* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78******************************************************************
    79
    80 ENVIRONMENT DIVISION.
    81
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   4
* EL6311.cbl
    83 DATA DIVISION.
    84 WORKING-STORAGE SECTION.
    85 01  DFH-START PIC X(04).
    86 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    87 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    88 77  FILLER  PIC X(32)  VALUE '********************************'.
    89 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    90 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    91 77  A1                          PIC S999 COMP-3 VALUE +0.
    92 77  N1                          PIC S999 COMP-3 VALUE +0.
    93 77  N2                          PIC S999 COMP-3 VALUE +0.
    94 77  N3                          PIC S999 COMP-3 VALUE +0.
    95 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    96 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    97 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    98     88  REVERSAL                    VALUE 'Y'.
    99 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   100 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   101 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   102 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   103 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   104     88  ERMAIL-FOUND                 VALUE 'Y'.
   105 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   106 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   107 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   108 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   109     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   110 77  ws-stop-sw                  pic x value ' '.
   111     88  i-say-stop                 value 'Y'.
   112 77  ws-check-sw                 pic x value ' '.
   113     88  i-have-checks              value 'Y'.
   114 77  ws-proc-check-sw            pic x value ' '.
   115     88  i-have-processed-checks    value 'Y'.
   116 77  ws-chek-browse-sw           pic x value ' '.
   117 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   118 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   119 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   120 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   121 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   122 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   123 01  P pointer.
   124 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   125 01  var-ptr pointer.
   126 01  env-var-len                 pic 9(4)  binary.
   127 01  rc                          pic 9(9)  binary.
   128 01  WS-KIXSYS.
   129     05  WS-KIX-FIL1             PIC X(10).
   130     05  WS-KIX-APPS             PIC X(10).
   131     05  WS-KIX-ENV              PIC X(10).
   132     05  WS-KIX-MYENV            PIC X(10).
   133     05  WS-KIX-SYS              PIC X(10).
   134*    COPY ELCSCTM.
   135******************************************************************
   136*                                                                *
   137*                                                                *
   138*                            ELCSCTM                             *
   139*                            VMOD=2.001                          *
   140*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   5
* EL6311.cbl
   141*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   142*                                                                *
   143******************************************************************
   144 01  SECURITY-MESSAGE.
   145     12  FILLER                          PIC X(30)
   146            VALUE '** LOGIC SECURITY VIOLATION -'.
   147     12  SM-READ                         PIC X(6).
   148     12  FILLER                          PIC X(5)
   149            VALUE ' PGM='.
   150     12  SM-PGM                          PIC X(6).
   151     12  FILLER                          PIC X(5)
   152            VALUE ' OPR='.
   153     12  SM-PROCESSOR-ID                 PIC X(4).
   154     12  FILLER                          PIC X(6)
   155            VALUE ' TERM='.
   156     12  SM-TERMID                       PIC X(4).
   157     12  FILLER                          PIC XX   VALUE SPACE.
   158     12  SM-JUL-DATE                     PIC 9(5).
   159     12  FILLER                          PIC X    VALUE SPACE.
   160     12  SM-TIME                         PIC 99.99.
   161
   162
   163*    COPY ELCSCRTY.
   164******************************************************************
   165*                                                                *
   166*                                                                *
   167*                            ELCSCRTY                            *
   168*                            VMOD=2.001                          *
   169*                                                                *
   170*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   171*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   172*        SAVED IN PI-SECURITY-ADDRESS.                           *
   173*                                                                *
   174******************************************************************
   175 01  SECURITY-CONTROL.
   176     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   177     12  FILLER                       PIC XX    VALUE 'SC'.
   178     12  SC-CREDIT-CODES.
   179         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   180             20  SC-CREDIT-DISPLAY    PIC X.
   181             20  SC-CREDIT-UPDATE     PIC X.
   182     12  SC-CLAIMS-CODES.
   183         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   184             20  SC-CLAIMS-DISPLAY    PIC X.
   185             20  SC-CLAIMS-UPDATE     PIC X.
   186
   187 01  WS-VA-NO-COMM-MESS.
   188     12  FILLER                  PIC X(41) VALUE
   189        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   190 01  WS-OC-MESSAGE.
   191     12  FILLER                  PIC X(43) VALUE
   192        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   193     12  WS-OC-DIS-AMT           PIC -----9.99.
   194     12  FILLER                  PIC X(4) VALUE ' ON '.
   195     12  WS-OC-DATE              PIC X(10).
   196 01  WS-DATE-AREA.
   197     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   198     12  WS-CURRENT-DT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   6
* EL6311.cbl
   199         16  FILLER              PIC X(6)    VALUE SPACES.
   200         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   201     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   202     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   203     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   204
   205 01  STANDARD-AREAS.
   206     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   207     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   208     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   209     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   210     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   211     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   212     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   213     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   214     12  PGM-NAME                PIC X(8).
   215     12  TIME-IN                 PIC S9(7).
   216     12  TIME-OUT-R  REDEFINES TIME-IN.
   217         16  FILLER              PIC X.
   218         16  TIME-OUT            PIC 99V99.
   219         16  FILLER              PIC XX.
   220     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   221     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   222     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   223     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   224     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   225     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   226     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   227     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   228     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   229     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   230     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   231     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   232     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   233     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   234     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   235     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   236     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   237     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   238     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   239     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   240     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   241     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   242     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   243     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   244     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   245     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   246     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   247     12  FILE-ID                 PIC X(8).
   248     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   249     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   250     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   251     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   252     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   253     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   254     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   255     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   256     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   7
* EL6311.cbl
   257     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   258     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   259     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   260     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   261     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   262     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   263
   264 01  WS-PASS-AREA.
   265     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   266     05  WS-PASS-VADS-REC    PIC X(350).
   267*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   268*                                COPY ELCZREC.
   269******************************************************************
   270*                                                                *
   271*                                                                *
   272*                            ELCZREC.                            *
   273*                                                                *
   274*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   275*                                                                *
   276******************************************************************
   277*-----------------------------------------------------------------
   278*                   C H A N G E   L O G
   279*
   280* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   281*-----------------------------------------------------------------
   282*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   283* EFFECTIVE    NUMBER
   284*-----------------------------------------------------------------
   285* 122011    2011022800001  AJRA  NEW FILE
   286* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   287* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   288* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   289* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   290*-----------------------------------------------------------------
   291 01  W-Z-CONTROL-DATA.
   292     05  W-NUMBER-OF-COPIES      PIC  9.
   293     05  FILLER                  PIC  X.
   294     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   295     05  FILLER                  PIC  X.
   296     05  W-DAYS-TO-RESEND        PIC  999.
   297     05  FILLER                  PIC  X.
   298     05  W-FORM-TO-RESEND        PIC  X(4).
   299     05  W-ADD-BAR-CODE          PIC  X.
   300     05  W-PROMPT-LETTER         PIC  X.
   301     05  W-HAS-RETURN-ENV        PIC  X.
   302     05  W-ENCLOSURE-CD          PIC  XXX.
   303     05  W-SIG-FLAG-DEFAULT      PIC  X.
   304     05  W-AUTO-CLOSE-IND        PIC  X.
   305     05  FILLER                  PIC  X.
   306     05  W-LETTER-TO-BENE        PIC  X.
   307     05  FILLER                  PIC  X.
   308     05  W-LETTER-TO-ACCT        PIC  X.
   309     05  FILLER                  PIC  X.
   310     05  W-LETTER-TYPE           PIC  X.
   311     05  FILLER                  PIC  X.
   312     05  W-PRINT-CERTIFICATE     PIC  X.
   313     05  FILLER                  PIC  X.
   314     05  W-REFUND-REQUIRED       PIC  X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   8
* EL6311.cbl
   315     05  FILLER                  PIC  X.
   316     05  W-ONBASE-CODE           PIC  XX.
   317     05  FILLER                  PIC  X.
   318     05  W-ACCT-SUMM             PIC  X.
   319     05  FILLER                  PIC  X.
   320     05  W-CSO-SUMM              PIC  X.
   321     05  FILLER                  PIC  X.
   322     05  W-REASONS-REQUIRED      PIC  X.
   323     05  FILLER                  PIC  X(29).
   324******************************************************************
   325*                                                                *
   326*              A C C E S S   K E Y S                             *
   327*                                                                *
   328******************************************************************
   329
   330 01  ACCESS-KEYS.
   331     12  ERPYAJ-KEY.
   332         16  ERPYAJ-COMPANY-CD       PIC X.
   333         16  ERPYAJ-CARRIER          PIC X.
   334         16  ERPYAJ-GROUPING         PIC X(6).
   335         16  ERPYAJ-FIN-RESP         PIC X(10).
   336         16  ERPYAJ-ACCOUNT          PIC X(10).
   337         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   338         16  ERPYAJ-TYPE             PIC X.
   339     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   340     12  ELCERT-KEY.
   341         16  ELCERT-COMPANY-CD       PIC X.
   342         16  ELCERT-CARRIER          PIC X.
   343         16  ELCERT-GROUPING         PIC X(6).
   344         16  ELCERT-STATE            PIC XX.
   345         16  ELCERT-ACCOUNT          PIC X(10).
   346         16  ELCERT-CERT-EFF-DT      PIC XX.
   347         16  ELCERT-CERT-NO.
   348             20  ELCERT-CERT-PRIME   PIC X(10).
   349             20  ELCERT-CERT-SFX     PIC X.
   350
   351     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   352     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   353     12  ELCRTO-KEY.
   354         16  ELCRTO-COMPANY-CD       PIC X.
   355         16  ELCRTO-CARRIER          PIC X.
   356         16  ELCRTO-GROUPING         PIC X(6).
   357         16  ELCRTO-STATE            PIC XX.
   358         16  ELCRTO-ACCOUNT          PIC X(10).
   359         16  ELCRTO-CERT-EFF-DT      PIC XX.
   360         16  ELCRTO-CERT-NO.
   361             20  ELCRTO-CERT-PRIME   PIC X(10).
   362             20  ELCRTO-CERT-SFX     PIC X.
   363         16  ELCRTO-RECORD-TYPE      PIC X.
   364         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   365
   366     12  ELCRTT-KEY.
   367         16  ELCRTT-PRIMARY          PIC X(33).
   368         16  ELCRTT-REC-TYPE         PIC X(1).
   369     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   370     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   371
   372     12  ERPNDB-KEY.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   9
* EL6311.cbl
   373         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   374         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   375         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   376         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   377             ERPNDB-BATCH-SEQ-NO     PIC XX.
   378         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   379
   380     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   381     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   382     12  ERCHEK-KEY.
   383         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   384         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   385         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   386         16  CHEK-STATE              PIC XX      VALUE SPACES.
   387         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   388         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   389         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   390         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   391         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   392     12  ELLETR-KEY.
   393         16  LETR-COMPANY-CD     PIC X.
   394         16  LETR-LETTER-ID      PIC X(4).
   395         16  LETR-FILLER         PIC X(8).
   396         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   397     12  ERPNDM-KEY.
   398         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   399         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   400         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   401         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   402
   403*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   404     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   405*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   406     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   407
   408     12  ERPNDB-ALT-KEY.
   409         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   410         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   411         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   412         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   413         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   414         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   415         16  ERPNDB-CERT-NO.
   416             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   417             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   418         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   419         16  ERPNDB-RECORD-TYPE      PIC X.
   420
   421      12  ERPNDB-CSR-KEY.
   422          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   423          20  ERPNDB-CSR-ID                PIC X(4).
   424          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   425          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   426          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   427
   428     12  ERNOTE-KEY.
   429         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   430         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  10
* EL6311.cbl
   431         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   432         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   433         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   434         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   435         16  ERNOTE-CERT-NO.
   436             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   437             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   438
   439     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   440     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   441
   442     12  ERCNOT-KEY.
   443         16  ERCNOT-PART-KEY.
   444             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   445             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   446             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   447             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   448             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   449             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   450             20  ERCNOT-CERT-NO.
   451                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   452                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   453         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   454         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   455
   456     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   457     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   458
   459     12  ERMAIL-KEY.
   460         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   461         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   462         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   463         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   464         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   465         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   466         16  ERMAIL-CERT-NO.
   467             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   468             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   469
   470     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   471     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   472
   473     12  ERRQST-KEY.
   474         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   475         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   476
   477     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   478     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   479
   480     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   481
   482     12  ERLOFC-KEY.
   483         16  ERLOFC-COMPANY-CD          PIC  X.
   484         16  ERLOFC-CARRIER             PIC  X.
   485         16  ERLOFC-GROUPING            PIC  X(6).
   486         16  ERLOFC-STATE               PIC  XX.
   487         16  ERLOFC-ACCOUNT             PIC  X(10).
   488         16  ERLOFC-OFFICER-CODE        PIC  X(5).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  11
* EL6311.cbl
   489*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   490
   491     12  ERACCT-KEY.
   492         16  ERACCT-COMPANY-CD          PIC  X.
   493         16  ERACCT-CARRIER             PIC  X.
   494         16  ERACCT-GROUPING            PIC  X(6).
   495         16  ERACCT-STATE               PIC  XX.
   496         16  ERACCT-ACCOUNT             PIC  X(10).
   497         16  ERACCT-EXP-DT.
   498             20  ERACCT-DT              PIC  XX.
   499             20  ERACCT-FILL            PIC  X(4).
   500
   501     12  ERENDT-KEY.
   502         16  ENDT-COMPANY-CD       PIC X.
   503         16  ENDT-CARRIER          PIC X.
   504         16  ENDT-GROUPING         PIC X(6).
   505         16  ENDT-STATE            PIC XX.
   506         16  ENDT-ACCOUNT          PIC X(10).
   507         16  ENDT-CERT-EFF-DT      PIC XX.
   508         16  ENDT-CERT-PRIME       PIC X(10).
   509         16  ENDT-CERT-SFX         PIC X.
   510         16  ENDT-RECORD-TYPE      PIC X.
   511         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   512
   513 01  WS-ELMSTR-WORK.
   514     12  ELMSTR-KEY.
   515         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   516         16  MSTR-CERT-NO.
   517             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   518             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   519     12  W-CLAIM-KEY.
   520         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   521         16  W-CL-CERT-NO.
   522             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   523             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   524      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   525 01  CANCEL-GEN-PASS-AREA.
   526     05  CG-OPTION-CODE          PIC X.
   527         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   528         88  CG-FLAT-CANCEL        VALUE '1'.
   529         88  CG-CANCEL             VALUE '2'.
   530         88  CG-CANCEL-REISSUE     VALUE '3'.
   531     05  CG-ERROR-CODE           PIC 99.
   532         88  CG-SUCCESS            VALUE 00.
   533         88  CG-DATE-ERROR         VALUE 01.
   534         88  CG-CERT-NOT-FOUND     VALUE 02.
   535         88  CG-AMOUNT-ERROR       VALUE 04.
   536         88  CG-OPTION-ERROR       VALUE 05.
   537         88  CG-PREV-CAN           VALUE 06.
   538         88  CG-INVALID-DATA       VALUE 07.
   539         88  CG-NO-ACCT-MSTR       VALUE 08.
   540         88  CG-SFX-A-EXIST        VALUE 09.
   541         88  CG-MISC-ERROR         VALUE 99.
   542     05  CG-COMPANY-ID           PIC XXX.
   543     05  CG-PROC-ID              PIC XXXX.
   544     05  CG-CURRENT-DT           PIC XX.
   545     05  CG-MONTH-END-DT         PIC XX.
   546     05  CG-CERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  12
* EL6311.cbl
   547         10  CG-CERT-COMPANY-CD  PIC X.
   548         10  CG-CERT-CARRIER     PIC X.
   549         10  CG-CERT-GROUP       PIC X(6).
   550         10  CG-CERT-STATE       PIC XX.
   551         10  CG-CERT-ACCOUNT     PIC X(10).
   552         10  CG-CERT-EFF-DT      PIC XX.
   553         10  CG-CERT-CERT-NO     PIC X(11).
   554     05  CG-LF-CAN-DATA.
   555         10  CG-LF-CAN-DT        PIC XX.
   556         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   557     05  CG-AH-CAN-DATA.
   558         10  CG-AH-CAN-DT        PIC XX.
   559         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   560     05  CG-CERT-PROFILE-DATA.
   561         10  CG-INS-LNAME        PIC X(15).
   562         10  CG-INS-FNAME        PIC X(10).
   563         10  CG-INS-MID-INIT     PIC X.
   564         10  CG-INS-AGE          PIC 99.
   565         10  CG-JNT-LNAME        PIC X(15).
   566         10  CG-JNT-FNAME        PIC X(10).
   567         10  CG-JNT-MID-INIT     PIC X.
   568         10  CG-JNT-AGE          PIC 99.
   569     05  CG-LF-ISS-DATA.
   570         10  CG-LF-BENCD         PIC XX.
   571         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   572         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   573     05  CG-AH-ISS-DATA.
   574         10  CG-AH-BENCD         PIC XX.
   575         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   576     05  CG-BATCH-NO             PIC X(6).
   577     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   578     05  FILLER                  PIC X(306).
   579******************************************************************
   580*                                                                *
   581*            G E N E R A L   W O R K   A R E A                   *
   582*                                                                *
   583******************************************************************
   584
   585 01  WORK-AREA.
   586     12  WS-RESPONSE             PIC S9(8)   COMP.
   587         88  RESP-NORMAL           VALUE +0.
   588         88  resp-file-notfnd      value +12.
   589         88  RESP-NOTFND           VALUE +13.
   590         88  resp-duprec           value +14.
   591         88  resp-dupkey           value +15.
   592         88  resp-invreq           value +16.
   593         88  RESP-NOTOPEN          VALUE +19.
   594         88  RESP-ENDFILE          VALUE +20.
   595         88  resp-lengtherr        value +22.
   596     12  DEEDIT-FIELD            PIC X(15).
   597     12  FILLER          REDEFINES DEEDIT-FIELD.
   598         16  FILLER              PIC X(4).
   599         16  DEEDIT-FIELD-X11    PIC X(11).
   600     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   601                                 PIC S9(15).
   602     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   603                                 PIC S9(13)V99.
   604     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  13
* EL6311.cbl
   605                                 PIC S9(11)V9999.
   606     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   607     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   608     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   609         16  WS-CALC-TERM-WHOLE  PIC S999.
   610         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   611
   612     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   613     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   614         16  WS-HR-MINS          PIC 99V99.
   615         16  FILLER              PIC XX.
   616
   617     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   618     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   619
   620     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   621     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   622
   623     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   624     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   625     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   626     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   627     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   628     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   629     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   630
   631     12  QID.
   632         16  QID-TERM            PIC X(4).
   633         16  FILLER              PIC X(4)    VALUE '607B'.
   634
   635     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   636         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   637
   638     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   639         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   640
   641     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   642         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   643                                         'A'.
   644
   645     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   646
   647     12  WS-NUMERIC-SW           PIC X.
   648        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   649
   650     12  WS-EDIT-CSO-FIELD.
   651         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   652                                 PIC X.
   653
   654     12  WS-SAVE-INPUT-FIELDS.
   655         16  WS-BAGE             PIC 99       VALUE ZERO.
   656*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   657         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   658         16  FILLER REDEFINES WS-BAPR.
   659             20  WS-APR-WHOLE-NUM    PIC 99.
   660             20  WS-APR-DEC          PIC 9999.
   661         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   662         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  14
* EL6311.cbl
   663
   664         16  WS-B-COVERAGE OCCURS 2 TIMES.
   665             20  WS-TERM-IN-DAYS-SW  PIC X.
   666                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   667             20  WS-BTERM        PIC 999       COMP-3.
   668             20  WS-BALT-TERM    PIC 999       COMP-3.
   669             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   670             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   671             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   672             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   673             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   674             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   675
   676         16  WS-C-FIELDS COMP-3.
   677             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   678             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   679             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   680
   681         16  WS-D-FIELDS COMP-3.
   682             20  WS-DRISS        PIC S9(5)    VALUE +0.
   683             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   684             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   685             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   686             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   687             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   688
   689     12  WS-SAVE-BIRTH-DATE.
   690         16  FILLER              PIC X(4)   VALUE SPACES.
   691         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   692
   693     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   694     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   695     12  FILLER REDEFINES WS-WORK-BIN-RED.
   696         16  FILLER              PIC X(02).
   697         16  WS-WORK-BIN-DT      PIC X(02).
   698     12  WS-SW-1                 PIC X     VALUE SPACE.
   699     12  WS-SW-2                 PIC X     VALUE SPACE.
   700     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   701         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   702     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   703         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   704
   705     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   706     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   707     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   708     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   709     12  WS-CONVERTED-CANCEL-DATES.
   710         16  WS-CONVERTED-CANDT1                  PIC XX.
   711         16  WS-CONVERTED-CANDT2                  PIC XX.
   712
   713     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   714
   715     12  WS-REC-FOUND-SW         PIC X.
   716         88  RECORD-NOT-FOUND    VALUE 'N'.
   717
   718     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   719         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   720         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  15
* EL6311.cbl
   721
   722     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   723         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   724         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   725
   726     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   727         88  BROWSE-STARTED      VALUE 'Y'.
   728
   729     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   730         88  FIRST-TIME          VALUE 'Y'.
   731
   732     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   733         88  FIRST-ENTRY         VALUE 'Y'.
   734
   735     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   736         88  REC-BILLED          VALUE 'Y'.
   737
   738     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   739         88  NO-CURSOR-SET       VALUE +0.
   740         88  CURSOR-SET          VALUE +1.
   741
   742     12  WS-ERR-SW               PIC X.
   743         88  STD-ERRORS          VALUE 'S'.
   744         88  TRN-ERRORS          VALUE 'T'.
   745
   746     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   747         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   748
   749     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   750         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   751
   752     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   753         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   754
   755     12  WS-ERR-CODE.
   756         16  FILLER              PIC 99.
   757         16  WS-ERROR-SUB        PIC 99.
   758
   759     12  WS-DATE-WORK.
   760         16  WS-WORK-MM          PIC XX.
   761         16  WS-WORK-DD          PIC XX.
   762         16  WS-WORK-YY          PIC XX.
   763
   764     12  WS-MM-YY.
   765         16  WS-MM               PIC XX.
   766         16  FILLER              PIC X     VALUE '/'.
   767         16  WS-YY               PIC XX.
   768
   769     12  WS-CERT-EFF-DT          PIC XX.
   770
   771     12  WS-MEMBER-NO            PIC X(12).
   772     12  FILLER  REDEFINES  WS-MEMBER-NO.
   773         16  WS-MEMBER-NO-1-8    PIC 9(8).
   774         16  FILLER              PIC X(4).
   775
   776     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   777
   778     12  WS-ERPNDB-ALT-KEY.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  16
* EL6311.cbl
   779         16  WS-PB-COMPANY-CD-A1         PIC X.
   780         16  WS-PB-CARRIER               PIC X.
   781         16  WS-PB-GROUPING              PIC X(6).
   782         16  WS-PB-STATE                 PIC XX.
   783         16  WS-PB-ACCOUNT               PIC X(10).
   784         16  WS-PB-CERT-EFF-DT           PIC XX.
   785         16  WS-PB-CERT-NO.
   786             20  WS-PB-CERT-PRIME        PIC X(10).
   787             20  WS-PB-CERT-SFX          PIC X.
   788         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   789         16  WS-PB-RECORD-TYPE           PIC X.
   790
   791     12  WS-SHOW-SAVE-AREAS.
   792         16  WS-NEW-CERT-NO.
   793             20  WS-NEW-PRIME    PIC X(10).
   794             20  WS-NEW-SUFFIX   PIC X.
   795         16  WS-NEW-CERT-EFF-DT  PIC XX.
   796         16  WS-NEW-RECORD-TYPE  PIC X.
   797         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   798             88   SHOW-RECORD            VALUE 'Y'.
   799
   800     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   801
   802     12  WS-BATCH-NO.
   803         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   804         16  FILLER              PIC X(5) VALUE SPACES.
   805
   806     12  WS-FIRST-NAME.
   807         16  WS-1ST-INIT         PIC X.
   808         16  FILLER              PIC X(9).
   809
   810     12  WS-INITIALS.
   811         16  WS-INITIAL-1        PIC X.
   812         16  WS-INITIAL-2        PIC X.
   813
   814     12  WS-C-HDG.
   815         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   816         16  FILLER              PIC X(4) VALUE '-REF'.
   817
   818     12  WS-D-PREM-HDG.
   819         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   820         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   821
   822     12  WS-D-REFUND-HDG.
   823         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   824         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   825
   826     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   827
   828     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   829     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   830     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   831     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   832     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   833     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   834     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   835
   836     12  WS-01-CANCEL-ERR        PIC X(25)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  17
* EL6311.cbl
   837         VALUE 'CANCEL DATE ERROR'.
   838     12  WS-02-CANCEL-ERR        PIC X(25)
   839         VALUE 'CERT NOT FOUND'.
   840     12  WS-04-CANCEL-ERR        PIC X(25)
   841         VALUE 'CANCEL AMOUNT ERROR'.
   842     12  WS-05-CANCEL-ERR        PIC X(25)
   843         VALUE 'CANCEL OPTION ERROR'.
   844     12  WS-06-CANCEL-ERR        PIC X(25)
   845         VALUE 'PREVIOUSLY CANCELLED'.
   846     12  WS-07-CANCEL-ERR        PIC X(25)
   847         VALUE 'INVALID DATA'.
   848     12  WS-08-CANCEL-ERR        PIC X(25)
   849         VALUE 'NO ACCOUNT MASTER'.
   850     12  WS-09-CANCEL-ERR        PIC X(25)
   851         VALUE 'SUFFIX ALREADY EXISTS'.
   852     12  WS-99-CANCEL-ERR        PIC X(25)
   853         VALUE 'MISC CANCEL ERROR'.
   854
   855     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   856     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   857
   858     12  WS-AGE-FIELDS.
   859         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   860         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   861         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   862         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   863
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  18
* EL6311.cbl
   865
   866******************************************************************
   867*                                                                *
   868*                 B A T C H   T O T A L S                        *
   869*                                                                *
   870******************************************************************
   871
   872     12  WS-BATCH-RECORD.
   873         16  FILLER                       PIC X(10).
   874         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   875         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   876         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   877         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   878         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   879         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   880         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   881         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   882         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   883         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   884         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   885         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   886         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   887         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   888         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   889         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   890         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   891         16  WS-ACCOUNT-NAME              PIC X(30).
   892         16  FILLER                       PIC X.
   893         16  WS-REFERENCE                 PIC X(12).
   894         16  FILLER                       PIC X(197).
   895
   896     12  WS-BATCH-TOTALS.
   897         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   898         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   899         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   900         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   901         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   902         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   903         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   904         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   905         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   906         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   907         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   908         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   909         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   910         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   911         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   912         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   913         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   914         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   915         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   916
   917     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   918
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  19
* EL6311.cbl
   920
   921******************************************************************
   922*                                                                *
   923*                E R R O R   M E S S A G E S                     *
   924*                                                                *
   925******************************************************************
   926
   927 01  ERROR-MESSAGES.
   928     12  ER-0004                 PIC  9(4) VALUE 0004.
   929     12  ER-0008                 PIC  9(4) VALUE 0008.
   930     12  ER-0023                 PIC  9(4) VALUE 0023.
   931     12  ER-0029                 PIC  9(4) VALUE 0029.
   932     12  ER-0033                 PIC  9(4) VALUE 0033.
   933     12  ER-0070                 PIC  9(4) VALUE 0070.
   934     12  ER-0220                 PIC  9(4) VALUE 0220.
   935     12  ER-0248                 PIC  9(4) VALUE 0248.
   936     12  ER-0280                 PIC  9(4) VALUE 0280.
   937     12  ER-0348                 PIC  9(4) VALUE 0348.
   938     12  ER-0582                 PIC  9(4) VALUE 0582.
   939     12  ER-0877                 PIC  9(4) VALUE 0877.
   940     12  ER-1236                 PIC  9(4) VALUE 1236.
   941     12  ER-1570                 PIC  9(4) VALUE 1570.
   942     12  ER-1575                 PIC  9(4) VALUE 1575.
   943     12  ER-1609                 PIC  9(4) VALUE 1609.
   944     12  ER-1819                 PIC  9(4) VALUE 1819.
   945     12  ER-2077                 PIC  9(4) VALUE 2077.
   946     12  ER-2129                 PIC  9(4) VALUE 2129.
   947     12  ER-2188                 PIC  9(4) VALUE 2188.
   948     12  ER-2192                 PIC  9(4) VALUE 2192.
   949     12  ER-2196                 PIC  9(4) VALUE 2196.
   950     12  ER-2197                 PIC  9(4) VALUE 2197.
   951     12  ER-2198                 PIC  9(4) VALUE 2198.
   952     12  ER-2200                 PIC  9(4) VALUE 2200.
   953     12  ER-2212                 PIC  9(4) VALUE 2212.
   954     12  ER-2218                 PIC  9(4) VALUE 2218.
   955     12  ER-2220                 PIC  9(4) VALUE 2220.
   956     12  ER-2222                 PIC  9(4) VALUE 2222.
   957     12  ER-2223                 PIC  9(4) VALUE 2223.
   958     12  ER-2224                 PIC  9(4) VALUE 2224.
   959     12  ER-2225                 PIC  9(4) VALUE 2225.
   960     12  ER-2226                 PIC  9(4) VALUE 2226.
   961     12  ER-2227                 PIC  9(4) VALUE 2227.
   962     12  ER-2228                 PIC  9(4) VALUE 2228.
   963     12  ER-2240                 PIC  9(4) VALUE 2240.
   964     12  ER-2241                 PIC  9(4) VALUE 2241.
   965     12  ER-2242                 PIC  9(4) VALUE 2242.
   966     12  ER-2243                 PIC  9(4) VALUE 2243.
   967     12  ER-2244                 PIC  9(4) VALUE 2244.
   968     12  ER-2245                 PIC  9(4) VALUE 2245.
   969     12  ER-2246                 PIC  9(4) VALUE 2246.
   970     12  ER-2247                 PIC  9(4) VALUE 2247.
   971     12  ER-2251                 PIC  9(4) VALUE 2251.
   972     12  ER-2252                 PIC  9(4) VALUE 2252.
   973     12  ER-2253                 PIC  9(4) VALUE 2253.
   974     12  ER-2254                 PIC  9(4) VALUE 2254.
   975     12  ER-2255                 PIC  9(4) VALUE 2255.
   976     12  ER-2256                 PIC  9(4) VALUE 2256.
   977     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  20
* EL6311.cbl
   978     12  ER-2258                 PIC  9(4) VALUE 2258.
   979     12  ER-2259                 PIC  9(4) VALUE 2259.
   980     12  ER-2260                 PIC  9(4) VALUE 2260.
   981     12  ER-2261                 PIC  9(4) VALUE 2261.
   982     12  ER-2287                 PIC  9(4) VALUE 2287.
   983     12  ER-2336                 PIC  9(4) VALUE 2336.
   984     12  ER-2337                 PIC  9(4) VALUE 2337.
   985     12  ER-2437                 PIC  9(4) VALUE 2437.
   986     12  ER-2471                 PIC  9(4) VALUE 2471.
   987     12  ER-2530                 PIC  9(4) VALUE 2530.
   988     12  ER-2531                 PIC  9(4) VALUE 2531.
   989     12  ER-2532                 PIC  9(4) VALUE 2532.
   990     12  ER-2533                 PIC  9(4) VALUE 2533.
   991     12  ER-2547                 PIC  9(4) VALUE 2547.
   992     12  ER-2591                 PIC  9(4) VALUE 2591.
   993     12  ER-2592                 PIC  9(4) VALUE 2592.
   994     12  ER-2593                 PIC  9(4) VALUE 2593.
   995     12  ER-2600                 PIC  9(4) VALUE 2600.
   996     12  ER-2601                 PIC  9(4) VALUE 2601.
   997     12  ER-2604                 PIC  9(4) VALUE 2604.
   998     12  ER-2605                 PIC  9(4) VALUE 2605.
   999     12  ER-2606                 PIC  9(4) VALUE 2606.
  1000     12  ER-2607                 PIC  9(4) VALUE 2607.
  1001     12  ER-2622                 PIC  9(4) VALUE 2622.
  1002     12  ER-2625                 PIC  9(4) VALUE 2625.
  1003     12  ER-2626                 PIC  9(4) VALUE 2626.
  1004     12  ER-2627                 PIC  9(4) VALUE 2627.
  1005     12  ER-2628                 PIC  9(4) VALUE 2628.
  1006     12  ER-2629                 PIC  9(4) VALUE 2629.
  1007     12  ER-2630                 PIC  9(4) VALUE 2630.
  1008     12  ER-2631                 PIC  9(4) VALUE 2631.
  1009     12  ER-2632                 PIC  9(4) VALUE 2632.
  1010     12  ER-2633                 PIC  9(4) VALUE 2633.
  1011     12  ER-2634                 PIC  9(4) VALUE 2634.
  1012     12  ER-2635                 PIC  9(4) VALUE 2635.
  1013     12  ER-2636                 PIC  9(4) VALUE 2636.
  1014     12  ER-2639                 PIC  9(4) VALUE 2639.
  1015     12  ER-2640                 PIC  9(4) VALUE 2640.
  1016     12  ER-2647                 PIC  9(4) VALUE 2647.
  1017     12  ER-2648                 PIC  9(4) VALUE 2648.
  1018     12  ER-2649                 PIC  9(4) VALUE 2649.
  1019     12  ER-2650                 PIC  9(4) VALUE 2650.
  1020     12  ER-2653                 PIC  9(4) VALUE 2653.
  1021     12  ER-2654                 PIC  9(4) VALUE 2654.
  1022     12  ER-2655                 PIC  9(4) VALUE 2655.
  1023     12  ER-2656                 PIC  9(4) VALUE 2656.
  1024     12  ER-2657                 PIC  9(4) VALUE 2657.
  1025     12  ER-2660                 PIC  9(4) VALUE 2660.
  1026     12  ER-2661                 PIC  9(4) VALUE 2661.
  1027     12  ER-2662                 PIC  9(4) VALUE 2662.
  1028     12  ER-2663                 PIC  9(4) VALUE 2663.
  1029     12  ER-2664                 PIC  9(4) VALUE 2664.
  1030     12  ER-2667                 PIC  9(4) VALUE 2667.
  1031     12  ER-2668                 PIC  9(4) VALUE 2668.
  1032     12  ER-2669                 PIC  9(4) VALUE 2669.
  1033     12  ER-2670                 PIC  9(4) VALUE 2670.
  1034     12  ER-2671                 PIC  9(4) VALUE 2671.
  1035     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  21
* EL6311.cbl
  1036     12  ER-2673                 PIC  9(4) VALUE 2673.
  1037     12  ER-2677                 PIC  9(4) VALUE 2677.
  1038     12  ER-2678                 PIC  9(4) VALUE 2678.
  1039     12  ER-2679                 PIC  9(4) VALUE 2679.
  1040     12  ER-2680                 PIC  9(4) VALUE 2680.
  1041     12  ER-2681                 PIC  9(4) VALUE 2681.
  1042     12  ER-2682                 PIC  9(4) VALUE 2682.
  1043     12  ER-2683                 PIC  9(4) VALUE 2683.
  1044     12  ER-2684                 PIC  9(4) VALUE 2684.
  1045     12  ER-2686                 PIC  9(4) VALUE 2686.
  1046     12  ER-2689                 PIC  9(4) VALUE 2689.
  1047     12  ER-2690                 PIC  9(4) VALUE 2690.
  1048     12  ER-2693                 PIC  9(4) VALUE 2693.
  1049     12  ER-2695                 PIC  9(4) VALUE 2695.
  1050     12  ER-2701                 PIC  9(4) VALUE 2701.
  1051     12  ER-2720                 PIC  9(4) VALUE 2720.
  1052     12  ER-2709                 PIC  9(4) VALUE 2709.
  1053     12  ER-2704                 PIC  9(4) VALUE 2704.
  1054     12  ER-2725                 PIC  9(4) VALUE 2725.
  1055     12  ER-2726                 PIC  9(4) VALUE 2726.
  1056     12  ER-2728                 PIC  9(4) VALUE 2728.
  1057     12  ER-2729                 PIC  9(4) VALUE 2729.
  1058     12  ER-2731                 PIC  9(4) VALUE 2731.
  1059     12  ER-2732                 PIC  9(4) VALUE 2732.
  1060     12  ER-2733                 PIC  9(4) VALUE 2733.
  1061     12  ER-2735                 PIC  9(4) VALUE 2735.
  1062     12  ER-2738                 PIC  9(4) VALUE 2738.
  1063     12  ER-2742                 PIC  9(4) VALUE 2742.
  1064     12  ER-2743                 PIC  9(4) VALUE 2743.
  1065     12  ER-2744                 PIC  9(4) VALUE 2744.
  1066     12  ER-2747                 PIC  9(4) VALUE 2747.
  1067     12  ER-2749                 PIC  9(4) VALUE 2749.
  1068     12  ER-2753                 PIC  9(4) VALUE 2753.
  1069     12  ER-2755                 PIC  9(4) VALUE 2755.
  1070     12  ER-2757                 PIC  9(4) VALUE 2757.
  1071     12  ER-2771                 PIC  9(4) VALUE 2771.
  1072     12  ER-2774                 PIC  9(4) VALUE 2774.
  1073     12  ER-2775                 PIC  9(4) VALUE 2775.
  1074     12  ER-2776                 PIC  9(4) VALUE 2776.
  1075     12  ER-2777                 PIC  9(4) VALUE 2777.
  1076     12  ER-2794                 PIC  9(4) VALUE 2794.
  1077     12  ER-2799                 PIC  9(4) VALUE 2799.
  1078     12  ER-2900                 PIC  9(4) VALUE 2900.
  1079     12  ER-2902                 PIC  9(4) VALUE 2902.
  1080     12  ER-2945                 PIC  9(4) VALUE 2945.
  1081     12  ER-3000                 PIC  9(4) VALUE 3000.
  1082     12  ER-3006                 PIC  9(4) VALUE 3006.
  1083     12  ER-3054                 PIC  9(4) VALUE 3054.
  1084     12  ER-3224                 PIC  9(4) VALUE 3224.
  1085     12  ER-3269                 PIC  9(4) VALUE 3269.
  1086     12  er-3444                 pic  9(4) value 3444.
  1087     12  er-3446                 pic  9(4) value 3446.
  1088     12  er-3447                 pic  9(4) value 3447.
  1089     12  er-3448                 pic  9(4) value 3448.
  1090     12  er-3449                 pic  9(4) value 3449.
  1091     12  ER-3456                 PIC  9(4) VALUE 3456.
  1092     12  ER-3457                 PIC  9(4) VALUE 3457.
  1093     12  ER-3458                 PIC  9(4) VALUE 3458.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  22
* EL6311.cbl
  1094     12  ER-3504                 PIC  9(4) VALUE 3504.
  1095     12  ER-3513                 PIC  9(4) VALUE 3513.
  1096     12  ER-3831                 PIC  9(4) VALUE 3831.
  1097     12  ER-3834                 PIC  9(4) VALUE 3834.
  1098     12  ER-3835                 PIC  9(4) VALUE 3835.
  1099     12  ER-4005                 PIC  9(4) VALUE 4005.
  1100     12  ER-7144                 PIC  9(4) VALUE 7144.
  1101     12  ER-7401                 PIC  9(4) VALUE 7401.
  1102     12  ER-7402                 PIC  9(4) VALUE 7402.
  1103     12  ER-7403                 PIC  9(4) VALUE 7403.
  1104     12  ER-7404                 PIC  9(4) VALUE 7404.
  1105     12  ER-7423                 PIC  9(4) VALUE 7423.
  1106     12  ER-7424                 PIC  9(4) VALUE 7424.
  1107     12  ER-7433                 PIC  9(4) VALUE 7433.
  1108     12  ER-7450                 PIC  9(4) VALUE 7450.
  1109     12  ER-7451                 PIC  9(4) VALUE 7451.
  1110     12  ER-7530                 PIC  9(4) VALUE 7530.
  1111     12  ER-7573                 PIC  9(4) VALUE 7573.
  1112     12  ER-7631                 PIC  9(4) VALUE 7631.
  1113     12  ER-7632                 PIC  9(4) VALUE 7632.
  1114     12  ER-7633                 PIC  9(4) VALUE 7633.
  1115     12  ER-7537                 PIC  9(4) VALUE 7537.
  1116     12  ER-7538                 PIC  9(4) VALUE 7538.
  1117     12  ER-7574                 PIC  9(4) VALUE 7574.
  1118     12  ER-7997                 PIC  9(4) VALUE 7997.
  1119     12  ER-7998                 PIC  9(4) VALUE 7998.
  1120     12  ER-8148                 PIC  9(4) VALUE 8148.
  1121     12  ER-9063                 PIC  9(4) VALUE 9063.
  1122     12  ER-9076                 PIC  9(4) VALUE 9076.
  1123     12  ER-9618                 PIC  9(4) VALUE 9618.
  1124     12  ER-9841                 PIC  9(4) VALUE 9841.
  1125
  1126*                                COPY ELCTEXT.
  1127******************************************************************
  1128*                                                                *
  1129*                                                                *
  1130*                            ELCTEXT.                            *
  1131*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1132*                            VMOD=2.008                          *
  1133*                                                                *
  1134*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1135*                                     FORM LETTERS,              *
  1136*                                     CERT FORM DISPLAY.
  1137*                                                                *
  1138*   FILE TYPE = VSAM,KSDS                                        *
  1139*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1140*                                                                *
  1141*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1142*       ALTERNATE INDEX = NONE                                   *
  1143*                                                                *
  1144*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1145*       ALTERNATE INDEX = NONE                                   *
  1146*                                                                *
  1147*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1148*       ALTERNATE INDEX = NONE                                   *
  1149*                                                                *
  1150*   LOG = NO                                                     *
  1151*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  23
* EL6311.cbl
  1152******************************************************************
  1153 01  TEXT-FILES.
  1154     12  TEXT-FILE-ID                PIC XX.
  1155         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1156         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1157         88  HELP-FILE-TEXT             VALUE 'TH'.
  1158
  1159     12  TX-CONTROL-PRIMARY.
  1160         16  TX-COMPANY-CD           PIC X.
  1161             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1162         16  TX-ACCESS-CD-GENL       PIC X(12).
  1163
  1164         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1165             20  TX-LETTER-NO        PIC X(4).
  1166             20  FILLER              PIC X(8).
  1167
  1168         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1169             20  TX-FORM-NO          PIC X(12).
  1170
  1171         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1172             20  TX-HELP-TYPE        PIC X.
  1173                 88  HELP-FOR-GENERAL   VALUE ' '.
  1174                 88  HELP-BY-SCREEN     VALUE 'S'.
  1175                 88  HELP-BY-ERROR      VALUE 'E'.
  1176             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1177                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1178             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1179                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1180             20  FILLER              PIC X(4).
  1181
  1182         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1183
  1184     12  TX-PROCESS-CONTROL          PIC XX.
  1185         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1186
  1187     12  TX-TEXT-LINE                PIC X(70).
  1188
  1189     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1190         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1191         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1192         88  TX-VALID-FORM-SQUEEZE-VALUE
  1193                                        VALUE 'Y' ' '.
  1194
  1195     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1196         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1197         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1198         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1199         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1200         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1201         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1202         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1203                                              'K' 'N' ' '
  1204                                              'Z'.
  1205
  1206     12  TX-ARCHIVE-SW               PIC X.
  1207         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1208         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1209         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  24
* EL6311.cbl
  1210
  1211     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1212     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1213
  1214     12  TX-BSR-CODE                 PIC X.
  1215         88  TX-BSR-LETTER              VALUE 'B'.
  1216         88  TX-NON-BSR-LETTER          VALUE ' '.
  1217
  1218     12  FILLER                      PIC X.
  1219*****************************************************************
  1220*                                COPY ELCCRTO.
  1221******************************************************************
  1222*                                                                *
  1223*                            ELCCRTO.                            *
  1224*                                                                *
  1225*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1226*                                                                *
  1227*   FILE TYPE = VSAM,KSDS                                        *
  1228*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1229*                                                                *
  1230*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1231*                                                                *
  1232*   LOG = YES                                                    *
  1233*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1234******************************************************************
  1235*                   C H A N G E   L O G
  1236*
  1237* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1238*-----------------------------------------------------------------
  1239*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1240* EFFECTIVE    NUMBER
  1241*-----------------------------------------------------------------
  1242* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1243* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1244* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1245* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1246* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1247******************************************************************
  1248 01  ORIGINAL-CERTIFICATE.
  1249     12  OC-RECORD-ID                      PIC XX.
  1250         88  VALID-OC-ID                      VALUE 'OC'.
  1251     12  OC-CONTROL-PRIMARY.
  1252         16  OC-COMPANY-CD                 PIC X.
  1253         16  OC-CARRIER                    PIC X.
  1254         16  OC-GROUPING                   PIC X(6).
  1255         16  OC-STATE                      PIC XX.
  1256         16  OC-ACCOUNT                    PIC X(10).
  1257         16  OC-CERT-EFF-DT                PIC XX.
  1258         16  OC-CERT-NO.
  1259             20  OC-CERT-PRIME             PIC X(10).
  1260             20  OC-CERT-SFX               PIC X.
  1261         16  OC-RECORD-TYPE                PIC X.
  1262         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1263     12  OC-LAST-MAINT-DT                  PIC XX.
  1264     12  OC-LAST-MAINT-BY                  PIC X(4).
  1265     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1266     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1267     12  FILLER                            PIC X(49).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  25
* EL6311.cbl
  1268     12  OC-ORIG-REC.
  1269         16  OC-INS-LAST-NAME              PIC X(15).
  1270         16  OC-INS-FIRST-NAME             PIC X(10).
  1271         16  OC-INS-MIDDLE-INIT            PIC X.
  1272         16  OC-INS-AGE                    PIC S999     COMP-3.
  1273         16  OC-JNT-LAST-NAME              PIC X(15).
  1274         16  OC-JNT-FIRST-NAME             PIC X(10).
  1275         16  OC-JNT-MIDDLE-INIT            PIC X.
  1276         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1277         16  OC-LF-BENCD                   PIC XX.
  1278         16  OC-LF-TERM                    PIC S999      COMP-3.
  1279         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1280         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1281         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1282         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1283         16  OC-LF-EXP-DT                  PIC XX.
  1284         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1285         16  OC-LF-CANCEL-DT               PIC XX.
  1286         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1287         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1288         16  OC-AH-BENCD                   PIC XX.
  1289         16  OC-AH-TERM                    PIC S999      COMP-3.
  1290         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1291         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1292         16  OC-AH-EXP-DT                  PIC XX.
  1293         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1294         16  OC-AH-CP                      PIC 99.
  1295         16  OC-AH-CANCEL-DT               PIC XX.
  1296         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1297         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1298         16  OC-CRED-BENE-NAME             PIC X(25).
  1299         16  OC-1ST-PMT-DT                 PIC XX.
  1300         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1301         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1302         16  OC-ISSUE-TRAN-IND             PIC X.
  1303         16  OC-CANCEL-TRAN-IND            PIC X.
  1304         16  FILLER                        PIC X(211).
  1305
  1306     12  FILLER                            PIC X(50).
  1307******************************************************************
  1308*                                COPY ERCACCT.
  1309******************************************************************
  1310*                                                                *
  1311*                                                                *
  1312*                            ERCACCT                             *
  1313*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1314*                            VMOD=2.031                          *
  1315*                                                                *
  1316*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1317*                                                                *
  1318*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1319*   VSAM ACCOUNT MASTER FILES.                                   *
  1320*                                                                *
  1321*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1322*                                                                *
  1323*   FILE TYPE = VSAM,KSDS                                        *
  1324*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1325*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  26
* EL6311.cbl
  1326*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1327*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1328*                                                                *
  1329*   LOG = NO                                                     *
  1330*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1331*                                                                *
  1332*                                                                *
  1333******************************************************************
  1334*                   C H A N G E   L O G
  1335*
  1336* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1337*-----------------------------------------------------------------
  1338*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1339* EFFECTIVE    NUMBER
  1340*-----------------------------------------------------------------
  1341* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1342* 092705    2005050300006  PEMA  ADD SPP LEASES
  1343* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1344* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1345* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1346* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1347* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1348******************************************************************
  1349
  1350 01  ACCOUNT-MASTER.
  1351     12  AM-RECORD-ID                      PIC XX.
  1352         88  VALID-AM-ID                      VALUE 'AM'.
  1353
  1354     12  AM-CONTROL-PRIMARY.
  1355         16  AM-COMPANY-CD                 PIC X.
  1356         16  AM-MSTR-CNTRL.
  1357             20  AM-CONTROL-A.
  1358                 24  AM-CARRIER            PIC X.
  1359                 24  AM-GROUPING.
  1360                     28 AM-GROUPING-PREFIX PIC XXX.
  1361                     28 AM-GROUPING-PRIME  PIC XXX.
  1362                 24  AM-STATE              PIC XX.
  1363                 24  AM-ACCOUNT.
  1364                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1365                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1366             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1367                                           PIC X(19).
  1368             20  AM-CNTRL-B.
  1369                 24  AM-EXPIRATION-DT      PIC XX.
  1370                 24  FILLER                PIC X(4).
  1371             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1372                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1373
  1374     12  AM-CONTROL-BY-VAR-GRP.
  1375         16  AM-COMPANY-CD-A1              PIC X.
  1376         16  AM-VG-CARRIER                 PIC X.
  1377         16  AM-VG-GROUPING                PIC X(6).
  1378         16  AM-VG-STATE                   PIC XX.
  1379         16  AM-VG-ACCOUNT                 PIC X(10).
  1380         16  AM-VG-DATE.
  1381             20  AM-VG-EXPIRATION-DT       PIC XX.
  1382             20  FILLER                    PIC X(4).
  1383         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  27
* EL6311.cbl
  1384                                           PIC 9(11)      COMP-3.
  1385     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1386         16  FILLER                        PIC X(10).
  1387         16  AM-VG-KEY3.
  1388             20  AM-VG3-ACCOUNT            PIC X(10).
  1389             20  AM-VG3-EXP-DT             PIC XX.
  1390         16  FILLER                        PIC X(4).
  1391     12  AM-MAINT-INFORMATION.
  1392         16  AM-LAST-MAINT-DT              PIC XX.
  1393         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1394         16  AM-LAST-MAINT-USER            PIC X(4).
  1395         16  FILLER                        PIC XX.
  1396
  1397     12  AM-EFFECTIVE-DT                   PIC XX.
  1398     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1399
  1400     12  AM-PREV-DATES  COMP-3.
  1401         16  AM-PREV-EXP-DT                PIC 9(11).
  1402         16  AM-PREV-EFF-DT                PIC 9(11).
  1403
  1404     12  AM-REPORT-CODE-1                  PIC X(10).
  1405     12  AM-REPORT-CODE-2                  PIC X(10).
  1406
  1407     12  AM-CITY-CODE                      PIC X(4).
  1408     12  AM-COUNTY-PARISH                  PIC X(6).
  1409
  1410     12  AM-NAME                           PIC X(30).
  1411     12  AM-PERSON                         PIC X(30).
  1412     12  AM-ADDRS                          PIC X(30).
  1413     12  AM-CITY.
  1414         16  AM-ADDR-CITY                  PIC X(28).
  1415         16  AM-ADDR-STATE                 PIC XX.
  1416     12  AM-ZIP.
  1417         16  AM-ZIP-PRIME.
  1418             20  AM-ZIP-PRI-1ST            PIC X.
  1419                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1420             20  FILLER                    PIC X(4).
  1421         16  AM-ZIP-PLUS4                  PIC X(4).
  1422     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1423         16  AM-CAN-POSTAL-1               PIC XXX.
  1424         16  AM-CAN-POSTAL-2               PIC XXX.
  1425         16  FILLER                        PIC XXX.
  1426     12  AM-TEL-NO.
  1427         16  AM-AREA-CODE                  PIC 999.
  1428         16  AM-TEL-PRE                    PIC 999.
  1429         16  AM-TEL-NBR                    PIC 9(4).
  1430     12  AM-TEL-LOC                        PIC X.
  1431         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1432         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1433
  1434     12  AM-COMM-STRUCTURE.
  1435         16  AM-DEFN-1.
  1436             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1437                 24  AM-AGT.
  1438                     28  AM-AGT-PREFIX     PIC X(4).
  1439                     28  AM-AGT-PRIME      PIC X(6).
  1440                 24  AM-COM-TYP            PIC X.
  1441                 24  AM-L-COM              PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  28
* EL6311.cbl
  1442                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1443                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1444                 24  AM-RECALC-LV-INDIC    PIC X.
  1445                 24  AM-RETRO-LV-INDIC     PIC X.
  1446                 24  AM-GL-CODES           PIC X.
  1447                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1448                 24  FILLER                PIC X(01).
  1449         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1450             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1451                 24  FILLER                PIC X(11).
  1452                 24  AM-L-COMA             PIC XXX.
  1453                 24  AM-J-COMA             PIC XXX.
  1454                 24  AM-A-COMA             PIC XXX.
  1455                 24  FILLER                PIC X(6).
  1456
  1457     12  AM-COMM-CHANGE-STATUS             PIC X.
  1458         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1459
  1460     12  AM-CSR-CODE                       PIC X(4).
  1461
  1462     12  AM-BILLING-STATUS                 PIC X.
  1463         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1464         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1465     12  AM-AUTO-REFUND-SW                 PIC X.
  1466         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1467         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1468     12  AM-GPCD                           PIC 99.
  1469     12  AM-IG                             PIC X.
  1470         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1471         88  AM-HAS-GROUP                     VALUE '2'.
  1472     12  AM-STATUS                         PIC X.
  1473         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1474         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1475         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1476         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1477         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1478         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1479     12  AM-REMIT-TO                       PIC 99.
  1480     12  AM-ID-NO                          PIC X(11).
  1481
  1482     12  AM-CAL-TABLE                      PIC XX.
  1483     12  AM-LF-DEVIATION                   PIC XXX.
  1484     12  AM-AH-DEVIATION                   PIC XXX.
  1485     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1486     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1487     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1488     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1489     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1490     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1491
  1492     12  AM-USER-FIELDS.
  1493         16  AM-FLD-1                      PIC XX.
  1494         16  AM-FLD-2                      PIC XX.
  1495         16  AM-FLD-3                      PIC XX.
  1496         16  AM-FLD-4                      PIC XX.
  1497         16  AM-FLD-5                      PIC XX.
  1498
  1499     12  AM-1ST-PROD-DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  29
* EL6311.cbl
  1500         16  AM-1ST-PROD-YR                PIC XX.
  1501         16  AM-1ST-PROD-MO                PIC XX.
  1502         16  AM-1ST-PROD-DA                PIC XX.
  1503     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1504     12  AM-CERTS-PURGED-DATE.
  1505         16  AM-PUR-YR                     PIC XX.
  1506         16  AM-PUR-MO                     PIC XX.
  1507         16  AM-PUR-DA                     PIC XX.
  1508     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1509     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1510     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1511     12  AM-INACTIVE-DATE.
  1512         16  AM-INA-MO                     PIC 99.
  1513         16  AM-INA-DA                     PIC 99.
  1514         16  AM-INA-YR                     PIC 99.
  1515     12  AM-AR-HI-CERT-DATE                PIC XX.
  1516
  1517     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1518     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1519
  1520     12  AM-OB-PAYMENT-MODE                PIC X.
  1521         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1522         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1523         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1524         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1525
  1526     12  AM-AH-ONLY-INDICATOR              PIC X.
  1527         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1528         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1529
  1530     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1531
  1532     12  AM-OVER-SHORT.
  1533         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1534         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1535
  1536     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1537     12  AM-DCC-CLP-STATE                  PIC XX.
  1538
  1539     12  AM-RECALC-COMM                    PIC X.
  1540     12  AM-RECALC-REIN                    PIC X.
  1541
  1542     12  AM-REI-TABLE                      PIC XXX.
  1543     12  AM-REI-ET-LF                      PIC X.
  1544     12  AM-REI-ET-AH                      PIC X.
  1545     12  AM-REI-PE-LF                      PIC X.
  1546     12  AM-REI-PE-AH                      PIC X.
  1547     12  AM-REI-PRT-ST                     PIC X.
  1548     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1549     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1550     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1551     12  AM-REI-GROUP-A                    PIC X(6).
  1552     12  AM-REI-MORT                       PIC X(4).
  1553     12  AM-REI-PRT-OW                     PIC X.
  1554     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1555     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1556     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1557     12  AM-REI-GROUP-B                    PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  30
* EL6311.cbl
  1558
  1559     12  AM-TRUST-TYPE                     PIC X(2).
  1560
  1561     12  AM-EMPLOYER-STMT-USED             PIC X.
  1562     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1563
  1564     12  AM-STD-AH-TYPE                    PIC XX.
  1565     12  AM-EARN-METHODS.
  1566         16  AM-EARN-METHOD-R              PIC X.
  1567             88 AM-REF-RL-R78                 VALUE 'R'.
  1568             88 AM-REF-RL-PR                  VALUE 'P'.
  1569             88 AM-REF-RL-MEAN                VALUE 'M'.
  1570             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1571         16  AM-EARN-METHOD-L              PIC X.
  1572             88 AM-REF-LL-R78                 VALUE 'R'.
  1573             88 AM-REF-LL-PR                  VALUE 'P'.
  1574             88 AM-REF-LL-MEAN                VALUE 'M'.
  1575             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1576         16  AM-EARN-METHOD-A              PIC X.
  1577             88 AM-REF-AH-R78                 VALUE 'R'.
  1578             88 AM-REF-AH-PR                  VALUE 'P'.
  1579             88 AM-REF-AH-MEAN                VALUE 'M'.
  1580             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1581             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1582             88 AM-REF-AH-NET                 VALUE 'N'.
  1583
  1584     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1585     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1586     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1587
  1588     12  AM-RET-Y-N                        PIC X.
  1589     12  AM-RET-P-E                        PIC X.
  1590     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1591     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1592     12  AM-RET-GRP                        PIC X(6).
  1593     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1594         16  AM-POOL-PRIME                 PIC XXX.
  1595         16  AM-POOL-SUB                   PIC XXX.
  1596     12  AM-RETRO-EARNINGS.
  1597         16  AM-RET-EARN-R                 PIC X.
  1598         16  AM-RET-EARN-L                 PIC X.
  1599         16  AM-RET-EARN-A                 PIC X.
  1600     12  AM-RET-ST-TAX-USE                 PIC X.
  1601         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1602         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1603     12  AM-RETRO-BEG-EARNINGS.
  1604         16  AM-RET-BEG-EARN-R             PIC X.
  1605         16  AM-RET-BEG-EARN-L             PIC X.
  1606         16  AM-RET-BEG-EARN-A             PIC X.
  1607     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1608     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1609
  1610     12  AM-USER-SELECT-OPTIONS.
  1611         16  AM-USER-SELECT-1              PIC X(10).
  1612         16  AM-USER-SELECT-2              PIC X(10).
  1613         16  AM-USER-SELECT-3              PIC X(10).
  1614         16  AM-USER-SELECT-4              PIC X(10).
  1615         16  AM-USER-SELECT-5              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  31
* EL6311.cbl
  1616
  1617     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1618
  1619     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1620
  1621     12  AM-RPT045A-SWITCH                 PIC X.
  1622         88  RPT045A-OFF                   VALUE 'N'.
  1623
  1624     12  AM-INSURANCE-LIMITS.
  1625         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1626         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1627
  1628     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1629         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1630
  1631     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1632         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1633         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1634
  1635     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1636
  1637     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1638     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1639     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1640     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1641     12  AM-DCC-UEF-STATE                  PIC XX.
  1642     12  FILLER                            PIC XXX.
  1643     12  AM-REPORT-CODE-3                  PIC X(10).
  1644*    12  FILLER                            PIC X(22).
  1645
  1646     12  AM-RESERVE-DATE.
  1647         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1648         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1649         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1650
  1651     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1652     12  AM-NOTIFICATION-TYPES.
  1653         16  AM-NOTIF-OF-LETTERS           PIC X.
  1654         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1655         16  AM-NOTIF-OF-REPORTS           PIC X.
  1656         16  AM-NOTIF-OF-STATUS            PIC X.
  1657
  1658     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1659         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1660         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1661         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1662         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1663
  1664     12  AM-BENEFIT-CONTROLS.
  1665         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1666             20  AM-BENEFIT-CODE           PIC XX.
  1667             20  AM-BENEFIT-TYPE           PIC X.
  1668             20  AM-BENEFIT-REVISION       PIC XXX.
  1669             20  AM-BENEFIT-REM-TERM       PIC X.
  1670             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1671             20  FILLER                    PIC XX.
  1672         16  FILLER                        PIC X(80).
  1673
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  32
* EL6311.cbl
  1674     12  AM-TRANSFER-DATA.
  1675         16  AM-TRANSFERRED-FROM.
  1676             20  AM-TRNFROM-CARRIER        PIC X.
  1677             20  AM-TRNFROM-GROUPING.
  1678                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1679                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1680             20  AM-TRNFROM-STATE          PIC XX.
  1681             20  AM-TRNFROM-ACCOUNT.
  1682                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1683                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1684             20  AM-TRNFROM-DTE            PIC XX.
  1685         16  AM-TRANSFERRED-TO.
  1686             20  AM-TRNTO-CARRIER          PIC X.
  1687             20  AM-TRNTO-GROUPING.
  1688                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1689                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1690             20  AM-TRNTO-STATE            PIC XX.
  1691             20  AM-TRNTO-ACCOUNT.
  1692                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1693                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1694             20  AM-TRNTO-DTE              PIC XX.
  1695         16  FILLER                        PIC X(10).
  1696
  1697     12  AM-SAVED-REMIT-TO                 PIC 99.
  1698
  1699     12  AM-COMM-STRUCTURE-SAVED.
  1700         16  AM-DEFN-1-SAVED.
  1701             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1702                 24  AM-AGT-SV             PIC X(10).
  1703                 24  AM-COM-TYP-SV         PIC X.
  1704                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1705                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1706                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1707                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1708                 24  FILLER                PIC X.
  1709                 24  AM-GL-CODES-SV        PIC X.
  1710                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1711                 24  FILLER                PIC X.
  1712         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1713             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1714                 24  FILLER                PIC X(11).
  1715                 24  AM-L-COMA-SV          PIC XXX.
  1716                 24  AM-J-COMA-SV          PIC XXX.
  1717                 24  AM-A-COMA-SV          PIC XXX.
  1718                 24  FILLER                PIC X(6).
  1719
  1720     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1721         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1722            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1723            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1724            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1725
  1726     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1727     12  FILLER                            PIC X(120).
  1728
  1729     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1730         16  AM-CONTROL-NAME               PIC X(30).
  1731         16  AM-EXECUTIVE-ONE.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  33
* EL6311.cbl
  1732             20  AM-EXEC1-NAME             PIC X(15).
  1733             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1734                                                          COMP-3.
  1735             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1736                                                          COMP-3.
  1737         16  AM-EXECUTIVE-TWO.
  1738             20  AM-EXEC2-NAME             PIC X(15).
  1739             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1740                                                          COMP-3.
  1741             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1742                                                          COMP-3.
  1743
  1744     12  AM-RETRO-ADDITIONAL-DATA.
  1745         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1746         16  AM-RETRO-PREM-P-E             PIC X.
  1747         16  AM-RETRO-CLMS-P-I             PIC X.
  1748         16  AM-RETRO-RET-BRACKET-LF.
  1749             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1750                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1751                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1752             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1753                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1754                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1755             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1756                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1757                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1758         16  AM-RETRO-RET-BRACKET-AH.
  1759             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1760                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1761                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1762                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1763             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1764                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1765                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1766             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1767                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1768                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1769
  1770     12  AM-COMMENTS.
  1771         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1772
  1773     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1774         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1775         16  AM-FLI-BILLING-CODE           PIC X.
  1776         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1777         16  AM-FLI-UNITED-IDENT           PIC X.
  1778         16  AM-FLI-INTEREST-LOST-DATA.
  1779             20  AM-FLI-BANK-NO            PIC X(5).
  1780             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1781             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1782             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1783         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1784             20  AM-FLI-AGT                PIC X(9).
  1785             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1786             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1787         16  FILLER                        PIC X(102).
  1788
  1789     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  34
* EL6311.cbl
  1790         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1791             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1792             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1793             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1794             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1795             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1796         16  FILLER                          PIC X(10).
  1797******************************************************************
  1798*                                COPY ELCVADS.
  1799******************************************************************
  1800*                                                                *
  1801*                                                                *
  1802*                            ELCVADS.                            *
  1803*                                                                *
  1804*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1805*   ELVADS                  LENGTH = 350                         *
  1806******************************************************************
  1807******************************************************************
  1808*                   C H A N G E   L O G
  1809*
  1810* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1811*-----------------------------------------------------------------
  1812*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1813* EFFECTIVE    NUMBER
  1814*-----------------------------------------------------------------
  1815* 100111    2011022800001  AJRA  NAPERSOFT
  1816******************************************************************
  1817
  1818 01  VIRGINIA-DISCLOSURE.
  1819     12  VD-COMPANY-CD              PIC X.
  1820     12  VD-CARRIER                 PIC X.
  1821     12  VD-GROUPING.
  1822         20  VD-GROUPING-PREFIX     PIC XXX.
  1823         20  VD-GROUPING-PRIME      PIC XXX.
  1824     12  VD-STATE                   PIC XX.
  1825     12  VD-ACCOUNT.
  1826         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1827         20  VD-ACCOUNT-PRIME       PIC X(6).
  1828     12  VD-CERT-EFF-DT             PIC XX.
  1829     12  VD-CERT-NO.
  1830         20  VD-CERT-PRIME          PIC X(10).
  1831         20  VD-CERT-SFX            PIC X.
  1832     12  VD-ENTRY-BATCH             PIC X(6).
  1833     12  VD-CSR-ID                  PIC X(4).
  1834     12  VD-NAME.
  1835         20  VD-INSURED-LAST-NAME   PIC X(15).
  1836         20  VD-INSURED-FIRST-NAME.
  1837             24  VD-INSURED-1ST-INIT PIC X.
  1838             24  FILLER             PIC X(9).
  1839         20  VD-INSURED-MIDDLE-INIT PIC X.
  1840     12  VD-JOINT-INSURED.
  1841         20 VD-JOINT-LAST-NAME      PIC X(15).
  1842         20 VD-JOINT-FIRST-NAME.
  1843            24  VD-JOINT-FIRST-INIT PIC X.
  1844            24  FILLER              PIC X(9).
  1845         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1846     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1847     12  VD-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  35
* EL6311.cbl
  1848     12  VD-INSURED-CITY-STATE.
  1849         20  VD-INSURED-CITY        PIC X(28).
  1850         20  VD-INSURED-STATE       PIC XX.
  1851     12  VD-INSURED-ZIP-CODE.
  1852         20  VD-INSURED-ZIP-PRIME.
  1853             24  VD-INSURED-ZIP-1   PIC X.
  1854                 88  VD-CANADIAN-POST-CODE
  1855                                       VALUE 'A' THRU 'Z'.
  1856             24  FILLER             PIC X(4).
  1857         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1858     12  VD-BENEFICIARY-NAME        PIC X(30).
  1859     12  VD-ACCOUNT-NAME            PIC X(30).
  1860     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1861     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1862     12  VD-1ST-PMT-DT              PIC XX.
  1863     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1864         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1865         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1866                                             '90' THRU '99'.
  1867     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1868                                    PIC XX.
  1869     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1870     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1871     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1872     12  VD-LF-TERM                 PIC S999   COMP-3.
  1873     12  VD-AH-BENEFIT-CD           PIC XX.
  1874         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1875         88  VD-INVALID-AH             VALUE '  ' '00'
  1876                                             '90' THRU '99'.
  1877     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1878     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1879     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1880     12  VD-AH-TERM                 PIC S999   COMP-3.
  1881     12  VD-LETTER-ID               PIC X(4).
  1882     12  VD-PROC-ID                 PIC X(4).
  1883     12  VD-COMP-ID                 PIC X(3).
  1884     12  VD-CURRENT-DATE            PIC XX.
  1885     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1886     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1887     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  36
* EL6311.cbl
  1889*    COPY ELCDATE.
  1890******************************************************************
  1891*                                                                *
  1892*                                                                *
  1893*                            ELCDATE.                            *
  1894*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1895*                            VMOD=2.003
  1896*                                                                *
  1897*                                                                *
  1898*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1899*                 LENGTH = 200                                   *
  1900******************************************************************
  1901
  1902 01  DATE-CONVERSION-DATA.
  1903     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1904     12  DC-OPTION-CODE                PIC X.
  1905         88  BIN-TO-GREG                VALUE ' '.
  1906         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1907         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1908         88  YMD-GREG-TO-BIN            VALUE '3'.
  1909         88  MDY-GREG-TO-BIN            VALUE '4'.
  1910         88  JULIAN-TO-BIN              VALUE '5'.
  1911         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1912         88  FIND-CENTURY               VALUE '7'.
  1913         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1914         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1915         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1916         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1917         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1918         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1919         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1920         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1921         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1922         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1923         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1924         88  BIN-3-TO-GREG              VALUE 'I'.
  1925         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1926         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1927         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1928         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1929         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1930         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1931         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1932         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1933         88  THREE-CHARACTER-BIN
  1934                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1935         88  GREGORIAN-TO-BIN
  1936                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1937         88  BIN-TO-GREGORIAN
  1938                  VALUES ' ' '1' 'I' '8' 'G'.
  1939         88  JULIAN-TO-BINARY
  1940                  VALUES '5' 'C' 'E' 'F'.
  1941     12  DC-ERROR-CODE                 PIC X.
  1942         88  NO-CONVERSION-ERROR        VALUE ' '.
  1943         88  DATE-CONVERSION-ERROR
  1944                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1945         88  DATE-IS-ZERO               VALUE '1'.
  1946         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  37
* EL6311.cbl
  1947         88  DATE-IS-INVALID            VALUE '3'.
  1948         88  DATE1-GREATER-DATE2        VALUE '4'.
  1949         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1950         88  DATE-INVALID-OPTION        VALUE '9'.
  1951         88  INVALID-CENTURY            VALUE 'A'.
  1952         88  ONLY-CENTURY               VALUE 'B'.
  1953         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1954         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1955     12  DC-END-OF-MONTH               PIC X.
  1956         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1957     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1958         88  USE-NORMAL-PROCESS         VALUE ' '.
  1959         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1960         88  ADJUST-UP-100-YRS          VALUE '2'.
  1961     12  FILLER                        PIC X.
  1962     12  DC-CONVERSION-DATES.
  1963         16  DC-BIN-DATE-1             PIC XX.
  1964         16  DC-BIN-DATE-2             PIC XX.
  1965         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1966         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1967                       DC-GREG-DATE-1-EDIT.
  1968             20  DC-EDIT1-MONTH        PIC 99.
  1969             20  SLASH1-1              PIC X.
  1970             20  DC-EDIT1-DAY          PIC 99.
  1971             20  SLASH1-2              PIC X.
  1972             20  DC-EDIT1-YEAR         PIC 99.
  1973         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1974         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1975                     DC-GREG-DATE-2-EDIT.
  1976             20  DC-EDIT2-MONTH        PIC 99.
  1977             20  SLASH2-1              PIC X.
  1978             20  DC-EDIT2-DAY          PIC 99.
  1979             20  SLASH2-2              PIC X.
  1980             20  DC-EDIT2-YEAR         PIC 99.
  1981         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1982         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1983                     DC-GREG-DATE-1-YMD.
  1984             20  DC-YMD-YEAR           PIC 99.
  1985             20  DC-YMD-MONTH          PIC 99.
  1986             20  DC-YMD-DAY            PIC 99.
  1987         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1988         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1989                      DC-GREG-DATE-1-MDY.
  1990             20  DC-MDY-MONTH          PIC 99.
  1991             20  DC-MDY-DAY            PIC 99.
  1992             20  DC-MDY-YEAR           PIC 99.
  1993         16  DC-GREG-DATE-1-ALPHA.
  1994             20  DC-ALPHA-MONTH        PIC X(10).
  1995             20  DC-ALPHA-DAY          PIC 99.
  1996             20  FILLER                PIC XX.
  1997             20  DC-ALPHA-CENTURY.
  1998                 24 DC-ALPHA-CEN-N     PIC 99.
  1999             20  DC-ALPHA-YEAR         PIC 99.
  2000         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2001         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2002         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2003         16  DC-JULIAN-DATE            PIC 9(05).
  2004         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  38
* EL6311.cbl
  2005                                       PIC 9(05).
  2006         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2007             20  DC-JULIAN-YEAR        PIC 99.
  2008             20  DC-JULIAN-DAYS        PIC 999.
  2009         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2010         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2011         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2012     12  DATE-CONVERSION-VARIBLES.
  2013         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2014         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2015             20  FILLER                PIC 9(3).
  2016             20  HOLD-CEN-1-CCYY.
  2017                 24  HOLD-CEN-1-CC     PIC 99.
  2018                 24  HOLD-CEN-1-YY     PIC 99.
  2019             20  HOLD-CEN-1-MO         PIC 99.
  2020             20  HOLD-CEN-1-DA         PIC 99.
  2021         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2022             20  HOLD-CEN-1-R-MO       PIC 99.
  2023             20  HOLD-CEN-1-R-DA       PIC 99.
  2024             20  HOLD-CEN-1-R-CCYY.
  2025                 24  HOLD-CEN-1-R-CC   PIC 99.
  2026                 24  HOLD-CEN-1-R-YY   PIC 99.
  2027             20  FILLER                PIC 9(3).
  2028         16  HOLD-CENTURY-1-X.
  2029             20  FILLER                PIC X(3)  VALUE SPACES.
  2030             20  HOLD-CEN-1-X-CCYY.
  2031                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2032                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2033             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2034             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2035         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2036             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2037             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2038             20  HOLD-CEN-1-R-X-CCYY.
  2039                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2040                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2041             20  FILLER                PIC XXX.
  2042         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2043         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2044         16  DC-JULIAN-DATE-1          PIC 9(07).
  2045         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2046             20  DC-JULIAN-1-CCYY.
  2047                 24  DC-JULIAN-1-CC    PIC 99.
  2048                 24  DC-JULIAN-1-YR    PIC 99.
  2049             20  DC-JULIAN-DA-1        PIC 999.
  2050         16  DC-JULIAN-DATE-2          PIC 9(07).
  2051         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2052             20  DC-JULIAN-2-CCYY.
  2053                 24  DC-JULIAN-2-CC    PIC 99.
  2054                 24  DC-JULIAN-2-YR    PIC 99.
  2055             20  DC-JULIAN-DA-2        PIC 999.
  2056         16  DC-GREG-DATE-A-EDIT.
  2057             20  DC-EDITA-MONTH        PIC 99.
  2058             20  SLASHA-1              PIC X VALUE '/'.
  2059             20  DC-EDITA-DAY          PIC 99.
  2060             20  SLASHA-2              PIC X VALUE '/'.
  2061             20  DC-EDITA-CCYY.
  2062                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  39
* EL6311.cbl
  2063                 24  DC-EDITA-YEAR     PIC 99.
  2064         16  DC-GREG-DATE-B-EDIT.
  2065             20  DC-EDITB-MONTH        PIC 99.
  2066             20  SLASHB-1              PIC X VALUE '/'.
  2067             20  DC-EDITB-DAY          PIC 99.
  2068             20  SLASHB-2              PIC X VALUE '/'.
  2069             20  DC-EDITB-CCYY.
  2070                 24  DC-EDITB-CENT     PIC 99.
  2071                 24  DC-EDITB-YEAR     PIC 99.
  2072         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2073         16  DC-GREG-DATE-CYMD-R REDEFINES
  2074                              DC-GREG-DATE-CYMD.
  2075             20  DC-CYMD-CEN           PIC 99.
  2076             20  DC-CYMD-YEAR          PIC 99.
  2077             20  DC-CYMD-MONTH         PIC 99.
  2078             20  DC-CYMD-DAY           PIC 99.
  2079         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2080         16  DC-GREG-DATE-MDCY-R REDEFINES
  2081                              DC-GREG-DATE-MDCY.
  2082             20  DC-MDCY-MONTH         PIC 99.
  2083             20  DC-MDCY-DAY           PIC 99.
  2084             20  DC-MDCY-CEN           PIC 99.
  2085             20  DC-MDCY-YEAR          PIC 99.
  2086    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2087        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2088    12  DC-EL310-DATE                  PIC X(21).
  2089    12  FILLER                         PIC X(28).
  2090
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  40
* EL6311.cbl
  2092*    COPY ELCLOGOF.
  2093******************************************************************
  2094*                                                                *
  2095*                                                                *
  2096*                            ELCLOGOF.                           *
  2097*                            VMOD=2.001                          *
  2098*                                                                *
  2099*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2100*                                                                *
  2101******************************************************************
  2102 01  CLASIC-LOGOFF.
  2103     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2104     12  LOGOFF-TEXT.
  2105         16  FILLER          PIC X(5)    VALUE SPACES.
  2106         16  LOGOFF-MSG.
  2107             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2108             20  FILLER      PIC X       VALUE SPACES.
  2109             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2110         16  FILLER          PIC X(80)
  2111           VALUE '* YOU ARE NOW LOGGED OFF'.
  2112         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2113         16  FILLER          PIC X       VALUE QUOTE.
  2114         16  LOGOFF-SYS-MSG  PIC X(17)
  2115           VALUE 'S CLAS-IC SYSTEM '.
  2116     12  TEXT-MESSAGES.
  2117         16  UNACCESS-MSG    PIC X(29)
  2118             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2119         16  PGMIDERR-MSG    PIC X(17)
  2120             VALUE 'PROGRAM NOT FOUND'.
  2121
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  41
* EL6311.cbl
  2123*    COPY ELCATTR.
  2124******************************************************************
  2125*                                                                *
  2126*                            ELCATTR.                            *
  2127*                            VMOD=2.001                          *
  2128*                                                                *
  2129*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2130*                                                                *
  2131*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2132*                                                                *
  2133*                   POS 1   P=PROTECTED                          *
  2134*                           U=UNPROTECTED                        *
  2135*                           S=ASKIP                              *
  2136*                   POS 2   A=ALPHA/NUMERIC                      *
  2137*                           N=NUMERIC                            *
  2138*                   POS 3   N=NORMAL                             *
  2139*                           B=BRIGHT                             *
  2140*                           D=DARK                               *
  2141*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2142*                           OF=MODIFIED DATA TAG OFF             *
  2143*                                                                *
  2144*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2145******************************************************************
  2146 01  ATTRIBUTE-LIST.
  2147     12  AL-PABOF            PIC X       VALUE 'Y'.
  2148     12  AL-PABON            PIC X       VALUE 'Z'.
  2149     12  AL-PADOF            PIC X       VALUE '%'.
  2150     12  AL-PADON            PIC X       VALUE '_'.
  2151     12  AL-PANOF            PIC X       VALUE '-'.
  2152     12  AL-PANON            PIC X       VALUE '/'.
  2153     12  AL-SABOF            PIC X       VALUE '8'.
  2154     12  AL-SABON            PIC X       VALUE '9'.
  2155     12  AL-SADOF            PIC X       VALUE '@'.
  2156     12  AL-SADON            PIC X       VALUE QUOTE.
  2157     12  AL-SANOF            PIC X       VALUE '0'.
  2158     12  AL-SANON            PIC X       VALUE '1'.
  2159     12  AL-UABOF            PIC X       VALUE 'H'.
  2160     12  AL-UABON            PIC X       VALUE 'I'.
  2161     12  AL-UADOF            PIC X       VALUE '<'.
  2162     12  AL-UADON            PIC X       VALUE '('.
  2163     12  AL-UANOF            PIC X       VALUE ' '.
  2164     12  AL-UANON            PIC X       VALUE 'A'.
  2165     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2166     12  AL-UNBON            PIC X       VALUE 'R'.
  2167     12  AL-UNDOF            PIC X       VALUE '*'.
  2168     12  AL-UNDON            PIC X       VALUE ')'.
  2169     12  AL-UNNOF            PIC X       VALUE '&'.
  2170     12  AL-UNNON            PIC X       VALUE 'J'.
  2171
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  42
* EL6311.cbl
  2173*    COPY ELCEMIB.
  2174******************************************************************
  2175*                                                                *
  2176*                                                                *
  2177*                            ELCEMIB.                            *
  2178*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2179*                            VMOD=2.005                          *
  2180*                                                                *
  2181*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2182*                                                                *
  2183******************************************************************
  2184 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2185     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2186     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2187     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2188     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2189     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2190     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2191     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2192     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2193     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2194         88  EMI-NO-ERRORS                    VALUE '1'.
  2195         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2196         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2197     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2198         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2199     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2200         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2201         88  EMI-AREA1-FULL                   VALUE '2'.
  2202     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2203         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2204         88  EMI-AREA2-FULL                   VALUE '2'.
  2205     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2206         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2207         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2208         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2209         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2210         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2211     12  EMI-ERROR-LINES.
  2212         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2213         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2214         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2215         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2216             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2217                 24  EMI-ERR-NUM         PIC X(4).
  2218                 24  EMI-FILLER          PIC X.
  2219                 24  EMI-SEV             PIC X.
  2220                 24  FILLER              PIC X.
  2221             20  FILLER                  PIC X(02).
  2222     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2223         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2224             20  EMI-ERROR-NUMBER    PIC X(4).
  2225             20  EMI-FILL            PIC X.
  2226             20  EMI-SEVERITY        PIC X.
  2227             20  FILLER              PIC X.
  2228             20  EMI-ERROR-TEXT.
  2229                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2230                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  43
* EL6311.cbl
  2231     12  EMI-SEVERITY-SAVE           PIC X.
  2232         88  EMI-NOTE                    VALUE 'N'.
  2233         88  EMI-WARNING                 VALUE 'W'.
  2234         88  EMI-FORCABLE                VALUE 'F'.
  2235         88  EMI-FATAL                   VALUE 'X'.
  2236     12  EMI-MESSAGE-FLAG            PIC X.
  2237         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2238         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2239     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2240     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2241         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2242         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2243         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2244     12  emi-claim-no                pic x(7).
  2245     12  emi-claim-type              pic x(6).
  2246     12  FILLER                      PIC X(124)  VALUE SPACES.
  2247     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2248     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2249     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2250     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2251
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  44
* EL6311.cbl
  2253*    COPY ELCINTF.
  2254******************************************************************
  2255*                                                                *
  2256*                                                                *
  2257*                            ELCINTF.                            *
  2258*                            VMOD=2.017                          *
  2259*                                                                *
  2260*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2261*                                                                *
  2262*       LENGTH = 1024                                            *
  2263*                                                                *
  2264******************************************************************
  2265*                   C H A N G E   L O G
  2266*
  2267* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2268*-----------------------------------------------------------------
  2269*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2270* EFFECTIVE    NUMBER
  2271*-----------------------------------------------------------------
  2272* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2273******************************************************************
  2274 01  PROGRAM-INTERFACE-BLOCK.
  2275     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2276     12  PI-CALLING-PROGRAM              PIC X(8).
  2277     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2278     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2279     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2280     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2281     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2282     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2283     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2284     12  PI-COMPANY-ID                   PIC XXX.
  2285     12  PI-COMPANY-CD                   PIC X.
  2286
  2287     12  PI-COMPANY-PASSWORD             PIC X(8).
  2288
  2289     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2290
  2291     12  PI-CONTROL-IN-PROGRESS.
  2292         16  PI-CARRIER                  PIC X.
  2293         16  PI-GROUPING                 PIC X(6).
  2294         16  PI-STATE                    PIC XX.
  2295         16  PI-ACCOUNT                  PIC X(10).
  2296         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2297                                         PIC X(10).
  2298         16  PI-CLAIM-CERT-GRP.
  2299             20  PI-CLAIM-NO             PIC X(7).
  2300             20  PI-CERT-NO.
  2301                 25  PI-CERT-PRIME       PIC X(10).
  2302                 25  PI-CERT-SFX         PIC X.
  2303             20  PI-CERT-EFF-DT          PIC XX.
  2304         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2305             20  PI-PLAN-CODE            PIC X(2).
  2306             20  PI-REVISION-NUMBER      PIC X(3).
  2307             20  PI-PLAN-EFF-DT          PIC X(2).
  2308             20  PI-PLAN-EXP-DT          PIC X(2).
  2309             20  FILLER                  PIC X(11).
  2310         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  45
* EL6311.cbl
  2311             20  PI-OE-REFERENCE-1.
  2312                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2313                 25  PI-OE-REF-1-SUFF    PIC XX.
  2314
  2315     12  PI-SESSION-IN-PROGRESS          PIC X.
  2316         88  CLAIM-SESSION                   VALUE '1'.
  2317         88  CREDIT-SESSION                  VALUE '2'.
  2318         88  WARRANTY-SESSION                VALUE '3'.
  2319         88  MORTGAGE-SESSION                VALUE '4'.
  2320         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2321
  2322
  2323*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2324
  2325     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2326     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2327
  2328     12  PI-CREDIT-USER                  PIC X.
  2329         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2330         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2331
  2332     12  PI-CLAIM-USER                   PIC X.
  2333         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2334         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2335
  2336     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2337         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2338         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2339         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2340         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2341         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2342
  2343     12  PI-PROCESSOR-ID                 PIC X(4).
  2344
  2345     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2346
  2347     12  PI-MEMBER-CAPTION               PIC X(10).
  2348
  2349     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2350         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2351
  2352     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2353     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2354     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2355     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2356
  2357     12  PI-AH-OVERRIDE-L1               PIC X.
  2358     12  PI-AH-OVERRIDE-L2               PIC XX.
  2359     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2360     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2361
  2362     12  PI-NEW-SYSTEM                   PIC X(2).
  2363
  2364     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2365     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2366         88  PI-USES-PAID-TO                 VALUE '1'.
  2367     12  PI-CRDTCRD-SYSTEM.
  2368         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  46
* EL6311.cbl
  2369             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2370             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2371         16  PI-CC-MONTH-END-DT          PIC XX.
  2372     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2373
  2374     12  PI-OE-REFERENCE-2.
  2375         16  PI-OE-REF-2-PRIME           PIC X(10).
  2376         16  PI-OE-REF-2-SUFF            PIC X.
  2377
  2378     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2379
  2380     12  PI-LANGUAGE-TYPE                PIC X.
  2381             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2382             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2383             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2384
  2385     12  PI-POLICY-LINKAGE-IND           PIC X.
  2386         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2387         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2388                                                   LOW-VALUES.
  2389
  2390     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2391     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2392         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2393         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2394
  2395     12  PI-PROCESSOR-CSR-IND            PIC X.
  2396         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2397         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2398
  2399     12  FILLER                          PIC X(3).
  2400
  2401     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2402
  2403     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2404         PI-SYSTEM-LEVEL.
  2405
  2406         16  PI-ENTRY-CODES.
  2407             20  PI-ENTRY-CD-1           PIC X.
  2408             20  PI-ENTRY-CD-2           PIC X.
  2409
  2410         16  PI-RETURN-CODES.
  2411             20  PI-RETURN-CD-1          PIC X.
  2412             20  PI-RETURN-CD-2          PIC X.
  2413
  2414         16  PI-UPDATE-STATUS-SAVE.
  2415             20  PI-UPDATE-BY            PIC X(4).
  2416             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2417
  2418         16  PI-LOWER-CASE-LETTERS       PIC X.
  2419             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2420
  2421*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2422*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2423*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2424
  2425         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2426             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  47
* EL6311.cbl
  2427             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2428             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2429             88  ACCNT-CNTL                  VALUE '3'.
  2430             88  CARR-ACCNT-CNTL             VALUE '4'.
  2431
  2432         16  PI-PROCESSOR-CAP-LIST.
  2433             20  PI-SYSTEM-CONTROLS.
  2434                24 PI-SYSTEM-DISPLAY     PIC X.
  2435                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2436                24 PI-SYSTEM-MODIFY      PIC X.
  2437                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2438             20  FILLER                  PIC XX.
  2439             20  PI-DISPLAY-CAP          PIC X.
  2440                 88  DISPLAY-CAP             VALUE 'Y'.
  2441             20  PI-MODIFY-CAP           PIC X.
  2442                 88  MODIFY-CAP              VALUE 'Y'.
  2443             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2444                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2445             20  PI-FORCE-CAP            PIC X.
  2446                 88  FORCE-CAP               VALUE 'Y'.
  2447
  2448         16  PI-PROGRAM-CONTROLS.
  2449             20  PI-PGM-PRINT-OPT        PIC X.
  2450             20  PI-PGM-FORMAT-OPT       PIC X.
  2451             20  PI-PGM-PROCESS-OPT      PIC X.
  2452             20  PI-PGM-TOTALS-OPT       PIC X.
  2453
  2454         16  PI-HELP-INTERFACE.
  2455             20  PI-LAST-ERROR-NO        PIC X(4).
  2456             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2457
  2458         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2459             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2460
  2461         16  PI-CR-CONTROL-IN-PROGRESS.
  2462             20  PI-CR-CARRIER           PIC X.
  2463             20  PI-CR-GROUPING          PIC X(6).
  2464             20  PI-CR-STATE             PIC XX.
  2465             20  PI-CR-ACCOUNT           PIC X(10).
  2466             20  PI-CR-FIN-RESP          PIC X(10).
  2467             20  PI-CR-TYPE              PIC X.
  2468
  2469         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2470
  2471         16  PI-CR-MONTH-END-DT          PIC XX.
  2472
  2473         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2474             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2475             88  PI-ZERO-CARRIER             VALUE '1'.
  2476             88  PI-ZERO-GROUPING            VALUE '2'.
  2477             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2478
  2479         16  PI-CARRIER-SECURITY         PIC X.
  2480             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2481
  2482         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2483             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2484             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  48
* EL6311.cbl
  2485
  2486         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2487             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2488                                         INDEXED BY PI-ACCESS-NDX
  2489                                         PIC X.
  2490
  2491         16  PI-GA-BILLING-CONTROL       PIC X.
  2492             88  PI-GA-BILLING               VALUE '1'.
  2493
  2494         16  PI-MAIL-PROCESSING          PIC X.
  2495             88  PI-MAIL-YES                 VALUE 'Y'.
  2496
  2497         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2498
  2499         16  PI-AR-SYSTEM.
  2500             20  PI-AR-PROCESSING-CNTL   PIC X.
  2501                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2502             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2503             20  PI-AR-MONTH-END-DT      PIC XX.
  2504
  2505         16  PI-MP-SYSTEM.
  2506             20  PI-MORTGAGE-USER            PIC X.
  2507                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2508                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2509             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2510                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2511                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2512                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2513                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2514                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2515             20  PI-MP-MONTH-END-DT          PIC XX.
  2516             20  PI-MP-REFERENCE-NO.
  2517                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2518                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2519
  2520         16  PI-LABEL-CONTROL            PIC X(01).
  2521             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2522             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2523
  2524         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2525             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2526
  2527         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2528             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2529             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2530
  2531         16  FILLER                      PIC X(14).
  2532
  2533     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2534******************************************************************
  2535
  2536     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2537*    COPY ELC631PI.
  2538******************************************************************
  2539*                                                                *
  2540*                                                                *
  2541*                            ELC631PI                            *
  2542*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  49
* EL6311.cbl
  2543*                                                                *
  2544*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2545*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2546*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2547*                                                                *
  2548*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2549*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2550*    BETWEEN PROGRAMS.                                           *
  2551*                                                                *
  2552*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2553*                                                                *
  2554*               EL631 - EL6311 - EL6312 - EL6313                 *
  2555*                                                                *
  2556******************************************************************
  2557*                   C H A N G E   L O G
  2558*
  2559* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2560*-----------------------------------------------------------------
  2561*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2562* EFFECTIVE    NUMBER
  2563*-----------------------------------------------------------------
  2564* 021414    2003053000001  PEMA  changes for auto chk request
  2565******************************************************************
  2566
  2567         16  PI-631-DATA.
  2568             20  PI-ERPNDB-KEY.
  2569                 24  PI-PB-COMPANY-CD     PIC X.
  2570                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2571                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2572                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2573
  2574             20  PI-ERPNDB-ALT-KEY.
  2575                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2576                 24  PI-PB-CARRIER        PIC X.
  2577                 24  PI-PB-GROUPING       PIC X(6).
  2578                 24  PI-PB-STATE          PIC XX.
  2579                 24  PI-PB-ACCOUNT        PIC X(10).
  2580                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2581                 24  PI-PB-CERT-NO.
  2582                     28  PI-PB-CERT-PRIME PIC X(10).
  2583                     28  PI-PB-CERT-SFX   PIC X.
  2584                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2585                 24  PI-PB-RECORD-TYPE    PIC X.
  2586
  2587             20  PI-ERPNDB-CSR-KEY.
  2588                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2589                 24  PI-PB-CSR-ID             PIC X(4).
  2590                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2591                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2592                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2593
  2594             20  PI-BROWSE-TYPE               PIC X.
  2595                 88  PI-FILE-BROWSE             VALUE ' '.
  2596                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2597                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2598                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2599                 88  PI-CSR-BROWSE              VALUE '4'.
  2600
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  50
* EL6311.cbl
  2601             20  PI-MAINT-FUNCTION            PIC X.
  2602                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2603                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2604                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2605                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2606                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2607                 88  PI-PF5-FUNCTION            VALUE '5'.
  2608                 88  PI-PF6-FUNCTION            VALUE '6'.
  2609
  2610             20  PI-FILE-SWITCHES.
  2611                 24  PI-ALL-ISSUES-SW         PIC X.
  2612                     88  ALL-ISSUES             VALUE 'Y'.
  2613                 24  PI-ALL-CANCELS-SW        PIC X.
  2614                     88  ALL-CANCELS            VALUE 'Y'.
  2615                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2616                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2617                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2618                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2619                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2620                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2621                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2622                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2623                 24  PI-HOLD-REC-SW           PIC X.
  2624                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2625                 24  PI-CHANGE-REC-SW         PIC X.
  2626                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2627                 24  PI-CHK-REQ-REC-SW        PIC X.
  2628                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2629                 24  PI-ISSUE-WARNING-SW      PIC X.
  2630                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2631                 24  PI-CANCEL-WARNING-SW     PIC X.
  2632                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2633             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2634                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2635             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2636                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2637
  2638             20  PI-MAP-NAME                  PIC X(8).
  2639
  2640             20  PI-CURSOR                    PIC S9(4) COMP.
  2641
  2642             20  PI-PREV-ALT-KEY              PIC X(36).
  2643             20  PI-PREV-CSR-KEY              PIC X(15).
  2644             20  PI-PREV-KEY.
  2645                 24  PI-PREV-COMPANY-CD       PIC X.
  2646                 24  PI-PREV-BATCH            PIC X(6).
  2647                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2648                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2649             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2650             20  PI-BROWSE-SW                 PIC X.
  2651                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2652                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2653             20  PI-SV-CARRIER                PIC X.
  2654             20  PI-SV-GROUPING               PIC X(6).
  2655             20  PI-SV-STATE                  PIC XX.
  2656             20  PI-EDIT-SW                   PIC X.
  2657             20  PI-DISPLAY-SW                PIC XX.
  2658                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  51
* EL6311.cbl
  2659                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2660             20  PI-CRITERIA-DATA             PIC X(350).
  2661             20  PI-BMODE                     PIC X.
  2662             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2663             20  PI-BPMTS                     PIC S999     COMP-3.
  2664             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2665             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2666             20  PI-CSR-SESSION-SW            PIC X.
  2667                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2668             20  PI-ERRORS-SW                 PIC X.
  2669                 88  FATAL-ERRORS               VALUE 'X'.
  2670*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2671             20  pi-unforced-sw               pic x.
  2672                 88  unforced-errors            value 'X'.
  2673             20  FILLER                       PIC X(4).
  2674
  2675        16  FILLER             PIC X(94).
  2676
  2677 01  W-LETTER-COMMUNICATION-AREAS.
  2678*    COPY ELC1042.
  2679******************************************************************
  2680*                                                                *
  2681*                                                                *
  2682*                           ELC1042                              *
  2683*                            VMOD=2.002                          *
  2684*                                                                *
  2685*    NOTE                                                        *
  2686*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2687*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2688*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2689*        TO THESE PROGRAMS.                                      *
  2690*                                                                *
  2691*    NOTE                                                        *
  2692*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2693*        USE ONLY!                                               *
  2694*                                                                *
  2695******************************************************************
  2696
  2697         16  PI-1042-WA.
  2698             20  PI-ACTION       PIC  X(01).
  2699                 88 PI-SHOW-MODE           VALUE '1'.
  2700                 88 PI-CLEAR-MODE          VALUE '2'.
  2701                 88 PI-CREATE-MODE         VALUE '3'.
  2702             20  PI-COMM-CONTROL PIC  X(12).
  2703             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2704             20  PI-EOF-SW       PIC  X(01).
  2705                 88  PI-FILE-EOF           VALUE 'Y'.
  2706             20  PI-FILETYP      PIC  X(01).
  2707             20  PI-FORM-SQUEEZE-CONTROL
  2708                                 PIC  X(01).
  2709                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2710                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2711             20  PI-LAST-CONTROL PIC  X(12).
  2712             20  PI-TEMP-STOR-ITEMS
  2713                                 PIC S9(04) COMP.
  2714             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2715             20  PI-UPDATE-SW    PIC  9(01).
  2716                 88 ANY-UPDATES            VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  52
* EL6311.cbl
  2717             20  PI-104-SCREEN-SENT-IND
  2718                                 PIC  X(01).
  2719                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2720                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2721             20  PI-1042-SCREEN-SENT-IND
  2722                                 PIC  X(01).
  2723                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2724                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2725             20  PI-1042-ARCHIVE-IND
  2726                                 PIC  X(01).
  2727                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2728             20  FILLER          PIC  X(29).
  2729*    COPY ELC689PI.
  2730******************************************************************
  2731*                                                                *
  2732*                            ELC689PI                            *
  2733*                            VMOD=2.003                          *
  2734*                                                                *
  2735*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2736*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2737*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2738*                                                                *
  2739*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2740*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2741*    BETWEEN PROGRAMS.                                           *
  2742*                                                                *
  2743*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2744*                                                                *
  2745*               EL631 - EL689  - EL6891 - EL6892                 *
  2746*                                                                *
  2747******************************************************************
  2748*                   C H A N G E   L O G
  2749*
  2750* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2751*-----------------------------------------------------------------
  2752*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2753* EFFECTIVE    NUMBER
  2754*-----------------------------------------------------------------
  2755* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2756* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2757* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2758******************************************************************
  2759
  2760
  2761         16  PI-689-WORK-AREA.
  2762             20  PI-689-ALT-PRINTER-ID
  2763                                 PIC  X(04).
  2764             20  PI-689-ARCHIVE-NUMBER
  2765                                 PIC  9(08).
  2766             20  PI-689-ARCHIVE-SW
  2767                                 PIC  X(01).
  2768                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2769             20  PI-689-DATA-SOURCE
  2770                                 PIC  X(01).
  2771                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2772                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2773                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2774                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  53
* EL6311.cbl
  2775                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2776             20  PI-689-ERROR-IND
  2777                                 PIC  X(01).
  2778                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2779             20  PI-689-ERROR    PIC  9(04).
  2780                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2781                 88  PI-689-FATAL-ERROR
  2782                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2783                            0042 0047 0051 0066 0067 0070
  2784                            0168 0169 0174 0175 0176 0177 0179
  2785                            0180 0181 0182 0184 0185 0189 0190
  2786                            0191
  2787                            0215 0279 0280
  2788                            0412 0413 0454
  2789                            0533 0537
  2790                            2055 2114 2208 2209 2216 2232 2369
  2791                            2398 2433 2908 2999
  2792                            3000 3770 3771 3775
  2793                            7250 7365 7367 7368 7369 7370 7371
  2794                            7272 7373 7374 7376 7377 7378 7379
  2795                            7381 7388 7390 7393 7395 7396 7398
  2796                            9095 9096 9281 9298 9299 9320 9327
  2797                            9426 9427.
  2798                 88  PI-689-STOP-ERROR
  2799                     VALUES 0004 0008 0013 0023 0029 0033
  2800                            0042 0047 0066 0067 0070
  2801                            0168 0169 0174 0175 0176 0177
  2802                            0181 0182 0184 0185 0189 0190
  2803                            0279 0280
  2804                            0412 0413 0454
  2805                            2055 2208 2209 2216 2232
  2806                            2398 2999
  2807                            3000 3770 3771 3775
  2808                            7250 7365 7369 7370 7371
  2809                            7272 7373 7374 7376 7377 7378 7379
  2810                            7381 7388 7390 7393 7396 7398
  2811                            9095 9096 9299 9320 9426.
  2812             20  PI-689-FOLLOW-UP-DATE
  2813                                 PIC  X(02).
  2814             20  PI-689-FORM-NUMBER
  2815                                 PIC  X(04).
  2816             20  PI-689-LABEL-SOURCE
  2817                                 PIC X(01).
  2818                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2819                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2820                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2821                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2822                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2823                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2824                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2825             20  PI-689-NUMBER-COPIES
  2826                                 PIC  9(01).
  2827             20  PI-689-NUMBER-LABEL-LINES
  2828                                 PIC  9(01).
  2829             20  PI-689-NUMBER-TEXT-RECORDS
  2830                                 PIC  9(03).
  2831             20  PI-689-PRINT-ORDER-SW
  2832                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  54
* EL6311.cbl
  2833                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2834                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2835                 88  PI-689-PRINT-LATER     VALUE '3'.
  2836                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2837             20  PI-689-PRINT-RESTRICTION
  2838                                 PIC  X(01).
  2839                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2840                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2841                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2842             20  PI-689-PRINT-SW PIC  X(01).
  2843                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2844             20  PI-689-RESEND-DATE-1
  2845                                 PIC  X(02).
  2846             20  PI-689-RESEND-LETR-1
  2847                                 PIC X(4).
  2848             20  PI-689-TEMP-STOR-ID
  2849                                 PIC  X(08).
  2850             20  PI-689-USE-SCREEN-IND
  2851                                 PIC  X(01).
  2852                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2853             20  PI-689-ARCH-POINTER
  2854                                 PIC S9(08) COMP.
  2855                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2856             20  PI-689-ARCT-POINTER
  2857                                 PIC S9(08) COMP.
  2858                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2859             20  PI-689-VARIABLE-DATA-GRP.
  2860                 24  PI-689-VARIABLE-DATA-1
  2861                                 PIC  X(30).
  2862                 24  PI-689-VARIABLE-DATA-2
  2863                                 PIC  X(30).
  2864                 24  PI-689-VARIABLE-DATA-3
  2865                                 PIC  X(30).
  2866                 24  PI-689-VARIABLE-DATA-4
  2867                                 PIC  X(30).
  2868
  2869         16  PI-689-KEY-DATA-FIELDS.
  2870             20  PI-689-ACCOUNT  PIC  X(10).
  2871             20  PI-689-CARRIER  PIC  X(01).
  2872             20  PI-689-CERT-NO.
  2873                 24  PI-689-CERT-PRIME
  2874                                 PIC  X(10).
  2875                 24  PI-689-CERT-SFX
  2876                                 PIC  X(01).
  2877             20  PI-689-CHG-SEQ-NO
  2878                                 PIC S9(04)    COMP.
  2879             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2880                                 PIC  X(02).
  2881             20  PI-689-ENTRY-BATCH
  2882                                 PIC  X(06).
  2883             20  PI-689-EFF-DATE PIC  X(02).
  2884             20  PI-689-EXP-DATE PIC  X(02).
  2885             20  PI-689-GROUPING PIC  X(06).
  2886             20  PI-689-RESP-PERSON
  2887                                 PIC  X(10).
  2888             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2889             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2890                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  55
* EL6311.cbl
  2891             20  PI-689-STATE    PIC  X(02).
  2892             20  PI-689-TYPE     PIC  X(01).
  2893             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2894             20  PI-689-ALT-SEQ-NO
  2895                                 PIC S9(04)    COMP.
  2896         16  PI-689-DATE-EDIT    PIC  X(08).
  2897         16  PI-689-FOLLOW-UP-EDIT
  2898                                 PIC  X(08).
  2899         16  PI-689-RESEND1-EDIT PIC  X(08).
  2900         16  PI-689-SEQ-EDIT     PIC  X(08).
  2901         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2902         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2903             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2904         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2905         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  56
* EL6311.cbl
  2907
  2908 01  WS-EL6315-PASS-AREA.
  2909        16  PI-6315-ISS-CAN-SW      PIC X.
  2910        16  FILLER                  PIC X(120).
  2911        16  PI-RES-REF-CLM-TYPE     PIC X.
  2912        16  FILLER                  PIC X.
  2913        16  PI-6315-PASS-AREA.
  2914            20 FILLER               PIC X(236).
  2915            20 PI-6315-FINALIZED    PIC X.
  2916            20 FILLER               PIC X(280).
  2917
  2918 01  WS-EL6316-PASS-AREA.
  2919        16  PI-ISS-CAN-SW           PIC X.
  2920        16  FILLER                  PIC X(121).
  2921        16  PI-CLM-RESC-IND         PIC X.
  2922        16  PI-6316-PASS-AREA.
  2923            20 FILLER               PIC X(236).
  2924            20 PI-6316-FINALIZED    PIC X.
  2925            20 FILLER               PIC X(280).
  2926
  2927******************************************************************
  2928*                                                                *
  2929*         P A S S   A R E A   F O R   E D I T                    *
  2930*                                                                *
  2931******************************************************************
  2932
  2933 01  PASSED-RECORD.
  2934     12  RECORD-SAVE                  PIC X(585).
  2935* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2936*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2937*                    BY  WK-CURRENT-DATE.
  2938******************************************************************
  2939*                                                                *
  2940*                                                                *
  2941*                             ELC50W1                            *
  2942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2943*                            VMOD=2.004                          *
  2944*                                                                *
  2945*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2946*                                                                *
  2947*                                                                *
  2948******************************************************************
  2949
  2950     12  WK-WORK-AREA.
  2951         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2952         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2953         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2954         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2955         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2956         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2957         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2958         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2959         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2960         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2961         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2962         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2963         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2964         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  57
* EL6311.cbl
  2965         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2966         16  WK-CREDIT-EDIT-CONTROLS.
  2967             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2968             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2969             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2970             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2971             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2972             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2973         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2974         16  WK-SAVE-REIN-DATA.
  2975             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2976             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2977             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2978         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2979             88  ENTRY-FROM-EL6311       VALUE '6'.
  2980         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2981         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2982     12  WK-RECORD-ADDRESSES.
  2983         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2984         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2985         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2986         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2987         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2988         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2989         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2990         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2991     12  WK-OVER-SHORT-AREA.
  2992         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2993         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2994         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2995             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2996         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  58
* EL6311.cbl
  2998
  2999*    COPY ELCEDITC.
  3000******************************************************************
  3001*                                                                *
  3002*                                                                *
  3003*                            ELCEDITC                            *
  3004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3005*                            VMOD=2.012                          *
  3006*                                                                *
  3007*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3008*                     EL6313, EL050 AND EL517.                   *
  3009*                                                                *
  3010******************************************************************
  3011******************************************************************
  3012*                   C H A N G E   L O G
  3013*
  3014* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3015*-----------------------------------------------------------------
  3016*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3017* EFFECTIVE    NUMBER
  3018*-----------------------------------------------------------------
  3019* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3020******************************************************************
  3021
  3022     12  EDIT-CRITERIA-DATA.
  3023         16  EC-CO-MONTH-END-DT       PIC XX.
  3024         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3025         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3026         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3027         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3028         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3029         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3030         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3031         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3032         16  EC-CO-REM-TERM-CALC      PIC X.
  3033               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3034               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3035               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3036               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3037
  3038         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3039               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3040               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3041               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3042               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3043               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3044               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3045               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3046               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3047               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3048               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3049
  3050         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3051               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3052               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3053               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3054               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3055               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  59
* EL6311.cbl
  3056               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3057               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3058               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3059
  3060         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3061                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3062                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3063
  3064         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3065                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3066                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3067                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3068                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3069                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3070                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3071                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3072                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3073
  3074         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3075               88  EC-BR-REDUCING                   VALUE 'R'.
  3076               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3077
  3078         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3079         16  EC-BR-LF-DESC             PIC X(10).
  3080         16  EC-BR-AH-DESC             PIC X(10).
  3081         16  EC-BR-LF-COMMENT          PIC X(10).
  3082         16  EC-BR-AH-COMMENT          PIC X(10).
  3083
  3084         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3085               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3086               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3087               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3088               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3089
  3090         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3091               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3092               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3093               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3094               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3095
  3096         16  EC-BR-LF-REFUND-CALC      PIC X.
  3097                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3098                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3099                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3100                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3101                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3102                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3103                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3104
  3105         16  EC-BR-AH-REFUND-CALC      PIC X.
  3106                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3107                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3108                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3109                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3110                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3111                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3112                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3113                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  60
* EL6311.cbl
  3114
  3115         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3116                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3117                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3118                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3119
  3120         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3121                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3122                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3123                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3124
  3125         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3126         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3127         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3128         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3129
  3130         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3131         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3132                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3133                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3134                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3135                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3136
  3137         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3138               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3139               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3140               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3141               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3142               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3143
  3144         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3145               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3146               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3147               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3148               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3149               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3150
  3151         16  EC-ST-LF-REFUND-CALC      PIC X.
  3152                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3153                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3154                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3155                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3156                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3157                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3158                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3159                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3160
  3161         16  EC-ST-AH-REFUND-CALC      PIC X.
  3162                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3163                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3164                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3165                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3166                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3167                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3168                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3169                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3170
  3171         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  61
* EL6311.cbl
  3172         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3173         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3174         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3175         16  EC-AM-EXPIRATION-DT       PIC XX.
  3176         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3177         16  EC-AM-CLASS-CD            PIC XX.
  3178         16  EC-AM-LF-DEVIATION        PIC XXX.
  3179         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3180         16  EC-AM-AH-DEVIATION        PIC XXX.
  3181         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3182         16  EC-AM-PHONE-NO            PIC X(10).
  3183
  3184         16  EC-AM-LF-REFUND-CALC      PIC X.
  3185                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3186                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3187                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3188                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3189                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3190                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3191                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3192
  3193         16  EC-AM-AH-REFUND-CALC      PIC X.
  3194                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3195                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3196                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3197                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3198                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3199                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3200                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3201
  3202         16  EC-AM-BEN-I-G-CD          PIC X.
  3203                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3204                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3205                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3206
  3207         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3208         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3209         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3210         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3211         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3212         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3213         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3214         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3215         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3216
  3217         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3218         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3219         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3220         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3221         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3222         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3223         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3224         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3225         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3226         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3227         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3228         16  EC-RT-LF-NSP-ST           PIC XX.
  3229         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  62
* EL6311.cbl
  3230         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3231         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3232
  3233         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3234             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3235                                             'M' '5' '9' '2'.
  3236             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3237             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3238             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3239             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3240             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3241             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3242             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3243             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3244             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3245             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3246
  3247         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3248             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3249                                             'M' '5' '9' '2'.
  3250             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3251             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3252             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3253             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3254             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3255             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3256             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3257             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3258             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3259             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3260
  3261         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3262         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3263         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3264         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3265         16  EC-CM-DEATH-DT            PIC XX.
  3266
  3267*DMD CUSTOM CODING FIELDS BELOW
  3268*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3269         16  EC-BR-DMD-RATING-SW       PIC X.
  3270                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3271                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3272                 88  NO-DMD-RATING               VALUE 'N'.
  3273
  3274         16  EC-NEW-CERT               PIC X(11).
  3275         16  EC-NEW-STATE              PIC XX.
  3276         16  FILLER                    PIC X.
  3277*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3278         16  OVER-SHORT-EDIT-FIELDS.
  3279             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3280             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3281             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3282             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3283             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3284             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3285             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3286             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3287             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  63
* EL6311.cbl
  3288         16  FILLER                    PIC X(71).
  3289
  3290******************************************************************
  3291
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  64
* EL6311.cbl
  3293
  3294*    COPY ELCJPFX.
  3295******************************************************************
  3296*                                                                *
  3297*                                                                *
  3298*                            ELCJPFX.                            *
  3299*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3300*                            VMOD=2.002                          *
  3301*                                                                *
  3302*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3303*                                                                *
  3304*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3305*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3306*        ELCNTL - CONTROL FILE                                   *
  3307*        ELMSTR - CLAIM MASTERS                                  *
  3308*        ELTRLR - ACTIVITY TRAILERS                              *
  3309*        ELCHKQ - CHECK QUE                                      *
  3310******************************************************************
  3311 01  JOURNAL-RECORD.
  3312     12  jp-date                     pic s9(5) comp-3.
  3313     12  jp-time                     pic s9(7) comp-3.
  3314     12  JP-USER-ID                  PIC X(4).
  3315     12  JP-FILE-ID                  PIC X(8).
  3316     12  JP-PROGRAM-ID               PIC X(8).
  3317     12  JP-RECORD-TYPE              PIC X.
  3318         88 JP-ADD              VALUE 'A'.
  3319         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3320         88 JP-AFTER-CHANGE     VALUE 'C'.
  3321         88 JP-DELETE           VALUE 'D'.
  3322         88 JP-GENERIC-DELETE   VALUE 'G'.
  3323         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3324         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3325     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3326     12  JP-RECORD-AREA
  3327
  3328
  3329                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  65
* EL6311.cbl
  3331*    COPY ELCAID.
  3332******************************************************************
  3333*                                                                *
  3334*                            ELCAID.                             *
  3335*                            VMOD=2.001                          *
  3336*                                                                *
  3337*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3338*                                                                *
  3339*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3340*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3341******************************************************************
  3342
  3343 01  DFHAID.
  3344   02  DFHNULL   PIC  X  VALUE  ' '.
  3345   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3346   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3347   02  DFHPEN    PIC  X  VALUE  '='.
  3348   02  DFHOPID   PIC  X  VALUE  'W'.
  3349   02  DFHPA1    PIC  X  VALUE  '%'.
  3350   02  DFHPA2    PIC  X  VALUE  '>'.
  3351   02  DFHPA3    PIC  X  VALUE  ','.
  3352   02  DFHPF1    PIC  X  VALUE  '1'.
  3353   02  DFHPF2    PIC  X  VALUE  '2'.
  3354   02  DFHPF3    PIC  X  VALUE  '3'.
  3355   02  DFHPF4    PIC  X  VALUE  '4'.
  3356   02  DFHPF5    PIC  X  VALUE  '5'.
  3357   02  DFHPF6    PIC  X  VALUE  '6'.
  3358   02  DFHPF7    PIC  X  VALUE  '7'.
  3359   02  DFHPF8    PIC  X  VALUE  '8'.
  3360   02  DFHPF9    PIC  X  VALUE  '9'.
  3361   02  DFHPF10   PIC  X  VALUE  ':'.
  3362   02  DFHPF11   PIC  X  VALUE  '#'.
  3363   02  DFHPF12   PIC  X  VALUE  '@'.
  3364   02  DFHPF13   PIC  X  VALUE  'A'.
  3365   02  DFHPF14   PIC  X  VALUE  'B'.
  3366   02  DFHPF15   PIC  X  VALUE  'C'.
  3367   02  DFHPF16   PIC  X  VALUE  'D'.
  3368   02  DFHPF17   PIC  X  VALUE  'E'.
  3369   02  DFHPF18   PIC  X  VALUE  'F'.
  3370   02  DFHPF19   PIC  X  VALUE  'G'.
  3371   02  DFHPF20   PIC  X  VALUE  'H'.
  3372   02  DFHPF21   PIC  X  VALUE  'I'.
  3373*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3374   02  DFHPF22   PIC  X  VALUE  '['.
  3375   02  DFHPF23   PIC  X  VALUE  '.'.
  3376   02  DFHPF24   PIC  X  VALUE  '<'.
  3377   02  DFHMSRE   PIC  X  VALUE  'X'.
  3378   02  DFHSTRF   PIC  X  VALUE  'h'.
  3379   02  DFHTRIG   PIC  X  VALUE  '"'.
  3380
  3381 01  FILLER    REDEFINES DFHAID.
  3382     12  FILLER              PIC X(8).
  3383     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3384
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  66
* EL6311.cbl
  3386*    COPY EL6311S.
  3387 01  EL631BI.
  3388     05  FILLER            PIC  X(0012).
  3389*    -------------------------------
  3390     05  BDATEL PIC S9(0004) COMP.
  3391     05  BDATEF PIC  X(0001).
  3392     05  FILLER REDEFINES BDATEF.
  3393         10  BDATEA PIC  X(0001).
  3394     05  BDATEI PIC  X(0008).
  3395*    -------------------------------
  3396     05  BTIMEL PIC S9(0004) COMP.
  3397     05  BTIMEF PIC  X(0001).
  3398     05  FILLER REDEFINES BTIMEF.
  3399         10  BTIMEA PIC  X(0001).
  3400     05  BTIMEI PIC  X(0005).
  3401*    -------------------------------
  3402     05  BHEADL PIC S9(0004) COMP.
  3403     05  BHEADF PIC  X(0001).
  3404     05  FILLER REDEFINES BHEADF.
  3405         10  BHEADA PIC  X(0001).
  3406     05  BHEADI PIC  X(0038).
  3407*    -------------------------------
  3408     05  BNCERTLL PIC S9(0004) COMP.
  3409     05  BNCERTLF PIC  X(0001).
  3410     05  FILLER REDEFINES BNCERTLF.
  3411         10  BNCERTLA PIC  X(0001).
  3412     05  BNCERTLI PIC  X(0008).
  3413*    -------------------------------
  3414     05  BNCERTL PIC S9(0004) COMP.
  3415     05  BNCERTF PIC  X(0001).
  3416     05  FILLER REDEFINES BNCERTF.
  3417         10  BNCERTA PIC  X(0001).
  3418     05  BNCERTI PIC  X(0011).
  3419*    -------------------------------
  3420     05  BNSTATLL PIC S9(0004) COMP.
  3421     05  BNSTATLF PIC  X(0001).
  3422     05  FILLER REDEFINES BNSTATLF.
  3423         10  BNSTATLA PIC  X(0001).
  3424     05  BNSTATLI PIC  X(0009).
  3425*    -------------------------------
  3426     05  BNSTATL PIC S9(0004) COMP.
  3427     05  BNSTATF PIC  X(0001).
  3428     05  FILLER REDEFINES BNSTATF.
  3429         10  BNSTATA PIC  X(0001).
  3430     05  BNSTATI PIC  X(0002).
  3431*    -------------------------------
  3432     05  BCHGTL PIC S9(0004) COMP.
  3433     05  BCHGTF PIC  X(0001).
  3434     05  FILLER REDEFINES BCHGTF.
  3435         10  BCHGTA PIC  X(0001).
  3436     05  BCHGTI PIC  X(0004).
  3437*    -------------------------------
  3438     05  BCHGL PIC S9(0004) COMP.
  3439     05  BCHGF PIC  X(0001).
  3440     05  FILLER REDEFINES BCHGF.
  3441         10  BCHGA PIC  X(0001).
  3442     05  BCHGI PIC  X(0004).
  3443*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  67
* EL6311.cbl
  3444     05  BCOMPIDL PIC S9(0004) COMP.
  3445     05  BCOMPIDF PIC  X(0001).
  3446     05  FILLER REDEFINES BCOMPIDF.
  3447         10  BCOMPIDA PIC  X(0001).
  3448     05  BCOMPIDI PIC  X(0003).
  3449*    -------------------------------
  3450     05  BREGIONL PIC S9(0004) COMP.
  3451     05  BREGIONF PIC  X(0001).
  3452     05  FILLER REDEFINES BREGIONF.
  3453         10  BREGIONA PIC  X(0001).
  3454     05  BREGIONI PIC  X(0006).
  3455*    -------------------------------
  3456     05  BUSERL PIC S9(0004) COMP.
  3457     05  BUSERF PIC  X(0001).
  3458     05  FILLER REDEFINES BUSERF.
  3459         10  BUSERA PIC  X(0001).
  3460     05  BUSERI PIC  X(0004).
  3461*    -------------------------------
  3462     05  BMAINTL PIC S9(0004) COMP.
  3463     05  BMAINTF PIC  X(0001).
  3464     05  FILLER REDEFINES BMAINTF.
  3465         10  BMAINTA PIC  X(0001).
  3466     05  BMAINTI PIC  X(0001).
  3467*    -------------------------------
  3468     05  BMANTBYL PIC S9(0004) COMP.
  3469     05  BMANTBYF PIC  X(0001).
  3470     05  FILLER REDEFINES BMANTBYF.
  3471         10  BMANTBYA PIC  X(0001).
  3472     05  BMANTBYI PIC  X(0004).
  3473*    -------------------------------
  3474     05  BCHGHDGL PIC S9(0004) COMP.
  3475     05  BCHGHDGF PIC  X(0001).
  3476     05  FILLER REDEFINES BCHGHDGF.
  3477         10  BCHGHDGA PIC  X(0001).
  3478     05  BCHGHDGI PIC  X(0003).
  3479*    -------------------------------
  3480     05  BMANTDTL PIC S9(0004) COMP.
  3481     05  BMANTDTF PIC  X(0001).
  3482     05  FILLER REDEFINES BMANTDTF.
  3483         10  BMANTDTA PIC  X(0001).
  3484     05  BMANTDTI PIC  X(0008).
  3485*    -------------------------------
  3486     05  BMANTATL PIC S9(0004) COMP.
  3487     05  BMANTATF PIC  X(0001).
  3488     05  FILLER REDEFINES BMANTATF.
  3489         10  BMANTATA PIC  X(0001).
  3490     05  BMANTATI PIC  X(0005).
  3491*    -------------------------------
  3492     05  BCSRL PIC S9(0004) COMP.
  3493     05  BCSRF PIC  X(0001).
  3494     05  FILLER REDEFINES BCSRF.
  3495         10  BCSRA PIC  X(0001).
  3496     05  BCSRI PIC  X(0004).
  3497*    -------------------------------
  3498     05  BBATCHL PIC S9(0004) COMP.
  3499     05  BBATCHF PIC  X(0001).
  3500     05  FILLER REDEFINES BBATCHF.
  3501         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  68
* EL6311.cbl
  3502     05  BBATCHI PIC  X(0006).
  3503*    -------------------------------
  3504     05  BSEQL PIC S9(0004) COMP.
  3505     05  BSEQF PIC  X(0001).
  3506     05  FILLER REDEFINES BSEQF.
  3507         10  BSEQA PIC  X(0001).
  3508     05  BSEQI PIC  X(0004).
  3509*    -------------------------------
  3510     05  BMOENDTL PIC S9(0004) COMP.
  3511     05  BMOENDTF PIC  X(0001).
  3512     05  FILLER REDEFINES BMOENDTF.
  3513         10  BMOENDTA PIC  X(0001).
  3514     05  BMOENDTI PIC  X(0008).
  3515*    -------------------------------
  3516     05  BCARRL PIC S9(0004) COMP.
  3517     05  BCARRF PIC  X(0001).
  3518     05  FILLER REDEFINES BCARRF.
  3519         10  BCARRA PIC  X(0001).
  3520     05  BCARRI PIC  X(0001).
  3521*    -------------------------------
  3522     05  BGROUPL PIC S9(0004) COMP.
  3523     05  BGROUPF PIC  X(0001).
  3524     05  FILLER REDEFINES BGROUPF.
  3525         10  BGROUPA PIC  X(0001).
  3526     05  BGROUPI PIC  X(0006).
  3527*    -------------------------------
  3528     05  BSTATEL PIC S9(0004) COMP.
  3529     05  BSTATEF PIC  X(0001).
  3530     05  FILLER REDEFINES BSTATEF.
  3531         10  BSTATEA PIC  X(0001).
  3532     05  BSTATEI PIC  X(0002).
  3533*    -------------------------------
  3534     05  BACCTL PIC S9(0004) COMP.
  3535     05  BACCTF PIC  X(0001).
  3536     05  FILLER REDEFINES BACCTF.
  3537         10  BACCTA PIC  X(0001).
  3538     05  BACCTI PIC  X(0010).
  3539*    -------------------------------
  3540     05  BVINHL PIC S9(0004) COMP.
  3541     05  BVINHF PIC  X(0001).
  3542     05  FILLER REDEFINES BVINHF.
  3543         10  BVINHA PIC  X(0001).
  3544     05  BVINHI PIC  X(0004).
  3545*    -------------------------------
  3546     05  BVINL PIC S9(0004) COMP.
  3547     05  BVINF PIC  X(0001).
  3548     05  FILLER REDEFINES BVINF.
  3549         10  BVINA PIC  X(0001).
  3550     05  BVINI PIC  X(0017).
  3551*    -------------------------------
  3552     05  BREFHDGL PIC S9(0004) COMP.
  3553     05  BREFHDGF PIC  X(0001).
  3554     05  FILLER REDEFINES BREFHDGF.
  3555         10  BREFHDGA PIC  X(0001).
  3556     05  BREFHDGI PIC  X(0004).
  3557*    -------------------------------
  3558     05  BREFL PIC S9(0004) COMP.
  3559     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  69
* EL6311.cbl
  3560     05  FILLER REDEFINES BREFF.
  3561         10  BREFA PIC  X(0001).
  3562     05  BREFI PIC  X(0012).
  3563*    -------------------------------
  3564     05  BAGEDEFL PIC S9(0004) COMP.
  3565     05  BAGEDEFF PIC  X(0001).
  3566     05  FILLER REDEFINES BAGEDEFF.
  3567         10  BAGEDEFA PIC  X(0001).
  3568     05  BAGEDEFI PIC  X(0004).
  3569*    -------------------------------
  3570     05  BCERTNOL PIC S9(0004) COMP.
  3571     05  BCERTNOF PIC  X(0001).
  3572     05  FILLER REDEFINES BCERTNOF.
  3573         10  BCERTNOA PIC  X(0001).
  3574     05  BCERTNOI PIC  X(0010).
  3575*    -------------------------------
  3576     05  BSUFIXL PIC S9(0004) COMP.
  3577     05  BSUFIXF PIC  X(0001).
  3578     05  FILLER REDEFINES BSUFIXF.
  3579         10  BSUFIXA PIC  X(0001).
  3580     05  BSUFIXI PIC  X(0001).
  3581*    -------------------------------
  3582     05  BEFFDTL PIC S9(0004) COMP.
  3583     05  BEFFDTF PIC  X(0001).
  3584     05  FILLER REDEFINES BEFFDTF.
  3585         10  BEFFDTA PIC  X(0001).
  3586     05  BEFFDTI PIC  X(0008).
  3587*    -------------------------------
  3588     05  BLSTNML PIC S9(0004) COMP.
  3589     05  BLSTNMF PIC  X(0001).
  3590     05  FILLER REDEFINES BLSTNMF.
  3591         10  BLSTNMA PIC  X(0001).
  3592     05  BLSTNMI PIC  X(0015).
  3593*    -------------------------------
  3594     05  B1STNML PIC S9(0004) COMP.
  3595     05  B1STNMF PIC  X(0001).
  3596     05  FILLER REDEFINES B1STNMF.
  3597         10  B1STNMA PIC  X(0001).
  3598     05  B1STNMI PIC  X(0010).
  3599*    -------------------------------
  3600     05  BINITL PIC S9(0004) COMP.
  3601     05  BINITF PIC  X(0001).
  3602     05  FILLER REDEFINES BINITF.
  3603         10  BINITA PIC  X(0001).
  3604     05  BINITI PIC  X(0001).
  3605*    -------------------------------
  3606     05  BSEXL PIC S9(0004) COMP.
  3607     05  BSEXF PIC  X(0001).
  3608     05  FILLER REDEFINES BSEXF.
  3609         10  BSEXA PIC  X(0001).
  3610     05  BSEXI PIC  X(0001).
  3611*    -------------------------------
  3612     05  BAGEL PIC S9(0004) COMP.
  3613     05  BAGEF PIC  X(0001).
  3614     05  FILLER REDEFINES BAGEF.
  3615         10  BAGEA PIC  X(0001).
  3616     05  BAGEI PIC  X(0002).
  3617*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  70
* EL6311.cbl
  3618     05  BBIRTHL PIC S9(0004) COMP.
  3619     05  BBIRTHF PIC  X(0001).
  3620     05  FILLER REDEFINES BBIRTHF.
  3621         10  BBIRTHA PIC  X(0001).
  3622     05  BBIRTHI PIC  X(0008).
  3623*    -------------------------------
  3624     05  B1STPMTL PIC S9(0004) COMP.
  3625     05  B1STPMTF PIC  X(0001).
  3626     05  FILLER REDEFINES B1STPMTF.
  3627         10  B1STPMTA PIC  X(0001).
  3628     05  B1STPMTI PIC  X(0008).
  3629*    -------------------------------
  3630     05  BDAYSL PIC S9(0004) COMP.
  3631     05  BDAYSF PIC  X(0001).
  3632     05  FILLER REDEFINES BDAYSF.
  3633         10  BDAYSA PIC  X(0001).
  3634     05  BDAYSI PIC  X(0003).
  3635*    -------------------------------
  3636     05  BLNTRML PIC S9(0004) COMP.
  3637     05  BLNTRMF PIC  X(0001).
  3638     05  FILLER REDEFINES BLNTRMF.
  3639         10  BLNTRMA PIC  X(0001).
  3640     05  BLNTRMI PIC  X(0003).
  3641*    -------------------------------
  3642     05  BLNOFCRL PIC S9(0004) COMP.
  3643     05  BLNOFCRF PIC  X(0001).
  3644     05  FILLER REDEFINES BLNOFCRF.
  3645         10  BLNOFCRA PIC  X(0001).
  3646     05  BLNOFCRI PIC  X(0005).
  3647*    -------------------------------
  3648     05  BMODEL PIC S9(0004) COMP.
  3649     05  BMODEF PIC  X(0001).
  3650     05  FILLER REDEFINES BMODEF.
  3651         10  BMODEA PIC  X(0001).
  3652     05  BMODEI PIC  X(0001).
  3653*    -------------------------------
  3654     05  BFREQL PIC S9(0004) COMP.
  3655     05  BFREQF PIC  X(0001).
  3656     05  FILLER REDEFINES BFREQF.
  3657         10  BFREQA PIC  X(0001).
  3658     05  BFREQI PIC  X(0002).
  3659*    -------------------------------
  3660     05  BPMTSL PIC S9(0004) COMP.
  3661     05  BPMTSF PIC  X(0001).
  3662     05  FILLER REDEFINES BPMTSF.
  3663         10  BPMTSA PIC  X(0001).
  3664     05  BPMTSI PIC  999.
  3665*    -------------------------------
  3666     05  BPMTAMTL PIC S9(0004) COMP.
  3667     05  BPMTAMTF PIC  X(0001).
  3668     05  FILLER REDEFINES BPMTAMTF.
  3669         10  BPMTAMTA PIC  X(0001).
  3670     05  BPMTAMTI PIC  9(7)V99.
  3671*    -------------------------------
  3672     05  BAPRL PIC S9(0004) COMP.
  3673     05  BAPRF PIC  X(0001).
  3674     05  FILLER REDEFINES BAPRF.
  3675         10  BAPRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  71
* EL6311.cbl
  3676     05  BAPRI PIC  X(7).
  3677*    -------------------------------
  3678     05  BLIVESL PIC S9(0004) COMP.
  3679     05  BLIVESF PIC  X(0001).
  3680     05  FILLER REDEFINES BLIVESF.
  3681         10  BLIVESA PIC  X(0001).
  3682     05  BLIVESI PIC  X(0009).
  3683*    -------------------------------
  3684     05  BMEMCAPL PIC S9(0004) COMP.
  3685     05  BMEMCAPF PIC  X(0001).
  3686     05  FILLER REDEFINES BMEMCAPF.
  3687         10  BMEMCAPA PIC  X(0001).
  3688     05  BMEMCAPI PIC  X(0011).
  3689*    -------------------------------
  3690     05  BORIGHDL PIC S9(0004) COMP.
  3691     05  BORIGHDF PIC  X(0001).
  3692     05  FILLER REDEFINES BORIGHDF.
  3693         10  BORIGHDA PIC  X(0001).
  3694     05  BORIGHDI PIC  X(0009).
  3695*    -------------------------------
  3696     05  DMDBILL PIC S9(0004) COMP.
  3697     05  DMDBILF PIC  X(0001).
  3698     05  FILLER REDEFINES DMDBILF.
  3699         10  DMDBILA PIC  X(0001).
  3700     05  DMDBILI PIC  X(0006).
  3701*    -------------------------------
  3702     05  BFORCEL PIC S9(0004) COMP.
  3703     05  BFORCEF PIC  X(0001).
  3704     05  FILLER REDEFINES BFORCEF.
  3705         10  BFORCEA PIC  X(0001).
  3706     05  BFORCEI PIC  X(0001).
  3707*    -------------------------------
  3708     05  BENTRYL PIC S9(0004) COMP.
  3709     05  BENTRYF PIC  X(0001).
  3710     05  FILLER REDEFINES BENTRYF.
  3711         10  BENTRYA PIC  X(0001).
  3712     05  BENTRYI PIC  X(0001).
  3713*    -------------------------------
  3714     05  BREINL PIC S9(0004) COMP.
  3715     05  BREINF PIC  X(0001).
  3716     05  FILLER REDEFINES BREINF.
  3717         10  BREINA PIC  X(0001).
  3718     05  BREINI PIC  X(0001).
  3719*    -------------------------------
  3720     05  BBILCDL PIC S9(0004) COMP.
  3721     05  BBILCDF PIC  X(0001).
  3722     05  FILLER REDEFINES BBILCDF.
  3723         10  BBILCDA PIC  X(0001).
  3724     05  BBILCDI PIC  X(0001).
  3725*    -------------------------------
  3726     05  BUNWRITL PIC S9(0004) COMP.
  3727     05  BUNWRITF PIC  X(0001).
  3728     05  FILLER REDEFINES BUNWRITF.
  3729         10  BUNWRITA PIC  X(0001).
  3730     05  BUNWRITI PIC  X(0001).
  3731*    -------------------------------
  3732     05  BSKPCDL PIC S9(0004) COMP.
  3733     05  BSKPCDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  72
* EL6311.cbl
  3734     05  FILLER REDEFINES BSKPCDF.
  3735         10  BSKPCDA PIC  X(0001).
  3736     05  BSKPCDI PIC  X(0001).
  3737*    -------------------------------
  3738     05  BINDGRPL PIC S9(0004) COMP.
  3739     05  BINDGRPF PIC  X(0001).
  3740     05  FILLER REDEFINES BINDGRPF.
  3741         10  BINDGRPA PIC  X(0001).
  3742     05  BINDGRPI PIC  X(0001).
  3743*    -------------------------------
  3744     05  BSIGL PIC S9(0004) COMP.
  3745     05  BSIGF PIC  X(0001).
  3746     05  FILLER REDEFINES BSIGF.
  3747         10  BSIGA PIC  X(0001).
  3748     05  BSIGI PIC  X(0001).
  3749*    -------------------------------
  3750     05  BRTCLSL PIC S9(0004) COMP.
  3751     05  BRTCLSF PIC  X(0001).
  3752     05  FILLER REDEFINES BRTCLSF.
  3753         10  BRTCLSA PIC  X(0001).
  3754     05  BRTCLSI PIC  X(0002).
  3755*    -------------------------------
  3756     05  BCHGCNTL PIC S9(0004) COMP.
  3757     05  BCHGCNTF PIC  X(0001).
  3758     05  FILLER REDEFINES BCHGCNTF.
  3759         10  BCHGCNTA PIC  X(0001).
  3760     05  BCHGCNTI PIC  X(0003).
  3761*    -------------------------------
  3762     05  BMEMBERL PIC S9(0004) COMP.
  3763     05  BMEMBERF PIC  X(0001).
  3764     05  FILLER REDEFINES BMEMBERF.
  3765         10  BMEMBERA PIC  X(0001).
  3766     05  BMEMBERI PIC  X(0012).
  3767*    -------------------------------
  3768     05  BORGNOL PIC S9(0004) COMP.
  3769     05  BORGNOF PIC  X(0001).
  3770     05  FILLER REDEFINES BORGNOF.
  3771         10  BORGNOA PIC  X(0001).
  3772     05  BORGNOI PIC  X(0006).
  3773*    -------------------------------
  3774     05  BORGSEQL PIC S9(0004) COMP.
  3775     05  BORGSEQF PIC  X(0001).
  3776     05  FILLER REDEFINES BORGSEQF.
  3777         10  BORGSEQA PIC  X(0001).
  3778     05  BORGSEQI PIC  X(0004).
  3779*    -------------------------------
  3780     05  BBILLEDL PIC S9(0004) COMP.
  3781     05  BBILLEDF PIC  X(0001).
  3782     05  FILLER REDEFINES BBILLEDF.
  3783         10  BBILLEDA PIC  X(0001).
  3784     05  BBILLEDI PIC  9(9).
  3785*    -------------------------------
  3786     05  BKIND1L PIC S9(0004) COMP.
  3787     05  BKIND1F PIC  X(0001).
  3788     05  FILLER REDEFINES BKIND1F.
  3789         10  BKIND1A PIC  X(0001).
  3790     05  BKIND1I PIC  X(0002).
  3791*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  73
* EL6311.cbl
  3792     05  BTYPE1L PIC S9(0004) COMP.
  3793     05  BTYPE1F PIC  X(0001).
  3794     05  FILLER REDEFINES BTYPE1F.
  3795         10  BTYPE1A PIC  X(0001).
  3796     05  BTYPE1I PIC  X(0003).
  3797*    -------------------------------
  3798     05  BTERM1L PIC S9(0004) COMP.
  3799     05  BTERM1F PIC  X(0001).
  3800     05  FILLER REDEFINES BTERM1F.
  3801         10  BTERM1A PIC  X(0001).
  3802     05  BTERM1I PIC  X(0003).
  3803*    -------------------------------
  3804     05  BBEN1L PIC S9(0004) COMP.
  3805     05  BBEN1F PIC  X(0001).
  3806     05  FILLER REDEFINES BBEN1F.
  3807         10  BBEN1A PIC  X(0001).
  3808     05  BBEN1I PIC  X(0012).
  3809*    -------------------------------
  3810     05  BPREM1L PIC S9(0004) COMP.
  3811     05  BPREM1F PIC  X(0001).
  3812     05  FILLER REDEFINES BPREM1F.
  3813         10  BPREM1A PIC  X(0001).
  3814     05  BPREM1I PIC  X(0011).
  3815*    -------------------------------
  3816     05  BEXPIR1L PIC S9(0004) COMP.
  3817     05  BEXPIR1F PIC  X(0001).
  3818     05  FILLER REDEFINES BEXPIR1F.
  3819         10  BEXPIR1A PIC  X(0001).
  3820     05  BEXPIR1I PIC  X(0008).
  3821*    -------------------------------
  3822     05  BCP1L PIC S9(0004) COMP.
  3823     05  BCP1F PIC  X(0001).
  3824     05  FILLER REDEFINES BCP1F.
  3825         10  BCP1A PIC  X(0001).
  3826     05  BCP1I PIC  X(0002).
  3827*    -------------------------------
  3828     05  BALTBN1L PIC S9(0004) COMP.
  3829     05  BALTBN1F PIC  X(0001).
  3830     05  FILLER REDEFINES BALTBN1F.
  3831         10  BALTBN1A PIC  X(0001).
  3832     05  BALTBN1I PIC  X(0012).
  3833*    -------------------------------
  3834     05  BALTPR1L PIC S9(0004) COMP.
  3835     05  BALTPR1F PIC  X(0001).
  3836     05  FILLER REDEFINES BALTPR1F.
  3837         10  BALTPR1A PIC  X(0001).
  3838     05  BALTPR1I PIC  X(0011).
  3839*    -------------------------------
  3840     05  BBNCD1L PIC S9(0004) COMP.
  3841     05  BBNCD1F PIC  X(0001).
  3842     05  FILLER REDEFINES BBNCD1F.
  3843         10  BBNCD1A PIC  X(0001).
  3844     05  BBNCD1I PIC  X(0003).
  3845*    -------------------------------
  3846     05  BCPRM1L PIC S9(0004) COMP.
  3847     05  BCPRM1F PIC  X(0001).
  3848     05  FILLER REDEFINES BCPRM1F.
  3849         10  BCPRM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  74
* EL6311.cbl
  3850     05  BCPRM1I PIC  X(0011).
  3851*    -------------------------------
  3852     05  BCAPRM1L PIC S9(0004) COMP.
  3853     05  BCAPRM1F PIC  X(0001).
  3854     05  FILLER REDEFINES BCAPRM1F.
  3855         10  BCAPRM1A PIC  X(0001).
  3856     05  BCAPRM1I PIC  X(0011).
  3857*    -------------------------------
  3858     05  BENABR1L PIC S9(0004) COMP.
  3859     05  BENABR1F PIC  X(0001).
  3860     05  FILLER REDEFINES BENABR1F.
  3861         10  BENABR1A PIC  X(0001).
  3862     05  BENABR1I PIC  X(0005).
  3863*    -------------------------------
  3864     05  BDIFF1L PIC S9(0004) COMP.
  3865     05  BDIFF1F PIC  X(0001).
  3866     05  FILLER REDEFINES BDIFF1F.
  3867         10  BDIFF1A PIC  X(0001).
  3868     05  BDIFF1I PIC  X(0011).
  3869*    -------------------------------
  3870     05  BBILIT1L PIC S9(0004) COMP.
  3871     05  BBILIT1F PIC  X(0001).
  3872     05  FILLER REDEFINES BBILIT1F.
  3873         10  BBILIT1A PIC  X(0001).
  3874     05  BBILIT1I PIC  X(0008).
  3875*    -------------------------------
  3876     05  BADIFF1L PIC S9(0004) COMP.
  3877     05  BADIFF1F PIC  X(0001).
  3878     05  FILLER REDEFINES BADIFF1F.
  3879         10  BADIFF1A PIC  X(0001).
  3880     05  BADIFF1I PIC  X(0011).
  3881*    -------------------------------
  3882     05  BKIND2L PIC S9(0004) COMP.
  3883     05  BKIND2F PIC  X(0001).
  3884     05  FILLER REDEFINES BKIND2F.
  3885         10  BKIND2A PIC  X(0001).
  3886     05  BKIND2I PIC  X(0002).
  3887*    -------------------------------
  3888     05  BTYPE2L PIC S9(0004) COMP.
  3889     05  BTYPE2F PIC  X(0001).
  3890     05  FILLER REDEFINES BTYPE2F.
  3891         10  BTYPE2A PIC  X(0001).
  3892     05  BTYPE2I PIC  X(0003).
  3893*    -------------------------------
  3894     05  BTERM2L PIC S9(0004) COMP.
  3895     05  BTERM2F PIC  X(0001).
  3896     05  FILLER REDEFINES BTERM2F.
  3897         10  BTERM2A PIC  X(0001).
  3898     05  BTERM2I PIC  X(0003).
  3899*    -------------------------------
  3900     05  BBEN2L PIC S9(0004) COMP.
  3901     05  BBEN2F PIC  X(0001).
  3902     05  FILLER REDEFINES BBEN2F.
  3903         10  BBEN2A PIC  X(0001).
  3904     05  BBEN2I PIC  X(0012).
  3905*    -------------------------------
  3906     05  BPREM2L PIC S9(0004) COMP.
  3907     05  BPREM2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  75
* EL6311.cbl
  3908     05  FILLER REDEFINES BPREM2F.
  3909         10  BPREM2A PIC  X(0001).
  3910     05  BPREM2I PIC  X(0011).
  3911*    -------------------------------
  3912     05  BEXPIR2L PIC S9(0004) COMP.
  3913     05  BEXPIR2F PIC  X(0001).
  3914     05  FILLER REDEFINES BEXPIR2F.
  3915         10  BEXPIR2A PIC  X(0001).
  3916     05  BEXPIR2I PIC  X(0008).
  3917*    -------------------------------
  3918     05  BCP2L PIC S9(0004) COMP.
  3919     05  BCP2F PIC  X(0001).
  3920     05  FILLER REDEFINES BCP2F.
  3921         10  BCP2A PIC  X(0001).
  3922     05  BCP2I PIC  X(0002).
  3923*    -------------------------------
  3924     05  BALTBN2L PIC S9(0004) COMP.
  3925     05  BALTBN2F PIC  X(0001).
  3926     05  FILLER REDEFINES BALTBN2F.
  3927         10  BALTBN2A PIC  X(0001).
  3928     05  BALTBN2I PIC  X(0012).
  3929*    -------------------------------
  3930     05  BALTPR2L PIC S9(0004) COMP.
  3931     05  BALTPR2F PIC  X(0001).
  3932     05  FILLER REDEFINES BALTPR2F.
  3933         10  BALTPR2A PIC  X(0001).
  3934     05  BALTPR2I PIC  X(0011).
  3935*    -------------------------------
  3936     05  BBNCD2L PIC S9(0004) COMP.
  3937     05  BBNCD2F PIC  X(0001).
  3938     05  FILLER REDEFINES BBNCD2F.
  3939         10  BBNCD2A PIC  X(0001).
  3940     05  BBNCD2I PIC  X(0003).
  3941*    -------------------------------
  3942     05  BCPRM2L PIC S9(0004) COMP.
  3943     05  BCPRM2F PIC  X(0001).
  3944     05  FILLER REDEFINES BCPRM2F.
  3945         10  BCPRM2A PIC  X(0001).
  3946     05  BCPRM2I PIC  X(0011).
  3947*    -------------------------------
  3948     05  BCAPRM2L PIC S9(0004) COMP.
  3949     05  BCAPRM2F PIC  X(0001).
  3950     05  FILLER REDEFINES BCAPRM2F.
  3951         10  BCAPRM2A PIC  X(0001).
  3952     05  BCAPRM2I PIC  X(0011).
  3953*    -------------------------------
  3954     05  BENABR2L PIC S9(0004) COMP.
  3955     05  BENABR2F PIC  X(0001).
  3956     05  FILLER REDEFINES BENABR2F.
  3957         10  BENABR2A PIC  X(0001).
  3958     05  BENABR2I PIC  X(0005).
  3959*    -------------------------------
  3960     05  BDIFF2L PIC S9(0004) COMP.
  3961     05  BDIFF2F PIC  X(0001).
  3962     05  FILLER REDEFINES BDIFF2F.
  3963         10  BDIFF2A PIC  X(0001).
  3964     05  BDIFF2I PIC  X(0011).
  3965*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  76
* EL6311.cbl
  3966     05  BBILIT2L PIC S9(0004) COMP.
  3967     05  BBILIT2F PIC  X(0001).
  3968     05  FILLER REDEFINES BBILIT2F.
  3969         10  BBILIT2A PIC  X(0001).
  3970     05  BBILIT2I PIC  X(0008).
  3971*    -------------------------------
  3972     05  BADIFF2L PIC S9(0004) COMP.
  3973     05  BADIFF2F PIC  X(0001).
  3974     05  FILLER REDEFINES BADIFF2F.
  3975         10  BADIFF2A PIC  X(0001).
  3976     05  BADIFF2I PIC  X(0011).
  3977*    -------------------------------
  3978     05  BERMSG1L PIC S9(0004) COMP.
  3979     05  BERMSG1F PIC  X(0001).
  3980     05  FILLER REDEFINES BERMSG1F.
  3981         10  BERMSG1A PIC  X(0001).
  3982     05  BERMSG1I PIC  X(0078).
  3983*    -------------------------------
  3984     05  BERMSG2L PIC S9(0004) COMP.
  3985     05  BERMSG2F PIC  X(0001).
  3986     05  FILLER REDEFINES BERMSG2F.
  3987         10  BERMSG2A PIC  X(0001).
  3988     05  BERMSG2I PIC  X(0078).
  3989*    -------------------------------
  3990     05  BERMSG3L PIC S9(0004) COMP.
  3991     05  BERMSG3F PIC  X(0001).
  3992     05  FILLER REDEFINES BERMSG3F.
  3993         10  BERMSG3A PIC  X(0001).
  3994     05  BERMSG3I PIC  X(0078).
  3995*    -------------------------------
  3996     05  BPFENTRL PIC S9(0004) COMP.
  3997     05  BPFENTRF PIC  X(0001).
  3998     05  FILLER REDEFINES BPFENTRF.
  3999         10  BPFENTRA PIC  X(0001).
  4000     05  BPFENTRI PIC  9(2).
  4001*    -------------------------------
  4002     05  BPF5HDRL PIC S9(0004) COMP.
  4003     05  BPF5HDRF PIC  X(0001).
  4004     05  FILLER REDEFINES BPF5HDRF.
  4005         10  BPF5HDRA PIC  X(0001).
  4006     05  BPF5HDRI PIC  X(0005).
  4007*    -------------------------------
  4008     05  BPF4HDRL PIC S9(0004) COMP.
  4009     05  BPF4HDRF PIC  X(0001).
  4010     05  FILLER REDEFINES BPF4HDRF.
  4011         10  BPF4HDRA PIC  X(0001).
  4012     05  BPF4HDRI PIC  X(0013).
  4013*    -------------------------------
  4014     05  BF15HDRL PIC S9(0004) COMP.
  4015     05  BF15HDRF PIC  X(0001).
  4016     05  FILLER REDEFINES BF15HDRF.
  4017         10  BF15HDRA PIC  X(0001).
  4018     05  BF15HDRI PIC  X(0010).
  4019 01  EL631BO REDEFINES EL631BI.
  4020     05  FILLER            PIC  X(0012).
  4021*    -------------------------------
  4022     05  FILLER            PIC  X(0003).
  4023     05  BDATEO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  77
* EL6311.cbl
  4024*    -------------------------------
  4025     05  FILLER            PIC  X(0003).
  4026     05  BTIMEO PIC  99.99.
  4027*    -------------------------------
  4028     05  FILLER            PIC  X(0003).
  4029     05  BHEADO PIC  X(0038).
  4030*    -------------------------------
  4031     05  FILLER            PIC  X(0003).
  4032     05  BNCERTLO PIC  X(0008).
  4033*    -------------------------------
  4034     05  FILLER            PIC  X(0003).
  4035     05  BNCERTO PIC  X(0011).
  4036*    -------------------------------
  4037     05  FILLER            PIC  X(0003).
  4038     05  BNSTATLO PIC  X(0009).
  4039*    -------------------------------
  4040     05  FILLER            PIC  X(0003).
  4041     05  BNSTATO PIC  X(0002).
  4042*    -------------------------------
  4043     05  FILLER            PIC  X(0003).
  4044     05  BCHGTO PIC  X(0004).
  4045*    -------------------------------
  4046     05  FILLER            PIC  X(0003).
  4047     05  BCHGO PIC  ZZZ9.
  4048*    -------------------------------
  4049     05  FILLER            PIC  X(0003).
  4050     05  BCOMPIDO PIC  X(0003).
  4051*    -------------------------------
  4052     05  FILLER            PIC  X(0003).
  4053     05  BREGIONO PIC  X(0006).
  4054*    -------------------------------
  4055     05  FILLER            PIC  X(0003).
  4056     05  BUSERO PIC  X(0004).
  4057*    -------------------------------
  4058     05  FILLER            PIC  X(0003).
  4059     05  BMAINTO PIC  X(0001).
  4060*    -------------------------------
  4061     05  FILLER            PIC  X(0003).
  4062     05  BMANTBYO PIC  X(0004).
  4063*    -------------------------------
  4064     05  FILLER            PIC  X(0003).
  4065     05  BCHGHDGO PIC  X(0003).
  4066*    -------------------------------
  4067     05  FILLER            PIC  X(0003).
  4068     05  BMANTDTO PIC  X(0008).
  4069*    -------------------------------
  4070     05  FILLER            PIC  X(0003).
  4071     05  BMANTATO PIC  99.99.
  4072*    -------------------------------
  4073     05  FILLER            PIC  X(0003).
  4074     05  BCSRO PIC  X(0004).
  4075*    -------------------------------
  4076     05  FILLER            PIC  X(0003).
  4077     05  BBATCHO PIC  X(0006).
  4078*    -------------------------------
  4079     05  FILLER            PIC  X(0003).
  4080     05  BSEQO PIC  X(0004).
  4081*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  78
* EL6311.cbl
  4082     05  FILLER            PIC  X(0003).
  4083     05  BMOENDTO PIC  X(0008).
  4084*    -------------------------------
  4085     05  FILLER            PIC  X(0003).
  4086     05  BCARRO PIC  X(0001).
  4087*    -------------------------------
  4088     05  FILLER            PIC  X(0003).
  4089     05  BGROUPO PIC  X(0006).
  4090*    -------------------------------
  4091     05  FILLER            PIC  X(0003).
  4092     05  BSTATEO PIC  X(0002).
  4093*    -------------------------------
  4094     05  FILLER            PIC  X(0003).
  4095     05  BACCTO PIC  X(0010).
  4096*    -------------------------------
  4097     05  FILLER            PIC  X(0003).
  4098     05  BVINHO PIC  X(0004).
  4099*    -------------------------------
  4100     05  FILLER            PIC  X(0003).
  4101     05  BVINO PIC  X(0017).
  4102*    -------------------------------
  4103     05  FILLER            PIC  X(0003).
  4104     05  BREFHDGO PIC  X(0004).
  4105*    -------------------------------
  4106     05  FILLER            PIC  X(0003).
  4107     05  BREFO PIC  X(0012).
  4108*    -------------------------------
  4109     05  FILLER            PIC  X(0003).
  4110     05  BAGEDEFO PIC  X(0004).
  4111*    -------------------------------
  4112     05  FILLER            PIC  X(0003).
  4113     05  BCERTNOO PIC  X(0010).
  4114*    -------------------------------
  4115     05  FILLER            PIC  X(0003).
  4116     05  BSUFIXO PIC  X(0001).
  4117*    -------------------------------
  4118     05  FILLER            PIC  X(0003).
  4119     05  BEFFDTO PIC  X(0008).
  4120*    -------------------------------
  4121     05  FILLER            PIC  X(0003).
  4122     05  BLSTNMO PIC  X(0015).
  4123*    -------------------------------
  4124     05  FILLER            PIC  X(0003).
  4125     05  B1STNMO PIC  X(0010).
  4126*    -------------------------------
  4127     05  FILLER            PIC  X(0003).
  4128     05  BINITO PIC  X(0001).
  4129*    -------------------------------
  4130     05  FILLER            PIC  X(0003).
  4131     05  BSEXO PIC  X(0001).
  4132*    -------------------------------
  4133     05  FILLER            PIC  X(0003).
  4134     05  BAGEO PIC  X(0002).
  4135*    -------------------------------
  4136     05  FILLER            PIC  X(0003).
  4137     05  BBIRTHO PIC  X(0008).
  4138*    -------------------------------
  4139     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  79
* EL6311.cbl
  4140     05  B1STPMTO PIC  X(0008).
  4141*    -------------------------------
  4142     05  FILLER            PIC  X(0003).
  4143     05  BDAYSO PIC  X(0003).
  4144*    -------------------------------
  4145     05  FILLER            PIC  X(0003).
  4146     05  BLNTRMO PIC  X(0003).
  4147*    -------------------------------
  4148     05  FILLER            PIC  X(0003).
  4149     05  BLNOFCRO PIC  X(0005).
  4150*    -------------------------------
  4151     05  FILLER            PIC  X(0003).
  4152     05  BMODEO PIC  X(0001).
  4153*    -------------------------------
  4154     05  FILLER            PIC  X(0003).
  4155     05  BFREQO PIC  X(0002).
  4156*    -------------------------------
  4157     05  FILLER            PIC  X(0003).
  4158     05  BPMTSO PIC  X(0003).
  4159*    -------------------------------
  4160     05  FILLER            PIC  X(0003).
  4161     05  BPMTAMTO PIC  ZZZZZ9.99.
  4162*    -------------------------------
  4163     05  FILLER            PIC  X(0003).
  4164     05  BAPRO PIC  99.9999.
  4165*    -------------------------------
  4166     05  FILLER            PIC  X(0003).
  4167     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4168*    -------------------------------
  4169     05  FILLER            PIC  X(0003).
  4170     05  BMEMCAPO PIC  X(0011).
  4171*    -------------------------------
  4172     05  FILLER            PIC  X(0003).
  4173     05  BORIGHDO PIC  X(0009).
  4174*    -------------------------------
  4175     05  FILLER            PIC  X(0003).
  4176     05  DMDBILO PIC  X(0006).
  4177*    -------------------------------
  4178     05  FILLER            PIC  X(0003).
  4179     05  BFORCEO PIC  X(0001).
  4180*    -------------------------------
  4181     05  FILLER            PIC  X(0003).
  4182     05  BENTRYO PIC  X(0001).
  4183*    -------------------------------
  4184     05  FILLER            PIC  X(0003).
  4185     05  BREINO PIC  X(0001).
  4186*    -------------------------------
  4187     05  FILLER            PIC  X(0003).
  4188     05  BBILCDO PIC  X(0001).
  4189*    -------------------------------
  4190     05  FILLER            PIC  X(0003).
  4191     05  BUNWRITO PIC  X(0001).
  4192*    -------------------------------
  4193     05  FILLER            PIC  X(0003).
  4194     05  BSKPCDO PIC  X(0001).
  4195*    -------------------------------
  4196     05  FILLER            PIC  X(0003).
  4197     05  BINDGRPO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  80
* EL6311.cbl
  4198*    -------------------------------
  4199     05  FILLER            PIC  X(0003).
  4200     05  BSIGO PIC  X(0001).
  4201*    -------------------------------
  4202     05  FILLER            PIC  X(0003).
  4203     05  BRTCLSO PIC  X(0002).
  4204*    -------------------------------
  4205     05  FILLER            PIC  X(0003).
  4206     05  BCHGCNTO PIC  X(0003).
  4207*    -------------------------------
  4208     05  FILLER            PIC  X(0003).
  4209     05  BMEMBERO PIC  X(0012).
  4210*    -------------------------------
  4211     05  FILLER            PIC  X(0003).
  4212     05  BORGNOO PIC  X(0006).
  4213*    -------------------------------
  4214     05  FILLER            PIC  X(0003).
  4215     05  BORGSEQO PIC  X(0004).
  4216*    -------------------------------
  4217     05  FILLER            PIC  X(0003).
  4218     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4219*    -------------------------------
  4220     05  FILLER            PIC  X(0003).
  4221     05  BKIND1O PIC  X(0002).
  4222*    -------------------------------
  4223     05  FILLER            PIC  X(0003).
  4224     05  BTYPE1O PIC  X(0003).
  4225*    -------------------------------
  4226     05  FILLER            PIC  X(0003).
  4227     05  BTERM1O PIC  X(0003).
  4228*    -------------------------------
  4229     05  FILLER            PIC  X(0003).
  4230     05  BBEN1O PIC  X(0012).
  4231*    -------------------------------
  4232     05  FILLER            PIC  X(0003).
  4233     05  BPREM1O PIC  X(0011).
  4234*    -------------------------------
  4235     05  FILLER            PIC  X(0003).
  4236     05  BEXPIR1O PIC  X(0008).
  4237*    -------------------------------
  4238     05  FILLER            PIC  X(0003).
  4239     05  BCP1O PIC  X(0002).
  4240*    -------------------------------
  4241     05  FILLER            PIC  X(0003).
  4242     05  BALTBN1O PIC  X(0012).
  4243*    -------------------------------
  4244     05  FILLER            PIC  X(0003).
  4245     05  BALTPR1O PIC  X(0011).
  4246*    -------------------------------
  4247     05  FILLER            PIC  X(0003).
  4248     05  BBNCD1O PIC  X(0003).
  4249*    -------------------------------
  4250     05  FILLER            PIC  X(0003).
  4251     05  BCPRM1O PIC  X(0011).
  4252*    -------------------------------
  4253     05  FILLER            PIC  X(0003).
  4254     05  BCAPRM1O PIC  X(0011).
  4255*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  81
* EL6311.cbl
  4256     05  FILLER            PIC  X(0003).
  4257     05  BENABR1O PIC  X(0005).
  4258*    -------------------------------
  4259     05  FILLER            PIC  X(0003).
  4260     05  BDIFF1O PIC  X(0011).
  4261*    -------------------------------
  4262     05  FILLER            PIC  X(0003).
  4263     05  BBILIT1O PIC  X(0008).
  4264*    -------------------------------
  4265     05  FILLER            PIC  X(0003).
  4266     05  BADIFF1O PIC  X(0011).
  4267*    -------------------------------
  4268     05  FILLER            PIC  X(0003).
  4269     05  BKIND2O PIC  X(0002).
  4270*    -------------------------------
  4271     05  FILLER            PIC  X(0003).
  4272     05  BTYPE2O PIC  X(0003).
  4273*    -------------------------------
  4274     05  FILLER            PIC  X(0003).
  4275     05  BTERM2O PIC  X(0003).
  4276*    -------------------------------
  4277     05  FILLER            PIC  X(0003).
  4278     05  BBEN2O PIC  X(0012).
  4279*    -------------------------------
  4280     05  FILLER            PIC  X(0003).
  4281     05  BPREM2O PIC  X(0011).
  4282*    -------------------------------
  4283     05  FILLER            PIC  X(0003).
  4284     05  BEXPIR2O PIC  X(0008).
  4285*    -------------------------------
  4286     05  FILLER            PIC  X(0003).
  4287     05  BCP2O PIC  X(0002).
  4288*    -------------------------------
  4289     05  FILLER            PIC  X(0003).
  4290     05  BALTBN2O PIC  X(0012).
  4291*    -------------------------------
  4292     05  FILLER            PIC  X(0003).
  4293     05  BALTPR2O PIC  X(0011).
  4294*    -------------------------------
  4295     05  FILLER            PIC  X(0003).
  4296     05  BBNCD2O PIC  X(0003).
  4297*    -------------------------------
  4298     05  FILLER            PIC  X(0003).
  4299     05  BCPRM2O PIC  X(0011).
  4300*    -------------------------------
  4301     05  FILLER            PIC  X(0003).
  4302     05  BCAPRM2O PIC  X(0011).
  4303*    -------------------------------
  4304     05  FILLER            PIC  X(0003).
  4305     05  BENABR2O PIC  X(0005).
  4306*    -------------------------------
  4307     05  FILLER            PIC  X(0003).
  4308     05  BDIFF2O PIC  X(0011).
  4309*    -------------------------------
  4310     05  FILLER            PIC  X(0003).
  4311     05  BBILIT2O PIC  X(0008).
  4312*    -------------------------------
  4313     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  82
* EL6311.cbl
  4314     05  BADIFF2O PIC  X(0011).
  4315*    -------------------------------
  4316     05  FILLER            PIC  X(0003).
  4317     05  BERMSG1O PIC  X(0078).
  4318*    -------------------------------
  4319     05  FILLER            PIC  X(0003).
  4320     05  BERMSG2O PIC  X(0078).
  4321*    -------------------------------
  4322     05  FILLER            PIC  X(0003).
  4323     05  BERMSG3O PIC  X(0078).
  4324*    -------------------------------
  4325     05  FILLER            PIC  X(0003).
  4326     05  BPFENTRO PIC  X(0002).
  4327*    -------------------------------
  4328     05  FILLER            PIC  X(0003).
  4329     05  BPF5HDRO PIC  X(0005).
  4330*    -------------------------------
  4331     05  FILLER            PIC  X(0003).
  4332     05  BPF4HDRO PIC  X(0013).
  4333*    -------------------------------
  4334     05  FILLER            PIC  X(0003).
  4335     05  BF15HDRO PIC  X(0010).
  4336*    -------------------------------
  4337 01  EL631CI REDEFINES EL631BI.
  4338     05  FILLER            PIC  X(0012).
  4339*    -------------------------------
  4340     05  CDATEL PIC S9(0004) COMP.
  4341     05  CDATEF PIC  X(0001).
  4342     05  FILLER REDEFINES CDATEF.
  4343         10  CDATEA PIC  X(0001).
  4344     05  CDATEI PIC  X(0008).
  4345*    -------------------------------
  4346     05  CTIMEL PIC S9(0004) COMP.
  4347     05  CTIMEF PIC  X(0001).
  4348     05  FILLER REDEFINES CTIMEF.
  4349         10  CTIMEA PIC  X(0001).
  4350     05  CTIMEI PIC  X(0005).
  4351*    -------------------------------
  4352     05  CHEADL PIC S9(0004) COMP.
  4353     05  CHEADF PIC  X(0001).
  4354     05  FILLER REDEFINES CHEADF.
  4355         10  CHEADA PIC  X(0001).
  4356     05  CHEADI PIC  X(0038).
  4357*    -------------------------------
  4358     05  CCHGTL PIC S9(0004) COMP.
  4359     05  CCHGTF PIC  X(0001).
  4360     05  FILLER REDEFINES CCHGTF.
  4361         10  CCHGTA PIC  X(0001).
  4362     05  CCHGTI PIC  X(0004).
  4363*    -------------------------------
  4364     05  CCHGL PIC S9(0004) COMP.
  4365     05  CCHGF PIC  X(0001).
  4366     05  FILLER REDEFINES CCHGF.
  4367         10  CCHGA PIC  X(0001).
  4368     05  CCHGI PIC  X(0004).
  4369*    -------------------------------
  4370     05  CMAINTL PIC S9(0004) COMP.
  4371     05  CMAINTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  83
* EL6311.cbl
  4372     05  FILLER REDEFINES CMAINTF.
  4373         10  CMAINTA PIC  X(0001).
  4374     05  CMAINTI PIC  X(0001).
  4375*    -------------------------------
  4376     05  CMANTBYL PIC S9(0004) COMP.
  4377     05  CMANTBYF PIC  X(0001).
  4378     05  FILLER REDEFINES CMANTBYF.
  4379         10  CMANTBYA PIC  X(0001).
  4380     05  CMANTBYI PIC  X(0004).
  4381*    -------------------------------
  4382     05  CCHGHDGL PIC S9(0004) COMP.
  4383     05  CCHGHDGF PIC  X(0001).
  4384     05  FILLER REDEFINES CCHGHDGF.
  4385         10  CCHGHDGA PIC  X(0001).
  4386     05  CCHGHDGI PIC  X(0003).
  4387*    -------------------------------
  4388     05  CMANTDTL PIC S9(0004) COMP.
  4389     05  CMANTDTF PIC  X(0001).
  4390     05  FILLER REDEFINES CMANTDTF.
  4391         10  CMANTDTA PIC  X(0001).
  4392     05  CMANTDTI PIC  X(0008).
  4393*    -------------------------------
  4394     05  CMANTATL PIC S9(0004) COMP.
  4395     05  CMANTATF PIC  X(0001).
  4396     05  FILLER REDEFINES CMANTATF.
  4397         10  CMANTATA PIC  X(0001).
  4398     05  CMANTATI PIC  X(0005).
  4399*    -------------------------------
  4400     05  CCSRL PIC S9(0004) COMP.
  4401     05  CCSRF PIC  X(0001).
  4402     05  FILLER REDEFINES CCSRF.
  4403         10  CCSRA PIC  X(0001).
  4404     05  CCSRI PIC  X(0004).
  4405*    -------------------------------
  4406     05  CBATCHL PIC S9(0004) COMP.
  4407     05  CBATCHF PIC  X(0001).
  4408     05  FILLER REDEFINES CBATCHF.
  4409         10  CBATCHA PIC  X(0001).
  4410     05  CBATCHI PIC  X(0006).
  4411*    -------------------------------
  4412     05  CSEQL PIC S9(0004) COMP.
  4413     05  CSEQF PIC  X(0001).
  4414     05  FILLER REDEFINES CSEQF.
  4415         10  CSEQA PIC  X(0001).
  4416     05  CSEQI PIC  X(0004).
  4417*    -------------------------------
  4418     05  CMOENDTL PIC S9(0004) COMP.
  4419     05  CMOENDTF PIC  X(0001).
  4420     05  FILLER REDEFINES CMOENDTF.
  4421         10  CMOENDTA PIC  X(0001).
  4422     05  CMOENDTI PIC  X(0008).
  4423*    -------------------------------
  4424     05  CCARRL PIC S9(0004) COMP.
  4425     05  CCARRF PIC  X(0001).
  4426     05  FILLER REDEFINES CCARRF.
  4427         10  CCARRA PIC  X(0001).
  4428     05  CCARRI PIC  X(0001).
  4429*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  84
* EL6311.cbl
  4430     05  CGROUPL PIC S9(0004) COMP.
  4431     05  CGROUPF PIC  X(0001).
  4432     05  FILLER REDEFINES CGROUPF.
  4433         10  CGROUPA PIC  X(0001).
  4434     05  CGROUPI PIC  X(0006).
  4435*    -------------------------------
  4436     05  CSTATEL PIC S9(0004) COMP.
  4437     05  CSTATEF PIC  X(0001).
  4438     05  FILLER REDEFINES CSTATEF.
  4439         10  CSTATEA PIC  X(0001).
  4440     05  CSTATEI PIC  X(0002).
  4441*    -------------------------------
  4442     05  CACCTL PIC S9(0004) COMP.
  4443     05  CACCTF PIC  X(0001).
  4444     05  FILLER REDEFINES CACCTF.
  4445         10  CACCTA PIC  X(0001).
  4446     05  CACCTI PIC  X(0010).
  4447*    -------------------------------
  4448     05  CORIGHDL PIC S9(0004) COMP.
  4449     05  CORIGHDF PIC  X(0001).
  4450     05  FILLER REDEFINES CORIGHDF.
  4451         10  CORIGHDA PIC  X(0001).
  4452     05  CORIGHDI PIC  X(0011).
  4453*    -------------------------------
  4454     05  CORGNOL PIC S9(0004) COMP.
  4455     05  CORGNOF PIC  X(0001).
  4456     05  FILLER REDEFINES CORGNOF.
  4457         10  CORGNOA PIC  X(0001).
  4458     05  CORGNOI PIC  X(0006).
  4459*    -------------------------------
  4460     05  CORGSEQL PIC S9(0004) COMP.
  4461     05  CORGSEQF PIC  X(0001).
  4462     05  FILLER REDEFINES CORGSEQF.
  4463         10  CORGSEQA PIC  X(0001).
  4464     05  CORGSEQI PIC  X(0004).
  4465*    -------------------------------
  4466     05  CREFHDGL PIC S9(0004) COMP.
  4467     05  CREFHDGF PIC  X(0001).
  4468     05  FILLER REDEFINES CREFHDGF.
  4469         10  CREFHDGA PIC  X(0001).
  4470     05  CREFHDGI PIC  X(0010).
  4471*    -------------------------------
  4472     05  CREFL PIC S9(0004) COMP.
  4473     05  CREFF PIC  X(0001).
  4474     05  FILLER REDEFINES CREFF.
  4475         10  CREFA PIC  X(0001).
  4476     05  CREFI PIC  X(0012).
  4477*    -------------------------------
  4478     05  CNHINTL PIC S9(0004) COMP.
  4479     05  CNHINTF PIC  X(0001).
  4480     05  FILLER REDEFINES CNHINTF.
  4481         10  CNHINTA PIC  X(0001).
  4482     05  CNHINTI PIC  9(7)V99.
  4483*    -------------------------------
  4484     05  CCERTNOL PIC S9(0004) COMP.
  4485     05  CCERTNOF PIC  X(0001).
  4486     05  FILLER REDEFINES CCERTNOF.
  4487         10  CCERTNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  85
* EL6311.cbl
  4488     05  CCERTNOI PIC  X(0010).
  4489*    -------------------------------
  4490     05  CSUFIXL PIC S9(0004) COMP.
  4491     05  CSUFIXF PIC  X(0001).
  4492     05  FILLER REDEFINES CSUFIXF.
  4493         10  CSUFIXA PIC  X(0001).
  4494     05  CSUFIXI PIC  X(0001).
  4495*    -------------------------------
  4496     05  CEFFDTL PIC S9(0004) COMP.
  4497     05  CEFFDTF PIC  X(0001).
  4498     05  FILLER REDEFINES CEFFDTF.
  4499         10  CEFFDTA PIC  X(0001).
  4500     05  CEFFDTI PIC  X(0008).
  4501*    -------------------------------
  4502     05  CLSTNML PIC S9(0004) COMP.
  4503     05  CLSTNMF PIC  X(0001).
  4504     05  FILLER REDEFINES CLSTNMF.
  4505         10  CLSTNMA PIC  X(0001).
  4506     05  CLSTNMI PIC  X(0015).
  4507*    -------------------------------
  4508     05  CPCYNL PIC S9(0004) COMP.
  4509     05  CPCYNF PIC  X(0001).
  4510     05  FILLER REDEFINES CPCYNF.
  4511         10  CPCYNA PIC  X(0001).
  4512     05  CPCYNI PIC  X(0001).
  4513*    -------------------------------
  4514     05  CINAMEL PIC S9(0004) COMP.
  4515     05  CINAMEF PIC  X(0001).
  4516     05  FILLER REDEFINES CINAMEF.
  4517         10  CINAMEA PIC  X(0001).
  4518     05  CINAMEI PIC  X(0015).
  4519*    -------------------------------
  4520     05  CINITSL PIC S9(0004) COMP.
  4521     05  CINITSF PIC  X(0001).
  4522     05  FILLER REDEFINES CINITSF.
  4523         10  CINITSA PIC  X(0001).
  4524     05  CINITSI PIC  X(0010).
  4525*    -------------------------------
  4526     05  CCANREAL PIC S9(0004) COMP.
  4527     05  CCANREAF PIC  X(0001).
  4528     05  FILLER REDEFINES CCANREAF.
  4529         10  CCANREAA PIC  X(0001).
  4530     05  CCANREAI PIC  X(0001).
  4531*    -------------------------------
  4532     05  CKIND1L PIC S9(0004) COMP.
  4533     05  CKIND1F PIC  X(0001).
  4534     05  FILLER REDEFINES CKIND1F.
  4535         10  CKIND1A PIC  X(0001).
  4536     05  CKIND1I PIC  X(0002).
  4537*    -------------------------------
  4538     05  CCANDT1L PIC S9(0004) COMP.
  4539     05  CCANDT1F PIC  X(0001).
  4540     05  FILLER REDEFINES CCANDT1F.
  4541         10  CCANDT1A PIC  X(0001).
  4542     05  CCANDT1I PIC  X(0008).
  4543*    -------------------------------
  4544     05  CREFND1L PIC S9(0004) COMP.
  4545     05  CREFND1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  86
* EL6311.cbl
  4546     05  FILLER REDEFINES CREFND1F.
  4547         10  CREFND1A PIC  X(0001).
  4548     05  CREFND1I PIC  S9(9)V99.
  4549*    -------------------------------
  4550     05  CMTHD1L PIC S9(0004) COMP.
  4551     05  CMTHD1F PIC  X(0001).
  4552     05  FILLER REDEFINES CMTHD1F.
  4553         10  CMTHD1A PIC  X(0001).
  4554     05  CMTHD1I PIC  X(0001).
  4555*    -------------------------------
  4556     05  CKIND2L PIC S9(0004) COMP.
  4557     05  CKIND2F PIC  X(0001).
  4558     05  FILLER REDEFINES CKIND2F.
  4559         10  CKIND2A PIC  X(0001).
  4560     05  CKIND2I PIC  X(0002).
  4561*    -------------------------------
  4562     05  CCANDT2L PIC S9(0004) COMP.
  4563     05  CCANDT2F PIC  X(0001).
  4564     05  FILLER REDEFINES CCANDT2F.
  4565         10  CCANDT2A PIC  X(0001).
  4566     05  CCANDT2I PIC  X(0008).
  4567*    -------------------------------
  4568     05  CREFND2L PIC S9(0004) COMP.
  4569     05  CREFND2F PIC  X(0001).
  4570     05  FILLER REDEFINES CREFND2F.
  4571         10  CREFND2A PIC  X(0001).
  4572     05  CREFND2I PIC  S9(9)V99.
  4573*    -------------------------------
  4574     05  CMTHD2L PIC S9(0004) COMP.
  4575     05  CMTHD2F PIC  X(0001).
  4576     05  FILLER REDEFINES CMTHD2F.
  4577         10  CMTHD2A PIC  X(0001).
  4578     05  CMTHD2I PIC  X(0001).
  4579*    -------------------------------
  4580     05  CLIVESL PIC S9(0004) COMP.
  4581     05  CLIVESF PIC  X(0001).
  4582     05  FILLER REDEFINES CLIVESF.
  4583         10  CLIVESA PIC  X(0001).
  4584     05  CLIVESI PIC  X(0003).
  4585*    -------------------------------
  4586     05  CFORCEL PIC S9(0004) COMP.
  4587     05  CFORCEF PIC  X(0001).
  4588     05  FILLER REDEFINES CFORCEF.
  4589         10  CFORCEA PIC  X(0001).
  4590     05  CFORCEI PIC  X(0001).
  4591*    -------------------------------
  4592     05  CBILCDL PIC S9(0004) COMP.
  4593     05  CBILCDF PIC  X(0001).
  4594     05  FILLER REDEFINES CBILCDF.
  4595         10  CBILCDA PIC  X(0001).
  4596     05  CBILCDI PIC  X(0001).
  4597*    -------------------------------
  4598     05  CCRFND1L PIC S9(0004) COMP.
  4599     05  CCRFND1F PIC  X(0001).
  4600     05  FILLER REDEFINES CCRFND1F.
  4601         10  CCRFND1A PIC  X(0001).
  4602     05  CCRFND1I PIC  X(0011).
  4603*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  87
* EL6311.cbl
  4604     05  CCRFND2L PIC S9(0004) COMP.
  4605     05  CCRFND2F PIC  X(0001).
  4606     05  FILLER REDEFINES CCRFND2F.
  4607         10  CCRFND2A PIC  X(0001).
  4608     05  CCRFND2I PIC  X(0011).
  4609*    -------------------------------
  4610     05  CBILIT1L PIC S9(0004) COMP.
  4611     05  CBILIT1F PIC  X(0001).
  4612     05  FILLER REDEFINES CBILIT1F.
  4613         10  CBILIT1A PIC  X(0001).
  4614     05  CBILIT1I PIC  X(0008).
  4615*    -------------------------------
  4616     05  CDRFND1L PIC S9(0004) COMP.
  4617     05  CDRFND1F PIC  X(0001).
  4618     05  FILLER REDEFINES CDRFND1F.
  4619         10  CDRFND1A PIC  X(0001).
  4620     05  CDRFND1I PIC  X(0011).
  4621*    -------------------------------
  4622     05  CBILIT2L PIC S9(0004) COMP.
  4623     05  CBILIT2F PIC  X(0001).
  4624     05  FILLER REDEFINES CBILIT2F.
  4625         10  CBILIT2A PIC  X(0001).
  4626     05  CBILIT2I PIC  X(0008).
  4627*    -------------------------------
  4628     05  CDRFND2L PIC S9(0004) COMP.
  4629     05  CDRFND2F PIC  X(0001).
  4630     05  FILLER REDEFINES CDRFND2F.
  4631         10  CDRFND2A PIC  X(0001).
  4632     05  CDRFND2I PIC  X(0011).
  4633*    -------------------------------
  4634     05  CCANTXTL PIC S9(0004) COMP.
  4635     05  CCANTXTF PIC  X(0001).
  4636     05  FILLER REDEFINES CCANTXTF.
  4637         10  CCANTXTA PIC  X(0001).
  4638     05  CCANTXTI PIC  X(0005).
  4639*    -------------------------------
  4640     05  CCANFEEL PIC S9(0004) COMP.
  4641     05  CCANFEEF PIC  X(0001).
  4642     05  FILLER REDEFINES CCANFEEF.
  4643         10  CCANFEEA PIC  X(0001).
  4644     05  CCANFEEI PIC  X(0002).
  4645*    -------------------------------
  4646     05  CTERM1L PIC S9(0004) COMP.
  4647     05  CTERM1F PIC  X(0001).
  4648     05  FILLER REDEFINES CTERM1F.
  4649         10  CTERM1A PIC  X(0001).
  4650     05  CTERM1I PIC  X(0003).
  4651*    -------------------------------
  4652     05  CRTERM1L PIC S9(0004) COMP.
  4653     05  CRTERM1F PIC  X(0001).
  4654     05  FILLER REDEFINES CRTERM1F.
  4655         10  CRTERM1A PIC  X(0001).
  4656     05  CRTERM1I PIC  X(0003).
  4657*    -------------------------------
  4658     05  CPREM1L PIC S9(0004) COMP.
  4659     05  CPREM1F PIC  X(0001).
  4660     05  FILLER REDEFINES CPREM1F.
  4661         10  CPREM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  88
* EL6311.cbl
  4662     05  CPREM1I PIC  X(0011).
  4663*    -------------------------------
  4664     05  CTERM2L PIC S9(0004) COMP.
  4665     05  CTERM2F PIC  X(0001).
  4666     05  FILLER REDEFINES CTERM2F.
  4667         10  CTERM2A PIC  X(0001).
  4668     05  CTERM2I PIC  X(0003).
  4669*    -------------------------------
  4670     05  CRTERM2L PIC S9(0004) COMP.
  4671     05  CRTERM2F PIC  X(0001).
  4672     05  FILLER REDEFINES CRTERM2F.
  4673         10  CRTERM2A PIC  X(0001).
  4674     05  CRTERM2I PIC  X(0003).
  4675*    -------------------------------
  4676     05  CPREM2L PIC S9(0004) COMP.
  4677     05  CPREM2F PIC  X(0001).
  4678     05  FILLER REDEFINES CPREM2F.
  4679         10  CPREM2A PIC  X(0001).
  4680     05  CPREM2I PIC  X(0011).
  4681*    -------------------------------
  4682     05  CENTRDTL PIC S9(0004) COMP.
  4683     05  CENTRDTF PIC  X(0001).
  4684     05  FILLER REDEFINES CENTRDTF.
  4685         10  CENTRDTA PIC  X(0001).
  4686     05  CENTRDTI PIC  X(0008).
  4687*    -------------------------------
  4688     05  CPAYEEL PIC S9(0004) COMP.
  4689     05  CPAYEEF PIC  X(0001).
  4690     05  FILLER REDEFINES CPAYEEF.
  4691         10  CPAYEEA PIC  X(0001).
  4692     05  CPAYEEI PIC  X(0006).
  4693*    -------------------------------
  4694     05  CRFNDSWL PIC S9(0004) COMP.
  4695     05  CRFNDSWF PIC  X(0001).
  4696     05  FILLER REDEFINES CRFNDSWF.
  4697         10  CRFNDSWA PIC  X(0001).
  4698     05  CRFNDSWI PIC  X(0003).
  4699*    -------------------------------
  4700     05  CLFHDGL PIC S9(0004) COMP.
  4701     05  CLFHDGF PIC  X(0001).
  4702     05  FILLER REDEFINES CLFHDGF.
  4703         10  CLFHDGA PIC  X(0001).
  4704     05  CLFHDGI PIC  X(0006).
  4705*    -------------------------------
  4706     05  CAHHDGL PIC S9(0004) COMP.
  4707     05  CAHHDGF PIC  X(0001).
  4708     05  FILLER REDEFINES CAHHDGF.
  4709         10  CAHHDGA PIC  X(0001).
  4710     05  CAHHDGI PIC  X(0006).
  4711*    -------------------------------
  4712     05  CENTDTL PIC S9(0004) COMP.
  4713     05  CENTDTF PIC  X(0001).
  4714     05  FILLER REDEFINES CENTDTF.
  4715         10  CENTDTA PIC  X(0001).
  4716     05  CENTDTI PIC  X(0008).
  4717*    -------------------------------
  4718     05  CENTBYL PIC S9(0004) COMP.
  4719     05  CENTBYF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  89
* EL6311.cbl
  4720     05  FILLER REDEFINES CENTBYF.
  4721         10  CENTBYA PIC  X(0001).
  4722     05  CENTBYI PIC  X(0004).
  4723*    -------------------------------
  4724     05  CCHGCNTL PIC S9(0004) COMP.
  4725     05  CCHGCNTF PIC  X(0001).
  4726     05  FILLER REDEFINES CCHGCNTF.
  4727         10  CCHGCNTA PIC  X(0001).
  4728     05  CCHGCNTI PIC  X(0003).
  4729*    -------------------------------
  4730     05  CLFREFNL PIC S9(0004) COMP.
  4731     05  CLFREFNF PIC  X(0001).
  4732     05  FILLER REDEFINES CLFREFNF.
  4733         10  CLFREFNA PIC  X(0001).
  4734     05  CLFREFNI PIC  X(0006).
  4735*    -------------------------------
  4736     05  CAHREFNL PIC S9(0004) COMP.
  4737     05  CAHREFNF PIC  X(0001).
  4738     05  FILLER REDEFINES CAHREFNF.
  4739         10  CAHREFNA PIC  X(0001).
  4740     05  CAHREFNI PIC  X(0006).
  4741*    -------------------------------
  4742     05  CREINCDL PIC S9(0004) COMP.
  4743     05  CREINCDF PIC  X(0001).
  4744     05  FILLER REDEFINES CREINCDF.
  4745         10  CREINCDA PIC  X(0001).
  4746     05  CREINCDI PIC  X(0003).
  4747*    -------------------------------
  4748     05  CAEFFDTL PIC S9(0004) COMP.
  4749     05  CAEFFDTF PIC  X(0001).
  4750     05  FILLER REDEFINES CAEFFDTF.
  4751         10  CAEFFDTA PIC  X(0001).
  4752     05  CAEFFDTI PIC  X(0008).
  4753*    -------------------------------
  4754     05  CAEXPDTL PIC S9(0004) COMP.
  4755     05  CAEXPDTF PIC  X(0001).
  4756     05  FILLER REDEFINES CAEXPDTF.
  4757         10  CAEXPDTA PIC  X(0001).
  4758     05  CAEXPDTI PIC  X(0008).
  4759*    -------------------------------
  4760     05  COMMLFL PIC S9(0004) COMP.
  4761     05  COMMLFF PIC  X(0001).
  4762     05  FILLER REDEFINES COMMLFF.
  4763         10  COMMLFA PIC  X(0001).
  4764     05  COMMLFI PIC  X(0006).
  4765*    -------------------------------
  4766     05  COMMAHL PIC S9(0004) COMP.
  4767     05  COMMAHF PIC  X(0001).
  4768     05  FILLER REDEFINES COMMAHF.
  4769         10  COMMAHA PIC  X(0001).
  4770     05  COMMAHI PIC  X(0006).
  4771*    -------------------------------
  4772     05  CERMSG1L PIC S9(0004) COMP.
  4773     05  CERMSG1F PIC  X(0001).
  4774     05  FILLER REDEFINES CERMSG1F.
  4775         10  CERMSG1A PIC  X(0001).
  4776     05  CERMSG1I PIC  X(0078).
  4777*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  90
* EL6311.cbl
  4778     05  CERMSG2L PIC S9(0004) COMP.
  4779     05  CERMSG2F PIC  X(0001).
  4780     05  FILLER REDEFINES CERMSG2F.
  4781         10  CERMSG2A PIC  X(0001).
  4782     05  CERMSG2I PIC  X(0078).
  4783*    -------------------------------
  4784     05  CERMSG3L PIC S9(0004) COMP.
  4785     05  CERMSG3F PIC  X(0001).
  4786     05  FILLER REDEFINES CERMSG3F.
  4787         10  CERMSG3A PIC  X(0001).
  4788     05  CERMSG3I PIC  X(0078).
  4789*    -------------------------------
  4790     05  CPFENTRL PIC S9(0004) COMP.
  4791     05  CPFENTRF PIC  X(0001).
  4792     05  FILLER REDEFINES CPFENTRF.
  4793         10  CPFENTRA PIC  X(0001).
  4794     05  CPFENTRI PIC  9(2).
  4795*    -------------------------------
  4796     05  CPF5HDRL PIC S9(0004) COMP.
  4797     05  CPF5HDRF PIC  X(0001).
  4798     05  FILLER REDEFINES CPF5HDRF.
  4799         10  CPF5HDRA PIC  X(0001).
  4800     05  CPF5HDRI PIC  X(0005).
  4801*    -------------------------------
  4802     05  CPF4HDRL PIC S9(0004) COMP.
  4803     05  CPF4HDRF PIC  X(0001).
  4804     05  FILLER REDEFINES CPF4HDRF.
  4805         10  CPF4HDRA PIC  X(0001).
  4806     05  CPF4HDRI PIC  X(0013).
  4807*    -------------------------------
  4808     05  CF15HDRL PIC S9(0004) COMP.
  4809     05  CF15HDRF PIC  X(0001).
  4810     05  FILLER REDEFINES CF15HDRF.
  4811         10  CF15HDRA PIC  X(0001).
  4812     05  CF15HDRI PIC  X(0022).
  4813 01  EL631CO REDEFINES EL631BI.
  4814     05  FILLER            PIC  X(0012).
  4815*    -------------------------------
  4816     05  FILLER            PIC  X(0003).
  4817     05  CDATEO PIC  X(0008).
  4818*    -------------------------------
  4819     05  FILLER            PIC  X(0003).
  4820     05  CTIMEO PIC  99.99.
  4821*    -------------------------------
  4822     05  FILLER            PIC  X(0003).
  4823     05  CHEADO PIC  X(0038).
  4824*    -------------------------------
  4825     05  FILLER            PIC  X(0003).
  4826     05  CCHGTO PIC  X(0004).
  4827*    -------------------------------
  4828     05  FILLER            PIC  X(0003).
  4829     05  CCHGO PIC  ZZZ9.
  4830*    -------------------------------
  4831     05  FILLER            PIC  X(0003).
  4832     05  CMAINTO PIC  X(0001).
  4833*    -------------------------------
  4834     05  FILLER            PIC  X(0003).
  4835     05  CMANTBYO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  91
* EL6311.cbl
  4836*    -------------------------------
  4837     05  FILLER            PIC  X(0003).
  4838     05  CCHGHDGO PIC  X(0003).
  4839*    -------------------------------
  4840     05  FILLER            PIC  X(0003).
  4841     05  CMANTDTO PIC  X(0008).
  4842*    -------------------------------
  4843     05  FILLER            PIC  X(0003).
  4844     05  CMANTATO PIC  99.99.
  4845*    -------------------------------
  4846     05  FILLER            PIC  X(0003).
  4847     05  CCSRO PIC  X(0004).
  4848*    -------------------------------
  4849     05  FILLER            PIC  X(0003).
  4850     05  CBATCHO PIC  X(0006).
  4851*    -------------------------------
  4852     05  FILLER            PIC  X(0003).
  4853     05  CSEQO PIC  X(0004).
  4854*    -------------------------------
  4855     05  FILLER            PIC  X(0003).
  4856     05  CMOENDTO PIC  X(0008).
  4857*    -------------------------------
  4858     05  FILLER            PIC  X(0003).
  4859     05  CCARRO PIC  X(0001).
  4860*    -------------------------------
  4861     05  FILLER            PIC  X(0003).
  4862     05  CGROUPO PIC  X(0006).
  4863*    -------------------------------
  4864     05  FILLER            PIC  X(0003).
  4865     05  CSTATEO PIC  X(0002).
  4866*    -------------------------------
  4867     05  FILLER            PIC  X(0003).
  4868     05  CACCTO PIC  X(0010).
  4869*    -------------------------------
  4870     05  FILLER            PIC  X(0003).
  4871     05  CORIGHDO PIC  X(0011).
  4872*    -------------------------------
  4873     05  FILLER            PIC  X(0003).
  4874     05  CORGNOO PIC  X(0006).
  4875*    -------------------------------
  4876     05  FILLER            PIC  X(0003).
  4877     05  CORGSEQO PIC  X(0004).
  4878*    -------------------------------
  4879     05  FILLER            PIC  X(0003).
  4880     05  CREFHDGO PIC  X(0010).
  4881*    -------------------------------
  4882     05  FILLER            PIC  X(0003).
  4883     05  CREFO PIC  X(0012).
  4884*    -------------------------------
  4885     05  FILLER            PIC  X(0003).
  4886     05  CNHINTO PIC  999999.99.
  4887*    -------------------------------
  4888     05  FILLER            PIC  X(0003).
  4889     05  CCERTNOO PIC  X(0010).
  4890*    -------------------------------
  4891     05  FILLER            PIC  X(0003).
  4892     05  CSUFIXO PIC  X(0001).
  4893*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  92
* EL6311.cbl
  4894     05  FILLER            PIC  X(0003).
  4895     05  CEFFDTO PIC  X(0008).
  4896*    -------------------------------
  4897     05  FILLER            PIC  X(0003).
  4898     05  CLSTNMO PIC  X(0015).
  4899*    -------------------------------
  4900     05  FILLER            PIC  X(0003).
  4901     05  CPCYNO PIC  X(0001).
  4902*    -------------------------------
  4903     05  FILLER            PIC  X(0003).
  4904     05  CINAMEO PIC  X(0015).
  4905*    -------------------------------
  4906     05  FILLER            PIC  X(0003).
  4907     05  CINITSO PIC  X(0010).
  4908*    -------------------------------
  4909     05  FILLER            PIC  X(0003).
  4910     05  CCANREAO PIC  X(0001).
  4911*    -------------------------------
  4912     05  FILLER            PIC  X(0003).
  4913     05  CKIND1O PIC  X(0002).
  4914*    -------------------------------
  4915     05  FILLER            PIC  X(0003).
  4916     05  CCANDT1O PIC  X(0008).
  4917*    -------------------------------
  4918     05  FILLER            PIC  X(0003).
  4919     05  CREFND1O PIC  Z(7).99-.
  4920*    -------------------------------
  4921     05  FILLER            PIC  X(0003).
  4922     05  CMTHD1O PIC  X(0001).
  4923*    -------------------------------
  4924     05  FILLER            PIC  X(0003).
  4925     05  CKIND2O PIC  X(0002).
  4926*    -------------------------------
  4927     05  FILLER            PIC  X(0003).
  4928     05  CCANDT2O PIC  X(0008).
  4929*    -------------------------------
  4930     05  FILLER            PIC  X(0003).
  4931     05  CREFND2O PIC  Z(7).99-.
  4932*    -------------------------------
  4933     05  FILLER            PIC  X(0003).
  4934     05  CMTHD2O PIC  X(0001).
  4935*    -------------------------------
  4936     05  FILLER            PIC  X(0003).
  4937     05  CLIVESO PIC  X(0003).
  4938*    -------------------------------
  4939     05  FILLER            PIC  X(0003).
  4940     05  CFORCEO PIC  X(0001).
  4941*    -------------------------------
  4942     05  FILLER            PIC  X(0003).
  4943     05  CBILCDO PIC  X(0001).
  4944*    -------------------------------
  4945     05  FILLER            PIC  X(0003).
  4946     05  CCRFND1O PIC  Z(7).99-.
  4947*    -------------------------------
  4948     05  FILLER            PIC  X(0003).
  4949     05  CCRFND2O PIC  Z(7).99-.
  4950*    -------------------------------
  4951     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  93
* EL6311.cbl
  4952     05  CBILIT1O PIC  X(0008).
  4953*    -------------------------------
  4954     05  FILLER            PIC  X(0003).
  4955     05  CDRFND1O PIC  Z(7).99-.
  4956*    -------------------------------
  4957     05  FILLER            PIC  X(0003).
  4958     05  CBILIT2O PIC  X(0008).
  4959*    -------------------------------
  4960     05  FILLER            PIC  X(0003).
  4961     05  CDRFND2O PIC  Z(7).99-.
  4962*    -------------------------------
  4963     05  FILLER            PIC  X(0003).
  4964     05  CCANTXTO PIC  X(0005).
  4965*    -------------------------------
  4966     05  FILLER            PIC  X(0003).
  4967     05  CCANFEEO PIC  Z9.
  4968*    -------------------------------
  4969     05  FILLER            PIC  X(0003).
  4970     05  CTERM1O PIC  ZZ9.
  4971*    -------------------------------
  4972     05  FILLER            PIC  X(0003).
  4973     05  CRTERM1O PIC  ZZ9.
  4974*    -------------------------------
  4975     05  FILLER            PIC  X(0003).
  4976     05  CPREM1O PIC  ZZZZZZ9.99-.
  4977*    -------------------------------
  4978     05  FILLER            PIC  X(0003).
  4979     05  CTERM2O PIC  ZZ9.
  4980*    -------------------------------
  4981     05  FILLER            PIC  X(0003).
  4982     05  CRTERM2O PIC  ZZ9.
  4983*    -------------------------------
  4984     05  FILLER            PIC  X(0003).
  4985     05  CPREM2O PIC  ZZZZZZ9.99-.
  4986*    -------------------------------
  4987     05  FILLER            PIC  X(0003).
  4988     05  CENTRDTO PIC  X(0008).
  4989*    -------------------------------
  4990     05  FILLER            PIC  X(0003).
  4991     05  CPAYEEO PIC  X(0006).
  4992*    -------------------------------
  4993     05  FILLER            PIC  X(0003).
  4994     05  CRFNDSWO PIC  X(0003).
  4995*    -------------------------------
  4996     05  FILLER            PIC  X(0003).
  4997     05  CLFHDGO PIC  X(0006).
  4998*    -------------------------------
  4999     05  FILLER            PIC  X(0003).
  5000     05  CAHHDGO PIC  X(0006).
  5001*    -------------------------------
  5002     05  FILLER            PIC  X(0003).
  5003     05  CENTDTO PIC  X(0008).
  5004*    -------------------------------
  5005     05  FILLER            PIC  X(0003).
  5006     05  CENTBYO PIC  X(0004).
  5007*    -------------------------------
  5008     05  FILLER            PIC  X(0003).
  5009     05  CCHGCNTO PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  94
* EL6311.cbl
  5010*    -------------------------------
  5011     05  FILLER            PIC  X(0003).
  5012     05  CLFREFNO PIC  X(0006).
  5013*    -------------------------------
  5014     05  FILLER            PIC  X(0003).
  5015     05  CAHREFNO PIC  X(0006).
  5016*    -------------------------------
  5017     05  FILLER            PIC  X(0003).
  5018     05  CREINCDO PIC  X(0003).
  5019*    -------------------------------
  5020     05  FILLER            PIC  X(0003).
  5021     05  CAEFFDTO PIC  X(0008).
  5022*    -------------------------------
  5023     05  FILLER            PIC  X(0003).
  5024     05  CAEXPDTO PIC  X(0008).
  5025*    -------------------------------
  5026     05  FILLER            PIC  X(0003).
  5027     05  COMMLFO PIC  .99999.
  5028*    -------------------------------
  5029     05  FILLER            PIC  X(0003).
  5030     05  COMMAHO PIC  .99999.
  5031*    -------------------------------
  5032     05  FILLER            PIC  X(0003).
  5033     05  CERMSG1O PIC  X(0078).
  5034*    -------------------------------
  5035     05  FILLER            PIC  X(0003).
  5036     05  CERMSG2O PIC  X(0078).
  5037*    -------------------------------
  5038     05  FILLER            PIC  X(0003).
  5039     05  CERMSG3O PIC  X(0078).
  5040*    -------------------------------
  5041     05  FILLER            PIC  X(0003).
  5042     05  CPFENTRO PIC  X(0002).
  5043*    -------------------------------
  5044     05  FILLER            PIC  X(0003).
  5045     05  CPF5HDRO PIC  X(0005).
  5046*    -------------------------------
  5047     05  FILLER            PIC  X(0003).
  5048     05  CPF4HDRO PIC  X(0013).
  5049*    -------------------------------
  5050     05  FILLER            PIC  X(0003).
  5051     05  CF15HDRO PIC  X(0022).
  5052*    -------------------------------
  5053 01  EL631DI REDEFINES EL631BI.
  5054     05  FILLER            PIC  X(0012).
  5055*    -------------------------------
  5056     05  DDATEL PIC S9(0004) COMP.
  5057     05  DDATEF PIC  X(0001).
  5058     05  FILLER REDEFINES DDATEF.
  5059         10  DDATEA PIC  X(0001).
  5060     05  DDATEI PIC  X(0008).
  5061*    -------------------------------
  5062     05  DTIMEL PIC S9(0004) COMP.
  5063     05  DTIMEF PIC  X(0001).
  5064     05  FILLER REDEFINES DTIMEF.
  5065         10  DTIMEA PIC  X(0001).
  5066     05  DTIMEI PIC  X(0005).
  5067*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  95
* EL6311.cbl
  5068     05  DHEADL PIC S9(0004) COMP.
  5069     05  DHEADF PIC  X(0001).
  5070     05  FILLER REDEFINES DHEADF.
  5071         10  DHEADA PIC  X(0001).
  5072     05  DHEADI PIC  X(0038).
  5073*    -------------------------------
  5074     05  DLDATEL PIC S9(0004) COMP.
  5075     05  DLDATEF PIC  X(0001).
  5076     05  FILLER REDEFINES DLDATEF.
  5077         10  DLDATEA PIC  X(0001).
  5078     05  DLDATEI PIC  X(0010).
  5079*    -------------------------------
  5080     05  DBATCHL PIC S9(0004) COMP.
  5081     05  DBATCHF PIC  X(0001).
  5082     05  FILLER REDEFINES DBATCHF.
  5083         10  DBATCHA PIC  X(0001).
  5084     05  DBATCHI PIC  X(0011).
  5085*    -------------------------------
  5086     05  DACCTNML PIC S9(0004) COMP.
  5087     05  DACCTNMF PIC  X(0001).
  5088     05  FILLER REDEFINES DACCTNMF.
  5089         10  DACCTNMA PIC  X(0001).
  5090     05  DACCTNMI PIC  X(0030).
  5091*    -------------------------------
  5092     05  DPROCDTL PIC S9(0004) COMP.
  5093     05  DPROCDTF PIC  X(0001).
  5094     05  FILLER REDEFINES DPROCDTF.
  5095         10  DPROCDTA PIC  X(0001).
  5096     05  DPROCDTI PIC  X(0008).
  5097*    -------------------------------
  5098     05  DINPUTL PIC S9(0004) COMP.
  5099     05  DINPUTF PIC  X(0001).
  5100     05  FILLER REDEFINES DINPUTF.
  5101         10  DINPUTA PIC  X(0001).
  5102     05  DINPUTI PIC  X(0008).
  5103*    -------------------------------
  5104     05  DMAINDTL PIC S9(0004) COMP.
  5105     05  DMAINDTF PIC  X(0001).
  5106     05  FILLER REDEFINES DMAINDTF.
  5107         10  DMAINDTA PIC  X(0001).
  5108     05  DMAINDTI PIC  X(0008).
  5109*    -------------------------------
  5110     05  DCARRL PIC S9(0004) COMP.
  5111     05  DCARRF PIC  X(0001).
  5112     05  FILLER REDEFINES DCARRF.
  5113         10  DCARRA PIC  X(0001).
  5114     05  DCARRI PIC  X(0001).
  5115*    -------------------------------
  5116     05  DGROUPL PIC S9(0004) COMP.
  5117     05  DGROUPF PIC  X(0001).
  5118     05  FILLER REDEFINES DGROUPF.
  5119         10  DGROUPA PIC  X(0001).
  5120     05  DGROUPI PIC  X(0006).
  5121*    -------------------------------
  5122     05  DSTATEL PIC S9(0004) COMP.
  5123     05  DSTATEF PIC  X(0001).
  5124     05  FILLER REDEFINES DSTATEF.
  5125         10  DSTATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  96
* EL6311.cbl
  5126     05  DSTATEI PIC  X(0002).
  5127*    -------------------------------
  5128     05  DACCTL PIC S9(0004) COMP.
  5129     05  DACCTF PIC  X(0001).
  5130     05  FILLER REDEFINES DACCTF.
  5131         10  DACCTA PIC  X(0001).
  5132     05  DACCTI PIC  X(0010).
  5133*    -------------------------------
  5134     05  DRECVDTL PIC S9(0004) COMP.
  5135     05  DRECVDTF PIC  X(0001).
  5136     05  FILLER REDEFINES DRECVDTF.
  5137         10  DRECVDTA PIC  X(0001).
  5138     05  DRECVDTI PIC  X(0008).
  5139*    -------------------------------
  5140     05  DCSRL PIC S9(0004) COMP.
  5141     05  DCSRF PIC  X(0001).
  5142     05  FILLER REDEFINES DCSRF.
  5143         10  DCSRA PIC  X(0001).
  5144     05  DCSRI PIC  X(0004).
  5145*    -------------------------------
  5146     05  DREFHDGL PIC S9(0004) COMP.
  5147     05  DREFHDGF PIC  X(0001).
  5148     05  FILLER REDEFINES DREFHDGF.
  5149         10  DREFHDGA PIC  X(0001).
  5150     05  DREFHDGI PIC  X(0010).
  5151*    -------------------------------
  5152     05  DREFL PIC S9(0004) COMP.
  5153     05  DREFF PIC  X(0001).
  5154     05  FILLER REDEFINES DREFF.
  5155         10  DREFA PIC  X(0001).
  5156     05  DREFI PIC  X(0012).
  5157*    -------------------------------
  5158     05  DLFPHDGL PIC S9(0004) COMP.
  5159     05  DLFPHDGF PIC  X(0001).
  5160     05  FILLER REDEFINES DLFPHDGF.
  5161         10  DLFPHDGA PIC  X(0001).
  5162     05  DLFPHDGI PIC  X(0010).
  5163*    -------------------------------
  5164     05  DAHPHDGL PIC S9(0004) COMP.
  5165     05  DAHPHDGF PIC  X(0001).
  5166     05  FILLER REDEFINES DAHPHDGF.
  5167         10  DAHPHDGA PIC  X(0001).
  5168     05  DAHPHDGI PIC  X(0010).
  5169*    -------------------------------
  5170     05  DLFRHDGL PIC S9(0004) COMP.
  5171     05  DLFRHDGF PIC  X(0001).
  5172     05  FILLER REDEFINES DLFRHDGF.
  5173         10  DLFRHDGA PIC  X(0001).
  5174     05  DLFRHDGI PIC  X(0009).
  5175*    -------------------------------
  5176     05  DAHRHDGL PIC S9(0004) COMP.
  5177     05  DAHRHDGF PIC  X(0001).
  5178     05  FILLER REDEFINES DAHRHDGF.
  5179         10  DAHRHDGA PIC  X(0001).
  5180     05  DAHRHDGI PIC  X(0009).
  5181*    -------------------------------
  5182     05  DRISSL PIC S9(0004) COMP.
  5183     05  DRISSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  97
* EL6311.cbl
  5184     05  FILLER REDEFINES DRISSF.
  5185         10  DRISSA PIC  X(0001).
  5186     05  DRISSI PIC  X(0005).
  5187*    -------------------------------
  5188     05  DRLFPRML PIC S9(0004) COMP.
  5189     05  DRLFPRMF PIC  X(0001).
  5190     05  FILLER REDEFINES DRLFPRMF.
  5191         10  DRLFPRMA PIC  X(0001).
  5192     05  DRLFPRMI PIC  S9(9)V99.
  5193*    -------------------------------
  5194     05  DRAHPRML PIC S9(0004) COMP.
  5195     05  DRAHPRMF PIC  X(0001).
  5196     05  FILLER REDEFINES DRAHPRMF.
  5197         10  DRAHPRMA PIC  X(0001).
  5198     05  DRAHPRMI PIC  S9(9)V99.
  5199*    -------------------------------
  5200     05  DRCANCL PIC S9(0004) COMP.
  5201     05  DRCANCF PIC  X(0001).
  5202     05  FILLER REDEFINES DRCANCF.
  5203         10  DRCANCA PIC  X(0001).
  5204     05  DRCANCI PIC  X(0005).
  5205*    -------------------------------
  5206     05  DRLFRFDL PIC S9(0004) COMP.
  5207     05  DRLFRFDF PIC  X(0001).
  5208     05  FILLER REDEFINES DRLFRFDF.
  5209         10  DRLFRFDA PIC  X(0001).
  5210     05  DRLFRFDI PIC  S9(9)V99.
  5211*    -------------------------------
  5212     05  DRAHRFDL PIC S9(0004) COMP.
  5213     05  DRAHRFDF PIC  X(0001).
  5214     05  FILLER REDEFINES DRAHRFDF.
  5215         10  DRAHRFDA PIC  X(0001).
  5216     05  DRAHRFDI PIC  S9(9)V99.
  5217*    -------------------------------
  5218     05  DEISSL PIC S9(0004) COMP.
  5219     05  DEISSF PIC  X(0001).
  5220     05  FILLER REDEFINES DEISSF.
  5221         10  DEISSA PIC  X(0001).
  5222     05  DEISSI PIC  X(0005).
  5223*    -------------------------------
  5224     05  DELFPRML PIC S9(0004) COMP.
  5225     05  DELFPRMF PIC  X(0001).
  5226     05  FILLER REDEFINES DELFPRMF.
  5227         10  DELFPRMA PIC  X(0001).
  5228     05  DELFPRMI PIC  X(0011).
  5229*    -------------------------------
  5230     05  DEAHPRML PIC S9(0004) COMP.
  5231     05  DEAHPRMF PIC  X(0001).
  5232     05  FILLER REDEFINES DEAHPRMF.
  5233         10  DEAHPRMA PIC  X(0001).
  5234     05  DEAHPRMI PIC  X(0011).
  5235*    -------------------------------
  5236     05  DECANCL PIC S9(0004) COMP.
  5237     05  DECANCF PIC  X(0001).
  5238     05  FILLER REDEFINES DECANCF.
  5239         10  DECANCA PIC  X(0001).
  5240     05  DECANCI PIC  X(0005).
  5241*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  98
* EL6311.cbl
  5242     05  DELFRFDL PIC S9(0004) COMP.
  5243     05  DELFRFDF PIC  X(0001).
  5244     05  FILLER REDEFINES DELFRFDF.
  5245         10  DELFRFDA PIC  X(0001).
  5246     05  DELFRFDI PIC  X(0011).
  5247*    -------------------------------
  5248     05  DEAHRFDL PIC S9(0004) COMP.
  5249     05  DEAHRFDF PIC  X(0001).
  5250     05  FILLER REDEFINES DEAHRFDF.
  5251         10  DEAHRFDA PIC  X(0001).
  5252     05  DEAHRFDI PIC  X(0011).
  5253*    -------------------------------
  5254     05  DCISSL PIC S9(0004) COMP.
  5255     05  DCISSF PIC  X(0001).
  5256     05  FILLER REDEFINES DCISSF.
  5257         10  DCISSA PIC  X(0001).
  5258     05  DCISSI PIC  X(0005).
  5259*    -------------------------------
  5260     05  DCLFPRML PIC S9(0004) COMP.
  5261     05  DCLFPRMF PIC  X(0001).
  5262     05  FILLER REDEFINES DCLFPRMF.
  5263         10  DCLFPRMA PIC  X(0001).
  5264     05  DCLFPRMI PIC  X(0011).
  5265*    -------------------------------
  5266     05  DCAHPRML PIC S9(0004) COMP.
  5267     05  DCAHPRMF PIC  X(0001).
  5268     05  FILLER REDEFINES DCAHPRMF.
  5269         10  DCAHPRMA PIC  X(0001).
  5270     05  DCAHPRMI PIC  X(0011).
  5271*    -------------------------------
  5272     05  DCCANCL PIC S9(0004) COMP.
  5273     05  DCCANCF PIC  X(0001).
  5274     05  FILLER REDEFINES DCCANCF.
  5275         10  DCCANCA PIC  X(0001).
  5276     05  DCCANCI PIC  X(0005).
  5277*    -------------------------------
  5278     05  DCLFRFDL PIC S9(0004) COMP.
  5279     05  DCLFRFDF PIC  X(0001).
  5280     05  FILLER REDEFINES DCLFRFDF.
  5281         10  DCLFRFDA PIC  X(0001).
  5282     05  DCLFRFDI PIC  X(0011).
  5283*    -------------------------------
  5284     05  DCAHRFDL PIC S9(0004) COMP.
  5285     05  DCAHRFDF PIC  X(0001).
  5286     05  FILLER REDEFINES DCAHRFDF.
  5287         10  DCAHRFDA PIC  X(0001).
  5288     05  DCAHRFDI PIC  X(0011).
  5289*    -------------------------------
  5290     05  DOISSL PIC S9(0004) COMP.
  5291     05  DOISSF PIC  X(0001).
  5292     05  FILLER REDEFINES DOISSF.
  5293         10  DOISSA PIC  X(0001).
  5294     05  DOISSI PIC  X(0005).
  5295*    -------------------------------
  5296     05  DOLFPRML PIC S9(0004) COMP.
  5297     05  DOLFPRMF PIC  X(0001).
  5298     05  FILLER REDEFINES DOLFPRMF.
  5299         10  DOLFPRMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  99
* EL6311.cbl
  5300     05  DOLFPRMI PIC  X(0011).
  5301*    -------------------------------
  5302     05  DOAHPRML PIC S9(0004) COMP.
  5303     05  DOAHPRMF PIC  X(0001).
  5304     05  FILLER REDEFINES DOAHPRMF.
  5305         10  DOAHPRMA PIC  X(0001).
  5306     05  DOAHPRMI PIC  X(0011).
  5307*    -------------------------------
  5308     05  DOCANCL PIC S9(0004) COMP.
  5309     05  DOCANCF PIC  X(0001).
  5310     05  FILLER REDEFINES DOCANCF.
  5311         10  DOCANCA PIC  X(0001).
  5312     05  DOCANCI PIC  X(0005).
  5313*    -------------------------------
  5314     05  DOLFRFDL PIC S9(0004) COMP.
  5315     05  DOLFRFDF PIC  X(0001).
  5316     05  FILLER REDEFINES DOLFRFDF.
  5317         10  DOLFRFDA PIC  X(0001).
  5318     05  DOLFRFDI PIC  X(0011).
  5319*    -------------------------------
  5320     05  DOAHRFDL PIC S9(0004) COMP.
  5321     05  DOAHRFDF PIC  X(0001).
  5322     05  FILLER REDEFINES DOAHRFDF.
  5323         10  DOAHRFDA PIC  X(0001).
  5324     05  DOAHRFDI PIC  X(0011).
  5325*    -------------------------------
  5326     05  DITOTALL PIC S9(0004) COMP.
  5327     05  DITOTALF PIC  X(0001).
  5328     05  FILLER REDEFINES DITOTALF.
  5329         10  DITOTALA PIC  X(0001).
  5330     05  DITOTALI PIC  X(0005).
  5331*    -------------------------------
  5332     05  DIFATALL PIC S9(0004) COMP.
  5333     05  DIFATALF PIC  X(0001).
  5334     05  FILLER REDEFINES DIFATALF.
  5335         10  DIFATALA PIC  X(0001).
  5336     05  DIFATALI PIC  X(0005).
  5337*    -------------------------------
  5338     05  DIFORCEL PIC S9(0004) COMP.
  5339     05  DIFORCEF PIC  X(0001).
  5340     05  FILLER REDEFINES DIFORCEF.
  5341         10  DIFORCEA PIC  X(0001).
  5342     05  DIFORCEI PIC  X(0005).
  5343*    -------------------------------
  5344     05  DIHOLDL PIC S9(0004) COMP.
  5345     05  DIHOLDF PIC  X(0001).
  5346     05  FILLER REDEFINES DIHOLDF.
  5347         10  DIHOLDA PIC  X(0001).
  5348     05  DIHOLDI PIC  X(0005).
  5349*    -------------------------------
  5350     05  DIAVAILL PIC S9(0004) COMP.
  5351     05  DIAVAILF PIC  X(0001).
  5352     05  FILLER REDEFINES DIAVAILF.
  5353         10  DIAVAILA PIC  X(0001).
  5354     05  DIAVAILI PIC  X(0005).
  5355*    -------------------------------
  5356     05  DIGPREML PIC S9(0004) COMP.
  5357     05  DIGPREMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 100
* EL6311.cbl
  5358     05  FILLER REDEFINES DIGPREMF.
  5359         10  DIGPREMA PIC  X(0001).
  5360     05  DIGPREMI PIC  X(0011).
  5361*    -------------------------------
  5362     05  DIBPREML PIC S9(0004) COMP.
  5363     05  DIBPREMF PIC  X(0001).
  5364     05  FILLER REDEFINES DIBPREMF.
  5365         10  DIBPREMA PIC  X(0001).
  5366     05  DIBPREMI PIC  X(0011).
  5367*    -------------------------------
  5368     05  DCTOTALL PIC S9(0004) COMP.
  5369     05  DCTOTALF PIC  X(0001).
  5370     05  FILLER REDEFINES DCTOTALF.
  5371         10  DCTOTALA PIC  X(0001).
  5372     05  DCTOTALI PIC  X(0005).
  5373*    -------------------------------
  5374     05  DCFATALL PIC S9(0004) COMP.
  5375     05  DCFATALF PIC  X(0001).
  5376     05  FILLER REDEFINES DCFATALF.
  5377         10  DCFATALA PIC  X(0001).
  5378     05  DCFATALI PIC  X(0005).
  5379*    -------------------------------
  5380     05  DCFORCEL PIC S9(0004) COMP.
  5381     05  DCFORCEF PIC  X(0001).
  5382     05  FILLER REDEFINES DCFORCEF.
  5383         10  DCFORCEA PIC  X(0001).
  5384     05  DCFORCEI PIC  X(0005).
  5385*    -------------------------------
  5386     05  DCHOLDL PIC S9(0004) COMP.
  5387     05  DCHOLDF PIC  X(0001).
  5388     05  FILLER REDEFINES DCHOLDF.
  5389         10  DCHOLDA PIC  X(0001).
  5390     05  DCHOLDI PIC  X(0005).
  5391*    -------------------------------
  5392     05  DCAVAILL PIC S9(0004) COMP.
  5393     05  DCAVAILF PIC  X(0001).
  5394     05  FILLER REDEFINES DCAVAILF.
  5395         10  DCAVAILA PIC  X(0001).
  5396     05  DCAVAILI PIC  X(0005).
  5397*    -------------------------------
  5398     05  DCGPREML PIC S9(0004) COMP.
  5399     05  DCGPREMF PIC  X(0001).
  5400     05  FILLER REDEFINES DCGPREMF.
  5401         10  DCGPREMA PIC  X(0001).
  5402     05  DCGPREMI PIC  X(0011).
  5403*    -------------------------------
  5404     05  DCBPREML PIC S9(0004) COMP.
  5405     05  DCBPREMF PIC  X(0001).
  5406     05  FILLER REDEFINES DCBPREMF.
  5407         10  DCBPREMA PIC  X(0001).
  5408     05  DCBPREMI PIC  X(0011).
  5409*    -------------------------------
  5410     05  DNTOTALL PIC S9(0004) COMP.
  5411     05  DNTOTALF PIC  X(0001).
  5412     05  FILLER REDEFINES DNTOTALF.
  5413         10  DNTOTALA PIC  X(0001).
  5414     05  DNTOTALI PIC  X(0005).
  5415*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 101
* EL6311.cbl
  5416     05  DNFATALL PIC S9(0004) COMP.
  5417     05  DNFATALF PIC  X(0001).
  5418     05  FILLER REDEFINES DNFATALF.
  5419         10  DNFATALA PIC  X(0001).
  5420     05  DNFATALI PIC  X(0005).
  5421*    -------------------------------
  5422     05  DNFORCEL PIC S9(0004) COMP.
  5423     05  DNFORCEF PIC  X(0001).
  5424     05  FILLER REDEFINES DNFORCEF.
  5425         10  DNFORCEA PIC  X(0001).
  5426     05  DNFORCEI PIC  X(0005).
  5427*    -------------------------------
  5428     05  DNHOLDL PIC S9(0004) COMP.
  5429     05  DNHOLDF PIC  X(0001).
  5430     05  FILLER REDEFINES DNHOLDF.
  5431         10  DNHOLDA PIC  X(0001).
  5432     05  DNHOLDI PIC  X(0005).
  5433*    -------------------------------
  5434     05  DNAVAILL PIC S9(0004) COMP.
  5435     05  DNAVAILF PIC  X(0001).
  5436     05  FILLER REDEFINES DNAVAILF.
  5437         10  DNAVAILA PIC  X(0001).
  5438     05  DNAVAILI PIC  X(0005).
  5439*    -------------------------------
  5440     05  DNGPREML PIC S9(0004) COMP.
  5441     05  DNGPREMF PIC  X(0001).
  5442     05  FILLER REDEFINES DNGPREMF.
  5443         10  DNGPREMA PIC  X(0001).
  5444     05  DNGPREMI PIC  X(0011).
  5445*    -------------------------------
  5446     05  DNBPREML PIC S9(0004) COMP.
  5447     05  DNBPREMF PIC  X(0001).
  5448     05  FILLER REDEFINES DNBPREMF.
  5449         10  DNBPREMA PIC  X(0001).
  5450     05  DNBPREMI PIC  X(0011).
  5451*    -------------------------------
  5452     05  DERMSGL PIC S9(0004) COMP.
  5453     05  DERMSGF PIC  X(0001).
  5454     05  FILLER REDEFINES DERMSGF.
  5455         10  DERMSGA PIC  X(0001).
  5456     05  DERMSGI PIC  X(0075).
  5457*    -------------------------------
  5458     05  DPFENTRL PIC S9(0004) COMP.
  5459     05  DPFENTRF PIC  X(0001).
  5460     05  FILLER REDEFINES DPFENTRF.
  5461         10  DPFENTRA PIC  X(0001).
  5462     05  DPFENTRI PIC  9(2).
  5463 01  EL631DO REDEFINES EL631BI.
  5464     05  FILLER            PIC  X(0012).
  5465*    -------------------------------
  5466     05  FILLER            PIC  X(0003).
  5467     05  DDATEO PIC  X(0008).
  5468*    -------------------------------
  5469     05  FILLER            PIC  X(0003).
  5470     05  DTIMEO PIC  99.99.
  5471*    -------------------------------
  5472     05  FILLER            PIC  X(0003).
  5473     05  DHEADO PIC  X(0038).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 102
* EL6311.cbl
  5474*    -------------------------------
  5475     05  FILLER            PIC  X(0003).
  5476     05  DLDATEO PIC  X(0010).
  5477*    -------------------------------
  5478     05  FILLER            PIC  X(0003).
  5479     05  DBATCHO PIC  X(0011).
  5480*    -------------------------------
  5481     05  FILLER            PIC  X(0003).
  5482     05  DACCTNMO PIC  X(0030).
  5483*    -------------------------------
  5484     05  FILLER            PIC  X(0003).
  5485     05  DPROCDTO PIC  X(0008).
  5486*    -------------------------------
  5487     05  FILLER            PIC  X(0003).
  5488     05  DINPUTO PIC  X(0008).
  5489*    -------------------------------
  5490     05  FILLER            PIC  X(0003).
  5491     05  DMAINDTO PIC  X(0008).
  5492*    -------------------------------
  5493     05  FILLER            PIC  X(0003).
  5494     05  DCARRO PIC  X(0001).
  5495*    -------------------------------
  5496     05  FILLER            PIC  X(0003).
  5497     05  DGROUPO PIC  X(0006).
  5498*    -------------------------------
  5499     05  FILLER            PIC  X(0003).
  5500     05  DSTATEO PIC  X(0002).
  5501*    -------------------------------
  5502     05  FILLER            PIC  X(0003).
  5503     05  DACCTO PIC  X(0010).
  5504*    -------------------------------
  5505     05  FILLER            PIC  X(0003).
  5506     05  DRECVDTO PIC  X(0008).
  5507*    -------------------------------
  5508     05  FILLER            PIC  X(0003).
  5509     05  DCSRO PIC  X(0004).
  5510*    -------------------------------
  5511     05  FILLER            PIC  X(0003).
  5512     05  DREFHDGO PIC  X(0010).
  5513*    -------------------------------
  5514     05  FILLER            PIC  X(0003).
  5515     05  DREFO PIC  X(0012).
  5516*    -------------------------------
  5517     05  FILLER            PIC  X(0003).
  5518     05  DLFPHDGO PIC  X(0010).
  5519*    -------------------------------
  5520     05  FILLER            PIC  X(0003).
  5521     05  DAHPHDGO PIC  X(0010).
  5522*    -------------------------------
  5523     05  FILLER            PIC  X(0003).
  5524     05  DLFRHDGO PIC  X(0009).
  5525*    -------------------------------
  5526     05  FILLER            PIC  X(0003).
  5527     05  DAHRHDGO PIC  X(0009).
  5528*    -------------------------------
  5529     05  FILLER            PIC  X(0003).
  5530     05  DRISSO PIC  ZZ99-.
  5531*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 103
* EL6311.cbl
  5532     05  FILLER            PIC  X(0003).
  5533     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5534*    -------------------------------
  5535     05  FILLER            PIC  X(0003).
  5536     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5537*    -------------------------------
  5538     05  FILLER            PIC  X(0003).
  5539     05  DRCANCO PIC  ZZ99-.
  5540*    -------------------------------
  5541     05  FILLER            PIC  X(0003).
  5542     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5543*    -------------------------------
  5544     05  FILLER            PIC  X(0003).
  5545     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5546*    -------------------------------
  5547     05  FILLER            PIC  X(0003).
  5548     05  DEISSO PIC  ZZ99-.
  5549*    -------------------------------
  5550     05  FILLER            PIC  X(0003).
  5551     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5552*    -------------------------------
  5553     05  FILLER            PIC  X(0003).
  5554     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5555*    -------------------------------
  5556     05  FILLER            PIC  X(0003).
  5557     05  DECANCO PIC  ZZ99-.
  5558*    -------------------------------
  5559     05  FILLER            PIC  X(0003).
  5560     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5561*    -------------------------------
  5562     05  FILLER            PIC  X(0003).
  5563     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5564*    -------------------------------
  5565     05  FILLER            PIC  X(0003).
  5566     05  DCISSO PIC  ZZ99-.
  5567*    -------------------------------
  5568     05  FILLER            PIC  X(0003).
  5569     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5570*    -------------------------------
  5571     05  FILLER            PIC  X(0003).
  5572     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5573*    -------------------------------
  5574     05  FILLER            PIC  X(0003).
  5575     05  DCCANCO PIC  ZZ99-.
  5576*    -------------------------------
  5577     05  FILLER            PIC  X(0003).
  5578     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5579*    -------------------------------
  5580     05  FILLER            PIC  X(0003).
  5581     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5582*    -------------------------------
  5583     05  FILLER            PIC  X(0003).
  5584     05  DOISSO PIC  ZZ99-.
  5585*    -------------------------------
  5586     05  FILLER            PIC  X(0003).
  5587     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5588*    -------------------------------
  5589     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 104
* EL6311.cbl
  5590     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5591*    -------------------------------
  5592     05  FILLER            PIC  X(0003).
  5593     05  DOCANCO PIC  ZZ99-.
  5594*    -------------------------------
  5595     05  FILLER            PIC  X(0003).
  5596     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5597*    -------------------------------
  5598     05  FILLER            PIC  X(0003).
  5599     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5600*    -------------------------------
  5601     05  FILLER            PIC  X(0003).
  5602     05  DITOTALO PIC  ZZZ99.
  5603*    -------------------------------
  5604     05  FILLER            PIC  X(0003).
  5605     05  DIFATALO PIC  ZZZ99.
  5606*    -------------------------------
  5607     05  FILLER            PIC  X(0003).
  5608     05  DIFORCEO PIC  ZZZ99.
  5609*    -------------------------------
  5610     05  FILLER            PIC  X(0003).
  5611     05  DIHOLDO PIC  ZZZ99.
  5612*    -------------------------------
  5613     05  FILLER            PIC  X(0003).
  5614     05  DIAVAILO PIC  ZZZ99.
  5615*    -------------------------------
  5616     05  FILLER            PIC  X(0003).
  5617     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5618*    -------------------------------
  5619     05  FILLER            PIC  X(0003).
  5620     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5621*    -------------------------------
  5622     05  FILLER            PIC  X(0003).
  5623     05  DCTOTALO PIC  ZZZ99.
  5624*    -------------------------------
  5625     05  FILLER            PIC  X(0003).
  5626     05  DCFATALO PIC  ZZZ99.
  5627*    -------------------------------
  5628     05  FILLER            PIC  X(0003).
  5629     05  DCFORCEO PIC  ZZZ99.
  5630*    -------------------------------
  5631     05  FILLER            PIC  X(0003).
  5632     05  DCHOLDO PIC  ZZZ99.
  5633*    -------------------------------
  5634     05  FILLER            PIC  X(0003).
  5635     05  DCAVAILO PIC  ZZZ99.
  5636*    -------------------------------
  5637     05  FILLER            PIC  X(0003).
  5638     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5639*    -------------------------------
  5640     05  FILLER            PIC  X(0003).
  5641     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5642*    -------------------------------
  5643     05  FILLER            PIC  X(0003).
  5644     05  DNTOTALO PIC  ---99.
  5645*    -------------------------------
  5646     05  FILLER            PIC  X(0003).
  5647     05  DNFATALO PIC  ---99.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 105
* EL6311.cbl
  5648*    -------------------------------
  5649     05  FILLER            PIC  X(0003).
  5650     05  DNFORCEO PIC  ---99.
  5651*    -------------------------------
  5652     05  FILLER            PIC  X(0003).
  5653     05  DNHOLDO PIC  ---99.
  5654*    -------------------------------
  5655     05  FILLER            PIC  X(0003).
  5656     05  DNAVAILO PIC  ---99.
  5657*    -------------------------------
  5658     05  FILLER            PIC  X(0003).
  5659     05  DNGPREMO PIC  -------9.99.
  5660*    -------------------------------
  5661     05  FILLER            PIC  X(0003).
  5662     05  DNBPREMO PIC  -------9.99.
  5663*    -------------------------------
  5664     05  FILLER            PIC  X(0003).
  5665     05  DERMSGO PIC  X(0075).
  5666*    -------------------------------
  5667     05  FILLER            PIC  X(0003).
  5668     05  DPFENTRO PIC  X(0002).
  5669*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 106
* EL6311.cbl
  5671 01  MAP-B REDEFINES EL631BI.
  5672     12  FILLER                  PIC X(591).
  5673*    12  FILLER                  PIC X(512).
  5674*    12  FILLER                  PIC X(510).
  5675     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5676         16  BKIND-LEN               PIC S9(4)  COMP.
  5677         16  BKIND-ATTRB             PIC X.
  5678         16  BKIND                   PIC XX.
  5679         16  BTYPE-LEN               PIC S9(4)  COMP.
  5680         16  BTYPE-ATTRB             PIC X.
  5681         16  BTYPE                   PIC X(3).
  5682         16  BTERM-LEN               PIC S9(4)  COMP.
  5683         16  BTERM-ATTRB             PIC X.
  5684         16  BTERMI                  PIC 999.
  5685         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5686         16  BBEN-LEN                PIC S9(4)  COMP.
  5687         16  BBEN-ATTRB              PIC X.
  5688         16  BBENI                   PIC 9(10)V99.
  5689*        16  BBENI                   PIC 9(12).
  5690         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5691         16  BPREM-LEN               PIC S9(4)  COMP.
  5692         16  BPREM-ATTRB             PIC X.
  5693         16  BPREMI                  PIC S9(9)V99.
  5694*        16  BPREMI                  PIC 9(11).
  5695         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5696         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5697         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5698         16  BEXPIRE-ATTRB           PIC X.
  5699         16  BEXPIRE                 PIC X(8).
  5700         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5701         16  BCRIT-PERD-ATTRB        PIC X.
  5702         16  BCRIT-PERDI             PIC 99.
  5703         16  BCRIT-PERDO REDEFINES
  5704                         BCRIT-PERDI PIC ZZ.
  5705         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5706         16  BALT-BEN-ATTRB          PIC X.
  5707         16  BALT-BENI               PIC 9(10)V99.
  5708*        16  BALT-BENI               PIC 9(12).
  5709         16  BALT-BENO REDEFINES
  5710                           BALT-BENI PIC Z(9).ZZ.
  5711         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5712         16  BALT-PREM-ATTRB         PIC X.
  5713         16  BALT-PREMI              PIC 9(9)V99.
  5714*        16  BALT-PREMI              PIC 9(11).
  5715         16  BALT-PREMO REDEFINES
  5716                          BALT-PREMI PIC Z(7).ZZ-.
  5717         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5718         16  BBEN-CD-ATTRB           PIC X.
  5719         16  BBEN-CD                 PIC XXX.
  5720         16  BCPREM-LEN              PIC S9(4)  COMP.
  5721         16  BCPREM-ATTRB            PIC X.
  5722         16  BCPREMI                 PIC S9(9)V99.
  5723*        16  BCPREMI                 PIC X(11).
  5724         16  BCPREMO REDEFINES BCPREMI
  5725                                     PIC Z(7).99-.
  5726         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5727         16  BCALT-PREM-ATTRB        PIC X.
  5728         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 107
* EL6311.cbl
  5729         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5730         16  BBEN-ABBR-ATTRB         PIC X.
  5731         16  BBEN-ABBR               PIC X(5).
  5732         16  BDIFF-LEN               PIC S9(4)  COMP.
  5733         16  BDIFF-ATTRB             PIC X.
  5734         16  BDIFFO                  PIC Z(7).99-.
  5735         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5736         16  BBILL-LIT-ATTRB         PIC X.
  5737         16  BBILL-LIT               PIC X(8).
  5738         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5739         16  BDALT-PREM-ATTRB        PIC X.
  5740         16  BDALT-PREM              PIC Z(7).99-.
  5741
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 108
* EL6311.cbl
  5743
  5744****************************************************************
  5745*
  5746* Copyright (c) 2007 by Clerity Solutions, Inc.
  5747* All rights reserved.
  5748*
  5749****************************************************************
  5750 01  DFHEIV.
  5751   02  DFHEIV0               PIC X(35).
  5752   02  DFHEIV1               PIC X(08).
  5753   02  DFHEIV2               PIC X(08).
  5754   02  DFHEIV3               PIC X(08).
  5755   02  DFHEIV4               PIC X(06).
  5756   02  DFHEIV5               PIC X(04).
  5757   02  DFHEIV6               PIC X(04).
  5758   02  DFHEIV7               PIC X(02).
  5759   02  DFHEIV8               PIC X(02).
  5760   02  DFHEIV9               PIC X(01).
  5761   02  DFHEIV10              PIC S9(7) COMP-3.
  5762   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5763   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5764   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5765   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5766   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5767   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5768   02  DFHEIV17              PIC X(04).
  5769   02  DFHEIV18              PIC X(04).
  5770   02  DFHEIV19              PIC X(04).
  5771   02  DFHEIV20              USAGE IS POINTER.
  5772   02  DFHEIV21              USAGE IS POINTER.
  5773   02  DFHEIV22              USAGE IS POINTER.
  5774   02  DFHEIV23              USAGE IS POINTER.
  5775   02  DFHEIV24              USAGE IS POINTER.
  5776   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5777   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5778   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5779   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5780   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5781   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5782   02  FILLER                PIC X(02).
  5783   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5784   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5785   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5786   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5787   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5788 LINKAGE  SECTION.
  5789*****************************************************************
  5790*                                                               *
  5791* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5792* All rights reserved.                                          *
  5793*                                                               *
  5794*****************************************************************
  5795 01  dfheiblk.
  5796     02  eibtime          pic s9(7) comp-3.
  5797     02  eibdate          pic s9(7) comp-3.
  5798     02  eibtrnid         pic x(4).
  5799     02  eibtaskn         pic s9(7) comp-3.
  5800     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 109
* EL6311.cbl
  5801     02  dfheigdi         pic s9(4) comp.
  5802     02  eibcposn         pic s9(4) comp.
  5803     02  eibcalen         pic s9(4) comp.
  5804     02  eibaid           pic x(1).
  5805     02  eibfiller1       pic x(1).
  5806     02  eibfn            pic x(2).
  5807     02  eibfiller2       pic x(2).
  5808     02  eibrcode         pic x(6).
  5809     02  eibfiller3       pic x(2).
  5810     02  eibds            pic x(8).
  5811     02  eibreqid         pic x(8).
  5812     02  eibrsrce         pic x(8).
  5813     02  eibsync          pic x(1).
  5814     02  eibfree          pic x(1).
  5815     02  eibrecv          pic x(1).
  5816     02  eibsend          pic x(1).
  5817     02  eibatt           pic x(1).
  5818     02  eibeoc           pic x(1).
  5819     02  eibfmh           pic x(1).
  5820     02  eibcompl         pic x(1).
  5821     02  eibsig           pic x(1).
  5822     02  eibconf          pic x(1).
  5823     02  eiberr           pic x(1).
  5824     02  eibrldbk         pic x(1).
  5825     02  eiberrcd         pic x(4).
  5826     02  eibsynrb         pic x(1).
  5827     02  eibnodat         pic x(1).
  5828     02  eibfiller5       pic x(2).
  5829     02  eibresp          pic 9(09) comp.
  5830     02  eibresp2         pic 9(09) comp.
  5831     02  dfheigdj         pic s9(4) comp.
  5832     02  dfheigdk         pic s9(4) comp.
  5833 01  DFHCOMMAREA                 PIC X(1300).
  5834*                                COPY ERCPNDB.
  5835******************************************************************
  5836*                                                                *
  5837*                                                                *
  5838*                            ERCPNDB.                            *
  5839*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5840*                            VMOD=2.025                          *
  5841*                                                                *
  5842*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5843*                                                                *
  5844******************************************************************
  5845*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5846*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5847******************************************************************
  5848*                                                                *
  5849*                                                                *
  5850*   FILE TYPE = VSAM,KSDS                                        *
  5851*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5852*                                                                *
  5853*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5854*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5855*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5856*                                                 RKP=13,LEN=36  *
  5857*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5858*                                      AND CHG-SEQ.)             *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 110
* EL6311.cbl
  5859*                                                RKP=49,LEN=11   *
  5860*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5861*                                      AND CHG-SEQ.)             *
  5862*                                                RKP=60,LEN=15   *
  5863*                                                                *
  5864*   LOG = NO                                                     *
  5865*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5866******************************************************************
  5867******************************************************************
  5868*                   C H A N G E   L O G
  5869*
  5870* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5871*-----------------------------------------------------------------
  5872*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5873* EFFECTIVE    NUMBER
  5874*-----------------------------------------------------------------
  5875* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5876* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5877* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5878* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5879* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5880* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5881* 032306                   PEMA  ADD BOW LOAN NUMBER
  5882* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5883* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5884* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5885* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5886* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5887* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5888* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5889* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5890* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  5891******************************************************************
  5892
  5893 01  PENDING-BUSINESS.
  5894     12  PB-RECORD-ID                     PIC XX.
  5895         88  VALID-PB-ID                        VALUE 'PB'.
  5896
  5897     12  PB-CONTROL-PRIMARY.
  5898         16  PB-COMPANY-CD                PIC X.
  5899         16  PB-ENTRY-BATCH               PIC X(6).
  5900         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5901         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5902
  5903     12  PB-CONTROL-BY-ACCOUNT.
  5904         16  PB-COMPANY-CD-A1             PIC X.
  5905         16  PB-CARRIER                   PIC X.
  5906         16  PB-GROUPING.
  5907             20  PB-GROUPING-PREFIX       PIC XXX.
  5908             20  PB-GROUPING-PRIME        PIC XXX.
  5909         16  PB-STATE                     PIC XX.
  5910         16  PB-ACCOUNT.
  5911             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5912             20  PB-ACCOUNT-PRIME         PIC X(6).
  5913         16  PB-CERT-EFF-DT               PIC XX.
  5914         16  PB-CERT-NO.
  5915             20  PB-CERT-PRIME            PIC X(10).
  5916             20  PB-CERT-SFX              PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 111
* EL6311.cbl
  5917         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5918
  5919         16  PB-RECORD-TYPE               PIC X.
  5920             88  PB-MAILING-DATA                VALUE '0'.
  5921             88  PB-ISSUE                       VALUE '1'.
  5922             88  PB-CANCELLATION                VALUE '2'.
  5923             88  PB-BATCH-TRAILER               VALUE '9'.
  5924
  5925     12  PB-CONTROL-BY-ORIG-BATCH.
  5926         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5927         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5928         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5929         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5930
  5931     12  PB-CONTROL-BY-CSR.
  5932         16  PB-CSR-COMPANY-CD            PIC X.
  5933         16  PB-CSR-ID                    PIC X(4).
  5934         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5935         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5936         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5937******************************************************************
  5938*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5939******************************************************************
  5940
  5941     12  PB-LAST-MAINT-DT                 PIC XX.
  5942     12  PB-LAST-MAINT-BY                 PIC X(4).
  5943     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5944
  5945     12  PB-RECORD-BODY                   PIC X(375).
  5946
  5947     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5948         16  PB-CERT-ORIGIN               PIC X.
  5949             88  CLASIC-CREATED-CERT         VALUE '1'.
  5950         16  PB-I-NAME.
  5951             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5952             20  PB-I-INSURED-FIRST-NAME.
  5953                 24  PB-I-INSURED-1ST-INIT PIC X.
  5954                 24  FILLER                PIC X(9).
  5955             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5956         16  PB-I-AGE                     PIC S99   COMP-3.
  5957         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5958         16  PB-I-BIRTHDAY                PIC XX.
  5959         16  PB-I-INSURED-SEX             PIC X.
  5960             88  PB-SEX-MALE     VALUE 'M'.
  5961             88  PB-SEX-FEMALE   VALUE 'F'.
  5962
  5963         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5964         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5965         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5966         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5967         16  PB-I-SKIP-CODE               PIC X.
  5968             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5969             88  PB-SKIP-JULY              VALUE '1'.
  5970             88  PB-SKIP-AUGUST            VALUE '2'.
  5971             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5972             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5973             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5974             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 112
* EL6311.cbl
  5975             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5976             88  PB-SKIP-JUNE              VALUE '8'.
  5977             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5978             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5979             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5980         16  PB-I-TERM-TYPE               PIC X.
  5981             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5982             88  PB-PAID-WEEKLY            VALUE 'W'.
  5983             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5984             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5985             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5986         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5987         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5988         16  PB-I-DATA-ENTRY-SW           PIC X.
  5989             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5990             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5991             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5992             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5993         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5994         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5995*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5996         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5997         16  FILLER                       PIC X.
  5998
  5999         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6000             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6001             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6002                                                   '90' THRU '99'.
  6003         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6004                                          PIC XX.
  6005         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6006         16  PB-I-AMOUNT-FINANCED REDEFINES
  6007                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6008         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6009         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6010                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6011         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6012         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6013         16  PB-I-CLP-AMOUNT REDEFINES
  6014                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6015         16  PB-I-LF-CALC-FLAG            PIC X.
  6016             88 PB-COMP-LF-PREM               VALUE '?'.
  6017         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6018         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6019         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  6020         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6021         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6022         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6023         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6024         16  PB-I-LF-ABBR                 PIC XXX.
  6025         16  PB-I-LF-INPUT-CD             PIC XX.
  6026
  6027         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6028             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6029             88  PB-INVALID-AH               VALUE '  ' '00'
  6030                                                   '90' THRU '99'.
  6031         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6032         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 113
* EL6311.cbl
  6033         16  PB-I-AH-CALC-FLAG            PIC X.
  6034             88 PB-COMP-AH-PREM                  VALUE '?'.
  6035         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6036         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6037         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6038         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6039         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6040         16  PB-I-AH-ABBR                 PIC XXX.
  6041         16  PB-I-AH-INPUT-CD             PIC XXX.
  6042
  6043         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6044         16  PB-I-REIN-TABLE              PIC XXX.
  6045         16  PB-I-BUSINESS-TYPE           PIC 99.
  6046         16  PB-I-INDV-GRP-CD             PIC X.
  6047         16  PB-I-MORT-CODE.
  6048             20  PB-I-TABLE               PIC X.
  6049             20  PB-I-INTEREST            PIC XX.
  6050             20  PB-I-MORT-TYP            PIC X.
  6051         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6052         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6053         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6054         16  PB-I-INDV-GRP-OVRD           PIC X.
  6055         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6056         16  PB-I-SIG-SW                  PIC X.
  6057             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6058         16  PB-I-RATE-CLASS              PIC XX.
  6059         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6060         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6061         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6062         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6063         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6064         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6065         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6066         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6067         16  PB-I-OB-FLAG                 PIC X.
  6068             88  PB-I-OB                      VALUE 'B'.
  6069             88  PB-I-SUMMARY                 VALUE 'Z'.
  6070         16  PB-I-ENTRY-STATUS            PIC X.
  6071             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6072                                              'M' '5' '9' '2'.
  6073             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6074             88  PB-I-POLICY-PENDING          VALUE '2'.
  6075             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6076             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6077             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  6078             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6079             88  PB-I-REIN-ONLY               VALUE '9'.
  6080             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6081             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6082             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6083             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6084         16  PB-I-INT-CODE                PIC X.
  6085             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6086             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6087         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6088         16  PB-I-SOC-SEC-NO              PIC X(11).
  6089         16  PB-I-MEMBER-NO               PIC X(12).
  6090         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 114
* EL6311.cbl
  6091*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6092         16  PB-I-OLD-LOF                 PIC XXX.
  6093         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6094         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6095         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6096         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6097         16  PB-I-LIFE-INDICATOR          PIC X.
  6098             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6099         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6100         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6101                                          PIC S9(5)V99    COMP-3.
  6102         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6103             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6104             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6105         16  PB-I-1ST-PMT-DT              PIC XX.
  6106         16  PB-I-JOINT-INSURED.
  6107             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6108             20 PB-I-JOINT-FIRST-NAME.
  6109                24  PB-I-JOINT-FIRST-INIT PIC X.
  6110                24  FILLER                PIC X(9).
  6111             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6112*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6113         16  PB-I-BENEFICIARY-NAME.
  6114             20  PB-I-BANK-NUMBER         PIC X(10).
  6115             20  FILLER                   PIC X(15).
  6116         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6117         16  PB-I-REFERENCE               PIC X(12).
  6118         16  FILLER REDEFINES PB-I-REFERENCE.
  6119             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6120             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6121             20  PB-I-CLP-STATE           PIC XX.
  6122         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6123             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6124             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6125             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6126         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6127         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6128         16  PB-I-RESIDENT-STATE          PIC XX.
  6129         16  PB-I-RATE-CODE               PIC X(4).
  6130         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6131         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6132         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6133         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6134         16  PB-I-BANK-NOCHRGB            PIC 99.
  6135         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6136         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6137
  6138     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6139         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6140             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6141         16  PB-C-CANCEL-ORIGIN           PIC X.
  6142             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6143         16  PB-C-LF-CANCEL-DT            PIC XX.
  6144         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6145         16  PB-C-LF-CALC-REQ             PIC X.
  6146             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6147         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6148         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 115
* EL6311.cbl
  6149         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6150             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6151         16  PB-C-AH-CANCEL-DT            PIC XX.
  6152         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6153         16  PB-C-AH-CALC-REQ             PIC X.
  6154             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6155         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6156         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6157         16  PB-C-LAST-NAME               PIC X(15).
  6158         16  PB-C-REFUND-SW               PIC X.
  6159             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6160             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6161         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6162         16  PB-C-PAYEE-CODE              PIC X(6).
  6163         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6164         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6165         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6166         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6167         16  PB-C-REFERENCE               PIC X(12).
  6168         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6169         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6170         16  PB-C-POST-CARD-IND           PIC X.
  6171         16  PB-C-CANCEL-REASON           PIC X.
  6172         16  PB-C-REF-INTERFACE-SW        PIC X.
  6173         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6174         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6175         16  FILLER                       PIC X(01).
  6176*        16  FILLER                       PIC X(18).
  6177         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6178*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6179         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6180         16  PB-CANCELED-CERT-DATA.
  6181             20  PB-CI-INSURED-NAME.
  6182                 24  PB-CI-LAST-NAME      PIC X(15).
  6183                 24  PB-CI-INITIALS       PIC XX.
  6184             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6185             20  PB-CI-INSURED-SEX        PIC X.
  6186             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6187             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6188             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6189             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6190             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6191             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6192             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6193             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6194             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6195             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6196             20  PB-CI-RATE-CLASS         PIC XX.
  6197             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6198             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6199             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6200             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6201             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6202             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6203             20  PB-CI-LF-ABBR            PIC X(3).
  6204             20  PB-CI-AH-ABBR            PIC X(3).
  6205             20  PB-CI-OB-FLAG            PIC X.
  6206                 88  PB-CI-OB                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 116
* EL6311.cbl
  6207             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6208                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6209                                           'M' '4' '5' '9' '2'.
  6210                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6211                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6212                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6213                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6214                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6215                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6216                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6217                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6218                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6219                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6220                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6221                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6222                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6223             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6224                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6225                                           'M' '4' '5' '9' '2'.
  6226                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6227                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6228                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6229                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6230                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6231                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6232                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6233                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6234                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6235                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6236                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6237                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6238                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6239             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6240             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6241             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6242             20  PB-CI-MEMBER-NO          PIC X(12).
  6243             20  PB-CI-INT-CODE           PIC X.
  6244                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6245                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6246             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6247             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6248             20  PB-CI-COMP-EXCP-SW       PIC X.
  6249                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6250                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6251             20  PB-CI-ENTRY-STATUS       PIC X.
  6252             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6253             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6254             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6255             20  PB-CI-DEATH-DT           PIC XX.
  6256             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6257             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6258             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6259             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6260             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6261             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6262             20  PB-CI-ENTRY-DT              PIC XX.
  6263             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6264             20  PB-CI-LF-EXPIRE-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 117
* EL6311.cbl
  6265             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6266             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6267             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6268             20  PB-CI-OLD-LOF               PIC XXX.
  6269*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6270             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6271             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6272             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6273             20  PB-CI-INDV-GRP-CD           PIC X.
  6274             20  PB-CI-BENEFICIARY-NAME.
  6275                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6276                 24  FILLER                  PIC X(15).
  6277             20  PB-CI-NOTE-SW               PIC X.
  6278             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6279             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6280             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6281             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6282             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6283             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6284             20  PB-CI-FIRST-NAME            PIC X(10).
  6285             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6286
  6287         16  FILLER                       PIC X(13).
  6288*032306  16  FILLER                       PIC X(27).
  6289*        16  FILLER                       PIC X(46).
  6290
  6291     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6292         16  FILLER                       PIC X(10).
  6293         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6294         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6295         16  PB-M-INSURED-MID-INIT        PIC X.
  6296         16  PB-M-INSURED-AGE             PIC 99.
  6297         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6298         16  PB-M-INSURED-SEX             PIC X.
  6299         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6300         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6301         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6302         16  PB-M-INSURED-CITY-STATE.
  6303             20  PB-M-INSURED-CITY        PIC X(28).
  6304             20  PB-M-INSURED-STATE       PIC XX.
  6305         16  PB-M-INSURED-ZIP-CODE.
  6306             20  PB-M-INSURED-ZIP-PRIME.
  6307                 24  PB-M-INSURED-ZIP-1   PIC X.
  6308                     88  PB-M-CANADIAN-POST-CODE
  6309                                             VALUE 'A' THRU 'Z'.
  6310                 24  FILLER               PIC X(4).
  6311             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6312         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6313                                        PB-M-INSURED-ZIP-CODE.
  6314             20  PM-M-INS-CAN-POST1       PIC XXX.
  6315             20  PM-M-INS-CAN-POST2       PIC XXX.
  6316             20  FILLER                   PIC XXX.
  6317         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6318         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6319         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6320         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6321         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6322         16  PB-M-CRED-BENE-CITYST.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 118
* EL6311.cbl
  6323             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6324             20  PB-M-CRED-BENE-STATE     PIC XX.
  6325         16  FILLER                       PIC X(92).
  6326
  6327     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6328         16  FILLER                       PIC X(10).
  6329         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6330         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6331         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6332         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6333         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6334         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6335         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6336         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6337         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6338         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6339         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6340         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6341         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6342         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6343         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6344         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6345         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6346         16  PB-ACCOUNT-NAME              PIC X(30).
  6347         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6348         16  PB-REFERENCE                 PIC X(12).
  6349         16  PB-B-RECEIVED-DT             PIC XX.
  6350         16  FILLER                       PIC X(234).
  6351
  6352     12  PB-RECORD-STATUS.
  6353         16  PB-CREDIT-SELECT-DT          PIC XX.
  6354         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6355         16  PB-BILLED-DT                 PIC XX.
  6356         16  PB-BILLING-STATUS            PIC X.
  6357             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6358             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6359             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6360         16  PB-RECORD-BILL               PIC X.
  6361             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6362             88  PB-RECORD-RETURNED           VALUE 'R'.
  6363             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6364             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6365             88  PB-OVERRIDE-AH               VALUE 'A'.
  6366             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6367         16  PB-BATCH-ENTRY               PIC X.
  6368             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6369             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6370             88  PB-REISSUED-CERT             VALUE 'E'.
  6371             88  PB-CASH-CERT                 VALUE 'C'.
  6372             88  PB-MONTHLY-CERT              VALUE 'M'.
  6373             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6374             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6375             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6376         16  PB-FORCE-CODE                PIC X.
  6377             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6378             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6379             88  PB-CANCEL-FORCE              VALUE '8'.
  6380             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 119
* EL6311.cbl
  6381             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6382             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6383             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6384             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6385             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6386             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6387         16  PB-FATAL-FLAG                PIC X.
  6388             88  PB-FATAL-ERRORS              VALUE 'X'.
  6389         16  PB-FORCE-ER-CD               PIC X.
  6390             88  PB-FORCE-ERRORS              VALUE 'F'.
  6391             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6392         16  PB-WARN-ER-CD                PIC X.
  6393             88  PB-WARNING-ERRORS            VALUE 'W'.
  6394         16  FILLER                       PIC X.
  6395         16  PB-OUT-BAL-CD                PIC X.
  6396             88  PB-OUT-OF-BAL                VALUE 'O'.
  6397         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6398         16  PB-AH-OVERRIDE-L1            PIC X.
  6399         16  PB-INPUT-DT                  PIC XX.
  6400         16  PB-INPUT-BY                  PIC X(4).
  6401         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6402         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6403         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6404         16  PB-LF-EARNING-METHOD         PIC X.
  6405         16  PB-AH-EARNING-METHOD         PIC X.
  6406         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6407         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6408         16  PB-REIN-CD                   PIC XXX.
  6409         16  PB-LF-REFUND-TYPE            PIC X.
  6410         16  PB-AH-REFUND-TYPE            PIC X.
  6411         16  PB-ACCT-EFF-DT               PIC XX.
  6412         16  PB-ACCT-EXP-DT               PIC XX.
  6413         16  PB-COMPANY-ID                PIC X(3).
  6414         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6415         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6416         16  PB-SV-CARRIER                PIC X.
  6417         16  PB-SV-GROUPING               PIC X(6).
  6418         16  PB-SV-STATE                  PIC XX.
  6419         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6420         16  PB-GA-BILLING-INFO.
  6421             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6422                                          PIC XX.
  6423         16  PB-SV-REMIT-TO  REDEFINES
  6424             PB-GA-BILLING-INFO           PIC X(10).
  6425         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6426         16  PB-I-LOAN-OFFICER            PIC X(5).
  6427         16  PB-I-VIN                     PIC X(17).
  6428
  6429         16  FILLER                       PIC X(04).
  6430         16  IMNET-BYPASS-SW              PIC X.
  6431
  6432******************************************************************
  6433*                COMMON EDIT ERRORS                              *
  6434******************************************************************
  6435
  6436     12  PB-COMMON-ERRORS.
  6437         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6438                                           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 120
* EL6311.cbl
  6439
  6440******************************************************************
  6441*                                COPY ELCCERT.
  6442******************************************************************
  6443*                                                                *
  6444*                            ELCCERT.                            *
  6445*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6446*                            VMOD=2.013                          *
  6447*                                                                *
  6448*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6449*                                                                *
  6450*   FILE TYPE = VSAM,KSDS                                        *
  6451*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6452*                                                                *
  6453*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6454*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6455*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6456*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6457*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6458*                                                                *
  6459*   LOG = YES                                                    *
  6460*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6461******************************************************************
  6462*                   C H A N G E   L O G
  6463*
  6464* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6465*-----------------------------------------------------------------
  6466*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6467* EFFECTIVE    NUMBER
  6468*-----------------------------------------------------------------
  6469* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6470* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6471* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6472* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6473* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6474* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6475* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6476* 032612  CR2011110200001  PEMA  AHL CHANGES
  6477* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6478******************************************************************
  6479
  6480 01  CERTIFICATE-MASTER.
  6481     12  CM-RECORD-ID                      PIC XX.
  6482         88  VALID-CM-ID                      VALUE 'CM'.
  6483
  6484     12  CM-CONTROL-PRIMARY.
  6485         16  CM-COMPANY-CD                 PIC X.
  6486         16  CM-CARRIER                    PIC X.
  6487         16  CM-GROUPING.
  6488             20  CM-GROUPING-PREFIX        PIC X(3).
  6489             20  CM-GROUPING-PRIME         PIC X(3).
  6490         16  CM-STATE                      PIC XX.
  6491         16  CM-ACCOUNT.
  6492             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6493             20  CM-ACCOUNT-PRIME          PIC X(6).
  6494         16  CM-CERT-EFF-DT                PIC XX.
  6495         16  CM-CERT-NO.
  6496             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 121
* EL6311.cbl
  6497             20  CM-CERT-SFX               PIC X.
  6498
  6499     12  CM-CONTROL-BY-NAME.
  6500         16  CM-COMPANY-CD-A1              PIC X.
  6501         16  CM-INSURED-LAST-NAME          PIC X(15).
  6502         16  CM-INSURED-INITIALS.
  6503             20  CM-INSURED-INITIAL1       PIC X.
  6504             20  CM-INSURED-INITIAL2       PIC X.
  6505
  6506     12  CM-CONTROL-BY-SSN.
  6507         16  CM-COMPANY-CD-A2              PIC X.
  6508         16  CM-SOC-SEC-NO.
  6509             20  CM-SSN-STATE              PIC XX.
  6510             20  CM-SSN-ACCOUNT            PIC X(6).
  6511             20  CM-SSN-LN3.
  6512                 25  CM-INSURED-INITIALS-A2.
  6513                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6514                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6515                 25 CM-PART-LAST-NAME-A2         PIC X.
  6516
  6517     12  CM-CONTROL-BY-CERT-NO.
  6518         16  CM-COMPANY-CD-A4              PIC X.
  6519         16  CM-CERT-NO-A4                 PIC X(11).
  6520
  6521     12  CM-CONTROL-BY-MEMB.
  6522         16  CM-COMPANY-CD-A5              PIC X.
  6523         16  CM-MEMBER-NO.
  6524             20  CM-MEMB-STATE             PIC XX.
  6525             20  CM-MEMB-ACCOUNT           PIC X(6).
  6526             20  CM-MEMB-LN4.
  6527                 25  CM-INSURED-INITIALS-A5.
  6528                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6529                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6530                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6531
  6532     12  CM-INSURED-PROFILE-DATA.
  6533         16  CM-INSURED-FIRST-NAME.
  6534             20  CM-INSURED-1ST-INIT       PIC X.
  6535             20  FILLER                    PIC X(9).
  6536         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6537         16  CM-INSURED-SEX                PIC X.
  6538             88  CM-SEX-MALE                  VALUE 'M'.
  6539             88  CM-SEX-FEMAL                 VALUE 'F'.
  6540         16  CM-INSURED-JOINT-AGE          PIC 99.
  6541         16  CM-JOINT-INSURED-NAME.
  6542             20  CM-JT-LAST-NAME           PIC X(15).
  6543             20  CM-JT-FIRST-NAME.
  6544                 24  CM-JT-1ST-INIT        PIC X.
  6545                 24  FILLER                PIC X(9).
  6546             20  CM-JT-INITIAL             PIC X.
  6547
  6548     12  CM-LIFE-DATA.
  6549         16  CM-LF-BENEFIT-CD              PIC XX.
  6550         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6551         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6552         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6553         16  CM-LF-DEV-CODE                PIC XXX.
  6554         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 122
* EL6311.cbl
  6555         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6556         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6557         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6558         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6559         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6560         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6561         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6562         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6563         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6564         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6565         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6566         16  cm-temp-epiq                  pic xx.
  6567             88  EPIQ-CLASS                  value 'EQ'.
  6568*        16  FILLER                        PIC XX.
  6569
  6570     12  CM-AH-DATA.
  6571         16  CM-AH-BENEFIT-CD              PIC XX.
  6572         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6573         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6574         16  CM-AH-DEV-CODE                PIC XXX.
  6575         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6576         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6577         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6578         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6579         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6580         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6581         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6582         16  CM-AH-PAID-THRU-DT            PIC XX.
  6583             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6584         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6585         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6586         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6587         16  FILLER                        PIC X.
  6588
  6589     12  CM-LOAN-INFORMATION.
  6590         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6591         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6592                                           PIC S9(5)V99  COMP-3.
  6593         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6594         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6595         16  CM-PAY-FREQUENCY              PIC S99.
  6596         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6597         16  CM-RATE-CLASS                 PIC XX.
  6598         16  CM-BENEFICIARY                PIC X(25).
  6599         16  CM-POLICY-FORM-NO             PIC X(12).
  6600         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6601         16  CM-LAST-ADD-ON-DT             PIC XX.
  6602         16  CM-DEDUCTIBLE-AMOUNTS.
  6603             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6604             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6605         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6606             20  CM-RESIDENT-STATE         PIC XX.
  6607             20  CM-RATE-CODE              PIC X(4).
  6608             20  FILLER                    PIC XX.
  6609         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6610             20  CM-LOAN-OFFICER           PIC X(5).
  6611             20  FILLER                    PIC XXX.
  6612         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 123
* EL6311.cbl
  6613         16  CM-UNDERWRITING-CODE          PIC X.
  6614             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6615         16  CM-POST-CARD-IND              PIC X.
  6616         16  CM-NH-INTERFACE-SW            PIC X.
  6617         16  CM-PREMIUM-TYPE               PIC X.
  6618             88  CM-SING-PRM                  VALUE '1'.
  6619             88  CM-O-B-COVERAGE              VALUE '2'.
  6620             88  CM-OPEN-END                  VALUE '3'.
  6621         16  CM-IND-GRP-TYPE               PIC X.
  6622             88  CM-INDIVIDUAL                VALUE 'I'.
  6623             88  CM-GROUP                     VALUE 'G'.
  6624         16  CM-SKIP-CODE                  PIC X.
  6625             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6626             88  SKIP-JULY                    VALUE '1'.
  6627             88  SKIP-AUGUST                  VALUE '2'.
  6628             88  SKIP-SEPTEMBER               VALUE '3'.
  6629             88  SKIP-JULY-AUG                VALUE '4'.
  6630             88  SKIP-AUG-SEPT                VALUE '5'.
  6631             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6632             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6633             88  SKIP-JUNE                    VALUE '8'.
  6634             88  SKIP-JUNE-JULY               VALUE '9'.
  6635             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6636             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6637         16  CM-PAYMENT-MODE               PIC X.
  6638             88  PAY-MONTHLY                  VALUE SPACE.
  6639             88  PAY-WEEKLY                   VALUE '1'.
  6640             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6641             88  PAY-BI-WEEKLY                VALUE '3'.
  6642             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6643         16  CM-LOAN-NUMBER                PIC X(8).
  6644         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6645         16  CM-OLD-LOF                    PIC XXX.
  6646*        16  CM-LOAN-OFFICER               PIC XXX.
  6647         16  CM-REIN-TABLE                 PIC XXX.
  6648         16  CM-SPECIAL-REIN-CODE          PIC X.
  6649         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6650         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6651         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6652
  6653     12  CM-STATUS-DATA.
  6654         16  CM-ENTRY-STATUS               PIC X.
  6655         16  CM-ENTRY-DT                   PIC XX.
  6656
  6657         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6658         16  CM-LF-CANCEL-DT               PIC XX.
  6659         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6660
  6661         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6662         16  CM-LF-DEATH-DT                PIC XX.
  6663         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6664
  6665         16  CM-LF-CURRENT-STATUS          PIC X.
  6666             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6667                                                'M' '4' '5' '9'.
  6668             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6669             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6670             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 124
* EL6311.cbl
  6671             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6672             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6673             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6674             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6675             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6676             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6677             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6678             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6679             88  CM-LF-DECLINED               VALUE 'D'.
  6680             88  CM-LF-VOIDED                 VALUE 'V'.
  6681
  6682         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6683         16  CM-AH-CANCEL-DT               PIC XX.
  6684         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6685
  6686         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6687         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6688         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6689
  6690         16  CM-AH-CURRENT-STATUS          PIC X.
  6691             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6692                                                'M' '4' '5' '9'.
  6693             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6694             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6695             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6696             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6697             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6698             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6699             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6700             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6701             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6702             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6703             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6704             88  CM-AH-DECLINED               VALUE 'D'.
  6705             88  CM-AH-VOIDED                 VALUE 'V'.
  6706
  6707         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6708             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6709             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6710             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6711         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6712
  6713         16  CM-ENTRY-BATCH                PIC X(6).
  6714         16  CM-LF-EXIT-BATCH              PIC X(6).
  6715         16  CM-AH-EXIT-BATCH              PIC X(6).
  6716         16  CM-LAST-MONTH-END             PIC XX.
  6717
  6718     12  CM-NOTE-SW                        PIC X.
  6719         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6720         88  CERT-NOTES-PRESENT               VALUE '1'.
  6721         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6722         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6723         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6724         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6725         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6726         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6727     12  CM-COMP-EXCP-SW                   PIC X.
  6728         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 125
* EL6311.cbl
  6729         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6730     12  CM-INSURED-ADDRESS-SW             PIC X.
  6731         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6732         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6733
  6734*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6735     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6736     12  FILLER                            PIC X.
  6737
  6738*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6739     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6740     12  FILLER                            PIC X.
  6741*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6742     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6743
  6744     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6745         88  CERT-ADDED-BATCH                 VALUE ' '.
  6746         88  CERT-ADDED-ONLINE                VALUE '1'.
  6747         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6748         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6749         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6750     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6751         88  CERT-AS-LOADED                   VALUE ' '.
  6752         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6753         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6754         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6755         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6756         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6757         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6758         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6759
  6760     12  CM-ACCOUNT-COMM-PCTS.
  6761         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6762         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6763
  6764     12  CM-USER-FIELD                     PIC X.
  6765     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6766     12  CM-CLP-STATE                      PIC XX.
  6767     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6768     12  CM-USER-RESERVED                  PIC XXX.
  6769     12  FILLER REDEFINES CM-USER-RESERVED.
  6770         16  CM-AH-CLASS-CD                PIC XX.
  6771         16  F                             PIC X.
  6772******************************************************************
  6773*                                COPY ERCNOTE.
  6774******************************************************************
  6775*                                                                *
  6776*                                                                *
  6777*                            ERCNOTE                             *
  6778*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6779*                            VMOD=2.003                          *
  6780*                                                                *
  6781*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6782*                                                                *
  6783*        FILE TYPE= VSAM,KSDS                                    *
  6784*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6785*                                                                *
  6786*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 126
* EL6311.cbl
  6787*                                                                *
  6788*        LOG = YES                                               *
  6789*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6790*                                                                *
  6791******************************************************************
  6792*                   C H A N G E   L O G
  6793*
  6794* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6795*-----------------------------------------------------------------
  6796*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6797* EFFECTIVE    NUMBER
  6798*-----------------------------------------------------------------
  6799* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6800*                                FILE WILL CONTAIN BILLING NOTES O
  6801******************************************************************
  6802
  6803 01  CERTIFICATE-NOTE.
  6804     12  CN-RECORD-ID                PIC  XX.
  6805         88  VALID-CN-ID                  VALUE 'CN'.
  6806
  6807     12  CN-CONTROL-PRIMARY.
  6808         16  CN-COMPANY-CD           PIC X.
  6809         16  CN-CARRIER              PIC X.
  6810         16  CN-GROUPING.
  6811             20 CN-GROUPING-PREFIX   PIC XXX.
  6812             20 CN-GROUPING-PRIME    PIC XXX.
  6813         16  CN-STATE                PIC XX.
  6814         16  CN-ACCOUNT.
  6815             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6816             20 CN-ACCOUNT-PRIME     PIC X(6).
  6817         16  CN-CERT-EFF-DT          PIC XX.
  6818         16  CN-CERT-NO.
  6819             20  CN-CERT-PRIME       PIC X(10).
  6820             20  CN-CERT-SFX         PIC X.
  6821
  6822     12  CN-BILLING-START-LINE-NO    PIC 99.
  6823     12  CN-BILLING-END-LINE-NO      PIC 99.
  6824
  6825     12  CN-LINES.
  6826         16  CN-LINE OCCURS 10       PIC X(77).
  6827
  6828     12  CN-LAST-MAINT-DT            PIC XX.
  6829     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6830     12  CN-LAST-MAINT-USER          PIC X(4).
  6831     12  FILLER                      PIC X(6).
  6832******************************************************************
  6833*                                COPY ERCPNDM.
  6834******************************************************************
  6835*                                                                *
  6836*                                                                *
  6837*                            ERCPNDM                             *
  6838*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6839*                            VMOD=2.003                          *
  6840*                                                                *
  6841*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6842*                                                                *
  6843*   FILE TYPE = VSAM,KSDS                                        *
  6844*   RECORD SIZE = 374   RECFORM = FIX                            *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 127
* EL6311.cbl
  6845*                                                                *
  6846*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6847*   ALTERNATE PATH    = NOT USED                                 *
  6848*                                                                *
  6849*   LOG = YES                                                    *
  6850*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6851******************************************************************
  6852*                   C H A N G E   L O G
  6853*
  6854* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6855*-----------------------------------------------------------------
  6856*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6857* EFFECTIVE    NUMBER
  6858*-----------------------------------------------------------------
  6859* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6860* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6861* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6862******************************************************************
  6863
  6864 01  PENDING-MAILING-DATA.
  6865     12  PM-RECORD-ID                      PIC XX.
  6866         88  VALID-MA-ID                       VALUE 'PM'.
  6867
  6868     12  PM-CONTROL-PRIMARY.
  6869         16  PM-COMPANY-CD                 PIC X.
  6870         16  PM-ENTRY-BATCH                PIC X(6).
  6871         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6872         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6873
  6874     12  FILLER                            PIC X(14).
  6875
  6876     12  PM-ACCESS-CONTROL.
  6877         16  PM-SOURCE-SYSTEM              PIC XX.
  6878             88  PM-FROM-CREDIT                VALUE 'CR'.
  6879             88  PM-FROM-VSI                   VALUE 'VS'.
  6880             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6881             88  PM-FROM-OTHER                 VALUE 'OT'.
  6882         16  PM-RECORD-ADD-DT              PIC XX.
  6883         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6884         16  PM-LAST-MAINT-DT              PIC XX.
  6885         16  PM-LAST-MAINT-BY              PIC XXXX.
  6886         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6887
  6888     12  PM-PROFILE-INFO.
  6889         16  PM-QUALIFY-CODE-1             PIC XX.
  6890         16  PM-QUALIFY-CODE-2             PIC XX.
  6891         16  PM-QUALIFY-CODE-3             PIC XX.
  6892         16  PM-QUALIFY-CODE-4             PIC XX.
  6893         16  PM-QUALIFY-CODE-5             PIC XX.
  6894
  6895         16  PM-INSURED-LAST-NAME          PIC X(15).
  6896         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6897         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6898         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6899         16  PM-INSURED-BIRTH-DT           PIC XX.
  6900         16  PM-INSURED-SEX                PIC X.
  6901             88  PM-SEX-MALE                   VALUE 'M'.
  6902             88  PM-SEX-FEMALE                 VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 128
* EL6311.cbl
  6903         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6904
  6905         16  PM-ADDRESS-CORRECTED          PIC X.
  6906         16  PM-JOINT-BIRTH-DT             PIC XX.
  6907*        16  FILLER                        PIC X(12).
  6908
  6909         16  PM-ADDRESS-LINE-1             PIC X(30).
  6910         16  PM-ADDRESS-LINE-2             PIC X(30).
  6911         16  PM-CITY-STATE.
  6912             20  PM-CITY                   PIC X(28).
  6913             20  PM-STATE                  PIC XX.
  6914         16  PM-ZIP.
  6915             20  PM-ZIP-CODE.
  6916                 24  PM-ZIP-1              PIC X.
  6917                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6918                 24  FILLER                PIC X(4).
  6919             20  PM-ZIP-PLUS4              PIC X(4).
  6920         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6921             20  PM-CAN-POST1              PIC XXX.
  6922             20  PM-CAN-POST2              PIC XXX.
  6923             20  FILLER                    PIC XXX.
  6924
  6925         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6926
  6927         16  FILLER                        PIC X(03).
  6928
  6929     12  PM-CRED-BENE-INFO.
  6930         16  PM-CRED-BENE-NAME             PIC X(25).
  6931         16  PM-CRED-BENE-ADDR             PIC X(30).
  6932         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6933         16  PM-CRED-BENE-CTYST.
  6934             20  PM-CRED-BENE-CITY         PIC X(28).
  6935             20  PM-CRED-BENE-STATE        PIC XX.
  6936         16  PM-CRED-BENE-ZIP.
  6937             20  PM-CB-ZIP-CODE.
  6938                 24  PM-CB-ZIP-1           PIC X.
  6939                     88  PM-CB-CANADIAN-POST-CODE
  6940                                  VALUE 'A' THRU 'Z'.
  6941                 24  FILLER                PIC X(4).
  6942             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6943         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6944             20  PM-CB-CAN-POST1           PIC XXX.
  6945             20  PM-CB-CAN-POST2           PIC XXX.
  6946             20  FILLER                    PIC XXX.
  6947     12  PM-POST-CARD-MAIL-DATA.
  6948         16  PM-MAIL-DATA OCCURS 7.
  6949             20  PM-MAIL-TYPE              PIC X.
  6950                 88  PM-12MO-MAILING           VALUE '1'.
  6951                 88  PM-EXP-MAILING            VALUE '2'.
  6952             20  PM-MAIL-STATUS            PIC X.
  6953                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6954                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6955                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6956             20  PM-MAIL-DATE              PIC XX.
  6957     12  FILLER                            PIC XX.
  6958     12  FILLER                            PIC X(12).
  6959*    12  FILLER                            PIC X(30).
  6960
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 129
* EL6311.cbl
  6961******************************************************************
  6962*                                COPY ERCMAIL.
  6963******************************************************************
  6964*                                                                *
  6965*                                                                *
  6966*                            ERCMAIL                             *
  6967*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6968*                            VMOD=2.003                          *
  6969*                                                                *
  6970*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6971*                                                                *
  6972*   FILE TYPE = VSAM,KSDS                                        *
  6973*   RECORD SIZE = 374   RECFORM = FIX                            *
  6974*                                                                *
  6975*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6976*   ALTERNATE PATH    = NOT USED                                 *
  6977*                                                                *
  6978*   LOG = YES                                                    *
  6979*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6980******************************************************************
  6981*                   C H A N G E   L O G
  6982*
  6983* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6984*-----------------------------------------------------------------
  6985*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6986* EFFECTIVE    NUMBER
  6987*-----------------------------------------------------------------
  6988* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6989* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6990* 111108                   PEMA  ADD CRED BENE ADDR2
  6991******************************************************************
  6992
  6993 01  MAILING-DATA.
  6994     12  MA-RECORD-ID                      PIC XX.
  6995         88  VALID-MA-ID                       VALUE 'MA'.
  6996
  6997     12  MA-CONTROL-PRIMARY.
  6998         16  MA-COMPANY-CD                 PIC X.
  6999         16  MA-CARRIER                    PIC X.
  7000         16  MA-GROUPING.
  7001             20  MA-GROUPING-PREFIX        PIC XXX.
  7002             20  MA-GROUPING-PRIME         PIC XXX.
  7003         16  MA-STATE                      PIC XX.
  7004         16  MA-ACCOUNT.
  7005             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7006             20  MA-ACCOUNT-PRIME          PIC X(6).
  7007         16  MA-CERT-EFF-DT                PIC XX.
  7008         16  MA-CERT-NO.
  7009             20  MA-CERT-PRIME             PIC X(10).
  7010             20  MA-CERT-SFX               PIC X.
  7011
  7012     12  FILLER                            PIC XX.
  7013
  7014     12  MA-ACCESS-CONTROL.
  7015         16  MA-SOURCE-SYSTEM              PIC XX.
  7016             88  MA-FROM-CREDIT                VALUE 'CR'.
  7017             88  MA-FROM-VSI                   VALUE 'VS'.
  7018             88  MA-FROM-WARRANTY              VALUE 'WA'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 130
* EL6311.cbl
  7019             88  MA-FROM-OTHER                 VALUE 'OT'.
  7020         16  MA-RECORD-ADD-DT              PIC XX.
  7021         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7022         16  MA-LAST-MAINT-DT              PIC XX.
  7023         16  MA-LAST-MAINT-BY              PIC XXXX.
  7024         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7025
  7026     12  MA-PROFILE-INFO.
  7027         16  MA-QUALIFY-CODE-1             PIC XX.
  7028         16  MA-QUALIFY-CODE-2             PIC XX.
  7029         16  MA-QUALIFY-CODE-3             PIC XX.
  7030         16  MA-QUALIFY-CODE-4             PIC XX.
  7031         16  MA-QUALIFY-CODE-5             PIC XX.
  7032
  7033         16  MA-INSURED-LAST-NAME          PIC X(15).
  7034         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7035         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7036         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7037         16  MA-INSURED-BIRTH-DT           PIC XX.
  7038         16  MA-INSURED-SEX                PIC X.
  7039             88  MA-SEX-MALE                   VALUE 'M'.
  7040             88  MA-SEX-FEMALE                 VALUE 'F'.
  7041         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7042
  7043         16  MA-ADDRESS-CORRECTED          PIC X.
  7044         16  MA-JOINT-BIRTH-DT             PIC XX.
  7045*        16  FILLER                        PIC X(12).
  7046
  7047         16  MA-ADDRESS-LINE-1             PIC X(30).
  7048         16  MA-ADDRESS-LINE-2             PIC X(30).
  7049         16  MA-CITY-STATE.
  7050             20  MA-CITY                   PIC X(28).
  7051             20  MA-ADDR-STATE             PIC XX.
  7052         16  MA-ZIP.
  7053             20  MA-ZIP-CODE.
  7054                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7055                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7056                 24  FILLER                PIC X(4).
  7057             20  MA-ZIP-PLUS4              PIC X(4).
  7058         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7059             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7060             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7061             20  FILLER                    PIC X(3).
  7062
  7063         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7064
  7065         16  FILLER                        PIC XXX.
  7066*        16  FILLER                        PIC X(10).
  7067
  7068     12  MA-CRED-BENE-INFO.
  7069         16  MA-CRED-BENE-NAME                 PIC X(25).
  7070         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7071         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7072         16  MA-CRED-BENE-CTYST.
  7073             20  MA-CRED-BENE-CITY             PIC X(28).
  7074             20  MA-CRED-BENE-STATE            PIC XX.
  7075         16  MA-CRED-BENE-ZIP.
  7076             20  MA-CB-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 131
* EL6311.cbl
  7077                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7078                     88  MA-CB-CANADIAN-POST-CODE
  7079                                           VALUE 'A' THRU 'Z'.
  7080                 24  FILLER                    PIC X(4).
  7081             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7082         16  MA-CB-CANADIAN-POSTAL-CODE
  7083                            REDEFINES MA-CRED-BENE-ZIP.
  7084             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7085             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7086             20  FILLER                        PIC X(3).
  7087     12  MA-POST-CARD-MAIL-DATA.
  7088         16  MA-MAIL-DATA OCCURS 7.
  7089             20  MA-MAIL-TYPE              PIC X.
  7090                 88  MA-12MO-MAILING           VALUE '1'.
  7091                 88  MA-EXP-MAILING            VALUE '2'.
  7092             20  MA-MAIL-STATUS            PIC X.
  7093                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7094                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7095                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7096             20  MA-MAIL-DATE              PIC XX.
  7097     12  FILLER                            PIC XX.
  7098     12  FILLER                            PIC XX.
  7099*    12  FILLER                            PIC X(30).
  7100******************************************************************
  7101*                                COPY ERCRQST.
  7102******************************************************************
  7103*                                                                *
  7104*                                                                *
  7105*                            ERCRQST.                            *
  7106*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7107*                            VMOD=2.002                          *
  7108*                                                                *
  7109*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7110*                                                                *
  7111*   FILE TYPE = VSAM,KSDS                                        *
  7112*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7113*                                                                *
  7114*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7115*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7116*                                   ACCOUNT, REF, BATCH)         *
  7117*                                                RKP=9, LEN=38   *
  7118*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7119*                                   ACCOUNT, REF, BATCH)         *
  7120*                                                RKP=47, LEN=46  *
  7121*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7122*                                   BATCH)                       *
  7123*                                                RKP=93, LEN=24  *
  7124*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7125*                                   REF, BATCH)                  *
  7126*                                                RKP=117, LEN=35 *
  7127*   LOG = NO                                                     *
  7128*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7129******************************************************************
  7130
  7131 01  AR-REQUEST-RECORD.
  7132     12  RQ-RECORD-ID                     PIC XX.
  7133         88  VALID-RQ-ID                        VALUE 'RQ'.
  7134
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 132
* EL6311.cbl
  7135     12  RQ-CONTROL-PRIMARY.
  7136         16  RQ-COMPANY-CD                PIC X.
  7137         16  RQ-ENTRY-BATCH               PIC X(6).
  7138
  7139     12  RQ-CONTROL-BY-ACCT-REF.
  7140         16  RQ-COMPANY-CD-A1             PIC X.
  7141         16  RQ-CARRIER-A1                PIC X.
  7142         16  RQ-GROUPING-A1               PIC X(6).
  7143         16  RQ-STATE-A1                  PIC XX.
  7144         16  RQ-ACCOUNT-A1                PIC X(10).
  7145         16  RQ-REFERENCE-A1              PIC X(12).
  7146         16  RQ-BATCH-A1                  PIC X(6).
  7147
  7148     12  RQ-CONTROL-BY-FIN-RESP.
  7149         16  RQ-COMPANY-CD-A2             PIC X.
  7150         16  RQ-CARRIER-A2                PIC X.
  7151         16  RQ-GROUPING-A2               PIC X(6).
  7152         16  RQ-FIN-RESP-A2               PIC X(10).
  7153         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7154         16  RQ-REFERENCE-A2              PIC X(12).
  7155         16  RQ-BATCH-A2                  PIC X(6).
  7156
  7157     12  RQ-CONTROL-BY-ACCT-AGENT.
  7158         16  RQ-COMPANY-CD-A3             PIC X.
  7159         16  RQ-CARRIER-A3                PIC X.
  7160         16  RQ-GROUPING-A3               PIC X(6).
  7161         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7162         16  RQ-BATCH-A3                  PIC X(6).
  7163
  7164     12  RQ-CONTROL-BY-SUMMARY.
  7165         16  RQ-COMPANY-CD-A4             PIC X.
  7166         16  RQ-SUMMARY-CODE              PIC X(6).
  7167         16  RQ-ACCOUNT-A4                PIC X(10).
  7168         16  RQ-REFERENCE-A4              PIC X(12).
  7169         16  RQ-BATCH-A4                  PIC X(6).
  7170
  7171     12  RQ-REQUEST-METHOD                PIC X.
  7172         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7173         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7174         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7175         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7176     12  FILLER                           PIC X.
  7177     12  RQ-STATUS                        PIC X.
  7178         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7179         88  RQ-RESUBMIT                      VALUE 'R'.
  7180     12  RQ-PROCESSOR-ID                  PIC X(4).
  7181     12  RQ-ENTRY-DT                      PIC XX.
  7182     12  RQ-MO-END-DT                     PIC XX.
  7183     12  RQ-REQUEST-DT                    PIC XX.
  7184     12  RQ-STMT-DT                       PIC XX.
  7185     12  RQ-REVERSAL-DT                   PIC XX.
  7186     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7187     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7188
  7189     12  FILLER                           PIC X(27).
  7190
  7191******************************************************************
  7192
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 133
* EL6311.cbl
  7193*                                COPY ERCLOFC.
  7194******************************************************************
  7195*                                                                *
  7196*                                                                *
  7197*                            ERCLOFC                             *
  7198*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7199*                            VMOD=2.003                          *
  7200*                                                                *
  7201*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7202*                                                                *
  7203*   FILE TYPE = VSAM,KSDS                                        *
  7204*   RECORD SIZE = 670   RECFORM = FIX                            *
  7205*                                                                *
  7206*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7207*                                                                *
  7208*   LOG = YES                                                    *
  7209*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7210*                                                                *
  7211******************************************************************
  7212
  7213 01  LOAN-OFFICER-MASTER.
  7214     12  LO-RECORD-ID                PIC XX.
  7215         88  VALID-LO-ID                VALUE 'LO'.
  7216
  7217     12  LO-CONTROL-PRIMARY.
  7218         16  LO-COMPANY-CD           PIC X.
  7219         16  LO-CARRIER              PIC X.
  7220         16  LO-GROUPING.
  7221             20  LO-GROUPING-PREFIX  PIC XXX.
  7222             20  LO-GROUPING-PRIME   PIC XXX.
  7223         16  LO-STATE                PIC XX.
  7224         16  LO-ACCOUNT.
  7225             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7226             20  LO-ACCOUNT-PRIME    PIC X(6).
  7227         16  LO-OFFICER-CODE         PIC X(5).
  7228
  7229     12  LO-OFFICER-NAME             PIC X(30).
  7230
  7231     12  LO-LAST-MAINT-DT            PIC XX.
  7232     12  LO-LAST-USER                PIC X(4).
  7233     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7234
  7235     12  LO-COMP-CONTROL             PIC X.
  7236             88  LO-SHOW-COMP           VALUE 'Y'.
  7237             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7238     12  LO-DETAIL-CONTROL           PIC X.
  7239             88  LO-PRINT-DETAIL        VALUE 'D'.
  7240             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7241
  7242     12  LO-SV-CARRIER               PIC X.
  7243     12  LO-SV-GROUPING              PIC X(6).
  7244     12  LO-SV-STATE                 PIC XX.
  7245
  7246     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7247     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7248
  7249     12  LO-OFFICER-INFO.
  7250         16  FILLER OCCURS 12 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 134
* EL6311.cbl
  7251             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7252             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7253             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7254             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7255             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7256             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7257             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7258             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7259     12  FILLER                      PIC X(198).
  7260******************************************************************
  7261*                                COPY ERCPYAJ.
  7262******************************************************************
  7263*                                                                *
  7264*                            ERCPYAJ                             *
  7265*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7266*                            VMOD=2.015                          *
  7267*                                                                *
  7268*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7269*                                                                *
  7270*                                                                *
  7271*   FILE TYPE = VSAM,KSDS                                        *
  7272*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7273*                                                                *
  7274*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7275*       ALTERNATE PATHS = NONE                                   *
  7276*                                                                *
  7277*   LOG = YES                                                    *
  7278*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7279******************************************************************
  7280******************************************************************
  7281*                   C H A N G E   L O G
  7282*
  7283* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7284*-----------------------------------------------------------------
  7285*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7286* EFFECTIVE    NUMBER
  7287*-----------------------------------------------------------------
  7288* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7289* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7290******************************************************************
  7291
  7292 01  PENDING-PAY-ADJ.
  7293     12  PY-RECORD-ID                     PIC XX.
  7294         88  VALID-PY-ID                        VALUE 'PY'.
  7295
  7296     12  PY-CONTROL-PRIMARY.
  7297         16  PY-COMPANY-CD                PIC X.
  7298         16  PY-CARRIER                   PIC X.
  7299         16  PY-GROUPING                  PIC X(6).
  7300         16  PY-FIN-RESP                  PIC X(10).
  7301         16  PY-ACCOUNT                   PIC X(10).
  7302         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7303                                          PIC X(10).
  7304         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7305         16  PY-RECORD-TYPE               PIC X.
  7306             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7307             88  PY-DEPOSIT                   VALUE 'D'.
  7308             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 135
* EL6311.cbl
  7309             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7310             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7311             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7312             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7313             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7314             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7315             88  PY-FICA-ENTRY                VALUE 'F'.
  7316             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7317             88  PY-POLICY-FEE                VALUE 'W'.
  7318             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7319
  7320     12  PY-PYMT-TYPE                     PIC X.
  7321             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7322             88  PY-REINS-PYMT                VALUE 'R'.
  7323             88  PY-EXP-PYMT                  VALUE 'E'.
  7324
  7325     12  PY-BIL-INV                       PIC X(6).
  7326     12  PY-REF-NO                        PIC X(12).
  7327
  7328     12  PY-LAST-MAINT-DT                 PIC XX.
  7329     12  PY-LAST-MAINT-BY                 PIC X(4).
  7330     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7331
  7332     12  PY-PYADJ-RECORD.
  7333         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7334         16  PY-ENTRY-COMMENT             PIC X(30).
  7335         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7336             20  PY-GL-ACCOUNT            PIC X(10).
  7337             20  PY-GL-STATE              PIC X(02).
  7338             20  PY-GL-CANC-SW            PIC X(01).
  7339                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7340                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7341             20  PY-GL-COMMENT            PIC X(10).
  7342             20  FILLER      REDEFINES PY-GL-COMMENT.
  7343                 24  PY-GL-CHECK-NO       PIC 9(06).
  7344                 24  FILLER               PIC X(04).
  7345             20  FILLER                   PIC X(07).
  7346         16  PY-SAVE-ACCOUNT              PIC X(10).
  7347         16  PY-SAVE-TYPE                 PIC X(01).
  7348
  7349         16  PY-LETTERS.
  7350             20  PY-LETTER OCCURS 3 TIMES
  7351                           INDEXED BY PY-LET-NDX
  7352                                          PIC X(04).
  7353
  7354         16  PY-ERCOMP-TYPE               PIC X.
  7355             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7356             88  PY-GA-TYPE                   VALUE 'G'.
  7357             88  PY-BANK-TYPE                 VALUE 'B'.
  7358         16  FILLER                       PIC X(05).
  7359
  7360     12  PY-RECORD-STATUS.
  7361         16  PY-CREDIT-SELECT-DT          PIC XX.
  7362         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7363         16  PY-BILLED-DATE               PIC XX.
  7364         16  PY-REPORTED-DT               PIC XX.
  7365         16  PY-PMT-APPLIED               PIC X.
  7366             88  PY-ACCOUNT-PMT               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 136
* EL6311.cbl
  7367             88  PY-GA-PMT                    VALUE 'G'.
  7368             88  PY-OVWRITE-PMT               VALUE 'O'.
  7369             88  PY-NON-AR-PMT                VALUE 'N'.
  7370         16  FILLER                       PIC X(5).
  7371         16  PY-INPUT-DT                  PIC XX.
  7372         16  PY-CHECK-NUMBER              PIC X(6).
  7373         16  PY-VOID-SW                   PIC X.
  7374             88  PY-CHECK-VOIDED              VALUE 'V'.
  7375         16  PY-CHECK-ORIGIN-SW           PIC X.
  7376             88  PY-BILLING-CHECK             VALUE 'B'.
  7377             88  PY-REFUND-CHECK              VALUE 'R'.
  7378             88  PY-GA-CHECK                  VALUE 'G'.
  7379             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7380             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7381         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7382         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7383         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7384         16  PY-BILL-FLAG                 PIC X.
  7385             88  PY-BILLED                    VALUE 'B'.
  7386         16  PY-AR-FLAG                   PIC X.
  7387             88  PY-AR-CYCLE                  VALUE 'C'.
  7388             88  PY-AR-MONTH-END              VALUE 'M'.
  7389         16  PY-AR-DATE                   PIC XX.
  7390
  7391     12  PY-GL-CODES.
  7392         16  PY-GL-DB                     PIC X(14).
  7393         16  PY-GL-CR                     PIC X(14).
  7394         16  PY-GL-FLAG                   PIC X.
  7395         16  PY-GL-DATE                   PIC XX.
  7396
  7397     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7398     12  FILLER                           PIC X(3).
  7399******************************************************************
  7400*                                COPY ERCCNOT.
  7401******************************************************************
  7402*                                                                *
  7403*                            ERCCNOT                             *
  7404*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7405*                            VMOD=2.003                          *
  7406*                                                                *
  7407*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7408*                                                                *
  7409*        FILE TYPE= VSAM,KSDS                                    *
  7410*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7411*                                                                *
  7412*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7413*                                                                *
  7414*        LOG = YES                                               *
  7415*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7416*                                                                *
  7417******************************************************************
  7418*                   C H A N G E   L O G
  7419*
  7420* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7421*-----------------------------------------------------------------
  7422*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7423* EFFECTIVE    NUMBER
  7424*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 137
* EL6311.cbl
  7425* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7426******************************************************************
  7427
  7428 01  CERT-NOTE-FILE.
  7429     12  CZ-RECORD-ID                PIC  XX.
  7430         88  VALID-CZ-ID                  VALUE 'CZ'.
  7431
  7432     12  CZ-CONTROL-PRIMARY.
  7433         16  CZ-COMPANY-CD           PIC X.
  7434         16  CZ-CARRIER              PIC X.
  7435         16  CZ-GROUPING.
  7436             20 CZ-GROUPING-PREFIX   PIC XXX.
  7437             20 CZ-GROUPING-PRIME    PIC XXX.
  7438         16  CZ-STATE                PIC XX.
  7439         16  CZ-ACCOUNT.
  7440             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7441             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7442         16  CZ-CERT-EFF-DT          PIC XX.
  7443         16  CZ-CERT-NO.
  7444             20  CZ-CERT-PRIME       PIC X(10).
  7445             20  CZ-CERT-SFX         PIC X.
  7446         16  CZ-RECORD-TYPE          PIC X.
  7447             88  CERT-NOTE           VALUE '1'.
  7448             88  CLAIM-CERT-NOTE     VALUE '2'.
  7449         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7450
  7451     12  CZ-LAST-MAINT-DT            PIC XX.
  7452     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7453     12  CZ-LAST-MAINT-USER          PIC X(4).
  7454
  7455     12  CZ-NOTE-INFORMATION.
  7456         16  CZ-NOTE                 PIC X(63).
  7457         16  FILLER                  PIC X(39).
  7458******************************************************************
  7459*                                COPY ELCMSTR.
  7460******************************************************************
  7461*                                                                *
  7462*                            ELCMSTR.                            *
  7463*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7464*                            VMOD=2.012                          *
  7465*                                                                *
  7466*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7467*                                                                *
  7468*   FILE TYPE = VSAM,KSDS                                        *
  7469*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7470*                                                                *
  7471*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7472*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7473*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7474*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7475*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7476*                                                 RKP=75,LEN=21  *
  7477*                                                                *
  7478*   **** NOTE ****                                               *
  7479*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7480*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7481*                                                                *
  7482*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 138
* EL6311.cbl
  7483*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7484******************************************************************
  7485*                   C H A N G E   L O G
  7486*
  7487* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7488*-----------------------------------------------------------------
  7489*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7490* EFFECTIVE    NUMBER
  7491*-----------------------------------------------------------------
  7492* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7493* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7494* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7495* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7496* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7497******************************************************************
  7498 01  CLAIM-MASTER.
  7499     12  CL-RECORD-ID                PIC XX.
  7500         88  VALID-CL-ID         VALUE 'CL'.
  7501
  7502     12  CL-CONTROL-PRIMARY.
  7503         16  CL-COMPANY-CD           PIC X.
  7504         16  CL-CARRIER              PIC X.
  7505         16  CL-CLAIM-NO             PIC X(7).
  7506         16  CL-CERT-NO.
  7507             20  CL-CERT-PRIME       PIC X(10).
  7508             20  CL-CERT-SFX         PIC X.
  7509
  7510     12  CL-CONTROL-BY-NAME.
  7511         16  CL-COMPANY-CD-A1        PIC X.
  7512         16  CL-INSURED-LAST-NAME    PIC X(15).
  7513         16  CL-INSURED-NAME.
  7514             20  CL-INSURED-1ST-NAME PIC X(12).
  7515             20  CL-INSURED-MID-INIT PIC X.
  7516
  7517     12  CL-CONTROL-BY-SSN.
  7518         16  CL-COMPANY-CD-A2        PIC X.
  7519         16  CL-SOC-SEC-NO.
  7520             20  CL-SSN-STATE        PIC XX.
  7521             20  CL-SSN-ACCOUNT      PIC X(6).
  7522             20  CL-SSN-LN3          PIC X(3).
  7523
  7524     12  CL-CONTROL-BY-CERT-NO.
  7525         16  CL-COMPANY-CD-A4        PIC X.
  7526         16  CL-CERT-NO-A4.
  7527             20  CL-CERT-A4-PRIME    PIC X(10).
  7528             20  CL-CERT-A4-SFX      PIC X.
  7529
  7530     12  CL-CONTROL-BY-CCN.
  7531         16  CL-COMPANY-CD-A5        PIC X.
  7532         16  CL-CCN-A5.
  7533             20  CL-CCN.
  7534                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7535                 24  CL-CCN-PRIME-A5 PIC X(12).
  7536             20  CL-CCN-FILLER-A5    PIC X(4).
  7537
  7538     12  CL-INSURED-PROFILE-DATA.
  7539         16  CL-INSURED-BIRTH-DT     PIC XX.
  7540         16  CL-INSURED-SEX-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 139
* EL6311.cbl
  7541             88  INSURED-IS-MALE        VALUE 'M'.
  7542             88  INSURED-IS-FEMALE      VALUE 'F'.
  7543             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7544         16  CL-INSURED-OCC-CD       PIC X(6).
  7545         16  FILLER                  PIC X(5).
  7546
  7547     12  CL-PROCESSING-INFO.
  7548         16  CL-PROCESSOR-ID         PIC X(4).
  7549         16  CL-CLAIM-STATUS         PIC X.
  7550             88  CLAIM-IS-OPEN          VALUE 'O'.
  7551             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7552         16  CL-CLAIM-TYPE           PIC X.
  7553*            88  AH-CLAIM               VALUE 'A'.
  7554*            88  LIFE-CLAIM             VALUE 'L'.
  7555*            88  PROPERTY-CLAIM         VALUE 'P'.
  7556*            88  IUI-CLAIM              VALUE 'I'.
  7557*            88  GAP-CLAIM              VALUE 'G'.
  7558*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7559         16  CL-CLAIM-PREM-TYPE      PIC X.
  7560             88  SINGLE-PREMIUM         VALUE '1'.
  7561             88  O-B-COVERAGE           VALUE '2'.
  7562             88  OPEN-END-COVERAGE      VALUE '3'.
  7563         16  CL-INCURRED-DT          PIC XX.
  7564         16  CL-REPORTED-DT          PIC XX.
  7565         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7566         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7567         16  CL-LAST-PMT-DT          PIC XX.
  7568         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7569         16  CL-PAID-THRU-DT         PIC XX.
  7570         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7571         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7572         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7573         16  CL-PMT-CALC-METHOD      PIC X.
  7574             88  CL-360-DAY-YR          VALUE '1'.
  7575             88  CL-365-DAY-YR          VALUE '2'.
  7576             88  CL-FULL-MONTHS         VALUE '3'.
  7577         16  CL-CAUSE-CD             PIC X(6).
  7578
  7579         16  CL-PRIME-CERT-NO.
  7580             20  CL-PRIME-CERT-PRIME PIC X(10).
  7581             20  CL-PRIME-CERT-SFX   PIC X.
  7582
  7583         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7584             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7585             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7586
  7587         16  CL-MICROFILM-NO         PIC X(10).
  7588         16  FILLER REDEFINES CL-MICROFILM-NO.
  7589             20  CL-BENEFIT-PERIOD   PIC 99.
  7590             20  FILLER              PIC X(8).
  7591         16  CL-PROG-FORM-TYPE       PIC X.
  7592         16  CL-LAST-ADD-ON-DT       PIC XX.
  7593
  7594         16  CL-LAST-REOPEN-DT       PIC XX.
  7595         16  CL-LAST-CLOSE-DT        PIC XX.
  7596         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7597             88  FINAL-PAID             VALUE '1'.
  7598             88  CLAIM-DENIED           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 140
* EL6311.cbl
  7599             88  AUTO-CLOSE             VALUE '3'.
  7600             88  MANUAL-CLOSE           VALUE '4'.
  7601             88  BENEFITS-CHANGED       VALUE 'C'.
  7602             88  SETUP-ERRORS           VALUE 'E'.
  7603         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7604         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7605         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7606             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7607         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7608         16  FILLER                  PIC X.
  7609
  7610     12  CL-CERTIFICATE-DATA.
  7611         16  CL-CERT-ORIGIN          PIC X.
  7612             88  CERT-WAS-ONLINE        VALUE '1'.
  7613             88  CERT-WAS-CREATED       VALUE '2'.
  7614             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7615         16  CL-CERT-KEY-DATA.
  7616             20  CL-CERT-CARRIER     PIC X.
  7617             20  CL-CERT-GROUPING    PIC X(6).
  7618             20  CL-CERT-STATE       PIC XX.
  7619             20  CL-CERT-ACCOUNT.
  7620                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7621                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7622             20  CL-CERT-EFF-DT      PIC XX.
  7623
  7624     12  CL-STATUS-CONTROLS.
  7625         16  CL-PRIORITY-CD          PIC X.
  7626             88  CONFIDENTIAL-DATA      VALUE '8'.
  7627             88  HIGHEST-PRIORITY       VALUE '9'.
  7628         16  CL-SUPV-ATTN-CD         PIC X.
  7629             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7630             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7631         16  CL-PURGED-DT            PIC XX.
  7632         16  CL-RESTORED-DT          PIC XX.
  7633         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7634         16  CL-NEXT-RESEND-DT       PIC XX.
  7635         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7636         16  CL-CRITICAL-PERIOD      PIC 99.
  7637*        16  FILLER                  PIC XX.
  7638         16  CL-LAST-MAINT-DT        PIC XX.
  7639         16  CL-LAST-MAINT-USER      PIC X(4).
  7640         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7641         16  CL-LAST-MAINT-TYPE      PIC X.
  7642             88  CLAIM-SET-UP           VALUE ' '.
  7643             88  PAYMENT-MADE           VALUE '1'.
  7644             88  LETTER-SENT            VALUE '2'.
  7645             88  MASTER-WAS-ALTERED     VALUE '3'.
  7646             88  MASTER-WAS-RESTORED    VALUE '4'.
  7647             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7648             88  FILE-CONVERTED         VALUE '6'.
  7649             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7650             88  ERROR-CORRECTION       VALUE 'E'.
  7651         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7652         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7653         16  CL-BENEFICIARY          PIC X(10).
  7654         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7655         16  CL-DENIAL-TYPE          PIC X.
  7656             88  CL-TYPE-DENIAL          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 141
* EL6311.cbl
  7657             88  CL-TYPE-RESCISSION      VALUE '2'.
  7658             88  CL-TYPE-REFORMATION     VALUE '3'.
  7659             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7660             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7661         16  filler                  pic x(5).
  7662*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7663*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7664*        16  CL-RTW-DT               PIC XX.
  7665
  7666     12  CL-TRAILER-CONTROLS.
  7667         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7668             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7669             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7670             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7671         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7672         16  FILLER                  PIC XX.
  7673         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7674         16  CL-ADDRESS-TRAILER-CNT.
  7675             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7676                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7677             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7678                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7679             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7680                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7681             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7682                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7683             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7684                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7685             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7686                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7687             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7688                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7689
  7690     12  CL-CV-REFERENCE-NO.
  7691         16  CL-CV-REFNO-PRIME       PIC X(18).
  7692         16  CL-CV-REFNO-SFX         PIC XX.
  7693
  7694     12  CL-FILE-LOCATION            PIC X(4).
  7695
  7696     12  CL-PROCESS-ERRORS.
  7697         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7698             88  NO-FATAL-ERRORS        VALUE ZERO.
  7699         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7700             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7701
  7702     12  CL-PRODUCT-CD               PIC X.
  7703
  7704     12  CL-CURRENT-KEY-DATA.
  7705         16  CL-CURRENT-CARRIER      PIC X.
  7706         16  CL-CURRENT-GROUPING     PIC X(6).
  7707         16  CL-CURRENT-STATE        PIC XX.
  7708         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7709
  7710     12  CL-ASSOCIATES               PIC X.
  7711         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7712         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7713         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7714         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 142
* EL6311.cbl
  7715
  7716     12  CL-ACTIVITY-CODE            PIC 99.
  7717     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7718     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7719
  7720     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7721     12  CL-LAG-REPORT-CODE          PIC 9.
  7722     12  CL-LOAN-TYPE                PIC XX.
  7723     12  CL-LEGAL-STATE              PIC XX.
  7724
  7725     12  CL-YESNOSW                  PIC X.
  7726     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7727         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7728         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7729         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7730     12  cl-insured-type             pic x.
  7731         88  cl-claim-on-primary         value 'P'.
  7732         88  cl-claim-on-co-borrower     value 'C'.
  7733     12  cl-benefit-expiration-dt    PIC XX.
  7734*                                COPY ERCENDT.
  7735******************************************************************
  7736*                                                                *
  7737*                                                                *
  7738*                            ERCENDT.                            *
  7739*                            VMOD=2.001                          *
  7740*                                                                *
  7741*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7742*                                                                *
  7743*   FILE TYPE = VSAM,KSDS                                        *
  7744*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7745*                                                                *
  7746*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7747*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7748*                                                                *
  7749*   LOG = NO                                                     *
  7750*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7751******************************************************************
  7752*-----------------------------------------------------------------
  7753*                   C H A N G E   L O G
  7754*
  7755* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7756*-----------------------------------------------------------------
  7757*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7758* EFFECTIVE    NUMBER
  7759*-----------------------------------------------------------------
  7760* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7761*                                WITH OPEN CLAIMS
  7762* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7763* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7764* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7765* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7766*-----------------------------------------------------------------
  7767 01  ENDORSEMENT-RECORD.
  7768     12  EN-RECORD-ID                PIC XX.
  7769         88  VALID-EN-ID                VALUE 'EN'.
  7770     12  EN-CONTROL-PRIMARY.
  7771         16  EN-COMPANY-CD           PIC X.
  7772         16  EN-CARRIER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 143
* EL6311.cbl
  7773         16  EN-GROUPING             PIC X(6).
  7774         16  EN-STATE                PIC XX.
  7775         16  EN-ACCOUNT              PIC X(10).
  7776         16  EN-CERT-EFF-DT          PIC XX.
  7777         16  EN-CERT-NO.
  7778             20  EN-CERT-PRIME       PIC X(10).
  7779             20  EN-CERT-SFX         PIC X.
  7780         16  EN-REC-TYPE             PIC X.
  7781             88  EN-ISSUE               VALUE 'I'.
  7782             88  EN-CANCELLATION        VALUE 'C'.
  7783         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7784     12  EN-CONTROL-BY-ARCH-NO.
  7785         16  EN-COMPANY-CD-A1              PIC X.
  7786         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7787     12  EN-LAST-MAINT-DT            PIC XX.
  7788     12  EN-LAST-MAINT-BY            PIC X(4).
  7789     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7790     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7791     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7792         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7793         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7794         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7795         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7796         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7797         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7798         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7799         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7800         16  EN-LF-ORIG-BENCD        PIC XX.
  7801         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7802         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7803         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7804         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7805         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7806         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7807*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7808         16  EN-ORIG-CRED-BENE       PIC X(25).
  7809         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7810         16  FILLER                  PIC X.
  7811         16  EN-AH-ORIG-BENCD        PIC XX.
  7812         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7813         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7814         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7815         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7816*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7817*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7818         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7819         16  F                       PIC X(09).
  7820         16  EN-AH-ORIG-CP           PIC 99.
  7821         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7822         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7823         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7824         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7825         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7826         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7827         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7828         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7829         16  EN-LF-NEW-BENCD         PIC XX.
  7830         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 144
* EL6311.cbl
  7831         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7832         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7833         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7834         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7835         16  EN-LF-NEW-EXP-DT        PIC XX.
  7836         16  EN-NEW-CRED-BENE        PIC X(25).
  7837         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7838         16  FILLER                  PIC X.
  7839         16  EN-AH-NEW-BENCD         PIC XX.
  7840         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7841         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7842         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7843         16  EN-AH-NEW-EXP-DT        PIC XX.
  7844*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7845*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7846*        16  F                       PIC X(12).
  7847         16  EN-AH-NEW-CP            PIC 99.
  7848         16  EN-SIG-SW               PIC X.
  7849         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7850         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7851         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7852         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7853         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7854         16  FILLER                  PIC X(33).
  7855     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7856         16  EN-LF-ORIG-REF-DT       PIC XX.
  7857         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7858         16  EN-AH-ORIG-REF-DT       PIC XX.
  7859         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7860         16  EN-LF-NEW-REF-DT        PIC XX.
  7861         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7862         16  EN-AH-NEW-REF-DT        PIC XX.
  7863         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7864         16  EN-FLAG-CERT            PIC X.
  7865         16  EN-INS-LAST-NAME        PIC X(15).
  7866         16  EN-INS-FIRST-NAME       PIC X(10).
  7867         16  EN-INS-MIDDLE-INIT      PIC X.
  7868         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7869         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7870         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7871         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7872         16  FILLER                  PIC X(262).
  7873     12  EN-MONEY-SW             PIC X.
  7874     12  EN-HEALTH-APP           PIC X.
  7875     12  EN-VOUCHER-SW           PIC X.
  7876     12  EN-PAYEE                PIC X(14).
  7877     12  EN-INPUT-DT             PIC XX.
  7878     12  EN-PROCESS-DT           PIC XX.
  7879     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7880     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7881     12  EN-REASON-CODES.
  7882         16  F OCCURS 12.
  7883             20  EN-REASON-CODE  PIC X(4).
  7884     12  EN-TEMPLATE-USED        PIC X(8).
  7885     12  EN-DOCU-TYPE            PIC X.
  7886         88  EN-VERI-DOCU          VALUE 'V'.
  7887         88  EN-GCE-DOCU           VALUE 'G'.
  7888         88  EN-CANC-DOCU          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 145
* EL6311.cbl
  7889     12  EN-COMMENTS1            PIC X(13).
  7890     12  EN-COMMENTS2            PIC X(70).
  7891     12  EN-COMM-CHGBK           PIC X.
  7892         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7893         88  EN-CHG-ACCT           VALUE 'Y'.
  7894     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7895     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7896     12  EN-BATCH-NUMBER         PIC X(6).
  7897     12  EN-ACCT-SUMM            PIC X.
  7898     12  EN-CSO-SUMM             PIC X.
  7899     12  en-check-type           pic x.
  7900     12  FILLER                  PIC X(12).
  7901******************************************************************
  7902*                                COPY ELCCRTT.
  7903******************************************************************
  7904*                                                                *
  7905*                            ELCCRTT.                            *
  7906*                                                                *
  7907*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7908*                                                                *
  7909*   FILE TYPE = VSAM,KSDS                                        *
  7910*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7911*                                                                *
  7912*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7913*                                                                *
  7914*   LOG = YES                                                    *
  7915*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7916******************************************************************
  7917*                   C H A N G E   L O G
  7918*
  7919* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7920*-----------------------------------------------------------------
  7921*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7922* EFFECTIVE    NUMBER
  7923*-----------------------------------------------------------------
  7924* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7925* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7926* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7927* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7928* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7929* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7930* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7931* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7932******************************************************************
  7933
  7934 01  CERTIFICATE-TRAILERS.
  7935     12  CS-RECORD-ID                      PIC XX.
  7936         88  VALID-CS-ID                      VALUE 'CS'.
  7937
  7938     12  CS-CONTROL-PRIMARY.
  7939         16  CS-COMPANY-CD                 PIC X.
  7940         16  CS-CARRIER                    PIC X.
  7941         16  CS-GROUPING                   PIC X(6).
  7942         16  CS-STATE                      PIC XX.
  7943         16  CS-ACCOUNT                    PIC X(10).
  7944         16  CS-CERT-EFF-DT                PIC XX.
  7945         16  CS-CERT-NO.
  7946             20  CS-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 146
* EL6311.cbl
  7947             20  CS-CERT-SFX               PIC X.
  7948         16  CS-TRAILER-TYPE               PIC X.
  7949             88  COMM-TRLR           VALUE 'A'.
  7950             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7951             88  CERT-DATA-TRLR      VALUE 'C'.
  7952
  7953     12  CS-DATA-AREA                      PIC X(516).
  7954
  7955     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7956         16  CS-BANK-COMMISSION-AREA.
  7957             20  CS-BANK-COMMS       OCCURS 10.
  7958                 24  CS-AGT                PIC X(10).
  7959                 24  CS-COM-TYP            PIC X.
  7960                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7961                 24  CS-RECALC-LV-INDIC    PIC X.
  7962                 24  FILLER                PIC X(10).
  7963         16  FILLER                        PIC X(256).
  7964
  7965     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7966****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7967         16  CS-MB-CLAIM-DATA OCCURS 24.
  7968             20  CS-CLAIM-NO               PIC X(7).
  7969             20  CS-CLAIM-TYPE             PIC X.
  7970                 88  CS-AH-CLM               VALUE 'A'.
  7971                 88  CS-IU-CLM               VALUE 'I'.
  7972                 88  CS-GP-CLM               VALUE 'G'.
  7973                 88  CS-LF-CLM               VALUE 'L'.
  7974                 88  CS-PR-CLM               VALUE 'P'.
  7975                 88  CS-FL-CLM               VALUE 'F'.
  7976             20  CS-INSURED-TYPE           PIC X.
  7977                 88  CS-PRIM-INSURED          VALUE 'P'.
  7978                 88  CS-CO-BORROWER           VALUE 'C'.
  7979             20  CS-BENEFIT-PERIOD         PIC 99.
  7980             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7981             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7982             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7983         16  FILLER                        PIC X(12).
  7984     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7985         16  CS-VIN-NUMBER                 PIC X(17).
  7986         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7987         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7988         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7989         16  cs-agent-name.
  7990             20  cs-agent-fname            pic x(20).
  7991             20  cs-agent-mi               pic x.
  7992             20  cs-agent-lname            pic x(25).
  7993         16  cs-license-no                 pic x(15).
  7994         16  cs-npn-number                 pic x(10).
  7995         16  cs-agent-edit-status          pic x.
  7996             88  cs-ae-refer-to-manager      value 'M'.
  7997             88  cs-ae-cover-sheet           value 'C'.
  7998             88  cs-ae-sig-form              value 'S'.
  7999             88  cs-ae-verified              value 'V'.
  8000             88  cs-unidentified-signature   value 'U'.
  8001             88  cs-cert-returned            value 'R'.
  8002             88  cs-accept-no-commission     value 'N'.
  8003         16  FILLER                        PIC X(424).
  8004*        16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 147
* EL6311.cbl
  8005*                                COPY ERCCHEK.
  8006******************************************************************
  8007*                                                                *
  8008*                                                                *
  8009*                            ERCCHEK                             *
  8010*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8011*                            VMOD=2.008                          *
  8012*                                                                *
  8013*   FILE DESCRIPTION = CHECK RECORDS                             *
  8014*                                                                *
  8015*   FILE TYPE = VSAM,KSDS                                        *
  8016*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8017*                                                                *
  8018*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8019*       ALTERNATE INDEX = NONE                                   *
  8020*                                                                *
  8021*   LOG = YES                                                    *
  8022*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8023******************************************************************
  8024*                   C H A N G E   L O G
  8025*
  8026* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8027*-----------------------------------------------------------------
  8028*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8029* EFFECTIVE    NUMBER
  8030*-----------------------------------------------------------------
  8031* 021414    2003053000001  PEMA  changes for auto chk request
  8032******************************************************************
  8033 01  CHECK-RECORDS.
  8034     12  CH-RECORD-ID                      PIC XX.
  8035         88  VALID-CH-ID                      VALUE 'CH'.
  8036
  8037     12  CH-CONTROL-PRIMARY.
  8038         16  CH-COMPANY-CD                 PIC X.
  8039         16  CH-CARRIER                    PIC X.
  8040         16  CH-GROUPING                   PIC X(6).
  8041         16  CH-STATE                      PIC XX.
  8042         16  CH-ACCOUNT                    PIC X(10).
  8043         16  CH-CERT-EFF-DT                PIC XX.
  8044         16  CH-CERT-NO.
  8045             20  CH-CERT-PRIME             PIC X(10).
  8046             20  CH-CERT-SFX               PIC X.
  8047         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8048
  8049     12  CH-RECORDED-DT                    PIC XX.
  8050     12  CH-RECORDED-BY                    PIC X(4).
  8051     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8052
  8053     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8054     12  CH-CHECK-NO                       PIC X(7).
  8055     12  CH-REASON-FOR-CHECK               PIC X(25).
  8056     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8057     12  FILLER                            PIC X.
  8058
  8059     12  CH-PAYEE-INFO.
  8060         16  CH-PAYEE-NAME-1               PIC X(30).
  8061         16  CH-PAYEE-NAME-2               PIC X(30).
  8062         16  CH-PAYEE-ADDRESS-1            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 148
* EL6311.cbl
  8063         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8064         16  CH-PAYEE-CITY-ST.
  8065             20  CH-PAYEE-CITY             PIC X(28).
  8066             20  CH-PAYEE-STATE            PIC XX.
  8067         16  CH-PAYEE-ZIP-CODE.
  8068             20  CH-PAYEE-ZIP.
  8069                 24  CH-ZIP-PRI-1ST        PIC X.
  8070                     88  CH-CANADIAN-POST-CODE
  8071                                           VALUES 'A' THRU 'Z'.
  8072                 24  FILLER                PIC X(4).
  8073             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8074         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8075             20  CH-CAN-POSTAL-1           PIC XXX.
  8076             20  CH-CAN-POSTAL-2           PIC XXX.
  8077             20  FILLER                    PIC XXX.
  8078
  8079     12  CH-CHECK-STUB-TEXT.
  8080         16  CH-STUB-LINE-1                PIC X(30).
  8081         16  CH-TEXT-LINE-1                PIC X(50).
  8082         16  CH-TEXT-LINE-2                PIC X(50).
  8083         16  CH-TEXT-LINE-3                PIC X(40).
  8084     12  CH-RETURN-TO                      PIC X(30).
  8085
  8086     12  CH-COMPENSATION-CONTROL.
  8087         16  CH-COMP-CARRIER               PIC X.
  8088         16  CH-COMP-GROUPING              PIC X(6).
  8089         16  CH-COMP-FIN-RESP              PIC X(10).
  8090         16  CH-COMP-ACCOUNT               PIC X(10).
  8091
  8092     12  CH-CREDIT-SELECT-DT               PIC XX.
  8093     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8094     12  CH-PAYEE-CODE                     PIC X(6).
  8095
  8096     12  CH-VOID-DATA.
  8097         20  CH-VOID-DT                    PIC XX.
  8098         20  CH-VOID-BY                    PIC X(4).
  8099         20  CH-VOID-REASON                PIC X(25).
  8100
  8101     12  CH-APPROVAL-DATA.
  8102         20  CH-APPROVAL-DT                PIC XX.
  8103         20  CH-APPROVAL-STATUS            PIC X.
  8104             88  CH-IN-LIMBO                  VALUE ' '.
  8105             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8106             88  CH-APPROVED                  VALUE 'A'.
  8107             88  CH-DENIED                    VALUE 'D'.
  8108         20  CH-APPROVED-BY                PIC XXXX.
  8109     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8110             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8111     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8112
  8113     12  ch-released-dt                    pic xx.
  8114     12  ch-check-cashed-dt                pic xx.
  8115     12  FILLER                            PIC X.
  8116*    12  CH-CHECK-REFERENCE                PIC X(12).
  8117     12  CH-CHECK-ORIGIN-SW                PIC X.
  8118             88  CH-REFUND-CHECK              VALUE 'R'.
  8119             88  CH-MAINT-CHECK               VALUE 'M'.
  8120
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 149
* EL6311.cbl
  8121     12  CH-CANC-DT                        PIC XX.
  8122     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8123     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8124
  8125     12  CH-INSURED-NAME                   PIC X(28).
  8126
  8127     12  ch-released-by                    pic x(4).
  8128     12  ch-csr                            pic x(4).
  8129     12  ch-deduct-commission              pic x.
  8130         88  ch-deduct-comm                  value 'Y'.
  8131         88  ch-do-not-deduct-comm           value 'N'.
  8132
  8133     12  FILLER                            PIC X(11).
  8134*    12  CH-LETTER-TABLE.
  8135*        16  CH-LETTERS OCCURS 3 TIMES
  8136*                       INDEXED BY CH-LT-NDX
  8137*                                          PIC X(04).
  8138
  8139     12  FILLER                            PIC X(07).
  8140
  8141 01  var                         pic x(30).
  8142 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8143                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8144                          PENDING-MAILING-DATA MAILING-DATA
  8145                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8146                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8147                          CLAIM-MASTER ENDORSEMENT-RECORD
  8148                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8149                          VAR.
  8150 0000-DFHEXIT SECTION.
  8151     MOVE '9#                    $   ' TO DFHEIV0.
  8152     MOVE 'EL6311' TO DFHEIV1.
  8153     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8154
  8155     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8156     MOVE EIBTRMID               TO QID-TERM.
  8157     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8158     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8159     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8160     MOVE 2                      TO EMI-SWITCH2.
  8161
  8162     move spaces to ws-kix-myenv
  8163     set P to address of KIXSYS
  8164     CALL "getenv" using by value P returning var-ptr
  8165     if var-ptr = null then
  8166        display ' kixsys not set '
  8167     else
  8168        set address of var to var-ptr
  8169        move 0 to env-var-len
  8170        inspect var tallying env-var-len
  8171          for characters before X'00'
  8172        unstring var (1:env-var-len) delimited by '/'
  8173           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8174              WS-KIX-SYS
  8175        end-unstring
  8176     end-if
  8177     perform varying a1 from +1 by +1 until a1 > +10
  8178        if ws-kix-myenv (a1:1) = low-values or high-values
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 150
* EL6311.cbl
  8179           display ' found low or hi val '
  8180           move spaces to ws-kix-myenv (a1:1)
  8181        end-if
  8182     end-perform
  8183*    display ' env *' ws-kix-myenv '*'
  8184     IF EIBCALEN = 0
  8185         GO TO 8800-UNAUTHORIZED-ACCESS.
  8186
  8187     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8188     MOVE '5'                   TO DC-OPTION-CODE.
  8189     PERFORM 9700-DATE-LINK.
  8190     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8191     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8192
  8193     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8194     MOVE SPACE                  TO DC-OPTION-CODE.
  8195     PERFORM 9700-DATE-LINK.
  8196     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8197     MOVE LOW-VALUES             TO EL631BI.
  8198
  8199
  8200* EXEC CICS HANDLE CONDITION
  8201*        PGMIDERR  (9600-PGMID-ERROR)
  8202*        ERROR     (9990-ABEND)
  8203*        INVREQ    (9990-ABEND)
  8204*        QIDERR    (0010-MAIN-LOGIC)
  8205*    END-EXEC.
  8206*    MOVE '"$L.8N                ! " #00008195' TO DFHEIV0
  8207     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8208     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8209     MOVE X'2220233030303038313935' TO DFHEIV0(25:11)
  8210     CALL 'kxdfhei1' USING DFHEIV0
  8211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8212
  8213
  8214     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8215         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8216             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8217             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8218             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8219             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8220             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8221             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8222             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8223             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8224
  8225             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8226                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8227
  8228             ELSE
  8229                 NEXT SENTENCE
  8230
  8231         ELSE
  8232             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8233             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8234             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8235             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8236             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 151
* EL6311.cbl
  8237             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8238             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8239             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8240             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8241             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8242             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8243             GO TO 3900-RE-DISPLAY-RECORD
  8244     ELSE
  8245         GO TO 0020-MAIN-LOGIC.
  8246
  8247 0010-MAIN-LOGIC.
  8248     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8249                                    WS-FIRST-ENTRY-SW.
  8250
  8251     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8252
  8253     MOVE LOW-VALUES             TO EC-NEW-CERT
  8254                                    EC-NEW-STATE.
  8255
  8256     IF PI-DISPLAY-ORIGINAL-BATCH
  8257         NEXT SENTENCE
  8258     ELSE
  8259         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8260             GO TO 5000-BROWSE-BATCH-HEADERS.
  8261
  8262     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8263         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8264
  8265     IF PI-CSR-BROWSE
  8266        GO TO 4200-BROWSE-CSR-FORWARD.
  8267
  8268     IF PI-FILE-BROWSE
  8269         GO TO 4300-BROWSE-FILE-FORWARD.
  8270
  8271     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8272
  8273 0020-MAIN-LOGIC.
  8274     IF EIBAID = DFHCLEAR
  8275         GO TO 9400-CLEAR.
  8276
  8277     MOVE LOW-VALUES             TO EC-NEW-CERT
  8278                                    EC-NEW-STATE.
  8279
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 152
* EL6311.cbl
  8281
  8282******************************************************************
  8283*                                                                *
  8284*              R E C E I V E   M A P                             *
  8285*                                                                *
  8286******************************************************************
  8287
  8288 0200-RECEIVE.
  8289     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8290         MOVE ER-0008            TO EMI-ERROR
  8291         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8292         IF PI-MAP-NAME = EL631B
  8293             MOVE -1                 TO BMAINTL
  8294             GO TO 8200-SEND-DATAONLY
  8295         ELSE
  8296             IF PI-MAP-NAME = EL631C
  8297                 MOVE -1                 TO CMAINTL
  8298                 GO TO 8200-SEND-DATAONLY
  8299             ELSE
  8300                 IF PI-MAP-NAME = EL631D
  8301                     MOVE -1                 TO DPFENTRL
  8302                     GO TO 8200-SEND-DATAONLY.
  8303
  8304
  8305* EXEC CICS RECEIVE
  8306*        MAP      (PI-MAP-NAME)
  8307*        MAPSET   (MAPSET-EL6311S)
  8308*        INTO     (EL631BI)
  8309*    END-EXEC.
  8310     MOVE LENGTH OF
  8311      EL631BI
  8312       TO DFHEIV11
  8313*    MOVE '8"T I  L              ''   #00008292' TO DFHEIV0
  8314     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8315     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8316     MOVE X'2020233030303038323932' TO DFHEIV0(25:11)
  8317     CALL 'kxdfhei1' USING DFHEIV0,
  8318           PI-MAP-NAME,
  8319           EL631BI,
  8320           DFHEIV11,
  8321           MAPSET-EL6311S,
  8322           DFHEIV99,
  8323           DFHEIV99
  8324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8325
  8326
  8327******************************************************************
  8328*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8329******************************************************************
  8330
  8331     IF BTYPE-LEN (1) EQUAL +3
  8332        IF BTYPE (1) EQUAL ALL ' '
  8333            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8334
  8335     IF BTYPE-LEN (2) EQUAL +3
  8336        IF BTYPE (2) EQUAL ALL ' '
  8337            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8338
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 153
* EL6311.cbl
  8339     INSPECT EL631BI CONVERTING '_' TO ' '.
  8340
  8341     IF PI-MAP-NAME = EL631B
  8342         IF BPFENTRL GREATER THAN ZEROS
  8343             IF EIBAID NOT = DFHENTER
  8344                 MOVE ER-0004       TO EMI-ERROR
  8345                 MOVE -1            TO BPFENTRL
  8346                 MOVE AL-UNBOF      TO BPFENTRA
  8347                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8348                 GO TO 8200-SEND-DATAONLY
  8349             ELSE
  8350                 IF BPFENTRI NUMERIC AND
  8351                   (BPFENTRI GREATER 0 AND LESS 25)
  8352                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8353                 ELSE
  8354                     MOVE ER-0029  TO EMI-ERROR
  8355                     MOVE AL-UNBON TO BPFENTRA
  8356                     MOVE -1       TO BPFENTRL
  8357                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8358                     GO TO 8200-SEND-DATAONLY
  8359         ELSE
  8360             NEXT SENTENCE
  8361     ELSE
  8362         IF PI-MAP-NAME = EL631C
  8363            IF CPFENTRL GREATER THAN ZEROS
  8364                IF EIBAID NOT = DFHENTER
  8365                 MOVE ER-0004         TO EMI-ERROR
  8366                 MOVE -1              TO CPFENTRL
  8367                 MOVE AL-UNBOF        TO CPFENTRA
  8368                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8369                 GO TO 8200-SEND-DATAONLY
  8370             ELSE
  8371                 IF CPFENTRI NUMERIC AND
  8372                   (CPFENTRI GREATER 0 AND LESS 25)
  8373                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8374                 ELSE
  8375                     MOVE ER-0029      TO EMI-ERROR
  8376                     MOVE AL-UNBON     TO CPFENTRA
  8377                     MOVE -1           TO CPFENTRL
  8378                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8379                     GO TO 8200-SEND-DATAONLY
  8380         ELSE
  8381             NEXT SENTENCE
  8382     ELSE
  8383     IF PI-MAP-NAME = EL631D
  8384         IF DPFENTRL GREATER THAN ZEROS
  8385             IF EIBAID NOT = DFHENTER
  8386                 MOVE ER-0004         TO EMI-ERROR
  8387                 MOVE -1              TO DPFENTRL
  8388                 MOVE AL-UNBOF        TO DPFENTRA
  8389                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8390                 GO TO 8200-SEND-DATAONLY
  8391             ELSE
  8392                 IF DPFENTRI NUMERIC AND
  8393                   (DPFENTRI GREATER 0 AND LESS 25)
  8394                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8395                 ELSE
  8396                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 154
* EL6311.cbl
  8397                     MOVE AL-UNBON     TO DPFENTRA
  8398                     MOVE -1           TO DPFENTRL
  8399                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8400                     GO TO 8200-SEND-DATAONLY.
  8401
  8402     IF EIBAID = DFHPF23
  8403         GO TO 8810-PF23.
  8404
  8405     IF EIBAID = DFHPF24
  8406         GO TO 9200-RETURN-MAIN-MENU.
  8407
  8408     IF EIBAID = DFHPF12
  8409         GO TO 9500-PF12.
  8410
  8411     IF PI-MAP-NAME = EL631B
  8412        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8413
  8414     IF PI-MAP-NAME = EL631C
  8415        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8416
  8417     IF PI-MAP-NAME = EL631D
  8418        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8419
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 155
* EL6311.cbl
  8421
  8422******************************************************************
  8423*                                                                *
  8424*      ISSUE SCREEN PF KEY CHECKING                              *
  8425*                                                                *
  8426******************************************************************
  8427
  8428******************************************************************
  8429*                                                                *
  8430*      PF KEY FUNCTIONS:                                         *
  8431*                                                                *
  8432*      PF1  = BROWSE FORWARD                                     *
  8433*      PF2  = BROWSE BACKWARD                                    *
  8434*      PF3  = CERTIFICATE LOOKUP                                 *
  8435*      PF4  = DISPLAY BATCH HEADER                               *
  8436*      PF5  = ADD ISSUE  SCREEN                                  *
  8437*      PF6  = ADD CANCEL SCREEN                                  *
  8438*      PF7  = CERTIFICATE DISPLAY                                *
  8439*      PF8  = CERTIFICATE NOTES                                  *
  8440*      PF9  = EDIT CONTROL                                       *
  8441*      PF10 = DISPLAY LETTER SCREEN                              *
  8442*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8443*      PF12 = HELP SCREEN                                        *
  8444*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8445*      PF14 = ACCOUNT MASTER                                     *
  8446*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8447*      PF16 = DISPLAY LETTER REVIEW                              *
  8448*                                                                *
  8449******************************************************************
  8450
  8451 0300-CHECK-ISSUE-PF-KEYS.
  8452     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8453        MOVE ER-2337            TO EMI-ERROR
  8454        MOVE -1                  TO BMAINTL
  8455        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8456        GO TO 8200-SEND-DATAONLY.
  8457
  8458     IF EIBAID = DFHPF1
  8459        MOVE '0'                TO PI-EDIT-SW
  8460        IF PI-PRIMARY-BROWSE
  8461           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8462        ELSE
  8463           IF PI-PRIMARY-WITH-SELECT
  8464              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8465           ELSE
  8466              IF PI-FILE-BROWSE
  8467                 GO TO 4300-BROWSE-FILE-FORWARD
  8468              ELSE
  8469                 IF PI-CSR-BROWSE
  8470                    GO TO 4200-BROWSE-CSR-FORWARD
  8471                 ELSE
  8472                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8473
  8474     IF EIBAID = DFHPF2
  8475        MOVE '0'                TO PI-EDIT-SW
  8476        IF PI-PRIMARY-BROWSE
  8477           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8478        ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 156
* EL6311.cbl
  8479           IF PI-PRIMARY-WITH-SELECT
  8480              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8481           ELSE
  8482              IF PI-FILE-BROWSE
  8483                 GO TO 4800-BROWSE-FILE-BACKWARD
  8484              ELSE
  8485                 IF PI-CSR-BROWSE
  8486                    GO TO 4900-BROWSE-CSR-BACKWARD
  8487                 ELSE
  8488                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8489
  8490     IF EIBAID = DFHPF3
  8491        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8492        MOVE XCTL-EL127         TO PGM-NAME
  8493        GO TO 9300-XCTL.
  8494
  8495     IF (EIBAID = DFHPF15 OR DFHPF6)
  8496        AND (CSR-EDIT-SESSION)
  8497*       AND (FATAL-OR-UNFORCED)
  8498        AND (FATAL-ERRORS)
  8499        MOVE ER-1819             TO EMI-ERROR
  8500        MOVE -1                  TO BMAINTL
  8501        MOVE AL-UANON            TO BMAINTA
  8502        PERFORM 9900-ERROR-FORMAT
  8503                                 THRU 9900-EXIT
  8504        GO TO 8200-SEND-DATAONLY
  8505     END-IF
  8506     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8507      OR (EIBAID = DFHPF10)
  8508        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8509        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8510        IF (RESP-NORMAL)
  8511           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8512              AM-CONTROL-PRIMARY (1:20))
  8513            IF AM-NAME NOT GREATER THAN SPACES OR
  8514               AM-ADDRS NOT GREATER THAN SPACES  OR
  8515               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8516               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8517               AM-ZIP NOT GREATER THAN SPACES
  8518               MOVE ER-3834             TO EMI-ERROR
  8519               MOVE -1                  TO BMAINTL
  8520               MOVE AL-UANON            TO BMAINTA
  8521               PERFORM 9900-ERROR-FORMAT
  8522                                 THRU 9900-EXIT
  8523               GO TO 8200-SEND-DATAONLY
  8524            END-IF
  8525        ELSE
  8526           MOVE ER-1609             TO EMI-ERROR
  8527           MOVE -1                  TO BMAINTL
  8528           MOVE AL-UANON            TO BMAINTA
  8529           PERFORM 9900-ERROR-FORMAT
  8530                                THRU 9900-EXIT
  8531           GO TO 8200-SEND-DATAONLY
  8532        END-IF
  8533
  8534        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8535        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8536        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 157
* EL6311.cbl
  8537            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8538               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8539               MA-CITY NOT GREATER THAN SPACES OR
  8540               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8541               MA-ZIP-CODE NOT GREATER THAN SPACES
  8542               MOVE ER-3835             TO EMI-ERROR
  8543               MOVE -1                  TO BMAINTL
  8544               MOVE AL-UANON            TO BMAINTA
  8545               PERFORM 9900-ERROR-FORMAT
  8546                                 THRU 9900-EXIT
  8547               GO TO 8200-SEND-DATAONLY
  8548            END-IF
  8549        ELSE
  8550           MOVE ER-3000             TO EMI-ERROR
  8551           MOVE -1                  TO BMAINTL
  8552           MOVE AL-UANON            TO BMAINTA
  8553           PERFORM 9900-ERROR-FORMAT
  8554                                THRU 9900-EXIT
  8555           GO TO 8200-SEND-DATAONLY
  8556        END-IF
  8557
  8558     END-IF
  8559     IF (EIBAID = DFHPF15)
  8560        AND (CSR-EDIT-SESSION)
  8561        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8562        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8563        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8564        MOVE PI-SV-STATE         TO PI-STATE
  8565        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8566        MOVE BCERTNOI            TO PI-CERT-PRIME
  8567        MOVE BSUFIXI             TO PI-CERT-SFX
  8568        MOVE BEFFDTI             TO DEEDIT-FIELD
  8569        PERFORM 8600-DEEDIT
  8570        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8571        MOVE '4'                 TO DC-OPTION-CODE
  8572        PERFORM 9700-DATE-LINK
  8573        IF DATE-CONVERSION-ERROR
  8574           MOVE ER-0348          TO EMI-ERROR
  8575           MOVE -1               TO BEFFDTL
  8576           MOVE AL-UABON         TO BEFFDTA
  8577           PERFORM 9900-ERROR-FORMAT
  8578                                 THRU 9900-EXIT
  8579           GO TO 8200-SEND-DATAONLY
  8580        ELSE
  8581           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8582           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8583           MOVE XCTL-EL6315      TO PGM-NAME
  8584           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8585           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8586           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8587           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8588           GO TO 9300-XCTL
  8589        END-IF
  8590     END-IF
  8591
  8592     IF EIBAID = DFHPF4
  8593        MOVE '0'                TO PI-EDIT-SW
  8594        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 158
* EL6311.cbl
  8595           NEXT SENTENCE
  8596        ELSE
  8597           GO TO 7200-DISPLAY-BATCHES.
  8598
  8599     IF EIBAID = DFHPF5
  8600        MOVE ER-0029                TO EMI-ERROR
  8601        MOVE -1                     TO BPFENTRL
  8602        MOVE AL-UNBON               TO BPFENTRA
  8603        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8604        GO TO 8200-SEND-DATAONLY.
  8605*        MOVE '0'                TO PI-EDIT-SW
  8606*        IF PI-DISPLAY-ORIGINAL-BATCH
  8607*           NEXT SENTENCE
  8608*        ELSE
  8609*           MOVE EL631B              TO PI-MAP-NAME
  8610*           MOVE LOW-VALUES          TO EL631BI
  8611*           MOVE 'A'                 TO BMAINTO
  8612*           MOVE AL-UANON            TO BMAINTA
  8613*           MOVE -1                  TO BMAINTL
  8614*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8615*           GO TO 8100-SEND-INITIAL-MAP.
  8616
  8617     IF EIBAID = DFHPF6
  8618        IF NOT CSR-EDIT-SESSION
  8619           MOVE ER-0029                TO EMI-ERROR
  8620           MOVE -1                     TO BPFENTRL
  8621           MOVE AL-UNBON               TO BPFENTRA
  8622           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8623           GO TO 8200-SEND-DATAONLY
  8624*           MOVE '0'              TO PI-EDIT-SW
  8625*           IF PI-DISPLAY-ORIGINAL-BATCH
  8626*              NEXT SENTENCE
  8627*           ELSE
  8628*              MOVE EL631C        TO PI-MAP-NAME
  8629*              MOVE LOW-VALUES    TO EL631CI
  8630*              MOVE 'A'           TO CMAINTO
  8631*              MOVE AL-UANON      TO CMAINTA
  8632*              MOVE -1            TO CMAINTL
  8633*              MOVE '6'           TO PI-MAINT-FUNCTION
  8634*              GO TO 8100-SEND-INITIAL-MAP
  8635*           END-IF
  8636        ELSE
  8637           PERFORM 5100-PROCESS-POL-RESC
  8638                                 THRU 5100-EXIT
  8639           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8640           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8641                                    PI-PREV-SEQ-NO
  8642           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8643*                                    WS-CANCEL-LETTER-SW
  8644                                    PI-ALL-ISSUES-SW
  8645                                    PI-ALL-CANCELS-SW
  8646           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8647        END-IF
  8648     END-IF
  8649     IF EIBAID = DFHPF7
  8650        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8651        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8652        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 159
* EL6311.cbl
  8653        MOVE PI-SV-STATE            TO PI-STATE
  8654        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8655        MOVE BCERTNOI               TO PI-CERT-PRIME
  8656        MOVE BSUFIXI                TO PI-CERT-SFX
  8657        MOVE BEFFDTI                TO DEEDIT-FIELD
  8658        PERFORM 8600-DEEDIT
  8659        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8660        MOVE '4'                    TO DC-OPTION-CODE
  8661        PERFORM 9700-DATE-LINK
  8662        IF DATE-CONVERSION-ERROR
  8663           MOVE ER-0348            TO EMI-ERROR
  8664           MOVE -1                  TO BEFFDTL
  8665           MOVE AL-UABON            TO BEFFDTA
  8666           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8667           GO TO 8200-SEND-DATAONLY
  8668        ELSE
  8669           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8670           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8671           MOVE XCTL-EL1273        TO PGM-NAME
  8672           GO TO 9300-XCTL.
  8673
  8674     IF EIBAID = DFHPF8
  8675        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8676        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8677        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8678        MOVE PI-SV-STATE            TO PI-STATE
  8679        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8680        MOVE BCERTNOI               TO PI-CERT-PRIME
  8681        MOVE BSUFIXI                TO PI-CERT-SFX
  8682        MOVE BEFFDTI                TO DEEDIT-FIELD
  8683        PERFORM 8600-DEEDIT
  8684        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8685        MOVE '4'                    TO DC-OPTION-CODE
  8686        PERFORM 9700-DATE-LINK
  8687        IF DATE-CONVERSION-ERROR
  8688           MOVE ER-0348            TO EMI-ERROR
  8689           MOVE -1                  TO BEFFDTL
  8690           MOVE AL-UABON            TO BEFFDTA
  8691           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8692           GO TO 8200-SEND-DATAONLY
  8693        ELSE
  8694           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8695           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8696           IF PI-COMPANY-ID = 'DMD'
  8697               MOVE XCTL-EL401DMD      TO PGM-NAME
  8698             ELSE
  8699               MOVE XCTL-EL1279        TO PGM-NAME
  8700           END-IF
  8701           GO TO 9300-XCTL.
  8702
  8703     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8704        MOVE XCTL-EL6312         TO PGM-NAME
  8705
  8706* EXEC CICS XCTL
  8707*           PROGRAM   (PGM-NAME)
  8708*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8709*           LENGTH    (WS-COMM-LENGTH)
  8710*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 160
* EL6311.cbl
  8711*    MOVE '.$C                   %   #00008676' TO DFHEIV0
  8712     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8713     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8714     MOVE X'2020233030303038363736' TO DFHEIV0(25:11)
  8715     CALL 'kxdfhei1' USING DFHEIV0,
  8716           PGM-NAME,
  8717           PROGRAM-INTERFACE-BLOCK,
  8718           WS-COMM-LENGTH,
  8719           DFHEIV99
  8720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8721     ELSE
  8722        MOVE '0'                 TO  PI-EDIT-SW.
  8723
  8724     IF  EIBAID = DFHPF10
  8725         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8726         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8727         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8728                                    PI-1042-WA
  8729         MOVE 4                  TO PI-689-DATA-SOURCE
  8730         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8731         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8732         MOVE PI-SV-STATE        TO PI-689-STATE
  8733         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8734         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8735         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8736         MOVE PI-PB-ALT-CHG-SEQ-NO
  8737                                 TO PI-689-ALT-SEQ-NO
  8738         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8739         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8740         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8741         MOVE +0                 TO PI-689-CONTROL
  8742         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8743                                    PI-689-EXP-DATE
  8744                                    PI-689-RESP-PERSON
  8745                                    PI-689-TYPE
  8746                                    PI-689-FOLLOW-UP-EDIT
  8747                                    PI-689-RESEND1-EDIT
  8748                                    PI-689-SEQ-EDIT
  8749                                    PI-689-BCSEQ-EDIT
  8750                                    PI-689-LBL-OVERRIDE
  8751         MOVE W-LETTER-COMMUNICATION-AREAS
  8752                                 TO PI-PROGRAM-WORK-AREA
  8753         MOVE XCTL-EL689         TO PGM-NAME
  8754         GO TO 9300-XCTL.
  8755
  8756     IF  EIBAID = DFHPF16
  8757         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8758         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8759         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8760                                    PI-1042-WA
  8761         MOVE 4                  TO PI-689-DATA-SOURCE
  8762         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8763         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8764         MOVE PI-SV-STATE        TO PI-689-STATE
  8765         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8766         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8767         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8768         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 161
* EL6311.cbl
  8769                                 TO PI-689-ALT-SEQ-NO
  8770         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8771         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8772         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8773         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8774         MOVE W-LETTER-COMMUNICATION-AREAS
  8775                                 TO PI-PROGRAM-WORK-AREA
  8776         MOVE XCTL-EL690         TO PGM-NAME
  8777         GO TO 9300-XCTL.
  8778
  8779     IF EIBAID = DFHPF13
  8780         MOVE XCTL-EL6313        TO PGM-NAME
  8781         GO TO 9300-XCTL.
  8782
  8783     IF EIBAID = DFHPF17
  8784        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8785        IF (PB-I-LOAN-APR numeric)
  8786           and (pb-i-loan-apr < 99.9999)
  8787           AND (PB-I-BENEFICIARY-NAME NOT
  8788              = SPACES AND LOW-VALUES)
  8789
  8790           MOVE LINK-ELVADS          TO PGM-NAME
  8791
  8792* EXEC CICS LINK
  8793*              PROGRAM    (PGM-NAME)
  8794*              COMMAREA   (WS-PASS-AREA)
  8795*              LENGTH     (WS-PASS-AREA-LENGTH)
  8796*          END-EXEC
  8797*    MOVE '."C                   (   #00008751' TO DFHEIV0
  8798     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8799     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8800     MOVE X'2020233030303038373531' TO DFHEIV0(25:11)
  8801     CALL 'kxdfhei1' USING DFHEIV0,
  8802           PGM-NAME,
  8803           WS-PASS-AREA,
  8804           WS-PASS-AREA-LENGTH,
  8805           DFHEIV99,
  8806           DFHEIV99,
  8807           DFHEIV99,
  8808           DFHEIV99
  8809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8810
  8811           MOVE 0000             TO EMI-ERROR
  8812           MOVE -1               TO BMAINTL
  8813           PERFORM 9900-ERROR-FORMAT
  8814                                 THRU 9900-EXIT
  8815           GO TO 8200-SEND-DATAONLY
  8816        ELSE
  8817           MOVE ER-0877            TO EMI-ERROR
  8818           MOVE -1                  TO BEFFDTL
  8819           MOVE AL-UABON            TO BEFFDTA
  8820           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8821           GO TO 8200-SEND-DATAONLY
  8822        END-IF
  8823     END-IF
  8824     IF EIBAID = DFHPF14
  8825        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8826        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 162
* EL6311.cbl
  8827        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8828        MOVE PI-SV-STATE            TO PI-CR-STATE
  8829        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8830        MOVE SPACE                  TO PI-EDIT-SW
  8831        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8832        MOVE XCTL-EL650             TO PGM-NAME
  8833        GO TO 9300-XCTL.
  8834
  8835     IF EIBAID = DFHPF15
  8836        IF PI-COMPANY-ID  =  'HER'
  8837            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8838            MOVE XCTL-EL680         TO PGM-NAME
  8839            GO TO 9300-XCTL.
  8840
  8841     IF EIBAID = DFHENTER OR DFHPF11
  8842        GO TO 1000-ISSUE-MAINLINE.
  8843
  8844     MOVE ER-0029                TO EMI-ERROR
  8845     MOVE -1                     TO BPFENTRL
  8846     MOVE AL-UNBON               TO BPFENTRA
  8847     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8848     GO TO 8200-SEND-DATAONLY.
  8849
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 163
* EL6311.cbl
  8851
  8852******************************************************************
  8853*                                                                *
  8854*      CANCEL SCREEN PF KEY CHECKING                             *
  8855*                                                                *
  8856******************************************************************
  8857
  8858******************************************************************
  8859*                                                                *
  8860*      PF KEY FUNCTIONS:                                         *
  8861*                                                                *
  8862*      PF1  = BROWSE FORWARD                                     *
  8863*      PF2  = BROWSE BACKWARD                                    *
  8864*      PF3  = CERTIFICATE LOOKUP                                 *
  8865*      PF4  = DISPLAY BATCH HEADER                               *
  8866*      PF5  = ADD ISSUE SCREEN                                   *
  8867*      PF6  = ADD CANCEL SCREEN                                  *
  8868*      PF7  = CERTIFICATE DISPLAY                                *
  8869*      PF8  = CERTIFICATE NOTES                                  *
  8870*      PF9  = EDIT CONTROL                                       *
  8871*      PF10 = DISPLAY LETTER SCREEN                              *
  8872*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8873*      PF12 = DISPLAY HELP SCREEN                                *
  8874*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8875*      PF14 = ACCOUNT MASTER                                     *
  8876*      PF16 = LETTER REVIEW                                      *
  8877*                                                                *
  8878******************************************************************
  8879
  8880 0400-CHECK-CANCEL-PF-KEYS.
  8881     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8882        MOVE ER-2337             TO EMI-ERROR
  8883        MOVE -1                  TO CMAINTL
  8884        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8885        GO TO 8200-SEND-DATAONLY.
  8886
  8887     IF EIBAID = DFHPF1
  8888        MOVE '0'                TO PI-EDIT-SW
  8889        IF PI-PRIMARY-BROWSE
  8890           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8891        ELSE
  8892           IF PI-PRIMARY-WITH-SELECT
  8893              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8894           ELSE
  8895              IF PI-FILE-BROWSE
  8896                 GO TO 4300-BROWSE-FILE-FORWARD
  8897              ELSE
  8898                 IF PI-CSR-BROWSE
  8899                    GO TO 4200-BROWSE-CSR-FORWARD
  8900                 ELSE
  8901                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8902
  8903     IF EIBAID = DFHPF2
  8904        MOVE '0'                TO PI-EDIT-SW
  8905        IF PI-PRIMARY-BROWSE
  8906           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8907        ELSE
  8908           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 164
* EL6311.cbl
  8909              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8910           ELSE
  8911              IF PI-FILE-BROWSE
  8912                 GO TO 4800-BROWSE-FILE-BACKWARD
  8913              ELSE
  8914                 IF PI-CSR-BROWSE
  8915                    GO TO 4900-BROWSE-CSR-BACKWARD
  8916                 ELSE
  8917                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8918
  8919     IF EIBAID = DFHPF3
  8920        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8921        MOVE XCTL-EL127         TO PGM-NAME
  8922        GO TO 9300-XCTL.
  8923
  8924     IF (EIBAID = DFHPF15 OR DFHPF17)
  8925        AND (CSR-EDIT-SESSION)
  8926*       AND (FATAL-OR-UNFORCED)
  8927        AND (FATAL-ERRORS)
  8928        MOVE ER-1819             TO EMI-ERROR
  8929        MOVE -1                  TO CMAINTL
  8930        MOVE AL-UANON            TO CMAINTA
  8931        PERFORM 9900-ERROR-FORMAT
  8932                                 THRU 9900-EXIT
  8933        GO TO 8200-SEND-DATAONLY
  8934     END-IF
  8935     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8936       AND (CSR-EDIT-SESSION)
  8937        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8938        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8939        IF (RESP-NORMAL)
  8940           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8941              AM-CONTROL-PRIMARY (1:20))
  8942            IF AM-NAME NOT GREATER THAN SPACES OR
  8943               AM-ADDRS NOT GREATER THAN SPACES  OR
  8944               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8945               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8946               AM-ZIP NOT GREATER THAN SPACES
  8947               MOVE ER-3834             TO EMI-ERROR
  8948               MOVE -1                  TO BMAINTL
  8949               MOVE AL-UANON            TO BMAINTA
  8950               PERFORM 9900-ERROR-FORMAT
  8951                                 THRU 9900-EXIT
  8952               GO TO 8200-SEND-DATAONLY
  8953            END-IF
  8954        ELSE
  8955           MOVE ER-1609             TO EMI-ERROR
  8956           MOVE -1                  TO BMAINTL
  8957           MOVE AL-UANON            TO BMAINTA
  8958           PERFORM 9900-ERROR-FORMAT
  8959                                THRU 9900-EXIT
  8960           GO TO 8200-SEND-DATAONLY
  8961        END-IF
  8962
  8963        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8964        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8965        IF (ERMAIL-FOUND)
  8966            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 165
* EL6311.cbl
  8967               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8968               MA-CITY NOT GREATER THAN SPACES OR
  8969               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8970               MA-ZIP-CODE NOT GREATER THAN SPACES
  8971               MOVE ER-3835             TO EMI-ERROR
  8972               MOVE -1                  TO BMAINTL
  8973               MOVE AL-UANON            TO BMAINTA
  8974               PERFORM 9900-ERROR-FORMAT
  8975                                 THRU 9900-EXIT
  8976               GO TO 8200-SEND-DATAONLY
  8977            END-IF
  8978        ELSE
  8979           MOVE ER-3000             TO EMI-ERROR
  8980           MOVE -1                  TO BMAINTL
  8981           MOVE AL-UANON            TO BMAINTA
  8982           PERFORM 9900-ERROR-FORMAT
  8983                                THRU 9900-EXIT
  8984           GO TO 8200-SEND-DATAONLY
  8985        END-IF
  8986
  8987     END-IF
  8988     IF (EIBAID = DFHPF15 OR DFHPF17)
  8989        AND (CSR-EDIT-SESSION)
  8990        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8991        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8992        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8993        MOVE PI-SV-STATE         TO PI-STATE
  8994        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8995        MOVE CCERTNOI            TO PI-CERT-PRIME
  8996        MOVE CSUFIXI             TO PI-CERT-SFX
  8997        MOVE CEFFDTI             TO DEEDIT-FIELD
  8998        PERFORM 8600-DEEDIT
  8999        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9000        MOVE '4'                 TO DC-OPTION-CODE
  9001        PERFORM 9700-DATE-LINK
  9002        IF DATE-CONVERSION-ERROR
  9003           MOVE ER-0348          TO EMI-ERROR
  9004           MOVE -1               TO CEFFDTL
  9005           MOVE AL-UABON         TO CEFFDTA
  9006           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9007           GO TO 8200-SEND-DATAONLY
  9008        ELSE
  9009           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9010           PERFORM 6000-CREATE-TEMP-STORAGE
  9011                                 THRU 6000-EXIT
  9012           IF EIBAID = DFHPF17
  9013               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9014                                  THRU 6400-EXIT
  9015               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9016                                 '2' AND '3' AND '4'
  9017                  MOVE ER-3831     TO  EMI-ERROR
  9018                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9019                  GO TO 8200-SEND-DATAONLY
  9020               END-IF
  9021               MOVE 'Y'          TO PI-CLM-RESC-IND
  9022           ELSE
  9023               MOVE 'N'          TO PI-CLM-RESC-IND
  9024           END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 166
* EL6311.cbl
  9025           MOVE XCTL-EL6316      TO PGM-NAME
  9026           MOVE '2'              TO PI-ISS-CAN-SW
  9027           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9028           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9029           GO TO 9300-XCTL
  9030        END-IF
  9031     END-IF
  9032
  9033     IF EIBAID = DFHPF4
  9034        MOVE '0'                TO PI-EDIT-SW
  9035        IF PI-DISPLAY-ORIGINAL-BATCH
  9036           NEXT SENTENCE
  9037        ELSE
  9038           GO TO 7200-DISPLAY-BATCHES.
  9039
  9040     IF EIBAID = DFHPF5
  9041        MOVE ER-0029                TO EMI-ERROR
  9042        MOVE -1                     TO BPFENTRL
  9043        MOVE AL-UNBON               TO BPFENTRA
  9044        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9045        GO TO 8200-SEND-DATAONLY.
  9046*        MOVE '0'                TO PI-EDIT-SW
  9047*        IF PI-DISPLAY-ORIGINAL-BATCH
  9048*           NEXT SENTENCE
  9049*        ELSE
  9050*           MOVE EL631B              TO PI-MAP-NAME
  9051*           MOVE LOW-VALUES          TO EL631BI
  9052*           MOVE 'A'                 TO BMAINTO
  9053*           MOVE AL-UANON            TO BMAINTA
  9054*           MOVE -1                  TO BMAINTL
  9055*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9056*           GO TO 8100-SEND-INITIAL-MAP.
  9057
  9058     IF EIBAID = DFHPF6
  9059        MOVE ER-0029                TO EMI-ERROR
  9060        MOVE -1                     TO BPFENTRL
  9061        MOVE AL-UNBON               TO BPFENTRA
  9062        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9063        GO TO 8200-SEND-DATAONLY.
  9064*        MOVE '0'                TO PI-EDIT-SW
  9065*        IF PI-DISPLAY-ORIGINAL-BATCH
  9066*           NEXT SENTENCE
  9067*        ELSE
  9068*           MOVE EL631C              TO PI-MAP-NAME
  9069*           MOVE LOW-VALUES          TO EL631CI
  9070*           MOVE 'A'                 TO CMAINTO
  9071*           MOVE AL-UANON            TO CMAINTA
  9072*           MOVE -1                  TO CMAINTL
  9073*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9074*           GO TO 8100-SEND-INITIAL-MAP.
  9075
  9076     IF EIBAID = DFHPF7
  9077        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9078        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9079        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9080        MOVE PI-SV-STATE            TO PI-STATE
  9081        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9082        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 167
* EL6311.cbl
  9083        MOVE CSUFIXI                TO PI-CERT-SFX
  9084        MOVE CEFFDTI                TO DEEDIT-FIELD
  9085        PERFORM 8600-DEEDIT
  9086        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9087        MOVE '4'                    TO DC-OPTION-CODE
  9088        PERFORM 9700-DATE-LINK
  9089        IF DATE-CONVERSION-ERROR
  9090           MOVE ER-0348            TO EMI-ERROR
  9091           MOVE -1                  TO BEFFDTL
  9092           MOVE AL-UABON            TO BEFFDTA
  9093           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9094           GO TO 8200-SEND-DATAONLY
  9095        ELSE
  9096           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9097           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9098           MOVE XCTL-EL1273        TO PGM-NAME
  9099           GO TO 9300-XCTL.
  9100
  9101     IF EIBAID = DFHPF8
  9102        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9103        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9104        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9105        MOVE PI-SV-STATE            TO PI-STATE
  9106        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9107        MOVE CCERTNOI               TO PI-CERT-PRIME
  9108        MOVE CSUFIXI                TO PI-CERT-SFX
  9109        MOVE CEFFDTI                TO DEEDIT-FIELD
  9110        PERFORM 8600-DEEDIT
  9111        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9112        MOVE '4'                    TO DC-OPTION-CODE
  9113        PERFORM 9700-DATE-LINK
  9114        IF DATE-CONVERSION-ERROR
  9115           MOVE ER-0348             TO EMI-ERROR
  9116           MOVE -1                  TO BEFFDTL
  9117           MOVE AL-UABON            TO BEFFDTA
  9118           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9119           GO TO 8200-SEND-DATAONLY
  9120        ELSE
  9121           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9122           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9123           IF PI-COMPANY-ID = 'DMD'
  9124               MOVE XCTL-EL401DMD      TO PGM-NAME
  9125             ELSE
  9126               MOVE XCTL-EL1279        TO PGM-NAME
  9127           END-IF
  9128           GO TO 9300-XCTL.
  9129
  9130     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9131        MOVE XCTL-EL6312     TO PGM-NAME
  9132
  9133* EXEC CICS XCTL
  9134*           PROGRAM  (PGM-NAME)
  9135*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9136*           LENGTH   (WS-COMM-LENGTH)
  9137*       END-EXEC
  9138*    MOVE '.$C                   %   #00009078' TO DFHEIV0
  9139     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9140     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 168
* EL6311.cbl
  9141     MOVE X'2020233030303039303738' TO DFHEIV0(25:11)
  9142     CALL 'kxdfhei1' USING DFHEIV0,
  9143           PGM-NAME,
  9144           PROGRAM-INTERFACE-BLOCK,
  9145           WS-COMM-LENGTH,
  9146           DFHEIV99
  9147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9148     ELSE
  9149        MOVE '0'                 TO  PI-EDIT-SW.
  9150
  9151     IF EIBAID = DFHPF10
  9152         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9153         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9154         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9155         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9156                                    PI-1042-WA
  9157         MOVE 4                  TO PI-689-DATA-SOURCE
  9158         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9159         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9160         MOVE PI-SV-STATE        TO PI-689-STATE
  9161         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9162         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9163         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9164         MOVE PI-PB-ALT-CHG-SEQ-NO
  9165                                 TO PI-689-ALT-SEQ-NO
  9166         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9167         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9168         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9169         MOVE +0                 TO PI-689-CONTROL
  9170         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9171                                    PI-689-EXP-DATE
  9172                                    PI-689-RESP-PERSON
  9173                                    PI-689-TYPE
  9174                                    PI-689-FOLLOW-UP-EDIT
  9175                                    PI-689-RESEND1-EDIT
  9176                                    PI-689-SEQ-EDIT
  9177                                    PI-689-BCSEQ-EDIT
  9178                                    PI-689-LBL-OVERRIDE
  9179         MOVE W-LETTER-COMMUNICATION-AREAS
  9180                                 TO PI-PROGRAM-WORK-AREA
  9181         MOVE XCTL-EL689         TO PGM-NAME
  9182         GO TO 9300-XCTL.
  9183
  9184     IF  EIBAID = DFHPF16
  9185         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9186         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9187         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9188                                    PI-1042-WA
  9189         MOVE 4                  TO PI-689-DATA-SOURCE
  9190         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9191         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9192         MOVE PI-SV-STATE        TO PI-689-STATE
  9193         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9194         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9195         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9196         MOVE PI-PB-ALT-CHG-SEQ-NO
  9197                                 TO PI-689-ALT-SEQ-NO
  9198         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 169
* EL6311.cbl
  9199         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9200         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9201         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9202         MOVE W-LETTER-COMMUNICATION-AREAS
  9203                                 TO PI-PROGRAM-WORK-AREA
  9204         MOVE XCTL-EL690         TO PGM-NAME
  9205         GO TO 9300-XCTL.
  9206     IF (EIBAID = DFHPF13)
  9207        if (not fatal-errors)
  9208           and (not unforced-errors)
  9209           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9210           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9211           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9212           MOVE PI-SV-STATE      TO PI-STATE
  9213           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9214           MOVE CCERTNOI         TO PI-CERT-PRIME
  9215           MOVE CSUFIXI          TO PI-CERT-SFX
  9216           MOVE CEFFDTI          TO DEEDIT-FIELD
  9217           PERFORM 8600-DEEDIT
  9218           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9219           MOVE '4'              TO DC-OPTION-CODE
  9220           PERFORM 9700-DATE-LINK
  9221           IF DATE-CONVERSION-ERROR
  9222              MOVE ER-0348       TO EMI-ERROR
  9223              MOVE -1            TO CEFFDTL
  9224              MOVE AL-UABON      TO CEFFDTA
  9225              PERFORM 9900-ERROR-FORMAT
  9226                                 THRU 9900-EXIT
  9227              GO TO 8200-SEND-DATAONLY
  9228           ELSE
  9229              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9230              MOVE AL-UANON      TO CEFFDTA
  9231              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9232              PERFORM 6000-CREATE-TEMP-STORAGE
  9233                                 THRU 6000-EXIT
  9234              MOVE XCTL-EL677    TO PGM-NAME
  9235              GO TO 9300-XCTL
  9236           end-if
  9237        else
  9238           MOVE ER-3444          TO EMI-ERROR
  9239           MOVE -1               TO CPFENTRL
  9240           MOVE AL-UNBON         TO CPFENTRA
  9241           PERFORM 9900-ERROR-FORMAT
  9242                                 THRU 9900-EXIT
  9243           GO TO 8200-SEND-DATAONLY
  9244        end-if
  9245     end-if
  9246
  9247     IF EIBAID = DFHPF14
  9248        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9249        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9250        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9251        MOVE PI-SV-STATE            TO PI-CR-STATE
  9252        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9253        MOVE SPACE                  TO PI-EDIT-SW
  9254        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9255        MOVE XCTL-EL650             TO PGM-NAME
  9256        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 170
* EL6311.cbl
  9257
  9258     IF EIBAID = DFHENTER OR DFHPF11
  9259        GO TO 2000-CANCEL-MAINLINE.
  9260
  9261     MOVE ER-0029                TO EMI-ERROR.
  9262     MOVE -1                     TO CPFENTRL.
  9263     MOVE AL-UNBON               TO CPFENTRA.
  9264     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9265     GO TO 8200-SEND-DATAONLY.
  9266
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 171
* EL6311.cbl
  9268
  9269******************************************************************
  9270*                                                                *
  9271*      BATCH SCREEN PF KEY CHECKING                              *
  9272*                                                                *
  9273******************************************************************
  9274
  9275******************************************************************
  9276*                                                                *
  9277*      PF KEY FUNCTIONS:                                         *
  9278*                                                                *
  9279*      PF1 = BROWSE FORWARD                                      *
  9280*      PF2 = BROWSE BACKWARD                                     *
  9281*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9282*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9283*                                                                *
  9284*                                                                *
  9285******************************************************************
  9286
  9287 0500-CHECK-BATCH-PF-KEYS.
  9288     IF EIBAID = DFHPF1
  9289        MOVE '0'                TO PI-EDIT-SW
  9290        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9291           GO TO 5000-BROWSE-BATCH-HEADERS
  9292        ELSE
  9293           IF PI-GOOD-BROWSE
  9294              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9295                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9296              ELSE
  9297                 IF PI-FILE-BROWSE
  9298                    GO TO 4300-BROWSE-FILE-FORWARD
  9299                 ELSE
  9300                    IF PI-CSR-BROWSE
  9301                       GO TO 4200-BROWSE-CSR-FORWARD
  9302                    ELSE
  9303                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9304           ELSE
  9305              GO TO 0800-BROWSE-ERROR.
  9306
  9307     IF EIBAID = DFHPF2
  9308        MOVE '0'                TO PI-EDIT-SW
  9309        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9310           GO TO 5500-BROWSE-BATCH-BACKWARD
  9311        ELSE
  9312           IF PI-GOOD-BROWSE
  9313              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9314                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9315              ELSE
  9316                 IF PI-FILE-BROWSE
  9317                    GO TO 4800-BROWSE-FILE-BACKWARD
  9318                 ELSE
  9319                    IF PI-CSR-BROWSE
  9320                       GO TO 4900-BROWSE-CSR-BACKWARD
  9321                    ELSE
  9322                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9323           ELSE
  9324              GO TO 0800-BROWSE-ERROR.
  9325
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 172
* EL6311.cbl
  9326     IF EIBAID = DFHPF3
  9327        GO TO 3000-BATCH-MAINLINE.
  9328
  9329     IF  EIBAID = DFHPF4
  9330        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9331        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9332        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9333        MOVE PI-SV-STATE            TO PI-CR-STATE
  9334        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9335                                       PI-CR-FIN-RESP
  9336        MOVE 'A'                    TO PI-CR-TYPE
  9337        MOVE SPACE                  TO PI-EDIT-SW
  9338        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9339        MOVE XCTL-EL640             TO PGM-NAME
  9340        GO TO 9300-XCTL.
  9341
  9342     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9343       AND
  9344        (EIBAID = DFHENTER)
  9345           GO TO 3500-EDIT-BATCH-DATA.
  9346
  9347     IF EIBAID = DFHENTER
  9348        GO TO 3500-EDIT-BATCH-DATA.
  9349
  9350     MOVE ER-0029             TO EMI-ERROR.
  9351     MOVE -1                  TO DPFENTRL.
  9352     MOVE AL-UNBON            TO DPFENTRA.
  9353     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9354     GO TO 8200-SEND-DATAONLY.
  9355
  9356 0800-BROWSE-ERROR.
  9357     MOVE ER-2258                TO EMI-ERROR.
  9358     MOVE -1                     TO DPFENTRL.
  9359     MOVE AL-UNBON               TO DPFENTRA.
  9360     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9361     GO TO 8200-SEND-DATAONLY.
  9362
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 173
* EL6311.cbl
  9364
  9365******************************************************************
  9366*                                                                *
  9367*                I S S U E   M A I N L I N E                     *
  9368*                                                                *
  9369******************************************************************
  9370
  9371 1000-ISSUE-MAINLINE.
  9372     IF PI-DISPLAY-ORIGINAL-BATCH
  9373        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9374           MOVE ER-0023             TO EMI-ERROR
  9375           MOVE -1                  TO BMAINTL
  9376           MOVE AL-UABON            TO BMAINTA
  9377           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9378           GO TO 8200-SEND-DATAONLY
  9379        ELSE
  9380           NEXT SENTENCE
  9381     ELSE
  9382        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9383           MOVE ER-0023             TO EMI-ERROR
  9384           MOVE -1                  TO BMAINTL
  9385           MOVE AL-UABON            TO BMAINTA
  9386           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9387           GO TO 8200-SEND-DATAONLY.
  9388
  9389     IF BMAINTI = 'S'
  9390        GO TO 1100-SHOW-REQUEST.
  9391
  9392     IF NOT MODIFY-CAP
  9393         MOVE 'UPDATE'       TO SM-READ
  9394         PERFORM 9995-SECURITY-VIOLATION
  9395         MOVE ER-0070        TO EMI-ERROR
  9396         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9397         GO TO 8100-SEND-INITIAL-MAP.
  9398
  9399     IF BMAINTL GREATER THAN ZEROS
  9400        IF PI-PF5-FUNCTION
  9401           IF BMAINTI NOT = 'A'
  9402              MOVE AL-UABON  TO BMAINTA
  9403              MOVE -1        TO BMAINTL
  9404              MOVE ER-2260   TO EMI-ERROR
  9405              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9406              GO TO 8200-SEND-DATAONLY.
  9407
  9408     IF BCERTNOL = ZEROS
  9409       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9410         NEXT SENTENCE
  9411     ELSE
  9412         IF BCERTNOL NOT = ZEROS
  9413             MOVE AL-UANON       TO BCERTNOA
  9414         ELSE
  9415             MOVE -1             TO BCERTNOL
  9416             MOVE  1             TO SET-CURSOR-SW
  9417             MOVE ER-2218        TO EMI-ERROR
  9418             MOVE AL-UABON       TO BCERTNOA
  9419             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9420
  9421     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 174
* EL6311.cbl
  9422         MOVE AL-UANON       TO BSUFIXA
  9423     ELSE
  9424         MOVE AL-SANOF       TO BSUFIXA.
  9425
  9426     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9427        NEXT SENTENCE
  9428     ELSE
  9429        IF BEFFDTL NOT = ZEROS
  9430           MOVE AL-UNNON             TO BEFFDTA
  9431           MOVE BEFFDTI              TO DEEDIT-FIELD
  9432           PERFORM 8600-DEEDIT
  9433           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9434           MOVE 4                    TO DC-OPTION-CODE
  9435           PERFORM 9700-DATE-LINK
  9436           IF NO-CONVERSION-ERROR
  9437              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9438              ELSE
  9439              MOVE -1                TO BEFFDTL
  9440              MOVE  1                TO SET-CURSOR-SW
  9441              MOVE ER-2226           TO EMI-ERROR
  9442              MOVE AL-UNBON          TO BEFFDTA
  9443              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9444           ELSE
  9445              MOVE -1                TO BEFFDTL
  9446              MOVE  1                TO SET-CURSOR-SW
  9447              MOVE ER-2220           TO EMI-ERROR
  9448              MOVE AL-UNBON          TO BEFFDTA
  9449              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9450
  9451     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9452
  9453     IF BCERTNOL NOT = ZEROS
  9454        MOVE BCERTNOI                TO WS-NEW-PRIME
  9455     ELSE
  9456        MOVE SPACES                  TO WS-NEW-PRIME.
  9457
  9458     IF BSUFIXL NOT = ZEROS
  9459        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9460     ELSE
  9461        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9462
  9463     IF BEFFDTL NOT = ZEROS
  9464        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9465     ELSE
  9466        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9467
  9468     IF BMAINTI = 'A' OR 'K' OR 'S'
  9469        NEXT SENTENCE
  9470     ELSE
  9471        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9472        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9473           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9474           WS-PB-RECORD-TYPE NOT = '1'
  9475           IF BMAINTI = 'C'
  9476               MOVE ER-2287          TO EMI-ERROR
  9477               MOVE -1               TO BCERTNOL
  9478               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9479               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 175
* EL6311.cbl
  9480               GO TO 8200-SEND-DATAONLY
  9481             ELSE
  9482               MOVE ER-2260          TO EMI-ERROR
  9483               MOVE -1               TO BCERTNOL
  9484               MOVE AL-UABON         TO BCERTNOA
  9485               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9486               GO TO 8200-SEND-DATAONLY.
  9487
  9488     IF BMAINTI = 'D'
  9489         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9490
  9491*    IF BMICRNOL  NOT =  ZEROS
  9492*        IF BMICRNOI  NUMERIC
  9493*            MOVE AL-UNNON       TO  BMICRNOA
  9494*        ELSE
  9495*            MOVE -1             TO  BMICRNOL
  9496*            MOVE 1              TO  SET-CURSOR-SW
  9497*            MOVE AL-UNBON       TO  BMICRNOA
  9498*            MOVE ER-2701        TO  EMI-ERROR
  9499*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9500     IF BVINL NOT = ZEROS
  9501        MOVE AL-UANON            TO BVINA
  9502     END-IF
  9503     IF B1STNML NOT = ZEROS
  9504         MOVE AL-UANON                TO B1STNMA.
  9505
  9506     IF BINITL  NOT = ZEROS
  9507        MOVE AL-UANON                TO BINITA.
  9508
  9509     IF BSEXL NOT = ZEROS
  9510        IF BSEXI = 'M' OR 'F'
  9511           MOVE AL-UANON             TO BSEXA
  9512        ELSE
  9513           MOVE -1               TO BSEXL
  9514           MOVE ER-2629          TO EMI-ERROR
  9515           MOVE AL-UABON         TO BSEXA
  9516           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9517
  9518     IF BAGEL NOT = ZEROS
  9519         IF BAGEI NUMERIC
  9520             MOVE BAGEI              TO WS-BAGE
  9521             MOVE AL-UNNON           TO BAGEA
  9522         ELSE
  9523             MOVE -1                 TO BAGEL
  9524             MOVE  1                 TO SET-CURSOR-SW
  9525             MOVE ER-2223            TO EMI-ERROR
  9526             MOVE AL-UNBON           TO BAGEA
  9527             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9528
  9529     IF BLSTNML NOT = ZERO  OR
  9530        B1STNML NOT = ZERO  OR
  9531        BINITL NOT = ZERO
  9532         IF BAGEL = ZEROS
  9533             MOVE -1                 TO BAGEL
  9534             MOVE  1                 TO SET-CURSOR-SW
  9535             MOVE ER-3269            TO EMI-ERROR
  9536             MOVE AL-UNBON           TO BAGEA
  9537             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 176
* EL6311.cbl
  9538         END-IF
  9539     END-IF.
  9540
  9541     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9542
  9543     IF (BBIRTHL GREATER THAN +0) AND
  9544        (BBIRTHI NOT EQUAL SPACES)
  9545        NEXT SENTENCE
  9546     ELSE
  9547        GO TO 1010-CHECK-AGE.
  9548
  9549     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9550     PERFORM 8600-DEEDIT.
  9551     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9552     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9553     MOVE AL-UNNON               TO BBIRTHA.
  9554     MOVE '4'                    TO DC-OPTION-CODE.
  9555     PERFORM 9700-DATE-LINK.
  9556     IF DATE-CONVERSION-ERROR
  9557        MOVE -1                  TO BBIRTHL
  9558        MOVE  1                  TO SET-CURSOR-SW
  9559        MOVE ER-2228             TO EMI-ERROR
  9560        MOVE AL-UNBON            TO BBIRTHA
  9561        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9562        GO TO 1010-CHECK-AGE.
  9563
  9564     IF (NO-CONVERSION-ERROR) AND
  9565        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9566        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9567        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9568        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9569                                    WS-CONVERTED-BIRTH
  9570        MOVE AL-UANON            TO BBIRTHA
  9571     ELSE
  9572        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9573        MOVE AL-UANON            TO BBIRTHA.
  9574
  9575 1010-CHECK-AGE.
  9576
  9577*    IF BAGEL = ZERO
  9578*       IF BBIRTHL GREATER THAN ZERO
  9579*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9580
  9581     IF B1STPMTL NOT = ZEROS
  9582        IF B1STPMTI = SPACES
  9583           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9584        ELSE
  9585           MOVE B1STPMTI             TO DEEDIT-FIELD
  9586           PERFORM 8600-DEEDIT
  9587           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9588           MOVE AL-UNNON             TO B1STPMTA
  9589           MOVE 4                    TO DC-OPTION-CODE
  9590           PERFORM 9700-DATE-LINK
  9591           IF NO-CONVERSION-ERROR
  9592              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9593              MOVE AL-UANON          TO B1STPMTA
  9594           ELSE
  9595              MOVE -1                TO B1STPMTL
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 177
* EL6311.cbl
  9596              MOVE  1                TO SET-CURSOR-SW
  9597              MOVE ER-2200           TO EMI-ERROR
  9598              MOVE AL-UNBON          TO B1STPMTA
  9599              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9600
  9601     IF BDAYSL NOT = ZEROS
  9602         IF BDAYSI NUMERIC
  9603             MOVE AL-UNNON           TO BDAYSA
  9604         ELSE
  9605             MOVE -1                 TO BDAYSL
  9606             MOVE ER-2530            TO EMI-ERROR
  9607             MOVE AL-UNBON           TO BDAYSA
  9608             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9609
  9610     IF BLNTRML NOT = ZEROS
  9611         IF BLNTRMI NUMERIC
  9612             MOVE AL-UNNON       TO BLNTRMA
  9613         ELSE
  9614             MOVE -1             TO BLNTRML
  9615             MOVE ER-2533        TO EMI-ERROR
  9616             MOVE AL-UNBON       TO BLNTRMA
  9617             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9618
  9619**   IF PI-COMPANY-ID = 'DMD'
  9620     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9621        NEXT SENTENCE
  9622     ELSE
  9623         IF BLNOFCRL NOT = ZEROS
  9624            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9625            IF LOAN-OFFICER-FOUND
  9626                MOVE AL-UANON        TO BLNOFCRA
  9627             ELSE
  9628                 MOVE SPACE          TO WS-LOAN-OFFICER
  9629                 MOVE -1             TO BLNOFCRL
  9630                 MOVE  1             TO SET-CURSOR-SW
  9631                 MOVE ER-3006        TO EMI-ERROR
  9632                 MOVE AL-UNBON       TO BLNOFCRA
  9633                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9634
  9635     IF BFREQL NOT = ZEROS
  9636         IF BFREQI NUMERIC
  9637             MOVE AL-UNNON       TO BFREQA
  9638         ELSE
  9639             MOVE -1             TO BFREQL
  9640             MOVE  1             TO SET-CURSOR-SW
  9641             MOVE ER-2223        TO EMI-ERROR
  9642             MOVE AL-UNBON       TO BFREQA
  9643             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9644
  9645     IF BMODEL NOT = ZEROS
  9646         MOVE BMODEI             TO WS-MODE-CODE
  9647                                    PI-BMODE
  9648         IF WS-MODE-CODE-VALID
  9649             MOVE AL-UANON       TO BMODEA
  9650         ELSE
  9651             MOVE -1             TO BMODEL
  9652             MOVE ER-2591        TO EMI-ERROR
  9653             MOVE AL-UABON       TO BMODEA
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 178
* EL6311.cbl
  9654             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9655
  9656     IF BPMTSL NOT = ZEROS
  9657         IF BPMTSI NUMERIC
  9658             MOVE AL-UNNON           TO BPMTSA
  9659             MOVE BPMTSI             TO PI-BPMTS
  9660         ELSE
  9661             MOVE -1                 TO BPMTSL
  9662             MOVE ER-2592            TO EMI-ERROR
  9663             MOVE AL-UNBON           TO BPMTSA
  9664             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9665
  9666     IF BPMTAMTL NOT = ZEROS
  9667
  9668* EXEC CICS BIF DEEDIT
  9669*            FIELD  (BPMTAMTI)
  9670*            LENGTH (9)
  9671*       END-EXEC
  9672     MOVE 9
  9673       TO DFHEIV11
  9674*    MOVE '@"L                   #   #00009602' TO DFHEIV0
  9675     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9676     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9677     MOVE X'2020233030303039363032' TO DFHEIV0(25:11)
  9678     CALL 'kxdfhei1' USING DFHEIV0,
  9679           BPMTAMTI,
  9680           DFHEIV11
  9681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9682        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9683*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9684*        PERFORM 8600-DEEDIT
  9685*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9686
  9687*    IF BAPRL NOT = ZEROS
  9688*        EXEC CICS BIF DEEDIT
  9689*            FIELD  (BAPRI)
  9690*            LENGTH (7)
  9691*        END-EXEC
  9692*        MOVE BAPRI              TO WS-BAPR.
  9693
  9694     IF BAPRL > 0
  9695        MOVE +0                  TO  WS-BAPR
  9696        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9697           (WS-SUB > 7)
  9698           OR (BAPRI (WS-SUB:1) NUMERIC)
  9699           OR (BAPRI (WS-SUB:1) = '.')
  9700        END-PERFORM
  9701        IF WS-SUB > 7
  9702           MOVE ER-2471       TO EMI-ERROR
  9703           MOVE -1            TO BAPRL
  9704           MOVE AL-UNBON      TO BAPRA
  9705           PERFORM 9900-ERROR-FORMAT
  9706                                 THRU 9900-EXIT
  9707        ELSE
  9708           IF BAPRI (WS-SUB:1) NUMERIC
  9709              MOVE WS-SUB           TO WS-BEG
  9710              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9711                 (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 179
* EL6311.cbl
  9712                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9713              END-PERFORM
  9714              COMPUTE WS-END = WS-SUB - WS-BEG
  9715              MOVE BAPRI (WS-BEG:WS-END)
  9716                                 TO WS-APR-WHOLE-NUM
  9717           END-IF
  9718           IF BAPRI (WS-SUB:1) = '.'
  9719              COMPUTE WS-BEG = WS-SUB + 1
  9720              IF (WS-BEG < 8)
  9721                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9722                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9723                    (WS-SUB > 7)
  9724                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9725                 END-PERFORM
  9726                 COMPUTE WS-END = WS-SUB - WS-BEG
  9727                 MOVE BAPRI (WS-BEG:WS-END)
  9728                                 TO WS-APR-DEC (1:WS-END)
  9729              END-IF
  9730           END-IF
  9731           MOVE AL-UNNON      TO BAPRA
  9732           MOVE WS-BAPR       TO BAPRO
  9733        END-IF
  9734     END-IF
  9735*     IF BAPRL NOT = ZEROS
  9736*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9737*        PERFORM 8600-DEEDIT
  9738*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9739
  9740     IF BLIVESL NOT = ZEROS
  9741        MOVE BLIVESI             TO DEEDIT-FIELD
  9742        PERFORM 8600-DEEDIT
  9743        IF DEEDIT-FIELD-V0 NUMERIC
  9744           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9745           MOVE AL-UNNON         TO BLIVESA
  9746        ELSE
  9747           MOVE -1               TO BLIVESL
  9748           MOVE AL-UNBON         TO BLIVESA
  9749           MOVE ER-2223          TO EMI-ERROR
  9750           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9751
  9752*DMD CUSTOM CODING*************START
  9753*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9754     IF PI-COMPANY-ID NOT = 'DMD'
  9755         MOVE ZEROS               TO BBILLEDL
  9756         GO TO 1010-EDIT-CONT.
  9757
  9758     IF BBILLEDL NOT = ZEROS
  9759        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9760        MOVE 'Y'                 TO WS-NUMERIC-SW
  9761        MOVE +1                  TO WS-CSO-SUB
  9762        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9763        IF CSO-NUMERIC-FIELD
  9764
  9765* EXEC CICS BIF DEEDIT
  9766*              FIELD  (BBILLEDI)
  9767*              LENGTH (9)
  9768*          END-EXEC
  9769     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 180
* EL6311.cbl
  9770       TO DFHEIV11
  9771*    MOVE '@"L                   #   #00009688' TO DFHEIV0
  9772     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9773     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9774     MOVE X'2020233030303039363838' TO DFHEIV0(25:11)
  9775     CALL 'kxdfhei1' USING DFHEIV0,
  9776           BBILLEDI,
  9777           DFHEIV11
  9778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9779           MOVE BBILLEDI         TO WS-BILLED
  9780           MOVE AL-UNNON         TO BBILLEDA
  9781        ELSE
  9782           MOVE -1               TO BBILLEDL
  9783           MOVE AL-UNBON         TO BBILLEDA
  9784           MOVE ER-2547          TO EMI-ERROR
  9785           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9786     ELSE
  9787        IF BMAINTI EQUAL 'A'
  9788           MOVE -1               TO BBILLEDL
  9789           MOVE AL-UNBON         TO BBILLEDA
  9790           MOVE ER-8148          TO EMI-ERROR
  9791           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9792
  9793 1010-EDIT-CONT.
  9794
  9795     IF BFORCEL  NOT = ZEROS
  9796         IF FORCE-CAP
  9797            MOVE AL-UANON            TO BFORCEA
  9798         ELSE
  9799            MOVE ER-2945             TO EMI-ERROR
  9800            MOVE AL-UABON            TO BFORCEA
  9801            MOVE -1                  TO BFORCEL
  9802            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9803
  9804     IF BENTRYL NOT = ZEROS
  9805        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9806                 'C' and 'D' AND 'V' AND 'U' AND 'M'
  9807           MOVE ER-2224              TO EMI-ERROR
  9808           MOVE AL-UABON             TO BENTRYA
  9809           MOVE -1                   TO BENTRYL
  9810           MOVE  1                   TO SET-CURSOR-SW
  9811           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9812        ELSE
  9813           MOVE AL-UANON             TO BENTRYA.
  9814
  9815     IF BUNWRITL NOT = ZEROS
  9816        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9817           MOVE ER-7574              TO EMI-ERROR
  9818           MOVE AL-UABON             TO BUNWRITA
  9819           MOVE -1                   TO BUNWRITL
  9820           MOVE  1                   TO SET-CURSOR-SW
  9821           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9822        ELSE
  9823           MOVE AL-UANON             TO BUNWRITA.
  9824
  9825     IF BREINL  NOT = ZEROS
  9826         MOVE AL-UANON               TO BREINA.
  9827
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 181
* EL6311.cbl
  9828     IF BBILCDL NOT = ZEROS
  9829        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9830                             AND 'A' AND 'B' AND 'E'
  9831           MOVE ER-2225              TO EMI-ERROR
  9832           MOVE AL-UABON             TO BBILCDA
  9833           MOVE -1                   TO BBILCDL
  9834           MOVE  1                   TO SET-CURSOR-SW
  9835           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9836        ELSE
  9837           MOVE AL-UANON             TO BBILCDA.
  9838
  9839     IF BSKPCDL NOT = ZEROS
  9840         MOVE AL-UANON               TO BSKPCDA.
  9841
  9842     IF BINDGRPL NOT = ZEROS
  9843         MOVE AL-UANON               TO BINDGRPA.
  9844
  9845     IF BSIGL   NOT = ZEROS
  9846         MOVE AL-UANON               TO BSIGA.
  9847
  9848     IF BRTCLSL NOT = ZEROS
  9849         MOVE AL-UANON               TO BRTCLSA.
  9850
  9851     IF BMEMBERL NOT = ZEROS
  9852         MOVE AL-UANON               TO BMEMBERA.
  9853
  9854     MOVE +0                         TO WS-SUB1.
  9855
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 182
* EL6311.cbl
  9857
  9858******************************************************************
  9859*                                                                *
  9860*           E D I T   I S S U E   C O V E R A G E S              *
  9861*                                                                *
  9862******************************************************************
  9863
  9864 1020-EDIT-COVERAGES.
  9865     ADD +1                      TO WS-SUB1.
  9866
  9867     IF WS-SUB1 GREATER +2
  9868        GO TO 1025-EDIT-CONTINUE
  9869     END-IF
  9870
  9871     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9872       IF (BMODEL   GREATER ZERO  OR
  9873            BPMTSL   GREATER ZERO  OR
  9874            BPMTAMTL GREATER ZERO)
  9875          AND
  9876            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9877               GO TO 1021-CONT-EDIT.
  9878
  9879     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9880        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9881        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9882        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9883        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9884        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9885        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9886        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9887        NEXT SENTENCE
  9888         ELSE
  9889            GO TO 1020-EDIT-COVERAGES.
  9890
  9891 1021-CONT-EDIT.
  9892
  9893     IF BMAINTI = 'A'
  9894        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9895           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9896        ELSE
  9897           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9898           MOVE ER-7404          TO EMI-ERROR
  9899           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9900           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9901     ELSE
  9902        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9903           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9904
  9905     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9906        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9907        PERFORM 8600-DEEDIT
  9908        IF DEEDIT-FIELD-V0 NUMERIC
  9909           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9910        ELSE
  9911           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9912
  9913     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9914*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 183
* EL6311.cbl
  9915        IF BMODEL  GREATER THAN ZEROS  AND
  9916           BPMTSL  GREATER THAN ZEROS
  9917           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9918
  9919     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9920         IF BMODEL   GREATER THAN ZEROS  OR
  9921            BPMTSL   GREATER THAN ZEROS  OR
  9922            BPMTAMTL GREATER THAN ZEROS
  9923             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9924
  9925     IF BMAINTI = ('C' OR 'K')
  9926        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9927           NEXT SENTENCE
  9928        ELSE
  9929           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9930           PERFORM 8600-DEEDIT
  9931           IF DEEDIT-FIELD-V0 NUMERIC
  9932              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9933              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9934                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9935              ELSE
  9936                    MOVE ER-2241      TO EMI-ERROR
  9937                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9938                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9939                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9940           ELSE
  9941              MOVE ER-2223          TO EMI-ERROR
  9942              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9943              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9944              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9945     ELSE
  9946        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9947            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9948            PERFORM 8600-DEEDIT
  9949            IF DEEDIT-FIELD-V0      NUMERIC
  9950               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9951                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9952                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9953               ELSE
  9954                  MOVE ER-2241         TO EMI-ERROR
  9955                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9956                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9957                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9958            ELSE
  9959              MOVE ER-2223             TO EMI-ERROR
  9960              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9961              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9962              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9963        ELSE
  9964            MOVE ER-2240               TO EMI-ERROR
  9965            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9966            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9967*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9968*        IF BMODEL  GREATER THAN ZEROS  AND
  9969*           BPMTSL  GREATER THAN ZEROS
  9970*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9971
  9972     IF BBEN-LEN (WS-SUB1) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 184
* EL6311.cbl
  9973        AND BMAINTI = ('C' OR 'K')
  9974           NEXT SENTENCE
  9975     ELSE
  9976        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9977           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9978
  9979* EXEC CICS BIF DEEDIT
  9980*              FIELD  (BBENI (WS-SUB1))
  9981*              LENGTH (12)
  9982*          END-EXEC
  9983     MOVE 12
  9984       TO DFHEIV11
  9985*    MOVE '@"L                   #   #00009891' TO DFHEIV0
  9986     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9987     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9988     MOVE X'2020233030303039383931' TO DFHEIV0(25:11)
  9989     CALL 'kxdfhei1' USING DFHEIV0,
  9990           BBENI(WS-SUB1),
  9991           DFHEIV11
  9992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9993           IF BBENI (WS-SUB1)  NUMERIC
  9994              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9995                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9996*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9997*          PERFORM 8600-DEEDIT
  9998*          IF DEEDIT-FIELD-V2  NUMERIC
  9999*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10000*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
 10001              ELSE
 10002                 MOVE ER-7632    TO EMI-ERROR
 10003                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10004                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10005                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10006           ELSE
 10007              MOVE ER-2223         TO EMI-ERROR
 10008              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10009              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10010              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10011        ELSE
 10012           MOVE ER-7632    TO EMI-ERROR
 10013           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10014           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10015           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10016
 10017     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10018        AND (BMAINTI = ('C' OR 'K'))
 10019        CONTINUE
 10020     ELSE
 10021        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10022           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10023           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10024              FOR ALL '.'
 10025           IF WS-TALLY > 1
 10026              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10027                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10028              END-PERFORM
 10029              IF A1 < 9
 10030                 ADD 3 TO A1
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 185
* EL6311.cbl
 10031                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10032              END-IF
 10033           ELSE
 10034              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10035                (A1 > 11)
 10036                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10037                  LOW-VALUES OR SPACES)
 10038              END-PERFORM
 10039              IF A1 > 1 AND < 12
 10040                 MOVE SPACES
 10041                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10042              END-IF
 10043           END-IF
 10044
 10045* EXEC CICS BIF DEEDIT
 10046*              FIELD  (BPREMI (WS-SUB1))
 10047*              LENGTH (11)
 10048*          END-EXEC
 10049     MOVE 11
 10050       TO DFHEIV11
 10051*    MOVE '@"L                   #   #00009946' TO DFHEIV0
 10052     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10053     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10054     MOVE X'2020233030303039393436' TO DFHEIV0(25:11)
 10055     CALL 'kxdfhei1' USING DFHEIV0,
 10056           BPREMI(WS-SUB1),
 10057           DFHEIV11
 10058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10059           IF BPREMI (WS-SUB1) NUMERIC
 10060              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10061                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10062*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10063*          PERFORM 8600-DEEDIT
 10064*          IF DEEDIT-FIELD-V2  NUMERIC
 10065*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10066*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10067              ELSE
 10068                 IF PI-COMPANY-ID NOT = 'DCC' and 'CAP'
 10069                    MOVE ER-7633    TO EMI-ERROR
 10070                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10071                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10072                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10073                 END-IF
 10074              END-IF
 10075           ELSE
 10076              MOVE ER-2223         TO EMI-ERROR
 10077              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10078              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10079              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10080           END-IF
 10081        ELSE
 10082           IF PI-COMPANY-ID NOT = 'DCC' and 'CAP'
 10083              MOVE ER-7633         TO EMI-ERROR
 10084              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10085              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10086              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10087           END-IF
 10088        END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 186
* EL6311.cbl
 10089     END-IF
 10090
 10091     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10092        NEXT SENTENCE
 10093     ELSE
 10094        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10095
 10096* EXEC CICS BIF DEEDIT
 10097*           FIELD  (BCPREMI (WS-SUB1))
 10098*           LENGTH (11)
 10099*       END-EXEC
 10100     MOVE 11
 10101       TO DFHEIV11
 10102*    MOVE '@"L                   #   #00009986' TO DFHEIV0
 10103     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10104     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10105     MOVE X'2020233030303039393836' TO DFHEIV0(25:11)
 10106     CALL 'kxdfhei1' USING DFHEIV0,
 10107           BCPREMI(WS-SUB1),
 10108           DFHEIV11
 10109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10110        IF BCPREMI (WS-SUB1) NUMERIC
 10111           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10112*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10113*       PERFORM 8600-DEEDIT
 10114*       IF DEEDIT-FIELD-V2  NUMERIC
 10115*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10116        ELSE
 10117           MOVE ER-2223         TO EMI-ERROR
 10118           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10119           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10120           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10121
 10122     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10123        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10124        PERFORM 8600-DEEDIT
 10125        IF DEEDIT-FIELD-V0 NUMERIC
 10126           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10127           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10128         ELSE
 10129           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10130           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10131           MOVE ER-2223              TO EMI-ERROR
 10132           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10133
 10134     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10135        IF BEXPIRE   (WS-SUB1) = SPACES
 10136           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10137        ELSE
 10138           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10139           PERFORM 8600-DEEDIT
 10140           IF DEEDIT-FIELD-V0        NUMERIC
 10141              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10142              MOVE 4                TO DC-OPTION-CODE
 10143              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10144              PERFORM 9700-DATE-LINK
 10145              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10146                                                        (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 187
* EL6311.cbl
 10147              IF NO-CONVERSION-ERROR
 10148                 NEXT SENTENCE
 10149              ELSE
 10150                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10151                 MOVE ER-2531    TO EMI-ERROR
 10152                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10153                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10154           ELSE
 10155             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10156             MOVE ER-2532        TO EMI-ERROR
 10157             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10158             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10159
 10160     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10161        NEXT SENTENCE
 10162     ELSE
 10163
 10164* EXEC CICS BIF DEEDIT
 10165*           FIELD  (BALT-BENI (WS-SUB1))
 10166*           LENGTH (12)
 10167*       END-EXEC
 10168     MOVE 12
 10169       TO DFHEIV11
 10170*    MOVE '@"L                   #   #00010043' TO DFHEIV0
 10171     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10172     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10173     MOVE X'2020233030303130303433' TO DFHEIV0(25:11)
 10174     CALL 'kxdfhei1' USING DFHEIV0,
 10175           BALT-BENI(WS-SUB1),
 10176           DFHEIV11
 10177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10178        IF BALT-BENI (WS-SUB1) NUMERIC
 10179           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10180*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10181*       PERFORM 8600-DEEDIT
 10182*       IF DEEDIT-FIELD-V0 NUMERIC
 10183*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10184        ELSE
 10185           MOVE ER-2223         TO EMI-ERROR
 10186           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10187           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10188           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10189
 10190     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10191        NEXT SENTENCE
 10192     ELSE
 10193
 10194* EXEC CICS BIF DEEDIT
 10195*           FIELD  (BALT-PREMI (WS-SUB1))
 10196*           LENGTH (11)
 10197*       END-EXEC
 10198     MOVE 11
 10199       TO DFHEIV11
 10200*    MOVE '@"L                   #   #00010062' TO DFHEIV0
 10201     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10202     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10203     MOVE X'2020233030303130303632' TO DFHEIV0(25:11)
 10204     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 188
* EL6311.cbl
 10205           BALT-PREMI(WS-SUB1),
 10206           DFHEIV11
 10207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10208        IF BALT-PREMI (WS-SUB1) NUMERIC
 10209           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10210*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10211*       PERFORM 8600-DEEDIT
 10212*       IF DEEDIT-FIELD-V0 NUMERIC
 10213*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10214        ELSE
 10215           MOVE ER-2223         TO EMI-ERROR
 10216           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10217           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10218           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10219
 10220      GO TO 1020-EDIT-COVERAGES.
 10221     .
 10222 1025-edit-continue.
 10223     IF PI-COMPANY-ID  =  'DMD'
 10224        MOVE LOW-VALUES             TO BNCERTI
 10225                                       BNSTATI.
 10226
 10227     IF EMI-ERROR = ZEROS
 10228         NEXT SENTENCE
 10229     ELSE
 10230         GO TO 8200-SEND-DATAONLY.
 10231
 10232     IF BMAINTI = 'A'
 10233         GO TO 1200-ADD-ISSUE-ROUTINE.
 10234
 10235     IF BMAINTI = 'C'
 10236         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10237
 10238     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10239
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 189
* EL6311.cbl
 10241
 10242 1030-EDIT-FOR-NUMERICS.
 10243     IF WS-CSO-SUB EQUAL 10
 10244        GO TO 1030-EDIT-EXIT.
 10245
 10246     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10247        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10248        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10249           ADD +1               TO WS-CSO-SUB
 10250           GO TO 1030-EDIT-FOR-NUMERICS.
 10251
 10252     MOVE 'N'                   TO WS-NUMERIC-SW.
 10253
 10254 1030-EDIT-EXIT.
 10255******************************************************************
 10256*                                                                *
 10257*                 C A L C U L A T E   A G E                      *
 10258*                                                                *
 10259******************************************************************
 10260
 10261
 10262 1095-CALC-AGE.
 10263
 10264     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10265     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10266     MOVE 1                  TO DC-OPTION-CODE.
 10267     PERFORM 9700-DATE-LINK
 10268     IF NO-CONVERSION-ERROR
 10269         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10270         MOVE WS-BAGE            TO BAGEI
 10271         MOVE +2                 TO BAGEL
 10272         MOVE AL-UNNON TO BAGEA.
 10273
 10274 1099-EXIT.
 10275     EXIT.
 10276
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 190
* EL6311.cbl
 10278
 10279******************************************************************
 10280*                                                                *
 10281*                   S H O W   I S S U E                          *
 10282*                                                                *
 10283******************************************************************
 10284
 10285 1100-SHOW-REQUEST.
 10286     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10287
 10288     IF BCERTNOL = ZEROS AND
 10289        BEFFDTL  = ZEROS
 10290        MOVE -1                  TO BMAINTL
 10291        GO TO 8200-SEND-DATAONLY.
 10292
 10293     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10294
 10295     IF BSUFIXL NOT = ZEROS
 10296        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10297     ELSE
 10298        MOVE SPACE               TO WS-NEW-SUFFIX.
 10299
 10300     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10301     PERFORM 8600-DEEDIT.
 10302     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10303     MOVE '4'                    TO DC-OPTION-CODE.
 10304     PERFORM 9700-DATE-LINK.
 10305     IF DATE-CONVERSION-ERROR
 10306        MOVE ER-0348             TO EMI-ERROR
 10307        MOVE -1                  TO BEFFDTL
 10308        MOVE AL-UABON            TO BEFFDTA
 10309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10310        GO TO 8200-SEND-DATAONLY
 10311     ELSE
 10312        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10313        MOVE AL-UANON            TO BEFFDTA
 10314        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10315
 10316     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10317
 10318     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10319        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10320          MOVE 'Y'                    TO WS-SHOW-SW
 10321          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10322             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10323           ELSE
 10324             IF PI-FILE-BROWSE
 10325                GO TO 4300-BROWSE-FILE-FORWARD
 10326              ELSE
 10327                IF PI-CSR-BROWSE
 10328                   GO TO 4200-BROWSE-CSR-FORWARD
 10329                ELSE
 10330                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10331        ELSE
 10332           GO TO 3900-RE-DISPLAY-RECORD.
 10333
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 191
* EL6311.cbl
 10335
 10336******************************************************************
 10337*                                                                *
 10338*            A D D   I S S U E   R O U T I N E                   *
 10339*                                                                *
 10340******************************************************************
 10341
 10342***************************************************************
 10343*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10344*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10345*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10346*     4. LINK TO THE EDIT ROUTINE.                            *
 10347*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10348*     6. WRITE THE NEW ISSUE RECORD.                          *
 10349*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10350*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10351*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10352*        ELSE                                                 *
 10353*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10354***************************************************************
 10355
 10356 1200-ADD-ISSUE-ROUTINE.
 10357     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10358
 10359
 10360* EXEC CICS GETMAIN
 10361*        SET     (ADDRESS OF PENDING-BUSINESS)
 10362*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10363*    END-EXEC.
 10364*    MOVE '," L                  $   #00010217' TO DFHEIV0
 10365     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10366     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10367     MOVE X'2020233030303130323137' TO DFHEIV0(25:11)
 10368     CALL 'kxdfhei1' USING DFHEIV0,
 10369           DFHEIV20,
 10370           ERPNDB-RECORD-LENGTH,
 10371           DFHEIV99
 10372     SET ADDRESS OF PENDING-BUSINESS TO
 10373         DFHEIV20
 10374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10375
 10376
 10377
 10378* EXEC CICS HANDLE CONDITION
 10379*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10380*    END-EXEC.
 10381*    MOVE '"$I                   ! # #00010222' TO DFHEIV0
 10382     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10383     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10384     MOVE X'2320233030303130323232' TO DFHEIV0(25:11)
 10385     CALL 'kxdfhei1' USING DFHEIV0
 10386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10387
 10388
 10389     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10390     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10391     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10392
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 192
* EL6311.cbl
 10393
 10394* EXEC CICS READ
 10395*        INTO    (PENDING-BUSINESS)
 10396*        DATASET (FILE-ID-ERPNDB)
 10397*        RIDFLD  (ERPNDB-KEY)
 10398*    END-EXEC.
 10399     MOVE LENGTH OF
 10400      PENDING-BUSINESS
 10401       TO DFHEIV11
 10402*    MOVE '&"IL       E          (   #00010230' TO DFHEIV0
 10403     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10404     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10405     MOVE X'2020233030303130323330' TO DFHEIV0(25:11)
 10406     CALL 'kxdfhei1' USING DFHEIV0,
 10407           FILE-ID-ERPNDB,
 10408           PENDING-BUSINESS,
 10409           DFHEIV11,
 10410           ERPNDB-KEY,
 10411           DFHEIV99,
 10412           DFHEIV99,
 10413           DFHEIV99
 10414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10415
 10416
 10417     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10418
 10419     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10420     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10421     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10422     MOVE SPACES                 TO PENDING-BUSINESS.
 10423     MOVE 'PB'                   TO PB-RECORD-ID.
 10424     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10425     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10426     MOVE SPACES                 TO PB-CERT-SFX.
 10427     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10428     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10429                                    PB-ALT-CHG-SEQ-NO.
 10430
 10431     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10432     MOVE '1'                    TO PB-RECORD-TYPE.
 10433
 10434     IF BSUFIXL NOT = ZEROS
 10435        MOVE BSUFIXI             TO PB-CERT-SFX.
 10436
 10437     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10438
 10439     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10440     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10441
 10442     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10443                                    PB-I-LF-PREM-CALC
 10444                                    PB-I-LF-ALT-PREM-CALC
 10445                                    PB-I-LF-RATE
 10446                                    PB-I-LF-ALT-RATE
 10447                                    PB-I-LF-REI-RATE
 10448                                    PB-I-LF-ALT-REI-RATE
 10449                                    PB-I-RATE-DEV-PCT-LF
 10450                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 193
* EL6311.cbl
 10451                                    PB-I-AH-RATE
 10452                                    PB-I-AH-REI-RATE
 10453                                    PB-I-AH-RATE-TRM
 10454                                    PB-I-RATE-DEV-PCT-AH
 10455                                    PB-I-BUSINESS-TYPE
 10456                                    PB-I-LIFE-COMMISSION
 10457                                    PB-I-JOINT-COMMISSION
 10458                                    PB-I-JOINT-AGE
 10459                                    PB-I-AH-COMMISSION
 10460                                    PB-I-CURR-SEQ
 10461                                    PB-CHG-COUNT
 10462                                    PB-LF-BILLED-AMTS
 10463                                    PB-AH-BILLED-AMTS
 10464                                    PB-CALC-TOLERANCE
 10465                                    PB-I-EXTENTION-DAYS
 10466*                                   PB-I-MICROFILM-NO
 10467                                    PB-I-TERM-IN-DAYS.
 10468
 10469     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10470                                    PB-I-LF-EXPIRE-DT
 10471                                    PB-I-AH-EXPIRE-DT
 10472                                    PB-BILLED-DT
 10473                                    PB-ACCT-EFF-DT
 10474                                    PB-ACCT-EXP-DT
 10475                                    PB-I-1ST-PMT-DT.
 10476
 10477     MOVE 'X'                    TO PB-FATAL-FLAG.
 10478
 10479     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10480
 10481     IF BLSTNML GREATER THAN ZEROS
 10482         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10483
 10484*    IF BMICRNOL  GREATER  ZEROS
 10485*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10486*    ELSE
 10487*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10488     IF BVINL > ZEROS
 10489        MOVE BVINI               TO PB-I-VIN
 10490     END-IF
 10491     IF B1STNML GREATER THAN ZEROS
 10492         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10493
 10494     IF BINITL  GREATER THAN ZEROS
 10495         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10496
 10497     IF BBIRTHL GREATER THAN ZERO
 10498         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10499     ELSE
 10500         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10501
 10502     IF B1STPMTL GREATER THAN ZERO
 10503         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10504     ELSE
 10505         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10506
 10507     IF BAGEL    GREATER THAN ZEROS
 10508         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 194
* EL6311.cbl
 10509        ELSE
 10510         MOVE ZEROS              TO PB-I-AGE.
 10511
 10512     IF BSEXL    GREATER THAN ZEROS
 10513         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10514
 10515     IF BTERM-LEN (1) GREATER THAN ZEROS
 10516        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10517     ELSE
 10518        MOVE ZEROS               TO PB-I-LF-TERM.
 10519
 10520     IF BTERM-LEN (2) GREATER THAN ZEROS
 10521        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10522     ELSE
 10523        MOVE ZEROS               TO PB-I-AH-TERM.
 10524
 10525     IF BLNTRML       GREATER THAN ZEROS
 10526         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10527        ELSE
 10528         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10529
 10530     IF BFREQL        GREATER THAN ZEROS
 10531         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10532        ELSE
 10533         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10534
 10535     IF BSKPCDL       GREATER THAN ZEROS
 10536         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10537
 10538     IF BMODEL        GREATER THAN ZEROS
 10539         MOVE BMODEI             TO PB-I-TERM-TYPE
 10540                                    PI-BMODE.
 10541
 10542     IF BPMTSL        GREATER THAN ZEROS
 10543         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10544                                    PI-BPMTS
 10545        ELSE
 10546         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10547                                    PI-BPMTS.
 10548
 10549     IF BPMTAMTL      GREATER THAN ZEROS
 10550         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10551        ELSE
 10552         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10553
 10554     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10555        IF BTYPE  (1)   NOT = ZEROS
 10556           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10557                                    PI-BTYPE (1)
 10558           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10559           MOVE SPACES           TO PB-I-LF-ABBR
 10560        ELSE
 10561           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10562                                    PB-I-LF-ABBR
 10563           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10564     ELSE
 10565        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10566                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 195
* EL6311.cbl
 10567        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10568
 10569     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10570         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10571     ELSE
 10572         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10573
 10574     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10575         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10576     ELSE
 10577         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10578
 10579     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10580         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10581            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10582            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10583         ELSE
 10584            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10585*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10586*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10587         END-IF
 10588     ELSE
 10589         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10590
 10591     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10592         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10593
 10594     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10595         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10596         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10597     ELSE
 10598         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10599
 10600     IF  BALT-PREM-LEN     (2) > ZEROS
 10601         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10602     ELSE
 10603         MOVE ZEROS            TO PB-I-TOT-FEES.
 10604
 10605     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10606        IF BTYPE      (2)   NOT = ZEROS
 10607           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10608                                  PI-BTYPE (2)
 10609           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10610           MOVE SPACES         TO PB-I-AH-ABBR
 10611        ELSE
 10612           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10613                                  PB-I-AH-ABBR
 10614           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10615     ELSE
 10616        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10617                                  PB-I-AH-ABBR
 10618        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10619
 10620     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10621         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10622     ELSE
 10623         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10624
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 196
* EL6311.cbl
 10625     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10626         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10627            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10628            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10629         ELSE
 10630            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10631*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10632*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10633         END-IF
 10634     ELSE
 10635         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10636
 10637     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10638         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10639
 10640     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10641        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10642     ELSE
 10643        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10644
 10645     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10646        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10647     ELSE
 10648        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10649
 10650     IF BINDGRPL  GREATER THAN ZEROS
 10651         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10652
 10653     IF BRTCLSL   GREATER THAN ZEROS
 10654         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10655
 10656     IF BSIGL     GREATER THAN ZEROS
 10657         MOVE BSIGI              TO PB-I-SIG-SW.
 10658     IF BAPRL > ZEROS
 10659         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10660     ELSE
 10661        if pi-company-id = 'CID'
 10662           move +99.9999         to pb-i-loan-apr
 10663        else
 10664           MOVE ZEROS            TO PB-I-LOAN-APR
 10665        end-if
 10666     end-if
 10667     IF BMEMBERL  GREATER THAN ZEROS
 10668         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10669
 10670     IF BLNOFCRL  GREATER THAN ZEROS
 10671         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10672
 10673     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10674        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10675     ELSE
 10676        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10677
 10678     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10679        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10680     ELSE
 10681        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10682
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 197
* EL6311.cbl
 10683     IF BDAYSL   GREATER THAN ZEROS
 10684        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10685                                    PB-I-EXTENTION-DAYS
 10686     ELSE
 10687        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10688                                    PB-I-EXTENTION-DAYS.
 10689
 10690     IF BDAYSL GREATER THAN ZEROS
 10691        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10692
 10693     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10694        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10695           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10696
 10697     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10698        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10699           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10700
 10701     IF B1STPMTL GREATER THAN ZEROS
 10702        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10703
 10704     IF PB-EXT-DAYS-PROCESSING
 10705        IF PB-I-EXTENTION-DAYS = ZEROS
 10706           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10707
 10708     IF PB-EXPIRE-DT-PROCESSING
 10709        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10710           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10711             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10712
 10713     IF PB-1ST-PMT-DT-PROCESSING
 10714        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10715           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10716
 10717     IF BREINL GREATER THAN ZEROS
 10718        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10719
 10720     IF BENTRYL NOT = ZEROS
 10721        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10722        IF PI-COMPANY-ID = 'CID'
 10723           AND (PB-BATCH-ENTRY = 'P')
 10724           AND (PB-STATE = 'VA')
 10725           PERFORM 1500-UPDATE-ERNOTE
 10726                                 THRU 1500-EXIT
 10727        END-IF
 10728     END-IF
 10729     IF BUNWRITL NOT = ZEROS
 10730        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10731
 10732     IF BFORCEL NOT = ZEROS
 10733        MOVE BFORCEI             TO PB-FORCE-CODE.
 10734
 10735     IF BBILCDL NOT = ZEROS
 10736        MOVE BBILCDI             TO PB-RECORD-BILL.
 10737
 10738     IF BLIVESL GREATER THAN ZEROS
 10739        MOVE WS-BLIVES           TO PB-I-LIVES
 10740     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 198
* EL6311.cbl
 10741        MOVE ZEROS               TO PB-I-LIVES.
 10742
 10743     IF BBILLEDL GREATER THAN ZEROS
 10744        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10745     ELSE
 10746        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10747
 10748*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10749
 10750 1260-WRITE-PB-RECORD.
 10751     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10752                                    PB-INPUT-BY.
 10753     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10754     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10755                                    PB-INPUT-DT.
 10756
 10757     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10758     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10759                                    PB-CONTROL-BY-ORIG-BATCH.
 10760
 10761
 10762     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10763     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10764     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10765     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10766     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10767
 10768     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10769
 10770     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10771
 10772     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10773     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10774     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10775
 10776     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10777     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10778
 10779 1275-WRITE-PENDING-BUSINESS.
 10780     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10781     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10782     MOVE 'A'                    TO JP-RECORD-TYPE.
 10783     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10784
 10785
 10786* EXEC CICS HANDLE CONDITION
 10787*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10788*    END-EXEC.
 10789*    MOVE '"$%                   ! $ #00010604' TO DFHEIV0
 10790     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10791     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10792     MOVE X'2420233030303130363034' TO DFHEIV0(25:11)
 10793     CALL 'kxdfhei1' USING DFHEIV0
 10794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10795
 10796
 10797
 10798* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 199
* EL6311.cbl
 10799*        DATASET (FILE-ID-ERPNDB)
 10800*        FROM    (PENDING-BUSINESS)
 10801*        RIDFLD  (PB-CONTROL-PRIMARY)
 10802*    END-EXEC.
 10803     MOVE LENGTH OF
 10804      PENDING-BUSINESS
 10805       TO DFHEIV11
 10806*    MOVE '&$ L                  ''   #00010608' TO DFHEIV0
 10807     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10808     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10809     MOVE X'2020233030303130363038' TO DFHEIV0(25:11)
 10810     CALL 'kxdfhei1' USING DFHEIV0,
 10811           FILE-ID-ERPNDB,
 10812           PENDING-BUSINESS,
 10813           DFHEIV11,
 10814           PB-CONTROL-PRIMARY,
 10815           DFHEIV99,
 10816           DFHEIV99
 10817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10818
 10819
 10820     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10821
 10822     PERFORM 8400-LOG-JOURNAL-RECORD.
 10823
 10824******************************************************************
 10825*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10826******************************************************************
 10827*    display ' made it to add orig cert '
 10828     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10829     MOVE ' '                    TO WS-ERMAIL-SW
 10830
 10831* EXEC CICS READ
 10832*       DATASET   (FILE-ID-ERMAIL)
 10833*       SET       (ADDRESS OF MAILING-DATA)
 10834*       RIDFLD    (ERMAIL-KEY)
 10835*       RESP      (WS-RESPONSE)
 10836*    END-EXEC
 10837*    MOVE '&"S        E          (  N#00010624' TO DFHEIV0
 10838     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10839     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10840     MOVE X'204E233030303130363234' TO DFHEIV0(25:11)
 10841     CALL 'kxdfhei1' USING DFHEIV0,
 10842           FILE-ID-ERMAIL,
 10843           DFHEIV20,
 10844           DFHEIV99,
 10845           ERMAIL-KEY,
 10846           DFHEIV99,
 10847           DFHEIV99,
 10848           DFHEIV99
 10849     SET ADDRESS OF MAILING-DATA TO
 10850         DFHEIV20
 10851     MOVE EIBRESP  TO WS-RESPONSE
 10852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10853     IF RESP-NORMAL
 10854        SET ERMAIL-FOUND TO TRUE
 10855     END-IF
 10856
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 200
* EL6311.cbl
 10857     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10858     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10859     MOVE 'OC'                   TO OC-RECORD-ID
 10860     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10861                                 TO OC-CONTROL-PRIMARY (1:33)
 10862     MOVE 'I'                    TO OC-RECORD-TYPE
 10863     MOVE +4096                  TO OC-KEY-SEQ-NO
 10864     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10865     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10866     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10867     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10868     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10869     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10870     MOVE PB-I-AGE               TO OC-INS-AGE
 10871     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10872     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10873     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10874     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10875     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10876     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10877     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10878     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10879     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10880     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10881     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10882     IF PB-I-JOINT-COMMISSION > +0
 10883         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10884     ELSE
 10885         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10886     END-IF
 10887     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10888     MOVE +0                     TO OC-LF-CANCEL-AMT
 10889                                    OC-LF-ITD-CANCEL-AMT
 10890     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10891     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10892     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10893     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10894     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10895     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10896     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10897     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10898     MOVE +0                     TO OC-AH-CANCEL-AMT
 10899                                    OC-AH-ITD-CANCEL-AMT
 10900     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10901     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10902     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10903     IF ERMAIL-FOUND
 10904        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10905     END-IF
 10906     IF NOT CERT-TRL-REC-NOT-FOUND
 10907        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10908                           OC-INS-AGE-DEFAULT-FLAG
 10909        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10910                           OC-JNT-AGE-DEFAULT-FLAG
 10911     END-IF
 10912     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10913     .
 10914 1275-WRITE-ELCRTO.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 201
* EL6311.cbl
 10915
 10916* EXEC CICS WRITE
 10917*       DATASET   ('ELCRTO')
 10918*       FROM      (ORIGINAL-CERTIFICATE)
 10919*       RIDFLD    (OC-CONTROL-PRIMARY)
 10920*       RESP      (WS-RESPONSE)
 10921*    END-EXEC
 10922     MOVE LENGTH OF
 10923      ORIGINAL-CERTIFICATE
 10924       TO DFHEIV11
 10925     MOVE 'ELCRTO' TO DFHEIV1
 10926*    MOVE '&$ L                  ''  N#00010692' TO DFHEIV0
 10927     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10928     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10929     MOVE X'204E233030303130363932' TO DFHEIV0(25:11)
 10930     CALL 'kxdfhei1' USING DFHEIV0,
 10931           DFHEIV1,
 10932           ORIGINAL-CERTIFICATE,
 10933           DFHEIV11,
 10934           OC-CONTROL-PRIMARY,
 10935           DFHEIV99,
 10936           DFHEIV99
 10937     MOVE EIBRESP  TO WS-RESPONSE
 10938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10939*    display ' just wrote 1275 ' ws-response
 10940     IF RESP-DUPKEY
 10941        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10942        GO TO 1275-WRITE-ELCRTO
 10943     ELSE
 10944        IF NOT RESP-NORMAL
 10945           MOVE -1               TO BMAINTL
 10946           MOVE ER-7450          TO EMI-ERROR
 10947           PERFORM 9900-ERROR-FORMAT
 10948                                 THRU 9900-EXIT
 10949           GO TO 8200-SEND-DATAONLY
 10950        END-IF
 10951     END-IF
 10952******************************************************************
 10953*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10954******************************************************************
 10955
 10956
 10957* EXEC CICS READ
 10958*        INTO    (PENDING-BUSINESS)
 10959*        DATASET (FILE-ID-ERPNDB)
 10960*        RIDFLD  (ERPNDB-KEY)
 10961*        UPDATE
 10962*    END-EXEC.
 10963     MOVE LENGTH OF
 10964      PENDING-BUSINESS
 10965       TO DFHEIV11
 10966*    MOVE '&"IL       EU         (   #00010715' TO DFHEIV0
 10967     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10968     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10969     MOVE X'2020233030303130373135' TO DFHEIV0(25:11)
 10970     CALL 'kxdfhei1' USING DFHEIV0,
 10971           FILE-ID-ERPNDB,
 10972           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 202
* EL6311.cbl
 10973           DFHEIV11,
 10974           ERPNDB-KEY,
 10975           DFHEIV99,
 10976           DFHEIV99,
 10977           DFHEIV99
 10978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10979
 10980
 10981     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10982     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10983     MOVE 'B'                    TO JP-RECORD-TYPE.
 10984     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10985
 10986     PERFORM 8400-LOG-JOURNAL-RECORD.
 10987
 10988     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10989
 10990
 10991* EXEC CICS REWRITE
 10992*        DATASET (FILE-ID-ERPNDB)
 10993*        FROM    (PENDING-BUSINESS)
 10994*    END-EXEC.
 10995     MOVE LENGTH OF
 10996      PENDING-BUSINESS
 10997       TO DFHEIV11
 10998*    MOVE '&& L                  %   #00010731' TO DFHEIV0
 10999     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11000     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11001     MOVE X'2020233030303130373331' TO DFHEIV0(25:11)
 11002     CALL 'kxdfhei1' USING DFHEIV0,
 11003           FILE-ID-ERPNDB,
 11004           PENDING-BUSINESS,
 11005           DFHEIV11,
 11006           DFHEIV99
 11007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11008
 11009
 11010     MOVE 'C'                    TO JP-RECORD-TYPE.
 11011     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11012
 11013     PERFORM 8400-LOG-JOURNAL-RECORD.
 11014
 11015     IF WS-ERRORS-PRESENT
 11016         GO TO 3900-RE-DISPLAY-RECORD.
 11017
 11018     MOVE ZEROS                  TO EMI-ERROR.
 11019     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11020     MOVE LOW-VALUES             TO EL631BI.
 11021     MOVE  -1                    TO BMAINTL.
 11022     GO TO 8100-SEND-INITIAL-MAP.
 11023
 11024 1280-BATCH-HDR-NOT-FOUND.
 11025     MOVE -1                     TO BMAINTL.
 11026     MOVE ER-7450                TO EMI-ERROR.
 11027     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11028     GO TO 8200-SEND-DATAONLY.
 11029
 11030 1290-DUPLICATE-ALT-INDEX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 203
* EL6311.cbl
 11031
 11032******************************************************************
 11033*                                                                *
 11034*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11035*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11036*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11037*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11038*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11039*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11040*                                                                *
 11041******************************************************************
 11042
 11043     IF LCP-ONCTR-01 =  0
 11044         ADD 1 TO LCP-ONCTR-01
 11045        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11046
 11047     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11048
 11049     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11050         NEXT SENTENCE
 11051     ELSE
 11052         ADD +1 TO PB-BATCH-SEQ-NO
 11053                   PB-CSR-BATCH-SEQ-NO
 11054         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11055         GO TO 1275-WRITE-PENDING-BUSINESS.
 11056
 11057     MOVE -1                     TO BCERTNOL.
 11058     MOVE AL-UABON               TO BCERTNOA.
 11059     MOVE AL-UNBON               TO BEFFDTA.
 11060
 11061     MOVE 1                      TO EMI-SUB
 11062                                    EMI-SWITCH1
 11063                                    EMI-SWITCH-AREA-1
 11064                                    EMI-SWITCH-AREA-2.
 11065
 11066     MOVE SPACES                 TO EMI-ERROR-LINES.
 11067
 11068
 11069* EXEC CICS SYNCPOINT ROLLBACK
 11070*    END-EXEC.
 11071*    MOVE '6"R                   !   #00010794' TO DFHEIV0
 11072     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11074     MOVE X'2020233030303130373934' TO DFHEIV0(25:11)
 11075     CALL 'kxdfhei1' USING DFHEIV0
 11076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11077
 11078
 11079     MOVE ER-2247                TO EMI-ERROR.
 11080     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11081     GO TO 8200-SEND-DATAONLY.
 11082
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 204
* EL6311.cbl
 11084
 11085
 11086 1295-READ-CERT-TRAILER.
 11087
 11088
 11089* EXEC CICS GETMAIN
 11090*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11091*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11092*        INITIMG (GETMAIN-SPACE)
 11093*    END-EXEC
 11094*    MOVE ',"IL                  $   #00010806' TO DFHEIV0
 11095     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11096     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11097     MOVE X'2020233030303130383036' TO DFHEIV0(25:11)
 11098     CALL 'kxdfhei1' USING DFHEIV0,
 11099           DFHEIV20,
 11100           ELCRTT-RECORD-LENGTH,
 11101           GETMAIN-SPACE
 11102     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11103         DFHEIV20
 11104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11105
 11106     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11107     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11108     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11109
 11110
 11111* EXEC CICS HANDLE CONDITION
 11112*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11113*    END-EXEC.
 11114*    MOVE '"$I                   ! % #00010816' TO DFHEIV0
 11115     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11116     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11117     MOVE X'2520233030303130383136' TO DFHEIV0(25:11)
 11118     CALL 'kxdfhei1' USING DFHEIV0
 11119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11120
 11121
 11122
 11123* EXEC CICS READ
 11124*        DATASET  (CRTT-ID)
 11125*        RIDFLD   (ELCRTT-KEY)
 11126*        INTO     (CERTIFICATE-TRAILERS)
 11127*    END-EXEC.
 11128     MOVE LENGTH OF
 11129      CERTIFICATE-TRAILERS
 11130       TO DFHEIV11
 11131*    MOVE '&"IL       E          (   #00010820' TO DFHEIV0
 11132     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11133     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11134     MOVE X'2020233030303130383230' TO DFHEIV0(25:11)
 11135     CALL 'kxdfhei1' USING DFHEIV0,
 11136           CRTT-ID,
 11137           CERTIFICATE-TRAILERS,
 11138           DFHEIV11,
 11139           ELCRTT-KEY,
 11140           DFHEIV99,
 11141           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 205
* EL6311.cbl
 11142           DFHEIV99
 11143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11144
 11145
 11146     GO TO 1295-EXIT.
 11147
 11148 1295-CERT-TRL-REC-NOTFND.
 11149     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11150
 11151 1295-EXIT.
 11152     EXIT.
 11153
 11154******************************************************************
 11155*                                                                *
 11156*          C H A N G E   I S S U E   R O U T I N E               *
 11157*                                                                *
 11158******************************************************************
 11159
 11160***************************************************************
 11161*                                                             *
 11162*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11163*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11164*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11165*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11166*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11167*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11168*     5. LINK TO THE EDIT ROUTINE.                            *
 11169*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11170*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11171*              THE EDIT ROUTINE.                              *
 11172*     7. REWRITE THE NEW ISSUE                                *
 11173*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11174*                                                             *
 11175***************************************************************
 11176
 11177 1300-CHANGE-ISSUE-ROUTINE.
 11178     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11179
 11180     IF BCHGL NOT = ZEROS
 11181        MOVE ER-2196             TO EMI-ERROR
 11182        MOVE AL-UABON            TO BMAINTA
 11183        MOVE -1                  TO BMAINTL
 11184        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11185        GO TO 8200-SEND-DATAONLY.
 11186
 11187     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11188
 11189     IF BSUFIXL NOT = ZEROS
 11190        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11191     ELSE
 11192        MOVE SPACE               TO WS-NEW-SUFFIX.
 11193
 11194     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11195     PERFORM 8600-DEEDIT.
 11196     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11197     MOVE '4'                    TO DC-OPTION-CODE.
 11198     PERFORM 9700-DATE-LINK.
 11199     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 206
* EL6311.cbl
 11200        MOVE ER-0348             TO EMI-ERROR
 11201        MOVE -1                  TO BEFFDTL
 11202        MOVE AL-UABON            TO BEFFDTA
 11203        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11204        GO TO 8200-SEND-DATAONLY
 11205     ELSE
 11206        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11207        MOVE AL-UANON            TO BEFFDTA
 11208        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11209
 11210 1325-PROCESS-ISSUE-CHANGES.
 11211
 11212* EXEC CICS HANDLE CONDITION
 11213*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11214*    END-EXEC.
 11215*    MOVE '"$I                   ! & #00010891' TO DFHEIV0
 11216     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11217     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11218     MOVE X'2620233030303130383931' TO DFHEIV0(25:11)
 11219     CALL 'kxdfhei1' USING DFHEIV0
 11220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11221
 11222
 11223     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11224     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11225     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11226
 11227
 11228* EXEC CICS GETMAIN
 11229*        SET      (ADDRESS OF PENDING-BUSINESS)
 11230*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11231*        INITIMG  (GETMAIN-SPACE)
 11232*     END-EXEC.
 11233*    MOVE ',"IL                  $   #00010899' TO DFHEIV0
 11234     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11235     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11236     MOVE X'2020233030303130383939' TO DFHEIV0(25:11)
 11237     CALL 'kxdfhei1' USING DFHEIV0,
 11238           DFHEIV20,
 11239           ERPNDB-RECORD-LENGTH,
 11240           GETMAIN-SPACE
 11241     SET ADDRESS OF PENDING-BUSINESS TO
 11242         DFHEIV20
 11243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11244
 11245
 11246
 11247* EXEC CICS READ
 11248*        INTO    (PENDING-BUSINESS)
 11249*        DATASET (FILE-ID-ERPNDB)
 11250*        RIDFLD  (ERPNDB-KEY)
 11251*    END-EXEC.
 11252     MOVE LENGTH OF
 11253      PENDING-BUSINESS
 11254       TO DFHEIV11
 11255*    MOVE '&"IL       E          (   #00010905' TO DFHEIV0
 11256     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11257     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 207
* EL6311.cbl
 11258     MOVE X'2020233030303130393035' TO DFHEIV0(25:11)
 11259     CALL 'kxdfhei1' USING DFHEIV0,
 11260           FILE-ID-ERPNDB,
 11261           PENDING-BUSINESS,
 11262           DFHEIV11,
 11263           ERPNDB-KEY,
 11264           DFHEIV99,
 11265           DFHEIV99,
 11266           DFHEIV99
 11267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11268
 11269
 11270     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11271
 11272
 11273* EXEC CICS HANDLE CONDITION
 11274*         NOTFND     (1385-REC-NOT-FOUND)
 11275*    END-EXEC.
 11276*    MOVE '"$I                   ! '' #00010913' TO DFHEIV0
 11277     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11278     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11279     MOVE X'2720233030303130393133' TO DFHEIV0(25:11)
 11280     CALL 'kxdfhei1' USING DFHEIV0
 11281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11282
 11283
 11284**********************************************************
 11285*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11286*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11287**********************************************************
 11288
 11289
 11290* EXEC CICS READ
 11291*        DATASET (FILE-ID-ERPNDB)
 11292*        INTO    (PENDING-BUSINESS)
 11293*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11294*    END-EXEC.
 11295     MOVE LENGTH OF
 11296      PENDING-BUSINESS
 11297       TO DFHEIV11
 11298*    MOVE '&"IL       E          (   #00010922' TO DFHEIV0
 11299     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11300     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11301     MOVE X'2020233030303130393232' TO DFHEIV0(25:11)
 11302     CALL 'kxdfhei1' USING DFHEIV0,
 11303           FILE-ID-ERPNDB,
 11304           PENDING-BUSINESS,
 11305           DFHEIV11,
 11306           PI-PREV-CONTROL-PRIMARY,
 11307           DFHEIV99,
 11308           DFHEIV99,
 11309           DFHEIV99
 11310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11311
 11312
 11313********** DO NOT ALLOW CHANGES IF THRU A/R
 11314     IF BMAINTI = 'C'
 11315         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 208
* EL6311.cbl
 11316             MOVE ER-4005          TO EMI-ERROR
 11317             MOVE -1               TO BMAINTL
 11318             MOVE AL-UABON         TO BMAINTA
 11319             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11320             GO TO 8200-SEND-DATAONLY.
 11321**********
 11322
 11323     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11324        MOVE -1                 TO BMAINTL
 11325        MOVE ER-2197            TO EMI-ERROR
 11326        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11327        GO TO 8200-SEND-DATAONLY.
 11328
 11329     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11330        MOVE ER-2196             TO EMI-ERROR
 11331        MOVE AL-UABON            TO BMAINTA
 11332        MOVE -1                  TO BMAINTL
 11333        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11334        GO TO 8200-SEND-DATAONLY.
 11335
 11336     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11337
 11338     IF PB-BILLED-DT = LOW-VALUES AND
 11339        PB-CHG-COUNT = ZEROS
 11340        NEXT SENTENCE
 11341     ELSE
 11342        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11343            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11344           OR
 11345           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11346            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11347           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11348     move zeros                  to ws-check-amts
 11349     move ' '                    to ws-stop-sw
 11350                                    ws-check-sw
 11351                                    ws-proc-check-sw
 11352                                    ws-chek-browse-sw
 11353
 11354     perform 2500-browse-checks  thru 2500-exit
 11355
 11356     if i-have-processed-checks
 11357        or i-have-checks
 11358        continue
 11359     else
 11360        go to 1330-continue
 11361     end-if
 11362
 11363     compute ws-tot-orig-prem =
 11364        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11365        pb-i-lf-alt-premium-amt
 11366
 11367     if bprem1l <> zeros
 11368        MOVE AL-UNNON            TO bprem1a
 11369        move ws-bprem (1)        to ws-new-iss-total
 11370     else
 11371        move pb-i-lf-premium-amt to ws-new-iss-total
 11372     end-if
 11373     display ' new iss totala ' ws-new-iss-total
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 209
* EL6311.cbl
 11374
 11375     if baltpr1l <> zeros
 11376        MOVE AL-UNNON            TO baltpr1a
 11377        compute ws-new-iss-total =
 11378           ws-new-iss-total + ws-balt-prem(1)
 11379     else
 11380        compute ws-new-iss-total =
 11381           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11382     end-if
 11383
 11384     if bprem2l <> zeros
 11385        MOVE AL-UNNON            TO bprem2a
 11386        compute ws-new-iss-total = ws-new-iss-total +
 11387           ws-bprem (2)
 11388     else
 11389        compute ws-new-iss-total = ws-new-iss-total +
 11390           pb-i-ah-premium-amt
 11391     end-if
 11392
 11393     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11394        if ((bprem1l <> zeros)
 11395           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11396                      or
 11397           ((bprem2l <> zeros)
 11398           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11399           move er-3456          to emi-error
 11400           perform 9900-error-format
 11401                                 thru 9900-exit
 11402           go to 1330-continue
 11403        end-if
 11404     end-if
 11405
 11406     if ws-new-iss-total > ws-tot-orig-prem
 11407        move er-3458             to emi-error
 11408        perform 9900-error-format thru 9900-exit
 11409        move al-uabon            to bmainta
 11410        move -1                  to bmaintl
 11411        go to 8200-send-dataonly
 11412     end-if
 11413
 11414     if ws-new-iss-total < ws-tot-orig-prem
 11415        move er-3457             to emi-error
 11416        move al-uabon            to bprem1a
 11417                                    bprem2a
 11418        move +0 to bprem1l bprem2l
 11419        perform 9900-error-format thru 9900-exit
 11420        move -1                  to bmaintl
 11421        go to 1330-continue
 11422     end-if
 11423
 11424     .
 11425 1330-continue.
 11426
 11427
 11428* EXEC CICS READ
 11429*        DATASET (FILE-ID-ERPNDB)
 11430*        INTO    (PENDING-BUSINESS)
 11431*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 210
* EL6311.cbl
 11432*        UPDATE
 11433*    END-EXEC.
 11434     MOVE LENGTH OF
 11435      PENDING-BUSINESS
 11436       TO DFHEIV11
 11437*    MOVE '&"IL       EU         (   #00011042' TO DFHEIV0
 11438     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11439     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11440     MOVE X'2020233030303131303432' TO DFHEIV0(25:11)
 11441     CALL 'kxdfhei1' USING DFHEIV0,
 11442           FILE-ID-ERPNDB,
 11443           PENDING-BUSINESS,
 11444           DFHEIV11,
 11445           PI-PREV-CONTROL-PRIMARY,
 11446           DFHEIV99,
 11447           DFHEIV99,
 11448           DFHEIV99
 11449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11450
 11451
 11452     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11453     MOVE 'B'                    TO JP-RECORD-TYPE
 11454     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11455     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11456
 11457     PERFORM 8400-LOG-JOURNAL-RECORD.
 11458
 11459     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11460        PB-CHG-COUNT NOT = ZEROS
 11461        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11462            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11463           OR
 11464           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11465            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11466            MOVE LOW-VALUES             TO PB-BILLED-DT
 11467            ADD +1                      TO PB-CHG-COUNT.
 11468
 11469     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11470     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11471     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11472     MOVE '5'                    TO DC-OPTION-CODE.
 11473     PERFORM 9700-DATE-LINK
 11474     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11475
 11476*    IF BMICRNOL  GREATER  ZEROS
 11477*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11478
 11479     IF BVINL > ZEROS
 11480        MOVE BVINI               TO PB-I-VIN
 11481     END-IF
 11482     IF (BFORCEL NOT = ZEROS)
 11483        AND (PB-COMPANY-ID = 'DCC' or 'CAP')
 11484        AND (BFORCEI = ' ')
 11485        AND (PB-FORCE-CODE = 'O')
 11486        COMPUTE PB-I-AH-PREMIUM-AMT =
 11487           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11488        PERFORM 1800-REMOVE-CERT-NOTES
 11489                                 THRU 1800-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 211
* EL6311.cbl
 11490        PERFORM 1900-DELETE-ERPYAJ
 11491                                 THRU 1900-EXIT
 11492        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11493     END-IF
 11494     IF (BFORCEL NOT = ZEROS)
 11495        AND (PB-COMPANY-ID = 'DCC' or 'CAP')
 11496        AND (BFORCEI = 'O')
 11497        AND (PB-FORCE-CODE NOT = 'O')
 11498        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11499           PB-I-AH-PREM-CALC
 11500        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11501        MOVE SPACE               TO DC-OPTION-CODE
 11502        PERFORM 9700-DATE-LINK
 11503        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11504        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11505        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11506        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11507        PERFORM 1500-UPDATE-ERNOTE
 11508                                 THRU 1500-EXIT
 11509        PERFORM 1600-UPDATE-ERPYAJ
 11510                                 THRU 1600-EXIT
 11511     END-IF
 11512     IF BLSTNML  GREATER THAN ZEROS
 11513         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11514
 11515     IF B1STNML  GREATER THAN ZEROS
 11516         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11517
 11518     IF BINITL   GREATER THAN ZEROS
 11519         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11520
 11521     IF BBIRTHL  GREATER THAN ZERO
 11522         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11523
 11524     IF B1STPMTL GREATER THAN ZERO
 11525         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11526
 11527     IF BAGEL    GREATER THAN ZEROS
 11528         MOVE BAGEI              TO PB-I-AGE.
 11529
 11530     MOVE 'N'                    TO WS-INS-AGE-SET
 11531                                    WS-JNT-AGE-SET.
 11532     IF BAGEL    GREATER THAN ZEROS
 11533        MOVE 'Y'                TO WS-INS-AGE-SET
 11534        IF BAGEI = ZERO AND
 11535             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11536           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11537           MOVE 'AGE*'          TO BAGEDEFO
 11538        ELSE
 11539           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11540           MOVE 'AGE '          TO BAGEDEFO
 11541        END-IF
 11542        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11543     END-IF.
 11544
 11545     IF BSEXL    GREATER THAN ZEROS
 11546         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11547
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 212
* EL6311.cbl
 11548     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11549        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11550
 11551     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11552        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11553
 11554     IF BLNTRML  GREATER THAN ZEROS
 11555         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11556
 11557     IF BFREQL   GREATER THAN ZEROS
 11558         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11559
 11560     IF BSKPCDL  GREATER THAN ZEROS
 11561         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11562
 11563     IF BMODEL   GREATER THAN ZEROS
 11564         MOVE BMODEI             TO PB-I-TERM-TYPE
 11565                                    PI-BMODE.
 11566
 11567     IF BPMTSL   GREATER THAN ZEROS
 11568         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11569                                    PI-BPMTS.
 11570
 11571     IF BPMTAMTL GREATER THAN ZEROS
 11572         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11573
 11574     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11575         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11576
 11577     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11578         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11579
 11580     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11581
 11582     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11583         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11584            SUBTRACT PB-I-LF-PREMIUM-AMT
 11585                     FROM WS-B-LF-ISS-PRM-ENTERED
 11586            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11587            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11588            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11589         ELSE
 11590            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11591*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11592*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11593         END-IF
 11594     END-IF.
 11595
 11596     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11597            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11598                     FROM WS-B-LF-ISS-PRM-ENTERED
 11599         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11600         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11601
 11602     IF  BALT-PREM-LEN     (2)  > ZEROS
 11603         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11604
 11605     IF  BBEN-LEN (2)  GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 213
* EL6311.cbl
 11606         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11607
 11608     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11609         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11610            SUBTRACT PB-I-AH-PREMIUM-AMT
 11611                     FROM WS-B-AH-ISS-PRM-ENTERED
 11612            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11613            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11614            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11615         ELSE
 11616            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11617*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11618*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11619         END-IF
 11620     END-IF
 11621
 11622     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11623        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11624
 11625     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11626        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11627
 11628     IF BINDGRPL            GREATER THAN ZEROS
 11629         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11630
 11631     IF BRTCLSL             GREATER THAN ZEROS
 11632         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11633
 11634     IF BSIGL               GREATER THAN ZEROS
 11635         MOVE BSIGI              TO PB-I-SIG-SW.
 11636
 11637     IF BAPRL               GREATER THAN ZEROS
 11638         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11639
 11640     IF BMEMBERL            GREATER THAN ZEROS
 11641         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11642
 11643     IF BLNOFCRL            GREATER THAN ZEROS
 11644         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11645
 11646     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11647        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11648
 11649     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11650        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11651
 11652     IF BDAYSL              GREATER THAN ZEROS
 11653        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11654                                    PB-I-EXTENTION-DAYS.
 11655
 11656     IF BDAYSL GREATER THAN ZEROS
 11657        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11658
 11659     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11660        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11661           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11662
 11663     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 214
* EL6311.cbl
 11664        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11665           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11666
 11667     IF B1STPMTL GREATER THAN ZEROS
 11668        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11669
 11670     IF PB-EXT-DAYS-PROCESSING
 11671        IF PB-I-EXTENTION-DAYS = ZEROS
 11672           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11673
 11674     IF PB-EXPIRE-DT-PROCESSING
 11675        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11676           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11677             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11678
 11679     IF PB-1ST-PMT-DT-PROCESSING
 11680        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11681           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11682
 11683     IF BREINL GREATER THAN ZEROS
 11684        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11685
 11686     IF BFORCEL NOT = ZEROS
 11687        MOVE BFORCEI             TO PB-FORCE-CODE.
 11688     IF (BENTRYL NOT = ZEROS)
 11689        AND (PB-COMPANY-ID = 'CID')
 11690        AND (PB-STATE = 'VA')
 11691        AND (BENTRYI NOT = 'P')
 11692        AND (PB-BATCH-ENTRY = 'P')
 11693        PERFORM 1800-REMOVE-CERT-NOTES
 11694                                 THRU 1800-EXIT
 11695     END-IF
 11696     IF BENTRYL NOT = ZEROS
 11697        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11698        IF PI-COMPANY-ID = 'CID'
 11699           AND (PB-BATCH-ENTRY = 'P')
 11700           AND (PB-STATE = 'VA')
 11701           PERFORM 1500-UPDATE-ERNOTE
 11702                                 THRU 1500-EXIT
 11703        END-IF
 11704     END-IF
 11705
 11706     IF BUNWRITL NOT = ZEROS
 11707        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11708
 11709     IF BBILCDL NOT = ZEROS
 11710        MOVE BBILCDI             TO PB-RECORD-BILL.
 11711
 11712     IF BLIVESL GREATER THAN ZEROS
 11713        MOVE WS-BLIVES           TO PB-I-LIVES.
 11714
 11715
 11716*DMD CUSTOM CODING*************START
 11717     IF PI-COMPANY-ID NOT = 'DMD'
 11718         MOVE ZEROS               TO BBILLEDL.
 11719*DMD CUSTOM CODING*************END
 11720
 11721     IF BBILLEDL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 215
* EL6311.cbl
 11722        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11723
 11724
 11725*****************************************************************
 11726*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11727*****************************************************************
 11728
 11729     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11730        IF BTYPE  (1)   = ZEROS OR SPACES
 11731           IF REMOVE-LF-COVERAGE
 11732               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11733                                        PI-BTYPE (1)
 11734               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11735                                        WS-B-LF-ISS-PRM-ENTERED
 11736               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11737                                        WS-B-LF-ISS-PRM-ENTERED
 11738               SUBTRACT PB-I-LF-PREM-CALC FROM
 11739                                        WS-B-LF-ISS-PRM-COMPUTED
 11740               MOVE ZEROS            TO PB-I-LF-TERM
 11741                                        PB-I-LF-BENEFIT-AMT
 11742                                        PB-I-LF-PREMIUM-AMT
 11743                                        PB-I-LF-BENEFIT-CD
 11744                                        PB-I-LF-PREM-CALC
 11745                                        PB-I-LF-CRIT-PER
 11746                                        PB-I-LF-ALT-BENEFIT-AMT
 11747                                        PB-I-LF-ALT-PREMIUM-AMT
 11748               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11749           ELSE
 11750               NEXT SENTENCE
 11751        ELSE
 11752           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11753                                    PI-BTYPE (1).
 11754     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11755        IF BTYPE  (2)   = ZEROS OR SPACES
 11756           IF  REMOVE-AH-COVERAGE
 11757               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11758                                        PI-BTYPE (2)
 11759               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11760                                        WS-B-AH-ISS-PRM-ENTERED
 11761               SUBTRACT PB-I-AH-PREM-CALC FROM
 11762                                        WS-B-AH-ISS-PRM-COMPUTED
 11763               MOVE ZEROS            TO PB-I-AH-TERM
 11764                                        PB-I-AH-BENEFIT-AMT
 11765                                        PB-I-AH-PREMIUM-AMT
 11766                                        PB-I-AH-BENEFIT-CD
 11767                                        PB-I-AH-PREM-CALC
 11768                                        PB-I-AH-CRIT-PER
 11769               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11770           ELSE
 11771               NEXT SENTENCE
 11772        ELSE
 11773           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11774                                    PI-BTYPE (2).
 11775 1360-REWRITE-PB-RECORD.
 11776     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11777
 11778     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11779     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 216
* EL6311.cbl
 11780
 11781     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11782
 11783     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11784     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11785
 11786     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11787         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11788
 11789     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11790         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11791
 11792     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11793
 11794     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11795
 11796     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11797
 11798     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11799     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11800     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11801
 11802     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11803     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11804
 11805 1375-REWRITE-PB-RECORD.
 11806     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11807     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11808     MOVE 'C'                    TO JP-RECORD-TYPE.
 11809     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11810
 11811
 11812* EXEC CICS REWRITE
 11813*        DATASET (FILE-ID-ERPNDB)
 11814*        FROM    (PENDING-BUSINESS)
 11815*    END-EXEC.
 11816     MOVE LENGTH OF
 11817      PENDING-BUSINESS
 11818       TO DFHEIV11
 11819*    MOVE '&& L                  %   #00011408' TO DFHEIV0
 11820     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11821     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11822     MOVE X'2020233030303131343038' TO DFHEIV0(25:11)
 11823     CALL 'kxdfhei1' USING DFHEIV0,
 11824           FILE-ID-ERPNDB,
 11825           PENDING-BUSINESS,
 11826           DFHEIV11,
 11827           DFHEIV99
 11828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11829
 11830
 11831     PERFORM 8400-LOG-JOURNAL-RECORD.
 11832******************************************************************
 11833*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11834******************************************************************
 11835     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11836     MOVE ' '                    TO WS-ERMAIL-SW
 11837
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 217
* EL6311.cbl
 11838* EXEC CICS READ
 11839*       DATASET   (FILE-ID-ERMAIL)
 11840*       SET       (ADDRESS OF MAILING-DATA)
 11841*       RIDFLD    (ERMAIL-KEY)
 11842*       RESP      (WS-RESPONSE)
 11843*    END-EXEC
 11844*    MOVE '&"S        E          (  N#00011419' TO DFHEIV0
 11845     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11846     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11847     MOVE X'204E233030303131343139' TO DFHEIV0(25:11)
 11848     CALL 'kxdfhei1' USING DFHEIV0,
 11849           FILE-ID-ERMAIL,
 11850           DFHEIV20,
 11851           DFHEIV99,
 11852           ERMAIL-KEY,
 11853           DFHEIV99,
 11854           DFHEIV99,
 11855           DFHEIV99
 11856     SET ADDRESS OF MAILING-DATA TO
 11857         DFHEIV20
 11858     MOVE EIBRESP  TO WS-RESPONSE
 11859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11860     IF RESP-NORMAL
 11861        SET ERMAIL-FOUND TO TRUE
 11862     END-IF
 11863
 11864     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11865     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11866                                 TO ELCRTO-KEY
 11867     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11868     MOVE +0                     TO ELCRTO-SEQ-NO
 11869
 11870* EXEC CICS READ
 11871*       DATASET   ('ELCRTO')
 11872*       INTO      (ORIGINAL-CERTIFICATE)
 11873*       RIDFLD    (ELCRTO-KEY)
 11874*       GTEQ
 11875*       RESP      (WS-RESPONSE)
 11876*    END-EXEC
 11877     MOVE LENGTH OF
 11878      ORIGINAL-CERTIFICATE
 11879       TO DFHEIV11
 11880     MOVE 'ELCRTO' TO DFHEIV1
 11881*    MOVE '&"IL       G          (  N#00011434' TO DFHEIV0
 11882     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11883     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11884     MOVE X'204E233030303131343334' TO DFHEIV0(25:11)
 11885     CALL 'kxdfhei1' USING DFHEIV0,
 11886           DFHEIV1,
 11887           ORIGINAL-CERTIFICATE,
 11888           DFHEIV11,
 11889           ELCRTO-KEY,
 11890           DFHEIV99,
 11891           DFHEIV99,
 11892           DFHEIV99
 11893     MOVE EIBRESP  TO WS-RESPONSE
 11894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11895*    display ' just read gteq ' ws-response
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 218
* EL6311.cbl
 11896     IF RESP-NORMAL
 11897        AND (OC-CONTROL-PRIMARY (1:33) =
 11898                 PB-CONTROL-BY-ACCOUNT (1:33))
 11899        AND (OC-RECORD-TYPE = 'I')
 11900*       display ' resp norm, key =, type i '
 11901        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11902*          display ' end proc blank '
 11903           display ' csr edit session ' PI-CSR-SESSION-SW
 11904           IF NOT CSR-EDIT-SESSION
 11905
 11906* EXEC CICS READ
 11907*                DATASET   ('ELCRTO')
 11908*                INTO      (ORIGINAL-CERTIFICATE)
 11909*                RIDFLD    (OC-CONTROL-PRIMARY)
 11910*                UPDATE
 11911*                RESP      (WS-RESPONSE)
 11912*             END-EXEC
 11913     MOVE LENGTH OF
 11914      ORIGINAL-CERTIFICATE
 11915       TO DFHEIV11
 11916     MOVE 'ELCRTO' TO DFHEIV1
 11917*    MOVE '&"IL       EU         (  N#00011451' TO DFHEIV0
 11918     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11919     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11920     MOVE X'204E233030303131343531' TO DFHEIV0(25:11)
 11921     CALL 'kxdfhei1' USING DFHEIV0,
 11922           DFHEIV1,
 11923           ORIGINAL-CERTIFICATE,
 11924           DFHEIV11,
 11925           OC-CONTROL-PRIMARY,
 11926           DFHEIV99,
 11927           DFHEIV99,
 11928           DFHEIV99
 11929     MOVE EIBRESP  TO WS-RESPONSE
 11930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11931              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11932              IF RESP-NORMAL
 11933                 display ' good read upd '
 11934                 MOVE PB-I-INSURED-LAST-NAME TO
 11935                         OC-INS-LAST-NAME
 11936                 MOVE PB-I-INSURED-FIRST-NAME TO
 11937                         OC-INS-FIRST-NAME
 11938                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11939                         OC-INS-MIDDLE-INIT
 11940                 MOVE PB-I-AGE         TO OC-INS-AGE
 11941                 MOVE PB-I-JOINT-LAST-NAME   TO
 11942                         OC-JNT-LAST-NAME
 11943                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11944                         OC-JNT-FIRST-NAME
 11945                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11946                         OC-JNT-MIDDLE-INIT
 11947                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11948                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11949                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11950                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11951                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11952                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11953                         OC-LF-ALT-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 219
* EL6311.cbl
 11954                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11955                         OC-LF-ALT-PRM-AMT
 11956                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11957                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11958                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11959                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11960                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11961                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11962                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11963                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11964                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11965                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11966                 IF OC-CANCEL-TRAN-IND = 'N'
 11967                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11968                    MOVE +0            TO OC-LF-CANCEL-AMT
 11969                                          OC-LF-ITD-CANCEL-AMT
 11970                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 11971                    MOVE +0            TO OC-AH-CANCEL-AMT
 11972                                          OC-AH-ITD-CANCEL-AMT
 11973                 END-IF
 11974                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11975                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11976                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11977                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11978                 IF ERMAIL-FOUND
 11979                    MOVE MA-CRED-BENE-NAME
 11980                                 TO OC-CRED-BENE-NAME
 11981                 END-IF
 11982                 IF NOT CERT-TRL-REC-NOT-FOUND
 11983                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11984                           OC-INS-AGE-DEFAULT-FLAG
 11985                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11986                           OC-JNT-AGE-DEFAULT-FLAG
 11987                 END-IF
 11988
 11989* EXEC CICS REWRITE
 11990*                   DATASET   ('ELCRTO')
 11991*                   FROM      (ORIGINAL-CERTIFICATE)
 11992*                   RESP      (WS-RESPONSE)
 11993*                END-EXEC
 11994     MOVE LENGTH OF
 11995      ORIGINAL-CERTIFICATE
 11996       TO DFHEIV11
 11997     MOVE 'ELCRTO' TO DFHEIV1
 11998*    MOVE '&& L                  %  N#00011515' TO DFHEIV0
 11999     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12000     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12001     MOVE X'204E233030303131353135' TO DFHEIV0(25:11)
 12002     CALL 'kxdfhei1' USING DFHEIV0,
 12003           DFHEIV1,
 12004           ORIGINAL-CERTIFICATE,
 12005           DFHEIV11,
 12006           DFHEIV99
 12007     MOVE EIBRESP  TO WS-RESPONSE
 12008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12009                 display ' just rewrote ' ws-response
 12010              END-IF
 12011           END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 220
* EL6311.cbl
 12012        ELSE
 12013           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 12014           MOVE 'OC'             TO OC-RECORD-ID
 12015           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12016           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12017           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12018           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12019           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12020           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12021           MOVE PB-I-AGE         TO OC-INS-AGE
 12022           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12023           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12024           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12025           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12026           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12027           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12028           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12029           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12030           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12031           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12032           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12033           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12034           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 12035           MOVE +0               TO OC-LF-CANCEL-AMT
 12036                                    OC-LF-ITD-CANCEL-AMT
 12037           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12038           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12039           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12040           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12041           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12042           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12043           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12044           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 12045           MOVE +0               TO OC-AH-CANCEL-AMT
 12046                                    OC-AH-ITD-CANCEL-AMT
 12047           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12048           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12049           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 12050           IF ERMAIL-FOUND
 12051              MOVE MA-CRED-BENE-NAME
 12052                                 TO OC-CRED-BENE-NAME
 12053           END-IF
 12054           IF NOT CERT-TRL-REC-NOT-FOUND
 12055              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12056                           OC-INS-AGE-DEFAULT-FLAG
 12057              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12058                           OC-JNT-AGE-DEFAULT-FLAG
 12059           END-IF
 12060           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 12061
 12062* EXEC CICS WRITE
 12063*             DATASET   ('ELCRTO')
 12064*             FROM      (ORIGINAL-CERTIFICATE)
 12065*             RIDFLD    (OC-CONTROL-PRIMARY)
 12066*             RESP      (WS-RESPONSE)
 12067*          END-EXEC
 12068     MOVE LENGTH OF
 12069      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 221
* EL6311.cbl
 12070       TO DFHEIV11
 12071     MOVE 'ELCRTO' TO DFHEIV1
 12072*    MOVE '&$ L                  ''  N#00011572' TO DFHEIV0
 12073     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12074     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12075     MOVE X'204E233030303131353732' TO DFHEIV0(25:11)
 12076     CALL 'kxdfhei1' USING DFHEIV0,
 12077           DFHEIV1,
 12078           ORIGINAL-CERTIFICATE,
 12079           DFHEIV11,
 12080           OC-CONTROL-PRIMARY,
 12081           DFHEIV99,
 12082           DFHEIV99
 12083     MOVE EIBRESP  TO WS-RESPONSE
 12084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12085        END-IF
 12086     ELSE
 12087        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12088        MOVE 'OC'                TO OC-RECORD-ID
 12089        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12090                                 TO OC-CONTROL-PRIMARY (1:33)
 12091        MOVE 'I'                 TO OC-RECORD-TYPE
 12092        MOVE +4096               TO OC-KEY-SEQ-NO
 12093        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12094        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12095        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12096        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12097        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12098        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12099        MOVE PB-I-AGE            TO OC-INS-AGE
 12100        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12101        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12102        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12103        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12104        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12105        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12106        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12107        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12108        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12109        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12110        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12111        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12112        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 12113        MOVE +0                  TO OC-LF-CANCEL-AMT
 12114                                    OC-LF-ITD-CANCEL-AMT
 12115        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12116        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12117        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12118        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12119        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12120        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12121        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12122        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12123        MOVE +0                  TO OC-AH-CANCEL-AMT
 12124                                    OC-AH-ITD-CANCEL-AMT
 12125        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12126        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12127        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 222
* EL6311.cbl
 12128        IF ERMAIL-FOUND
 12129           MOVE MA-CRED-BENE-NAME
 12130                                 TO OC-CRED-BENE-NAME
 12131        END-IF
 12132        IF NOT CERT-TRL-REC-NOT-FOUND
 12133           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12134                           OC-INS-AGE-DEFAULT-FLAG
 12135           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12136                           OC-JNT-AGE-DEFAULT-FLAG
 12137        END-IF
 12138        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12139
 12140* EXEC CICS WRITE
 12141*          DATASET   ('ELCRTO')
 12142*          FROM      (ORIGINAL-CERTIFICATE)
 12143*          RIDFLD    (OC-CONTROL-PRIMARY)
 12144*          RESP      (WS-RESPONSE)
 12145*       END-EXEC
 12146     MOVE LENGTH OF
 12147      ORIGINAL-CERTIFICATE
 12148       TO DFHEIV11
 12149     MOVE 'ELCRTO' TO DFHEIV1
 12150*    MOVE '&$ L                  ''  N#00011632' TO DFHEIV0
 12151     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12152     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12153     MOVE X'204E233030303131363332' TO DFHEIV0(25:11)
 12154     CALL 'kxdfhei1' USING DFHEIV0,
 12155           DFHEIV1,
 12156           ORIGINAL-CERTIFICATE,
 12157           DFHEIV11,
 12158           OC-CONTROL-PRIMARY,
 12159           DFHEIV99,
 12160           DFHEIV99
 12161     MOVE EIBRESP  TO WS-RESPONSE
 12162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12163     END-IF
 12164******************************************************************
 12165*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12166******************************************************************
 12167
 12168     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12169     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12170
 12171
 12172* EXEC CICS READ
 12173*        INTO    (PENDING-BUSINESS)
 12174*        DATASET (FILE-ID-ERPNDB)
 12175*        RIDFLD  (ERPNDB-KEY)
 12176*        UPDATE
 12177*    END-EXEC.
 12178     MOVE LENGTH OF
 12179      PENDING-BUSINESS
 12180       TO DFHEIV11
 12181*    MOVE '&"IL       EU         (   #00011646' TO DFHEIV0
 12182     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12183     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12184     MOVE X'2020233030303131363436' TO DFHEIV0(25:11)
 12185     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 223
* EL6311.cbl
 12186           FILE-ID-ERPNDB,
 12187           PENDING-BUSINESS,
 12188           DFHEIV11,
 12189           ERPNDB-KEY,
 12190           DFHEIV99,
 12191           DFHEIV99,
 12192           DFHEIV99
 12193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12194
 12195
 12196     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12197     MOVE 'B'                    TO JP-RECORD-TYPE.
 12198     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12199
 12200     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12201
 12202     PERFORM 8400-LOG-JOURNAL-RECORD.
 12203
 12204     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 12205
 12206     MOVE 'C'                    TO JP-RECORD-TYPE.
 12207     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12208
 12209
 12210* EXEC CICS REWRITE
 12211*        DATASET    (FILE-ID-ERPNDB)
 12212*        FROM       (PENDING-BUSINESS)
 12213*    END-EXEC.
 12214     MOVE LENGTH OF
 12215      PENDING-BUSINESS
 12216       TO DFHEIV11
 12217*    MOVE '&& L                  %   #00011666' TO DFHEIV0
 12218     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12219     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12220     MOVE X'2020233030303131363636' TO DFHEIV0(25:11)
 12221     CALL 'kxdfhei1' USING DFHEIV0,
 12222           FILE-ID-ERPNDB,
 12223           PENDING-BUSINESS,
 12224           DFHEIV11,
 12225           DFHEIV99
 12226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12227
 12228
 12229     PERFORM 8400-LOG-JOURNAL-RECORD.
 12230
 12231     IF WS-ERRORS-PRESENT
 12232        GO TO 3900-RE-DISPLAY-RECORD.
 12233
 12234     MOVE ZEROS                  TO EMI-ERROR.
 12235     MOVE -1                     TO BMAINTL.
 12236     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12237     GO TO 3900-RE-DISPLAY-RECORD.
 12238
 12239 1380-BATCH-HDR-NOT-FOUND.
 12240     MOVE -1                     TO BMAINTL.
 12241     MOVE ER-7450                TO EMI-ERROR.
 12242     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12243     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 224
* EL6311.cbl
 12244
 12245 1385-REC-NOT-FOUND.
 12246     MOVE -1                     TO BMAINTL.
 12247     MOVE ER-7451                TO EMI-ERROR.
 12248     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12249     GO TO 8200-SEND-DATAONLY.
 12250
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 225
* EL6311.cbl
 12252
 12253 1386-UPDATE-AGE-FLAGS.
 12254
 12255
 12256* EXEC CICS GETMAIN
 12257*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12258*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12259*        INITIMG (GETMAIN-SPACE)
 12260*    END-EXEC
 12261*    MOVE ',"IL                  $   #00011697' TO DFHEIV0
 12262     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12263     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12264     MOVE X'2020233030303131363937' TO DFHEIV0(25:11)
 12265     CALL 'kxdfhei1' USING DFHEIV0,
 12266           DFHEIV20,
 12267           ELCRTT-RECORD-LENGTH,
 12268           GETMAIN-SPACE
 12269     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12270         DFHEIV20
 12271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12272
 12273
 12274* EXEC CICS HANDLE CONDITION
 12275*        NOTFND   (1386-NOTFND)
 12276*    END-EXEC.
 12277*    MOVE '"$I                   ! ( #00011703' TO DFHEIV0
 12278     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12279     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12280     MOVE X'2820233030303131373033' TO DFHEIV0(25:11)
 12281     CALL 'kxdfhei1' USING DFHEIV0
 12282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12283
 12284
 12285     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12286     MOVE 'C'                TO ELCRTT-REC-TYPE
 12287
 12288
 12289* EXEC CICS READ
 12290*        UPDATE
 12291*        DATASET  (CRTT-ID)
 12292*        RIDFLD   (ELCRTT-KEY)
 12293*        INTO     (CERTIFICATE-TRAILERS)
 12294*    END-EXEC.
 12295     MOVE LENGTH OF
 12296      CERTIFICATE-TRAILERS
 12297       TO DFHEIV11
 12298*    MOVE '&"IL       EU         (   #00011710' TO DFHEIV0
 12299     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12300     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12301     MOVE X'2020233030303131373130' TO DFHEIV0(25:11)
 12302     CALL 'kxdfhei1' USING DFHEIV0,
 12303           CRTT-ID,
 12304           CERTIFICATE-TRAILERS,
 12305           DFHEIV11,
 12306           ELCRTT-KEY,
 12307           DFHEIV99,
 12308           DFHEIV99,
 12309           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 226
* EL6311.cbl
 12310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12311
 12312
 12313     IF WS-INS-AGE-SET = 'Y'
 12314        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12315     END-IF
 12316     IF WS-JNT-AGE-SET = 'Y'
 12317        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12318     END-IF
 12319
 12320
 12321* EXEC CICS REWRITE
 12322*       DATASET  (CRTT-ID)
 12323*       FROM     (CERTIFICATE-TRAILERS)
 12324*    END-EXEC.
 12325     MOVE LENGTH OF
 12326      CERTIFICATE-TRAILERS
 12327       TO DFHEIV11
 12328*    MOVE '&& L                  %   #00011724' TO DFHEIV0
 12329     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12330     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12331     MOVE X'2020233030303131373234' TO DFHEIV0(25:11)
 12332     CALL 'kxdfhei1' USING DFHEIV0,
 12333           CRTT-ID,
 12334           CERTIFICATE-TRAILERS,
 12335           DFHEIV11,
 12336           DFHEIV99
 12337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12338
 12339
 12340     GO TO 1386-EXIT.
 12341
 12342 1386-NOTFND.
 12343
 12344     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12345     MOVE 'CS'         TO CS-RECORD-ID.
 12346     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12347     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12348     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12349     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12350     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12351
 12352* EXEC CICS WRITE
 12353*       DATASET  (CRTT-ID)
 12354*       RIDFLD   (ELCRTT-KEY)
 12355*       FROM     (CERTIFICATE-TRAILERS)
 12356*    END-EXEC.
 12357     MOVE LENGTH OF
 12358      CERTIFICATE-TRAILERS
 12359       TO DFHEIV11
 12360*    MOVE '&$ L                  ''   #00011740' TO DFHEIV0
 12361     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12362     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12363     MOVE X'2020233030303131373430' TO DFHEIV0(25:11)
 12364     CALL 'kxdfhei1' USING DFHEIV0,
 12365           CRTT-ID,
 12366           CERTIFICATE-TRAILERS,
 12367           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 227
* EL6311.cbl
 12368           ELCRTT-KEY,
 12369           DFHEIV99,
 12370           DFHEIV99
 12371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12372
 12373
 12374 1386-EXIT.
 12375     EXIT.
 12376
 12377 1390-UPDATE-ERPNDM.
 12378
 12379
 12380* EXEC CICS HANDLE CONDITION
 12381*        NOTFND (1399-EXIT)
 12382*    END-EXEC.
 12383*    MOVE '"$I                   ! ) #00011751' TO DFHEIV0
 12384     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12385     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12386     MOVE X'2920233030303131373531' TO DFHEIV0(25:11)
 12387     CALL 'kxdfhei1' USING DFHEIV0
 12388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12389
 12390
 12391     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12392
 12393
 12394* EXEC CICS READ
 12395*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12396*        DATASET (FILE-ID-ERPNDM)
 12397*        RIDFLD  (ERPNDM-KEY)
 12398*        UPDATE
 12399*    END-EXEC.
 12400*    MOVE '&"S        EU         (   #00011757' TO DFHEIV0
 12401     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12402     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12403     MOVE X'2020233030303131373537' TO DFHEIV0(25:11)
 12404     CALL 'kxdfhei1' USING DFHEIV0,
 12405           FILE-ID-ERPNDM,
 12406           DFHEIV20,
 12407           DFHEIV99,
 12408           ERPNDM-KEY,
 12409           DFHEIV99,
 12410           DFHEIV99,
 12411           DFHEIV99
 12412     SET ADDRESS OF PENDING-MAILING-DATA TO
 12413         DFHEIV20
 12414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12415
 12416
 12417     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12418     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12419     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12420
 12421     IF BLSTNML GREATER THAN ZEROS
 12422         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12423
 12424     IF B1STNML GREATER  THAN ZEROS
 12425         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 228
* EL6311.cbl
 12426
 12427     IF BINITL GREATER THAN ZEROS
 12428         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12429
 12430     IF BAGEL GREATER THAN ZEROS
 12431         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12432
 12433     IF BBIRTHL GREATER THAN ZEROS
 12434         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12435
 12436     IF BSEXL GREATER THAN ZEROS
 12437         MOVE  BSEXI             TO PM-INSURED-SEX.
 12438
 12439
 12440* EXEC CICS REWRITE
 12441*        DATASET (FILE-ID-ERPNDM)
 12442*        FROM    (PENDING-MAILING-DATA)
 12443*    END-EXEC.
 12444     MOVE LENGTH OF
 12445      PENDING-MAILING-DATA
 12446       TO DFHEIV11
 12447*    MOVE '&& L                  %   #00011786' TO DFHEIV0
 12448     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12449     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12450     MOVE X'2020233030303131373836' TO DFHEIV0(25:11)
 12451     CALL 'kxdfhei1' USING DFHEIV0,
 12452           FILE-ID-ERPNDM,
 12453           PENDING-MAILING-DATA,
 12454           DFHEIV11,
 12455           DFHEIV99
 12456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12457
 12458
 12459 1399-EXIT.
 12460     EXIT.
 12461
 12462******************************************************************
 12463*                                                                *
 12464*          D E L E T E   I S S U E   R O U T I N E               *
 12465*                                                                *
 12466******************************************************************
 12467
 12468 1400-DELETE-ISSUE-ROUTINE.
 12469     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12470
 12471     IF BCHGL NOT = ZEROS
 12472        MOVE ER-2196             TO EMI-ERROR
 12473        MOVE AL-UABON            TO BMAINTA
 12474        MOVE -1                  TO BMAINTL
 12475        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12476        GO TO 8200-SEND-DATAONLY.
 12477
 12478
 12479* EXEC CICS HANDLE CONDITION
 12480*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12481*    END-EXEC.
 12482*    MOVE '"$I                   ! * #00011810' TO DFHEIV0
 12483     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 229
* EL6311.cbl
 12484     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12485     MOVE X'2A20233030303131383130' TO DFHEIV0(25:11)
 12486     CALL 'kxdfhei1' USING DFHEIV0
 12487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12488
 12489
 12490     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12491     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12492     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12493
 12494
 12495* EXEC CICS READ
 12496*        SET     (ADDRESS OF PENDING-BUSINESS)
 12497*        DATASET (FILE-ID-ERPNDB)
 12498*        RIDFLD  (ERPNDB-KEY)
 12499*    END-EXEC.
 12500*    MOVE '&"S        E          (   #00011818' TO DFHEIV0
 12501     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12502     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12503     MOVE X'2020233030303131383138' TO DFHEIV0(25:11)
 12504     CALL 'kxdfhei1' USING DFHEIV0,
 12505           FILE-ID-ERPNDB,
 12506           DFHEIV20,
 12507           DFHEIV99,
 12508           ERPNDB-KEY,
 12509           DFHEIV99,
 12510           DFHEIV99,
 12511           DFHEIV99
 12512     SET ADDRESS OF PENDING-BUSINESS TO
 12513         DFHEIV20
 12514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12515
 12516
 12517     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12518
 12519     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12520
 12521     IF BSUFIXL NOT = ZEROS
 12522        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12523     ELSE
 12524        MOVE SPACE               TO WS-NEW-SUFFIX.
 12525
 12526     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12527     PERFORM 8600-DEEDIT.
 12528     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12529     MOVE '4'                    TO DC-OPTION-CODE.
 12530     PERFORM 9700-DATE-LINK.
 12531     IF DATE-CONVERSION-ERROR
 12532        MOVE ER-0348             TO EMI-ERROR
 12533        MOVE -1                  TO BEFFDTL
 12534        MOVE AL-UABON            TO BEFFDTA
 12535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12536        GO TO 8200-SEND-DATAONLY
 12537     ELSE
 12538        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12539        MOVE AL-UANON            TO BEFFDTA
 12540        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12541
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 230
* EL6311.cbl
 12542
 12543* EXEC CICS HANDLE CONDITION
 12544*         NOTFND    (1490-RECORD-NOT-FOUND)
 12545*    END-EXEC.
 12546*    MOVE '"$I                   ! + #00011849' TO DFHEIV0
 12547     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12548     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12549     MOVE X'2B20233030303131383439' TO DFHEIV0(25:11)
 12550     CALL 'kxdfhei1' USING DFHEIV0
 12551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12552
 12553
 12554
 12555* EXEC CICS READ
 12556*        SET     (ADDRESS OF PENDING-BUSINESS)
 12557*        DATASET (FILE-ID-ERPNDB)
 12558*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12559*        UPDATE
 12560*    END-EXEC.
 12561*    MOVE '&"S        EU         (   #00011853' TO DFHEIV0
 12562     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12563     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12564     MOVE X'2020233030303131383533' TO DFHEIV0(25:11)
 12565     CALL 'kxdfhei1' USING DFHEIV0,
 12566           FILE-ID-ERPNDB,
 12567           DFHEIV20,
 12568           DFHEIV99,
 12569           PI-PREV-CONTROL-PRIMARY,
 12570           DFHEIV99,
 12571           DFHEIV99,
 12572           DFHEIV99
 12573     SET ADDRESS OF PENDING-BUSINESS TO
 12574         DFHEIV20
 12575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12576
 12577
 12578     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12579        MOVE -1                 TO BMAINTL
 12580        MOVE ER-2197            TO EMI-ERROR
 12581        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12582        GO TO 8200-SEND-DATAONLY.
 12583
 12584     IF PB-BILLED-DT NOT = LOW-VALUES
 12585        MOVE -1                 TO BMAINTL
 12586        MOVE ER-2129            TO EMI-ERROR
 12587        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12588        GO TO 8200-SEND-DATAONLY.
 12589
 12590     IF PB-CHG-COUNT NOT = ZEROS
 12591        MOVE ER-2336            TO EMI-ERROR
 12592        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12593        MOVE AL-UABON            TO BMAINTA
 12594        MOVE -1                  TO BMAINTL
 12595        GO TO 8200-SEND-DATAONLY.
 12596
 12597     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12598        PB-CHG-COUNT NOT = ZEROS
 12599        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 231
* EL6311.cbl
 12600        MOVE AL-UABON            TO BMAINTA
 12601        MOVE -1                  TO BMAINTL
 12602        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12603        GO TO 8200-SEND-DATAONLY.
 12604******************************************************************
 12605*                                                                *
 12606*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12607*                                                                *
 12608******************************************************************
 12609     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12610     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12611     MOVE +0                     TO ELCRTO-SEQ-NO
 12612
 12613* EXEC CICS READ
 12614*       DATASET   ('ELCRTO')
 12615*       INTO      (ORIGINAL-CERTIFICATE)
 12616*       RIDFLD    (ELCRTO-KEY)
 12617*       GTEQ
 12618*       RESP      (WS-RESPONSE)
 12619*    END-EXEC
 12620     MOVE LENGTH OF
 12621      ORIGINAL-CERTIFICATE
 12622       TO DFHEIV11
 12623     MOVE 'ELCRTO' TO DFHEIV1
 12624*    MOVE '&"IL       G          (  N#00011894' TO DFHEIV0
 12625     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12626     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12627     MOVE X'204E233030303131383934' TO DFHEIV0(25:11)
 12628     CALL 'kxdfhei1' USING DFHEIV0,
 12629           DFHEIV1,
 12630           ORIGINAL-CERTIFICATE,
 12631           DFHEIV11,
 12632           ELCRTO-KEY,
 12633           DFHEIV99,
 12634           DFHEIV99,
 12635           DFHEIV99
 12636     MOVE EIBRESP  TO WS-RESPONSE
 12637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12638     IF RESP-NORMAL
 12639        AND (OC-CONTROL-PRIMARY (1:33) =
 12640                 PB-CONTROL-BY-ACCOUNT (1:33))
 12641        AND (OC-RECORD-TYPE = 'I')
 12642
 12643* EXEC CICS READ
 12644*          DATASET   ('ELCRTO')
 12645*          INTO      (ORIGINAL-CERTIFICATE)
 12646*          RIDFLD    (ELCRTO-KEY)
 12647*          UPDATE
 12648*          RESP      (WS-RESPONSE)
 12649*       END-EXEC
 12650     MOVE LENGTH OF
 12651      ORIGINAL-CERTIFICATE
 12652       TO DFHEIV11
 12653     MOVE 'ELCRTO' TO DFHEIV1
 12654*    MOVE '&"IL       EU         (  N#00011905' TO DFHEIV0
 12655     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12656     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12657     MOVE X'204E233030303131393035' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 232
* EL6311.cbl
 12658     CALL 'kxdfhei1' USING DFHEIV0,
 12659           DFHEIV1,
 12660           ORIGINAL-CERTIFICATE,
 12661           DFHEIV11,
 12662           ELCRTO-KEY,
 12663           DFHEIV99,
 12664           DFHEIV99,
 12665           DFHEIV99
 12666     MOVE EIBRESP  TO WS-RESPONSE
 12667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12668        IF RESP-NORMAL
 12669
 12670* EXEC CICS DELETE
 12671*             DATASET   ('ELCRTO')
 12672*          END-EXEC
 12673     MOVE 'ELCRTO' TO DFHEIV1
 12674*    MOVE '&(                    &   #00011913' TO DFHEIV0
 12675     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12676     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12677     MOVE X'2020233030303131393133' TO DFHEIV0(25:11)
 12678     CALL 'kxdfhei1' USING DFHEIV0,
 12679           DFHEIV1,
 12680           DFHEIV99,
 12681           DFHEIV99,
 12682           DFHEIV99,
 12683           DFHEIV99
 12684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12685        END-IF
 12686     END-IF
 12687******************************************************************
 12688*                                                                *
 12689*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12690*                                                                *
 12691******************************************************************
 12692
 12693* EXEC CICS HANDLE CONDITION
 12694*        NOTFND    (1405-DELETE-CERTIFICATE)
 12695*    END-EXEC.
 12696*    MOVE '"$I                   ! , #00011923' TO DFHEIV0
 12697     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12698     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12699     MOVE X'2C20233030303131393233' TO DFHEIV0(25:11)
 12700     CALL 'kxdfhei1' USING DFHEIV0
 12701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12702
 12703
 12704
 12705* EXEC CICS READ
 12706*        EQUAL
 12707*        DATASET   (FILE-ID-ERPNDM)
 12708*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12709*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12710*        UPDATE
 12711*    END-EXEC.
 12712*    MOVE '&"S        EU         (   #00011927' TO DFHEIV0
 12713     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12714     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12715     MOVE X'2020233030303131393237' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 233
* EL6311.cbl
 12716     CALL 'kxdfhei1' USING DFHEIV0,
 12717           FILE-ID-ERPNDM,
 12718           DFHEIV20,
 12719           DFHEIV99,
 12720           PI-PREV-CONTROL-PRIMARY,
 12721           DFHEIV99,
 12722           DFHEIV99,
 12723           DFHEIV99
 12724     SET ADDRESS OF PENDING-MAILING-DATA TO
 12725         DFHEIV20
 12726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12727
 12728
 12729     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12730     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12731     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12732
 12733     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12734
 12735
 12736* EXEC CICS DELETE
 12737*        DATASET   (FILE-ID-ERPNDM)
 12738*    END-EXEC.
 12739*    MOVE '&(                    &   #00011941' TO DFHEIV0
 12740     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12741     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12742     MOVE X'2020233030303131393431' TO DFHEIV0(25:11)
 12743     CALL 'kxdfhei1' USING DFHEIV0,
 12744           FILE-ID-ERPNDM,
 12745           DFHEIV99,
 12746           DFHEIV99,
 12747           DFHEIV99,
 12748           DFHEIV99
 12749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12750
 12751
 12752******************************************************************
 12753*                PROCESS   CERTIFICATE                           *
 12754******************************************************************
 12755
 12756 1405-DELETE-CERTIFICATE.
 12757
 12758* EXEC CICS HANDLE CONDITION
 12759*         NOTFND  (1420-CONTINUE-DELETE)
 12760*    END-EXEC.
 12761*    MOVE '"$I                   ! - #00011950' TO DFHEIV0
 12762     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12763     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12764     MOVE X'2D20233030303131393530' TO DFHEIV0(25:11)
 12765     CALL 'kxdfhei1' USING DFHEIV0
 12766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12767
 12768
 12769     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12770     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12771     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12772     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12773
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 234
* EL6311.cbl
 12774
 12775* EXEC CICS READ
 12776*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12777*        DATASET (FILE-ID-ELCERT)
 12778*        RIDFLD  (ELCERT-KEY)
 12779*        UPDATE
 12780*    END-EXEC.
 12781*    MOVE '&"S        EU         (   #00011959' TO DFHEIV0
 12782     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12783     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12784     MOVE X'2020233030303131393539' TO DFHEIV0(25:11)
 12785     CALL 'kxdfhei1' USING DFHEIV0,
 12786           FILE-ID-ELCERT,
 12787           DFHEIV20,
 12788           DFHEIV99,
 12789           ELCERT-KEY,
 12790           DFHEIV99,
 12791           DFHEIV99,
 12792           DFHEIV99
 12793     SET ADDRESS OF CERTIFICATE-MASTER TO
 12794         DFHEIV20
 12795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12796
 12797
 12798     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12799
 12800     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12801     MOVE 'B'                    TO JP-RECORD-TYPE
 12802     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12803
 12804     PERFORM 8400-LOG-JOURNAL-RECORD.
 12805
 12806     IF CERT-NOTES-ARE-NOT-PRESENT
 12807        MOVE ' '                 TO WS-CERT-NOTE-SW
 12808     ELSE
 12809        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12810
 12811     IF INSURED-ADDR-PRESENT
 12812        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12813
 12814******************************************************************
 12815******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12816******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12817******************************************************************
 12818******************************************************************
 12819
 12820     IF CERT-ADDED-BATCH AND
 12821        (NOT NO-CLAIM-ATTACHED
 12822         OR
 12823         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12824        GO TO 1410-REWRITE-CERT.
 12825
 12826******************************************************************
 12827******************************************************************
 12828
 12829     IF CERT-ADDED-BATCH  AND
 12830        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12831        GO TO 1410-REWRITE-CERT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 235
* EL6311.cbl
 12832
 12833     IF NO-CLAIM-ATTACHED
 12834        NEXT SENTENCE
 12835     ELSE
 12836        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12837        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12838        GO TO 1410-REWRITE-CERT.
 12839
 12840     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12841     MOVE 'D'                      TO JP-RECORD-TYPE.
 12842     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12843
 12844
 12845* EXEC CICS DELETE
 12846*         DATASET    (FILE-ID-ELCERT)
 12847*    END-EXEC.
 12848*    MOVE '&(                    &   #00012012' TO DFHEIV0
 12849     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12850     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12851     MOVE X'2020233030303132303132' TO DFHEIV0(25:11)
 12852     CALL 'kxdfhei1' USING DFHEIV0,
 12853           FILE-ID-ELCERT,
 12854           DFHEIV99,
 12855           DFHEIV99,
 12856           DFHEIV99,
 12857           DFHEIV99
 12858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12859
 12860
 12861     PERFORM 8400-LOG-JOURNAL-RECORD.
 12862
 12863******************************************************************
 12864*                                                                *
 12865*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12866*                                                                *
 12867******************************************************************
 12868
 12869     IF  CERT-NOTES-ARE-PRESENT
 12870         NEXT SENTENCE
 12871     ELSE
 12872         GO TO 1407-DELETE-MAILING.
 12873
 12874
 12875* EXEC CICS HANDLE CONDITION
 12876*         NOTFND  (1406-DELETE-ERNOTE)
 12877*    END-EXEC.
 12878*    MOVE '"$I                   ! . #00012029' TO DFHEIV0
 12879     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12881     MOVE X'2E20233030303132303239' TO DFHEIV0(25:11)
 12882     CALL 'kxdfhei1' USING DFHEIV0
 12883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12884
 12885
 12886     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12887     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12888     MOVE 0                     TO ERCNOT-SEQUENCE.
 12889
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 236
* EL6311.cbl
 12890 1406-DELETE-ERCNOT-LOOP.
 12891
 12892
 12893* EXEC CICS READ
 12894*        GTEQ
 12895*        DATASET   (FILE-ID-ERCNOT)
 12896*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12897*        RIDFLD    (ERCNOT-KEY)
 12898*    END-EXEC.
 12899*    MOVE '&"S        G          (   #00012039' TO DFHEIV0
 12900     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12901     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12902     MOVE X'2020233030303132303339' TO DFHEIV0(25:11)
 12903     CALL 'kxdfhei1' USING DFHEIV0,
 12904           FILE-ID-ERCNOT,
 12905           DFHEIV20,
 12906           DFHEIV99,
 12907           ERCNOT-KEY,
 12908           DFHEIV99,
 12909           DFHEIV99,
 12910           DFHEIV99
 12911     SET ADDRESS OF CERT-NOTE-FILE TO
 12912         DFHEIV20
 12913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12914
 12915
 12916     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12917     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12918         GO TO 1406-DELETE-ERNOTE
 12919     END-IF.
 12920
 12921     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12922     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12923     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12924
 12925     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12926
 12927
 12928* EXEC CICS DELETE
 12929*        DATASET   (FILE-ID-ERCNOT)
 12930*        RIDFLD    (ERCNOT-KEY)
 12931*        END-EXEC.
 12932*    MOVE '&(  R                 &   #00012057' TO DFHEIV0
 12933     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12934     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12935     MOVE X'2020233030303132303537' TO DFHEIV0(25:11)
 12936     CALL 'kxdfhei1' USING DFHEIV0,
 12937           FILE-ID-ERCNOT,
 12938           ERCNOT-KEY,
 12939           DFHEIV99,
 12940           DFHEIV99,
 12941           DFHEIV99
 12942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12943
 12944
 12945     PERFORM 8400-LOG-JOURNAL-RECORD.
 12946
 12947     GO TO 1406-DELETE-ERCNOT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 237
* EL6311.cbl
 12948
 12949 1406-DELETE-ERNOTE.
 12950
 12951
 12952* EXEC CICS HANDLE CONDITION
 12953*         NOTFND  (1407-DELETE-MAILING)
 12954*    END-EXEC.
 12955*    MOVE '"$I                   ! / #00012068' TO DFHEIV0
 12956     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12957     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12958     MOVE X'2F20233030303132303638' TO DFHEIV0(25:11)
 12959     CALL 'kxdfhei1' USING DFHEIV0
 12960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12961
 12962
 12963
 12964* EXEC CICS READ
 12965*        EQUAL
 12966*        DATASET   (FILE-ID-ERNOTE)
 12967*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12968*        RIDFLD    (ELCERT-KEY)
 12969*        UPDATE
 12970*    END-EXEC.
 12971*    MOVE '&"S        EU         (   #00012072' TO DFHEIV0
 12972     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12973     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12974     MOVE X'2020233030303132303732' TO DFHEIV0(25:11)
 12975     CALL 'kxdfhei1' USING DFHEIV0,
 12976           FILE-ID-ERNOTE,
 12977           DFHEIV20,
 12978           DFHEIV99,
 12979           ELCERT-KEY,
 12980           DFHEIV99,
 12981           DFHEIV99,
 12982           DFHEIV99
 12983     SET ADDRESS OF CERTIFICATE-NOTE TO
 12984         DFHEIV20
 12985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12986
 12987
 12988     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12989     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12990     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12991
 12992     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12993
 12994
 12995* EXEC CICS DELETE
 12996*        DATASET   (FILE-ID-ERNOTE)
 12997*        END-EXEC.
 12998*    MOVE '&(                    &   #00012086' TO DFHEIV0
 12999     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13000     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13001     MOVE X'2020233030303132303836' TO DFHEIV0(25:11)
 13002     CALL 'kxdfhei1' USING DFHEIV0,
 13003           FILE-ID-ERNOTE,
 13004           DFHEIV99,
 13005           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 238
* EL6311.cbl
 13006           DFHEIV99,
 13007           DFHEIV99
 13008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13009
 13010
 13011     PERFORM 8400-LOG-JOURNAL-RECORD.
 13012
 13013******************************************************************
 13014*                                                                *
 13015*                DELETE MAILING ADDRESS RECORDS                  *
 13016*                                                                *
 13017******************************************************************
 13018
 13019 1407-DELETE-MAILING.
 13020     IF CERT-ADDRESS-PRESENT
 13021        NEXT SENTENCE
 13022     ELSE
 13023        GO TO 1420-CONTINUE-DELETE.
 13024
 13025
 13026* EXEC CICS HANDLE CONDITION
 13027*         NOTFND  (1420-CONTINUE-DELETE)
 13028*    END-EXEC.
 13029*    MOVE '"$I                   ! 0 #00012104' TO DFHEIV0
 13030     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13031     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13032     MOVE X'3020233030303132313034' TO DFHEIV0(25:11)
 13033     CALL 'kxdfhei1' USING DFHEIV0
 13034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13035
 13036
 13037
 13038* EXEC CICS READ
 13039*        EQUAL
 13040*        DATASET   (FILE-ID-ERMAIL)
 13041*        SET       (ADDRESS OF MAILING-DATA)
 13042*        RIDFLD    (ELCERT-KEY)
 13043*        UPDATE
 13044*    END-EXEC.
 13045*    MOVE '&"S        EU         (   #00012108' TO DFHEIV0
 13046     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13047     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13048     MOVE X'2020233030303132313038' TO DFHEIV0(25:11)
 13049     CALL 'kxdfhei1' USING DFHEIV0,
 13050           FILE-ID-ERMAIL,
 13051           DFHEIV20,
 13052           DFHEIV99,
 13053           ELCERT-KEY,
 13054           DFHEIV99,
 13055           DFHEIV99,
 13056           DFHEIV99
 13057     SET ADDRESS OF MAILING-DATA TO
 13058         DFHEIV20
 13059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13060
 13061
 13062     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13063     MOVE 'D'                    TO  JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 239
* EL6311.cbl
 13064     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13065
 13066     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13067
 13068
 13069* EXEC CICS DELETE
 13070*        DATASET   (FILE-ID-ERMAIL)
 13071*    END-EXEC.
 13072*    MOVE '&(                    &   #00012122' TO DFHEIV0
 13073     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13074     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13075     MOVE X'2020233030303132313232' TO DFHEIV0(25:11)
 13076     CALL 'kxdfhei1' USING DFHEIV0,
 13077           FILE-ID-ERMAIL,
 13078           DFHEIV99,
 13079           DFHEIV99,
 13080           DFHEIV99,
 13081           DFHEIV99
 13082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13083
 13084
 13085     GO TO 1420-CONTINUE-DELETE.
 13086
 13087 1410-REWRITE-CERT.
 13088     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13089     MOVE 'C'                      TO JP-RECORD-TYPE.
 13090     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13091     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13092
 13093
 13094* EXEC CICS REWRITE
 13095*         DATASET    (FILE-ID-ELCERT)
 13096*         FROM       (CERTIFICATE-MASTER)
 13097*         END-EXEC.
 13098     MOVE LENGTH OF
 13099      CERTIFICATE-MASTER
 13100       TO DFHEIV11
 13101*    MOVE '&& L                  %   #00012134' TO DFHEIV0
 13102     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13103     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13104     MOVE X'2020233030303132313334' TO DFHEIV0(25:11)
 13105     CALL 'kxdfhei1' USING DFHEIV0,
 13106           FILE-ID-ELCERT,
 13107           CERTIFICATE-MASTER,
 13108           DFHEIV11,
 13109           DFHEIV99
 13110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13111
 13112
 13113     PERFORM 8400-LOG-JOURNAL-RECORD.
 13114
 13115 1420-CONTINUE-DELETE.
 13116     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 13117     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13118
 13119     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13120     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13121
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 240
* EL6311.cbl
 13122     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13123
 13124 1450-DELETE-PB-RECORD.
 13125     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13126     MOVE 'D'                      TO JP-RECORD-TYPE
 13127     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13128
 13129
 13130* EXEC CICS DELETE
 13131*        DATASET    (FILE-ID-ERPNDB)
 13132*    END-EXEC.
 13133*    MOVE '&(                    &   #00012155' TO DFHEIV0
 13134     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13135     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13136     MOVE X'2020233030303132313535' TO DFHEIV0(25:11)
 13137     CALL 'kxdfhei1' USING DFHEIV0,
 13138           FILE-ID-ERPNDB,
 13139           DFHEIV99,
 13140           DFHEIV99,
 13141           DFHEIV99,
 13142           DFHEIV99
 13143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13144
 13145
 13146     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13147
 13148     PERFORM 8400-LOG-JOURNAL-RECORD.
 13149
 13150     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13151     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13152     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13153
 13154
 13155* EXEC CICS HANDLE CONDITION
 13156*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13157*    END-EXEC.
 13158*    MOVE '"$I                   ! 1 #00012167' TO DFHEIV0
 13159     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13160     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13161     MOVE X'3120233030303132313637' TO DFHEIV0(25:11)
 13162     CALL 'kxdfhei1' USING DFHEIV0
 13163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13164
 13165
 13166
 13167* EXEC CICS READ
 13168*        SET     (ADDRESS OF PENDING-BUSINESS)
 13169*        DATASET (FILE-ID-ERPNDB)
 13170*        RIDFLD  (ERPNDB-KEY)
 13171*        UPDATE
 13172*    END-EXEC.
 13173*    MOVE '&"S        EU         (   #00012171' TO DFHEIV0
 13174     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13175     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13176     MOVE X'2020233030303132313731' TO DFHEIV0(25:11)
 13177     CALL 'kxdfhei1' USING DFHEIV0,
 13178           FILE-ID-ERPNDB,
 13179           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 241
* EL6311.cbl
 13180           DFHEIV99,
 13181           ERPNDB-KEY,
 13182           DFHEIV99,
 13183           DFHEIV99,
 13184           DFHEIV99
 13185     SET ADDRESS OF PENDING-BUSINESS TO
 13186         DFHEIV20
 13187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13188
 13189
 13190     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13191
 13192     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13193
 13194     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13195        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13196        MOVE 'D'                   TO JP-RECORD-TYPE
 13197        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13198
 13199* EXEC CICS DELETE
 13200*            DATASET    (FILE-ID-ERPNDB)
 13201*       END-EXEC
 13202*    MOVE '&(                    &   #00012186' TO DFHEIV0
 13203     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13204     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13205     MOVE X'2020233030303132313836' TO DFHEIV0(25:11)
 13206     CALL 'kxdfhei1' USING DFHEIV0,
 13207           FILE-ID-ERPNDB,
 13208           DFHEIV99,
 13209           DFHEIV99,
 13210           DFHEIV99,
 13211           DFHEIV99
 13212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13213        PERFORM 8400-LOG-JOURNAL-RECORD
 13214     ELSE
 13215        MOVE 'B'                 TO JP-RECORD-TYPE
 13216        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13217        PERFORM 8400-LOG-JOURNAL-RECORD
 13218        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13219        MOVE 'C'                 TO JP-RECORD-TYPE
 13220        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13221
 13222* EXEC CICS REWRITE
 13223*            DATASET    (FILE-ID-ERPNDB)
 13224*            FROM       (PENDING-BUSINESS)
 13225*       END-EXEC
 13226     MOVE LENGTH OF
 13227      PENDING-BUSINESS
 13228       TO DFHEIV11
 13229*    MOVE '&& L                  %   #00012197' TO DFHEIV0
 13230     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13231     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13232     MOVE X'2020233030303132313937' TO DFHEIV0(25:11)
 13233     CALL 'kxdfhei1' USING DFHEIV0,
 13234           FILE-ID-ERPNDB,
 13235           PENDING-BUSINESS,
 13236           DFHEIV11,
 13237           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 242
* EL6311.cbl
 13238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13239        PERFORM 8400-LOG-JOURNAL-RECORD.
 13240
 13241******************************************************************
 13242*                                                                *
 13243*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13244*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13245*                                                                *
 13246******************************************************************
 13247
 13248     IF NOT PI-AR-PROCESSING
 13249        GO TO 1475-DELETE-FINISHED.
 13250
 13251     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13252        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13253        NEXT SENTENCE
 13254     ELSE
 13255        GO TO 1475-DELETE-FINISHED.
 13256
 13257
 13258* EXEC CICS HANDLE CONDITION
 13259*         NOTFND    (1475-DELETE-FINISHED)
 13260*         END-EXEC.
 13261*    MOVE '"$I                   ! 2 #00012219' TO DFHEIV0
 13262     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13263     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13264     MOVE X'3220233030303132323139' TO DFHEIV0(25:11)
 13265     CALL 'kxdfhei1' USING DFHEIV0
 13266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13267
 13268
 13269     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13270     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13271
 13272
 13273* EXEC CICS READ
 13274*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13275*        DATASET (FILE-ID-ERRQST)
 13276*        RIDFLD  (ERRQST-KEY)
 13277*        UPDATE
 13278*    END-EXEC.
 13279*    MOVE '&"S        EU         (   #00012226' TO DFHEIV0
 13280     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13281     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13282     MOVE X'2020233030303132323236' TO DFHEIV0(25:11)
 13283     CALL 'kxdfhei1' USING DFHEIV0,
 13284           FILE-ID-ERRQST,
 13285           DFHEIV20,
 13286           DFHEIV99,
 13287           ERRQST-KEY,
 13288           DFHEIV99,
 13289           DFHEIV99,
 13290           DFHEIV99
 13291     SET ADDRESS OF AR-REQUEST-RECORD TO
 13292         DFHEIV20
 13293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13294
 13295
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 243
* EL6311.cbl
 13296     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13297
 13298     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13299
 13300     MOVE 'D'                      TO JP-RECORD-TYPE.
 13301     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13302
 13303
 13304* EXEC CICS DELETE
 13305*         DATASET    (FILE-ID-ERRQST)
 13306*    END-EXEC.
 13307*    MOVE '&(                    &   #00012240' TO DFHEIV0
 13308     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13309     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13310     MOVE X'2020233030303132323430' TO DFHEIV0(25:11)
 13311     CALL 'kxdfhei1' USING DFHEIV0,
 13312           FILE-ID-ERRQST,
 13313           DFHEIV99,
 13314           DFHEIV99,
 13315           DFHEIV99,
 13316           DFHEIV99
 13317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13318
 13319
 13320     PERFORM 8400-LOG-JOURNAL-RECORD.
 13321
 13322 1475-DELETE-FINISHED.
 13323     MOVE ZEROS                  TO EMI-ERROR.
 13324     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13325     MOVE LOW-VALUES             TO EL631BI.
 13326     MOVE -1                     TO BMAINTL.
 13327     GO TO 8100-SEND-INITIAL-MAP.
 13328
 13329 1480-BATCH-HDR-NOT-FOUND.
 13330     MOVE -1                     TO BMAINTL.
 13331     MOVE ER-7450                TO EMI-ERROR.
 13332     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13333     GO TO 8200-SEND-DATAONLY.
 13334
 13335 1490-RECORD-NOT-FOUND.
 13336     MOVE -1                     TO BMAINTL.
 13337     MOVE ER-7451                TO EMI-ERROR.
 13338     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13339     GO TO 8200-SEND-DATAONLY.
 13340
 13341******************************************************************
 13342*            O V E R   C H A R G E   P R O C E S S I N G         *
 13343******************************************************************
 13344 1500-UPDATE-ERNOTE.
 13345     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13346     MOVE 'A'                    TO WS-NOTE-SW
 13347     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13348     .
 13349 1500-EXIT.
 13350     EXIT.
 13351 1510-ADD-ERNOTE-REC.
 13352
 13353* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 244
* EL6311.cbl
 13354*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13355*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13356*        INITIMG (GETMAIN-SPACE)
 13357*    END-EXEC
 13358*    MOVE ',"IL                  $   #00012276' TO DFHEIV0
 13359     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13360     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13361     MOVE X'2020233030303132323736' TO DFHEIV0(25:11)
 13362     CALL 'kxdfhei1' USING DFHEIV0,
 13363           DFHEIV20,
 13364           ERNOTE-RECORD-LENGTH,
 13365           GETMAIN-SPACE
 13366     SET ADDRESS OF CERTIFICATE-NOTE TO
 13367         DFHEIV20
 13368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13369     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13370                                 TO ERNOTE-KEY
 13371
 13372* EXEC CICS READ
 13373*       DATASET    (FILE-ID-ERNOTE)
 13374*       RIDFLD     (ERNOTE-KEY)
 13375*       INTO       (CERTIFICATE-NOTE)
 13376*       RESP       (WS-RESPONSE)
 13377*       UPDATE
 13378*    END-EXEC
 13379     MOVE LENGTH OF
 13380      CERTIFICATE-NOTE
 13381       TO DFHEIV11
 13382*    MOVE '&"IL       EU         (  N#00012283' TO DFHEIV0
 13383     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13384     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13385     MOVE X'204E233030303132323833' TO DFHEIV0(25:11)
 13386     CALL 'kxdfhei1' USING DFHEIV0,
 13387           FILE-ID-ERNOTE,
 13388           CERTIFICATE-NOTE,
 13389           DFHEIV11,
 13390           ERNOTE-KEY,
 13391           DFHEIV99,
 13392           DFHEIV99,
 13393           DFHEIV99
 13394     MOVE EIBRESP  TO WS-RESPONSE
 13395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13396     IF RESP-NORMAL
 13397        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13398           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13399        END-IF
 13400        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13401           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13402        END-IF
 13403        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13404           (N1 > +10)
 13405           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13406           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13407        END-PERFORM
 13408        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13409          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13410
 13411* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 245
* EL6311.cbl
 13412*            DATASET    (FILE-ID-ERNOTE)
 13413*          END-EXEC
 13414*    MOVE '&*                    #   #00012304' TO DFHEIV0
 13415     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13416     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13417     MOVE X'2020233030303132333034' TO DFHEIV0(25:11)
 13418     CALL 'kxdfhei1' USING DFHEIV0,
 13419           FILE-ID-ERNOTE,
 13420           DFHEIV99
 13421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13422        ELSE
 13423          PERFORM VARYING N1 FROM +1 BY +1
 13424           UNTIL (N1 > +10)
 13425           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13426          END-PERFORM
 13427          IF (N1 < +11)
 13428            IF N1 >= CN-BILLING-START-LINE-NO AND
 13429              N1 <= CN-BILLING-END-LINE-NO
 13430              IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13431                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13432              ELSE
 13433                 MOVE WS-VA-NO-COMM-MESS
 13434                                    TO CN-LINE (N1)
 13435              END-IF
 13436            ELSE
 13437              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13438               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13439                IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13440                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13441                ELSE
 13442                  MOVE WS-VA-NO-COMM-MESS
 13443                                    TO CN-LINE (N1)
 13444                END-IF
 13445                MOVE N1             TO CN-BILLING-END-LINE-NO
 13446              ELSE
 13447                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13448                  IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13449                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13450                  ELSE
 13451                     MOVE WS-VA-NO-COMM-MESS
 13452                                    TO CN-LINE (N1)
 13453                  END-IF
 13454                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13455                                      CN-BILLING-START-LINE-NO
 13456                ELSE
 13457                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13458                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13459                     IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13460                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13461                     ELSE
 13462                       MOVE WS-VA-NO-COMM-MESS
 13463                                    TO CN-LINE (N1)
 13464                     END-IF
 13465                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13466                  ELSE
 13467                     PERFORM 1700-SQUEEZE-IT-IN
 13468                                 THRU 1700-EXIT
 13469                  END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 246
* EL6311.cbl
 13470                END-IF
 13471              END-IF
 13472            END-IF
 13473            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13474            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13475            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13476
 13477* EXEC CICS REWRITE
 13478*              DATASET    (FILE-ID-ERNOTE)
 13479*              FROM       (CERTIFICATE-NOTE)
 13480*              RESP       (WS-RESPONSE)
 13481*           END-EXEC
 13482     MOVE LENGTH OF
 13483      CERTIFICATE-NOTE
 13484       TO DFHEIV11
 13485*    MOVE '&& L                  %  N#00012361' TO DFHEIV0
 13486     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13487     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13488     MOVE X'204E233030303132333631' TO DFHEIV0(25:11)
 13489     CALL 'kxdfhei1' USING DFHEIV0,
 13490           FILE-ID-ERNOTE,
 13491           CERTIFICATE-NOTE,
 13492           DFHEIV11,
 13493           DFHEIV99
 13494     MOVE EIBRESP  TO WS-RESPONSE
 13495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13496          END-IF
 13497        END-IF
 13498     ELSE
 13499        MOVE SPACES              TO CERTIFICATE-NOTE
 13500        MOVE 'CN'                TO CN-RECORD-ID
 13501        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13502                                 TO CN-CONTROL-PRIMARY
 13503                                    ERNOTE-KEY
 13504        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13505                                    CN-BILLING-END-LINE-NO
 13506        IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13507           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13508        ELSE
 13509           MOVE WS-VA-NO-COMM-MESS
 13510                                 TO CN-LINE (1)
 13511        END-IF
 13512        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13513        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13514        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13515
 13516* EXEC CICS WRITE
 13517*          DATASET    (FILE-ID-ERNOTE)
 13518*          FROM       (CERTIFICATE-NOTE)
 13519*          RIDFLD     (ERNOTE-KEY)
 13520*          RESP       (WS-RESPONSE)
 13521*       END-EXEC
 13522     MOVE LENGTH OF
 13523      CERTIFICATE-NOTE
 13524       TO DFHEIV11
 13525*    MOVE '&$ L                  ''  N#00012385' TO DFHEIV0
 13526     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13527     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 247
* EL6311.cbl
 13528     MOVE X'204E233030303132333835' TO DFHEIV0(25:11)
 13529     CALL 'kxdfhei1' USING DFHEIV0,
 13530           FILE-ID-ERNOTE,
 13531           CERTIFICATE-NOTE,
 13532           DFHEIV11,
 13533           ERNOTE-KEY,
 13534           DFHEIV99,
 13535           DFHEIV99
 13536     MOVE EIBRESP  TO WS-RESPONSE
 13537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13538     END-IF
 13539     .
 13540 1510-EXIT.
 13541     EXIT.
 13542 1520-UPDATE-ELCERT.
 13543     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13544                                 TO ELCERT-KEY
 13545
 13546* EXEC CICS READ
 13547*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13548*        DATASET (FILE-ID-ELCERT)
 13549*        RIDFLD  (ELCERT-KEY)
 13550*        UPDATE
 13551*        RESP    (WS-RESPONSE)
 13552*    END-EXEC
 13553*    MOVE '&"S        EU         (  N#00012398' TO DFHEIV0
 13554     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13555     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13556     MOVE X'204E233030303132333938' TO DFHEIV0(25:11)
 13557     CALL 'kxdfhei1' USING DFHEIV0,
 13558           FILE-ID-ELCERT,
 13559           DFHEIV20,
 13560           DFHEIV99,
 13561           ELCERT-KEY,
 13562           DFHEIV99,
 13563           DFHEIV99,
 13564           DFHEIV99
 13565     SET ADDRESS OF CERTIFICATE-MASTER TO
 13566         DFHEIV20
 13567     MOVE EIBRESP  TO WS-RESPONSE
 13568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13569     IF RESP-NORMAL
 13570        IF WS-NOTE-SW = 'A'
 13571           IF CM-NOTE-SW = ' '
 13572              MOVE '2'             TO CM-NOTE-SW
 13573           ELSE
 13574             IF CM-NOTE-SW = '1'
 13575                MOVE '3'           TO CM-NOTE-SW
 13576             ELSE
 13577               IF CM-NOTE-SW = '4'
 13578                  MOVE '6'         TO CM-NOTE-SW
 13579               ELSE
 13580                 IF CM-NOTE-SW = '5'
 13581                    MOVE '7'       TO CM-NOTE-SW
 13582                 END-IF
 13583               END-IF
 13584             END-IF
 13585           END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 248
* EL6311.cbl
 13586        ELSE
 13587           IF CM-NOTE-SW = '2'
 13588              MOVE ' '             TO CM-NOTE-SW
 13589           ELSE
 13590             IF CM-NOTE-SW = '3'
 13591                MOVE '1'           TO CM-NOTE-SW
 13592             ELSE
 13593               IF CM-NOTE-SW = '6'
 13594                  MOVE '4'         TO CM-NOTE-SW
 13595               ELSE
 13596                 IF CM-NOTE-SW = '7'
 13597                    MOVE '5'       TO CM-NOTE-SW
 13598                 END-IF
 13599               END-IF
 13600             END-IF
 13601           END-IF
 13602        END-IF
 13603
 13604* EXEC CICS REWRITE
 13605*          DATASET    (FILE-ID-ELCERT)
 13606*          FROM       (CERTIFICATE-MASTER)
 13607*          RESP       (WS-RESPONSE)
 13608*       END-EXEC
 13609     MOVE LENGTH OF
 13610      CERTIFICATE-MASTER
 13611       TO DFHEIV11
 13612*    MOVE '&& L                  %  N#00012439' TO DFHEIV0
 13613     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13614     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13615     MOVE X'204E233030303132343339' TO DFHEIV0(25:11)
 13616     CALL 'kxdfhei1' USING DFHEIV0,
 13617           FILE-ID-ELCERT,
 13618           CERTIFICATE-MASTER,
 13619           DFHEIV11,
 13620           DFHEIV99
 13621     MOVE EIBRESP  TO WS-RESPONSE
 13622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13623        IF RESP-NORMAL
 13624           CONTINUE
 13625        ELSE
 13626           MOVE WS-RESPONSE TO EMI-ERROR
 13627           PERFORM 9900-ERROR-FORMAT
 13628                                 THRU 9900-EXIT
 13629           GO TO 8200-SEND-DATAONLY
 13630        END-IF
 13631     ELSE
 13632        MOVE -1                  TO BMAINTL
 13633        MOVE 0249                TO EMI-ERROR
 13634        PERFORM 9900-ERROR-FORMAT
 13635                                 THRU 9900-EXIT
 13636        GO TO 8200-SEND-DATAONLY
 13637     END-IF
 13638     .
 13639 1520-EXIT.
 13640     EXIT.
 13641 1600-UPDATE-ERPYAJ.
 13642     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13643                                 THRU 1610-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 249
* EL6311.cbl
 13644     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13645                                 THRU 1620-EXIT
 13646     .
 13647 1600-EXIT.
 13648     EXIT.
 13649 1610-ADD-ERPYAJ-BANK-REC.
 13650
 13651* EXEC CICS GETMAIN
 13652*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13653*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13654*        INITIMG (GETMAIN-SPACE)
 13655*    END-EXEC
 13656*    MOVE ',"IL                  $   #00012471' TO DFHEIV0
 13657     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13658     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13659     MOVE X'2020233030303132343731' TO DFHEIV0(25:11)
 13660     CALL 'kxdfhei1' USING DFHEIV0,
 13661           DFHEIV20,
 13662           ERPYAJ-RECORD-LENGTH,
 13663           GETMAIN-SPACE
 13664     SET ADDRESS OF PENDING-PAY-ADJ TO
 13665         DFHEIV20
 13666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13667     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13668     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13669     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13670     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13671     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13672     MOVE +10                    TO ERPYAJ-SEQ-NO
 13673     MOVE 'R'                    TO ERPYAJ-TYPE
 13674     IF REVERSAL
 13675        MOVE 'C'                 TO ERPYAJ-TYPE
 13676     END-IF
 13677     MOVE SPACES                 TO PENDING-PAY-ADJ
 13678     MOVE 'PY'                   TO PY-RECORD-ID
 13679     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13680     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13681     IF REVERSAL
 13682        MOVE PB-I-DCC-OVER-CHG-AMT
 13683                                 TO PY-ENTRY-AMT
 13684     END-IF
 13685     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13686                                    PY-INPUT-DT
 13687*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13688*                                   PY-INPUT-DT
 13689     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13690     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13691     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13692     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13693     IF PB-CARRIER = '2'
 13694        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13695     ELSE
 13696        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13697     END-IF
 13698     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13699                                    PY-BILLED-DATE
 13700                                    PY-AR-DATE
 13701                                    PY-REPORTED-DT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 250
* EL6311.cbl
 13702                                    PY-CHECK-WRITTEN-DT
 13703     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13704                                    PY-CHECK-QUE-SEQUENCE
 13705     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13706     PERFORM WITH TEST AFTER
 13707        UNTIL (NOT RESP-DUPKEY)
 13708           AND (NOT RESP-DUPREC)
 13709
 13710* EXEC CICS WRITE
 13711*          DATASET    (FILE-ID-ERPYAJ)
 13712*          FROM       (PENDING-PAY-ADJ)
 13713*          RIDFLD     (ERPYAJ-KEY)
 13714*          RESP       (WS-RESPONSE)
 13715*       END-EXEC
 13716     MOVE LENGTH OF
 13717      PENDING-PAY-ADJ
 13718       TO DFHEIV11
 13719*    MOVE '&$ L                  ''  N#00012518' TO DFHEIV0
 13720     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13721     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13722     MOVE X'204E233030303132353138' TO DFHEIV0(25:11)
 13723     CALL 'kxdfhei1' USING DFHEIV0,
 13724           FILE-ID-ERPYAJ,
 13725           PENDING-PAY-ADJ,
 13726           DFHEIV11,
 13727           ERPYAJ-KEY,
 13728           DFHEIV99,
 13729           DFHEIV99
 13730     MOVE EIBRESP  TO WS-RESPONSE
 13731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13732        IF RESP-DUPKEY OR RESP-DUPREC
 13733           ADD +1                TO ERPYAJ-SEQ-NO
 13734           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13735        END-IF
 13736     END-PERFORM
 13737     .
 13738 1610-EXIT.
 13739     EXIT.
 13740 1620-ADD-ERPYAJ-DLR-REC.
 13741     MOVE 'C'                    TO ERPYAJ-TYPE
 13742     IF REVERSAL
 13743        MOVE 'R'                 TO ERPYAJ-TYPE
 13744     END-IF
 13745     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13746                                    ERPYAJ-ACCOUNT
 13747     ADD +1                      TO ERPYAJ-SEQ-NO
 13748     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13749     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13750     IF PB-CARRIER = '2'
 13751        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13752     ELSE
 13753        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13754     END-IF
 13755     PERFORM WITH TEST AFTER
 13756        UNTIL (NOT RESP-DUPKEY)
 13757           AND (NOT RESP-DUPREC)
 13758
 13759* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 251
* EL6311.cbl
 13760*          DATASET    (FILE-ID-ERPYAJ)
 13761*          FROM       (PENDING-PAY-ADJ)
 13762*          RIDFLD     (ERPYAJ-KEY)
 13763*          RESP       (WS-RESPONSE)
 13764*       END-EXEC
 13765     MOVE LENGTH OF
 13766      PENDING-PAY-ADJ
 13767       TO DFHEIV11
 13768*    MOVE '&$ L                  ''  N#00012550' TO DFHEIV0
 13769     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13770     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13771     MOVE X'204E233030303132353530' TO DFHEIV0(25:11)
 13772     CALL 'kxdfhei1' USING DFHEIV0,
 13773           FILE-ID-ERPYAJ,
 13774           PENDING-PAY-ADJ,
 13775           DFHEIV11,
 13776           ERPYAJ-KEY,
 13777           DFHEIV99,
 13778           DFHEIV99
 13779     MOVE EIBRESP  TO WS-RESPONSE
 13780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13781        IF RESP-DUPKEY OR RESP-DUPREC
 13782           ADD +1                TO ERPYAJ-SEQ-NO
 13783           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13784        END-IF
 13785     END-PERFORM
 13786     .
 13787 1620-EXIT.
 13788     EXIT.
 13789 1700-SQUEEZE-IT-IN.
 13790     IF (N1 > CN-BILLING-END-LINE-NO)
 13791        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13792           N1 = +1
 13793           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13794           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13795              IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13796                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13797              ELSE
 13798                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13799              END-IF
 13800              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13801              MOVE +2 TO N1
 13802           END-IF
 13803        END-PERFORM
 13804     ELSE
 13805        IF (N1 < CN-BILLING-START-LINE-NO)
 13806           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13807              N1 = +10
 13808              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13809              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13810                 IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13811                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13812                 ELSE
 13813                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13814                 END-IF
 13815                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13816                 MOVE +9 TO N1
 13817              END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 252
* EL6311.cbl
 13818           END-PERFORM
 13819        END-IF
 13820     END-IF
 13821     .
 13822 1700-EXIT.
 13823     EXIT.
 13824 1800-REMOVE-CERT-NOTES.
 13825     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13826                                 TO ERNOTE-KEY
 13827
 13828* EXEC CICS READ
 13829*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13830*       DATASET    (FILE-ID-ERNOTE)
 13831*       RIDFLD     (ERNOTE-KEY)
 13832*       RESP       (WS-RESPONSE)
 13833*       UPDATE
 13834*    END-EXEC
 13835*    MOVE '&"S        EU         (  N#00012602' TO DFHEIV0
 13836     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13837     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13838     MOVE X'204E233030303132363032' TO DFHEIV0(25:11)
 13839     CALL 'kxdfhei1' USING DFHEIV0,
 13840           FILE-ID-ERNOTE,
 13841           DFHEIV20,
 13842           DFHEIV99,
 13843           ERNOTE-KEY,
 13844           DFHEIV99,
 13845           DFHEIV99,
 13846           DFHEIV99
 13847     SET ADDRESS OF CERTIFICATE-NOTE TO
 13848         DFHEIV20
 13849     MOVE EIBRESP  TO WS-RESPONSE
 13850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13851     IF RESP-NORMAL
 13852        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13853           (N1 > +10)
 13854           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13855           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13856        END-PERFORM
 13857        IF N1 < +11
 13858           MOVE SPACES              TO CN-LINE (N1)
 13859           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13860              N1 <= CN-BILLING-END-LINE-NO
 13861              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13862              IF CN-BILLING-END-LINE-NO <
 13863                               CN-BILLING-START-LINE-NO
 13864                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13865                                     CN-BILLING-START-LINE-NO
 13866              END-IF
 13867              PERFORM 1820-SQUEEZE-ERNOTE
 13868                                  THRU 1820-EXIT
 13869           END-IF
 13870           IF CN-LINES = SPACES
 13871
 13872* EXEC CICS DELETE
 13873*                DATASET    (FILE-ID-ERNOTE)
 13874*                RESP       (WS-RESPONSE)
 13875*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 253
* EL6311.cbl
 13876*    MOVE '&(                    &  N#00012629' TO DFHEIV0
 13877     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13878     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13879     MOVE X'204E233030303132363239' TO DFHEIV0(25:11)
 13880     CALL 'kxdfhei1' USING DFHEIV0,
 13881           FILE-ID-ERNOTE,
 13882           DFHEIV99,
 13883           DFHEIV99,
 13884           DFHEIV99,
 13885           DFHEIV99
 13886     MOVE EIBRESP  TO WS-RESPONSE
 13887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13888              IF RESP-NORMAL
 13889                 MOVE 'D'        TO WS-NOTE-SW
 13890                 PERFORM 1520-UPDATE-ELCERT
 13891                                 THRU 1520-EXIT
 13892              END-IF
 13893           ELSE
 13894
 13895* EXEC CICS REWRITE
 13896*                DATASET    (FILE-ID-ERNOTE)
 13897*                FROM       (CERTIFICATE-NOTE)
 13898*                RESP       (WS-RESPONSE)
 13899*             END-EXEC
 13900     MOVE LENGTH OF
 13901      CERTIFICATE-NOTE
 13902       TO DFHEIV11
 13903*    MOVE '&& L                  %  N#00012639' TO DFHEIV0
 13904     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13905     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13906     MOVE X'204E233030303132363339' TO DFHEIV0(25:11)
 13907     CALL 'kxdfhei1' USING DFHEIV0,
 13908           FILE-ID-ERNOTE,
 13909           CERTIFICATE-NOTE,
 13910           DFHEIV11,
 13911           DFHEIV99
 13912     MOVE EIBRESP  TO WS-RESPONSE
 13913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13914           END-IF
 13915        END-IF
 13916     END-IF
 13917     .
 13918 1800-EXIT.
 13919     EXIT.
 13920 1820-SQUEEZE-ERNOTE.
 13921     MOVE CN-BILLING-START-LINE-NO TO N2
 13922     IF N2 = 0
 13923         MOVE +1                 TO N2
 13924     END-IF
 13925     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13926        (N1 > +9)
 13927        IF CN-LINE (N1) = SPACES
 13928           MOVE CN-LINE (N1 + +1)
 13929                                 TO CN-LINE (N1)
 13930           MOVE SPACES           TO CN-LINE (N1 + +1)
 13931        END-IF
 13932     END-PERFORM
 13933     .
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 254
* EL6311.cbl
 13934 1820-EXIT.
 13935     EXIT.
 13936 1900-DELETE-ERPYAJ.
 13937     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13938     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13939     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13940     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13941     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13942     MOVE +10                    TO ERPYAJ-SEQ-NO
 13943     MOVE 'R'                    TO ERPYAJ-TYPE
 13944     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13945
 13946* EXEC CICS STARTBR
 13947*       DATASET    (FILE-ID-ERPYAJ)
 13948*       RIDFLD     (ERPYAJ-KEY)
 13949*       RESP       (WS-RESPONSE)
 13950*    END-EXEC
 13951     MOVE 0
 13952       TO DFHEIV11
 13953*    MOVE '&,         G          &  N#00012675' TO DFHEIV0
 13954     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13955     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13956     MOVE X'204E233030303132363735' TO DFHEIV0(25:11)
 13957     CALL 'kxdfhei1' USING DFHEIV0,
 13958           FILE-ID-ERPYAJ,
 13959           ERPYAJ-KEY,
 13960           DFHEIV99,
 13961           DFHEIV11,
 13962           DFHEIV99
 13963     MOVE EIBRESP  TO WS-RESPONSE
 13964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13965     IF RESP-NORMAL
 13966        CONTINUE
 13967     ELSE
 13968        GO TO 1900-GET-DEALER
 13969     END-IF
 13970     .
 13971 1900-READNEXT-ERPYAJ-B.
 13972*  GET THE BANK ERPYAJ RECORD
 13973
 13974* EXEC CICS READNEXT
 13975*       DATASET    (FILE-ID-ERPYAJ)
 13976*       RIDFLD     (ERPYAJ-KEY)
 13977*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13978*       RESP       (WS-RESPONSE)
 13979*    END-EXEC
 13980     MOVE 0
 13981       TO DFHEIV11
 13982*    MOVE '&.S                   )  N#00012688' TO DFHEIV0
 13983     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13984     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13985     MOVE X'204E233030303132363838' TO DFHEIV0(25:11)
 13986     CALL 'kxdfhei1' USING DFHEIV0,
 13987           FILE-ID-ERPYAJ,
 13988           DFHEIV20,
 13989           DFHEIV99,
 13990           ERPYAJ-KEY,
 13991           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 255
* EL6311.cbl
 13992           DFHEIV11,
 13993           DFHEIV99,
 13994           DFHEIV99
 13995     SET ADDRESS OF PENDING-PAY-ADJ TO
 13996         DFHEIV20
 13997     MOVE EIBRESP  TO WS-RESPONSE
 13998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13999     IF RESP-NORMAL
 14000        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14001           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14002              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14003                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14004
 14005* EXEC CICS READ
 14006*                   DATASET    (FILE-ID-ERPYAJ)
 14007*                   RIDFLD     (ERPYAJ-KEY)
 14008*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14009*                   RESP       (WS-RESPONSE)
 14010*                   UPDATE
 14011*                END-EXEC
 14012*    MOVE '&"S        EU         (  N#00012699' TO DFHEIV0
 14013     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14014     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14015     MOVE X'204E233030303132363939' TO DFHEIV0(25:11)
 14016     CALL 'kxdfhei1' USING DFHEIV0,
 14017           FILE-ID-ERPYAJ,
 14018           DFHEIV20,
 14019           DFHEIV99,
 14020           ERPYAJ-KEY,
 14021           DFHEIV99,
 14022           DFHEIV99,
 14023           DFHEIV99
 14024     SET ADDRESS OF PENDING-PAY-ADJ TO
 14025         DFHEIV20
 14026     MOVE EIBRESP  TO WS-RESPONSE
 14027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14028                 IF RESP-NORMAL
 14029
 14030* EXEC CICS DELETE
 14031*                      DATASET   (FILE-ID-ERPYAJ)
 14032*                      RESP      (WS-RESPONSE)
 14033*                   END-EXEC
 14034*    MOVE '&(                    &  N#00012707' TO DFHEIV0
 14035     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14036     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14037     MOVE X'204E233030303132373037' TO DFHEIV0(25:11)
 14038     CALL 'kxdfhei1' USING DFHEIV0,
 14039           FILE-ID-ERPYAJ,
 14040           DFHEIV99,
 14041           DFHEIV99,
 14042           DFHEIV99,
 14043           DFHEIV99
 14044     MOVE EIBRESP  TO WS-RESPONSE
 14045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14046                 END-IF
 14047              ELSE
 14048                 SET REVERSAL    TO TRUE
 14049                 PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 256
* EL6311.cbl
 14050                                 THRU 1600-EXIT
 14051                 GO TO 1900-EXIT
 14052              END-IF
 14053           ELSE
 14054              GO TO 1900-READNEXT-ERPYAJ-B
 14055           END-IF
 14056        END-IF
 14057
 14058* EXEC CICS ENDBR
 14059*          DATASET   (FILE-ID-ERPYAJ)
 14060*       END-EXEC
 14061     MOVE 0
 14062       TO DFHEIV11
 14063*    MOVE '&2                    $   #00012722' TO DFHEIV0
 14064     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14065     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14066     MOVE X'2020233030303132373232' TO DFHEIV0(25:11)
 14067     CALL 'kxdfhei1' USING DFHEIV0,
 14068           FILE-ID-ERPYAJ,
 14069           DFHEIV11,
 14070           DFHEIV99
 14071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14072     END-IF
 14073     .
 14074 1900-GET-DEALER.
 14075     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14076     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14077     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14078     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14079     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 14080     MOVE +10                    TO ERPYAJ-SEQ-NO
 14081     MOVE 'C'                    TO ERPYAJ-TYPE
 14082     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14083
 14084* EXEC CICS STARTBR
 14085*       DATASET    (FILE-ID-ERPYAJ)
 14086*       RIDFLD     (ERPYAJ-KEY)
 14087*       RESP       (WS-RESPONSE)
 14088*    END-EXEC
 14089     MOVE 0
 14090       TO DFHEIV11
 14091*    MOVE '&,         G          &  N#00012736' TO DFHEIV0
 14092     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14093     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14094     MOVE X'204E233030303132373336' TO DFHEIV0(25:11)
 14095     CALL 'kxdfhei1' USING DFHEIV0,
 14096           FILE-ID-ERPYAJ,
 14097           ERPYAJ-KEY,
 14098           DFHEIV99,
 14099           DFHEIV11,
 14100           DFHEIV99
 14101     MOVE EIBRESP  TO WS-RESPONSE
 14102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14103     IF RESP-NORMAL
 14104        CONTINUE
 14105     ELSE
 14106        GO TO 1900-EXIT
 14107     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 257
* EL6311.cbl
 14108     .
 14109 1900-READNEXT-ERPYAJ-D.
 14110*  GET THE DEALER ERPYAJ RECORD
 14111
 14112* EXEC CICS READNEXT
 14113*       DATASET    (FILE-ID-ERPYAJ)
 14114*       RIDFLD     (ERPYAJ-KEY)
 14115*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14116*       RESP       (WS-RESPONSE)
 14117*    END-EXEC
 14118     MOVE 0
 14119       TO DFHEIV11
 14120*    MOVE '&.S                   )  N#00012749' TO DFHEIV0
 14121     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14122     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14123     MOVE X'204E233030303132373439' TO DFHEIV0(25:11)
 14124     CALL 'kxdfhei1' USING DFHEIV0,
 14125           FILE-ID-ERPYAJ,
 14126           DFHEIV20,
 14127           DFHEIV99,
 14128           ERPYAJ-KEY,
 14129           DFHEIV99,
 14130           DFHEIV11,
 14131           DFHEIV99,
 14132           DFHEIV99
 14133     SET ADDRESS OF PENDING-PAY-ADJ TO
 14134         DFHEIV20
 14135     MOVE EIBRESP  TO WS-RESPONSE
 14136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14137     IF RESP-NORMAL
 14138        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14139           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14140              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14141                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14142
 14143* EXEC CICS READ
 14144*                   DATASET    (FILE-ID-ERPYAJ)
 14145*                   RIDFLD     (ERPYAJ-KEY)
 14146*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14147*                   RESP       (WS-RESPONSE)
 14148*                   UPDATE
 14149*                END-EXEC
 14150*    MOVE '&"S        EU         (  N#00012760' TO DFHEIV0
 14151     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14152     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14153     MOVE X'204E233030303132373630' TO DFHEIV0(25:11)
 14154     CALL 'kxdfhei1' USING DFHEIV0,
 14155           FILE-ID-ERPYAJ,
 14156           DFHEIV20,
 14157           DFHEIV99,
 14158           ERPYAJ-KEY,
 14159           DFHEIV99,
 14160           DFHEIV99,
 14161           DFHEIV99
 14162     SET ADDRESS OF PENDING-PAY-ADJ TO
 14163         DFHEIV20
 14164     MOVE EIBRESP  TO WS-RESPONSE
 14165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 258
* EL6311.cbl
 14166                 IF RESP-NORMAL
 14167
 14168* EXEC CICS DELETE
 14169*                      DATASET   (FILE-ID-ERPYAJ)
 14170*                      RESP      (WS-RESPONSE)
 14171*                   END-EXEC
 14172*    MOVE '&(                    &  N#00012768' TO DFHEIV0
 14173     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14174     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14175     MOVE X'204E233030303132373638' TO DFHEIV0(25:11)
 14176     CALL 'kxdfhei1' USING DFHEIV0,
 14177           FILE-ID-ERPYAJ,
 14178           DFHEIV99,
 14179           DFHEIV99,
 14180           DFHEIV99,
 14181           DFHEIV99
 14182     MOVE EIBRESP  TO WS-RESPONSE
 14183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14184                 END-IF
 14185              ELSE
 14186                 SET REVERSAL    TO TRUE
 14187              END-IF
 14188           ELSE
 14189              GO TO 1900-READNEXT-ERPYAJ-D
 14190           END-IF
 14191        END-IF
 14192
 14193* EXEC CICS ENDBR
 14194*          DATASET   (FILE-ID-ERPYAJ)
 14195*       END-EXEC
 14196     MOVE 0
 14197       TO DFHEIV11
 14198*    MOVE '&2                    $   #00012780' TO DFHEIV0
 14199     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14200     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14201     MOVE X'2020233030303132373830' TO DFHEIV0(25:11)
 14202     CALL 'kxdfhei1' USING DFHEIV0,
 14203           FILE-ID-ERPYAJ,
 14204           DFHEIV11,
 14205           DFHEIV99
 14206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14207     END-IF
 14208     .
 14209 1900-EXIT.
 14210     EXIT.
 14211******************************************************************
 14212*            C A N C E L   M A I N L I N E                       *
 14213******************************************************************
 14214
 14215 2000-CANCEL-MAINLINE.
 14216     IF PI-DISPLAY-ORIGINAL-BATCH
 14217        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14218           MOVE ER-0023             TO EMI-ERROR
 14219           MOVE -1                  TO CMAINTL
 14220           MOVE AL-UABON            TO CMAINTA
 14221           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14222           GO TO 8200-SEND-DATAONLY
 14223        ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 259
* EL6311.cbl
 14224           NEXT SENTENCE
 14225     ELSE
 14226        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14227           MOVE ER-0023             TO EMI-ERROR
 14228           MOVE -1                  TO CMAINTL
 14229           MOVE AL-UABON            TO CMAINTA
 14230           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14231           GO TO 8200-SEND-DATAONLY.
 14232
 14233     IF CMAINTI = 'S'
 14234        GO TO 2100-SHOW-REQUEST.
 14235
 14236     IF NOT MODIFY-CAP
 14237         MOVE 'UPDATE'       TO SM-READ
 14238         PERFORM 9995-SECURITY-VIOLATION
 14239         MOVE ER-0070        TO EMI-ERROR
 14240         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14241         GO TO 8100-SEND-INITIAL-MAP.
 14242
 14243     IF CMAINTL GREATER THAN ZEROS
 14244        IF PI-PF6-FUNCTION
 14245           IF CMAINTI NOT = 'A'
 14246              MOVE AL-UABON  TO CMAINTA
 14247              MOVE -1        TO CMAINTL
 14248              MOVE ER-2260   TO EMI-ERROR
 14249              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14250              GO TO 8200-SEND-DATAONLY.
 14251
 14252     IF CCERTNOL = ZEROS
 14253       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14254         NEXT SENTENCE
 14255     ELSE
 14256         IF CCERTNOL NOT = ZEROS
 14257             MOVE AL-UANON       TO CCERTNOA
 14258         ELSE
 14259             MOVE -1             TO CCERTNOL
 14260             MOVE  1             TO SET-CURSOR-SW
 14261             MOVE ER-2218       TO EMI-ERROR
 14262             MOVE AL-UABON       TO CCERTNOA
 14263             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14264
 14265     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14266        NEXT SENTENCE
 14267     ELSE
 14268        IF CEFFDTL NOT = ZEROS
 14269           MOVE AL-UNNON         TO CEFFDTA
 14270           MOVE CEFFDTI TO DEEDIT-FIELD
 14271           PERFORM 8600-DEEDIT
 14272           MOVE 4                TO DC-OPTION-CODE
 14273           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14274           PERFORM 9700-DATE-LINK
 14275           IF NO-CONVERSION-ERROR
 14276              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14277              ELSE
 14278              MOVE -1            TO CEFFDTL
 14279              MOVE  1            TO SET-CURSOR-SW
 14280              MOVE ER-2226      TO EMI-ERROR
 14281              MOVE AL-UNBON      TO CEFFDTA
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 260
* EL6311.cbl
 14282              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14283          ELSE
 14284          MOVE -1                 TO CEFFDTL
 14285          MOVE  1                 TO SET-CURSOR-SW
 14286          MOVE ER-2220            TO EMI-ERROR
 14287          MOVE AL-UNBON           TO CEFFDTA
 14288          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14289
 14290     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14291
 14292     IF CCERTNOL NOT = ZEROS
 14293        MOVE CCERTNOI                TO WS-NEW-PRIME
 14294     ELSE
 14295        MOVE SPACES                  TO WS-NEW-PRIME.
 14296
 14297     IF CSUFIXL NOT = ZEROS
 14298        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14299     ELSE
 14300        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14301
 14302     IF CEFFDTL NOT = ZEROS
 14303        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14304     ELSE
 14305        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14306
 14307     IF CMAINTI = 'A' OR 'K' OR 'S'
 14308        NEXT SENTENCE
 14309     ELSE
 14310        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14311        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14312           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14313           WS-PB-RECORD-TYPE NOT = '2'
 14314           IF CMAINTI = 'C'
 14315              MOVE ER-2287          TO EMI-ERROR
 14316              MOVE -1               TO CCERTNOL
 14317              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14318              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14319              GO TO 8200-SEND-DATAONLY
 14320             ELSE
 14321              MOVE ER-2260          TO EMI-ERROR
 14322              MOVE -1               TO CCERTNOL
 14323              MOVE AL-UABON         TO CCERTNOA
 14324              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14325              GO TO 8200-SEND-DATAONLY.
 14326
 14327     IF CMAINTI = 'D'
 14328        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14329
 14330     IF CLSTNML GREATER THAN ZEROS
 14331         MOVE AL-UANON           TO CLSTNMA.
 14332
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 261
* EL6311.cbl
 14334
 14335******************************************************************
 14336*                                                                *
 14337*           E D I T   C A N C E L   C O V E R A G E S            *
 14338*                                                                *
 14339******************************************************************
 14340
 14341 2015-EDIT-COVERAGES.
 14342     IF CCANDT1L      GREATER THAN ZEROS OR
 14343        CREFND1L      GREATER THAN ZEROS OR
 14344        CCANDT2L      GREATER THAN ZEROS OR
 14345        CREFND2L      GREATER THAN ZEROS OR
 14346        CMTHD1L       GREATER THAN ZEROS OR
 14347        CMTHD2L       GREATER THAN ZEROS OR
 14348        CLIVESL       GREATER THAN ZEROS OR
 14349        CPAYEEL       GREATER THAN ZEROS OR
 14350        CFORCEL       GREATER THAN ZEROS OR
 14351        CBILCDL       GREATER THAN ZEROS OR
 14352        CCANREAL      GREATER THAN ZEROS
 14353            NEXT SENTENCE
 14354         ELSE
 14355            GO TO 2030-EDIT-COMPLETE.
 14356
 14357     IF CCANDT1L = ZEROS
 14358        AND (CMAINTI = 'C' OR 'K')
 14359        NEXT SENTENCE
 14360     ELSE
 14361        IF CCANDT1L      GREATER THAN ZEROS
 14362            MOVE AL-UNNON            TO CCANDT1A
 14363            IF CCANDT1I = SPACES
 14364               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14365            ELSE
 14366               MOVE CCANDT1I            TO DEEDIT-FIELD
 14367               PERFORM 8600-DEEDIT
 14368               IF DEEDIT-FIELD-V0   NUMERIC
 14369                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14370                  MOVE 4                TO DC-OPTION-CODE
 14371                  PERFORM 9700-DATE-LINK
 14372                  IF NO-CONVERSION-ERROR
 14373                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14374                  ELSE
 14375                      MOVE -1        TO CCANDT1L
 14376                      MOVE ER-2227   TO EMI-ERROR
 14377                      MOVE AL-UNBON  TO CCANDT1A
 14378                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14379               ELSE
 14380                  MOVE -1         TO CCANDT1L
 14381                  MOVE ER-2223    TO EMI-ERROR
 14382                  MOVE AL-UNBON   TO CCANDT1A
 14383                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14384        ELSE
 14385            IF CREFND1L GREATER THAN ZEROS
 14386               MOVE -1             TO CCANDT1L
 14387               MOVE ER-2222        TO EMI-ERROR
 14388               MOVE AL-UNBOF       TO CCANDT1A
 14389               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14390
 14391     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 262
* EL6311.cbl
 14392        AND (CMAINTI = 'C' OR 'K')
 14393         NEXT SENTENCE
 14394     ELSE
 14395         IF CREFND1L NOT = ZEROS
 14396            MOVE AL-UNNON        TO CREFND1A
 14397
 14398* EXEC CICS BIF DEEDIT
 14399*               FIELD  (CREFND1I)
 14400*               LENGTH (11)
 14401*           END-EXEC
 14402     MOVE 11
 14403       TO DFHEIV11
 14404*    MOVE '@"L                   #   #00012973' TO DFHEIV0
 14405     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14406     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14407     MOVE X'2020233030303132393733' TO DFHEIV0(25:11)
 14408     CALL 'kxdfhei1' USING DFHEIV0,
 14409           CREFND1I,
 14410           DFHEIV11
 14411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14412            MOVE CREFND1I        TO WS-CREFND1
 14413*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14414*           PERFORM 8600-DEEDIT
 14415*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14416            IF WS-CREFND1  = ZEROS
 14417               AND CMAINTI = 'A'
 14418             MOVE ER-2437        TO EMI-ERROR
 14419             MOVE -1             TO CREFND1L
 14420             MOVE AL-UNBON       TO CREFND1A
 14421             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14422
 14423     IF CCANREAL > +0
 14424        MOVE AL-UANON            TO CCANREAA
 14425        IF CCANREAI = 'R' OR ' '
 14426           CONTINUE
 14427        ELSE
 14428           MOVE ER-9841        TO EMI-ERROR
 14429           MOVE -1             TO CCANREAL
 14430           MOVE AL-UABON       TO CCANREAA
 14431           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14432        END-IF
 14433     END-IF
 14434     IF CMTHD1L EQUAL +0
 14435        NEXT SENTENCE
 14436     ELSE
 14437        IF CMTHD1L NOT = +0
 14438           MOVE AL-UNNON        TO CMTHD1A
 14439           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14440                         OR '5' OR '6' OR '8' OR '9'
 14441                         OR 'R' OR ' '
 14442              NEXT SENTENCE
 14443           ELSE
 14444              MOVE ER-0582        TO EMI-ERROR
 14445              MOVE -1             TO CMTHD1L
 14446              MOVE AL-UNBON       TO CMTHD1A
 14447              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14448
 14449     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 263
* EL6311.cbl
 14450        AND (CMAINTI = 'C' OR 'K')
 14451         NEXT SENTENCE
 14452     ELSE
 14453         IF CCANDT2L  GREATER THAN ZEROS
 14454             MOVE AL-UNNON       TO CCANDT2A
 14455             IF CCANDT2I = SPACES
 14456                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14457             ELSE
 14458                MOVE CCANDT2I       TO DEEDIT-FIELD
 14459                PERFORM 8600-DEEDIT
 14460                IF DEEDIT-FIELD-V0   NUMERIC
 14461                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14462                   MOVE 4                TO DC-OPTION-CODE
 14463                   PERFORM 9700-DATE-LINK
 14464                   IF NO-CONVERSION-ERROR
 14465                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14466                   ELSE
 14467                      MOVE -1       TO CCANDT2L
 14468                      MOVE ER-2227  TO EMI-ERROR
 14469                      MOVE AL-UNBON TO CCANDT2A
 14470                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14471                ELSE
 14472                   MOVE -1         TO CCANDT2L
 14473                   MOVE ER-2223    TO EMI-ERROR
 14474                   MOVE AL-UNBON   TO CCANDT2A
 14475                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14476         ELSE
 14477            IF CREFND2L GREATER THAN ZEROS
 14478               MOVE -1             TO CCANDT2L
 14479               MOVE ER-2222        TO EMI-ERROR
 14480               MOVE AL-UNBOF       TO CCANDT2A
 14481               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14482
 14483     IF CREFND2L = ZEROS
 14484        AND (CMAINTI = 'C' OR 'K')
 14485         NEXT SENTENCE
 14486     ELSE
 14487         IF CREFND2L NOT = ZEROS
 14488            MOVE AL-UNNON        TO CREFND2A
 14489
 14490* EXEC CICS BIF DEEDIT
 14491*               FIELD  (CREFND2I)
 14492*               LENGTH (11)
 14493*           END-EXEC
 14494     MOVE 11
 14495       TO DFHEIV11
 14496*    MOVE '@"L                   #   #00013054' TO DFHEIV0
 14497     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14498     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14499     MOVE X'2020233030303133303534' TO DFHEIV0(25:11)
 14500     CALL 'kxdfhei1' USING DFHEIV0,
 14501           CREFND2I,
 14502           DFHEIV11
 14503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14504            MOVE CREFND2I        TO WS-CREFND2
 14505*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14506*           PERFORM 8600-DEEDIT
 14507*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 264
* EL6311.cbl
 14508            IF WS-CREFND2  = ZEROS
 14509               AND CMAINTI = 'A'
 14510             MOVE ER-2437        TO EMI-ERROR
 14511             MOVE -1             TO CREFND2L
 14512             MOVE AL-UNBON       TO CREFND2A
 14513             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14514
 14515     IF CMTHD2L EQUAL +0
 14516        NEXT SENTENCE
 14517     ELSE
 14518        IF CMTHD2L NOT = +0
 14519           MOVE AL-UNNON        TO CMTHD2A
 14520           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14521                         OR '5' OR '6' OR '8' OR '9'
 14522                         OR ' ' OR 'R'
 14523              NEXT SENTENCE
 14524           ELSE
 14525              MOVE ER-0582        TO EMI-ERROR
 14526              MOVE -1             TO CMTHD2L
 14527              MOVE AL-UNBON       TO CMTHD2A
 14528              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14529
 14530     IF CLIVESL GREATER THAN ZEROS
 14531         MOVE CLIVESI            TO DEEDIT-FIELD
 14532         PERFORM 8600-DEEDIT
 14533         IF DEEDIT-FIELD-V0 NUMERIC
 14534             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14535             MOVE AL-UNNON       TO CLIVESA
 14536         ELSE
 14537             MOVE -1             TO CLIVESL
 14538             MOVE AL-UNBON       TO CLIVESA
 14539             MOVE ER-2223        TO EMI-ERROR
 14540             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14541
 14542     IF CFORCEL  NOT = ZEROS
 14543         IF FORCE-CAP
 14544            MOVE AL-UANON            TO CFORCEA
 14545         ELSE
 14546            MOVE ER-2945             TO EMI-ERROR
 14547            MOVE AL-UABON            TO CFORCEA
 14548            MOVE -1                  TO CFORCEL
 14549            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14550
 14551     IF CPAYEEL GREATER THAN ZEROS
 14552        MOVE AL-UANON            TO CPAYEEA.
 14553
 14554     IF CBILCDL NOT = ZEROS
 14555        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14556                             AND 'A' AND 'B' AND 'E'
 14557           MOVE ER-2225              TO EMI-ERROR
 14558           MOVE AL-UABON             TO CBILCDA
 14559           MOVE -1                   TO CBILCDL
 14560           MOVE  1                   TO SET-CURSOR-SW
 14561           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14562        ELSE
 14563           MOVE AL-UANON             TO CBILCDA.
 14564
 14565 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 265
* EL6311.cbl
 14566     IF EMI-ERROR = ZEROS
 14567         NEXT SENTENCE
 14568     ELSE
 14569         GO TO 8200-SEND-DATAONLY.
 14570
 14571     IF CMAINTI = 'A'
 14572        GO TO 2200-ADD-CANCEL-ROUTINE.
 14573
 14574     IF CMAINTI = 'C'
 14575        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14576
 14577     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14578
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 266
* EL6311.cbl
 14580
 14581******************************************************************
 14582*                                                                *
 14583*                   S H O W   C A N C E L                        *
 14584*                                                                *
 14585******************************************************************
 14586
 14587 2100-SHOW-REQUEST.
 14588     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14589
 14590     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14591        MOVE -1                  TO CMAINTL
 14592        GO TO 8200-SEND-DATAONLY.
 14593
 14594     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14595
 14596     IF CSUFIXL NOT = ZEROS
 14597        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14598       ELSE
 14599        MOVE SPACE            TO WS-NEW-SUFFIX.
 14600
 14601     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14602     PERFORM 8600-DEEDIT.
 14603     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14604     MOVE '4'                    TO DC-OPTION-CODE.
 14605     PERFORM 9700-DATE-LINK.
 14606     IF DATE-CONVERSION-ERROR
 14607        MOVE ER-0348             TO EMI-ERROR
 14608        MOVE -1                  TO CEFFDTL
 14609        MOVE AL-UABON            TO CEFFDTA
 14610        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14611        GO TO 8200-SEND-DATAONLY
 14612     ELSE
 14613        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14614        MOVE AL-UANON            TO CEFFDTA
 14615        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14616
 14617     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14618
 14619     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14620        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14621        MOVE 'Y'                    TO WS-SHOW-SW
 14622        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14623           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14624        ELSE
 14625           IF PI-FILE-BROWSE
 14626              GO TO 4300-BROWSE-FILE-FORWARD
 14627           ELSE
 14628              IF PI-CSR-BROWSE
 14629                 GO TO 4200-BROWSE-CSR-FORWARD
 14630              ELSE
 14631                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14632     ELSE
 14633        GO TO 3900-RE-DISPLAY-RECORD.
 14634
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 267
* EL6311.cbl
 14636
 14637
 14638******************************************************************
 14639*                                                                *
 14640*            A D D   C A N C E L   R O U T I N E                 *
 14641*                                                                *
 14642******************************************************************
 14643
 14644 2200-ADD-CANCEL-ROUTINE.
 14645     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14646
 14647
 14648* EXEC CICS GETMAIN
 14649*        SET     (ADDRESS OF PENDING-BUSINESS)
 14650*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14651*    END-EXEC.
 14652*    MOVE '," L                  $   #00013201' TO DFHEIV0
 14653     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14654     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14655     MOVE X'2020233030303133323031' TO DFHEIV0(25:11)
 14656     CALL 'kxdfhei1' USING DFHEIV0,
 14657           DFHEIV20,
 14658           ERPNDB-RECORD-LENGTH,
 14659           DFHEIV99
 14660     SET ADDRESS OF PENDING-BUSINESS TO
 14661         DFHEIV20
 14662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14663
 14664
 14665
 14666* EXEC CICS HANDLE CONDITION
 14667*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14668*    END-EXEC.
 14669*    MOVE '"$I                   ! 3 #00013206' TO DFHEIV0
 14670     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14671     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14672     MOVE X'3320233030303133323036' TO DFHEIV0(25:11)
 14673     CALL 'kxdfhei1' USING DFHEIV0
 14674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14675
 14676
 14677     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14678     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14679     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14680
 14681
 14682* EXEC CICS READ
 14683*        INTO    (PENDING-BUSINESS)
 14684*        DATASET (FILE-ID-ERPNDB)
 14685*        RIDFLD  (ERPNDB-KEY)
 14686*    END-EXEC.
 14687     MOVE LENGTH OF
 14688      PENDING-BUSINESS
 14689       TO DFHEIV11
 14690*    MOVE '&"IL       E          (   #00013214' TO DFHEIV0
 14691     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14692     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14693     MOVE X'2020233030303133323134' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 268
* EL6311.cbl
 14694     CALL 'kxdfhei1' USING DFHEIV0,
 14695           FILE-ID-ERPNDB,
 14696           PENDING-BUSINESS,
 14697           DFHEIV11,
 14698           ERPNDB-KEY,
 14699           DFHEIV99,
 14700           DFHEIV99,
 14701           DFHEIV99
 14702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14703
 14704
 14705     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14706
 14707     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14708     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14709     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14710     MOVE SPACES                 TO PENDING-BUSINESS.
 14711     MOVE 'PB'                   TO PB-RECORD-ID.
 14712     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14713     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14714     MOVE SPACES                 TO PB-CERT-SFX.
 14715     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14716     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14717                                    PB-ALT-CHG-SEQ-NO.
 14718
 14719     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14720     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14721     MOVE '2'                    TO PB-RECORD-TYPE.
 14722
 14723     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14724     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14725
 14726
 14727     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14728                                    PB-ALT-CHG-SEQ-NO
 14729                                    PB-C-LF-REF-CALC
 14730                                    PB-C-AH-REF-CALC
 14731                                    PB-C-LF-RFND-CLP
 14732                                    PB-C-AH-RFND-CLP
 14733                                    PB-CI-INSURED-AGE
 14734                                    PB-CI-LF-TERM
 14735                                    PB-CI-AH-TERM
 14736                                    PB-CI-LF-BENEFIT-CD
 14737                                    PB-CI-LF-BENEFIT-AMT
 14738                                    PB-CI-LF-ALT-BENEFIT-AMT
 14739                                    PB-CI-LF-PREMIUM-AMT
 14740                                    PB-CI-LF-ALT-PREMIUM-AMT
 14741                                    PB-CI-AH-BENEFIT-CD
 14742                                    PB-CI-AH-BENEFIT-AMT
 14743                                    PB-CI-AH-PREMIUM-AMT
 14744                                    PB-CI-PAY-FREQUENCY
 14745                                    PB-CI-LOAN-APR
 14746                                    PB-CI-LOAN-TERM
 14747                                    PB-CI-LIFE-COMMISSION
 14748                                    PB-CI-AH-COMMISSION
 14749                                    PB-CI-CURR-SEQ
 14750                                    PB-CI-AH-CANCEL-AMT
 14751                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 269
* EL6311.cbl
 14752                                    PB-CI-RATE-DEV-PCT-LF
 14753                                    PB-CI-RATE-DEV-PCT-AH
 14754                                    PB-CI-EXTENTION-DAYS
 14755                                    PB-CI-TERM-IN-DAYS
 14756                                    PB-CI-LIVES
 14757                                    PB-CI-LF-CRIT-PER
 14758                                    PB-CI-AH-CRIT-PER
 14759                                    PB-C-LF-REM-TERM
 14760                                    PB-C-AH-REM-TERM
 14761                                    PB-CHG-COUNT
 14762                                    PB-LF-BILLED-AMTS
 14763                                    PB-AH-BILLED-AMTS
 14764                                    PB-C-NH-INT-ON-REFS
 14765*                                   PB-C-MICROFILM-NO
 14766                                    PB-CALC-TOLERANCE.
 14767
 14768     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14769                                    PB-CI-AH-SETTLEMENT-DT
 14770                                    PB-CI-DEATH-DT
 14771                                    PB-CI-LF-PRIOR-CANCEL-DT
 14772                                    PB-CI-AH-PRIOR-CANCEL-DT
 14773                                    PB-CI-ENTRY-DT
 14774                                    PB-CI-LF-EXPIRE-DT
 14775                                    PB-CI-AH-EXPIRE-DT
 14776                                    PB-CI-LOAN-1ST-PMT-DT
 14777                                    PB-C-LF-CANCEL-DT
 14778                                    PB-C-AH-CANCEL-DT
 14779                                    PB-CREDIT-ACCEPT-DT
 14780                                    PB-BILLED-DT
 14781                                    PB-ACCT-EFF-DT
 14782                                    PB-ACCT-EXP-DT.
 14783
 14784     MOVE 'X'                    TO PB-FATAL-FLAG.
 14785
 14786     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14787
 14788     IF CSUFIXL     GREATER THAN ZEROS
 14789        MOVE CSUFIXI             TO PB-CERT-SFX.
 14790
 14791*    IF CMICRNOL  GREATER  ZEROS
 14792*        IF CMICRNOI  NUMERIC
 14793*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14794*            MOVE AL-UNNON       TO  CMICRNOA
 14795*        ELSE
 14796*            MOVE -1             TO  CMICRNOL
 14797*            MOVE AL-UNBON       TO  CMICRNOA
 14798*            MOVE ER-2701        TO  EMI-ERROR
 14799*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14800
 14801     IF CLSTNML     GREATER THAN ZEROS
 14802        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14803
 14804     IF CCANREAL > ZEROS
 14805        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14806     END-IF
 14807     IF CPCYNL > ZEROS
 14808        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14809     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 270
* EL6311.cbl
 14810     IF CCANDT1L    GREATER THAN ZEROS
 14811        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14812
 14813     IF CCANDT2L    GREATER THAN ZEROS
 14814        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14815
 14816     IF CMTHD1L    GREATER THAN +0
 14817        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14818
 14819     IF CMTHD2L    GREATER THAN +0
 14820        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14821
 14822     IF CREFND1L    GREATER THAN ZEROS
 14823        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14824        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14825     ELSE
 14826        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14827
 14828     IF CREFND2L    GREATER THAN ZEROS
 14829        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14830        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14831     ELSE
 14832        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14833
 14834     IF CLIVESL     GREATER THAN ZEROS
 14835        MOVE WS-CLIVES           TO PB-C-LIVES
 14836     ELSE
 14837        MOVE ZEROS               TO PB-C-LIVES.
 14838
 14839     IF CPAYEEL     GREATER THAN ZEROS
 14840        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14841
 14842     IF CFORCEL     GREATER THAN ZEROS
 14843        MOVE CFORCEI             TO PB-FORCE-CODE.
 14844
 14845     IF CBILCDL     GREATER THAN ZEROS
 14846        MOVE CBILCDI             TO PB-RECORD-BILL.
 14847
 14848*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14849
 14850 2260-WRITE-PB-RECORD.
 14851     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14852                                    PB-INPUT-BY.
 14853     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14854     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14855                                    PB-INPUT-DT.
 14856
 14857     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14858     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14859                                    PB-CONTROL-BY-ORIG-BATCH.
 14860
 14861     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14862     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14863     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14864     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14865     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14866
 14867     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 271
* EL6311.cbl
 14868
 14869     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14870
 14871     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14872     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14873     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14874
 14875     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14876     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14877
 14878 2275-WRITE-PENDING-BUSINESS.
 14879     MOVE 'A'                    TO JP-RECORD-TYPE.
 14880     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14881     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14882     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14883
 14884
 14885* EXEC CICS HANDLE CONDITION
 14886*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14887*    END-EXEC.
 14888*    MOVE '"$%                   ! 4 #00013399' TO DFHEIV0
 14889     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14890     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14891     MOVE X'3420233030303133333939' TO DFHEIV0(25:11)
 14892     CALL 'kxdfhei1' USING DFHEIV0
 14893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14894
 14895
 14896
 14897* EXEC CICS WRITE
 14898*        DATASET (FILE-ID-ERPNDB)
 14899*        FROM    (PENDING-BUSINESS)
 14900*        RIDFLD  (PB-CONTROL-PRIMARY)
 14901*    END-EXEC.
 14902     MOVE LENGTH OF
 14903      PENDING-BUSINESS
 14904       TO DFHEIV11
 14905*    MOVE '&$ L                  ''   #00013403' TO DFHEIV0
 14906     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14907     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14908     MOVE X'2020233030303133343033' TO DFHEIV0(25:11)
 14909     CALL 'kxdfhei1' USING DFHEIV0,
 14910           FILE-ID-ERPNDB,
 14911           PENDING-BUSINESS,
 14912           DFHEIV11,
 14913           PB-CONTROL-PRIMARY,
 14914           DFHEIV99,
 14915           DFHEIV99
 14916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14917
 14918
 14919     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14920
 14921     PERFORM 8400-LOG-JOURNAL-RECORD.
 14922
 14923******************************************************************
 14924*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14925******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 272
* EL6311.cbl
 14926
 14927     display ' made it to add orig CANCEL cert '
 14928     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14929     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14930     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14931     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14932
 14933
 14934* EXEC CICS READ
 14935*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14936*        DATASET (FILE-ID-ELCERT)
 14937*        RIDFLD  (ELCERT-KEY)
 14938*        RESP    (WS-RESPONSE)
 14939*    END-EXEC.
 14940*    MOVE '&"S        E          (  N#00013423' TO DFHEIV0
 14941     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14942     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14943     MOVE X'204E233030303133343233' TO DFHEIV0(25:11)
 14944     CALL 'kxdfhei1' USING DFHEIV0,
 14945           FILE-ID-ELCERT,
 14946           DFHEIV20,
 14947           DFHEIV99,
 14948           ELCERT-KEY,
 14949           DFHEIV99,
 14950           DFHEIV99,
 14951           DFHEIV99
 14952     SET ADDRESS OF CERTIFICATE-MASTER TO
 14953         DFHEIV20
 14954     MOVE EIBRESP  TO WS-RESPONSE
 14955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14956
 14957
 14958     IF NOT RESP-NORMAL
 14959        GO TO 2276-BYPASS-CRTO
 14960     END-IF
 14961
 14962     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14963     MOVE ' '                    TO WS-ERMAIL-SW
 14964
 14965
 14966* EXEC CICS READ
 14967*       DATASET   (FILE-ID-ERMAIL)
 14968*       SET       (ADDRESS OF MAILING-DATA)
 14969*       RIDFLD    (ERMAIL-KEY)
 14970*       RESP      (WS-RESPONSE)
 14971*    END-EXEC
 14972*    MOVE '&"S        E          (  N#00013437' TO DFHEIV0
 14973     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14974     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14975     MOVE X'204E233030303133343337' TO DFHEIV0(25:11)
 14976     CALL 'kxdfhei1' USING DFHEIV0,
 14977           FILE-ID-ERMAIL,
 14978           DFHEIV20,
 14979           DFHEIV99,
 14980           ERMAIL-KEY,
 14981           DFHEIV99,
 14982           DFHEIV99,
 14983           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 273
* EL6311.cbl
 14984     SET ADDRESS OF MAILING-DATA TO
 14985         DFHEIV20
 14986     MOVE EIBRESP  TO WS-RESPONSE
 14987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14988
 14989     IF RESP-NORMAL
 14990        SET ERMAIL-FOUND TO TRUE
 14991     END-IF
 14992
 14993     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14994
 14995     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14996     MOVE 'OC'                   TO OC-RECORD-ID
 14997     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14998                                 TO OC-CONTROL-PRIMARY (1:33)
 14999     MOVE 'I'                    TO OC-RECORD-TYPE
 15000     MOVE +4096                  TO OC-KEY-SEQ-NO
 15001     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 15002     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 15003     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 15004
 15005     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15006     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15007     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15008     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15009     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15010     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15011     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15012     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15013     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15014     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15015     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15016     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15017     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15018     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15019     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15020     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15021     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15022     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15023     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15024     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15025     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15026     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15027     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15028     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15029     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15030     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15031     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15032     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15033     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15034     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15035     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15036     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15037
 15038     IF ERMAIL-FOUND
 15039        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 15040     END-IF
 15041     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 274
* EL6311.cbl
 15042        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15043                           OC-INS-AGE-DEFAULT-FLAG
 15044        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15045                           OC-JNT-AGE-DEFAULT-FLAG
 15046     END-IF
 15047     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 15048     .
 15049 2275-WRITE-ELCRTO.
 15050
 15051
 15052* EXEC CICS WRITE
 15053*       DATASET   ('ELCRTO')
 15054*       FROM      (ORIGINAL-CERTIFICATE)
 15055*       RIDFLD    (OC-CONTROL-PRIMARY)
 15056*       RESP      (WS-RESPONSE)
 15057*    END-EXEC
 15058     MOVE LENGTH OF
 15059      ORIGINAL-CERTIFICATE
 15060       TO DFHEIV11
 15061     MOVE 'ELCRTO' TO DFHEIV1
 15062*    MOVE '&$ L                  ''  N#00013506' TO DFHEIV0
 15063     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15064     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15065     MOVE X'204E233030303133353036' TO DFHEIV0(25:11)
 15066     CALL 'kxdfhei1' USING DFHEIV0,
 15067           DFHEIV1,
 15068           ORIGINAL-CERTIFICATE,
 15069           DFHEIV11,
 15070           OC-CONTROL-PRIMARY,
 15071           DFHEIV99,
 15072           DFHEIV99
 15073     MOVE EIBRESP  TO WS-RESPONSE
 15074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15075
 15076     display ' just wrote 2275 ' ws-response
 15077     IF RESP-DUPKEY
 15078        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 15079        GO TO 2275-WRITE-ELCRTO
 15080     ELSE
 15081        IF NOT RESP-NORMAL
 15082           MOVE -1               TO BMAINTL
 15083           MOVE ER-7450          TO EMI-ERROR
 15084           PERFORM 9900-ERROR-FORMAT
 15085                                 THRU 9900-EXIT
 15086           GO TO 8200-SEND-DATAONLY
 15087        END-IF
 15088     END-IF.
 15089
 15090 2276-BYPASS-CRTO.
 15091******************************************************************
 15092*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15093******************************************************************
 15094
 15095
 15096* EXEC CICS READ
 15097*        INTO    (PENDING-BUSINESS)
 15098*        DATASET (FILE-ID-ERPNDB)
 15099*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 275
* EL6311.cbl
 15100*        UPDATE
 15101*    END-EXEC.
 15102     MOVE LENGTH OF
 15103      PENDING-BUSINESS
 15104       TO DFHEIV11
 15105*    MOVE '&"IL       EU         (   #00013532' TO DFHEIV0
 15106     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15107     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15108     MOVE X'2020233030303133353332' TO DFHEIV0(25:11)
 15109     CALL 'kxdfhei1' USING DFHEIV0,
 15110           FILE-ID-ERPNDB,
 15111           PENDING-BUSINESS,
 15112           DFHEIV11,
 15113           ERPNDB-KEY,
 15114           DFHEIV99,
 15115           DFHEIV99,
 15116           DFHEIV99
 15117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15118
 15119
 15120     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15121     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15122     MOVE 'B'                    TO JP-RECORD-TYPE.
 15123     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15124
 15125     PERFORM 8400-LOG-JOURNAL-RECORD.
 15126
 15127     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15128
 15129
 15130* EXEC CICS REWRITE
 15131*        DATASET (FILE-ID-ERPNDB)
 15132*        FROM    (PENDING-BUSINESS)
 15133*    END-EXEC.
 15134     MOVE LENGTH OF
 15135      PENDING-BUSINESS
 15136       TO DFHEIV11
 15137*    MOVE '&& L                  %   #00013548' TO DFHEIV0
 15138     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15139     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15140     MOVE X'2020233030303133353438' TO DFHEIV0(25:11)
 15141     CALL 'kxdfhei1' USING DFHEIV0,
 15142           FILE-ID-ERPNDB,
 15143           PENDING-BUSINESS,
 15144           DFHEIV11,
 15145           DFHEIV99
 15146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15147
 15148
 15149     MOVE 'C'                    TO JP-RECORD-TYPE.
 15150     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15151
 15152     PERFORM 8400-LOG-JOURNAL-RECORD.
 15153
 15154     IF WS-ERRORS-PRESENT
 15155        GO TO 3900-RE-DISPLAY-RECORD.
 15156
 15157     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 276
* EL6311.cbl
 15158     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15159     MOVE LOW-VALUES             TO EL631CI.
 15160     MOVE  -1                    TO CMAINTL.
 15161     GO TO 8100-SEND-INITIAL-MAP.
 15162
 15163 2280-BATCH-HDR-NOT-FOUND.
 15164     MOVE -1                     TO BMAINTL.
 15165     MOVE ER-7450                TO EMI-ERROR.
 15166     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15167     GO TO 8200-SEND-DATAONLY.
 15168
 15169 2290-DUPLICATE-ALT-INDEX.
 15170
 15171******************************************************************
 15172*                                                                *
 15173*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15174*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15175*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15176*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15177*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15178*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15179*                                                                *
 15180******************************************************************
 15181
 15182     IF LCP-ONCTR-02 =  0
 15183         ADD 1 TO LCP-ONCTR-02
 15184        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15185
 15186     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15187
 15188     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15189         NEXT SENTENCE
 15190     ELSE
 15191         ADD +1 TO PB-BATCH-SEQ-NO
 15192                   PB-CSR-BATCH-SEQ-NO
 15193         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15194         GO TO 2275-WRITE-PENDING-BUSINESS.
 15195
 15196     MOVE -1                     TO CCERTNOL.
 15197     MOVE AL-UABON               TO CCERTNOA.
 15198     MOVE AL-UNBON               TO CEFFDTA.
 15199
 15200     MOVE 1                      TO EMI-SUB
 15201                                    EMI-SWITCH1
 15202                                    EMI-SWITCH-AREA-1
 15203                                    EMI-SWITCH-AREA-2.
 15204
 15205     MOVE SPACES                 TO EMI-ERROR-LINES.
 15206
 15207
 15208* EXEC CICS SYNCPOINT ROLLBACK
 15209*    END-EXEC.
 15210*    MOVE '6"R                   !   #00013611' TO DFHEIV0
 15211     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15212     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15213     MOVE X'2020233030303133363131' TO DFHEIV0(25:11)
 15214     CALL 'kxdfhei1' USING DFHEIV0
 15215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 277
* EL6311.cbl
 15216
 15217
 15218     MOVE ER-2247                TO EMI-ERROR.
 15219     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15220     GO TO 8200-SEND-DATAONLY.
 15221
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 278
* EL6311.cbl
 15223
 15224******************************************************************
 15225*                                                                *
 15226*          C H A N G E   C A N C E L   R O U T I N E             *
 15227*                                                                *
 15228******************************************************************
 15229
 15230***************************************************************
 15231*                                                             *
 15232*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15233*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15234*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15235*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15236*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15237*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15238*     5. LINK TO THE EDIT ROUTINE.                            *
 15239*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15240*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15241*              THE EDIT ROUTINE.                              *
 15242*     7. REWRITE THE NEW ISSUE                                *
 15243*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15244*                                                             *
 15245***************************************************************
 15246 2300-CHANGE-CANCEL-ROUTINE.
 15247     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15248
 15249     IF CCHGL NOT = ZEROS
 15250        MOVE ER-2196             TO EMI-ERROR
 15251        MOVE AL-UABON            TO CMAINTA
 15252        MOVE -1                  TO CMAINTL
 15253        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15254        GO TO 8200-SEND-DATAONLY.
 15255
 15256     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15257
 15258     IF CSUFIXL NOT = ZEROS
 15259        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15260     ELSE
 15261        MOVE SPACE               TO WS-NEW-SUFFIX.
 15262
 15263     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15264     PERFORM 8600-DEEDIT.
 15265     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15266     MOVE '4'                    TO DC-OPTION-CODE.
 15267
 15268     PERFORM 9700-DATE-LINK.
 15269
 15270     IF DATE-CONVERSION-ERROR
 15271        MOVE ER-0348             TO EMI-ERROR
 15272        MOVE -1                  TO CEFFDTL
 15273        MOVE AL-UABON            TO CEFFDTA
 15274        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15275        GO TO 8200-SEND-DATAONLY
 15276     ELSE
 15277        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15278        MOVE AL-UANON            TO CEFFDTA
 15279        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15280
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 279
* EL6311.cbl
 15281 2325-PROCESS-CANCEL-CHANGES.
 15282
 15283* EXEC CICS HANDLE CONDITION
 15284*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15285*    END-EXEC.
 15286*    MOVE '"$I                   ! 5 #00013678' TO DFHEIV0
 15287     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15288     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15289     MOVE X'3520233030303133363738' TO DFHEIV0(25:11)
 15290     CALL 'kxdfhei1' USING DFHEIV0
 15291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15292
 15293
 15294     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15295     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15296     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15297
 15298
 15299* EXEC CICS GETMAIN
 15300*        SET      (ADDRESS OF PENDING-BUSINESS)
 15301*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15302*        INITIMG  (GETMAIN-SPACE)
 15303*     END-EXEC.
 15304*    MOVE ',"IL                  $   #00013686' TO DFHEIV0
 15305     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15306     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15307     MOVE X'2020233030303133363836' TO DFHEIV0(25:11)
 15308     CALL 'kxdfhei1' USING DFHEIV0,
 15309           DFHEIV20,
 15310           ERPNDB-RECORD-LENGTH,
 15311           GETMAIN-SPACE
 15312     SET ADDRESS OF PENDING-BUSINESS TO
 15313         DFHEIV20
 15314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15315
 15316
 15317
 15318* EXEC CICS READ
 15319*        INTO    (PENDING-BUSINESS)
 15320*        DATASET (FILE-ID-ERPNDB)
 15321*        RIDFLD  (ERPNDB-KEY)
 15322*    END-EXEC.
 15323     MOVE LENGTH OF
 15324      PENDING-BUSINESS
 15325       TO DFHEIV11
 15326*    MOVE '&"IL       E          (   #00013692' TO DFHEIV0
 15327     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15329     MOVE X'2020233030303133363932' TO DFHEIV0(25:11)
 15330     CALL 'kxdfhei1' USING DFHEIV0,
 15331           FILE-ID-ERPNDB,
 15332           PENDING-BUSINESS,
 15333           DFHEIV11,
 15334           ERPNDB-KEY,
 15335           DFHEIV99,
 15336           DFHEIV99,
 15337           DFHEIV99
 15338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 280
* EL6311.cbl
 15339
 15340
 15341     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15342
 15343
 15344* EXEC CICS HANDLE CONDITION
 15345*         NOTFND     (2385-REC-NOT-FOUND)
 15346*    END-EXEC.
 15347*    MOVE '"$I                   ! 6 #00013700' TO DFHEIV0
 15348     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15349     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15350     MOVE X'3620233030303133373030' TO DFHEIV0(25:11)
 15351     CALL 'kxdfhei1' USING DFHEIV0
 15352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15353
 15354
 15355**********************************************************
 15356*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15357*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15358**********************************************************
 15359
 15360
 15361* EXEC CICS READ
 15362*        DATASET (FILE-ID-ERPNDB)
 15363*        INTO    (PENDING-BUSINESS)
 15364*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15365*    END-EXEC.
 15366     MOVE LENGTH OF
 15367      PENDING-BUSINESS
 15368       TO DFHEIV11
 15369*    MOVE '&"IL       E          (   #00013709' TO DFHEIV0
 15370     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15371     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15372     MOVE X'2020233030303133373039' TO DFHEIV0(25:11)
 15373     CALL 'kxdfhei1' USING DFHEIV0,
 15374           FILE-ID-ERPNDB,
 15375           PENDING-BUSINESS,
 15376           DFHEIV11,
 15377           PI-PREV-CONTROL-PRIMARY,
 15378           DFHEIV99,
 15379           DFHEIV99,
 15380           DFHEIV99
 15381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15382
 15383
 15384********** DO NOT ALLOW CHANGES IF THRU A/R
 15385     IF BMAINTI = 'C'
 15386         IF PB-EL860-INTERNAL-PROCESS
 15387             MOVE ER-4005          TO EMI-ERROR
 15388             MOVE -1               TO BMAINTL
 15389             MOVE AL-UABON         TO BMAINTA
 15390             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15391             GO TO 8200-SEND-DATAONLY.
 15392**********
 15393
 15394     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15395        MOVE -1                 TO CMAINTL
 15396        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 281
* EL6311.cbl
 15397        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15398        GO TO 8200-SEND-DATAONLY.
 15399
 15400     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15401        MOVE ER-2196             TO EMI-ERROR
 15402        MOVE AL-UABON            TO CMAINTA
 15403        MOVE -1                  TO CMAINTL
 15404        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15405        GO TO 8200-SEND-DATAONLY.
 15406     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15407
 15408     IF PB-BILLED-DT = LOW-VALUES AND
 15409        PB-CHG-COUNT = ZEROS
 15410        NEXT SENTENCE
 15411     ELSE
 15412        IF (CREFND1L GREATER THAN ZEROS AND
 15413            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15414           OR
 15415           (CREFND2L GREATER THAN ZEROS AND
 15416            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15417           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15418     if ((crefnd1l <> zeros)
 15419        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15420                      or
 15421        ((crefnd2l <> zeros)
 15422        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15423        continue
 15424     else
 15425        go to 2330-continue-change
 15426     end-if
 15427
 15428     move zeros                  to ws-check-amts
 15429     move ' '                    to ws-stop-sw
 15430                                    ws-check-sw
 15431                                    ws-proc-check-sw
 15432                                    ws-chek-browse-sw
 15433
 15434     perform 2500-browse-checks  thru 2500-exit
 15435
 15436     if i-have-processed-checks
 15437        or i-have-checks
 15438        continue
 15439     else
 15440        go to 2330-continue-change
 15441     end-if
 15442
 15443     if crefnd1l <> zeros
 15444        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15445        move ws-crefnd1 to ws-new-ref-total
 15446     else
 15447        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15448     end-if
 15449     if crefnd2l <> zeros
 15450        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15451        compute ws-new-ref-total = ws-new-ref-total +
 15452           ws-crefnd2
 15453     else
 15454        compute ws-new-ref-total = ws-new-ref-total +
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 282
* EL6311.cbl
 15455           pb-c-ah-cancel-amt
 15456     end-if
 15457
 15458     if zeros = (ws-lf-diff + ws-ah-diff)
 15459        move er-3449             to emi-error
 15460        perform 9900-error-format thru 9900-exit
 15461        go to 2330-continue-change
 15462     end-if
 15463
 15464     if (ws-new-ref-total < ws-check-amts)
 15465        and (pb-c-refund-sw = 'Y')
 15466        move er-3447             to emi-error
 15467        perform 9900-error-format thru 9900-exit
 15468        move al-uabon            to cmainta
 15469        move -1                  to cmaintl
 15470        go to 8200-send-dataonly
 15471     end-if
 15472
 15473     if (ws-new-ref-total > ws-check-amts)
 15474        and (ws-check-amts not = zeros)
 15475        move er-3448             to emi-error
 15476        move al-uabon            to crefnd1a
 15477                                    crefnd2a
 15478        perform 9900-error-format thru 9900-exit
 15479     end-if
 15480
 15481*     if (ws-lf-diff + ws-ah-diff) < zeros
 15482*        move er-3447             to emi-error
 15483*        perform 9900-error-format thru 9900-exit
 15484*        move al-uabon            to cmainta
 15485*        move -1                  to cmaintl
 15486*        go to 8200-send-dataonly
 15487*     end-if
 15488     .
 15489 2330-continue-change.
 15490
 15491
 15492* EXEC CICS READ
 15493*        DATASET (FILE-ID-ERPNDB)
 15494*        INTO    (PENDING-BUSINESS)
 15495*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15496*        UPDATE
 15497*    END-EXEC.
 15498     MOVE LENGTH OF
 15499      PENDING-BUSINESS
 15500       TO DFHEIV11
 15501*    MOVE '&"IL       EU         (   #00013822' TO DFHEIV0
 15502     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15503     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15504     MOVE X'2020233030303133383232' TO DFHEIV0(25:11)
 15505     CALL 'kxdfhei1' USING DFHEIV0,
 15506           FILE-ID-ERPNDB,
 15507           PENDING-BUSINESS,
 15508           DFHEIV11,
 15509           PI-PREV-CONTROL-PRIMARY,
 15510           DFHEIV99,
 15511           DFHEIV99,
 15512           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 283
* EL6311.cbl
 15513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15514
 15515
 15516     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15517     MOVE 'B'                    TO JP-RECORD-TYPE
 15518     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15519     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15520
 15521     PERFORM 8400-LOG-JOURNAL-RECORD.
 15522
 15523     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15524          PB-CHG-COUNT NOT = ZEROS
 15525        IF (CREFND1L GREATER THAN ZEROS AND
 15526            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15527           OR
 15528           (CREFND2L GREATER THAN ZEROS AND
 15529            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15530            ADD +1                      TO PB-CHG-COUNT
 15531            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15532
 15533*    IF CMICRNOL  GREATER  ZEROS
 15534*        IF CMICRNOI  NUMERIC
 15535*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15536*            MOVE AL-UNNON       TO  CMICRNOA
 15537*        ELSE
 15538*            MOVE -1             TO  CMICRNOL
 15539*            MOVE AL-UNBON       TO  CMICRNOA
 15540*            MOVE ER-2701        TO  EMI-ERROR
 15541*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15542
 15543     IF CSUFIXL GREATER THAN ZEROS
 15544        MOVE CSUFIXI             TO PB-CERT-SFX.
 15545
 15546     IF CLSTNML GREATER THAN ZEROS
 15547         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15548
 15549     IF CCANREAL > ZEROS
 15550        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15551     END-IF
 15552     IF CPCYNL > ZEROS
 15553        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15554     END-IF
 15555     IF CCANDT1L    GREATER THAN ZEROS
 15556        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15557
 15558     IF CCANDT2L    GREATER THAN ZEROS
 15559        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15560
 15561     IF CMTHD1L    GREATER THAN +0
 15562        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15563
 15564     IF CMTHD2L    GREATER THAN +0
 15565        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15566
 15567     IF CREFND1L    GREATER THAN ZEROS
 15568        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15569        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15570        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 284
* EL6311.cbl
 15571        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15572
 15573     IF CREFND2L    GREATER THAN ZEROS
 15574        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15575        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15576        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15577        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15578
 15579     IF CLIVESL     GREATER THAN ZEROS
 15580        MOVE WS-CLIVES           TO PB-C-LIVES.
 15581
 15582     IF CPAYEEL     GREATER THAN ZEROS
 15583        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15584
 15585     IF CFORCEL     GREATER THAN ZEROS
 15586        MOVE CFORCEI             TO PB-FORCE-CODE.
 15587
 15588     IF CBILCDL     GREATER THAN ZEROS
 15589        MOVE CBILCDI             TO PB-RECORD-BILL.
 15590
 15591 2360-REWRITE-PB-RECORD.
 15592     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15593     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15594     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15595     MOVE 'C'                    TO JP-RECORD-TYPE.
 15596     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15597     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15598     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15599
 15600     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15601
 15602     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15603     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15604
 15605     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15606
 15607     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15608
 15609     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15610     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15611     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15612
 15613     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15614     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15615
 15616 2375-REWRITE-PENDING-BUSINESS.
 15617     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15618     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15619     MOVE 'C'                    TO JP-RECORD-TYPE.
 15620     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15621
 15622
 15623* EXEC CICS REWRITE
 15624*        DATASET (FILE-ID-ERPNDB)
 15625*        FROM    (PENDING-BUSINESS)
 15626*    END-EXEC.
 15627     MOVE LENGTH OF
 15628      PENDING-BUSINESS
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 285
* EL6311.cbl
 15629       TO DFHEIV11
 15630*    MOVE '&& L                  %   #00013935' TO DFHEIV0
 15631     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15632     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15633     MOVE X'2020233030303133393335' TO DFHEIV0(25:11)
 15634     CALL 'kxdfhei1' USING DFHEIV0,
 15635           FILE-ID-ERPNDB,
 15636           PENDING-BUSINESS,
 15637           DFHEIV11,
 15638           DFHEIV99
 15639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15640
 15641
 15642     PERFORM 8400-LOG-JOURNAL-RECORD.
 15643
 15644******************************************************************
 15645*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15646******************************************************************
 15647
 15648     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15649     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15650     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15651     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15652
 15653
 15654* EXEC CICS READ
 15655*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15656*        DATASET (FILE-ID-ELCERT)
 15657*        RIDFLD  (ELCERT-KEY)
 15658*        RESP    (WS-RESPONSE)
 15659*    END-EXEC.
 15660*    MOVE '&"S        E          (  N#00013951' TO DFHEIV0
 15661     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15662     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15663     MOVE X'204E233030303133393531' TO DFHEIV0(25:11)
 15664     CALL 'kxdfhei1' USING DFHEIV0,
 15665           FILE-ID-ELCERT,
 15666           DFHEIV20,
 15667           DFHEIV99,
 15668           ELCERT-KEY,
 15669           DFHEIV99,
 15670           DFHEIV99,
 15671           DFHEIV99
 15672     SET ADDRESS OF CERTIFICATE-MASTER TO
 15673         DFHEIV20
 15674     MOVE EIBRESP  TO WS-RESPONSE
 15675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15676
 15677
 15678     IF NOT RESP-NORMAL
 15679        GO TO 2376-BYPASS-CRTO
 15680     END-IF
 15681
 15682
 15683     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15684     MOVE ' '                    TO WS-ERMAIL-SW
 15685
 15686
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 286
* EL6311.cbl
 15687* EXEC CICS READ
 15688*       DATASET   (FILE-ID-ERMAIL)
 15689*       SET       (ADDRESS OF MAILING-DATA)
 15690*       RIDFLD    (ERMAIL-KEY)
 15691*       RESP      (WS-RESPONSE)
 15692*    END-EXEC
 15693*    MOVE '&"S        E          (  N#00013966' TO DFHEIV0
 15694     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15695     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15696     MOVE X'204E233030303133393636' TO DFHEIV0(25:11)
 15697     CALL 'kxdfhei1' USING DFHEIV0,
 15698           FILE-ID-ERMAIL,
 15699           DFHEIV20,
 15700           DFHEIV99,
 15701           ERMAIL-KEY,
 15702           DFHEIV99,
 15703           DFHEIV99,
 15704           DFHEIV99
 15705     SET ADDRESS OF MAILING-DATA TO
 15706         DFHEIV20
 15707     MOVE EIBRESP  TO WS-RESPONSE
 15708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15709
 15710     IF RESP-NORMAL
 15711        SET ERMAIL-FOUND TO TRUE
 15712     END-IF
 15713
 15714     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15715
 15716     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15717                                 TO ELCRTO-KEY
 15718     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15719     MOVE +0                     TO ELCRTO-SEQ-NO
 15720
 15721
 15722* EXEC CICS READ
 15723*       DATASET   ('ELCRTO')
 15724*       INTO      (ORIGINAL-CERTIFICATE)
 15725*       RIDFLD    (ELCRTO-KEY)
 15726*       GTEQ
 15727*       RESP      (WS-RESPONSE)
 15728*    END-EXEC
 15729     MOVE LENGTH OF
 15730      ORIGINAL-CERTIFICATE
 15731       TO DFHEIV11
 15732     MOVE 'ELCRTO' TO DFHEIV1
 15733*    MOVE '&"IL       G          (  N#00013984' TO DFHEIV0
 15734     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15735     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15736     MOVE X'204E233030303133393834' TO DFHEIV0(25:11)
 15737     CALL 'kxdfhei1' USING DFHEIV0,
 15738           DFHEIV1,
 15739           ORIGINAL-CERTIFICATE,
 15740           DFHEIV11,
 15741           ELCRTO-KEY,
 15742           DFHEIV99,
 15743           DFHEIV99,
 15744           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 287
* EL6311.cbl
 15745     MOVE EIBRESP  TO WS-RESPONSE
 15746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15747
 15748     IF RESP-NORMAL
 15749        AND (OC-CONTROL-PRIMARY (1:33) =
 15750                 PB-CONTROL-BY-ACCOUNT (1:33))
 15751        AND (OC-RECORD-TYPE = 'I')
 15752        display ' resp norm, key =, type i '
 15753        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15754           display ' end proc blank '
 15755           display ' csr edit session ' PI-CSR-SESSION-SW
 15756           IF NOT CSR-EDIT-SESSION
 15757
 15758* EXEC CICS READ
 15759*                DATASET   ('ELCRTO')
 15760*                INTO      (ORIGINAL-CERTIFICATE)
 15761*                RIDFLD    (OC-CONTROL-PRIMARY)
 15762*                UPDATE
 15763*                RESP      (WS-RESPONSE)
 15764*             END-EXEC
 15765     MOVE LENGTH OF
 15766      ORIGINAL-CERTIFICATE
 15767       TO DFHEIV11
 15768     MOVE 'ELCRTO' TO DFHEIV1
 15769*    MOVE '&"IL       EU         (  N#00014001' TO DFHEIV0
 15770     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15771     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15772     MOVE X'204E233030303134303031' TO DFHEIV0(25:11)
 15773     CALL 'kxdfhei1' USING DFHEIV0,
 15774           DFHEIV1,
 15775           ORIGINAL-CERTIFICATE,
 15776           DFHEIV11,
 15777           OC-CONTROL-PRIMARY,
 15778           DFHEIV99,
 15779           DFHEIV99,
 15780           DFHEIV99
 15781     MOVE EIBRESP  TO WS-RESPONSE
 15782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15783              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15784              IF RESP-NORMAL
 15785                 display ' good read upd '
 15786                 IF OC-ISSUE-TRAN-IND = 'N'
 15787                    MOVE CM-INSURED-LAST-NAME   TO
 15788                         OC-INS-LAST-NAME
 15789                    MOVE CM-INSURED-FIRST-NAME  TO
 15790                         OC-INS-FIRST-NAME
 15791                    MOVE CM-INSURED-INITIAL2    TO
 15792                         OC-INS-MIDDLE-INIT
 15793                    MOVE CM-INSURED-ISSUE-AGE   TO
 15794                         OC-INS-AGE
 15795                    MOVE CM-JT-LAST-NAME        TO
 15796                         OC-JNT-LAST-NAME
 15797                    MOVE CM-JT-FIRST-NAME       TO
 15798                         OC-JNT-FIRST-NAME
 15799                    MOVE CM-JT-INITIAL          TO
 15800                         OC-JNT-MIDDLE-INIT
 15801                    MOVE CM-INSURED-JOINT-AGE   TO
 15802                         OC-JNT-AGE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 288
* EL6311.cbl
 15803                    MOVE CM-LF-BENEFIT-CD       TO
 15804                         OC-LF-BENCD
 15805                    MOVE CM-LF-ORIG-TERM        TO
 15806                         OC-LF-TERM
 15807                    MOVE CM-LF-BENEFIT-AMT      TO
 15808                         OC-LF-BEN-AMT
 15809                    MOVE CM-LF-PREMIUM-AMT      TO
 15810                         OC-LF-PRM-AMT
 15811                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15812                         OC-LF-ALT-BEN-AMT
 15813                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15814                         OC-LF-ALT-PRM-AMT
 15815                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15816                         OC-LF-EXP-DT
 15817                    MOVE CM-LIFE-COMM-PCT       TO
 15818                         OC-LF-COMM-PCT
 15819                    MOVE CM-AH-BENEFIT-CD       TO
 15820                         OC-AH-BENCD
 15821                    MOVE CM-AH-ORIG-TERM        TO
 15822                         OC-AH-TERM
 15823                    MOVE CM-AH-BENEFIT-AMT      TO
 15824                         OC-AH-BEN-AMT
 15825                    MOVE CM-AH-PREMIUM-AMT      TO
 15826                         OC-AH-PRM-AMT
 15827                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15828                         OC-AH-EXP-DT
 15829                    MOVE CM-AH-COMM-PCT         TO
 15830                         OC-AH-COMM-PCT
 15831                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15832                         OC-AH-CP
 15833                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15834                         OC-1ST-PMT-DT
 15835                 END-IF
 15836                 MOVE PB-C-LF-CANCEL-DT      TO
 15837                         OC-LF-CANCEL-DT
 15838                 MOVE PB-C-LF-CANCEL-AMT     TO
 15839                         OC-LF-CANCEL-AMT
 15840                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15841                         OC-LF-ITD-CANCEL-AMT
 15842                 MOVE PB-C-AH-CANCEL-DT      TO
 15843                         OC-AH-CANCEL-DT
 15844                 MOVE PB-C-AH-CANCEL-AMT     TO
 15845                         OC-AH-CANCEL-AMT
 15846                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15847                         OC-AH-ITD-CANCEL-AMT
 15848                 MOVE 'Y'                    TO
 15849                         OC-CANCEL-TRAN-IND
 15850                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15851                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15852                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15853                 IF ERMAIL-FOUND
 15854                    MOVE MA-CRED-BENE-NAME
 15855                                 TO OC-CRED-BENE-NAME
 15856                 END-IF
 15857                 IF NOT CERT-TRL-REC-NOT-FOUND
 15858                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15859                           OC-INS-AGE-DEFAULT-FLAG
 15860                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 289
* EL6311.cbl
 15861                           OC-JNT-AGE-DEFAULT-FLAG
 15862                 END-IF
 15863
 15864* EXEC CICS REWRITE
 15865*                   DATASET   ('ELCRTO')
 15866*                   FROM      (ORIGINAL-CERTIFICATE)
 15867*                   RESP      (WS-RESPONSE)
 15868*                END-EXEC
 15869     MOVE LENGTH OF
 15870      ORIGINAL-CERTIFICATE
 15871       TO DFHEIV11
 15872     MOVE 'ELCRTO' TO DFHEIV1
 15873*    MOVE '&& L                  %  N#00014088' TO DFHEIV0
 15874     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15875     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15876     MOVE X'204E233030303134303838' TO DFHEIV0(25:11)
 15877     CALL 'kxdfhei1' USING DFHEIV0,
 15878           DFHEIV1,
 15879           ORIGINAL-CERTIFICATE,
 15880           DFHEIV11,
 15881           DFHEIV99
 15882     MOVE EIBRESP  TO WS-RESPONSE
 15883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15884                 display ' just rewrote ' ws-response
 15885              END-IF
 15886           END-IF
 15887        ELSE
 15888           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15889           MOVE 'OC'             TO OC-RECORD-ID
 15890           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15891           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15892           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15893           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15894           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15895           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15896           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15897           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15898           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15899           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15900           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15901           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15902           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15903           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15904           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15905           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15906           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15907           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15908           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15909           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15910           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15911           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15912           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15913           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15914           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15915           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15916           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15917           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15918           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 290
* EL6311.cbl
 15919           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15920           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15921           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15922           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15923           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15924           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15925           IF ERMAIL-FOUND
 15926              MOVE MA-CRED-BENE-NAME
 15927                                 TO OC-CRED-BENE-NAME
 15928           END-IF
 15929           IF NOT CERT-TRL-REC-NOT-FOUND
 15930              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15931                           OC-INS-AGE-DEFAULT-FLAG
 15932              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15933                           OC-JNT-AGE-DEFAULT-FLAG
 15934           END-IF
 15935           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15936
 15937* EXEC CICS WRITE
 15938*             DATASET   ('ELCRTO')
 15939*             FROM      (ORIGINAL-CERTIFICATE)
 15940*             RIDFLD    (OC-CONTROL-PRIMARY)
 15941*             RESP      (WS-RESPONSE)
 15942*          END-EXEC
 15943     MOVE LENGTH OF
 15944      ORIGINAL-CERTIFICATE
 15945       TO DFHEIV11
 15946     MOVE 'ELCRTO' TO DFHEIV1
 15947*    MOVE '&$ L                  ''  N#00014145' TO DFHEIV0
 15948     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15949     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15950     MOVE X'204E233030303134313435' TO DFHEIV0(25:11)
 15951     CALL 'kxdfhei1' USING DFHEIV0,
 15952           DFHEIV1,
 15953           ORIGINAL-CERTIFICATE,
 15954           DFHEIV11,
 15955           OC-CONTROL-PRIMARY,
 15956           DFHEIV99,
 15957           DFHEIV99
 15958     MOVE EIBRESP  TO WS-RESPONSE
 15959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15960        END-IF
 15961     ELSE
 15962        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15963        MOVE 'OC'                TO OC-RECORD-ID
 15964        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15965                                 TO OC-CONTROL-PRIMARY (1:33)
 15966        MOVE 'I'                 TO OC-RECORD-TYPE
 15967        MOVE +4096               TO OC-KEY-SEQ-NO
 15968        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15969        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15970        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15971        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15972        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15973        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15974        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15975        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15976        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 291
* EL6311.cbl
 15977        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15978        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15979        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15980        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15981        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15982        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15983        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15984        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15985        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15986        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15987        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15988        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15989        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15990        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15991        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15992        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15993        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15994        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15995        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15996        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15997        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15998        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15999        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16000        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16001        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16002        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16003        IF ERMAIL-FOUND
 16004           MOVE MA-CRED-BENE-NAME
 16005                                 TO OC-CRED-BENE-NAME
 16006        END-IF
 16007        IF NOT CERT-TRL-REC-NOT-FOUND
 16008           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16009                           OC-INS-AGE-DEFAULT-FLAG
 16010           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16011                           OC-JNT-AGE-DEFAULT-FLAG
 16012        END-IF
 16013        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 16014
 16015
 16016* EXEC CICS WRITE
 16017*          DATASET   ('ELCRTO')
 16018*          FROM      (ORIGINAL-CERTIFICATE)
 16019*          RIDFLD    (OC-CONTROL-PRIMARY)
 16020*          RESP      (WS-RESPONSE)
 16021*       END-EXEC
 16022     MOVE LENGTH OF
 16023      ORIGINAL-CERTIFICATE
 16024       TO DFHEIV11
 16025     MOVE 'ELCRTO' TO DFHEIV1
 16026*    MOVE '&$ L                  ''  N#00014206' TO DFHEIV0
 16027     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16028     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16029     MOVE X'204E233030303134323036' TO DFHEIV0(25:11)
 16030     CALL 'kxdfhei1' USING DFHEIV0,
 16031           DFHEIV1,
 16032           ORIGINAL-CERTIFICATE,
 16033           DFHEIV11,
 16034           OC-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 292
* EL6311.cbl
 16035           DFHEIV99,
 16036           DFHEIV99
 16037     MOVE EIBRESP  TO WS-RESPONSE
 16038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16039     END-IF.
 16040
 16041 2376-BYPASS-CRTO.
 16042******************************************************************
 16043*       U P D A T E   T H E   B A T C H   H E A D E R            *
 16044******************************************************************
 16045
 16046
 16047* EXEC CICS HANDLE CONDITION
 16048*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 16049*    END-EXEC.
 16050*    MOVE '"$I                   ! 7 #00014219' TO DFHEIV0
 16051     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16052     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16053     MOVE X'3720233030303134323139' TO DFHEIV0(25:11)
 16054     CALL 'kxdfhei1' USING DFHEIV0
 16055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16056
 16057
 16058
 16059* EXEC CICS READ
 16060*        INTO    (PENDING-BUSINESS)
 16061*        DATASET (FILE-ID-ERPNDB)
 16062*        RIDFLD  (ERPNDB-KEY)
 16063*        UPDATE
 16064*    END-EXEC.
 16065     MOVE LENGTH OF
 16066      PENDING-BUSINESS
 16067       TO DFHEIV11
 16068*    MOVE '&"IL       EU         (   #00014223' TO DFHEIV0
 16069     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16070     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16071     MOVE X'2020233030303134323233' TO DFHEIV0(25:11)
 16072     CALL 'kxdfhei1' USING DFHEIV0,
 16073           FILE-ID-ERPNDB,
 16074           PENDING-BUSINESS,
 16075           DFHEIV11,
 16076           ERPNDB-KEY,
 16077           DFHEIV99,
 16078           DFHEIV99,
 16079           DFHEIV99
 16080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16081
 16082
 16083     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16084     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16085     MOVE 'B'                    TO JP-RECORD-TYPE.
 16086     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16087
 16088     PERFORM 8400-LOG-JOURNAL-RECORD.
 16089
 16090     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16091
 16092
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 293
* EL6311.cbl
 16093* EXEC CICS REWRITE
 16094*        DATASET (FILE-ID-ERPNDB)
 16095*        FROM    (PENDING-BUSINESS)
 16096*    END-EXEC.
 16097     MOVE LENGTH OF
 16098      PENDING-BUSINESS
 16099       TO DFHEIV11
 16100*    MOVE '&& L                  %   #00014239' TO DFHEIV0
 16101     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16102     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16103     MOVE X'2020233030303134323339' TO DFHEIV0(25:11)
 16104     CALL 'kxdfhei1' USING DFHEIV0,
 16105           FILE-ID-ERPNDB,
 16106           PENDING-BUSINESS,
 16107           DFHEIV11,
 16108           DFHEIV99
 16109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16110
 16111
 16112     MOVE 'C'                    TO JP-RECORD-TYPE.
 16113     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16114
 16115     PERFORM 8400-LOG-JOURNAL-RECORD.
 16116
 16117     IF WS-ERRORS-PRESENT
 16118         GO TO 3900-RE-DISPLAY-RECORD.
 16119
 16120     MOVE ZEROS                  TO EMI-ERROR
 16121     MOVE -1                     TO CMAINTL
 16122     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16123     GO TO 3900-RE-DISPLAY-RECORD.
 16124
 16125 2380-BATCH-HDR-NOT-FOUND.
 16126     MOVE -1                     TO BMAINTL.
 16127     MOVE ER-7450                TO EMI-ERROR.
 16128     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16129     GO TO 8200-SEND-DATAONLY.
 16130
 16131 2385-REC-NOT-FOUND.
 16132     MOVE -1                     TO BMAINTL.
 16133     MOVE ER-7451                TO EMI-ERROR.
 16134     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16135     GO TO 8200-SEND-DATAONLY.
 16136
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 294
* EL6311.cbl
 16138
 16139******************************************************************
 16140*                                                                *
 16141*          D E L E T E   C A N C E L   R O U T I N E             *
 16142*                                                                *
 16143******************************************************************
 16144
 16145 2400-DELETE-CANCEL-ROUTINE.
 16146     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16147
 16148     IF CCHGL NOT = ZEROS
 16149        MOVE ER-2196             TO EMI-ERROR
 16150        MOVE AL-UABON            TO CMAINTA
 16151        MOVE -1                  TO CMAINTL
 16152        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16153        GO TO 8200-SEND-DATAONLY.
 16154
 16155
 16156* EXEC CICS HANDLE CONDITION
 16157*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16158*    END-EXEC.
 16159*    MOVE '"$I                   ! 8 #00014287' TO DFHEIV0
 16160     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16162     MOVE X'3820233030303134323837' TO DFHEIV0(25:11)
 16163     CALL 'kxdfhei1' USING DFHEIV0
 16164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16165
 16166
 16167     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16168     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16169     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16170
 16171
 16172* EXEC CICS READ
 16173*        SET     (ADDRESS OF PENDING-BUSINESS)
 16174*        DATASET (FILE-ID-ERPNDB)
 16175*        RIDFLD  (ERPNDB-KEY)
 16176*    END-EXEC.
 16177*    MOVE '&"S        E          (   #00014295' TO DFHEIV0
 16178     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16179     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16180     MOVE X'2020233030303134323935' TO DFHEIV0(25:11)
 16181     CALL 'kxdfhei1' USING DFHEIV0,
 16182           FILE-ID-ERPNDB,
 16183           DFHEIV20,
 16184           DFHEIV99,
 16185           ERPNDB-KEY,
 16186           DFHEIV99,
 16187           DFHEIV99,
 16188           DFHEIV99
 16189     SET ADDRESS OF PENDING-BUSINESS TO
 16190         DFHEIV20
 16191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16192
 16193
 16194     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16195
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 295
* EL6311.cbl
 16196     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16197
 16198     IF CSUFIXL NOT = ZEROS
 16199        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16200     ELSE
 16201        MOVE SPACE               TO WS-NEW-SUFFIX.
 16202
 16203     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16204
 16205     PERFORM 8600-DEEDIT.
 16206     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16207     MOVE '4'                    TO DC-OPTION-CODE.
 16208     PERFORM 9700-DATE-LINK.
 16209
 16210     IF DATE-CONVERSION-ERROR
 16211        MOVE ER-0348             TO EMI-ERROR
 16212        MOVE -1                  TO CEFFDTL
 16213        MOVE AL-UABON            TO CEFFDTA
 16214        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16215        GO TO 8200-SEND-DATAONLY
 16216     ELSE
 16217        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16218        MOVE AL-UANON            TO CEFFDTA
 16219        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16220
 16221
 16222* EXEC CICS HANDLE CONDITION
 16223*         NOTFND    (2490-RECORD-NOT-FOUND)
 16224*    END-EXEC.
 16225*    MOVE '"$I                   ! 9 #00014328' TO DFHEIV0
 16226     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16227     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16228     MOVE X'3920233030303134333238' TO DFHEIV0(25:11)
 16229     CALL 'kxdfhei1' USING DFHEIV0
 16230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16231
 16232
 16233
 16234* EXEC CICS READ
 16235*        SET     (ADDRESS OF PENDING-BUSINESS)
 16236*        DATASET (FILE-ID-ERPNDB)
 16237*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16238*        UPDATE
 16239*    END-EXEC.
 16240*    MOVE '&"S        EU         (   #00014332' TO DFHEIV0
 16241     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16242     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16243     MOVE X'2020233030303134333332' TO DFHEIV0(25:11)
 16244     CALL 'kxdfhei1' USING DFHEIV0,
 16245           FILE-ID-ERPNDB,
 16246           DFHEIV20,
 16247           DFHEIV99,
 16248           PI-PREV-CONTROL-PRIMARY,
 16249           DFHEIV99,
 16250           DFHEIV99,
 16251           DFHEIV99
 16252     SET ADDRESS OF PENDING-BUSINESS TO
 16253         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 296
* EL6311.cbl
 16254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16255
 16256
 16257     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16258        MOVE -1                 TO CMAINTL
 16259        MOVE ER-2197            TO EMI-ERROR
 16260        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16261        GO TO 8200-SEND-DATAONLY.
 16262
 16263     IF PB-BILLED-DT NOT = LOW-VALUES
 16264        MOVE -1                 TO CMAINTL
 16265        MOVE ER-2129            TO EMI-ERROR
 16266        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16267        GO TO 8200-SEND-DATAONLY.
 16268
 16269     IF PB-CHG-COUNT NOT = ZEROS
 16270        MOVE ER-2336            TO EMI-ERROR
 16271        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16272        MOVE AL-UABON            TO CMAINTA
 16273        MOVE -1                  TO CMAINTL
 16274        GO TO 8200-SEND-DATAONLY.
 16275
 16276     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16277        PB-CHG-COUNT NOT = ZEROS
 16278        MOVE ER-2196             TO EMI-ERROR
 16279        MOVE AL-UABON            TO CMAINTA
 16280        MOVE -1                  TO CMAINTL
 16281        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16282        GO TO 8200-SEND-DATAONLY.
 16283
 16284     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16285        MOVE ER-2900 TO EMI-ERROR
 16286        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16287        MOVE AL-UABON         TO CMAINTA
 16288        MOVE -1               TO CMAINTL
 16289        GO TO 8200-SEND-DATAONLY.
 16290     move ' '                    to ws-stop-sw
 16291                                    ws-check-sw
 16292                                    ws-proc-check-sw
 16293                                    ws-chek-browse-sw
 16294
 16295     perform 2500-browse-checks  thru 2500-exit
 16296     if (i-have-processed-checks)
 16297        and (pb-c-refund-sw = 'Y')
 16298        move er-3446             to emi-error
 16299        perform 9900-error-format thru 9900-exit
 16300        move al-uabon            to cmainta
 16301        move -1                  to cmaintl
 16302        go to 8200-send-dataonly
 16303     end-if
 16304
 16305* EXEC CICS HANDLE CONDITION
 16306*         NOTFND  (2475-CONTINUE-DELETE)
 16307*    END-EXEC
 16308*    MOVE '"$I                   ! : #00014386' TO DFHEIV0
 16309     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16310     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16311     MOVE X'3A20233030303134333836' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 297
* EL6311.cbl
 16312     CALL 'kxdfhei1' USING DFHEIV0
 16313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16314
 16315     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16316     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16317     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16318     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16319
 16320
 16321* EXEC CICS READ
 16322*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16323*        DATASET (FILE-ID-ELCERT)
 16324*        RIDFLD  (ELCERT-KEY)
 16325*        UPDATE
 16326*    END-EXEC.
 16327*    MOVE '&"S        EU         (   #00014395' TO DFHEIV0
 16328     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16329     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16330     MOVE X'2020233030303134333935' TO DFHEIV0(25:11)
 16331     CALL 'kxdfhei1' USING DFHEIV0,
 16332           FILE-ID-ELCERT,
 16333           DFHEIV20,
 16334           DFHEIV99,
 16335           ELCERT-KEY,
 16336           DFHEIV99,
 16337           DFHEIV99,
 16338           DFHEIV99
 16339     SET ADDRESS OF CERTIFICATE-MASTER TO
 16340         DFHEIV20
 16341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16342
 16343
 16344     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16345
 16346     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16347     MOVE 'B'                    TO JP-RECORD-TYPE.
 16348     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16349     PERFORM 8400-LOG-JOURNAL-RECORD.
 16350
 16351     IF PB-CI-LIVES NOT NUMERIC
 16352         MOVE ZERO                    TO PB-CI-LIVES.
 16353
 16354     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16355        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16356           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16357           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16358           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16359                                            CM-LF-CANCEL-DT
 16360           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16361        ELSE
 16362           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16363           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16364           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16365           MOVE PB-CI-LIVES              TO CM-LIVES.
 16366
 16367     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16368        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16369           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 298
* EL6311.cbl
 16370               MOVE CM-LF-STATUS-AT-CANCEL
 16371                                        TO CM-LF-CURRENT-STATUS
 16372               MOVE SPACE
 16373                                        TO CM-LF-STATUS-AT-CANCEL
 16374           ELSE
 16375               MOVE PB-CI-LF-POLICY-STATUS
 16376                                        TO CM-LF-CURRENT-STATUS
 16377        ELSE
 16378           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16379
 16380
 16381     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16382        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16383           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16384           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16385           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16386                                            CM-AH-CANCEL-DT
 16387           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16388        ELSE
 16389           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16390           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16391           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16392           MOVE PB-CI-LIVES              TO CM-LIVES.
 16393
 16394     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16395        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16396           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16397               MOVE CM-AH-STATUS-AT-CANCEL
 16398                                        TO CM-AH-CURRENT-STATUS
 16399               MOVE SPACE
 16400                                        TO CM-AH-STATUS-AT-CANCEL
 16401           ELSE
 16402               MOVE PB-CI-AH-POLICY-STATUS
 16403                                        TO CM-AH-CURRENT-STATUS
 16404        ELSE
 16405           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16406
 16407 2450-REWRITE-CERT.
 16408     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16409     MOVE 'C'                      TO JP-RECORD-TYPE.
 16410     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16411
 16412
 16413* EXEC CICS REWRITE
 16414*        DATASET  (FILE-ID-ELCERT)
 16415*        FROM     (CERTIFICATE-MASTER)
 16416*    END-EXEC.
 16417     MOVE LENGTH OF
 16418      CERTIFICATE-MASTER
 16419       TO DFHEIV11
 16420*    MOVE '&& L                  %   #00014470' TO DFHEIV0
 16421     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16422     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16423     MOVE X'2020233030303134343730' TO DFHEIV0(25:11)
 16424     CALL 'kxdfhei1' USING DFHEIV0,
 16425           FILE-ID-ELCERT,
 16426           CERTIFICATE-MASTER,
 16427           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 299
* EL6311.cbl
 16428           DFHEIV99
 16429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16430
 16431
 16432     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16433
 16434     PERFORM 8400-LOG-JOURNAL-RECORD.
 16435
 16436     move ' '                    to ws-stop-sw
 16437                                    ws-proc-check-sw
 16438                                    ws-chek-browse-sw
 16439
 16440     if i-have-checks
 16441        perform until i-say-stop
 16442           perform 2510-startbr-erchek
 16443                                 thru 2510-exit
 16444           if resp-normal
 16445              perform 2520-readnext-erchek
 16446                                 thru 2520-exit
 16447           end-if
 16448           if (not resp-normal)
 16449              or (pb-control-by-account (1:33) not =
 16450                 ch-control-primary (1:33))
 16451                 set i-say-stop to true
 16452           else
 16453              perform 2530-readupd-erchek
 16454                                 thru 2530-exit
 16455              if resp-normal
 16456                 perform 2540-delete-erchek
 16457                                 thru 2540-exit
 16458              end-if
 16459              if ws-chek-browse-sw = 'Y'
 16460                 perform 2525-endbr-erchek
 16461                                 thru 2525-exit
 16462                 move ' '        to ws-chek-browse-sw
 16463              end-if
 16464           end-if
 16465        end-perform
 16466     end-if
 16467
 16468     if ws-chek-browse-sw = 'Y'
 16469        perform 2525-endbr-erchek thru 2525-exit
 16470     end-if
 16471     .
 16472 2475-CONTINUE-DELETE.
 16473     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16474     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16475
 16476     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16477     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16478
 16479     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16480
 16481     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16482     MOVE 'D'                    TO JP-RECORD-TYPE
 16483     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16484
 16485
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 300
* EL6311.cbl
 16486* EXEC CICS DELETE
 16487*        DATASET    (FILE-ID-ERPNDB)
 16488*    END-EXEC.
 16489*    MOVE '&(                    &   #00014528' TO DFHEIV0
 16490     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16491     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16492     MOVE X'2020233030303134353238' TO DFHEIV0(25:11)
 16493     CALL 'kxdfhei1' USING DFHEIV0,
 16494           FILE-ID-ERPNDB,
 16495           DFHEIV99,
 16496           DFHEIV99,
 16497           DFHEIV99,
 16498           DFHEIV99
 16499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16500
 16501
 16502     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16503
 16504     PERFORM 8400-LOG-JOURNAL-RECORD.
 16505
 16506     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16507     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16508
 16509
 16510* EXEC CICS HANDLE CONDITION
 16511*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16512*    END-EXEC.
 16513*    MOVE '"$I                   ! ; #00014539' TO DFHEIV0
 16514     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16515     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16516     MOVE X'3B20233030303134353339' TO DFHEIV0(25:11)
 16517     CALL 'kxdfhei1' USING DFHEIV0
 16518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16519
 16520
 16521
 16522* EXEC CICS READ
 16523*        SET     (ADDRESS OF PENDING-BUSINESS)
 16524*        DATASET (FILE-ID-ERPNDB)
 16525*        RIDFLD  (ERPNDB-KEY)
 16526*        UPDATE
 16527*    END-EXEC.
 16528*    MOVE '&"S        EU         (   #00014543' TO DFHEIV0
 16529     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16530     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16531     MOVE X'2020233030303134353433' TO DFHEIV0(25:11)
 16532     CALL 'kxdfhei1' USING DFHEIV0,
 16533           FILE-ID-ERPNDB,
 16534           DFHEIV20,
 16535           DFHEIV99,
 16536           ERPNDB-KEY,
 16537           DFHEIV99,
 16538           DFHEIV99,
 16539           DFHEIV99
 16540     SET ADDRESS OF PENDING-BUSINESS TO
 16541         DFHEIV20
 16542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16543
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 301
* EL6311.cbl
 16544
 16545     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16546     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16547
 16548     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16549        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16550        MOVE 'D'                 TO JP-RECORD-TYPE
 16551        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16552
 16553* EXEC CICS DELETE
 16554*            DATASET    (FILE-ID-ERPNDB)
 16555*       END-EXEC
 16556*    MOVE '&(                    &   #00014557' TO DFHEIV0
 16557     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16558     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16559     MOVE X'2020233030303134353537' TO DFHEIV0(25:11)
 16560     CALL 'kxdfhei1' USING DFHEIV0,
 16561           FILE-ID-ERPNDB,
 16562           DFHEIV99,
 16563           DFHEIV99,
 16564           DFHEIV99,
 16565           DFHEIV99
 16566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16567        PERFORM 8400-LOG-JOURNAL-RECORD
 16568     ELSE
 16569        MOVE 'B'                 TO JP-RECORD-TYPE
 16570        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16571        PERFORM 8400-LOG-JOURNAL-RECORD
 16572        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16573        MOVE 'C'                 TO JP-RECORD-TYPE
 16574        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16575
 16576* EXEC CICS REWRITE
 16577*            DATASET    (FILE-ID-ERPNDB)
 16578*            FROM       (PENDING-BUSINESS)
 16579*       END-EXEC
 16580     MOVE LENGTH OF
 16581      PENDING-BUSINESS
 16582       TO DFHEIV11
 16583*    MOVE '&& L                  %   #00014568' TO DFHEIV0
 16584     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16585     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16586     MOVE X'2020233030303134353638' TO DFHEIV0(25:11)
 16587     CALL 'kxdfhei1' USING DFHEIV0,
 16588           FILE-ID-ERPNDB,
 16589           PENDING-BUSINESS,
 16590           DFHEIV11,
 16591           DFHEIV99
 16592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16593        PERFORM 8400-LOG-JOURNAL-RECORD.
 16594
 16595******************************************************************
 16596*                                                                *
 16597*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16598*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16599*                                                                *
 16600******************************************************************
 16601
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 302
* EL6311.cbl
 16602     IF NOT PI-AR-PROCESSING
 16603        GO TO 2480-DELETE-FINISHED.
 16604
 16605     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16606        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16607        NEXT SENTENCE
 16608     ELSE
 16609        GO TO 2480-DELETE-FINISHED.
 16610
 16611
 16612* EXEC CICS HANDLE CONDITION
 16613*         NOTFND    (2480-DELETE-FINISHED)
 16614*    END-EXEC.
 16615*    MOVE '"$I                   ! < #00014590' TO DFHEIV0
 16616     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16617     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16618     MOVE X'3C20233030303134353930' TO DFHEIV0(25:11)
 16619     CALL 'kxdfhei1' USING DFHEIV0
 16620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16621
 16622
 16623     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16624     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16625
 16626
 16627* EXEC CICS READ
 16628*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16629*        DATASET (FILE-ID-ERRQST)
 16630*        RIDFLD  (ERRQST-KEY)
 16631*        UPDATE
 16632*    END-EXEC.
 16633*    MOVE '&"S        EU         (   #00014597' TO DFHEIV0
 16634     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16635     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16636     MOVE X'2020233030303134353937' TO DFHEIV0(25:11)
 16637     CALL 'kxdfhei1' USING DFHEIV0,
 16638           FILE-ID-ERRQST,
 16639           DFHEIV20,
 16640           DFHEIV99,
 16641           ERRQST-KEY,
 16642           DFHEIV99,
 16643           DFHEIV99,
 16644           DFHEIV99
 16645     SET ADDRESS OF AR-REQUEST-RECORD TO
 16646         DFHEIV20
 16647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16648
 16649
 16650     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16651
 16652     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16653
 16654     MOVE 'D'                      TO JP-RECORD-TYPE.
 16655     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16656
 16657
 16658* EXEC CICS DELETE
 16659*         DATASET    (FILE-ID-ERRQST)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 303
* EL6311.cbl
 16660*    END-EXEC.
 16661*    MOVE '&(                    &   #00014611' TO DFHEIV0
 16662     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16663     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16664     MOVE X'2020233030303134363131' TO DFHEIV0(25:11)
 16665     CALL 'kxdfhei1' USING DFHEIV0,
 16666           FILE-ID-ERRQST,
 16667           DFHEIV99,
 16668           DFHEIV99,
 16669           DFHEIV99,
 16670           DFHEIV99
 16671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16672
 16673
 16674     PERFORM 8400-LOG-JOURNAL-RECORD.
 16675
 16676 2480-DELETE-FINISHED.
 16677     MOVE ZEROS                  TO EMI-ERROR.
 16678     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16679     MOVE LOW-VALUES             TO EL631CI.
 16680     MOVE -1                     TO CMAINTL.
 16681     GO TO 8100-SEND-INITIAL-MAP.
 16682
 16683 2485-BATCH-HDR-NOT-FOUND.
 16684     MOVE -1                     TO CMAINTL
 16685     MOVE AL-UABON               TO CMAINTA.
 16686     MOVE ER-7450                TO EMI-ERROR.
 16687     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16688     GO TO 8200-SEND-DATAONLY.
 16689
 16690 2490-RECORD-NOT-FOUND.
 16691     MOVE -1                     TO CMAINTL
 16692     MOVE AL-UABON               TO CMAINTA.
 16693     MOVE ER-7451                TO EMI-ERROR.
 16694     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16695     GO TO 8200-SEND-DATAONLY.
 16696***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16697***                                                            ***
 16698***     2500  B R O W S E   C H E C K S                        ***
 16699***  We perform this routine from 2 different places.          ***
 16700***  1. If the user changes the refund amount on a cancel, we  ***
 16701***    want to.........                                        ***
 16702***    a. determine if prior checks have been processed        ***
 16703***    b. If the amt is larger, display message instructing    ***
 16704***     them to create another check to make up the difference.***
 16705***    c. If the amt is less, do not allow the change and      ***
 16706***     display a FATAL error suggesting they deal with check  ***
 16707***     records befor continuing.                              ***
 16708***  2. If the user wants to delete a cancel record we......   ***
 16709***    a. browse through all the checks and if there is a      ***
 16710***     processed check, send FATAL message.                   ***
 16711***    b. If there is a non-released check, then delete that   ***
 16712***     check after you delete the pending cancel record.      ***
 16713***                                                            ***
 16714***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16715
 16716 2500-browse-checks.
 16717
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 304
* EL6311.cbl
 16718     perform 2510-startbr-erchek thru 2510-exit
 16719
 16720     if not resp-normal
 16721        go to 2500-exit
 16722     end-if
 16723
 16724     perform until i-say-stop
 16725        perform 2520-readnext-erchek
 16726                                 thru 2520-exit
 16727        if (not resp-normal)
 16728           or (pb-control-by-account (1:33) not =
 16729              ch-control-primary (1:33))
 16730              set i-say-stop to true
 16731        else
 16732           if (ch-approval-status) = ' '
 16733              and (ch-void-dt = low-values)
 16734              and (ch-released-dt = low-values)
 16735              set i-have-checks to true
 16736           else
 16737              if ch-void-dt = low-values
 16738                 set i-have-processed-checks to true
 16739              end-if
 16740           end-if
 16741           if (ch-credit-accept-dt = low-values)
 16742              and (ch-void-dt = low-values)
 16743              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16744              if (ch-check-origin-sw not = 'R')
 16745                 and (pb-record-type = '2')
 16746                 continue
 16747              else
 16748                 compute ws-check-amts =
 16749                    ws-check-amts + ch-amount-paid
 16750              end-if
 16751           end-if
 16752        end-if
 16753     end-perform
 16754
 16755     if ws-chek-browse-sw = 'Y'
 16756        perform 2525-endbr-erchek thru 2525-exit
 16757     end-if
 16758
 16759    .
 16760 2500-exit.
 16761     exit.
 16762
 16763 2510-startbr-erchek.
 16764
 16765     move pb-control-by-account  to erchek-key
 16766     move +0                     to chek-record-seq
 16767
 16768
 16769* exec cics startbr
 16770*       dataset   ('ERCHEK')
 16771*       ridfld    (erchek-key)
 16772*       gteq
 16773*       resp      (ws-response)
 16774*    end-exec
 16775     MOVE 'ERCHEK' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 305
* EL6311.cbl
 16776     MOVE 0
 16777       TO DFHEIV11
 16778*    MOVE '&,         G          &  N#00014709' TO DFHEIV0
 16779     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16780     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16781     MOVE X'204E233030303134373039' TO DFHEIV0(25:11)
 16782     CALL 'kxdfhei1' USING DFHEIV0,
 16783           DFHEIV1,
 16784           erchek-key,
 16785           DFHEIV99,
 16786           DFHEIV11,
 16787           DFHEIV99
 16788     MOVE EIBRESP  TO ws-response
 16789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16790
 16791     IF RESP-NORMAL
 16792        move 'Y'                 to ws-chek-browse-sw
 16793     end-if
 16794
 16795     .
 16796 2510-exit.
 16797     exit.
 16798
 16799 2520-readnext-erchek.
 16800
 16801
 16802* EXEC CICS READNEXT
 16803*       SET     (ADDRESS OF CHECK-RECORDS)
 16804*       DATASET ('ERCHEK')
 16805*       RIDFLD  (ERCHEK-KEY)
 16806*       RESP    (WS-RESPONSE)
 16807*    END-EXEC
 16808     MOVE 'ERCHEK' TO DFHEIV1
 16809     MOVE 0
 16810       TO DFHEIV11
 16811*    MOVE '&.S                   )  N#00014726' TO DFHEIV0
 16812     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16813     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16814     MOVE X'204E233030303134373236' TO DFHEIV0(25:11)
 16815     CALL 'kxdfhei1' USING DFHEIV0,
 16816           DFHEIV1,
 16817           DFHEIV20,
 16818           DFHEIV99,
 16819           ERCHEK-KEY,
 16820           DFHEIV99,
 16821           DFHEIV11,
 16822           DFHEIV99,
 16823           DFHEIV99
 16824     SET ADDRESS OF CHECK-RECORDS TO
 16825         DFHEIV20
 16826     MOVE EIBRESP  TO WS-RESPONSE
 16827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16828
 16829     .
 16830 2520-exit.
 16831     exit.
 16832
 16833 2525-endbr-erchek.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 306
* EL6311.cbl
 16834
 16835
 16836* exec cics endbr
 16837*       dataset  ('ERCHEK')
 16838*    end-exec
 16839     MOVE 'ERCHEK' TO DFHEIV1
 16840     MOVE 0
 16841       TO DFHEIV11
 16842*    MOVE '&2                    $   #00014739' TO DFHEIV0
 16843     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16844     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16845     MOVE X'2020233030303134373339' TO DFHEIV0(25:11)
 16846     CALL 'kxdfhei1' USING DFHEIV0,
 16847           DFHEIV1,
 16848           DFHEIV11,
 16849           DFHEIV99
 16850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16851
 16852     .
 16853 2525-exit.
 16854     exit.
 16855
 16856 2530-readupd-erchek.
 16857
 16858
 16859* EXEC CICS READ
 16860*       UPDATE
 16861*       SET     (ADDRESS OF CHECK-RECORDS)
 16862*       DATASET ('ERCHEK')
 16863*       RIDFLD  (ERCHEK-KEY)
 16864*       RESP    (WS-RESPONSE)
 16865*    END-EXEC
 16866     MOVE 'ERCHEK' TO DFHEIV1
 16867*    MOVE '&"S        EU         (  N#00014749' TO DFHEIV0
 16868     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16869     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16870     MOVE X'204E233030303134373439' TO DFHEIV0(25:11)
 16871     CALL 'kxdfhei1' USING DFHEIV0,
 16872           DFHEIV1,
 16873           DFHEIV20,
 16874           DFHEIV99,
 16875           ERCHEK-KEY,
 16876           DFHEIV99,
 16877           DFHEIV99,
 16878           DFHEIV99
 16879     SET ADDRESS OF CHECK-RECORDS TO
 16880         DFHEIV20
 16881     MOVE EIBRESP  TO WS-RESPONSE
 16882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16883
 16884     .
 16885 2530-exit.
 16886     exit.
 16887
 16888 2540-delete-erchek.
 16889
 16890
 16891* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 307
* EL6311.cbl
 16892*       DATASET ('ERCHEK')
 16893*       RESP    (WS-RESPONSE)
 16894*    END-EXEC
 16895     MOVE 'ERCHEK' TO DFHEIV1
 16896*    MOVE '&(                    &  N#00014763' TO DFHEIV0
 16897     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16898     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16899     MOVE X'204E233030303134373633' TO DFHEIV0(25:11)
 16900     CALL 'kxdfhei1' USING DFHEIV0,
 16901           DFHEIV1,
 16902           DFHEIV99,
 16903           DFHEIV99,
 16904           DFHEIV99,
 16905           DFHEIV99
 16906     MOVE EIBRESP  TO WS-RESPONSE
 16907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16908
 16909     .
 16910 2540-exit.
 16911     exit.
 16912***************************************************************
 16913*                                                             *
 16914*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16915*                                                             *
 16916***************************************************************
 16917
 16918***************************************************************
 16919*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16920*     AN ALREADY BILLED RECORD.                               *
 16921***************************************************************
 16922
 16923 2700-BUILD-CORRECTION-RECORD.
 16924     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16925     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16926     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16927     MOVE '5'                    TO DC-OPTION-CODE.
 16928     PERFORM 9700-DATE-LINK.
 16929     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16930
 16931     IF PB-CHG-COUNT = ZEROS
 16932        MOVE +1                  TO WS-SEQ-SAVE
 16933     ELSE
 16934        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16935
 16936     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16937     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16938
 16939     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16940
 16941     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16942     MOVE 'A'                    TO JP-RECORD-TYPE.
 16943     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16944
 16945
 16946* EXEC CICS WRITE
 16947*        DATASET    (FILE-ID-ERPNDB)
 16948*        FROM       (PENDING-BUSINESS)
 16949*        RIDFLD     (PB-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 308
* EL6311.cbl
 16950*    END-EXEC.
 16951     MOVE LENGTH OF
 16952      PENDING-BUSINESS
 16953       TO DFHEIV11
 16954*    MOVE '&$ L                  ''   #00014804' TO DFHEIV0
 16955     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16956     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16957     MOVE X'2020233030303134383034' TO DFHEIV0(25:11)
 16958     CALL 'kxdfhei1' USING DFHEIV0,
 16959           FILE-ID-ERPNDB,
 16960           PENDING-BUSINESS,
 16961           DFHEIV11,
 16962           PB-CONTROL-PRIMARY,
 16963           DFHEIV99,
 16964           DFHEIV99
 16965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16966
 16967
 16968     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16969
 16970     PERFORM 8400-LOG-JOURNAL-RECORD.
 16971
 16972 2799-EXIT.
 16973      EXIT.
 16974
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 309
* EL6311.cbl
 16976
 16977******************************************************************
 16978*                                                                *
 16979*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16980*                                                                *
 16981******************************************************************
 16982
 16983 2800-REWRITE-ISSUE-CERT-KEY.
 16984     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16985
 16986     IF  BCERTNOL GREATER THAN ZEROS
 16987         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16988
 16989     IF  BSUFIXL  GREATER THAN ZEROS
 16990         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16991
 16992     IF  BEFFDTL  GREATER THAN ZEROS
 16993         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16994
 16995 2810-READ-BY-ACCOUNT.
 16996
 16997* EXEC CICS HANDLE CONDITION
 16998*         NOTFND    (2820-PROCESS-REWRITE)
 16999*    END-EXEC.
 17000*    MOVE '"$I                   ! = #00014838' TO DFHEIV0
 17001     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17002     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17003     MOVE X'3D20233030303134383338' TO DFHEIV0(25:11)
 17004     CALL 'kxdfhei1' USING DFHEIV0
 17005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17006
 17007
 17008***  read pndb using new key
 17009
 17010* EXEC CICS READ
 17011*        SET     (ADDRESS OF PENDING-BUSINESS)
 17012*        DATASET (FILE-ID-ERPNDB2)
 17013*        RIDFLD  (ERPNDB-ALT-KEY)
 17014*    END-EXEC.
 17015*    MOVE '&"S        E          (   #00014843' TO DFHEIV0
 17016     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17017     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17018     MOVE X'2020233030303134383433' TO DFHEIV0(25:11)
 17019     CALL 'kxdfhei1' USING DFHEIV0,
 17020           FILE-ID-ERPNDB2,
 17021           DFHEIV20,
 17022           DFHEIV99,
 17023           ERPNDB-ALT-KEY,
 17024           DFHEIV99,
 17025           DFHEIV99,
 17026           DFHEIV99
 17027     SET ADDRESS OF PENDING-BUSINESS TO
 17028         DFHEIV20
 17029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17030
 17031
 17032     GO TO 2890-DUPLICATE-RECORD.
 17033
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 310
* EL6311.cbl
 17034  2820-PROCESS-REWRITE.
 17035
 17036* EXEC CICS HANDLE CONDITION
 17037*         NOTFND    (2885-RECORD-MISSING)
 17038*    END-EXEC.
 17039*    MOVE '"$I                   ! > #00014852' TO DFHEIV0
 17040     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17041     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17042     MOVE X'3E20233030303134383532' TO DFHEIV0(25:11)
 17043     CALL 'kxdfhei1' USING DFHEIV0
 17044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17045
 17046
 17047     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17048
 17049***  read pndb using original key
 17050
 17051* EXEC CICS READ
 17052*        SET     (ADDRESS OF PENDING-BUSINESS)
 17053*        DATASET (FILE-ID-ERPNDB)
 17054*        RIDFLD  (ERPNDB-KEY)
 17055*        UPDATE
 17056*    END-EXEC.
 17057*    MOVE '&"S        EU         (   #00014859' TO DFHEIV0
 17058     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17059     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17060     MOVE X'2020233030303134383539' TO DFHEIV0(25:11)
 17061     CALL 'kxdfhei1' USING DFHEIV0,
 17062           FILE-ID-ERPNDB,
 17063           DFHEIV20,
 17064           DFHEIV99,
 17065           ERPNDB-KEY,
 17066           DFHEIV99,
 17067           DFHEIV99,
 17068           DFHEIV99
 17069     SET ADDRESS OF PENDING-BUSINESS TO
 17070         DFHEIV20
 17071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17072
 17073
 17074     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17075     MOVE 'D'                    TO JP-RECORD-TYPE.
 17076     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17077     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17078
 17079     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17080
 17081     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17082     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17083     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17084
 17085***  delete pndb using original key
 17086
 17087* EXEC CICS DELETE
 17088*        DATASET    (FILE-ID-ERPNDB)
 17089*    END-EXEC.
 17090*    MOVE '&(                    &   #00014878' TO DFHEIV0
 17091     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 311
* EL6311.cbl
 17092     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17093     MOVE X'2020233030303134383738' TO DFHEIV0(25:11)
 17094     CALL 'kxdfhei1' USING DFHEIV0,
 17095           FILE-ID-ERPNDB,
 17096           DFHEIV99,
 17097           DFHEIV99,
 17098           DFHEIV99,
 17099           DFHEIV99
 17100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17101
 17102
 17103     PERFORM 8400-LOG-JOURNAL-RECORD.
 17104
 17105
 17106* EXEC CICS GETMAIN
 17107*        SET      (ADDRESS OF PENDING-BUSINESS)
 17108*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17109*        INITIMG  (GETMAIN-SPACE)
 17110*    END-EXEC.
 17111*    MOVE ',"IL                  $   #00014884' TO DFHEIV0
 17112     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17113     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17114     MOVE X'2020233030303134383834' TO DFHEIV0(25:11)
 17115     CALL 'kxdfhei1' USING DFHEIV0,
 17116           DFHEIV20,
 17117           ERPNDB-RECORD-LENGTH,
 17118           GETMAIN-SPACE
 17119     SET ADDRESS OF PENDING-BUSINESS TO
 17120         DFHEIV20
 17121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17122
 17123
 17124***  pending-business now has original record
 17125     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17126
 17127
 17128* EXEC CICS HANDLE CONDITION
 17129*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 17130*    END-EXEC.
 17131*    MOVE '"$I                   ! ? #00014893' TO DFHEIV0
 17132     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17133     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17134     MOVE X'3F20233030303134383933' TO DFHEIV0(25:11)
 17135     CALL 'kxdfhei1' USING DFHEIV0
 17136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17137
 17138
 17139***  read elcert using original key
 17140
 17141* EXEC CICS READ
 17142*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17143*        DATASET (FILE-ID-ELCERT)
 17144*        RIDFLD  (ELCERT-KEY)
 17145*        UPDATE
 17146*    END-EXEC.
 17147*    MOVE '&"S        EU         (   #00014898' TO DFHEIV0
 17148     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17149     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 312
* EL6311.cbl
 17150     MOVE X'2020233030303134383938' TO DFHEIV0(25:11)
 17151     CALL 'kxdfhei1' USING DFHEIV0,
 17152           FILE-ID-ELCERT,
 17153           DFHEIV20,
 17154           DFHEIV99,
 17155           ELCERT-KEY,
 17156           DFHEIV99,
 17157           DFHEIV99,
 17158           DFHEIV99
 17159     SET ADDRESS OF CERTIFICATE-MASTER TO
 17160         DFHEIV20
 17161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17162
 17163
 17164     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 17165     MOVE 'B'                    TO JP-RECORD-TYPE
 17166     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17167     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17168
 17169     IF INSURED-ADDR-PRESENT
 17170        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 17171
 17172     IF CERT-NOTES-ARE-NOT-PRESENT
 17173        MOVE SPACE               TO WS-CERT-NOTE-SW
 17174     ELSE
 17175        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 17176
 17177     IF CERT-ADDED-BATCH      OR
 17178        CERT-AND-CLAIM-ONLINE OR
 17179        CERT-WAS-CREATED-FOR-CLAIM
 17180        NEXT SENTENCE
 17181     ELSE
 17182        GO TO 2825-DELETE-CERTIFICATE.
 17183
 17184     PERFORM 8400-LOG-JOURNAL-RECORD.
 17185
 17186*********************************************************
 17187** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 17188     IF CERT-ADDED-BATCH
 17189         GO TO 2822-REWRITE-ELCERT.
 17190*********************************************************
 17191
 17192     IF NO-CLAIM-ATTACHED
 17193        NEXT SENTENCE
 17194     ELSE
 17195        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17196        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17197
 17198 2822-REWRITE-ELCERT.
 17199     MOVE 'C'                    TO JP-RECORD-TYPE
 17200     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17201
 17202     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17203
 17204
 17205* EXEC CICS REWRITE
 17206*         DATASET    (FILE-ID-ELCERT)
 17207*         FROM       (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 313
* EL6311.cbl
 17208*    END-EXEC.
 17209     MOVE LENGTH OF
 17210      CERTIFICATE-MASTER
 17211       TO DFHEIV11
 17212*    MOVE '&& L                  %   #00014945' TO DFHEIV0
 17213     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17214     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17215     MOVE X'2020233030303134393435' TO DFHEIV0(25:11)
 17216     CALL 'kxdfhei1' USING DFHEIV0,
 17217           FILE-ID-ELCERT,
 17218           CERTIFICATE-MASTER,
 17219           DFHEIV11,
 17220           DFHEIV99
 17221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17222
 17223
 17224     PERFORM 8400-LOG-JOURNAL-RECORD.
 17225
 17226     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17227
 17228 2825-DELETE-CERTIFICATE.
 17229     MOVE 'D'                      TO JP-RECORD-TYPE.
 17230     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17231
 17232     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17233
 17234
 17235* EXEC CICS DELETE
 17236*         DATASET    (FILE-ID-ELCERT)
 17237*    END-EXEC.
 17238*    MOVE '&(                    &   #00014960' TO DFHEIV0
 17239     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17240     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17241     MOVE X'2020233030303134393630' TO DFHEIV0(25:11)
 17242     CALL 'kxdfhei1' USING DFHEIV0,
 17243           FILE-ID-ELCERT,
 17244           DFHEIV99,
 17245           DFHEIV99,
 17246           DFHEIV99,
 17247           DFHEIV99
 17248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17249
 17250
 17251     PERFORM 8400-LOG-JOURNAL-RECORD.
 17252
 17253******************************************************************
 17254*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17255******************************************************************
 17256
 17257     IF CERT-NOTES-ARE-PRESENT
 17258        NEXT SENTENCE
 17259     ELSE
 17260        GO TO 2827-DELETE-MAILING.
 17261
 17262
 17263* EXEC CICS HANDLE CONDITION
 17264*         NOTFND  (2827-DELETE-MAILING)
 17265*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 314
* EL6311.cbl
 17266*    MOVE '"$I                   ! @ #00014975' TO DFHEIV0
 17267     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17268     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17269     MOVE X'4020233030303134393735' TO DFHEIV0(25:11)
 17270     CALL 'kxdfhei1' USING DFHEIV0
 17271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17272
 17273
 17274
 17275* EXEC CICS READ
 17276*        EQUAL
 17277*        DATASET   (FILE-ID-ERNOTE)
 17278*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17279*        RIDFLD    (ELCERT-KEY)
 17280*        UPDATE
 17281*    END-EXEC.
 17282*    MOVE '&"S        EU         (   #00014979' TO DFHEIV0
 17283     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17284     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17285     MOVE X'2020233030303134393739' TO DFHEIV0(25:11)
 17286     CALL 'kxdfhei1' USING DFHEIV0,
 17287           FILE-ID-ERNOTE,
 17288           DFHEIV20,
 17289           DFHEIV99,
 17290           ELCERT-KEY,
 17291           DFHEIV99,
 17292           DFHEIV99,
 17293           DFHEIV99
 17294     SET ADDRESS OF CERTIFICATE-NOTE TO
 17295         DFHEIV20
 17296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17297
 17298
 17299     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17300     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17301     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17302
 17303     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17304
 17305
 17306* EXEC CICS DELETE
 17307*        DATASET   (FILE-ID-ERNOTE)
 17308*    END-EXEC.
 17309*    MOVE '&(                    &   #00014993' TO DFHEIV0
 17310     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17311     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17312     MOVE X'2020233030303134393933' TO DFHEIV0(25:11)
 17313     CALL 'kxdfhei1' USING DFHEIV0,
 17314           FILE-ID-ERNOTE,
 17315           DFHEIV99,
 17316           DFHEIV99,
 17317           DFHEIV99,
 17318           DFHEIV99
 17319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17320
 17321
 17322     PERFORM 8400-LOG-JOURNAL-RECORD.
 17323
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 315
* EL6311.cbl
 17324******************************************************************
 17325*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17326******************************************************************
 17327
 17328 2827-DELETE-MAILING.
 17329     IF CERT-ADDRESS-PRESENT
 17330        NEXT SENTENCE
 17331     ELSE
 17332        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17333
 17334
 17335* EXEC CICS HANDLE CONDITION
 17336*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17337*    END-EXEC.
 17338*    MOVE '"$I                   ! A #00015009' TO DFHEIV0
 17339     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17340     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17341     MOVE X'4120233030303135303039' TO DFHEIV0(25:11)
 17342     CALL 'kxdfhei1' USING DFHEIV0
 17343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17344
 17345
 17346     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17347
 17348
 17349* EXEC CICS READ
 17350*        EQUAL
 17351*        DATASET   (FILE-ID-ERMAIL)
 17352*        SET       (ADDRESS OF MAILING-DATA)
 17353*        RIDFLD    (ERMAIL-KEY)
 17354*        UPDATE
 17355*    END-EXEC.
 17356*    MOVE '&"S        EU         (   #00015015' TO DFHEIV0
 17357     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17358     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17359     MOVE X'2020233030303135303135' TO DFHEIV0(25:11)
 17360     CALL 'kxdfhei1' USING DFHEIV0,
 17361           FILE-ID-ERMAIL,
 17362           DFHEIV20,
 17363           DFHEIV99,
 17364           ERMAIL-KEY,
 17365           DFHEIV99,
 17366           DFHEIV99,
 17367           DFHEIV99
 17368     SET ADDRESS OF MAILING-DATA TO
 17369         DFHEIV20
 17370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17371
 17372
 17373     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17374     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17375     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17376
 17377     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17378
 17379
 17380* EXEC CICS DELETE
 17381*        DATASET   (FILE-ID-ERMAIL)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 316
* EL6311.cbl
 17382*    END-EXEC.
 17383*    MOVE '&(                    &   #00015029' TO DFHEIV0
 17384     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17385     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17386     MOVE X'2020233030303135303239' TO DFHEIV0(25:11)
 17387     CALL 'kxdfhei1' USING DFHEIV0,
 17388           FILE-ID-ERMAIL,
 17389           DFHEIV99,
 17390           DFHEIV99,
 17391           DFHEIV99,
 17392           DFHEIV99
 17393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17394
 17395
 17396     PERFORM 8400-LOG-JOURNAL-RECORD.
 17397
 17398 2830-BUILD-NEW-ISSUE-RECORD.
 17399     MOVE SPACES                 TO ELCERT-KEY.
 17400
 17401     IF  BCERTNOL GREATER THAN ZEROS
 17402         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17403
 17404     IF  BSUFIXL  GREATER THAN ZEROS
 17405         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17406
 17407     IF BEFFDTL GREATER THAN ZEROS
 17408        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17409
 17410 2870-WRITE-PENDING-BUSINESS.
 17411     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17412     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17413     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17414     MOVE '5'                    TO DC-OPTION-CODE.
 17415     PERFORM 9700-DATE-LINK.
 17416     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17417
 17418     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17419
 17420     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17421     MOVE 'A'                    TO JP-RECORD-TYPE.
 17422     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17423
 17424
 17425* EXEC CICS WRITE
 17426*        DATASET  (FILE-ID-ERPNDB)
 17427*        FROM     (PENDING-BUSINESS)
 17428*        RIDFLD   (PB-CONTROL-PRIMARY)
 17429*    END-EXEC.
 17430     MOVE LENGTH OF
 17431      PENDING-BUSINESS
 17432       TO DFHEIV11
 17433*    MOVE '&$ L                  ''   #00015061' TO DFHEIV0
 17434     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17435     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17436     MOVE X'2020233030303135303631' TO DFHEIV0(25:11)
 17437     CALL 'kxdfhei1' USING DFHEIV0,
 17438           FILE-ID-ERPNDB,
 17439           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 317
* EL6311.cbl
 17440           DFHEIV11,
 17441           PB-CONTROL-PRIMARY,
 17442           DFHEIV99,
 17443           DFHEIV99
 17444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17445
 17446
 17447     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17448
 17449     PERFORM 8400-LOG-JOURNAL-RECORD.
 17450
 17451     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17452
 17453 2885-RECORD-MISSING.
 17454     MOVE -1                     TO BMAINTL
 17455     MOVE AL-UABON               TO BMAINTA
 17456     MOVE ER-2902                TO EMI-ERROR.
 17457     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17458     GO TO 8200-SEND-DATAONLY.
 17459
 17460 2890-DUPLICATE-RECORD.
 17461     MOVE -1                     TO BMAINTL.
 17462     MOVE AL-UABON               TO BCERTNOA.
 17463     MOVE AL-UNBON               TO BEFFDTA.
 17464     MOVE SPACE                  TO BMAINTI.
 17465
 17466     MOVE 1                      TO EMI-SUB
 17467                                    EMI-SWITCH1
 17468                                    EMI-SWITCH-AREA-1
 17469                                    EMI-SWITCH-AREA-2.
 17470
 17471     MOVE SPACES                 TO EMI-ERROR-LINES.
 17472
 17473
 17474* EXEC CICS SYNCPOINT ROLLBACK
 17475*    END-EXEC.
 17476*    MOVE '6"R                   !   #00015093' TO DFHEIV0
 17477     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17478     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17479     MOVE X'2020233030303135303933' TO DFHEIV0(25:11)
 17480     CALL 'kxdfhei1' USING DFHEIV0
 17481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17482
 17483
 17484     MOVE ER-2247                TO EMI-ERROR.
 17485     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17486     GO TO 8200-SEND-DATAONLY.
 17487
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 318
* EL6311.cbl
 17489
 17490******************************************************************
 17491*                                                                *
 17492*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17493*                                                                *
 17494******************************************************************
 17495
 17496 2900-REWRITE-CAN-CERT-KEY.
 17497     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17498
 17499     IF  CCERTNOL GREATER THAN ZEROS
 17500         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17501
 17502     IF  CSUFIXL  GREATER THAN ZEROS
 17503         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17504
 17505     IF  CEFFDTL  GREATER THAN ZEROS
 17506         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17507
 17508 2910-READ-BY-ACCOUNT.
 17509
 17510* EXEC CICS HANDLE CONDITION
 17511*         NOTFND    (2920-PROCESS-REWRITE)
 17512*    END-EXEC.
 17513*    MOVE '"$I                   ! B #00015121' TO DFHEIV0
 17514     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17515     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17516     MOVE X'4220233030303135313231' TO DFHEIV0(25:11)
 17517     CALL 'kxdfhei1' USING DFHEIV0
 17518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17519
 17520
 17521
 17522* EXEC CICS READ
 17523*        SET     (ADDRESS OF PENDING-BUSINESS)
 17524*        DATASET (FILE-ID-ERPNDB2)
 17525*        RIDFLD  (ERPNDB-ALT-KEY)
 17526*    END-EXEC.
 17527*    MOVE '&"S        E          (   #00015125' TO DFHEIV0
 17528     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17529     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17530     MOVE X'2020233030303135313235' TO DFHEIV0(25:11)
 17531     CALL 'kxdfhei1' USING DFHEIV0,
 17532           FILE-ID-ERPNDB2,
 17533           DFHEIV20,
 17534           DFHEIV99,
 17535           ERPNDB-ALT-KEY,
 17536           DFHEIV99,
 17537           DFHEIV99,
 17538           DFHEIV99
 17539     SET ADDRESS OF PENDING-BUSINESS TO
 17540         DFHEIV20
 17541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17542
 17543
 17544     GO TO 2990-DUPLICATE-RECORD.
 17545
 17546  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 319
* EL6311.cbl
 17547
 17548* EXEC CICS HANDLE CONDITION
 17549*         NOTFND    (2985-RECORD-MISSING)
 17550*    END-EXEC.
 17551*    MOVE '"$I                   ! C #00015134' TO DFHEIV0
 17552     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17553     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17554     MOVE X'4320233030303135313334' TO DFHEIV0(25:11)
 17555     CALL 'kxdfhei1' USING DFHEIV0
 17556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17557
 17558
 17559     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17560
 17561
 17562* EXEC CICS READ
 17563*        SET     (ADDRESS OF PENDING-BUSINESS)
 17564*        DATASET (FILE-ID-ERPNDB)
 17565*        RIDFLD  (ERPNDB-KEY)
 17566*        UPDATE
 17567*    END-EXEC.
 17568*    MOVE '&"S        EU         (   #00015140' TO DFHEIV0
 17569     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17570     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17571     MOVE X'2020233030303135313430' TO DFHEIV0(25:11)
 17572     CALL 'kxdfhei1' USING DFHEIV0,
 17573           FILE-ID-ERPNDB,
 17574           DFHEIV20,
 17575           DFHEIV99,
 17576           ERPNDB-KEY,
 17577           DFHEIV99,
 17578           DFHEIV99,
 17579           DFHEIV99
 17580     SET ADDRESS OF PENDING-BUSINESS TO
 17581         DFHEIV20
 17582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17583
 17584
 17585     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17586     MOVE 'D'                    TO JP-RECORD-TYPE.
 17587     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17588     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17589
 17590     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17591
 17592     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17593     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17594     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17595
 17596
 17597* EXEC CICS DELETE
 17598*        DATASET    (FILE-ID-ERPNDB)
 17599*    END-EXEC.
 17600*    MOVE '&(                    &   #00015158' TO DFHEIV0
 17601     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17602     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17603     MOVE X'2020233030303135313538' TO DFHEIV0(25:11)
 17604     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 320
* EL6311.cbl
 17605           FILE-ID-ERPNDB,
 17606           DFHEIV99,
 17607           DFHEIV99,
 17608           DFHEIV99,
 17609           DFHEIV99
 17610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17611
 17612
 17613     PERFORM 8400-LOG-JOURNAL-RECORD.
 17614
 17615
 17616* EXEC CICS GETMAIN
 17617*        SET      (ADDRESS OF PENDING-BUSINESS)
 17618*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17619*        INITIMG  (GETMAIN-SPACE)
 17620*    END-EXEC.
 17621*    MOVE ',"IL                  $   #00015164' TO DFHEIV0
 17622     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17623     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17624     MOVE X'2020233030303135313634' TO DFHEIV0(25:11)
 17625     CALL 'kxdfhei1' USING DFHEIV0,
 17626           DFHEIV20,
 17627           ERPNDB-RECORD-LENGTH,
 17628           GETMAIN-SPACE
 17629     SET ADDRESS OF PENDING-BUSINESS TO
 17630         DFHEIV20
 17631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17632
 17633
 17634     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17635
 17636 2950-PROCESS-CANCELS.
 17637
 17638
 17639* EXEC CICS HANDLE CONDITION
 17640*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17641*    END-EXEC.
 17642*    MOVE '"$I                   ! D #00015174' TO DFHEIV0
 17643     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17644     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17645     MOVE X'4420233030303135313734' TO DFHEIV0(25:11)
 17646     CALL 'kxdfhei1' USING DFHEIV0
 17647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17648
 17649
 17650
 17651* EXEC CICS READ
 17652*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17653*        DATASET (FILE-ID-ELCERT)
 17654*        RIDFLD  (ELCERT-KEY)
 17655*        UPDATE
 17656*    END-EXEC.
 17657*    MOVE '&"S        EU         (   #00015178' TO DFHEIV0
 17658     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17659     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17660     MOVE X'2020233030303135313738' TO DFHEIV0(25:11)
 17661     CALL 'kxdfhei1' USING DFHEIV0,
 17662           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 321
* EL6311.cbl
 17663           DFHEIV20,
 17664           DFHEIV99,
 17665           ELCERT-KEY,
 17666           DFHEIV99,
 17667           DFHEIV99,
 17668           DFHEIV99
 17669     SET ADDRESS OF CERTIFICATE-MASTER TO
 17670         DFHEIV20
 17671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17672
 17673
 17674     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17675
 17676     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17677     MOVE 'B'                      TO JP-RECORD-TYPE.
 17678     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17679     PERFORM 8400-LOG-JOURNAL-RECORD.
 17680
 17681     IF PB-CI-LIVES NOT NUMERIC
 17682         MOVE ZERO                    TO PB-CI-LIVES.
 17683
 17684     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17685        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17686        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17687        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17688                                         CM-LF-CANCEL-DT
 17689     ELSE
 17690        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17691        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17692        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17693        MOVE PB-CI-LIVES              TO CM-LIVES.
 17694
 17695     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17696        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17697            MOVE CM-LF-STATUS-AT-CANCEL
 17698                                     TO CM-LF-CURRENT-STATUS
 17699            MOVE SPACE
 17700                                     TO CM-LF-STATUS-AT-CANCEL
 17701        ELSE
 17702            MOVE PB-CI-LF-POLICY-STATUS
 17703                                     TO CM-LF-CURRENT-STATUS
 17704     ELSE
 17705        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17706
 17707     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17708        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17709        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17710        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17711                                         CM-AH-CANCEL-DT
 17712     ELSE
 17713        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17714        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17715        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17716        MOVE PB-CI-LIVES              TO CM-LIVES.
 17717
 17718     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17719        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17720            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 322
* EL6311.cbl
 17721                                     TO CM-AH-CURRENT-STATUS
 17722            MOVE SPACE
 17723                                     TO CM-AH-STATUS-AT-CANCEL
 17724        ELSE
 17725            MOVE PB-CI-AH-POLICY-STATUS
 17726                                     TO CM-AH-CURRENT-STATUS
 17727     ELSE
 17728        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17729
 17730 2975-REWRITE-CERT.
 17731     MOVE 'C'                      TO JP-RECORD-TYPE.
 17732     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17733
 17734
 17735* EXEC CICS REWRITE
 17736*        DATASET    (FILE-ID-ELCERT)
 17737*        FROM       (CERTIFICATE-MASTER)
 17738*    END-EXEC.
 17739     MOVE LENGTH OF
 17740      CERTIFICATE-MASTER
 17741       TO DFHEIV11
 17742*    MOVE '&& L                  %   #00015245' TO DFHEIV0
 17743     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17744     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17745     MOVE X'2020233030303135323435' TO DFHEIV0(25:11)
 17746     CALL 'kxdfhei1' USING DFHEIV0,
 17747           FILE-ID-ELCERT,
 17748           CERTIFICATE-MASTER,
 17749           DFHEIV11,
 17750           DFHEIV99
 17751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17752
 17753
 17754     PERFORM 8400-LOG-JOURNAL-RECORD.
 17755
 17756 2960-BUILD-NEW-CANCEL-RECORD.
 17757     IF  CCERTNOL GREATER THAN ZEROS
 17758         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17759
 17760     IF  CSUFIXL  GREATER THAN ZEROS
 17761         MOVE CSUFIXI             TO PB-CERT-SFX.
 17762
 17763     IF  CEFFDTL  GREATER  THAN ZEROS
 17764         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17765
 17766 2970-WRITE-PENDING-BUSINESS.
 17767     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17768     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17769     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17770     MOVE '5'                    TO DC-OPTION-CODE.
 17771     PERFORM 9700-DATE-LINK.
 17772     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17773
 17774     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17775
 17776     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17777                                    PB-CI-INSURED-SEX
 17778                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 323
* EL6311.cbl
 17779                                    PB-CI-AH-BENEFIT-CD
 17780                                    PB-CI-RATE-CLASS
 17781                                    PB-CI-RATE-DEV-LF
 17782                                    PB-CI-RATE-DEV-AH
 17783                                    PB-CI-LF-ABBR
 17784                                    PB-CI-AH-ABBR
 17785                                    PB-CI-OB-FLAG
 17786                                    PB-CI-LF-POLICY-STATUS
 17787                                    PB-CI-AH-POLICY-STATUS
 17788                                    PB-CI-INDV-GRP-CD
 17789                                    PB-CI-BENEFICIARY-NAME
 17790                                    PB-CI-NOTE-SW
 17791                                    PB-CI-SOC-SEC-NO
 17792                                    PB-CI-MEMBER-NO
 17793                                    PB-CI-INT-CODE
 17794                                    PB-CI-COMP-EXCP-SW
 17795                                    PB-CI-ENTRY-STATUS
 17796                                    PB-CI-CREDIT-INTERFACE-SW-1
 17797                                    PB-CI-CREDIT-INTERFACE-SW-2
 17798                                    PB-CI-ENTRY-BATCH.
 17799
 17800     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17801                                    PB-CI-AH-SETTLEMENT-DT
 17802                                    PB-CI-DEATH-DT
 17803                                    PB-CI-LF-PRIOR-CANCEL-DT
 17804                                    PB-CI-AH-PRIOR-CANCEL-DT
 17805                                    PB-CI-LOAN-1ST-PMT-DT
 17806                                    PB-CI-ENTRY-DT
 17807                                    PB-CI-LF-EXPIRE-DT
 17808                                    PB-CI-AH-EXPIRE-DT.
 17809
 17810     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17811                                    PB-CI-LF-TERM
 17812                                    PB-CI-LF-BENEFIT-AMT
 17813                                    PB-CI-LF-ALT-BENEFIT-AMT
 17814                                    PB-CI-LF-PREMIUM-AMT
 17815                                    PB-CI-LF-ALT-PREMIUM-AMT
 17816                                    PB-CI-AH-TERM
 17817                                    PB-CI-AH-BENEFIT-AMT
 17818                                    PB-CI-AH-PREMIUM-AMT
 17819                                    PB-CI-RATE-DEV-PCT-LF
 17820                                    PB-CI-RATE-DEV-PCT-AH
 17821                                    PB-CI-LIFE-COMMISSION
 17822                                    PB-CI-AH-COMMISSION
 17823                                    PB-CI-PAY-FREQUENCY
 17824                                    PB-CI-LOAN-APR
 17825                                    PB-CI-LOAN-TERM
 17826                                    PB-CI-CURR-SEQ
 17827                                    PB-CI-AH-CANCEL-AMT
 17828                                    PB-CI-LF-CANCEL-AMT
 17829                                    PB-CI-EXTENTION-DAYS
 17830                                    PB-CI-TERM-IN-DAYS
 17831                                    PB-CI-LOAN-OFFICER
 17832                                    PB-CI-LIVES
 17833                                    PB-CI-LF-CRIT-PER
 17834                                    PB-CI-AH-CRIT-PER
 17835                                    PB-C-LF-REM-TERM
 17836                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 324
* EL6311.cbl
 17837
 17838     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17839     MOVE 'A'                    TO JP-RECORD-TYPE.
 17840     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17841
 17842
 17843* EXEC CICS HANDLE CONDITION
 17844*        DUPREC   (2990-DUPLICATE-RECORD)
 17845*    END-EXEC.
 17846*    MOVE '"$%                   ! E #00015338' TO DFHEIV0
 17847     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17848     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17849     MOVE X'4520233030303135333338' TO DFHEIV0(25:11)
 17850     CALL 'kxdfhei1' USING DFHEIV0
 17851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17852
 17853
 17854
 17855* EXEC CICS WRITE
 17856*        DATASET  (FILE-ID-ERPNDB)
 17857*        FROM     (PENDING-BUSINESS)
 17858*        RIDFLD   (PB-CONTROL-PRIMARY)
 17859*    END-EXEC.
 17860     MOVE LENGTH OF
 17861      PENDING-BUSINESS
 17862       TO DFHEIV11
 17863*    MOVE '&$ L                  ''   #00015342' TO DFHEIV0
 17864     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17865     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17866     MOVE X'2020233030303135333432' TO DFHEIV0(25:11)
 17867     CALL 'kxdfhei1' USING DFHEIV0,
 17868           FILE-ID-ERPNDB,
 17869           PENDING-BUSINESS,
 17870           DFHEIV11,
 17871           PB-CONTROL-PRIMARY,
 17872           DFHEIV99,
 17873           DFHEIV99
 17874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17875
 17876
 17877     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17878
 17879     PERFORM 8400-LOG-JOURNAL-RECORD.
 17880
 17881     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17882
 17883 2985-RECORD-MISSING.
 17884     MOVE -1                     TO CMAINTL
 17885     MOVE AL-UABON               TO CMAINTA.
 17886
 17887     MOVE ER-2902                TO EMI-ERROR.
 17888     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17889     GO TO 8200-SEND-DATAONLY.
 17890
 17891 2990-DUPLICATE-RECORD.
 17892     MOVE SPACE                  TO CMAINTI.
 17893     MOVE -1                     TO CMAINTL.
 17894     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 325
* EL6311.cbl
 17895     MOVE AL-UNBON               TO CEFFDTA.
 17896
 17897     MOVE 1                      TO EMI-SUB
 17898                                    EMI-SWITCH1
 17899                                    EMI-SWITCH-AREA-1
 17900                                    EMI-SWITCH-AREA-2.
 17901     MOVE SPACES                 TO EMI-ERROR-LINES.
 17902
 17903
 17904* EXEC CICS SYNCPOINT ROLLBACK
 17905*    END-EXEC.
 17906*    MOVE '6"R                   !   #00015374' TO DFHEIV0
 17907     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17908     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17909     MOVE X'2020233030303135333734' TO DFHEIV0(25:11)
 17910     CALL 'kxdfhei1' USING DFHEIV0
 17911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17912
 17913
 17914     MOVE ER-2247                TO EMI-ERROR.
 17915     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17916     GO TO 8200-SEND-DATAONLY.
 17917
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 326
* EL6311.cbl
 17919
 17920***************************************************************
 17921*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17922*     PREMIUM FOR A SINGLE BATCH.                             *
 17923*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17924***************************************************************
 17925
 17926 3000-BATCH-MAINLINE.
 17927     IF PI-PREV-KEY NOT = SPACES
 17928         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17929     ELSE
 17930         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17931
 17932     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17933
 17934 3010-READNEXT.
 17935
 17936* EXEC CICS READ
 17937*         DATASET    (FILE-ID-ERPNDB)
 17938*         SET        (ADDRESS OF PENDING-BUSINESS)
 17939*         RIDFLD     (ERPNDB-KEY)
 17940*         GTEQ
 17941*    END-EXEC.
 17942*    MOVE '&"S        G          (   #00015398' TO DFHEIV0
 17943     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17944     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17945     MOVE X'2020233030303135333938' TO DFHEIV0(25:11)
 17946     CALL 'kxdfhei1' USING DFHEIV0,
 17947           FILE-ID-ERPNDB,
 17948           DFHEIV20,
 17949           DFHEIV99,
 17950           ERPNDB-KEY,
 17951           DFHEIV99,
 17952           DFHEIV99,
 17953           DFHEIV99
 17954     SET ADDRESS OF PENDING-BUSINESS TO
 17955         DFHEIV20
 17956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17957
 17958
 17959     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17960        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17961          GO TO 3030-END-BATCH.
 17962
 17963     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17964
 17965     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17966        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17967          GO TO 3020-BUMP-SEQ.
 17968
 17969     IF PB-ISSUE
 17970        ADD +1                   TO WS-ISS-TOTAL-CNT
 17971        IF PB-FATAL-ERRORS
 17972           ADD +1                      TO WS-ISS-FATAL-CNT
 17973           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17974           GO TO 3020-BUMP-SEQ
 17975        ELSE
 17976           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 327
* EL6311.cbl
 17977              ADD +1                      TO WS-ISS-FORCE-CNT
 17978              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17979              GO TO 3020-BUMP-SEQ
 17980           ELSE
 17981              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17982                 ADD +1                      TO WS-ISS-HOLD-CNT
 17983                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17984                 GO TO 3020-BUMP-SEQ
 17985              ELSE
 17986                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17987                     THRU  3299-EXIT
 17988                 GO TO 3020-BUMP-SEQ.
 17989
 17990     IF PB-CANCELLATION
 17991        ADD +1                   TO WS-CAN-TOTAL-CNT
 17992        IF PB-FATAL-ERRORS
 17993           ADD +1                 TO WS-CAN-FATAL-CNT
 17994           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17995           GO TO 3020-BUMP-SEQ
 17996        ELSE
 17997           IF PB-UNFORCED-ERRORS
 17998              ADD +1                 TO WS-CAN-FORCE-CNT
 17999              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18000              GO TO 3020-BUMP-SEQ
 18001           ELSE
 18002              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18003                 ADD +1                 TO WS-CAN-HOLD-CNT
 18004                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18005                 GO TO 3020-BUMP-SEQ
 18006              ELSE
 18007                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 18008                     THRU  3499-EXIT
 18009                 GO TO 3020-BUMP-SEQ.
 18010
 18011     IF PB-BATCH-TRAILER
 18012         GO TO 3030-END-BATCH.
 18013
 18014 3020-BUMP-SEQ.
 18015     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 18016     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18017     GO TO 3010-READNEXT.
 18018
 18019 3030-END-BATCH.
 18020     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 18021     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 18022     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 18023     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 18024
 18025     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18026                                          - WS-ISS-FORCE-CNT
 18027                                          - WS-ISS-HOLD-CNT).
 18028
 18029     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 18030     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 18031
 18032     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 18033     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 18034     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 328
* EL6311.cbl
 18035     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 18036     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18037                                          - WS-CAN-FORCE-CNT
 18038                                          - WS-CAN-HOLD-CNT).
 18039     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 18040     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 18041
 18042     COMPUTE WS-NET-TOTAL-CNT
 18043         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 18044     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 18045     COMPUTE WS-NET-FATAL-CNT
 18046         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 18047     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 18048     COMPUTE WS-NET-FORCE-CNT
 18049         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 18050     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 18051     COMPUTE WS-NET-HOLD-CNT
 18052         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 18053     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 18054
 18055     COMPUTE WS-NET-AVAIL-CNT
 18056          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18057                              - WS-ISS-FORCE-CNT
 18058                              - WS-ISS-HOLD-CNT)
 18059          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18060                              - WS-CAN-FORCE-CNT
 18061                              - WS-CAN-HOLD-CNT).
 18062     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 18063
 18064     COMPUTE WS-NET-GOOD-PREM
 18065         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 18066     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 18067     COMPUTE WS-NET-BAD-PREM
 18068         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 18069     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 18070
 18071     MOVE 0000                   TO EMI-ERROR.
 18072     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18073     MOVE -1                     TO DPFENTRL.
 18074     GO TO 8200-SEND-DATAONLY.
 18075
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 329
* EL6311.cbl
 18077
 18078******************************************************************
 18079*                                                                *
 18080*           A D D    B A D   I S S U E   P R E M I U M           *
 18081*                                                                *
 18082******************************************************************
 18083
 18084 3100-ADD-BAD-ISSUE-PREM.
 18085     IF PB-OVERRIDE-LIFE
 18086       OR PB-OVERRIDE-BOTH
 18087           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18088           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18089       ELSE
 18090           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18091           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18092
 18093     IF PB-OVERRIDE-AH
 18094       OR PB-OVERRIDE-BOTH
 18095           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18096       ELSE
 18097           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18098
 18099 3199-EXIT.
 18100     EXIT.
 18101
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 330
* EL6311.cbl
 18103
 18104******************************************************************
 18105*                                                                *
 18106*       A D D   G O O D   I S S U E   P R E M I U M              *
 18107*                                                                *
 18108******************************************************************
 18109
 18110 3200-ADD-GOOD-ISSUE-PREM.
 18111     IF PB-OVERRIDE-LIFE
 18112       OR PB-OVERRIDE-BOTH
 18113           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18114           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18115       ELSE
 18116           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18117           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18118
 18119     IF PB-OVERRIDE-AH
 18120       OR PB-OVERRIDE-BOTH
 18121           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18122       ELSE
 18123           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18124
 18125 3299-EXIT.
 18126     EXIT.
 18127
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 331
* EL6311.cbl
 18129
 18130
 18131******************************************************************
 18132*                                                                *
 18133*        A D D   B A D   C A N C E L   P R E M I U M             *
 18134*                                                                *
 18135******************************************************************
 18136
 18137 3300-ADD-BAD-CANCEL-PREM.
 18138     IF PB-OVERRIDE-LIFE
 18139       OR PB-OVERRIDE-BOTH
 18140           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18141       ELSE
 18142           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18143
 18144     IF PB-OVERRIDE-AH
 18145       OR PB-OVERRIDE-BOTH
 18146           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18147       ELSE
 18148           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18149
 18150 3399-EXIT.
 18151     EXIT.
 18152
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 332
* EL6311.cbl
 18154
 18155******************************************************************
 18156*                                                                *
 18157*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18158*                                                                *
 18159******************************************************************
 18160
 18161 3400-ADD-GOOD-CANCEL-PREM.
 18162     IF PB-OVERRIDE-LIFE
 18163       OR PB-OVERRIDE-BOTH
 18164           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18165       ELSE
 18166           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18167
 18168     IF PB-OVERRIDE-AH
 18169       OR PB-OVERRIDE-BOTH
 18170           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18171       ELSE
 18172           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18173
 18174 3499-EXIT.
 18175     EXIT.
 18176
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 333
* EL6311.cbl
 18178
 18179******************************************************************
 18180*                                                                *
 18181*           E D I T   B A T C H   D A T A                        *
 18182*                                                                *
 18183******************************************************************
 18184
 18185 3500-EDIT-BATCH-DATA.
 18186     IF PI-PREV-KEY NOT = SPACES
 18187        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18188     ELSE
 18189        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18190
 18191     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18192     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18193
 18194
 18195* EXEC CICS HANDLE CONDITION
 18196*         NOTFND      (3590-NOT-FOUND)
 18197*    END-EXEC.
 18198*    MOVE '"$I                   ! F #00015640' TO DFHEIV0
 18199     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18200     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18201     MOVE X'4620233030303135363430' TO DFHEIV0(25:11)
 18202     CALL 'kxdfhei1' USING DFHEIV0
 18203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18204
 18205
 18206     IF DRISSL   GREATER THAN ZEROS OR
 18207        DRISSL   GREATER THAN ZEROS OR
 18208        DRLFPRML GREATER THAN ZEROS OR
 18209        DRAHPRML GREATER THAN ZEROS OR
 18210        DRCANCL  GREATER THAN ZEROS OR
 18211        DRLFRFDL GREATER THAN ZEROS OR
 18212        DRAHRFDL GREATER THAN ZEROS
 18213              NEXT SENTENCE
 18214          ELSE
 18215              MOVE ER-3224    TO EMI-ERROR
 18216              MOVE -1         TO DPFENTRL
 18217              MOVE AL-UNBON   TO DPFENTRA
 18218              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18219              GO TO 8200-SEND-DATAONLY.
 18220
 18221     IF NOT MODIFY-CAP
 18222         MOVE 'UPDATE'       TO SM-READ
 18223         PERFORM 9995-SECURITY-VIOLATION
 18224         MOVE ER-0070        TO EMI-ERROR
 18225         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18226         GO TO 8100-SEND-INITIAL-MAP.
 18227
 18228        IF DRISSL GREATER THAN ZEROS
 18229           MOVE AL-UNNON         TO DRISSA
 18230           MOVE DRISSI           TO DEEDIT-FIELD
 18231           PERFORM 8600-DEEDIT
 18232           IF DEEDIT-FIELD-V0  NUMERIC
 18233              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18234           ELSE
 18235              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 334
* EL6311.cbl
 18236              MOVE -1         TO DRISSL
 18237              MOVE AL-UNBON   TO DRISSA
 18238              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18239
 18240        IF DRLFPRML GREATER THAN ZEROS
 18241           MOVE AL-UNNON         TO DRLFPRMA
 18242
 18243* EXEC CICS BIF DEEDIT
 18244*              FIELD  (DRLFPRMI)
 18245*              LENGTH (11)
 18246*          END-EXEC
 18247     MOVE 11
 18248       TO DFHEIV11
 18249*    MOVE '@"L                   #   #00015680' TO DFHEIV0
 18250     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18251     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18252     MOVE X'2020233030303135363830' TO DFHEIV0(25:11)
 18253     CALL 'kxdfhei1' USING DFHEIV0,
 18254           DRLFPRMI,
 18255           DFHEIV11
 18256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18257           IF DRLFPRMI NUMERIC
 18258              MOVE DRLFPRMI   TO WS-DRLFPRM
 18259*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18260*          PERFORM 8600-DEEDIT
 18261*          IF DEEDIT-FIELD-V2  NUMERIC
 18262*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18263           ELSE
 18264              MOVE ER-2223    TO EMI-ERROR
 18265              MOVE -1         TO DRLFPRML
 18266              MOVE AL-UNBON   TO DRLFPRMA
 18267              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18268
 18269        IF DRAHPRML GREATER THAN ZEROS
 18270           MOVE AL-UNNON         TO DRAHPRMA
 18271
 18272* EXEC CICS BIF DEEDIT
 18273*              FIELD  (DRAHPRMI)
 18274*              LENGTH (11)
 18275*          END-EXEC
 18276     MOVE 11
 18277       TO DFHEIV11
 18278*    MOVE '@"L                   #   #00015698' TO DFHEIV0
 18279     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18280     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18281     MOVE X'2020233030303135363938' TO DFHEIV0(25:11)
 18282     CALL 'kxdfhei1' USING DFHEIV0,
 18283           DRAHPRMI,
 18284           DFHEIV11
 18285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18286           IF DRAHPRMI NUMERIC
 18287              MOVE DRAHPRMI   TO WS-DRAHPRM
 18288*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18289*          PERFORM 8600-DEEDIT
 18290*          IF DEEDIT-FIELD-V2  NUMERIC
 18291*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18292           ELSE
 18293              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 335
* EL6311.cbl
 18294              MOVE -1         TO DRAHPRML
 18295              MOVE AL-UNBON   TO DRAHPRMA
 18296              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18297
 18298        IF DRCANCL GREATER THAN ZEROS
 18299           MOVE AL-UNNON         TO DRCANCA
 18300           MOVE DRCANCI          TO DEEDIT-FIELD
 18301           PERFORM 8600-DEEDIT
 18302           IF DEEDIT-FIELD-V0  NUMERIC
 18303              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18304           ELSE
 18305              MOVE ER-2223    TO EMI-ERROR
 18306              MOVE -1         TO DRCANCL
 18307              MOVE AL-UNBON   TO DRCANCL
 18308              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18309
 18310        IF DRLFRFDL GREATER THAN ZEROS
 18311           MOVE AL-UNNON         TO DRLFRFDA
 18312
 18313* EXEC CICS BIF DEEDIT
 18314*              FIELD  (DRLFRFDI)
 18315*              LENGTH (11)
 18316*          END-EXEC
 18317     MOVE 11
 18318       TO DFHEIV11
 18319*    MOVE '@"L                   #   #00015728' TO DFHEIV0
 18320     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18321     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18322     MOVE X'2020233030303135373238' TO DFHEIV0(25:11)
 18323     CALL 'kxdfhei1' USING DFHEIV0,
 18324           DRLFRFDI,
 18325           DFHEIV11
 18326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18327           IF DRLFRFDI NUMERIC
 18328              MOVE DRLFRFDI   TO WS-DRLFRFD
 18329*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18330*          PERFORM 8600-DEEDIT
 18331*          IF DEEDIT-FIELD-V2  NUMERIC
 18332*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18333           ELSE
 18334              MOVE ER-2223    TO EMI-ERROR
 18335              MOVE -1         TO DRLFRFDL
 18336              MOVE AL-UNBON   TO DRLFRFDA
 18337              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18338
 18339        IF DRAHRFDL GREATER THAN ZEROS
 18340           MOVE AL-UNNON         TO DRAHRFDA
 18341
 18342* EXEC CICS BIF DEEDIT
 18343*              FIELD  (DRAHRFDI)
 18344*              LENGTH (11)
 18345*          END-EXEC
 18346     MOVE 11
 18347       TO DFHEIV11
 18348*    MOVE '@"L                   #   #00015746' TO DFHEIV0
 18349     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18350     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18351     MOVE X'2020233030303135373436' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 336
* EL6311.cbl
 18352     CALL 'kxdfhei1' USING DFHEIV0,
 18353           DRAHRFDI,
 18354           DFHEIV11
 18355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18356           IF DRAHRFDI NUMERIC
 18357              MOVE DRAHRFDI   TO WS-DRAHRFD
 18358*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18359*          PERFORM 8600-DEEDIT
 18360*          IF DEEDIT-FIELD-V2  NUMERIC
 18361*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18362           ELSE
 18363              MOVE ER-2223    TO EMI-ERROR
 18364              MOVE -1         TO DRAHRFDL
 18365              MOVE AL-UNBON   TO DRAHRFDA
 18366              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18367
 18368     IF EMI-ERROR = ZEROS
 18369        GO 3600-UPDATE-BATCH-HEADER.
 18370
 18371     GO TO 8200-SEND-DATAONLY.
 18372
 18373 3590-NOT-FOUND.
 18374     MOVE ER-2192                TO EMI-ERROR.
 18375     MOVE -1                     TO DPFENTRL.
 18376     MOVE AL-UNBON               TO DPFENTRA.
 18377     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18378     GO TO 8200-SEND-DATAONLY.
 18379
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 337
* EL6311.cbl
 18381
 18382******************************************************************
 18383*                                                                *
 18384*           U P D A T E   B A T C H   H E A D E R                *
 18385*                                                                *
 18386******************************************************************
 18387
 18388 3600-UPDATE-BATCH-HEADER.
 18389
 18390* EXEC CICS HANDLE CONDITION
 18391*         NOTFND      (3690-NOT-FOUND)
 18392*    END-EXEC.
 18393*    MOVE '"$I                   ! G #00015783' TO DFHEIV0
 18394     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18396     MOVE X'4720233030303135373833' TO DFHEIV0(25:11)
 18397     CALL 'kxdfhei1' USING DFHEIV0
 18398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18399
 18400
 18401
 18402* EXEC CICS READ
 18403*        DATASET (FILE-ID-ERPNDB)
 18404*        RIDFLD  (ERPNDB-KEY)
 18405*        SET     (ADDRESS OF PENDING-BUSINESS)
 18406*        UPDATE
 18407*    END-EXEC.
 18408*    MOVE '&"S        EU         (   #00015787' TO DFHEIV0
 18409     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18410     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18411     MOVE X'2020233030303135373837' TO DFHEIV0(25:11)
 18412     CALL 'kxdfhei1' USING DFHEIV0,
 18413           FILE-ID-ERPNDB,
 18414           DFHEIV20,
 18415           DFHEIV99,
 18416           ERPNDB-KEY,
 18417           DFHEIV99,
 18418           DFHEIV99,
 18419           DFHEIV99
 18420     SET ADDRESS OF PENDING-BUSINESS TO
 18421         DFHEIV20
 18422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18423
 18424
 18425     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18426     MOVE 'B'                    TO JP-RECORD-TYPE.
 18427     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18428
 18429     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18430
 18431     PERFORM 8400-LOG-JOURNAL-RECORD.
 18432
 18433     IF DRISSL GREATER THAN ZEROS
 18434        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18435
 18436     IF DRCANCL GREATER THAN ZEROS
 18437        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18438
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 338
* EL6311.cbl
 18439
 18440     IF DRLFPRML GREATER THAN ZEROS
 18441        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18442
 18443     IF DRAHPRML GREATER THAN ZEROS
 18444        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18445
 18446     IF DRLFRFDL GREATER THAN ZEROS
 18447        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18448
 18449     IF DRAHRFDL GREATER THAN ZEROS
 18450        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18451
 18452 3670-REWRITE-BATCH-HEADER.
 18453     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18454        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18455        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18456        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18457        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18458        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18459        MOVE SPACE               TO PB-OUT-BAL-CD
 18460     ELSE
 18461        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18462
 18463     MOVE 'C'                    TO JP-RECORD-TYPE.
 18464     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18465
 18466
 18467* EXEC CICS REWRITE
 18468*         DATASET      (FILE-ID-ERPNDB)
 18469*         FROM         (PENDING-BUSINESS)
 18470*    END-EXEC.
 18471     MOVE LENGTH OF
 18472      PENDING-BUSINESS
 18473       TO DFHEIV11
 18474*    MOVE '&& L                  %   #00015835' TO DFHEIV0
 18475     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18476     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18477     MOVE X'2020233030303135383335' TO DFHEIV0(25:11)
 18478     CALL 'kxdfhei1' USING DFHEIV0,
 18479           FILE-ID-ERPNDB,
 18480           PENDING-BUSINESS,
 18481           DFHEIV11,
 18482           DFHEIV99
 18483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18484
 18485
 18486     PERFORM 8400-LOG-JOURNAL-RECORD.
 18487
 18488     GO TO 7200-DISPLAY-BATCHES.
 18489
 18490 3690-NOT-FOUND.
 18491     MOVE ER-2192                TO EMI-ERROR.
 18492     MOVE -1                     TO DPFENTRL.
 18493     MOVE AL-UNBON               TO DPFENTRA.
 18494     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18495     GO TO 8200-SEND-DATAONLY.
 18496
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 339
* EL6311.cbl
 18498
 18499******************************************************************
 18500*                                                                *
 18501*           R E - D I S P L A Y   R E C O R D                    *
 18502*                                                                *
 18503******************************************************************
 18504
 18505 3900-RE-DISPLAY-RECORD.
 18506
 18507* EXEC CICS HANDLE CONDITION
 18508*         NOTFND   (3990-NOT-FOUND)
 18509*    END-EXEC.
 18510*    MOVE '"$I                   ! H #00015860' TO DFHEIV0
 18511     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18512     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18513     MOVE X'4820233030303135383630' TO DFHEIV0(25:11)
 18514     CALL 'kxdfhei1' USING DFHEIV0
 18515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18516
 18517
 18518     IF PI-DISPLAY-ORIGINAL-BATCH
 18519         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18520     ELSE
 18521         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18522
 18523
 18524* EXEC CICS READ
 18525*         DATASET   (FILE-ID)
 18526*         RIDFLD    (PI-PREV-KEY)
 18527*         SET       (ADDRESS OF PENDING-BUSINESS)
 18528*    END-EXEC.
 18529*    MOVE '&"S        E          (   #00015869' TO DFHEIV0
 18530     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18531     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18532     MOVE X'2020233030303135383639' TO DFHEIV0(25:11)
 18533     CALL 'kxdfhei1' USING DFHEIV0,
 18534           FILE-ID,
 18535           DFHEIV20,
 18536           DFHEIV99,
 18537           PI-PREV-KEY,
 18538           DFHEIV99,
 18539           DFHEIV99,
 18540           DFHEIV99
 18541     SET ADDRESS OF PENDING-BUSINESS TO
 18542         DFHEIV20
 18543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18544
 18545
 18546     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18547
 18548     IF PB-ISSUE
 18549         GO TO 7000-DISPLAY-ISSUES.
 18550
 18551     IF PB-CANCELLATION
 18552         GO TO 7100-DISPLAY-CANCELS.
 18553
 18554     IF PB-BATCH-TRAILER
 18555         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 340
* EL6311.cbl
 18556
 18557 3990-NOT-FOUND.
 18558     MOVE LOW-VALUES             TO EL631BI.
 18559
 18560     IF PI-MAP-NAME = EL631B
 18561         MOVE -1                  TO BMAINTL
 18562     ELSE
 18563         MOVE -1                  TO CMAINTL.
 18564
 18565     GO TO 8100-SEND-INITIAL-MAP.
 18566
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 341
* EL6311.cbl
 18568
 18569***************************************************************
 18570*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18571*                                                             *
 18572*      1. START BROWSE WITH                                   *
 18573*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18574*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18575*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18576*                                                             *
 18577*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18578*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18579*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18580*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18581*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18582*               AND IS IT TO BE DISPLAYED.                    *
 18583*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18584*               DISPLAYED.                                    *
 18585*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18586*               DISPLAYED.                                    *
 18587*                                                             *
 18588*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18589*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18590***************************************************************
 18591
 18592 4000-BROWSE-DETAIL-FORWARD.
 18593     IF FIRST-TIME
 18594        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18595     ELSE
 18596        IF SHOW-RECORD
 18597           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18598           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18599           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18600           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18601           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18602        ELSE
 18603           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18604
 18605
 18606* EXEC CICS HANDLE CONDITION
 18607*         NOTFND   (4050-END-RECORDS)
 18608*         ENDFILE  (4050-END-RECORDS)
 18609*    END-EXEC.
 18610*    MOVE '"$I''                  ! I #00015934' TO DFHEIV0
 18611     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18612     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18613     MOVE X'4920233030303135393334' TO DFHEIV0(25:11)
 18614     CALL 'kxdfhei1' USING DFHEIV0
 18615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18616
 18617
 18618
 18619* EXEC CICS STARTBR
 18620*         DATASET   (FILE-ID-ERPNDB2)
 18621*         RIDFLD    (ERPNDB-ALT-KEY)
 18622*    END-EXEC.
 18623     MOVE 0
 18624       TO DFHEIV11
 18625*    MOVE '&,         G          &   #00015939' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 342
* EL6311.cbl
 18626     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18627     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18628     MOVE X'2020233030303135393339' TO DFHEIV0(25:11)
 18629     CALL 'kxdfhei1' USING DFHEIV0,
 18630           FILE-ID-ERPNDB2,
 18631           ERPNDB-ALT-KEY,
 18632           DFHEIV99,
 18633           DFHEIV11,
 18634           DFHEIV99
 18635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18636
 18637
 18638     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18639
 18640     IF FIRST-TIME OR SHOW-RECORD
 18641        MOVE SPACE               TO WS-FIRST-TIME-SW
 18642        GO TO 4005-READ-NEXT-RECORD.
 18643
 18644
 18645* EXEC CICS READNEXT
 18646*         DATASET    (FILE-ID-ERPNDB2)
 18647*         SET        (ADDRESS OF PENDING-BUSINESS)
 18648*         RIDFLD     (ERPNDB-ALT-KEY)
 18649*    END-EXEC.
 18650     MOVE 0
 18651       TO DFHEIV11
 18652*    MOVE '&.S                   )   #00015950' TO DFHEIV0
 18653     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18654     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18655     MOVE X'2020233030303135393530' TO DFHEIV0(25:11)
 18656     CALL 'kxdfhei1' USING DFHEIV0,
 18657           FILE-ID-ERPNDB2,
 18658           DFHEIV20,
 18659           DFHEIV99,
 18660           ERPNDB-ALT-KEY,
 18661           DFHEIV99,
 18662           DFHEIV11,
 18663           DFHEIV99,
 18664           DFHEIV99
 18665     SET ADDRESS OF PENDING-BUSINESS TO
 18666         DFHEIV20
 18667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18668
 18669
 18670 4005-READ-NEXT-RECORD.
 18671
 18672* EXEC CICS READNEXT
 18673*         DATASET    (FILE-ID-ERPNDB2)
 18674*         SET        (ADDRESS OF PENDING-BUSINESS)
 18675*         RIDFLD     (ERPNDB-ALT-KEY)
 18676*    END-EXEC.
 18677     MOVE 0
 18678       TO DFHEIV11
 18679*    MOVE '&.S                   )   #00015957' TO DFHEIV0
 18680     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18681     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18682     MOVE X'2020233030303135393537' TO DFHEIV0(25:11)
 18683     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 343
* EL6311.cbl
 18684           FILE-ID-ERPNDB2,
 18685           DFHEIV20,
 18686           DFHEIV99,
 18687           ERPNDB-ALT-KEY,
 18688           DFHEIV99,
 18689           DFHEIV11,
 18690           DFHEIV99,
 18691           DFHEIV99
 18692     SET ADDRESS OF PENDING-BUSINESS TO
 18693         DFHEIV20
 18694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18695
 18696
 18697     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18698
 18699     IF WS-BATCH-PREFIX = '#CL'
 18700        GO TO 4005-READ-NEXT-RECORD.
 18701
 18702     IF SHOW-RECORD
 18703        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18704           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18705           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18706           PB-STATE         NOT = PI-PB-STATE          OR
 18707           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18708           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18709           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18710           GO TO 4050-END-RECORDS
 18711        ELSE
 18712           GO TO 4010-CHECK-REC-TYPE.
 18713
 18714     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18715        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18716        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18717        PB-STATE            NOT = PI-PB-STATE          OR
 18718        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18719        GO TO 4050-END-RECORDS.
 18720
 18721     IF PB-BATCH-TRAILER
 18722        GO TO 4005-READ-NEXT-RECORD.
 18723
 18724     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18725        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18726           GO TO 4005-READ-NEXT-RECORD
 18727        ELSE
 18728           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18729              GO TO 4010-CHECK-REC-TYPE
 18730           ELSE
 18731              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18732                 GO TO 4010-CHECK-REC-TYPE
 18733              ELSE
 18734                 GO TO 4005-READ-NEXT-RECORD.
 18735
 18736     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18737        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18738           GO TO 4005-READ-NEXT-RECORD.
 18739
 18740 4010-CHECK-REC-TYPE.
 18741     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 344
* EL6311.cbl
 18742         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18743             NEXT SENTENCE
 18744         ELSE
 18745             GO TO 4005-READ-NEXT-RECORD.
 18746
 18747     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18748         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18749             NEXT SENTENCE
 18750        ELSE
 18751             GO TO 4005-READ-NEXT-RECORD.
 18752
 18753     IF NOT DISPLAY-CHANGE-RECORDS AND
 18754            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18755        GO TO 4005-READ-NEXT-RECORD.
 18756
 18757     IF DISPLAY-HOLD-RECORDS AND
 18758        NOT PB-RECORD-ON-HOLD
 18759          GO TO 4005-READ-NEXT-RECORD.
 18760
 18761     IF PB-ISSUE
 18762        IF DISPLAY-CHK-REQ-RECORDS
 18763            GO TO 4005-READ-NEXT-RECORD.
 18764
 18765     IF PB-ISSUE
 18766        IF ISSUE-WITH-WARNING
 18767           IF PB-WARNING-ERRORS
 18768              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18769                  GO TO 4005-READ-NEXT-RECORD
 18770              ELSE
 18771                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18772                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18773                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18774                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18775                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18776                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18777                 GO TO 7000-DISPLAY-ISSUES
 18778           ELSE
 18779              GO TO 4005-READ-NEXT-RECORD.
 18780
 18781     IF PB-ISSUE
 18782        IF (ISSUES-IN-ERROR AND
 18783            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18784            ALL-ISSUES
 18785            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18786            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18787            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18788            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18789            MOVE PB-SV-STATE            TO PI-SV-STATE
 18790            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18791            GO TO 7000-DISPLAY-ISSUES
 18792        ELSE
 18793            GO TO 4005-READ-NEXT-RECORD.
 18794
 18795     IF PB-CANCELLATION
 18796        IF DISPLAY-CHK-REQ-RECORDS
 18797           IF PB-C-REFUND-REQUESTED
 18798              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18799              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 345
* EL6311.cbl
 18800              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18801              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18802              MOVE PB-SV-STATE            TO PI-SV-STATE
 18803              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18804              GO TO 7100-DISPLAY-CANCELS
 18805           ELSE
 18806               GO TO 4005-READ-NEXT-RECORD.
 18807
 18808     IF PB-CANCELLATION
 18809        IF CANCEL-WITH-WARNING
 18810           IF PB-WARNING-ERRORS
 18811              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18812                  GO TO 4005-READ-NEXT-RECORD
 18813              ELSE
 18814                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18815                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18816                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18817                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18818                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18819                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18820                 GO TO 7100-DISPLAY-CANCELS
 18821           ELSE
 18822              GO TO 4005-READ-NEXT-RECORD.
 18823
 18824     IF PB-CANCELLATION
 18825        IF (CANCEL-IN-ERROR  AND
 18826            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18827            ALL-CANCELS
 18828            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18829            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18830            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18831            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18832            MOVE PB-SV-STATE            TO PI-SV-STATE
 18833            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18834            GO TO 7100-DISPLAY-CANCELS.
 18835
 18836     GO TO 4005-READ-NEXT-RECORD.
 18837
 18838 4050-END-RECORDS.
 18839******************************************************************
 18840*                                                                *
 18841*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18842*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18843*         PROGRAM.                                               *
 18844*                                                                *
 18845******************************************************************
 18846
 18847     IF BROWSE-STARTED
 18848        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18849
 18850* EXEC CICS ENDBR
 18851*            DATASET  (FILE-ID-ERPNDB2)
 18852*       END-EXEC.
 18853     MOVE 0
 18854       TO DFHEIV11
 18855*    MOVE '&2                    $   #00016115' TO DFHEIV0
 18856     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18857     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 346
* EL6311.cbl
 18858     MOVE X'2020233030303136313135' TO DFHEIV0(25:11)
 18859     CALL 'kxdfhei1' USING DFHEIV0,
 18860           FILE-ID-ERPNDB2,
 18861           DFHEIV11,
 18862           DFHEIV99
 18863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18864
 18865
 18866     IF  EIBTRNID NOT = TRANS-EXB1
 18867         IF PENDING-BUS-RECS-FOUND
 18868             NEXT SENTENCE
 18869           ELSE
 18870             MOVE '9'            TO PI-BROWSE-SW
 18871             GO TO 9400-CLEAR.
 18872
 18873     IF SHOW-RECORD
 18874        MOVE ER-2253            TO EMI-ERROR
 18875       ELSE
 18876        MOVE ER-2254            TO EMI-ERROR.
 18877
 18878     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18879
 18880     IF PI-MAP-NAME = SPACES
 18881        MOVE -1                  TO DPFENTRL
 18882        MOVE EL631D               TO PI-MAP-NAME
 18883        GO TO 8100-SEND-INITIAL-MAP.
 18884
 18885     IF PI-MAP-NAME = EL631B
 18886        MOVE -1                  TO BMAINTL
 18887     ELSE
 18888        IF PI-MAP-NAME = EL631C
 18889           MOVE -1               TO CMAINTL
 18890        ELSE
 18891           MOVE -1               TO DPFENTRL.
 18892
 18893     GO TO 8200-SEND-DATAONLY.
 18894
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 347
* EL6311.cbl
 18896
 18897***************************************************************
 18898*                                                             *
 18899*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18900*                                                             *
 18901*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18902*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18903*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18904*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18905*                                                             *
 18906*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18907*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18908*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18909*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18910*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18911*                AND IS IT TO BE DISPLAYED.                   *
 18912*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18913*                DISPLAYED.                                   *
 18914*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18915*                DISPLAYED.                                   *
 18916*                                                             *
 18917*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18918*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18919*                                                             *
 18920*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18921*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18922*                THEY ARE NOT TO BE DISPLAYED.                *
 18923*                                                             *
 18924***************************************************************
 18925
 18926 4100-BROWSE-PRIMARY-FORWARD.
 18927     IF FIRST-TIME  OR SHOW-RECORD
 18928        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18929        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18930        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18931     ELSE
 18932        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18933        IF ERPNDB-BATCH-SEQ-NO = +9999
 18934           GO TO 4150-END-BATCH
 18935        ELSE
 18936           IF DISPLAY-CHANGE-RECORDS
 18937              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18938           ELSE
 18939              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18940              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18941
 18942     IF FIRST-TIME
 18943         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18944            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18945              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18946
 18947
 18948* EXEC CICS HANDLE CONDITION
 18949*         ENDFILE  (4150-END-BATCH)
 18950*    END-EXEC.
 18951*    MOVE '"$''                   ! J #00016200' TO DFHEIV0
 18952     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18953     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 348
* EL6311.cbl
 18954     MOVE X'4A20233030303136323030' TO DFHEIV0(25:11)
 18955     CALL 'kxdfhei1' USING DFHEIV0
 18956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18957
 18958
 18959 4105-READ-NEXT.
 18960
 18961* EXEC CICS HANDLE CONDITION
 18962*         NOTFND    (4150-END-BATCH)
 18963*    END-EXEC.
 18964*    MOVE '"$I                   ! K #00016205' TO DFHEIV0
 18965     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18966     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18967     MOVE X'4B20233030303136323035' TO DFHEIV0(25:11)
 18968     CALL 'kxdfhei1' USING DFHEIV0
 18969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18970
 18971
 18972     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18973
 18974     IF PI-DISPLAY-ORIGINAL-BATCH
 18975        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18976     ELSE
 18977        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18978
 18979
 18980* EXEC CICS READ
 18981*         DATASET   (FILE-ID)
 18982*         SET       (ADDRESS OF PENDING-BUSINESS)
 18983*         RIDFLD    (ERPNDB-KEY)
 18984*         GTEQ
 18985*    END-EXEC.
 18986*    MOVE '&"S        G          (   #00016216' TO DFHEIV0
 18987     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18988     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18989     MOVE X'2020233030303136323136' TO DFHEIV0(25:11)
 18990     CALL 'kxdfhei1' USING DFHEIV0,
 18991           FILE-ID,
 18992           DFHEIV20,
 18993           DFHEIV99,
 18994           ERPNDB-KEY,
 18995           DFHEIV99,
 18996           DFHEIV99,
 18997           DFHEIV99
 18998     SET ADDRESS OF PENDING-BUSINESS TO
 18999         DFHEIV20
 19000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19001
 19002
 19003     IF PI-DISPLAY-ORIGINAL-BATCH
 19004        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19005           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19006           GO TO 4150-END-BATCH
 19007        ELSE
 19008           IF PB-BATCH-TRAILER
 19009              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 19010              GO TO 4105-READ-NEXT
 19011           ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 349
* EL6311.cbl
 19012              NEXT SENTENCE
 19013     ELSE
 19014        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19015           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19016           GO TO 4150-END-BATCH.
 19017
 19018     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19019
 19020     IF WS-BATCH-PREFIX = '#CL'
 19021         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19022         GO TO 4105-READ-NEXT.
 19023
 19024     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19025     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19026     MOVE PB-STATE               TO PI-PB-STATE.
 19027     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19028
 19029     IF PB-BATCH-TRAILER
 19030        IF SHOW-RECORD
 19031           GO TO 4150-END-BATCH
 19032        ELSE
 19033           MOVE ER-2251         TO EMI-ERROR
 19034           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19035           MOVE 1               TO PI-BROWSE-TYPE
 19036           GO TO 7200-DISPLAY-BATCHES.
 19037
 19038     IF SHOW-RECORD
 19039           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19040              GO TO 4110-BUMP-SEQ
 19041           ELSE
 19042              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19043                 GO TO 4110-BUMP-SEQ
 19044              ELSE
 19045                 GO TO 4107-CHECK-REC-TYPE.
 19046
 19047     IF NOT  PI-PRIMARY-WITH-SELECT
 19048        GO TO 4107-CHECK-REC-TYPE.
 19049
 19050     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19051        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19052           GO TO 4110-BUMP-SEQ
 19053        ELSE
 19054           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19055              GO TO 4107-CHECK-REC-TYPE
 19056           ELSE
 19057              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19058                 GO TO 4107-CHECK-REC-TYPE
 19059              ELSE
 19060                 GO TO 4110-BUMP-SEQ.
 19061
 19062     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19063        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19064           GO TO 4110-BUMP-SEQ.
 19065
 19066 4107-CHECK-REC-TYPE.
 19067     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19068         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19069             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 350
* EL6311.cbl
 19070           ELSE
 19071             GO TO 4110-BUMP-SEQ.
 19072
 19073     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19074         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19075             NEXT SENTENCE
 19076           ELSE
 19077             GO TO 4110-BUMP-SEQ.
 19078
 19079     IF NOT DISPLAY-CHANGE-RECORDS AND
 19080        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19081           GO TO 4110-BUMP-SEQ.
 19082
 19083     IF DISPLAY-HOLD-RECORDS AND
 19084        NOT PB-RECORD-ON-HOLD
 19085          GO TO 4110-BUMP-SEQ.
 19086
 19087     IF PB-ISSUE
 19088        IF DISPLAY-CHK-REQ-RECORDS
 19089            GO TO 4110-BUMP-SEQ.
 19090
 19091     IF PB-ISSUE
 19092        IF ISSUE-WITH-WARNING
 19093           IF PB-WARNING-ERRORS
 19094              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19095                  GO TO 4110-BUMP-SEQ
 19096              ELSE
 19097                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19098                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19099                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19100                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19101                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19102                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19103                 GO TO 7000-DISPLAY-ISSUES
 19104        ELSE
 19105            GO TO 4110-BUMP-SEQ.
 19106
 19107     IF PB-ISSUE
 19108        IF (ISSUES-IN-ERROR AND
 19109            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19110            ALL-ISSUES
 19111            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19112            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19113            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19114            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19115            MOVE PB-SV-STATE            TO PI-SV-STATE
 19116            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19117            GO TO 7000-DISPLAY-ISSUES
 19118        ELSE
 19119            GO TO 4110-BUMP-SEQ.
 19120
 19121     IF PB-CANCELLATION
 19122        IF DISPLAY-CHK-REQ-RECORDS
 19123           IF PB-C-REFUND-REQUESTED
 19124              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19125              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19126              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19127              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 351
* EL6311.cbl
 19128              MOVE PB-SV-STATE            TO PI-SV-STATE
 19129              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19130              GO TO 7100-DISPLAY-CANCELS
 19131           ELSE
 19132              GO TO 4110-BUMP-SEQ.
 19133
 19134     IF PB-CANCELLATION
 19135        IF CANCEL-WITH-WARNING
 19136           IF PB-WARNING-ERRORS
 19137              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19138                  GO TO 4110-BUMP-SEQ
 19139              ELSE
 19140                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19141                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19142                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19143                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19144                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19145                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19146                 GO TO 7100-DISPLAY-CANCELS
 19147           ELSE
 19148              GO TO 4110-BUMP-SEQ.
 19149
 19150     IF PB-CANCELLATION
 19151        IF (CANCEL-IN-ERROR  AND
 19152            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19153            ALL-CANCELS
 19154            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19155            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19156            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19157            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19158            MOVE PB-SV-STATE            TO PI-SV-STATE
 19159            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19160            GO TO 7100-DISPLAY-CANCELS.
 19161
 19162 4110-BUMP-SEQ.
 19163     IF NOT DISPLAY-CHANGE-RECORDS
 19164        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19165        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19166     ELSE
 19167        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19168           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19169           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19170        ELSE
 19171           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19172           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19173
 19174     GO TO 4105-READ-NEXT.
 19175
 19176 4150-END-BATCH.
 19177******************************************************************
 19178*                                                                *
 19179*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19180*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19181*         PROGRAM.                                               *
 19182*                                                                *
 19183******************************************************************
 19184
 19185     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 352
* EL6311.cbl
 19186         IF PENDING-BUS-RECS-FOUND
 19187             NEXT SENTENCE
 19188           ELSE
 19189             MOVE '9'            TO PI-BROWSE-SW
 19190             GO TO 9400-CLEAR.
 19191
 19192     IF SHOW-RECORD
 19193        MOVE ER-2253             TO EMI-ERROR
 19194     ELSE
 19195        MOVE ER-2251             TO EMI-ERROR.
 19196
 19197     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19198
 19199     IF PI-MAP-NAME = SPACES
 19200        MOVE -1                  TO BMAINTL
 19201        MOVE EL631B              TO PI-MAP-NAME
 19202        GO TO 8100-SEND-INITIAL-MAP.
 19203
 19204     IF PI-MAP-NAME = EL631B
 19205        MOVE -1                  TO BMAINTL
 19206     ELSE
 19207        IF PI-MAP-NAME = EL631C
 19208           MOVE -1               TO CMAINTL
 19209        ELSE
 19210           MOVE -1               TO DPFENTRL.
 19211
 19212     GO TO 8200-SEND-DATAONLY.
 19213
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 353
* EL6311.cbl
 19215
 19216***************************************************************
 19217*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19218*                                                             *
 19219*      1. START BROWSE WITH                                   *
 19220*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19221*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19222*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19223*                                                             *
 19224*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19225*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19226*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19227*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19228*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19229*               AND IS IT TO BE DISPLAYED.                    *
 19230*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19231*               DISPLAYED.                                    *
 19232*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19233*               DISPLAYED.                                    *
 19234*                                                             *
 19235*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19236*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19237***************************************************************
 19238
 19239 4200-BROWSE-CSR-FORWARD.
 19240
 19241     IF FIRST-TIME
 19242        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19243     ELSE
 19244        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19245
 19246
 19247* EXEC CICS HANDLE CONDITION
 19248*         NOTFND   (4250-END-RECORDS)
 19249*         ENDFILE  (4250-END-RECORDS)
 19250*    END-EXEC.
 19251*    MOVE '"$I''                  ! L #00016466' TO DFHEIV0
 19252     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19253     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19254     MOVE X'4C20233030303136343636' TO DFHEIV0(25:11)
 19255     CALL 'kxdfhei1' USING DFHEIV0
 19256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19257
 19258
 19259
 19260* EXEC CICS STARTBR
 19261*         DATASET   (FILE-ID-ERPNDB4)
 19262*         RIDFLD    (ERPNDB-CSR-KEY)
 19263*    END-EXEC.
 19264     MOVE 0
 19265       TO DFHEIV11
 19266*    MOVE '&,         G          &   #00016471' TO DFHEIV0
 19267     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19268     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19269     MOVE X'2020233030303136343731' TO DFHEIV0(25:11)
 19270     CALL 'kxdfhei1' USING DFHEIV0,
 19271           FILE-ID-ERPNDB4,
 19272           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 354
* EL6311.cbl
 19273           DFHEIV99,
 19274           DFHEIV11,
 19275           DFHEIV99
 19276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19277
 19278
 19279     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19280
 19281     IF FIRST-TIME
 19282        MOVE SPACE               TO WS-FIRST-TIME-SW
 19283        GO TO 4205-READ-NEXT-RECORD.
 19284
 19285
 19286* EXEC CICS READNEXT
 19287*         DATASET    (FILE-ID-ERPNDB4)
 19288*         SET        (ADDRESS OF PENDING-BUSINESS)
 19289*         RIDFLD     (ERPNDB-CSR-KEY)
 19290*    END-EXEC.
 19291     MOVE 0
 19292       TO DFHEIV11
 19293*    MOVE '&.S                   )   #00016482' TO DFHEIV0
 19294     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19295     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19296     MOVE X'2020233030303136343832' TO DFHEIV0(25:11)
 19297     CALL 'kxdfhei1' USING DFHEIV0,
 19298           FILE-ID-ERPNDB4,
 19299           DFHEIV20,
 19300           DFHEIV99,
 19301           ERPNDB-CSR-KEY,
 19302           DFHEIV99,
 19303           DFHEIV11,
 19304           DFHEIV99,
 19305           DFHEIV99
 19306     SET ADDRESS OF PENDING-BUSINESS TO
 19307         DFHEIV20
 19308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19309
 19310
 19311 4205-READ-NEXT-RECORD.
 19312
 19313
 19314* EXEC CICS READNEXT
 19315*         DATASET    (FILE-ID-ERPNDB4)
 19316*         SET        (ADDRESS OF PENDING-BUSINESS)
 19317*         RIDFLD     (ERPNDB-CSR-KEY)
 19318*    END-EXEC.
 19319     MOVE 0
 19320       TO DFHEIV11
 19321*    MOVE '&.S                   )   #00016490' TO DFHEIV0
 19322     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19323     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19324     MOVE X'2020233030303136343930' TO DFHEIV0(25:11)
 19325     CALL 'kxdfhei1' USING DFHEIV0,
 19326           FILE-ID-ERPNDB4,
 19327           DFHEIV20,
 19328           DFHEIV99,
 19329           ERPNDB-CSR-KEY,
 19330           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 355
* EL6311.cbl
 19331           DFHEIV11,
 19332           DFHEIV99,
 19333           DFHEIV99
 19334     SET ADDRESS OF PENDING-BUSINESS TO
 19335         DFHEIV20
 19336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19337
 19338
 19339     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19340
 19341     IF WS-BATCH-PREFIX = '#CL'
 19342        GO TO 4205-READ-NEXT-RECORD.
 19343
 19344     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19345        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19346        GO TO 4250-END-RECORDS.
 19347
 19348     IF PB-BATCH-TRAILER
 19349        GO TO 4205-READ-NEXT-RECORD.
 19350
 19351     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19352        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19353           GO TO 4205-READ-NEXT-RECORD
 19354        ELSE
 19355           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19356              GO TO 4210-CHECK-REC-TYPE
 19357           ELSE
 19358              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19359                 GO TO 4210-CHECK-REC-TYPE
 19360              ELSE
 19361                 GO TO 4205-READ-NEXT-RECORD.
 19362
 19363     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19364        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19365           GO TO 4205-READ-NEXT-RECORD.
 19366
 19367 4210-CHECK-REC-TYPE.
 19368     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19369         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19370             NEXT SENTENCE
 19371         ELSE
 19372             GO TO 4205-READ-NEXT-RECORD.
 19373
 19374     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19375         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19376             NEXT SENTENCE
 19377        ELSE
 19378             GO TO 4205-READ-NEXT-RECORD.
 19379
 19380     IF NOT DISPLAY-CHANGE-RECORDS AND
 19381            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19382        GO TO 4205-READ-NEXT-RECORD.
 19383
 19384     IF DISPLAY-HOLD-RECORDS AND
 19385        NOT PB-RECORD-ON-HOLD
 19386          GO TO 4205-READ-NEXT-RECORD.
 19387
 19388     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 356
* EL6311.cbl
 19389        IF DISPLAY-CHK-REQ-RECORDS
 19390            GO TO 4205-READ-NEXT-RECORD.
 19391
 19392     IF PB-ISSUE
 19393        IF ISSUE-WITH-WARNING
 19394           IF PB-WARNING-ERRORS
 19395              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19396                  GO TO 4205-READ-NEXT-RECORD
 19397              ELSE
 19398                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19399                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19400                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19401                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19402                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19403                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19404                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19405                 GO TO 7000-DISPLAY-ISSUES
 19406           ELSE
 19407              GO TO 4205-READ-NEXT-RECORD.
 19408
 19409     IF PB-ISSUE
 19410        IF (ISSUES-IN-ERROR AND
 19411            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19412            ALL-ISSUES
 19413            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19414            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19415            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19416            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19417            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19418            MOVE PB-SV-STATE            TO PI-SV-STATE
 19419            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19420            GO TO 7000-DISPLAY-ISSUES
 19421        ELSE
 19422            GO TO 4205-READ-NEXT-RECORD.
 19423
 19424     IF PB-CANCELLATION
 19425        IF DISPLAY-CHK-REQ-RECORDS
 19426           IF PB-C-REFUND-REQUESTED
 19427              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19428              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19429              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19430              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19431              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19432              MOVE PB-SV-STATE            TO PI-SV-STATE
 19433              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19434              GO TO 7100-DISPLAY-CANCELS
 19435           ELSE
 19436               GO TO 4205-READ-NEXT-RECORD.
 19437
 19438     IF PB-CANCELLATION
 19439        IF CANCEL-WITH-WARNING
 19440           IF PB-WARNING-ERRORS
 19441              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19442                  GO TO 4205-READ-NEXT-RECORD
 19443              ELSE
 19444                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19445                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19446                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 357
* EL6311.cbl
 19447                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19448                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19449                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19450                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19451                 GO TO 7100-DISPLAY-CANCELS
 19452           ELSE
 19453              GO TO 4205-READ-NEXT-RECORD.
 19454
 19455     IF PB-CANCELLATION
 19456        IF (CANCEL-IN-ERROR  AND
 19457            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19458            ALL-CANCELS
 19459            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19460            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19461            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19462            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19463            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19464            MOVE PB-SV-STATE            TO PI-SV-STATE
 19465            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19466            GO TO 7100-DISPLAY-CANCELS.
 19467
 19468     GO TO 4205-READ-NEXT-RECORD.
 19469
 19470 4250-END-RECORDS.
 19471******************************************************************
 19472*                                                                *
 19473*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19474*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19475*         PROGRAM.                                               *
 19476*                                                                *
 19477******************************************************************
 19478
 19479     IF BROWSE-STARTED
 19480        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19481
 19482* EXEC CICS ENDBR
 19483*            DATASET  (FILE-ID-ERPNDB4)
 19484*       END-EXEC.
 19485     MOVE 0
 19486       TO DFHEIV11
 19487*    MOVE '&2                    $   #00016638' TO DFHEIV0
 19488     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19489     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19490     MOVE X'2020233030303136363338' TO DFHEIV0(25:11)
 19491     CALL 'kxdfhei1' USING DFHEIV0,
 19492           FILE-ID-ERPNDB4,
 19493           DFHEIV11,
 19494           DFHEIV99
 19495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19496
 19497
 19498     IF  EIBTRNID NOT = TRANS-EXB1
 19499         IF PENDING-BUS-RECS-FOUND
 19500             NEXT SENTENCE
 19501           ELSE
 19502             MOVE '9'            TO PI-BROWSE-SW
 19503             GO TO 9400-CLEAR.
 19504
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 358
* EL6311.cbl
 19505     IF SHOW-RECORD
 19506        MOVE ER-2253            TO EMI-ERROR
 19507       ELSE
 19508        MOVE ER-2254            TO EMI-ERROR.
 19509
 19510     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19511
 19512     IF PI-MAP-NAME = SPACES
 19513        MOVE -1                  TO DPFENTRL
 19514        MOVE EL631D               TO PI-MAP-NAME
 19515        GO TO 8100-SEND-INITIAL-MAP.
 19516
 19517     IF PI-MAP-NAME = EL631B
 19518        MOVE -1                  TO BMAINTL
 19519     ELSE
 19520        IF PI-MAP-NAME = EL631C
 19521           MOVE -1               TO CMAINTL
 19522        ELSE
 19523           MOVE -1               TO DPFENTRL.
 19524
 19525     GO TO 8200-SEND-DATAONLY.
 19526
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 359
* EL6311.cbl
 19528
 19529***************************************************************
 19530*                                                             *
 19531*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19532*                                                             *
 19533*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19534*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19535*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19536*                                                             *
 19537*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19538*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19539*          A. IS IT WITHIN THE SAME COMPANY                   *
 19540*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19541*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19542*                AND IS IT TO BE DISPLAYED.                   *
 19543*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19544*                DISPLAYED.                                   *
 19545*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19546*                DISPLAYED.                                   *
 19547*                                                             *
 19548*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19549*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19550*                                                             *
 19551*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19552*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19553*                THEY ARE NOT TO BE DISPLAYED.                *
 19554*                                                             *
 19555***************************************************************
 19556
 19557 4300-BROWSE-FILE-FORWARD.
 19558     IF FIRST-TIME OR SHOW-RECORD
 19559        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19560        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19561        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19562     ELSE
 19563        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19564        IF ERPNDB-BATCH-SEQ-NO = +9999
 19565           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19566        ELSE
 19567           IF DISPLAY-CHANGE-RECORDS
 19568              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19569           ELSE
 19570              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19571              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19572
 19573
 19574* EXEC CICS HANDLE CONDITION
 19575*         ENDFILE  (4350-END-BATCH)
 19576*         NOTFND   (4350-END-BATCH)
 19577*    END-EXEC.
 19578*    MOVE '"$''I                  ! M #00016717' TO DFHEIV0
 19579     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19580     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19581     MOVE X'4D20233030303136373137' TO DFHEIV0(25:11)
 19582     CALL 'kxdfhei1' USING DFHEIV0
 19583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19584
 19585
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 360
* EL6311.cbl
 19586 4305-READ-NEXT.
 19587     IF PI-DISPLAY-ORIGINAL-BATCH
 19588        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19589     ELSE
 19590        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19591
 19592
 19593* EXEC CICS READ
 19594*         DATASET   (FILE-ID)
 19595*         SET       (ADDRESS OF PENDING-BUSINESS)
 19596*         RIDFLD    (ERPNDB-KEY)
 19597*         GTEQ
 19598*    END-EXEC.
 19599*    MOVE '&"S        G          (   #00016728' TO DFHEIV0
 19600     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19601     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19602     MOVE X'2020233030303136373238' TO DFHEIV0(25:11)
 19603     CALL 'kxdfhei1' USING DFHEIV0,
 19604           FILE-ID,
 19605           DFHEIV20,
 19606           DFHEIV99,
 19607           ERPNDB-KEY,
 19608           DFHEIV99,
 19609           DFHEIV99,
 19610           DFHEIV99
 19611     SET ADDRESS OF PENDING-BUSINESS TO
 19612         DFHEIV20
 19613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19614
 19615
 19616     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19617        GO TO 4350-END-BATCH.
 19618
 19619     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19620                                    WS-BATCH-NO.
 19621
 19622     IF  WS-BATCH-PREFIX = '#CL'
 19623         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19624         GO TO 4305-READ-NEXT.
 19625
 19626     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19627     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19628     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19629     MOVE PB-STATE               TO PI-PB-STATE.
 19630     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19631
 19632     IF PB-BATCH-TRAILER
 19633        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19634        GO TO 4305-READ-NEXT.
 19635
 19636     IF SHOW-RECORD
 19637           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19638              GO TO 4310-BUMP-SEQ
 19639           ELSE
 19640              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19641                 GO TO 4310-BUMP-SEQ
 19642              ELSE
 19643                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 361
* EL6311.cbl
 19644
 19645     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19646        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19647           GO TO 4310-BUMP-SEQ
 19648        ELSE
 19649           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19650              GO TO 4307-CHECK-REC-TYPE
 19651           ELSE
 19652              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19653                 GO TO 4307-CHECK-REC-TYPE
 19654              ELSE
 19655                 GO TO 4310-BUMP-SEQ.
 19656
 19657     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19658        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19659           GO TO 4310-BUMP-SEQ.
 19660
 19661 4307-CHECK-REC-TYPE.
 19662     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19663         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19664             NEXT SENTENCE
 19665         ELSE
 19666             GO TO 4310-BUMP-SEQ.
 19667
 19668     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19669         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19670             NEXT SENTENCE
 19671        ELSE
 19672             GO TO 4310-BUMP-SEQ.
 19673
 19674     IF NOT DISPLAY-CHANGE-RECORDS AND
 19675            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19676        GO TO 4310-BUMP-SEQ.
 19677
 19678     IF DISPLAY-HOLD-RECORDS AND
 19679        NOT PB-RECORD-ON-HOLD
 19680          GO TO 4310-BUMP-SEQ.
 19681
 19682     IF PB-ISSUE
 19683        IF DISPLAY-CHK-REQ-RECORDS
 19684           GO TO 4310-BUMP-SEQ.
 19685
 19686     IF PB-ISSUE
 19687        IF ISSUE-WITH-WARNING
 19688           IF PB-WARNING-ERRORS
 19689              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19690                  GO TO 4310-BUMP-SEQ
 19691              ELSE
 19692                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19693                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19694                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19695                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19696                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19697                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19698                 GO TO 7000-DISPLAY-ISSUES
 19699           ELSE
 19700              GO TO 4310-BUMP-SEQ.
 19701
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 362
* EL6311.cbl
 19702     IF PB-ISSUE
 19703        IF (ISSUES-IN-ERROR AND
 19704            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19705            ALL-ISSUES
 19706            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19707            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19708            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19709            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19710            MOVE PB-SV-STATE            TO PI-SV-STATE
 19711            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19712            GO TO 7000-DISPLAY-ISSUES
 19713        ELSE
 19714            GO TO 4310-BUMP-SEQ.
 19715
 19716     IF PB-CANCELLATION
 19717        IF DISPLAY-CHK-REQ-RECORDS
 19718           IF PB-C-REFUND-REQUESTED
 19719              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19720              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19721              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19722              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19723              MOVE PB-SV-STATE            TO PI-SV-STATE
 19724              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19725              GO TO 7100-DISPLAY-CANCELS
 19726           ELSE
 19727              GO TO 4310-BUMP-SEQ.
 19728
 19729     IF PB-CANCELLATION
 19730        IF CANCEL-WITH-WARNING
 19731           IF PB-WARNING-ERRORS
 19732              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19733                  GO TO 4310-BUMP-SEQ
 19734              ELSE
 19735                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19736                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19737                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19738                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19739                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19740                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19741                 GO TO 7100-DISPLAY-CANCELS
 19742           ELSE
 19743              GO TO 4310-BUMP-SEQ.
 19744
 19745     IF PB-CANCELLATION
 19746        IF (CANCEL-IN-ERROR  AND
 19747            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19748            ALL-CANCELS
 19749            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19750            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19751            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19752            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19753            MOVE PB-SV-STATE            TO PI-SV-STATE
 19754            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19755            GO TO 7100-DISPLAY-CANCELS.
 19756
 19757 4310-BUMP-SEQ.
 19758     IF NOT DISPLAY-CHANGE-RECORDS
 19759        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 363
* EL6311.cbl
 19760        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19761     ELSE
 19762        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19763           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19764           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19765        ELSE
 19766           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19767           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19768
 19769     GO TO 4305-READ-NEXT.
 19770
 19771 4350-END-BATCH.
 19772
 19773******************************************************************
 19774*                                                                *
 19775*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19776*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19777*         PROGRAM.                                               *
 19778*                                                                *
 19779******************************************************************
 19780
 19781     IF  EIBTRNID NOT = TRANS-EXB1
 19782         IF PENDING-BUS-RECS-FOUND
 19783             NEXT SENTENCE
 19784           ELSE
 19785             MOVE '9'            TO PI-BROWSE-SW
 19786             GO TO 9400-CLEAR.
 19787
 19788     IF SHOW-RECORD
 19789        MOVE ER-2253            TO EMI-ERROR
 19790     ELSE
 19791        MOVE ER-2251            TO EMI-ERROR.
 19792
 19793     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19794
 19795     IF PI-MAP-NAME = SPACES
 19796        MOVE -1                  TO BMAINTL
 19797        MOVE EL631B               TO PI-MAP-NAME
 19798        GO TO 8100-SEND-INITIAL-MAP.
 19799
 19800     IF PI-MAP-NAME = EL631B
 19801        MOVE -1                  TO BMAINTL
 19802     ELSE
 19803        IF PI-MAP-NAME = EL631C
 19804           MOVE -1               TO CMAINTL
 19805        ELSE
 19806           MOVE -1               TO DPFENTRL.
 19807
 19808     GO TO 8200-SEND-DATAONLY.
 19809
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 364
* EL6311.cbl
 19811
 19812******************************************************************
 19813*                                                                *
 19814*        B R O W S E   D E T A I L   B A C K W A R D             *
 19815*                                                                *
 19816******************************************************************
 19817
 19818 4500-BROWSE-DETAIL-BACKWARD.
 19819
 19820     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19821
 19822
 19823* EXEC CICS HANDLE CONDITION
 19824*         NOTFND   (4570-NOT-FOUND)
 19825*         ENDFILE  (4550-END-RECORDS)
 19826*    END-EXEC
 19827*    MOVE '"$I''                  ! N #00016941' TO DFHEIV0
 19828     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19829     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19830     MOVE X'4E20233030303136393431' TO DFHEIV0(25:11)
 19831     CALL 'kxdfhei1' USING DFHEIV0
 19832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19833
 19834
 19835* EXEC CICS STARTBR
 19836*         DATASET   (FILE-ID-ERPNDB2)
 19837*         RIDFLD    (ERPNDB-ALT-KEY)
 19838*    END-EXEC.
 19839     MOVE 0
 19840       TO DFHEIV11
 19841*    MOVE '&,         G          &   #00016946' TO DFHEIV0
 19842     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19843     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19844     MOVE X'2020233030303136393436' TO DFHEIV0(25:11)
 19845     CALL 'kxdfhei1' USING DFHEIV0,
 19846           FILE-ID-ERPNDB2,
 19847           ERPNDB-ALT-KEY,
 19848           DFHEIV99,
 19849           DFHEIV11,
 19850           DFHEIV99
 19851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19852
 19853
 19854     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19855                                    WS-FIRST-TIME-SW.
 19856
 19857 4505-READ-PREV-RECORD.
 19858
 19859* EXEC CICS READPREV
 19860*         DATASET    (FILE-ID-ERPNDB2)
 19861*         SET        (ADDRESS OF PENDING-BUSINESS)
 19862*         RIDFLD     (ERPNDB-ALT-KEY)
 19863*    END-EXEC.
 19864     MOVE 0
 19865       TO DFHEIV11
 19866*    MOVE '&0S                   )   #00016955' TO DFHEIV0
 19867     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19868     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 365
* EL6311.cbl
 19869     MOVE X'2020233030303136393535' TO DFHEIV0(25:11)
 19870     CALL 'kxdfhei1' USING DFHEIV0,
 19871           FILE-ID-ERPNDB2,
 19872           DFHEIV20,
 19873           DFHEIV99,
 19874           ERPNDB-ALT-KEY,
 19875           DFHEIV99,
 19876           DFHEIV11,
 19877           DFHEIV99,
 19878           DFHEIV99
 19879     SET ADDRESS OF PENDING-BUSINESS TO
 19880         DFHEIV20
 19881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19882
 19883
 19884     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19885
 19886     IF WS-BATCH-PREFIX = '#CL'
 19887         GO TO 4505-READ-PREV-RECORD.
 19888
 19889     IF FIRST-TIME
 19890         MOVE SPACE               TO WS-FIRST-TIME-SW
 19891         GO TO 4505-READ-PREV-RECORD.
 19892
 19893     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19894        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19895        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19896        PB-STATE         NOT = PI-PB-STATE    OR
 19897        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19898          GO TO 4550-END-RECORDS.
 19899
 19900
 19901     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19902
 19903     IF PB-BATCH-TRAILER
 19904        GO TO 4505-READ-PREV-RECORD.
 19905
 19906     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19907
 19908     IF  WS-BATCH-PREFIX = '#CL'
 19909         GO TO 4505-READ-PREV-RECORD.
 19910
 19911     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19912        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19913           GO TO 4505-READ-PREV-RECORD
 19914        ELSE
 19915           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19916              GO TO 4510-CHECK-REC-TYPE
 19917           ELSE
 19918              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19919                 GO TO 4510-CHECK-REC-TYPE
 19920              ELSE
 19921                 GO TO 4505-READ-PREV-RECORD.
 19922
 19923     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19924        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19925           GO TO 4505-READ-PREV-RECORD.
 19926
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 366
* EL6311.cbl
 19927 4510-CHECK-REC-TYPE.
 19928     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19929         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19930             NEXT SENTENCE
 19931         ELSE
 19932             GO TO 4505-READ-PREV-RECORD.
 19933
 19934     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19935         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19936             NEXT SENTENCE
 19937        ELSE
 19938             GO TO 4505-READ-PREV-RECORD.
 19939
 19940     IF NOT DISPLAY-CHANGE-RECORDS AND
 19941            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19942        GO TO 4505-READ-PREV-RECORD.
 19943
 19944     IF DISPLAY-HOLD-RECORDS AND
 19945        NOT PB-RECORD-ON-HOLD
 19946          GO TO 4505-READ-PREV-RECORD.
 19947
 19948     IF PB-ISSUE
 19949        IF DISPLAY-CHK-REQ-RECORDS
 19950           GO TO 4505-READ-PREV-RECORD.
 19951
 19952     IF PB-ISSUE
 19953        IF ISSUE-WITH-WARNING
 19954           IF PB-WARNING-ERRORS
 19955              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19956                  GO TO 4505-READ-PREV-RECORD
 19957              ELSE
 19958                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19959                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19960                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19961                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19962                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19963                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19964                 GO TO 7000-DISPLAY-ISSUES
 19965           ELSE
 19966              GO TO 4505-READ-PREV-RECORD.
 19967
 19968     IF PB-ISSUE
 19969        IF (ISSUES-IN-ERROR AND
 19970            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19971            ALL-ISSUES
 19972            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19973            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19974            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19975            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19976            MOVE PB-SV-STATE            TO PI-SV-STATE
 19977            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19978            GO TO 7000-DISPLAY-ISSUES
 19979        ELSE
 19980            GO TO 4505-READ-PREV-RECORD.
 19981
 19982     IF PB-CANCELLATION
 19983        IF DISPLAY-CHK-REQ-RECORDS
 19984           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 367
* EL6311.cbl
 19985              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19986              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19987              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19988              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19989              MOVE PB-SV-STATE            TO PI-SV-STATE
 19990              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19991              GO TO 7100-DISPLAY-CANCELS
 19992           ELSE
 19993              GO TO 4505-READ-PREV-RECORD.
 19994
 19995     IF PB-CANCELLATION
 19996        IF CANCEL-WITH-WARNING
 19997           IF PB-WARNING-ERRORS
 19998              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19999                  GO TO 4505-READ-PREV-RECORD
 20000              ELSE
 20001                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20002                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20003                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20004                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20005                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20006                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20007                 GO TO 7100-DISPLAY-CANCELS
 20008           ELSE
 20009              GO TO 4505-READ-PREV-RECORD.
 20010
 20011     IF PB-CANCELLATION
 20012        IF (CANCEL-IN-ERROR  AND
 20013            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20014            ALL-CANCELS
 20015            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20016            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20017            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20018            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20019            MOVE PB-SV-STATE            TO PI-SV-STATE
 20020            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20021            GO TO 7100-DISPLAY-CANCELS.
 20022
 20023     GO TO 4505-READ-PREV-RECORD.
 20024
 20025 4550-END-RECORDS.
 20026     IF PI-MAP-NAME = EL631B
 20027        MOVE -1                  TO BMAINTL
 20028     ELSE
 20029        IF PI-MAP-NAME = EL631C
 20030           MOVE -1               TO CMAINTL
 20031        ELSE
 20032           MOVE -1               TO DPFENTRL.
 20033
 20034     MOVE ER-2255               TO EMI-ERROR.
 20035     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20036     GO TO 8200-SEND-DATAONLY.
 20037
 20038 4570-NOT-FOUND.
 20039
 20040******************************************************************
 20041*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20042******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 368
* EL6311.cbl
 20043
 20044
 20045* EXEC CICS RESETBR
 20046*         DATASET    (FILE-ID-ERPNDB2)
 20047*         RIDFLD     (ERPNDB-ALT-KEY)
 20048*    END-EXEC.
 20049     MOVE 0
 20050       TO DFHEIV11
 20051*    MOVE '&4         G          &   #00017121' TO DFHEIV0
 20052     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20053     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20054     MOVE X'2020233030303137313231' TO DFHEIV0(25:11)
 20055     CALL 'kxdfhei1' USING DFHEIV0,
 20056           FILE-ID-ERPNDB2,
 20057           ERPNDB-ALT-KEY,
 20058           DFHEIV99,
 20059           DFHEIV11,
 20060           DFHEIV99
 20061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20062
 20063
 20064
 20065* EXEC CICS READNEXT
 20066*         DATASET    (FILE-ID-ERPNDB2)
 20067*         SET        (ADDRESS OF PENDING-BUSINESS)
 20068*         RIDFLD     (ERPNDB-ALT-KEY)
 20069*    END-EXEC.
 20070     MOVE 0
 20071       TO DFHEIV11
 20072*    MOVE '&.S                   )   #00017126' TO DFHEIV0
 20073     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20074     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20075     MOVE X'2020233030303137313236' TO DFHEIV0(25:11)
 20076     CALL 'kxdfhei1' USING DFHEIV0,
 20077           FILE-ID-ERPNDB2,
 20078           DFHEIV20,
 20079           DFHEIV99,
 20080           ERPNDB-ALT-KEY,
 20081           DFHEIV99,
 20082           DFHEIV11,
 20083           DFHEIV99,
 20084           DFHEIV99
 20085     SET ADDRESS OF PENDING-BUSINESS TO
 20086         DFHEIV20
 20087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20088
 20089
 20090
 20091* EXEC CICS READPREV
 20092*         DATASET    (FILE-ID-ERPNDB2)
 20093*         SET        (ADDRESS OF PENDING-BUSINESS)
 20094*         RIDFLD     (ERPNDB-ALT-KEY)
 20095*    END-EXEC.
 20096     MOVE 0
 20097       TO DFHEIV11
 20098*    MOVE '&0S                   )   #00017132' TO DFHEIV0
 20099     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20100     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 369
* EL6311.cbl
 20101     MOVE X'2020233030303137313332' TO DFHEIV0(25:11)
 20102     CALL 'kxdfhei1' USING DFHEIV0,
 20103           FILE-ID-ERPNDB2,
 20104           DFHEIV20,
 20105           DFHEIV99,
 20106           ERPNDB-ALT-KEY,
 20107           DFHEIV99,
 20108           DFHEIV11,
 20109           DFHEIV99,
 20110           DFHEIV99
 20111     SET ADDRESS OF PENDING-BUSINESS TO
 20112         DFHEIV20
 20113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20114
 20115
 20116 4580-READ-PREV-RECORD.
 20117
 20118* EXEC CICS READPREV
 20119*         DATASET    (FILE-ID-ERPNDB2)
 20120*         SET        (ADDRESS OF PENDING-BUSINESS)
 20121*         RIDFLD     (ERPNDB-ALT-KEY)
 20122*    END-EXEC.
 20123     MOVE 0
 20124       TO DFHEIV11
 20125*    MOVE '&0S                   )   #00017139' TO DFHEIV0
 20126     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20127     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20128     MOVE X'2020233030303137313339' TO DFHEIV0(25:11)
 20129     CALL 'kxdfhei1' USING DFHEIV0,
 20130           FILE-ID-ERPNDB2,
 20131           DFHEIV20,
 20132           DFHEIV99,
 20133           ERPNDB-ALT-KEY,
 20134           DFHEIV99,
 20135           DFHEIV11,
 20136           DFHEIV99,
 20137           DFHEIV99
 20138     SET ADDRESS OF PENDING-BUSINESS TO
 20139         DFHEIV20
 20140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20141
 20142
 20143     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20144
 20145     IF WS-BATCH-PREFIX = '#CL'
 20146        GO TO 4580-READ-PREV-RECORD.
 20147
 20148     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20149     GO TO 4505-READ-PREV-RECORD.
 20150
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 370
* EL6311.cbl
 20152
 20153******************************************************************
 20154*                                                                *
 20155*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20156*                                                                *
 20157******************************************************************
 20158
 20159 4600-BROWSE-PRIMARY-BACKWARD.
 20160        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20161
 20162     IF ERPNDB-BATCH-SEQ-NO = +9999
 20163        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20164
 20165        IF ERPNDB-BATCH-SEQ-NO = +0000
 20166           GO TO 4650-END-BATCH
 20167        ELSE
 20168           IF PI-MAP-NAME NOT = EL631D
 20169              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20170                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20171              ELSE
 20172                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20173                 IF DISPLAY-CHANGE-RECORDS
 20174                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20175                 ELSE
 20176                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20177
 20178
 20179* EXEC CICS HANDLE CONDITION
 20180*         NOTFND    (4680-NOT-FOUND)
 20181*         ENDFILE   (4680-NOT-FOUND)
 20182*    END-EXEC.
 20183*    MOVE '"$I''                  ! O #00017180' TO DFHEIV0
 20184     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20185     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20186     MOVE X'4F20233030303137313830' TO DFHEIV0(25:11)
 20187     CALL 'kxdfhei1' USING DFHEIV0
 20188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20189
 20190
 20191 4605-READ-NEXT.
 20192     IF ERPNDB-BATCH-SEQ-NO = +0000
 20193        GO TO 4650-END-BATCH.
 20194
 20195     IF PI-DISPLAY-ORIGINAL-BATCH
 20196        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20197     ELSE
 20198        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20199
 20200
 20201* EXEC CICS READ
 20202*         DATASET   (FILE-ID)
 20203*         SET       (ADDRESS OF PENDING-BUSINESS)
 20204*         RIDFLD    (ERPNDB-KEY)
 20205*    END-EXEC.
 20206*    MOVE '&"S        E          (   #00017194' TO DFHEIV0
 20207     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20208     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20209     MOVE X'2020233030303137313934' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 371
* EL6311.cbl
 20210     CALL 'kxdfhei1' USING DFHEIV0,
 20211           FILE-ID,
 20212           DFHEIV20,
 20213           DFHEIV99,
 20214           ERPNDB-KEY,
 20215           DFHEIV99,
 20216           DFHEIV99,
 20217           DFHEIV99
 20218     SET ADDRESS OF PENDING-BUSINESS TO
 20219         DFHEIV20
 20220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20221
 20222
 20223     IF NOT  PI-PRIMARY-WITH-SELECT
 20224        GO TO 4607-CHECK-REC-TYPE.
 20225
 20226     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20227
 20228     IF  WS-BATCH-PREFIX = '#CL'
 20229         GO TO 4610-BUMP-SEQ.
 20230
 20231     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20232        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20233           GO TO 4610-BUMP-SEQ
 20234        ELSE
 20235           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20236              GO TO 4607-CHECK-REC-TYPE
 20237           ELSE
 20238              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20239                 GO TO 4607-CHECK-REC-TYPE
 20240              ELSE
 20241                 GO TO 4610-BUMP-SEQ.
 20242
 20243     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20244        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20245           GO TO 4610-BUMP-SEQ.
 20246
 20247 4607-CHECK-REC-TYPE.
 20248     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20249         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20250             NEXT SENTENCE
 20251         ELSE
 20252             GO TO 4610-BUMP-SEQ.
 20253
 20254     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20255         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20256             NEXT SENTENCE
 20257        ELSE
 20258             GO TO 4610-BUMP-SEQ.
 20259
 20260     IF NOT DISPLAY-CHANGE-RECORDS AND
 20261            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20262        GO TO 4610-BUMP-SEQ.
 20263
 20264     IF DISPLAY-HOLD-RECORDS AND
 20265        NOT PB-RECORD-ON-HOLD
 20266          GO TO 4610-BUMP-SEQ.
 20267
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 372
* EL6311.cbl
 20268     IF PB-ISSUE
 20269        IF DISPLAY-CHK-REQ-RECORDS
 20270           GO TO 4610-BUMP-SEQ.
 20271
 20272     IF PB-ISSUE
 20273        IF ISSUE-WITH-WARNING
 20274           IF PB-WARNING-ERRORS
 20275              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20276                  GO TO 4610-BUMP-SEQ
 20277              ELSE
 20278                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20279                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20280                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20281                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20282                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20283                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20284                 GO TO 7000-DISPLAY-ISSUES
 20285           ELSE
 20286              GO TO 4610-BUMP-SEQ.
 20287
 20288     IF PB-ISSUE
 20289        IF (ISSUES-IN-ERROR AND
 20290            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20291            ALL-ISSUES
 20292            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20293            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20294            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20295            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20296            MOVE PB-SV-STATE            TO PI-SV-STATE
 20297            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20298            GO TO 7000-DISPLAY-ISSUES
 20299        ELSE
 20300            GO TO 4610-BUMP-SEQ.
 20301
 20302     IF PB-CANCELLATION
 20303        IF DISPLAY-CHK-REQ-RECORDS
 20304           IF PB-C-REFUND-REQUESTED
 20305              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20306              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20307              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20308              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20309              MOVE PB-SV-STATE            TO PI-SV-STATE
 20310              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20311              GO TO 7100-DISPLAY-CANCELS
 20312           ELSE
 20313              GO TO 4610-BUMP-SEQ.
 20314
 20315     IF PB-CANCELLATION
 20316        IF CANCEL-WITH-WARNING
 20317           IF PB-WARNING-ERRORS
 20318              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20319                  GO TO 4610-BUMP-SEQ
 20320              ELSE
 20321                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20322                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20323                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20324                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20325                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 373
* EL6311.cbl
 20326                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20327                 GO TO 7100-DISPLAY-CANCELS
 20328           ELSE
 20329              GO TO 4610-BUMP-SEQ.
 20330
 20331     IF PB-CANCELLATION
 20332        IF (CANCEL-IN-ERROR  AND
 20333            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20334            ALL-CANCELS
 20335            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20336            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20337            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20338            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20339            MOVE PB-SV-STATE            TO PI-SV-STATE
 20340            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20341            GO TO 7100-DISPLAY-CANCELS.
 20342
 20343 4610-BUMP-SEQ.
 20344     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20345        GO TO 4650-END-BATCH.
 20346
 20347     IF DISPLAY-CHANGE-RECORDS
 20348        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20349           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20350        ELSE
 20351           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20352           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20353        ELSE
 20354           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20355           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20356
 20357        GO TO 4605-READ-NEXT.
 20358
 20359 4650-END-BATCH.
 20360     IF PI-MAP-NAME = EL631B
 20361        MOVE -1                  TO BMAINTL
 20362     ELSE
 20363        IF PI-MAP-NAME = EL631C
 20364           MOVE -1               TO CMAINTL
 20365        ELSE
 20366           MOVE -1               TO DPFENTRL.
 20367
 20368     MOVE ER-2252               TO EMI-ERROR.
 20369     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20370     GO TO 8200-SEND-DATAONLY.
 20371
 20372 4680-NOT-FOUND.
 20373     IF DISPLAY-CHANGE-RECORDS
 20374        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20375           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20376        ELSE
 20377           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20378           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20379     ELSE
 20380        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20381
 20382     GO TO 4605-READ-NEXT.
 20383
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 374
* EL6311.cbl
 20385
 20386******************************************************************
 20387*                                                                *
 20388*        B R O W S E   F I L E   B A C K W A R D S               *
 20389*                                                                *
 20390******************************************************************
 20391
 20392 4800-BROWSE-FILE-BACKWARD.
 20393
 20394* EXEC CICS HANDLE CONDITION
 20395*         NOTFND   (4860-NOT-FOUND)
 20396*         ENDFILE  (4850-END-RECORDS)
 20397*    END-EXEC.
 20398*    MOVE '"$I''                  ! P #00017370' TO DFHEIV0
 20399     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20401     MOVE X'5020233030303137333730' TO DFHEIV0(25:11)
 20402     CALL 'kxdfhei1' USING DFHEIV0
 20403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20404
 20405
 20406     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20407
 20408     IF PI-DISPLAY-ORIGINAL-BATCH
 20409        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20410     ELSE
 20411        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20412
 20413
 20414* EXEC CICS STARTBR
 20415*         DATASET   (FILE-ID)
 20416*         RIDFLD    (ERPNDB-KEY)
 20417*    END-EXEC.
 20418     MOVE 0
 20419       TO DFHEIV11
 20420*    MOVE '&,         G          &   #00017382' TO DFHEIV0
 20421     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20422     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20423     MOVE X'2020233030303137333832' TO DFHEIV0(25:11)
 20424     CALL 'kxdfhei1' USING DFHEIV0,
 20425           FILE-ID,
 20426           ERPNDB-KEY,
 20427           DFHEIV99,
 20428           DFHEIV11,
 20429           DFHEIV99
 20430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20431
 20432
 20433     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20434
 20435
 20436* EXEC CICS READPREV
 20437*         DATASET    (FILE-ID-ERPNDB)
 20438*         SET        (ADDRESS OF PENDING-BUSINESS)
 20439*         RIDFLD     (ERPNDB-KEY)
 20440*    END-EXEC.
 20441     MOVE 0
 20442       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 375
* EL6311.cbl
 20443*    MOVE '&0S                   )   #00017389' TO DFHEIV0
 20444     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20445     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20446     MOVE X'2020233030303137333839' TO DFHEIV0(25:11)
 20447     CALL 'kxdfhei1' USING DFHEIV0,
 20448           FILE-ID-ERPNDB,
 20449           DFHEIV20,
 20450           DFHEIV99,
 20451           ERPNDB-KEY,
 20452           DFHEIV99,
 20453           DFHEIV11,
 20454           DFHEIV99,
 20455           DFHEIV99
 20456     SET ADDRESS OF PENDING-BUSINESS TO
 20457         DFHEIV20
 20458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20459
 20460
 20461 4810-READ-PREV-RECORD.
 20462
 20463* EXEC CICS READPREV
 20464*         DATASET    (FILE-ID-ERPNDB)
 20465*         SET        (ADDRESS OF PENDING-BUSINESS)
 20466*         RIDFLD     (ERPNDB-KEY)
 20467*    END-EXEC.
 20468     MOVE 0
 20469       TO DFHEIV11
 20470*    MOVE '&0S                   )   #00017396' TO DFHEIV0
 20471     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20472     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20473     MOVE X'2020233030303137333936' TO DFHEIV0(25:11)
 20474     CALL 'kxdfhei1' USING DFHEIV0,
 20475           FILE-ID-ERPNDB,
 20476           DFHEIV20,
 20477           DFHEIV99,
 20478           ERPNDB-KEY,
 20479           DFHEIV99,
 20480           DFHEIV11,
 20481           DFHEIV99,
 20482           DFHEIV99
 20483     SET ADDRESS OF PENDING-BUSINESS TO
 20484         DFHEIV20
 20485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20486
 20487
 20488     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20489        GO TO 4850-END-RECORDS.
 20490
 20491     IF PB-BATCH-TRAILER
 20492        GO TO 4810-READ-PREV-RECORD.
 20493
 20494     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20495
 20496     IF  WS-BATCH-PREFIX = '#CL'
 20497         GO TO 4810-READ-PREV-RECORD.
 20498
 20499     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20500        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 376
* EL6311.cbl
 20501           GO TO 4810-READ-PREV-RECORD
 20502        ELSE
 20503           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20504              GO TO 4820-CHECK-REC-TYPE
 20505           ELSE
 20506              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20507                 GO TO 4820-CHECK-REC-TYPE
 20508              ELSE
 20509                 GO TO 4810-READ-PREV-RECORD.
 20510
 20511     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20512        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20513           GO TO 4810-READ-PREV-RECORD.
 20514
 20515 4820-CHECK-REC-TYPE.
 20516     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20517         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20518             NEXT SENTENCE
 20519         ELSE
 20520             GO TO 4810-READ-PREV-RECORD.
 20521
 20522     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20523         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20524             NEXT SENTENCE
 20525        ELSE
 20526             GO TO 4810-READ-PREV-RECORD.
 20527
 20528     IF NOT DISPLAY-CHANGE-RECORDS AND
 20529            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20530        GO TO 4810-READ-PREV-RECORD.
 20531
 20532     IF DISPLAY-HOLD-RECORDS AND
 20533        NOT PB-RECORD-ON-HOLD
 20534          GO TO 4810-READ-PREV-RECORD.
 20535
 20536     IF PB-ISSUE
 20537        IF DISPLAY-CHK-REQ-RECORDS
 20538           GO TO 4810-READ-PREV-RECORD.
 20539
 20540     IF PB-ISSUE
 20541        IF ISSUE-WITH-WARNING
 20542           IF PB-WARNING-ERRORS
 20543              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20544                  GO TO 4810-READ-PREV-RECORD
 20545              ELSE
 20546                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20547                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20548                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20549                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20550                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20551                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20552                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20553                 GO TO 7000-DISPLAY-ISSUES
 20554           ELSE
 20555              GO TO 4810-READ-PREV-RECORD.
 20556
 20557     IF PB-ISSUE
 20558        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 377
* EL6311.cbl
 20559            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20560            ALL-ISSUES
 20561            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20562            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20563            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20564            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20565            MOVE PB-SV-STATE            TO PI-SV-STATE
 20566            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20567            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20568            GO TO 7000-DISPLAY-ISSUES
 20569        ELSE
 20570            GO TO 4810-READ-PREV-RECORD.
 20571
 20572     IF PB-CANCELLATION
 20573        IF DISPLAY-CHK-REQ-RECORDS
 20574           IF PB-C-REFUND-REQUESTED
 20575              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20576              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20577              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20578              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20579              MOVE PB-SV-STATE            TO PI-SV-STATE
 20580              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20581              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20582              GO TO 7100-DISPLAY-CANCELS
 20583           ELSE
 20584              GO TO 4810-READ-PREV-RECORD.
 20585
 20586     IF PB-CANCELLATION
 20587        IF CANCEL-WITH-WARNING
 20588           IF PB-WARNING-ERRORS
 20589              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20590                  GO TO 4810-READ-PREV-RECORD
 20591              ELSE
 20592                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20593                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20594                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20595                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20596                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20597                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20598                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20599                 GO TO 7100-DISPLAY-CANCELS
 20600           ELSE
 20601              GO TO 4810-READ-PREV-RECORD.
 20602
 20603     IF PB-CANCELLATION
 20604        IF (CANCEL-IN-ERROR  AND
 20605            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20606            ALL-CANCELS
 20607            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20608            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20609            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20610            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20611            MOVE PB-SV-STATE            TO PI-SV-STATE
 20612            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20613            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20614            GO TO 7100-DISPLAY-CANCELS.
 20615
 20616     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 378
* EL6311.cbl
 20617
 20618 4850-END-RECORDS.
 20619     MOVE ER-2252                TO EMI-ERROR.
 20620     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20621
 20622     IF PI-MAP-NAME = EL631B
 20623        MOVE -1                  TO BPFENTRL
 20624     ELSE
 20625        MOVE -1                  TO CPFENTRL.
 20626
 20627     GO TO 8200-SEND-DATAONLY.
 20628
 20629 4860-NOT-FOUND.
 20630
 20631******************************************************************
 20632*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20633******************************************************************
 20634
 20635
 20636* EXEC CICS RESETBR
 20637*         DATASET    (FILE-ID-ERPNDB)
 20638*         RIDFLD     (ERPNDB-KEY)
 20639*     END-EXEC.
 20640     MOVE 0
 20641       TO DFHEIV11
 20642*    MOVE '&4         G          &   #00017549' TO DFHEIV0
 20643     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20644     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20645     MOVE X'2020233030303137353439' TO DFHEIV0(25:11)
 20646     CALL 'kxdfhei1' USING DFHEIV0,
 20647           FILE-ID-ERPNDB,
 20648           ERPNDB-KEY,
 20649           DFHEIV99,
 20650           DFHEIV11,
 20651           DFHEIV99
 20652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20653
 20654
 20655
 20656* EXEC CICS READNEXT
 20657*         DATASET    (FILE-ID-ERPNDB)
 20658*         SET        (ADDRESS OF PENDING-BUSINESS)
 20659*         RIDFLD     (ERPNDB-KEY)
 20660*    END-EXEC.
 20661     MOVE 0
 20662       TO DFHEIV11
 20663*    MOVE '&.S                   )   #00017554' TO DFHEIV0
 20664     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20665     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20666     MOVE X'2020233030303137353534' TO DFHEIV0(25:11)
 20667     CALL 'kxdfhei1' USING DFHEIV0,
 20668           FILE-ID-ERPNDB,
 20669           DFHEIV20,
 20670           DFHEIV99,
 20671           ERPNDB-KEY,
 20672           DFHEIV99,
 20673           DFHEIV11,
 20674           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 379
* EL6311.cbl
 20675           DFHEIV99
 20676     SET ADDRESS OF PENDING-BUSINESS TO
 20677         DFHEIV20
 20678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20679
 20680
 20681
 20682* EXEC CICS READPREV
 20683*         DATASET    (FILE-ID-ERPNDB)
 20684*         SET        (ADDRESS OF PENDING-BUSINESS)
 20685*         RIDFLD     (ERPNDB-KEY)
 20686*    END-EXEC.
 20687     MOVE 0
 20688       TO DFHEIV11
 20689*    MOVE '&0S                   )   #00017560' TO DFHEIV0
 20690     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20691     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20692     MOVE X'2020233030303137353630' TO DFHEIV0(25:11)
 20693     CALL 'kxdfhei1' USING DFHEIV0,
 20694           FILE-ID-ERPNDB,
 20695           DFHEIV20,
 20696           DFHEIV99,
 20697           ERPNDB-KEY,
 20698           DFHEIV99,
 20699           DFHEIV11,
 20700           DFHEIV99,
 20701           DFHEIV99
 20702     SET ADDRESS OF PENDING-BUSINESS TO
 20703         DFHEIV20
 20704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20705
 20706
 20707     GO TO 4810-READ-PREV-RECORD.
 20708
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 380
* EL6311.cbl
 20710
 20711******************************************************************
 20712*                                                                *
 20713*           B R O W S E   C S R   B A C K W A R D                *
 20714*                                                                *
 20715******************************************************************
 20716
 20717 4900-BROWSE-CSR-BACKWARD.
 20718
 20719     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20720
 20721
 20722* EXEC CICS HANDLE CONDITION
 20723*         NOTFND   (4970-NOT-FOUND)
 20724*         ENDFILE  (4950-END-RECORDS)
 20725*    END-EXEC
 20726*    MOVE '"$I''                  ! Q #00017580' TO DFHEIV0
 20727     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20728     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20729     MOVE X'5120233030303137353830' TO DFHEIV0(25:11)
 20730     CALL 'kxdfhei1' USING DFHEIV0
 20731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20732
 20733
 20734* EXEC CICS STARTBR
 20735*         DATASET   (FILE-ID-ERPNDB4)
 20736*         RIDFLD    (ERPNDB-CSR-KEY)
 20737*    END-EXEC.
 20738     MOVE 0
 20739       TO DFHEIV11
 20740*    MOVE '&,         G          &   #00017585' TO DFHEIV0
 20741     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20742     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20743     MOVE X'2020233030303137353835' TO DFHEIV0(25:11)
 20744     CALL 'kxdfhei1' USING DFHEIV0,
 20745           FILE-ID-ERPNDB4,
 20746           ERPNDB-CSR-KEY,
 20747           DFHEIV99,
 20748           DFHEIV11,
 20749           DFHEIV99
 20750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20751
 20752
 20753     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20754                                    WS-FIRST-TIME-SW.
 20755
 20756 4905-READ-PREV-RECORD.
 20757
 20758* EXEC CICS READPREV
 20759*         DATASET    (FILE-ID-ERPNDB4)
 20760*         SET        (ADDRESS OF PENDING-BUSINESS)
 20761*         RIDFLD     (ERPNDB-CSR-KEY)
 20762*    END-EXEC.
 20763     MOVE 0
 20764       TO DFHEIV11
 20765*    MOVE '&0S                   )   #00017594' TO DFHEIV0
 20766     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20767     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 381
* EL6311.cbl
 20768     MOVE X'2020233030303137353934' TO DFHEIV0(25:11)
 20769     CALL 'kxdfhei1' USING DFHEIV0,
 20770           FILE-ID-ERPNDB4,
 20771           DFHEIV20,
 20772           DFHEIV99,
 20773           ERPNDB-CSR-KEY,
 20774           DFHEIV99,
 20775           DFHEIV11,
 20776           DFHEIV99,
 20777           DFHEIV99
 20778     SET ADDRESS OF PENDING-BUSINESS TO
 20779         DFHEIV20
 20780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20781
 20782
 20783     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20784
 20785     IF WS-BATCH-PREFIX = '#CL'
 20786         GO TO 4905-READ-PREV-RECORD.
 20787
 20788     IF FIRST-TIME
 20789         MOVE SPACE               TO WS-FIRST-TIME-SW
 20790         GO TO 4905-READ-PREV-RECORD.
 20791
 20792     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20793        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20794        GO TO 4950-END-RECORDS.
 20795
 20796     IF PB-BATCH-TRAILER
 20797        GO TO 4905-READ-PREV-RECORD.
 20798
 20799     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20800
 20801     IF  WS-BATCH-PREFIX = '#CL'
 20802         GO TO 4905-READ-PREV-RECORD.
 20803
 20804     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20805        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20806           GO TO 4905-READ-PREV-RECORD
 20807        ELSE
 20808           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20809              GO TO 4910-CHECK-REC-TYPE
 20810           ELSE
 20811              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20812                 GO TO 4910-CHECK-REC-TYPE
 20813              ELSE
 20814                 GO TO 4905-READ-PREV-RECORD.
 20815
 20816     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20817        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20818           GO TO 4905-READ-PREV-RECORD.
 20819
 20820 4910-CHECK-REC-TYPE.
 20821     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20822         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20823             NEXT SENTENCE
 20824         ELSE
 20825             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 382
* EL6311.cbl
 20826
 20827     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20828         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20829             NEXT SENTENCE
 20830        ELSE
 20831             GO TO 4905-READ-PREV-RECORD.
 20832
 20833     IF NOT DISPLAY-CHANGE-RECORDS AND
 20834            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20835        GO TO 4905-READ-PREV-RECORD.
 20836
 20837     IF DISPLAY-HOLD-RECORDS AND
 20838        NOT PB-RECORD-ON-HOLD
 20839          GO TO 4905-READ-PREV-RECORD.
 20840
 20841     IF PB-ISSUE
 20842        IF DISPLAY-CHK-REQ-RECORDS
 20843           GO TO 4905-READ-PREV-RECORD.
 20844
 20845     IF PB-ISSUE
 20846        IF ISSUE-WITH-WARNING
 20847           IF PB-WARNING-ERRORS
 20848              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20849                  GO TO 4505-READ-PREV-RECORD
 20850              ELSE
 20851                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20852                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20853                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20854                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20855                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20856                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20857                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20858                 GO TO 7000-DISPLAY-ISSUES
 20859           ELSE
 20860              GO TO 4905-READ-PREV-RECORD.
 20861
 20862     IF PB-ISSUE
 20863        IF (ISSUES-IN-ERROR AND
 20864            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20865            ALL-ISSUES
 20866            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20867            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20868            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20869            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20870            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20871            MOVE PB-SV-STATE            TO PI-SV-STATE
 20872            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20873            GO TO 7000-DISPLAY-ISSUES
 20874        ELSE
 20875            GO TO 4905-READ-PREV-RECORD.
 20876
 20877     IF PB-CANCELLATION
 20878        IF DISPLAY-CHK-REQ-RECORDS
 20879           IF PB-C-REFUND-REQUESTED
 20880              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20881              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20882              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20883              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 383
* EL6311.cbl
 20884              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20885              MOVE PB-SV-STATE            TO PI-SV-STATE
 20886              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20887              GO TO 7100-DISPLAY-CANCELS
 20888           ELSE
 20889              GO TO 4905-READ-PREV-RECORD.
 20890
 20891     IF PB-CANCELLATION
 20892        IF CANCEL-WITH-WARNING
 20893           IF PB-WARNING-ERRORS
 20894              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20895                  GO TO 4505-READ-PREV-RECORD
 20896              ELSE
 20897                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20898                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20899                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20900                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20901                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20902                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20903                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20904                 GO TO 7100-DISPLAY-CANCELS
 20905           ELSE
 20906              GO TO 4905-READ-PREV-RECORD.
 20907
 20908     IF PB-CANCELLATION
 20909        IF (CANCEL-IN-ERROR  AND
 20910            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20911            ALL-CANCELS
 20912            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20913            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20914            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20915            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20916            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20917            MOVE PB-SV-STATE            TO PI-SV-STATE
 20918            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20919            GO TO 7100-DISPLAY-CANCELS.
 20920
 20921     GO TO 4905-READ-PREV-RECORD.
 20922
 20923 4950-END-RECORDS.
 20924     IF PI-MAP-NAME = EL631B
 20925        MOVE -1                  TO BMAINTL
 20926     ELSE
 20927        IF PI-MAP-NAME = EL631C
 20928           MOVE -1               TO CMAINTL
 20929        ELSE
 20930           MOVE -1               TO DPFENTRL.
 20931
 20932     MOVE ER-2255               TO EMI-ERROR.
 20933     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20934     GO TO 8200-SEND-DATAONLY.
 20935
 20936 4970-NOT-FOUND.
 20937
 20938******************************************************************
 20939*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20940******************************************************************
 20941
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 384
* EL6311.cbl
 20942
 20943* EXEC CICS RESETBR
 20944*         DATASET    (FILE-ID-ERPNDB4)
 20945*         RIDFLD     (ERPNDB-CSR-KEY)
 20946*    END-EXEC.
 20947     MOVE 0
 20948       TO DFHEIV11
 20949*    MOVE '&4         G          &   #00017759' TO DFHEIV0
 20950     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20951     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20952     MOVE X'2020233030303137373539' TO DFHEIV0(25:11)
 20953     CALL 'kxdfhei1' USING DFHEIV0,
 20954           FILE-ID-ERPNDB4,
 20955           ERPNDB-CSR-KEY,
 20956           DFHEIV99,
 20957           DFHEIV11,
 20958           DFHEIV99
 20959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20960
 20961
 20962
 20963* EXEC CICS READNEXT
 20964*         DATASET    (FILE-ID-ERPNDB4)
 20965*         SET        (ADDRESS OF PENDING-BUSINESS)
 20966*         RIDFLD     (ERPNDB-CSR-KEY)
 20967*    END-EXEC.
 20968     MOVE 0
 20969       TO DFHEIV11
 20970*    MOVE '&.S                   )   #00017764' TO DFHEIV0
 20971     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20972     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20973     MOVE X'2020233030303137373634' TO DFHEIV0(25:11)
 20974     CALL 'kxdfhei1' USING DFHEIV0,
 20975           FILE-ID-ERPNDB4,
 20976           DFHEIV20,
 20977           DFHEIV99,
 20978           ERPNDB-CSR-KEY,
 20979           DFHEIV99,
 20980           DFHEIV11,
 20981           DFHEIV99,
 20982           DFHEIV99
 20983     SET ADDRESS OF PENDING-BUSINESS TO
 20984         DFHEIV20
 20985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20986
 20987
 20988
 20989* EXEC CICS READPREV
 20990*         DATASET    (FILE-ID-ERPNDB4)
 20991*         SET        (ADDRESS OF PENDING-BUSINESS)
 20992*         RIDFLD     (ERPNDB-CSR-KEY)
 20993*    END-EXEC.
 20994     MOVE 0
 20995       TO DFHEIV11
 20996*    MOVE '&0S                   )   #00017770' TO DFHEIV0
 20997     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20998     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20999     MOVE X'2020233030303137373730' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 385
* EL6311.cbl
 21000     CALL 'kxdfhei1' USING DFHEIV0,
 21001           FILE-ID-ERPNDB4,
 21002           DFHEIV20,
 21003           DFHEIV99,
 21004           ERPNDB-CSR-KEY,
 21005           DFHEIV99,
 21006           DFHEIV11,
 21007           DFHEIV99,
 21008           DFHEIV99
 21009     SET ADDRESS OF PENDING-BUSINESS TO
 21010         DFHEIV20
 21011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21012
 21013
 21014 4980-READ-PREV-RECORD.
 21015
 21016* EXEC CICS READPREV
 21017*         DATASET    (FILE-ID-ERPNDB4)
 21018*         SET        (ADDRESS OF PENDING-BUSINESS)
 21019*         RIDFLD     (ERPNDB-CSR-KEY)
 21020*    END-EXEC.
 21021     MOVE 0
 21022       TO DFHEIV11
 21023*    MOVE '&0S                   )   #00017777' TO DFHEIV0
 21024     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21025     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21026     MOVE X'2020233030303137373737' TO DFHEIV0(25:11)
 21027     CALL 'kxdfhei1' USING DFHEIV0,
 21028           FILE-ID-ERPNDB4,
 21029           DFHEIV20,
 21030           DFHEIV99,
 21031           ERPNDB-CSR-KEY,
 21032           DFHEIV99,
 21033           DFHEIV11,
 21034           DFHEIV99,
 21035           DFHEIV99
 21036     SET ADDRESS OF PENDING-BUSINESS TO
 21037         DFHEIV20
 21038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21039
 21040
 21041     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21042
 21043     IF WS-BATCH-PREFIX = '#CL'
 21044        GO TO 4980-READ-PREV-RECORD.
 21045
 21046     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 21047     GO TO 4905-READ-PREV-RECORD.
 21048
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 386
* EL6311.cbl
 21050
 21051
 21052******************************************************************
 21053*                                                                *
 21054*        B R O W S E   B A T C H   H E A D E R S                 *
 21055*                                                                *
 21056******************************************************************
 21057
 21058 5000-BROWSE-BATCH-HEADERS.
 21059
 21060     IF EIBTRNID NOT = TRANS-EXB1
 21061        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 21062        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21063        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21064        GO TO 5010-READ-NEXT-RECORD.
 21065
 21066     IF EIBAID = DFHPF4
 21067        MOVE '0'                TO PI-EDIT-SW
 21068        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21069        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21070        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21071        GO TO 5010-READ-NEXT-RECORD.
 21072
 21073     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21074     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 21075     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21076
 21077
 21078* EXEC CICS HANDLE CONDITION
 21079*         ENDFILE  (5050-NOT-FOUND)
 21080*    END-EXEC.
 21081*    MOVE '"$''                   ! R #00017819' TO DFHEIV0
 21082     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 21083     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21084     MOVE X'5220233030303137383139' TO DFHEIV0(25:11)
 21085     CALL 'kxdfhei1' USING DFHEIV0
 21086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21087
 21088
 21089 5010-READ-NEXT-RECORD.
 21090
 21091* EXEC CICS HANDLE CONDITION
 21092*         NOTFND    (5050-NOT-FOUND)
 21093*    END-EXEC.
 21094*    MOVE '"$I                   ! S #00017824' TO DFHEIV0
 21095     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21097     MOVE X'5320233030303137383234' TO DFHEIV0(25:11)
 21098     CALL 'kxdfhei1' USING DFHEIV0
 21099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21100
 21101
 21102
 21103* EXEC CICS READ
 21104*         DATASET   (FILE-ID-ERPNDB)
 21105*         SET       (ADDRESS OF PENDING-BUSINESS)
 21106*         RIDFLD    (ERPNDB-KEY)
 21107*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 387
* EL6311.cbl
 21108*    END-EXEC.
 21109*    MOVE '&"S        G          (   #00017828' TO DFHEIV0
 21110     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21111     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21112     MOVE X'2020233030303137383238' TO DFHEIV0(25:11)
 21113     CALL 'kxdfhei1' USING DFHEIV0,
 21114           FILE-ID-ERPNDB,
 21115           DFHEIV20,
 21116           DFHEIV99,
 21117           ERPNDB-KEY,
 21118           DFHEIV99,
 21119           DFHEIV99,
 21120           DFHEIV99
 21121     SET ADDRESS OF PENDING-BUSINESS TO
 21122         DFHEIV20
 21123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21124
 21125
 21126     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21127         GO TO 5050-NOT-FOUND.
 21128
 21129     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21130
 21131     IF WS-BATCH-PREFIX = '#CL'
 21132         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21133         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21134         GO TO 5010-READ-NEXT-RECORD.
 21135
 21136     IF NOT PB-BATCH-TRAILER
 21137         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21138         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21139         GO TO 5010-READ-NEXT-RECORD.
 21140
 21141     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21142         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21143             NEXT SENTENCE
 21144         ELSE
 21145             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21146             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21147             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21148             GO TO 5010-READ-NEXT-RECORD.
 21149
 21150     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21151         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21152             NEXT SENTENCE
 21153        ELSE
 21154             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21155             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21156             GO TO 5010-READ-NEXT-RECORD.
 21157
 21158     IF EIBAID = DFHPF4
 21159        MOVE '0'                TO PI-EDIT-SW
 21160        GO TO 7200-DISPLAY-BATCHES.
 21161
 21162     IF PI-CSR-BROWSE
 21163        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21164           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21165           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 388
* EL6311.cbl
 21166           GO TO 5010-READ-NEXT-RECORD.
 21167
 21168     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21169       IF PI-PB-CARRIER    = SPACES AND
 21170          PI-PB-GROUPING   = SPACES AND
 21171          PI-PB-STATE      = SPACES AND
 21172          PI-PB-ACCOUNT    = SPACES
 21173            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21174            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21175            GO TO 7200-DISPLAY-BATCHES
 21176         ELSE
 21177           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21178              PI-PB-GROUPING   = PB-GROUPING AND
 21179              PI-PB-STATE      = PB-STATE    AND
 21180              PI-PB-ACCOUNT    = PB-ACCOUNT
 21181              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21182              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21183              GO TO 7200-DISPLAY-BATCHES.
 21184
 21185     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21186     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21187
 21188
 21189* EXEC CICS HANDLE CONDITION
 21190*         NOTFND    (5050-NOT-FOUND)
 21191*    END-EXEC.
 21192*    MOVE '"$I                   ! T #00017897' TO DFHEIV0
 21193     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21194     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21195     MOVE X'5420233030303137383937' TO DFHEIV0(25:11)
 21196     CALL 'kxdfhei1' USING DFHEIV0
 21197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21198
 21199
 21200
 21201* EXEC CICS READ
 21202*         DATASET   (FILE-ID-ERPNDB)
 21203*         SET       (ADDRESS OF PENDING-BUSINESS)
 21204*         RIDFLD    (ERPNDB-KEY)
 21205*         GTEQ
 21206*    END-EXEC.
 21207*    MOVE '&"S        G          (   #00017901' TO DFHEIV0
 21208     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21209     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21210     MOVE X'2020233030303137393031' TO DFHEIV0(25:11)
 21211     CALL 'kxdfhei1' USING DFHEIV0,
 21212           FILE-ID-ERPNDB,
 21213           DFHEIV20,
 21214           DFHEIV99,
 21215           ERPNDB-KEY,
 21216           DFHEIV99,
 21217           DFHEIV99,
 21218           DFHEIV99
 21219     SET ADDRESS OF PENDING-BUSINESS TO
 21220         DFHEIV20
 21221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21222
 21223
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 389
* EL6311.cbl
 21224     GO TO 5010-READ-NEXT-RECORD.
 21225
 21226 5050-NOT-FOUND.
 21227
 21228******************************************************************
 21229*                                                                *
 21230*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21231*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21232*         PROGRAM.                                               *
 21233*                                                                *
 21234******************************************************************
 21235
 21236     IF EIBTRNID NOT = TRANS-EXB1
 21237        IF PENDING-BUS-RECS-FOUND
 21238            NEXT SENTENCE
 21239          ELSE
 21240            MOVE '9'            TO PI-BROWSE-SW
 21241            GO TO 9400-CLEAR.
 21242
 21243     MOVE ER-2256                TO EMI-ERROR.
 21244     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21245
 21246     IF PI-MAP-NAME = SPACES
 21247        MOVE EL631D              TO PI-MAP-NAME
 21248        MOVE -1                  TO DPFENTRL
 21249        GO TO 8100-SEND-INITIAL-MAP.
 21250
 21251     IF PI-MAP-NAME = EL631B
 21252        MOVE -1                  TO BMAINTL
 21253     ELSE
 21254        IF PI-MAP-NAME = EL631C
 21255           MOVE -1               TO CMAINTL
 21256        ELSE
 21257           MOVE -1               TO DPFENTRL
 21258           GO TO 8200-SEND-DATAONLY.
 21259
 21260     GO TO 8100-SEND-INITIAL-MAP.
 21261
 21262     .
 21263 5100-PROCESS-POL-RESC.
 21264     MOVE ZEROS                  TO CG-LF-BENCD
 21265                                    CG-AH-BENCD
 21266                                    CG-LF-CAN-AMT
 21267                                    CG-AH-CAN-AMT
 21268     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21269                                    CG-AH-CAN-DT
 21270     MOVE SPACES                 TO CG-BATCH-NO
 21271     MOVE '4'                    TO CG-OPTION-CODE
 21272     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21273     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21274     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21275     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21276     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21277     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21278     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21279     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21280     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21281     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 390
* EL6311.cbl
 21282     MOVE PI-PREV-ALT-KEY (1:33)
 21283                                 TO CG-CERT-KEY
 21284     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21285     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21286                                    CG-AH-CAN-AMT
 21287     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21288                                    CG-AH-CAN-DT
 21289     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21290     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21291      display 'about to cancel ' cg-cert-key
 21292
 21293* EXEC CICS LINK
 21294*        PROGRAM  ('ELCANC')
 21295*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21296*    END-EXEC
 21297     MOVE LENGTH OF
 21298      CANCEL-GEN-PASS-AREA
 21299       TO DFHEIV11
 21300     MOVE 'ELCANC' TO DFHEIV1
 21301*    MOVE '."C                   (   #00017976' TO DFHEIV0
 21302     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21303     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21304     MOVE X'2020233030303137393736' TO DFHEIV0(25:11)
 21305     CALL 'kxdfhei1' USING DFHEIV0,
 21306           DFHEIV1,
 21307           CANCEL-GEN-PASS-AREA,
 21308           DFHEIV11,
 21309           DFHEIV99,
 21310           DFHEIV99,
 21311           DFHEIV99,
 21312           DFHEIV99
 21313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21314     IF CG-SUCCESS
 21315        CONTINUE
 21316     ELSE
 21317        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21318        MOVE '3'                 TO EMI-SWITCH1
 21319        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21320        EVALUATE TRUE
 21321           WHEN CG-DATE-ERROR
 21322             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21323           WHEN CG-CERT-NOT-FOUND
 21324             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21325           WHEN CG-AMOUNT-ERROR
 21326             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21327           WHEN CG-OPTION-ERROR
 21328             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21329           WHEN CG-PREV-CAN
 21330             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21331           WHEN CG-INVALID-DATA
 21332             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21333           WHEN CG-NO-ACCT-MSTR
 21334             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21335           WHEN CG-SFX-A-EXIST
 21336             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21337           WHEN CG-MISC-ERROR
 21338             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21339           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 391
* EL6311.cbl
 21340             MOVE ' ERROR - ELCANC - RETURN '
 21341                                 TO EMI-ERROR-TEXT (1) (12:25)
 21342        END-EVALUATE
 21343        GO TO 8200-SEND-DATAONLY
 21344     END-IF
 21345     .
 21346 5100-EXIT.
 21347     EXIT.
 21348
 21349******************************************************************
 21350*                                                                *
 21351*        B R O W S E   B A T C H   B A C K W A R D S             *
 21352*                                                                *
 21353******************************************************************
 21354
 21355 5500-BROWSE-BATCH-BACKWARD.
 21356
 21357* EXEC CICS HANDLE CONDITION
 21358*         NOTFND   (5550-END-RECORDS)
 21359*         ENDFILE  (5550-END-RECORDS)
 21360*    END-EXEC.
 21361*    MOVE '"$I''                  ! U #00018022' TO DFHEIV0
 21362     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21363     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21364     MOVE X'5520233030303138303232' TO DFHEIV0(25:11)
 21365     CALL 'kxdfhei1' USING DFHEIV0
 21366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21367
 21368
 21369 5505-START-BROWSE.
 21370     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21371     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21372     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21373
 21374
 21375* EXEC CICS STARTBR
 21376*         DATASET   (FILE-ID-ERPNDB)
 21377*         RIDFLD    (ERPNDB-ALT-KEY)
 21378*    END-EXEC.
 21379     MOVE 0
 21380       TO DFHEIV11
 21381*    MOVE '&,         G          &   #00018032' TO DFHEIV0
 21382     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21383     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21384     MOVE X'2020233030303138303332' TO DFHEIV0(25:11)
 21385     CALL 'kxdfhei1' USING DFHEIV0,
 21386           FILE-ID-ERPNDB,
 21387           ERPNDB-ALT-KEY,
 21388           DFHEIV99,
 21389           DFHEIV11,
 21390           DFHEIV99
 21391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21392
 21393
 21394     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21395
 21396
 21397* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 392
* EL6311.cbl
 21398*         DATASET    (FILE-ID-ERPNDB)
 21399*         SET        (ADDRESS OF PENDING-BUSINESS)
 21400*         RIDFLD     (ERPNDB-KEY)
 21401*    END-EXEC.
 21402     MOVE 0
 21403       TO DFHEIV11
 21404*    MOVE '&.S                   )   #00018039' TO DFHEIV0
 21405     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21406     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21407     MOVE X'2020233030303138303339' TO DFHEIV0(25:11)
 21408     CALL 'kxdfhei1' USING DFHEIV0,
 21409           FILE-ID-ERPNDB,
 21410           DFHEIV20,
 21411           DFHEIV99,
 21412           ERPNDB-KEY,
 21413           DFHEIV99,
 21414           DFHEIV11,
 21415           DFHEIV99,
 21416           DFHEIV99
 21417     SET ADDRESS OF PENDING-BUSINESS TO
 21418         DFHEIV20
 21419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21420
 21421
 21422
 21423* EXEC CICS READPREV
 21424*         DATASET    (FILE-ID-ERPNDB)
 21425*         SET        (ADDRESS OF PENDING-BUSINESS)
 21426*         RIDFLD     (ERPNDB-KEY)
 21427*    END-EXEC.
 21428     MOVE 0
 21429       TO DFHEIV11
 21430*    MOVE '&0S                   )   #00018045' TO DFHEIV0
 21431     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21432     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21433     MOVE X'2020233030303138303435' TO DFHEIV0(25:11)
 21434     CALL 'kxdfhei1' USING DFHEIV0,
 21435           FILE-ID-ERPNDB,
 21436           DFHEIV20,
 21437           DFHEIV99,
 21438           ERPNDB-KEY,
 21439           DFHEIV99,
 21440           DFHEIV11,
 21441           DFHEIV99,
 21442           DFHEIV99
 21443     SET ADDRESS OF PENDING-BUSINESS TO
 21444         DFHEIV20
 21445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21446
 21447
 21448
 21449* EXEC CICS READPREV
 21450*         DATASET    (FILE-ID-ERPNDB)
 21451*         SET        (ADDRESS OF PENDING-BUSINESS)
 21452*         RIDFLD     (ERPNDB-KEY)
 21453*    END-EXEC.
 21454     MOVE 0
 21455       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 393
* EL6311.cbl
 21456*    MOVE '&0S                   )   #00018051' TO DFHEIV0
 21457     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21458     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21459     MOVE X'2020233030303138303531' TO DFHEIV0(25:11)
 21460     CALL 'kxdfhei1' USING DFHEIV0,
 21461           FILE-ID-ERPNDB,
 21462           DFHEIV20,
 21463           DFHEIV99,
 21464           ERPNDB-KEY,
 21465           DFHEIV99,
 21466           DFHEIV11,
 21467           DFHEIV99,
 21468           DFHEIV99
 21469     SET ADDRESS OF PENDING-BUSINESS TO
 21470         DFHEIV20
 21471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21472
 21473
 21474     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21475        GO TO 5550-END-RECORDS.
 21476
 21477     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21478
 21479     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21480
 21481     IF  WS-BATCH-PREFIX = '#CL'
 21482             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21483
 21484* EXEC CICS ENDBR
 21485*                 DATASET  (FILE-ID-ERPNDB)
 21486*            END-EXEC
 21487     MOVE 0
 21488       TO DFHEIV11
 21489*    MOVE '&2                    $   #00018066' TO DFHEIV0
 21490     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21491     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21492     MOVE X'2020233030303138303636' TO DFHEIV0(25:11)
 21493     CALL 'kxdfhei1' USING DFHEIV0,
 21494           FILE-ID-ERPNDB,
 21495           DFHEIV11,
 21496           DFHEIV99
 21497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21498         GO TO 5505-START-BROWSE.
 21499
 21500     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21501         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21502             NEXT SENTENCE
 21503         ELSE
 21504             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21505
 21506* EXEC CICS ENDBR
 21507*                 DATASET  (FILE-ID-ERPNDB)
 21508*            END-EXEC
 21509     MOVE 0
 21510       TO DFHEIV11
 21511*    MOVE '&2                    $   #00018076' TO DFHEIV0
 21512     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21513     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 394
* EL6311.cbl
 21514     MOVE X'2020233030303138303736' TO DFHEIV0(25:11)
 21515     CALL 'kxdfhei1' USING DFHEIV0,
 21516           FILE-ID-ERPNDB,
 21517           DFHEIV11,
 21518           DFHEIV99
 21519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21520             GO TO 5505-START-BROWSE.
 21521
 21522
 21523     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21524         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21525             NEXT SENTENCE
 21526        ELSE
 21527             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21528
 21529* EXEC CICS ENDBR
 21530*                 DATASET  (FILE-ID-ERPNDB)
 21531*            END-EXEC
 21532     MOVE 0
 21533       TO DFHEIV11
 21534*    MOVE '&2                    $   #00018087' TO DFHEIV0
 21535     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21536     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21537     MOVE X'2020233030303138303837' TO DFHEIV0(25:11)
 21538     CALL 'kxdfhei1' USING DFHEIV0,
 21539           FILE-ID-ERPNDB,
 21540           DFHEIV11,
 21541           DFHEIV99
 21542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21543             GO TO 5505-START-BROWSE.
 21544
 21545     IF NOT PB-BATCH-TRAILER
 21546        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21547
 21548* EXEC CICS ENDBR
 21549*            DATASET  (FILE-ID-ERPNDB)
 21550*       END-EXEC
 21551     MOVE 0
 21552       TO DFHEIV11
 21553*    MOVE '&2                    $   #00018094' TO DFHEIV0
 21554     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21555     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21556     MOVE X'2020233030303138303934' TO DFHEIV0(25:11)
 21557     CALL 'kxdfhei1' USING DFHEIV0,
 21558           FILE-ID-ERPNDB,
 21559           DFHEIV11,
 21560           DFHEIV99
 21561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21562        GO TO 5505-START-BROWSE.
 21563
 21564     IF PI-CSR-BROWSE
 21565        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21566           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21567
 21568* EXEC CICS ENDBR
 21569*               DATASET  (FILE-ID-ERPNDB)
 21570*          END-EXEC
 21571     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 395
* EL6311.cbl
 21572       TO DFHEIV11
 21573*    MOVE '&2                    $   #00018102' TO DFHEIV0
 21574     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21575     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21576     MOVE X'2020233030303138313032' TO DFHEIV0(25:11)
 21577     CALL 'kxdfhei1' USING DFHEIV0,
 21578           FILE-ID-ERPNDB,
 21579           DFHEIV11,
 21580           DFHEIV99
 21581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21582           GO TO 5505-START-BROWSE.
 21583
 21584     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21585        IF PI-PB-CARRIER    = SPACES AND
 21586           PI-PB-GROUPING   = SPACES AND
 21587           PI-PB-STATE      = SPACES AND
 21588           PI-PB-ACCOUNT    = SPACES
 21589             GO TO 7200-DISPLAY-BATCHES
 21590          ELSE
 21591            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21592               PI-PB-GROUPING   = PB-GROUPING AND
 21593               PI-PB-STATE      = PB-STATE    AND
 21594               PI-PB-ACCOUNT    = PB-ACCOUNT
 21595                 GO TO 7200-DISPLAY-BATCHES.
 21596
 21597     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21598
 21599
 21600* EXEC CICS ENDBR
 21601*         DATASET  (FILE-ID-ERPNDB)
 21602*    END-EXEC.
 21603     MOVE 0
 21604       TO DFHEIV11
 21605*    MOVE '&2                    $   #00018122' TO DFHEIV0
 21606     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21607     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21608     MOVE X'2020233030303138313232' TO DFHEIV0(25:11)
 21609     CALL 'kxdfhei1' USING DFHEIV0,
 21610           FILE-ID-ERPNDB,
 21611           DFHEIV11,
 21612           DFHEIV99
 21613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21614
 21615
 21616     GO TO 5505-START-BROWSE.
 21617
 21618 5550-END-RECORDS.
 21619     MOVE ER-2257                TO EMI-ERROR.
 21620     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21621     MOVE -1                     TO DPFENTRL.
 21622
 21623     GO TO 8200-SEND-DATAONLY.
 21624
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 396
* EL6311.cbl
 21626
 21627******************************************************************
 21628*                                                                *
 21629*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21630*                                                                *
 21631******************************************************************
 21632
 21633 6000-CREATE-TEMP-STORAGE.
 21634
 21635
 21636* EXEC CICS HANDLE CONDITION
 21637*        QIDERR  (6050-QID-ERROR)
 21638*    END-EXEC.
 21639*    MOVE '"$N                   ! V #00018145' TO DFHEIV0
 21640     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21641     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21642     MOVE X'5620233030303138313435' TO DFHEIV0(25:11)
 21643     CALL 'kxdfhei1' USING DFHEIV0
 21644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21645
 21646
 21647
 21648* EXEC CICS WRITEQ TS
 21649*        QUEUE    (QID)
 21650*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21651*        LENGTH   (WS-COMM-LENGTH)
 21652*        ITEM     (W-ONE)
 21653*    END-EXEC.
 21654*    MOVE '*" I                  ''   #00018149' TO DFHEIV0
 21655     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 21656     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21657     MOVE X'2020233030303138313439' TO DFHEIV0(25:11)
 21658     CALL 'kxdfhei1' USING DFHEIV0,
 21659           QID,
 21660           PROGRAM-INTERFACE-BLOCK,
 21661           WS-COMM-LENGTH,
 21662           W-ONE,
 21663           DFHEIV99,
 21664           DFHEIV99
 21665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21666
 21667
 21668 6000-EXIT.
 21669      EXIT.
 21670
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 397
* EL6311.cbl
 21672
 21673******************************************************************
 21674*                                                                *
 21675*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21676*                                                                *
 21677******************************************************************
 21678
 21679 6050-RECOVER-TEMP-STORAGE.
 21680     IF PGM-NAME = XCTL-EL6312
 21681        GO TO 6050-EXIT.
 21682
 21683     IF PGM-NAME = XCTL-EL6313
 21684        GO TO 6050-EXIT.
 21685
 21686     IF PGM-NAME = XCTL-EL6315
 21687         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21688     END-IF
 21689
 21690     IF PGM-NAME = XCTL-EL6316
 21691         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21692     END-IF
 21693
 21694
 21695* EXEC CICS HANDLE CONDITION
 21696*        QIDERR  (6050-QID-ERROR)
 21697*    END-EXEC.
 21698*    MOVE '"$N                   ! W #00018182' TO DFHEIV0
 21699     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21700     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21701     MOVE X'5720233030303138313832' TO DFHEIV0(25:11)
 21702     CALL 'kxdfhei1' USING DFHEIV0
 21703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21704
 21705
 21706
 21707* EXEC CICS READQ TS
 21708*         QUEUE   (QID)
 21709*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21710*         LENGTH  (WS-COMM-LENGTH)
 21711*         ITEM    (W-ONE)
 21712*     END-EXEC.
 21713*    MOVE '*$II   L              ''   #00018186' TO DFHEIV0
 21714     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21715     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21716     MOVE X'2020233030303138313836' TO DFHEIV0(25:11)
 21717     CALL 'kxdfhei1' USING DFHEIV0,
 21718           QID,
 21719           PROGRAM-INTERFACE-BLOCK,
 21720           WS-COMM-LENGTH,
 21721           W-ONE,
 21722           DFHEIV99,
 21723           DFHEIV99
 21724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21725
 21726
 21727 6050-DELETE-TEMP-STORAGE.
 21728
 21729
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 398
* EL6311.cbl
 21730* EXEC CICS DELETEQ TS
 21731*        QUEUE   (QID)
 21732*    END-EXEC.
 21733*    MOVE '*&                    #   #00018195' TO DFHEIV0
 21734     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21735     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21736     MOVE X'2020233030303138313935' TO DFHEIV0(25:11)
 21737     CALL 'kxdfhei1' USING DFHEIV0,
 21738           QID,
 21739           DFHEIV99
 21740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21741
 21742
 21743     GO TO 6050-EXIT.
 21744
 21745 6050-QID-ERROR.
 21746     MOVE ER-0033                TO EMI-ERROR
 21747     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21748
 21749 6050-EXIT.
 21750      EXIT.
 21751
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 399
* EL6311.cbl
 21753
 21754******************************************************************
 21755*                                                                *
 21756*            T E R M   C O N V E R S I O N                       *
 21757*                                                                *
 21758******************************************************************
 21759
 21760 6100-TERM-CONVERSION.
 21761
 21762     IF PI-BPMTS = ZERO
 21763         GO TO 6199-EXIT.
 21764
 21765     IF PI-BMODE = ' ' OR 'M'
 21766         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21767         GO TO 6105-ROUND-TERM.
 21768
 21769     IF PI-BMODE = 'S'
 21770         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21771         GO TO 6105-ROUND-TERM.
 21772
 21773     IF PI-BMODE = 'W'
 21774         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21775         GO TO 6105-ROUND-TERM.
 21776
 21777     IF PI-BMODE = 'B'
 21778         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21779         GO TO 6105-ROUND-TERM.
 21780
 21781     IF PI-BMODE = 'T'
 21782         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21783
 21784 6105-ROUND-TERM.
 21785
 21786     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21787         ADD +1                  TO WS-CALC-TERM-WHOLE
 21788         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21789
 21790     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21791         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21792
 21793     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21794         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21795                                      WS-BTERM    (WS-SUB1)
 21796         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21797
 21798     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21799         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21800             MOVE -1               TO BMODEL
 21801             MOVE ER-2593          TO EMI-ERROR
 21802             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21803             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21804
 21805 6124-CHECK-BENEFIT.
 21806
 21807     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21808        GO TO 6126-COMPUTE-BENEFIT.
 21809
 21810     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 400
* EL6311.cbl
 21811
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 401
* EL6311.cbl
 21813******************************************************************
 21814**         COMPUTE TERM AND BENEFIT
 21815******************************************************************
 21816 6125-COMPUTE-TERM-BENEFIT.
 21817
 21818     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21819        PI-BPMTAMT = ZERO
 21820         GO TO 6199-EXIT.
 21821
 21822     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21823                                     WS-BTERM  (WS-SUB1).
 21824     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21825
 21826 6126-COMPUTE-BENEFIT.
 21827
 21828     IF PI-BMODE = 'M' OR  ' '
 21829         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21830
 21831     IF PI-BMODE = 'W'
 21832         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21833
 21834     IF PI-BMODE = 'S'
 21835         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21836
 21837     IF PI-BMODE = 'B'
 21838         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21839
 21840     IF PI-BMODE = 'T'
 21841         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21842
 21843     IF WS-SUB1 = +1
 21844        COMPUTE WS-BBEN (WS-SUB1) =
 21845                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21846
 21847     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21848     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21849     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21850
 21851 6199-EXIT.
 21852     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 402
* EL6311.cbl
 21854
 21855******************************************************************
 21856*                                                                *
 21857*             D I S P L A Y   I S S U E S                        *
 21858*                                                                *
 21859******************************************************************
 21860
 21861 6200-CREATE-VADS.
 21862     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21863     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21864     MOVE SPACES                 TO WS-PASS-VADS-REC
 21865
 21866* EXEC CICS GETMAIN
 21867*       SET      (ADDRESS OF PENDING-BUSINESS)
 21868*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21869*       INITIMG  (GETMAIN-SPACE)
 21870*       RESP     (WS-RESPONSE)
 21871*    END-EXEC
 21872*    MOVE ',"IL                  $  N#00018321' TO DFHEIV0
 21873     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21874     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21875     MOVE X'204E233030303138333231' TO DFHEIV0(25:11)
 21876     CALL 'kxdfhei1' USING DFHEIV0,
 21877           DFHEIV20,
 21878           ERPNDB-RECORD-LENGTH,
 21879           GETMAIN-SPACE
 21880     SET ADDRESS OF PENDING-BUSINESS TO
 21881         DFHEIV20
 21882     MOVE EIBRESP  TO WS-RESPONSE
 21883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21884
 21885* EXEC CICS READ
 21886*       INTO    (PENDING-BUSINESS)
 21887*       DATASET (FILE-ID-ERPNDB)
 21888*       RIDFLD  (ERPNDB-KEY)
 21889*       RESP    (WS-RESPONSE)
 21890*    END-EXEC
 21891     MOVE LENGTH OF
 21892      PENDING-BUSINESS
 21893       TO DFHEIV11
 21894*    MOVE '&"IL       E          (  N#00018327' TO DFHEIV0
 21895     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21896     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21897     MOVE X'204E233030303138333237' TO DFHEIV0(25:11)
 21898     CALL 'kxdfhei1' USING DFHEIV0,
 21899           FILE-ID-ERPNDB,
 21900           PENDING-BUSINESS,
 21901           DFHEIV11,
 21902           ERPNDB-KEY,
 21903           DFHEIV99,
 21904           DFHEIV99,
 21905           DFHEIV99
 21906     MOVE EIBRESP  TO WS-RESPONSE
 21907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21908     IF RESP-NORMAL
 21909        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21910        IF (RESP-NORMAL)
 21911           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 403
* EL6311.cbl
 21912              AM-CONTROL-PRIMARY (1:20))
 21913           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21914        ELSE
 21915           MOVE 'ACCOUNT NOT FOUND'
 21916                                 TO VD-ACCOUNT-NAME
 21917        END-IF
 21918        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21919                                    TO M1
 21920        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21921        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21922           (A2 > M1)
 21923           OR (WS-WORK-FIELD (A2:1) = '*')
 21924           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21925           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21926        END-PERFORM
 21927        IF A2 > M1
 21928           CONTINUE
 21929        ELSE
 21930           MOVE WS-WORK-FIELD (1:A2 - 1)
 21931                                    TO VD-ACCOUNT-NAME
 21932        END-IF
 21933        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21934        MOVE PB-CARRIER          TO VD-CARRIER
 21935        MOVE PB-GROUPING         TO VD-GROUPING
 21936        MOVE PB-STATE            TO VD-STATE
 21937        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21938        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21939        MOVE PB-CERT-NO          TO VD-CERT-NO
 21940        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21941        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21942        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21943        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21944        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21945        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21946        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21947        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21948        MOVE PB-CSR-ID           TO VD-CSR-ID
 21949        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21950        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21951        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21952        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21953        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21954        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21955        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21956        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21957        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21958        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21959        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21960        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21961        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21962     END-IF
 21963     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21964
 21965
 21966* EXEC CICS GETMAIN
 21967*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21968*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21969*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 404
* EL6311.cbl
 21970*       RESP     (WS-RESPONSE)
 21971*    END-EXEC
 21972*    MOVE ',"IL                  $  N#00018390' TO DFHEIV0
 21973     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21974     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21975     MOVE X'204E233030303138333930' TO DFHEIV0(25:11)
 21976     CALL 'kxdfhei1' USING DFHEIV0,
 21977           DFHEIV20,
 21978           ERPNDM-RECORD-LENGTH,
 21979           GETMAIN-SPACE
 21980     SET ADDRESS OF PENDING-MAILING-DATA TO
 21981         DFHEIV20
 21982     MOVE EIBRESP  TO WS-RESPONSE
 21983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21984
 21985
 21986* EXEC CICS READ
 21987*       INTO    (PENDING-MAILING-DATA)
 21988*       DATASET (FILE-ID-ERPNDM)
 21989*       RIDFLD  (ERPNDM-KEY)
 21990*       RESP    (WS-RESPONSE)
 21991*    END-EXEC
 21992     MOVE LENGTH OF
 21993      PENDING-MAILING-DATA
 21994       TO DFHEIV11
 21995*    MOVE '&"IL       E          (  N#00018397' TO DFHEIV0
 21996     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21997     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21998     MOVE X'204E233030303138333937' TO DFHEIV0(25:11)
 21999     CALL 'kxdfhei1' USING DFHEIV0,
 22000           FILE-ID-ERPNDM,
 22001           PENDING-MAILING-DATA,
 22002           DFHEIV11,
 22003           ERPNDM-KEY,
 22004           DFHEIV99,
 22005           DFHEIV99,
 22006           DFHEIV99
 22007     MOVE EIBRESP  TO WS-RESPONSE
 22008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22009
 22010     IF RESP-NORMAL
 22011        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 22012        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 22013        MOVE PM-CITY              TO VD-INSURED-CITY
 22014        MOVE PM-STATE             TO VD-INSURED-STATE
 22015        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 22016     END-IF
 22017
 22018     MOVE 'VAC1'                  TO VD-LETTER-ID
 22019     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 22020     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 22021     MOVE EIBTIME                 TO VD-CURRENT-TIME
 22022     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 22023     MOVE +0                      TO VD-ARCHIVE-NO
 22024     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 22025     .
 22026 6200-EXIT.
 22027     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 405
* EL6311.cbl
 22028 6210-READ-ERACCT.
 22029     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 22030     MOVE LOW-VALUES             TO ERACCT-FILL
 22031
 22032* EXEC CICS READ
 22033*         DATASET   ('ERACCT')
 22034*         INTO      (ACCOUNT-MASTER)
 22035*         RIDFLD    (ERACCT-KEY)
 22036*         GTEQ
 22037*         RESP      (WS-RESPONSE)
 22038*    END-EXEC
 22039     MOVE LENGTH OF
 22040      ACCOUNT-MASTER
 22041       TO DFHEIV11
 22042     MOVE 'ERACCT' TO DFHEIV1
 22043*    MOVE '&"IL       G          (  N#00018425' TO DFHEIV0
 22044     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22045     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22046     MOVE X'204E233030303138343235' TO DFHEIV0(25:11)
 22047     CALL 'kxdfhei1' USING DFHEIV0,
 22048           DFHEIV1,
 22049           ACCOUNT-MASTER,
 22050           DFHEIV11,
 22051           ERACCT-KEY,
 22052           DFHEIV99,
 22053           DFHEIV99,
 22054           DFHEIV99
 22055     MOVE EIBRESP  TO WS-RESPONSE
 22056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22057     .
 22058 6210-EXIT.
 22059     EXIT.
 22060
 22061 6220-READ-ERMAIL.
 22062
 22063     MOVE ELCERT-KEY             TO ERMAIL-KEY
 22064     MOVE ' '                    TO WS-ERMAIL-SW
 22065
 22066
 22067* EXEC CICS READ
 22068*       DATASET   (FILE-ID-ERMAIL)
 22069*       SET       (ADDRESS OF MAILING-DATA)
 22070*       RIDFLD    (ERMAIL-KEY)
 22071*       RESP      (WS-RESPONSE)
 22072*    END-EXEC
 22073*    MOVE '&"S        E          (  N#00018441' TO DFHEIV0
 22074     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22075     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22076     MOVE X'204E233030303138343431' TO DFHEIV0(25:11)
 22077     CALL 'kxdfhei1' USING DFHEIV0,
 22078           FILE-ID-ERMAIL,
 22079           DFHEIV20,
 22080           DFHEIV99,
 22081           ERMAIL-KEY,
 22082           DFHEIV99,
 22083           DFHEIV99,
 22084           DFHEIV99
 22085     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 406
* EL6311.cbl
 22086         DFHEIV20
 22087     MOVE EIBRESP  TO WS-RESPONSE
 22088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22089
 22090     IF RESP-NORMAL
 22091        SET ERMAIL-FOUND TO TRUE
 22092     END-IF
 22093     .
 22094 6220-EXIT.
 22095     EXIT.
 22096
 22097 6400-CHECK-FOR-RES-REF-CLAIM.
 22098     display 'made it to 6400- for ' pi-cert-no
 22099     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22100
 22101     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22102                                    W-CL-COMP-CD.
 22103     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22104                                    W-CL-CERT-NO.
 22105     MOVE SPACES                 TO MSTR-CERT-SFX.
 22106
 22107
 22108* EXEC CICS HANDLE CONDITION
 22109*        NOTFND  (6400-CONTINUE)
 22110*        ENDFILE (6400-CONTINUE)
 22111*    END-EXEC.
 22112*    MOVE '"$I''                  ! X #00018465' TO DFHEIV0
 22113     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22114     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22115     MOVE X'5820233030303138343635' TO DFHEIV0(25:11)
 22116     CALL 'kxdfhei1' USING DFHEIV0
 22117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22118
 22119
 22120
 22121* EXEC CICS IGNORE CONDITION
 22122*        DUPKEY
 22123*    END-EXEC.
 22124*    MOVE '"*$                   !   #00018470' TO DFHEIV0
 22125     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22126     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22127     MOVE X'2020233030303138343730' TO DFHEIV0(25:11)
 22128     CALL 'kxdfhei1' USING DFHEIV0
 22129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22130
 22131
 22132
 22133* EXEC CICS STARTBR
 22134*        DATASET   (CLMS-ID)
 22135*        RIDFLD    (ELMSTR-KEY)
 22136*        GENERIC   EQUAL
 22137*        KEYLENGTH (ELMSTR-LENGTH)
 22138*    END-EXEC.
 22139     MOVE 0
 22140       TO DFHEIV11
 22141*    MOVE '&,   KG    E          &   #00018474' TO DFHEIV0
 22142     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22143     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 407
* EL6311.cbl
 22144     MOVE X'2020233030303138343734' TO DFHEIV0(25:11)
 22145     CALL 'kxdfhei1' USING DFHEIV0,
 22146           CLMS-ID,
 22147           ELMSTR-KEY,
 22148           ELMSTR-LENGTH,
 22149           DFHEIV11,
 22150           DFHEIV99
 22151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22152
 22153
 22154     display 'browse started'
 22155     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22156
 22157 6400-NEXT-CLAIM.
 22158
 22159
 22160* EXEC CICS READNEXT
 22161*        DATASET   (CLMS-ID)
 22162*        RIDFLD    (ELMSTR-KEY)
 22163*        SET       (ADDRESS OF CLAIM-MASTER)
 22164*    END-EXEC.
 22165     MOVE 0
 22166       TO DFHEIV11
 22167*    MOVE '&.S                   )   #00018486' TO DFHEIV0
 22168     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22169     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22170     MOVE X'2020233030303138343836' TO DFHEIV0(25:11)
 22171     CALL 'kxdfhei1' USING DFHEIV0,
 22172           CLMS-ID,
 22173           DFHEIV20,
 22174           DFHEIV99,
 22175           ELMSTR-KEY,
 22176           DFHEIV99,
 22177           DFHEIV11,
 22178           DFHEIV99,
 22179           DFHEIV99
 22180     SET ADDRESS OF CLAIM-MASTER TO
 22181         DFHEIV20
 22182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22183
 22184
 22185     display 'read claim for ' mstr-cert-no
 22186     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22187        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22188         GO TO 6400-CONTINUE
 22189     END-IF.
 22190
 22191     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22192        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22193        PI-STATE       NOT = CL-CERT-STATE     OR
 22194        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22195        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22196         GO TO 6400-NEXT-CLAIM
 22197     END-IF.
 22198
 22199     display 'found claim ' cl-claim-no
 22200        ' with denial type ' cl-denial-type
 22201     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 408
* EL6311.cbl
 22202         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22203         GO TO 6400-CONTINUE
 22204     END-IF.
 22205
 22206     GO TO 6400-NEXT-CLAIM.
 22207
 22208 6400-CONTINUE.
 22209
 22210     IF WS-BROWSE-STARTED-SW = 'Y'
 22211
 22212* EXEC CICS ENDBR
 22213*            DATASET   (CLMS-ID)
 22214*        END-EXEC
 22215     MOVE 0
 22216       TO DFHEIV11
 22217*    MOVE '&2                    $   #00018518' TO DFHEIV0
 22218     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22219     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22220     MOVE X'2020233030303138353138' TO DFHEIV0(25:11)
 22221     CALL 'kxdfhei1' USING DFHEIV0,
 22222           CLMS-ID,
 22223           DFHEIV11,
 22224           DFHEIV99
 22225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22226         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22227     END-IF.
 22228
 22229 6400-EXIT.
 22230     EXIT.
 22231
 22232 7000-DISPLAY-ISSUES.
 22233
 22234     IF PI-DISPLAY-ORIGINAL-BATCH
 22235        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22236        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22237     ELSE
 22238        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22239
 22240     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22241
 22242     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22243     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22244
 22245     MOVE LOW-VALUES                 TO EL631BI.
 22246     MOVE ZEROS                      TO PI-BPMTAMT
 22247                                        PI-BPMTS.
 22248     MOVE SPACE                      TO PI-BMODE
 22249                                        PI-BTYPE (1)
 22250                                        PI-BTYPE (2).
 22251     MOVE EL631B                     TO PI-MAP-NAME.
 22252     MOVE 'Y'                        TO PI-BROWSE-SW.
 22253     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22254                                        PI-HIGH-SEQ-NO.
 22255
 22256     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22257        MOVE AL-SABOF                TO BCHGTA
 22258        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22259        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 409
* EL6311.cbl
 22260     ELSE
 22261        MOVE AL-SADOF                TO BCHGTA
 22262                                        BCHGA
 22263        MOVE PB-CHG-COUNT            TO BCHGO.
 22264
 22265     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22266     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22267     MOVE WS-HR-MINS                 TO BMANTATO.
 22268
 22269     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22270        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22271        MOVE SPACE                   TO DC-OPTION-CODE
 22272        PERFORM 9700-DATE-LINK
 22273        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22274        MOVE 'INACTIVE'              TO BMOENDTO
 22275     ELSE
 22276        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22277        MOVE SPACE                   TO DC-OPTION-CODE
 22278        PERFORM 9700-DATE-LINK
 22279        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22280        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22281        MOVE SPACE                   TO DC-OPTION-CODE
 22282        PERFORM 9700-DATE-LINK
 22283        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22284
 22285*    MOVE PB-I-REFERENCE             TO BREFO.
 22286
 22287*    IF PI-COMPANY-ID EQUAL 'HER'
 22288*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22289*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22290*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22291*                MOVE WS-MEMBER-NO-1-8
 22292*                                TO  BMICRNOO.
 22293
 22294*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22295*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22296*            MOVE PB-I-MICROFILM-NO
 22297*                                TO  BMICRNOO.
 22298     IF PB-I-VIN NOT = SPACES
 22299        MOVE PB-I-VIN            TO BVINO
 22300     END-IF
 22301
 22302     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22303     MOVE PB-CERT-SFX                TO BSUFIXO.
 22304     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22305     MOVE SPACE                      TO DC-OPTION-CODE.
 22306     PERFORM 9700-DATE-LINK.
 22307     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22308
 22309     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22310     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22311     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22312     MOVE PB-I-INSURED-SEX           TO BSEXO
 22313
 22314     IF PB-I-AGE NOT = ZEROS
 22315         MOVE PB-I-AGE               TO BAGEO.
 22316
 22317     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 410
* EL6311.cbl
 22318                                 TO ELCERT-KEY
 22319     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22320     IF NOT CERT-TRL-REC-NOT-FOUND
 22321         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22322             MOVE 'AGE*'             TO BAGEDEFO
 22323         ELSE
 22324             MOVE 'AGE '             TO BAGEDEFO
 22325         END-IF
 22326     ELSE
 22327         MOVE 'AGE '             TO BAGEDEFO
 22328     END-IF
 22329
 22330     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22331         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22332         MOVE SPACE                  TO DC-OPTION-CODE
 22333         PERFORM 9700-DATE-LINK
 22334         IF NO-CONVERSION-ERROR
 22335            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22336
 22337     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22338         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22339         MOVE SPACE                  TO DC-OPTION-CODE
 22340         PERFORM 9700-DATE-LINK
 22341         IF NO-CONVERSION-ERROR
 22342            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22343
 22344     IF PB-I-EXTENTION-DAYS NUMERIC
 22345        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22346           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22347        ELSE
 22348           IF PB-I-TERM-IN-DAYS NUMERIC
 22349              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22350                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22351
 22352     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22353        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22354
 22355     MOVE PB-FORCE-CODE              TO BFORCEO.
 22356     MOVE PB-I-TERM-TYPE             TO BMODEO
 22357                                        PI-BMODE.
 22358
 22359     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22360        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22361
 22362     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22363         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22364                                        PI-BPMTS.
 22365
 22366     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22367         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22368           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22369                                        PI-BPMTAMT.
 22370
 22371     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22372     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22373     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22374     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22375     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 411
* EL6311.cbl
 22376     MOVE PB-I-SIG-SW                TO BSIGO.
 22377     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22378     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22379     MOVE PB-RECORD-BILL             TO BBILCDO.
 22380     MOVE PB-FORCE-CODE              TO BFORCEO.
 22381
 22382     IF (PB-I-LIVES NUMERIC)
 22383        AND (PB-I-LIVES > ZEROS)
 22384        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22385        IF (RESP-NORMAL)
 22386           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22387           CONTINUE
 22388        ELSE
 22389           MOVE PB-I-LIVES       TO BLIVESO
 22390        END-IF
 22391     END-IF
 22392
 22393     IF PB-I-NUM-BILLED NUMERIC AND
 22394        PB-I-NUM-BILLED GREATER THAN ZEROS
 22395        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22396*    ELSE
 22397*       MOVE ZEROS                   TO BBILLEDO.
 22398
 22399     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22400
 22401     IF PB-I-LOAN-APR NOT = +99.9999
 22402        MOVE PB-I-LOAN-APR           TO BAPRO.
 22403
 22404     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22405        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22406
 22407     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22408        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22409           MOVE AL-SANOF                TO BORIGHDA
 22410           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22411           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22412
 22413     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22414
 22415     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22416        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22417
 22418     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22419        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22420                                        PI-BTYPE (1).
 22421
 22422     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22423        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22424
 22425     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22426        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22427
 22428     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22429        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22430
 22431     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22432        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22433
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 412
* EL6311.cbl
 22434     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22435        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22436
 22437     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22438         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22439         MOVE SPACE                  TO DC-OPTION-CODE
 22440         PERFORM 9700-DATE-LINK
 22441         IF NO-CONVERSION-ERROR
 22442            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22443
 22444     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22445        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22446        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22447        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22448        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22449                 GIVING BDIFFO (1)
 22450     ELSE
 22451        MOVE SPACES                  TO BBEN-CD     (1)
 22452                                        BBEN-ABBR   (1).
 22453
 22454     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22455        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22456        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22457                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22458
 22459     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22460       IF PB-RECORD-ON-HOLD
 22461          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22462
 22463     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22464       IF PB-RECORD-RETURNED
 22465          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22466
 22467     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22468        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22469             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22470
 22471     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22472
 22473     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22474        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22475
 22476     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22477        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22478                                        PI-BTYPE (2).
 22479
 22480     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22481        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22482
 22483     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22484        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22485
 22486     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22487        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22488
 22489     IF PB-I-TOT-FEES NOT NUMERIC
 22490        MOVE ZEROS               TO PB-I-TOT-FEES
 22491     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 413
* EL6311.cbl
 22492     IF PB-I-TOT-FEES > ZEROS
 22493        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22494
 22495     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22496         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22497         MOVE SPACE                  TO DC-OPTION-CODE
 22498         PERFORM 9700-DATE-LINK
 22499         IF NO-CONVERSION-ERROR
 22500            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22501
 22502     IF PB-I-TOT-FEES > ZEROS
 22503        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22504        SUBTRACT PB-I-TOT-FEES FROM
 22505                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22506
 22507     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22508        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22509        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22510        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22511        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22512                 GIVING BDIFFO (2)
 22513     ELSE
 22514        MOVE SPACES                  TO BBEN-CD     (2)
 22515                                        BBEN-ABBR   (2).
 22516
 22517     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22518       IF PB-RECORD-ON-HOLD
 22519          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22520
 22521     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22522       IF PB-RECORD-RETURNED
 22523          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22524
 22525     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22526        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22527             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22528
 22529     MOVE PB-CSR-ID                  TO BCSRO.
 22530
 22531     IF PI-COMPANY-ID  =  'DMD'
 22532        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22533            NEXT SENTENCE
 22534        ELSE
 22535            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22536               MOVE 'NEW CERT'       TO BNCERTLI
 22537               MOVE EC-NEW-CERT      TO BNCERTO.
 22538
 22539     IF PI-COMPANY-ID  =  'DMD'
 22540        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22541            NEXT SENTENCE
 22542        ELSE
 22543           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22544               MOVE 'NEW STATE'      TO BNSTATLI
 22545               MOVE EC-NEW-STATE     TO BNSTATO.
 22546
 22547 7000-CONTINUE.
 22548     MOVE 'C'                        TO BMAINTI.
 22549     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 414
* EL6311.cbl
 22550
 22551     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22552        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22553
 22554     IF PI-6315-FINALIZED = 'Y'   AND
 22555        PB-UNFORCED-ERRORS
 22556          MOVE -1                TO BFORCEL
 22557          MOVE  1                TO SET-CURSOR-SW
 22558     END-IF
 22559
 22560     IF NO-CURSOR-SET
 22561        MOVE -1                      TO BMAINTL.
 22562
 22563     GO TO 8100-SEND-INITIAL-MAP.
 22564
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 415
* EL6311.cbl
 22566
 22567******************************************************************
 22568*                                                                *
 22569*             D I S P L A Y   C A N C E L S                      *
 22570*                                                                *
 22571******************************************************************
 22572
 22573 7100-DISPLAY-CANCELS.
 22574     IF PI-DISPLAY-ORIGINAL-BATCH
 22575        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22576        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22577     ELSE
 22578        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22579
 22580     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22581
 22582     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22583     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22584
 22585     MOVE LOW-VALUES                 TO EL631CI.
 22586     MOVE EL631C                     TO PI-MAP-NAME.
 22587     MOVE 'Y'                        TO PI-BROWSE-SW.
 22588     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22589                                        PI-HIGH-SEQ-NO.
 22590
 22591     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22592        MOVE AL-SABOF                TO CCHGTA
 22593        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22594        MOVE AL-SANON                TO CCHGA
 22595      ELSE
 22596        MOVE AL-SADOF                TO CCHGTA
 22597                                        CCHGA
 22598        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22599
 22600*    MOVE PB-C-REFERENCE             TO CREFO.
 22601
 22602*    IF PB-C-MICROFILM-NO IS NUMERIC
 22603*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22604*          MOVE PB-C-MICROFILM-NO
 22605*                                TO CMICRNOO
 22606*          MOVE AL-UNNON         TO CMICRNOA
 22607*       END-IF
 22608*    END-IF
 22609     IF PB-C-NH-INT-ON-REFS NUMERIC
 22610        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 22611           MOVE PB-C-NH-INT-ON-REFS
 22612                                 TO CNHINTO
 22613           MOVE AL-SANOF         TO CNHINTA
 22614        END-IF
 22615     END-IF
 22616     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22617     MOVE PB-CERT-SFX                TO CSUFIXO.
 22618     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22619     MOVE SPACE                      TO DC-OPTION-CODE.
 22620     PERFORM 9700-DATE-LINK.
 22621     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22622
 22623     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 416
* EL6311.cbl
 22624        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22625        MOVE SPACE                   TO DC-OPTION-CODE
 22626        PERFORM 9700-DATE-LINK
 22627        IF NO-CONVERSION-ERROR
 22628           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22629
 22630     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22631        NEXT SENTENCE
 22632     ELSE
 22633        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22634
 22635     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22636        NEXT SENTENCE
 22637     ELSE
 22638        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22639
 22640     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22641        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22642        MOVE SPACE                   TO DC-OPTION-CODE
 22643        PERFORM 9700-DATE-LINK
 22644        IF NO-CONVERSION-ERROR
 22645           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22646
 22647     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22648         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22649
 22650     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22651         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22652
 22653     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22654        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22655        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22656                 GIVING CDRFND1O.
 22657
 22658     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22659        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22660        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22661                 GIVING CDRFND2O.
 22662
 22663     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22664       IF PB-RECORD-ON-HOLD
 22665          MOVE 'ON HOLD'             TO CBILIT1O.
 22666
 22667     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22668       IF PB-RECORD-RETURNED
 22669          MOVE 'RETURNED'            TO CBILIT1O.
 22670
 22671     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22672        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22673             MOVE 'OVERRIDE'         TO CBILIT1O.
 22674
 22675     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22676       IF PB-RECORD-ON-HOLD
 22677          MOVE 'ON HOLD'             TO CBILIT2O.
 22678
 22679     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22680       IF PB-RECORD-RETURNED
 22681          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 417
* EL6311.cbl
 22682
 22683     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22684        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22685             MOVE 'OVERRIDE'         TO CBILIT2O.
 22686
 22687     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22688     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22689     IF PB-C-POST-CARD-IND = 'Y'
 22690        MOVE 'Y'                     TO CPCYNO
 22691     ELSE
 22692        MOVE 'N'                     TO CPCYNO
 22693     END-IF
 22694     MOVE PB-FORCE-CODE              TO CFORCEO.
 22695     MOVE PB-RECORD-BILL             TO CBILCDO.
 22696     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22697     MOVE SPACES                     TO CINITSO.
 22698     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22699         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22700     ELSE
 22701         MOVE PB-CI-INITIALS         TO CINITSO
 22702     END-IF.
 22703
 22704     IF PB-CI-CANCEL-FEE NUMERIC
 22705        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22706        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22707     ELSE
 22708        MOVE ZEROES                  TO W-CANCEL-FEE.
 22709
 22710     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22711
 22712     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22713        ADD PB-CI-LF-PREMIUM-AMT
 22714             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22715
 22716     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22717        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22718
 22719     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22720     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22721     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22722     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22723
 22724     IF PB-C-LIVES NUMERIC
 22725        MOVE PB-C-LIVES              TO CLIVESO.
 22726
 22727     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22728        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22729
 22730     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22731        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22732        MOVE SPACE                   TO DC-OPTION-CODE
 22733        PERFORM 9700-DATE-LINK
 22734        IF NO-CONVERSION-ERROR
 22735           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22736
 22737     IF  PB-C-REFUND-CREATED
 22738         MOVE 'YES'                  TO CRFNDSWO
 22739     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 418
* EL6311.cbl
 22740         IF PB-C-REFUND-REQUESTED
 22741            MOVE 'REQ'               TO CRFNDSWO
 22742         ELSE
 22743            MOVE 'NO'                TO CRFNDSWO.
 22744
 22745     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22746     MOVE SPACE                      TO DC-OPTION-CODE.
 22747     PERFORM 9700-DATE-LINK.
 22748     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22749     MOVE PB-INPUT-BY                TO CENTBYO.
 22750
 22751     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22752        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22753        MOVE SPACE                   TO DC-OPTION-CODE
 22754        PERFORM 9700-DATE-LINK
 22755        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22756        MOVE 'INACTIVE'              TO CMOENDTO
 22757     ELSE
 22758        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22759        MOVE SPACE                   TO DC-OPTION-CODE
 22760        PERFORM 9700-DATE-LINK
 22761        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22762        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22763        MOVE SPACE                   TO DC-OPTION-CODE
 22764        PERFORM 9700-DATE-LINK
 22765        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22766
 22767     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22768
 22769     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22770     MOVE WS-HR-MINS                 TO CMANTATO.
 22771
 22772     EVALUATE PB-LF-REFUND-TYPE
 22773        WHEN '1'
 22774           MOVE 'RULE78'            TO CLFREFNO
 22775        WHEN '2'
 22776           MOVE 'PRORAT'            TO CLFREFNO
 22777        WHEN '3'
 22778           MOVE 'CALIF'             TO CLFREFNO
 22779        WHEN '4'
 22780           MOVE 'IRREG'             TO CLFREFNO
 22781        WHEN '5'
 22782           MOVE 'NETPAY'            TO CLFREFNO
 22783        WHEN '6'
 22784           MOVE 'ATCP'              TO CLFREFNO
 22785        WHEN '7'
 22786           MOVE 'UTAH'              TO CLFREFNO
 22787        WHEN '8'
 22788           MOVE 'MEAN'              TO CLFREFNO
 22789        WHEN '9'
 22790           MOVE 'SUM '              TO CLFREFNO
 22791        WHEN 'B'
 22792           MOVE 'BALN'              TO CLFREFNO
 22793     END-EVALUATE.
 22794
 22795     EVALUATE TRUE
 22796        WHEN PB-AH-REFUND-TYPE =  '1'
 22797           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 419
* EL6311.cbl
 22798        WHEN PB-AH-REFUND-TYPE =  '2'
 22799           MOVE 'PRORAT'            TO CAHREFNO
 22800        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22801           MOVE 'CALIF'             TO CAHREFNO
 22802        WHEN PB-AH-REFUND-TYPE =  '4'
 22803           MOVE 'IRREG'             TO CAHREFNO
 22804        WHEN PB-AH-REFUND-TYPE =  '5'
 22805           MOVE 'NETPAY'            TO CAHREFNO
 22806        WHEN PB-AH-REFUND-TYPE =  '6'
 22807           MOVE 'ATCP'              TO CAHREFNO
 22808        WHEN PB-AH-REFUND-TYPE =  '7'
 22809           MOVE 'UTAH'              TO CAHREFNO
 22810        WHEN PB-AH-REFUND-TYPE =  '8'
 22811           MOVE 'MEAN'              TO CAHREFNO
 22812        WHEN PB-AH-REFUND-TYPE =  '9'
 22813           MOVE 'SUM '              TO CAHREFNO
 22814        WHEN PB-AH-REFUND-TYPE =  'B'
 22815           MOVE 'BALN'              TO CAHREFNO
 22816     END-EVALUATE.
 22817
 22818     MOVE PB-REIN-CD                 TO CREINCDO.
 22819
 22820     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22821        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22822        MOVE SPACE                   TO DC-OPTION-CODE
 22823        PERFORM 9700-DATE-LINK
 22824        IF NO-CONVERSION-ERROR
 22825           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22826
 22827     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22828        MOVE 999999                  TO WS-EXP-DT-EDIT
 22829        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22830        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22831     ELSE
 22832        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22833           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22834           MOVE SPACE                   TO DC-OPTION-CODE
 22835           PERFORM 9700-DATE-LINK
 22836           IF NO-CONVERSION-ERROR
 22837              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22838
 22839     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22840        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22841           MOVE AL-SANOF                TO CORIGHDA
 22842           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22843           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22844
 22845     MOVE PB-CSR-ID              TO CCSRO.
 22846
 22847     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22848     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22849
 22850     MOVE 'C'                    TO CMAINTI.
 22851     MOVE AL-UANON               TO CMAINTA.
 22852
 22853     IF PI-6316-FINALIZED = 'Y'  AND
 22854        PB-UNFORCED-ERRORS
 22855          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 420
* EL6311.cbl
 22856          MOVE  1                TO SET-CURSOR-SW
 22857     END-IF
 22858
 22859     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22860        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22861
 22862     IF NO-CURSOR-SET
 22863        MOVE -1                  TO CMAINTL.
 22864
 22865     GO TO 8100-SEND-INITIAL-MAP.
 22866
 22867
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 421
* EL6311.cbl
 22869***************************************************************
 22870*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22871*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22872***************************************************************
 22873
 22874 7200-DISPLAY-BATCHES.
 22875     MOVE EL631D                 TO PI-MAP-NAME.
 22876     MOVE LOW-VALUES             TO EL631DI.
 22877
 22878     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22879
 22880
 22881* EXEC CICS HANDLE CONDITION
 22882*         NOTFND   (3690-NOT-FOUND)
 22883*    END-EXEC.
 22884*    MOVE '"$I                   ! Y #00019175' TO DFHEIV0
 22885     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22886     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22887     MOVE X'5920233030303139313735' TO DFHEIV0(25:11)
 22888     CALL 'kxdfhei1' USING DFHEIV0
 22889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22890
 22891
 22892     IF PI-DISPLAY-SCREEN
 22893        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22894     ELSE
 22895        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22896
 22897     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22898     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22899
 22900
 22901* EXEC CICS READ
 22902*         DATASET   (FILE-ID-ERPNDB)
 22903*         RIDFLD    (ERPNDB-KEY)
 22904*         SET       (ADDRESS OF PENDING-BUSINESS)
 22905*    END-EXEC.
 22906*    MOVE '&"S        E          (   #00019187' TO DFHEIV0
 22907     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22908     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22909     MOVE X'2020233030303139313837' TO DFHEIV0(25:11)
 22910     CALL 'kxdfhei1' USING DFHEIV0,
 22911           FILE-ID-ERPNDB,
 22912           DFHEIV20,
 22913           DFHEIV99,
 22914           ERPNDB-KEY,
 22915           DFHEIV99,
 22916           DFHEIV99,
 22917           DFHEIV99
 22918     SET ADDRESS OF PENDING-BUSINESS TO
 22919         DFHEIV20
 22920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22921
 22922
 22923     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22924     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22925     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22926     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 422
* EL6311.cbl
 22927     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22928
 22929     MOVE EL631D                 TO PI-MAP-NAME.
 22930     MOVE LOW-VALUES             TO EL631DI.
 22931     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22932
 22933*    IF PI-AR-PROCESSING
 22934*       MOVE PB-REFERENCE        TO DREFO.
 22935
 22936     MOVE PB-CSR-ID              TO DCSRO.
 22937
 22938     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22939        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22940        MOVE SPACE               TO DC-OPTION-CODE
 22941        PERFORM 9700-DATE-LINK
 22942        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22943        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22944        MOVE 'INACTIVE'          TO DLDATEO
 22945     ELSE
 22946        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22947        MOVE SPACE               TO DC-OPTION-CODE
 22948        PERFORM 9700-DATE-LINK
 22949        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22950
 22951     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22952     MOVE SPACE                  TO DC-OPTION-CODE.
 22953     PERFORM 9700-DATE-LINK.
 22954     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22955
 22956     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22957        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22958     ELSE
 22959        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22960        MOVE SPACE               TO DC-OPTION-CODE
 22961        PERFORM 9700-DATE-LINK
 22962        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22963
 22964     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22965     MOVE SPACE                  TO DC-OPTION-CODE.
 22966     PERFORM 9700-DATE-LINK.
 22967     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22968
 22969     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22970     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22971
 22972     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22973        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22974                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22975
 22976     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22977     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22978     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22979
 22980     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22981        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22982                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22983
 22984     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 423
* EL6311.cbl
 22985     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22986     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22987
 22988     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22989        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22990                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22991
 22992     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22993     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22994
 22995     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22996        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22997                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22998
 22999     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 23000     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 23001     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 23002
 23003     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 23004        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 23005                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 23006
 23007     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 23008     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 23009     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 23010
 23011     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 23012        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 23013                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 23014
 23015     MOVE -1                     TO DPFENTRL.
 23016     GO TO 8100-SEND-INITIAL-MAP.
 23017
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 424
* EL6311.cbl
 23019
 23020***************************************************************
 23021*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 23022*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 23023*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 23024*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 23025*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 23026*     ARE THEN SET ACCORDINGLY.                               *
 23027*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 23028*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 23029*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 23030***************************************************************
 23031
 23032******************************************************************
 23033*                                                                *
 23034*            E R R O R   A N A L Y S I S                         *
 23035*                                                                *
 23036******************************************************************
 23037
 23038******************************************************************
 23039*                                                                *
 23040*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 23041*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 23042*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 23043*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 23044*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 23045*                                                                *
 23046*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 23047*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 23048*                                                                *
 23049******************************************************************
 23050
 23051 7300-FORMAT-ERRORS.
 23052     MOVE ' '                    TO PI-ERRORS-SW
 23053     IF PB-COMMON-ERRORS = LOW-VALUES
 23054        IF PB-FATAL-ERRORS
 23055           MOVE ER-2695          TO EMI-ERROR
 23056           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23057           GO TO 7399-EXIT.
 23058
 23059     MOVE +0                     TO WS-SUB4.
 23060
 23061 7310-ERROR-LOOP.
 23062
 23063     ADD +1                      TO WS-SUB4.
 23064
 23065     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23066        GO TO 7350-SET-ERROR-FLAGS.
 23067
 23068     IF PI-COMPANY-ID = 'UCL'
 23069         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 23070             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 23071             MOVE ' '                   TO DC-OPTION-CODE
 23072             PERFORM 9700-DATE-LINK
 23073             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 23074
 23075     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 23076     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 425
* EL6311.cbl
 23077     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 23078
 23079     GO TO 7310-ERROR-LOOP.
 23080
 23081
 23082 7350-SET-ERROR-FLAGS.
 23083
 23084     IF EMI-FATAL-CTR NOT = ZEROS
 23085        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23086        MOVE 'X'                 TO PB-FATAL-FLAG
 23087                                    PI-ERRORS-SW
 23088        GO TO 7355-SET-ERROR-FLAGS.
 23089
 23090     move ' ' to pi-unforced-sw
 23091     IF EMI-FORCABLE-CTR NOT = ZEROS
 23092        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23093        IF PB-ISSUE
 23094           IF PB-ISSUE-FORCE
 23095              MOVE 'F'           TO PB-FORCE-ER-CD
 23096              MOVE ER-2600       TO EMI-ERROR
 23097              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23098             ELSE
 23099              MOVE 'X'           TO PB-FORCE-ER-CD
 23100*                                   PI-ERRORS-SW
 23101          ELSE
 23102           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23103              MOVE 'F'           TO PB-FORCE-ER-CD
 23104                                    pi-unforced-sw
 23105              MOVE ER-2600       TO EMI-ERROR
 23106              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23107             ELSE
 23108              MOVE 'X'           TO PB-FORCE-ER-CD
 23109                                    pi-unforced-sw.
 23110*                                   PI-ERRORS-SW.
 23111
 23112     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23113     IF PB-ISSUE
 23114         MOVE 'I'                TO ENDT-RECORD-TYPE
 23115     ELSE
 23116         MOVE 'C'                TO ENDT-RECORD-TYPE
 23117     END-IF
 23118     MOVE +0                     TO ENDT-SEQ-NO
 23119
 23120
 23121* EXEC CICS READ
 23122*        DATASET   (FILE-ID-ERENDT)
 23123*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23124*        RIDFLD    (ERENDT-KEY)
 23125*        RESP      (WS-RESPONSE)
 23126*        GTEQ
 23127*    END-EXEC
 23128*    MOVE '&"S        G          (  N#00019390' TO DFHEIV0
 23129     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23130     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23131     MOVE X'204E233030303139333930' TO DFHEIV0(25:11)
 23132     CALL 'kxdfhei1' USING DFHEIV0,
 23133           FILE-ID-ERENDT,
 23134           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 426
* EL6311.cbl
 23135           DFHEIV99,
 23136           ERENDT-KEY,
 23137           DFHEIV99,
 23138           DFHEIV99,
 23139           DFHEIV99
 23140     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23141         DFHEIV20
 23142     MOVE EIBRESP  TO WS-RESPONSE
 23143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23144
 23145     IF RESP-NORMAL
 23146        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23147        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23148            MOVE ER-0280          TO EMI-ERROR
 23149            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23150            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23151            EVALUATE TRUE
 23152              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23153                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23154              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23155                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23156              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23157                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23158            END-EVALUATE
 23159        END-IF
 23160     END-IF
 23161
 23162
 23163
 23164     IF FIRST-ENTRY OR
 23165        EIBAID = DFHPF1 OR DFHPF2
 23166        MOVE '0'                TO PI-EDIT-SW
 23167        GO TO 7399-EXIT.
 23168
 23169 7355-SET-ERROR-FLAGS.
 23170
 23171     IF EMI-WARNING-CTR NOT = ZEROS
 23172        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23173        MOVE 'W'                 TO PB-WARN-ER-CD.
 23174
 23175     IF PB-UNFORCED-ERRORS OR
 23176        PB-FATAL-ERRORS    OR
 23177        PB-RECORD-ON-HOLD  OR
 23178        PB-RECORD-RETURNED OR
 23179        PB-CANCELLATION
 23180          NEXT SENTENCE
 23181        ELSE
 23182          GO TO 7399-EXIT.
 23183
 23184
 23185* EXEC CICS  HANDLE CONDITION
 23186*           NOTFND   (7399-EXIT)
 23187*    END-EXEC.
 23188*    MOVE '"$I                   ! Z #00019437' TO DFHEIV0
 23189     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23190     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23191     MOVE X'5A20233030303139343337' TO DFHEIV0(25:11)
 23192     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 427
* EL6311.cbl
 23193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23194
 23195
 23196     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23197     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23198     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23199     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23200
 23201
 23202* EXEC CICS READ
 23203*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23204*        DATASET (FILE-ID-ELCERT)
 23205*        RIDFLD  (ELCERT-KEY)
 23206*        UPDATE
 23207*    END-EXEC.
 23208*    MOVE '&"S        EU         (   #00019446' TO DFHEIV0
 23209     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23210     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23211     MOVE X'2020233030303139343436' TO DFHEIV0(25:11)
 23212     CALL 'kxdfhei1' USING DFHEIV0,
 23213           FILE-ID-ELCERT,
 23214           DFHEIV20,
 23215           DFHEIV99,
 23216           ELCERT-KEY,
 23217           DFHEIV99,
 23218           DFHEIV99,
 23219           DFHEIV99
 23220     SET ADDRESS OF CERTIFICATE-MASTER TO
 23221         DFHEIV20
 23222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23223
 23224
 23225
 23226     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23227     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23228
 23229     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23230        GO TO 7360-REWRITE-CERT-MASTER.
 23231
 23232     IF PB-ISSUE
 23233        IF PB-RECORD-RETURNED
 23234            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23235            GO TO 7360-REWRITE-CERT-MASTER
 23236        ELSE
 23237            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23238            GO TO 7360-REWRITE-CERT-MASTER.
 23239
 23240     IF PB-RECORD-RETURNED
 23241         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 23242         GO TO 7360-REWRITE-CERT-MASTER.
 23243
 23244     IF (PB-C-LF-CANCEL-VOIDED)
 23245        or (pb-c-ah-cancel-voided)
 23246        IF (PB-UNFORCED-ERRORS OR
 23247            PB-FATAL-ERRORS    OR
 23248            PB-RECORD-ON-HOLD)
 23249            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23250            GO TO 7360-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 428
* EL6311.cbl
 23251        ELSE
 23252            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23253            GO TO 7360-REWRITE-CERT-MASTER.
 23254
 23255     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23256                            OR PB-RECORD-ON-HOLD)
 23257        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23258     ELSE
 23259        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23260
 23261 7360-REWRITE-CERT-MASTER.
 23262
 23263     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23264        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23265
 23266* EXEC CICS UNLOCK
 23267*            DATASET    (FILE-ID-ELCERT)
 23268*       END-EXEC
 23269*    MOVE '&*                    #   #00019493' TO DFHEIV0
 23270     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23271     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23272     MOVE X'2020233030303139343933' TO DFHEIV0(25:11)
 23273     CALL 'kxdfhei1' USING DFHEIV0,
 23274           FILE-ID-ELCERT,
 23275           DFHEIV99
 23276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23277        GO TO 7399-EXIT.
 23278
 23279
 23280* EXEC CICS REWRITE
 23281*         DATASET    (FILE-ID-ELCERT)
 23282*         FROM       (CERTIFICATE-MASTER)
 23283*    END-EXEC.
 23284     MOVE LENGTH OF
 23285      CERTIFICATE-MASTER
 23286       TO DFHEIV11
 23287*    MOVE '&& L                  %   #00019498' TO DFHEIV0
 23288     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23289     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23290     MOVE X'2020233030303139343938' TO DFHEIV0(25:11)
 23291     CALL 'kxdfhei1' USING DFHEIV0,
 23292           FILE-ID-ELCERT,
 23293           CERTIFICATE-MASTER,
 23294           DFHEIV11,
 23295           DFHEIV99
 23296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23297
 23298
 23299 7399-EXIT.
 23300      EXIT.
 23301
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 429
* EL6311.cbl
 23303
 23304*************************************************************
 23305*                                                           *
 23306*              S E T   A T T R I B U T E S                  *
 23307*                                                           *
 23308*************************************************************
 23309
 23310 7400-SET-ATTRIBUTES.
 23311
 23312     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23313        GO TO 7499-EXIT.
 23314
 23315**2601**
 23316
 23317     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23318        IF PB-ISSUE
 23319           MOVE AL-UABON         TO BEFFDTA
 23320           GO TO 7499-EXIT
 23321         ELSE
 23322           MOVE AL-UABON         TO CEFFDTA
 23323           GO TO 7499-EXIT.
 23324
 23325**2604**
 23326
 23327     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23328        IF PB-ISSUE
 23329           MOVE AL-UABON         TO BTYPE1A
 23330           MOVE -1               TO BTYPE1L
 23331           MOVE  1               TO SET-CURSOR-SW
 23332           GO TO 7499-EXIT.
 23333
 23334**2605**
 23335
 23336     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23337        IF PB-ISSUE
 23338           MOVE AL-UABON         TO BTYPE2A
 23339           MOVE -1               TO BTYPE2L
 23340           MOVE  1               TO SET-CURSOR-SW
 23341           GO TO 7499-EXIT.
 23342
 23343**2606**
 23344
 23345     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23346        IF PB-ISSUE
 23347           MOVE AL-UABON         TO BSIGA
 23348           MOVE -1               TO BSIGL
 23349           MOVE  1               TO SET-CURSOR-SW
 23350           GO TO 7499-EXIT.
 23351
 23352**2607**
 23353
 23354     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23355        IF PB-ISSUE
 23356           MOVE AL-UABON         TO BSIGA
 23357           MOVE -1               TO BSIGL
 23358           MOVE  1               TO SET-CURSOR-SW
 23359           GO TO 7499-EXIT.
 23360
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 430
* EL6311.cbl
 23361**2615**
 23362
 23363     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23364        IF PB-ISSUE
 23365           MOVE AL-UABOF         TO BREINA
 23366           MOVE -1               TO BREINL
 23367           GO TO 7499-EXIT.
 23368
 23369**2622**
 23370
 23371     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23372        IF PB-ISSUE
 23373           MOVE AL-UABON         TO BEFFDTA
 23374           GO TO 7499-EXIT
 23375        ELSE
 23376           MOVE AL-UABON         TO CEFFDTA
 23377           GO TO 7499-EXIT.
 23378
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 431
* EL6311.cbl
 23380
 23381*************************************************************
 23382*                                                           *
 23383*              I S S U E   E R R O R S                      *
 23384*                                                           *
 23385*************************************************************
 23386
 23387 7420-ISSUE-ERRORS.
 23388
 23389**2626**
 23390
 23391     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23392        MOVE AL-UABON            TO BCERTNOA
 23393        GO TO 7499-EXIT.
 23394
 23395**2627**
 23396
 23397     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23398        MOVE AL-UNBON            TO BAGEA
 23399        MOVE -1                  TO BAGEL
 23400        MOVE  1                  TO SET-CURSOR-SW
 23401        GO TO 7499-EXIT.
 23402
 23403**2628**
 23404
 23405     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23406        MOVE AL-UNBON            TO BAGEA
 23407        MOVE -1                  TO BAGEL
 23408        MOVE  1                  TO SET-CURSOR-SW
 23409        GO TO 7499-EXIT.
 23410
 23411**2629**
 23412
 23413     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23414        MOVE AL-UABON            TO BSEXA
 23415        MOVE -1                  TO BSEXL
 23416        MOVE  1                  TO SET-CURSOR-SW
 23417        GO TO 7499-EXIT.
 23418
 23419**2630**
 23420
 23421     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23422        MOVE -1                  TO BTYPE1L
 23423        MOVE  1                  TO SET-CURSOR-SW
 23424        GO TO 7499-EXIT.
 23425
 23426**2631**
 23427
 23428     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23429        MOVE -1                  TO BTYPE1L
 23430        MOVE  1                  TO SET-CURSOR-SW
 23431        GO TO 7499-EXIT.
 23432
 23433**2632**
 23434
 23435     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23436        MOVE AL-UNBON            TO BBEN1A
 23437        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 432
* EL6311.cbl
 23438        MOVE  1                  TO SET-CURSOR-SW
 23439        GO TO 7499-EXIT.
 23440
 23441**2633**
 23442
 23443     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23444        MOVE AL-UNBON            TO BPREM1A
 23445        MOVE -1                  TO BPREM1L
 23446        MOVE  1                  TO SET-CURSOR-SW
 23447        GO TO 7499-EXIT.
 23448
 23449**2634**
 23450
 23451     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23452        MOVE -1                  TO BTYPE2L
 23453        MOVE  1                  TO SET-CURSOR-SW
 23454        GO TO 7499-EXIT.
 23455
 23456**2635**
 23457
 23458     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23459        MOVE AL-UNBON            TO BBEN2A
 23460        MOVE -1                  TO BBEN2L
 23461        MOVE  1                  TO SET-CURSOR-SW
 23462        GO TO 7499-EXIT.
 23463
 23464**2636**
 23465
 23466     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23467        MOVE AL-UNBON            TO BPREM2A
 23468        MOVE -1                  TO BPREM2L
 23469        MOVE  1                  TO SET-CURSOR-SW
 23470        GO TO 7499-EXIT.
 23471
 23472**2639**
 23473
 23474     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23475        MOVE AL-UNBON            TO BBEN1A
 23476        MOVE -1                  TO BBEN1L
 23477        MOVE  1                  TO SET-CURSOR-SW
 23478        GO TO 7499-EXIT.
 23479
 23480**2640**
 23481
 23482     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23483        MOVE AL-UNBON            TO BBEN2A
 23484        MOVE -1                  TO BBEN2L
 23485        MOVE  1                  TO SET-CURSOR-SW
 23486        GO TO 7499-EXIT.
 23487
 23488**2647**
 23489
 23490     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23491        MOVE AL-UNBON            TO BTERM1A
 23492        MOVE -1                  TO BTERM1L
 23493        MOVE  1                  TO SET-CURSOR-SW
 23494        GO TO 7499-EXIT.
 23495
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 433
* EL6311.cbl
 23496**2648**
 23497
 23498     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23499        MOVE AL-UNBON            TO BLNTRMA
 23500        MOVE -1                  TO BLNTRML
 23501        MOVE  1                  TO SET-CURSOR-SW
 23502        GO TO 7499-EXIT.
 23503
 23504**2649**
 23505
 23506     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23507        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23508            MOVE AL-UNBON            TO BPREM1A
 23509            MOVE -1                  TO BPREM1L
 23510            MOVE  1                  TO SET-CURSOR-SW
 23511            GO TO 7499-EXIT
 23512     ELSE
 23513        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23514           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23515            MOVE AL-UNBON            TO BPREM2A
 23516            MOVE -1                  TO BPREM2L
 23517            MOVE  1                  TO SET-CURSOR-SW
 23518            GO TO 7499-EXIT.
 23519
 23520**2650**
 23521
 23522     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23523        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23524            MOVE AL-UNBON        TO BPREM1A
 23525            MOVE -1              TO BPREM1L
 23526            MOVE  1              TO SET-CURSOR-SW
 23527            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23528                MOVE AL-UNBON        TO BPREM2A
 23529                MOVE -1              TO BPREM2L
 23530                MOVE  1              TO SET-CURSOR-SW
 23531                GO TO 7499-EXIT
 23532            ELSE
 23533                GO TO 7499-EXIT
 23534        ELSE
 23535            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23536                MOVE AL-UNBON        TO BPREM2A
 23537                MOVE -1              TO BPREM2L
 23538                MOVE  1              TO SET-CURSOR-SW
 23539                GO TO 7499-EXIT
 23540            ELSE
 23541                GO TO 7499-EXIT.
 23542
 23543**2651**
 23544
 23545     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23546        MOVE AL-UABON            TO BSIGA
 23547        MOVE -1                  TO BSIGL
 23548        MOVE  1                  TO SET-CURSOR-SW
 23549        GO TO 7499-EXIT.
 23550
 23551**2653**
 23552
 23553     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 434
* EL6311.cbl
 23554        MOVE AL-UABON            TO BFREQA
 23555        MOVE -1                  TO BFREQL
 23556        MOVE  1                  TO SET-CURSOR-SW
 23557        GO TO 7499-EXIT.
 23558
 23559**2654**
 23560
 23561     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23562        MOVE AL-UABON            TO BFREQA
 23563        MOVE -1                  TO BFREQL
 23564        MOVE  1                  TO SET-CURSOR-SW
 23565        GO TO 7499-EXIT.
 23566
 23567**2655**
 23568
 23569     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23570        MOVE AL-UABON            TO BFREQA
 23571        MOVE -1                  TO BFREQL
 23572        MOVE  1                  TO SET-CURSOR-SW
 23573        GO TO 7499-EXIT.
 23574
 23575**2656**
 23576
 23577     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23578        MOVE AL-UNBON            TO BAPRA
 23579        MOVE -1                  TO BAPRL
 23580        MOVE  1                  TO SET-CURSOR-SW
 23581        GO TO 7499-EXIT.
 23582
 23583**2657**
 23584
 23585     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23586        MOVE AL-UNBON            TO BAPRA
 23587        MOVE -1                  TO BAPRL
 23588        MOVE  1                  TO SET-CURSOR-SW
 23589        GO TO 7499-EXIT.
 23590
 23591**2658**
 23592
 23593     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23594        MOVE AL-UNBON            TO BTERM2A
 23595        MOVE -1                  TO BTERM2L
 23596        MOVE  1                  TO SET-CURSOR-SW
 23597        GO TO 7499-EXIT.
 23598
 23599**2660**
 23600
 23601     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23602        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23603        MOVE -1                  TO BLSTNML
 23604        MOVE  1                  TO SET-CURSOR-SW
 23605        GO TO 7499-EXIT.
 23606
 23607
 23608**2662**
 23609
 23610     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23611        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 435
* EL6311.cbl
 23612        MOVE -1                  TO BAGEL
 23613        MOVE  1                  TO SET-CURSOR-SW
 23614        GO TO 7499-EXIT.
 23615
 23616**2663**
 23617
 23618     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23619        MOVE AL-UNBON            TO BAGEA
 23620        MOVE -1                  TO BAGEL
 23621        MOVE  1                  TO SET-CURSOR-SW
 23622        GO TO 7499-EXIT.
 23623
 23624**2664**
 23625
 23626     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23627        MOVE AL-UABON            TO BREINA
 23628        MOVE -1                  TO BREINL
 23629        MOVE  1                  TO SET-CURSOR-SW
 23630        GO TO 7499-EXIT.
 23631
 23632**2667**
 23633
 23634     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23635        MOVE AL-UNBON            TO BBEN2A
 23636        MOVE -1                  TO BBEN2L
 23637        MOVE  1                  TO SET-CURSOR-SW
 23638        GO TO 7499-EXIT.
 23639
 23640**2668**
 23641
 23642     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23643        MOVE AL-UABON            TO BEFFDTA
 23644        GO TO 7499-EXIT.
 23645
 23646**2669**
 23647
 23648     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23649       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23650       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23651        MOVE AL-UNBON            TO BAGEA
 23652        MOVE -1                  TO BAGEL
 23653        MOVE  1                  TO SET-CURSOR-SW
 23654        GO TO 7499-EXIT.
 23655
 23656**2670**
 23657
 23658     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23659        MOVE AL-UABON            TO BFORCEA
 23660        MOVE -1                  TO BFORCEL
 23661        MOVE  1                  TO SET-CURSOR-SW
 23662        GO TO 7499-EXIT.
 23663
 23664**2671**
 23665
 23666     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23667        MOVE AL-UABON            TO BEFFDTA
 23668        GO TO 7499-EXIT.
 23669
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 436
* EL6311.cbl
 23670**2672**
 23671
 23672     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23673        MOVE AL-UABON            TO BEFFDTA
 23674        GO TO 7499-EXIT.
 23675
 23676**2673**
 23677
 23678     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23679        MOVE AL-UABON            TO BEFFDTA
 23680        GO TO 7499-EXIT.
 23681
 23682**2674**
 23683
 23684     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23685        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23686        MOVE -1                  TO BTYPE1L
 23687        MOVE  1                  TO SET-CURSOR-SW
 23688        GO TO 7499-EXIT.
 23689
 23690**2677**
 23691
 23692     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23693        MOVE AL-UNBON            TO BTERM1A
 23694        MOVE -1                  TO BTERM1L
 23695        MOVE  1                  TO SET-CURSOR-SW
 23696        GO TO 7499-EXIT.
 23697
 23698**2678**
 23699
 23700     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23701        MOVE AL-UNBON            TO BTERM2A
 23702        MOVE -1                  TO BTERM2L
 23703        MOVE  1                  TO SET-CURSOR-SW
 23704        GO TO 7499-EXIT.
 23705
 23706**2679**
 23707
 23708     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23709        MOVE AL-UABON            TO BTYPE1A
 23710        MOVE -1                  TO BTYPE1L
 23711        MOVE  1                  TO SET-CURSOR-SW
 23712        GO TO 7499-EXIT.
 23713
 23714**2680**
 23715
 23716     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 23717        MOVE AL-UABOF            TO B1STPMTA
 23718        MOVE -1                  TO B1STPMTL
 23719        MOVE  1                  TO SET-CURSOR-SW
 23720        GO TO 7499-EXIT.
 23721
 23722**2681**
 23723
 23724     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23725        MOVE AL-UABON            TO BDAYSA
 23726        MOVE -1                  TO BDAYSL
 23727        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 437
* EL6311.cbl
 23728        GO TO 7499-EXIT.
 23729
 23730**2682**
 23731
 23732     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23733        MOVE AL-UABON            TO BTERM1A
 23734        MOVE -1                  TO BTERM1L
 23735        MOVE  1                  TO SET-CURSOR-SW
 23736        GO TO 7499-EXIT.
 23737
 23738**2683**
 23739
 23740     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23741        MOVE AL-UABON            TO BSKPCDA
 23742        MOVE -1                  TO BSKPCDL
 23743        MOVE  1                  TO SET-CURSOR-SW
 23744        GO TO 7499-EXIT.
 23745
 23746**2684**
 23747
 23748     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23749        MOVE AL-UABON            TO BTYPE2A
 23750        MOVE -1                  TO BTYPE2L
 23751        MOVE  1                  TO SET-CURSOR-SW
 23752        GO TO 7499-EXIT.
 23753
 23754**2686**
 23755
 23756     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23757        MOVE AL-UABON            TO BTYPE2A
 23758        MOVE -1                  TO BTYPE2L
 23759        MOVE  1                  TO SET-CURSOR-SW
 23760        GO TO 7499-EXIT.
 23761
 23762**2689**
 23763
 23764     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23765        MOVE AL-UABON            TO BSIGA
 23766        MOVE -1                  TO BSIGL
 23767        MOVE  1                  TO SET-CURSOR-SW
 23768        GO TO 7499-EXIT.
 23769
 23770**2690**
 23771
 23772     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23773        MOVE AL-UABOF            TO BLNOFCRA
 23774        MOVE -1                  TO BLNOFCRL
 23775        MOVE  1                  TO SET-CURSOR-SW
 23776        GO TO 7499-EXIT.
 23777
 23778**2693**
 23779
 23780     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23781        MOVE AL-UABOF            TO BLNOFCRA
 23782        MOVE AL-UNBON            TO BBEN1A
 23783        MOVE -1                  TO BBEN1L
 23784        MOVE  1                  TO SET-CURSOR-SW
 23785        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 438
* EL6311.cbl
 23786
 23787**2720**
 23788
 23789     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23790        MOVE AL-UNBON            TO BBEN1A
 23791        MOVE -1                  TO BBEN1L
 23792        MOVE  1                  TO SET-CURSOR-SW
 23793        GO TO 7499-EXIT.
 23794
 23795**2709**
 23796
 23797*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23798*       MOVE AL-UNBON            TO BBEN1A
 23799*       MOVE -1                  TO BBEN1L
 23800*       MOVE  1                  TO SET-CURSOR-SW
 23801*       GO TO 7499-EXIT.
 23802
 23803*************************************************************
 23804*                                                           *
 23805*            C A N C E L   E R R O R S                      *
 23806*                                                           *
 23807*************************************************************
 23808
 23809**2726**
 23810
 23811     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23812        MOVE AL-UABON            TO CCERTNOA
 23813        GO TO 7499-EXIT.
 23814
 23815**2728**
 23816
 23817     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23818        MOVE AL-UABON            TO CCERTNOA
 23819        GO TO 7499-EXIT.
 23820
 23821**2729**
 23822
 23823     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23824        MOVE AL-UABON            TO CCERTNOA
 23825        GO TO 7499-EXIT.
 23826
 23827**2730**
 23828
 23829     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23830        MOVE AL-UABON            TO CCERTNOA
 23831        GO TO 7499-EXIT.
 23832
 23833**2731**
 23834
 23835     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23836        MOVE AL-UABON            TO CCANDT1A
 23837        MOVE -1                  TO CCANDT1L
 23838        MOVE  1                  TO SET-CURSOR-SW
 23839        GO TO 7499-EXIT.
 23840
 23841**2732**
 23842
 23843     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 439
* EL6311.cbl
 23844        MOVE AL-UABON            TO CCANDT1A
 23845        MOVE -1                  TO CCANDT1L
 23846        MOVE  1                  TO SET-CURSOR-SW
 23847        GO TO 7499-EXIT.
 23848
 23849**2733**
 23850
 23851     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23852        MOVE AL-UABON            TO CCANDT1A
 23853        MOVE -1                  TO CCANDT1L
 23854        MOVE  1                  TO SET-CURSOR-SW
 23855        GO TO 7499-EXIT.
 23856
 23857**2734**
 23858
 23859     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23860        MOVE AL-UNBON            TO CREFND1A
 23861        MOVE -1                  TO CREFND1L
 23862        MOVE  1                  TO SET-CURSOR-SW
 23863        GO TO 7499-EXIT.
 23864
 23865**2735**
 23866
 23867     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23868        MOVE AL-UABON            TO CCANDT2A
 23869        MOVE -1                  TO CCANDT2L
 23870        MOVE  1                  TO SET-CURSOR-SW
 23871        GO TO 7499-EXIT.
 23872
 23873**2736**
 23874
 23875     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23876        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23877            MOVE AL-UNBON        TO CREFND1A
 23878            MOVE -1              TO CREFND1L
 23879            MOVE  1              TO SET-CURSOR-SW
 23880            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23881                MOVE AL-UNBON        TO CREFND2A
 23882                MOVE -1              TO CREFND2L
 23883                MOVE  1              TO SET-CURSOR-SW
 23884                GO TO 7499-EXIT
 23885            ELSE
 23886                GO TO 7499-EXIT
 23887        ELSE
 23888            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23889                MOVE AL-UNBON        TO CREFND2A
 23890                MOVE -1              TO CREFND2L
 23891                MOVE  1              TO SET-CURSOR-SW
 23892                GO TO 7499-EXIT
 23893            ELSE
 23894                GO TO 7499-EXIT.
 23895
 23896**2738**
 23897
 23898     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23899        MOVE -1                  TO CREFND2L
 23900        MOVE  1                  TO SET-CURSOR-SW
 23901        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 440
* EL6311.cbl
 23902
 23903**2739**
 23904
 23905     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23906        MOVE -1                  TO CREFND1L
 23907        MOVE  1                  TO SET-CURSOR-SW
 23908        GO TO 7499-EXIT.
 23909
 23910**2741**
 23911
 23912     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23913        MOVE -1                  TO CREFND1L
 23914        MOVE  1                  TO SET-CURSOR-SW
 23915        GO TO 7499-EXIT.
 23916
 23917**2743**
 23918
 23919     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23920        MOVE AL-UNBON            TO CCANDT1A
 23921        MOVE -1                  TO CCANDT1L
 23922        MOVE  1                  TO SET-CURSOR-SW
 23923        GO TO 7499-EXIT.
 23924
 23925**2744**
 23926
 23927     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23928        MOVE AL-UNBON            TO CCANDT2A
 23929        MOVE -1                  TO CCANDT2L
 23930        MOVE  1                  TO SET-CURSOR-SW
 23931        GO TO 7499-EXIT.
 23932
 23933**2747**
 23934
 23935     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23936        MOVE AL-UABON            TO CLSTNMA
 23937        MOVE -1                  TO CLSTNML
 23938        MOVE  1                  TO SET-CURSOR-SW
 23939        GO TO 7499-EXIT.
 23940
 23941**2749**
 23942
 23943     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23944        MOVE AL-UABON            TO CFORCEA
 23945        MOVE -1                  TO CFORCEL
 23946        MOVE  1                  TO SET-CURSOR-SW
 23947        GO TO 7499-EXIT.
 23948
 23949**2753**
 23950
 23951     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23952        MOVE AL-UNBON            TO CCANDT1A
 23953        MOVE -1                  TO CCANDT1L
 23954        MOVE  1                  TO SET-CURSOR-SW
 23955        GO TO 7499-EXIT.
 23956
 23957**2755**
 23958
 23959     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 441
* EL6311.cbl
 23960        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23961            MOVE AL-UNBON        TO CREFND1A
 23962            MOVE -1              TO CREFND1L
 23963            MOVE  1              TO SET-CURSOR-SW
 23964            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23965                MOVE AL-UNBON        TO CREFND2A
 23966                MOVE -1              TO CREFND2L
 23967                MOVE  1              TO SET-CURSOR-SW
 23968                GO TO 7499-EXIT
 23969            ELSE
 23970                GO TO 7499-EXIT
 23971        ELSE
 23972            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23973                MOVE AL-UNBON        TO CREFND2A
 23974                MOVE -1              TO CREFND2L
 23975                MOVE  1              TO SET-CURSOR-SW
 23976            ELSE
 23977                GO TO 7499-EXIT.
 23978
 23979**2757**
 23980
 23981     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23982        MOVE AL-UNBON            TO CLIVESA
 23983        MOVE -1                  TO CLIVESL
 23984        MOVE  1                  TO SET-CURSOR-SW
 23985        GO TO 7499-EXIT.
 23986
 23987**2771**
 23988
 23989     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23990        MOVE AL-UABON            TO CCANDT2A
 23991        MOVE -1                  TO CCANDT2L
 23992        MOVE  1                  TO SET-CURSOR-SW
 23993        GO TO 7499-EXIT.
 23994
 23995**2774**
 23996
 23997     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23998        MOVE AL-UABON            TO CCANDT1A
 23999        MOVE -1                  TO CCANDT1L
 24000        MOVE  1                  TO SET-CURSOR-SW
 24001        GO TO 7499-EXIT.
 24002
 24003**2775**
 24004
 24005     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 24006        MOVE AL-UABON            TO CCANDT2A
 24007        MOVE -1                  TO CCANDT2L
 24008        MOVE  1                  TO SET-CURSOR-SW
 24009        GO TO 7499-EXIT.
 24010
 24011**2776**
 24012
 24013     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 24014        MOVE AL-UABON            TO CCANDT1A
 24015        MOVE -1                  TO CCANDT1L
 24016        MOVE  1                  TO SET-CURSOR-SW
 24017        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 442
* EL6311.cbl
 24018
 24019
 24020**2777**
 24021
 24022     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 24023        MOVE AL-UABON            TO CCANDT2A
 24024        MOVE -1                  TO CCANDT2L
 24025        MOVE  1                  TO SET-CURSOR-SW
 24026        GO TO 7499-EXIT.
 24027
 24028**2794**
 24029
 24030     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 24031        MOVE AL-UABON            TO CFORCEA
 24032        MOVE -1                  TO CFORCEL
 24033        MOVE  1                  TO SET-CURSOR-SW
 24034        GO TO 7499-EXIT.
 24035
 24036**2799**
 24037
 24038     IF PI-COMPANY-ID = 'UCL'
 24039         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 24040             MOVE AL-UNBON            TO BEFFDTA
 24041             MOVE -1                  TO BEFFDTL
 24042             MOVE  1                  TO SET-CURSOR-SW
 24043             GO TO 7499-EXIT.
 24044
 24045 7499-EXIT.
 24046      EXIT.
 24047
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 443
* EL6311.cbl
 24049
 24050 7500-READ-ERLOFC.
 24051     MOVE SPACES                 TO  WS-LOAN-OFFICER
 24052                                     ERLOFC-KEY.
 24053
 24054     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 24055
 24056     IF ST-ACCNT-CNTL
 24057         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24058
 24059     IF CARR-GROUP-ST-ACCNT-CNTL
 24060         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24061         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 24062         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 24063
 24064     IF CARR-ST-ACCNT-CNTL
 24065         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24066         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24067
 24068     IF CARR-ACCNT-CNTL
 24069         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 24070
 24071     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 24072
 24073     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 24074
 24075
 24076* EXEC CICS HANDLE CONDITION
 24077*        NOTFND   (7550-OFFICER-NOTFND)
 24078*    END-EXEC.
 24079*    MOVE '"$I                   ! [ #00020279' TO DFHEIV0
 24080     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 24081     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24082     MOVE X'5B20233030303230323739' TO DFHEIV0(25:11)
 24083     CALL 'kxdfhei1' USING DFHEIV0
 24084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24085
 24086
 24087
 24088* EXEC CICS READ
 24089*        DATASET   (FILE-ID-ERLOFC)
 24090*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24091*        RIDFLD    (ERLOFC-KEY)
 24092*        EQUAL
 24093*    END-EXEC.
 24094*    MOVE '&"S        E          (   #00020283' TO DFHEIV0
 24095     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24096     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24097     MOVE X'2020233030303230323833' TO DFHEIV0(25:11)
 24098     CALL 'kxdfhei1' USING DFHEIV0,
 24099           FILE-ID-ERLOFC,
 24100           DFHEIV20,
 24101           DFHEIV99,
 24102           ERLOFC-KEY,
 24103           DFHEIV99,
 24104           DFHEIV99,
 24105           DFHEIV99
 24106     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 444
* EL6311.cbl
 24107         DFHEIV20
 24108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24109
 24110
 24111     GO TO 7599-EXIT.
 24112
 24113 7550-OFFICER-NOTFND.
 24114     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24115
 24116 7599-EXIT.
 24117      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 445
* EL6311.cbl
 24119******************************************************************
 24120*                                                                *
 24121*            S  E N D    I N I T I A L   M A P                   *
 24122*                                                                *
 24123******************************************************************
 24124
 24125 8100-SEND-INITIAL-MAP.
 24126     MOVE EIBTIME                TO TIME-IN.
 24127
 24128     IF EIBAID = DFHPF11
 24129        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24130        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24131
 24132
 24133     IF PI-COMPANY-ID = CLIENT-GIC
 24134        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24135                                       BCPREM-ATTRB (2).
 24136
 24137     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24138                         CLIENT-PEM OR
 24139                         CLIENT-CSO)
 24140        AND PI-DISPLAY-ORIGINAL-BATCH
 24141          IF PI-MAP-NAME = EL631B
 24142             MOVE AL-SADOF               TO BPF5HDRA
 24143                                            BPF4HDRA
 24144          ELSE
 24145             IF PI-MAP-NAME = EL631C
 24146                MOVE AL-SADOF            TO CPF5HDRA
 24147                                            CPF4HDRA.
 24148
 24149     IF PI-MAP-NAME = EL631B
 24150        MOVE AL-SADOF               TO BPF5HDRA
 24151     ELSE
 24152        MOVE AL-SADOF               TO CPF5HDRA
 24153     END-IF
 24154
 24155*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24156     IF PI-MAP-NAME = EL631B
 24157          IF PI-COMPANY-ID NOT = 'DMD'
 24158             MOVE AL-SANOF            TO BBILLEDA
 24159             MOVE AL-SADOF            TO DMDBILA.
 24160*DMD CUSTOM CODING*************END
 24161
 24162     IF PI-PROCESSOR-ID = 'LGXX'
 24163        IF PI-MAP-NAME = EL631B
 24164           MOVE AL-SABOF                    TO BREFHDGA
 24165           MOVE AL-SANOF                    TO BREFA
 24166        ELSE
 24167           IF PI-MAP-NAME = EL631C
 24168              MOVE AL-SABOF                 TO CREFHDGA
 24169              MOVE AL-SANOF                 TO CREFA.
 24170
 24171     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'CAP'
 24172        continue
 24173     ELSE
 24174        IF PI-MAP-NAME = EL631C
 24175           MOVE AL-SADOF         TO CCANTXTA
 24176                                    CCANFEEA
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 446
* EL6311.cbl
 24177        end-if
 24178     end-if
 24179     IF PI-MAP-NAME = EL631D
 24180        IF PI-AR-PROCESSING
 24181           MOVE AL-SANOF            TO DREFHDGA
 24182        ELSE
 24183           MOVE AL-SADOF            TO DREFHDGA.
 24184
 24185     IF (PI-COMPANY-ID NOT = 'DCC' and 'CAP' and 'CID')
 24186        AND (PI-MAP-NAME = EL631B)
 24187        MOVE AL-SADOF            TO BVINHA
 24188                                    BVINA
 24189     END-IF
 24190     IF PI-MAP-NAME = EL631B
 24191        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24192        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24193                                 TO BREGIONO
 24194        MOVE PI-PROCESSOR-ID     TO BUSERO
 24195        IF CSR-EDIT-SESSION
 24196           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24197                                 TO BHEADO
 24198           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24199        ELSE
 24200           MOVE AL-SADOF         TO BF15HDRA
 24201           MOVE '4=B-HDR      '  TO BPF4HDRO
 24202        END-IF
 24203        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24204        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24205        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24206        MOVE WS-CURRENT-DT          TO BDATEO
 24207        MOVE TIME-OUT               TO BTIMEO
 24208        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24209        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24210        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24211        IF   WS-DISPLAY-SCREEN
 24212             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24213             MOVE PB-SV-CARRIER     TO BCARRO
 24214             MOVE PB-SV-GROUPING    TO BGROUPO
 24215             MOVE PB-SV-STATE       TO BSTATEO
 24216             MOVE PB-ACCOUNT        TO BACCTO
 24217        ELSE
 24218             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24219     ELSE
 24220        IF PI-MAP-NAME = EL631C
 24221           MOVE '4=B-HDR      '     TO CPF4HDRO
 24222           IF CSR-EDIT-SESSION
 24223              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24224                                 TO CHEADO
 24225           ELSE
 24226              MOVE AL-SADOF      TO CF15HDRA
 24227           END-IF
 24228           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24229           MOVE WS-CURRENT-DT          TO CDATEO
 24230           MOVE TIME-OUT               TO CTIMEO
 24231           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24232           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24233           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24234           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 447
* EL6311.cbl
 24235           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24236           MOVE WS-C-HDG               TO CAHHDGO
 24237           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24238           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24239           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24240           IF   WS-DISPLAY-SCREEN
 24241                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24242                MOVE PB-SV-CARRIER     TO CCARRO
 24243                MOVE PB-SV-GROUPING    TO CGROUPO
 24244                MOVE PB-SV-STATE       TO CSTATEO
 24245                MOVE PB-ACCOUNT        TO CACCTO
 24246           ELSE
 24247                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24248        ELSE
 24249           MOVE WS-CURRENT-DT          TO DDATEO
 24250           MOVE TIME-OUT               TO DTIMEO
 24251           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24252                                          WS-REFUND-HDG-OVERRIDE
 24253           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24254           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24255           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24256                                          WS-REFUND-HDG-OVERRIDE
 24257           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24258           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24259           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24260           IF CSR-EDIT-SESSION
 24261              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24262                                 TO DHEADO
 24263           END-IF
 24264           IF  WS-DISPLAY-SCREEN
 24265               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24266               MOVE PB-CARRIER         TO DCARRO
 24267               MOVE PB-GROUPING        TO DGROUPO
 24268               MOVE PB-STATE           TO DSTATEO
 24269               MOVE PB-ACCOUNT         TO DACCTO
 24270               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24271           ELSE
 24272               MOVE EL631D             TO PI-MAP-NAME
 24273               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24274               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24275
 24276     MOVE SPACE                        TO WS-DISPLAY-SW.
 24277
 24278
 24279* EXEC CICS SEND
 24280*        MAP      (PI-MAP-NAME)
 24281*        MAPSET   (MAPSET-EL6311S)
 24282*        FROM     (EL631BI)
 24283*        ERASE
 24284*        CURSOR
 24285*    END-EXEC.
 24286     MOVE LENGTH OF
 24287      EL631BI
 24288       TO DFHEIV12
 24289     MOVE -1
 24290       TO DFHEIV11
 24291*    MOVE '8$     CT  E    H L F ,   #00020457' TO DFHEIV0
 24292     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 448
* EL6311.cbl
 24293     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24294     MOVE X'2020233030303230343537' TO DFHEIV0(25:11)
 24295     CALL 'kxdfhei1' USING DFHEIV0,
 24296           PI-MAP-NAME,
 24297           EL631BI,
 24298           DFHEIV12,
 24299           MAPSET-EL6311S,
 24300           DFHEIV99,
 24301           DFHEIV99,
 24302           DFHEIV99,
 24303           DFHEIV11,
 24304           DFHEIV99,
 24305           DFHEIV99,
 24306           DFHEIV99
 24307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24308
 24309
 24310     GO TO 9100-RETURN-TRAN.
 24311
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 449
* EL6311.cbl
 24313
 24314******************************************************************
 24315*                                                                *
 24316*              S E N D    D A T A O N L Y                        *
 24317*                                                                *
 24318******************************************************************
 24319
 24320 8200-SEND-DATAONLY.
 24321     MOVE EIBTIME                TO TIME-IN.
 24322
 24323     IF PI-COMPANY-ID = CLIENT-GIC
 24324        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24325                                       BCPREM-ATTRB (2).
 24326
 24327     IF PI-MAP-NAME = EL631B
 24328        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24329        MOVE WS-CURRENT-DT          TO BDATEO
 24330        MOVE TIME-OUT               TO BTIMEO
 24331        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24332        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24333        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24334        MOVE SPACES                 TO BPFENTRO
 24335        MOVE AL-UANOF               TO BPFENTRA
 24336
 24337*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24338        IF PI-COMPANY-ID NOT = 'DMD'
 24339             MOVE AL-SANOF            TO BBILLEDA
 24340             MOVE AL-SADOF            TO DMDBILA
 24341         ELSE
 24342            NEXT SENTENCE
 24343*DMD CUSTOM CODING*************END
 24344     ELSE
 24345        IF PI-MAP-NAME = EL631C
 24346           MOVE WS-CURRENT-DT          TO CDATEO
 24347           MOVE TIME-OUT               TO CTIMEO
 24348           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24349           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24350           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24351           MOVE SPACES                 TO CPFENTRO
 24352           MOVE AL-UANOF               TO CPFENTRA
 24353        ELSE
 24354           MOVE WS-CURRENT-DT          TO DDATEO
 24355           MOVE TIME-OUT               TO DTIMEO
 24356           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24357
 24358
 24359* EXEC CICS SEND
 24360*        MAP      (PI-MAP-NAME)
 24361*        MAPSET   (MAPSET-EL6311S)
 24362*        FROM     (EL631BI)
 24363*        DATAONLY
 24364*        CURSOR
 24365*    END-EXEC.
 24366     MOVE LENGTH OF
 24367      EL631BI
 24368       TO DFHEIV12
 24369     MOVE -1
 24370       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 450
* EL6311.cbl
 24371*    MOVE '8$D    CT       H L F ,   #00020513' TO DFHEIV0
 24372     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24373     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24374     MOVE X'2020233030303230353133' TO DFHEIV0(25:11)
 24375     CALL 'kxdfhei1' USING DFHEIV0,
 24376           PI-MAP-NAME,
 24377           EL631BI,
 24378           DFHEIV12,
 24379           MAPSET-EL6311S,
 24380           DFHEIV99,
 24381           DFHEIV99,
 24382           DFHEIV99,
 24383           DFHEIV11,
 24384           DFHEIV99,
 24385           DFHEIV99,
 24386           DFHEIV99
 24387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24388
 24389
 24390     GO TO 9100-RETURN-TRAN.
 24391
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 451
* EL6311.cbl
 24393
 24394******************************************************************
 24395*                                                                *
 24396*           U T I L I T Y   R O U T I N E S                      *
 24397*                                                                *
 24398******************************************************************
 24399
 24400 8300-SEND-TEXT.
 24401
 24402* EXEC CICS SEND TEXT
 24403*        FROM     (LOGOFF-TEXT)
 24404*        LENGTH   (LOGOFF-LENGTH)
 24405*        ERASE
 24406*        FREEKB
 24407*    END-EXEC.
 24408*    MOVE '8&      T  E F  H   F -   #00020532' TO DFHEIV0
 24409     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24410     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24411     MOVE X'2020233030303230353332' TO DFHEIV0(25:11)
 24412     CALL 'kxdfhei1' USING DFHEIV0,
 24413           LOGOFF-TEXT,
 24414           LOGOFF-LENGTH,
 24415           DFHEIV99,
 24416           DFHEIV99,
 24417           DFHEIV99,
 24418           DFHEIV99,
 24419           DFHEIV99,
 24420           DFHEIV99,
 24421           DFHEIV99,
 24422           DFHEIV99,
 24423           DFHEIV99,
 24424           DFHEIV99
 24425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24426
 24427
 24428
 24429* EXEC CICS RETURN
 24430*    END-EXEC.
 24431*    MOVE '.(                    ''   #00020539' TO DFHEIV0
 24432     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24433     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24434     MOVE X'2020233030303230353339' TO DFHEIV0(25:11)
 24435     CALL 'kxdfhei1' USING DFHEIV0,
 24436           DFHEIV99,
 24437           DFHEIV99,
 24438           DFHEIV99,
 24439           DFHEIV99,
 24440           DFHEIV99,
 24441           DFHEIV99
 24442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24443
 24444
 24445 8400-LOG-JOURNAL-RECORD.
 24446     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24447     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24448
 24449*    EXEC CICS JOURNAL
 24450*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 452
* EL6311.cbl
 24451*        JTYPEID     ('EL')
 24452*        FROM        (JOURNAL-RECORD)
 24453*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24454*    END-EXEC.
 24455
 24456 8600-DEEDIT.
 24457
 24458* EXEC CICS BIF DEEDIT
 24459*         FIELD   (DEEDIT-FIELD)
 24460*         LENGTH  (15)
 24461*    END-EXEC.
 24462     MOVE 15
 24463       TO DFHEIV11
 24464*    MOVE '@"L                   #   #00020554' TO DFHEIV0
 24465     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24466     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24467     MOVE X'2020233030303230353534' TO DFHEIV0(25:11)
 24468     CALL 'kxdfhei1' USING DFHEIV0,
 24469           DEEDIT-FIELD,
 24470           DFHEIV11
 24471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24472
 24473
 24474 8800-UNAUTHORIZED-ACCESS.
 24475     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24476     GO TO 8300-SEND-TEXT.
 24477
 24478 8810-PF23.
 24479     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24480     MOVE XCTL-EL005             TO PGM-NAME.
 24481     GO TO 9300-XCTL.
 24482
 24483 9100-RETURN-TRAN.
 24484     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24485
 24486     IF  PI-MAP-NAME =  EL631B
 24487         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24488
 24489     IF  PI-MAP-NAME =  EL631C
 24490         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24491
 24492     IF  PI-MAP-NAME =  EL631D
 24493         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24494
 24495
 24496* EXEC CICS RETURN
 24497*        TRANSID    (TRANS-EXB1)
 24498*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24499*        LENGTH     (1300)
 24500*    END-EXEC.
 24501     MOVE 1300
 24502       TO DFHEIV11
 24503*    MOVE '.(CT                  ''   #00020580' TO DFHEIV0
 24504     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24505     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24506     MOVE X'2020233030303230353830' TO DFHEIV0(25:11)
 24507     CALL 'kxdfhei1' USING DFHEIV0,
 24508           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 453
* EL6311.cbl
 24509           PROGRAM-INTERFACE-BLOCK,
 24510           DFHEIV11,
 24511           DFHEIV99,
 24512           DFHEIV99,
 24513           DFHEIV99
 24514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24515
 24516
 24517 9200-RETURN-MAIN-MENU.
 24518     MOVE XCTL-EL626             TO PGM-NAME.
 24519     GO TO 9300-XCTL.
 24520
 24521 9300-XCTL.
 24522
 24523* EXEC CICS XCTL
 24524*        PROGRAM    (PGM-NAME)
 24525*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24526*        LENGTH     (PI-COMM-LENGTH)
 24527*    END-EXEC.
 24528*    MOVE '.$C                   %   #00020591' TO DFHEIV0
 24529     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24530     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24531     MOVE X'2020233030303230353931' TO DFHEIV0(25:11)
 24532     CALL 'kxdfhei1' USING DFHEIV0,
 24533           PGM-NAME,
 24534           PROGRAM-INTERFACE-BLOCK,
 24535           PI-COMM-LENGTH,
 24536           DFHEIV99
 24537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24538
 24539
 24540 9400-CLEAR.
 24541     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24542     GO TO 9300-XCTL.
 24543
 24544 9500-PF12.
 24545     MOVE XCTL-EL010             TO PGM-NAME.
 24546     GO TO 9300-XCTL.
 24547
 24548 9600-PGMID-ERROR.
 24549
 24550* EXEC CICS HANDLE CONDITION
 24551*        PGMIDERR    (8300-SEND-TEXT)
 24552*    END-EXEC.
 24553*    MOVE '"$L                   ! \ #00020606' TO DFHEIV0
 24554     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24555     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24556     MOVE X'5C20233030303230363036' TO DFHEIV0(25:11)
 24557     CALL 'kxdfhei1' USING DFHEIV0
 24558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24559
 24560
 24561     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24562     MOVE ' '                    TO PI-ENTRY-CD-1.
 24563     MOVE XCTL-EL005             TO PGM-NAME.
 24564     MOVE PGM-NAME               TO LOGOFF-PGM.
 24565     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24566     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 454
* EL6311.cbl
 24567
 24568 9700-DATE-LINK.
 24569     MOVE LINK-ELDATCV           TO PGM-NAME.
 24570
 24571* EXEC CICS LINK
 24572*        PROGRAM    (PGM-NAME)
 24573*        COMMAREA   (DATE-CONVERSION-DATA)
 24574*        LENGTH     (DC-COMM-LENGTH)
 24575*    END-EXEC.
 24576*    MOVE '."C                   (   #00020619' TO DFHEIV0
 24577     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24578     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24579     MOVE X'2020233030303230363139' TO DFHEIV0(25:11)
 24580     CALL 'kxdfhei1' USING DFHEIV0,
 24581           PGM-NAME,
 24582           DATE-CONVERSION-DATA,
 24583           DC-COMM-LENGTH,
 24584           DFHEIV99,
 24585           DFHEIV99,
 24586           DFHEIV99,
 24587           DFHEIV99
 24588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24589
 24590
 24591 9800-LINK-PENDING-EDIT.
 24592     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24593     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24594
 24595     MOVE LINK-EL050             TO PGM-NAME
 24596     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24597     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24598                                    WK-CO-TOL-CLAIM
 24599                                    WK-CO-TOL-PREM
 24600                                    WK-CO-TOL-REFUND
 24601                                    WK-CO-TOL-PREM-PCT
 24602                                    WK-CO-TOL-REFUND-PCT
 24603                                    WK-REFUND-OVS-AMT
 24604                                    WK-REFUND-OVS-PCT
 24605                                    WK-ACCT-ADDR
 24606                                    WK-LIFE-EDIT-ADDR
 24607                                    WK-AH-EDIT-ADDR
 24608                                    WK-LIFE-BEN-ADDR
 24609                                    WK-AH-BEN-ADDR
 24610                                    WK-STATE-ADDR
 24611                                    WK-PLAN-ADDR
 24612                                    WK-FORM-ADDR
 24613     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24614
 24615     MOVE '6'                    TO WK-ENTRY-SW.
 24616
 24617     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24618
 24619     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24620                                    EC-AM-EXPIRATION-DT
 24621                                    EC-AM-EFFECTIVE-DT
 24622                                    EC-CM-LF-CANCEL-DT
 24623                                    EC-CM-AH-CANCEL-DT
 24624                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 455
* EL6311.cbl
 24625
 24626     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24627                                    EC-CO-TOL-REFUND
 24628                                    EC-CO-MIN-AGE
 24629                                    EC-CO-MIN-PREMIUM
 24630                                    EC-CO-MIN-TERM
 24631                                    EC-CO-MAX-TERM
 24632                                    EC-ST-TOL-PREM
 24633                                    EC-ST-TOL-REFUND
 24634                                    EC-AM-LF-TOL-PREM
 24635                                    EC-AM-AH-TOL-PREM
 24636                                    EC-AM-LF-MAX-ATT-AGE
 24637                                    EC-AM-LF-MAX-AGE
 24638                                    EC-AM-LF-MAX-TERM
 24639                                    EC-AM-LF-MAX-TOT-BEN
 24640                                    EC-AM-AH-MAX-ATT-AGE
 24641                                    EC-AM-AH-MAX-AGE
 24642                                    EC-AM-AH-MAX-TERM
 24643                                    EC-AM-AH-MAX-TOT-BEN
 24644                                    EC-AM-AH-MAX-MON-BEN
 24645                                    EC-RT-LF-MAX-ATT-AGE
 24646                                    EC-RT-LF-MAX-AGE
 24647                                    EC-RT-LF-MAX-TERM
 24648                                    EC-RT-LF-MAX-TOT-BEN
 24649                                    EC-RT-AH-MAX-ATT-AGE
 24650                                    EC-RT-AH-MAX-AGE
 24651                                    EC-RT-AH-MAX-TERM
 24652                                    EC-RT-AH-MAX-TOT-BEN
 24653                                    EC-RT-AH-MAX-MON-BEN
 24654                                    EC-RT-AH-RATE
 24655                                    EC-RT-LF-RATE
 24656                                    EC-RT-LF-NSP-RATE
 24657                                    EC-RT-AH-NSP-RATE
 24658                                    EC-CM-LF-PRIOR-REFUND
 24659                                    EC-CM-AH-PRIOR-REFUND.
 24660
 24661     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24662                                    EC-ST-TOL-PREM-PCT
 24663                                    EC-AM-LF-TOL-REFUND
 24664                                    EC-AM-LF-DEV-PERCENT
 24665                                    EC-CO-TOL-REFUND-PCT
 24666                                    EC-ST-TOL-REFUND-PCT
 24667                                    EC-AM-AH-TOL-REFUND
 24668                                    EC-AM-AH-DEV-PERCENT.
 24669
 24670
 24671* EXEC CICS LINK
 24672*         PROGRAM   (PGM-NAME)
 24673*         COMMAREA  (PASSED-RECORD)
 24674*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24675*    END-EXEC.
 24676*    MOVE '."C                   (   #00020704' TO DFHEIV0
 24677     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24678     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24679     MOVE X'2020233030303230373034' TO DFHEIV0(25:11)
 24680     CALL 'kxdfhei1' USING DFHEIV0,
 24681           PGM-NAME,
 24682           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 456
* EL6311.cbl
 24683           WS-EDIT-PASS-LENGTH,
 24684           DFHEIV99,
 24685           DFHEIV99,
 24686           DFHEIV99,
 24687           DFHEIV99
 24688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24689
 24690
 24691     MOVE '1'                    TO PI-EDIT-SW.
 24692     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24693
 24694     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24695
 24696     IF PI-COMPANY-ID = 'UCL'
 24697         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24698
 24699     IF VALID-PB-ID
 24700        GO TO 9800-EXIT.
 24701
 24702     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24703
 24704     IF PI-MAP-NAME = EL631B
 24705        MOVE -1                  TO BMAINTL
 24706       ELSE
 24707        MOVE -1                  TO CMAINTL.
 24708
 24709     GO TO 8200-SEND-DATAONLY.
 24710
 24711 9800-EXIT.
 24712      EXIT.
 24713
 24714 9900-ERROR-FORMAT.
 24715
 24716     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24717
 24718     IF NOT EMI-ERRORS-COMPLETE
 24719         MOVE LINK-EL001         TO PGM-NAME
 24720
 24721* EXEC CICS LINK
 24722*            PROGRAM    (PGM-NAME)
 24723*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24724*            LENGTH     (EMI-COMM-LENGTH)
 24725*        END-EXEC.
 24726*    MOVE '."C                   (   #00020739' TO DFHEIV0
 24727     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24728     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24729     MOVE X'2020233030303230373339' TO DFHEIV0(25:11)
 24730     CALL 'kxdfhei1' USING DFHEIV0,
 24731           PGM-NAME,
 24732           ERROR-MESSAGE-INTERFACE-BLOCK,
 24733           EMI-COMM-LENGTH,
 24734           DFHEIV99,
 24735           DFHEIV99,
 24736           DFHEIV99,
 24737           DFHEIV99
 24738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24739
 24740
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 457
* EL6311.cbl
 24741 9900-EXIT.
 24742     EXIT.
 24743
 24744 9990-ABEND.
 24745     MOVE LINK-EL004             TO PGM-NAME.
 24746     MOVE DFHEIBLK               TO EMI-LINE1.
 24747
 24748* EXEC CICS LINK
 24749*        PROGRAM   (PGM-NAME)
 24750*        COMMAREA  (EMI-LINE1)
 24751*        LENGTH    (72)
 24752*    END-EXEC.
 24753     MOVE 72
 24754       TO DFHEIV11
 24755*    MOVE '."C                   (   #00020751' TO DFHEIV0
 24756     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24757     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24758     MOVE X'2020233030303230373531' TO DFHEIV0(25:11)
 24759     CALL 'kxdfhei1' USING DFHEIV0,
 24760           PGM-NAME,
 24761           EMI-LINE1,
 24762           DFHEIV11,
 24763           DFHEIV99,
 24764           DFHEIV99,
 24765           DFHEIV99,
 24766           DFHEIV99
 24767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24768
 24769
 24770     IF PI-MAP-NAME = EL631B
 24771        MOVE -1                  TO BMAINTL
 24772       ELSE
 24773        MOVE -1                  TO CMAINTL.
 24774
 24775     IF EIBTRNID NOT = TRANS-EXB1
 24776        GO TO 8100-SEND-INITIAL-MAP
 24777       ELSE
 24778        GO TO 8200-SEND-DATAONLY.
 24779
 24780 9995-SECURITY-VIOLATION.
 24781*                            COPY ELCSCTP.
 24782******************************************************************
 24783*                                                                *
 24784*                            ELCSCTP                             *
 24785*                            VMOD=2.001                          *
 24786*                                                                *
 24787*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24788******************************************************************
 24789
 24790
 24791     MOVE EIBDATE          TO SM-JUL-DATE.
 24792     MOVE EIBTRMID         TO SM-TERMID.
 24793     MOVE THIS-PGM         TO SM-PGM.
 24794     MOVE EIBTIME          TO TIME-IN.
 24795     MOVE TIME-OUT         TO SM-TIME.
 24796     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24797
 24798
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 458
* EL6311.cbl
 24799* EXEC CICS LINK
 24800*         PROGRAM  ('EL003')
 24801*         COMMAREA (SECURITY-MESSAGE)
 24802*         LENGTH   (80)
 24803*    END-EXEC.
 24804     MOVE 'EL003' TO DFHEIV1
 24805     MOVE 80
 24806       TO DFHEIV11
 24807*    MOVE '."C                   (   #00020785' TO DFHEIV0
 24808     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24809     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24810     MOVE X'2020233030303230373835' TO DFHEIV0(25:11)
 24811     CALL 'kxdfhei1' USING DFHEIV0,
 24812           DFHEIV1,
 24813           SECURITY-MESSAGE,
 24814           DFHEIV11,
 24815           DFHEIV99,
 24816           DFHEIV99,
 24817           DFHEIV99,
 24818           DFHEIV99
 24819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24820
 24821
 24822******************************************************************
 24823
 24824
 24825 9999-DFHBACK SECTION.
 24826     MOVE '9%                    "   ' TO DFHEIV0
 24827     MOVE 'EL6311' TO DFHEIV1
 24828     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24829     GOBACK.
 24830 9999-DFHEXIT.
 24831     IF DFHEIGDJ EQUAL 0001
 24832         NEXT SENTENCE
 24833     ELSE IF DFHEIGDJ EQUAL 2
 24834         GO TO 9600-PGMID-ERROR,
 24835               9990-ABEND,
 24836               9990-ABEND,
 24837               0010-MAIN-LOGIC
 24838         DEPENDING ON DFHEIGDI
 24839     ELSE IF DFHEIGDJ EQUAL 3
 24840         GO TO 1280-BATCH-HDR-NOT-FOUND
 24841         DEPENDING ON DFHEIGDI
 24842     ELSE IF DFHEIGDJ EQUAL 4
 24843         GO TO 1290-DUPLICATE-ALT-INDEX
 24844         DEPENDING ON DFHEIGDI
 24845     ELSE IF DFHEIGDJ EQUAL 5
 24846         GO TO 1295-CERT-TRL-REC-NOTFND
 24847         DEPENDING ON DFHEIGDI
 24848     ELSE IF DFHEIGDJ EQUAL 6
 24849         GO TO 1380-BATCH-HDR-NOT-FOUND
 24850         DEPENDING ON DFHEIGDI
 24851     ELSE IF DFHEIGDJ EQUAL 7
 24852         GO TO 1385-REC-NOT-FOUND
 24853         DEPENDING ON DFHEIGDI
 24854     ELSE IF DFHEIGDJ EQUAL 8
 24855         GO TO 1386-NOTFND
 24856         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 459
* EL6311.cbl
 24857     ELSE IF DFHEIGDJ EQUAL 9
 24858         GO TO 1399-EXIT
 24859         DEPENDING ON DFHEIGDI
 24860     ELSE IF DFHEIGDJ EQUAL 10
 24861         GO TO 1480-BATCH-HDR-NOT-FOUND
 24862         DEPENDING ON DFHEIGDI
 24863     ELSE IF DFHEIGDJ EQUAL 11
 24864         GO TO 1490-RECORD-NOT-FOUND
 24865         DEPENDING ON DFHEIGDI
 24866     ELSE IF DFHEIGDJ EQUAL 12
 24867         GO TO 1405-DELETE-CERTIFICATE
 24868         DEPENDING ON DFHEIGDI
 24869     ELSE IF DFHEIGDJ EQUAL 13
 24870         GO TO 1420-CONTINUE-DELETE
 24871         DEPENDING ON DFHEIGDI
 24872     ELSE IF DFHEIGDJ EQUAL 14
 24873         GO TO 1406-DELETE-ERNOTE
 24874         DEPENDING ON DFHEIGDI
 24875     ELSE IF DFHEIGDJ EQUAL 15
 24876         GO TO 1407-DELETE-MAILING
 24877         DEPENDING ON DFHEIGDI
 24878     ELSE IF DFHEIGDJ EQUAL 16
 24879         GO TO 1420-CONTINUE-DELETE
 24880         DEPENDING ON DFHEIGDI
 24881     ELSE IF DFHEIGDJ EQUAL 17
 24882         GO TO 1480-BATCH-HDR-NOT-FOUND
 24883         DEPENDING ON DFHEIGDI
 24884     ELSE IF DFHEIGDJ EQUAL 18
 24885         GO TO 1475-DELETE-FINISHED
 24886         DEPENDING ON DFHEIGDI
 24887     ELSE IF DFHEIGDJ EQUAL 19
 24888         GO TO 2280-BATCH-HDR-NOT-FOUND
 24889         DEPENDING ON DFHEIGDI
 24890     ELSE IF DFHEIGDJ EQUAL 20
 24891         GO TO 2290-DUPLICATE-ALT-INDEX
 24892         DEPENDING ON DFHEIGDI
 24893     ELSE IF DFHEIGDJ EQUAL 21
 24894         GO TO 2380-BATCH-HDR-NOT-FOUND
 24895         DEPENDING ON DFHEIGDI
 24896     ELSE IF DFHEIGDJ EQUAL 22
 24897         GO TO 2385-REC-NOT-FOUND
 24898         DEPENDING ON DFHEIGDI
 24899     ELSE IF DFHEIGDJ EQUAL 23
 24900         GO TO 2380-BATCH-HDR-NOT-FOUND
 24901         DEPENDING ON DFHEIGDI
 24902     ELSE IF DFHEIGDJ EQUAL 24
 24903         GO TO 2485-BATCH-HDR-NOT-FOUND
 24904         DEPENDING ON DFHEIGDI
 24905     ELSE IF DFHEIGDJ EQUAL 25
 24906         GO TO 2490-RECORD-NOT-FOUND
 24907         DEPENDING ON DFHEIGDI
 24908     ELSE IF DFHEIGDJ EQUAL 26
 24909         GO TO 2475-CONTINUE-DELETE
 24910         DEPENDING ON DFHEIGDI
 24911     ELSE IF DFHEIGDJ EQUAL 27
 24912         GO TO 2485-BATCH-HDR-NOT-FOUND
 24913         DEPENDING ON DFHEIGDI
 24914     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 460
* EL6311.cbl
 24915         GO TO 2480-DELETE-FINISHED
 24916         DEPENDING ON DFHEIGDI
 24917     ELSE IF DFHEIGDJ EQUAL 29
 24918         GO TO 2820-PROCESS-REWRITE
 24919         DEPENDING ON DFHEIGDI
 24920     ELSE IF DFHEIGDJ EQUAL 30
 24921         GO TO 2885-RECORD-MISSING
 24922         DEPENDING ON DFHEIGDI
 24923     ELSE IF DFHEIGDJ EQUAL 31
 24924         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24925         DEPENDING ON DFHEIGDI
 24926     ELSE IF DFHEIGDJ EQUAL 32
 24927         GO TO 2827-DELETE-MAILING
 24928         DEPENDING ON DFHEIGDI
 24929     ELSE IF DFHEIGDJ EQUAL 33
 24930         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24931         DEPENDING ON DFHEIGDI
 24932     ELSE IF DFHEIGDJ EQUAL 34
 24933         GO TO 2920-PROCESS-REWRITE
 24934         DEPENDING ON DFHEIGDI
 24935     ELSE IF DFHEIGDJ EQUAL 35
 24936         GO TO 2985-RECORD-MISSING
 24937         DEPENDING ON DFHEIGDI
 24938     ELSE IF DFHEIGDJ EQUAL 36
 24939         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24940         DEPENDING ON DFHEIGDI
 24941     ELSE IF DFHEIGDJ EQUAL 37
 24942         GO TO 2990-DUPLICATE-RECORD
 24943         DEPENDING ON DFHEIGDI
 24944     ELSE IF DFHEIGDJ EQUAL 38
 24945         GO TO 3590-NOT-FOUND
 24946         DEPENDING ON DFHEIGDI
 24947     ELSE IF DFHEIGDJ EQUAL 39
 24948         GO TO 3690-NOT-FOUND
 24949         DEPENDING ON DFHEIGDI
 24950     ELSE IF DFHEIGDJ EQUAL 40
 24951         GO TO 3990-NOT-FOUND
 24952         DEPENDING ON DFHEIGDI
 24953     ELSE IF DFHEIGDJ EQUAL 41
 24954         GO TO 4050-END-RECORDS,
 24955               4050-END-RECORDS
 24956         DEPENDING ON DFHEIGDI
 24957     ELSE IF DFHEIGDJ EQUAL 42
 24958         GO TO 4150-END-BATCH
 24959         DEPENDING ON DFHEIGDI
 24960     ELSE IF DFHEIGDJ EQUAL 43
 24961         GO TO 4150-END-BATCH
 24962         DEPENDING ON DFHEIGDI
 24963     ELSE IF DFHEIGDJ EQUAL 44
 24964         GO TO 4250-END-RECORDS,
 24965               4250-END-RECORDS
 24966         DEPENDING ON DFHEIGDI
 24967     ELSE IF DFHEIGDJ EQUAL 45
 24968         GO TO 4350-END-BATCH,
 24969               4350-END-BATCH
 24970         DEPENDING ON DFHEIGDI
 24971     ELSE IF DFHEIGDJ EQUAL 46
 24972         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 461
* EL6311.cbl
 24973               4550-END-RECORDS
 24974         DEPENDING ON DFHEIGDI
 24975     ELSE IF DFHEIGDJ EQUAL 47
 24976         GO TO 4680-NOT-FOUND,
 24977               4680-NOT-FOUND
 24978         DEPENDING ON DFHEIGDI
 24979     ELSE IF DFHEIGDJ EQUAL 48
 24980         GO TO 4860-NOT-FOUND,
 24981               4850-END-RECORDS
 24982         DEPENDING ON DFHEIGDI
 24983     ELSE IF DFHEIGDJ EQUAL 49
 24984         GO TO 4970-NOT-FOUND,
 24985               4950-END-RECORDS
 24986         DEPENDING ON DFHEIGDI
 24987     ELSE IF DFHEIGDJ EQUAL 50
 24988         GO TO 5050-NOT-FOUND
 24989         DEPENDING ON DFHEIGDI
 24990     ELSE IF DFHEIGDJ EQUAL 51
 24991         GO TO 5050-NOT-FOUND
 24992         DEPENDING ON DFHEIGDI
 24993     ELSE IF DFHEIGDJ EQUAL 52
 24994         GO TO 5050-NOT-FOUND
 24995         DEPENDING ON DFHEIGDI
 24996     ELSE IF DFHEIGDJ EQUAL 53
 24997         GO TO 5550-END-RECORDS,
 24998               5550-END-RECORDS
 24999         DEPENDING ON DFHEIGDI
 25000     ELSE IF DFHEIGDJ EQUAL 54
 25001         GO TO 6050-QID-ERROR
 25002         DEPENDING ON DFHEIGDI
 25003     ELSE IF DFHEIGDJ EQUAL 55
 25004         GO TO 6050-QID-ERROR
 25005         DEPENDING ON DFHEIGDI
 25006     ELSE IF DFHEIGDJ EQUAL 56
 25007         GO TO 6400-CONTINUE,
 25008               6400-CONTINUE
 25009         DEPENDING ON DFHEIGDI
 25010     ELSE IF DFHEIGDJ EQUAL 57
 25011         GO TO 3690-NOT-FOUND
 25012         DEPENDING ON DFHEIGDI
 25013     ELSE IF DFHEIGDJ EQUAL 58
 25014         GO TO 7399-EXIT
 25015         DEPENDING ON DFHEIGDI
 25016     ELSE IF DFHEIGDJ EQUAL 59
 25017         GO TO 7550-OFFICER-NOTFND
 25018         DEPENDING ON DFHEIGDI
 25019     ELSE IF DFHEIGDJ EQUAL 60
 25020         GO TO 8300-SEND-TEXT
 25021         DEPENDING ON DFHEIGDI.
 25022     MOVE '9%                    "   ' TO DFHEIV0
 25023     MOVE 'EL6311' TO DFHEIV1
 25024     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25025     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15276     Code:       99072
