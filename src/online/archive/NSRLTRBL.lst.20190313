* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page   1
* NSRLTRBL.cbl
* Options: int("NSRLTRBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRLTRBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRLTRBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "NSRLTRBL.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSRLTRBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSREQLTR
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page   2
* NSRLTRBL.cbl
    14* 121802    2009122800001  PEMA  NEW PROGRAM
    15* 022212    2011120900003  AJRA  ADD AHL
    16* 031912    2011120900003  AJRA  ADD AHL CLAIM NO TO EXTRACT
    17* 020513    2011090100001  PEMA  CORRECT ISS WITH MULT &
    18* 020613    2012110800002  AJRA  ADD BUS TYPE (GPCD) TO NAPERSOFT
    19* 031116    2015110400001  TANA  ADD EL150D FIELDS
    20* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    21******************************************************************
    22 ENVIRONMENT DIVISION.
    23 DATA DIVISION.
    24 working-storage section.
    25 01  DFH-START PIC X(04).
    26 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    27 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    28 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    29 77  S1                          PIC S999 COMP-3 VALUE +0.
    30 77  S2                          PIC S999 COMP-3 VALUE +0.
    31 77  S3                          PIC S999 COMP-3 VALUE +0.
    32 77  E1                          PIC S999 COMP-3 VALUE +0.
    33 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    34 77  M1                          PIC S999 COMP-3 VALUE +0.
    35 77  P1                          PIC S999 COMP-3 VALUE +0.
    36 77  WS-HOLD-KEY                 PIC X(20).
    37 77  WS-HOLD-S1                  PIC S999 COMP-3 VALUE +0.
    38 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    39 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    40 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    41 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    42 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    43 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    44 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    45 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    46 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    47 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    48     88  FOUND-BENE                  VALUE 'Y'.
    49 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    50 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    51 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    52 77  WS-CNTR                     pic s999 comp-3 value +0.
    53 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    54 77  WS-ACCUM-DAYS               PIC S9(5) COMP-3 VALUE +0.
    55 77  WS-ACCUM-AMT                PIC S9(9)V99 COMP-3 VALUE +0.
    56 77  WS-ACCUM-PD-BENS            PIC S999 COMP-3 VALUE +0.
    57 77  WS-PREV-CLM-TYPE            PIC X   VALUE ' '.
    58 77  WS-PREV-INS-TYPE            PIC X   VALUE ' '.
    59 77  WS-PREV-BEN-PER             PIC 99 VALUE ZEROS.
    60 77  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
    61     88  PDEF-FOUND                   VALUE 'Y'.
    62 77  wk1                         pic 999 value zeros.
    63 77  wk2                         pic 999 value zeros.
    64 77  WS-WORK-BEN-PCT             PIC S9V999 COMP-3 VALUE +0.
    65 77  WS-MAX-SUB                  PIC 9(4)    VALUE ZEROS.
    66 01  OUTPUT-SCREEN-WORK-AREA.
    67     05  OS-PREV-KEY.
    68         10  OS-PREV-CLM-TYPE        PIC X.
    69         10  OS-PREV-INS-TYPE        PIC X.
    70     05  WS-PD-BENS                  PIC 999 VALUE ZEROS.
    71     05  WS-COV-REM-BENS             PIC S999 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page   3
* NSRLTRBL.cbl
    72 01  WS-XML-WORK                 PIC X(2500)  VALUE SPACES.
    73 01 response-code         pic s9(8) comp.
    74 01 display-response      pic 9(8).
    75 01 bl-index              pic 9(8) comp.
    76 01 max-last-name         pic x(18).
    77 01 first-initial         pic x.
    78 01 name-in-range-flag    pic 9.
    79 01 max-entries           pic s9(8) comp value 100.
    80 01 lower-case    pic x(26) value
    81            "abcdefghijklmnopqrstuvwxyz".
    82 01 upper-case    pic x(26) value
    83            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
    84 01  W-Z-CONTROL-DATA.
    85     05  W-NUMBER-OF-COPIES  PIC  9(01).
    86     05  FILLER              PIC  X(01).
    87     05  W-DAYS-TO-FOLLOW-UP PIC  9(03).
    88     05  FILLER              PIC  X(01).
    89     05  W-DAYS-TO-RESEND-1  PIC  9(03).
    90     05  FILLER              PIC  X(01).
    91     05  W-FORM-TO-RESEND    PIC  X(04).
    92     05  FILLER              PIC  X(01).
    93     05  W-PROMPT-LETTER     PIC  X(01).
    94     05  FILLER              PIC  X(01).
    95     05  W-ENCLOSURE-CD      PIC  X(03).
    96     05  FILLER              PIC  X(1).
    97     05  W-AUTO-CLOSE-IND    PIC  X(1).
    98     05  FILLER              PIC  X(1).
    99     05  W-LETTER-TO-BENE    PIC  X(1).
   100 01  MISC.
   101     12  WS-RESPONSE             PIC S9(8)   COMP.
   102         88  RESP-NORMAL                  VALUE +00.
   103         88  RESP-NOTFND                  VALUE +13.
   104         88  RESP-DUPREC                  VALUE +14.
   105         88  RESP-DUPKEY                  VALUE +15.
   106         88  RESP-NOTOPEN                 VALUE +19.
   107         88  RESP-ENDFILE                 VALUE +20.
   108 01  WS-ELENCC-KEY.
   109     05  WS-ELENCC-COMPANY-CD    PIC X.
   110     05  WS-ELENCC-REC-TYPE      PIC X.
   111     05  WS-ELENCC-ENC-CODE      PIC X(5).
   112     05  F                       PIC X(09).
   113 01  WS-ELMSTR-KEY.
   114     05  WS-ELMSTR-COMPANY-CD    PIC X.
   115     05  WS-ELMSTR-CARRIER       PIC X.
   116     05  WS-ELMSTR-CLAIM-NO      PIC X(7).
   117     05  WS-ELMSTR-CERT-NO       PIC X(11).
   118 01  WS-ELTRLR-KEY.
   119     05  WS-ELTRLR-COMPANY-CD    PIC X.
   120     05  WS-ELTRLR-CARRIER       PIC X.
   121     05  WS-ELTRLR-CLAIM-NO      PIC X(7).
   122     05  WS-ELTRLR-CERT-NO       PIC X(11).
   123     05  WS-ELTRLR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   124 01  WS-ELCERT-KEY.
   125     05  WS-ELCERT-COMPANY-CD    PIC X.
   126     05  WS-ELCERT-CARRIER       PIC X.
   127     05  WS-ELCERT-GROUP         PIC X(6).
   128     05  WS-ELCERT-STATE         PIC XX.
   129     05  WS-ELCERT-ACCOUNT       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page   4
* NSRLTRBL.cbl
   130     05  WS-ELCERT-EFF-DT        PIC XX.
   131     05  WS-ELCERT-CERT-NO       PIC X(11).
   132 01  WS-ERACCT-KEY.
   133     05  WS-ERACCT-COMPANY-CD    PIC X.
   134     05  WS-ERACCT-CARRIER       PIC X.
   135     05  WS-ERACCT-GROUP         PIC X(6).
   136     05  WS-ERACCT-STATE         PIC XX.
   137     05  WS-ERACCT-ACCOUNT       PIC X(10).
   138     05  WS-ERACCT-EXP-DT        PIC XX.
   139     05  FILLER                  PIC XXXX.
   140 01  WS-ELBENE-KEY.
   141     05  WS-ELBENE-COMPANY-CD    PIC X.
   142     05  WS-ELBENE-REC-TYPE      PIC X.
   143     05  WS-ELBENE-BENE          PIC X(10).
   144 01  WS-ELLETR-KEY.
   145     05  WS-ELLETR-COMPANY-CD    PIC X.
   146     05  WS-ELLETR-LETTER-ID     PIC X(12).
   147     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   148 01  WS-ELCNTL-KEY.
   149     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   150     05  WS-ELCNTL-REC-TYPE      PIC X.
   151     05  WS-ELCNTL-GENL.
   152         10  FILLER              PIC XX  VALUE SPACES.
   153         10  WS-ELCNTL-BEN-CD    PIC XX.
   154     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   155 01  ACCESS-KEYS.
   156     12  ELCRTT-KEY.
   157         16  CRTT-COMP-CD            PIC X.
   158         16  CRTT-CARRIER            PIC X.
   159         16  CRTT-GROUPING           PIC X(6).
   160         16  CRTT-STATE              PIC XX.
   161         16  CRTT-ACCOUNT            PIC X(10).
   162         16  CRTT-EFF-DT             PIC XX.
   163         16  CRTT-CERT-NO            PIC X(11).
   164         16  CRTT-REC-TYPE           PIC X.
   165
   166 01  ERPDEF-KEY-SAVE             PIC X(18).
   167 01  ERPDEF-KEY.
   168     12  ERPDEF-COMPANY-CD       PIC X.
   169     12  ERPDEF-STATE            PIC XX.
   170     12  ERPDEF-PROD-CD          PIC XXX.
   171     12  F                       PIC X(7).
   172     12  ERPDEF-BEN-TYPE         PIC X.
   173     12  ERPDEF-BEN-CODE         PIC XX.
   174     12  ERPDEF-EXP-DT           PIC XX.
   175 01  TEXT-WORK-AREAS.
   176     05  WS-COV-TYPE             PIC X(4) VALUE SPACES.
   177 01  WS-UNSORTED-TABLE.
   178     12  WS-UNSRTD-TABLE   OCCURS 25 TIMES.
   179         16  WS-KEY.
   180             20  WS-CLM-TYPE     PIC X.
   181             20  WS-INS-TYPE     PIC X.
   182             20  WS-BEN-PER      PIC 99.
   183             20  WS-INC-DT       PIC XX.
   184         16  WS-EXCL-PER         PIC 999.
   185         16  WS-COV-ENDS         PIC 999.
   186         16  WS-ACC-PER          PIC 999.
   187         16  WS-MAX-BENS         PIC 999.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page   5
* NSRLTRBL.cbl
   188         16  WS-REC-MOS          PIC 99.
   189         16  WS-MAX-EXTEN        PIC 99.
   190         16  WS-STATUS           PIC X.
   191         16  WS-PD-THRU-DT       PIC XX.
   192         16  WS-CLAIM-NO         PIC X(7).
   193         16  WS-MAX-MOBEN        PIC S9(7)V99 COMP-3.
   194         16  WS-TOTAL-PAID       PIC S9(7)V99 COMP-3.
   195         16  WS-REM-BENS         PIC 999.
   196         16  WS-SORTED-SW        PIC X.
   197 01  WS-SORTED-TABLE.
   198     12  WS-SRTD-TABLE OCCURS 25 TIMES.
   199         16  WS-SRTD-KEY.
   200             20  WS-SRTD-CLM-TYPE PIC X.
   201             20  WS-SRTD-INS-TYPE PIC X.
   202             20  WS-SRTD-BEN-PER PIC 99.
   203             20  WS-SRTD-INC-DT  PIC XX.
   204         16  WS-SRTD-EXCL-PER    PIC 999.
   205         16  WS-SRTD-COV-ENDS    PIC 999.
   206         16  WS-SRTD-ACC-PER     PIC 999.
   207         16  WS-SRTD-MAX-BENS    PIC 999.
   208         16  WS-SRTD-REC-MOS     PIC 99.
   209         16  WS-SRTD-MAX-EXTEN   PIC 99.
   210         16  WS-SRTD-STATUS      PIC X.
   211         16  WS-SRTD-PD-THRU-DT  PIC XX.
   212         16  WS-SRTD-CLAIM-NO    PIC X(7).
   213         16  WS-SRTD-MAX-MOBEN   PIC S9(7)V99 COMP-3.
   214         16  WS-SRTD-TOTAL-PAID  PIC S9(7)V99 COMP-3.
   215         16  WS-SRTD-REM-BENS    PIC 999.
   216         16  WS-SRTD-SW          PIC X.
   217 01  SAVE-ACCOUNT-MASTER         PIC X(2000) VALUE SPACES.
   218*                                COPY ELCDATE.
   219******************************************************************
   220*                                                                *
   221*                                                                *
   222*                            ELCDATE.                            *
   223*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   224*                            VMOD=2.003
   225*                                                                *
   226*                                                                *
   227*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   228*                 LENGTH = 200                                   *
   229******************************************************************
   230
   231 01  DATE-CONVERSION-DATA.
   232     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   233     12  DC-OPTION-CODE                PIC X.
   234         88  BIN-TO-GREG                VALUE ' '.
   235         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   236         88  EDIT-GREG-TO-BIN           VALUE '2'.
   237         88  YMD-GREG-TO-BIN            VALUE '3'.
   238         88  MDY-GREG-TO-BIN            VALUE '4'.
   239         88  JULIAN-TO-BIN              VALUE '5'.
   240         88  BIN-PLUS-ELAPSED           VALUE '6'.
   241         88  FIND-CENTURY               VALUE '7'.
   242         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   243         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   244         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   245         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page   6
* NSRLTRBL.cbl
   246         88  JULIAN-TO-BIN-3            VALUE 'C'.
   247         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   248         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   249         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   250         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   251         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   252         88  CHECK-LEAP-YEAR            VALUE 'H'.
   253         88  BIN-3-TO-GREG              VALUE 'I'.
   254         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   255         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   256         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   257         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   258         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   259         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   260         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   261         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   262         88  THREE-CHARACTER-BIN
   263                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   264         88  GREGORIAN-TO-BIN
   265                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   266         88  BIN-TO-GREGORIAN
   267                  VALUES ' ' '1' 'I' '8' 'G'.
   268         88  JULIAN-TO-BINARY
   269                  VALUES '5' 'C' 'E' 'F'.
   270     12  DC-ERROR-CODE                 PIC X.
   271         88  NO-CONVERSION-ERROR        VALUE ' '.
   272         88  DATE-CONVERSION-ERROR
   273                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   274         88  DATE-IS-ZERO               VALUE '1'.
   275         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   276         88  DATE-IS-INVALID            VALUE '3'.
   277         88  DATE1-GREATER-DATE2        VALUE '4'.
   278         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   279         88  DATE-INVALID-OPTION        VALUE '9'.
   280         88  INVALID-CENTURY            VALUE 'A'.
   281         88  ONLY-CENTURY               VALUE 'B'.
   282         88  ONLY-LEAP-YEAR             VALUE 'C'.
   283         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   284     12  DC-END-OF-MONTH               PIC X.
   285         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   286     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   287         88  USE-NORMAL-PROCESS         VALUE ' '.
   288         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   289         88  ADJUST-UP-100-YRS          VALUE '2'.
   290     12  FILLER                        PIC X.
   291     12  DC-CONVERSION-DATES.
   292         16  DC-BIN-DATE-1             PIC XX.
   293         16  DC-BIN-DATE-2             PIC XX.
   294         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   295         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   296                       DC-GREG-DATE-1-EDIT.
   297             20  DC-EDIT1-MONTH        PIC 99.
   298             20  SLASH1-1              PIC X.
   299             20  DC-EDIT1-DAY          PIC 99.
   300             20  SLASH1-2              PIC X.
   301             20  DC-EDIT1-YEAR         PIC 99.
   302         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   303         16  DC-GREG-DATE-2-EDIT-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page   7
* NSRLTRBL.cbl
   304                     DC-GREG-DATE-2-EDIT.
   305             20  DC-EDIT2-MONTH        PIC 99.
   306             20  SLASH2-1              PIC X.
   307             20  DC-EDIT2-DAY          PIC 99.
   308             20  SLASH2-2              PIC X.
   309             20  DC-EDIT2-YEAR         PIC 99.
   310         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   311         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   312                     DC-GREG-DATE-1-YMD.
   313             20  DC-YMD-YEAR           PIC 99.
   314             20  DC-YMD-MONTH          PIC 99.
   315             20  DC-YMD-DAY            PIC 99.
   316         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   317         16  DC-GREG-DATE-1-MDY-R REDEFINES
   318                      DC-GREG-DATE-1-MDY.
   319             20  DC-MDY-MONTH          PIC 99.
   320             20  DC-MDY-DAY            PIC 99.
   321             20  DC-MDY-YEAR           PIC 99.
   322         16  DC-GREG-DATE-1-ALPHA.
   323             20  DC-ALPHA-MONTH        PIC X(10).
   324             20  DC-ALPHA-DAY          PIC 99.
   325             20  FILLER                PIC XX.
   326             20  DC-ALPHA-CENTURY.
   327                 24 DC-ALPHA-CEN-N     PIC 99.
   328             20  DC-ALPHA-YEAR         PIC 99.
   329         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   330         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   331         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   332         16  DC-JULIAN-DATE            PIC 9(05).
   333         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   334                                       PIC 9(05).
   335         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   336             20  DC-JULIAN-YEAR        PIC 99.
   337             20  DC-JULIAN-DAYS        PIC 999.
   338         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   339         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   340         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   341     12  DATE-CONVERSION-VARIBLES.
   342         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   343         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   344             20  FILLER                PIC 9(3).
   345             20  HOLD-CEN-1-CCYY.
   346                 24  HOLD-CEN-1-CC     PIC 99.
   347                 24  HOLD-CEN-1-YY     PIC 99.
   348             20  HOLD-CEN-1-MO         PIC 99.
   349             20  HOLD-CEN-1-DA         PIC 99.
   350         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   351             20  HOLD-CEN-1-R-MO       PIC 99.
   352             20  HOLD-CEN-1-R-DA       PIC 99.
   353             20  HOLD-CEN-1-R-CCYY.
   354                 24  HOLD-CEN-1-R-CC   PIC 99.
   355                 24  HOLD-CEN-1-R-YY   PIC 99.
   356             20  FILLER                PIC 9(3).
   357         16  HOLD-CENTURY-1-X.
   358             20  FILLER                PIC X(3)  VALUE SPACES.
   359             20  HOLD-CEN-1-X-CCYY.
   360                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   361                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page   8
* NSRLTRBL.cbl
   362             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   363             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   364         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   365             20  HOLD-CEN-1-R-X-MO     PIC XX.
   366             20  HOLD-CEN-1-R-X-DA     PIC XX.
   367             20  HOLD-CEN-1-R-X-CCYY.
   368                 24  HOLD-CEN-1-R-X-CC PIC XX.
   369                 24  HOLD-CEN-1-R-X-YY PIC XX.
   370             20  FILLER                PIC XXX.
   371         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   372         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   373         16  DC-JULIAN-DATE-1          PIC 9(07).
   374         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   375             20  DC-JULIAN-1-CCYY.
   376                 24  DC-JULIAN-1-CC    PIC 99.
   377                 24  DC-JULIAN-1-YR    PIC 99.
   378             20  DC-JULIAN-DA-1        PIC 999.
   379         16  DC-JULIAN-DATE-2          PIC 9(07).
   380         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   381             20  DC-JULIAN-2-CCYY.
   382                 24  DC-JULIAN-2-CC    PIC 99.
   383                 24  DC-JULIAN-2-YR    PIC 99.
   384             20  DC-JULIAN-DA-2        PIC 999.
   385         16  DC-GREG-DATE-A-EDIT.
   386             20  DC-EDITA-MONTH        PIC 99.
   387             20  SLASHA-1              PIC X VALUE '/'.
   388             20  DC-EDITA-DAY          PIC 99.
   389             20  SLASHA-2              PIC X VALUE '/'.
   390             20  DC-EDITA-CCYY.
   391                 24  DC-EDITA-CENT     PIC 99.
   392                 24  DC-EDITA-YEAR     PIC 99.
   393         16  DC-GREG-DATE-B-EDIT.
   394             20  DC-EDITB-MONTH        PIC 99.
   395             20  SLASHB-1              PIC X VALUE '/'.
   396             20  DC-EDITB-DAY          PIC 99.
   397             20  SLASHB-2              PIC X VALUE '/'.
   398             20  DC-EDITB-CCYY.
   399                 24  DC-EDITB-CENT     PIC 99.
   400                 24  DC-EDITB-YEAR     PIC 99.
   401         16  DC-GREG-DATE-CYMD         PIC 9(08).
   402         16  DC-GREG-DATE-CYMD-R REDEFINES
   403                              DC-GREG-DATE-CYMD.
   404             20  DC-CYMD-CEN           PIC 99.
   405             20  DC-CYMD-YEAR          PIC 99.
   406             20  DC-CYMD-MONTH         PIC 99.
   407             20  DC-CYMD-DAY           PIC 99.
   408         16  DC-GREG-DATE-MDCY         PIC 9(08).
   409         16  DC-GREG-DATE-MDCY-R REDEFINES
   410                              DC-GREG-DATE-MDCY.
   411             20  DC-MDCY-MONTH         PIC 99.
   412             20  DC-MDCY-DAY           PIC 99.
   413             20  DC-MDCY-CEN           PIC 99.
   414             20  DC-MDCY-YEAR          PIC 99.
   415    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   416        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   417    12  DC-EL310-DATE                  PIC X(21).
   418    12  FILLER                         PIC X(28).
   419*                                COPY ELCMSTR.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page   9
* NSRLTRBL.cbl
   420******************************************************************
   421*                                                                *
   422*                            ELCMSTR.                            *
   423*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   424*                            VMOD=2.012                          *
   425*                                                                *
   426*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   427*                                                                *
   428*   FILE TYPE = VSAM,KSDS                                        *
   429*   RECORD SIZE = 350  RECFORM = FIXED                           *
   430*                                                                *
   431*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   432*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   433*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   434*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   435*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   436*                                                 RKP=75,LEN=21  *
   437*                                                                *
   438*   **** NOTE ****                                               *
   439*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   440*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   441*                                                                *
   442*   LOG = YES                                                    *
   443*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   444******************************************************************
   445*                   C H A N G E   L O G
   446*
   447* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   448*-----------------------------------------------------------------
   449*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   450* EFFECTIVE    NUMBER
   451*-----------------------------------------------------------------
   452* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   453* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   454* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   455* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   456* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   457* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
   458* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   459******************************************************************
   460 01  CLAIM-MASTER.
   461     12  CL-RECORD-ID                PIC XX.
   462         88  VALID-CL-ID         VALUE 'CL'.
   463
   464     12  CL-CONTROL-PRIMARY.
   465         16  CL-COMPANY-CD           PIC X.
   466         16  CL-CARRIER              PIC X.
   467         16  CL-CLAIM-NO             PIC X(7).
   468         16  CL-CERT-NO.
   469             20  CL-CERT-PRIME       PIC X(10).
   470             20  CL-CERT-SFX         PIC X.
   471
   472     12  CL-CONTROL-BY-NAME.
   473         16  CL-COMPANY-CD-A1        PIC X.
   474         16  CL-INSURED-LAST-NAME    PIC X(15).
   475         16  CL-INSURED-NAME.
   476             20  CL-INSURED-1ST-NAME PIC X(12).
   477             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  10
* NSRLTRBL.cbl
   478
   479     12  CL-CONTROL-BY-SSN.
   480         16  CL-COMPANY-CD-A2        PIC X.
   481         16  CL-SOC-SEC-NO.
   482             20  CL-SSN-STATE        PIC XX.
   483             20  CL-SSN-ACCOUNT      PIC X(6).
   484             20  CL-SSN-LN3          PIC X(3).
   485
   486     12  CL-CONTROL-BY-CERT-NO.
   487         16  CL-COMPANY-CD-A4        PIC X.
   488         16  CL-CERT-NO-A4.
   489             20  CL-CERT-A4-PRIME    PIC X(10).
   490             20  CL-CERT-A4-SFX      PIC X.
   491
   492     12  CL-CONTROL-BY-CCN.
   493         16  CL-COMPANY-CD-A5        PIC X.
   494         16  CL-CCN-A5.
   495             20  CL-CCN.
   496                 24  CL-CCN-PREFIX-A5 PIC X(4).
   497                 24  CL-CCN-PRIME-A5 PIC X(12).
   498             20  CL-CCN-FILLER-A5    PIC X(4).
   499
   500     12  CL-INSURED-PROFILE-DATA.
   501         16  CL-INSURED-BIRTH-DT     PIC XX.
   502         16  CL-INSURED-SEX-CD       PIC X.
   503             88  INSURED-IS-MALE        VALUE 'M'.
   504             88  INSURED-IS-FEMALE      VALUE 'F'.
   505             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   506         16  CL-INSURED-OCC-CD       PIC X(6).
   507         16  FILLER                  PIC X(5).
   508
   509     12  CL-PROCESSING-INFO.
   510         16  CL-PROCESSOR-ID         PIC X(4).
   511         16  CL-CLAIM-STATUS         PIC X.
   512             88  CLAIM-IS-OPEN          VALUE 'O'.
   513             88  CLAIM-IS-CLOSED        VALUE 'C'.
   514         16  CL-CLAIM-TYPE           PIC X.
   515*            88  AH-CLAIM               VALUE 'A'.
   516*            88  LIFE-CLAIM             VALUE 'L'.
   517*            88  PROPERTY-CLAIM         VALUE 'P'.
   518*            88  IUI-CLAIM              VALUE 'I'.
   519*            88  GAP-CLAIM              VALUE 'G'.
   520*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   521*            88  OTHER-CLAIM            VALUE 'O'.
   522         16  CL-CLAIM-PREM-TYPE      PIC X.
   523             88  SINGLE-PREMIUM         VALUE '1'.
   524             88  O-B-COVERAGE           VALUE '2'.
   525             88  OPEN-END-COVERAGE      VALUE '3'.
   526         16  CL-INCURRED-DT          PIC XX.
   527         16  CL-REPORTED-DT          PIC XX.
   528         16  CL-FILE-ESTABLISH-DT    PIC XX.
   529         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   530         16  CL-LAST-PMT-DT          PIC XX.
   531         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   532         16  CL-PAID-THRU-DT         PIC XX.
   533         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   534         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   535         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  11
* NSRLTRBL.cbl
   536         16  CL-PMT-CALC-METHOD      PIC X.
   537             88  CL-360-DAY-YR          VALUE '1'.
   538             88  CL-365-DAY-YR          VALUE '2'.
   539             88  CL-FULL-MONTHS         VALUE '3'.
   540         16  CL-CAUSE-CD             PIC X(6).
   541
   542         16  CL-PRIME-CERT-NO.
   543             20  CL-PRIME-CERT-PRIME PIC X(10).
   544             20  CL-PRIME-CERT-SFX   PIC X.
   545
   546         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   547             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   548             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   549
   550         16  CL-MICROFILM-NO         PIC X(10).
   551         16  FILLER REDEFINES CL-MICROFILM-NO.
   552             20  CL-BENEFIT-PERIOD   PIC 99.
   553             20  FILLER              PIC X(8).
   554         16  CL-PROG-FORM-TYPE       PIC X.
   555         16  CL-LAST-ADD-ON-DT       PIC XX.
   556
   557         16  CL-LAST-REOPEN-DT       PIC XX.
   558         16  CL-LAST-CLOSE-DT        PIC XX.
   559         16  CL-LAST-CLOSE-REASON    PIC X(01).
   560             88  FINAL-PAID             VALUE '1'.
   561             88  CLAIM-DENIED           VALUE '2'.
   562             88  AUTO-CLOSE             VALUE '3'.
   563             88  MANUAL-CLOSE           VALUE '4'.
   564             88  BENEFITS-CHANGED       VALUE 'C'.
   565             88  SETUP-ERRORS           VALUE 'E'.
   566         16  CL-ASSOC-CERT-SEQU      PIC S99.
   567         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   568         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   569             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   570         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   571         16  FILLER                  PIC X.
   572
   573     12  CL-CERTIFICATE-DATA.
   574         16  CL-CERT-ORIGIN          PIC X.
   575             88  CERT-WAS-ONLINE        VALUE '1'.
   576             88  CERT-WAS-CREATED       VALUE '2'.
   577             88  COVERAGE-WAS-ADDED     VALUE '3'.
   578         16  CL-CERT-KEY-DATA.
   579             20  CL-CERT-CARRIER     PIC X.
   580             20  CL-CERT-GROUPING    PIC X(6).
   581             20  CL-CERT-STATE       PIC XX.
   582             20  CL-CERT-ACCOUNT.
   583                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   584                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   585             20  CL-CERT-EFF-DT      PIC XX.
   586
   587     12  CL-STATUS-CONTROLS.
   588         16  CL-PRIORITY-CD          PIC X.
   589             88  CONFIDENTIAL-DATA      VALUE '8'.
   590             88  HIGHEST-PRIORITY       VALUE '9'.
   591         16  CL-SUPV-ATTN-CD         PIC X.
   592             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   593             88  SUPV-IS-REQUIRED       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  12
* NSRLTRBL.cbl
   594         16  CL-PURGED-DT            PIC XX.
   595         16  CL-RESTORED-DT          PIC XX.
   596         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   597         16  CL-NEXT-RESEND-DT       PIC XX.
   598         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   599         16  CL-CRITICAL-PERIOD      PIC 99.
   600*        16  FILLER                  PIC XX.
   601         16  CL-LAST-MAINT-DT        PIC XX.
   602         16  CL-LAST-MAINT-USER      PIC X(4).
   603         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   604         16  CL-LAST-MAINT-TYPE      PIC X.
   605             88  CLAIM-SET-UP           VALUE ' '.
   606             88  PAYMENT-MADE           VALUE '1'.
   607             88  LETTER-SENT            VALUE '2'.
   608             88  MASTER-WAS-ALTERED     VALUE '3'.
   609             88  MASTER-WAS-RESTORED    VALUE '4'.
   610             88  INCURRED-DATE-CHANGED  VALUE '5'.
   611             88  FILE-CONVERTED         VALUE '6'.
   612             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   613             88  ERROR-CORRECTION       VALUE 'E'.
   614         16  CL-RELATED-CLAIM-NO     PIC X(7).
   615         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   616         16  CL-BENEFICIARY          PIC X(10).
   617         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   618         16  CL-DENIAL-TYPE          PIC X.
   619             88  CL-TYPE-DENIAL          VALUE '1'.
   620             88  CL-TYPE-RESCISSION      VALUE '2'.
   621             88  CL-TYPE-REFORMATION     VALUE '3'.
   622             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   623             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   624         16  CL-NO-OF-EXTENSIONS     PIC 99.
   625         16  filler                  pic x(3).
   626*        16  CL-CRIT-PER-RECURRENT   PIC X.
   627*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   628*        16  CL-RTW-DT               PIC XX.
   629
   630     12  CL-TRAILER-CONTROLS.
   631         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   632             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   633             88  CL-LAST-TRL-AVAIL      VALUE +100.
   634             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   635         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   636         16  FILLER                  PIC XX.
   637         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   638         16  CL-ADDRESS-TRAILER-CNT.
   639             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   640                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   641             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   642                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   643             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   644                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   645             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   646                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   647             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   648                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   649             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   650                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   651             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  13
* NSRLTRBL.cbl
   652                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   653
   654     12  CL-CV-REFERENCE-NO.
   655         16  CL-CV-REFNO-PRIME       PIC X(18).
   656         16  CL-CV-REFNO-SFX         PIC XX.
   657
   658     12  CL-FILE-LOCATION            PIC X(4).
   659
   660     12  CL-PROCESS-ERRORS.
   661         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   662             88  NO-FATAL-ERRORS        VALUE ZERO.
   663         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   664             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   665
   666     12  CL-PRODUCT-CD               PIC X.
   667
   668     12  CL-CURRENT-KEY-DATA.
   669         16  CL-CURRENT-CARRIER      PIC X.
   670         16  CL-CURRENT-GROUPING     PIC X(6).
   671         16  CL-CURRENT-STATE        PIC XX.
   672         16  CL-CURRENT-ACCOUNT      PIC X(10).
   673
   674     12  CL-ASSOCIATES               PIC X.
   675         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   676         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   677         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   678         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   679
   680     12  CL-ACTIVITY-CODE            PIC 99.
   681     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   682     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   683
   684     12  CL-LAPSE-REPORT-CODE        PIC 9.
   685     12  CL-LAG-REPORT-CODE          PIC 9.
   686     12  CL-LOAN-TYPE                PIC XX.
   687     12  CL-LEGAL-STATE              PIC XX.
   688
   689     12  CL-YESNOSW                  PIC X.
   690     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   691         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   692         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   693         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   694     12  cl-insured-type             pic x.
   695         88  cl-claim-on-primary         value 'P'.
   696         88  cl-claim-on-co-borrower     value 'C'.
   697     12  cl-benefit-expiration-dt    PIC XX.
   698*                                COPY ELCTRLR.
   699******************************************************************
   700*                                                                *
   701*                            ELCTRLR.                            *
   702*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   703*                            VMOD=2.014                          *
   704*                                                                *
   705*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
   706*                                                                *
   707*   FILE TYPE = VSAM,KSDS                                        *
   708*   RECORD SIZE = 200    RECFORM = FIXED                         *
   709*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  14
* NSRLTRBL.cbl
   710*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
   711*       ALTERNATE INDEX = NONE                                   *
   712*                                                                *
   713*   LOG = YES                                                    *
   714*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   715******************************************************************
   716*                   C H A N G E   L O G
   717*
   718* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   719*-----------------------------------------------------------------
   720*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   721* EFFECTIVE    NUMBER
   722*-----------------------------------------------------------------
   723* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   724* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
   725* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
   726* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
   727* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
   728* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
   729* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
   730* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
   731* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
   732* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
   733* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
   734* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
   735* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
   736* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
   737* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
   738* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
   739* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
   740* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
   741* 040814    2014030500002  AJRA  ADD ICD CODES
   742* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   743* 013017  CR2016053100001  PEMA  ACH PROCESSING
   744* 062217  CR2017050300002  TANA  ADD AUTH RCVD
   745* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   746******************************************************************
   747 01  ACTIVITY-TRAILERS.
   748     12  AT-RECORD-ID                    PIC XX.
   749         88  VALID-AT-ID                       VALUE 'AT'.
   750
   751     12  AT-CONTROL-PRIMARY.
   752         16  AT-COMPANY-CD               PIC X.
   753         16  AT-CARRIER                  PIC X.
   754         16  AT-CLAIM-NO                 PIC X(7).
   755         16  AT-CERT-NO.
   756             20  AT-CERT-PRIME           PIC X(10).
   757             20  AT-CERT-SFX             PIC X.
   758         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
   759             88  AT-1ST-TRL-AVAIL             VALUE +4095.
   760             88  AT-LAST-TRL-AVAIL            VALUE +100.
   761             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
   762             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
   763             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
   764             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
   765             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
   766             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
   767             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  15
* NSRLTRBL.cbl
   768             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
   769             88  AT-DIAGNOSIS-TRL             VALUE +90.
   770             88  AT-BENEFICIARY-TRL           VALUE +91.
   771             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
   772             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
   773             88  AT-VFY-CAUSAL-STATE          VALUE +94.
   774             88  AT-ERROR-MSGS-TRL            VALUE +95.
   775
   776     12  AT-TRAILER-TYPE                 PIC X.
   777         88  RESERVE-EXPENSE-TR               VALUE '1'.
   778         88  PAYMENT-TR                       VALUE '2'.
   779         88  AUTO-PAY-TR                      VALUE '3'.
   780         88  CORRESPONDENCE-TR                VALUE '4'.
   781         88  ADDRESS-TR                       VALUE '5'.
   782         88  GENERAL-INFO-TR                  VALUE '6'.
   783         88  AUTO-PROMPT-TR                   VALUE '7'.
   784         88  DENIAL-TR                        VALUE '8'.
   785         88  INCURRED-CHG-TR                  VALUE '9'.
   786         88  FORM-CONTROL-TR                  VALUE 'A'.
   787
   788     12  AT-RECORDED-DT                  PIC XX.
   789     12  AT-RECORDED-BY                  PIC X(4).
   790     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
   791
   792     12  AT-TRAILER-BODY                 PIC X(165).
   793
   794     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
   795         16  AT-RESERVE-CONTROLS.
   796             20  AT-MANUAL-SW            PIC X.
   797                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
   798             20  AT-FUTURE-SW            PIC X.
   799                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
   800             20  AT-PTC-SW               PIC X.
   801                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
   802             20  AT-IBNR-SW              PIC X.
   803                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
   804             20  AT-PTC-LF-SW            PIC X.
   805                 88  AT-LF-PTC-USED          VALUE '1'.
   806             20  AT-CDT-ACCESS-METHOD    PIC X.
   807                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
   808                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
   809                 88  AT-CDT-INTERPOLATED     VALUE '3'.
   810             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
   811         16  AT-LAST-COMPUTED-DT         PIC XX.
   812         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
   813         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
   814         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
   815         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
   816         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
   817         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
   818         16  AT-EXPENSE-CONTROLS.
   819             20  AT-EXPENSE-METHOD       PIC X.
   820                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
   821                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
   822                 88  PERCENT-OF-PMT           VALUE '3'.
   823                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
   824             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
   825             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  16
* NSRLTRBL.cbl
   826         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
   827         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
   828
   829         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
   830         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
   831
   832*        16  FILLER                      PIC X(53).
   833         16  FILLER                      PIC X(47).
   834
   835         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
   836         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
   837
   838         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
   839             20  AT-OPEN-CLOSE-DATE      PIC XX.
   840             20  AT-OPEN-CLOSE-TYPE      PIC X.
   841*                    C = CLOSED
   842*                    O = OPEN
   843             20  AT-OPEN-CLOSE-REASON    PIC X(5).
   844*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
   845
   846     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
   847         16  AT-PAYMENT-TYPE             PIC X.
   848             88  PARTIAL-PAYMENT                VALUE '1'.
   849             88  FINAL-PAYMENT                  VALUE '2'.
   850             88  LUMP-SUM-PAYMENT               VALUE '3'.
   851             88  ADDITIONAL-PAYMENT             VALUE '4'.
   852             88  CHARGEABLE-EXPENSE             VALUE '5'.
   853             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
   854             88  VOIDED-PAYMENT                 VALUE '9'.
   855             88  TRANSFER                       VALUE 'T'.
   856             88  LIFE-INTEREST                  VALUE 'I'.
   857
   858         16  AT-CLAIM-TYPE               PIC X.
   859             88  PAID-FOR-AH                    VALUE 'A'.
   860             88  PAID-FOR-LIFE                  VALUE 'L'.
   861             88  PAID-FOR-IUI                   VALUE 'I'.
   862             88  PAID-FOR-GAP                   VALUE 'G'.
   863             88  PAID-FOR-FAM                   VALUE 'F'.
   864             88  PAID-FOR-OTH                   VALUE 'O'.
   865         16  AT-CLAIM-PREM-TYPE          PIC X.
   866             88  AT-SINGLE-PREMIUM              VALUE '1'.
   867             88  AT-O-B-COVERAGE                VALUE '2'.
   868             88  AT-OPEN-END-COVERAGE           VALUE '3'.
   869         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
   870         16  AT-CHECK-NO                 PIC X(7).
   871         16  AT-PAID-FROM-DT             PIC XX.
   872         16  AT-PAID-THRU-DT             PIC XX.
   873         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
   874         16  AT-ACH-PAYMENT              PIC X.
   875*        16  FILLER                      PIC X.
   876         16  AT-PAYEES-NAME              PIC X(30).
   877         16  AT-PAYMENT-ORIGIN           PIC X.
   878             88  ONLINE-MANUAL-PMT              VALUE '1'.
   879             88  ONLINE-AUTO-PMT                VALUE '2'.
   880             88  OFFLINE-PMT                    VALUE '3'.
   881         16  AT-CHECK-WRITTEN-DT         PIC XX.
   882         16  AT-TO-BE-WRITTEN-DT         PIC XX.
   883         16  AT-VOID-DATA.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  17
* NSRLTRBL.cbl
   884             20  AT-VOID-DT              PIC XX.
   885*00144       20  AT-VOID-REASON          PIC X(30).
   886             20  AT-VOID-REASON          PIC X(26).
   887         16  AT-PMT-APPROVED-BY          PIC X(04).
   888         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
   889         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
   890         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
   891                                         PIC S99V9(5)  COMP-3.
   892         16  AT-CREDIT-INTERFACE.
   893             20  AT-PMT-SELECT-DT        PIC XX.
   894                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
   895             20  AT-PMT-ACCEPT-DT        PIC XX.
   896                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
   897             20  AT-VOID-SELECT-DT       PIC XX.
   898                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
   899             20  AT-VOID-ACCEPT-DT       PIC XX.
   900                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
   901
   902         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
   903                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
   904                 88  CONVERSION-PAYMENT           VALUE +99999999.
   905         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
   906
   907         16  AT-FORCE-CONTROL            PIC X.
   908             88  PAYMENT-WAS-FORCED           VALUE '1'.
   909         16  AT-PREV-LAST-PMT-DT         PIC XX.
   910         16  AT-PREV-PAID-THRU-DT        PIC XX.
   911         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
   912         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
   913         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
   914         16  AT-BENEFIT-TYPE             PIC X.
   915
   916         16  AT-EXPENSE-TYPE             PIC X.
   917         16  AT-PAYMENT-APPROVAL-SW      PIC X.
   918
   919         16  AT-PAYEE-TYPE-CD.
   920             20  AT-PAYEE-TYPE           PIC X.
   921                 88  INSURED-PAID           VALUE 'I'.
   922                 88  BENEFICIARY-PAID       VALUE 'B'.
   923                 88  ACCOUNT-PAID           VALUE 'A'.
   924                 88  OTHER-1-PAID           VALUE 'O'.
   925                 88  OTHER-2-PAID           VALUE 'Q'.
   926                 88  DOCTOR-PAID            VALUE 'P'.
   927                 88  EMPLOYER-PAID          VALUE 'E'.
   928             20  AT-PAYEE-SEQ            PIC X.
   929
   930         16  AT-CASH-PAYMENT             PIC X.
   931         16  AT-GROUPED-PAYMENT          PIC X.
   932         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
   933         16  AT-APPROVAL-LEVEL-REQD      PIC X.
   934         16  AT-APPROVED-LEVEL           PIC X.
   935         16  AT-VOID-TYPE                PIC X.
   936             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
   937             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
   938         16  AT-AIG-UNEMP-IND            PIC X.
   939             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
   940         16  AT-ASSOCIATES               PIC X.
   941             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  18
* NSRLTRBL.cbl
   942             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
   943
   944         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
   945         16  AT-CV-PMT-CODE              PIC X.
   946             88  FULL-DEATH-PAYMENT         VALUE '1'.
   947             88  HALF-DEATH-PAYMENT         VALUE '2'.
   948             88  FULL-ADD-PAYMENT           VALUE '3'.
   949             88  HALF-ADD-PAYMENT           VALUE '4'.
   950             88  FULL-RIDER-PAYMENT         VALUE '5'.
   951             88  HALF-RIDER-PAYMENT         VALUE '6'.
   952             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
   953             88  ADDL-PAYMENT               VALUE '8'.
   954
   955         16  AT-EOB-CODE1                PIC XXX.
   956         16  AT-EOB-CODE2                PIC XXX.
   957         16  AT-EOB-CODE3                PIC XXX.
   958         16  FILLER REDEFINES AT-EOB-CODE3.
   959             20  AT-PRINT-CLM-FORM       PIC X.
   960             20  AT-PRINT-SURVEY         PIC X.
   961             20  AT-SPECIAL-RELEASE      PIC X.
   962         16  AT-EOB-CODE4                PIC XXX.
   963         16  FILLER REDEFINES AT-EOB-CODE4.
   964             20  AT-INT-PMT-SELECT-DT    PIC XX.
   965             20  FILLER                  PIC X.
   966         16  AT-EOB-CODE5                PIC XXX.
   967         16  FILLER REDEFINES AT-EOB-CODE5.
   968             20  AT-PMT-PROOF-DT         PIC XX.
   969             20  FILLER                  PIC X.
   970
   971         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
   972             88  AT-PRINT-EOB            VALUE 'Y'.
   973
   974         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
   975         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
   976
   977     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
   978         16  AT-SCHEDULE-START-DT        PIC XX.
   979         16  AT-SCHEDULE-END-DT          PIC XX.
   980         16  AT-TERMINATED-DT            PIC XX.
   981         16  AT-LAST-PMT-TYPE            PIC X.
   982             88  LAST-PMT-IS-FINAL              VALUE 'F'.
   983             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
   984         16  AT-FIRST-PMT-DATA.
   985             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
   986             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
   987             20  AT-1ST-PAY-THRU-DT      PIC XX.
   988         16  AT-REGULAR-PMT-DATA.
   989             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
   990             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
   991             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
   992         16  AT-AUTO-PAYEE-CD.
   993             20  AT-AUTO-PAYEE-TYPE      PIC X.
   994                 88  INSURED-PAID-AUTO      VALUE 'I'.
   995                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
   996                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
   997                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
   998                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
   999             20  AT-AUTO-PAYEE-SEQ       PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  19
* NSRLTRBL.cbl
  1000         16  AT-AUTO-PAY-DAY             PIC 99.
  1001         16  AT-AUTO-CASH                PIC X.
  1002             88  AT-CASH                      VALUE 'Y'.
  1003             88  AT-NON-CASH                  VALUE 'N'.
  1004*        16  FILLER                      PIC X(129).
  1005         16  AT-AUTO-END-LETTER          PIC X(4).
  1006         16  FILLER                      PIC X(125).
  1007
  1008         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  1009         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  1010
  1011     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  1012         16  AT-LETTER-SENT-DT           PIC XX.
  1013         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  1014         16  AT-AUTO-RE-SEND-DT          PIC XX.
  1015         16  AT-LETTER-ANSWERED-DT       PIC XX.
  1016         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  1017         16  AT-LETTER-ORIGIN            PIC X.
  1018             88  ONLINE-CREATION              VALUE '1' '3'.
  1019             88  OFFLINE-CREATION             VALUE '2' '4'.
  1020             88  NAPER-ONLINE-CREATION        VALUE '3'.
  1021             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  1022         16  AT-STD-LETTER-FORM          PIC X(4).
  1023         16  AT-REASON-TEXT              PIC X(70).
  1024         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  1025         16  AT-ADDRESEE-TYPE            PIC X.
  1026              88  INSURED-ADDRESEE            VALUE 'I'.
  1027              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  1028              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  1029              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  1030              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  1031              88  OTHER-ADDRESEE-1            VALUE 'O'.
  1032              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  1033         16  AT-ADDRESSEE-NAME           PIC X(30).
  1034         16  AT-INITIAL-PRINT-DATE       PIC XX.
  1035         16  AT-RESEND-PRINT-DATE        PIC XX.
  1036         16  AT-CORR-SOL-UNSOL           PIC X.
  1037         16  AT-LETTER-PURGED-DT         PIC XX.
  1038*
  1039*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  1040*
  1041         16  AT-CSO-REDEFINITION.
  1042             20  AT-RESEND-LETTER-FORM   PIC X(4).
  1043             20  AT-AUTO-CLOSE-IND       PIC X(1).
  1044             20  AT-LETTER-TO-BENE       PIC X(1).
  1045             20  AT-STOP-LETTER-DT       PIC X(2).
  1046             20  AT-AUTH-RCVD            PIC X(1).
  1047             20  FILLER                  PIC X(18).
  1048*             20  FILLER                  PIC X(27).
  1049             20  AT-CSO-LETTER-STATUS    PIC X.
  1050                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  1051                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  1052                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  1053             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  1054             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  1055*
  1056*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  1057*
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  20
* NSRLTRBL.cbl
  1058*        16  FILLER                      PIC X(26).
  1059*
  1060*        16  AT-DMD-BSR-CODE             PIC X.
  1061*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  1062*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  1063*
  1064*        16  AT-DMD-LETTER-STATUS        PIC X.
  1065*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  1066*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  1067*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  1068*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  1069*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  1070
  1071         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  1072         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  1073
  1074     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  1075         16  AT-ADDRESS-TYPE             PIC X.
  1076             88  INSURED-ADDRESS               VALUE 'I'.
  1077             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  1078             88  ACCOUNT-ADDRESS               VALUE 'A'.
  1079             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  1080             88  EMPLOYER-ADDRESS              VALUE 'E'.
  1081             88  OTHER-ADDRESS-1               VALUE 'O'.
  1082             88  OTHER-ADDRESS-2               VALUE 'Q'.
  1083         16  AT-MAIL-TO-NAME             PIC X(30).
  1084         16  AT-ADDRESS-LINE-1           PIC X(30).
  1085         16  AT-ADDRESS-LINE-2           PIC X(30).
  1086         16  AT-CITY-STATE.
  1087             20  AT-CITY                 PIC X(28).
  1088             20  AT-STATE                PIC XX.
  1089         16  AT-ZIP.
  1090             20  AT-ZIP-CODE.
  1091                 24  AT-ZIP-1ST          PIC X.
  1092                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1093                 24  FILLER              PIC X(4).
  1094             20  AT-ZIP-PLUS4            PIC X(4).
  1095         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  1096             20  AT-CAN-POSTAL-1         PIC XXX.
  1097             20  AT-CAN-POSTAL-2         PIC XXX.
  1098             20  FILLER                  PIC XXX.
  1099         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  1100*         16  FILLER                      PIC X(23).
  1101         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  1102         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  1103         16  FILLER                      PIC X(13).
  1104         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  1105         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  1106
  1107     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1108         16  AT-INFO-LINE-1              PIC X(60).
  1109         16  FILLER REDEFINES AT-INFO-LINE-1.
  1110             20  AT-NOTE-ERROR-NO OCCURS 15
  1111                                         PIC X(4).
  1112         16  AT-INFO-LINE-2              PIC X(60).
  1113         16  FILLER REDEFINES AT-INFO-LINE-2.
  1114             20  AT-ICD-CODE-1           PIC X(8).
  1115             20  AT-ICD-CODE-2           PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  21
* NSRLTRBL.cbl
  1116             20  FILLER                  PIC X(44).
  1117         16  AT-INFO-TRAILER-TYPE        PIC X.
  1118             88  AT-ERRORS-NOTE          VALUE 'E'.
  1119             88  AT-PAYMENT-NOTE         VALUE 'P'.
  1120             88  AT-CALL-NOTE            VALUE 'C'.
  1121             88  AT-MAINT-NOTE           VALUE 'M'.
  1122             88  AT-CERT-CHANGE          VALUE 'X'.
  1123             88  AT-APPROVAL-NOTE        VALUE 'R'.
  1124             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  1125             88  AT-CERT-CANCELLED       VALUE 'T'.
  1126         16  AT-CALL-TYPE                PIC X.
  1127             88  AT-PHONE-CALL-IN        VALUE 'I'.
  1128             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  1129         16  AT-NOTE-CONTINUATION        PIC X.
  1130             88  AT-CONTINUED-NOTE       VALUE 'X'.
  1131         16  AT-EOB-CODES-EXIST          PIC X.
  1132             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  1133         16  FILLER                      PIC X(35).
  1134         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  1135         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  1136
  1137     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  1138         16  AT-PROMPT-LINE-1            PIC X(60).
  1139         16  AT-PROMPT-LINE-2            PIC X(60).
  1140         16  AT-PROMPT-START-DT          PIC XX.
  1141         16  AT-PROMPT-END-DT            PIC XX.
  1142         16  FILLER                      PIC X(35).
  1143         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  1144         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  1145
  1146     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1147         16  AT-DENIAL-INFO-1            PIC X(60).
  1148         16  AT-DENIAL-INFO-2            PIC X(60).
  1149         16  AT-DENIAL-DT                PIC XX.
  1150         16  AT-RETRACTION-DT            PIC XX.
  1151         16  AT-DENIAL-REASON-CODE       PIC X(4).
  1152*         16  FILLER                      PIC X(31).
  1153         16  AT-DENIAL-PROOF-DT          PIC XX.
  1154         16  FILLER                      PIC X(29).
  1155         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  1156         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  1157
  1158     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  1159         16  AT-OLD-INCURRED-DT          PIC XX.
  1160         16  AT-OLD-REPORTED-DT          PIC XX.
  1161         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  1162         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  1163         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  1164         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  1165         16  AT-OLD-PAID-THRU-DT         PIC XX.
  1166         16  AT-LAST-PMT-MADE-DT         PIC XX.
  1167         16  FILLER                      PIC X(26).
  1168         16  AT-OLD-DIAG-CODE            PIC X(6).
  1169         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  1170         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  1171         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  1172         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  1173         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  22
* NSRLTRBL.cbl
  1174         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  1175         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  1176         16  AT-OLD-ICD-CODE-1           PIC X(8).
  1177         16  AT-OLD-ICD-CODE-2           PIC X(8).
  1178         16  FILLER                      PIC X(9).
  1179         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  1180
  1181     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  1182         16  AT-FORM-SEND-ON-DT          PIC XX.
  1183         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  1184         16  AT-FORM-RE-SEND-DT          PIC XX.
  1185         16  AT-FORM-ANSWERED-DT         PIC XX.
  1186         16  AT-FORM-PRINTED-DT          PIC XX.
  1187         16  AT-FORM-REPRINT-DT          PIC XX.
  1188         16  AT-FORM-TYPE                PIC X.
  1189             88  INITIAL-FORM                  VALUE '1'.
  1190             88  PROGRESS-FORM                 VALUE '2'.
  1191         16  AT-INSTRUCT-LN-1            PIC X(28).
  1192         16  AT-INSTRUCT-LN-2            PIC X(28).
  1193         16  AT-INSTRUCT-LN-3            PIC X(28).
  1194         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  1195         16  AT-FORM-ADDRESS             PIC X.
  1196             88  FORM-TO-INSURED              VALUE 'I'.
  1197             88  FORM-TO-ACCOUNT              VALUE 'A'.
  1198             88  FORM-TO-OTHER-1              VALUE 'O'.
  1199             88  FORM-TO-OTHER-2              VALUE 'Q'.
  1200         16  AT-RELATED-1.
  1201             20 AT-REL-CARR-1            PIC X.
  1202             20 AT-REL-CLAIM-1           PIC X(7).
  1203             20 AT-REL-CERT-1            PIC X(11).
  1204         16  AT-RELATED-2.
  1205             20 AT-REL-CARR-2            PIC X.
  1206             20 AT-REL-CLAIM-2           PIC X(7).
  1207             20 AT-REL-CERT-2            PIC X(11).
  1208         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  1209         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  1210         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  1211         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  1212         16  AT-FORM-REM-PRINT-DT        PIC XX.
  1213         16  AT-STOP-FORM-DT             PIC X(2).
  1214
  1215         16  FILLER                      PIC X(09).
  1216         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  1217         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  1218******************************************************************
  1219*                                COPY ELCCERT.
  1220******************************************************************
  1221*                                                                *
  1222*                            ELCCERT.                            *
  1223*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1224*                            VMOD=2.013                          *
  1225*                                                                *
  1226*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1227*                                                                *
  1228*   FILE TYPE = VSAM,KSDS                                        *
  1229*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1230*                                                                *
  1231*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  23
* NSRLTRBL.cbl
  1232*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1233*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1234*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1235*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1236*                                                                *
  1237*   LOG = YES                                                    *
  1238*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1239******************************************************************
  1240*                   C H A N G E   L O G
  1241*
  1242* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1243*-----------------------------------------------------------------
  1244*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1245* EFFECTIVE    NUMBER
  1246*-----------------------------------------------------------------
  1247* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1248* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1249* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1250* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1251* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1252* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1253* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1254* 032612  CR2011110200001  PEMA  AHL CHANGES
  1255* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1256* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1257* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  1258******************************************************************
  1259
  1260 01  CERTIFICATE-MASTER.
  1261     12  CM-RECORD-ID                      PIC XX.
  1262         88  VALID-CM-ID                      VALUE 'CM'.
  1263
  1264     12  CM-CONTROL-PRIMARY.
  1265         16  CM-COMPANY-CD                 PIC X.
  1266         16  CM-CARRIER                    PIC X.
  1267         16  CM-GROUPING.
  1268             20  CM-GROUPING-PREFIX        PIC X(3).
  1269             20  CM-GROUPING-PRIME         PIC X(3).
  1270         16  CM-STATE                      PIC XX.
  1271         16  CM-ACCOUNT.
  1272             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1273             20  CM-ACCOUNT-PRIME          PIC X(6).
  1274         16  CM-CERT-EFF-DT                PIC XX.
  1275         16  CM-CERT-NO.
  1276             20  CM-CERT-PRIME             PIC X(10).
  1277             20  CM-CERT-SFX               PIC X.
  1278
  1279     12  CM-CONTROL-BY-NAME.
  1280         16  CM-COMPANY-CD-A1              PIC X.
  1281         16  CM-INSURED-LAST-NAME          PIC X(15).
  1282         16  CM-INSURED-INITIALS.
  1283             20  CM-INSURED-INITIAL1       PIC X.
  1284             20  CM-INSURED-INITIAL2       PIC X.
  1285
  1286     12  CM-CONTROL-BY-SSN.
  1287         16  CM-COMPANY-CD-A2              PIC X.
  1288         16  CM-SOC-SEC-NO.
  1289             20  CM-SSN-STATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  24
* NSRLTRBL.cbl
  1290             20  CM-SSN-ACCOUNT            PIC X(6).
  1291             20  CM-SSN-LN3.
  1292                 25  CM-INSURED-INITIALS-A2.
  1293                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1294                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1295                 25 CM-PART-LAST-NAME-A2         PIC X.
  1296
  1297     12  CM-CONTROL-BY-CERT-NO.
  1298         16  CM-COMPANY-CD-A4              PIC X.
  1299         16  CM-CERT-NO-A4                 PIC X(11).
  1300
  1301     12  CM-CONTROL-BY-MEMB.
  1302         16  CM-COMPANY-CD-A5              PIC X.
  1303         16  CM-MEMBER-NO.
  1304             20  CM-MEMB-STATE             PIC XX.
  1305             20  CM-MEMB-ACCOUNT           PIC X(6).
  1306             20  CM-MEMB-LN4.
  1307                 25  CM-INSURED-INITIALS-A5.
  1308                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1309                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1310                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1311
  1312     12  CM-INSURED-PROFILE-DATA.
  1313         16  CM-INSURED-FIRST-NAME.
  1314             20  CM-INSURED-1ST-INIT       PIC X.
  1315             20  FILLER                    PIC X(9).
  1316         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1317         16  CM-INSURED-SEX                PIC X.
  1318             88  CM-SEX-MALE                  VALUE 'M'.
  1319             88  CM-SEX-FEMAL                 VALUE 'F'.
  1320         16  CM-INSURED-JOINT-AGE          PIC 99.
  1321         16  CM-JOINT-INSURED-NAME.
  1322             20  CM-JT-LAST-NAME           PIC X(15).
  1323             20  CM-JT-FIRST-NAME.
  1324                 24  CM-JT-1ST-INIT        PIC X.
  1325                 24  FILLER                PIC X(9).
  1326             20  CM-JT-INITIAL             PIC X.
  1327
  1328     12  CM-LIFE-DATA.
  1329         16  CM-LF-BENEFIT-CD              PIC XX.
  1330         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1331         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1332         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1333         16  CM-LF-DEV-CODE                PIC XXX.
  1334         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1335         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1336         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1337         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1338         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1339         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1340         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1341         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1342         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1343         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1344         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1345         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1346         16  cm-temp-epiq                  pic xx.
  1347             88  EPIQ-CLASS                  value 'EQ'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  25
* NSRLTRBL.cbl
  1348*        16  FILLER                        PIC XX.
  1349
  1350     12  CM-AH-DATA.
  1351         16  CM-AH-BENEFIT-CD              PIC XX.
  1352         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1353         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1354         16  CM-AH-DEV-CODE                PIC XXX.
  1355         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1356         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1357         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1358         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1359         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1360         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1361         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1362         16  CM-AH-PAID-THRU-DT            PIC XX.
  1363             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1364         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1365         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1366         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1367         16  FILLER                        PIC X.
  1368
  1369     12  CM-LOAN-INFORMATION.
  1370         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1371         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1372                                           PIC S9(5)V99  COMP-3.
  1373         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1374         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1375         16  CM-PAY-FREQUENCY              PIC S99.
  1376         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1377         16  CM-RATE-CLASS                 PIC XX.
  1378         16  CM-BENEFICIARY                PIC X(25).
  1379         16  CM-POLICY-FORM-NO             PIC X(12).
  1380         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1381         16  CM-LAST-ADD-ON-DT             PIC XX.
  1382         16  CM-DEDUCTIBLE-AMOUNTS.
  1383             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1384             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1385         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1386             20  CM-RESIDENT-STATE         PIC XX.
  1387             20  CM-RATE-CODE              PIC X(4).
  1388             20  FILLER                    PIC XX.
  1389         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1390             20  CM-LOAN-OFFICER           PIC X(5).
  1391             20  FILLER                    PIC XXX.
  1392         16  CM-CSR-CODE                   PIC XXX.
  1393         16  CM-UNDERWRITING-CODE          PIC X.
  1394             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1395         16  CM-POST-CARD-IND              PIC X.
  1396         16  CM-REF-INTERFACE-SW           PIC X.
  1397         16  CM-PREMIUM-TYPE               PIC X.
  1398             88  CM-SING-PRM                  VALUE '1'.
  1399             88  CM-O-B-COVERAGE              VALUE '2'.
  1400             88  CM-OPEN-END                  VALUE '3'.
  1401         16  CM-IND-GRP-TYPE               PIC X.
  1402             88  CM-INDIVIDUAL                VALUE 'I'.
  1403             88  CM-GROUP                     VALUE 'G'.
  1404         16  CM-SKIP-CODE                  PIC X.
  1405             88  NO-MONTHS-SKIPPED            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  26
* NSRLTRBL.cbl
  1406             88  SKIP-JULY                    VALUE '1'.
  1407             88  SKIP-AUGUST                  VALUE '2'.
  1408             88  SKIP-SEPTEMBER               VALUE '3'.
  1409             88  SKIP-JULY-AUG                VALUE '4'.
  1410             88  SKIP-AUG-SEPT                VALUE '5'.
  1411             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1412             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1413             88  SKIP-JUNE                    VALUE '8'.
  1414             88  SKIP-JUNE-JULY               VALUE '9'.
  1415             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1416             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1417         16  CM-PAYMENT-MODE               PIC X.
  1418             88  PAY-MONTHLY                  VALUE SPACE.
  1419             88  PAY-WEEKLY                   VALUE '1'.
  1420             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1421             88  PAY-BI-WEEKLY                VALUE '3'.
  1422             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1423         16  CM-LOAN-NUMBER                PIC X(8).
  1424         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1425         16  CM-OLD-LOF                    PIC XXX.
  1426*        16  CM-LOAN-OFFICER               PIC XXX.
  1427         16  CM-REIN-TABLE                 PIC XXX.
  1428         16  CM-SPECIAL-REIN-CODE          PIC X.
  1429         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1430         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1431         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1432
  1433     12  CM-STATUS-DATA.
  1434         16  CM-ENTRY-STATUS               PIC X.
  1435         16  CM-ENTRY-DT                   PIC XX.
  1436
  1437         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1438         16  CM-LF-CANCEL-DT               PIC XX.
  1439         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1440
  1441         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1442         16  CM-LF-DEATH-DT                PIC XX.
  1443         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1444
  1445         16  CM-LF-CURRENT-STATUS          PIC X.
  1446             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1447                                                'M' '4' '5' '9'.
  1448             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1449             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1450             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1451             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1452             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1453             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1454             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1455             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1456             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1457             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1458             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1459             88  CM-LF-DECLINED               VALUE 'D'.
  1460             88  CM-LF-VOIDED                 VALUE 'V'.
  1461
  1462         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1463         16  CM-AH-CANCEL-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  27
* NSRLTRBL.cbl
  1464         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1465
  1466         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1467         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1468         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1469
  1470         16  CM-AH-CURRENT-STATUS          PIC X.
  1471             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1472                                                'M' '4' '5' '9'.
  1473             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1474             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1475             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1476             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1477             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1478             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1479             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1480             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1481             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1482             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1483             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1484             88  CM-AH-DECLINED               VALUE 'D'.
  1485             88  CM-AH-VOIDED                 VALUE 'V'.
  1486
  1487         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1488             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1489             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1490             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1491         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1492
  1493         16  CM-ENTRY-BATCH                PIC X(6).
  1494         16  CM-LF-EXIT-BATCH              PIC X(6).
  1495         16  CM-AH-EXIT-BATCH              PIC X(6).
  1496         16  CM-LAST-MONTH-END             PIC XX.
  1497
  1498     12  CM-NOTE-SW                        PIC X.
  1499         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1500         88  CERT-NOTES-PRESENT               VALUE '1'.
  1501         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1502         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1503         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1504         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1505         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1506         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1507     12  CM-COMP-EXCP-SW                   PIC X.
  1508         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1509         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1510     12  CM-INSURED-ADDRESS-SW             PIC X.
  1511         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1512         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1513
  1514*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1515     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1516     12  FILLER                            PIC X.
  1517
  1518*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1519     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1520     12  FILLER                            PIC X.
  1521*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  28
* NSRLTRBL.cbl
  1522     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  1523
  1524     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1525         88  CERT-ADDED-BATCH                 VALUE ' '.
  1526         88  CERT-ADDED-ONLINE                VALUE '1'.
  1527         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1528         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1529         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1530     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1531         88  CERT-AS-LOADED                   VALUE ' '.
  1532         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1533         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1534         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1535         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1536         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1537         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1538         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1539
  1540     12  CM-ACCOUNT-COMM-PCTS.
  1541         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1542         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1543
  1544     12  CM-USER-FIELD                     PIC X.
  1545     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1546     12  CM-CLP-STATE                      PIC XX.
  1547     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  1548     12  CM-USER-RESERVED                  PIC XXX.
  1549     12  FILLER REDEFINES CM-USER-RESERVED.
  1550         16  CM-AH-CLASS-CD                PIC XX.
  1551         16  F                             PIC X.
  1552******************************************************************
  1553*                                COPY ERCACCT.
  1554******************************************************************
  1555*                                                                *
  1556*                                                                *
  1557*                            ERCACCT                             *
  1558*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1559*                            VMOD=2.031                          *
  1560*                                                                *
  1561*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1562*                                                                *
  1563*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1564*   VSAM ACCOUNT MASTER FILES.                                   *
  1565*                                                                *
  1566*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1567*                                                                *
  1568*   FILE TYPE = VSAM,KSDS                                        *
  1569*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1570*                                                                *
  1571*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1572*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1573*                                                                *
  1574*   LOG = NO                                                     *
  1575*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1576*                                                                *
  1577*                                                                *
  1578******************************************************************
  1579*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  29
* NSRLTRBL.cbl
  1580*
  1581* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1582*-----------------------------------------------------------------
  1583*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1584* EFFECTIVE    NUMBER
  1585*-----------------------------------------------------------------
  1586* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1587* 092705    2005050300006  PEMA  ADD SPP LEASES
  1588* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1589* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1590* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1591* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1592* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1593* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1594******************************************************************
  1595
  1596 01  ACCOUNT-MASTER.
  1597     12  AM-RECORD-ID                      PIC XX.
  1598         88  VALID-AM-ID                      VALUE 'AM'.
  1599
  1600     12  AM-CONTROL-PRIMARY.
  1601         16  AM-COMPANY-CD                 PIC X.
  1602         16  AM-MSTR-CNTRL.
  1603             20  AM-CONTROL-A.
  1604                 24  AM-CARRIER            PIC X.
  1605                 24  AM-GROUPING.
  1606                     28 AM-GROUPING-PREFIX PIC XXX.
  1607                     28 AM-GROUPING-PRIME  PIC XXX.
  1608                 24  AM-STATE              PIC XX.
  1609                 24  AM-ACCOUNT.
  1610                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1611                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1612             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1613                                           PIC X(19).
  1614             20  AM-CNTRL-B.
  1615                 24  AM-EXPIRATION-DT      PIC XX.
  1616                 24  FILLER                PIC X(4).
  1617             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1618                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1619
  1620     12  AM-CONTROL-BY-VAR-GRP.
  1621         16  AM-COMPANY-CD-A1              PIC X.
  1622         16  AM-VG-CARRIER                 PIC X.
  1623         16  AM-VG-GROUPING                PIC X(6).
  1624         16  AM-VG-STATE                   PIC XX.
  1625         16  AM-VG-ACCOUNT                 PIC X(10).
  1626         16  AM-VG-DATE.
  1627             20  AM-VG-EXPIRATION-DT       PIC XX.
  1628             20  FILLER                    PIC X(4).
  1629         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1630                                           PIC 9(11)      COMP-3.
  1631     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1632         16  FILLER                        PIC X(10).
  1633         16  AM-VG-KEY3.
  1634             20  AM-VG3-ACCOUNT            PIC X(10).
  1635             20  AM-VG3-EXP-DT             PIC XX.
  1636         16  FILLER                        PIC X(4).
  1637     12  AM-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  30
* NSRLTRBL.cbl
  1638         16  AM-LAST-MAINT-DT              PIC XX.
  1639         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1640         16  AM-LAST-MAINT-USER            PIC X(4).
  1641         16  FILLER                        PIC XX.
  1642
  1643     12  AM-EFFECTIVE-DT                   PIC XX.
  1644     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1645
  1646     12  AM-PREV-DATES  COMP-3.
  1647         16  AM-PREV-EXP-DT                PIC 9(11).
  1648         16  AM-PREV-EFF-DT                PIC 9(11).
  1649
  1650     12  AM-REPORT-CODE-1                  PIC X(10).
  1651     12  AM-REPORT-CODE-2                  PIC X(10).
  1652
  1653     12  AM-CITY-CODE                      PIC X(4).
  1654     12  AM-COUNTY-PARISH                  PIC X(6).
  1655
  1656     12  AM-NAME                           PIC X(30).
  1657     12  AM-PERSON                         PIC X(30).
  1658     12  AM-ADDRS                          PIC X(30).
  1659     12  AM-CITY.
  1660         16  AM-ADDR-CITY                  PIC X(28).
  1661         16  AM-ADDR-STATE                 PIC XX.
  1662     12  AM-ZIP.
  1663         16  AM-ZIP-PRIME.
  1664             20  AM-ZIP-PRI-1ST            PIC X.
  1665                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1666             20  FILLER                    PIC X(4).
  1667         16  AM-ZIP-PLUS4                  PIC X(4).
  1668     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1669         16  AM-CAN-POSTAL-1               PIC XXX.
  1670         16  AM-CAN-POSTAL-2               PIC XXX.
  1671         16  FILLER                        PIC XXX.
  1672     12  AM-TEL-NO.
  1673         16  AM-AREA-CODE                  PIC 999.
  1674         16  AM-TEL-PRE                    PIC 999.
  1675         16  AM-TEL-NBR                    PIC 9(4).
  1676     12  AM-TEL-LOC                        PIC X.
  1677         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1678         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1679
  1680     12  AM-COMM-STRUCTURE.
  1681         16  AM-DEFN-1.
  1682             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1683                 24  AM-AGT.
  1684                     28  AM-AGT-PREFIX     PIC X(4).
  1685                     28  AM-AGT-PRIME      PIC X(6).
  1686                 24  AM-COM-TYP            PIC X.
  1687                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1688                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1689                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1690                 24  AM-RECALC-LV-INDIC    PIC X.
  1691                 24  AM-RETRO-LV-INDIC     PIC X.
  1692                 24  AM-GL-CODES           PIC X.
  1693                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1694                 24  FILLER                PIC X(01).
  1695         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  31
* NSRLTRBL.cbl
  1696             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1697                 24  FILLER                PIC X(11).
  1698                 24  AM-L-COMA             PIC XXX.
  1699                 24  AM-J-COMA             PIC XXX.
  1700                 24  AM-A-COMA             PIC XXX.
  1701                 24  FILLER                PIC X(6).
  1702
  1703     12  AM-COMM-CHANGE-STATUS             PIC X.
  1704         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1705
  1706     12  AM-CSR-CODE                       PIC X(4).
  1707
  1708     12  AM-BILLING-STATUS                 PIC X.
  1709         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1710         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1711     12  AM-AUTO-REFUND-SW                 PIC X.
  1712         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1713         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1714     12  AM-GPCD                           PIC 99.
  1715     12  AM-IG                             PIC X.
  1716         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1717         88  AM-HAS-GROUP                     VALUE '2'.
  1718     12  AM-STATUS                         PIC X.
  1719         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1720         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1721         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1722         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1723         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1724         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1725         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1726         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1727         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1728         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1729     12  AM-REMIT-TO                       PIC 99.
  1730     12  AM-ID-NO                          PIC X(11).
  1731
  1732     12  AM-CAL-TABLE                      PIC XX.
  1733     12  AM-LF-DEVIATION                   PIC XXX.
  1734     12  AM-AH-DEVIATION                   PIC XXX.
  1735     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1736     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1737     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1738     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1739     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1740     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1741
  1742     12  AM-USER-FIELDS.
  1743         16  AM-FLD-1                      PIC XX.
  1744         16  AM-FLD-2                      PIC XX.
  1745         16  AM-FLD-3                      PIC XX.
  1746         16  AM-FLD-4                      PIC XX.
  1747         16  AM-FLD-5                      PIC XX.
  1748
  1749     12  AM-1ST-PROD-DATE.
  1750         16  AM-1ST-PROD-YR                PIC XX.
  1751         16  AM-1ST-PROD-MO                PIC XX.
  1752         16  AM-1ST-PROD-DA                PIC XX.
  1753     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  32
* NSRLTRBL.cbl
  1754     12  AM-CERTS-PURGED-DATE.
  1755         16  AM-PUR-YR                     PIC XX.
  1756         16  AM-PUR-MO                     PIC XX.
  1757         16  AM-PUR-DA                     PIC XX.
  1758     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1759     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1760     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1761     12  AM-INACTIVE-DATE.
  1762         16  AM-INA-MO                     PIC 99.
  1763         16  AM-INA-DA                     PIC 99.
  1764         16  AM-INA-YR                     PIC 99.
  1765     12  AM-AR-HI-CERT-DATE                PIC XX.
  1766
  1767     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1768     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1769
  1770     12  AM-OB-PAYMENT-MODE                PIC X.
  1771         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1772         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1773         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1774         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1775
  1776     12  AM-AH-ONLY-INDICATOR              PIC X.
  1777         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1778         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1779
  1780     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1781
  1782     12  AM-OVER-SHORT.
  1783         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1784         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1785
  1786     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1787     12  AM-DCC-CLP-STATE                  PIC XX.
  1788
  1789     12  AM-RECALC-COMM                    PIC X.
  1790     12  AM-RECALC-REIN                    PIC X.
  1791
  1792     12  AM-REI-TABLE                      PIC XXX.
  1793     12  AM-REI-ET-LF                      PIC X.
  1794     12  AM-REI-ET-AH                      PIC X.
  1795     12  AM-REI-PE-LF                      PIC X.
  1796     12  AM-REI-PE-AH                      PIC X.
  1797     12  AM-REI-PRT-ST                     PIC X.
  1798     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1799     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1800     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1801     12  AM-REI-GROUP-A                    PIC X(6).
  1802     12  AM-REI-MORT                       PIC X(4).
  1803     12  AM-REI-PRT-OW                     PIC X.
  1804     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1805     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1806     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1807     12  AM-REI-GROUP-B                    PIC X(6).
  1808
  1809     12  AM-TRUST-TYPE                     PIC X(2).
  1810
  1811     12  AM-EMPLOYER-STMT-USED             PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  33
* NSRLTRBL.cbl
  1812     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1813
  1814     12  AM-STD-AH-TYPE                    PIC XX.
  1815     12  AM-EARN-METHODS.
  1816         16  AM-EARN-METHOD-R              PIC X.
  1817             88 AM-REF-RL-R78                 VALUE 'R'.
  1818             88 AM-REF-RL-PR                  VALUE 'P'.
  1819             88 AM-REF-RL-MEAN                VALUE 'M'.
  1820             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1821         16  AM-EARN-METHOD-L              PIC X.
  1822             88 AM-REF-LL-R78                 VALUE 'R'.
  1823             88 AM-REF-LL-PR                  VALUE 'P'.
  1824             88 AM-REF-LL-MEAN                VALUE 'M'.
  1825             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1826         16  AM-EARN-METHOD-A              PIC X.
  1827             88 AM-REF-AH-R78                 VALUE 'R'.
  1828             88 AM-REF-AH-PR                  VALUE 'P'.
  1829             88 AM-REF-AH-MEAN                VALUE 'M'.
  1830             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1831             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1832             88 AM-REF-AH-NET                 VALUE 'N'.
  1833
  1834     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1835     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1836     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1837
  1838     12  AM-RET-Y-N                        PIC X.
  1839     12  AM-RET-P-E                        PIC X.
  1840     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1841     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1842     12  AM-RET-GRP                        PIC X(6).
  1843     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1844         16  AM-POOL-PRIME                 PIC XXX.
  1845         16  AM-POOL-SUB                   PIC XXX.
  1846     12  AM-RETRO-EARNINGS.
  1847         16  AM-RET-EARN-R                 PIC X.
  1848         16  AM-RET-EARN-L                 PIC X.
  1849         16  AM-RET-EARN-A                 PIC X.
  1850     12  AM-RET-ST-TAX-USE                 PIC X.
  1851         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1852         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1853     12  AM-RETRO-BEG-EARNINGS.
  1854         16  AM-RET-BEG-EARN-R             PIC X.
  1855         16  AM-RET-BEG-EARN-L             PIC X.
  1856         16  AM-RET-BEG-EARN-A             PIC X.
  1857     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1858     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1859
  1860     12  AM-USER-SELECT-OPTIONS.
  1861         16  AM-USER-SELECT-1              PIC X(10).
  1862         16  AM-USER-SELECT-2              PIC X(10).
  1863         16  AM-USER-SELECT-3              PIC X(10).
  1864         16  AM-USER-SELECT-4              PIC X(10).
  1865         16  AM-USER-SELECT-5              PIC X(10).
  1866
  1867     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1868
  1869     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  34
* NSRLTRBL.cbl
  1870
  1871     12  AM-RPT045A-SWITCH                 PIC X.
  1872         88  RPT045A-OFF                   VALUE 'N'.
  1873
  1874     12  AM-INSURANCE-LIMITS.
  1875         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1876         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1877
  1878     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1879         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1880
  1881     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1882         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1883         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1884
  1885     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1886
  1887     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1888     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1889     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1890     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1891     12  AM-DCC-UEF-STATE                  PIC XX.
  1892     12  FILLER                            PIC XXX.
  1893     12  AM-REPORT-CODE-3                  PIC X(10).
  1894*    12  FILLER                            PIC X(22).
  1895
  1896     12  AM-RESERVE-DATE.
  1897         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1898         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1899         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1900
  1901     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1902     12  AM-NOTIFICATION-TYPES.
  1903         16  AM-NOTIF-OF-LETTERS           PIC X.
  1904         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1905         16  AM-NOTIF-OF-REPORTS           PIC X.
  1906         16  AM-NOTIF-OF-STATUS            PIC X.
  1907
  1908     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1909         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1910         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1911         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1912         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1913
  1914     12  AM-BENEFIT-CONTROLS.
  1915         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1916             20  AM-BENEFIT-CODE           PIC XX.
  1917             20  AM-BENEFIT-TYPE           PIC X.
  1918             20  AM-BENEFIT-REVISION       PIC XXX.
  1919             20  AM-BENEFIT-REM-TERM       PIC X.
  1920             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1921             20  FILLER                    PIC XX.
  1922         16  FILLER                        PIC X(80).
  1923
  1924     12  AM-TRANSFER-DATA.
  1925         16  AM-TRANSFERRED-FROM.
  1926             20  AM-TRNFROM-CARRIER        PIC X.
  1927             20  AM-TRNFROM-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  35
* NSRLTRBL.cbl
  1928                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1929                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1930             20  AM-TRNFROM-STATE          PIC XX.
  1931             20  AM-TRNFROM-ACCOUNT.
  1932                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1933                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1934             20  AM-TRNFROM-DTE            PIC XX.
  1935         16  AM-TRANSFERRED-TO.
  1936             20  AM-TRNTO-CARRIER          PIC X.
  1937             20  AM-TRNTO-GROUPING.
  1938                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1939                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1940             20  AM-TRNTO-STATE            PIC XX.
  1941             20  AM-TRNTO-ACCOUNT.
  1942                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1943                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1944             20  AM-TRNTO-DTE              PIC XX.
  1945         16  FILLER                        PIC X(10).
  1946
  1947     12  AM-SAVED-REMIT-TO                 PIC 99.
  1948
  1949     12  AM-COMM-STRUCTURE-SAVED.
  1950         16  AM-DEFN-1-SAVED.
  1951             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1952                 24  AM-AGT-SV             PIC X(10).
  1953                 24  AM-COM-TYP-SV         PIC X.
  1954                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1955                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1956                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1957                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1958                 24  FILLER                PIC X.
  1959                 24  AM-GL-CODES-SV        PIC X.
  1960                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1961                 24  FILLER                PIC X.
  1962         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1963             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1964                 24  FILLER                PIC X(11).
  1965                 24  AM-L-COMA-SV          PIC XXX.
  1966                 24  AM-J-COMA-SV          PIC XXX.
  1967                 24  AM-A-COMA-SV          PIC XXX.
  1968                 24  FILLER                PIC X(6).
  1969
  1970     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1971         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1972            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1973            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1974            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1975
  1976     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1977     12  FILLER                            PIC X(120).
  1978
  1979     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1980         16  AM-CONTROL-NAME               PIC X(30).
  1981         16  AM-EXECUTIVE-ONE.
  1982             20  AM-EXEC1-NAME             PIC X(15).
  1983             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1984                                                          COMP-3.
  1985             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  36
* NSRLTRBL.cbl
  1986                                                          COMP-3.
  1987         16  AM-EXECUTIVE-TWO.
  1988             20  AM-EXEC2-NAME             PIC X(15).
  1989             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1990                                                          COMP-3.
  1991             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1992                                                          COMP-3.
  1993
  1994     12  AM-RETRO-ADDITIONAL-DATA.
  1995         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1996         16  AM-RETRO-PREM-P-E             PIC X.
  1997         16  AM-RETRO-CLMS-P-I             PIC X.
  1998         16  AM-RETRO-RET-BRACKET-LF.
  1999             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2000                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2001                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2002             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2003                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2004                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2005             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2006                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2007                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2008         16  AM-RETRO-RET-BRACKET-AH.
  2009             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2010                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2011                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2012                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2013             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2014                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2015                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2016             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2017                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2018                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2019
  2020     12  AM-COMMENTS.
  2021         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2022
  2023     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2024         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2025         16  AM-FLI-BILLING-CODE           PIC X.
  2026         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2027         16  AM-FLI-UNITED-IDENT           PIC X.
  2028         16  AM-FLI-INTEREST-LOST-DATA.
  2029             20  AM-FLI-BANK-NO            PIC X(5).
  2030             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2031             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2032             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2033         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2034             20  AM-FLI-AGT                PIC X(9).
  2035             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2036             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2037         16  FILLER                        PIC X(102).
  2038
  2039     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2040         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2041             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2042             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2043             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  37
* NSRLTRBL.cbl
  2044             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2045             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2046         16  FILLER                          PIC X(10).
  2047******************************************************************
  2048*                                COPY ELCBENE.
  2049******************************************************************
  2050*                                                                *
  2051*                            ELCBENE.                            *
  2052*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2053*                            VMOD=2.006                          *
  2054*                                                                *
  2055*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  2056*                                                                *
  2057*   FILE TYPE = VSAM,KSDS                                        *
  2058*   RECORD SIZE = 500   RECFORM = FIX                            *
  2059*                                                                *
  2060*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  2061*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  2062*                                                                *
  2063*   LOG = YES                                                    *
  2064*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2065*                                                                *
  2066*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  2067******************************************************************
  2068*                   C H A N G E   L O G
  2069*
  2070* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2071*-----------------------------------------------------------------
  2072*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2073* EFFECTIVE    NUMBER
  2074*-----------------------------------------------------------------
  2075* 013017  CR2016053100001  PEMA  ACH PROCESSING
  2076* 082317  CR2017082100003  PEMA  Add sub type
  2077******************************************************************
  2078
  2079 01  BENEFICIARY-MASTER.
  2080     12  BE-RECORD-ID                PIC XX.
  2081         88  VALID-BE-ID                VALUE 'BE'.
  2082
  2083     12  BE-CONTROL-PRIMARY.
  2084         16  BE-COMPANY-CD           PIC X.
  2085         16  BE-RECORD-TYPE          PIC X.
  2086             88  BENEFICIARY-RECORD  VALUE 'B'.
  2087             88  ADJUSTOR-RECORD     VALUE 'A'.
  2088         16  BE-BENEFICIARY          PIC X(10).
  2089     12  BE-CONTROL-BY-NAME.
  2090         16  BE-COMPANY-CD-A1        PIC X.
  2091         16  BE-RECORD-TYPE-A1       PIC X.
  2092         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  2093         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  2094
  2095     12  BE-LAST-MAINT-DT            PIC XX.
  2096     12  BE-LAST-MAINT-BY            PIC X(4).
  2097     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  2098
  2099     12  BE-ADDRESS-DATA.
  2100         16  BE-MAIL-TO-NAME         PIC X(30).
  2101         16  BE-ADDRESS-LINE-1       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  38
* NSRLTRBL.cbl
  2102         16  BE-ADDRESS-LINE-2       PIC X(30).
  2103         16  BE-ADDRESS-LINE-3       PIC X(30).
  2104         16  BE-CITY-STATE.
  2105             20  BE-CITY             PIC X(28).
  2106             20  BE-STATE            PIC XX.
  2107         16  BE-ZIP-CODE.
  2108             20  BE-ZIP-PRIME.
  2109                 24  BE-ZIP-1ST      PIC X.
  2110                     88  BE-CANADIAN-POST-CODE
  2111                                         VALUE 'A' THRU 'Z'.
  2112                 24  FILLER          PIC X(4).
  2113             20  BE-ZIP-PLUS4        PIC X(4).
  2114         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  2115             20  BE-CAN-POSTAL-1     PIC XXX.
  2116             20  BE-CAN-POSTAL-2     PIC XXX.
  2117             20  FILLER              PIC XXX.
  2118         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  2119         16  BE-GROUP-CHECKS-Y-N     PIC X.
  2120
  2121******************************************************************
  2122*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  2123*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  2124******************************************************************
  2125     12  BE-CARRIER                  PIC X.
  2126
  2127     12  BE-ADDRESS-DATA2.
  2128         16  BE-MAIL-TO-NAME2        PIC X(30).
  2129         16  BE-ADDRESS-LINE-12      PIC X(30).
  2130         16  BE-ADDRESS-LINE-22      PIC X(30).
  2131         16  BE-ADDRESS-LINE-32      PIC X(30).
  2132         16  BE-CITY-STATE2.
  2133             20  BE-CITY2            PIC X(28).
  2134             20  BE-STATE2           PIC XX.
  2135         16  BE-ZIP-CODE2.
  2136             20  BE-ZIP-PRIME2.
  2137                 24  BE-ZIP-1ST2     PIC X.
  2138                     88  BE-CANADIAN-POST-CODE2
  2139                                         VALUE 'A' THRU 'Z'.
  2140                 24  FILLER          PIC X(4).
  2141             20  BE-ZIP-PLUS42       PIC X(4).
  2142         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  2143             20  BE-CAN-POSTAL-12    PIC XXX.
  2144             20  BE-CAN-POSTAL-22    PIC XXX.
  2145             20  FILLER              PIC XXX.
  2146         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  2147         16  BE-ACH-DATA.
  2148             20  BE-ACH-YES-OR-NO    PIC X.
  2149                 88  BE-ON-ACH       VALUE 'Y'.
  2150                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  2151             20  BE-ACH-ABA-ROUTING-NUMBER
  2152                                     PIC X(15).
  2153             20  BE-ACH-BANK-ACCOUNT-NUMBER
  2154                                     PIC X(20).
  2155             20  BE-ACH-SUB-TYPE     PIC XX.
  2156             20  FILLER              PIC X(23).
  2157         16  BE-BILLING-STMT-DATA.
  2158*            20  BE-BSR              PIC X.
  2159*                88  BE-AUTOMATED-BSR      VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  39
* NSRLTRBL.cbl
  2160*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  2161*            20  BE-BSR-FROM         PIC X(30).
  2162*            20  BE-BSR-DEPT         PIC X(30).
  2163             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  2164             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  2165             20  BE-OUTPUT-TYPE      PIC X.
  2166                 88  BE-FAX-OUTPUT         VALUE 'F'.
  2167                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  2168
  2169     12  FILLER                      PIC X(28).
  2170******************************************************************
  2171*                                COPY ELCTEXT.
  2172******************************************************************
  2173*                                                                *
  2174*                                                                *
  2175*                            ELCTEXT.                            *
  2176*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2177*                            VMOD=2.008                          *
  2178*                                                                *
  2179*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  2180*                                     FORM LETTERS,              *
  2181*                                     CERT FORM DISPLAY.
  2182*                                                                *
  2183*   FILE TYPE = VSAM,KSDS                                        *
  2184*   RECORD SIZE = 100   RECFORM = FIXED                          *
  2185*                                                                *
  2186*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  2187*       ALTERNATE INDEX = NONE                                   *
  2188*                                                                *
  2189*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  2190*       ALTERNATE INDEX = NONE                                   *
  2191*                                                                *
  2192*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  2193*       ALTERNATE INDEX = NONE                                   *
  2194*                                                                *
  2195*   LOG = NO                                                     *
  2196*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2197******************************************************************
  2198 01  TEXT-FILES.
  2199     12  TEXT-FILE-ID                PIC XX.
  2200         88  FORMS-FILE-TEXT            VALUE 'TF'.
  2201         88  LETTER-FILE-TEXT           VALUE 'TL'.
  2202         88  HELP-FILE-TEXT             VALUE 'TH'.
  2203
  2204     12  TX-CONTROL-PRIMARY.
  2205         16  TX-COMPANY-CD           PIC X.
  2206             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  2207         16  TX-ACCESS-CD-GENL       PIC X(12).
  2208
  2209         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2210             20  TX-LETTER-NO        PIC X(4).
  2211             20  FILLER              PIC X(8).
  2212
  2213         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2214             20  TX-FORM-NO          PIC X(12).
  2215
  2216         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2217             20  TX-HELP-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  40
* NSRLTRBL.cbl
  2218                 88  HELP-FOR-GENERAL   VALUE ' '.
  2219                 88  HELP-BY-SCREEN     VALUE 'S'.
  2220                 88  HELP-BY-ERROR      VALUE 'E'.
  2221             20  TX-SCREEN-OR-ERROR  PIC X(4).
  2222                 88  GENERAL-INFO-HELP  VALUE '0000'.
  2223             20  TX-HELP-FOR-COMPANY  PIC XXX.
  2224                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  2225             20  FILLER              PIC X(4).
  2226
  2227         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  2228
  2229     12  TX-PROCESS-CONTROL          PIC XX.
  2230         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  2231
  2232     12  TX-TEXT-LINE                PIC X(70).
  2233
  2234     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  2235         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  2236         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  2237         88  TX-VALID-FORM-SQUEEZE-VALUE
  2238                                        VALUE 'Y' ' '.
  2239
  2240     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  2241         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  2242         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  2243         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  2244         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  2245         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  2246         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  2247         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  2248                                              'K' 'N' ' '
  2249                                              'Z'.
  2250
  2251     12  TX-ARCHIVE-SW               PIC X.
  2252         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  2253         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  2254         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  2255
  2256     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  2257     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  2258
  2259     12  TX-BSR-CODE                 PIC X.
  2260         88  TX-BSR-LETTER              VALUE 'B'.
  2261         88  TX-NON-BSR-LETTER          VALUE ' '.
  2262
  2263     12  FILLER                      PIC X.
  2264*****************************************************************
  2265*                                COPY ELCCNTL.
  2266******************************************************************
  2267*                                                                *
  2268*                                                                *
  2269*                            ELCCNTL.                            *
  2270*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2271*                            VMOD=2.059                          *
  2272*                                                                *
  2273*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2274*                                                                *
  2275*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  41
* NSRLTRBL.cbl
  2276*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2277*                                                                *
  2278*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2279*       ALTERNATE INDEX = NONE                                   *
  2280*                                                                *
  2281*   LOG = YES                                                    *
  2282*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2283******************************************************************
  2284*                   C H A N G E   L O G
  2285*
  2286* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2287*-----------------------------------------------------------------
  2288*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2289* EFFECTIVE    NUMBER
  2290*-----------------------------------------------------------------
  2291* 082503                   PEMA  ADD BENEFIT GROUP
  2292* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2293* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2294* 092705    2005050300006  PEMA  ADD SPP LEASES
  2295* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2296* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2297* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2298* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2299* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2300* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2301* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2302* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2303* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2304* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2305* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2306******************************************************************
  2307*
  2308 01  CONTROL-FILE.
  2309     12  CF-RECORD-ID                       PIC XX.
  2310         88  VALID-CF-ID                        VALUE 'CF'.
  2311
  2312     12  CF-CONTROL-PRIMARY.
  2313         16  CF-COMPANY-ID                  PIC XXX.
  2314         16  CF-RECORD-TYPE                 PIC X.
  2315             88  CF-COMPANY-MASTER              VALUE '1'.
  2316             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2317             88  CF-STATE-MASTER                VALUE '3'.
  2318             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2319             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2320             88  CF-CARRIER-MASTER              VALUE '6'.
  2321             88  CF-MORTALITY-MASTER            VALUE '7'.
  2322             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2323             88  CF-TERMINAL-MASTER             VALUE '9'.
  2324             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2325             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2326             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2327             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2328             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2329             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2330             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2331             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2332             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2333         16  CF-ACCESS-CD-GENL              PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  42
* NSRLTRBL.cbl
  2334         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2335             20  CF-PROCESSOR               PIC X(4).
  2336         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2337             20  CF-STATE-CODE              PIC XX.
  2338             20  FILLER                     PIC XX.
  2339         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2340             20  FILLER                     PIC XX.
  2341             20  CF-HI-BEN-IN-REC           PIC XX.
  2342         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2343             20  FILLER                     PIC XXX.
  2344             20  CF-CARRIER-CNTL            PIC X.
  2345         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2346             20  FILLER                     PIC XX.
  2347             20  CF-HI-TYPE-IN-REC          PIC 99.
  2348         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2349             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2350                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2351             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2352             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2353         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2354             20  FILLER                     PIC X.
  2355             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2356         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2357             20  FILLER                     PIC XX.
  2358             20  CF-MORTGAGE-PLAN           PIC XX.
  2359         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2360
  2361     12  CF-LAST-MAINT-DT                   PIC XX.
  2362     12  CF-LAST-MAINT-BY                   PIC X(4).
  2363     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2364
  2365     12  CF-RECORD-BODY                     PIC X(728).
  2366
  2367
  2368****************************************************************
  2369*             COMPANY MASTER RECORD                            *
  2370****************************************************************
  2371
  2372     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2373         16  CF-COMPANY-ADDRESS.
  2374             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2375             20  CF-CL-IN-CARE-OF           PIC X(30).
  2376             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2377             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2378             20  CF-CL-CITY-STATE           PIC X(30).
  2379             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2380             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2381         16  CF-COMPANY-CD                  PIC X.
  2382         16  CF-COMPANY-PASSWORD            PIC X(8).
  2383         16  CF-SECURITY-OPTION             PIC X.
  2384             88  ALL-SECURITY                   VALUE '1'.
  2385             88  COMPANY-VERIFY                 VALUE '2'.
  2386             88  PROCESSOR-VERIFY               VALUE '3'.
  2387             88  NO-SECURITY                    VALUE '4'.
  2388             88  ALL-BUT-TERM                   VALUE '5'.
  2389         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2390             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2391         16  CF-LGX-INTERFACE-CNTL          PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  43
* NSRLTRBL.cbl
  2392             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2393         16  CF-INFORCE-LOCATION            PIC X.
  2394             88  CERTS-ARE-ONLINE               VALUE '1'.
  2395             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2396             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2397         16  CF-LOWER-CASE-LETTERS          PIC X.
  2398         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2399             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2400             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2401             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2402             88  CF-ACCNT-CNTL                  VALUE '3'.
  2403             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2404
  2405         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2406         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2407
  2408         16  CF-LGX-CREDIT-USER             PIC X.
  2409             88  CO-IS-NOT-USER                 VALUE 'N'.
  2410             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2411
  2412         16 CF-CREDIT-CALC-CODES.
  2413             20  CF-CR-REM-TERM-CALC PIC X.
  2414               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2415               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2416               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2417               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2418               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2419               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2420               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2421             20  CF-CR-R78-METHOD           PIC X.
  2422               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2423               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2424
  2425         16  CF-CLAIM-CONTROL-COUNTS.
  2426             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2427                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2428
  2429             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2430                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2431
  2432             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2433                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2434
  2435             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2436                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2437
  2438         16  CF-CURRENT-MONTH-END           PIC XX.
  2439
  2440         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2441             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2442             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2443             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2444             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2445                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2446                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2447             20  CF-CO-PREM-REJECT-SW       PIC X.
  2448                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2449                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  44
* NSRLTRBL.cbl
  2450             20  CF-CO-REF-REJECT-SW        PIC X.
  2451                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2452                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2453
  2454         16  CF-CO-REPORTING-DT             PIC XX.
  2455         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2456         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2457           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2458           88  CF-CO-MONTH-END                  VALUE '1'.
  2459
  2460         16  CF-LGX-CLAIM-USER              PIC X.
  2461             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2462             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2463
  2464         16  CF-CREDIT-EDIT-CONTROLS.
  2465             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2466             20  CF-MIN-AGE                 PIC 99.
  2467             20  CF-DEFAULT-AGE             PIC 99.
  2468             20  CF-MIN-TERM                PIC S999      COMP-3.
  2469             20  CF-MAX-TERM                PIC S999      COMP-3.
  2470             20  CF-DEFAULT-SEX             PIC X.
  2471             20  CF-JOINT-AGE-INPUT         PIC X.
  2472                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2473             20  CF-BIRTH-DATE-INPUT        PIC X.
  2474                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2475             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2476                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2477                 88  CF-ZERO-CARRIER            VALUE '1'.
  2478                 88  CF-ZERO-GROUPING           VALUE '2'.
  2479                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2480             20  CF-EDIT-SW                 PIC X.
  2481                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2482             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2483             20  CF-CR-PR-METHOD            PIC X.
  2484               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2485               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2486             20  FILLER                     PIC X.
  2487
  2488         16  CF-CREDIT-MISC-CONTROLS.
  2489             20  CF-REIN-TABLE-SW           PIC X.
  2490                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2491             20  CF-COMP-TABLE-SW           PIC X.
  2492                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2493             20  CF-EXPERIENCE-RETENTION-AGE
  2494                                            PIC S9        COMP-3.
  2495             20  CF-CONVERSION-DT           PIC XX.
  2496             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2497             20  CF-RUN-FREQUENCY-SW        PIC X.
  2498                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2499                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2500
  2501             20  CF-CR-CHECK-NO-CONTROL.
  2502                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2503                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2504                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2505                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2506                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2507                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  45
* NSRLTRBL.cbl
  2508
  2509                 24  CF-CR-CHECK-COUNT       REDEFINES
  2510                     CF-CR-CHECK-COUNTER      PIC X(4).
  2511
  2512                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2513                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2514
  2515                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2516                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2517                 24  CF-MAIL-PROCESSING       PIC X.
  2518                     88  MAIL-PROCESSING          VALUE 'Y'.
  2519
  2520         16  CF-MISC-SYSTEM-CONTROL.
  2521             20  CF-SYSTEM-C                 PIC X.
  2522                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2523             20  CF-SYSTEM-D                 PIC X.
  2524                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2525             20  CF-SOC-SEC-NO-SW            PIC X.
  2526                 88  SOC-SEC-NO-USED             VALUE '1'.
  2527             20  CF-MEMBER-NO-SW             PIC X.
  2528                 88  MEMBER-NO-USED              VALUE '1'.
  2529             20  CF-TAX-ID-NUMBER            PIC X(11).
  2530             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2531             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2532                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2533                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2534                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2535                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2536             20  CF-SYSTEM-E                 PIC X.
  2537                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2538
  2539         16  CF-LGX-LIFE-USER               PIC X.
  2540             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2541             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2542
  2543         16  CF-CR-MONTH-END-DT             PIC XX.
  2544
  2545         16  CF-FILE-MAINT-DATES.
  2546             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2547                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2548             20  CF-LAST-BATCH       REDEFINES
  2549                 CF-LAST-BATCH-NO               PIC X(4).
  2550             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2551             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2552             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2553             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2554             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2555             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2556             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2557             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2558             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2559             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2560
  2561         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2562         16  FILLER                         PIC X.
  2563
  2564         16  CF-ALT-MORT-CODE               PIC X(4).
  2565         16  CF-MEMBER-CAPTION              PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  46
* NSRLTRBL.cbl
  2566
  2567         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2568             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2569             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2570             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2571             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2572             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2573
  2574         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2575
  2576         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2577         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2578         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2579         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2580
  2581         16  CF-AH-OVERRIDE-L1              PIC X.
  2582         16  CF-AH-OVERRIDE-L2              PIC XX.
  2583         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2584         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2585
  2586         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2587         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2588
  2589         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2590         16  CF-AR-LAST-EL860-DT            PIC XX.
  2591         16  CF-MP-MONTH-END-DT             PIC XX.
  2592
  2593         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2594         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2595             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2596
  2597         16  CF-AR-MONTH-END-DT             PIC XX.
  2598
  2599         16  CF-CRDTCRD-USER                PIC X.
  2600             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2601             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2602
  2603         16  CF-CC-MONTH-END-DT             PIC XX.
  2604
  2605         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2606
  2607         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2608             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2609             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2610             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2611         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2612         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2613         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2614         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2615             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2616             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2617         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2618         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2619         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2620             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2621         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2622
  2623         16  CF-CL-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  47
* NSRLTRBL.cbl
  2624             20  CF-CL-ZIP-PRIME.
  2625                 24  CF-CL-ZIP-1ST          PIC X.
  2626                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2627                 24  FILLER                 PIC X(4).
  2628             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2629         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2630             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2631             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2632             20  FILLER                     PIC XXX.
  2633
  2634         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2635         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2636         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2637         16  CF-CO-OPTION-START-DATE        PIC XX.
  2638         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2639           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2640                                                      '3' '4'.
  2641           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2642           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2643           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2644           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2645           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2646           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2647
  2648         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2649
  2650         16  CF-PAYMENT-APPROVAL-LEVELS.
  2651             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2652             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2653             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2654             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2655             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2656             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2657
  2658         16  CF-END-USER-REPORTING-USER     PIC X.
  2659             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2660             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2661
  2662         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2663             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2664             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2665
  2666         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2667
  2668         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2669         16  FILLER                         PIC X.
  2670
  2671         16  CF-CREDIT-ARCHIVE-CNTL.
  2672             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2673             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2674             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2675
  2676         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2677
  2678         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2679             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2680             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2681
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  48
* NSRLTRBL.cbl
  2682         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2683             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2684             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2685
  2686         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2687
  2688         16  CF-CO-ACH-ID-CODE              PIC  X.
  2689             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2690             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2691             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2692         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2693         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2694         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2695         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2696         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2697         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2698         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2699         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2700         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2701                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2702         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2703                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2704
  2705         16  CF-CO-OVER-SHORT.
  2706             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2707             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2708
  2709*         16  FILLER                         PIC X(102).
  2710         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2711             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2712             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2713
  2714         16  CF-AH-APPROVAL-DAYS.
  2715             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2716             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2717             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2718             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2719
  2720         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2721
  2722         16  CF-APPROV-LEV-5.
  2723             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2724             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2725             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2726
  2727         16  FILLER                         PIC X(68).
  2728****************************************************************
  2729*             PROCESSOR/USER RECORD                            *
  2730****************************************************************
  2731
  2732     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2733         16  CF-PROCESSOR-NAME              PIC X(30).
  2734         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2735         16  CF-PROCESSOR-TITLE             PIC X(26).
  2736         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2737                 88  MESSAGE-YES                VALUE 'Y'.
  2738                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2739
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  49
* NSRLTRBL.cbl
  2740*****************************************************
  2741****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2742****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2743****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2744****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2745*****************************************************
  2746
  2747         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2748             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2749             20  CF-APPLICATION-FORCE       PIC X.
  2750             20  CF-INDIVIDUAL-APP.
  2751                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2752                     28  CF-BROWSE-APP      PIC X.
  2753                     28  CF-UPDATE-APP      PIC X.
  2754
  2755         16  CF-CURRENT-TERM-ON             PIC X(4).
  2756         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2757             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2758             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2759             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2760             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2761             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2762             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2763             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2764         16  CF-PROCESSOR-CARRIER           PIC X.
  2765             88  NO-CARRIER-SECURITY            VALUE ' '.
  2766         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2767             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2768         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2769             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2770         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2771             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2772
  2773         16  CF-PROC-SYS-ACCESS-SW.
  2774             20  CF-PROC-CREDIT-CLAIMS-SW.
  2775                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2776                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2777                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2778                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2779             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2780                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2781                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2782             20  CF-PROC-LIFE-GNRLDGR-SW.
  2783                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2784                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2785                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2786                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2787             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2788                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2789                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2790         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2791             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2792             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2793         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2794
  2795         16  CF-APPROVAL-LEVEL                  PIC X.
  2796             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2797             88  APPROVAL-LEVEL-2                   VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  50
* NSRLTRBL.cbl
  2798             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2799             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2800             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2801
  2802         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2803
  2804         16  CF-LANGUAGE-TYPE                   PIC X.
  2805             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2806             88  CF-LANG-IS-FR                      VALUE 'F'.
  2807
  2808         16  CF-CSR-IND                         PIC X.
  2809         16  FILLER                             PIC X(239).
  2810
  2811****************************************************************
  2812*             PROCESSOR/REMINDERS RECORD                       *
  2813****************************************************************
  2814
  2815     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2816         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2817             20  CF-START-REMIND-DT         PIC XX.
  2818             20  CF-END-REMIND-DT           PIC XX.
  2819             20  CF-REMINDER-TEXT           PIC X(50).
  2820         16  FILLER                         PIC X(296).
  2821
  2822
  2823****************************************************************
  2824*             STATE MASTER RECORD                              *
  2825****************************************************************
  2826
  2827     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2828         16  CF-STATE-ABBREVIATION          PIC XX.
  2829         16  CF-STATE-NAME                  PIC X(25).
  2830         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2831         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2832             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2833             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2834             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2835             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2836                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2837                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2838             20  CF-ST-PREM-REJECT-SW       PIC X.
  2839                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2840                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2841             20  CF-ST-REF-REJECT-SW        PIC X.
  2842                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2843                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2844         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2845         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2846         16  CF-ST-REFUND-RULES.
  2847             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2848             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2849             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2850         16  CF-ST-FST-PMT-EXTENSION.
  2851             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2852             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2853                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2854                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2855                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  51
* NSRLTRBL.cbl
  2856                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2857         16  CF-ST-STATE-CALL.
  2858             20  CF-ST-CALL-UNEARNED        PIC X.
  2859             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2860             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2861         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2862             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2863             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2864         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2865         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2866         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2867         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2868         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2869         16  FILLER                         PIC X.
  2870         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2871             20  CF-ST-BENEFIT-CD           PIC XX.
  2872             20  CF-ST-BENEFIT-KIND         PIC X.
  2873                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2874                 88  CF-ST-AH-KIND              VALUE 'A'.
  2875             20  CF-ST-REM-TERM-CALC        PIC X.
  2876                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2877                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2878                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2879                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2880                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2881                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2882                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2883                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2884
  2885             20  CF-ST-REFUND-CALC          PIC X.
  2886                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2887                 88  ST-REFD-BY-R78             VALUE '1'.
  2888                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2889                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2890                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2891                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2892                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2893                 88  ST-REFD-UTAH               VALUE '7'.
  2894                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2895                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2896                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2897
  2898             20  CF-ST-EARNING-CALC         PIC X.
  2899                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2900                 88  ST-EARN-BY-R78             VALUE '1'.
  2901                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2902                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2903                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2904                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2905                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2906                 88  ST-EARN-MEAN               VALUE '8'.
  2907                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2908
  2909             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2910                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2911                 88  ST-OVRD-BY-R78             VALUE '1'.
  2912                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2913                 88  ST-OVRD-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  52
* NSRLTRBL.cbl
  2914                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2915                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2916                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2917                 88  ST-OVRD-MEAN               VALUE '8'.
  2918                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2919             20  cf-st-extra-periods        pic 9.
  2920*            20  FILLER                     PIC X.
  2921
  2922         16  CF-ST-COMMISSION-CAPS.
  2923             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2924             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2925             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2926             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2927         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2928                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2929                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  2930                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  2931
  2932         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2933
  2934         16  CF-ST-STATUTORY-INTEREST.
  2935             20  CF-ST-STAT-DATE-FROM       PIC X.
  2936                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2937                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2938             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2939             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2940             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2941             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2942             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2943
  2944         16  CF-ST-OVER-SHORT.
  2945             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2946             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2947
  2948         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2949
  2950         16  CF-ST-RT-CALC                  PIC X.
  2951
  2952         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2953         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2954         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2955         16  CF-ST-RF-LR-CALC               PIC X.
  2956         16  CF-ST-RF-LL-CALC               PIC X.
  2957         16  CF-ST-RF-LN-CALC               PIC X.
  2958         16  CF-ST-RF-AH-CALC               PIC X.
  2959         16  CF-ST-RF-CP-CALC               PIC X.
  2960*        16  FILLER                         PIC X(206).
  2961*CIDMOD         16  FILLER                         PIC X(192).
  2962         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2963             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2964         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2965         16  CF-ST-VFY-2ND-BENE             PIC X.
  2966         16  CF-ST-CAUSAL-STATE             PIC X.
  2967         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2968         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2969         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2970             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2971         16  CF-ST-NET-ONLY-STATE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  53
* NSRLTRBL.cbl
  2972             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2973         16  cf-commission-cap-required     pic x.
  2974         16  CF-ST-GA-COMMISSION-CAPS.
  2975             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  2976             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  2977             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  2978             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  2979         16  CF-ST-TOT-COMMISSION-CAPS.
  2980             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  2981             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  2982             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  2983             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  2984         16  FILLER                         PIC X(156).
  2985
  2986****************************************************************
  2987*             BENEFIT MASTER RECORD                            *
  2988****************************************************************
  2989
  2990     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2991         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2992             20  CF-BENEFIT-CODE            PIC XX.
  2993             20  CF-BENEFIT-NUMERIC  REDEFINES
  2994                 CF-BENEFIT-CODE            PIC XX.
  2995             20  CF-BENEFIT-ALPHA           PIC XXX.
  2996             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2997             20  CF-BENEFIT-COMMENT         PIC X(10).
  2998
  2999             20  CF-LF-COVERAGE-TYPE        PIC X.
  3000                 88  CF-REDUCING                VALUE 'R'.
  3001                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3002
  3003             20  CF-SPECIAL-CALC-CD         PIC X.
  3004                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3005                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3006                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3007                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3008                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3009                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3010                 88  CF-FARM-PLAN               VALUE 'F'.
  3011                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3012                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3013                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3014                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3015                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3016                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3017                 88  CF-PRUDENTIAL              VALUE 'P'.
  3018                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3019                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3020                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3021                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3022                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3023                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3024
  3025             20  CF-JOINT-INDICATOR         PIC X.
  3026                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3027
  3028*            20  FILLER                     PIC X(12).
  3029             20  cf-maximum-benefits        pic s999 comp-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  54
* NSRLTRBL.cbl
  3030             20  FILLER                     PIC X(09).
  3031             20  CF-BENEFIT-CATEGORY        PIC X.
  3032             20  CF-LOAN-TYPE               PIC X(8).
  3033
  3034             20  CF-CO-REM-TERM-CALC        PIC X.
  3035                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3036                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3037                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3038                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3039                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3040
  3041             20  CF-CO-EARNINGS-CALC        PIC X.
  3042                 88  CO-EARN-BY-R78             VALUE '1'.
  3043                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3044                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3045                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3046                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3047                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3048                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3049                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3050
  3051             20  CF-CO-REFUND-CALC          PIC X.
  3052                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3053                 88  CO-REFD-BY-R78             VALUE '1'.
  3054                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3055                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3056                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3057                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3058                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3059                 88  CO-REFD-MEAN               VALUE '8'.
  3060                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3061                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3062                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3063
  3064             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3065                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3066                 88  CO-OVRD-BY-R78             VALUE '1'.
  3067                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3068                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3069                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3070                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3071                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3072                 88  CO-OVRD-MEAN               VALUE '8'.
  3073                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3074
  3075             20  CF-CO-BEN-I-G-CD           PIC X.
  3076                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3077                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3078                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3079
  3080         16  FILLER                         PIC X(304).
  3081
  3082
  3083****************************************************************
  3084*             CARRIER MASTER RECORD                            *
  3085****************************************************************
  3086
  3087     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  55
* NSRLTRBL.cbl
  3088         16  CF-ADDRESS-DATA.
  3089             20  CF-MAIL-TO-NAME            PIC X(30).
  3090             20  CF-IN-CARE-OF              PIC X(30).
  3091             20  CF-ADDRESS-LINE-1          PIC X(30).
  3092             20  CF-ADDRESS-LINE-2          PIC X(30).
  3093             20  CF-CITY-STATE              PIC X(30).
  3094             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3095             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3096
  3097         16  CF-CLAIM-NO-CONTROL.
  3098             20  CF-CLAIM-NO-METHOD         PIC X.
  3099                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3100                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3101                 88  CLAIM-NO-SEQ               VALUE '3'.
  3102                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3103             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3104                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3105                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3106                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3107
  3108         16  CF-CHECK-NO-CONTROL.
  3109             20  CF-CHECK-NO-METHOD         PIC X.
  3110                 88  CHECK-NO-MANUAL            VALUE '1'.
  3111                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3112                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3113                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3114             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3115                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3116
  3117         16  CF-DOMICILE-STATE              PIC XX.
  3118
  3119         16  CF-EXPENSE-CONTROLS.
  3120             20  CF-EXPENSE-METHOD          PIC X.
  3121                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3122                 88  DOLLARS-PER-PMT            VALUE '2'.
  3123                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3124                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3125             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3126             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3127
  3128         16  CF-CORRESPONDENCE-CONTROL.
  3129             20  CF-LETTER-RESEND-OPT       PIC X.
  3130                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3131                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3132             20  FILLER                     PIC X(4).
  3133
  3134         16  CF-RESERVE-CONTROLS.
  3135             20  CF-MANUAL-SW               PIC X.
  3136                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3137             20  CF-FUTURE-SW               PIC X.
  3138                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3139             20  CF-PTC-SW                  PIC X.
  3140                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3141             20  CF-IBNR-SW                 PIC X.
  3142                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3143             20  CF-PTC-LF-SW               PIC X.
  3144                 88  CF-LF-PTC-USED             VALUE '1'.
  3145             20  CF-CDT-ACCESS-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  56
* NSRLTRBL.cbl
  3146                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3147                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3148                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3149             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3150
  3151         16  CF-CLAIM-CALC-METHOD           PIC X.
  3152             88  360-PLUS-MONTHS                VALUE '1'.
  3153             88  365-PLUS-MONTHS                VALUE '2'.
  3154             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3155             88  360-DAILY                      VALUE '4'.
  3156             88  365-DAILY                      VALUE '5'.
  3157
  3158         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3159         16  FILLER                         PIC X(11).
  3160
  3161         16  CF-LIMIT-AMOUNTS.
  3162             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3163             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3164             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3165             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3166             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3167             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3168             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3169             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3170             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3171             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3172
  3173         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3174         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3175         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3176
  3177         16  CF-ZIP-CODE.
  3178             20  CF-ZIP-PRIME.
  3179                 24  CF-ZIP-1ST             PIC X.
  3180                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3181                 24  FILLER                 PIC X(4).
  3182             20  CF-ZIP-PLUS4               PIC X(4).
  3183         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3184             20  CF-CAN-POSTAL-1            PIC XXX.
  3185             20  CF-CAN-POSTAL-2            PIC XXX.
  3186             20  FILLER                     PIC XXX.
  3187
  3188         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3189         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3190         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3191
  3192         16  CF-RATING-SWITCH               PIC X.
  3193             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3194             88  CF-NO-RATING                   VALUE 'N'.
  3195
  3196         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3197
  3198         16  CF-CARRIER-OVER-SHORT.
  3199             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3200             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3201
  3202         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3203         16  CF-SECPAY-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  57
* NSRLTRBL.cbl
  3204             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3205             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3206         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3207         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3208         16  FILLER                         PIC X(444).
  3209*        16  FILLER                         PIC X(452).
  3210
  3211
  3212****************************************************************
  3213*             MORTALITY MASTER RECORD                          *
  3214****************************************************************
  3215
  3216     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3217         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3218                                INDEXED BY CF-MORT-NDX.
  3219             20  CF-MORT-TABLE              PIC X(5).
  3220             20  CF-MORT-TABLE-TYPE         PIC X.
  3221                 88  CF-MORT-JOINT              VALUE 'J'.
  3222                 88  CF-MORT-SINGLE             VALUE 'S'.
  3223                 88  CF-MORT-COMBINED           VALUE 'C'.
  3224                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3225                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3226             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3227             20  CF-MORT-AGE-METHOD         PIC XX.
  3228                 88  CF-AGE-LAST                VALUE 'AL'.
  3229                 88  CF-AGE-NEAR                VALUE 'AN'.
  3230             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3231             20  CF-MORT-ADJUSTMENT-DIRECTION
  3232                                            PIC X.
  3233                 88  CF-MINUS                   VALUE '-'.
  3234                 88  CF-PLUS                    VALUE '+'.
  3235             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3236             20  CF-MORT-JOINT-CODE         PIC X.
  3237                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3238             20  CF-MORT-PC-Q               PIC X.
  3239                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3240             20  CF-MORT-TABLE-CODE         PIC X(4).
  3241             20  CF-MORT-COMMENTS           PIC X(15).
  3242             20  FILLER                     PIC X(14).
  3243
  3244         16  FILLER                         PIC X(251).
  3245
  3246
  3247****************************************************************
  3248*             BUSSINESS TYPE MASTER RECORD                     *
  3249****************************************************************
  3250
  3251     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3252* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3253* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3254* AND RECORD 05 IS TYPES 81-99
  3255         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3256             20  CF-BUSINESS-TITLE          PIC  X(19).
  3257             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3258                                            PIC S9V9(4) COMP-3.
  3259             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3260             20  FILLER                     PIC  X.
  3261         16  FILLER                         PIC  X(248).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  58
* NSRLTRBL.cbl
  3262
  3263
  3264****************************************************************
  3265*             TERMINAL MASTER RECORD                           *
  3266****************************************************************
  3267
  3268     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3269
  3270         16  CF-COMPANY-TERMINALS.
  3271             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3272                                  PIC X(4).
  3273         16  FILLER               PIC X(248).
  3274
  3275
  3276****************************************************************
  3277*             LIFE EDIT MASTER RECORD                          *
  3278****************************************************************
  3279
  3280     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3281         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3282             20  CF-LIFE-CODE-IN            PIC XX.
  3283             20  CF-LIFE-CODE-OUT           PIC XX.
  3284         16  FILLER                         PIC X(248).
  3285
  3286
  3287****************************************************************
  3288*             AH EDIT MASTER RECORD                            *
  3289****************************************************************
  3290
  3291     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3292         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3293             20  CF-AH-CODE-IN              PIC XXX.
  3294             20  CF-AH-CODE-OUT             PIC XX.
  3295         16  FILLER                         PIC X(248).
  3296
  3297
  3298****************************************************************
  3299*             CREDIBILITY TABLES                               *
  3300****************************************************************
  3301
  3302     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3303         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3304                             INDEXED BY CF-CRDB-NDX.
  3305             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3306             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3307             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3308         16  FILLER                         PIC  X(332).
  3309
  3310
  3311****************************************************************
  3312*             REPORT CUSTOMIZATION RECORD                      *
  3313****************************************************************
  3314
  3315     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3316         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3317             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3318             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3319             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  59
* NSRLTRBL.cbl
  3320**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3321****       A T-TRANSFER.                                   ****
  3322             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3323
  3324         16  FILLER                         PIC XX.
  3325
  3326         16  CF-CARRIER-CNTL-OPT.
  3327             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3328                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3329                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3330             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3331                                            PIC X.
  3332         16  CF-GROUP-CNTL-OPT.
  3333             20  CF-GROUP-OPT-SEQ           PIC 9.
  3334                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3335                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3336             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3337                                            PIC X(6).
  3338         16  CF-STATE-CNTL-OPT.
  3339             20  CF-STATE-OPT-SEQ           PIC 9.
  3340                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3341                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3342             20  CF-STATE-SELECT OCCURS 3 TIMES
  3343                                            PIC XX.
  3344         16  CF-ACCOUNT-CNTL-OPT.
  3345             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3346                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3347                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3348             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3349                                            PIC X(10).
  3350         16  CF-BUS-TYP-CNTL-OPT.
  3351             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3352                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3353                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3354             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3355                                            PIC XX.
  3356         16  CF-LF-TYP-CNTL-OPT.
  3357             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3358                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3359                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3360             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3361                                            PIC XX.
  3362         16  CF-AH-TYP-CNTL-OPT.
  3363             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3364                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3365                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3366             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3367                                            PIC XX.
  3368         16  CF-REPTCD1-CNTL-OPT.
  3369             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3370                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3371                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3372             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3373                                            PIC X(10).
  3374         16  CF-REPTCD2-CNTL-OPT.
  3375             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3376                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3377                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  60
* NSRLTRBL.cbl
  3378             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3379                                            PIC X(10).
  3380         16  CF-USER1-CNTL-OPT.
  3381             20  CF-USER1-OPT-SEQ           PIC 9.
  3382                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3383                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3384             20  CF-USER1-SELECT OCCURS 3 TIMES
  3385                                            PIC X(10).
  3386         16  CF-USER2-CNTL-OPT.
  3387             20  CF-USER2-OPT-SEQ           PIC 9.
  3388                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3389                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3390             20  CF-USER2-SELECT OCCURS 3 TIMES
  3391                                            PIC X(10).
  3392         16  CF-USER3-CNTL-OPT.
  3393             20  CF-USER3-OPT-SEQ           PIC 9.
  3394                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3395                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3396             20  CF-USER3-SELECT OCCURS 3 TIMES
  3397                                            PIC X(10).
  3398         16  CF-USER4-CNTL-OPT.
  3399             20  CF-USER4-OPT-SEQ           PIC 9.
  3400                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3401                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3402             20  CF-USER4-SELECT OCCURS 3 TIMES
  3403                                            PIC X(10).
  3404         16  CF-USER5-CNTL-OPT.
  3405             20  CF-USER5-OPT-SEQ           PIC 9.
  3406                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3407                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3408             20  CF-USER5-SELECT OCCURS 3 TIMES
  3409                                            PIC X(10).
  3410         16  CF-REINS-CNTL-OPT.
  3411             20  CF-REINS-OPT-SEQ           PIC 9.
  3412                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3413                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3414             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3415                 24  CF-REINS-PRIME         PIC XXX.
  3416                 24  CF-REINS-SUB           PIC XXX.
  3417
  3418         16  CF-AGENT-CNTL-OPT.
  3419             20  CF-AGENT-OPT-SEQ           PIC 9.
  3420                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3421                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3422             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3423                                            PIC X(10).
  3424
  3425         16  FILLER                         PIC X(43).
  3426
  3427         16  CF-LOSS-RATIO-SELECT.
  3428             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3429             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3430         16  CF-ENTRY-DATE-SELECT.
  3431             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3432             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3433         16  CF-EFFECTIVE-DATE-SELECT.
  3434             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3435             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  61
* NSRLTRBL.cbl
  3436
  3437         16  CF-EXCEPTION-LIST-IND          PIC X.
  3438             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3439
  3440         16  FILLER                         PIC X(318).
  3441
  3442****************************************************************
  3443*                  EXCEPTION REPORTING RECORD                  *
  3444****************************************************************
  3445
  3446     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3447         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3448             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3449
  3450         16  CF-COMBINED-LIFE-AH-OPT.
  3451             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3452             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3453             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3454             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3455
  3456         16  CF-LIFE-OPT.
  3457             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3458             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3459             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3460             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3461             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3462             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3463             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3464             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3465             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3466             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3467
  3468         16  CF-AH-OPT.
  3469             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3470             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3471             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3472             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3473             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3474             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3475             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3476             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3477             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3478             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3479
  3480         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3481             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3482             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3483             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3484
  3485         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3486
  3487         16  FILLER                         PIC X(673).
  3488
  3489
  3490****************************************************************
  3491*             MORTGAGE SYSTEM PLAN RECORD                      *
  3492****************************************************************
  3493
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  62
* NSRLTRBL.cbl
  3494     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3495         16  CF-PLAN-TYPE                   PIC X.
  3496             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3497             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3498             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3499         16  CF-PLAN-ABBREV                 PIC XXX.
  3500         16  CF-PLAN-DESCRIPT               PIC X(10).
  3501         16  CF-PLAN-NOTES                  PIC X(20).
  3502         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3503         16  CF-PLAN-UNDERWRITING.
  3504             20  CF-PLAN-TERM-DATA.
  3505                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3506                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3507             20  CF-PLAN-AGE-DATA.
  3508                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3509                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3510                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3511             20  CF-PLAN-BENEFIT-DATA.
  3512                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3513                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3514                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3515                                            PIC S9(7)V99  COMP-3.
  3516         16  CF-PLAN-POLICY-FORMS.
  3517             20  CF-POLICY-FORM             PIC X(12).
  3518             20  CF-MASTER-APPLICATION      PIC X(12).
  3519             20  CF-MASTER-POLICY           PIC X(12).
  3520         16  CF-PLAN-RATING.
  3521             20  CF-RATE-CODE               PIC X(5).
  3522             20  CF-SEX-RATING              PIC X.
  3523                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3524                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3525             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3526             20  CF-SUB-STD-TYPE            PIC X.
  3527                 88  CF-PCT-OF-PREM            VALUE '1'.
  3528                 88  CF-PCT-OF-BENE            VALUE '2'.
  3529         16  CF-PLAN-PREM-TOLERANCES.
  3530             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3531             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3532         16  CF-PLAN-PYMT-TOLERANCES.
  3533             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3534             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3535         16  CF-PLAN-MISC-DATA.
  3536             20  FILLER                     PIC X.
  3537             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3538             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3539         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3540         16  CF-PLAN-IND-GRP                PIC X.
  3541             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3542                                                     '1'.
  3543             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3544                                                     '2'.
  3545         16  CF-MIB-SEARCH-SW               PIC X.
  3546             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3547             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3548             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3549             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3550         16  CF-ALPHA-SEARCH-SW             PIC X.
  3551             88  CF-MIB-ALPHA-ALL              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  63
* NSRLTRBL.cbl
  3552             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3553             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3554             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3555             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3556             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3557             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3558             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3559             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3560             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3561                                                     'A' 'B' 'C'
  3562                                                     'X' 'Y' 'Z'.
  3563         16  CF-EFF-DT-RULE-SW              PIC X.
  3564             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3565             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3566             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3567             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3568             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3569         16  FILLER                         PIC X(4).
  3570         16  CF-HEALTH-QUESTIONS            PIC X.
  3571             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3572         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3573         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3574         16  CF-PLAN-SNGL-JNT               PIC X.
  3575             88  CF-COMBINED-PLAN              VALUE 'C'.
  3576             88  CF-JNT-PLAN                   VALUE 'J'.
  3577             88  CF-SNGL-PLAN                  VALUE 'S'.
  3578         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3579         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3580         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3581         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3582         16  CF-RERATE-CNTL                 PIC  X.
  3583             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3584             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3585             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3586             88  CF-AUTO-RECALC                 VALUE '4'.
  3587         16  CF-BENEFIT-TYPE                PIC  X.
  3588             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3589             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3590         16  CF-POLICY-FEE                  PIC S999V99
  3591                                                    COMP-3.
  3592         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3593         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3594         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3595         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3596         16  FILLER                         PIC  X(32).
  3597         16  CF-TERMINATION-FORM            PIC  X(04).
  3598         16  FILLER                         PIC  X(08).
  3599         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3600                                                       COMP-3.
  3601         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3602         16  CF-ISSUE-LETTER                PIC  X(4).
  3603         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3604         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3605             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3606             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3607         16  CF-MP-REFUND-CALC              PIC X.
  3608             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3609             88  CF-MP-REFD-BY-R78              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  64
* NSRLTRBL.cbl
  3610             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3611             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3612             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3613             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3614             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3615             88  CF-MP-REFD-MEAN                VALUE '8'.
  3616         16  CF-ALT-RATE-CODE               PIC  X(5).
  3617
  3618
  3619         16  FILLER                         PIC X(498).
  3620****************************************************************
  3621*             MORTGAGE COMPANY MASTER RECORD                   *
  3622****************************************************************
  3623
  3624     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3625         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3626         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3627             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3628             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3629             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3630             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3631             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3632
  3633         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3634         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3635         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3636         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3637         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3638
  3639         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3640             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3641         16  CF-MP-RECON-USE-IND            PIC X(1).
  3642             88  CF-MP-USE-RECON             VALUE 'Y'.
  3643         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3644             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3645         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3646             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3647             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3648         16  FILLER                         PIC X(1).
  3649         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3650             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3651         16  CF-MORTG-MIB-VERSION           PIC X.
  3652             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3653             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3654             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3655         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3656             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3657                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3658             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3659                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3660             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3661                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3662             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3663                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3664             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3665                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3666             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3667                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  65
* NSRLTRBL.cbl
  3668         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3669         16  FILLER                         PIC X(7).
  3670         16  CF-MORTG-DESTINATION-SYMBOL.
  3671             20  CF-MORTG-MIB-COMM          PIC X(5).
  3672             20  CF-MORTG-MIB-TERM          PIC X(5).
  3673         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3674             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3675         16  FILLER                         PIC X(03).
  3676         16  CF-MP-CHECK-NO-CONTROL.
  3677             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3678                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3679                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3680                                                ' ' LOW-VALUES.
  3681                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3682                                               VALUE '3'.
  3683         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3684         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3685         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3686             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3687                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3688             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3689                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3690             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3691                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3692             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3693                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3694             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3695                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3696             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3697                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3698         16  CF-MORTG-BILLING-AREA.
  3699             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3700                                            PIC X.
  3701         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3702         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3703         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3704         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3705             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3706             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3707         16  FILLER                         PIC X.
  3708         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3709             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3710             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3711         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3712         16  FILLER                         PIC X(8).
  3713         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3714         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3715         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3716         16  CF-ACH-COMPANY-ID.
  3717             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3718                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3719                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3720                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3721             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3722         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3723             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3724         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3725             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  66
* NSRLTRBL.cbl
  3726             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3727         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3728         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3729         16  FILLER                         PIC X(536).
  3730
  3731****************************************************************
  3732*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3733****************************************************************
  3734
  3735     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3736         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3737             20  CF-FEMALE-HEIGHT.
  3738                 24  CF-FEMALE-FT           PIC 99.
  3739                 24  CF-FEMALE-IN           PIC 99.
  3740             20  CF-FEMALE-MIN-WT           PIC 999.
  3741             20  CF-FEMALE-MAX-WT           PIC 999.
  3742         16  FILLER                         PIC X(428).
  3743
  3744     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3745         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3746             20  CF-MALE-HEIGHT.
  3747                 24  CF-MALE-FT             PIC 99.
  3748                 24  CF-MALE-IN             PIC 99.
  3749             20  CF-MALE-MIN-WT             PIC 999.
  3750             20  CF-MALE-MAX-WT             PIC 999.
  3751         16  FILLER                         PIC X(428).
  3752******************************************************************
  3753*             AUTOMATIC ACTIVITY RECORD                          *
  3754******************************************************************
  3755     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3756         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3757             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3758             20  CF-SYS-LETTER-ID           PIC X(04).
  3759             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3760             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3761             20  CF-SYS-RESET-SW            PIC X(01).
  3762             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3763             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3764
  3765         16  FILLER                         PIC X(50).
  3766
  3767         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3768             20  CF-USER-ACTIVE-SW          PIC X(01).
  3769             20  CF-USER-LETTER-ID          PIC X(04).
  3770             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3771             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3772             20  CF-USER-RESET-SW           PIC X(01).
  3773             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3774             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3775             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3776
  3777         16  FILLER                         PIC X(246).
  3778*                                COPY NSCVARS.
  3779******************************************************************
  3780*                   C H A N G E   L O G
  3781*
  3782* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3783*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  67
* NSRLTRBL.cbl
  3784*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3785* EFFECTIVE    NUMBER
  3786*-----------------------------------------------------------------
  3787* 031912    2011110200002  AJRA  AHL CLAIM NUM
  3788* 013013    2012110080002  AJRA  ADD ACCOUNT GPCD
  3789* 031116    2015110400001  TANA  ADD EL150D FIELDS
  3790* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  3791******************************************************************
  3792 01 NAPER-OUTPUT-DATA.
  3793    05 FILLER              PIC X(6) VALUE "TEMPL=".
  3794    05 OUT-TEMP            PIC X(4).
  3795    05 FILLER              PIC X(8) VALUE "&LETTER=".
  3796    05 OUT-LETTER          PIC X(4).
  3797    05 FILLER              PIC X(6) VALUE "&CARR=".
  3798    05 OUT-CARR            PIC X.
  3799    05 FILLER              PIC X(7) VALUE "&CLMNO=".
  3800    05 OUT-CLMNO           PIC X(7).
  3801    05 FILLER              PIC X(7) VALUE "&CRTNO=".
  3802    05 OUT-CRTNO           PIC X(11).
  3803    05 FILLER              PIC X(7) VALUE "&ACTNO=".
  3804    05 OUT-ACTNO           PIC X(10).
  3805    05 FILLER              PIC X(8) VALUE "&ILNAME=".
  3806    05 OUT-ILNAME          PIC X(15).
  3807    05 FILLER              PIC X(8) VALUE "&IFNAME=".
  3808    05 OUT-IFNAME          PIC X(10).
  3809    05 FILLER              PIC X(7) VALUE "&SEXCD=".
  3810    05 OUT-SEX-CD          PIC X.
  3811    05 FILLER              PIC X(5) VALUE "&SSN=".
  3812    05 OUT-SSN             PIC X(11).
  3813    05 FILLER              PIC X(9) VALUE "&CLMSTAT=".
  3814    05 OUT-CLMSTAT         PIC X.
  3815    05 FILLER              PIC X(8) VALUE "&CLMTYP=".
  3816    05 OUT-CLMTYPE         PIC X.
  3817    05 FILLER              PIC X(7) VALUE "&ESTDT=".
  3818    05 OUT-EST-DT          PIC X(21).
  3819    05 FILLER              PIC X(7) VALUE "&INCDT=".
  3820    05 OUT-INC-DT          PIC X(21).
  3821    05 FILLER              PIC X(7) VALUE "&RPTDT=".
  3822    05 OUT-RPT-DT          PIC X(21).
  3823    05 FILLER              PIC X(10) VALUE "&PDTHRUDT=".
  3824    05 OUT-PD-THRU-DT      PIC X(21).
  3825    05 FILLER              PIC X(11) VALUE "&FORMDUEDT=".
  3826    05 OUT-FORM-DUE-DT     PIC X(21).
  3827    05 FILLER              PIC X(8) VALUE "&LPMTDT=".
  3828    05 OUT-LST-PMT-DT      PIC X(21).
  3829    05 FILLER              PIC X(8) VALUE "&NOPMTS=".
  3830    05 OUT-NO-OF-PMTS      PIC X(10).
  3831    05 FILLER              PIC X(9) VALUE "&TOTPAID=".
  3832    05 OUT-TOT-PAID        PIC 9999999.99.
  3833    05 FILLER              PIC X(8) VALUE "&LPDAMT=".
  3834    05 OUT-LST-PD-AMT      PIC 9999999.99.
  3835    05 FILLER              PIC X(9) VALUE "&ADDRCNT=".
  3836    05 OUT-ADDR-CNT        PIC 9.
  3837    05 FILLER              PIC X(7) VALUE "&CRTST=".
  3838    05 OUT-CRT-ST          PIC XX.
  3839    05 FILLER              PIC X(10) VALUE "&CERTACCT=".
  3840    05 OUT-CERTACCT        PIC X(10).
  3841    05 FILLER              PIC X(7) VALUE "&EFFDT=".
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  68
* NSRLTRBL.cbl
  3842    05 OUT-EFF-DT          PIC X(21).
  3843    05 FILLER              PIC X(8) VALUE "&LMNTDT=".
  3844    05 OUT-LST-MAINT-DT    PIC X(21).
  3845    05 FILLER              PIC X(10) VALUE "&LMNTUSER=".
  3846    05 OUT-LST-MAINT-USER  PIC X(10).
  3847    05 FILLER              PIC X(10) VALUE "&LMNTTYPE=".
  3848    05 OUT-LST-MAINT-TYPE  PIC X(10).
  3849    05 FILLER              PIC X(6) VALUE "&DIAG=".
  3850    05 OUT-DIAG            PIC X(66).
  3851    05 FILLER              PIC X(7) VALUE "&EXPDT=".
  3852    05 OUT-EXP-DT          PIC X(21).
  3853    05 FILLER              PIC X(12) VALUE "&LCLSREASON=".
  3854    05 OUT-LST-CLS-REA     PIC X(10).
  3855    05 FILLER              PIC X(8) VALUE "&BRTHDT=".
  3856    05 OUT-BIRTH-DT        PIC X(21).
  3857    05 FILLER              PIC X(6) VALUE "&TERM=".
  3858    05 OUT-TERM            PIC 999.
  3859    05 FILLER              PIC X(7) VALUE "&BENCD=".
  3860    05 OUT-BEN-CD          PIC XX.
  3861    05 FILLER              PIC X(8) VALUE "&BENAMT=".
  3862    05 OUT-BENAMT          PIC 9999999.99.
  3863    05 FILLER              PIC X(9) VALUE "&CRITPER=".
  3864    05 OUT-CRIT-PER        PIC 999.
  3865    05 FILLER              PIC X(9) VALUE "&WAITPER=".
  3866    05 OUT-WAIT-PER        PIC XX.
  3867    05 FILLER              PIC X(11)  VALUE "&LFINTRATE=".
  3868    05 OUT-LF-INT-RATE     PIC 99.99999.
  3869    05 FILLER              PIC X(10) VALUE "&AUTOPYDT=".
  3870    05 OUT-AUTO-PY-DT      PIC X(21).
  3871    05 FILLER              PIC X(12) VALUE "&AUTOSCHEND=".
  3872    05 OUT-AUTO-SCHD-END   PIC X(21).
  3873    05 FILLER              PIC X(8) VALUE "&LOANNO=".
  3874    05 OUT-LOAN-NO         PIC X(25).
  3875    05 FILLER              PIC X(5) VALUE "&APR=".
  3876    05 OUT-APR             PIC 99.99999.
  3877    05 FILLER              PIC X(8) VALUE "&LACTDT=".
  3878    05 OUT-LST-ACT-DT      PIC X(21).
  3879    05 FILLER              PIC X(7) VALUE "&ACTDT=".
  3880    05 OUT-ACT-DT          PIC X(21).
  3881    05 FILLER              PIC X(10) VALUE "&LACTTYPE=".
  3882    05 OUT-LST-ACT-TYPE    PIC X(15).
  3883    05 FILLER              PIC X(9) VALUE "&ACTTYPE=".
  3884    05 OUT-ACT-TYPE        PIC X(15).
  3885    05 FILLER              PIC X(6) VALUE "&FORM=".
  3886    05 OUT-FORM            PIC X(4).
  3887    05 FILLER              PIC X(9) VALUE "&INSNAME=".
  3888    05 OUT-INS-NAME        PIC X(36).
  3889    05 FILLER              PIC X(10) VALUE "&INSADDR1=".
  3890    05 OUT-INS-ADDR1       PIC X(36).
  3891    05 FILLER              PIC X(10) VALUE "&INSADDR2=".
  3892    05 OUT-INS-ADDR2       PIC X(36).
  3893    05 FILLER              PIC X(9) VALUE "&INSCITY=".
  3894    05 OUT-INS-CITY        PIC X(28).
  3895    05 FILLER              PIC X(10) VALUE "&INSSTATE=".
  3896    05 OUT-INS-STATE       PIC XX.
  3897    05 FILLER              PIC X(8) VALUE "&INSZIP=".
  3898    05 OUT-INS-ZIP         PIC X(10).
  3899    05 FILLER              PIC X(10) VALUE "&INSPHONE=".
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  69
* NSRLTRBL.cbl
  3900    05 OUT-INS-PHONE       PIC X(13).
  3901    05 FILLER              PIC X(10) VALUE "&BENENAME=".
  3902    05 OUT-BEN-NAME        PIC X(32).
  3903    05 FILLER              PIC X(11) VALUE "&BENEADDR1=".
  3904    05 OUT-BEN-ADDR1       PIC X(36).
  3905    05 FILLER              PIC X(11) VALUE "&BENEADDR2=".
  3906    05 OUT-BEN-ADDR2       PIC X(32).
  3907    05 FILLER              PIC X(10) VALUE "&BENECITY=".
  3908    05 OUT-BEN-CITY        PIC X(28).
  3909    05 FILLER              PIC X(11) VALUE "&BENESTATE=".
  3910    05 OUT-BEN-STATE       PIC XX.
  3911    05 FILLER              PIC X(9) VALUE "&BENEZIP=".
  3912    05 OUT-BEN-ZIP         PIC X(10).
  3913    05 FILLER              PIC X(11) VALUE "&BENEPHONE=".
  3914    05 OUT-BEN-PHONE       PIC X(13).
  3915    05 FILLER              PIC X(8) VALUE "&OANAME=".
  3916    05 OUT-ORIG-NAME       PIC X(32).
  3917    05 FILLER              PIC X(10) VALUE "&ACCTNAME=".
  3918    05 OUT-ACCT-NAME       PIC X(32).
  3919    05 FILLER              PIC X(11) VALUE "&ACCTADDR1=".
  3920    05 OUT-ACCT-ADDR1      PIC X(36).
  3921    05 FILLER              PIC X(11) VALUE "&ACCTADDR2=".
  3922    05 OUT-ACCT-ADDR2      PIC X(32).
  3923    05 FILLER              PIC X(10) VALUE "&ACCTCITY=".
  3924    05 OUT-ACCT-CITY       PIC X(30).
  3925    05 FILLER              PIC X(11) VALUE "&ACCTSTATE=".
  3926    05 OUT-ACCT-STATE      PIC XX.
  3927    05 FILLER              PIC X(9)  VALUE "&ACCTZIP=".
  3928    05 OUT-ACCT-ZIP        PIC X(10).
  3929    05 FILLER              PIC X(11) VALUE "&ACCTPHONE=".
  3930    05 OUT-ACCT-PHONE      PIC X(13).
  3931    05 FILLER              PIC X(7) VALUE "&ENCCD=".
  3932    05 OUT-ENC-CODE        PIC XXX.
  3933    05 FILLER              PIC X(7) VALUE "&ENCST=".
  3934    05 OUT-ENC-ST          PIC XX.
  3935    05 FILLER              PIC X(8) VALUE "&ARCHNO=".
  3936    05 OUT-ARCHNO          PIC 999999999.
  3937    05 FILLER              PIC X(11) VALUE "&FLTRPRTDT=".
  3938    05 OUT-1ST-LTR-PRT-DT  PIC X(21).
  3939    05 FILLER              PIC X(11) VALUE "&NEXTDUEDT=".
  3940    05 OUT-NEXT-DUE-DT     PIC X(21).
  3941    05 FILLER              PIC X(8) VALUE "&JLNAME=".
  3942    05 OUT-JLNAME          PIC X(15).
  3943    05 FILLER              PIC X(8) VALUE "&JFNAME=".
  3944    05 OUT-JFNAME          PIC X(10).
  3945    05 FILLER              PIC X(9)  VALUE "&ENCLINE=".
  3946    05 OUT-ENCLINE         PIC X(100).
  3947    05 FILLER              PIC X(9) VALUE "&ENCATTS=".
  3948    05 OUT-ENCATTS         PIC X(255).
  3949    05 FILLER              PIC X(10) VALUE "&OUTSTACK=".
  3950    05 OUT-OUTSTACK        PIC X.
  3951    05 FILLER              PIC X(8) VALUE "&PROCID=".
  3952    05 OUT-PROCID          PIC XXXX.
  3953    05 FILLER              PIC X(8) VALUE "&COMPID=".
  3954    05 OUT-COMPID          PIC XXX.
  3955    05 FILLER              PIC X(8) VALUE "&PRTNOW=".
  3956    05 OUT-PRINT-NOW-SW    PIC X.
  3957    05 FILLER              PIC X(11) VALUE "&CYCLEDATE=".
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  70
* NSRLTRBL.cbl
  3958    05 OUT-CYCLE-DATE      PIC X(8).
  3959    05 FILLER              PIC X(11) VALUE "&ENCSTNAME=".
  3960    05 OUT-ENC-ST-NAME     PIC XX.
  3961    05 FILLER              PIC X(10) VALUE "&CARRIDLU=".
  3962    05 OUT-CARR-LU         PIC X.
  3963    05 FILLER              PIC X(5)  VALUE "&CCN=".
  3964    05 OUT-AHL-CLAIM-NO    PIC X(9).
  3965    05 FILLER              PIC X(4) VALUE "&GP=".
  3966    05 OUT-ACCT-GPCD       PIC 99.
  3967    05 FILLER              PIC X(9) VALUE "&MAXBENS=".
  3968    05 OUT-MAX-BENS        PIC 9(3).
  3969    05 FILLER              PIC X(10) VALUE "&PAIDBENS=".
  3970    05 OUT-PAID-BENS       PIC 9(3).
  3971    05 FILLER              PIC X(9) VALUE "&REMBENS=".
  3972    05 OUT-REM-BENS        PIC 9(3).
  3973    05 FILLER              PIC X(9) VALUE "&EXCLPER=".
  3974    05 OUT-EXCL-PER        PIC 9(3).
  3975    05 FILLER              PIC X(8) VALUE "&RECMOS=".
  3976    05 OUT-REC-MOS         PIC 9(2).
  3977    05 FILLER              PIC X(8) VALUE "&INSTYP=".
  3978    05 OUT-INS-TYP         PIC X(4).
  3979    05 FILLER              PIC X(8) VALUE "&BENPER=".
  3980    05 OUT-BEN-PER         PIC 9(2).
  3981    05 FILLER              PIC X(7) VALUE "&ACCSW=".
  3982    05 OUT-ACC-SW          PIC X.
  3983 01  FILLER                      PIC X(500)  VALUE SPACES.
  3984*                                COPY ELCNAPS.
  3985******************************************************************
  3986*                                                                *
  3987*                            ELCNAPS                             *
  3988*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3989*                            VMOD=2.003                          *
  3990*                                                                *
  3991*        FILE DESCRIPTION = NAPERSOFT LETTER FILE                *
  3992*                                                                *
  3993*        FILE TYPE= VSAM,KSDS                                    *
  3994*        RECORD SIZE = 150    RECFORM = FIXED                    *
  3995*                                                                *
  3996*        BASE CLUSTER = ELNAPS        RKP=2,LEN=28               *
  3997*                                                                *
  3998*        LOG = YES                                               *
  3999*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  4000*                                                                *
  4001******************************************************************
  4002*                   C H A N G E   L O G
  4003*
  4004* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4005*-----------------------------------------------------------------
  4006*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4007* EFFECTIVE    NUMBER
  4008*-----------------------------------------------------------------
  4009* 033110  CR2009122800001  AJRA  NEW FILE FOR NAPERSOFT.
  4010******************************************************************
  4011
  4012 01  NAPERSOFT-FILE.
  4013     12  NA-RECORD-ID                PIC  XX.
  4014         88  VALID-NA-ID                  VALUE 'NA'.
  4015
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  71
* NSRLTRBL.cbl
  4016     12  NA-CONTROL-PRIMARY.
  4017         16  NA-COMPANY-CD           PIC X.
  4018         16  NA-CARRIER              PIC X.
  4019         16  NA-CLAIM-NO             PIC X(7).
  4020         16  NA-CERT-NO.
  4021             20  NA-CERT-PRIME       PIC X(10).
  4022             20  NA-CERT-SFX         PIC X.
  4023         16  NA-ARCHIVE-NO           PIC 9(8).
  4024
  4025     12  NA-LETTER-INFORMATION.
  4026         16  NA-LETTER-ID            PIC X(4).
  4027         16  NA-PROCESSOR-ID         PIC X(4).
  4028         16  NA-CREATION-DT          PIC X(2).
  4029         16  NA-INITIAL-PRINT-DT     PIC X(2).
  4030         16  NA-FOLLOW-UP-DT         PIC X(2).
  4031         16  NA-RESEND-DT            PIC X(2).
  4032         16  NA-RESEND-LETTER-ID     PIC X(4).
  4033         16  NA-NO-OF-COPIES         PIC 9(2).
  4034         16  NA-ADDRESS-TYPE         PIC X(2).
  4035         16  NA-CORR-TRLR-SEQ        PIC 9(4).
  4036         16  NA-RESEND-PRINT-DT      PIC X(2).
  4037         16  NA-1ST-LTR-PRINT-DT     PIC X(2).
  4038         16  NA-NEXT-DUE-DT          PIC X(2).
  4039         16  NA-AUTOPYDT             PIC X(2).
  4040         16  NA-ENCLOSURE-CD         PIC X(3).
  4041         16  NA-CREATED-IN-NAPERSOFT PIC X(1).
  4042         16  NA-ORIG-ARCHIVE-NO      PIC 9(9).
  4043         16  NA-RESEND-PROMPT-IND    PIC X(1).
  4044         16  NA-ORIG-ENCLOSURE-CD    PIC X(3).
  4045         16  FILLER                  PIC X(67).
  4046******************************************************************
  4047*                                COPY ELCENCC.
  4048******************************************************************
  4049*                                                                *
  4050*                                                                *
  4051*                            ELCENCC                             *
  4052*                            VMOD=2.001                          *
  4053*                                                                *
  4054*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  4055*                                                                *
  4056*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  4057*   A NAPERSOFT DOCUMENT                                         *
  4058*                                                                *
  4059*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  4060*                                                                *
  4061*   FILE TYPE = VSAM,KSDS                                        *
  4062*   RECORD SIZE = 400   RECFORM = FIX                            *
  4063*                                                                *
  4064*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  4065*                                                                *
  4066*   LOG = NO                                                     *
  4067*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4068*                                                                *
  4069*                                                                *
  4070******************************************************************
  4071*                   C H A N G E   L O G
  4072*
  4073* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  72
* NSRLTRBL.cbl
  4074*-----------------------------------------------------------------
  4075*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4076* EFFECTIVE    NUMBER
  4077*-----------------------------------------------------------------
  4078* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  4079* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  4080******************************************************************
  4081 01  ENCLOSURE-CODES.
  4082     12  NC-RECORD-ID                      PIC XX.
  4083         88  VALID-NC-ID                      VALUE 'NC'.
  4084     12  NC-CONTROL-PRIMARY.
  4085         16  NC-COMPANY-CD                 PIC X.
  4086         16  NC-REC-TYPE                   PIC X.
  4087             88  NC-CLAIMS                   VALUE '1'.
  4088             88  NC-ADMIN                    VALUE '2'.
  4089         16  NC-ENC-CODE                   PIC X(5).
  4090         16  FILLER                        PIC X(09).
  4091     12  NC-MAINT-INFORMATION.
  4092         16  NC-LAST-MAINT-DT              PIC XX.
  4093         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4094         16  NC-LAST-MAINT-USER            PIC X(4).
  4095         16  FILLER                        PIC XX.
  4096     12  NC-OUTPUT-STACK                   PIC XXX.
  4097     12  NC-ENCLOSURE-LINE                 PIC X(100).
  4098     12  NC-ATTACHMENTS                    PIC X(255).
  4099     12  NC-FUTURE                         PIC X(12).
  4100******************************************************************
  4101*                                COPY ELCCRTT.
  4102******************************************************************
  4103*                                                                *
  4104*                            ELCCRTT.                            *
  4105*                                                                *
  4106*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  4107*                                                                *
  4108*   FILE TYPE = VSAM,KSDS                                        *
  4109*   RECORD SIZE = 552  RECFORM = FIXED                           *
  4110*                                                                *
  4111*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  4112*                                                                *
  4113*   LOG = YES                                                    *
  4114*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4115******************************************************************
  4116*                   C H A N G E   L O G
  4117*
  4118* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4119*-----------------------------------------------------------------
  4120*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4121* EFFECTIVE    NUMBER
  4122*-----------------------------------------------------------------
  4123* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  4124* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  4125* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  4126* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4127* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4128* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4129* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4130* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  4131* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  73
* NSRLTRBL.cbl
  4132* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  4133* 091318  CR2018073000001  PEMA  ADD Refund methods
  4134* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  4135******************************************************************
  4136
  4137 01  CERTIFICATE-TRAILERS.
  4138     12  CS-RECORD-ID                      PIC XX.
  4139         88  VALID-CS-ID                      VALUE 'CS'.
  4140
  4141     12  CS-CONTROL-PRIMARY.
  4142         16  CS-COMPANY-CD                 PIC X.
  4143         16  CS-CARRIER                    PIC X.
  4144         16  CS-GROUPING                   PIC X(6).
  4145         16  CS-STATE                      PIC XX.
  4146         16  CS-ACCOUNT                    PIC X(10).
  4147         16  CS-CERT-EFF-DT                PIC XX.
  4148         16  CS-CERT-NO.
  4149             20  CS-CERT-PRIME             PIC X(10).
  4150             20  CS-CERT-SFX               PIC X.
  4151         16  CS-TRAILER-TYPE               PIC X.
  4152             88  COMM-TRLR           VALUE 'A'.
  4153             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  4154             88  CERT-DATA-TRLR      VALUE 'C'.
  4155
  4156     12  CS-DATA-AREA                      PIC X(516).
  4157
  4158     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  4159         16  CS-BANK-COMMISSION-AREA.
  4160             20  CS-BANK-COMMS       OCCURS 10.
  4161                 24  CS-AGT                PIC X(10).
  4162                 24  CS-COM-TYP            PIC X.
  4163                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  4164                 24  CS-RECALC-LV-INDIC    PIC X.
  4165                 24  FILLER                PIC X(10).
  4166         16  FILLER                        PIC X(256).
  4167
  4168     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  4169****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  4170         16  CS-MB-CLAIM-DATA OCCURS 24.
  4171             20  CS-CLAIM-NO               PIC X(7).
  4172             20  CS-CLAIM-TYPE             PIC X.
  4173                 88  CS-AH-CLM               VALUE 'A'.
  4174                 88  CS-IU-CLM               VALUE 'I'.
  4175                 88  CS-GP-CLM               VALUE 'G'.
  4176                 88  CS-LF-CLM               VALUE 'L'.
  4177                 88  CS-PR-CLM               VALUE 'P'.
  4178                 88  CS-FL-CLM               VALUE 'F'.
  4179                 88  CS-OT-CLM               VALUE 'O'.
  4180             20  CS-INSURED-TYPE           PIC X.
  4181                 88  CS-PRIM-INSURED          VALUE 'P'.
  4182                 88  CS-CO-BORROWER           VALUE 'C'.
  4183             20  CS-BENEFIT-PERIOD         PIC 99.
  4184             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  4185             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  4186             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  4187         16  FILLER                        PIC X(12).
  4188     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  4189         16  CS-VIN-NUMBER                 PIC X(17).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  74
* NSRLTRBL.cbl
  4190         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  4191         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  4192         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  4193         16  cs-agent-name.
  4194             20  cs-agent-fname            pic x(20).
  4195             20  cs-agent-mi               pic x.
  4196             20  cs-agent-lname            pic x(25).
  4197         16  cs-license-no                 pic x(15).
  4198         16  cs-npn-number                 pic x(10).
  4199         16  cs-agent-edit-status          pic x.
  4200             88  cs-ae-refer-to-manager      value 'M'.
  4201             88  cs-ae-cover-sheet           value 'C'.
  4202             88  cs-ae-sig-form              value 'S'.
  4203             88  cs-ae-verified              value 'V'.
  4204             88  cs-unidentified-signature   value 'U'.
  4205             88  cs-cert-returned            value 'R'.
  4206             88  cs-accept-no-commission     value 'N'.
  4207         16  cs-year                       pic 9999.
  4208         16  cs-make                       pic x(20).
  4209         16  cs-model                      pic x(20).
  4210         16  cs-future                     pic x(20).
  4211         16  cs-vehicle-odometer           pic s9(7) comp-3.
  4212         16  cs-claim-verification-status  pic x.
  4213             88  cs-clm-ver-eligible         value 'A'.
  4214             88  cs-clm-ver-partial-elig     value 'B'.
  4215             88  cs-clm-ver-not-eligible     value 'C'.
  4216             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  4217             88  cs-clm-ver-not-part-elig-rw value 'E'.
  4218             88  cs-clm-ver-ND-CERT          value 'F'.
  4219             88  cs-clm-ver-spec-other       value 'G'.
  4220             88  cs-clam-ver-pratial-corrected
  4221                                             value 'H'.
  4222             88  cs-clm-ver-no-matches       value 'I'.
  4223             88  cs-clm-ver-not-elig-corrected
  4224                                             value 'J'.
  4225             88  cs-clm-ver-needs-review     value 'R'.
  4226             88  cs-clm-ver-sent-to-claims   value 'W'.
  4227         16  CS-LF-REFUND-METHOD           PIC X.
  4228         16  CS-AH-REFUND-METHOD           PIC X.
  4229         16  FILLER                        PIC X(353). *> was 420
  4230*        16  FILLER                        PIC X(496).
  4231*                                COPY ERCPDEF.
  4232******************************************************************
  4233*                                                                *
  4234*                                                                *
  4235*                            ERCPDEF.                            *
  4236*                                                                *
  4237*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  4238*                                                                *
  4239*    FILE TYPE = VSAM,KSDS                                       *
  4240*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  4241*                                                                *
  4242*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  4243*                                                                *
  4244*    LOG = YES                                                   *
  4245*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4246******************************************************************
  4247*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  75
* NSRLTRBL.cbl
  4248*
  4249* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4250*-----------------------------------------------------------------
  4251*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4252* EFFECTIVE    NUMBER
  4253*-----------------------------------------------------------------
  4254* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4255* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4256* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  4257* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  4258******************************************************************
  4259 01  PRODUCT-MASTER.
  4260    12  PD-RECORD-ID                 PIC X(02).
  4261        88  VALID-PD-ID                  VALUE 'PD'.
  4262    12  PD-CONTROL-PRIMARY.
  4263        16  PD-COMPANY-CD            PIC X.
  4264        16  PD-STATE                 PIC XX.
  4265        16  PD-PRODUCT-CD            PIC XXX.
  4266        16  PD-FILLER                PIC X(7).
  4267        16  PD-BEN-TYPE              PIC X.
  4268        16  PD-BEN-CODE              PIC XX.
  4269        16  PD-PROD-EXP-DT           PIC XX.
  4270    12  FILLER                       PIC X(50).
  4271    12  PD-PRODUCT-DATA OCCURS 8.
  4272        16  PD-PROD-CODE             PIC X.
  4273            88  PD-PROD-LIFE           VALUE 'L'.
  4274            88  PD-PROD-PROP           VALUE 'P'.
  4275            88  PD-PROD-AH             VALUE 'A'.
  4276            88  PD-PROD-IU             VALUE 'I'.
  4277            88  PD-PROD-GAP            VALUE 'G'.
  4278            88  PD-PROD-FAML           VALUE 'F'.
  4279            88  PD-PROD-OTH            VALUE 'O'.
  4280        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  4281        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  4282        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  4283        16  PD-MAX-TERM              PIC S999        COMP-3.
  4284        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  4285        16  FILLER                   PIC X.
  4286        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  4287        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  4288        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  4289        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  4290        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  4291        16  PD-REC-CRIT-PERIOD       PIC 99.
  4292        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  4293            20  PD-RECURRING-YN      PIC X.
  4294            20  FILLER               PIC X.
  4295        16  PD-RTW-MOS               PIC 99.
  4296        16  PD-MAX-EXTENSION         PIC 99.
  4297        16  pd-ben-pct               pic sv999 comp-3.
  4298*       16  FILLER                   PIC XX.
  4299    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  4300    12  PD-TERM-LIMITS OCCURS 15.
  4301        16  PD-LOW-TERM              PIC S999        COMP-3.
  4302        16  PD-HI-TERM               PIC S999        COMP-3.
  4303*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  4304    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  4305        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  76
* NSRLTRBL.cbl
  4306        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  4307    12  PD-EARN-FACTORS.
  4308        16  FILLER OCCURS 15.
  4309            20  FILLER OCCURS 15.
  4310                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  4311    12  PD-PRODUCT-DESC              PIC X(80).
  4312    12  PD-TRUNCATED                 PIC X.
  4313    12  FILLER                       PIC X(59).
  4314    12  PD-MAINT-INFORMATION.
  4315        16  PD-LAST-MAINT-DT         PIC X(02).
  4316        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  4317        16  PD-LAST-MAINT-BY         PIC X(04).
  4318****************************************************************
  4319*
  4320* Copyright (c) 2007-2013 Dell Inc.
  4321* All rights reserved.
  4322*
  4323****************************************************************
  4324 01  DFHEIV.
  4325   02  DFHEIV0               PIC X(35).
  4326   02  DFHEIV1               PIC X(08).
  4327   02  DFHEIV2               PIC X(08).
  4328   02  DFHEIV3               PIC X(08).
  4329   02  DFHEIV4               PIC X(06).
  4330   02  DFHEIV5               PIC X(04).
  4331   02  DFHEIV6               PIC X(04).
  4332   02  DFHEIV7               PIC X(02).
  4333   02  DFHEIV8               PIC X(02).
  4334   02  DFHEIV9               PIC X(01).
  4335   02  DFHEIV10              PIC S9(7) COMP-3.
  4336   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4337   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4338   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4339   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4340   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4341   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4342   02  DFHEIV17              PIC X(04).
  4343   02  DFHEIV18              PIC X(04).
  4344   02  DFHEIV19              PIC X(04).
  4345   02  DFHEIV20              USAGE IS POINTER.
  4346   02  DFHEIV21              USAGE IS POINTER.
  4347   02  DFHEIV22              USAGE IS POINTER.
  4348   02  DFHEIV23              USAGE IS POINTER.
  4349   02  DFHEIV24              USAGE IS POINTER.
  4350   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4351   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4352   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4353   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4354   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4355   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4356   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4357   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4358   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4359   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4360   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4361   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4362   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4363   02  FILLER                PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  77
* NSRLTRBL.cbl
  4364   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4365   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4366   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4367   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4368   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4369   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4370   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4371 LINKAGE  SECTION.
  4372*****************************************************************
  4373*                                                               *
  4374* Copyright (c) 2007-2013 Dell Inc.                             *
  4375* All rights reserved.                                          *
  4376*                                                               *
  4377*****************************************************************
  4378 01  dfheiblk.
  4379     02  eibtime          pic s9(7) comp-3.
  4380     02  eibdate          pic s9(7) comp-3.
  4381     02  eibtrnid         pic x(4).
  4382     02  eibtaskn         pic s9(7) comp-3.
  4383     02  eibtrmid         pic x(4).
  4384     02  dfheigdi         pic s9(4) comp.
  4385     02  eibcposn         pic s9(4) comp.
  4386     02  eibcalen         pic s9(4) comp.
  4387     02  eibaid           pic x(1).
  4388     02  eibfiller1       pic x(1).
  4389     02  eibfn            pic x(2).
  4390     02  eibfiller2       pic x(2).
  4391     02  eibrcode         pic x(6).
  4392     02  eibfiller3       pic x(2).
  4393     02  eibds            pic x(8).
  4394     02  eibreqid         pic x(8).
  4395     02  eibrsrce         pic x(8).
  4396     02  eibsync          pic x(1).
  4397     02  eibfree          pic x(1).
  4398     02  eibrecv          pic x(1).
  4399     02  eibsend          pic x(1).
  4400     02  eibatt           pic x(1).
  4401     02  eibeoc           pic x(1).
  4402     02  eibfmh           pic x(1).
  4403     02  eibcompl         pic x(1).
  4404     02  eibsig           pic x(1).
  4405     02  eibconf          pic x(1).
  4406     02  eiberr           pic x(1).
  4407     02  eibrldbk         pic x(1).
  4408     02  eiberrcd         pic x(4).
  4409     02  eibsynrb         pic x(1).
  4410     02  eibnodat         pic x(1).
  4411     02  eibfiller5       pic x(2).
  4412     02  eibresp          pic s9(8) comp.
  4413     02  eibresp2         pic s9(8) comp.
  4414     02  dfheigdj         pic s9(4) comp.
  4415     02  dfheigdk         pic s9(4) comp.
  4416 01 dfhcommarea.
  4417*                                copy ELCLTRSPI.
  4418******************************************************************
  4419*                   C H A N G E   L O G
  4420*
  4421* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  78
* NSRLTRBL.cbl
  4422*-----------------------------------------------------------------
  4423*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4424* EFFECTIVE    NUMBER
  4425*-----------------------------------------------------------------
  4426* 121802    2009122800001  PEMA  NEW COPYBOOK
  4427******************************************************************
  4428****************************************
  4429*  commarea for NaperSoft On Demand Claim letters
  4430*  (business logic input & output)
  4431****************************************
  4432     03  BL-INPUT.
  4433         05  BL-CARRIER          PIC X.
  4434         05  BL-CLAIM-NO         PIC X(7).
  4435         05  BL-CERT-NO          PIC X(11).
  4436         05  BL-LETTER-ID        PIC XXXX.
  4437         05  BL-FOLLOW-UP-DT     PIC X(10).
  4438         05  BL-RESEND-DT        PIC X(10).
  4439         05  BL-NO-OF-COPIES     PIC 99.
  4440         05  BL-PROC-ID          PIC XXXX.
  4441         05  BL-COMP-ID          PIC XXX.
  4442         05  BL-PRINT-NOW-SW     PIC X.
  4443         05  BL-ENC-CD           PIC XXX.
  4444         05  BL-ARCHIVE-NO       PIC 9(8).
  4445         05  BL-REGARDING        PIC X(70).
  4446     03  BL-OUTPUT.
  4447         05  BL-STATUS                   PIC X.
  4448             88  BL-OK                      VALUE "P".
  4449             88  BL-FAIL                  VALUE "F".
  4450         05  BL-MESSAGE          PIC X(50).
  4451     03  BL-RECORD-PASSED-DATA   PIC X(2500).
  4452 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  4453 0000-DFHEXIT SECTION.
  4454     MOVE '9#                    $   ' TO DFHEIV0.
  4455     MOVE 'NSRLTRBL' TO DFHEIV1.
  4456     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4457     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  4458     MOVE '5'                    TO DC-OPTION-CODE
  4459     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4460     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE
  4461     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  4462     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE
  4463*****************************************************
  4464* The full claim key has been established and passed
  4465* to this program via NSREQLTR
  4466*****************************************************
  4467     IF BL-COMP-ID = 'DCC'
  4468        MOVE X'05'               TO WS-ELMSTR-COMPANY-CD
  4469     ELSE
  4470       IF BL-COMP-ID = 'AHL'
  4471        MOVE X'06'               TO WS-ELMSTR-COMPANY-CD
  4472       ELSE
  4473        MOVE X'04'               TO WS-ELMSTR-COMPANY-CD
  4474       END-IF
  4475     END-IF
  4476     MOVE BL-CARRIER             TO WS-ELMSTR-CARRIER
  4477     MOVE BL-CLAIM-NO            TO WS-ELMSTR-CLAIM-NO
  4478     MOVE BL-CERT-NO             TO WS-ELMSTR-CERT-NO
  4479     SET BL-FAIL TO TRUE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  79
* NSRLTRBL.cbl
  4480
  4481* EXEC CICS READ
  4482*         DATASET    ('ELMSTR')
  4483*         INTO       (CLAIM-MASTER)
  4484*         RIDFLD     (WS-ELMSTR-KEY)
  4485*         RESP       (WS-RESPONSE)
  4486*    END-EXEC.
  4487     MOVE LENGTH OF
  4488      CLAIM-MASTER
  4489       TO DFHEIV11
  4490     MOVE 'ELMSTR' TO DFHEIV1
  4491*    MOVE '&"IL       E          (  N#00004476' TO DFHEIV0
  4492     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4493     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4494     MOVE X'204E233030303034343736' TO DFHEIV0(25:11)
  4495     CALL 'kxdfhei1' USING DFHEIV0,
  4496           DFHEIV1,
  4497           CLAIM-MASTER,
  4498           DFHEIV11,
  4499           WS-ELMSTR-KEY,
  4500           DFHEIV99,
  4501           DFHEIV99,
  4502           DFHEIV99
  4503     MOVE EIBRESP  TO WS-RESPONSE
  4504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4505
  4506     IF RESP-NORMAL
  4507        MOVE BL-LETTER-ID        TO OUT-TEMP
  4508                                    OUT-LETTER
  4509        MOVE BL-PROC-ID          TO OUT-PROCID
  4510        MOVE BL-COMP-ID          TO OUT-COMPID
  4511        MOVE BL-PRINT-NOW-SW     TO OUT-PRINT-NOW-SW
  4512        MOVE CL-CARRIER          TO OUT-CARR
  4513                                    OUT-CARR-LU
  4514        MOVE CL-INSURED-LAST-NAME
  4515                                 TO OUT-ILNAME
  4516        MOVE CL-INSURED-1ST-NAME TO OUT-IFNAME
  4517        MOVE CL-CLAIM-NO         TO OUT-CLMNO
  4518        MOVE CL-CERT-NO          TO OUT-CRTNO
  4519        MOVE CL-CERT-ACCOUNT     TO OUT-ACTNO
  4520        MOVE CL-SOC-SEC-NO       TO OUT-SSN
  4521        MOVE CL-CLAIM-STATUS     TO OUT-CLMSTAT
  4522        MOVE CL-CCN (1:9)        TO OUT-AHL-CLAIM-NO
  4523        MOVE WS-SAVE-EDIT-A-DATE TO DC-GREG-DATE-A-EDIT
  4524        STRING DC-EDITA-CCYY  DC-EDITA-MONTH DC-EDITA-DAY
  4525          DELIMITED BY SIZE INTO OUT-CYCLE-DATE
  4526        END-STRING
  4527*       IF CLAIM-IS-CLOSED
  4528*          MOVE 'CLOSED'         TO OUT-CLMSTAT
  4529*       ELSE
  4530*          MOVE 'OPEN'           TO OUT-CLMSTAT
  4531*       END-IF
  4532        MOVE CL-CLAIM-TYPE       TO OUT-CLMTYPE
  4533        MOVE CL-FILE-ESTABLISH-DT
  4534                                 TO DC-BIN-DATE-1
  4535        MOVE ' '                 TO DC-OPTION-CODE
  4536        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4537        IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  80
* NSRLTRBL.cbl
  4538           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4539              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4540              INTO OUT-EST-DT
  4541           END-STRING
  4542        ELSE
  4543           MOVE SPACES           TO OUT-EST-DT
  4544        END-IF
  4545        MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  4546        MOVE ' '                 TO DC-OPTION-CODE
  4547        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4548        IF NO-CONVERSION-ERROR
  4549           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4550              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4551              INTO OUT-PD-THRU-DT
  4552           END-STRING
  4553        ELSE
  4554           MOVE SPACES           TO OUT-PD-THRU-DT
  4555        END-IF
  4556        MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
  4557        MOVE +0                  TO DC-ELAPSED-MONTHS
  4558        MOVE +30                 TO DC-ELAPSED-DAYS
  4559        MOVE '6'                 TO DC-OPTION-CODE
  4560        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4561        IF NO-CONVERSION-ERROR
  4562           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4563              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4564              INTO OUT-FORM-DUE-DT
  4565           END-STRING
  4566        ELSE
  4567           MOVE SPACES           TO OUT-FORM-DUE-DT
  4568        END-IF
  4569        MOVE CL-TOTAL-PAID-AMT   TO OUT-TOT-PAID
  4570        MOVE CL-INSURED-SEX-CD   TO OUT-SEX-CD
  4571        MOVE CL-CERT-STATE       TO OUT-CRT-ST
  4572                                    OUT-ENC-ST
  4573                                    OUT-ENC-ST-NAME
  4574        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
  4575        MOVE ' '                 TO DC-OPTION-CODE
  4576        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4577        IF NO-CONVERSION-ERROR
  4578           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4579              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4580              INTO OUT-EFF-DT
  4581           END-STRING
  4582        ELSE
  4583           MOVE SPACES           TO OUT-EFF-DT
  4584        END-IF
  4585        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
  4586        MOVE ' '                 TO DC-OPTION-CODE
  4587        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4588        IF NO-CONVERSION-ERROR
  4589           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4590              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4591              INTO OUT-INC-DT
  4592           END-STRING
  4593        ELSE
  4594           MOVE SPACES           TO OUT-INC-DT
  4595        END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  81
* NSRLTRBL.cbl
  4596        MOVE CL-REPORTED-DT      TO DC-BIN-DATE-1
  4597        MOVE ' '                 TO DC-OPTION-CODE
  4598        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4599        IF NO-CONVERSION-ERROR
  4600           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4601              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4602              INTO OUT-RPT-DT
  4603           END-STRING
  4604        ELSE
  4605           MOVE SPACES           TO OUT-RPT-DT
  4606        END-IF
  4607        MOVE CL-LAST-PMT-DT      TO DC-BIN-DATE-1
  4608        MOVE ' '                 TO DC-OPTION-CODE
  4609        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4610        IF NO-CONVERSION-ERROR
  4611           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4612              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4613              INTO OUT-LST-PMT-DT
  4614           END-STRING
  4615        ELSE
  4616           MOVE SPACES           TO OUT-LST-PMT-DT
  4617        END-IF
  4618        MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
  4619        MOVE ' '                 TO DC-OPTION-CODE
  4620        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4621        IF NO-CONVERSION-ERROR
  4622           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4623              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4624              INTO OUT-BIRTH-DT
  4625           END-STRING
  4626        ELSE
  4627           MOVE SPACES           TO OUT-BIRTH-DT
  4628        END-IF
  4629        MOVE CL-LAST-MAINT-DT    TO DC-BIN-DATE-1
  4630        MOVE ' '                 TO DC-OPTION-CODE
  4631        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4632        IF NO-CONVERSION-ERROR
  4633           STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4634              DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4635              INTO OUT-LST-MAINT-DT
  4636           END-STRING
  4637        ELSE
  4638           MOVE SPACES           TO OUT-LST-MAINT-DT
  4639        END-IF
  4640        MOVE CL-LAST-MAINT-USER  TO OUT-LST-MAINT-USER
  4641        MOVE CL-LAST-MAINT-TYPE  TO OUT-LST-MAINT-TYPE
  4642        MOVE CL-NO-OF-PMTS-MADE  TO OUT-NO-OF-PMTS
  4643        MOVE CL-LAST-PMT-AMT     TO OUT-LST-PD-AMT
  4644        MOVE CL-ACCOUNT-ADDR-CNT TO OUT-ADDR-CNT
  4645        MOVE CL-LAST-CLOSE-REASON TO OUT-LST-CLS-REA
  4646        MOVE BL-ENC-CD           TO OUT-ENC-CODE
  4647        PERFORM 1000-GET-FILES   THRU 1000-EXIT
  4648        PERFORM 1800-SET-EL150D-FIELDS THRU 1800-EXIT
  4649        SET BL-OK TO TRUE
  4650     END-IF
  4651     IF BL-OK
  4652        PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  4653        MOVE WS-ARCHIVE-NO       TO OUT-ARCHNO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  82
* NSRLTRBL.cbl
  4654        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  4655        MOVE NAPER-OUTPUT-DATA   TO BL-RECORD-PASSED-DATA
  4656*       PERFORM 1600-ADD-CORR-TRLR
  4657*                                THRU 1600-EXIT
  4658     END-IF
  4659
  4660* exec cics return end-exec.
  4661*    MOVE '.(                    ''   #00004635' TO DFHEIV0
  4662     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4663     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4664     MOVE X'2020233030303034363335' TO DFHEIV0(25:11)
  4665     CALL 'kxdfhei1' USING DFHEIV0,
  4666           DFHEIV99,
  4667           DFHEIV99,
  4668           DFHEIV99,
  4669           DFHEIV99,
  4670           DFHEIV99,
  4671           DFHEIV99
  4672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4673
  4674 0500-SCRUB-DATA.
  4675*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  4676*   A DIFFERENT DELIMITER IN PROGRAM NSREQLTR BUT
  4677*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  4678*   TO A HEX 26 TO GET BY THE DECODER
  4679     MOVE FUNCTION LENGTH(OUT-ILNAME)
  4680                                 TO M1
  4681     MOVE SPACES                 TO WS-WORK-FIELD
  4682     perform varying a1 from +1 by +1 until a1 > m1
  4683        if out-ilname (a1:1) = '&'
  4684           MOVE OUT-ILNAME (1:A1 - 1)
  4685                                 TO WS-WORK-FIELD (1:A1 - 1)
  4686           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4687           MOVE OUT-ILNAME (A1 + 1:M1 - A1)
  4688                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4689           MOVE WS-WORK-FIELD    TO OUT-ILNAME
  4690           add +2 to a1
  4691        end-if
  4692     end-perform
  4693     MOVE FUNCTION LENGTH(OUT-ACCT-ADDR1)
  4694                                 TO M1
  4695     MOVE SPACES                 TO WS-WORK-FIELD
  4696     perform varying a1 from +1 by +1 until a1 > m1
  4697        if out-acct-addr1 (a1:1) = '&'
  4698           MOVE out-acct-addr1 (1:A1 - 1)
  4699                                 TO WS-WORK-FIELD (1:A1 - 1)
  4700           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4701           MOVE out-acct-addr1 (A1 + 1:M1 - A1)
  4702                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4703           MOVE WS-WORK-FIELD    TO out-acct-addr1
  4704           add +2 to a1
  4705        end-if
  4706     end-perform
  4707     MOVE FUNCTION LENGTH(OUT-ACCT-ADDR2)
  4708                                 TO M1
  4709     MOVE SPACES                 TO WS-WORK-FIELD
  4710     perform varying a1 from +1 by +1 until a1 > m1
  4711        if out-acct-addr2 (a1:1) = '&'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  83
* NSRLTRBL.cbl
  4712           MOVE out-acct-addr2 (1:A1 - 1)
  4713                                 TO WS-WORK-FIELD (1:A1 - 1)
  4714           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4715           MOVE out-acct-addr2 (A1 + 1:M1 - A1)
  4716                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4717           MOVE WS-WORK-FIELD    TO out-acct-addr2
  4718           add +2 to a1
  4719        end-if
  4720     end-perform
  4721     MOVE FUNCTION LENGTH(OUT-ACCT-CITY)
  4722                                 TO M1
  4723     MOVE SPACES                 TO WS-WORK-FIELD
  4724     perform varying a1 from +1 by +1 until a1 > m1
  4725        if out-acct-city (a1:1) = '&'
  4726           MOVE out-acct-city (1:A1 - 1)
  4727                                 TO WS-WORK-FIELD (1:A1 - 1)
  4728           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4729           MOVE out-acct-city (A1 + 1:M1 - A1)
  4730                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4731           MOVE WS-WORK-FIELD    TO out-acct-city
  4732           add +2 to a1
  4733        end-if
  4734     end-perform
  4735     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  4736                                 TO M1
  4737     MOVE SPACES                 TO WS-WORK-FIELD
  4738     perform varying a1 from +1 by +1 until a1 > m1
  4739        if out-acct-name (a1:1) = '&'
  4740           MOVE out-acct-name (1:A1 - 1)
  4741                                 TO WS-WORK-FIELD (1:A1 - 1)
  4742           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4743           MOVE out-acct-name (A1 + 1:M1 - A1)
  4744                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4745           MOVE WS-WORK-FIELD    TO out-acct-name
  4746           add +2 to a1
  4747        end-if
  4748     end-perform
  4749     MOVE FUNCTION LENGTH(OUT-ORIG-NAME)
  4750                                 TO M1
  4751     MOVE SPACES                 TO WS-WORK-FIELD
  4752     perform varying a1 from +1 by +1 until a1 > m1
  4753        if out-orig-name (a1:1) = '&'
  4754           MOVE out-orig-name (1:A1 - 1)
  4755                                 TO WS-WORK-FIELD (1:A1 - 1)
  4756           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4757           MOVE out-orig-name (A1 + 1:M1 - A1)
  4758                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4759           MOVE WS-WORK-FIELD    TO out-orig-name
  4760           add +2 to a1
  4761        end-if
  4762     end-perform
  4763     MOVE FUNCTION LENGTH(OUT-INS-NAME)
  4764                                 TO M1
  4765     MOVE SPACES                 TO WS-WORK-FIELD
  4766     perform varying a1 from +1 by +1 until a1 > m1
  4767        if out-ins-name (a1:1) = '&'
  4768           MOVE out-ins-name (1:A1 - 1)
  4769                                 TO WS-WORK-FIELD (1:A1 - 1)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  84
* NSRLTRBL.cbl
  4770           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4771           MOVE out-ins-name (A1 + 1:M1 - A1)
  4772                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4773           MOVE WS-WORK-FIELD    TO out-ins-name
  4774           add +2 to a1
  4775        end-if
  4776     end-perform
  4777     MOVE FUNCTION LENGTH(OUT-INS-ADDR1)
  4778                                 TO M1
  4779     MOVE SPACES                 TO WS-WORK-FIELD
  4780     perform varying a1 from +1 by +1 until a1 > m1
  4781        if out-ins-addr1 (a1:1) = '&'
  4782           MOVE out-ins-addr1 (1:A1 - 1)
  4783                                 TO WS-WORK-FIELD (1:A1 - 1)
  4784           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4785           MOVE out-ins-addr1 (A1 + 1:M1 - A1)
  4786                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4787           MOVE WS-WORK-FIELD    TO out-ins-addr1
  4788           add +2 to a1
  4789        end-if
  4790     end-perform
  4791     MOVE FUNCTION LENGTH(OUT-INS-ADDR2)
  4792                                 TO M1
  4793     MOVE SPACES                 TO WS-WORK-FIELD
  4794     perform varying a1 from +1 by +1 until a1 > m1
  4795        if out-ins-addr2 (a1:1) = '&'
  4796           MOVE out-ins-addr2 (1:A1 - 1)
  4797                                 TO WS-WORK-FIELD (1:A1 - 1)
  4798           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4799           MOVE out-ins-addr2 (A1 + 1:M1 - A1)
  4800                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4801           MOVE WS-WORK-FIELD    TO out-ins-addr2
  4802           add +2 to a1
  4803        end-if
  4804     end-perform
  4805     MOVE FUNCTION LENGTH(OUT-BEN-NAME)   TO M1
  4806     MOVE SPACES                 TO WS-WORK-FIELD
  4807     perform varying a1 from +1 by +1 until a1 > m1
  4808        if out-ben-name (a1:1) = '&'
  4809           MOVE out-ben-name (1:A1 - 1)
  4810                                 TO WS-WORK-FIELD (1:A1 - 1)
  4811           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4812           MOVE out-ben-name (A1 + 1:M1 - A1)
  4813                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4814           MOVE WS-WORK-FIELD    TO out-ben-name
  4815           add +2 to a1
  4816        end-if
  4817     end-perform
  4818     MOVE FUNCTION LENGTH(OUT-BEN-ADDR1)
  4819                                 TO M1
  4820     MOVE SPACES                 TO WS-WORK-FIELD
  4821     perform varying a1 from +1 by +1 until a1 > m1
  4822        if out-ben-addr1 (a1:1) = '&'
  4823           MOVE out-ben-addr1 (1:A1 - 1)
  4824                                 TO WS-WORK-FIELD (1:A1 - 1)
  4825           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4826           MOVE out-ben-addr1 (A1 + 1:M1 - A1)
  4827                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  85
* NSRLTRBL.cbl
  4828           MOVE WS-WORK-FIELD    TO out-ben-addr1
  4829           add +2 to a1
  4830        end-if
  4831     end-perform
  4832     MOVE FUNCTION LENGTH(OUT-BEN-ADDR2)
  4833                                 TO M1
  4834     MOVE SPACES                 TO WS-WORK-FIELD
  4835     perform varying a1 from +1 by +1 until a1 > m1
  4836        if out-ben-addr2 (a1:1) = '&'
  4837           MOVE out-ben-addr2 (1:A1 - 1)
  4838                                 TO WS-WORK-FIELD (1:A1 - 1)
  4839           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4840           MOVE out-ben-addr2 (A1 + 1:M1 - A1)
  4841                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4842           MOVE WS-WORK-FIELD    TO out-ben-addr2
  4843           add +2 to a1
  4844        end-if
  4845     end-perform
  4846     MOVE FUNCTION LENGTH(OUT-DIAG)       TO M1
  4847     MOVE SPACES                 TO WS-WORK-FIELD
  4848     perform varying a1 from +1 by +1 until a1 > m1
  4849        if out-diag (a1:1) = '&'
  4850           MOVE out-diag (1:A1 - 1)
  4851                                 TO WS-WORK-FIELD (1:A1 - 1)
  4852           MOVE '%26'            TO WS-WORK-FIELD (A1:3)
  4853           MOVE out-diag (A1 + 1:M1 - A1)
  4854                                 TO WS-WORK-FIELD (A1 + 3:M1 - A1)
  4855           MOVE WS-WORK-FIELD    TO out-diag
  4856           add +2 to a1
  4857        end-if
  4858     end-perform
  4859     MOVE ZEROS TO WS-TALLY WS-TALLY1
  4860     INSPECT NAPER-OUTPUT-DATA TALLYING WS-TALLY
  4861        FOR ALL '%'
  4862     INSPECT NAPER-OUTPUT-DATA TALLYING WS-TALLY1
  4863        FOR ALL '%26'
  4864     IF (WS-TALLY > 0)
  4865        AND (WS-TALLY NOT = WS-TALLY1)
  4866        MOVE +1                  TO A1
  4867        MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  4868                                 TO NS-LEN
  4869        PERFORM WS-TALLY TIMES
  4870           PERFORM VARYING A1 FROM A1 BY +1 UNTIL
  4871              (A1 > NS-LEN)
  4872              OR (NAPER-OUTPUT-DATA (A1:1) = '%')
  4873           END-PERFORM
  4874           IF A1 > NS-LEN
  4875              CONTINUE
  4876           ELSE
  4877              IF NAPER-OUTPUT-DATA (A1:3) = '%26'
  4878                 ADD +1 TO A1
  4879              ELSE
  4880                 MOVE NAPER-OUTPUT-DATA (1:A1 - 1)
  4881                                 TO WS-XML-WORK
  4882                 MOVE '%25'      TO WS-XML-WORK (A1:3)
  4883                 MOVE NAPER-OUTPUT-DATA (A1 + 1:NS-LEN - A1)
  4884                              TO WS-XML-WORK (A1 + 3:NS-LEN - A1)
  4885                 MOVE WS-XML-WORK TO NAPER-OUTPUT-DATA
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  86
* NSRLTRBL.cbl
  4886                 ADD +3 TO A1
  4887              END-IF
  4888           END-IF
  4889        END-PERFORM
  4890     END-IF
  4891     .
  4892 0500-EXIT.
  4893     EXIT.
  4894 1000-GET-FILES.
  4895     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  4896     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  4897     MOVE ' '                    TO WS-FOUND-BENE-SW
  4898     PERFORM 1250-GET-ELLETR     THRU 1250-EXIT
  4899     PERFORM 1300-GET-ELTRLRS    THRU 1300-EXIT
  4900     PERFORM 1700-GET-ELENCC     THRU 1700-EXIT
  4901     IF CL-CLAIM-TYPE NOT = 'L' AND 'P' AND 'O'
  4902        PERFORM 1400-GET-WAIT-PER THRU 1400-EXIT
  4903     END-IF
  4904     IF NOT FOUND-BENE
  4905        MOVE CL-COMPANY-CD       TO WS-ELBENE-COMPANY-CD
  4906        MOVE 'B'                 TO WS-ELBENE-REC-TYPE
  4907        MOVE CL-BENEFICIARY      TO WS-ELBENE-BENE
  4908
  4909* EXEC CICS READ
  4910*            DATASET    ('ELBENE')
  4911*            INTO       (BENEFICIARY-MASTER)
  4912*            RIDFLD     (WS-ELBENE-KEY)
  4913*            RESP       (WS-RESPONSE)
  4914*       END-EXEC
  4915     MOVE LENGTH OF
  4916      BENEFICIARY-MASTER
  4917       TO DFHEIV11
  4918     MOVE 'ELBENE' TO DFHEIV1
  4919*    MOVE '&"IL       E          (  N#00004870' TO DFHEIV0
  4920     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4921     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4922     MOVE X'204E233030303034383730' TO DFHEIV0(25:11)
  4923     CALL 'kxdfhei1' USING DFHEIV0,
  4924           DFHEIV1,
  4925           BENEFICIARY-MASTER,
  4926           DFHEIV11,
  4927           WS-ELBENE-KEY,
  4928           DFHEIV99,
  4929           DFHEIV99,
  4930           DFHEIV99
  4931     MOVE EIBRESP  TO WS-RESPONSE
  4932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4933        IF RESP-NORMAL
  4934           MOVE BE-MAIL-TO-NAME   TO OUT-BEN-NAME
  4935           MOVE BE-ADDRESS-LINE-1 TO OUT-BEN-ADDR1
  4936           MOVE BE-ADDRESS-LINE-2 TO OUT-BEN-ADDR2
  4937           MOVE BE-CITY           TO OUT-BEN-CITY
  4938           MOVE BE-STATE          TO OUT-BEN-STATE
  4939           MOVE BE-ZIP-PRIME      TO OUT-BEN-ZIP
  4940           IF BE-ZIP-PLUS4 NOT = SPACES AND ZEROS
  4941              STRING '-' BE-ZIP-PLUS4 DELIMITED BY SIZE
  4942                 INTO OUT-BEN-ZIP (6:5)
  4943              END-STRING
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  87
* NSRLTRBL.cbl
  4944           END-IF
  4945           MOVE BE-PHONE-NO       TO OUT-BEN-PHONE
  4946        END-IF
  4947     END-IF
  4948     .
  4949 1000-EXIT.
  4950     EXIT.
  4951 1100-GET-ELCERT.
  4952     MOVE CL-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  4953     MOVE CL-CERT-KEY-DATA       TO WS-ELCERT-KEY (2:21)
  4954     MOVE CL-CERT-NO             TO WS-ELCERT-CERT-NO
  4955
  4956* EXEC CICS READ
  4957*         DATASET    ('ELCERT')
  4958*         INTO       (CERTIFICATE-MASTER)
  4959*         RIDFLD     (WS-ELCERT-KEY)
  4960*         RESP       (WS-RESPONSE)
  4961*    END-EXEC.
  4962     MOVE LENGTH OF
  4963      CERTIFICATE-MASTER
  4964       TO DFHEIV11
  4965     MOVE 'ELCERT' TO DFHEIV1
  4966*    MOVE '&"IL       E          (  N#00004898' TO DFHEIV0
  4967     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4968     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4969     MOVE X'204E233030303034383938' TO DFHEIV0(25:11)
  4970     CALL 'kxdfhei1' USING DFHEIV0,
  4971           DFHEIV1,
  4972           CERTIFICATE-MASTER,
  4973           DFHEIV11,
  4974           WS-ELCERT-KEY,
  4975           DFHEIV99,
  4976           DFHEIV99,
  4977           DFHEIV99
  4978     MOVE EIBRESP  TO WS-RESPONSE
  4979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4980
  4981     IF RESP-NORMAL
  4982        IF CL-CLAIM-TYPE = 'L' OR 'P' OR 'O'
  4983           MOVE CM-LF-BENEFIT-AMT TO OUT-BENAMT
  4984           MOVE CM-LF-ORIG-TERM  TO OUT-TERM
  4985           MOVE CM-LF-BENEFIT-CD TO OUT-BEN-CD
  4986           MOVE CM-LF-CRITICAL-PERIOD
  4987                                 TO OUT-CRIT-PER
  4988           MOVE CM-LF-LOAN-EXPIRE-DT
  4989                                 TO DC-BIN-DATE-1
  4990           MOVE ' '              TO DC-OPTION-CODE
  4991           PERFORM 9700-DATE-LINK
  4992                                 THRU 9700-EXIT
  4993           IF NO-CONVERSION-ERROR
  4994              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  4995                 DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  4996                 INTO OUT-EXP-DT
  4997              END-STRING
  4998           ELSE
  4999              MOVE SPACES        TO OUT-EXP-DT
  5000           END-IF
  5001        ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  88
* NSRLTRBL.cbl
  5002           MOVE CM-AH-BENEFIT-AMT TO OUT-BENAMT
  5003           MOVE CM-AH-ORIG-TERM  TO OUT-TERM
  5004           MOVE CM-AH-BENEFIT-CD TO OUT-BEN-CD
  5005           MOVE CM-AH-CRITICAL-PERIOD
  5006                                 TO OUT-CRIT-PER
  5007           MOVE CM-AH-LOAN-EXPIRE-DT
  5008                                 TO DC-BIN-DATE-1
  5009           MOVE ' '              TO DC-OPTION-CODE
  5010           PERFORM 9700-DATE-LINK
  5011                                 THRU 9700-EXIT
  5012           IF NO-CONVERSION-ERROR
  5013              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5014                 DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5015                 INTO OUT-EXP-DT
  5016              END-STRING
  5017           ELSE
  5018              MOVE SPACES        TO OUT-EXP-DT
  5019           END-IF
  5020        END-IF
  5021        MOVE CM-ACCOUNT          TO OUT-CERTACCT
  5022        IF CL-INSURED-1ST-NAME = CM-INSURED-FIRST-NAME
  5023            MOVE CM-JT-FIRST-NAME TO OUT-JFNAME
  5024            MOVE CM-JT-LAST-NAME  TO OUT-JLNAME
  5025        ELSE
  5026            MOVE CM-INSURED-FIRST-NAME TO OUT-JFNAME
  5027            MOVE CM-INSURED-LAST-NAME TO OUT-JLNAME
  5028        END-IF
  5029        MOVE CM-LOAN-APR         TO OUT-APR
  5030     END-IF
  5031     .
  5032 1100-EXIT.
  5033     EXIT.
  5034 1200-GET-ERACCT.
  5035    MOVE LOW-VALUES              TO WS-ERACCT-KEY
  5036    MOVE WS-ELCERT-KEY (1:22)    TO WS-ERACCT-KEY (1:22)
  5037
  5038* EXEC CICS STARTBR
  5039*        DATASET   ('ERACCT')
  5040*        RIDFLD    (WS-ERACCT-KEY)
  5041*        GTEQ
  5042*        RESP      (WS-RESPONSE)
  5043*    END-EXEC
  5044     MOVE 'ERACCT' TO DFHEIV1
  5045     MOVE 0
  5046       TO DFHEIV11
  5047*    MOVE '&,         G          &  N#00004960' TO DFHEIV0
  5048     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5049     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5050     MOVE X'204E233030303034393630' TO DFHEIV0(25:11)
  5051     CALL 'kxdfhei1' USING DFHEIV0,
  5052           DFHEIV1,
  5053           WS-ERACCT-KEY,
  5054           DFHEIV99,
  5055           DFHEIV11,
  5056           DFHEIV99
  5057     MOVE EIBRESP  TO WS-RESPONSE
  5058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5059     IF RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  89
* NSRLTRBL.cbl
  5060
  5061* EXEC CICS READNEXT
  5062*          INTO    (ACCOUNT-MASTER)
  5063*          DATASET ('ERACCT')
  5064*          RIDFLD  (WS-ERACCT-KEY)
  5065*          RESP    (WS-RESPONSE)
  5066*       END-EXEC
  5067     MOVE LENGTH OF
  5068      ACCOUNT-MASTER
  5069       TO DFHEIV12
  5070     MOVE 'ERACCT' TO DFHEIV1
  5071     MOVE 0
  5072       TO DFHEIV11
  5073*    MOVE '&.IL                  )  N#00004967' TO DFHEIV0
  5074     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5075     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5076     MOVE X'204E233030303034393637' TO DFHEIV0(25:11)
  5077     CALL 'kxdfhei1' USING DFHEIV0,
  5078           DFHEIV1,
  5079           ACCOUNT-MASTER,
  5080           DFHEIV12,
  5081           WS-ERACCT-KEY,
  5082           DFHEIV99,
  5083           DFHEIV11,
  5084           DFHEIV99,
  5085           DFHEIV99
  5086     MOVE EIBRESP  TO WS-RESPONSE
  5087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5088     END-IF
  5089     IF RESP-NORMAL
  5090        PERFORM WITH TEST AFTER UNTIL
  5091           NOT (RESP-NORMAL)
  5092           OR (CM-CONTROL-PRIMARY (1:20) NOT =
  5093                        AM-CONTROL-PRIMARY (1:20))
  5094           IF (CM-CONTROL-PRIMARY (1:20)
  5095              = AM-CONTROL-PRIMARY (1:20))
  5096              IF (CL-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5097                 AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5098                 MOVE AM-NAME    TO OUT-ORIG-NAME
  5099                 MOVE ACCOUNT-MASTER TO SAVE-ACCOUNT-MASTER
  5100              END-IF
  5101              MOVE AM-NAME       TO OUT-ACCT-NAME
  5102              MOVE AM-ADDRS      TO OUT-ACCT-ADDR1
  5103              MOVE SPACES        TO OUT-ACCT-ADDR2
  5104              MOVE AM-ADDR-CITY  TO OUT-ACCT-CITY
  5105              MOVE AM-ADDR-STATE TO OUT-ACCT-STATE
  5106              MOVE AM-ZIP-PRIME  TO OUT-ACCT-ZIP
  5107              IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5108                 STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  5109                    INTO OUT-ACCT-ZIP (6:5)
  5110                 END-STRING
  5111              END-IF
  5112              MOVE AM-TEL-NO     TO OUT-ACCT-PHONE
  5113              MOVE AM-GPCD       TO OUT-ACCT-GPCD
  5114
  5115* EXEC CICS READNEXT
  5116*                INTO    (ACCOUNT-MASTER)
  5117*                DATASET ('ERACCT')
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  90
* NSRLTRBL.cbl
  5118*                RIDFLD  (WS-ERACCT-KEY)
  5119*                RESP    (WS-RESPONSE)
  5120*             END-EXEC
  5121     MOVE LENGTH OF
  5122      ACCOUNT-MASTER
  5123       TO DFHEIV12
  5124     MOVE 'ERACCT' TO DFHEIV1
  5125     MOVE 0
  5126       TO DFHEIV11
  5127*    MOVE '&.IL                  )  N#00004999' TO DFHEIV0
  5128     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5129     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5130     MOVE X'204E233030303034393939' TO DFHEIV0(25:11)
  5131     CALL 'kxdfhei1' USING DFHEIV0,
  5132           DFHEIV1,
  5133           ACCOUNT-MASTER,
  5134           DFHEIV12,
  5135           WS-ERACCT-KEY,
  5136           DFHEIV99,
  5137           DFHEIV11,
  5138           DFHEIV99,
  5139           DFHEIV99
  5140     MOVE EIBRESP  TO WS-RESPONSE
  5141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5142           END-IF
  5143        END-PERFORM
  5144     END-IF
  5145     MOVE SAVE-ACCOUNT-MASTER  TO ACCOUNT-MASTER
  5146    .
  5147 1200-EXIT.
  5148     EXIT.
  5149 1250-GET-ELLETR.
  5150     MOVE CL-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  5151     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  5152     MOVE +0                     TO WS-ELLETR-SEQ-NO
  5153
  5154* EXEC CICS READ
  5155*         DATASET    ('ELLETR')
  5156*         INTO       (TEXT-FILES)
  5157*         RIDFLD     (WS-ELLETR-KEY)
  5158*         RESP       (WS-RESPONSE)
  5159*         GTEQ
  5160*    END-EXEC
  5161     MOVE LENGTH OF
  5162      TEXT-FILES
  5163       TO DFHEIV11
  5164     MOVE 'ELLETR' TO DFHEIV1
  5165*    MOVE '&"IL       G          (  N#00005016' TO DFHEIV0
  5166     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5167     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5168     MOVE X'204E233030303035303136' TO DFHEIV0(25:11)
  5169     CALL 'kxdfhei1' USING DFHEIV0,
  5170           DFHEIV1,
  5171           TEXT-FILES,
  5172           DFHEIV11,
  5173           WS-ELLETR-KEY,
  5174           DFHEIV99,
  5175           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  91
* NSRLTRBL.cbl
  5176           DFHEIV99
  5177     MOVE EIBRESP  TO WS-RESPONSE
  5178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5179     IF RESP-NORMAL
  5180        IF (LETTER-FILE-TEXT)
  5181           AND (BL-LETTER-ID = TX-LETTER-NO)
  5182           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  5183           PERFORM 1280-PROCESS-Z-CONTROLS
  5184                                 THRU 1280-EXIT
  5185        END-IF
  5186     END-IF
  5187     .
  5188 1250-EXIT.
  5189     EXIT.
  5190 1280-PROCESS-Z-CONTROLS.
  5191     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  5192     IF W-FORM-TO-RESEND > SPACES
  5193        MOVE W-FORM-TO-RESEND    TO OUT-FORM
  5194     ELSE
  5195        MOVE SPACES              TO OUT-FORM
  5196     END-IF.
  5197*    MOVE W-ENCLOSURE-CD         TO OUT-ENC-CODE
  5198     .
  5199 1280-EXIT.
  5200     EXIT.
  5201 1300-GET-ELTRLRS.
  5202     MOVE CL-CONTROL-PRIMARY     TO WS-ELTRLR-KEY
  5203     MOVE +0                     TO WS-ELTRLR-SEQ-NO
  5204
  5205* EXEC CICS STARTBR
  5206*        DATASET   ('ELTRLR')
  5207*        RIDFLD    (WS-ELTRLR-KEY)
  5208*        GTEQ
  5209*        RESP      (WS-RESPONSE)
  5210*    END-EXEC
  5211     MOVE 'ELTRLR' TO DFHEIV1
  5212     MOVE 0
  5213       TO DFHEIV11
  5214*    MOVE '&,         G          &  N#00005048' TO DFHEIV0
  5215     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5216     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5217     MOVE X'204E233030303035303438' TO DFHEIV0(25:11)
  5218     CALL 'kxdfhei1' USING DFHEIV0,
  5219           DFHEIV1,
  5220           WS-ELTRLR-KEY,
  5221           DFHEIV99,
  5222           DFHEIV11,
  5223           DFHEIV99
  5224     MOVE EIBRESP  TO WS-RESPONSE
  5225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5226    IF RESP-NORMAL
  5227
  5228* EXEC CICS READNEXT
  5229*         INTO    (ACTIVITY-TRAILERS)
  5230*         DATASET ('ELTRLR')
  5231*         RIDFLD  (WS-ELTRLR-KEY)
  5232*         RESP    (WS-RESPONSE)
  5233*      END-EXEC
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  92
* NSRLTRBL.cbl
  5234     MOVE LENGTH OF
  5235      ACTIVITY-TRAILERS
  5236       TO DFHEIV12
  5237     MOVE 'ELTRLR' TO DFHEIV1
  5238     MOVE 0
  5239       TO DFHEIV11
  5240*    MOVE '&.IL                  )  N#00005055' TO DFHEIV0
  5241     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5242     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5243     MOVE X'204E233030303035303535' TO DFHEIV0(25:11)
  5244     CALL 'kxdfhei1' USING DFHEIV0,
  5245           DFHEIV1,
  5246           ACTIVITY-TRAILERS,
  5247           DFHEIV12,
  5248           WS-ELTRLR-KEY,
  5249           DFHEIV99,
  5250           DFHEIV11,
  5251           DFHEIV99,
  5252           DFHEIV99
  5253     MOVE EIBRESP  TO WS-RESPONSE
  5254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5255       PERFORM 1310-GET-ELTRLRS THRU 1310-EXIT
  5256    END-IF
  5257     .
  5258 1300-EXIT.
  5259     EXIT.
  5260 1310-GET-ELTRLRS.
  5261     IF RESP-NORMAL
  5262     IF CL-CONTROL-PRIMARY = AT-CONTROL-PRIMARY (1:20)
  5263        EVALUATE TRUE
  5264           WHEN AT-INSURED-ADDR-TRL
  5265              MOVE AT-MAIL-TO-NAME   TO OUT-INS-NAME
  5266              MOVE AT-ADDRESS-LINE-1 TO OUT-INS-ADDR1
  5267              MOVE AT-ADDRESS-LINE-2 TO OUT-INS-ADDR2
  5268              MOVE AT-CITY           TO OUT-INS-CITY
  5269              MOVE AT-STATE          TO OUT-INS-STATE
  5270              MOVE AT-ZIP-CODE       TO OUT-INS-ZIP
  5271              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5272                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5273                    INTO OUT-INS-ZIP (6:5)
  5274                 END-STRING
  5275              END-IF
  5276              MOVE AT-PHONE-NO       TO OUT-INS-PHONE
  5277           WHEN AT-BENEFICIARY-ADDR-TRL
  5278              SET FOUND-BENE TO TRUE
  5279              MOVE AT-MAIL-TO-NAME   TO OUT-BEN-NAME
  5280              MOVE AT-ADDRESS-LINE-1 TO OUT-BEN-ADDR1
  5281              MOVE AT-ADDRESS-LINE-2 TO OUT-BEN-ADDR2
  5282              MOVE AT-CITY           TO OUT-BEN-CITY
  5283              MOVE AT-STATE          TO OUT-BEN-STATE
  5284              MOVE AT-ZIP-CODE       TO OUT-BEN-ZIP
  5285              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5286                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5287                    INTO OUT-BEN-ZIP (6:5)
  5288                 END-STRING
  5289              END-IF
  5290              MOVE AT-PHONE-NO       TO OUT-BEN-PHONE
  5291           WHEN AT-ACCOUNT-ADDR-TRL
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  93
* NSRLTRBL.cbl
  5292              MOVE AT-MAIL-TO-NAME   TO OUT-ACCT-NAME
  5293              MOVE AT-ADDRESS-LINE-1 TO OUT-ACCT-ADDR1
  5294              MOVE AT-ADDRESS-LINE-2 TO OUT-ACCT-ADDR2
  5295              MOVE AT-CITY           TO OUT-ACCT-CITY
  5296              MOVE AT-STATE          TO OUT-ACCT-STATE
  5297              MOVE AT-ZIP-CODE       TO OUT-ACCT-ZIP
  5298              IF AT-ZIP-PLUS4 NOT = SPACES AND ZEROS
  5299                 STRING '-' AT-ZIP-PLUS4 DELIMITED BY SIZE
  5300                    INTO OUT-ACCT-ZIP (6:5)
  5301                 END-STRING
  5302              END-IF
  5303              MOVE AT-PHONE-NO       TO OUT-ACCT-PHONE
  5304           WHEN AT-SEQUENCE-NO = +90
  5305              MOVE AT-INFO-LINE-1   TO OUT-DIAG
  5306           WHEN AT-SEQUENCE-NO = +91
  5307              MOVE AT-INFO-LINE-1 TO OUT-LOAN-NO
  5308           WHEN AT-TRAILER-TYPE = '2' AND AT-PAYMENT-TYPE = 'I'
  5309              IF AT-INT-RATE NUMERIC AND
  5310                 AT-INT-RATE NOT EQUAL ZEROS
  5311                    COMPUTE OUT-LF-INT-RATE = AT-INT-RATE * 100
  5312              END-IF
  5313           WHEN AT-TRAILER-TYPE = '3'
  5314              IF (SAVE-BIN-DATE >= AT-SCHEDULE-START-DT)
  5315                 AND (SAVE-BIN-DATE <= AT-SCHEDULE-END-DT)
  5316                 AND (AT-TERMINATED-DT = LOW-VALUES OR SPACES)
  5317                 MOVE AT-SCHEDULE-END-DT TO WS-AUTO-LAST-SCHED-DT
  5318              END-IF
  5319           WHEN AT-TRAILER-TYPE = '8'
  5320              IF AT-RECORDED-DT > WS-LAST-ACT-DT
  5321                 MOVE AT-RECORDED-DT
  5322                              TO WS-LAST-ACT-DT
  5323                 MOVE 'DENIAL'
  5324                              TO WS-LAST-ACT-TYPE
  5325              END-IF
  5326           WHEN AT-TRAILER-TYPE = 'A'
  5327              IF AT-RECORDED-DT > WS-LAST-ACT-DT
  5328                 MOVE AT-RECORDED-DT
  5329                              TO WS-LAST-ACT-DT
  5330                 MOVE 'FORMS' TO WS-LAST-ACT-TYPE
  5331                 IF INITIAL-FORM
  5332                    MOVE 'INIT'
  5333                              TO WS-FORM
  5334                 END-IF
  5335                 IF PROGRESS-FORM
  5336                    MOVE 'PROG'
  5337                              TO WS-FORM
  5338                 END-IF
  5339              END-IF
  5340              IF AT-FORM-SEND-ON-DT > WS-ACTIVITY-DT
  5341                 MOVE AT-FORM-SEND-ON-DT
  5342                              TO WS-ACTIVITY-DT
  5343              END-IF
  5344              IF AT-FORM-REPRINT-DT > WS-ACTIVITY-DT
  5345                 MOVE AT-FORM-REPRINT-DT
  5346                              TO WS-ACTIVITY-DT
  5347              END-IF
  5348              IF AT-FORM-ANSWERED-DT > WS-ACTIVITY-DT
  5349                 MOVE AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  94
* NSRLTRBL.cbl
  5350                              TO WS-ACTIVITY-DT
  5351              END-IF
  5352        END-EVALUATE
  5353
  5354* EXEC CICS READNEXT
  5355*         INTO    (ACTIVITY-TRAILERS)
  5356*         DATASET ('ELTRLR')
  5357*         RIDFLD  (WS-ELTRLR-KEY)
  5358*         RESP    (WS-RESPONSE)
  5359*       END-EXEC
  5360     MOVE LENGTH OF
  5361      ACTIVITY-TRAILERS
  5362       TO DFHEIV12
  5363     MOVE 'ELTRLR' TO DFHEIV1
  5364     MOVE 0
  5365       TO DFHEIV11
  5366*    MOVE '&.IL                  )  N#00005159' TO DFHEIV0
  5367     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5368     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5369     MOVE X'204E233030303035313539' TO DFHEIV0(25:11)
  5370     CALL 'kxdfhei1' USING DFHEIV0,
  5371           DFHEIV1,
  5372           ACTIVITY-TRAILERS,
  5373           DFHEIV12,
  5374           WS-ELTRLR-KEY,
  5375           DFHEIV99,
  5376           DFHEIV11,
  5377           DFHEIV99,
  5378           DFHEIV99
  5379     MOVE EIBRESP  TO WS-RESPONSE
  5380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5381        GO TO 1310-GET-ELTRLRS
  5382     END-IF
  5383     END-IF
  5384     .
  5385 1310-EXIT.
  5386     EXIT.
  5387 1400-GET-WAIT-PER.
  5388     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  5389     MOVE CM-AH-BENEFIT-CD       TO WS-ELCNTL-BEN-CD
  5390     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  5391     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  5392
  5393* EXEC CICS READ
  5394*       INTO    (CONTROL-FILE)
  5395*       DATASET ('ELCNTL')
  5396*       RIDFLD  (WS-ELCNTL-KEY)
  5397*       GTEQ
  5398*       RESP    (WS-RESPONSE)
  5399*    END-EXEC
  5400     MOVE LENGTH OF
  5401      CONTROL-FILE
  5402       TO DFHEIV11
  5403     MOVE 'ELCNTL' TO DFHEIV1
  5404*    MOVE '&"IL       G          (  N#00005176' TO DFHEIV0
  5405     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5406     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5407     MOVE X'204E233030303035313736' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  95
* NSRLTRBL.cbl
  5408     CALL 'kxdfhei1' USING DFHEIV0,
  5409           DFHEIV1,
  5410           CONTROL-FILE,
  5411           DFHEIV11,
  5412           WS-ELCNTL-KEY,
  5413           DFHEIV99,
  5414           DFHEIV99,
  5415           DFHEIV99
  5416     MOVE EIBRESP  TO WS-RESPONSE
  5417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5418     IF RESP-NORMAL
  5419        AND (CF-COMPANY-ID  = BL-COMP-ID)
  5420        AND (CF-RECORD-TYPE = '5')
  5421        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5422           (S1 > +8)
  5423           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5424        END-PERFORM
  5425        IF S1 > +8
  5426           MOVE '**'             TO OUT-WAIT-PER
  5427        ELSE
  5428           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  5429                                 TO OUT-WAIT-PER
  5430        END-IF
  5431     ELSE
  5432        MOVE '**'                TO OUT-WAIT-PER
  5433     END-IF
  5434    .
  5435 1400-EXIT.
  5436     EXIT.
  5437 1500-GET-ARCH-NO.
  5438     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  5439     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  5440     MOVE SPACES                 TO WS-ELCNTL-GENL
  5441     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  5442
  5443* EXEC CICS READ
  5444*       INTO    (CONTROL-FILE)
  5445*       DATASET ('ELCNTL')
  5446*       RIDFLD  (WS-ELCNTL-KEY)
  5447*       UPDATE
  5448*       RESP    (WS-RESPONSE)
  5449*    END-EXEC
  5450     MOVE LENGTH OF
  5451      CONTROL-FILE
  5452       TO DFHEIV11
  5453     MOVE 'ELCNTL' TO DFHEIV1
  5454*    MOVE '&"IL       EU         (  N#00005208' TO DFHEIV0
  5455     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5456     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5457     MOVE X'204E233030303035323038' TO DFHEIV0(25:11)
  5458     CALL 'kxdfhei1' USING DFHEIV0,
  5459           DFHEIV1,
  5460           CONTROL-FILE,
  5461           DFHEIV11,
  5462           WS-ELCNTL-KEY,
  5463           DFHEIV99,
  5464           DFHEIV99,
  5465           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  96
* NSRLTRBL.cbl
  5466     MOVE EIBRESP  TO WS-RESPONSE
  5467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5468     IF RESP-NORMAL
  5469        AND (CF-COMPANY-ID  = BL-COMP-ID)
  5470        AND (CF-RECORD-TYPE = '1')
  5471        ADD +1                   TO CF-CO-ARCHIVE-COUNTER
  5472        MOVE CF-CO-ARCHIVE-COUNTER TO WS-ARCHIVE-NO
  5473        MOVE WS-ARCHIVE-NO       TO BL-ARCHIVE-NO
  5474
  5475* EXEC CICS REWRITE
  5476*          FROM    (CONTROL-FILE)
  5477*          DATASET ('ELCNTL')
  5478*       END-EXEC
  5479     MOVE LENGTH OF
  5480      CONTROL-FILE
  5481       TO DFHEIV11
  5482     MOVE 'ELCNTL' TO DFHEIV1
  5483*    MOVE '&& L                  %   #00005221' TO DFHEIV0
  5484     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5485     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5486     MOVE X'2020233030303035323231' TO DFHEIV0(25:11)
  5487     CALL 'kxdfhei1' USING DFHEIV0,
  5488           DFHEIV1,
  5489           CONTROL-FILE,
  5490           DFHEIV11,
  5491           DFHEIV99
  5492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5493     ELSE
  5494        MOVE +0                  TO WS-ARCHIVE-NO
  5495     END-IF
  5496    .
  5497 1500-EXIT.
  5498     EXIT.
  5499 1600-ADD-CORR-TRLR.
  5500
  5501* EXEC CICS READ
  5502*         DATASET    ('ELMSTR')
  5503*         INTO       (CLAIM-MASTER)
  5504*         RIDFLD     (WS-ELMSTR-KEY)
  5505*         UPDATE
  5506*         RESP       (WS-RESPONSE)
  5507*    END-EXEC
  5508     MOVE LENGTH OF
  5509      CLAIM-MASTER
  5510       TO DFHEIV11
  5511     MOVE 'ELMSTR' TO DFHEIV1
  5512*    MOVE '&"IL       EU         (  N#00005232' TO DFHEIV0
  5513     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5514     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5515     MOVE X'204E233030303035323332' TO DFHEIV0(25:11)
  5516     CALL 'kxdfhei1' USING DFHEIV0,
  5517           DFHEIV1,
  5518           CLAIM-MASTER,
  5519           DFHEIV11,
  5520           WS-ELMSTR-KEY,
  5521           DFHEIV99,
  5522           DFHEIV99,
  5523           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  97
* NSRLTRBL.cbl
  5524     MOVE EIBRESP  TO WS-RESPONSE
  5525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5526     IF NOT RESP-NORMAL
  5527        DISPLAY ' 1600 READ UPD MSTR ' WS-RESPONSE
  5528        GO TO 1600-EXIT
  5529     END-IF
  5530     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
  5531     PERFORM 2000-BUILD-ELNAPS   THRU 2000-EXIT
  5532     IF WS-FOLLOW-UP-DT > CL-NEXT-FOLLOWUP-DT
  5533        MOVE WS-FOLLOW-UP-DT     TO CL-NEXT-FOLLOWUP-DT
  5534     END-IF
  5535     IF WS-RESEND-DT > CL-NEXT-FOLLOWUP-DT
  5536        MOVE WS-RESEND-DT        TO CL-NEXT-FOLLOWUP-DT
  5537     END-IF
  5538     MOVE '2'                    TO CL-LAST-MAINT-TYPE
  5539     MOVE 'AT'                   TO ACTIVITY-TRAILERS
  5540     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY
  5541     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
  5542     MOVE  4                     TO AT-TRAILER-TYPE
  5543     MOVE SAVE-BIN-DATE          TO AT-RECORDED-DT
  5544                                    CL-LAST-MAINT-DT
  5545                                    AT-CORR-LAST-MAINT-DT
  5546     MOVE BL-PROC-ID             TO AT-RECORDED-BY
  5547                                    CL-LAST-MAINT-USER
  5548                                    AT-CORR-LAST-UPDATED-BY
  5549     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  5550                                    CL-LAST-MAINT-HHMMSS.
  5551     MOVE SAVE-BIN-DATE          TO AT-LETTER-SENT-DT.
  5552     MOVE WS-FOLLOW-UP-DT        TO AT-RECEIPT-FOLLOW-UP.
  5553     MOVE WS-RESEND-DT           TO AT-AUTO-RE-SEND-DT.
  5554     MOVE LOW-VALUES             TO AT-LETTER-ANSWERED-DT
  5555                                    AT-LETTER-PURGED-DT.
  5556     MOVE WS-ARCHIVE-NO          TO AT-LETTER-ARCHIVE-NO.
  5557     MOVE '3'                    TO AT-LETTER-ORIGIN
  5558     MOVE BL-LETTER-ID           TO AT-STD-LETTER-FORM
  5559     MOVE SAVE-BIN-DATE          TO AT-INITIAL-PRINT-DATE
  5560     MOVE LOW-VALUES             TO AT-RESEND-PRINT-DATE
  5561
  5562* EXEC CICS WRITE
  5563*         DATASET    ('ELTRLR')
  5564*         FROM       (ACTIVITY-TRAILERS)
  5565*         RIDFLD     (AT-CONTROL-PRIMARY)
  5566*         RESP       (WS-RESPONSE)
  5567*    END-EXEC
  5568     MOVE LENGTH OF
  5569      ACTIVITY-TRAILERS
  5570       TO DFHEIV11
  5571     MOVE 'ELTRLR' TO DFHEIV1
  5572*    MOVE '&$ L                  ''  N#00005274' TO DFHEIV0
  5573     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5574     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5575     MOVE X'204E233030303035323734' TO DFHEIV0(25:11)
  5576     CALL 'kxdfhei1' USING DFHEIV0,
  5577           DFHEIV1,
  5578           ACTIVITY-TRAILERS,
  5579           DFHEIV11,
  5580           AT-CONTROL-PRIMARY,
  5581           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  98
* NSRLTRBL.cbl
  5582           DFHEIV99
  5583     MOVE EIBRESP  TO WS-RESPONSE
  5584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5585     IF NOT RESP-NORMAL
  5586        DISPLAY ' 1600 WRITE TRLR ' WS-RESPONSE
  5587        GO TO 1600-EXIT
  5588     END-IF
  5589
  5590* EXEC CICS REWRITE
  5591*         DATASET    ('ELMSTR')
  5592*         FROM       (CLAIM-MASTER)
  5593*         RESP       (WS-RESPONSE)
  5594*    END-EXEC
  5595     MOVE LENGTH OF
  5596      CLAIM-MASTER
  5597       TO DFHEIV11
  5598     MOVE 'ELMSTR' TO DFHEIV1
  5599*    MOVE '&& L                  %  N#00005284' TO DFHEIV0
  5600     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5601     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5602     MOVE X'204E233030303035323834' TO DFHEIV0(25:11)
  5603     CALL 'kxdfhei1' USING DFHEIV0,
  5604           DFHEIV1,
  5605           CLAIM-MASTER,
  5606           DFHEIV11,
  5607           DFHEIV99
  5608     MOVE EIBRESP  TO WS-RESPONSE
  5609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5610     IF NOT RESP-NORMAL
  5611        DISPLAY ' 1600 REWRITE MSTR ' WS-RESPONSE
  5612     END-IF
  5613     .
  5614 1600-EXIT.
  5615     EXIT.
  5616 1700-GET-ELENCC.
  5617     MOVE CL-COMPANY-CD          TO WS-ELENCC-KEY
  5618     MOVE '1'                    TO WS-ELENCC-REC-TYPE
  5619     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  5620     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  5621        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  5622        OR (E1 > +5)
  5623     END-PERFORM
  5624     IF E1 < +5
  5625        MOVE CL-CERT-STATE       TO WS-ELENCC-ENC-CODE (E1:2)
  5626     END-IF
  5627
  5628* EXEC CICS READ
  5629*        DATASET   ('ELENCC')
  5630*        INTO      (ENCLOSURE-CODES)
  5631*        RIDFLD    (WS-ELENCC-KEY)
  5632*        RESP      (WS-RESPONSE)
  5633*    END-EXEC
  5634     MOVE LENGTH OF
  5635      ENCLOSURE-CODES
  5636       TO DFHEIV11
  5637     MOVE 'ELENCC' TO DFHEIV1
  5638*    MOVE '&"IL       E          (  N#00005306' TO DFHEIV0
  5639     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page  99
* NSRLTRBL.cbl
  5640     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5641     MOVE X'204E233030303035333036' TO DFHEIV0(25:11)
  5642     CALL 'kxdfhei1' USING DFHEIV0,
  5643           DFHEIV1,
  5644           ENCLOSURE-CODES,
  5645           DFHEIV11,
  5646           WS-ELENCC-KEY,
  5647           DFHEIV99,
  5648           DFHEIV99,
  5649           DFHEIV99
  5650     MOVE EIBRESP  TO WS-RESPONSE
  5651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5652     IF NOT RESP-NORMAL
  5653        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  5654
  5655* EXEC CICS READ
  5656*           DATASET   ('ELENCC')
  5657*           INTO      (ENCLOSURE-CODES)
  5658*           RIDFLD    (WS-ELENCC-KEY)
  5659*           RESP      (WS-RESPONSE)
  5660*       END-EXEC
  5661     MOVE LENGTH OF
  5662      ENCLOSURE-CODES
  5663       TO DFHEIV11
  5664     MOVE 'ELENCC' TO DFHEIV1
  5665*    MOVE '&"IL       E          (  N#00005314' TO DFHEIV0
  5666     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5667     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5668     MOVE X'204E233030303035333134' TO DFHEIV0(25:11)
  5669     CALL 'kxdfhei1' USING DFHEIV0,
  5670           DFHEIV1,
  5671           ENCLOSURE-CODES,
  5672           DFHEIV11,
  5673           WS-ELENCC-KEY,
  5674           DFHEIV99,
  5675           DFHEIV99,
  5676           DFHEIV99
  5677     MOVE EIBRESP  TO WS-RESPONSE
  5678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5679     END-IF
  5680     IF RESP-NORMAL
  5681        MOVE NC-OUTPUT-STACK     TO OUT-OUTSTACK
  5682        MOVE NC-ENCLOSURE-LINE   TO OUT-ENCLINE
  5683        MOVE NC-ATTACHMENTS      TO OUT-ENCATTS
  5684     END-IF
  5685     .
  5686 1700-EXIT.
  5687     EXIT.
  5688 1800-SET-EL150D-FIELDS.
  5689     MOVE SPACES TO WS-UNSORTED-TABLE
  5690                    WS-SORTED-TABLE
  5691
  5692     MOVE ' '                    TO WS-PDEF-RECORD-SW
  5693
  5694     MOVE CM-CONTROL-PRIMARY     TO ELCRTT-KEY
  5695     MOVE 'B'                    TO CRTT-REC-TYPE
  5696
  5697
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page 100
* NSRLTRBL.cbl
  5698* EXEC CICS READ
  5699*       DATASET   ('ELCRTT')
  5700*       INTO      (CERTIFICATE-TRAILERS)
  5701*       RIDFLD    (ELCRTT-KEY)
  5702*       RESP      (WS-RESPONSE)
  5703*    END-EXEC
  5704     MOVE LENGTH OF
  5705      CERTIFICATE-TRAILERS
  5706       TO DFHEIV11
  5707     MOVE 'ELCRTT' TO DFHEIV1
  5708*    MOVE '&"IL       E          (  N#00005338' TO DFHEIV0
  5709     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5710     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5711     MOVE X'204E233030303035333338' TO DFHEIV0(25:11)
  5712     CALL 'kxdfhei1' USING DFHEIV0,
  5713           DFHEIV1,
  5714           CERTIFICATE-TRAILERS,
  5715           DFHEIV11,
  5716           ELCRTT-KEY,
  5717           DFHEIV99,
  5718           DFHEIV99,
  5719           DFHEIV99
  5720     MOVE EIBRESP  TO WS-RESPONSE
  5721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5722
  5723     IF NOT RESP-NORMAL
  5724        DISPLAY ' NSRLTRBL- NO TRLRS ' CL-CERT-NO
  5725        GO TO 1800-EXIT
  5726     END-IF
  5727
  5728     DISPLAY ' NSRLTRBL- GOOD READ ON ELCRTT '
  5729     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5730       (S1 > +24)
  5731       OR (CS-CLAIM-NO (S1) = SPACES)
  5732        MOVE CS-CLAIM-NO (S1)    TO WS-CLAIM-NO (S1)
  5733        MOVE CS-CLAIM-TYPE (S1)  TO WS-CLM-TYPE (S1)
  5734        IF CS-INSURED-TYPE (S1) = 'C'
  5735           MOVE '2'              TO WS-INS-TYPE (S1)
  5736        ELSE
  5737           MOVE '1'              TO WS-INS-TYPE (S1)
  5738        END-IF
  5739        MOVE CS-BENEFIT-PERIOD (S1)
  5740                                 TO WS-BEN-PER (S1)
  5741*       MOVE CS-DAYS-PAID (S1)   TO WS-DAYS-PAID (S1)
  5742        MOVE CS-TOTAL-PAID (S1)  TO WS-TOTAL-PAID (S1)
  5743        MOVE ' '                 TO WS-SORTED-SW (S1)
  5744
  5745        MOVE CS-COMPANY-CD          TO WS-ELMSTR-COMPANY-CD
  5746        MOVE CS-CARRIER             TO WS-ELMSTR-CARRIER
  5747        MOVE CS-CLAIM-NO (S1)       TO WS-ELMSTR-CLAIM-NO
  5748        MOVE CS-CERT-NO             TO WS-ELMSTR-CERT-NO
  5749
  5750
  5751* EXEC CICS READ
  5752*          DATASET        ('ELMSTR')
  5753*          RIDFLD         (WS-ELMSTR-KEY)
  5754*          INTO           (CLAIM-MASTER)
  5755*          RESP           (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page 101
* NSRLTRBL.cbl
  5756*       END-EXEC
  5757     MOVE LENGTH OF
  5758      CLAIM-MASTER
  5759       TO DFHEIV11
  5760     MOVE 'ELMSTR' TO DFHEIV1
  5761*    MOVE '&"IL       E          (  N#00005372' TO DFHEIV0
  5762     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5763     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5764     MOVE X'204E233030303035333732' TO DFHEIV0(25:11)
  5765     CALL 'kxdfhei1' USING DFHEIV0,
  5766           DFHEIV1,
  5767           CLAIM-MASTER,
  5768           DFHEIV11,
  5769           WS-ELMSTR-KEY,
  5770           DFHEIV99,
  5771           DFHEIV99,
  5772           DFHEIV99
  5773     MOVE EIBRESP  TO WS-RESPONSE
  5774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5775        IF RESP-NORMAL
  5776           MOVE CL-INCURRED-DT   TO WS-INC-DT (S1)
  5777           MOVE CL-PAID-THRU-DT  TO WS-PD-THRU-DT (S1)
  5778           MOVE CL-CLAIM-STATUS  TO WS-STATUS (S1)
  5779           IF CL-CRITICAL-PERIOD NOT NUMERIC
  5780              MOVE ZEROS TO CL-CRITICAL-PERIOD
  5781           END-IF
  5782           MOVE CL-CRITICAL-PERIOD
  5783                                 TO WS-MAX-BENS (S1)
  5784           IF CL-CRITICAL-PERIOD = ZEROS
  5785              IF CL-CLAIM-TYPE = 'L' OR 'P' OR 'O'
  5786                 MOVE 01         TO WS-MAX-BENS (S1)
  5787              ELSE
  5788                 MOVE CM-AH-ORIG-TERM
  5789                                 TO WS-MAX-BENS (S1)
  5790              END-IF
  5791           END-IF
  5792           IF CL-DENIAL-TYPE = '1' OR '2' OR '3' OR '4'
  5793              MOVE 'D'           TO WS-STATUS (S1)
  5794           END-IF
  5795           IF CS-CLAIM-NO (S1) = BL-CLAIM-NO
  5796              MOVE CL-ACCIDENT-CLAIM-SW TO OUT-ACC-SW
  5797           END-IF
  5798
  5799           MOVE ' '                    TO WS-PDEF-RECORD-SW
  5800           IF (AM-DCC-PRODUCT-CODE NOT = SPACES)
  5801              PERFORM 1850-GET-DDF-LIMITS
  5802                                 THRU 1850-EXIT
  5803           END-IF
  5804           IF PDEF-FOUND
  5805              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  5806                 (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
  5807                 OR (P1 > +8)
  5808              END-PERFORM
  5809              IF P1 < +9
  5810                 IF CL-CLAIM-TYPE = 'L' OR 'P' OR 'O'
  5811                    IF (PD-MAX-AMT (P1) NOT = ZEROS)
  5812                       AND (PD-MAX-AMT (P1) < CM-LF-BENEFIT-AMT)
  5813                       MOVE PD-MAX-AMT (P1)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page 102
* NSRLTRBL.cbl
  5814                                 TO WS-MAX-MOBEN (S1)
  5815                    ELSE
  5816                       MOVE CM-LF-BENEFIT-AMT
  5817                                 TO WS-MAX-MOBEN (S1)
  5818                    END-IF
  5819                 ELSE
  5820                    IF PD-BEN-PCT (P1) NOT NUMERIC
  5821                       MOVE ZEROS   TO PD-BEN-PCT (P1)
  5822                    END-IF
  5823                    IF PD-BEN-PCT (P1) = ZEROS
  5824                       MOVE +1      TO WS-WORK-BEN-PCT
  5825                    ELSE
  5826                       MOVE PD-BEN-PCT (P1)
  5827                                    TO WS-WORK-BEN-PCT
  5828                    END-IF
  5829                    COMPUTE WS-MAX-MOBEN (S1) =
  5830                       CM-AH-BENEFIT-AMT * WS-WORK-BEN-PCT
  5831                    IF (PD-MAX-AMT (P1) NOT = ZEROS)
  5832                       AND (PD-MAX-AMT (P1) < WS-MAX-MOBEN (S1))
  5833                       MOVE PD-MAX-AMT (P1)
  5834                                 TO WS-MAX-MOBEN (S1)
  5835                    END-IF
  5836                 END-IF
  5837*                IF (PD-MAX-AMT (P1) NOT = ZEROS)
  5838*                   AND (PD-MAX-AMT (P1) < CM-AH-BENEFIT-AMT)
  5839*                   MOVE PD-MAX-AMT (P1) TO WS-MAX-MOBEN (S1)
  5840*                ELSE
  5841*                   MOVE CM-AH-BENEFIT-AMT TO WS-MAX-MOBEN (S1)
  5842*                END-IF
  5843                 MOVE PD-EXCLUSION-PERIOD-DAYS (P1)
  5844                                 TO WS-EXCL-PER (S1)
  5845                 MOVE PD-COVERAGE-ENDS-MOS (P1)
  5846                                 TO WS-COV-ENDS (S1)
  5847                 MOVE PD-ACCIDENT-ONLY-MOS (P1)
  5848                                 TO WS-ACC-PER (S1)
  5849                 MOVE PD-MAX-EXTENSION (P1)
  5850                                 TO WS-MAX-EXTEN (S1)
  5851                 EVALUATE TRUE
  5852                    WHEN PD-RECURRING-YN (P1) = 'N'
  5853                       MOVE 00   TO WS-REC-MOS (S1)
  5854                    WHEN PD-RECURRING-YN (P1) = 'Y'
  5855                       MOVE 99   TO WS-REC-MOS (S1)
  5856                    WHEN PD-REC-CRIT-PERIOD (P1) NUMERIC
  5857                       MOVE PD-REC-CRIT-PERIOD (P1)
  5858                                 TO WS-REC-MOS (S1)
  5859                    WHEN OTHER
  5860                       MOVE ZEROS TO WS-REC-MOS (S1)
  5861                 END-EVALUATE
  5862                 IF WS-REC-MOS (S1) = ZEROS
  5863                    MOVE 01      TO WS-REC-MOS (S1)
  5864                 END-IF
  5865                 DISPLAY ' NSRLTRBL- PDEF FOUND ' WS-EXCL-PER (S1)
  5866              END-IF
  5867           ELSE
  5868              IF CL-CLAIM-TYPE NOT = 'L' AND 'P' AND 'O'
  5869                 MOVE CM-AH-BENEFIT-AMT
  5870                                 TO WS-MAX-MOBEN (S1)
  5871              ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page 103
* NSRLTRBL.cbl
  5872                 MOVE ZEROS      TO WS-MAX-MOBEN (S1)
  5873              END-IF
  5874              MOVE ZEROS         TO WS-EXCL-PER (S1)
  5875                                    WS-MAX-EXTEN (S1)
  5876                                    WS-ACC-PER  (S1)
  5877              MOVE 999           TO WS-COV-ENDS (S1)
  5878              MOVE 01            TO WS-REC-MOS  (S1)
  5879           END-IF
  5880        END-IF
  5881     END-PERFORM
  5882
  5883*      SORT THE TABLE
  5884     MOVE HIGH-VALUES            TO WS-KEY (S1)
  5885     COMPUTE WS-MAX-SUB = S1 - +1
  5886     DISPLAY ' NSRLTRBL- JUST BUILT TABLE '   WS-MAX-SUB
  5887
  5888     MOVE WS-MAX-SUB             TO WS-CNTR
  5889
  5890     MOVE +1                     TO S2
  5891     MOVE +0                     TO S3
  5892     PERFORM UNTIL (WS-CNTR = ZERO) OR (S3 > 700)
  5893        MOVE +0 TO WS-HOLD-S1
  5894        MOVE HIGH-VALUES TO WS-HOLD-KEY
  5895        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5896           (S1 > WS-MAX-SUB)
  5897           IF (WS-SORTED-SW (S1) NOT = 'Y')
  5898              AND (WS-KEY (S1) <= WS-HOLD-KEY)
  5899              MOVE WS-KEY (S1)   TO WS-HOLD-KEY
  5900              MOVE S1            TO WS-HOLD-S1
  5901           END-IF
  5902        END-PERFORM
  5903        IF WS-HOLD-S1 NOT = ZEROS
  5904           MOVE WS-HOLD-S1         TO S1
  5905           MOVE WS-KEY        (S1) TO WS-SRTD-KEY        (S2)
  5906           MOVE WS-STATUS     (S1) TO WS-SRTD-STATUS     (S2)
  5907           MOVE WS-MAX-BENS   (S1) TO WS-SRTD-MAX-BENS   (S2)
  5908           MOVE WS-EXCL-PER   (S1) TO WS-SRTD-EXCL-PER   (S2)
  5909           MOVE WS-COV-ENDS   (S1) TO WS-SRTD-COV-ENDS   (S2)
  5910           MOVE WS-ACC-PER    (S1) TO WS-SRTD-ACC-PER    (S2)
  5911           MOVE WS-REC-MOS    (S1) TO WS-SRTD-REC-MOS    (S2)
  5912           MOVE WS-MAX-EXTEN  (S1) TO WS-SRTD-MAX-EXTEN  (S2)
  5913           MOVE WS-PD-THRU-DT (S1) TO WS-SRTD-PD-THRU-DT (S2)
  5914           MOVE WS-CLAIM-NO   (S1) TO WS-SRTD-CLAIM-NO   (S2)
  5915           MOVE WS-MAX-MOBEN  (S1) TO WS-SRTD-MAX-MOBEN  (S2)
  5916           MOVE WS-TOTAL-PAID (S1) TO WS-SRTD-TOTAL-PAID (S2)
  5917*          MOVE WS-REM-BENS   (S1) TO WS-SRTD-REM-BENS   (S2)
  5918           MOVE 'Y'                TO WS-SORTED-SW       (S1)
  5919           SUBTRACT 1 FROM WS-CNTR
  5920           ADD +1 TO S2
  5921        END-IF
  5922        ADD 1 TO S3
  5923     END-PERFORM
  5924
  5925     DISPLAY ' NSRLTRBL- JUST SORTED TABLE '
  5926
  5927***  -----------------------
  5928     IF BL-COMP-ID NOT = 'DCC' AND 'VPP'
  5929        PERFORM 1900-BUILD-NON-DCC
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page 104
* NSRLTRBL.cbl
  5930        GO TO 1800-EXIT
  5931     END-IF
  5932
  5933     MOVE SPACES                 TO WS-PREV-CLM-TYPE
  5934                                    WS-PREV-INS-TYPE
  5935     MOVE ZEROS                  TO WS-PREV-BEN-PER
  5936                                    WS-ACCUM-DAYS
  5937                                    WS-ACCUM-AMT
  5938                                    WS-ACCUM-PD-BENS
  5939
  5940     MOVE +1                     TO M1
  5941     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5942        S1 > WS-MAX-SUB
  5943        IF (WS-SRTD-CLM-TYPE (S1) = WS-PREV-CLM-TYPE)
  5944           AND (WS-SRTD-BEN-PER (S1) = WS-PREV-BEN-PER)
  5945           AND (WS-SRTD-INS-TYPE (S1) NOT = WS-PREV-INS-TYPE)
  5946           MOVE ZEROS            TO WS-ACCUM-DAYS
  5947                                    WS-ACCUM-AMT
  5948                                    WS-ACCUM-PD-BENS
  5949        END-IF
  5950        MOVE WS-SRTD-INS-TYPE (S1) TO WS-PREV-INS-TYPE
  5951        IF (WS-SRTD-CLM-TYPE (S1) = WS-PREV-CLM-TYPE)
  5952           AND (WS-SRTD-BEN-PER (S1) NOT = WS-PREV-BEN-PER)
  5953           MOVE ZEROS            TO WS-ACCUM-DAYS
  5954                                    WS-ACCUM-AMT
  5955                                    WS-ACCUM-PD-BENS
  5956        END-IF
  5957        MOVE WS-SRTD-BEN-PER (S1) TO WS-PREV-BEN-PER
  5958        IF WS-SRTD-CLM-TYPE (S1) NOT = WS-PREV-CLM-TYPE
  5959           PERFORM 1810-SET-NEW-HEAD
  5960                                 THRU 1810-EXIT
  5961           MOVE WS-SRTD-CLM-TYPE (S1)
  5962                                 TO WS-PREV-CLM-TYPE
  5963           ADD +1                TO M1
  5964        END-IF
  5965
  5966        MOVE WS-SRTD-BEN-PER (S1)  TO OUT-BEN-PER
  5967        IF WS-SRTD-INS-TYPE (S1) = '1'
  5968           MOVE 'PRIM'             TO OUT-INS-TYP
  5969        ELSE
  5970           MOVE 'COBO'             TO OUT-INS-TYP
  5971        END-IF
  5972*       EVALUATE WS-SRTD-STATUS (S1)
  5973*          WHEN 'C'
  5974*             MOVE 'CLOSED'        TO WSM-STATUS (M1)
  5975*          WHEN 'D'
  5976*             MOVE 'DENIED'        TO WSM-STATUS (M1)
  5977*          WHEN 'O'
  5978*             MOVE 'OPEN'          TO WSM-STATUS (M1)
  5979*          WHEN OTHER
  5980*             MOVE 'OTHER'         TO WSM-STATUS (M1)
  5981*       END-EVALUATE
  5982*       MOVE WS-SRTD-CLAIM-NO (S1) TO WSM-CLAIM-NO (M1)
  5983*                                     PI-WSM-CLAIM-NOS (S1)
  5984*       MOVE WS-SRTD-TOTAL-PAID (S1) TO WSM-TOTAL-PAID (M1)
  5985
  5986        COMPUTE OUT-MAX-BENS =
  5987           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page 105
* NSRLTRBL.cbl
  5988
  5989        DISPLAY ' NSRLTRBL- MAX BENS 1 ' OUT-MAX-BENS ' '
  5990           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  5991
  5992        MOVE ZEROS TO WK1 WK2
  5993        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  5994           COMPUTE WS-PD-BENS ROUNDED =
  5995              WS-SRTD-TOTAL-PAID (S1) / WS-SRTD-MAX-MOBEN (S1)
  5996           IF WS-SRTD-CLM-TYPE (S1) NOT = 'L' AND 'P'
  5997              DIVIDE WS-SRTD-TOTAL-PAID (S1) BY
  5998                 WS-SRTD-MAX-MOBEN(S1) GIVING WK1
  5999                 REMAINDER WK2
  6000           END-IF
  6001        ELSE
  6002           MOVE ZEROS            TO WS-PD-BENS
  6003        END-IF
  6004        IF (WS-PD-BENS = ZEROS)
  6005           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6006           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6007           MOVE 1                TO WS-PD-BENS
  6008        END-IF
  6009        MOVE WS-PD-BENS          TO OUT-PAID-BENS
  6010*       if wk2 not = zeros
  6011*          move '*'              to wsm-part (m1)
  6012*       end-if
  6013*       compute ws-accum-days =
  6014*          ws-accum-days + ws-srtd-days-paid (s1)
  6015        COMPUTE WS-ACCUM-AMT =
  6016           WS-ACCUM-AMT + WS-SRTD-TOTAL-PAID (S1)
  6017        DISPLAY ' NSRLTRBL- COMPUTE A PD BENS ' M1 ' '
  6018           WS-ACCUM-AMT ' ' WS-SRTD-MAX-MOBEN (S1)
  6019        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6020           COMPUTE WS-ACCUM-PD-BENS ROUNDED =
  6021              WS-ACCUM-AMT / WS-SRTD-MAX-MOBEN (S1)
  6022        ELSE
  6023           MOVE ZEROS            TO WS-ACCUM-PD-BENS
  6024        END-IF
  6025        IF (WS-ACCUM-PD-BENS = ZEROS)
  6026           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6027           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6028           MOVE 1                TO WS-ACCUM-PD-BENS
  6029        END-IF
  6030        DISPLAY ' NSRLTRBL- COMPUTE REM BENS ' M1 ' '
  6031           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6032        COMPUTE OUT-REM-BENS =
  6033           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  6034        PERFORM 1820-FIND-QUALIFY THRU 1820-EXIT
  6035
  6036*       MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-1
  6037*       MOVE ' '                    TO DC-OPTION-CODE
  6038*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6039*       IF NO-CONVERSION-ERROR
  6040*          MOVE DC-GREG-DATE-A-EDIT TO wsm-inc-date (m1)
  6041*       ELSE
  6042*          MOVE SPACES              TO wsm-inc-date (m1)
  6043*       END-IF
  6044*       MOVE ws-srtd-pd-thru-dt (s1) TO DC-BIN-DATE-1
  6045*       MOVE ' '                     TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page 106
* NSRLTRBL.cbl
  6046*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6047*       IF NO-CONVERSION-ERROR
  6048*          MOVE DC-GREG-DATE-A-EDIT TO wsm-pd-thru-dt (m1)
  6049*       ELSE
  6050*          MOVE SPACES              TO wsm-pd-thru-dt (m1)
  6051*       END-IF
  6052        ADD +1                   TO M1
  6053        IF WS-SRTD-CLAIM-NO (S1) = BL-CLAIM-NO
  6054           MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  6055           MOVE 26 TO S1
  6056        END-IF
  6057
  6058     END-PERFORM
  6059
  6060    DISPLAY ' NSRLTRBL- 1800 end MAX BENS '  OUT-MAX-BENS
  6061    display  ' PAID BENS ' OUT-PAID-BENS ' REM BENS ' OUT-REM-BENS
  6062    display  ' EXCL PER ' OUT-EXCL-PER ' REC MOS ' OUT-REC-MOS
  6063    display  ' INS TYP ' OUT-INS-TYP ' BEN PER ' OUT-BEN-PER
  6064    display  ' ACC SW ' OUT-ACC-SW
  6065
  6066     .
  6067 1800-EXIT.
  6068     EXIT.
  6069
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page 107
* NSRLTRBL.cbl
  6071
  6072 1810-SET-NEW-HEAD.
  6073     MOVE ZEROS                  TO WS-ACCUM-DAYS
  6074                                    WS-ACCUM-AMT
  6075                                    WS-ACCUM-PD-BENS
  6076     EVALUATE WS-SRTD-CLM-TYPE (S1)
  6077        WHEN 'A'
  6078           MOVE 'A&H'            TO WS-COV-TYPE
  6079        WHEN 'F'
  6080           MOVE 'FAM '           TO WS-COV-TYPE
  6081        WHEN 'I'
  6082           MOVE ' IU '           TO WS-COV-TYPE
  6083        WHEN 'L'
  6084           MOVE 'LIFE'           TO WS-COV-TYPE
  6085        WHEN OTHER
  6086           MOVE WS-SRTD-CLM-TYPE (S1)
  6087                                 TO WS-COV-TYPE
  6088     END-EVALUATE
  6089
  6090     MOVE WS-SRTD-REC-MOS (S1) TO OUT-REC-MOS
  6091     MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  6092
  6093*    string '  ' ws-cov-type ' ExPer ' OUT-EXCL-PER
  6094*       ' CovEnd ' ws-srtd-cov-ends (s1)
  6095*       ' MaxBens ' ws-srtd-max-bens (s1)
  6096*       ' Recurring ' OUT-REC-MOS
  6097*       delimited by size into ws-map-output (m1)
  6098*    end-string
  6099
  6100     .
  6101 1810-EXIT.
  6102     EXIT.
  6103
  6104 1820-FIND-QUALIFY.
  6105     IF NOT PDEF-FOUND
  6106        GO TO 1820-EXIT
  6107     END-IF
  6108
  6109     DISPLAY ' NSRLTRBL- MAX BENS 2 ' OUT-MAX-BENS ' '
  6110        WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6111
  6112     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  6113     MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-2
  6114     MOVE '1'                    TO DC-OPTION-CODE
  6115     MOVE +0                     TO DC-ELAPSED-MONTHS
  6116                                    DC-ELAPSED-DAYS
  6117     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6118
  6119     IF NO-CONVERSION-ERROR
  6120        DISPLAY ' NSRLTRBL- GOOD DATE CONVERT '
  6121        MOVE DC-ELAPSED-MONTHS   TO WS-MONTHS-BETWEEN
  6122        IF DC-ELAPSED-DAYS > 1
  6123           ADD 1 TO WS-MONTHS-BETWEEN
  6124        END-IF
  6125     ELSE
  6126        MOVE ZEROS               TO WS-MONTHS-BETWEEN
  6127     END-IF
  6128
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page 108
* NSRLTRBL.cbl
  6129     DISPLAY ' NSRLTRBL- DISPLAY 3 ' OUT-EXCL-PER
  6130        ' ' WS-SRTD-COV-ENDS (S1) ' ' WS-MONTHS-BETWEEN
  6131
  6132     EVALUATE TRUE
  6133        WHEN (OUT-EXCL-PER NOT = ZEROS)
  6134           AND (WS-MONTHS-BETWEEN <= OUT-EXCL-PER)
  6135           DISPLAY ' NSRLTRBL- ZERO 1 '
  6136           MOVE ZEROS TO OUT-MAX-BENS
  6137                         OUT-REM-BENS
  6138        WHEN (WS-SRTD-COV-ENDS (S1) NOT = ZEROS)
  6139           AND (WS-MONTHS-BETWEEN > WS-SRTD-COV-ENDS (S1))
  6140           DISPLAY ' NSRLTRBL- ZERO 2 '
  6141           MOVE ZEROS TO OUT-MAX-BENS
  6142     END-EVALUATE
  6143     IF OUT-REC-MOS < WS-SRTD-BEN-PER (S1)
  6144        MOVE ZEROS               TO OUT-REM-BENS
  6145     END-IF
  6146
  6147     .
  6148 1820-EXIT.
  6149     EXIT.
  6150
  6151 1850-GET-DDF-LIMITS.
  6152
  6153     IF CM-CLP-STATE = SPACES OR LOW-VALUES OR ZEROS
  6154        MOVE CM-STATE            TO CM-CLP-STATE
  6155     END-IF
  6156
  6157     MOVE CL-COMPANY-CD          TO ERPDEF-KEY
  6158     MOVE CM-CLP-STATE           TO ERPDEF-STATE
  6159     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  6160
  6161     IF (CL-CLAIM-TYPE = 'L' OR 'P' OR 'O')
  6162        AND (CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD')
  6163        MOVE 'L'                 TO ERPDEF-BEN-TYPE
  6164        MOVE CM-LF-BENEFIT-CD    TO ERPDEF-BEN-CODE
  6165     ELSE
  6166        MOVE 'A'                 TO ERPDEF-BEN-TYPE
  6167        MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  6168     END-IF
  6169
  6170     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  6171
  6172     DISPLAY ' NSRLTRBL- MADE 1850 ' ERPDEF-KEY (2:15)
  6173     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  6174
  6175
  6176* EXEC CICS STARTBR
  6177*        DATASET  ('ERPDEF')
  6178*        RIDFLD   (ERPDEF-KEY)
  6179*        GTEQ
  6180*        RESP     (WS-RESPONSE)
  6181*    END-EXEC
  6182     MOVE 'ERPDEF' TO DFHEIV1
  6183     MOVE 0
  6184       TO DFHEIV11
  6185*    MOVE '&,         G          &  N#00005778' TO DFHEIV0
  6186     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page 109
* NSRLTRBL.cbl
  6187     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6188     MOVE X'204E233030303035373738' TO DFHEIV0(25:11)
  6189     CALL 'kxdfhei1' USING DFHEIV0,
  6190           DFHEIV1,
  6191           ERPDEF-KEY,
  6192           DFHEIV99,
  6193           DFHEIV11,
  6194           DFHEIV99
  6195     MOVE EIBRESP  TO WS-RESPONSE
  6196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6197
  6198     IF NOT RESP-NORMAL
  6199        GO TO 1850-EXIT
  6200     END-IF
  6201
  6202     .
  6203 1850-READNEXT.
  6204
  6205
  6206* EXEC CICS READNEXT
  6207*       DATASET  ('ERPDEF')
  6208*       INTO     (PRODUCT-MASTER)
  6209*       RIDFLD   (ERPDEF-KEY)
  6210*       RESP     (WS-RESPONSE)
  6211*    END-EXEC
  6212     MOVE LENGTH OF
  6213      PRODUCT-MASTER
  6214       TO DFHEIV12
  6215     MOVE 'ERPDEF' TO DFHEIV1
  6216     MOVE 0
  6217       TO DFHEIV11
  6218*    MOVE '&.IL                  )  N#00005792' TO DFHEIV0
  6219     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6220     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6221     MOVE X'204E233030303035373932' TO DFHEIV0(25:11)
  6222     CALL 'kxdfhei1' USING DFHEIV0,
  6223           DFHEIV1,
  6224           PRODUCT-MASTER,
  6225           DFHEIV12,
  6226           ERPDEF-KEY,
  6227           DFHEIV99,
  6228           DFHEIV11,
  6229           DFHEIV99,
  6230           DFHEIV99
  6231     MOVE EIBRESP  TO WS-RESPONSE
  6232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6233
  6234     IF NOT RESP-NORMAL
  6235        GO TO 1850-ENDBR
  6236     END-IF
  6237
  6238     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  6239        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  6240           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  6241           DISPLAY ' NSRLTRBL- SETTING PDEF FOUND TO TRUE '
  6242        ELSE
  6243           GO TO 1850-READNEXT
  6244        END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page 110
* NSRLTRBL.cbl
  6245     ELSE
  6246        GO TO 1850-ENDBR
  6247     END-IF
  6248
  6249     .
  6250 1850-ENDBR.
  6251
  6252
  6253* EXEC CICS ENDBR
  6254*       DATASET  ('ERPDEF')
  6255*    END-EXEC
  6256     MOVE 'ERPDEF' TO DFHEIV1
  6257     MOVE 0
  6258       TO DFHEIV11
  6259*    MOVE '&2                    $   #00005817' TO DFHEIV0
  6260     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6261     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6262     MOVE X'2020233030303035383137' TO DFHEIV0(25:11)
  6263     CALL 'kxdfhei1' USING DFHEIV0,
  6264           DFHEIV1,
  6265           DFHEIV11,
  6266           DFHEIV99
  6267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6268
  6269     .
  6270 1850-EXIT.
  6271     EXIT.
  6272
  6273 1900-BUILD-NON-DCC.
  6274
  6275     MOVE SPACES                 TO WS-PREV-CLM-TYPE
  6276                                    WS-PREV-INS-TYPE
  6277     MOVE ZEROS                  TO WS-PREV-BEN-PER
  6278                                    WS-ACCUM-DAYS
  6279                                    WS-ACCUM-AMT
  6280                                    WS-ACCUM-PD-BENS
  6281
  6282     MOVE +1                     TO M1
  6283     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6284        S1 > WS-MAX-SUB
  6285        IF WS-SRTD-CLM-TYPE (S1) NOT = WS-PREV-CLM-TYPE
  6286           PERFORM 1810-SET-NEW-HEAD
  6287                                 THRU 1810-EXIT
  6288           MOVE WS-SRTD-CLM-TYPE (S1)
  6289                                 TO WS-PREV-CLM-TYPE
  6290           ADD +1                TO M1
  6291        END-IF
  6292        MOVE WS-SRTD-BEN-PER (S1)  TO OUT-BEN-PER
  6293        IF WS-SRTD-INS-TYPE (S1) = '1'
  6294           MOVE 'PRIM'             TO OUT-INS-TYP
  6295        ELSE
  6296           MOVE 'COBO'             TO OUT-INS-TYP
  6297        END-IF
  6298*       evaluate ws-srtd-status (s1)
  6299*          when 'C'
  6300*             MOVE 'CLOSED'        TO WSM-STATUS (M1)
  6301*          WHEN 'D'
  6302*             MOVE 'DENIED'        TO WSM-STATUS (M1)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page 111
* NSRLTRBL.cbl
  6303*          WHEN 'O'
  6304*             MOVE 'OPEN'          TO WSM-STATUS (M1)
  6305*          WHEN OTHER
  6306*             MOVE 'OTHER'         TO WSM-STATUS (M1)
  6307*       END-EVALUATE
  6308*       move ws-srtd-claim-no (s1) to wsm-claim-no (m1)
  6309*                                     pi-wsm-claim-nos (s1)
  6310*       move ws-srtd-total-paid (s1) to wsm-total-paid (m1)
  6311
  6312        COMPUTE OUT-MAX-BENS =
  6313           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  6314
  6315        DISPLAY ' NSRLTRBL- MAX BENS 1 ' OUT-MAX-BENS ' '
  6316           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6317
  6318        MOVE ZEROS TO WK1 WK2
  6319        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6320           COMPUTE WS-PD-BENS ROUNDED =
  6321              WS-SRTD-TOTAL-PAID (S1) / WS-SRTD-MAX-MOBEN (S1)
  6322           IF WS-SRTD-CLM-TYPE (S1) NOT = 'L' AND 'P'
  6323              DIVIDE WS-SRTD-TOTAL-PAID (S1) BY
  6324                 WS-SRTD-MAX-MOBEN(S1) GIVING WK1
  6325                 REMAINDER WK2
  6326           END-IF
  6327        ELSE
  6328           MOVE ZEROS            TO WS-PD-BENS
  6329        END-IF
  6330        IF (WS-PD-BENS = ZEROS)
  6331           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6332           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6333           MOVE 1                TO WS-PD-BENS
  6334        END-IF
  6335        MOVE WS-PD-BENS          TO OUT-PAID-BENS
  6336*       IF WK2 NOT = ZEROS
  6337*          MOVE '*'              TO WSM-PART (M1)
  6338*       END-IF
  6339        COMPUTE WS-ACCUM-AMT =
  6340           WS-ACCUM-AMT + WS-SRTD-TOTAL-PAID (S1)
  6341        DISPLAY ' NSRLTRBL- COMPUTE A PD BENS ' M1 ' '
  6342           WS-ACCUM-AMT ' ' WS-SRTD-MAX-MOBEN (S1)
  6343        IF WS-SRTD-MAX-MOBEN (S1) NOT = ZEROS
  6344           COMPUTE WS-ACCUM-PD-BENS ROUNDED =
  6345              WS-ACCUM-AMT / WS-SRTD-MAX-MOBEN (S1)
  6346        ELSE
  6347           MOVE ZEROS            TO WS-ACCUM-PD-BENS
  6348        END-IF
  6349        IF (WS-ACCUM-PD-BENS = ZEROS)
  6350           AND (WS-SRTD-CLM-TYPE (S1) = 'L' OR 'P')
  6351           AND (WS-SRTD-TOTAL-PAID (S1) > ZEROS)
  6352           MOVE 1                TO WS-ACCUM-PD-BENS
  6353        END-IF
  6354        DISPLAY ' NSRLTRBL- COMPUTE REM BENS ' M1 ' '
  6355           WS-SRTD-MAX-BENS (S1) ' ' WS-ACCUM-PD-BENS
  6356        COMPUTE OUT-REM-BENS =
  6357           WS-SRTD-MAX-BENS (S1) - WS-ACCUM-PD-BENS
  6358
  6359*       MOVE ws-srtd-inc-dt (s1)    TO DC-BIN-DATE-1
  6360*       MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page 112
* NSRLTRBL.cbl
  6361*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6362*       IF NO-CONVERSION-ERROR
  6363*          MOVE DC-GREG-DATE-A-EDIT TO wsm-inc-date (m1)
  6364*       ELSE
  6365*          MOVE SPACES              TO wsm-inc-date (m1)
  6366*       END-IF
  6367*       MOVE ws-srtd-pd-thru-dt (s1) TO DC-BIN-DATE-1
  6368*       MOVE ' '                     TO DC-OPTION-CODE
  6369*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  6370*       IF NO-CONVERSION-ERROR
  6371*          MOVE DC-GREG-DATE-A-EDIT TO wsm-pd-thru-dt (m1)
  6372*       ELSE
  6373*          MOVE SPACES              TO wsm-pd-thru-dt (m1)
  6374*       END-IF
  6375*       move WS-MAP-OUTPUT (m1)  to replineo (m1)
  6376        IF WS-SRTD-CLAIM-NO (S1) = BL-CLAIM-NO
  6377           MOVE WS-SRTD-EXCL-PER (S1) TO OUT-EXCL-PER
  6378           MOVE 26 TO S1
  6379        END-IF
  6380
  6381        ADD +1                   TO M1
  6382     END-PERFORM
  6383     DISPLAY ' NSRLTRBL- 1900 end MAX BENS '  OUT-MAX-BENS
  6384     display ' PAID BENS ' OUT-PAID-BENS ' REM BENS ' OUT-REM-BENS
  6385     display ' EXCL PER ' OUT-EXCL-PER ' REC MOS ' OUT-REC-MOS
  6386     display ' INS TYP ' OUT-INS-TYP ' BEN PER ' OUT-BEN-PER
  6387     display ' ACC SW ' OUT-ACC-SW
  6388     .
  6389 2000-BUILD-ELNAPS.
  6390     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6391     MOVE 'NA'                   TO NAPERSOFT-FILE
  6392     MOVE CL-COMPANY-CD          TO NA-COMPANY-CD
  6393     MOVE BL-CARRIER             TO NA-CARRIER
  6394     MOVE BL-CLAIM-NO            TO NA-CLAIM-NO
  6395     MOVE BL-CERT-NO             TO NA-CERT-NO
  6396     MOVE WS-ARCHIVE-NO          TO NA-ARCHIVE-NO
  6397                                    BL-ARCHIVE-NO
  6398     MOVE BL-LETTER-ID           TO NA-LETTER-ID
  6399     MOVE BL-NO-OF-COPIES        TO NA-NO-OF-COPIES
  6400     MOVE SAVE-BIN-DATE          TO NA-CREATION-DT
  6401                                    NA-INITIAL-PRINT-DT
  6402     MOVE LOW-VALUES             TO NA-FOLLOW-UP-DT
  6403                                    NA-RESEND-DT
  6404                                    NA-RESEND-PRINT-DT
  6405                                    NA-1ST-LTR-PRINT-DT
  6406                                    NA-NEXT-DUE-DT
  6407                                    NA-AUTOPYDT
  6408     MOVE CL-TRAILER-SEQ-CNT     TO NA-CORR-TRLR-SEQ
  6409     IF BL-FOLLOW-UP-DT NOT = SPACES AND LOW-VALUES
  6410        STRING BL-FOLLOW-UP-DT (7:2) BL-FOLLOW-UP-DT (1:2)
  6411           BL-FOLLOW-UP-DT (4:2) DELIMITED BY SIZE
  6412             INTO DC-GREG-DATE-1-YMD-R
  6413        END-STRING
  6414        MOVE '3'                 TO DC-OPTION-CODE
  6415        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6416        IF NO-CONVERSION-ERROR
  6417           MOVE DC-BIN-DATE-1    TO NA-FOLLOW-UP-DT
  6418                                    WS-FOLLOW-UP-DT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page 113
* NSRLTRBL.cbl
  6419        ELSE
  6420           MOVE LOW-VALUES       TO NA-FOLLOW-UP-DT
  6421                                    WS-FOLLOW-UP-DT
  6422        END-IF
  6423     END-IF
  6424     IF BL-RESEND-DT NOT = SPACES AND LOW-VALUES
  6425        STRING BL-RESEND-DT (7:2) BL-RESEND-DT (1:2)
  6426           BL-RESEND-DT (4:2) DELIMITED BY SIZE
  6427             INTO DC-GREG-DATE-1-YMD-R
  6428        END-STRING
  6429        MOVE '3'                 TO DC-OPTION-CODE
  6430        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6431        IF NO-CONVERSION-ERROR
  6432           MOVE DC-BIN-DATE-1    TO NA-RESEND-DT
  6433                                    WS-RESEND-DT
  6434        ELSE
  6435           MOVE LOW-VALUES       TO NA-RESEND-DT
  6436                                    WS-RESEND-DT
  6437        END-IF
  6438     END-IF
  6439     PERFORM WITH TEST AFTER UNTIL RESP-NORMAL
  6440
  6441* EXEC CICS WRITE
  6442*          DATASET   ('ELNAPS')
  6443*          FROM      (NAPERSOFT-FILE)
  6444*          RIDFLD    (NA-CONTROL-PRIMARY)
  6445*          RESP      (WS-RESPONSE)
  6446*       END-EXEC
  6447     MOVE LENGTH OF
  6448      NAPERSOFT-FILE
  6449       TO DFHEIV11
  6450     MOVE 'ELNAPS' TO DFHEIV1
  6451*    MOVE '&$ L                  ''  N#00005992' TO DFHEIV0
  6452     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6453     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6454     MOVE X'204E233030303035393932' TO DFHEIV0(25:11)
  6455     CALL 'kxdfhei1' USING DFHEIV0,
  6456           DFHEIV1,
  6457           NAPERSOFT-FILE,
  6458           DFHEIV11,
  6459           NA-CONTROL-PRIMARY,
  6460           DFHEIV99,
  6461           DFHEIV99
  6462     MOVE EIBRESP  TO WS-RESPONSE
  6463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6464        IF RESP-NORMAL
  6465           CONTINUE
  6466        ELSE
  6467           IF RESP-DUPREC OR RESP-DUPKEY
  6468              ADD +1 TO NA-ARCHIVE-NO
  6469           ELSE
  6470              DISPLAY ' BAD WRITE ELNAPS ' WS-RESPONSE
  6471                 ' ' NA-CONTROL-PRIMARY (2:19)
  6472              SET RESP-NORMAL TO TRUE
  6473           END-IF
  6474        END-IF
  6475     END-PERFORM
  6476    .
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:05 Page 114
* NSRLTRBL.cbl
  6477 2000-EXIT.
  6478     EXIT.
  6479 9700-DATE-LINK.
  6480
  6481* EXEC CICS LINK
  6482*        PROGRAM   ('ELDATCV')
  6483*        COMMAREA  (DATE-CONVERSION-DATA)
  6484*        LENGTH    (DC-COMM-LENGTH)
  6485*    END-EXEC.
  6486     MOVE 'ELDATCV' TO DFHEIV1
  6487*    MOVE '."C                   (   #00006014' TO DFHEIV0
  6488     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6489     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6490     MOVE X'2020233030303036303134' TO DFHEIV0(25:11)
  6491     CALL 'kxdfhei1' USING DFHEIV0,
  6492           DFHEIV1,
  6493           DATE-CONVERSION-DATA,
  6494           DC-COMM-LENGTH,
  6495           DFHEIV99,
  6496           DFHEIV99,
  6497           DFHEIV99,
  6498           DFHEIV99
  6499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6500
  6501 9700-EXIT.
  6502      EXIT.
  6503
  6504 9999-DFHBACK SECTION.
  6505     MOVE '9%                    "   ' TO DFHEIV0
  6506     MOVE 'NSRLTRBL' TO DFHEIV1
  6507     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6508     GOBACK.
  6509 9999-DFHEXIT.
  6510     IF DFHEIGDJ EQUAL 0001
  6511         NEXT SENTENCE.
  6512     MOVE '9%                    "   ' TO DFHEIV0
  6513     MOVE 'NSRLTRBL' TO DFHEIV1
  6514     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6515     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       19080     Code:       16290
