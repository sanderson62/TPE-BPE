* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37******************************************************************
    38
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   3
* EL131.cbl
    40 ENVIRONMENT DIVISION.
    41
    42 DATA DIVISION.
    43
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46
    47 77  FILLER  PIC X(32)  VALUE '********************************'.
    48 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    49 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    50 77  s1                          pic s999 comp-3 value+0.
    51 77  s2                          pic s999 comp-3 value+0.
    52 77  a1                          pic s999 comp-3 value+0.
    53 77  WS-CRIT-PER-RECURRENT       PIC X     VALUE ' '.
    54 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    55 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    56 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    57 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    58 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    59 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    60 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    61     88  ERPDEF-FOUND                 VALUE 'Y'.
    62
    63 01  LCP-TIME-OF-DAY-XX.
    64     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    65     05  FILLER                    PIC 99.
    66 01  LCP-CICS-TIME                 PIC 9(15).
    67*                            COPY ELCSCTM.
    68******************************************************************
    69*                                                                *
    70*                                                                *
    71*                            ELCSCTM                             *
    72*                            VMOD=2.001                          *
    73*                                                                *
    74*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    75*                                                                *
    76******************************************************************
    77 01  SECURITY-MESSAGE.
    78     12  FILLER                          PIC X(30)
    79            VALUE '** LOGIC SECURITY VIOLATION -'.
    80     12  SM-READ                         PIC X(6).
    81     12  FILLER                          PIC X(5)
    82            VALUE ' PGM='.
    83     12  SM-PGM                          PIC X(6).
    84     12  FILLER                          PIC X(5)
    85            VALUE ' OPR='.
    86     12  SM-PROCESSOR-ID                 PIC X(4).
    87     12  FILLER                          PIC X(6)
    88            VALUE ' TERM='.
    89     12  SM-TERMID                       PIC X(4).
    90     12  FILLER                          PIC XX   VALUE SPACE.
    91     12  SM-JUL-DATE                     PIC 9(5).
    92     12  FILLER                          PIC X    VALUE SPACE.
    93     12  SM-TIME                         PIC 99.99.
    94
    95
    96*                            COPY ELCSCRTY.
    97******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   4
* EL131.cbl
    98*                                                                *
    99*                                                                *
   100*                            ELCSCRTY                            *
   101*                            VMOD=2.001                          *
   102*                                                                *
   103*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   104*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   105*        SAVED IN PI-SECURITY-ADDRESS.                           *
   106*                                                                *
   107******************************************************************
   108 01  SECURITY-CONTROL.
   109     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   110     12  FILLER                       PIC XX    VALUE 'SC'.
   111     12  SC-CREDIT-CODES.
   112         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   113             20  SC-CREDIT-DISPLAY    PIC X.
   114             20  SC-CREDIT-UPDATE     PIC X.
   115     12  SC-CLAIMS-CODES.
   116         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   117             20  SC-CLAIMS-DISPLAY    PIC X.
   118             20  SC-CLAIMS-UPDATE     PIC X.
   119
   120*                            COPY ELCNWA.
   121*****************************************************************
   122*                                                               *
   123*                                                               *
   124*                            ELCNWA.                            *
   125*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   126*                            VMOD=2.003                         *
   127*                                                               *
   128*            M O V E   N A M E   W O R K   A R E A.             *
   129*                                                               *
   130*****************************************************************.
   131
   132 01  WS-NAME-WORK-AREA.
   133     05  WS-INSURED-LAST-NAME        PIC X(15).
   134     05  WS-INSURED-1ST-NAME         PIC X(12).
   135     05  WS-INSURED-MID-INIT         PIC X.
   136
   137     05  WS-NAME-WORK.
   138         10  WS-NW                   PIC X
   139             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   140
   141     05  WS-NAME-WORK2.
   142         10  WS-NW2                  PIC X
   143             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   144                                        NWA-INDEX0.
   145
   146     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   147                                     COMP-3.
   148
   149
   150 01  ws-dcc-error-line.
   151     05  filler occurs 15.
   152         10  ws-error-no        pic x(4).
   153 01  WS-DATE-AREA.
   154     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   155     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   5
* EL131.cbl
   156     12  SAVE-DATE-CCYYMMDD.
   157         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   158         16  SAVE-DATE-YMD.
   159             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   160             20  FILLER         PIC X(4)    VALUE SPACES.
   161
   162 01  WS-BLANK                   PIC X       VALUE ' '.
   163
   164 01  CSO-WORK-FIELDS.
   165     05  WS-HOLD-CLAIM-STATUS    PIC X.
   166
   167 01  LITERALS-NUMBERS.
   168     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   169     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   170     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   171     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   172     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   173     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   174     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   175     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   176
   177     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   178     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   179     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   180     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   181     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   182     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   183     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   184     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   185     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   186     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   187
   188     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   189
   190     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   191
   192     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   193     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   194     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   195     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   196     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   197     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   198     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   199     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   200     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   201     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   202     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   203
   204     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   205     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   206     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   207     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   208         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   209     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   210     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   211     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   212     12  WS-CLAIM-SEQU.
   213         16  FILLER              PIC X VALUE '('.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   6
* EL131.cbl
   214         16  WS-CURRENT-SEQU     PIC Z9.
   215         16  FILLER              PIC X(04) VALUE ' OF '.
   216         16  WS-OF-SEQU          PIC Z9.
   217         16  FILLER              PIC X VALUE ')'.
   218     12  WS-EDIT-BEN-CODE        PIC XX.
   219         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   220                                          '90' THRU '99'.
   221
   222     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   223     12  WS-EDIT-NUMBER          PIC ZZZ9.
   224
   225     12  WS-RESPONSE             PIC S9(8)   COMP.
   226         88  WS-RESP-NORMAL              VALUE +00.
   227         88  WS-RESP-ERROR               VALUE +01.
   228         88  WS-RESP-NOTFND              VALUE +13.
   229         88  WS-RESP-DUPKEY              VALUE +15.
   230         88  WS-RESP-NOTOPEN             VALUE +19.
   231         88  WS-RESP-ENDFILE             VALUE +20.
   232
   233     12  WS-MOS-PAID             PIC 999.
   234     12  WS-ODD-DAYS             PIC 99.
   235     12  WS-REM-MOS              PIC 999.
   236     12  WS-REM-DAYS             PIC 99.
   237     12  WS-TERM-IN-DAYS         PIC 9(4).
   238     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   239
   240     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   241     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   242     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   243     12  WS-RESET-SW             PIC X       VALUE 'N'.
   244     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   245     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   246     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   247
   248 01  DMD-DATE-YYYYMMDD.
   249     12  DMD-DECADE          PIC XX      VALUE SPACES.
   250     12  DMD-YYMMDD.
   251         16  DMD-YY          PIC XX      VALUE SPACES.
   252         16  DMD-MM          PIC XX      VALUE SPACES.
   253         16  DMD-DD          PIC XX      VALUE SPACES.
   254
   255 01  DMD-DATE-MMDDYYYY.
   256     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   257     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   258     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   259     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   260     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   261     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   262
   263 01  WS-MAIL-CODE.
   264     12  FILLER              PIC X.
   265     12  DMD-MAIL-CODE.
   266         16  WS-MAIL-4       PIC X(4).
   267         16  WS-MAIL-5       PIC X.
   268     12  FILLER              PIC X(4).
   269
   270     12  W-NAME-LAST             PIC  X(15).
   271     12  W-NAME-FIRST            PIC  X(15).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   7
* EL131.cbl
   272     12  W-NAME-MIDDLE.
   273         16  FILLER              PIC  X.
   274         16  W-NAME-MIDDLE-2     PIC  X.
   275         16  FILLER              PIC  X(13).
   276
   277*    COPY ELCDCTB.
   278******************************************************************
   279*                                                                *
   280*                                                                *
   281*                            ELCDCTB.                            *
   282*                            VMOD=2.002                          *
   283*                                                                *
   284*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   285*       COMMUNICATIONS AREA                                      *
   286*                                                                *
   287******************************************************************
   288 01  DCT-COMMUNICATION-AREA.
   289     12  DCT-BILLING-BANK-ID      PIC  X(05).
   290     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   291     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   292     12  DCT-PRODUCT-CODE         PIC  X(02).
   293     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   294     12  DCT-RETURN-CODE          PIC  X(02).
   295     12  DCT-MAIL-CODE            PIC  X(05).
   296     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   297     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   8
* EL131.cbl
   299 01  ERROR-SWITCHES.
   300     12  ERROR-SWITCH            PIC X.
   301         88  SCREEN-ERROR                    VALUE 'X'.
   302     12  MSTR-KEY-SWITCH         PIC X.
   303         88  MSTR-KEY-CHANGED                VALUE 'X'.
   304     12  CERT-KEY-SWITCH         PIC X.
   305*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   306         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   307*********SET TO Y IF PRIMARY KEY WILL CHANGE
   308         88  CERT-KEY-CHANGED                VALUE 'Y'.
   309     12  MSTR-SWITCH             PIC X.
   310         88  MSTR-UPDATES                    VALUE 'X'.
   311     12  CERT-SWITCH             PIC X.
   312         88  CERT-UPDATES                    VALUE 'X'.
   313     12  UPDATE-SWITCH           PIC X.
   314         88  UPDATES-PRESENT                 VALUE 'X'.
   315     12  TRLR-SWITCH             PIC X.
   316         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   317         88  UPDATE-MADE                     VALUE 'Y'.
   318     12  NINETY-TRLR-SWITCH      PIC X.
   319         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   320     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   321         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   322     12  EARNINGS-CALC-SWITCH    PIC X.
   323         88  TEX-REG                         VALUE '4'.
   324         88  NET-PAY                         VALUE '5'.
   325     12  DLYACTV-SW              PIC X       VALUE 'N'.
   326         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page   9
* EL131.cbl
   328 01  EDIT-WORK-AREA.
   329     12  COUNT-2                 PIC 9.
   330     12  CALL-PGM                PIC X(8).
   331     12  TRANS-ID                PIC X(4).
   332     12  CHECK-PFKEYS            PIC 99.
   333     12  CHECK-MAINT             PIC X.
   334         88  ADD-ALPHA-RECORD                VALUE 'A'.
   335         88  CHANGE-CLAIM                    VALUE 'C'.
   336         88  DELETE-CLAIM                    VALUE 'D'.
   337         88  CHANGE-NAME                     VALUE 'N'.
   338         88  VALID-OPTIONS                   VALUE 'A' 'C'
   339                                                   'D' 'N'.
   340
   341     12  HOLD-BENEFIT            PIC XX.
   342     12  HOLD-FREQ               PIC XX.
   343     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   344     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   345     12  HOLD-PDTHRU             PIC XX.
   346     12  HOLD-ADDON              PIC XX.
   347     12  HOLD-NODAYS             PIC 9(4).
   348     12  HOLD-NOPMTS             PIC 9(3).
   349     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   350     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   351     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   352     12  HOLD-BIRTH              PIC XX.
   353     12  HOLD-END                PIC XX.
   354     12  HOLD-EFF                PIC XX.
   355     12  HOLD-ENTRY              PIC XX.
   356     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   357     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   358     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   359     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   360     12  HOLD-LF-CV-CAN          PIC XX.
   361     12  HOLD-AH-CV-CAN          PIC XX.
   362     12  DIVIDE-QUOT             PIC 9(3).
   363     12  DIVIDE-REM              PIC 9(3).
   364
   365     12  WS-ALPHA-DATE.
   366         16  WS-ALPHA-YEAR.
   367             20  WS-ALPHA-YY-1   PIC 99.
   368             20  WS-ALPHA-YY-2   PIC 99.
   369         16  WS-ALPHA-MM         PIC 99.
   370         16  WS-ALPHA-DD         PIC 99.
   371
   372     12  BUILD-VALID-DATE.
   373         16  BUILD-MONTH         PIC 99.
   374         16  BUILD-DAY           PIC 99.
   375         16  BUILD-YEAR          PIC 99.
   376     12  DEEDIT-MMYY-INPUT.
   377         16  FILLER              PIC X.
   378         16  DEEDIT-MONTH        PIC XX.
   379         16  DEEDIT-YEAR         PIC XX.
   380     12  DEEDIT-BEN              PIC 9(9)V99.
   381     12  DEEDIT-DATE-INPUT.
   382         16  FILLER              PIC XX.
   383         16  DEEDIT-DATE         PIC X(6).
   384     12  WORK-DATE-MDY.
   385         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  10
* EL131.cbl
   386         16  FILLER              PIC X(4).
   387         16  YEAR-WORK           PIC XX.
   388     12  WORK-DATE-MY.
   389         16  WORK-MONTH          PIC XX.
   390         16  WORK-SLASH          PIC X       VALUE '/'.
   391         16  WORK-YEAR           PIC XX.
   392     12  HOLD-DATE.
   393         16  HOLD-MONTH          PIC 99.
   394         16  FILLER              PIC X(4).
   395         16  HOLD-YEAR           PIC 99.
   396     12  SPLIT-INFO-LINE-1.
   397         16  SPLIT-INFO-DESC     PIC X(15).
   398         16  FILLER              PIC X(5)    VALUE ' OLD='.
   399         16  SPLIT-INFO-OLD      PIC X(40).
   400     12  EFF-TERM-MO             PIC 9(4).
   401     12  CURR-MO                 PIC 9(4).
   402     12  WS-BIN-CURRENT-DT       PIC XX.
   403     12  WS-CALC-METHOD          PIC X.
   404     12  WS-INITIALS.
   405         16  WS-INIT-1           PIC X.
   406         16  WS-INIT-2           PIC X.
   407     12  WS-REIN-TABLE.
   408         16  WS-REIN-1           PIC X.
   409         16  WS-REIN-2           PIC X.
   410         16  WS-REIN-3           PIC X.
   411     12  PI-KEY.
   412         16  PI-TERM             PIC X(4).
   413         16  PI-QUAL             PIC X(4).
   414     12  CHECK-KEY               PIC X(20).
   415     12  SAVE-ACCT-KEY           PIC X(20).
   416     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   417     12  WS-SOC-SEC-NUMBER.
   418         16  WS-SOC-SEC-NO       PIC 9(9).
   419         16  WS-SOC-SEC-BLANK    PIC X(2).
   420     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   421         16  WS-SSN-1-3          PIC 9(3).
   422         16  WS-SSN-DASH1        PIC X(1).
   423         16  WS-SSN-4-5          PIC 9(2).
   424         16  WS-SSN-DASH2        PIC X(1).
   425         16  WS-SSN-6-9          PIC 9(4).
   426     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   427     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   428
   429 01  WS-SAVE-FIELDS.
   430     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   431     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   432     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   433     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   434     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   435     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   436     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   437     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   438     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   439     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   440     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   441     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   442     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   443     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  11
* EL131.cbl
   444     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   445     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   446     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   447     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   448     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   449     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   450     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   451     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   452     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   453     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   454     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   455     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   456     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   457     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   458     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   459     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   460     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   461     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   462     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   463     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   464     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   465     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   466     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   467     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   468     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   469     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   470     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   471     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   472     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   473     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   474     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   475     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   476     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   477     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   478     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   479     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   480     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   481
   482 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   483     12  M                   PIC S9(7)V99           VALUE ZEROS.
   484     12  L                   PIC S9(7)V99           VALUE ZEROS.
   485     12  N                   PIC S9(3)              VALUE ZEROS.
   486     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   487     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   488     12  I                   PIC S99V9(5)           VALUE ZEROS.
   489     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   490     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   491     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   492     12  R                   PIC S9(3)              VALUE ZEROS.
   493     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   494     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   495     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   496     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   497     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   498     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   499     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   500     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   501     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  12
* EL131.cbl
   502
   503 01  TERM-CALC-WORK-AREA.
   504     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   505     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   506     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   507     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   508     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   509     12  V-EXPONENTS.
   510        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   511     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   512
   513 01  TIME-IN.
   514     12  UN-HOURS                PIC XX.
   515     12  UN-MINUTES              PIC XX.
   516     12  FILLER                  PIC XX.
   517
   518 01  TIME-OUT.
   519     12  FOR-HOURS               PIC XX.
   520     12  FILLER                  PIC X       VALUE '.'.
   521     12  FOR-MINUTES             PIC XX.
   522
   523 01  ERROR-NUMBERS.
   524     12  ER-0000                 PIC X(4)    VALUE '0000'.
   525     12  ER-0004                 PIC X(4)    VALUE '0004'.
   526     12  ER-0008                 PIC X(4)    VALUE '0008'.
   527     12  ER-0023                 PIC X(4)    VALUE '0023'.
   528     12  ER-0029                 PIC X(4)    VALUE '0029'.
   529     12  ER-0068                 PIC X(4)    VALUE '0068'.
   530     12  ER-0070                 PIC X(4)    VALUE '0070'.
   531     12  ER-0149                 PIC X(4)    VALUE '0149'.
   532     12  ER-0154                 PIC X(4)    VALUE '0154'.
   533     12  ER-0169                 PIC X(4)    VALUE '0169'.
   534     12  ER-0192                 PIC X(4)    VALUE '0192'.
   535     12  ER-0199                 PIC X(4)    VALUE '0199'.
   536     12  ER-0203                 PIC X(4)    VALUE '0203'.
   537     12  ER-0204                 PIC X(4)    VALUE '0204'.
   538     12  ER-0205                 PIC X(4)    VALUE '0205'.
   539     12  ER-0206                 PIC X(4)    VALUE '0206'.
   540     12  ER-0208                 PIC X(4)    VALUE '0208'.
   541     12  ER-0210                 PIC X(4)    VALUE '0210'.
   542     12  ER-0215                 PIC X(4)    VALUE '0215'.
   543     12  ER-0219                 PIC X(4)    VALUE '0219'.
   544     12  ER-0220                 PIC X(4)    VALUE '0220'.
   545     12  ER-0222                 PIC X(4)    VALUE '0222'.
   546     12  ER-0223                 PIC X(4)    VALUE '0223'.
   547     12  ER-0224                 PIC X(4)    VALUE '0224'.
   548     12  ER-0227                 PIC X(4)    VALUE '0227'.
   549     12  ER-0230                 PIC X(4)    VALUE '0230'.
   550     12  ER-0232                 PIC X(4)    VALUE '0232'.
   551     12  ER-0233                 PIC X(4)    VALUE '0233'.
   552     12  ER-0236                 PIC X(4)    VALUE '0236'.
   553     12  ER-0237                 PIC X(4)    VALUE '0237'.
   554     12  ER-0238                 PIC X(4)    VALUE '0238'.
   555     12  ER-0240                 PIC X(4)    VALUE '0240'.
   556     12  ER-0241                 PIC X(4)    VALUE '0241'.
   557     12  ER-0243                 PIC X(4)    VALUE '0243'.
   558     12  ER-0244                 PIC X(4)    VALUE '0244'.
   559     12  ER-0246                 PIC X(4)    VALUE '0246'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  13
* EL131.cbl
   560     12  ER-0247                 PIC X(4)    VALUE '0247'.
   561     12  ER-0248                 PIC X(4)    VALUE '0248'.
   562     12  ER-0250                 PIC X(4)    VALUE '0250'.
   563     12  ER-0251                 PIC X(4)    VALUE '0251'.
   564     12  ER-0253                 PIC X(4)    VALUE '0253'.
   565     12  ER-0256                 PIC X(4)    VALUE '0256'.
   566     12  ER-0257                 PIC X(4)    VALUE '0257'.
   567     12  ER-0258                 PIC X(4)    VALUE '0258'.
   568     12  ER-0259                 PIC X(4)    VALUE '0259'.
   569     12  ER-0260                 PIC X(4)    VALUE '0260'.
   570     12  ER-0261                 PIC X(4)    VALUE '0261'.
   571     12  ER-0262                 PIC X(4)    VALUE '0262'.
   572     12  ER-0263                 PIC X(4)    VALUE '0263'.
   573     12  ER-0273                 PIC X(4)    VALUE '0273'.
   574     12  ER-0274                 PIC X(4)    VALUE '0274'.
   575     12  ER-0276                 PIC X(4)    VALUE '0276'.
   576     12  ER-0282                 PIC X(4)    VALUE '0282'.
   577     12  ER-0283                 PIC X(4)    VALUE '0283'.
   578     12  ER-0309                 PIC X(4)    VALUE '0309'.
   579     12  ER-0310                 PIC X(4)    VALUE '0310'.
   580     12  ER-0311                 PIC X(4)    VALUE '0311'.
   581     12  ER-0333                 PIC X(4)    VALUE '0333'.
   582     12  ER-0360                 PIC X(4)    VALUE '0360'.
   583     12  ER-0377                 PIC X(4)    VALUE '0377'.
   584     12  ER-0402                 PIC X(4)    VALUE '0402'.
   585     12  ER-0416                 PIC X(4)    VALUE '0416'.
   586     12  ER-0426                 PIC X(4)    VALUE '0426'.
   587     12  ER-0427                 PIC X(4)    VALUE '0427'.
   588     12  ER-0428                 PIC X(4)    VALUE '0428'.
   589     12  ER-0429                 PIC X(4)    VALUE '0429'.
   590     12  ER-0430                 PIC X(4)    VALUE '0430'.
   591     12  ER-0458                 PIC X(4)    VALUE '0458'.
   592     12  ER-0475                 PIC X(4)    VALUE '0475'.
   593     12  ER-0491                 PIC X(4)    VALUE '0491'.
   594     12  ER-0509                 PIC X(4)    VALUE '0509'.
   595     12  ER-0510                 PIC X(4)    VALUE '0510'.
   596     12  ER-0511                 PIC X(4)    VALUE '0511'.
   597     12  ER-0512                 PIC X(4)    VALUE '0512'.
   598     12  ER-0519                 PIC X(4)    VALUE '0519'.
   599     12  ER-0520                 PIC X(4)    VALUE '0520'.
   600     12  ER-0521                 PIC X(4)    VALUE '0521'.
   601     12  ER-0547                 PIC X(4)    VALUE '0547'.
   602     12  ER-0548                 PIC X(4)    VALUE '0548'.
   603     12  ER-0549                 PIC X(4)    VALUE '0549'.
   604     12  ER-0565                 PIC X(4)    VALUE '0565'.
   605     12  ER-0598                 PIC X(4)    VALUE '0598'.
   606     12  ER-0639                 PIC X(4)    VALUE '0639'.
   607     12  ER-0797                 PIC X(4)    VALUE '0797'.
   608     12  ER-0802                 PIC X(4)    VALUE '0802'.
   609     12  ER-0803                 PIC X(4)    VALUE '0803'.
   610     12  ER-0849                 PIC X(4)    VALUE '0849'.
   611     12  ER-0885                 PIC X(4)    VALUE '0885'.
   612     12  ER-0887                 PIC X(4)    VALUE '0887'.
   613     12  ER-0919                 PIC X(4)    VALUE '0919'.
   614     12  ER-0921                 PIC X(4)    VALUE '0921'.
   615     12  ER-0938                 PIC X(4)    VALUE '0938'.
   616     12  ER-0946                 PIC X(4)    VALUE '0946'.
   617     12  ER-0947                 PIC X(4)    VALUE '0947'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  14
* EL131.cbl
   618     12  ER-0948                 PIC X(4)    VALUE '0948'.
   619     12  ER-0949                 PIC X(4)    VALUE '0949'.
   620     12  ER-0950                 PIC X(4)    VALUE '0950'.
   621     12  ER-0951                 PIC X(4)    VALUE '0951'.
   622     12  ER-0954                 PIC X(4)    VALUE '0954'.
   623     12  ER-0974                 PIC X(4)    VALUE '0974'.
   624     12  ER-0975                 PIC X(4)    VALUE '0975'.
   625     12  ER-1651                 PIC X(4)    VALUE '1651'.
   626     12  ER-1652                 PIC X(4)    VALUE '1652'.
   627     12  ER-1653                 PIC X(4)    VALUE '1653'.
   628     12  ER-1654                 PIC X(4)    VALUE '1654'.
   629     12  ER-1655                 PIC X(4)    VALUE '1655'.
   630     12  er-1656                 pic x(4)    value '1656'.
   631     12  ER-1661                 PIC X(4)    VALUE '1661'.
   632     12  ER-1662                 PIC X(4)    VALUE '1662'.
   633     12  ER-1663                 PIC X(4)    VALUE '1663'.
   634     12  ER-1773                 PIC X(4)    VALUE '1773'.
   635     12  ER-2280                 PIC X(4)    VALUE '2280'.
   636     12  ER-2878                 PIC X(4)    VALUE '2878'.
   637     12  ER-7641                 PIC X(4)    VALUE '7641'.
   638     12  ER-7642                 PIC X(4)    VALUE '7642'.
   639     12  ER-7650                 PIC X(4)    VALUE '7650'.
   640     12  ER-7651                 PIC X(4)    VALUE '7651'.
   641     12  ER-7687                 PIC X(4)    VALUE '7687'.
   642     12  ER-7689                 PIC X(4)    VALUE '7689'.
   643     12  ER-7690                 PIC X(4)    VALUE '7690'.
   644     12  ER-7691                 PIC X(4)    VALUE '7691'.
   645     12  ER-8003                 PIC X(4)    VALUE '8003'.
   646     12  ER-8051                 PIC X(4)    VALUE '8051'.
   647     12  ER-8052                 PIC X(4)    VALUE '8052'.
   648     12  ER-8053                 PIC X(4)    VALUE '8053'.
   649     12  ER-8054                 PIC X(4)    VALUE '8054'.
   650     12  ER-8055                 PIC X(4)    VALUE '8055'.
   651     12  ER-8056                 PIC X(4)    VALUE '8056'.
   652     12  ER-8057                 PIC X(4)    VALUE '8057'.
   653     12  ER-8058                 PIC X(4)    VALUE '8058'.
   654     12  ER-8059                 PIC X(4)    VALUE '8059'.
   655     12  ER-8060                 PIC X(4)    VALUE '8060'.
   656     12  ER-8061                 PIC X(4)    VALUE '8061'.
   657     12  ER-8062                 PIC X(4)    VALUE '8062'.
   658     12  ER-8063                 PIC X(4)    VALUE '8063'.
   659     12  ER-8064                 PIC X(4)    VALUE '8064'.
   660     12  ER-8065                 PIC X(4)    VALUE '8065'.
   661     12  ER-8066                 PIC X(4)    VALUE '8066'.
   662     12  ER-8152                 PIC X(4)    VALUE '8152'.
   663     12  ER-8153                 PIC X(4)    VALUE '8153'.
   664     12  ER-8154                 PIC X(4)    VALUE '8154'.
   665     12  ER-8155                 PIC X(4)    VALUE '8155'.
   666 01  ERPDEF-KEY-SAVE             PIC X(18).
   667 01  ERPDEF-KEY.
   668     12  ERPDEF-COMPANY-CD       PIC X.
   669     12  ERPDEF-STATE            PIC XX.
   670     12  ERPDEF-PROD-CD          PIC XXX.
   671     12  F                       PIC X(7).
   672     12  ERPDEF-BEN-TYPE         PIC X.
   673     12  ERPDEF-BEN-CODE         PIC XX.
   674     12  ERPDEF-EXP-DT           PIC XX.
   675 01  MSTR-KEY.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  15
* EL131.cbl
   676     12  COMPANY-CODE            PIC X.
   677     12  CARRIER-CODE            PIC X.
   678     12  CLAIM-NO                PIC X(7).
   679     12  CERT-NO.
   680         16  CERT-NO-PRIME       PIC X(10).
   681         16  CERT-NO-SUFX        PIC X.
   682
   683 01  WS-SAVE-CLAIM-KEY.
   684     12  WS-SAVE-COMPANY-CD      PIC X.
   685     12  WS-SAVE-CARRIER         PIC X.
   686     12  WS-SAVE-CLAIM-NO        PIC X(7).
   687     12  WS-SAVE-CERT-NO.
   688         16  WS-CERT-NO-PRIME    PIC X(10).
   689         16  WS-CERT-NO-SUFX     PIC X.
   690
   691 01  CERT-KEY.
   692     12  CERT-COMPANY-CODE       PIC X.
   693     12  CERT-CARRIER            PIC X.
   694     12  CERT-GROUP              PIC X(6).
   695     12  CERT-STATE              PIC XX.
   696     12  CERT-ACCOUNT            PIC X(10).
   697     12  CERT-DATE               PIC XX.
   698     12  CERT-CERT.
   699         16  CERT-CERT-PRIME     PIC X(10).
   700         16  CERT-CERT-SUFX      PIC X.
   701
   702 01  ELCRTT-KEY.
   703     05  CTRLR-COMP-CD       PIC X.
   704     05  CTRLR-CARRIER       PIC X.
   705     05  CTRLR-GROUPING      PIC X(6).
   706     05  CTRLR-STATE         PIC X(2).
   707     05  CTRLR-ACCOUNT       PIC X(10).
   708     05  CTRLR-EFF-DT        PIC XX.
   709     05  CTRLR-CERT-NO       PIC X(11).
   710     05  CTRLR-REC-TYPE      PIC X.
   711 01  NOTE-KEY.
   712     12  NOTE-COMP-CD            PIC X.
   713     12  NOTE-CERT-KEY.
   714         16  NOTE-CARRIER        PIC X.
   715         16  NOTE-GROUP          PIC X(6).
   716         16  NOTE-STATE          PIC XX.
   717         16  NOTE-ACCOUNT        PIC X(10).
   718         16  NOTE-DATE           PIC XX.
   719         16  NOTE-CERT-NO        PIC X(11).
   720
   721 01  TRLR-KEY.
   722     12  TRLR-MAIN-KEY.
   723         16  TRLR-COMPANY-CD     PIC X.
   724         16  TRLR-CARRIER        PIC X.
   725         16  TRLR-CLAIM-NO       PIC X(07).
   726         16  TRLR-CERT-NO        PIC X(11).
   727     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   728
   729 01  BENEFIT-KEY.
   730     12  BEN-CO-ID               PIC X(3).
   731     12  BEN-REC-TYPE            PIC X.
   732     12  FILLER                  PIC XX.
   733     12  BEN-ACC-CD              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  16
* EL131.cbl
   734     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   735
   736 01  CNTL-KEY.
   737     12  CNTL-CO-ID              PIC X(3).
   738     12  CNTL-REC-TYPE           PIC X.
   739     12  CNTL-PROC-ID            PIC X(4).
   740     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   741         16  CNTL-STATE-NUMBER   PIC XX.
   742         16  FILLER              PIC XX.
   743     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   744         16  FILLER              PIC X(3).
   745         16  CNTL-CARRIER        PIC X.
   746     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   747
   748 01  ACTQ-KEY                    PIC X(20).
   749
   750 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   751
   752 01  CHKQ-KEY.
   753     12  CHKQ-COMPANY-CODE       PIC X.
   754     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   755     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   756
   757 01  ARCH-KEY.
   758     12  ARCH-COMPANY-CODE       PIC X.
   759     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   760     12  ARCH-RECORD-TYPE        PIC X.
   761     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   762
   763 01  ACCT-KEY.
   764     05  ACCT-PARTIAL-KEY.
   765         12  ACCT-COMPANY-CODE   PIC X.
   766         12  ACCT-CARRIER        PIC X.
   767         12  ACCT-GROUP          PIC X(6).
   768         12  ACCT-STATE          PIC XX.
   769         12  ACCT-ACCOUNT        PIC X(10).
   770     05  ACCT-DATE               PIC XX.
   771
   772 01  WS-ELBENE-KEY.
   773     12  WS-ELBENE-COMPANY-CD    PIC X.
   774     12  WS-ELBENE-RECORD-TYPE   PIC X.
   775     12  WS-ELBENE-ID            PIC X(10).
   776
   777 01  ELALPH-KEY.
   778     12  ELALPH-COMPANY-CD       PIC X.
   779     12  ELALPH-SOURCE           PIC X.
   780     12  ELALPH-NAME.
   781         16  ELALPH-LAST-NAME    PIC X(15).
   782         16  ELALPH-FIRST-NAME.
   783             20  ELALPH-FIRST-INIT   PIC X.
   784             20  FILLER              PIC X(11).
   785         16  ELALPH-MIDDLE-INIT  PIC X.
   786     12  ELALPH-DATE             PIC X(08).
   787     12  ELALPH-TIME             PIC S9(04)    COMP.
   788
   789 01  COMP-LENGTHS.
   790     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   791     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  17
* EL131.cbl
   792     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   793     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   794     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   795     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   796     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   797     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   798     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   799     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   800     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   801     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   802     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   803     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  18
* EL131.cbl
   805*                                COPY ELCLNKLT.
   806******************************************************************
   807*                                                                *
   808*                                                                *
   809*                           ELCLNKLT                             *
   810*                            VMOD=2.003                          *
   811*                                                                *
   812*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   813*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   814*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   815*                                                                *
   816*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   817*   COMPLETING THE REQUIRED FIELDS.                              *
   818*                                                                *
   819*   THE CALLING PROGRAM SHOULD CHECK:                            *
   820*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   821*                              9999 INDICATES AN UNKNOWN ABEND   *
   822*                                   WAS DETECTED.                *
   823*                              ALL OTHER VALUES ARE NORMAL ERROR *
   824*                              CODES FOUND IN THE ERROR FILE.    *
   825******************************************************************
   826 01  W-1523-LINKDATA.
   827     12  W-1523-COMMON-PI-DATA.
   828         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   829         16  FILLER              PIC  X(67).
   830         16  W-1523-COMPANY-CD   PIC  X(01).
   831         16  FILLER              PIC  X(10).
   832         16  W-1523-CONTROL-IN-PROGRESS.
   833             20  W-1523-CARRIER  PIC  X(01).
   834             20  W-1523-GROUPING PIC  X(06).
   835             20  W-1523-STATE    PIC  X(02).
   836             20  W-1523-ACCOUNT  PIC  X(10).
   837             20  W-1523-CLAIM-CERT-GRP.
   838                 24  W-1523-CLAIM-NO
   839                                 PIC  X(07).
   840                 24  W-1523-CERT-NO.
   841                     28  W-1523-CERT-PRIME
   842                                 PIC  X(10).
   843                     28  W-1523-CERT-SFX
   844                                 PIC  X(01).
   845                 24  W-1523-CERT-EFF-DT
   846                                 PIC  X(02).
   847         16  FILLER              PIC X(265).
   848
   849     12  W-1523-WORK-AREA.
   850         16  W-1523-FORM-NUMBER  PIC  X(04).
   851         16  W-1523-NUMBER-COPIES
   852                                 PIC  9(01).
   853         16  W-1523-ADDR-TYPE    PIC  X(02).
   854         16  W-1523-FOLLOW-UP-DATE
   855                                 PIC  X(02).
   856         16  W-1523-RESEND-DATE  PIC  X(02).
   857         16  W-1523-ERROR-CODE   PIC  9(04).
   858             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   859             88  W-1523-FATAL-ERROR
   860                                    VALUES  0006 0013 0042
   861                                            0154 0168 0169
   862                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  19
* EL131.cbl
   863                                            0179 0186 0281
   864                                            0332 2055 3697
   865                                            3698 3699 3770
   866                                            3771 3772 7675
   867                                            9106 9808 9883
   868                                            9887.
   869             88  W-1523-STOP-ERRORS
   870                                    VALUES  0013 0042 0154
   871                                            0168 0169 0172
   872                                            0281 0332 2055
   873                                            3698 3699 7675
   874                                            9106 9808 9883
   875                                            9999.
   876         16  W-1523-REASON       PIC  X(70).
   877         16  W-1523-ARCHIVE-NUMBER
   878                                 PIC  9(08).
   879     12  W-1523-POINTER-AREA.
   880         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   881         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   882         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   883         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   884         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  20
* EL131.cbl
   886*                                COPY ELCINTF.
   887******************************************************************
   888*                                                                *
   889*                                                                *
   890*                            ELCINTF.                            *
   891*                            VMOD=2.017                          *
   892*                                                                *
   893*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   894*                                                                *
   895*       LENGTH = 1024                                            *
   896*                                                                *
   897******************************************************************
   898*                   C H A N G E   L O G
   899*
   900* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   901*-----------------------------------------------------------------
   902*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   903* EFFECTIVE    NUMBER
   904*-----------------------------------------------------------------
   905* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   906******************************************************************
   907 01  PROGRAM-INTERFACE-BLOCK.
   908     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   909     12  PI-CALLING-PROGRAM              PIC X(8).
   910     12  PI-SAVED-PROGRAM-1              PIC X(8).
   911     12  PI-SAVED-PROGRAM-2              PIC X(8).
   912     12  PI-SAVED-PROGRAM-3              PIC X(8).
   913     12  PI-SAVED-PROGRAM-4              PIC X(8).
   914     12  PI-SAVED-PROGRAM-5              PIC X(8).
   915     12  PI-SAVED-PROGRAM-6              PIC X(8).
   916     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   917     12  PI-COMPANY-ID                   PIC XXX.
   918     12  PI-COMPANY-CD                   PIC X.
   919
   920     12  PI-COMPANY-PASSWORD             PIC X(8).
   921
   922     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   923
   924     12  PI-CONTROL-IN-PROGRESS.
   925         16  PI-CARRIER                  PIC X.
   926         16  PI-GROUPING                 PIC X(6).
   927         16  PI-STATE                    PIC XX.
   928         16  PI-ACCOUNT                  PIC X(10).
   929         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   930                                         PIC X(10).
   931         16  PI-CLAIM-CERT-GRP.
   932             20  PI-CLAIM-NO             PIC X(7).
   933             20  PI-CERT-NO.
   934                 25  PI-CERT-PRIME       PIC X(10).
   935                 25  PI-CERT-SFX         PIC X.
   936             20  PI-CERT-EFF-DT          PIC XX.
   937         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   938             20  PI-PLAN-CODE            PIC X(2).
   939             20  PI-REVISION-NUMBER      PIC X(3).
   940             20  PI-PLAN-EFF-DT          PIC X(2).
   941             20  PI-PLAN-EXP-DT          PIC X(2).
   942             20  FILLER                  PIC X(11).
   943         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  21
* EL131.cbl
   944             20  PI-OE-REFERENCE-1.
   945                 25  PI-OE-REF-1-PRIME   PIC X(18).
   946                 25  PI-OE-REF-1-SUFF    PIC XX.
   947
   948     12  PI-SESSION-IN-PROGRESS          PIC X.
   949         88  CLAIM-SESSION                   VALUE '1'.
   950         88  CREDIT-SESSION                  VALUE '2'.
   951         88  WARRANTY-SESSION                VALUE '3'.
   952         88  MORTGAGE-SESSION                VALUE '4'.
   953         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   954
   955
   956*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   957
   958     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   959     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   960
   961     12  PI-CREDIT-USER                  PIC X.
   962         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   963         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   964
   965     12  PI-CLAIM-USER                   PIC X.
   966         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   967         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   968
   969     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   970         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   971         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   972         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   973         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   974         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   975
   976     12  PI-PROCESSOR-ID                 PIC X(4).
   977
   978     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   979
   980     12  PI-MEMBER-CAPTION               PIC X(10).
   981
   982     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   983         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   984
   985     12  PI-LIFE-OVERRIDE-L1             PIC X.
   986     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   987     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   988     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   989
   990     12  PI-AH-OVERRIDE-L1               PIC X.
   991     12  PI-AH-OVERRIDE-L2               PIC XX.
   992     12  PI-AH-OVERRIDE-L6               PIC X(6).
   993     12  PI-AH-OVERRIDE-L12              PIC X(12).
   994
   995     12  PI-NEW-SYSTEM                   PIC X(2).
   996
   997     12  PI-PRIMARY-CERT-NO              PIC X(11).
   998     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   999         88  PI-USES-PAID-TO                 VALUE '1'.
  1000     12  PI-CRDTCRD-SYSTEM.
  1001         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  22
* EL131.cbl
  1002             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1003             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1004         16  PI-CC-MONTH-END-DT          PIC XX.
  1005     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1006
  1007     12  PI-OE-REFERENCE-2.
  1008         16  PI-OE-REF-2-PRIME           PIC X(10).
  1009         16  PI-OE-REF-2-SUFF            PIC X.
  1010
  1011     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1012
  1013     12  PI-LANGUAGE-TYPE                PIC X.
  1014             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1015             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1016             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1017
  1018     12  PI-POLICY-LINKAGE-IND           PIC X.
  1019         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1020         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1021                                                   LOW-VALUES.
  1022
  1023     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1024     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1025         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1026         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1027
  1028     12  PI-PROCESSOR-CSR-IND            PIC X.
  1029         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1030         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1031
  1032     12  FILLER                          PIC X(3).
  1033
  1034     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1035
  1036     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1037         PI-SYSTEM-LEVEL.
  1038
  1039         16  PI-ENTRY-CODES.
  1040             20  PI-ENTRY-CD-1           PIC X.
  1041             20  PI-ENTRY-CD-2           PIC X.
  1042
  1043         16  PI-RETURN-CODES.
  1044             20  PI-RETURN-CD-1          PIC X.
  1045             20  PI-RETURN-CD-2          PIC X.
  1046
  1047         16  PI-UPDATE-STATUS-SAVE.
  1048             20  PI-UPDATE-BY            PIC X(4).
  1049             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1050
  1051         16  PI-LOWER-CASE-LETTERS       PIC X.
  1052             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1053
  1054*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1055*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1056*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1057
  1058         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1059             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  23
* EL131.cbl
  1060             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1061             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1062             88  ACCNT-CNTL                  VALUE '3'.
  1063             88  CARR-ACCNT-CNTL             VALUE '4'.
  1064
  1065         16  PI-PROCESSOR-CAP-LIST.
  1066             20  PI-SYSTEM-CONTROLS.
  1067                24 PI-SYSTEM-DISPLAY     PIC X.
  1068                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1069                24 PI-SYSTEM-MODIFY      PIC X.
  1070                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1071             20  FILLER                  PIC XX.
  1072             20  PI-DISPLAY-CAP          PIC X.
  1073                 88  DISPLAY-CAP             VALUE 'Y'.
  1074             20  PI-MODIFY-CAP           PIC X.
  1075                 88  MODIFY-CAP              VALUE 'Y'.
  1076             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1077                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1078             20  PI-FORCE-CAP            PIC X.
  1079                 88  FORCE-CAP               VALUE 'Y'.
  1080
  1081         16  PI-PROGRAM-CONTROLS.
  1082             20  PI-PGM-PRINT-OPT        PIC X.
  1083             20  PI-PGM-FORMAT-OPT       PIC X.
  1084             20  PI-PGM-PROCESS-OPT      PIC X.
  1085             20  PI-PGM-TOTALS-OPT       PIC X.
  1086
  1087         16  PI-HELP-INTERFACE.
  1088             20  PI-LAST-ERROR-NO        PIC X(4).
  1089             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1090
  1091         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1092             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1093
  1094         16  PI-CR-CONTROL-IN-PROGRESS.
  1095             20  PI-CR-CARRIER           PIC X.
  1096             20  PI-CR-GROUPING          PIC X(6).
  1097             20  PI-CR-STATE             PIC XX.
  1098             20  PI-CR-ACCOUNT           PIC X(10).
  1099             20  PI-CR-FIN-RESP          PIC X(10).
  1100             20  PI-CR-TYPE              PIC X.
  1101
  1102         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1103
  1104         16  PI-CR-MONTH-END-DT          PIC XX.
  1105
  1106         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1107             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1108             88  PI-ZERO-CARRIER             VALUE '1'.
  1109             88  PI-ZERO-GROUPING            VALUE '2'.
  1110             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1111
  1112         16  PI-CARRIER-SECURITY         PIC X.
  1113             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1114
  1115         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1116             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1117             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  24
* EL131.cbl
  1118
  1119         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1120             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1121                                         INDEXED BY PI-ACCESS-NDX
  1122                                         PIC X.
  1123
  1124         16  PI-GA-BILLING-CONTROL       PIC X.
  1125             88  PI-GA-BILLING               VALUE '1'.
  1126
  1127         16  PI-MAIL-PROCESSING          PIC X.
  1128             88  PI-MAIL-YES                 VALUE 'Y'.
  1129
  1130         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1131
  1132         16  PI-AR-SYSTEM.
  1133             20  PI-AR-PROCESSING-CNTL   PIC X.
  1134                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1135             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1136             20  PI-AR-MONTH-END-DT      PIC XX.
  1137
  1138         16  PI-MP-SYSTEM.
  1139             20  PI-MORTGAGE-USER            PIC X.
  1140                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1141                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1142             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1143                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1144                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1145                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1146                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1147                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1148             20  PI-MP-MONTH-END-DT          PIC XX.
  1149             20  PI-MP-REFERENCE-NO.
  1150                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1151                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1152
  1153         16  PI-LABEL-CONTROL            PIC X(01).
  1154             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1155             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1156
  1157         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1158             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1159
  1160         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1161             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1162             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1163
  1164         16  FILLER                      PIC X(14).
  1165
  1166     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1167******************************************************************
  1168     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1169         16  PI-NO-PMTS                    PIC 9(4).
  1170         16  PI-CERT-SWITCH                PIC X.
  1171             88  CREATED-CERT              VALUE '2'.
  1172         16  PI-PREM-TYPE                  PIC X.
  1173         16  PI-SAVE-CERT-NO.
  1174             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1175             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  25
* EL131.cbl
  1176         16  FILLER                        PIC X(46).
  1177         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1178         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1179         16  PI-REC-FOUND-SW               PIC X.
  1180         16  PI-LETTER-SW                  PIC X.
  1181         16  PI-PREV-TRLR-KEY              PIC X(22).
  1182         16  pi-claim-type                 pic x.
  1183         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1184         16  pi-approval-level             pic x.
  1185         16  FILLER                        PIC X(543).
  1186
  1187 01  SAVE-RECORD                 PIC X(450).
  1188
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  26
* EL131.cbl
  1190*                                COPY ELCLOGOF SUPPRESS.
  1191******************************************************************
  1192*                                                                *
  1193*                                                                *
  1194*                            ELCLOGOF.                           *
  1195*                            VMOD=2.001                          *
  1196*                                                                *
  1197*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1198*                                                                *
  1199******************************************************************
  1200 01  CLASIC-LOGOFF.
  1201     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1202     12  LOGOFF-TEXT.
  1203         16  FILLER          PIC X(5)    VALUE SPACES.
  1204         16  LOGOFF-MSG.
  1205             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1206             20  FILLER      PIC X       VALUE SPACES.
  1207             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1208         16  FILLER          PIC X(80)
  1209           VALUE '* YOU ARE NOW LOGGED OFF'.
  1210         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1211         16  FILLER          PIC X       VALUE QUOTE.
  1212         16  LOGOFF-SYS-MSG  PIC X(17)
  1213           VALUE 'S CLAS-IC SYSTEM '.
  1214     12  TEXT-MESSAGES.
  1215         16  UNACCESS-MSG    PIC X(29)
  1216             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1217         16  PGMIDERR-MSG    PIC X(17)
  1218             VALUE 'PROGRAM NOT FOUND'.
  1219
  1220*                                COPY ELCATTR SUPPRESS.
  1221******************************************************************
  1222*                                                                *
  1223*                            ELCATTR.                            *
  1224*                            VMOD=2.001                          *
  1225*                                                                *
  1226*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1227*                                                                *
  1228*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1229*                                                                *
  1230*                   POS 1   P=PROTECTED                          *
  1231*                           U=UNPROTECTED                        *
  1232*                           S=ASKIP                              *
  1233*                   POS 2   A=ALPHA/NUMERIC                      *
  1234*                           N=NUMERIC                            *
  1235*                   POS 3   N=NORMAL                             *
  1236*                           B=BRIGHT                             *
  1237*                           D=DARK                               *
  1238*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1239*                           OF=MODIFIED DATA TAG OFF             *
  1240*                                                                *
  1241*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1242******************************************************************
  1243 01  ATTRIBUTE-LIST.
  1244     12  AL-PABOF            PIC X       VALUE 'Y'.
  1245     12  AL-PABON            PIC X       VALUE 'Z'.
  1246     12  AL-PADOF            PIC X       VALUE '%'.
  1247     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  27
* EL131.cbl
  1248     12  AL-PANOF            PIC X       VALUE '-'.
  1249     12  AL-PANON            PIC X       VALUE '/'.
  1250     12  AL-SABOF            PIC X       VALUE '8'.
  1251     12  AL-SABON            PIC X       VALUE '9'.
  1252     12  AL-SADOF            PIC X       VALUE '@'.
  1253     12  AL-SADON            PIC X       VALUE QUOTE.
  1254     12  AL-SANOF            PIC X       VALUE '0'.
  1255     12  AL-SANON            PIC X       VALUE '1'.
  1256     12  AL-UABOF            PIC X       VALUE 'H'.
  1257     12  AL-UABON            PIC X       VALUE 'I'.
  1258     12  AL-UADOF            PIC X       VALUE '<'.
  1259     12  AL-UADON            PIC X       VALUE '('.
  1260     12  AL-UANOF            PIC X       VALUE ' '.
  1261     12  AL-UANON            PIC X       VALUE 'A'.
  1262     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1263     12  AL-UNBON            PIC X       VALUE 'R'.
  1264     12  AL-UNDOF            PIC X       VALUE '*'.
  1265     12  AL-UNDON            PIC X       VALUE ')'.
  1266     12  AL-UNNOF            PIC X       VALUE '&'.
  1267     12  AL-UNNON            PIC X       VALUE 'J'.
  1268
  1269*                                COPY ELCAID SUPPRESS.
  1270******************************************************************
  1271*                                                                *
  1272*                            ELCAID.                             *
  1273*                            VMOD=2.001                          *
  1274*                                                                *
  1275*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1276*                                                                *
  1277*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1278*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1279******************************************************************
  1280
  1281 01  DFHAID.
  1282   02  DFHNULL   PIC  X  VALUE  ' '.
  1283   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1284   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1285   02  DFHPEN    PIC  X  VALUE  '='.
  1286   02  DFHOPID   PIC  X  VALUE  'W'.
  1287   02  DFHPA1    PIC  X  VALUE  '%'.
  1288   02  DFHPA2    PIC  X  VALUE  '>'.
  1289   02  DFHPA3    PIC  X  VALUE  ','.
  1290   02  DFHPF1    PIC  X  VALUE  '1'.
  1291   02  DFHPF2    PIC  X  VALUE  '2'.
  1292   02  DFHPF3    PIC  X  VALUE  '3'.
  1293   02  DFHPF4    PIC  X  VALUE  '4'.
  1294   02  DFHPF5    PIC  X  VALUE  '5'.
  1295   02  DFHPF6    PIC  X  VALUE  '6'.
  1296   02  DFHPF7    PIC  X  VALUE  '7'.
  1297   02  DFHPF8    PIC  X  VALUE  '8'.
  1298   02  DFHPF9    PIC  X  VALUE  '9'.
  1299   02  DFHPF10   PIC  X  VALUE  ':'.
  1300   02  DFHPF11   PIC  X  VALUE  '#'.
  1301   02  DFHPF12   PIC  X  VALUE  '@'.
  1302   02  DFHPF13   PIC  X  VALUE  'A'.
  1303   02  DFHPF14   PIC  X  VALUE  'B'.
  1304   02  DFHPF15   PIC  X  VALUE  'C'.
  1305   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  28
* EL131.cbl
  1306   02  DFHPF17   PIC  X  VALUE  'E'.
  1307   02  DFHPF18   PIC  X  VALUE  'F'.
  1308   02  DFHPF19   PIC  X  VALUE  'G'.
  1309   02  DFHPF20   PIC  X  VALUE  'H'.
  1310   02  DFHPF21   PIC  X  VALUE  'I'.
  1311*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1312   02  DFHPF22   PIC  X  VALUE  '['.
  1313   02  DFHPF23   PIC  X  VALUE  '.'.
  1314   02  DFHPF24   PIC  X  VALUE  '<'.
  1315   02  DFHMSRE   PIC  X  VALUE  'X'.
  1316   02  DFHSTRF   PIC  X  VALUE  'h'.
  1317   02  DFHTRIG   PIC  X  VALUE  '"'.
  1318 01  FILLER REDEFINES DFHAID.
  1319     12  FILLER                  PIC X(8).
  1320     12  AID-KEYS OCCURS 24 TIMES.
  1321         16  FILLER              PIC X.
  1322
  1323*                                COPY EL131S.
  1324 01  EL131AI.
  1325     05  FILLER            PIC  X(0012).
  1326*    -------------------------------
  1327     05  DATEL PIC S9(0004) COMP.
  1328     05  DATEF PIC  X(0001).
  1329     05  FILLER REDEFINES DATEF.
  1330         10  DATEA PIC  X(0001).
  1331     05  DATEI PIC  X(0008).
  1332*    -------------------------------
  1333     05  TIMEL PIC S9(0004) COMP.
  1334     05  TIMEF PIC  X(0001).
  1335     05  FILLER REDEFINES TIMEF.
  1336         10  TIMEA PIC  X(0001).
  1337     05  TIMEI PIC  X(0005).
  1338*    -------------------------------
  1339     05  SEQUL PIC S9(0004) COMP.
  1340     05  SEQUF PIC  X(0001).
  1341     05  FILLER REDEFINES SEQUF.
  1342         10  SEQUA PIC  X(0001).
  1343     05  SEQUI PIC  X(0010).
  1344*    -------------------------------
  1345     05  COMPL PIC S9(0004) COMP.
  1346     05  COMPF PIC  X(0001).
  1347     05  FILLER REDEFINES COMPF.
  1348         10  COMPA PIC  X(0001).
  1349     05  COMPI PIC  X(0003).
  1350*    -------------------------------
  1351     05  USERIDL PIC S9(0004) COMP.
  1352     05  USERIDF PIC  X(0001).
  1353     05  FILLER REDEFINES USERIDF.
  1354         10  USERIDA PIC  X(0001).
  1355     05  USERIDI PIC  X(0004).
  1356*    -------------------------------
  1357     05  CCNOL PIC S9(0004) COMP.
  1358     05  CCNOF PIC  X(0001).
  1359     05  FILLER REDEFINES CCNOF.
  1360         10  CCNOA PIC  X(0001).
  1361     05  CCNOI PIC  X(0016).
  1362*    -------------------------------
  1363     05  MAINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  29
* EL131.cbl
  1364     05  MAINTF PIC  X(0001).
  1365     05  FILLER REDEFINES MAINTF.
  1366         10  MAINTA PIC  X(0001).
  1367     05  MAINTI PIC  X(0001).
  1368*    -------------------------------
  1369     05  CLAIML PIC S9(0004) COMP.
  1370     05  CLAIMF PIC  X(0001).
  1371     05  FILLER REDEFINES CLAIMF.
  1372         10  CLAIMA PIC  X(0001).
  1373     05  CLAIMI PIC  X(0007).
  1374*    -------------------------------
  1375     05  CARRL PIC S9(0004) COMP.
  1376     05  CARRF PIC  X(0001).
  1377     05  FILLER REDEFINES CARRF.
  1378         10  CARRA PIC  X(0001).
  1379     05  CARRI PIC  X(0001).
  1380*    -------------------------------
  1381     05  CERTL PIC S9(0004) COMP.
  1382     05  CERTF PIC  X(0001).
  1383     05  FILLER REDEFINES CERTF.
  1384         10  CERTA PIC  X(0001).
  1385     05  CERTI PIC  X(0010).
  1386*    -------------------------------
  1387     05  SUFXL PIC S9(0004) COMP.
  1388     05  SUFXF PIC  X(0001).
  1389     05  FILLER REDEFINES SUFXF.
  1390         10  SUFXA PIC  X(0001).
  1391     05  SUFXI PIC  X(0001).
  1392*    -------------------------------
  1393     05  TYPEL PIC S9(0004) COMP.
  1394     05  TYPEF PIC  X(0001).
  1395     05  FILLER REDEFINES TYPEF.
  1396         10  TYPEA PIC  X(0001).
  1397     05  TYPEI PIC  X(0001).
  1398*    -------------------------------
  1399     05  LABEL1L PIC S9(0004) COMP.
  1400     05  LABEL1F PIC  X(0001).
  1401     05  FILLER REDEFINES LABEL1F.
  1402         10  LABEL1A PIC  X(0001).
  1403     05  LABEL1I PIC  X(0011).
  1404*    -------------------------------
  1405     05  PCERTNOL PIC S9(0004) COMP.
  1406     05  PCERTNOF PIC  X(0001).
  1407     05  FILLER REDEFINES PCERTNOF.
  1408         10  PCERTNOA PIC  X(0001).
  1409     05  PCERTNOI PIC  X(0010).
  1410*    -------------------------------
  1411     05  PSUFXL PIC S9(0004) COMP.
  1412     05  PSUFXF PIC  X(0001).
  1413     05  FILLER REDEFINES PSUFXF.
  1414         10  PSUFXA PIC  X(0001).
  1415     05  PSUFXI PIC  X(0001).
  1416*    -------------------------------
  1417     05  STATUSL PIC S9(0004) COMP.
  1418     05  STATUSF PIC  X(0001).
  1419     05  FILLER REDEFINES STATUSF.
  1420         10  STATUSA PIC  X(0001).
  1421     05  STATUSI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  30
* EL131.cbl
  1422*    -------------------------------
  1423     05  INCL PIC S9(0004) COMP.
  1424     05  INCF PIC  X(0001).
  1425     05  FILLER REDEFINES INCF.
  1426         10  INCA PIC  X(0001).
  1427     05  INCI PIC  X(0008).
  1428*    -------------------------------
  1429     05  REPL PIC S9(0004) COMP.
  1430     05  REPF PIC  X(0001).
  1431     05  FILLER REDEFINES REPF.
  1432         10  REPA PIC  X(0001).
  1433     05  REPI PIC  X(0008).
  1434*    -------------------------------
  1435     05  CAUSEL PIC S9(0004) COMP.
  1436     05  CAUSEF PIC  X(0001).
  1437     05  FILLER REDEFINES CAUSEF.
  1438         10  CAUSEA PIC  X(0001).
  1439     05  CAUSEI PIC  X(0006).
  1440*    -------------------------------
  1441     05  ENDL PIC S9(0004) COMP.
  1442     05  ENDF PIC  X(0001).
  1443     05  FILLER REDEFINES ENDF.
  1444         10  ENDA PIC  X(0001).
  1445     05  ENDI PIC  X(0008).
  1446*    -------------------------------
  1447     05  DIAGL PIC S9(0004) COMP.
  1448     05  DIAGF PIC  X(0001).
  1449     05  FILLER REDEFINES DIAGF.
  1450         10  DIAGA PIC  X(0001).
  1451     05  DIAGI PIC  X(0060).
  1452*    -------------------------------
  1453     05  ACCSWL PIC S9(0004) COMP.
  1454     05  ACCSWF PIC  X(0001).
  1455     05  FILLER REDEFINES ACCSWF.
  1456         10  ACCSWA PIC  X(0001).
  1457     05  ACCSWI PIC  X(0001).
  1458*    -------------------------------
  1459     05  BENEL PIC S9(0004) COMP.
  1460     05  BENEF PIC  X(0001).
  1461     05  FILLER REDEFINES BENEF.
  1462         10  BENEA PIC  X(0001).
  1463     05  BENEI PIC  X(0010).
  1464*    -------------------------------
  1465     05  BIRTHL PIC S9(0004) COMP.
  1466     05  BIRTHF PIC  X(0001).
  1467     05  FILLER REDEFINES BIRTHF.
  1468         10  BIRTHA PIC  X(0001).
  1469     05  BIRTHI PIC  X(0008).
  1470*    -------------------------------
  1471     05  SOCIALL PIC S9(0004) COMP.
  1472     05  SOCIALF PIC  X(0001).
  1473     05  FILLER REDEFINES SOCIALF.
  1474         10  SOCIALA PIC  X(0001).
  1475     05  SOCIALI PIC  X(0011).
  1476*    -------------------------------
  1477     05  SEXL PIC S9(0004) COMP.
  1478     05  SEXF PIC  X(0001).
  1479     05  FILLER REDEFINES SEXF.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  31
* EL131.cbl
  1480         10  SEXA PIC  X(0001).
  1481     05  SEXI PIC  X(0001).
  1482*    -------------------------------
  1483     05  MLNAMEL PIC S9(0004) COMP.
  1484     05  MLNAMEF PIC  X(0001).
  1485     05  FILLER REDEFINES MLNAMEF.
  1486         10  MLNAMEA PIC  X(0001).
  1487     05  MLNAMEI PIC  X(0015).
  1488*    -------------------------------
  1489     05  MFNAMEL PIC S9(0004) COMP.
  1490     05  MFNAMEF PIC  X(0001).
  1491     05  FILLER REDEFINES MFNAMEF.
  1492         10  MFNAMEA PIC  X(0001).
  1493     05  MFNAMEI PIC  X(0012).
  1494*    -------------------------------
  1495     05  MMINITL PIC S9(0004) COMP.
  1496     05  MMINITF PIC  X(0001).
  1497     05  FILLER REDEFINES MMINITF.
  1498         10  MMINITA PIC  X(0001).
  1499     05  MMINITI PIC  X(0001).
  1500*    -------------------------------
  1501     05  LOANNOL PIC S9(0004) COMP.
  1502     05  LOANNOF PIC  X(0001).
  1503     05  FILLER REDEFINES LOANNOF.
  1504         10  LOANNOA PIC  X(0001).
  1505     05  LOANNOI PIC  X(0008).
  1506*    -------------------------------
  1507     05  CRTLNMEL PIC S9(0004) COMP.
  1508     05  CRTLNMEF PIC  X(0001).
  1509     05  FILLER REDEFINES CRTLNMEF.
  1510         10  CRTLNMEA PIC  X(0001).
  1511     05  CRTLNMEI PIC  X(0015).
  1512*    -------------------------------
  1513     05  CRTFNMEL PIC S9(0004) COMP.
  1514     05  CRTFNMEF PIC  X(0001).
  1515     05  FILLER REDEFINES CRTFNMEF.
  1516         10  CRTFNMEA PIC  X(0001).
  1517     05  CRTFNMEI PIC  X(0012).
  1518*    -------------------------------
  1519     05  CRTINITL PIC S9(0004) COMP.
  1520     05  CRTINITF PIC  X(0001).
  1521     05  FILLER REDEFINES CRTINITF.
  1522         10  CRTINITA PIC  X(0001).
  1523     05  CRTINITI PIC  X(0001).
  1524*    -------------------------------
  1525     05  LOANBALL PIC S9(0004) COMP.
  1526     05  LOANBALF PIC  X(0001).
  1527     05  FILLER REDEFINES LOANBALF.
  1528         10  LOANBALA PIC  X(0001).
  1529     05  LOANBALI PIC  9(7)V99.
  1530*    -------------------------------
  1531     05  PROCL PIC S9(0004) COMP.
  1532     05  PROCF PIC  X(0001).
  1533     05  FILLER REDEFINES PROCF.
  1534         10  PROCA PIC  X(0001).
  1535     05  PROCI PIC  X(0004).
  1536*    -------------------------------
  1537     05  SUPVL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  32
* EL131.cbl
  1538     05  SUPVF PIC  X(0001).
  1539     05  FILLER REDEFINES SUPVF.
  1540         10  SUPVA PIC  X(0001).
  1541     05  SUPVI PIC  X(0001).
  1542*    -------------------------------
  1543     05  PRICDL PIC S9(0004) COMP.
  1544     05  PRICDF PIC  X(0001).
  1545     05  FILLER REDEFINES PRICDF.
  1546         10  PRICDA PIC  X(0001).
  1547     05  PRICDI PIC  X(0001).
  1548*    -------------------------------
  1549     05  CRITPL PIC S9(0004) COMP.
  1550     05  CRITPF PIC  X(0001).
  1551     05  FILLER REDEFINES CRITPF.
  1552         10  CRITPA PIC  X(0001).
  1553     05  CRITPI PIC  X(0002).
  1554*    -------------------------------
  1555     05  CRITPTL PIC S9(0004) COMP.
  1556     05  CRITPTF PIC  X(0001).
  1557     05  FILLER REDEFINES CRITPTF.
  1558         10  CRITPTA PIC  X(0001).
  1559     05  CRITPTI PIC  X(0001).
  1560*    -------------------------------
  1561     05  RTWMOSL PIC S9(0004) COMP.
  1562     05  RTWMOSF PIC  X(0001).
  1563     05  FILLER REDEFINES RTWMOSF.
  1564         10  RTWMOSA PIC  X(0001).
  1565     05  RTWMOSI PIC  X(0002).
  1566*    -------------------------------
  1567     05  FILETOL PIC S9(0004) COMP.
  1568     05  FILETOF PIC  X(0001).
  1569     05  FILLER REDEFINES FILETOF.
  1570         10  FILETOA PIC  X(0001).
  1571     05  FILETOI PIC  X(0004).
  1572*    -------------------------------
  1573     05  PTHRHDGL PIC S9(0004) COMP.
  1574     05  PTHRHDGF PIC  X(0001).
  1575     05  FILLER REDEFINES PTHRHDGF.
  1576         10  PTHRHDGA PIC  X(0001).
  1577     05  PTHRHDGI PIC  X(0010).
  1578*    -------------------------------
  1579     05  PDTHRUL PIC S9(0004) COMP.
  1580     05  PDTHRUF PIC  X(0001).
  1581     05  FILLER REDEFINES PDTHRUF.
  1582         10  PDTHRUA PIC  X(0001).
  1583     05  PDTHRUI PIC  X(0008).
  1584*    -------------------------------
  1585     05  PDAMTL PIC S9(0004) COMP.
  1586     05  PDAMTF PIC  X(0001).
  1587     05  FILLER REDEFINES PDAMTF.
  1588         10  PDAMTA PIC  X(0001).
  1589     05  PDAMTI PIC  9(7)V99.
  1590*    -------------------------------
  1591     05  NODAYSL PIC S9(0004) COMP.
  1592     05  NODAYSF PIC  X(0001).
  1593     05  FILLER REDEFINES NODAYSF.
  1594         10  NODAYSA PIC  X(0001).
  1595     05  NODAYSI PIC  9(5).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  33
* EL131.cbl
  1596*    -------------------------------
  1597     05  NOPMTSL PIC S9(0004) COMP.
  1598     05  NOPMTSF PIC  X(0001).
  1599     05  FILLER REDEFINES NOPMTSF.
  1600         10  NOPMTSA PIC  X(0001).
  1601     05  NOPMTSI PIC  9(4).
  1602*    -------------------------------
  1603     05  FORMTYPL PIC S9(0004) COMP.
  1604     05  FORMTYPF PIC  X(0001).
  1605     05  FILLER REDEFINES FORMTYPF.
  1606         10  FORMTYPA PIC  X(0001).
  1607     05  FORMTYPI PIC  X(0001).
  1608*    -------------------------------
  1609     05  ESTL PIC S9(0004) COMP.
  1610     05  ESTF PIC  X(0001).
  1611     05  FILLER REDEFINES ESTF.
  1612         10  ESTA PIC  X(0001).
  1613     05  ESTI PIC  X(0008).
  1614*    -------------------------------
  1615     05  AUIDL PIC S9(0004) COMP.
  1616     05  AUIDF PIC  X(0001).
  1617     05  FILLER REDEFINES AUIDF.
  1618         10  AUIDA PIC  X(0001).
  1619     05  AUIDI PIC  X(0004).
  1620*    -------------------------------
  1621     05  OCCL PIC S9(0004) COMP.
  1622     05  OCCF PIC  X(0001).
  1623     05  FILLER REDEFINES OCCF.
  1624         10  OCCA PIC  X(0001).
  1625     05  OCCI PIC  X(0006).
  1626*    -------------------------------
  1627     05  MNTDTL PIC S9(0004) COMP.
  1628     05  MNTDTF PIC  X(0001).
  1629     05  FILLER REDEFINES MNTDTF.
  1630         10  MNTDTA PIC  X(0001).
  1631     05  MNTDTI PIC  X(0008).
  1632*    -------------------------------
  1633     05  MNTTYPEL PIC S9(0004) COMP.
  1634     05  MNTTYPEF PIC  X(0001).
  1635     05  FILLER REDEFINES MNTTYPEF.
  1636         10  MNTTYPEA PIC  X(0001).
  1637     05  MNTTYPEI PIC  X(0006).
  1638*    -------------------------------
  1639     05  CERTCARL PIC S9(0004) COMP.
  1640     05  CERTCARF PIC  X(0001).
  1641     05  FILLER REDEFINES CERTCARF.
  1642         10  CERTCARA PIC  X(0001).
  1643     05  CERTCARI PIC  X(0001).
  1644*    -------------------------------
  1645     05  CERTGRPL PIC S9(0004) COMP.
  1646     05  CERTGRPF PIC  X(0001).
  1647     05  FILLER REDEFINES CERTGRPF.
  1648         10  CERTGRPA PIC  X(0001).
  1649     05  CERTGRPI PIC  X(0006).
  1650*    -------------------------------
  1651     05  CERTSTL PIC S9(0004) COMP.
  1652     05  CERTSTF PIC  X(0001).
  1653     05  FILLER REDEFINES CERTSTF.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  34
* EL131.cbl
  1654         10  CERTSTA PIC  X(0001).
  1655     05  CERTSTI PIC  X(0002).
  1656*    -------------------------------
  1657     05  CERTACTL PIC S9(0004) COMP.
  1658     05  CERTACTF PIC  X(0001).
  1659     05  FILLER REDEFINES CERTACTF.
  1660         10  CERTACTA PIC  X(0001).
  1661     05  CERTACTI PIC  X(0010).
  1662*    -------------------------------
  1663     05  CERTEFFL PIC S9(0004) COMP.
  1664     05  CERTEFFF PIC  X(0001).
  1665     05  FILLER REDEFINES CERTEFFF.
  1666         10  CERTEFFA PIC  X(0001).
  1667     05  CERTEFFI PIC  X(0008).
  1668*    -------------------------------
  1669     05  ISSAGEL PIC S9(0004) COMP.
  1670     05  ISSAGEF PIC  X(0001).
  1671     05  FILLER REDEFINES ISSAGEF.
  1672         10  ISSAGEA PIC  X(0001).
  1673     05  ISSAGEI PIC  X(0002).
  1674*    -------------------------------
  1675     05  APRL PIC S9(0004) COMP.
  1676     05  APRF PIC  X(0001).
  1677     05  FILLER REDEFINES APRF.
  1678         10  APRA PIC  X(0001).
  1679     05  APRI PIC  9(4)V9(4).
  1680*    -------------------------------
  1681     05  PMTFREQL PIC S9(0004) COMP.
  1682     05  PMTFREQF PIC  X(0001).
  1683     05  FILLER REDEFINES PMTFREQF.
  1684         10  PMTFREQA PIC  X(0001).
  1685     05  PMTFREQI PIC  99.
  1686*    -------------------------------
  1687     05  INDGRPL PIC S9(0004) COMP.
  1688     05  INDGRPF PIC  X(0001).
  1689     05  FILLER REDEFINES INDGRPF.
  1690         10  INDGRPA PIC  X(0001).
  1691     05  INDGRPI PIC  X(0001).
  1692*    -------------------------------
  1693     05  PREMTYPL PIC S9(0004) COMP.
  1694     05  PREMTYPF PIC  X(0001).
  1695     05  FILLER REDEFINES PREMTYPF.
  1696         10  PREMTYPA PIC  X(0001).
  1697     05  PREMTYPI PIC  X(0001).
  1698*    -------------------------------
  1699     05  REINCDL PIC S9(0004) COMP.
  1700     05  REINCDF PIC  X(0001).
  1701     05  FILLER REDEFINES REINCDF.
  1702         10  REINCDA PIC  X(0001).
  1703     05  REINCDI PIC  X(0001).
  1704*    -------------------------------
  1705     05  JNTLNMEL PIC S9(0004) COMP.
  1706     05  JNTLNMEF PIC  X(0001).
  1707     05  FILLER REDEFINES JNTLNMEF.
  1708         10  JNTLNMEA PIC  X(0001).
  1709     05  JNTLNMEI PIC  X(0015).
  1710*    -------------------------------
  1711     05  JNTFNMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  35
* EL131.cbl
  1712     05  JNTFNMEF PIC  X(0001).
  1713     05  FILLER REDEFINES JNTFNMEF.
  1714         10  JNTFNMEA PIC  X(0001).
  1715     05  JNTFNMEI PIC  X(0012).
  1716*    -------------------------------
  1717     05  JNTINITL PIC S9(0004) COMP.
  1718     05  JNTINITF PIC  X(0001).
  1719     05  FILLER REDEFINES JNTINITF.
  1720         10  JNTINITA PIC  X(0001).
  1721     05  JNTINITI PIC  X(0001).
  1722*    -------------------------------
  1723     05  JNTAGEL PIC S9(0004) COMP.
  1724     05  JNTAGEF PIC  X(0001).
  1725     05  FILLER REDEFINES JNTAGEF.
  1726         10  JNTAGEA PIC  X(0001).
  1727     05  JNTAGEI PIC  X(0002).
  1728*    -------------------------------
  1729     05  ADDONDTL PIC S9(0004) COMP.
  1730     05  ADDONDTF PIC  X(0001).
  1731     05  FILLER REDEFINES ADDONDTF.
  1732         10  ADDONDTA PIC  X(0001).
  1733     05  ADDONDTI PIC  X(0008).
  1734*    -------------------------------
  1735     05  LCVDSCRL PIC S9(0004) COMP.
  1736     05  LCVDSCRF PIC  X(0001).
  1737     05  FILLER REDEFINES LCVDSCRF.
  1738         10  LCVDSCRA PIC  X(0001).
  1739     05  LCVDSCRI PIC  X(0006).
  1740*    -------------------------------
  1741     05  LCVKINDL PIC S9(0004) COMP.
  1742     05  LCVKINDF PIC  X(0001).
  1743     05  FILLER REDEFINES LCVKINDF.
  1744         10  LCVKINDA PIC  X(0001).
  1745     05  LCVKINDI PIC  X(0003).
  1746*    -------------------------------
  1747     05  LCVCDL PIC S9(0004) COMP.
  1748     05  LCVCDF PIC  X(0001).
  1749     05  FILLER REDEFINES LCVCDF.
  1750         10  LCVCDA PIC  X(0001).
  1751     05  LCVCDI PIC  X(0002).
  1752*    -------------------------------
  1753     05  LCVOTRML PIC S9(0004) COMP.
  1754     05  LCVOTRMF PIC  X(0001).
  1755     05  FILLER REDEFINES LCVOTRMF.
  1756         10  LCVOTRMA PIC  X(0001).
  1757     05  LCVOTRMI PIC  999.
  1758*    -------------------------------
  1759     05  LCVRTRML PIC S9(0004) COMP.
  1760     05  LCVRTRMF PIC  X(0001).
  1761     05  FILLER REDEFINES LCVRTRMF.
  1762         10  LCVRTRMA PIC  X(0001).
  1763     05  LCVRTRMI PIC  X(0003).
  1764*    -------------------------------
  1765     05  LCVRATEL PIC S9(0004) COMP.
  1766     05  LCVRATEF PIC  X(0001).
  1767     05  FILLER REDEFINES LCVRATEF.
  1768         10  LCVRATEA PIC  X(0001).
  1769     05  LCVRATEI PIC  9999V99.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  36
* EL131.cbl
  1770*    -------------------------------
  1771     05  LCVBENEL PIC S9(0004) COMP.
  1772     05  LCVBENEF PIC  X(0001).
  1773     05  FILLER REDEFINES LCVBENEF.
  1774         10  LCVBENEA PIC  X(0001).
  1775     05  LCVBENEI PIC  9(9)V99.
  1776*    -------------------------------
  1777     05  LCVFORML PIC S9(0004) COMP.
  1778     05  LCVFORMF PIC  X(0001).
  1779     05  FILLER REDEFINES LCVFORMF.
  1780         10  LCVFORMA PIC  X(0001).
  1781     05  LCVFORMI PIC  X(0012).
  1782*    -------------------------------
  1783     05  LCVCNDTL PIC S9(0004) COMP.
  1784     05  LCVCNDTF PIC  X(0001).
  1785     05  FILLER REDEFINES LCVCNDTF.
  1786         10  LCVCNDTA PIC  X(0001).
  1787     05  LCVCNDTI PIC  X(0008).
  1788*    -------------------------------
  1789     05  LCVEXITL PIC S9(0004) COMP.
  1790     05  LCVEXITF PIC  X(0001).
  1791     05  FILLER REDEFINES LCVEXITF.
  1792         10  LCVEXITA PIC  X(0001).
  1793     05  LCVEXITI PIC  X(0008).
  1794*    -------------------------------
  1795     05  LCVSTATL PIC S9(0004) COMP.
  1796     05  LCVSTATF PIC  X(0001).
  1797     05  FILLER REDEFINES LCVSTATF.
  1798         10  LCVSTATA PIC  X(0001).
  1799     05  LCVSTATI PIC  X(0006).
  1800*    -------------------------------
  1801     05  ACVDSCRL PIC S9(0004) COMP.
  1802     05  ACVDSCRF PIC  X(0001).
  1803     05  FILLER REDEFINES ACVDSCRF.
  1804         10  ACVDSCRA PIC  X(0001).
  1805     05  ACVDSCRI PIC  X(0006).
  1806*    -------------------------------
  1807     05  ACVKINDL PIC S9(0004) COMP.
  1808     05  ACVKINDF PIC  X(0001).
  1809     05  FILLER REDEFINES ACVKINDF.
  1810         10  ACVKINDA PIC  X(0001).
  1811     05  ACVKINDI PIC  X(0003).
  1812*    -------------------------------
  1813     05  ACVCDL PIC S9(0004) COMP.
  1814     05  ACVCDF PIC  X(0001).
  1815     05  FILLER REDEFINES ACVCDF.
  1816         10  ACVCDA PIC  X(0001).
  1817     05  ACVCDI PIC  X(0002).
  1818*    -------------------------------
  1819     05  ACVOTRML PIC S9(0004) COMP.
  1820     05  ACVOTRMF PIC  X(0001).
  1821     05  FILLER REDEFINES ACVOTRMF.
  1822         10  ACVOTRMA PIC  X(0001).
  1823     05  ACVOTRMI PIC  999.
  1824*    -------------------------------
  1825     05  ACVRTRML PIC S9(0004) COMP.
  1826     05  ACVRTRMF PIC  X(0001).
  1827     05  FILLER REDEFINES ACVRTRMF.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  37
* EL131.cbl
  1828         10  ACVRTRMA PIC  X(0001).
  1829     05  ACVRTRMI PIC  X(0003).
  1830*    -------------------------------
  1831     05  ACVRATEL PIC S9(0004) COMP.
  1832     05  ACVRATEF PIC  X(0001).
  1833     05  FILLER REDEFINES ACVRATEF.
  1834         10  ACVRATEA PIC  X(0001).
  1835     05  ACVRATEI PIC  9999V99.
  1836*    -------------------------------
  1837     05  ACVBENEL PIC S9(0004) COMP.
  1838     05  ACVBENEF PIC  X(0001).
  1839     05  FILLER REDEFINES ACVBENEF.
  1840         10  ACVBENEA PIC  X(0001).
  1841     05  ACVBENEI PIC  9(9)V99.
  1842*    -------------------------------
  1843     05  ACVFORML PIC S9(0004) COMP.
  1844     05  ACVFORMF PIC  X(0001).
  1845     05  FILLER REDEFINES ACVFORMF.
  1846         10  ACVFORMA PIC  X(0001).
  1847     05  ACVFORMI PIC  X(0012).
  1848*    -------------------------------
  1849     05  ACVCNDTL PIC S9(0004) COMP.
  1850     05  ACVCNDTF PIC  X(0001).
  1851     05  FILLER REDEFINES ACVCNDTF.
  1852         10  ACVCNDTA PIC  X(0001).
  1853     05  ACVCNDTI PIC  X(0008).
  1854*    -------------------------------
  1855     05  ACVEXITL PIC S9(0004) COMP.
  1856     05  ACVEXITF PIC  X(0001).
  1857     05  FILLER REDEFINES ACVEXITF.
  1858         10  ACVEXITA PIC  X(0001).
  1859     05  ACVEXITI PIC  X(0008).
  1860*    -------------------------------
  1861     05  ACVSTATL PIC S9(0004) COMP.
  1862     05  ACVSTATF PIC  X(0001).
  1863     05  FILLER REDEFINES ACVSTATF.
  1864         10  ACVSTATA PIC  X(0001).
  1865     05  ACVSTATI PIC  X(0006).
  1866*    -------------------------------
  1867     05  LABEL2L PIC S9(0004) COMP.
  1868     05  LABEL2F PIC  X(0001).
  1869     05  FILLER REDEFINES LABEL2F.
  1870         10  LABEL2A PIC  X(0001).
  1871     05  LABEL2I PIC  X(0014).
  1872*    -------------------------------
  1873     05  BCERT1L PIC S9(0004) COMP.
  1874     05  BCERT1F PIC  X(0001).
  1875     05  FILLER REDEFINES BCERT1F.
  1876         10  BCERT1A PIC  X(0001).
  1877     05  BCERT1I PIC  X(0010).
  1878*    -------------------------------
  1879     05  BSUFX1L PIC S9(0004) COMP.
  1880     05  BSUFX1F PIC  X(0001).
  1881     05  FILLER REDEFINES BSUFX1F.
  1882         10  BSUFX1A PIC  X(0001).
  1883     05  BSUFX1I PIC  X(0001).
  1884*    -------------------------------
  1885     05  BCERT2L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  38
* EL131.cbl
  1886     05  BCERT2F PIC  X(0001).
  1887     05  FILLER REDEFINES BCERT2F.
  1888         10  BCERT2A PIC  X(0001).
  1889     05  BCERT2I PIC  X(0010).
  1890*    -------------------------------
  1891     05  BSUFX2L PIC S9(0004) COMP.
  1892     05  BSUFX2F PIC  X(0001).
  1893     05  FILLER REDEFINES BSUFX2F.
  1894         10  BSUFX2A PIC  X(0001).
  1895     05  BSUFX2I PIC  X(0001).
  1896*    -------------------------------
  1897     05  BCERT3L PIC S9(0004) COMP.
  1898     05  BCERT3F PIC  X(0001).
  1899     05  FILLER REDEFINES BCERT3F.
  1900         10  BCERT3A PIC  X(0001).
  1901     05  BCERT3I PIC  X(0010).
  1902*    -------------------------------
  1903     05  BSUFX3L PIC S9(0004) COMP.
  1904     05  BSUFX3F PIC  X(0001).
  1905     05  FILLER REDEFINES BSUFX3F.
  1906         10  BSUFX3A PIC  X(0001).
  1907     05  BSUFX3I PIC  X(0001).
  1908*    -------------------------------
  1909     05  BCERT4L PIC S9(0004) COMP.
  1910     05  BCERT4F PIC  X(0001).
  1911     05  FILLER REDEFINES BCERT4F.
  1912         10  BCERT4A PIC  X(0001).
  1913     05  BCERT4I PIC  X(0010).
  1914*    -------------------------------
  1915     05  BSUFX4L PIC S9(0004) COMP.
  1916     05  BSUFX4F PIC  X(0001).
  1917     05  FILLER REDEFINES BSUFX4F.
  1918         10  BSUFX4A PIC  X(0001).
  1919     05  BSUFX4I PIC  X(0001).
  1920*    -------------------------------
  1921     05  BCERT5L PIC S9(0004) COMP.
  1922     05  BCERT5F PIC  X(0001).
  1923     05  FILLER REDEFINES BCERT5F.
  1924         10  BCERT5A PIC  X(0001).
  1925     05  BCERT5I PIC  X(0010).
  1926*    -------------------------------
  1927     05  BSUFX5L PIC S9(0004) COMP.
  1928     05  BSUFX5F PIC  X(0001).
  1929     05  FILLER REDEFINES BSUFX5F.
  1930         10  BSUFX5A PIC  X(0001).
  1931     05  BSUFX5I PIC  X(0001).
  1932*    -------------------------------
  1933     05  MSG1L PIC S9(0004) COMP.
  1934     05  MSG1F PIC  X(0001).
  1935     05  FILLER REDEFINES MSG1F.
  1936         10  MSG1A PIC  X(0001).
  1937     05  MSG1I PIC  X(0072).
  1938*    -------------------------------
  1939     05  MSG2L PIC S9(0004) COMP.
  1940     05  MSG2F PIC  X(0001).
  1941     05  FILLER REDEFINES MSG2F.
  1942         10  MSG2A PIC  X(0001).
  1943     05  MSG2I PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  39
* EL131.cbl
  1944*    -------------------------------
  1945     05  PFKEYL PIC S9(0004) COMP.
  1946     05  PFKEYF PIC  X(0001).
  1947     05  FILLER REDEFINES PFKEYF.
  1948         10  PFKEYA PIC  X(0001).
  1949     05  PFKEYI PIC  99.
  1950*    -------------------------------
  1951     05  PFKEY6L PIC S9(0004) COMP.
  1952     05  PFKEY6F PIC  X(0001).
  1953     05  FILLER REDEFINES PFKEY6F.
  1954         10  PFKEY6A PIC  X(0001).
  1955     05  PFKEY6I PIC  X(0016).
  1956 01  EL131AO REDEFINES EL131AI.
  1957     05  FILLER            PIC  X(0012).
  1958*    -------------------------------
  1959     05  FILLER            PIC  X(0003).
  1960     05  DATEO PIC  X(0008).
  1961*    -------------------------------
  1962     05  FILLER            PIC  X(0003).
  1963     05  TIMEO PIC  99.99.
  1964*    -------------------------------
  1965     05  FILLER            PIC  X(0003).
  1966     05  SEQUO PIC  X(0010).
  1967*    -------------------------------
  1968     05  FILLER            PIC  X(0003).
  1969     05  COMPO PIC  X(0003).
  1970*    -------------------------------
  1971     05  FILLER            PIC  X(0003).
  1972     05  USERIDO PIC  X(0004).
  1973*    -------------------------------
  1974     05  FILLER            PIC  X(0003).
  1975     05  CCNOO PIC  X(0016).
  1976*    -------------------------------
  1977     05  FILLER            PIC  X(0003).
  1978     05  MAINTO PIC  X(0001).
  1979*    -------------------------------
  1980     05  FILLER            PIC  X(0003).
  1981     05  CLAIMO PIC  X(0007).
  1982*    -------------------------------
  1983     05  FILLER            PIC  X(0003).
  1984     05  CARRO PIC  X(0001).
  1985*    -------------------------------
  1986     05  FILLER            PIC  X(0003).
  1987     05  CERTO PIC  X(0010).
  1988*    -------------------------------
  1989     05  FILLER            PIC  X(0003).
  1990     05  SUFXO PIC  X(0001).
  1991*    -------------------------------
  1992     05  FILLER            PIC  X(0003).
  1993     05  TYPEO PIC  X(0001).
  1994*    -------------------------------
  1995     05  FILLER            PIC  X(0003).
  1996     05  LABEL1O PIC  X(0011).
  1997*    -------------------------------
  1998     05  FILLER            PIC  X(0003).
  1999     05  PCERTNOO PIC  X(0010).
  2000*    -------------------------------
  2001     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  40
* EL131.cbl
  2002     05  PSUFXO PIC  X(0001).
  2003*    -------------------------------
  2004     05  FILLER            PIC  X(0003).
  2005     05  STATUSO PIC  X(0006).
  2006*    -------------------------------
  2007     05  FILLER            PIC  X(0003).
  2008     05  INCO PIC  X(0008).
  2009*    -------------------------------
  2010     05  FILLER            PIC  X(0003).
  2011     05  REPO PIC  X(0008).
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  CAUSEO PIC  X(0006).
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  ENDO PIC  X(0008).
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  DIAGO PIC  X(0060).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  ACCSWO PIC  X(0001).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  BENEO PIC  X(0010).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  BIRTHO PIC  X(0008).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  SOCIALO PIC  X(0011).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  SEXO PIC  X(0001).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  MLNAMEO PIC  X(0015).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  MFNAMEO PIC  X(0012).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  MMINITO PIC  X(0001).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  LOANNOO PIC  X(0008).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  CRTLNMEO PIC  X(0015).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  CRTFNMEO PIC  X(0012).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  CRTINITO PIC  X(0001).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  LOANBALO PIC  ZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  41
* EL131.cbl
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  PROCO PIC  X(0004).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  SUPVO PIC  X(0001).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  PRICDO PIC  X(0001).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  CRITPO PIC  X(0002).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  CRITPTO PIC  X(0001).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  RTWMOSO PIC  X(0002).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  FILETOO PIC  X(0004).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  PTHRHDGO PIC  X(0010).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  PDTHRUO PIC  X(0008).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  PDAMTO PIC  Z(06).99.
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  NODAYSO PIC  ZZZ99.
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  NOPMTSO PIC  ZZ99.
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  FORMTYPO PIC  X(0001).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  ESTO PIC  X(0008).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  AUIDO PIC  X(0004).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  OCCO PIC  X(0006).
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  MNTDTO PIC  X(0008).
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  MNTTYPEO PIC  X(0006).
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  CERTCARO PIC  X(0001).
  2117*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  42
* EL131.cbl
  2118     05  FILLER            PIC  X(0003).
  2119     05  CERTGRPO PIC  X(0006).
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  CERTSTO PIC  X(0002).
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  CERTACTO PIC  X(0010).
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  CERTEFFO PIC  X(0008).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  ISSAGEO PIC  X(0002).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  APRO PIC  9(3).9(4).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  PMTFREQO PIC  99.
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  INDGRPO PIC  X(0001).
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  PREMTYPO PIC  X(0001).
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  REINCDO PIC  X(0001).
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  JNTLNMEO PIC  X(0015).
  2150*    -------------------------------
  2151     05  FILLER            PIC  X(0003).
  2152     05  JNTFNMEO PIC  X(0012).
  2153*    -------------------------------
  2154     05  FILLER            PIC  X(0003).
  2155     05  JNTINITO PIC  X(0001).
  2156*    -------------------------------
  2157     05  FILLER            PIC  X(0003).
  2158     05  JNTAGEO PIC  X(0002).
  2159*    -------------------------------
  2160     05  FILLER            PIC  X(0003).
  2161     05  ADDONDTO PIC  X(0008).
  2162*    -------------------------------
  2163     05  FILLER            PIC  X(0003).
  2164     05  LCVDSCRO PIC  X(0006).
  2165*    -------------------------------
  2166     05  FILLER            PIC  X(0003).
  2167     05  LCVKINDO PIC  X(0003).
  2168*    -------------------------------
  2169     05  FILLER            PIC  X(0003).
  2170     05  LCVCDO PIC  X(0002).
  2171*    -------------------------------
  2172     05  FILLER            PIC  X(0003).
  2173     05  LCVOTRMO PIC  999.
  2174*    -------------------------------
  2175     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  43
* EL131.cbl
  2176     05  LCVRTRMO PIC  999.
  2177*    -------------------------------
  2178     05  FILLER            PIC  X(0003).
  2179     05  LCVRATEO PIC  ZZZ.ZZ.
  2180*    -------------------------------
  2181     05  FILLER            PIC  X(0003).
  2182     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2183*    -------------------------------
  2184     05  FILLER            PIC  X(0003).
  2185     05  LCVFORMO PIC  X(0012).
  2186*    -------------------------------
  2187     05  FILLER            PIC  X(0003).
  2188     05  LCVCNDTO PIC  X(0008).
  2189*    -------------------------------
  2190     05  FILLER            PIC  X(0003).
  2191     05  LCVEXITO PIC  X(0008).
  2192*    -------------------------------
  2193     05  FILLER            PIC  X(0003).
  2194     05  LCVSTATO PIC  X(0006).
  2195*    -------------------------------
  2196     05  FILLER            PIC  X(0003).
  2197     05  ACVDSCRO PIC  X(0006).
  2198*    -------------------------------
  2199     05  FILLER            PIC  X(0003).
  2200     05  ACVKINDO PIC  X(0003).
  2201*    -------------------------------
  2202     05  FILLER            PIC  X(0003).
  2203     05  ACVCDO PIC  X(0002).
  2204*    -------------------------------
  2205     05  FILLER            PIC  X(0003).
  2206     05  ACVOTRMO PIC  999.
  2207*    -------------------------------
  2208     05  FILLER            PIC  X(0003).
  2209     05  ACVRTRMO PIC  999.
  2210*    -------------------------------
  2211     05  FILLER            PIC  X(0003).
  2212     05  ACVRATEO PIC  ZZZ.ZZ.
  2213*    -------------------------------
  2214     05  FILLER            PIC  X(0003).
  2215     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2216*    -------------------------------
  2217     05  FILLER            PIC  X(0003).
  2218     05  ACVFORMO PIC  X(0012).
  2219*    -------------------------------
  2220     05  FILLER            PIC  X(0003).
  2221     05  ACVCNDTO PIC  X(0008).
  2222*    -------------------------------
  2223     05  FILLER            PIC  X(0003).
  2224     05  ACVEXITO PIC  X(0008).
  2225*    -------------------------------
  2226     05  FILLER            PIC  X(0003).
  2227     05  ACVSTATO PIC  X(0006).
  2228*    -------------------------------
  2229     05  FILLER            PIC  X(0003).
  2230     05  LABEL2O PIC  X(0014).
  2231*    -------------------------------
  2232     05  FILLER            PIC  X(0003).
  2233     05  BCERT1O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  44
* EL131.cbl
  2234*    -------------------------------
  2235     05  FILLER            PIC  X(0003).
  2236     05  BSUFX1O PIC  X(0001).
  2237*    -------------------------------
  2238     05  FILLER            PIC  X(0003).
  2239     05  BCERT2O PIC  X(0010).
  2240*    -------------------------------
  2241     05  FILLER            PIC  X(0003).
  2242     05  BSUFX2O PIC  X(0001).
  2243*    -------------------------------
  2244     05  FILLER            PIC  X(0003).
  2245     05  BCERT3O PIC  X(0010).
  2246*    -------------------------------
  2247     05  FILLER            PIC  X(0003).
  2248     05  BSUFX3O PIC  X(0001).
  2249*    -------------------------------
  2250     05  FILLER            PIC  X(0003).
  2251     05  BCERT4O PIC  X(0010).
  2252*    -------------------------------
  2253     05  FILLER            PIC  X(0003).
  2254     05  BSUFX4O PIC  X(0001).
  2255*    -------------------------------
  2256     05  FILLER            PIC  X(0003).
  2257     05  BCERT5O PIC  X(0010).
  2258*    -------------------------------
  2259     05  FILLER            PIC  X(0003).
  2260     05  BSUFX5O PIC  X(0001).
  2261*    -------------------------------
  2262     05  FILLER            PIC  X(0003).
  2263     05  MSG1O PIC  X(0072).
  2264*    -------------------------------
  2265     05  FILLER            PIC  X(0003).
  2266     05  MSG2O PIC  X(0072).
  2267*    -------------------------------
  2268     05  FILLER            PIC  X(0003).
  2269     05  PFKEYO PIC  X(0002).
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  PFKEY6O PIC  X(0016).
  2273*    -------------------------------
  2274
  2275*                                COPY ELCEMIB SUPPRESS.
  2276******************************************************************
  2277*                                                                *
  2278*                                                                *
  2279*                            ELCEMIB.                            *
  2280*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2281*                            VMOD=2.005                          *
  2282*                                                                *
  2283*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2284*                                                                *
  2285******************************************************************
  2286 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2287     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2288     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2289     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2290     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2291     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  45
* EL131.cbl
  2292     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2293     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2294     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2295     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2296         88  EMI-NO-ERRORS                    VALUE '1'.
  2297         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2298         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2299     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2300         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2301     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2302         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2303         88  EMI-AREA1-FULL                   VALUE '2'.
  2304     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2305         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2306         88  EMI-AREA2-FULL                   VALUE '2'.
  2307     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2308         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2309         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2310         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2311         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2312         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2313     12  EMI-ERROR-LINES.
  2314         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2315         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2316         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2317         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2318             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2319                 24  EMI-ERR-NUM         PIC X(4).
  2320                 24  EMI-FILLER          PIC X.
  2321                 24  EMI-SEV             PIC X.
  2322                 24  FILLER              PIC X.
  2323             20  FILLER                  PIC X(02).
  2324     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2325         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2326             20  EMI-ERROR-NUMBER    PIC X(4).
  2327             20  EMI-FILL            PIC X.
  2328             20  EMI-SEVERITY        PIC X.
  2329             20  FILLER              PIC X.
  2330             20  EMI-ERROR-TEXT.
  2331                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2332                 24  FILLER          PIC X(55).
  2333     12  EMI-SEVERITY-SAVE           PIC X.
  2334         88  EMI-NOTE                    VALUE 'N'.
  2335         88  EMI-WARNING                 VALUE 'W'.
  2336         88  EMI-FORCABLE                VALUE 'F'.
  2337         88  EMI-FATAL                   VALUE 'X'.
  2338     12  EMI-MESSAGE-FLAG            PIC X.
  2339         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2340         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2341     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2342     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2343         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2344         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2345         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2346     12  emi-claim-no                pic x(7).
  2347     12  emi-claim-type              pic x(6).
  2348     12  FILLER                      PIC X(124)  VALUE SPACES.
  2349     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  46
* EL131.cbl
  2350     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2351     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2352     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2353
  2354*                                COPY ELCJPFX SUPPRESS.
  2355******************************************************************
  2356*                                                                *
  2357*                                                                *
  2358*                            ELCJPFX.                            *
  2359*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2360*                            VMOD=2.002                          *
  2361*                                                                *
  2362*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2363*                                                                *
  2364*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2365*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2366*        ELCNTL - CONTROL FILE                                   *
  2367*        ELMSTR - CLAIM MASTERS                                  *
  2368*        ELTRLR - ACTIVITY TRAILERS                              *
  2369*        ELCHKQ - CHECK QUE                                      *
  2370******************************************************************
  2371 01  JOURNAL-RECORD.
  2372     12  jp-date                     pic s9(5) comp-3.
  2373     12  jp-time                     pic s9(7) comp-3.
  2374     12  JP-USER-ID                  PIC X(4).
  2375     12  JP-FILE-ID                  PIC X(8).
  2376     12  JP-PROGRAM-ID               PIC X(8).
  2377     12  JP-RECORD-TYPE              PIC X.
  2378         88 JP-ADD              VALUE 'A'.
  2379         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2380         88 JP-AFTER-CHANGE     VALUE 'C'.
  2381         88 JP-DELETE           VALUE 'D'.
  2382         88 JP-GENERIC-DELETE   VALUE 'G'.
  2383         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2384         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2385     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2386     12  JP-RECORD-AREA
  2387
  2388
  2389                                 PIC X(750).
  2390
  2391*                                COPY ELCCALC.
  2392******************************************************************
  2393*                                                                *
  2394*                           ELCCALC.                            *
  2395*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2396*                            VMOD=2.025                          *
  2397*                                                                *
  2398*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2399*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2400*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2401*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2402*                                                                *
  2403*  PASSED TO ELRTRM                                              *
  2404*  -----------------                                             *
  2405*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2406*  ORIGINAL TERM                                                 *
  2407*  BEGINNING DATE                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  47
* EL131.cbl
  2408*  ENDING DATE                                                   *
  2409*  COMPANY I.D.                                                  *
  2410*  ACCOUNT MASTER USER FIELD                                     *
  2411*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2412*  FREE LOOK DAYS                                                *
  2413*                                                                *
  2414*  RETURNED FROM ELRTRM                                          *
  2415*  ---------------------                                         *
  2416*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2417*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2418*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2419*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2420*----------------------------------------------------------------*
  2421*  PASSED TO ELRAMT                                              *
  2422*  ----------------                                              *
  2423*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2424*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2425*  ORIGINAL AMOUNT                                               *
  2426*  ALTERNATE BENEFIT (BALLON)                                    *
  2427*  A.P.R. - NET PAY ONLY                                         *
  2428*  METHOD
  2429*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2430*  COMPANY I.D.                                                  *
  2431*  BENEFIT TYPE                                                  *
  2432*                                                                *
  2433*  RETURNED FROM ELRAMT                                          *
  2434*  --------------------                                          *
  2435*  REMAINING AMOUNT 1 - CURRENT                                  *
  2436*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2437*  REMAINING AMOUNT FACTOR
  2438*----------------------------------------------------------------*
  2439*  PASSED TO ELRESV                                              *
  2440*  -----------------                                             *
  2441*  CERTIFICATE EFFECTIVE DATE                                    *
  2442*  VALUATION DATE                                                *
  2443*  PAID THRU DATE                                                *
  2444*  BENEFIT                                                       *
  2445*  INCURRED DATE                                                 *
  2446*  REPORTED DATE                                                 *
  2447*  ISSUE AGE                                                     *
  2448*  TERM                                                          *
  2449*  CDT PERCENT                                                   *
  2450*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2451* *CLAIM TYPE (LIFE, A/H)                                        *
  2452* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2453* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2454*                                                                *
  2455*  RETURNED FROM ELRESV                                          *
  2456*  --------------------                                          *
  2457*  CDT TABLE USED                                                *
  2458*  CDT FACTOR USED                                               *
  2459*  PAY TO CURRENT RESERVE                                        *
  2460*  I.B.N.R. - A/H ONLY                                           *
  2461*  FUTURE (ACCRUED) AH ONLY                                      *
  2462*----------------------------------------------------------------*
  2463*  PASSED TO ELRATE                                              *
  2464*  ----------------                                              *
  2465*  CERT ISSUE DATE                                               *
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  48
* EL131.cbl
  2466*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2467*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2468*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2469*  STATE CODE (CLIENT DEFINED)                                   *
  2470*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2471*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2472*  DEVIATION CODE                                                *
  2473*  ISSUE AGE                                                     *
  2474*  ORIGINAL BENEFIT AMOUNT                                       *
  2475*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2476*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2477*  BENEFIT KIND (LIFE OR A/H)                                    *
  2478*  A.P.R.                                                        *
  2479*  METHOD
  2480*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2481*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2482*  COMPANY I.D. (3 CHARACTER)                                    *
  2483*  BENEFIT CODE                                                  *
  2484*  BENEFIT OVERRIDE CODE                                         *
  2485*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2486*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2487*  JOINT INDICATOR (CSL ONLY)                                    *
  2488*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2489*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2490*                                                                *
  2491*  RETURNED FROM ELRATE                                          *
  2492*  --------------------                                          *
  2493*  CALCULATED PREMIUM                                            *
  2494*  PREMIUM RATE                                                  *
  2495*  MORTALITY CODE                                                *
  2496*  MAX ATTAINED AGE                                              *
  2497*  MAX AGE                                                       *
  2498*  MAX TERM                                                      *
  2499*  MAX MONTHLY BENEFIT                                           *
  2500*  MAX TOTAL BENIFIT                                             *
  2501*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2502*----------------------------------------------------------------*
  2503*  PASSED TO ELRFND                                              *
  2504*  ----------------                                              *
  2505*  CERT ISSUE DATE                                               *
  2506*  REFUND DATE                                                   *
  2507*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2508*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2509*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2510*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2511*  STATE CODE (CLIENT DEFINED)                                   *
  2512*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2513*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2514*  DEVIATION CODE                                                *
  2515*  ISSUE AGE                                                     *
  2516*  ORIGINAL BENEFIT AMOUNT                                       *
  2517*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2518*  PROCESS TYPE (CANCEL)                                         *
  2519*  BENEFIT KIND (LIFE OR A/H)                                    *
  2520*  A.P.R.                                                        *
  2521*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2522*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2523*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  49
* EL131.cbl
  2524*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2525*  COMPANY I.D. (3 CHARACTER)                                    *
  2526*  BENEFIT CODE                                                  *
  2527*  BENEFIT OVERRIDE CODE                                         *
  2528*                                                                *
  2529*  RETURNED FROM ELRFND                                          *
  2530*  --------------------                                          *
  2531*  CALCULATED REFUND                                             *
  2532*----------------------------------------------------------------*
  2533*  PASSED TO ELEARN                                              *
  2534*  ----------------                                              *
  2535*  CERT ISSUE DATE                                               *
  2536*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2537*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2538*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2539*  STATE CODE (CLIENT DEFINED)                                   *
  2540*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2541*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2542*  DEVIATION CODE                                                *
  2543*  ISSUE AGE                                                     *
  2544*  ORIGINAL BENEFIT AMOUNT                                       *
  2545*  BENEFIT KIND (LIFE OR A/H)                                    *
  2546*  A.P.R.                                                        *
  2547*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2548*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2549*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2550*  COMPANY I.D. (3 CHARACTER)                                    *
  2551*  BENEFIT CODE                                                  *
  2552*  BENEFIT OVERRIDE CODE                                         *
  2553*                                                                *
  2554*  RETURNED FROM ELEARN                                          *
  2555*  --------------------                                          *
  2556*  INDICATED  EARNINGS                                           *
  2557*----------------------------------------------------------------*
  2558*                 LENGTH = 450                                   *
  2559*                                                                *
  2560******************************************************************
  2561******************************************************************
  2562*                   C H A N G E   L O G
  2563*
  2564* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2565*-----------------------------------------------------------------
  2566*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2567* EFFECTIVE    NUMBER
  2568*-----------------------------------------------------------------
  2569* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2570* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2571* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2572* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2573* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2574* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2575* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2576* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2577* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2578******************************************************************
  2579
  2580 01  CALCULATION-PASS-AREA.
  2581     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  50
* EL131.cbl
  2582                                     COMP.
  2583
  2584     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2585       88  NO-CP-ERROR                             VALUE ZERO.
  2586       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2587                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2588       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2589       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2590       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2591       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2592       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2593       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2594       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2595       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2596       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2597       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2598       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2599       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2600       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2601       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2602       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2603       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2604       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2605
  2606     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2607       88  NO-CP-ERROR-2                           VALUE ZERO.
  2608***********************  INPUT AREAS ****************************
  2609
  2610     12  CP-CALCULATION-AREA.
  2611         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2612         16  CP-CERT-EFF-DT        PIC XX.
  2613         16  CP-VALUATION-DT       PIC XX.
  2614         16  CP-PAID-THRU-DT       PIC XX.
  2615         16  CP-BENEFIT-TYPE       PIC X.
  2616           88  CP-AH                               VALUE 'A' 'D'
  2617                                                   'I' 'U'.
  2618           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2619           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2620         16  CP-INCURRED-DT        PIC XX.
  2621         16  CP-REPORTED-DT        PIC XX.
  2622         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2623         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2624         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2625                                     COMP-3.
  2626         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2627                                     COMP-3.
  2628         16  CP-CDT-METHOD         PIC X.
  2629           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2630           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2631           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2632         16  CP-CLAIM-TYPE         PIC X.
  2633           88  CP-AH-CLAIM                         VALUE 'A'.
  2634           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2635         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2636                                     COMP-3.
  2637         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2638                                     COMP-3.
  2639         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  51
* EL131.cbl
  2640                                     COMP-3.
  2641         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2642                                     COMP-3.
  2643         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2644                                     COMP-3.
  2645         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2646                                     COMP-3.
  2647         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2648                                     COMP-3.
  2649         16  CP-REM-TERM-METHOD    PIC X.
  2650           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2651           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2652           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2653           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2654           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2655           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2656           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2657         16  CP-EARNING-METHOD     PIC X.
  2658           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2659           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2660           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2661           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2662           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2663           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2664           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2665           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2666           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2667           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2668           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2669           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2670           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2671           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2672         16  CP-PROCESS-TYPE       PIC X.
  2673           88  CP-CLAIM                            VALUE '1'.
  2674           88  CP-CANCEL                           VALUE '2'.
  2675           88  CP-ISSUE                            VALUE '3'.
  2676         16  CP-SPECIAL-CALC-CD    PIC X.
  2677           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2678           88  CP-1-MTH-INTEREST               VALUE ' '.
  2679           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2680           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2681           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2682           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2683           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2684           88  CP-FARM-PLAN                    VALUE 'F'.
  2685           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2686           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2687           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2688           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2689           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2690           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2691           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2692           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2693           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2694           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2695                                                     'W' 'X'.
  2696           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2697           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  52
* EL131.cbl
  2698           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2699           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2700           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2701           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2702           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2703           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2704           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2705           88  CP-CSL-METH-1                   VALUE '5'.
  2706           88  CP-CSL-METH-2                   VALUE '6'.
  2707           88  CP-CSL-METH-3                   VALUE '7'.
  2708           88  CP-CSL-METH-4                   VALUE '8'.
  2709
  2710         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2711                                     COMP-3.
  2712         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2713         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2714         16  CP-STATE              PIC XX          VALUE SPACE.
  2715         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2716         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2717           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2718               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2719         16  CP-R78-OPTION         PIC X.
  2720           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2721           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2722
  2723         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2724         16  CP-IBNR-RESERVE-SW    PIC X.
  2725         16  CP-CLAIM-STATUS       PIC X.
  2726         16  CP-RATE-FILE          PIC X.
  2727         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2728                                     COMP-3.
  2729
  2730         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2731         16  CP-AH-OVERRIDE-CODE   PIC X.
  2732
  2733         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2734                                     COMP-3.
  2735         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2736                                   PIC S9(5)V99 COMP-3.
  2737         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2738                                     COMP-3.
  2739         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2740                                     COMP-3.
  2741         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2742                                     COMP-3.
  2743         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2744                                  PIC S9(7)V99 COMP-3.
  2745
  2746         16  CP-PAID-FROM-DATE     PIC X(02).
  2747         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2748         16  CP-EXT-DAYS-CALC      PIC X.
  2749           88  CP-EXT-NO-CHG                   VALUE ' '.
  2750           88  CP-EXT-CHG-LF                   VALUE '1'.
  2751           88  CP-EXT-CHG-AH                   VALUE '2'.
  2752           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2753         16  CP-DOMICILE-STATE     PIC XX.
  2754         16  CP-CARRIER            PIC X.
  2755         16  CP-REIN-FLAG          PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  53
* EL131.cbl
  2756         16  CP-REM-TRM-CALC-OPTION PIC X.
  2757           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2758                      '2' '3' '4' '5'.
  2759           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2760           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2761           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2762           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2763           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2764           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2765           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2766           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2767         16  CP-SIG-SWITCH         PIC X.
  2768         16  CP-RATING-METHOD      PIC X.
  2769           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2770           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2771           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2772           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2773           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2774           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2775           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2776           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2777           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2778         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2779                                     COMP-3.
  2780         16  CP-BEN-CATEGORY       PIC X.
  2781         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2782         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2783                                   PIC S99V9(5) COMP-3.
  2784         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2785         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2786                                   PIC S99V9(5) COMP-3.
  2787         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2788         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2789         16  CP-EXPIRE-DT          PIC XX.
  2790         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2791         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2792         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2793         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2794         16  CP-DDF-SPEC-CALC      PIC X.
  2795             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2796             88  CP-CALC-CLP              VALUE 'C'.
  2797         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2798         16  CP-CANCEL-REASON      PIC X.
  2799         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2800         16  CP-PMT-MODE           PIC X.
  2801         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2802         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2803         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2804         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2805         16  FILLER                PIC X.
  2806
  2807***************    OUTPUT FROM ELRESV   ************************
  2808
  2809         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2810
  2811         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2812                                     COMP-3.
  2813         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  54
* EL131.cbl
  2814                                     COMP-3.
  2815         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2816                                     COMP-3.
  2817         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2818                                     COMP-3.
  2819         16  FILLER                PIC X(09).
  2820***************    OUTPUT FROM ELRTRM   *************************
  2821
  2822         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2823                                     COMP-3.
  2824         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2825                                     COMP-3.
  2826         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2827                                     COMP-3.
  2828         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2829                                     COMP-3.
  2830         16  FILLER                PIC X(12).
  2831
  2832***************    OUTPUT FROM ELRAMT   *************************
  2833
  2834         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2835                                     COMP-3.
  2836         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2837                                     COMP-3.
  2838         16  FILLER                PIC X(12).
  2839
  2840***************    OUTPUT FROM ELRATE   *************************
  2841
  2842         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2843                                     COMP-3.
  2844         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2845                                     COMP-3.
  2846         16  CP-MORTALITY-CODE     PIC X(4).
  2847         16  CP-RATE-EDIT-FLAG     PIC X.
  2848             88  CP-RATES-NEED-APR                  VALUE '1'.
  2849         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2850                                     COMP-3.
  2851         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2852         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2853         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2854                                   PIC S9(7)V99 COMP-3.
  2855         16  FILLER                PIC X(07).
  2856
  2857***************    OUTPUT FROM ELRFND   *************************
  2858
  2859         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2860                                     COMP-3.
  2861         16  CP-REFUND-TYPE-USED   PIC X.
  2862           88  CP-R-AS-R78                         VALUE '1'.
  2863           88  CP-R-AS-PRORATA                     VALUE '2'.
  2864           88  CP-R-AS-CALIF                       VALUE '3'.
  2865           88  CP-R-AS-TEXAS                       VALUE '4'.
  2866           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2867           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2868           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2869           88  CP-R-AS-MEAN                        VALUE '8'.
  2870           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2871           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  55
* EL131.cbl
  2872           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2873           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2874           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2875           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2876         16  FILLER                PIC X(12).
  2877
  2878***************    OUTPUT FROM ELEARN   *************************
  2879
  2880         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2881                                     COMP-3.
  2882         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2883                                     COMP-3.
  2884         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2885                                     COMP-3.
  2886         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2887                                     COMP-3.
  2888         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2889                                     COMP-3.
  2890         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2891                                     COMP-3.
  2892         16  CP-EARNING-TYPE-USED  PIC X.
  2893           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2894           88  CP-E-AS-R78                         VALUE '1'.
  2895           88  CP-E-AS-PRORATA                     VALUE '2'.
  2896           88  CP-E-AS-TEXAS                       VALUE '4'.
  2897           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2898           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2899           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2900           88  CP-E-AS-MEAN                        VALUE '8'.
  2901           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2902         16  FILLER                PIC X(12).
  2903
  2904***************    OUTPUT FROM ELPMNT   *************************
  2905
  2906         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2907                                     COMP-3.
  2908         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2909                                     COMP-3.
  2910         16  FILLER                PIC X(12).
  2911
  2912***************   MISC WORK AREAS    *****************************
  2913         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2914                                     COMP-3.
  2915         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2916                                     COMP-3.
  2917         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2918                                     COMP-3.
  2919         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2920                                     COMP-3.
  2921         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2922                                     COMP-3.
  2923         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2924                                     COMP-3.
  2925         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2926             88  OPEN-RATE-FILE                   VALUE 'O'.
  2927             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2928             88  IO-ERROR                         VALUE 'E'.
  2929
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  56
* EL131.cbl
  2930         16  CP-FIRST-PAY-DATE     PIC XX.
  2931
  2932         16  CP-JOINT-INDICATOR    PIC X.
  2933
  2934         16  CP-RESERVE-REMAINING-TERM
  2935                                   PIC S9(4)V9    VALUE ZERO
  2936                                     COMP-3.
  2937
  2938         16  CP-INSURED-BIRTH-DT   PIC XX.
  2939
  2940         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2941                                     COMP-3.
  2942
  2943         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2944                                     COMP-3.
  2945
  2946         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2947                                     COMP-3.
  2948
  2949         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2950                                     COMP-3.
  2951
  2952         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2953                                     COMP-3.
  2954
  2955         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2956                                     COMP-3.
  2957
  2958         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2959                                     COMP-3.
  2960
  2961         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2962             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2963
  2964         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2965                                     COMP-3.
  2966         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2967                                     COMP-3.
  2968         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2969         16  FILLER                PIC X(15).
  2970******************************************************************
  2971
  2972*                                COPY ELCDATE.
  2973******************************************************************
  2974*                                                                *
  2975*                                                                *
  2976*                            ELCDATE.                            *
  2977*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2978*                            VMOD=2.003
  2979*                                                                *
  2980*                                                                *
  2981*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2982*                 LENGTH = 200                                   *
  2983******************************************************************
  2984
  2985 01  DATE-CONVERSION-DATA.
  2986     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2987     12  DC-OPTION-CODE                PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  57
* EL131.cbl
  2988         88  BIN-TO-GREG                VALUE ' '.
  2989         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2990         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2991         88  YMD-GREG-TO-BIN            VALUE '3'.
  2992         88  MDY-GREG-TO-BIN            VALUE '4'.
  2993         88  JULIAN-TO-BIN              VALUE '5'.
  2994         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2995         88  FIND-CENTURY               VALUE '7'.
  2996         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2997         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2998         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2999         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3000         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3001         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3002         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3003         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3004         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3005         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3006         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3007         88  BIN-3-TO-GREG              VALUE 'I'.
  3008         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3009         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3010         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3011         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3012         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3013         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3014         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3015         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3016         88  THREE-CHARACTER-BIN
  3017                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3018         88  GREGORIAN-TO-BIN
  3019                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3020         88  BIN-TO-GREGORIAN
  3021                  VALUES ' ' '1' 'I' '8' 'G'.
  3022         88  JULIAN-TO-BINARY
  3023                  VALUES '5' 'C' 'E' 'F'.
  3024     12  DC-ERROR-CODE                 PIC X.
  3025         88  NO-CONVERSION-ERROR        VALUE ' '.
  3026         88  DATE-CONVERSION-ERROR
  3027                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3028         88  DATE-IS-ZERO               VALUE '1'.
  3029         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3030         88  DATE-IS-INVALID            VALUE '3'.
  3031         88  DATE1-GREATER-DATE2        VALUE '4'.
  3032         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3033         88  DATE-INVALID-OPTION        VALUE '9'.
  3034         88  INVALID-CENTURY            VALUE 'A'.
  3035         88  ONLY-CENTURY               VALUE 'B'.
  3036         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3037         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3038     12  DC-END-OF-MONTH               PIC X.
  3039         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3040     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3041         88  USE-NORMAL-PROCESS         VALUE ' '.
  3042         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3043         88  ADJUST-UP-100-YRS          VALUE '2'.
  3044     12  FILLER                        PIC X.
  3045     12  DC-CONVERSION-DATES.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  58
* EL131.cbl
  3046         16  DC-BIN-DATE-1             PIC XX.
  3047         16  DC-BIN-DATE-2             PIC XX.
  3048         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3049         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3050                       DC-GREG-DATE-1-EDIT.
  3051             20  DC-EDIT1-MONTH        PIC 99.
  3052             20  SLASH1-1              PIC X.
  3053             20  DC-EDIT1-DAY          PIC 99.
  3054             20  SLASH1-2              PIC X.
  3055             20  DC-EDIT1-YEAR         PIC 99.
  3056         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3057         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3058                     DC-GREG-DATE-2-EDIT.
  3059             20  DC-EDIT2-MONTH        PIC 99.
  3060             20  SLASH2-1              PIC X.
  3061             20  DC-EDIT2-DAY          PIC 99.
  3062             20  SLASH2-2              PIC X.
  3063             20  DC-EDIT2-YEAR         PIC 99.
  3064         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3065         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3066                     DC-GREG-DATE-1-YMD.
  3067             20  DC-YMD-YEAR           PIC 99.
  3068             20  DC-YMD-MONTH          PIC 99.
  3069             20  DC-YMD-DAY            PIC 99.
  3070         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3071         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3072                      DC-GREG-DATE-1-MDY.
  3073             20  DC-MDY-MONTH          PIC 99.
  3074             20  DC-MDY-DAY            PIC 99.
  3075             20  DC-MDY-YEAR           PIC 99.
  3076         16  DC-GREG-DATE-1-ALPHA.
  3077             20  DC-ALPHA-MONTH        PIC X(10).
  3078             20  DC-ALPHA-DAY          PIC 99.
  3079             20  FILLER                PIC XX.
  3080             20  DC-ALPHA-CENTURY.
  3081                 24 DC-ALPHA-CEN-N     PIC 99.
  3082             20  DC-ALPHA-YEAR         PIC 99.
  3083         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3084         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3085         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3086         16  DC-JULIAN-DATE            PIC 9(05).
  3087         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3088                                       PIC 9(05).
  3089         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3090             20  DC-JULIAN-YEAR        PIC 99.
  3091             20  DC-JULIAN-DAYS        PIC 999.
  3092         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3093         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3094         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3095     12  DATE-CONVERSION-VARIBLES.
  3096         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3097         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3098             20  FILLER                PIC 9(3).
  3099             20  HOLD-CEN-1-CCYY.
  3100                 24  HOLD-CEN-1-CC     PIC 99.
  3101                 24  HOLD-CEN-1-YY     PIC 99.
  3102             20  HOLD-CEN-1-MO         PIC 99.
  3103             20  HOLD-CEN-1-DA         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  59
* EL131.cbl
  3104         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3105             20  HOLD-CEN-1-R-MO       PIC 99.
  3106             20  HOLD-CEN-1-R-DA       PIC 99.
  3107             20  HOLD-CEN-1-R-CCYY.
  3108                 24  HOLD-CEN-1-R-CC   PIC 99.
  3109                 24  HOLD-CEN-1-R-YY   PIC 99.
  3110             20  FILLER                PIC 9(3).
  3111         16  HOLD-CENTURY-1-X.
  3112             20  FILLER                PIC X(3)  VALUE SPACES.
  3113             20  HOLD-CEN-1-X-CCYY.
  3114                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3115                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3116             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3117             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3118         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3119             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3120             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3121             20  HOLD-CEN-1-R-X-CCYY.
  3122                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3123                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3124             20  FILLER                PIC XXX.
  3125         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3126         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3127         16  DC-JULIAN-DATE-1          PIC 9(07).
  3128         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3129             20  DC-JULIAN-1-CCYY.
  3130                 24  DC-JULIAN-1-CC    PIC 99.
  3131                 24  DC-JULIAN-1-YR    PIC 99.
  3132             20  DC-JULIAN-DA-1        PIC 999.
  3133         16  DC-JULIAN-DATE-2          PIC 9(07).
  3134         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3135             20  DC-JULIAN-2-CCYY.
  3136                 24  DC-JULIAN-2-CC    PIC 99.
  3137                 24  DC-JULIAN-2-YR    PIC 99.
  3138             20  DC-JULIAN-DA-2        PIC 999.
  3139         16  DC-GREG-DATE-A-EDIT.
  3140             20  DC-EDITA-MONTH        PIC 99.
  3141             20  SLASHA-1              PIC X VALUE '/'.
  3142             20  DC-EDITA-DAY          PIC 99.
  3143             20  SLASHA-2              PIC X VALUE '/'.
  3144             20  DC-EDITA-CCYY.
  3145                 24  DC-EDITA-CENT     PIC 99.
  3146                 24  DC-EDITA-YEAR     PIC 99.
  3147         16  DC-GREG-DATE-B-EDIT.
  3148             20  DC-EDITB-MONTH        PIC 99.
  3149             20  SLASHB-1              PIC X VALUE '/'.
  3150             20  DC-EDITB-DAY          PIC 99.
  3151             20  SLASHB-2              PIC X VALUE '/'.
  3152             20  DC-EDITB-CCYY.
  3153                 24  DC-EDITB-CENT     PIC 99.
  3154                 24  DC-EDITB-YEAR     PIC 99.
  3155         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3156         16  DC-GREG-DATE-CYMD-R REDEFINES
  3157                              DC-GREG-DATE-CYMD.
  3158             20  DC-CYMD-CEN           PIC 99.
  3159             20  DC-CYMD-YEAR          PIC 99.
  3160             20  DC-CYMD-MONTH         PIC 99.
  3161             20  DC-CYMD-DAY           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  60
* EL131.cbl
  3162         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3163         16  DC-GREG-DATE-MDCY-R REDEFINES
  3164                              DC-GREG-DATE-MDCY.
  3165             20  DC-MDCY-MONTH         PIC 99.
  3166             20  DC-MDCY-DAY           PIC 99.
  3167             20  DC-MDCY-CEN           PIC 99.
  3168             20  DC-MDCY-YEAR          PIC 99.
  3169    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3170        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3171    12  DC-EL310-DATE                  PIC X(21).
  3172    12  FILLER                         PIC X(28).
  3173
  3174*                                COPY ELCDMO.
  3175******************************************************************
  3176*                                                                *
  3177*                                                                *
  3178*                            ELCDMO.                             *
  3179*                            VMOD=2.004                          *
  3180*                                                                *
  3181*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3182*        COMMUNICATION AREA                                      *
  3183*   FILE TYPE = NA                                               *
  3184*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3185*                                                                *
  3186******************************************************************
  3187 01  DMO-COMMUNICATION-AREA.
  3188     12  DM-RECORD-TYPE                  PIC  X(02).
  3189             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3190             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3191             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3192     12  DM-DIST-CODE                    PIC  X(04).
  3193     12  DM-MAIL-CODE                    PIC  X(05).
  3194     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3195     12  DM-INSURED-NAME                 PIC  X(30).
  3196     12  DM-CLAIM-NO                     PIC  X(07).
  3197     12  DM-CLAIM-TYPE                   PIC  X.
  3198
  3199     12  DM-STATUS-DATA-AREA.
  3200         16  DM-CLAIM-STATUS             PIC  X.
  3201             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3202             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3203             88  DM-CLOSED                        VALUE '3'.
  3204             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3205             88  DM-DEFAULT                       VALUE '9'.
  3206         16  DM-STATUS-DATE              PIC  X(08).
  3207******YYYYMMDD
  3208         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3209             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3210             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3211             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3212             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3213             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3214             88  DM-RE-OPENED                     VALUE 'R'.
  3215             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3216             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3217             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3218         16  DM-STAT-CARRIER             PIC X.
  3219
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  61
* EL131.cbl
  3220     12  DM-DRAFT-DATA-AREA.
  3221         16  DM-PAYMENT-TYPE             PIC  X.
  3222             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3223         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3224         16  DM-PAYMENT-DATE             PIC  X(08).
  3225******YYYYMMDD
  3226         16  DM-CERT-NO                  PIC  X(11).
  3227         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3228         16  DM-CARRIER                  PIC  X.
  3229
  3230     12  DM-RETURN-CODE                  PIC  XX.
  3231*                                COPY ERCPDEF.
  3232******************************************************************
  3233*                                                                *
  3234*                                                                *
  3235*                            ERCPDEF.                            *
  3236*                                                                *
  3237*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3238*                                                                *
  3239*    FILE TYPE = VSAM,KSDS                                       *
  3240*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3241*                                                                *
  3242*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3243*                                                                *
  3244*    LOG = YES                                                   *
  3245*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3246******************************************************************
  3247 01  PRODUCT-MASTER.
  3248    12  PD-RECORD-ID                 PIC X(02).
  3249        88  VALID-PD-ID                  VALUE 'PD'.
  3250    12  PD-CONTROL-PRIMARY.
  3251        16  PD-COMPANY-CD            PIC X.
  3252        16  PD-STATE                 PIC XX.
  3253        16  PD-PRODUCT-CD            PIC XXX.
  3254        16  PD-FILLER                PIC X(7).
  3255        16  PD-BEN-TYPE              PIC X.
  3256        16  PD-BEN-CODE              PIC XX.
  3257        16  PD-PROD-EXP-DT           PIC XX.
  3258    12  FILLER                       PIC X(50).
  3259    12  PD-PRODUCT-DATA OCCURS 8.
  3260        16  PD-PROD-CODE             PIC X.
  3261            88  PD-PROD-LIFE           VALUE 'L'.
  3262            88  PD-PROD-PROP           VALUE 'P'.
  3263            88  PD-PROD-AH             VALUE 'A'.
  3264            88  PD-PROD-IU             VALUE 'I'.
  3265            88  PD-PROD-GAP            VALUE 'G'.
  3266        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3267        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3268        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3269        16  PD-MAX-TERM              PIC S999        COMP-3.
  3270        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3271        16  FILLER                   PIC X.
  3272        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3273        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3274        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3275        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3276        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3277        16  PD-REC-CRIT-PERIOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  62
* EL131.cbl
  3278        16  PD-RTW-MOS               PIC 99.
  3279        16  FILLER                   PIC X(5).
  3280    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3281    12  PD-TERM-LIMITS OCCURS 15.
  3282        16  PD-LOW-TERM              PIC S999        COMP-3.
  3283        16  PD-HI-TERM               PIC S999        COMP-3.
  3284*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3285    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3286        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3287        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3288    12  PD-EARN-FACTORS.
  3289        16  FILLER OCCURS 15.
  3290            20  FILLER OCCURS 15.
  3291                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3292    12  PD-PRODUCT-DESC              PIC X(80).
  3293    12  PD-TRUNCATED                 PIC X.
  3294    12  FILLER                       PIC X(59).
  3295    12  PD-MAINT-INFORMATION.
  3296        16  PD-LAST-MAINT-DT         PIC X(02).
  3297        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3298        16  PD-LAST-MAINT-BY         PIC X(04).
  3299*                                COPY ELCCRTT.
  3300******************************************************************
  3301*                                                                *
  3302*                            ELCCRTT.                            *
  3303*                                                                *
  3304*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3305*                                                                *
  3306*   FILE TYPE = VSAM,KSDS                                        *
  3307*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3308*                                                                *
  3309*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3310*                                                                *
  3311*   LOG = YES                                                    *
  3312*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3313******************************************************************
  3314*                   C H A N G E   L O G
  3315*
  3316* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3317*-----------------------------------------------------------------
  3318*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3319* EFFECTIVE    NUMBER
  3320*-----------------------------------------------------------------
  3321* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3322* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3323* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3324* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3325* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3326******************************************************************
  3327
  3328 01  CERTIFICATE-TRAILERS.
  3329     12  CS-RECORD-ID                      PIC XX.
  3330         88  VALID-CS-ID                      VALUE 'CS'.
  3331
  3332     12  CS-CONTROL-PRIMARY.
  3333         16  CS-COMPANY-CD                 PIC X.
  3334         16  CS-CARRIER                    PIC X.
  3335         16  CS-GROUPING                   PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  63
* EL131.cbl
  3336         16  CS-STATE                      PIC XX.
  3337         16  CS-ACCOUNT                    PIC X(10).
  3338         16  CS-CERT-EFF-DT                PIC XX.
  3339         16  CS-CERT-NO.
  3340             20  CS-CERT-PRIME             PIC X(10).
  3341             20  CS-CERT-SFX               PIC X.
  3342         16  CS-TRAILER-TYPE               PIC X.
  3343             88  COMM-TRLR           VALUE 'A'.
  3344             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3345             88  CERT-DATA-TRLR      VALUE 'C'.
  3346
  3347     12  CS-DATA-AREA                      PIC X(516).
  3348
  3349     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3350         16  CS-BANK-COMMISSION-AREA.
  3351             20  CS-BANK-COMMS       OCCURS 10.
  3352                 24  CS-AGT                PIC X(10).
  3353                 24  CS-COM-TYP            PIC X.
  3354                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3355                 24  CS-RECALC-LV-INDIC    PIC X.
  3356                 24  FILLER                PIC X(10).
  3357         16  FILLER                        PIC X(256).
  3358
  3359     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3360****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3361****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  3362         16  CS-MB-CLAIM-DATA OCCURS 2.
  3363             20  FILLER OCCURS 10.
  3364                 24  CS-CLAIM-TYPE         PIC X.
  3365                     88  CS-AH-CLM           VALUE 'A'.
  3366                     88  CS-IU-CLM           VALUE 'I'.
  3367                     88  CS-GP-CLM           VALUE 'G'.
  3368                     88  CS-LF-CLM           VALUE 'L'.
  3369                     88  CS-PR-CLM           VALUE 'P'.
  3370                 24  CS-BANK               PIC S999 COMP-3.
  3371                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  3372                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  3373                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  3374         16  FILLER                        PIC X(216).
  3375     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3376         16  CS-VIN-NUMBER                 PIC X(17).
  3377         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3378         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3379         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3380         16  FILLER                        PIC X(496).
  3381******************************************************************
  3382
  3383****************************************************************
  3384*
  3385* Copyright (c) 2007 by Clerity Solutions, Inc.
  3386* All rights reserved.
  3387*
  3388****************************************************************
  3389 01  DFHEIV.
  3390   02  DFHEIV0               PIC X(35).
  3391   02  DFHEIV1               PIC X(08).
  3392   02  DFHEIV2               PIC X(08).
  3393   02  DFHEIV3               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  64
* EL131.cbl
  3394   02  DFHEIV4               PIC X(06).
  3395   02  DFHEIV5               PIC X(04).
  3396   02  DFHEIV6               PIC X(04).
  3397   02  DFHEIV7               PIC X(02).
  3398   02  DFHEIV8               PIC X(02).
  3399   02  DFHEIV9               PIC X(01).
  3400   02  DFHEIV10              PIC S9(7) COMP-3.
  3401   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3402   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3403   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3404   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3405   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3406   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3407   02  DFHEIV17              PIC X(04).
  3408   02  DFHEIV18              PIC X(04).
  3409   02  DFHEIV19              PIC X(04).
  3410   02  DFHEIV20              USAGE IS POINTER.
  3411   02  DFHEIV21              USAGE IS POINTER.
  3412   02  DFHEIV22              USAGE IS POINTER.
  3413   02  DFHEIV23              USAGE IS POINTER.
  3414   02  DFHEIV24              USAGE IS POINTER.
  3415   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3416   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3417   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3418   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3419   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3420   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3421   02  FILLER                PIC X(02).
  3422   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3423   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3424   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3425   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3426   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3427 LINKAGE  SECTION.
  3428*****************************************************************
  3429*                                                               *
  3430* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3431* All rights reserved.                                          *
  3432*                                                               *
  3433*****************************************************************
  3434 01  dfheiblk.
  3435     02  eibtime          pic s9(7) comp-3.
  3436     02  eibdate          pic s9(7) comp-3.
  3437     02  eibtrnid         pic x(4).
  3438     02  eibtaskn         pic s9(7) comp-3.
  3439     02  eibtrmid         pic x(4).
  3440     02  dfheigdi         pic s9(4) comp.
  3441     02  eibcposn         pic s9(4) comp.
  3442     02  eibcalen         pic s9(4) comp.
  3443     02  eibaid           pic x(1).
  3444     02  eibfiller1       pic x(1).
  3445     02  eibfn            pic x(2).
  3446     02  eibfiller2       pic x(2).
  3447     02  eibrcode         pic x(6).
  3448     02  eibfiller3       pic x(2).
  3449     02  eibds            pic x(8).
  3450     02  eibreqid         pic x(8).
  3451     02  eibrsrce         pic x(8).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  65
* EL131.cbl
  3452     02  eibsync          pic x(1).
  3453     02  eibfree          pic x(1).
  3454     02  eibrecv          pic x(1).
  3455     02  eibsend          pic x(1).
  3456     02  eibatt           pic x(1).
  3457     02  eibeoc           pic x(1).
  3458     02  eibfmh           pic x(1).
  3459     02  eibcompl         pic x(1).
  3460     02  eibsig           pic x(1).
  3461     02  eibconf          pic x(1).
  3462     02  eiberr           pic x(1).
  3463     02  eibrldbk         pic x(1).
  3464     02  eiberrcd         pic x(4).
  3465     02  eibsynrb         pic x(1).
  3466     02  eibnodat         pic x(1).
  3467     02  eibfiller5       pic x(2).
  3468     02  eibresp          pic 9(09) comp.
  3469     02  eibresp2         pic 9(09) comp.
  3470     02  dfheigdj         pic s9(4) comp.
  3471     02  dfheigdk         pic s9(4) comp.
  3472 01  DFHCOMMAREA                 PIC X(1024).
  3473
  3474*                                COPY ELCMSTR.
  3475******************************************************************
  3476*                                                                *
  3477*                            ELCMSTR.                            *
  3478*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3479*                            VMOD=2.012                          *
  3480*                                                                *
  3481*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3482*                                                                *
  3483*   FILE TYPE = VSAM,KSDS                                        *
  3484*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3485*                                                                *
  3486*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3487*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3488*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3489*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3490*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3491*                                                 RKP=75,LEN=21  *
  3492*                                                                *
  3493*   **** NOTE ****                                               *
  3494*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3495*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3496*                                                                *
  3497*   LOG = YES                                                    *
  3498*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3499******************************************************************
  3500*                   C H A N G E   L O G
  3501*
  3502* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3503*-----------------------------------------------------------------
  3504*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3505* EFFECTIVE    NUMBER
  3506*-----------------------------------------------------------------
  3507* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3508* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3509* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  66
* EL131.cbl
  3510******************************************************************
  3511 01  CLAIM-MASTER.
  3512     12  CL-RECORD-ID                PIC XX.
  3513         88  VALID-CL-ID         VALUE 'CL'.
  3514
  3515     12  CL-CONTROL-PRIMARY.
  3516         16  CL-COMPANY-CD           PIC X.
  3517         16  CL-CARRIER              PIC X.
  3518         16  CL-CLAIM-NO             PIC X(7).
  3519         16  CL-CERT-NO.
  3520             20  CL-CERT-PRIME       PIC X(10).
  3521             20  CL-CERT-SFX         PIC X.
  3522
  3523     12  CL-CONTROL-BY-NAME.
  3524         16  CL-COMPANY-CD-A1        PIC X.
  3525         16  CL-INSURED-LAST-NAME    PIC X(15).
  3526         16  CL-INSURED-NAME.
  3527             20  CL-INSURED-1ST-NAME PIC X(12).
  3528             20  CL-INSURED-MID-INIT PIC X.
  3529
  3530     12  CL-CONTROL-BY-SSN.
  3531         16  CL-COMPANY-CD-A2        PIC X.
  3532         16  CL-SOC-SEC-NO.
  3533             20  CL-SSN-STATE        PIC XX.
  3534             20  CL-SSN-ACCOUNT      PIC X(6).
  3535             20  CL-SSN-LN3          PIC X(3).
  3536
  3537     12  CL-CONTROL-BY-CERT-NO.
  3538         16  CL-COMPANY-CD-A4        PIC X.
  3539         16  CL-CERT-NO-A4.
  3540             20  CL-CERT-A4-PRIME    PIC X(10).
  3541             20  CL-CERT-A4-SFX      PIC X.
  3542
  3543     12  CL-CONTROL-BY-CCN.
  3544         16  CL-COMPANY-CD-A5        PIC X.
  3545         16  CL-CCN-A5.
  3546             20  CL-CCN.
  3547                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3548                 24  CL-CCN-PRIME-A5 PIC X(12).
  3549             20  CL-CCN-FILLER-A5    PIC X(4).
  3550
  3551     12  CL-INSURED-PROFILE-DATA.
  3552         16  CL-INSURED-BIRTH-DT     PIC XX.
  3553         16  CL-INSURED-SEX-CD       PIC X.
  3554             88  INSURED-IS-MALE        VALUE 'M'.
  3555             88  INSURED-IS-FEMALE      VALUE 'F'.
  3556             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3557         16  CL-INSURED-OCC-CD       PIC X(6).
  3558         16  FILLER                  PIC X(5).
  3559
  3560     12  CL-PROCESSING-INFO.
  3561         16  CL-PROCESSOR-ID         PIC X(4).
  3562         16  CL-CLAIM-STATUS         PIC X.
  3563             88  CLAIM-IS-OPEN          VALUE 'O'.
  3564             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3565         16  CL-CLAIM-TYPE           PIC X.
  3566*            88  AH-CLAIM               VALUE 'A'.
  3567*            88  LIFE-CLAIM             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  67
* EL131.cbl
  3568*            88  PROPERTY-CLAIM         VALUE 'P'.
  3569*            88  IUI-CLAIM              VALUE 'I'.
  3570*            88  GAP-CLAIM              VALUE 'G'.
  3571         16  CL-CLAIM-PREM-TYPE      PIC X.
  3572             88  SINGLE-PREMIUM         VALUE '1'.
  3573             88  O-B-COVERAGE           VALUE '2'.
  3574             88  OPEN-END-COVERAGE      VALUE '3'.
  3575         16  CL-INCURRED-DT          PIC XX.
  3576         16  CL-REPORTED-DT          PIC XX.
  3577         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3578         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3579         16  CL-LAST-PMT-DT          PIC XX.
  3580         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3581         16  CL-PAID-THRU-DT         PIC XX.
  3582         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3583         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3584         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3585         16  CL-PMT-CALC-METHOD      PIC X.
  3586             88  CL-360-DAY-YR          VALUE '1'.
  3587             88  CL-365-DAY-YR          VALUE '2'.
  3588             88  CL-FULL-MONTHS         VALUE '3'.
  3589         16  CL-CAUSE-CD             PIC X(6).
  3590
  3591         16  CL-PRIME-CERT-NO.
  3592             20  CL-PRIME-CERT-PRIME PIC X(10).
  3593             20  CL-PRIME-CERT-SFX   PIC X.
  3594
  3595         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3596             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3597             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3598
  3599         16  CL-MICROFILM-NO         PIC X(10).
  3600         16  CL-PROG-FORM-TYPE       PIC X.
  3601         16  CL-LAST-ADD-ON-DT       PIC XX.
  3602
  3603         16  CL-LAST-REOPEN-DT       PIC XX.
  3604         16  CL-LAST-CLOSE-DT        PIC XX.
  3605         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3606             88  FINAL-PAID             VALUE '1'.
  3607             88  CLAIM-DENIED           VALUE '2'.
  3608             88  AUTO-CLOSE             VALUE '3'.
  3609             88  MANUAL-CLOSE           VALUE '4'.
  3610             88  BENEFITS-CHANGED       VALUE 'C'.
  3611             88  SETUP-ERRORS           VALUE 'E'.
  3612         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3613         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3614         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3615             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3616         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3617         16  FILLER                  PIC X.
  3618
  3619     12  CL-CERTIFICATE-DATA.
  3620         16  CL-CERT-ORIGIN          PIC X.
  3621             88  CERT-WAS-ONLINE        VALUE '1'.
  3622             88  CERT-WAS-CREATED       VALUE '2'.
  3623             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3624         16  CL-CERT-KEY-DATA.
  3625             20  CL-CERT-CARRIER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  68
* EL131.cbl
  3626             20  CL-CERT-GROUPING    PIC X(6).
  3627             20  CL-CERT-STATE       PIC XX.
  3628             20  CL-CERT-ACCOUNT.
  3629                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3630                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3631             20  CL-CERT-EFF-DT      PIC XX.
  3632
  3633     12  CL-STATUS-CONTROLS.
  3634         16  CL-PRIORITY-CD          PIC X.
  3635             88  CONFIDENTIAL-DATA      VALUE '8'.
  3636             88  HIGHEST-PRIORITY       VALUE '9'.
  3637         16  CL-SUPV-ATTN-CD         PIC X.
  3638             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3639             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3640         16  CL-PURGED-DT            PIC XX.
  3641         16  CL-RESTORED-DT          PIC XX.
  3642         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3643         16  CL-NEXT-RESEND-DT       PIC XX.
  3644         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3645         16  CL-CRITICAL-PERIOD      PIC 99.
  3646*        16  FILLER                  PIC XX.
  3647         16  CL-LAST-MAINT-DT        PIC XX.
  3648         16  CL-LAST-MAINT-USER      PIC X(4).
  3649         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3650         16  CL-LAST-MAINT-TYPE      PIC X.
  3651             88  CLAIM-SET-UP           VALUE ' '.
  3652             88  PAYMENT-MADE           VALUE '1'.
  3653             88  LETTER-SENT            VALUE '2'.
  3654             88  MASTER-WAS-ALTERED     VALUE '3'.
  3655             88  MASTER-WAS-RESTORED    VALUE '4'.
  3656             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3657             88  FILE-CONVERTED         VALUE '6'.
  3658             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3659             88  ERROR-CORRECTION       VALUE 'E'.
  3660         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3661         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3662         16  CL-BENEFICIARY          PIC X(10).
  3663         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3664         16  CL-DENIAL-TYPE          PIC X.
  3665             88  CL-TYPE-DENIAL          VALUE '1'.
  3666             88  CL-TYPE-RESCISSION      VALUE '2'.
  3667             88  CL-TYPE-REFORMATION     VALUE '3'.
  3668             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3669             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3670         16  CL-CRIT-PER-RECURRENT   PIC X.
  3671         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3672         16  CL-RTW-DT               PIC XX.
  3673
  3674     12  CL-TRAILER-CONTROLS.
  3675         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3676             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3677             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3678             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3679         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3680         16  FILLER                  PIC XX.
  3681         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3682         16  CL-ADDRESS-TRAILER-CNT.
  3683             20  CL-INSURED-ADDR-CNT  PIC S9(1).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  69
* EL131.cbl
  3684                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3685             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3686                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3687             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3688                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3689             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3690                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3691             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3692                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3693             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3694                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3695             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3696                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3697
  3698     12  CL-CV-REFERENCE-NO.
  3699         16  CL-CV-REFNO-PRIME       PIC X(18).
  3700         16  CL-CV-REFNO-SFX         PIC XX.
  3701
  3702     12  CL-FILE-LOCATION            PIC X(4).
  3703
  3704     12  CL-PROCESS-ERRORS.
  3705         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3706             88  NO-FATAL-ERRORS        VALUE ZERO.
  3707         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3708             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3709
  3710     12  CL-PRODUCT-CD               PIC X.
  3711
  3712     12  CL-CURRENT-KEY-DATA.
  3713         16  CL-CURRENT-CARRIER      PIC X.
  3714         16  CL-CURRENT-GROUPING     PIC X(6).
  3715         16  CL-CURRENT-STATE        PIC XX.
  3716         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3717
  3718     12  CL-ASSOCIATES               PIC X.
  3719         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3720         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3721         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3722         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3723
  3724     12  CL-ACTIVITY-CODE            PIC 99.
  3725     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3726     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3727
  3728     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3729     12  CL-LAG-REPORT-CODE          PIC 9.
  3730     12  CL-LOAN-TYPE                PIC XX.
  3731     12  CL-LEGAL-STATE              PIC XX.
  3732
  3733     12  CL-YESNOSW                  PIC X.
  3734     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3735         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3736         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3737         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3738     12  cl-insured-claim            pic x.
  3739         88  cl-claim-on-primary         value 'P'.
  3740         88  cl-claim-on-secondary       value 'S'.
  3741     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  70
* EL131.cbl
  3742
  3743*                                COPY ELCCERT.
  3744******************************************************************
  3745*                                                                *
  3746*                            ELCCERT.                            *
  3747*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3748*                            VMOD=2.013                          *
  3749*                                                                *
  3750*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3751*                                                                *
  3752*   FILE TYPE = VSAM,KSDS                                        *
  3753*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3754*                                                                *
  3755*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3756*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3757*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3758*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3759*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3760*                                                                *
  3761*   LOG = YES                                                    *
  3762*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3763******************************************************************
  3764*                   C H A N G E   L O G
  3765*
  3766* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3767*-----------------------------------------------------------------
  3768*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3769* EFFECTIVE    NUMBER
  3770*-----------------------------------------------------------------
  3771* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3772* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3773* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3774* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3775* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3776* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3777* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3778* 032612  CR2011110200001  PEMA  AHL CHANGES
  3779******************************************************************
  3780
  3781 01  CERTIFICATE-MASTER.
  3782     12  CM-RECORD-ID                      PIC XX.
  3783         88  VALID-CM-ID                      VALUE 'CM'.
  3784
  3785     12  CM-CONTROL-PRIMARY.
  3786         16  CM-COMPANY-CD                 PIC X.
  3787         16  CM-CARRIER                    PIC X.
  3788         16  CM-GROUPING.
  3789             20  CM-GROUPING-PREFIX        PIC X(3).
  3790             20  CM-GROUPING-PRIME         PIC X(3).
  3791         16  CM-STATE                      PIC XX.
  3792         16  CM-ACCOUNT.
  3793             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3794             20  CM-ACCOUNT-PRIME          PIC X(6).
  3795         16  CM-CERT-EFF-DT                PIC XX.
  3796         16  CM-CERT-NO.
  3797             20  CM-CERT-PRIME             PIC X(10).
  3798             20  CM-CERT-SFX               PIC X.
  3799
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  71
* EL131.cbl
  3800     12  CM-CONTROL-BY-NAME.
  3801         16  CM-COMPANY-CD-A1              PIC X.
  3802         16  CM-INSURED-LAST-NAME          PIC X(15).
  3803         16  CM-INSURED-INITIALS.
  3804             20  CM-INSURED-INITIAL1       PIC X.
  3805             20  CM-INSURED-INITIAL2       PIC X.
  3806
  3807     12  CM-CONTROL-BY-SSN.
  3808         16  CM-COMPANY-CD-A2              PIC X.
  3809         16  CM-SOC-SEC-NO.
  3810             20  CM-SSN-STATE              PIC XX.
  3811             20  CM-SSN-ACCOUNT            PIC X(6).
  3812             20  CM-SSN-LN3.
  3813                 25  CM-INSURED-INITIALS-A2.
  3814                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3815                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3816                 25 CM-PART-LAST-NAME-A2         PIC X.
  3817
  3818     12  CM-CONTROL-BY-CERT-NO.
  3819         16  CM-COMPANY-CD-A4              PIC X.
  3820         16  CM-CERT-NO-A4                 PIC X(11).
  3821
  3822     12  CM-CONTROL-BY-MEMB.
  3823         16  CM-COMPANY-CD-A5              PIC X.
  3824         16  CM-MEMBER-NO.
  3825             20  CM-MEMB-STATE             PIC XX.
  3826             20  CM-MEMB-ACCOUNT           PIC X(6).
  3827             20  CM-MEMB-LN4.
  3828                 25  CM-INSURED-INITIALS-A5.
  3829                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3830                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3831                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3832
  3833     12  CM-INSURED-PROFILE-DATA.
  3834         16  CM-INSURED-FIRST-NAME.
  3835             20  CM-INSURED-1ST-INIT       PIC X.
  3836             20  FILLER                    PIC X(9).
  3837         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3838         16  CM-INSURED-SEX                PIC X.
  3839             88  CM-SEX-MALE                  VALUE 'M'.
  3840             88  CM-SEX-FEMAL                 VALUE 'F'.
  3841         16  CM-INSURED-JOINT-AGE          PIC 99.
  3842         16  CM-JOINT-INSURED-NAME.
  3843             20  CM-JT-LAST-NAME           PIC X(15).
  3844             20  CM-JT-FIRST-NAME.
  3845                 24  CM-JT-1ST-INIT        PIC X.
  3846                 24  FILLER                PIC X(9).
  3847             20  CM-JT-INITIAL             PIC X.
  3848
  3849     12  CM-LIFE-DATA.
  3850         16  CM-LF-BENEFIT-CD              PIC XX.
  3851         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3852         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3853         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3854         16  CM-LF-DEV-CODE                PIC XXX.
  3855         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3856         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3857         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  72
* EL131.cbl
  3858         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3859         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3860         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3861         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3862         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3863         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3864         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3865         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3866         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3867         16  FILLER                        PIC XX.
  3868
  3869     12  CM-AH-DATA.
  3870         16  CM-AH-BENEFIT-CD              PIC XX.
  3871         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3872         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3873         16  CM-AH-DEV-CODE                PIC XXX.
  3874         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3875         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3876         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3877         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3878         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3879         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3880         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3881         16  CM-AH-PAID-THRU-DT            PIC XX.
  3882             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3883         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3884         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3885         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3886         16  FILLER                        PIC X.
  3887
  3888     12  CM-LOAN-INFORMATION.
  3889         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3890         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  3891                                           PIC S9(5)V99  COMP-3.
  3892         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3893         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3894         16  CM-PAY-FREQUENCY              PIC S99.
  3895         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3896         16  CM-RATE-CLASS                 PIC XX.
  3897         16  CM-BENEFICIARY                PIC X(25).
  3898         16  CM-POLICY-FORM-NO             PIC X(12).
  3899         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3900         16  CM-LAST-ADD-ON-DT             PIC XX.
  3901         16  CM-DEDUCTIBLE-AMOUNTS.
  3902             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3903             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3904         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3905             20  CM-RESIDENT-STATE         PIC XX.
  3906             20  CM-RATE-CODE              PIC X(4).
  3907             20  FILLER                    PIC XX.
  3908         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3909             20  CM-LOAN-OFFICER           PIC X(5).
  3910             20  FILLER                    PIC XXX.
  3911         16  CM-CSR-CODE                   PIC XXX.
  3912         16  CM-UNDERWRITING-CODE          PIC X.
  3913             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3914         16  CM-POST-CARD-IND              PIC X.
  3915         16  CM-NH-INTERFACE-SW            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  73
* EL131.cbl
  3916         16  CM-PREMIUM-TYPE               PIC X.
  3917             88  CM-SING-PRM                  VALUE '1'.
  3918             88  CM-O-B-COVERAGE              VALUE '2'.
  3919             88  CM-OPEN-END                  VALUE '3'.
  3920         16  CM-IND-GRP-TYPE               PIC X.
  3921             88  CM-INDIVIDUAL                VALUE 'I'.
  3922             88  CM-GROUP                     VALUE 'G'.
  3923         16  CM-SKIP-CODE                  PIC X.
  3924             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  3925             88  SKIP-JULY                    VALUE '1'.
  3926             88  SKIP-AUGUST                  VALUE '2'.
  3927             88  SKIP-SEPTEMBER               VALUE '3'.
  3928             88  SKIP-JULY-AUG                VALUE '4'.
  3929             88  SKIP-AUG-SEPT                VALUE '5'.
  3930             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  3931             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  3932             88  SKIP-JUNE                    VALUE '8'.
  3933             88  SKIP-JUNE-JULY               VALUE '9'.
  3934             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  3935             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  3936         16  CM-PAYMENT-MODE               PIC X.
  3937             88  PAY-MONTHLY                  VALUE SPACE.
  3938             88  PAY-WEEKLY                   VALUE '1'.
  3939             88  PAY-SEMI-MONTHLY             VALUE '2'.
  3940             88  PAY-BI-WEEKLY                VALUE '3'.
  3941             88  PAY-SEMI-ANUALLY             VALUE '4'.
  3942         16  CM-LOAN-NUMBER                PIC X(8).
  3943         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  3944         16  CM-OLD-LOF                    PIC XXX.
  3945*        16  CM-LOAN-OFFICER               PIC XXX.
  3946         16  CM-REIN-TABLE                 PIC XXX.
  3947         16  CM-SPECIAL-REIN-CODE          PIC X.
  3948         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  3949         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  3950         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  3951
  3952     12  CM-STATUS-DATA.
  3953         16  CM-ENTRY-STATUS               PIC X.
  3954         16  CM-ENTRY-DT                   PIC XX.
  3955
  3956         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  3957         16  CM-LF-CANCEL-DT               PIC XX.
  3958         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  3959
  3960         16  CM-LF-STATUS-AT-DEATH         PIC X.
  3961         16  CM-LF-DEATH-DT                PIC XX.
  3962         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  3963
  3964         16  CM-LF-CURRENT-STATUS          PIC X.
  3965             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3966                                                'M' '4' '5' '9'.
  3967             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  3968             88  CM-LF-POLICY-PENDING         VALUE '2'.
  3969             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  3970             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  3971             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  3972             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3973             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  74
* EL131.cbl
  3974             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3975             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  3976             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  3977             88  CM-LF-DECLINED               VALUE 'D'.
  3978             88  CM-LF-VOIDED                 VALUE 'V'.
  3979
  3980         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  3981         16  CM-AH-CANCEL-DT               PIC XX.
  3982         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  3983
  3984         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  3985         16  CM-AH-SETTLEMENT-DT           PIC XX.
  3986         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  3987
  3988         16  CM-AH-CURRENT-STATUS          PIC X.
  3989             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3990                                                'M' '4' '5' '9'.
  3991             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  3992             88  CM-AH-POLICY-PENDING         VALUE '2'.
  3993             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  3994             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  3995             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  3996             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3997             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  3998             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3999             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4000             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4001             88  CM-AH-DECLINED               VALUE 'D'.
  4002             88  CM-AH-VOIDED                 VALUE 'V'.
  4003
  4004         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4005             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4006             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4007             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4008         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4009
  4010         16  CM-ENTRY-BATCH                PIC X(6).
  4011         16  CM-LF-EXIT-BATCH              PIC X(6).
  4012         16  CM-AH-EXIT-BATCH              PIC X(6).
  4013         16  CM-LAST-MONTH-END             PIC XX.
  4014
  4015     12  CM-NOTE-SW                        PIC X.
  4016         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4017         88  CERT-NOTES-PRESENT               VALUE '1'.
  4018         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4019         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4020         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4021         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4022         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4023         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4024     12  CM-COMP-EXCP-SW                   PIC X.
  4025         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4026         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4027     12  CM-INSURED-ADDRESS-SW             PIC X.
  4028         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4029         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4030
  4031*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  75
* EL131.cbl
  4032     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4033     12  FILLER                            PIC X.
  4034
  4035*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4036     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4037     12  FILLER                            PIC X.
  4038*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4039     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4040
  4041     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4042         88  CERT-ADDED-BATCH                 VALUE ' '.
  4043         88  CERT-ADDED-ONLINE                VALUE '1'.
  4044         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4045         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4046         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4047     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4048         88  CERT-AS-LOADED                   VALUE ' '.
  4049         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4050         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4051         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4052         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4053         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4054         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4055         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4056
  4057     12  CM-ACCOUNT-COMM-PCTS.
  4058         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4059         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4060
  4061     12  CM-USER-FIELD                     PIC X.
  4062     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4063     12  CM-CLP-STATE                      PIC XX.
  4064     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4065     12  CM-USER-RESERVED                  PIC XXX.
  4066     12  FILLER REDEFINES CM-USER-RESERVED.
  4067         16  CM-AH-CLASS-CD                PIC XX.
  4068         16  F                             PIC X.
  4069******************************************************************
  4070
  4071*                                COPY ELCTRLR.
  4072******************************************************************
  4073*                                                                *
  4074*                            ELCTRLR.                            *
  4075*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4076*                            VMOD=2.014                          *
  4077*                                                                *
  4078*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4079*                                                                *
  4080*   FILE TYPE = VSAM,KSDS                                        *
  4081*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4082*                                                                *
  4083*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4084*       ALTERNATE INDEX = NONE                                   *
  4085*                                                                *
  4086*   LOG = YES                                                    *
  4087*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4088******************************************************************
  4089*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  76
* EL131.cbl
  4090*
  4091* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4092*-----------------------------------------------------------------
  4093*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4094* EFFECTIVE    NUMBER
  4095*-----------------------------------------------------------------
  4096* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4097* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4098* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4099* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4100* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4101* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4102* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4103* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4104* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4105* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4106* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4107* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4108* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4109* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4110* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4111* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4112* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4113******************************************************************
  4114 01  ACTIVITY-TRAILERS.
  4115     12  AT-RECORD-ID                    PIC XX.
  4116         88  VALID-AT-ID                       VALUE 'AT'.
  4117
  4118     12  AT-CONTROL-PRIMARY.
  4119         16  AT-COMPANY-CD               PIC X.
  4120         16  AT-CARRIER                  PIC X.
  4121         16  AT-CLAIM-NO                 PIC X(7).
  4122         16  AT-CERT-NO.
  4123             20  AT-CERT-PRIME           PIC X(10).
  4124             20  AT-CERT-SFX             PIC X.
  4125         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4126             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4127             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4128             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4129             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4130             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4131             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4132             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4133             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4134             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4135             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4136             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4137             88  AT-BENEFICIARY-TRL           VALUE +91.
  4138             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4139             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4140             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4141             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4142
  4143     12  AT-TRAILER-TYPE                 PIC X.
  4144         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4145         88  PAYMENT-TR                       VALUE '2'.
  4146         88  AUTO-PAY-TR                      VALUE '3'.
  4147         88  CORRESPONDENCE-TR                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  77
* EL131.cbl
  4148         88  ADDRESS-TR                       VALUE '5'.
  4149         88  GENERAL-INFO-TR                  VALUE '6'.
  4150         88  AUTO-PROMPT-TR                   VALUE '7'.
  4151         88  DENIAL-TR                        VALUE '8'.
  4152         88  INCURRED-CHG-TR                  VALUE '9'.
  4153         88  FORM-CONTROL-TR                  VALUE 'A'.
  4154
  4155     12  AT-RECORDED-DT                  PIC XX.
  4156     12  AT-RECORDED-BY                  PIC X(4).
  4157     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4158
  4159     12  AT-TRAILER-BODY                 PIC X(165).
  4160
  4161     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4162         16  AT-RESERVE-CONTROLS.
  4163             20  AT-MANUAL-SW            PIC X.
  4164                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4165             20  AT-FUTURE-SW            PIC X.
  4166                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4167             20  AT-PTC-SW               PIC X.
  4168                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4169             20  AT-IBNR-SW              PIC X.
  4170                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4171             20  AT-PTC-LF-SW            PIC X.
  4172                 88  AT-LF-PTC-USED          VALUE '1'.
  4173             20  AT-CDT-ACCESS-METHOD    PIC X.
  4174                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4175                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4176                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4177             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4178         16  AT-LAST-COMPUTED-DT         PIC XX.
  4179         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4180         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4181         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4182         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4183         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4184         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4185         16  AT-EXPENSE-CONTROLS.
  4186             20  AT-EXPENSE-METHOD       PIC X.
  4187                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4188                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4189                 88  PERCENT-OF-PMT           VALUE '3'.
  4190                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4191             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4192             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4193         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4194         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4195
  4196         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4197         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4198
  4199*        16  FILLER                      PIC X(53).
  4200         16  FILLER                      PIC X(47).
  4201
  4202         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4203         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4204
  4205         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  78
* EL131.cbl
  4206             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4207             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4208*                    C = CLOSED
  4209*                    O = OPEN
  4210             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4211*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4212
  4213     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4214         16  AT-PAYMENT-TYPE             PIC X.
  4215             88  PARTIAL-PAYMENT                VALUE '1'.
  4216             88  FINAL-PAYMENT                  VALUE '2'.
  4217             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4218             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4219             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4220             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4221             88  VOIDED-PAYMENT                 VALUE '9'.
  4222             88  TRANSFER                       VALUE 'T'.
  4223             88  LIFE-INTEREST                  VALUE 'I'.
  4224
  4225         16  AT-CLAIM-TYPE               PIC X.
  4226             88  PAID-FOR-AH                    VALUE 'A'.
  4227             88  PAID-FOR-LIFE                  VALUE 'L'.
  4228             88  PAID-FOR-IUI                   VALUE 'I'.
  4229             88  PAID-FOR-GAP                   VALUE 'G'.
  4230         16  AT-CLAIM-PREM-TYPE          PIC X.
  4231             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4232             88  AT-O-B-COVERAGE                VALUE '2'.
  4233             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4234         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4235         16  AT-CHECK-NO                 PIC X(7).
  4236         16  AT-PAID-FROM-DT             PIC XX.
  4237         16  AT-PAID-THRU-DT             PIC XX.
  4238         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4239         16  FILLER                      PIC X.
  4240         16  AT-PAYEES-NAME              PIC X(30).
  4241         16  AT-PAYMENT-ORIGIN           PIC X.
  4242             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4243             88  ONLINE-AUTO-PMT                VALUE '2'.
  4244             88  OFFLINE-PMT                    VALUE '3'.
  4245         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4246         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4247         16  AT-VOID-DATA.
  4248             20  AT-VOID-DT              PIC XX.
  4249*00144       20  AT-VOID-REASON          PIC X(30).
  4250             20  AT-VOID-REASON          PIC X(26).
  4251         16  AT-PMT-APPROVED-BY          PIC X(04).
  4252         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4253         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4254         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4255                                         PIC S99V9(5)  COMP-3.
  4256         16  AT-CREDIT-INTERFACE.
  4257             20  AT-PMT-SELECT-DT        PIC XX.
  4258                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4259             20  AT-PMT-ACCEPT-DT        PIC XX.
  4260                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4261             20  AT-VOID-SELECT-DT       PIC XX.
  4262                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4263             20  AT-VOID-ACCEPT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  79
* EL131.cbl
  4264                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4265
  4266         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4267                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4268                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4269         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4270
  4271         16  AT-FORCE-CONTROL            PIC X.
  4272             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4273         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4274         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4275         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4276         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4277         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4278         16  AT-BENEFIT-TYPE             PIC X.
  4279
  4280         16  AT-EXPENSE-TYPE             PIC X.
  4281         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4282
  4283         16  AT-PAYEE-TYPE-CD.
  4284             20  AT-PAYEE-TYPE           PIC X.
  4285                 88  INSURED-PAID           VALUE 'I'.
  4286                 88  BENEFICIARY-PAID       VALUE 'B'.
  4287                 88  ACCOUNT-PAID           VALUE 'A'.
  4288                 88  OTHER-1-PAID           VALUE 'O'.
  4289                 88  OTHER-2-PAID           VALUE 'Q'.
  4290                 88  DOCTOR-PAID            VALUE 'P'.
  4291                 88  EMPLOYER-PAID          VALUE 'E'.
  4292             20  AT-PAYEE-SEQ            PIC X.
  4293
  4294         16  AT-CASH-PAYMENT             PIC X.
  4295         16  AT-GROUPED-PAYMENT          PIC X.
  4296         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4297         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4298         16  AT-APPROVED-LEVEL           PIC X.
  4299         16  AT-VOID-TYPE                PIC X.
  4300             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4301             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4302         16  AT-AIG-UNEMP-IND            PIC X.
  4303             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4304         16  AT-ASSOCIATES               PIC X.
  4305             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4306             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4307
  4308         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4309         16  AT-CV-PMT-CODE              PIC X.
  4310             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4311             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4312             88  FULL-ADD-PAYMENT           VALUE '3'.
  4313             88  HALF-ADD-PAYMENT           VALUE '4'.
  4314             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4315             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4316             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4317             88  ADDL-PAYMENT               VALUE '8'.
  4318
  4319         16  AT-EOB-CODE1                PIC XXX.
  4320         16  AT-EOB-CODE2                PIC XXX.
  4321         16  AT-EOB-CODE3                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  80
* EL131.cbl
  4322         16  FILLER REDEFINES AT-EOB-CODE3.
  4323             20  AT-PRINT-CLM-FORM       PIC X.
  4324             20  AT-PRINT-SURVEY         PIC X.
  4325             20  AT-SPECIAL-RELEASE      PIC X.
  4326         16  AT-EOB-CODE4                PIC XXX.
  4327         16  FILLER REDEFINES AT-EOB-CODE4.
  4328             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4329             20  FILLER                  PIC X.
  4330         16  AT-EOB-CODE5                PIC XXX.
  4331         16  FILLER REDEFINES AT-EOB-CODE5.
  4332             20  AT-PMT-PROOF-DT         PIC XX.
  4333             20  FILLER                  PIC X.
  4334
  4335         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4336             88  AT-PRINT-EOB            VALUE 'Y'.
  4337
  4338         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4339         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4340
  4341     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4342         16  AT-SCHEDULE-START-DT        PIC XX.
  4343         16  AT-SCHEDULE-END-DT          PIC XX.
  4344         16  AT-TERMINATED-DT            PIC XX.
  4345         16  AT-LAST-PMT-TYPE            PIC X.
  4346             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4347             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4348         16  AT-FIRST-PMT-DATA.
  4349             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4350             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4351             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4352         16  AT-REGULAR-PMT-DATA.
  4353             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4354             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4355             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4356         16  AT-AUTO-PAYEE-CD.
  4357             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4358                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4359                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4360                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4361                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4362                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4363             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4364         16  AT-AUTO-PAY-DAY             PIC 99.
  4365         16  AT-AUTO-CASH                PIC X.
  4366             88  AT-CASH                      VALUE 'Y'.
  4367             88  AT-NON-CASH                  VALUE 'N'.
  4368*        16  FILLER                      PIC X(129).
  4369         16  AT-AUTO-END-LETTER          PIC X(4).
  4370         16  FILLER                      PIC X(125).
  4371
  4372         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4373         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4374
  4375     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4376         16  AT-LETTER-SENT-DT           PIC XX.
  4377         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4378         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4379         16  AT-LETTER-ANSWERED-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  81
* EL131.cbl
  4380         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4381         16  AT-LETTER-ORIGIN            PIC X.
  4382             88  ONLINE-CREATION              VALUE '1' '3'.
  4383             88  OFFLINE-CREATION             VALUE '2' '4'.
  4384             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4385             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4386         16  AT-STD-LETTER-FORM          PIC X(4).
  4387         16  AT-REASON-TEXT              PIC X(70).
  4388         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4389         16  AT-ADDRESEE-TYPE            PIC X.
  4390              88  INSURED-ADDRESEE            VALUE 'I'.
  4391              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4392              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4393              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4394              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4395              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4396              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4397         16  AT-ADDRESSEE-NAME           PIC X(30).
  4398         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4399         16  AT-RESEND-PRINT-DATE        PIC XX.
  4400         16  AT-CORR-SOL-UNSOL           PIC X.
  4401         16  AT-LETTER-PURGED-DT         PIC XX.
  4402*
  4403*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4404*
  4405         16  AT-CSO-REDEFINITION.
  4406             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4407             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4408             20  AT-LETTER-TO-BENE       PIC X(1).
  4409             20  AT-STOP-LETTER-DT       PIC X(2).
  4410             20  FILLER                  PIC X(19).
  4411*             20  FILLER                  PIC X(27).
  4412             20  AT-CSO-LETTER-STATUS    PIC X.
  4413                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4414                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4415                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4416             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4417             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4418*
  4419*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4420*
  4421*        16  FILLER                      PIC X(26).
  4422*
  4423*        16  AT-DMD-BSR-CODE             PIC X.
  4424*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4425*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4426*
  4427*        16  AT-DMD-LETTER-STATUS        PIC X.
  4428*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4429*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4430*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4431*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4432*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4433
  4434         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4435         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4436
  4437     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  82
* EL131.cbl
  4438         16  AT-ADDRESS-TYPE             PIC X.
  4439             88  INSURED-ADDRESS               VALUE 'I'.
  4440             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4441             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4442             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4443             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4444             88  OTHER-ADDRESS-1               VALUE 'O'.
  4445             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4446         16  AT-MAIL-TO-NAME             PIC X(30).
  4447         16  AT-ADDRESS-LINE-1           PIC X(30).
  4448         16  AT-ADDRESS-LINE-2           PIC X(30).
  4449         16  AT-CITY-STATE.
  4450             20  AT-CITY                 PIC X(28).
  4451             20  AT-STATE                PIC XX.
  4452         16  AT-ZIP.
  4453             20  AT-ZIP-CODE.
  4454                 24  AT-ZIP-1ST          PIC X.
  4455                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4456                 24  FILLER              PIC X(4).
  4457             20  AT-ZIP-PLUS4            PIC X(4).
  4458         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4459             20  AT-CAN-POSTAL-1         PIC XXX.
  4460             20  AT-CAN-POSTAL-2         PIC XXX.
  4461             20  FILLER                  PIC XXX.
  4462         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4463*         16  FILLER                      PIC X(23).
  4464         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4465         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4466         16  FILLER                      PIC X(13).
  4467         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4468         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4469
  4470     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4471         16  AT-INFO-LINE-1              PIC X(60).
  4472         16  FILLER REDEFINES AT-INFO-LINE-1.
  4473             20  AT-NOTE-ERROR-NO OCCURS 15
  4474                                         PIC X(4).
  4475         16  AT-INFO-LINE-2              PIC X(60).
  4476         16  AT-INFO-TRAILER-TYPE        PIC X.
  4477             88  AT-ERRORS-NOTE          VALUE 'E'.
  4478             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4479             88  AT-CALL-NOTE            VALUE 'C'.
  4480             88  AT-MAINT-NOTE           VALUE 'M'.
  4481             88  AT-CERT-CHANGE          VALUE 'X'.
  4482             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4483             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4484         16  AT-CALL-TYPE                PIC X.
  4485             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4486             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4487         16  AT-NOTE-CONTINUATION        PIC X.
  4488             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4489         16  AT-EOB-CODES-EXIST          PIC X.
  4490             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4491         16  FILLER                      PIC X(35).
  4492         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4493         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4494
  4495     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  83
* EL131.cbl
  4496         16  AT-PROMPT-LINE-1            PIC X(60).
  4497         16  AT-PROMPT-LINE-2            PIC X(60).
  4498         16  AT-PROMPT-START-DT          PIC XX.
  4499         16  AT-PROMPT-END-DT            PIC XX.
  4500         16  FILLER                      PIC X(35).
  4501         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4502         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4503
  4504     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4505         16  AT-DENIAL-INFO-1            PIC X(60).
  4506         16  AT-DENIAL-INFO-2            PIC X(60).
  4507         16  AT-DENIAL-DT                PIC XX.
  4508         16  AT-RETRACTION-DT            PIC XX.
  4509         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4510*         16  FILLER                      PIC X(31).
  4511         16  AT-DENIAL-PROOF-DT          PIC XX.
  4512         16  FILLER                      PIC X(29).
  4513         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4514         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4515
  4516     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4517         16  AT-OLD-INCURRED-DT          PIC XX.
  4518         16  AT-OLD-REPORTED-DT          PIC XX.
  4519         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4520         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4521         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4522         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4523         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4524         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4525         16  FILLER                      PIC X(26).
  4526         16  AT-OLD-DIAG-CODE            PIC X(6).
  4527         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4528         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4529         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4530         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4531         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4532         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4533         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4534         16  FILLER                      PIC X(25).
  4535         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4536
  4537     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4538         16  AT-FORM-SEND-ON-DT          PIC XX.
  4539         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4540         16  AT-FORM-RE-SEND-DT          PIC XX.
  4541         16  AT-FORM-ANSWERED-DT         PIC XX.
  4542         16  AT-FORM-PRINTED-DT          PIC XX.
  4543         16  AT-FORM-REPRINT-DT          PIC XX.
  4544         16  AT-FORM-TYPE                PIC X.
  4545             88  INITIAL-FORM                  VALUE '1'.
  4546             88  PROGRESS-FORM                 VALUE '2'.
  4547         16  AT-INSTRUCT-LN-1            PIC X(28).
  4548         16  AT-INSTRUCT-LN-2            PIC X(28).
  4549         16  AT-INSTRUCT-LN-3            PIC X(28).
  4550         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4551         16  AT-FORM-ADDRESS             PIC X.
  4552             88  FORM-TO-INSURED              VALUE 'I'.
  4553             88  FORM-TO-ACCOUNT              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  84
* EL131.cbl
  4554             88  FORM-TO-OTHER-1              VALUE 'O'.
  4555             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4556         16  AT-RELATED-1.
  4557             20 AT-REL-CARR-1            PIC X.
  4558             20 AT-REL-CLAIM-1           PIC X(7).
  4559             20 AT-REL-CERT-1            PIC X(11).
  4560         16  AT-RELATED-2.
  4561             20 AT-REL-CARR-2            PIC X.
  4562             20 AT-REL-CLAIM-2           PIC X(7).
  4563             20 AT-REL-CERT-2            PIC X(11).
  4564         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4565         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4566         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4567         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4568         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4569         16  AT-STOP-FORM-DT             PIC X(2).
  4570
  4571         16  FILLER                      PIC X(09).
  4572         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4573         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4574******************************************************************
  4575
  4576*                                COPY ELCCNTL.
  4577******************************************************************
  4578*                                                                *
  4579*                                                                *
  4580*                            ELCCNTL.                            *
  4581*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4582*                            VMOD=2.059                          *
  4583*                                                                *
  4584*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4585*                                                                *
  4586*   FILE TYPE = VSAM,KSDS                                        *
  4587*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4588*                                                                *
  4589*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4590*       ALTERNATE INDEX = NONE                                   *
  4591*                                                                *
  4592*   LOG = YES                                                    *
  4593*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4594******************************************************************
  4595*                   C H A N G E   L O G
  4596*
  4597* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4598*-----------------------------------------------------------------
  4599*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4600* EFFECTIVE    NUMBER
  4601*-----------------------------------------------------------------
  4602* 082503                   PEMA  ADD BENEFIT GROUP
  4603* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4604* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4605* 092705    2005050300006  PEMA  ADD SPP LEASES
  4606* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4607* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4608* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4609* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4610* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4611* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  85
* EL131.cbl
  4612* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4613* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4614* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4615******************************************************************
  4616*
  4617 01  CONTROL-FILE.
  4618     12  CF-RECORD-ID                       PIC XX.
  4619         88  VALID-CF-ID                        VALUE 'CF'.
  4620
  4621     12  CF-CONTROL-PRIMARY.
  4622         16  CF-COMPANY-ID                  PIC XXX.
  4623         16  CF-RECORD-TYPE                 PIC X.
  4624             88  CF-COMPANY-MASTER              VALUE '1'.
  4625             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4626             88  CF-STATE-MASTER                VALUE '3'.
  4627             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4628             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4629             88  CF-CARRIER-MASTER              VALUE '6'.
  4630             88  CF-MORTALITY-MASTER            VALUE '7'.
  4631             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4632             88  CF-TERMINAL-MASTER             VALUE '9'.
  4633             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4634             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4635             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4636             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4637             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4638             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4639             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4640             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4641             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4642         16  CF-ACCESS-CD-GENL              PIC X(4).
  4643         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4644             20  CF-PROCESSOR               PIC X(4).
  4645         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4646             20  CF-STATE-CODE              PIC XX.
  4647             20  FILLER                     PIC XX.
  4648         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4649             20  FILLER                     PIC XX.
  4650             20  CF-HI-BEN-IN-REC           PIC XX.
  4651         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4652             20  FILLER                     PIC XXX.
  4653             20  CF-CARRIER-CNTL            PIC X.
  4654         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4655             20  FILLER                     PIC XX.
  4656             20  CF-HI-TYPE-IN-REC          PIC 99.
  4657         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4658             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4659                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4660             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4661             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4662         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4663             20  FILLER                     PIC X.
  4664             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4665         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4666             20  FILLER                     PIC XX.
  4667             20  CF-MORTGAGE-PLAN           PIC XX.
  4668         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4669
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  86
* EL131.cbl
  4670     12  CF-LAST-MAINT-DT                   PIC XX.
  4671     12  CF-LAST-MAINT-BY                   PIC X(4).
  4672     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4673
  4674     12  CF-RECORD-BODY                     PIC X(728).
  4675
  4676
  4677****************************************************************
  4678*             COMPANY MASTER RECORD                            *
  4679****************************************************************
  4680
  4681     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4682         16  CF-COMPANY-ADDRESS.
  4683             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4684             20  CF-CL-IN-CARE-OF           PIC X(30).
  4685             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4686             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4687             20  CF-CL-CITY-STATE           PIC X(30).
  4688             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4689             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4690         16  CF-COMPANY-CD                  PIC X.
  4691         16  CF-COMPANY-PASSWORD            PIC X(8).
  4692         16  CF-SECURITY-OPTION             PIC X.
  4693             88  ALL-SECURITY                   VALUE '1'.
  4694             88  COMPANY-VERIFY                 VALUE '2'.
  4695             88  PROCESSOR-VERIFY               VALUE '3'.
  4696             88  NO-SECURITY                    VALUE '4'.
  4697             88  ALL-BUT-TERM                   VALUE '5'.
  4698         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4699             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4700         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4701             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4702         16  CF-INFORCE-LOCATION            PIC X.
  4703             88  CERTS-ARE-ONLINE               VALUE '1'.
  4704             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4705             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4706         16  CF-LOWER-CASE-LETTERS          PIC X.
  4707         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4708             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4709             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4710             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4711             88  CF-ACCNT-CNTL                  VALUE '3'.
  4712             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4713
  4714         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4715         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4716
  4717         16  CF-LGX-CREDIT-USER             PIC X.
  4718             88  CO-IS-NOT-USER                 VALUE 'N'.
  4719             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4720
  4721         16 CF-CREDIT-CALC-CODES.
  4722             20  CF-CR-REM-TERM-CALC PIC X.
  4723               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4724               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4725               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4726               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4727               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  87
* EL131.cbl
  4728               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4729               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4730             20  CF-CR-R78-METHOD           PIC X.
  4731               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4732               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4733
  4734         16  CF-CLAIM-CONTROL-COUNTS.
  4735             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4736                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4737
  4738             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4739                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4740
  4741             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4742                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4743
  4744             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4745                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4746
  4747         16  CF-CURRENT-MONTH-END           PIC XX.
  4748
  4749         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4750             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4751             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4752             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4753             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4754                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4755                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4756             20  CF-CO-PREM-REJECT-SW       PIC X.
  4757                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4758                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4759             20  CF-CO-REF-REJECT-SW        PIC X.
  4760                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4761                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4762
  4763         16  CF-CO-REPORTING-DT             PIC XX.
  4764         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4765         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4766           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4767           88  CF-CO-MONTH-END                  VALUE '1'.
  4768
  4769         16  CF-LGX-CLAIM-USER              PIC X.
  4770             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4771             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4772
  4773         16  CF-CREDIT-EDIT-CONTROLS.
  4774             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4775             20  CF-MIN-AGE                 PIC 99.
  4776             20  CF-DEFAULT-AGE             PIC 99.
  4777             20  CF-MIN-TERM                PIC S999      COMP-3.
  4778             20  CF-MAX-TERM                PIC S999      COMP-3.
  4779             20  CF-DEFAULT-SEX             PIC X.
  4780             20  CF-JOINT-AGE-INPUT         PIC X.
  4781                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4782             20  CF-BIRTH-DATE-INPUT        PIC X.
  4783                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4784             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4785                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  88
* EL131.cbl
  4786                 88  CF-ZERO-CARRIER            VALUE '1'.
  4787                 88  CF-ZERO-GROUPING           VALUE '2'.
  4788                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4789             20  CF-EDIT-SW                 PIC X.
  4790                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4791             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4792             20  CF-CR-PR-METHOD            PIC X.
  4793               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4794               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4795             20  FILLER                     PIC X.
  4796
  4797         16  CF-CREDIT-MISC-CONTROLS.
  4798             20  CF-REIN-TABLE-SW           PIC X.
  4799                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4800             20  CF-COMP-TABLE-SW           PIC X.
  4801                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4802             20  CF-EXPERIENCE-RETENTION-AGE
  4803                                            PIC S9        COMP-3.
  4804             20  CF-CONVERSION-DT           PIC XX.
  4805             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4806             20  CF-RUN-FREQUENCY-SW        PIC X.
  4807                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4808                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4809
  4810             20  CF-CR-CHECK-NO-CONTROL.
  4811                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4812                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4813                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4814                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4815                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4816                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4817
  4818                 24  CF-CR-CHECK-COUNT       REDEFINES
  4819                     CF-CR-CHECK-COUNTER      PIC X(4).
  4820
  4821                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4822                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4823
  4824                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4825                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4826                 24  CF-MAIL-PROCESSING       PIC X.
  4827                     88  MAIL-PROCESSING          VALUE 'Y'.
  4828
  4829         16  CF-MISC-SYSTEM-CONTROL.
  4830             20  CF-SYSTEM-C                 PIC X.
  4831                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4832             20  CF-SYSTEM-D                 PIC X.
  4833                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4834             20  CF-SOC-SEC-NO-SW            PIC X.
  4835                 88  SOC-SEC-NO-USED             VALUE '1'.
  4836             20  CF-MEMBER-NO-SW             PIC X.
  4837                 88  MEMBER-NO-USED              VALUE '1'.
  4838             20  CF-TAX-ID-NUMBER            PIC X(11).
  4839             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4840             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4841                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4842                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4843                 88  CF-ALL-APPROVED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  89
* EL131.cbl
  4844                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4845             20  CF-SYSTEM-E                 PIC X.
  4846                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4847
  4848         16  CF-LGX-LIFE-USER               PIC X.
  4849             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4850             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4851
  4852         16  CF-CR-MONTH-END-DT             PIC XX.
  4853
  4854         16  CF-FILE-MAINT-DATES.
  4855             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4856                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4857             20  CF-LAST-BATCH       REDEFINES
  4858                 CF-LAST-BATCH-NO               PIC X(4).
  4859             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4860             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4861             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4862             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4863             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4864             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4865             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4866             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4867             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4868             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4869
  4870         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4871         16  FILLER                         PIC X.
  4872
  4873         16  CF-ALT-MORT-CODE               PIC X(4).
  4874         16  CF-MEMBER-CAPTION              PIC X(10).
  4875
  4876         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4877             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4878             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4879             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4880             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4881             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4882
  4883         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4884
  4885         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4886         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4887         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4888         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4889
  4890         16  CF-AH-OVERRIDE-L1              PIC X.
  4891         16  CF-AH-OVERRIDE-L2              PIC XX.
  4892         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4893         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4894
  4895         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4896         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4897
  4898         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4899         16  CF-AR-LAST-EL860-DT            PIC XX.
  4900         16  CF-MP-MONTH-END-DT             PIC XX.
  4901
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  90
* EL131.cbl
  4902         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4903         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4904             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4905
  4906         16  CF-AR-MONTH-END-DT             PIC XX.
  4907
  4908         16  CF-CRDTCRD-USER                PIC X.
  4909             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4910             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4911
  4912         16  CF-CC-MONTH-END-DT             PIC XX.
  4913
  4914         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4915
  4916         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4917             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4918             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4919             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4920         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4921         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4922         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4923         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4924             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4925             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4926         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4927         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4928         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4929             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4930         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4931
  4932         16  CF-CL-ZIP-CODE.
  4933             20  CF-CL-ZIP-PRIME.
  4934                 24  CF-CL-ZIP-1ST          PIC X.
  4935                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4936                 24  FILLER                 PIC X(4).
  4937             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4938         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4939             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4940             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4941             20  FILLER                     PIC XXX.
  4942
  4943         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4944         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4945         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4946         16  CF-CO-OPTION-START-DATE        PIC XX.
  4947         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4948           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4949                                                      '3' '4'.
  4950           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4951           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4952           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4953           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4954           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4955           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4956
  4957         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4958
  4959         16  CF-PAYMENT-APPROVAL-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  91
* EL131.cbl
  4960             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4961             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4962             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4963             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4964             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4965             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4966
  4967         16  CF-END-USER-REPORTING-USER     PIC X.
  4968             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4969             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4970
  4971         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4972             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4973             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4974
  4975         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4976
  4977         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4978         16  FILLER                         PIC X.
  4979
  4980         16  CF-CREDIT-ARCHIVE-CNTL.
  4981             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4982             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4983             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4984
  4985         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4986
  4987         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4988             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4989             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4990
  4991         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4992             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4993             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4994
  4995         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4996
  4997         16  CF-CO-ACH-ID-CODE              PIC  X.
  4998             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4999             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5000             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5001         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5002         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5003         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5004         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5005         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5006         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5007         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5008         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5009         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5010                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5011         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5012                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5013
  5014         16  CF-CO-OVER-SHORT.
  5015             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5016             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5017
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  92
* EL131.cbl
  5018*         16  FILLER                         PIC X(102).
  5019         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5020             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5021             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5022
  5023         16  CF-AH-APPROVAL-DAYS.
  5024             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5025             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5026             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5027             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5028
  5029         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5030
  5031         16  CF-APPROV-LEV-5.
  5032             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5033             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5034             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5035
  5036         16  FILLER                         PIC X(68).
  5037****************************************************************
  5038*             PROCESSOR/USER RECORD                            *
  5039****************************************************************
  5040
  5041     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5042         16  CF-PROCESSOR-NAME              PIC X(30).
  5043         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5044         16  CF-PROCESSOR-TITLE             PIC X(26).
  5045         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5046                 88  MESSAGE-YES                VALUE 'Y'.
  5047                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5048
  5049*****************************************************
  5050****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5051****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5052****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5053****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5054*****************************************************
  5055
  5056         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5057             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5058             20  CF-APPLICATION-FORCE       PIC X.
  5059             20  CF-INDIVIDUAL-APP.
  5060                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5061                     28  CF-BROWSE-APP      PIC X.
  5062                     28  CF-UPDATE-APP      PIC X.
  5063
  5064         16  CF-CURRENT-TERM-ON             PIC X(4).
  5065         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5066             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5067             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5068             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5069             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5070             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5071             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5072             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5073         16  CF-PROCESSOR-CARRIER           PIC X.
  5074             88  NO-CARRIER-SECURITY            VALUE ' '.
  5075         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  93
* EL131.cbl
  5076             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5077         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5078             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5079         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5080             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5081
  5082         16  CF-PROC-SYS-ACCESS-SW.
  5083             20  CF-PROC-CREDIT-CLAIMS-SW.
  5084                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5085                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5086                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5087                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5088             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5089                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5090                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5091             20  CF-PROC-LIFE-GNRLDGR-SW.
  5092                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5093                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5094                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5095                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5096             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5097                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5098                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5099         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5100             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5101             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5102         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5103
  5104         16  CF-APPROVAL-LEVEL                  PIC X.
  5105             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5106             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5107             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5108             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5109             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5110
  5111         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5112
  5113         16  CF-LANGUAGE-TYPE                   PIC X.
  5114             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5115             88  CF-LANG-IS-FR                      VALUE 'F'.
  5116
  5117         16  CF-CSR-IND                         PIC X.
  5118         16  FILLER                             PIC X(239).
  5119
  5120****************************************************************
  5121*             PROCESSOR/REMINDERS RECORD                       *
  5122****************************************************************
  5123
  5124     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5125         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5126             20  CF-START-REMIND-DT         PIC XX.
  5127             20  CF-END-REMIND-DT           PIC XX.
  5128             20  CF-REMINDER-TEXT           PIC X(50).
  5129         16  FILLER                         PIC X(296).
  5130
  5131
  5132****************************************************************
  5133*             STATE MASTER RECORD                              *
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  94
* EL131.cbl
  5134****************************************************************
  5135
  5136     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5137         16  CF-STATE-ABBREVIATION          PIC XX.
  5138         16  CF-STATE-NAME                  PIC X(25).
  5139         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5140         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5141             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5142             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5143             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5144             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5145                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5146                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5147             20  CF-ST-PREM-REJECT-SW       PIC X.
  5148                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5149                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5150             20  CF-ST-REF-REJECT-SW        PIC X.
  5151                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5152                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5153         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5154         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5155         16  CF-ST-REFUND-RULES.
  5156             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5157             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5158             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5159         16  CF-ST-FST-PMT-EXTENSION.
  5160             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5161             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5162                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5163                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5164                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5165                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5166         16  CF-ST-STATE-CALL.
  5167             20  CF-ST-CALL-UNEARNED        PIC X.
  5168             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5169             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5170         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5171             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5172             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5173         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5174         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5175         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5176         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5177         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5178         16  FILLER                         PIC X.
  5179         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5180             20  CF-ST-BENEFIT-CD           PIC XX.
  5181             20  CF-ST-BENEFIT-KIND         PIC X.
  5182                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5183                 88  CF-ST-AH-KIND              VALUE 'A'.
  5184             20  CF-ST-REM-TERM-CALC        PIC X.
  5185                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5186                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5187                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5188                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5189                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5190                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5191                 88  ST-EARN-AFTER-14TH         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  95
* EL131.cbl
  5192                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5193
  5194             20  CF-ST-REFUND-CALC          PIC X.
  5195                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5196                 88  ST-REFD-BY-R78             VALUE '1'.
  5197                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5198                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5199                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5200                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5201                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5202                 88  ST-REFD-UTAH               VALUE '7'.
  5203                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5204                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5205                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5206
  5207             20  CF-ST-EARNING-CALC         PIC X.
  5208                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5209                 88  ST-EARN-BY-R78             VALUE '1'.
  5210                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5211                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5212                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5213                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5214                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5215                 88  ST-EARN-MEAN               VALUE '8'.
  5216                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5217
  5218             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5219                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5220                 88  ST-OVRD-BY-R78             VALUE '1'.
  5221                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5222                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5223                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5224                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5225                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5226                 88  ST-OVRD-MEAN               VALUE '8'.
  5227                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5228             20  FILLER                     PIC X.
  5229
  5230         16  CF-ST-COMMISSION-CAPS.
  5231             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5232             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5233             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5234             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5235         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5236                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5237
  5238         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5239
  5240         16  CF-ST-STATUTORY-INTEREST.
  5241             20  CF-ST-STAT-DATE-FROM       PIC X.
  5242                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5243                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5244             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5245             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5246             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5247             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5248             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5249
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  96
* EL131.cbl
  5250         16  CF-ST-OVER-SHORT.
  5251             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5252             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5253
  5254         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5255
  5256         16  CF-ST-RT-CALC                  PIC X.
  5257
  5258         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5259         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5260         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5261         16  CF-ST-RF-LR-CALC               PIC X.
  5262         16  CF-ST-RF-LL-CALC               PIC X.
  5263         16  CF-ST-RF-LN-CALC               PIC X.
  5264         16  CF-ST-RF-AH-CALC               PIC X.
  5265         16  CF-ST-RF-CP-CALC               PIC X.
  5266*        16  FILLER                         PIC X(206).
  5267*CIDMOD         16  FILLER                         PIC X(192).
  5268         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5269             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5270         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5271         16  CF-ST-VFY-2ND-BENE             PIC X.
  5272         16  CF-ST-CAUSAL-STATE             PIC X.
  5273         16  FILLER                         PIC X(185).
  5274
  5275****************************************************************
  5276*             BENEFIT MASTER RECORD                            *
  5277****************************************************************
  5278
  5279     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5280         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5281             20  CF-BENEFIT-CODE            PIC XX.
  5282             20  CF-BENEFIT-NUMERIC  REDEFINES
  5283                 CF-BENEFIT-CODE            PIC XX.
  5284             20  CF-BENEFIT-ALPHA           PIC XXX.
  5285             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5286             20  CF-BENEFIT-COMMENT         PIC X(10).
  5287
  5288             20  CF-LF-COVERAGE-TYPE        PIC X.
  5289                 88  CF-REDUCING                VALUE 'R'.
  5290                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5291
  5292             20  CF-SPECIAL-CALC-CD         PIC X.
  5293                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5294                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5295                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5296                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5297                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5298                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5299                 88  CF-FARM-PLAN               VALUE 'F'.
  5300                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5301                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5302                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5303                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5304                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5305                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5306                 88  CF-PRUDENTIAL              VALUE 'P'.
  5307                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  97
* EL131.cbl
  5308                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5309                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5310                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5311                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5312                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5313
  5314             20  CF-JOINT-INDICATOR         PIC X.
  5315                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5316
  5317*            20  FILLER                     PIC X(12).
  5318             20  FILLER                     PIC X(11).
  5319             20  CF-BENEFIT-CATEGORY        PIC X.
  5320             20  CF-LOAN-TYPE               PIC X(8).
  5321
  5322             20  CF-CO-REM-TERM-CALC        PIC X.
  5323                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5324                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5325                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5326                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5327                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5328
  5329             20  CF-CO-EARNINGS-CALC        PIC X.
  5330                 88  CO-EARN-BY-R78             VALUE '1'.
  5331                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5332                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5333                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5334                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5335                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5336                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5337                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5338
  5339             20  CF-CO-REFUND-CALC          PIC X.
  5340                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5341                 88  CO-REFD-BY-R78             VALUE '1'.
  5342                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5343                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5344                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5345                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5346                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5347                 88  CO-REFD-MEAN               VALUE '8'.
  5348                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5349                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5350                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5351
  5352             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5353                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5354                 88  CO-OVRD-BY-R78             VALUE '1'.
  5355                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5356                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5357                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5358                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5359                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5360                 88  CO-OVRD-MEAN               VALUE '8'.
  5361                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5362
  5363             20  CF-CO-BEN-I-G-CD           PIC X.
  5364                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5365                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  98
* EL131.cbl
  5366                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5367
  5368         16  FILLER                         PIC X(304).
  5369
  5370
  5371****************************************************************
  5372*             CARRIER MASTER RECORD                            *
  5373****************************************************************
  5374
  5375     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5376         16  CF-ADDRESS-DATA.
  5377             20  CF-MAIL-TO-NAME            PIC X(30).
  5378             20  CF-IN-CARE-OF              PIC X(30).
  5379             20  CF-ADDRESS-LINE-1          PIC X(30).
  5380             20  CF-ADDRESS-LINE-2          PIC X(30).
  5381             20  CF-CITY-STATE              PIC X(30).
  5382             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5383             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5384
  5385         16  CF-CLAIM-NO-CONTROL.
  5386             20  CF-CLAIM-NO-METHOD         PIC X.
  5387                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5388                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5389                 88  CLAIM-NO-SEQ               VALUE '3'.
  5390                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5391             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5392                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5393                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5394                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5395
  5396         16  CF-CHECK-NO-CONTROL.
  5397             20  CF-CHECK-NO-METHOD         PIC X.
  5398                 88  CHECK-NO-MANUAL            VALUE '1'.
  5399                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5400                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5401                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5402             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5403                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5404
  5405         16  CF-DOMICILE-STATE              PIC XX.
  5406
  5407         16  CF-EXPENSE-CONTROLS.
  5408             20  CF-EXPENSE-METHOD          PIC X.
  5409                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5410                 88  DOLLARS-PER-PMT            VALUE '2'.
  5411                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5412                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5413             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5414             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5415
  5416         16  CF-CORRESPONDENCE-CONTROL.
  5417             20  CF-LETTER-RESEND-OPT       PIC X.
  5418                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5419                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5420             20  FILLER                     PIC X(4).
  5421
  5422         16  CF-RESERVE-CONTROLS.
  5423             20  CF-MANUAL-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page  99
* EL131.cbl
  5424                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5425             20  CF-FUTURE-SW               PIC X.
  5426                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5427             20  CF-PTC-SW                  PIC X.
  5428                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5429             20  CF-IBNR-SW                 PIC X.
  5430                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5431             20  CF-PTC-LF-SW               PIC X.
  5432                 88  CF-LF-PTC-USED             VALUE '1'.
  5433             20  CF-CDT-ACCESS-METHOD       PIC X.
  5434                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5435                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5436                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5437             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5438
  5439         16  CF-CLAIM-CALC-METHOD           PIC X.
  5440             88  360-PLUS-MONTHS                VALUE '1'.
  5441             88  365-PLUS-MONTHS                VALUE '2'.
  5442             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5443             88  360-DAILY                      VALUE '4'.
  5444             88  365-DAILY                      VALUE '5'.
  5445
  5446         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5447         16  FILLER                         PIC X(11).
  5448
  5449         16  CF-LIMIT-AMOUNTS.
  5450             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5451             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5452             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5453             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5454             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5455             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5456             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5457             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5458             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5459             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5460
  5461         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5462         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5463         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5464
  5465         16  CF-ZIP-CODE.
  5466             20  CF-ZIP-PRIME.
  5467                 24  CF-ZIP-1ST             PIC X.
  5468                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5469                 24  FILLER                 PIC X(4).
  5470             20  CF-ZIP-PLUS4               PIC X(4).
  5471         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5472             20  CF-CAN-POSTAL-1            PIC XXX.
  5473             20  CF-CAN-POSTAL-2            PIC XXX.
  5474             20  FILLER                     PIC XXX.
  5475
  5476         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5477         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5478         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5479
  5480         16  CF-RATING-SWITCH               PIC X.
  5481             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 100
* EL131.cbl
  5482             88  CF-NO-RATING                   VALUE 'N'.
  5483
  5484         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5485
  5486         16  CF-CARRIER-OVER-SHORT.
  5487             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5488             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5489
  5490         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5491         16  CF-SECPAY-SWITCH               PIC X.
  5492             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5493             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5494         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5495         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5496         16  FILLER                         PIC X(444).
  5497*        16  FILLER                         PIC X(452).
  5498
  5499
  5500****************************************************************
  5501*             MORTALITY MASTER RECORD                          *
  5502****************************************************************
  5503
  5504     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5505         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5506                                INDEXED BY CF-MORT-NDX.
  5507             20  CF-MORT-TABLE              PIC X(5).
  5508             20  CF-MORT-TABLE-TYPE         PIC X.
  5509                 88  CF-MORT-JOINT              VALUE 'J'.
  5510                 88  CF-MORT-SINGLE             VALUE 'S'.
  5511                 88  CF-MORT-COMBINED           VALUE 'C'.
  5512                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5513                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5514             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5515             20  CF-MORT-AGE-METHOD         PIC XX.
  5516                 88  CF-AGE-LAST                VALUE 'AL'.
  5517                 88  CF-AGE-NEAR                VALUE 'AN'.
  5518             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5519             20  CF-MORT-ADJUSTMENT-DIRECTION
  5520                                            PIC X.
  5521                 88  CF-MINUS                   VALUE '-'.
  5522                 88  CF-PLUS                    VALUE '+'.
  5523             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5524             20  CF-MORT-JOINT-CODE         PIC X.
  5525                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5526             20  CF-MORT-PC-Q               PIC X.
  5527                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5528             20  CF-MORT-TABLE-CODE         PIC X(4).
  5529             20  CF-MORT-COMMENTS           PIC X(15).
  5530             20  FILLER                     PIC X(14).
  5531
  5532         16  FILLER                         PIC X(251).
  5533
  5534
  5535****************************************************************
  5536*             BUSSINESS TYPE MASTER RECORD                     *
  5537****************************************************************
  5538
  5539     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 101
* EL131.cbl
  5540* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5541* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5542* AND RECORD 05 IS TYPES 81-99
  5543         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5544             20  CF-BUSINESS-TITLE          PIC  X(19).
  5545             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5546                                            PIC S9V9(4) COMP-3.
  5547             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5548             20  FILLER                     PIC  X.
  5549         16  FILLER                         PIC  X(248).
  5550
  5551
  5552****************************************************************
  5553*             TERMINAL MASTER RECORD                           *
  5554****************************************************************
  5555
  5556     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5557
  5558         16  CF-COMPANY-TERMINALS.
  5559             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5560                                  PIC X(4).
  5561         16  FILLER               PIC X(248).
  5562
  5563
  5564****************************************************************
  5565*             LIFE EDIT MASTER RECORD                          *
  5566****************************************************************
  5567
  5568     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5569         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5570             20  CF-LIFE-CODE-IN            PIC XX.
  5571             20  CF-LIFE-CODE-OUT           PIC XX.
  5572         16  FILLER                         PIC X(248).
  5573
  5574
  5575****************************************************************
  5576*             AH EDIT MASTER RECORD                            *
  5577****************************************************************
  5578
  5579     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5580         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5581             20  CF-AH-CODE-IN              PIC XXX.
  5582             20  CF-AH-CODE-OUT             PIC XX.
  5583         16  FILLER                         PIC X(248).
  5584
  5585
  5586****************************************************************
  5587*             CREDIBILITY TABLES                               *
  5588****************************************************************
  5589
  5590     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5591         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5592                             INDEXED BY CF-CRDB-NDX.
  5593             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5594             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5595             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5596         16  FILLER                         PIC  X(332).
  5597
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 102
* EL131.cbl
  5598
  5599****************************************************************
  5600*             REPORT CUSTOMIZATION RECORD                      *
  5601****************************************************************
  5602
  5603     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5604         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5605             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5606             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5607             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5608**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5609****       A T-TRANSFER.                                   ****
  5610             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5611
  5612         16  FILLER                         PIC XX.
  5613
  5614         16  CF-CARRIER-CNTL-OPT.
  5615             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5616                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5617                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5618             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5619                                            PIC X.
  5620         16  CF-GROUP-CNTL-OPT.
  5621             20  CF-GROUP-OPT-SEQ           PIC 9.
  5622                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5623                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5624             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5625                                            PIC X(6).
  5626         16  CF-STATE-CNTL-OPT.
  5627             20  CF-STATE-OPT-SEQ           PIC 9.
  5628                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5629                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5630             20  CF-STATE-SELECT OCCURS 3 TIMES
  5631                                            PIC XX.
  5632         16  CF-ACCOUNT-CNTL-OPT.
  5633             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5634                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5635                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5636             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5637                                            PIC X(10).
  5638         16  CF-BUS-TYP-CNTL-OPT.
  5639             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5640                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5641                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5642             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5643                                            PIC XX.
  5644         16  CF-LF-TYP-CNTL-OPT.
  5645             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5646                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5647                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5648             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5649                                            PIC XX.
  5650         16  CF-AH-TYP-CNTL-OPT.
  5651             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5652                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5653                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5654             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5655                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 103
* EL131.cbl
  5656         16  CF-REPTCD1-CNTL-OPT.
  5657             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5658                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5659                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5660             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5661                                            PIC X(10).
  5662         16  CF-REPTCD2-CNTL-OPT.
  5663             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5664                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5665                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5666             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5667                                            PIC X(10).
  5668         16  CF-USER1-CNTL-OPT.
  5669             20  CF-USER1-OPT-SEQ           PIC 9.
  5670                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5671                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5672             20  CF-USER1-SELECT OCCURS 3 TIMES
  5673                                            PIC X(10).
  5674         16  CF-USER2-CNTL-OPT.
  5675             20  CF-USER2-OPT-SEQ           PIC 9.
  5676                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5677                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5678             20  CF-USER2-SELECT OCCURS 3 TIMES
  5679                                            PIC X(10).
  5680         16  CF-USER3-CNTL-OPT.
  5681             20  CF-USER3-OPT-SEQ           PIC 9.
  5682                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5683                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5684             20  CF-USER3-SELECT OCCURS 3 TIMES
  5685                                            PIC X(10).
  5686         16  CF-USER4-CNTL-OPT.
  5687             20  CF-USER4-OPT-SEQ           PIC 9.
  5688                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5689                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5690             20  CF-USER4-SELECT OCCURS 3 TIMES
  5691                                            PIC X(10).
  5692         16  CF-USER5-CNTL-OPT.
  5693             20  CF-USER5-OPT-SEQ           PIC 9.
  5694                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5695                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5696             20  CF-USER5-SELECT OCCURS 3 TIMES
  5697                                            PIC X(10).
  5698         16  CF-REINS-CNTL-OPT.
  5699             20  CF-REINS-OPT-SEQ           PIC 9.
  5700                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5701                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5702             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5703                 24  CF-REINS-PRIME         PIC XXX.
  5704                 24  CF-REINS-SUB           PIC XXX.
  5705
  5706         16  CF-AGENT-CNTL-OPT.
  5707             20  CF-AGENT-OPT-SEQ           PIC 9.
  5708                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5709                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5710             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5711                                            PIC X(10).
  5712
  5713         16  FILLER                         PIC X(43).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 104
* EL131.cbl
  5714
  5715         16  CF-LOSS-RATIO-SELECT.
  5716             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5717             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5718         16  CF-ENTRY-DATE-SELECT.
  5719             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5720             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5721         16  CF-EFFECTIVE-DATE-SELECT.
  5722             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5723             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5724
  5725         16  CF-EXCEPTION-LIST-IND          PIC X.
  5726             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5727
  5728         16  FILLER                         PIC X(318).
  5729
  5730****************************************************************
  5731*                  EXCEPTION REPORTING RECORD                  *
  5732****************************************************************
  5733
  5734     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5735         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5736             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5737
  5738         16  CF-COMBINED-LIFE-AH-OPT.
  5739             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5740             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5741             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5742             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5743
  5744         16  CF-LIFE-OPT.
  5745             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5746             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5747             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5748             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5749             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5750             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5751             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5752             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5753             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5754             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5755
  5756         16  CF-AH-OPT.
  5757             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5758             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5759             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5760             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5761             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5762             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5763             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5764             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5765             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5766             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5767
  5768         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5769             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5770             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5771             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 105
* EL131.cbl
  5772
  5773         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5774
  5775         16  FILLER                         PIC X(673).
  5776
  5777
  5778****************************************************************
  5779*             MORTGAGE SYSTEM PLAN RECORD                      *
  5780****************************************************************
  5781
  5782     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5783         16  CF-PLAN-TYPE                   PIC X.
  5784             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5785             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5786             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5787         16  CF-PLAN-ABBREV                 PIC XXX.
  5788         16  CF-PLAN-DESCRIPT               PIC X(10).
  5789         16  CF-PLAN-NOTES                  PIC X(20).
  5790         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5791         16  CF-PLAN-UNDERWRITING.
  5792             20  CF-PLAN-TERM-DATA.
  5793                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5794                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5795             20  CF-PLAN-AGE-DATA.
  5796                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5797                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5798                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5799             20  CF-PLAN-BENEFIT-DATA.
  5800                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5801                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5802                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5803                                            PIC S9(7)V99  COMP-3.
  5804         16  CF-PLAN-POLICY-FORMS.
  5805             20  CF-POLICY-FORM             PIC X(12).
  5806             20  CF-MASTER-APPLICATION      PIC X(12).
  5807             20  CF-MASTER-POLICY           PIC X(12).
  5808         16  CF-PLAN-RATING.
  5809             20  CF-RATE-CODE               PIC X(5).
  5810             20  CF-SEX-RATING              PIC X.
  5811                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5812                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5813             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5814             20  CF-SUB-STD-TYPE            PIC X.
  5815                 88  CF-PCT-OF-PREM            VALUE '1'.
  5816                 88  CF-PCT-OF-BENE            VALUE '2'.
  5817         16  CF-PLAN-PREM-TOLERANCES.
  5818             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5819             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5820         16  CF-PLAN-PYMT-TOLERANCES.
  5821             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5822             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5823         16  CF-PLAN-MISC-DATA.
  5824             20  FILLER                     PIC X.
  5825             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5826             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5827         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5828         16  CF-PLAN-IND-GRP                PIC X.
  5829             88  CF-MORT-INDIV-PLAN            VALUE 'I'
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 106
* EL131.cbl
  5830                                                     '1'.
  5831             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5832                                                     '2'.
  5833         16  CF-MIB-SEARCH-SW               PIC X.
  5834             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5835             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5836             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5837             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5838         16  CF-ALPHA-SEARCH-SW             PIC X.
  5839             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5840             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5841             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5842             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5843             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5844             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5845             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5846             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5847             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5848             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5849                                                     'A' 'B' 'C'
  5850                                                     'X' 'Y' 'Z'.
  5851         16  CF-EFF-DT-RULE-SW              PIC X.
  5852             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5853             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5854             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5855             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5856             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5857         16  FILLER                         PIC X(4).
  5858         16  CF-HEALTH-QUESTIONS            PIC X.
  5859             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5860         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5861         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5862         16  CF-PLAN-SNGL-JNT               PIC X.
  5863             88  CF-COMBINED-PLAN              VALUE 'C'.
  5864             88  CF-JNT-PLAN                   VALUE 'J'.
  5865             88  CF-SNGL-PLAN                  VALUE 'S'.
  5866         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5867         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5868         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5869         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5870         16  CF-RERATE-CNTL                 PIC  X.
  5871             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5872             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5873             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5874             88  CF-AUTO-RECALC                 VALUE '4'.
  5875         16  CF-BENEFIT-TYPE                PIC  X.
  5876             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5877             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5878         16  CF-POLICY-FEE                  PIC S999V99
  5879                                                    COMP-3.
  5880         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5881         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5882         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5883         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5884         16  FILLER                         PIC  X(32).
  5885         16  CF-TERMINATION-FORM            PIC  X(04).
  5886         16  FILLER                         PIC  X(08).
  5887         16  CF-CLAIM-CAP                   PIC S9(7)V99
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 107
* EL131.cbl
  5888                                                       COMP-3.
  5889         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5890         16  CF-ISSUE-LETTER                PIC  X(4).
  5891         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5892         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5893             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5894             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5895         16  CF-MP-REFUND-CALC              PIC X.
  5896             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5897             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5898             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5899             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5900             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5901             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5902             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5903             88  CF-MP-REFD-MEAN                VALUE '8'.
  5904         16  CF-ALT-RATE-CODE               PIC  X(5).
  5905
  5906
  5907         16  FILLER                         PIC X(498).
  5908****************************************************************
  5909*             MORTGAGE COMPANY MASTER RECORD                   *
  5910****************************************************************
  5911
  5912     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5913         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5914         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5915             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5916             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5917             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5918             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5919             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5920
  5921         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5922         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5923         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5924         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5925         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5926
  5927         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5928             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5929         16  CF-MP-RECON-USE-IND            PIC X(1).
  5930             88  CF-MP-USE-RECON             VALUE 'Y'.
  5931         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5932             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5933         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5934             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5935             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5936         16  FILLER                         PIC X(1).
  5937         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5938             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5939         16  CF-MORTG-MIB-VERSION           PIC X.
  5940             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5941             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5942             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5943         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5944             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5945                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 108
* EL131.cbl
  5946             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5947                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5948             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5949                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5950             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5951                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5952             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5953                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5954             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5955                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5956         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5957         16  FILLER                         PIC X(7).
  5958         16  CF-MORTG-DESTINATION-SYMBOL.
  5959             20  CF-MORTG-MIB-COMM          PIC X(5).
  5960             20  CF-MORTG-MIB-TERM          PIC X(5).
  5961         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5962             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5963         16  FILLER                         PIC X(03).
  5964         16  CF-MP-CHECK-NO-CONTROL.
  5965             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5966                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5967                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5968                                                ' ' LOW-VALUES.
  5969                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5970                                               VALUE '3'.
  5971         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5972         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5973         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5974             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5975                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5976             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5977                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5978             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5979                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5980             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5981                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5982             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5983                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5984             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5985                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5986         16  CF-MORTG-BILLING-AREA.
  5987             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5988                                            PIC X.
  5989         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5990         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5991         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5992         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5993             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5994             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5995         16  FILLER                         PIC X.
  5996         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5997             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5998             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5999         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6000         16  FILLER                         PIC X(8).
  6001         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6002         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6003         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 109
* EL131.cbl
  6004         16  CF-ACH-COMPANY-ID.
  6005             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6006                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6007                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6008                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6009             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6010         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6011             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6012         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6013             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6014             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6015         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6016         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6017         16  FILLER                         PIC X(536).
  6018
  6019****************************************************************
  6020*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6021****************************************************************
  6022
  6023     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6024         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6025             20  CF-FEMALE-HEIGHT.
  6026                 24  CF-FEMALE-FT           PIC 99.
  6027                 24  CF-FEMALE-IN           PIC 99.
  6028             20  CF-FEMALE-MIN-WT           PIC 999.
  6029             20  CF-FEMALE-MAX-WT           PIC 999.
  6030         16  FILLER                         PIC X(428).
  6031
  6032     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6033         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6034             20  CF-MALE-HEIGHT.
  6035                 24  CF-MALE-FT             PIC 99.
  6036                 24  CF-MALE-IN             PIC 99.
  6037             20  CF-MALE-MIN-WT             PIC 999.
  6038             20  CF-MALE-MAX-WT             PIC 999.
  6039         16  FILLER                         PIC X(428).
  6040******************************************************************
  6041*             AUTOMATIC ACTIVITY RECORD                          *
  6042******************************************************************
  6043     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6044         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6045             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6046             20  CF-SYS-LETTER-ID           PIC X(04).
  6047             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6048             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6049             20  CF-SYS-RESET-SW            PIC X(01).
  6050             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6051             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6052
  6053         16  FILLER                         PIC X(50).
  6054
  6055         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6056             20  CF-USER-ACTIVE-SW          PIC X(01).
  6057             20  CF-USER-LETTER-ID          PIC X(04).
  6058             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6059             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6060             20  CF-USER-RESET-SW           PIC X(01).
  6061             20  CF-USER-REPORT-DAYS        PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 110
* EL131.cbl
  6062             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6063             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6064
  6065         16  FILLER                         PIC X(246).
  6066
  6067*                                COPY ELCACTQ.
  6068******************************************************************
  6069*                                                                *
  6070*                            ELCACTQ.                            *
  6071*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6072*                            VMOD=2.004                          *
  6073*                                                                *
  6074*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6075*                                                                *
  6076*   FILE TYPE = VSAM,KSDS                                        *
  6077*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6078*                                                                *
  6079*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6080*       ALTERNATE INDEX = NONE                                   *
  6081*                                                                *
  6082*   LOG = YES                                                    *
  6083*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6084*                                                                *
  6085*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6086******************************************************************
  6087
  6088 01  ACTIVITY-QUE.
  6089     12  AQ-RECORD-ID                PIC XX.
  6090         88  VALID-AQ-ID                VALUE 'AQ'.
  6091
  6092     12  AQ-CONTROL-PRIMARY.
  6093         16  AQ-COMPANY-CD           PIC X.
  6094         16  AQ-CARRIER              PIC X.
  6095         16  AQ-CLAIM-NO             PIC X(7).
  6096         16  AQ-CERT-NO.
  6097             20  AQ-CERT-PRIME       PIC X(10).
  6098             20  AQ-CERT-SFX         PIC X.
  6099
  6100     12  AQ-PENDING-ACTIVITY-FLAGS.
  6101         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6102         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6103             88  PENDING-PAYMENTS       VALUE '1'.
  6104         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6105             88  PENDING-FULL-PRINT     VALUE '1'.
  6106             88  PENDING-PART-PRINT     VALUE '2'.
  6107         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6108             88  PENDING-LETTERS        VALUE '1'.
  6109         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6110             88  PENDING-RESTORE        VALUE 'C'.
  6111             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6112
  6113     12  FILLER                      PIC X(20).
  6114
  6115     12  AQ-RESEND-DATE              PIC XX.
  6116     12  AQ-FOLLOWUP-DATE            PIC XX.
  6117     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6118     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6119     12  AQ-AUTO-LETTER              PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 111
* EL131.cbl
  6120     12  FILLER                      PIC XX.
  6121     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6122*****************************************************************
  6123
  6124*                                COPY ERCACCT.
  6125******************************************************************
  6126*                                                                *
  6127*                                                                *
  6128*                            ERCACCT                             *
  6129*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6130*                            VMOD=2.031                          *
  6131*                                                                *
  6132*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6133*                                                                *
  6134*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6135*   VSAM ACCOUNT MASTER FILES.                                   *
  6136*                                                                *
  6137*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6138*                                                                *
  6139*   FILE TYPE = VSAM,KSDS                                        *
  6140*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6141*                                                                *
  6142*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6143*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6144*                                                                *
  6145*   LOG = NO                                                     *
  6146*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6147*                                                                *
  6148*                                                                *
  6149******************************************************************
  6150*                   C H A N G E   L O G
  6151*
  6152* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6153*-----------------------------------------------------------------
  6154*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6155* EFFECTIVE    NUMBER
  6156*-----------------------------------------------------------------
  6157* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6158* 092705    2005050300006  PEMA  ADD SPP LEASES
  6159* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6160* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6161* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6162* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6163* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6164******************************************************************
  6165
  6166 01  ACCOUNT-MASTER.
  6167     12  AM-RECORD-ID                      PIC XX.
  6168         88  VALID-AM-ID                      VALUE 'AM'.
  6169
  6170     12  AM-CONTROL-PRIMARY.
  6171         16  AM-COMPANY-CD                 PIC X.
  6172         16  AM-MSTR-CNTRL.
  6173             20  AM-CONTROL-A.
  6174                 24  AM-CARRIER            PIC X.
  6175                 24  AM-GROUPING.
  6176                     28 AM-GROUPING-PREFIX PIC XXX.
  6177                     28 AM-GROUPING-PRIME  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 112
* EL131.cbl
  6178                 24  AM-STATE              PIC XX.
  6179                 24  AM-ACCOUNT.
  6180                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6181                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6182             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6183                                           PIC X(19).
  6184             20  AM-CNTRL-B.
  6185                 24  AM-EXPIRATION-DT      PIC XX.
  6186                 24  FILLER                PIC X(4).
  6187             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6188                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6189
  6190     12  AM-CONTROL-BY-VAR-GRP.
  6191         16  AM-COMPANY-CD-A1              PIC X.
  6192         16  AM-VG-CARRIER                 PIC X.
  6193         16  AM-VG-GROUPING                PIC X(6).
  6194         16  AM-VG-STATE                   PIC XX.
  6195         16  AM-VG-ACCOUNT                 PIC X(10).
  6196         16  AM-VG-DATE.
  6197             20  AM-VG-EXPIRATION-DT       PIC XX.
  6198             20  FILLER                    PIC X(4).
  6199         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6200                                           PIC 9(11)      COMP-3.
  6201     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6202         16  FILLER                        PIC X(10).
  6203         16  AM-VG-KEY3.
  6204             20  AM-VG3-ACCOUNT            PIC X(10).
  6205             20  AM-VG3-EXP-DT             PIC XX.
  6206         16  FILLER                        PIC X(4).
  6207     12  AM-MAINT-INFORMATION.
  6208         16  AM-LAST-MAINT-DT              PIC XX.
  6209         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6210         16  AM-LAST-MAINT-USER            PIC X(4).
  6211         16  FILLER                        PIC XX.
  6212
  6213     12  AM-EFFECTIVE-DT                   PIC XX.
  6214     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6215
  6216     12  AM-PREV-DATES  COMP-3.
  6217         16  AM-PREV-EXP-DT                PIC 9(11).
  6218         16  AM-PREV-EFF-DT                PIC 9(11).
  6219
  6220     12  AM-REPORT-CODE-1                  PIC X(10).
  6221     12  AM-REPORT-CODE-2                  PIC X(10).
  6222
  6223     12  AM-CITY-CODE                      PIC X(4).
  6224     12  AM-COUNTY-PARISH                  PIC X(6).
  6225
  6226     12  AM-NAME                           PIC X(30).
  6227     12  AM-PERSON                         PIC X(30).
  6228     12  AM-ADDRS                          PIC X(30).
  6229     12  AM-CITY.
  6230         16  AM-ADDR-CITY                  PIC X(28).
  6231         16  AM-ADDR-STATE                 PIC XX.
  6232     12  AM-ZIP.
  6233         16  AM-ZIP-PRIME.
  6234             20  AM-ZIP-PRI-1ST            PIC X.
  6235                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 113
* EL131.cbl
  6236             20  FILLER                    PIC X(4).
  6237         16  AM-ZIP-PLUS4                  PIC X(4).
  6238     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6239         16  AM-CAN-POSTAL-1               PIC XXX.
  6240         16  AM-CAN-POSTAL-2               PIC XXX.
  6241         16  FILLER                        PIC XXX.
  6242     12  AM-TEL-NO.
  6243         16  AM-AREA-CODE                  PIC 999.
  6244         16  AM-TEL-PRE                    PIC 999.
  6245         16  AM-TEL-NBR                    PIC 9(4).
  6246     12  AM-TEL-LOC                        PIC X.
  6247         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6248         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6249
  6250     12  AM-COMM-STRUCTURE.
  6251         16  AM-DEFN-1.
  6252             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6253                 24  AM-AGT.
  6254                     28  AM-AGT-PREFIX     PIC X(4).
  6255                     28  AM-AGT-PRIME      PIC X(6).
  6256                 24  AM-COM-TYP            PIC X.
  6257                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6258                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6259                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6260                 24  AM-RECALC-LV-INDIC    PIC X.
  6261                 24  AM-RETRO-LV-INDIC     PIC X.
  6262                 24  AM-GL-CODES           PIC X.
  6263                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6264                 24  FILLER                PIC X(01).
  6265         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6266             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6267                 24  FILLER                PIC X(11).
  6268                 24  AM-L-COMA             PIC XXX.
  6269                 24  AM-J-COMA             PIC XXX.
  6270                 24  AM-A-COMA             PIC XXX.
  6271                 24  FILLER                PIC X(6).
  6272
  6273     12  AM-COMM-CHANGE-STATUS             PIC X.
  6274         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6275
  6276     12  AM-CSR-CODE                       PIC X(4).
  6277
  6278     12  AM-BILLING-STATUS                 PIC X.
  6279         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6280         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6281     12  AM-AUTO-REFUND-SW                 PIC X.
  6282         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6283         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6284     12  AM-GPCD                           PIC 99.
  6285     12  AM-IG                             PIC X.
  6286         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6287         88  AM-HAS-GROUP                     VALUE '2'.
  6288     12  AM-STATUS                         PIC X.
  6289         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6290         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6291         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6292         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6293         88  AM-ACCOUNT-FROZEN                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 114
* EL131.cbl
  6294         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6295     12  AM-REMIT-TO                       PIC 99.
  6296     12  AM-ID-NO                          PIC X(11).
  6297
  6298     12  AM-CAL-TABLE                      PIC XX.
  6299     12  AM-LF-DEVIATION                   PIC XXX.
  6300     12  AM-AH-DEVIATION                   PIC XXX.
  6301     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6302     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6303     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6304     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6305     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6306     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6307
  6308     12  AM-USER-FIELDS.
  6309         16  AM-FLD-1                      PIC XX.
  6310         16  AM-FLD-2                      PIC XX.
  6311         16  AM-FLD-3                      PIC XX.
  6312         16  AM-FLD-4                      PIC XX.
  6313         16  AM-FLD-5                      PIC XX.
  6314
  6315     12  AM-1ST-PROD-DATE.
  6316         16  AM-1ST-PROD-YR                PIC XX.
  6317         16  AM-1ST-PROD-MO                PIC XX.
  6318         16  AM-1ST-PROD-DA                PIC XX.
  6319     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6320     12  AM-CERTS-PURGED-DATE.
  6321         16  AM-PUR-YR                     PIC XX.
  6322         16  AM-PUR-MO                     PIC XX.
  6323         16  AM-PUR-DA                     PIC XX.
  6324     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6325     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6326     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6327     12  AM-INACTIVE-DATE.
  6328         16  AM-INA-MO                     PIC 99.
  6329         16  AM-INA-DA                     PIC 99.
  6330         16  AM-INA-YR                     PIC 99.
  6331     12  AM-AR-HI-CERT-DATE                PIC XX.
  6332
  6333     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6334     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6335
  6336     12  AM-OB-PAYMENT-MODE                PIC X.
  6337         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6338         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6339         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6340         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6341
  6342     12  AM-AH-ONLY-INDICATOR              PIC X.
  6343         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6344         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6345
  6346     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6347
  6348     12  AM-OVER-SHORT.
  6349         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6350         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6351
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 115
* EL131.cbl
  6352     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6353     12  AM-DCC-CLP-STATE                  PIC XX.
  6354
  6355     12  AM-RECALC-COMM                    PIC X.
  6356     12  AM-RECALC-REIN                    PIC X.
  6357
  6358     12  AM-REI-TABLE                      PIC XXX.
  6359     12  AM-REI-ET-LF                      PIC X.
  6360     12  AM-REI-ET-AH                      PIC X.
  6361     12  AM-REI-PE-LF                      PIC X.
  6362     12  AM-REI-PE-AH                      PIC X.
  6363     12  AM-REI-PRT-ST                     PIC X.
  6364     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6365     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6366     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6367     12  AM-REI-GROUP-A                    PIC X(6).
  6368     12  AM-REI-MORT                       PIC X(4).
  6369     12  AM-REI-PRT-OW                     PIC X.
  6370     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6371     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6372     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6373     12  AM-REI-GROUP-B                    PIC X(6).
  6374
  6375     12  AM-TRUST-TYPE                     PIC X(2).
  6376
  6377     12  AM-EMPLOYER-STMT-USED             PIC X.
  6378     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6379
  6380     12  AM-STD-AH-TYPE                    PIC XX.
  6381     12  AM-EARN-METHODS.
  6382         16  AM-EARN-METHOD-R              PIC X.
  6383             88 AM-REF-RL-R78                 VALUE 'R'.
  6384             88 AM-REF-RL-PR                  VALUE 'P'.
  6385             88 AM-REF-RL-MEAN                VALUE 'M'.
  6386             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6387         16  AM-EARN-METHOD-L              PIC X.
  6388             88 AM-REF-LL-R78                 VALUE 'R'.
  6389             88 AM-REF-LL-PR                  VALUE 'P'.
  6390             88 AM-REF-LL-MEAN                VALUE 'M'.
  6391             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6392         16  AM-EARN-METHOD-A              PIC X.
  6393             88 AM-REF-AH-R78                 VALUE 'R'.
  6394             88 AM-REF-AH-PR                  VALUE 'P'.
  6395             88 AM-REF-AH-MEAN                VALUE 'M'.
  6396             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6397             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6398             88 AM-REF-AH-NET                 VALUE 'N'.
  6399
  6400     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6401     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6402     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6403
  6404     12  AM-RET-Y-N                        PIC X.
  6405     12  AM-RET-P-E                        PIC X.
  6406     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6407     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6408     12  AM-RET-GRP                        PIC X(6).
  6409     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 116
* EL131.cbl
  6410         16  AM-POOL-PRIME                 PIC XXX.
  6411         16  AM-POOL-SUB                   PIC XXX.
  6412     12  AM-RETRO-EARNINGS.
  6413         16  AM-RET-EARN-R                 PIC X.
  6414         16  AM-RET-EARN-L                 PIC X.
  6415         16  AM-RET-EARN-A                 PIC X.
  6416     12  AM-RET-ST-TAX-USE                 PIC X.
  6417         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6418         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6419     12  AM-RETRO-BEG-EARNINGS.
  6420         16  AM-RET-BEG-EARN-R             PIC X.
  6421         16  AM-RET-BEG-EARN-L             PIC X.
  6422         16  AM-RET-BEG-EARN-A             PIC X.
  6423     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6424     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6425
  6426     12  AM-USER-SELECT-OPTIONS.
  6427         16  AM-USER-SELECT-1              PIC X(10).
  6428         16  AM-USER-SELECT-2              PIC X(10).
  6429         16  AM-USER-SELECT-3              PIC X(10).
  6430         16  AM-USER-SELECT-4              PIC X(10).
  6431         16  AM-USER-SELECT-5              PIC X(10).
  6432
  6433     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6434
  6435     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6436
  6437     12  AM-RPT045A-SWITCH                 PIC X.
  6438         88  RPT045A-OFF                   VALUE 'N'.
  6439
  6440     12  AM-INSURANCE-LIMITS.
  6441         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6442         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6443
  6444     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6445         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6446
  6447     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6448         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6449         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6450
  6451     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6452
  6453     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6454     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6455     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6456     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6457     12  AM-DCC-UEF-STATE                  PIC XX.
  6458     12  FILLER                            PIC XXX.
  6459     12  AM-REPORT-CODE-3                  PIC X(10).
  6460*    12  FILLER                            PIC X(22).
  6461
  6462     12  AM-RESERVE-DATE.
  6463         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6464         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6465         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6466
  6467     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 117
* EL131.cbl
  6468     12  AM-NOTIFICATION-TYPES.
  6469         16  AM-NOTIF-OF-LETTERS           PIC X.
  6470         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6471         16  AM-NOTIF-OF-REPORTS           PIC X.
  6472         16  AM-NOTIF-OF-STATUS            PIC X.
  6473
  6474     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6475         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6476         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6477         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6478         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6479
  6480     12  AM-BENEFIT-CONTROLS.
  6481         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6482             20  AM-BENEFIT-CODE           PIC XX.
  6483             20  AM-BENEFIT-TYPE           PIC X.
  6484             20  AM-BENEFIT-REVISION       PIC XXX.
  6485             20  AM-BENEFIT-REM-TERM       PIC X.
  6486             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6487             20  FILLER                    PIC XX.
  6488         16  FILLER                        PIC X(80).
  6489
  6490     12  AM-TRANSFER-DATA.
  6491         16  AM-TRANSFERRED-FROM.
  6492             20  AM-TRNFROM-CARRIER        PIC X.
  6493             20  AM-TRNFROM-GROUPING.
  6494                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6495                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6496             20  AM-TRNFROM-STATE          PIC XX.
  6497             20  AM-TRNFROM-ACCOUNT.
  6498                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6499                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6500             20  AM-TRNFROM-DTE            PIC XX.
  6501         16  AM-TRANSFERRED-TO.
  6502             20  AM-TRNTO-CARRIER          PIC X.
  6503             20  AM-TRNTO-GROUPING.
  6504                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6505                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6506             20  AM-TRNTO-STATE            PIC XX.
  6507             20  AM-TRNTO-ACCOUNT.
  6508                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6509                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6510             20  AM-TRNTO-DTE              PIC XX.
  6511         16  FILLER                        PIC X(10).
  6512
  6513     12  AM-SAVED-REMIT-TO                 PIC 99.
  6514
  6515     12  AM-COMM-STRUCTURE-SAVED.
  6516         16  AM-DEFN-1-SAVED.
  6517             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6518                 24  AM-AGT-SV             PIC X(10).
  6519                 24  AM-COM-TYP-SV         PIC X.
  6520                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6521                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6522                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6523                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6524                 24  FILLER                PIC X.
  6525                 24  AM-GL-CODES-SV        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 118
* EL131.cbl
  6526                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6527                 24  FILLER                PIC X.
  6528         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6529             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6530                 24  FILLER                PIC X(11).
  6531                 24  AM-L-COMA-SV          PIC XXX.
  6532                 24  AM-J-COMA-SV          PIC XXX.
  6533                 24  AM-A-COMA-SV          PIC XXX.
  6534                 24  FILLER                PIC X(6).
  6535
  6536     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6537         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6538            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6539            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6540            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6541
  6542     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6543     12  FILLER                            PIC X(120).
  6544
  6545     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6546         16  AM-CONTROL-NAME               PIC X(30).
  6547         16  AM-EXECUTIVE-ONE.
  6548             20  AM-EXEC1-NAME             PIC X(15).
  6549             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6550                                                          COMP-3.
  6551             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6552                                                          COMP-3.
  6553         16  AM-EXECUTIVE-TWO.
  6554             20  AM-EXEC2-NAME             PIC X(15).
  6555             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6556                                                          COMP-3.
  6557             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6558                                                          COMP-3.
  6559
  6560     12  AM-RETRO-ADDITIONAL-DATA.
  6561         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6562         16  AM-RETRO-PREM-P-E             PIC X.
  6563         16  AM-RETRO-CLMS-P-I             PIC X.
  6564         16  AM-RETRO-RET-BRACKET-LF.
  6565             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6566                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6567                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6568             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6569                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6570                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6571             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6572                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6573                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6574         16  AM-RETRO-RET-BRACKET-AH.
  6575             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6576                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6577                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6578                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6579             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6580                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6581                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6582             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6583                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 119
* EL131.cbl
  6584                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6585
  6586     12  AM-COMMENTS.
  6587         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6588
  6589     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6590         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6591         16  AM-FLI-BILLING-CODE           PIC X.
  6592         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6593         16  AM-FLI-UNITED-IDENT           PIC X.
  6594         16  AM-FLI-INTEREST-LOST-DATA.
  6595             20  AM-FLI-BANK-NO            PIC X(5).
  6596             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6597             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6598             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6599         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6600             20  AM-FLI-AGT                PIC X(9).
  6601             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6602             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6603         16  FILLER                        PIC X(102).
  6604
  6605     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6606         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6607             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6608             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6609             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6610             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6611             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6612         16  FILLER                          PIC X(10).
  6613******************************************************************
  6614
  6615*                                COPY ELCCHKQ.
  6616******************************************************************
  6617*                                                                *
  6618*                                                                *
  6619*                            ELCCHKQ.                            *
  6620*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6621*                            VMOD=2.007                          *
  6622*                                                                *
  6623*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6624*                                                                *
  6625*   FILE TYPE = VSAM,KSDS                                        *
  6626*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6627*                                                                *
  6628*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6629*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6630*                                                                *
  6631*   LOG = YES                                                    *
  6632*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6633******************************************************************
  6634 01  CHECK-QUE.
  6635     12  CQ-RECORD-ID                PIC XX.
  6636         88  VALID-CQ-ID         VALUE 'CQ'.
  6637
  6638     12  CQ-CONTROL-PRIMARY.
  6639         16  CQ-COMPANY-CD           PIC X.
  6640         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6641         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 120
* EL131.cbl
  6642
  6643     12  CQ-CONTROL-BY-PAYEE.
  6644         16  CQ-CONTROL-BY-NUMBER.
  6645             20  CQ-COMPANY-CD-A1     PIC X.
  6646             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6647         16  CQ-PAYEE-CARRIER        PIC X.
  6648         16  CQ-PAYEE-GROUPING       PIC X(6).
  6649         16  CQ-PAYEE-STATE          PIC XX.
  6650         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6651         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6652
  6653     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6654         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6655         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6656         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6657         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6658         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6659         16  FILLER                  PIC X(3).
  6660
  6661     12  CQ-ENTRY-TYPE               PIC X.
  6662             88  CHECK-ON-QUE           VALUE 'Q'.
  6663             88  ALIGNMENT-CHECK        VALUE 'A'.
  6664             88  SPOILED-CHECK          VALUE 'S'.
  6665             88  PAYMENT-ABORTED        VALUE 'X'.
  6666
  6667     12  CQ-CLAIM-MAST-CNTL.
  6668         16  CQ-CARRIER              PIC X.
  6669         16  CQ-CLAIM-NO             PIC X(7).
  6670         16  CQ-CERT-NO.
  6671             20  CQ-CERT-PRIME       PIC X(10).
  6672             20  CQ-CERT-SFX         PIC X.
  6673         16  CQ-CLAIM-TYPE           PIC X.
  6674             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6675             88  CQ-AH-CLAIM            VALUE 'A'.
  6676         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6677             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6678             88  CQ-O-B-COVERAGE        VALUE '2'.
  6679             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6680
  6681     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6682     12  CQ-CHECK-NUMBER             PIC X(7).
  6683     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6684     12  CQ-PAYMENT-TYPE             PIC X.
  6685             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6686             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6687             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6688             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6689             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6690             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6691             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6692             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6693     12  CQ-VOID-INDICATOR           PIC X.
  6694             88  CHECK-IS-STOPPED          VALUE 'S'.
  6695             88  CHECK-IS-VOID             VALUE 'V'.
  6696     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6697     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6698     12  CQ-CHECK-BY-USER            PIC X(4).
  6699     12  CQ-PRE-NUMBERING-SW         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 121
* EL131.cbl
  6700       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6701       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6702
  6703     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6704     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6705     12  CQ-LEDGER-FLAG              PIC X(01).
  6706     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6707     12  CQ-LAST-UPDATED-DT          PIC XX.
  6708     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6709     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6710
  6711     12  FILLER                      PIC X(04).
  6712
  6713******************************************************************
  6714
  6715*                                COPY ELCARCH.
  6716******************************************************************
  6717*                                                                *
  6718*                            ELCARCH.                            *
  6719*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6720*                            VMOD=2.007                          *
  6721*                                                                *
  6722*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6723*                                                                *
  6724*   FILE TYPE = VSAM,KSDS                                        *
  6725*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6726*                                                                *
  6727*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6728*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6729*                                                                *
  6730*   LOG = NO                                                     *
  6731*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6732*                                                                *
  6733*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6734******************************************************************
  6735 01  LETTER-ARCHIVE.
  6736     12  LA-RECORD-ID                PIC XX.
  6737         88  VALID-LA-ID                VALUE 'LA'.
  6738
  6739     12  LA-CONTROL-PRIMARY.
  6740         16  LA-COMPANY-CD           PIC X.
  6741         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6742         16  LA-RECORD-TYPE          PIC X.
  6743             88  LA-HEADER-DATA         VALUE '1'.
  6744             88  LA-ADDRESS-DATA        VALUE '2'.
  6745             88  LA-TEXT-DATA           VALUE '3'.
  6746             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6747         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6748
  6749     12  LA-CONTROL-BY-TYPE.
  6750         16  LA-COMPANY-CD-A1        PIC X.
  6751         16  LA-RECORD-TYPE-A1       PIC X.
  6752         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6753         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6754
  6755     12  LA-TEXT-RECORD.
  6756         16  LA-SKIP-CONTROL         PIC XX.
  6757             88  NO-LINES-SKIPPED       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 122
* EL131.cbl
  6758             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6759         16  LA-TEXT-LINE            PIC X(70).
  6760
  6761     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6762         16  FILLER                  PIC XX.
  6763         16  LA-ADDRESS-LINE         PIC X(30).
  6764         16  FILLER                  PIC X(40).
  6765
  6766     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6767         16  FILLER                  PIC XX.
  6768         16  LA-CARRIER              PIC X.
  6769         16  LA-CLAIM-NO             PIC X(7).
  6770         16  LA-CERT-NO.
  6771             20  LA-CERT-PRIME       PIC X(10).
  6772             20  LA-CERT-SFX         PIC X.
  6773         16  LA-NO-OF-COPIES         PIC S9.
  6774         16  LA-RESEND-DATE          PIC XX.
  6775         16  LA-PROCESSOR-CD         PIC X(4).
  6776         16  LA-CREATION-DT          PIC XX.
  6777         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6778         16  LA-RESEND-PRINT-DATE    PIC XX.
  6779         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6780         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6781*
  6782* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6783*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6784*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6785*   I        20  LA-DMD-RES-ST           PIC XX.
  6786*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6787*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6788*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6789*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6790*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6791*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6792*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6793*   I        20  LA-DMD-UND-CODE         PIC XX.
  6794*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6795*   V    16  FILLER                  PIC X(15).
  6796* -----
  6797*
  6798* REINSERTED  CSO  MODS
  6799*
  6800         16  FILLER.
  6801             20  FILLER                  PIC X(29).
  6802             20  LA-CSO-LETTER-STATUS    PIC X.
  6803                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6804                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6805                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6806             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6807             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6808*
  6809
  6810     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6811         16  FILLER                  PIC XX.
  6812         16  LA4-CARRIER             PIC X.
  6813         16  LA4-CLAIM-NO            PIC X(7).
  6814         16  LA4-CERT-NO.
  6815             20  LA4-CERT-PRIME      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 123
* EL131.cbl
  6816             20  LA4-CERT-SFX        PIC X.
  6817         16  LA4-NO-OF-COPIES        PIC S9.
  6818         16  LA4-RESEND-DATE         PIC XX.
  6819         16  LA4-PROCESSOR-CD        PIC X(4).
  6820         16  LA4-CREATION-DT         PIC XX.
  6821         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6822         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6823         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6824         16  LA4-FORM-TYPE           PIC X.
  6825             88  LA4-INITIAL-FORM    VALUE '1'.
  6826             88  LA4-PROGRESS-FORM   VALUE '2'.
  6827         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6828         16  LA4-STATE               PIC X(02).
  6829         16  FILLER                  PIC X(31).
  6830******************************************************************
  6831
  6832*                                COPY ELCBENE.
  6833******************************************************************
  6834*                                                                *
  6835*                            ELCBENE.                            *
  6836*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6837*                            VMOD=2.006                          *
  6838*                                                                *
  6839*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6840*                                                                *
  6841*   FILE TYPE = VSAM,KSDS                                        *
  6842*   RECORD SIZE = 500   RECFORM = FIX                            *
  6843*                                                                *
  6844*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6845*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6846*                                                                *
  6847*   LOG = YES                                                    *
  6848*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6849*                                                                *
  6850*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6851******************************************************************
  6852
  6853 01  BENEFICIARY-MASTER.
  6854     12  BE-RECORD-ID                PIC XX.
  6855         88  VALID-BE-ID                VALUE 'BE'.
  6856
  6857     12  BE-CONTROL-PRIMARY.
  6858         16  BE-COMPANY-CD           PIC X.
  6859         16  BE-RECORD-TYPE          PIC X.
  6860             88  BENEFICIARY-RECORD  VALUE 'B'.
  6861             88  ADJUSTOR-RECORD     VALUE 'A'.
  6862         16  BE-BENEFICIARY          PIC X(10).
  6863     12  BE-CONTROL-BY-NAME.
  6864         16  BE-COMPANY-CD-A1        PIC X.
  6865         16  BE-RECORD-TYPE-A1       PIC X.
  6866         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6867         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6868
  6869     12  BE-LAST-MAINT-DT            PIC XX.
  6870     12  BE-LAST-MAINT-BY            PIC X(4).
  6871     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6872
  6873     12  BE-ADDRESS-DATA.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 124
* EL131.cbl
  6874         16  BE-MAIL-TO-NAME         PIC X(30).
  6875         16  BE-ADDRESS-LINE-1       PIC X(30).
  6876         16  BE-ADDRESS-LINE-2       PIC X(30).
  6877         16  BE-ADDRESS-LINE-3       PIC X(30).
  6878         16  BE-CITY-STATE.
  6879             20  BE-CITY             PIC X(28).
  6880             20  BE-STATE            PIC XX.
  6881         16  BE-ZIP-CODE.
  6882             20  BE-ZIP-PRIME.
  6883                 24  BE-ZIP-1ST      PIC X.
  6884                     88  BE-CANADIAN-POST-CODE
  6885                                         VALUE 'A' THRU 'Z'.
  6886                 24  FILLER          PIC X(4).
  6887             20  BE-ZIP-PLUS4        PIC X(4).
  6888         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6889             20  BE-CAN-POSTAL-1     PIC XXX.
  6890             20  BE-CAN-POSTAL-2     PIC XXX.
  6891             20  FILLER              PIC XXX.
  6892         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6893         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6894
  6895******************************************************************
  6896*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6897*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6898******************************************************************
  6899     12  BE-CARRIER                  PIC X.
  6900
  6901     12  BE-ADDRESS-DATA2.
  6902         16  BE-MAIL-TO-NAME2        PIC X(30).
  6903         16  BE-ADDRESS-LINE-12      PIC X(30).
  6904         16  BE-ADDRESS-LINE-22      PIC X(30).
  6905         16  BE-ADDRESS-LINE-32      PIC X(30).
  6906         16  BE-CITY-STATE2.
  6907             20  BE-CITY2            PIC X(28).
  6908             20  BE-STATE2           PIC XX.
  6909         16  BE-ZIP-CODE2.
  6910             20  BE-ZIP-PRIME2.
  6911                 24  BE-ZIP-1ST2     PIC X.
  6912                     88  BE-CANADIAN-POST-CODE2
  6913                                         VALUE 'A' THRU 'Z'.
  6914                 24  FILLER          PIC X(4).
  6915             20  BE-ZIP-PLUS42       PIC X(4).
  6916         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6917             20  BE-CAN-POSTAL-12    PIC XXX.
  6918             20  BE-CAN-POSTAL-22    PIC XXX.
  6919             20  FILLER              PIC XXX.
  6920         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6921         16  BE-BILLING-STMT-DATA.
  6922             20  BE-BSR              PIC X.
  6923                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6924                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6925             20  BE-BSR-FROM         PIC X(30).
  6926             20  BE-BSR-DEPT         PIC X(30).
  6927             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6928             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6929             20  BE-OUTPUT-TYPE      PIC X.
  6930                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6931                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 125
* EL131.cbl
  6932
  6933     12  FILLER                      PIC X(28).
  6934******************************************************************
  6935
  6936*                                COPY ELCDAR.
  6937******************************************************************
  6938*                                                                *
  6939*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6940*   FILE TYPE = VSAM,KSDS                                        *
  6941*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6942*   BASE CLUSTER = DLYACTV                                       *
  6943*   LOG = YES                                                    *
  6944*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6945*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6946*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6947*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6948*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6949*               BY PROGRAM "LGINFCE".                            *
  6950*                                                                *
  6951******************************************************************
  6952 01  DAILY-ACTIVITY-RECORD.
  6953     05  DA-KEY.
  6954         10  DA-COMP-CD          PIC X.
  6955         10  DA-CARRIER          PIC X.
  6956         10  DA-CLAIM-NO         PIC X(7).
  6957         10  DA-CERT-NO.
  6958             15  DA-CERT-PRIME   PIC X(10).
  6959             15  DA-CERT-SFX     PIC X.
  6960     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6961     05  DA-RECORD-TYPE          PIC X.
  6962     05  FILLER                  PIC X(2).
  6963******************************************************************
  6964
  6965*                                COPY ELCALPH.
  6966******************************************************************
  6967*                                                                *
  6968*                            ELCALPH.                            *
  6969*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6970*                            VMOD=2.003                          *
  6971*                                                                *
  6972*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  6973*                                                                *
  6974*   FILE TYPE = VSAM,KSDS                                        *
  6975*   RECORD SIZE = 128  RECFORM = FIXED                           *
  6976*                                                                *
  6977*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  6978*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  6979*                                                                *
  6980*   LOG = YES                                                    *
  6981*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6982*                                                                *
  6983*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  6984******************************************************************
  6985
  6986 01  ALPHA-INDEX.
  6987     12  AI-RECORD-ID                         PIC XX.
  6988         88  VALID-AI-ID                  VALUE 'AI'.
  6989     12  AI-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 126
* EL131.cbl
  6990         16  AI-COMPANY-CD                     PIC X.
  6991         16  AI-SOURCE                         PIC X.
  6992             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  6993             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  6994         16  AI-NAME.
  6995             20  AI-LAST-NAME                  PIC X(15).
  6996             20  AI-FIRST-NAME.
  6997                 24  AI-FIRST-INITIAL          PIC X.
  6998                 24  FILLER                    PIC X(11).
  6999             20  AI-MIDDLE-INIT                PIC X.
  7000         16  AI-DATE                           PIC X(8).
  7001         16  AI-TIME                           PIC S9(07) COMP-3.
  7002
  7003     12  AI-CONTROL-BY-ADMIN-KEY.
  7004         16  AI-CM-COMPANY-CD                  PIC X.
  7005         16  AI-CM-SOURCE                      PIC X.
  7006         16  AI-CM-CARRIER                     PIC X.
  7007         16  AI-CM-GROUPING.
  7008             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7009             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7010         16  AI-CM-STATE                       PIC XX.
  7011         16  AI-CM-PRODUCER.
  7012             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7013             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7014         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7015         16  AI-CM-CERTIFICATE-NUMBER.
  7016             20  AI-CM-CERT-PRIME              PIC X(10).
  7017             20  AI-CM-CERT-SFX                PIC X.
  7018         16  AI-CM-DATE                        PIC X(8).
  7019         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7020         16  FILLER                            PIC X(11).
  7021
  7022     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7023         AI-CONTROL-BY-ADMIN-KEY.
  7024         16  AI-CL-COMPANY-CD                  PIC X.
  7025         16  AI-CL-SOURCE                      PIC X.
  7026         16  AI-CL-CARRIER                     PIC X.
  7027         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7028         16  AI-CL-CERTIFICATE-NUMBER.
  7029             20  AI-CL-CERT-PRIME              PIC X(10).
  7030             20  AI-CL-CERT-SFX                PIC X.
  7031         16  AI-CL-DATE                        PIC X(8).
  7032         16  AI-CL-INCURRED-DATE               PIC XX.
  7033         16  AI-CL-CLOSE-DATE                  PIC XX.
  7034         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7035         16  AI-CREDIT-CARD-NUMBER.
  7036             20  AI-CCN.
  7037                 24  AI-CCN-PREFIX             PIC X(4).
  7038                 24  AI-CCN-PRIME              PIC X(12).
  7039             20  AI-CCN-FILLER                 PIC X(4).
  7040
  7041     12  AI-MAINT-INFO.
  7042         16  AI-LAST-MAINT-BY                  PIC X(4).
  7043         16  AI-LAST-MAINT-DT                  PIC XX.
  7044         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7045
  7046     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7047
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 127
* EL131.cbl
  7048     12  FILLER                                PIC X(15).
  7049
  7050
  7051*                                COPY ERCDMDNT.
  7052******************************************************************
  7053*                                                                *
  7054*                            ERCDMDNT                            *
  7055*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7056*                            VMOD=2.005                          *
  7057*                                                                *
  7058*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7059*                                                                *
  7060*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7061*                                                                *
  7062*        FILE TYPE= VSAM,KSDS                                    *
  7063*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7064*                                                                *
  7065*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7066*                                                                *
  7067*        LOG = YES                                               *
  7068*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7069*                                                                *
  7070******************************************************************
  7071
  7072 01  CERTIFICATE-NOTE.
  7073     12  CN-RECORD-ID                     PIC  XX.
  7074         88  VALID-CN-ID                      VALUE 'CN'.
  7075
  7076     12  CN-CONTROL-PRIMARY.
  7077         16  CN-COMPANY-CD                PIC X.
  7078         16  CN-CERT-KEY.
  7079             20  CN-CARRIER               PIC X.
  7080             20  CN-GROUPING.
  7081                 24  CN-GROUPING-PREFIX   PIC XXX.
  7082                 24  CN-GROUPING-PRIME    PIC XXX.
  7083             20  CN-STATE                 PIC XX.
  7084             20  CN-ACCOUNT.
  7085                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7086                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7087             20  CN-CERT-EFF-DT           PIC XX.
  7088             20  CN-CERT-NO.
  7089                 24  CN-CERT-PRIME        PIC X(10).
  7090                 24  CN-CERT-SFX          PIC X.
  7091
  7092     12  CN-BILLING-START-LINE-NO         PIC 99.
  7093     12  CN-BILLING-END-LINE-NO           PIC 99.
  7094
  7095     12  CN-LINES.
  7096         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7097
  7098     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7099         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7100         16  CN-CSI-GENERAL-DATA-AREA.
  7101             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7102
  7103         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7104             CN-CSI-GENERAL-DATA-AREA.
  7105             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 128
* EL131.cbl
  7106             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7107             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7108             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7109             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7110             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7111             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7112             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7113             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7114             20  FILLER                       PIC XX.
  7115             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7116             20  FILLER                       PIC X(38).
  7117
  7118         16  CN-CSI-PRODUCT-DATA-AREA.
  7119             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7120
  7121         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7122             CN-CSI-PRODUCT-DATA-AREA.
  7123             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7124             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7125             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7126             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7127             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7128             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7129             20  FILLER                   PIC XX.
  7130             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7131             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7132             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7133             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7134             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7135             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7136             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7137             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7138             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7139             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7140             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7141             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7142             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7143             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7144             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7145             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7146             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7147             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7148             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7149             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7150             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7151             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7152             20  FILLER                   PIC X(25).
  7153
  7154         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7155             CN-CSI-CREDIT-CARD-DATA.
  7156             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7157             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7158             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7159             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7160             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7161             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7162             20  FILLER                   PIC XX.
  7163             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 129
* EL131.cbl
  7164             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7165             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7166             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7167             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7168             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7169             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7170             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7171             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7172             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7173             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7174             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7175             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7176             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7177             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7178             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7179             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7180             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7181             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7182             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7183             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7184             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7185             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7186             20  FILLER                   PIC X(17).
  7187
  7188         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7189             CN-CSI-FAMILY-LEAVE-DATA.
  7190             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7191             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7192             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7193             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7194             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7195             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7196             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7197             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7198             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7199             20  CN-CSI-SL-INT-ON-PROCEEDS
  7200                                          PIC S9(5)V99  COMP-3.
  7201             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7202             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7203             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7204             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7205             20  CN-CSI-SL-POLICY-BENEFITS
  7206                                          PIC S9(5)V99  COMP-3.
  7207             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7208             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7209             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7210             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7211             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7212             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7213             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7214             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7215             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7216             20  CN-CSI-SL-STATE-NOT      PIC X.
  7217             20  FILLER                   PIC XX.
  7218
  7219         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7220             CN-CSI-SENIOR-LIFE-DATA.
  7221             20  CN-CSI-PP-CARD-TYPE      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 130
* EL131.cbl
  7222             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7223             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7224                                          PIC S9(5)V99  COMP-3.
  7225             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7226             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7227             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7228             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7229             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7230             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7231             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7232             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7233             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7234             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7235             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7236             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7237             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7238             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7239             20  CN-CSI-PP-REPAIR         PIC X.
  7240             20  CN-CSI-PP-REPLACE        PIC X.
  7241             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7242             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7243             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7244             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7245             20  FILLER                   PIC X(5).
  7246
  7247         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7248             CN-CSI-PURCH-PROP-DATA.
  7249             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7250             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7251             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7252             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7253             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7254             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7255             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7256             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7257             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7258             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7259             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7260             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7261             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7262             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7263             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7264             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7265             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7266             20  CN-CSI-EW-REPLACE        PIC X.
  7267             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7268             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7269             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7270             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7271             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7272             20  FILLER                   PIC X(4).
  7273
  7274     12  CN-LAST-MAINT-DT                 PIC XX.
  7275     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7276     12  CN-LAST-MAINT-USER               PIC X(4).
  7277     12  FILLER                           PIC X(6).
  7278
  7279******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 131
* EL131.cbl
  7280
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 132
* EL131.cbl
  7282 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7283                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7284                          CONTROL-FILE ACTIVITY-QUE
  7285                          ACCOUNT-MASTER CHECK-QUE
  7286                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7287                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7288                          CERTIFICATE-NOTE.
  7289 0000-DFHEXIT SECTION.
  7290     MOVE '9#                    $   ' TO DFHEIV0.
  7291     MOVE 'EL131' TO DFHEIV1.
  7292     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7293
  7294     IF EIBCALEN = ZERO
  7295         GO TO 8800-UNAUTHORIZED-ACCESS.
  7296
  7297     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7298     MOVE '5'                    TO DC-OPTION-CODE.
  7299     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7300     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7301     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7302     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7303
  7304     IF SAVE-DATE-YY GREATER 70
  7305         MOVE 19                 TO SAVE-DATE-CC
  7306      ELSE
  7307         MOVE 20                 TO SAVE-DATE-CC.
  7308
  7309
  7310* EXEC CICS HANDLE CONDITION
  7311*        PGMIDERR (8820-XCTL-ERROR)
  7312*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7313*        ERROR    (9990-ABEND)
  7314*    END-EXEC.
  7315*    MOVE '"$LI.                 ! " #00007305' TO DFHEIV0
  7316     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7317     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7318     MOVE X'2220233030303037333035' TO DFHEIV0(25:11)
  7319     CALL 'kxdfhei1' USING DFHEIV0
  7320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7321
  7322
  7323     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7324     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7325     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7326
  7327     INITIALIZE    EDIT-WORK-AREA.
  7328     MOVE '/'                    TO WORK-SLASH.
  7329     MOVE SPACES                 TO ERROR-SWITCHES.
  7330
  7331     MOVE TRAN-ID                TO TRANS-ID.
  7332     MOVE EIBTRMID               TO PI-TERM.
  7333     MOVE MAP-ID                 TO PI-QUAL.
  7334
  7335     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7336
  7337     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7338         MOVE LOW-VALUES         TO EL131AO
  7339         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 133
* EL131.cbl
  7340         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7341         MOVE -1                 TO MAINTL
  7342         GO TO 8110-SEND-DATA.
  7343
  7344     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7345         MOVE LOW-VALUES         TO EL131AO
  7346         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7347         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7348         MOVE 'X'                TO PI-RETURN-CD-1
  7349         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7350         MOVE -1                 TO MAINTL
  7351         IF WS-RETURNED-FROM = XCTL-EL114
  7352             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7353         END-IF
  7354         GO TO 8100-SEND-MAP.
  7355
  7356     IF EIBAID = DFHCLEAR
  7357         GO TO 8200-RETURN-PRIOR.
  7358
  7359     IF PI-PROCESSOR-ID = 'LGXX'
  7360         NEXT SENTENCE
  7361     ELSE
  7362
  7363* EXEC CICS READQ TS
  7364*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7365*            INTO    (SECURITY-CONTROL)
  7366*            LENGTH  (SC-COMM-LENGTH)
  7367*            ITEM    (SC-ITEM)
  7368*        END-EXEC
  7369*    MOVE '*$II   L              ''   #00007350' TO DFHEIV0
  7370     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7371     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7372     MOVE X'2020233030303037333530' TO DFHEIV0(25:11)
  7373     CALL 'kxdfhei1' USING DFHEIV0,
  7374           PI-SECURITY-TEMP-STORE-ID,
  7375           SECURITY-CONTROL,
  7376           SC-COMM-LENGTH,
  7377           SC-ITEM,
  7378           DFHEIV99,
  7379           DFHEIV99
  7380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7381         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7382         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7383         IF NOT DISPLAY-CAP
  7384             MOVE 'READ'               TO  SM-READ
  7385             PERFORM 9995-SECURITY-VIOLATION
  7386             MOVE ER-0070              TO  EMI-ERROR
  7387             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7388             GO TO 8100-SEND-MAP.
  7389
  7390
  7391* EXEC CICS RECEIVE
  7392*        MAP    ('EL131A')
  7393*        MAPSET ('EL131S')
  7394*    END-EXEC.
  7395     MOVE 'EL131A' TO DFHEIV1
  7396     MOVE 'EL131S' TO DFHEIV2
  7397*    MOVE '8"T                   ''   #00007365' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 134
* EL131.cbl
  7398     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7399     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7400     MOVE X'2020233030303037333635' TO DFHEIV0(25:11)
  7401     CALL 'kxdfhei1' USING DFHEIV0,
  7402           DFHEIV1,
  7403           EL131AI,
  7404           DFHEIV99,
  7405           DFHEIV2,
  7406           DFHEIV99,
  7407           DFHEIV99
  7408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7409
  7410
  7411     IF PFKEYL GREATER THAN ZERO
  7412         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7413
  7414     IF SCREEN-ERROR
  7415         MOVE ER-0004 TO EMI-ERROR
  7416         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7417         MOVE -1 TO MAINTL
  7418         GO TO 8110-SEND-DATA.
  7419
  7420     IF EIBAID = DFHPF3
  7421         GO TO 8500-TRLR-MNT.
  7422
  7423     IF EIBAID = DFHPF4
  7424         GO TO 8600-ADDR-MNT.
  7425
  7426     IF EIBAID = DFHPF5
  7427         GO TO 8700-CERT-MNT.
  7428
  7429     IF PI-COMPANY-ID = 'DMD'
  7430       IF EIBAID = DFHPF6
  7431         GO TO 8750-DMD-CLM-FIX.
  7432
  7433     IF EIBAID = DFHPF7
  7434         GO TO 4000-FORCE-ERRORS.
  7435
  7436     IF EIBAID = DFHPF12
  7437         GO TO 8300-GET-HELP.
  7438
  7439     IF EIBAID = DFHPF15
  7440         GO TO 8725-BENEFICIARY-MNT
  7441     END-IF.
  7442
  7443     IF EIBAID = DFHPF23
  7444         GO TO 8810-PF23-ENTERED.
  7445
  7446     IF EIBAID = DFHPF24
  7447         GO TO 8400-RETURN-MASTER.
  7448
  7449     IF EIBAID NOT = DFHENTER
  7450         MOVE ER-0029            TO EMI-ERROR
  7451         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7452         MOVE -1                 TO MAINTL
  7453         GO TO 8110-SEND-DATA.
  7454
  7455     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 135
* EL131.cbl
  7456         MOVE ER-0311            TO EMI-ERROR
  7457         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7458         MOVE -1                 TO MAINTL
  7459         GO TO 8110-SEND-DATA.
  7460
  7461     IF MAINTI = 'A'
  7462         GO TO 0500-ADD-ALPHA-ONLY.
  7463
  7464     IF MAINTI = 'N'
  7465         GO TO 0600-CHANGE-NAME.
  7466
  7467     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7468
  7469     IF SCREEN-ERROR
  7470         GO TO 8110-SEND-DATA.
  7471
  7472     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7473         MOVE ER-0276            TO EMI-ERROR
  7474         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7475         MOVE -1                 TO MAINTL
  7476         GO TO 8110-SEND-DATA.
  7477
  7478     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7479
  7480     IF SCREEN-ERROR
  7481         GO TO 8110-SEND-DATA.
  7482
  7483     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7484
  7485     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7486
  7487     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7488         GO TO 8110-SEND-DATA.
  7489
  7490     IF EMI-FATAL-CTR GREATER THAN ZERO
  7491         GO TO 8110-SEND-DATA.
  7492
  7493     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7494
  7495     IF WS-OPEN-CLOSE-SW = 'Y'
  7496         IF PI-LETTER-SW = 'Y'
  7497             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7498             MOVE 'T'            TO  CNTL-REC-TYPE
  7499             MOVE SPACES         TO  CNTL-PROC-ID
  7500             MOVE +0             TO  CNTL-SEQ-NO
  7501
  7502* EXEC CICS READ
  7503*                DATASET   (CNTL-FILE-ID)
  7504*                RIDFLD    (CNTL-KEY)
  7505*                SET       (ADDRESS OF CONTROL-FILE)
  7506*            END-EXEC
  7507*    MOVE '&"S        E          (   #00007460' TO DFHEIV0
  7508     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7509     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7510     MOVE X'2020233030303037343630' TO DFHEIV0(25:11)
  7511     CALL 'kxdfhei1' USING DFHEIV0,
  7512           CNTL-FILE-ID,
  7513           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 136
* EL131.cbl
  7514           DFHEIV99,
  7515           CNTL-KEY,
  7516           DFHEIV99,
  7517           DFHEIV99,
  7518           DFHEIV99
  7519     SET ADDRESS OF CONTROL-FILE TO
  7520         DFHEIV20
  7521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7522             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7523
  7524     MOVE ER-0000                TO EMI-ERROR.
  7525     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7526
  7527     MOVE SPACE                  TO MAINTO.
  7528     MOVE -1                     TO MAINTL.
  7529     GO TO 8100-SEND-MAP.
  7530
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 137
* EL131.cbl
  7532 0100-UPDATE-PI.
  7533
  7534     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7535     IF WS-RETURNED-FROM = XCTL-EL114
  7536***sometimes there is crap in positions 7-10 when no code was sele
  7537        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7538          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7539        END-IF
  7540     END-IF.
  7541
  7542     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7543         GO TO 0110-UPDATE-UP.
  7544
  7545     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7546     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7547     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7548     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7549     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7550     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7551     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7552     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7553     GO TO 0120-UPDATE-PI-EXIT.
  7554
  7555 0110-UPDATE-UP.
  7556     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7557     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7558     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7559     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7560     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7561     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7562     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7563     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7564
  7565
  7566* EXEC CICS HANDLE CONDITION
  7567*         QIDERR    (0130-TS-ERROR)
  7568*         ITEMERR   (0130-TS-ERROR)
  7569*    END-EXEC.
  7570*    MOVE '"$N<                  ! # #00007508' TO DFHEIV0
  7571     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7572     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7573     MOVE X'2320233030303037353038' TO DFHEIV0(25:11)
  7574     CALL 'kxdfhei1' USING DFHEIV0
  7575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7576
  7577
  7578     IF WS-RETURNED-FROM = XCTL-EL114
  7579
  7580* EXEC CICS READQ TS
  7581*            QUEUE    (PI-KEY)
  7582*            INTO     (EL131AI)
  7583*            LENGTH   (MAP-LENGTH)
  7584*       END-EXEC
  7585*    MOVE '*$I    L              ''   #00007514' TO DFHEIV0
  7586     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7587     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7588     MOVE X'2020233030303037353134' TO DFHEIV0(25:11)
  7589     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 138
* EL131.cbl
  7590           PI-KEY,
  7591           EL131AI,
  7592           MAP-LENGTH,
  7593           DFHEIV99,
  7594           DFHEIV99,
  7595           DFHEIV99
  7596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7597
  7598        IF WS-SAVE-BENEFICIARY > SPACES
  7599            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7600            MOVE +10            TO BENEL
  7601            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7602        END-IF
  7603        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7604     END-IF.
  7605
  7606
  7607* EXEC CICS READQ TS
  7608*         QUEUE    (PI-KEY)
  7609*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7610*         LENGTH   (PI-COMM-LENGTH)
  7611*    END-EXEC.
  7612*    MOVE '*$I    L              ''   #00007528' TO DFHEIV0
  7613     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7614     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7615     MOVE X'2020233030303037353238' TO DFHEIV0(25:11)
  7616     CALL 'kxdfhei1' USING DFHEIV0,
  7617           PI-KEY,
  7618           PROGRAM-INTERFACE-BLOCK,
  7619           PI-COMM-LENGTH,
  7620           DFHEIV99,
  7621           DFHEIV99,
  7622           DFHEIV99
  7623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7624
  7625
  7626
  7627* EXEC CICS DELETEQ TS
  7628*         QUEUE    (PI-KEY)
  7629*    END-EXEC.
  7630*    MOVE '*&                    #   #00007534' TO DFHEIV0
  7631     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7632     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7633     MOVE X'2020233030303037353334' TO DFHEIV0(25:11)
  7634     CALL 'kxdfhei1' USING DFHEIV0,
  7635           PI-KEY,
  7636           DFHEIV99
  7637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7638
  7639
  7640 0120-UPDATE-PI-EXIT.
  7641     EXIT.
  7642
  7643 0130-TS-ERROR.
  7644     MOVE LOW-VALUES             TO EL131AO.
  7645     MOVE ER-0192                TO EMI-ERROR.
  7646
  7647     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 139
* EL131.cbl
  7648
  7649     GO TO 8100-SEND-MAP.
  7650
  7651 0200-TRANS-PF.
  7652     IF EIBAID NOT = DFHENTER
  7653         MOVE 'X'                TO ERROR-SWITCH
  7654         GO TO 0210-EXIT.
  7655
  7656     IF PFKEYI NOT NUMERIC
  7657         MOVE 'X'                TO ERROR-SWITCH
  7658         GO TO 0210-EXIT.
  7659
  7660     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7661
  7662     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7663         MOVE 'X' TO ERROR-SWITCH
  7664         GO TO 0210-EXIT.
  7665
  7666     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7667
  7668 0210-EXIT.
  7669     EXIT.
  7670
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 140
* EL131.cbl
  7672 0500-ADD-ALPHA-ONLY.
  7673******************************************************************
  7674*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7675*    RECORD.                                                     *
  7676******************************************************************
  7677
  7678     IF MLNAMEL = +0 AND
  7679        MFNAMEL = +0 AND
  7680        MMINITL = +0
  7681         MOVE ER-0797                TO  EMI-ERROR
  7682         MOVE -1                     TO  MAINTL
  7683         MOVE AL-UABON               TO  MAINTA
  7684         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7685         GO TO 8110-SEND-DATA.
  7686
  7687     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7688     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7689     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7690     MOVE PI-CERT-NO                 TO  CERT-NO.
  7691
  7692
  7693* EXEC CICS READ
  7694*        DATASET   (CLMS-FILE-ID)
  7695*        RIDFLD    (MSTR-KEY)
  7696*        SET       (ADDRESS OF CLAIM-MASTER)
  7697*    END-EXEC.
  7698*    MOVE '&"S        E          (   #00007590' TO DFHEIV0
  7699     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7700     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7701     MOVE X'2020233030303037353930' TO DFHEIV0(25:11)
  7702     CALL 'kxdfhei1' USING DFHEIV0,
  7703           CLMS-FILE-ID,
  7704           DFHEIV20,
  7705           DFHEIV99,
  7706           MSTR-KEY,
  7707           DFHEIV99,
  7708           DFHEIV99,
  7709           DFHEIV99
  7710     SET ADDRESS OF CLAIM-MASTER TO
  7711         DFHEIV20
  7712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7713
  7714
  7715
  7716* EXEC CICS GETMAIN
  7717*        SET       (ADDRESS OF ALPHA-INDEX)
  7718*        LENGTH    (ALPH-LENGTH)
  7719*        INITIMG   (GETMAIN-SPACE)
  7720*    END-EXEC.
  7721*    MOVE ',"IL                  $   #00007596' TO DFHEIV0
  7722     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7723     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7724     MOVE X'2020233030303037353936' TO DFHEIV0(25:11)
  7725     CALL 'kxdfhei1' USING DFHEIV0,
  7726           DFHEIV20,
  7727           ALPH-LENGTH,
  7728           GETMAIN-SPACE
  7729     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 141
* EL131.cbl
  7730         DFHEIV20
  7731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7732
  7733
  7734     MOVE 'AI'                       TO  AI-RECORD-ID.
  7735     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7736                                         AI-CL-COMPANY-CD.
  7737     MOVE 'C'                        TO  AI-SOURCE
  7738                                         AI-CL-SOURCE.
  7739
  7740     IF MLNAMEL IS GREATER THAN +0
  7741         MOVE MLNAMEI                TO  AI-LAST-NAME
  7742     ELSE
  7743         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7744
  7745     IF MFNAMEL IS GREATER THAN +0
  7746         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7747     ELSE
  7748         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7749
  7750     IF MMINITL IS GREATER THAN +0
  7751         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7752     ELSE
  7753         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7754
  7755     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7756     MOVE '5'                        TO  DC-OPTION-CODE.
  7757     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7758     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7759     IF BUILD-YEAR IS GREATER THAN 50
  7760         MOVE '19'                   TO  WS-ALPHA-YY-1
  7761         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7762         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7763         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7764     ELSE
  7765         MOVE '20'                   TO  WS-ALPHA-YY-1
  7766         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7767         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7768         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7769
  7770     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7771                                         AI-CL-DATE.
  7772
  7773     MOVE EIBTIME                    TO  AI-TIME
  7774                                         AI-CL-TIME.
  7775
  7776     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7777     MOVE 'C'                        TO  AI-CL-SOURCE.
  7778     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7779     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7780     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7781     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7782     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7783
  7784     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7785     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7786     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7787
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 142
* EL131.cbl
  7788
  7789* EXEC CICS WRITE
  7790*        DATASET   (ALPH-FILE-ID)
  7791*        RIDFLD    (AI-CONTROL-PRIMARY)
  7792*        FROM      (ALPHA-INDEX)
  7793*    END-EXEC.
  7794     MOVE LENGTH OF
  7795      ALPHA-INDEX
  7796       TO DFHEIV11
  7797*    MOVE '&$ L                  ''   #00007656' TO DFHEIV0
  7798     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7799     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7800     MOVE X'2020233030303037363536' TO DFHEIV0(25:11)
  7801     CALL 'kxdfhei1' USING DFHEIV0,
  7802           ALPH-FILE-ID,
  7803           ALPHA-INDEX,
  7804           DFHEIV11,
  7805           AI-CONTROL-PRIMARY,
  7806           DFHEIV99,
  7807           DFHEIV99
  7808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7809
  7810
  7811     MOVE LOW-VALUES                 TO  EL131AO.
  7812     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7813     MOVE ER-0000                    TO  EMI-ERROR.
  7814     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7815     MOVE -1                         TO  MAINTL.
  7816     GO TO 8100-SEND-MAP.
  7817
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 143
* EL131.cbl
  7819 0600-CHANGE-NAME.
  7820******************************************************************
  7821*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7822*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7823******************************************************************
  7824
  7825     IF MLNAMEL = +0 AND
  7826        MFNAMEL = +0 AND
  7827        MMINITL = +0
  7828         MOVE ER-0276                TO  EMI-ERROR
  7829         MOVE -1                     TO  MAINTL
  7830         MOVE AL-UABON               TO  MAINTA
  7831         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7832         GO TO 8110-SEND-DATA.
  7833
  7834     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7835     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7836     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7837     MOVE PI-CERT-NO                 TO  CERT-NO.
  7838
  7839
  7840* EXEC CICS READ
  7841*        DATASET   (CLMS-FILE-ID)
  7842*        RIDFLD    (MSTR-KEY)
  7843*        SET       (ADDRESS OF CLAIM-MASTER)
  7844*    END-EXEC.
  7845*    MOVE '&"S        E          (   #00007690' TO DFHEIV0
  7846     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7847     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7848     MOVE X'2020233030303037363930' TO DFHEIV0(25:11)
  7849     CALL 'kxdfhei1' USING DFHEIV0,
  7850           CLMS-FILE-ID,
  7851           DFHEIV20,
  7852           DFHEIV99,
  7853           MSTR-KEY,
  7854           DFHEIV99,
  7855           DFHEIV99,
  7856           DFHEIV99
  7857     SET ADDRESS OF CLAIM-MASTER TO
  7858         DFHEIV20
  7859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7860
  7861
  7862
  7863* EXEC CICS GETMAIN
  7864*        SET       (ADDRESS OF ALPHA-INDEX)
  7865*        LENGTH    (ALPH-LENGTH)
  7866*        INITIMG   (GETMAIN-SPACE)
  7867*    END-EXEC.
  7868*    MOVE ',"IL                  $   #00007696' TO DFHEIV0
  7869     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7870     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7871     MOVE X'2020233030303037363936' TO DFHEIV0(25:11)
  7872     CALL 'kxdfhei1' USING DFHEIV0,
  7873           DFHEIV20,
  7874           ALPH-LENGTH,
  7875           GETMAIN-SPACE
  7876     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 144
* EL131.cbl
  7877         DFHEIV20
  7878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7879
  7880
  7881     MOVE 'AI'                       TO  AI-RECORD-ID.
  7882     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7883                                         AI-CL-COMPANY-CD.
  7884     MOVE 'C'                        TO  AI-SOURCE
  7885                                         AI-CL-SOURCE.
  7886
  7887     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  7888     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  7889     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  7890
  7891     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7892     MOVE '5'                        TO  DC-OPTION-CODE.
  7893     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7894     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7895     IF BUILD-YEAR IS GREATER THAN 50
  7896         MOVE '19'                   TO  WS-ALPHA-YY-1
  7897         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7898         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7899         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7900     ELSE
  7901         MOVE '20'                   TO  WS-ALPHA-YY-1
  7902         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7903         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7904         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7905
  7906     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7907                                         AI-CL-DATE.
  7908
  7909     MOVE EIBTIME                    TO  AI-TIME
  7910                                         AI-CL-TIME.
  7911
  7912     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7913     MOVE 'C'                        TO  AI-CL-SOURCE.
  7914     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7915     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7916     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7917     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7918     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7919
  7920     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7921     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7922     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7923
  7924     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7925         MOVE 'Y'                TO CL-YESNOSW
  7926     END-IF.
  7927
  7928
  7929* EXEC CICS WRITE
  7930*        DATASET   (ALPH-FILE-ID)
  7931*        RIDFLD    (AI-CONTROL-PRIMARY)
  7932*        FROM      (ALPHA-INDEX)
  7933*    END-EXEC.
  7934     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 145
* EL131.cbl
  7935      ALPHA-INDEX
  7936       TO DFHEIV11
  7937*    MOVE '&$ L                  ''   #00007749' TO DFHEIV0
  7938     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7939     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7940     MOVE X'2020233030303037373439' TO DFHEIV0(25:11)
  7941     CALL 'kxdfhei1' USING DFHEIV0,
  7942           ALPH-FILE-ID,
  7943           ALPHA-INDEX,
  7944           DFHEIV11,
  7945           AI-CONTROL-PRIMARY,
  7946           DFHEIV99,
  7947           DFHEIV99
  7948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7949
  7950
  7951
  7952* EXEC CICS READ
  7953*        DATASET   (CLMS-FILE-ID)
  7954*        RIDFLD    (MSTR-KEY)
  7955*        SET       (ADDRESS OF CLAIM-MASTER)
  7956*        UPDATE
  7957*    END-EXEC.
  7958*    MOVE '&"S        EU         (   #00007755' TO DFHEIV0
  7959     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7960     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7961     MOVE X'2020233030303037373535' TO DFHEIV0(25:11)
  7962     CALL 'kxdfhei1' USING DFHEIV0,
  7963           CLMS-FILE-ID,
  7964           DFHEIV20,
  7965           DFHEIV99,
  7966           MSTR-KEY,
  7967           DFHEIV99,
  7968           DFHEIV99,
  7969           DFHEIV99
  7970     SET ADDRESS OF CLAIM-MASTER TO
  7971         DFHEIV20
  7972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7973
  7974
  7975     if (cl-priority-cd = '8')
  7976        and (pi-processor-id not = 'PEMA'and 'JMS '
  7977             AND 'AMWA' AND 'KMSB')
  7978        MOVE ER-8003             TO EMI-ERROR
  7979        PERFORM 9900-ERROR-FORMAT
  7980                                 THRU 9900-EXIT
  7981        MOVE -1                  TO MAINTL
  7982        GO TO 8110-SEND-DATA
  7983     end-if
  7984
  7985     IF MLNAMEL IS GREATER THAN +0
  7986         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  7987
  7988     IF MFNAMEL IS GREATER THAN +0
  7989         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  7990
  7991     IF MMINITL IS GREATER THAN +0
  7992         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 146
* EL131.cbl
  7993
  7994     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  7995     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  7996     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  7997     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  7998
  7999     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8000         MOVE 'Y'                TO CL-YESNOSW
  8001     END-IF.
  8002
  8003
  8004* EXEC CICS HANDLE CONDITION
  8005*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8006*    END-EXEC.
  8007*    MOVE '"$$                   ! $ #00007790' TO DFHEIV0
  8008     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8009     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8010     MOVE X'2420233030303037373930' TO DFHEIV0(25:11)
  8011     CALL 'kxdfhei1' USING DFHEIV0
  8012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8013
  8014
  8015
  8016* EXEC CICS REWRITE
  8017*        DATASET   (CLMS-FILE-ID)
  8018*        FROM      (CLAIM-MASTER)
  8019*    END-EXEC.
  8020     MOVE LENGTH OF
  8021      CLAIM-MASTER
  8022       TO DFHEIV11
  8023*    MOVE '&& L                  %   #00007794' TO DFHEIV0
  8024     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8025     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8026     MOVE X'2020233030303037373934' TO DFHEIV0(25:11)
  8027     CALL 'kxdfhei1' USING DFHEIV0,
  8028           CLMS-FILE-ID,
  8029           CLAIM-MASTER,
  8030           DFHEIV11,
  8031           DFHEIV99
  8032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8033
  8034
  8035 0600-CONTINUE-NAME-UPDATE.
  8036
  8037     MOVE LOW-VALUES                 TO  EL131AO.
  8038     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8039     MOVE ER-0000                    TO  EMI-ERROR.
  8040     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8041     MOVE -1                         TO  MAINTL.
  8042     GO TO 8100-SEND-MAP.
  8043
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 147
* EL131.cbl
  8045 1000-EDIT-SCREEN.
  8046
  8047     MOVE MAINTI                 TO CHECK-MAINT.
  8048
  8049     IF NOT VALID-OPTIONS
  8050         MOVE 'X'                TO ERROR-SWITCH
  8051         MOVE -1                 TO MAINTL
  8052         MOVE AL-UABON           TO MAINTA
  8053         MOVE ER-0023            TO EMI-ERROR
  8054         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8055         GO TO 1010-EXIT.
  8056
  8057     IF NOT MODIFY-CAP
  8058         MOVE 'UPDATE'           TO  SM-READ
  8059         PERFORM 9995-SECURITY-VIOLATION
  8060         MOVE ER-0070               TO  EMI-ERROR
  8061         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8062         GO TO 8100-SEND-MAP.
  8063
  8064     IF DELETE-CLAIM
  8065         MOVE AL-UANON TO MAINTA
  8066         GO TO 1010-EXIT.
  8067
  8068     MOVE AL-UANON               TO MAINTA.
  8069
  8070     IF CCNOI GREATER THAN LOW-VALUES
  8071         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8072
  8073     IF PI-COMPANY-ID = 'CSL'
  8074        CONTINUE
  8075     ELSE
  8076        IF TYPEL > ZERO
  8077           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8078              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8079                    PI-LIFE-OVERRIDE-L1))
  8080                       OR
  8081              ((PI-COMPANY-ID = 'DCC')
  8082              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8083                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G'))
  8084              MOVE AL-UANON      TO TYPEA
  8085              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8086           ELSE
  8087              MOVE ER-0199       TO EMI-ERROR
  8088              PERFORM 9900-ERROR-FORMAT
  8089                                 THRU 9900-EXIT
  8090              MOVE AL-UABON      TO TYPEA
  8091              MOVE -1            TO TYPEL
  8092              MOVE 'X'           TO ERROR-SWITCH
  8093           END-IF
  8094        ELSE
  8095           MOVE AL-UANOF         TO TYPEA
  8096        END-IF
  8097     END-IF
  8098     IF STATUSI GREATER THAN LOW-VALUES
  8099         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8100             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8101             MOVE AL-UANON       TO STATUSA
  8102             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 148
* EL131.cbl
  8103             MOVE 'Y'            TO DLYACTV-SW
  8104         ELSE
  8105             MOVE ER-0333        TO EMI-ERROR
  8106             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8107             MOVE AL-UABON       TO STATUSA
  8108             MOVE -1             TO STATUSL
  8109             MOVE 'X'            TO ERROR-SWITCH
  8110         END-IF
  8111     ELSE
  8112         MOVE SPACE              TO TRLR-SWITCH
  8113         MOVE 'N'                TO DLYACTV-SW
  8114         MOVE AL-UANOF           TO STATUSA.
  8115
  8116     IF PROCI GREATER THAN LOW-VALUES
  8117         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8118     ELSE
  8119         MOVE AL-UANOF TO PROCA.
  8120
  8121     IF SEXI GREATER THAN LOW-VALUES
  8122         IF SEXI = 'F' OR 'M'
  8123             MOVE AL-UANON       TO SEXA
  8124             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8125           ELSE
  8126             MOVE ER-0219        TO EMI-ERROR
  8127             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8128             MOVE AL-UABON       TO SEXA
  8129             MOVE -1             TO SEXL
  8130             MOVE 'X'            TO ERROR-SWITCH
  8131       ELSE
  8132         MOVE AL-UANOF           TO SEXA.
  8133
  8134     IF BIRTHL = +0
  8135         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8136         MOVE AL-UANOF           TO  BIRTHA
  8137         GO TO 1000-CONTINUE-EDITS.
  8138
  8139     IF BIRTHI = SPACES
  8140         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8141         MOVE 'X'                TO  UPDATE-SWITCH
  8142                                     MSTR-SWITCH
  8143         GO TO 1000-CONTINUE-EDITS.
  8144
  8145     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8146     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8147     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8148     MOVE '4'                    TO  DC-OPTION-CODE.
  8149     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8150     IF DATE-CONVERSION-ERROR
  8151         MOVE ER-0220            TO  EMI-ERROR
  8152         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8153         MOVE AL-UABON           TO  BIRTHA
  8154         MOVE -1                 TO  BIRTHL
  8155         MOVE 'X'                TO  ERROR-SWITCH
  8156         GO TO 1000-CONTINUE-EDITS.
  8157
  8158******************************************************************
  8159**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8160**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 149
* EL131.cbl
  8161**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8162******************************************************************
  8163     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8164         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8165         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8166         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8167         MOVE '4'                TO  DC-OPTION-CODE
  8168         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8169         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8170                                     DC-ELAPSED-DAYS
  8171         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8172         IF DATE-CONVERSION-ERROR
  8173             MOVE ER-0220        TO  EMI-ERROR
  8174             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8175             MOVE AL-UABON       TO  BIRTHA
  8176             MOVE -1             TO  BIRTHL
  8177             MOVE 'X'            TO  ERROR-SWITCH
  8178             GO TO 1000-CONTINUE-EDITS.
  8179
  8180     MOVE AL-UANON               TO  BIRTHA.
  8181     MOVE 'X'                    TO  UPDATE-SWITCH
  8182                                     MSTR-SWITCH.
  8183     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8184     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8185     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8186
  8187 1000-CONTINUE-EDITS.
  8188
  8189     IF SOCIALI GREATER THAN LOW-VALUES
  8190         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8191         IF WS-SOC-SEC-NO NUMERIC AND
  8192           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8193             NEXT SENTENCE
  8194         ELSE
  8195            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8196               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8197               WS-SSN-DASH2 = '-'
  8198                 NEXT SENTENCE
  8199            ELSE
  8200                 MOVE ER-0887        TO  EMI-ERROR
  8201                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8202                 MOVE AL-UABON       TO  SOCIALA
  8203                 MOVE -1             TO  SOCIALL
  8204                 MOVE 'X'            TO  ERROR-SWITCH
  8205            END-IF
  8206        END-IF
  8207     END-IF.
  8208
  8209     IF SOCIALI GREATER THAN LOW-VALUES
  8210         MOVE AL-UANON           TO SOCIALA
  8211         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8212     ELSE
  8213         MOVE AL-UANOF           TO SOCIALA.
  8214
  8215     IF OCCI GREATER THAN LOW-VALUES
  8216         MOVE AL-UANON           TO OCCA
  8217         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8218     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 150
* EL131.cbl
  8219         MOVE AL-UANOF           TO OCCA.
  8220
  8221     IF BENEL NOT GREATER THAN ZERO
  8222            GO TO 1005-CONTINUE-EDITS.
  8223
  8224     IF BENEI = SPACES
  8225        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8226           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8227           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8228           IF AUTO-PAY-TO-BENE = 'Y'
  8229               MOVE ER-1773      TO  EMI-ERROR
  8230               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8231               MOVE 'X'          TO ERROR-SWITCH
  8232               MOVE AL-UABON     TO BENEA
  8233               MOVE -1           TO BENEL
  8234           ELSE
  8235               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8236           END-IF
  8237        ELSE
  8238           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8239        END-IF
  8240        GO TO 1005-CONTINUE-EDITS.
  8241
  8242
  8243* EXEC CICS HANDLE CONDITION
  8244*        NOTFND (1004-BENE-NOT-FOUND)
  8245*    END-EXEC.
  8246*    MOVE '"$I                   ! % #00008006' TO DFHEIV0
  8247     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8248     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8249     MOVE X'2520233030303038303036' TO DFHEIV0(25:11)
  8250     CALL 'kxdfhei1' USING DFHEIV0
  8251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8252
  8253
  8254     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8255     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8256     MOVE BENEI                  TO  WS-ELBENE-ID.
  8257
  8258
  8259* EXEC CICS READ
  8260*        DATASET ('ELBENE')
  8261*        RIDFLD  (WS-ELBENE-KEY)
  8262*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8263*    END-EXEC.
  8264     MOVE 'ELBENE' TO DFHEIV1
  8265*    MOVE '&"S        E          (   #00008014' TO DFHEIV0
  8266     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8267     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8268     MOVE X'2020233030303038303134' TO DFHEIV0(25:11)
  8269     CALL 'kxdfhei1' USING DFHEIV0,
  8270           DFHEIV1,
  8271           DFHEIV20,
  8272           DFHEIV99,
  8273           WS-ELBENE-KEY,
  8274           DFHEIV99,
  8275           DFHEIV99,
  8276           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 151
* EL131.cbl
  8277     SET ADDRESS OF BENEFICIARY-MASTER TO
  8278         DFHEIV20
  8279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8280
  8281
  8282     MOVE AL-UANON               TO  BENEA.
  8283     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8284
  8285     GO TO 1005-CONTINUE-EDITS.
  8286
  8287 1004-BENE-NOT-FOUND.
  8288     MOVE ER-0565                TO  EMI-ERROR.
  8289
  8290     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8291     MOVE 'X'                    TO ERROR-SWITCH.
  8292     MOVE AL-UABON               TO BENEA.
  8293     MOVE -1                     TO BENEL.
  8294
  8295 1005-CONTINUE-EDITS.
  8296
  8297     IF DIAGI GREATER THAN LOW-VALUES
  8298         MOVE AL-UANON           TO DIAGA
  8299         MOVE 'X'                TO UPDATE-SWITCH
  8300                                    NINETY-TRLR-SWITCH
  8301     ELSE
  8302         MOVE AL-UANOF           TO DIAGA.
  8303
  8304     IF CAUSEI GREATER THAN LOW-VALUES
  8305         MOVE AL-UANON           TO CAUSEA
  8306         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8307     ELSE
  8308         MOVE AL-UANOF           TO CAUSEA.
  8309
  8310     IF ENDL GREATER THAN ZERO
  8311         MOVE LOW-VALUES         TO HOLD-END
  8312         IF ENDI = SPACES
  8313             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8314         ELSE
  8315             MOVE ENDI           TO DEEDIT-DATE-INPUT
  8316
  8317* EXEC CICS BIF DEEDIT
  8318*                FIELD    (DEEDIT-DATE-INPUT)
  8319*                LENGTH   (DATE-LENGTH)
  8320*            END-EXEC
  8321*    MOVE '@"L                   #   #00008054' TO DFHEIV0
  8322     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8323     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8324     MOVE X'2020233030303038303534' TO DFHEIV0(25:11)
  8325     CALL 'kxdfhei1' USING DFHEIV0,
  8326           DEEDIT-DATE-INPUT,
  8327           DATE-LENGTH
  8328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8329             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8330             MOVE '4'            TO DC-OPTION-CODE
  8331             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8332             IF NOT DATE-CONVERSION-ERROR
  8333                 MOVE DC-BIN-DATE-1      TO HOLD-END
  8334                 MOVE AL-UANON   TO ENDA
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 152
* EL131.cbl
  8335                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8336                 MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8337             ELSE
  8338                 MOVE ER-0224    TO EMI-ERROR
  8339                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8340                 MOVE AL-UABON   TO ENDA
  8341                 MOVE -1         TO ENDL
  8342                 MOVE 'X'        TO ERROR-SWITCH
  8343       ELSE
  8344           MOVE AL-UANOF         TO ENDA.
  8345
  8346     IF INCL GREATER THAN ZERO
  8347         MOVE LOW-VALUES         TO HOLD-INCUR
  8348         IF INCI = SPACES
  8349             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8350         ELSE
  8351             MOVE INCI           TO DEEDIT-DATE-INPUT
  8352
  8353* EXEC CICS BIF DEEDIT
  8354*                FIELD    (DEEDIT-DATE-INPUT)
  8355*                LENGTH   (DATE-LENGTH)
  8356*            END-EXEC
  8357*    MOVE '@"L                   #   #00008081' TO DFHEIV0
  8358     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8359     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8360     MOVE X'2020233030303038303831' TO DFHEIV0(25:11)
  8361     CALL 'kxdfhei1' USING DFHEIV0,
  8362           DEEDIT-DATE-INPUT,
  8363           DATE-LENGTH
  8364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8365             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8366             MOVE '4'            TO DC-OPTION-CODE
  8367             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8368             IF NOT DATE-CONVERSION-ERROR
  8369                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8370                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8371                 MOVE AL-UANON           TO INCA
  8372                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8373             ELSE
  8374                 MOVE ER-0222    TO EMI-ERROR
  8375                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8376                 MOVE AL-UABON   TO INCA
  8377                 MOVE -1         TO INCL
  8378                 MOVE 'X'        TO ERROR-SWITCH
  8379       ELSE
  8380           IF PI-NO-PMTS = ZEROS
  8381               MOVE AL-UANOF     TO INCA.
  8382
  8383     IF REPL GREATER THAN ZERO
  8384         MOVE LOW-VALUES         TO HOLD-REPORTED
  8385         IF REPI = SPACES
  8386             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8387         ELSE
  8388             MOVE REPI           TO DEEDIT-DATE-INPUT
  8389
  8390* EXEC CICS BIF DEEDIT
  8391*                FIELD    (DEEDIT-DATE-INPUT)
  8392*                LENGTH   (DATE-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 153
* EL131.cbl
  8393*            END-EXEC
  8394*    MOVE '@"L                   #   #00008109' TO DFHEIV0
  8395     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8396     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8397     MOVE X'2020233030303038313039' TO DFHEIV0(25:11)
  8398     CALL 'kxdfhei1' USING DFHEIV0,
  8399           DEEDIT-DATE-INPUT,
  8400           DATE-LENGTH
  8401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8402             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8403             MOVE '4'            TO DC-OPTION-CODE
  8404             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8405             IF NOT DATE-CONVERSION-ERROR
  8406                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8407                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8408                 MOVE AL-UANON   TO REPA
  8409                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8410             ELSE
  8411                 MOVE ER-0223    TO EMI-ERROR
  8412                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8413                 MOVE AL-UABON   TO REPA
  8414                 MOVE -1         TO REPL
  8415                 MOVE 'X'        TO ERROR-SWITCH
  8416       ELSE
  8417         MOVE AL-UANOF TO REPA.
  8418
  8419     IF PDTHRUI GREATER THAN LOW-VALUES
  8420        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8421        IF PDTHRUI = SPACES
  8422           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8423        ELSE
  8424           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8425
  8426* EXEC CICS BIF DEEDIT
  8427*               FIELD    (DEEDIT-DATE-INPUT)
  8428*               LENGTH   (DATE-LENGTH)
  8429*          END-EXEC
  8430*    MOVE '@"L                   #   #00008136' TO DFHEIV0
  8431     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8432     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8433     MOVE X'2020233030303038313336' TO DFHEIV0(25:11)
  8434     CALL 'kxdfhei1' USING DFHEIV0,
  8435           DEEDIT-DATE-INPUT,
  8436           DATE-LENGTH
  8437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8438           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8439           MOVE '4'            TO DC-OPTION-CODE
  8440           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8441           IF NOT DATE-CONVERSION-ERROR
  8442              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8443              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8444              MOVE AL-UANON   TO PDTHRUA
  8445              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8446              IF PI-USES-PAID-TO
  8447                 MOVE '6'            TO DC-OPTION-CODE
  8448                 MOVE -1             TO DC-ELAPSED-DAYS
  8449                 MOVE +0             TO DC-ELAPSED-MONTHS
  8450                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 154
* EL131.cbl
  8451                 IF NO-CONVERSION-ERROR
  8452                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8453                 ELSE
  8454                    NEXT SENTENCE
  8455              ELSE
  8456                 NEXT SENTENCE
  8457           ELSE
  8458              MOVE ER-0475    TO EMI-ERROR
  8459              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8460              MOVE AL-UABON   TO PDTHRUA
  8461              MOVE -1         TO PDTHRUL
  8462              MOVE 'X'        TO ERROR-SWITCH
  8463     ELSE
  8464        IF MODIFY-CAP
  8465           MOVE AL-UANOF        TO PDTHRUA.
  8466
  8467     IF PDAMTL GREATER THAN +0
  8468         MOVE ZEROS              TO HOLD-PDAMT
  8469
  8470* EXEC CICS BIF DEEDIT
  8471*            FIELD    (PDAMTI)
  8472*            LENGTH   (9)
  8473*        END-EXEC
  8474     MOVE 9
  8475       TO DFHEIV11
  8476*    MOVE '@"L                   #   #00008171' TO DFHEIV0
  8477     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8478     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8479     MOVE X'2020233030303038313731' TO DFHEIV0(25:11)
  8480     CALL 'kxdfhei1' USING DFHEIV0,
  8481           PDAMTI,
  8482           DFHEIV11
  8483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8484         IF PDAMTI NUMERIC
  8485             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8486             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8487             MOVE AL-UNNON       TO PDAMTA
  8488         ELSE
  8489             MOVE ER-0547        TO EMI-ERROR
  8490             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8491             MOVE AL-UNBON       TO PDAMTA
  8492             MOVE -1             TO PDAMTL
  8493             MOVE 'X'            TO ERROR-SWITCH
  8494     ELSE
  8495         IF MODIFY-CAP
  8496            MOVE AL-UNNOF        TO PDAMTA.
  8497
  8498     IF NODAYSI GREATER THAN LOW-VALUES
  8499         MOVE ZEROS              TO HOLD-NODAYS
  8500
  8501* EXEC CICS BIF DEEDIT
  8502*            FIELD (NODAYSI)
  8503*            LENGTH (5)
  8504*        END-EXEC
  8505     MOVE 5
  8506       TO DFHEIV11
  8507*    MOVE '@"L                   #   #00008191' TO DFHEIV0
  8508     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 155
* EL131.cbl
  8509     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8510     MOVE X'2020233030303038313931' TO DFHEIV0(25:11)
  8511     CALL 'kxdfhei1' USING DFHEIV0,
  8512           NODAYSI,
  8513           DFHEIV11
  8514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8515         IF NODAYSI NUMERIC
  8516             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8517             MOVE AL-UNNON       TO NODAYSA
  8518             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8519         ELSE
  8520             MOVE ER-0491        TO EMI-ERROR
  8521             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8522             MOVE AL-UNBON       TO NODAYSA
  8523             MOVE -1             TO NODAYSL
  8524             MOVE 'X'            TO ERROR-SWITCH
  8525     ELSE
  8526         IF MODIFY-CAP
  8527            MOVE AL-UNNOF        TO NODAYSA.
  8528
  8529     IF NOPMTSI GREATER THAN LOW-VALUES
  8530         MOVE ZEROS              TO HOLD-NOPMTS
  8531
  8532* EXEC CICS BIF DEEDIT
  8533*            FIELD (NOPMTSI)
  8534*            LENGTH (4)
  8535*        END-EXEC
  8536     MOVE 4
  8537       TO DFHEIV11
  8538*    MOVE '@"L                   #   #00008211' TO DFHEIV0
  8539     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8540     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8541     MOVE X'2020233030303038323131' TO DFHEIV0(25:11)
  8542     CALL 'kxdfhei1' USING DFHEIV0,
  8543           NOPMTSI,
  8544           DFHEIV11
  8545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8546         IF NOPMTSI NUMERIC
  8547             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8548             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8549             MOVE AL-UNNON       TO NOPMTSA
  8550           ELSE
  8551             MOVE ER-0548        TO EMI-ERROR
  8552             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8553             MOVE AL-UNBON       TO NOPMTSA
  8554             MOVE -1             TO NOPMTSL
  8555             MOVE 'X'            TO ERROR-SWITCH
  8556       ELSE
  8557         IF MODIFY-CAP
  8558            MOVE AL-UNNOF        TO NOPMTSA.
  8559
  8560     IF FORMTYPI GREATER THAN LOW-VALUES
  8561         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8562             MOVE AL-UANON       TO FORMTYPA
  8563             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8564           ELSE
  8565             MOVE ER-7650        TO EMI-ERROR
  8566             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 156
* EL131.cbl
  8567             MOVE AL-UABON       TO FORMTYPA
  8568             MOVE -1             TO FORMTYPL
  8569             MOVE 'X'            TO ERROR-SWITCH
  8570       ELSE
  8571         MOVE AL-UANOF           TO FORMTYPA.
  8572
  8573     IF PRICDL GREATER THAN ZERO
  8574         IF (PRICDI = ' ') OR
  8575            (PRICDI GREATER THAN ZERO   AND
  8576             PRICDI NOT GREATER THAN '9')
  8577             MOVE AL-UANON       TO PRICDA
  8578             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8579         ELSE
  8580             MOVE ER-0274        TO EMI-ERROR
  8581             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8582             MOVE AL-UABON       TO PRICDA
  8583             MOVE -1             TO PRICDL
  8584             MOVE 'X'            TO ERROR-SWITCH
  8585     ELSE
  8586         MOVE AL-UANOF TO PRICDA.
  8587
  8588     IF PI-COMPANY-ID = 'DMD'
  8589     IF PRICDL GREATER THAN ZERO
  8590       IF SYSTEM-MODIFY-CAP  OR
  8591          PI-PROCESSOR-ID = 'LGXX'
  8592             NEXT SENTENCE
  8593           ELSE
  8594            IF CL-PRIORITY-CD = '9'  OR
  8595               PRICDI         = '9'
  8596                  MOVE ER-0938        TO EMI-ERROR
  8597                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8598                  MOVE AL-UABON       TO PRICDA
  8599                  MOVE -1             TO PRICDL
  8600                  MOVE 'X'            TO ERROR-SWITCH.
  8601
  8602     IF FILETOL GREATER THAN ZERO
  8603         MOVE AL-UANON           TO FILETOA
  8604         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8605     ELSE
  8606         MOVE AL-UANOF TO FILETOA.
  8607
  8608     IF SUPVL GREATER THAN ZERO
  8609         IF SUPVI = 'Y' OR 'N' OR SPACE
  8610             MOVE AL-UANON       TO SUPVA
  8611             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8612         ELSE
  8613             MOVE ER-0230        TO EMI-ERROR
  8614             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8615             MOVE AL-UABON       TO SUPVA
  8616             MOVE -1             TO SUPVL
  8617             MOVE 'X'            TO ERROR-SWITCH
  8618     ELSE
  8619         MOVE AL-UANOF           TO SUPVA.
  8620
  8621     IF MLNAMEL GREATER THAN ZERO
  8622         IF MLNAMEI GREATER THAN SPACES
  8623            MOVE AL-UANON        TO MLNAMEA
  8624            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 157
* EL131.cbl
  8625                                     MSTR-KEY-SWITCH
  8626         ELSE
  8627            MOVE ER-0236         TO EMI-ERROR
  8628            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8629            MOVE AL-UABON        TO MLNAMEA
  8630            MOVE -1              TO MLNAMEL
  8631            MOVE 'X'             TO ERROR-SWITCH
  8632     ELSE
  8633         MOVE AL-UANOF           TO MLNAMEA.
  8634
  8635     IF MFNAMEI GREATER THAN LOW-VALUES
  8636         MOVE AL-UANON           TO MFNAMEA
  8637         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8638     ELSE
  8639         MOVE AL-UANOF           TO MFNAMEA.
  8640
  8641     IF MMINITI GREATER THAN LOW-VALUES
  8642         MOVE AL-UANON           TO MMINITA
  8643         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8644     ELSE
  8645         MOVE AL-UANOF           TO MMINITA.
  8646
  8647     IF CRTLNMEI GREATER THAN LOW-VALUES
  8648         IF CRTLNMEI NOT = SPACES
  8649            MOVE AL-UANON        TO CRTLNMEA
  8650            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8651                                     CERT-KEY-SWITCH
  8652        ELSE
  8653            MOVE ER-0236         TO EMI-ERROR
  8654            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8655            MOVE AL-UABON        TO CRTLNMEA
  8656            MOVE -1              TO CRTLNMEL
  8657            MOVE 'X'             TO ERROR-SWITCH
  8658     ELSE
  8659         MOVE AL-UANOF           TO CRTLNMEA.
  8660
  8661     IF CRTFNMEI GREATER THAN LOW-VALUES
  8662         MOVE AL-UANON           TO CRTFNMEA
  8663         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8664     ELSE
  8665         MOVE AL-UANOF           TO CRTFNMEA.
  8666
  8667     IF CRTINITI GREATER THAN LOW-VALUES
  8668         MOVE AL-UANON           TO CRTINITA
  8669         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
  8670     ELSE
  8671         MOVE AL-UANOF           TO CRTINITA.
  8672
  8673     IF ISSAGEL GREATER THAN ZERO
  8674         IF ISSAGEI NUMERIC
  8675            MOVE AL-UANON        TO ISSAGEA
  8676            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8677         ELSE
  8678            MOVE ER-0237         TO EMI-ERROR
  8679            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8680            MOVE AL-UABON        TO ISSAGEA
  8681            MOVE -1              TO ISSAGEL
  8682            MOVE 'X'             TO ERROR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 158
* EL131.cbl
  8683     ELSE
  8684         MOVE AL-UANOF           TO ISSAGEA.
  8685
  8686     IF JNTFNMEI GREATER THAN LOW-VALUES
  8687         MOVE AL-UANON           TO JNTFNMEA
  8688         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8689     ELSE
  8690         MOVE AL-UANOF           TO JNTFNMEA.
  8691
  8692     IF JNTLNMEI GREATER THAN LOW-VALUES
  8693         MOVE AL-UANON           TO JNTLNMEA
  8694         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8695     ELSE
  8696         MOVE AL-UANOF           TO JNTLNMEA.
  8697
  8698     IF JNTINITI GREATER THAN LOW-VALUES
  8699         MOVE AL-UANON           TO JNTINITA
  8700         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8701     ELSE
  8702         MOVE AL-UANOF           TO JNTINITA.
  8703
  8704     IF JNTAGEL GREATER THAN ZERO
  8705         IF JNTAGEI NUMERIC
  8706            MOVE AL-UANON        TO JNTAGEA
  8707            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8708         ELSE
  8709            MOVE ER-0238         TO EMI-ERROR
  8710            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8711            MOVE AL-UABON        TO JNTAGEA
  8712            MOVE -1              TO JNTAGEL
  8713            MOVE 'X'             TO ERROR-SWITCH
  8714     ELSE
  8715         MOVE AL-UANOF           TO JNTAGEA.
  8716
  8717     IF ADDONDTI GREATER THAN LOW-VALUES
  8718         MOVE LOW-VALUES         TO HOLD-ADDON
  8719         IF ADDONDTI = SPACES
  8720             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8721         ELSE
  8722             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8723
  8724* EXEC CICS BIF DEEDIT
  8725*                FIELD    (DEEDIT-DATE-INPUT)
  8726*                LENGTH   (DATE-LENGTH)
  8727*            END-EXEC
  8728*    MOVE '@"L                   #   #00008392' TO DFHEIV0
  8729     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8730     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8731     MOVE X'2020233030303038333932' TO DFHEIV0(25:11)
  8732     CALL 'kxdfhei1' USING DFHEIV0,
  8733           DEEDIT-DATE-INPUT,
  8734           DATE-LENGTH
  8735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8736             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8737             MOVE '4'            TO DC-OPTION-CODE
  8738             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8739             IF NOT DATE-CONVERSION-ERROR
  8740                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 159
* EL131.cbl
  8741                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8742                                                  CERT-SWITCH
  8743                 MOVE AL-UANON   TO ADDONDTA
  8744                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8745             ELSE
  8746                 MOVE ER-7651    TO EMI-ERROR
  8747                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8748                 MOVE AL-UABON   TO ADDONDTA
  8749                 MOVE -1         TO ADDONDTL
  8750                 MOVE 'X'        TO ERROR-SWITCH
  8751       ELSE
  8752         MOVE AL-UANOF TO ADDONDTA.
  8753
  8754     IF LCVCDI GREATER THAN LOW-VALUES
  8755         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8756         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8757     ELSE
  8758         MOVE AL-UANOF           TO LCVCDA.
  8759
  8760     IF ACVCDI GREATER THAN LOW-VALUES
  8761         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8762         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8763     ELSE
  8764         MOVE AL-UANOF           TO ACVCDA.
  8765
  8766     IF LCVOTRMI GREATER THAN LOW-VALUES
  8767
  8768* EXEC CICS BIF DEEDIT
  8769*            FIELD (LCVOTRMI)
  8770*            LENGTH(3)
  8771*        END-EXEC
  8772     MOVE 3
  8773       TO DFHEIV11
  8774*    MOVE '@"L                   #   #00008427' TO DFHEIV0
  8775     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8776     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8777     MOVE X'2020233030303038343237' TO DFHEIV0(25:11)
  8778     CALL 'kxdfhei1' USING DFHEIV0,
  8779           LCVOTRMI,
  8780           DFHEIV11
  8781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8782         IF LCVOTRMI IS NUMERIC
  8783             MOVE LCVOTRMI       TO LCVOTRMO
  8784             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8785             MOVE AL-UANON       TO LCVOTRMA
  8786         ELSE
  8787             MOVE ER-0241        TO EMI-ERROR
  8788             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8789             MOVE AL-UNBON       TO LCVOTRMA
  8790             MOVE 'X'            TO ERROR-SWITCH
  8791             MOVE -1             TO LCVOTRML
  8792     ELSE
  8793         MOVE AL-UANOF           TO LCVOTRMA.
  8794
  8795     IF ACVOTRMI GREATER THAN LOW-VALUES
  8796
  8797* EXEC CICS BIF DEEDIT
  8798*            FIELD (ACVOTRMI)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 160
* EL131.cbl
  8799*            LENGTH(3)
  8800*        END-EXEC
  8801     MOVE 3
  8802       TO DFHEIV11
  8803*    MOVE '@"L                   #   #00008445' TO DFHEIV0
  8804     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8805     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8806     MOVE X'2020233030303038343435' TO DFHEIV0(25:11)
  8807     CALL 'kxdfhei1' USING DFHEIV0,
  8808           ACVOTRMI,
  8809           DFHEIV11
  8810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8811         IF ACVOTRMI IS NUMERIC
  8812             MOVE ACVOTRMI       TO ACVOTRMO
  8813             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8814             MOVE AL-UANON       TO ACVOTRMA
  8815         ELSE
  8816             MOVE ER-0241        TO EMI-ERROR
  8817             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8818             MOVE AL-UNBON       TO ACVOTRMA
  8819             MOVE 'X'            TO ERROR-SWITCH
  8820             MOVE -1             TO ACVOTRML
  8821     ELSE
  8822         MOVE AL-UANOF           TO ACVOTRMA.
  8823
  8824     IF LCVRATEL GREATER THAN +0
  8825
  8826* EXEC CICS BIF DEEDIT
  8827*            FIELD (LCVRATEI)
  8828*            LENGTH(6)
  8829*        END-EXEC
  8830     MOVE 6
  8831       TO DFHEIV11
  8832*    MOVE '@"L                   #   #00008463' TO DFHEIV0
  8833     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8834     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8835     MOVE X'2020233030303038343633' TO DFHEIV0(25:11)
  8836     CALL 'kxdfhei1' USING DFHEIV0,
  8837           LCVRATEI,
  8838           DFHEIV11
  8839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8840         IF LCVRATEI IS NUMERIC
  8841             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  8842             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8843             MOVE AL-UNNON       TO LCVRATEA
  8844         ELSE
  8845             MOVE ER-2280        TO EMI-ERROR
  8846             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8847             MOVE AL-UNBON       TO LCVRATEA
  8848             MOVE 'X'            TO ERROR-SWITCH
  8849             MOVE -1             TO LCVRATEL
  8850     ELSE
  8851         MOVE AL-UNNOF           TO LCVRATEA.
  8852
  8853     IF ACVRATEL GREATER THAN +0
  8854
  8855* EXEC CICS BIF DEEDIT
  8856*            FIELD (ACVRATEI)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 161
* EL131.cbl
  8857*            LENGTH(6)
  8858*        END-EXEC
  8859     MOVE 6
  8860       TO DFHEIV11
  8861*    MOVE '@"L                   #   #00008481' TO DFHEIV0
  8862     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8863     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8864     MOVE X'2020233030303038343831' TO DFHEIV0(25:11)
  8865     CALL 'kxdfhei1' USING DFHEIV0,
  8866           ACVRATEI,
  8867           DFHEIV11
  8868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8869         IF ACVRATEI IS NUMERIC
  8870             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  8871             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8872             MOVE AL-UNNON       TO ACVRATEA
  8873         ELSE
  8874             MOVE ER-2280        TO EMI-ERROR
  8875             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8876             MOVE AL-UNBON       TO ACVRATEA
  8877             MOVE 'X'            TO ERROR-SWITCH
  8878             MOVE -1             TO ACVRATEL
  8879     ELSE
  8880         MOVE AL-UNNOF           TO ACVRATEA.
  8881
  8882     IF LCVBENEL GREATER THAN ZERO
  8883
  8884* EXEC CICS BIF DEEDIT
  8885*            FIELD (LCVBENEI)
  8886*            LENGTH (11)
  8887*        END-EXEC
  8888     MOVE 11
  8889       TO DFHEIV11
  8890*    MOVE '@"L                   #   #00008499' TO DFHEIV0
  8891     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8892     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8893     MOVE X'2020233030303038343939' TO DFHEIV0(25:11)
  8894     CALL 'kxdfhei1' USING DFHEIV0,
  8895           LCVBENEI,
  8896           DFHEIV11
  8897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8898         IF LCVBENEI IS NUMERIC
  8899            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  8900            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8901            MOVE AL-UNNON        TO LCVBENEA
  8902         ELSE
  8903            MOVE ER-0243         TO EMI-ERROR
  8904            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8905            MOVE AL-UNBON        TO LCVBENEA
  8906            MOVE -1              TO LCVBENEL
  8907            MOVE 'X'             TO ERROR-SWITCH
  8908     ELSE
  8909         MOVE AL-UANOF           TO LCVBENEA.
  8910
  8911     IF ACVBENEL GREATER THAN ZERO
  8912
  8913* EXEC CICS BIF DEEDIT
  8914*            FIELD (ACVBENEI)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 162
* EL131.cbl
  8915*            LENGTH (11)
  8916*        END-EXEC
  8917     MOVE 11
  8918       TO DFHEIV11
  8919*    MOVE '@"L                   #   #00008517' TO DFHEIV0
  8920     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8921     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8922     MOVE X'2020233030303038353137' TO DFHEIV0(25:11)
  8923     CALL 'kxdfhei1' USING DFHEIV0,
  8924           ACVBENEI,
  8925           DFHEIV11
  8926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8927         IF ACVBENEI IS NUMERIC
  8928            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  8929            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8930            MOVE AL-UNNON        TO ACVBENEA
  8931         ELSE
  8932            MOVE ER-0243         TO EMI-ERROR
  8933            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8934            MOVE AL-UNBON        TO ACVBENEA
  8935            MOVE -1              TO ACVBENEL
  8936            MOVE 'X'             TO ERROR-SWITCH
  8937     ELSE
  8938         MOVE AL-UANOF           TO ACVBENEA.
  8939
  8940     IF LCVFORMI GREATER THAN LOW-VALUES
  8941        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8942        MOVE AL-UANON            TO LCVFORMA
  8943     ELSE
  8944        MOVE AL-UANOF            TO LCVFORMA.
  8945
  8946     IF ACVFORMI GREATER THAN LOW-VALUES
  8947        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8948        MOVE AL-UANON            TO ACVFORMA
  8949     ELSE
  8950        MOVE AL-UANOF            TO ACVFORMA.
  8951
  8952     IF LCVCNDTL GREATER THAN ZERO
  8953         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8954         IF LCVCNDTI = SPACES
  8955             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8956         ELSE
  8957             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  8958             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8959             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8960             MOVE '4'            TO DC-OPTION-CODE
  8961             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8962             IF NOT DATE-CONVERSION-ERROR
  8963                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  8964                 MOVE AL-UANON   TO LCVCNDTA
  8965                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8966                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  8967             ELSE
  8968                 MOVE ER-0246    TO EMI-ERROR
  8969                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8970                 MOVE AL-UABON   TO LCVCNDTA
  8971                 MOVE -1         TO LCVCNDTL
  8972                 MOVE 'X'        TO ERROR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 163
* EL131.cbl
  8973     ELSE
  8974         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8975         MOVE AL-UANOF           TO LCVCNDTA.
  8976
  8977     IF ACVCNDTL GREATER THAN ZERO
  8978         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8979         IF ACVCNDTI = SPACES
  8980             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8981         ELSE
  8982             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  8983             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8984             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8985             MOVE '4'            TO DC-OPTION-CODE
  8986             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8987             IF NOT DATE-CONVERSION-ERROR
  8988                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  8989                 MOVE AL-UANON   TO ACVCNDTA
  8990                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8991                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  8992             ELSE
  8993                 MOVE ER-0246    TO EMI-ERROR
  8994                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8995                 MOVE AL-UABON   TO ACVCNDTA
  8996                 MOVE -1         TO ACVCNDTL
  8997                 MOVE 'X'        TO ERROR-SWITCH
  8998     ELSE
  8999         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9000         MOVE AL-UANOF           TO ACVCNDTA.
  9001
  9002     IF APRL GREATER THAN +0
  9003
  9004* EXEC CICS BIF DEEDIT
  9005*            FIELD    (APRI)
  9006*            LENGTH   (8)
  9007*        END-EXEC
  9008     MOVE 8
  9009       TO DFHEIV11
  9010*    MOVE '@"L                   #   #00008597' TO DFHEIV0
  9011     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9012     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9013     MOVE X'2020233030303038353937' TO DFHEIV0(25:11)
  9014     CALL 'kxdfhei1' USING DFHEIV0,
  9015           APRI,
  9016           DFHEIV11
  9017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9018         IF APRI NUMERIC
  9019            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9020            MOVE APRI            TO HOLD-APR APRO
  9021            MOVE AL-UANON        TO APRA
  9022          ELSE
  9023            MOVE ER-0259         TO EMI-ERROR
  9024            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9025            MOVE AL-UABON        TO APRA
  9026            MOVE -1              TO APRL
  9027            MOVE 'X'             TO ERROR-SWITCH
  9028     ELSE
  9029         MOVE AL-UANOF           TO APRA.
  9030
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 164
* EL131.cbl
  9031     IF PMTFREQL GREATER THAN ZERO
  9032
  9033* EXEC CICS BIF DEEDIT
  9034*            FIELD    (PMTFREQI)
  9035*            LENGTH   (2)
  9036*        END-EXEC
  9037     MOVE 2
  9038       TO DFHEIV11
  9039*    MOVE '@"L                   #   #00008615' TO DFHEIV0
  9040     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9041     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9042     MOVE X'2020233030303038363135' TO DFHEIV0(25:11)
  9043     CALL 'kxdfhei1' USING DFHEIV0,
  9044           PMTFREQI,
  9045           DFHEIV11
  9046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9047         IF PMTFREQI NUMERIC
  9048            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9049            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9050            MOVE AL-UANON        TO PMTFREQA
  9051          ELSE
  9052            MOVE ER-0427         TO EMI-ERROR
  9053            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9054            MOVE AL-UABON        TO PMTFREQA
  9055            MOVE -1              TO PMTFREQL
  9056            MOVE 'X'             TO ERROR-SWITCH
  9057     ELSE
  9058         MOVE AL-UANOF           TO PMTFREQA.
  9059
  9060     IF INDGRPL GREATER THAN ZERO
  9061         IF INDGRPI = 'I' OR 'G' OR SPACE
  9062             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9063             MOVE AL-UANON       TO INDGRPA
  9064          ELSE
  9065             MOVE ER-0260        TO EMI-ERROR
  9066             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9067             MOVE AL-UABON       TO INDGRPA
  9068             MOVE -1             TO INDGRPL
  9069             MOVE 'X'            TO ERROR-SWITCH
  9070     ELSE
  9071         MOVE AL-UANOF           TO INDGRPA.
  9072
  9073     IF PREMTYPL GREATER THAN ZERO
  9074         IF PREMTYPI = '1' OR '2' OR '3'
  9075            MOVE PREMTYPI        TO PI-PREM-TYPE
  9076            MOVE AL-UNNON        TO PREMTYPA
  9077            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9078          ELSE
  9079            MOVE ER-0227         TO EMI-ERROR
  9080            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9081            MOVE AL-UNBON        TO PREMTYPA
  9082            MOVE -1              TO PREMTYPL
  9083            MOVE 'X'             TO ERROR-SWITCH
  9084     ELSE
  9085         MOVE AL-UANOF           TO PREMTYPA.
  9086
  9087     IF LOANBALL GREATER THAN ZERO
  9088
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 165
* EL131.cbl
  9089* EXEC CICS BIF DEEDIT
  9090*             FIELD    (LOANBALI)
  9091*             LENGTH   (9)
  9092*        END-EXEC
  9093     MOVE 9
  9094       TO DFHEIV11
  9095*    MOVE '@"L                   #   #00008660' TO DFHEIV0
  9096     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9097     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9098     MOVE X'2020233030303038363630' TO DFHEIV0(25:11)
  9099     CALL 'kxdfhei1' USING DFHEIV0,
  9100           LOANBALI,
  9101           DFHEIV11
  9102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9103         IF LOANBALI NUMERIC
  9104             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9105             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9106             MOVE AL-UNNON TO LOANBALA
  9107         ELSE
  9108             MOVE ER-0639        TO EMI-ERROR
  9109             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9110             MOVE AL-UNBON       TO LOANBALA
  9111             MOVE -1             TO LOANBALL
  9112             MOVE 'X'            TO ERROR-SWITCH
  9113     ELSE
  9114         MOVE AL-UNNOF           TO LOANBALA.
  9115
  9116     IF LOANNOL GREATER THAN ZERO
  9117        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9118        MOVE AL-UANON            TO LOANNOA
  9119     ELSE
  9120        MOVE AL-UANOF            TO LOANNOA.
  9121
  9122     IF REINCDI GREATER THAN LOW-VALUES
  9123        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9124        MOVE AL-UANON            TO REINCDA
  9125     ELSE
  9126        MOVE AL-UANOF            TO REINCDA.
  9127
  9128     IF CERTI GREATER THAN LOW-VALUES
  9129         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9130     ELSE
  9131         MOVE AL-UANOF           TO CERTA.
  9132
  9133     IF CERTEFFI GREATER THAN LOW-VALUES
  9134         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9135     ELSE
  9136         MOVE AL-UANOF           TO CERTEFFA.
  9137
  9138     IF CERTACTI GREATER THAN LOW-VALUES
  9139         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9140     ELSE
  9141         MOVE AL-UANOF           TO CERTACTA.
  9142
  9143     IF CERTSTI GREATER THAN LOW-VALUES
  9144         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9145     ELSE
  9146         MOVE AL-UANOF           TO CERTSTA.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 166
* EL131.cbl
  9147
  9148     IF CERTCARI GREATER THAN LOW-VALUES
  9149         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9150     ELSE
  9151         MOVE AL-UANOF           TO CERTCARA.
  9152
  9153     IF DLYACTV-RECORD-NEEDED
  9154         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9155                 1150-EXIT
  9156     END-IF.
  9157
  9158     IF CERTEFFI GREATER LOW-VALUES OR
  9159        CERTACTI GREATER LOW-VALUES OR
  9160        CERTSTI  GREATER LOW-VALUES OR
  9161        CERTCARI GREATER LOW-VALUES OR
  9162        CERTGRPI GREATER LOW-VALUES
  9163        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9164
  9165*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9166*      IF PI-PREM-TYPE NOT = '1'  AND
  9167*         PI-NO-PMTS = ZEROS
  9168*          IF LOANBALL GREATER +0 OR
  9169*             ACVBENEL GREATER +0
  9170*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9171
  9172     if accswl > zeros
  9173        if accswi = 'Y' OR 'N'
  9174           MOVE 'X'              TO UPDATE-SWITCH
  9175                                    MSTR-SWITCH
  9176           MOVE AL-UANON         TO accswa
  9177        else
  9178           move er-1656          to emi-error
  9179           PERFORM 9900-ERROR-FORMAT
  9180                                 THRU 9900-EXIT
  9181           move al-uabon         to accswa
  9182           move -1               to accswl
  9183           move 'X'              to error-switch
  9184           move al-uanof         to accswa
  9185        end-if
  9186     end-if
  9187     IF CERTL = ZEROS AND
  9188        SUFXL = ZEROS
  9189          GO TO 1010-EXIT.
  9190
  9191     IF CERTL GREATER THAN ZEROS
  9192         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9193             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9194             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9195             MOVE 'X'            TO ERROR-SWITCH
  9196             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9197
  9198     IF SUFXL GREATER THAN ZEROS
  9199         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9200             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9201             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9202             MOVE 'X'            TO ERROR-SWITCH
  9203             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9204
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 167
* EL131.cbl
  9205 1010-EXIT.
  9206     EXIT.
  9207
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 168
* EL131.cbl
  9209 1120-EDIT-PROC.
  9210     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9211     MOVE '2'                    TO CNTL-REC-TYPE.
  9212     MOVE PROCI                  TO CNTL-PROC-ID.
  9213     MOVE ZERO                   TO CNTL-SEQ-NO.
  9214
  9215
  9216* EXEC CICS HANDLE CONDITION
  9217*         NOTFND    (1120-CNTL-NOTFND)
  9218*    END-EXEC.
  9219*    MOVE '"$I                   ! & #00008776' TO DFHEIV0
  9220     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9221     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9222     MOVE X'2620233030303038373736' TO DFHEIV0(25:11)
  9223     CALL 'kxdfhei1' USING DFHEIV0
  9224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9225
  9226
  9227
  9228* EXEC CICS READ
  9229*         SET      (ADDRESS OF CONTROL-FILE)
  9230*         DATASET  (CNTL-FILE-ID)
  9231*         RIDFLD   (CNTL-KEY)
  9232*    END-EXEC.
  9233*    MOVE '&"S        E          (   #00008780' TO DFHEIV0
  9234     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9235     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9236     MOVE X'2020233030303038373830' TO DFHEIV0(25:11)
  9237     CALL 'kxdfhei1' USING DFHEIV0,
  9238           CNTL-FILE-ID,
  9239           DFHEIV20,
  9240           DFHEIV99,
  9241           CNTL-KEY,
  9242           DFHEIV99,
  9243           DFHEIV99,
  9244           DFHEIV99
  9245     SET ADDRESS OF CONTROL-FILE TO
  9246         DFHEIV20
  9247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9248
  9249
  9250     MOVE AL-UANON               TO PROCA.
  9251     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9252     GO TO 1120-EXIT.
  9253
  9254 1120-CNTL-NOTFND.
  9255     MOVE ER-0273                TO EMI-ERROR.
  9256     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9257     MOVE AL-UABON               TO PROCA.
  9258     MOVE -1                     TO PROCL.
  9259     MOVE 'X'                    TO ERROR-SWITCH.
  9260
  9261 1120-EXIT.
  9262     EXIT.
  9263
  9264*************************************************************
  9265*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  9266*************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 169
* EL131.cbl
  9267
  9268 1150-OUTPUT-ACTIVITY-RECORD.
  9269
  9270
  9271* EXEC CICS GETMAIN
  9272*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  9273*        LENGTH (25)
  9274*        INITIMG (WS-BLANK)
  9275*    END-EXEC.
  9276     MOVE 25
  9277       TO DFHEIV11
  9278*    MOVE ',"IL                  $   #00008806' TO DFHEIV0
  9279     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9280     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9281     MOVE X'2020233030303038383036' TO DFHEIV0(25:11)
  9282     CALL 'kxdfhei1' USING DFHEIV0,
  9283           DFHEIV20,
  9284           DFHEIV11,
  9285           WS-BLANK
  9286     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  9287         DFHEIV20
  9288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9289
  9290
  9291     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  9292     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  9293     MOVE PI-CARRIER             TO DA-CARRIER.
  9294     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  9295     MOVE PI-CERT-NO             TO DA-CERT-NO.
  9296     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  9297     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  9298
  9299
  9300* EXEC CICS HANDLE CONDITION
  9301*        NOTOPEN (1150-NOTOPEN-ERROR)
  9302*        DUPREC (1150-EXIT)
  9303*    END-EXEC.
  9304*    MOVE '"$J%                  ! '' #00008820' TO DFHEIV0
  9305     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  9306     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9307     MOVE X'2720233030303038383230' TO DFHEIV0(25:11)
  9308     CALL 'kxdfhei1' USING DFHEIV0
  9309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9310
  9311     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  9312     MOVE 'DLYACTV'              TO JP-FILE-ID.
  9313     MOVE 'A'                    TO JP-RECORD-TYPE.
  9314     MOVE +48                    TO JOURNAL-LENGTH.
  9315
  9316
  9317* EXEC CICS WRITE
  9318*        DATASET ('DLYACTV')
  9319*        RIDFLD (DA-KEY)
  9320*        FROM (DAILY-ACTIVITY-RECORD)
  9321*        LENGTH (25)
  9322*    END-EXEC.
  9323     MOVE 'DLYACTV' TO DFHEIV1
  9324     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 170
* EL131.cbl
  9325       TO DFHEIV11
  9326*    MOVE '&$ L                  ''   #00008829' TO DFHEIV0
  9327     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9328     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9329     MOVE X'2020233030303038383239' TO DFHEIV0(25:11)
  9330     CALL 'kxdfhei1' USING DFHEIV0,
  9331           DFHEIV1,
  9332           DAILY-ACTIVITY-RECORD,
  9333           DFHEIV11,
  9334           DA-KEY,
  9335           DFHEIV99,
  9336           DFHEIV99
  9337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9338
  9339
  9340     GO TO 1150-EXIT.
  9341
  9342 1150-NOTOPEN-ERROR.
  9343
  9344     MOVE '2955'                 TO EMI-ERROR.
  9345     MOVE -1                     TO MAINTL.
  9346     MOVE AL-UANON               TO MAINTA.
  9347     MOVE 'X'                    TO ERROR-SWITCH.
  9348     PERFORM 9900-ERROR-FORMAT THRU
  9349             9900-EXIT.
  9350
  9351 1150-EXIT.
  9352     EXIT.
  9353
  9354*************************************************************
  9355*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  9356*************************************************************
  9357
  9358 1240-EDIT-LIFE-CODE.
  9359
  9360     IF INVALID-BENEFIT-CODE
  9361         GO TO 1240-SET-ERROR.
  9362
  9363     MOVE SPACES                 TO BENEFIT-KEY.
  9364     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9365     MOVE '4'                    TO BEN-REC-TYPE.
  9366     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9367     MOVE ZERO                   TO BEN-SEQ-NO.
  9368
  9369
  9370* EXEC CICS READ GTEQ
  9371*         DATASET  (CNTL-FILE-ID)
  9372*         RIDFLD   (BENEFIT-KEY)
  9373*         SET      (ADDRESS OF CONTROL-FILE)
  9374*    END-EXEC.
  9375*    MOVE '&"S        G          (   #00008865' TO DFHEIV0
  9376     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9377     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9378     MOVE X'2020233030303038383635' TO DFHEIV0(25:11)
  9379     CALL 'kxdfhei1' USING DFHEIV0,
  9380           CNTL-FILE-ID,
  9381           DFHEIV20,
  9382           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 171
* EL131.cbl
  9383           BENEFIT-KEY,
  9384           DFHEIV99,
  9385           DFHEIV99,
  9386           DFHEIV99
  9387     SET ADDRESS OF CONTROL-FILE TO
  9388         DFHEIV20
  9389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9390
  9391
  9392     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9393        CF-RECORD-TYPE NOT = '4'
  9394         GO TO 1240-SET-ERROR.
  9395
  9396     MOVE ZERO                   TO COUNT-2.
  9397     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9398
  9399     IF SCREEN-ERROR
  9400         GO TO 1240-SET-ERROR.
  9401
  9402 1240-SET-CODE-SWITCHES.
  9403     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9404     MOVE AL-UANON               TO LCVCDA.
  9405     GO TO 1240-EXIT.
  9406
  9407 1240-SET-ERROR.
  9408     MOVE ER-0240                TO EMI-ERROR.
  9409     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9410     MOVE 'X'                    TO ERROR-SWITCH.
  9411     MOVE AL-UABON               TO LCVCDA.
  9412     MOVE -1                     TO LCVCDL.
  9413
  9414 1240-EXIT.
  9415     EXIT.
  9416
  9417 1310-EDIT-AH-CODE.
  9418     IF INVALID-BENEFIT-CODE
  9419         GO TO 1310-SET-ERROR.
  9420
  9421     MOVE SPACES                 TO BENEFIT-KEY.
  9422     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9423     MOVE '5'                    TO BEN-REC-TYPE.
  9424     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9425     MOVE ZERO                   TO BEN-SEQ-NO.
  9426
  9427
  9428* EXEC CICS READ GTEQ
  9429*         DATASET  (CNTL-FILE-ID)
  9430*         RIDFLD   (BENEFIT-KEY)
  9431*         SET      (ADDRESS OF CONTROL-FILE)
  9432*    END-EXEC.
  9433*    MOVE '&"S        G          (   #00008906' TO DFHEIV0
  9434     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9435     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9436     MOVE X'2020233030303038393036' TO DFHEIV0(25:11)
  9437     CALL 'kxdfhei1' USING DFHEIV0,
  9438           CNTL-FILE-ID,
  9439           DFHEIV20,
  9440           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 172
* EL131.cbl
  9441           BENEFIT-KEY,
  9442           DFHEIV99,
  9443           DFHEIV99,
  9444           DFHEIV99
  9445     SET ADDRESS OF CONTROL-FILE TO
  9446         DFHEIV20
  9447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9448
  9449
  9450     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9451        CF-RECORD-TYPE NOT = '5'
  9452         GO TO 1310-SET-ERROR.
  9453
  9454     MOVE ZERO                   TO COUNT-2.
  9455     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9456     IF SCREEN-ERROR
  9457         GO TO 1310-SET-ERROR.
  9458
  9459 1310-SET-CODE-SWITCHES.
  9460     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9461     MOVE AL-UANON               TO ACVCDA.
  9462     GO TO 1310-EXIT.
  9463
  9464 1310-SET-ERROR.
  9465     MOVE ER-0250                TO EMI-ERROR.
  9466     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9467     MOVE AL-UABON               TO ACVCDA.
  9468     MOVE 'X'                    TO ERROR-SWITCH.
  9469     MOVE -1                     TO ACVCDL.
  9470
  9471 1310-EXIT.
  9472     EXIT.
  9473
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 173
* EL131.cbl
  9475 1460-EDIT-CERT-NO.
  9476     MOVE CERTI                  TO WS-CERT-NO-PRIME.
  9477     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
  9478
  9479     IF WS-SAVE-CERT-NO = SPACES
  9480         MOVE ER-0203            TO EMI-ERROR
  9481         GO TO 1460-CERT-NO-ERROR.
  9482
  9483     IF WS-CERT-NO-PRIME = SPACES AND
  9484        WS-CERT-NO-SUFX GREATER THAN SPACE
  9485            MOVE ER-0210         TO EMI-ERROR
  9486            GO TO 1460-CERT-NO-ERROR.
  9487
  9488     MOVE 'X'                    TO UPDATE-SWITCH.
  9489     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9490     MOVE AL-UANON               TO CERTA.
  9491
  9492     IF SUFXL IS GREATER THAN 0
  9493         MOVE AL-UANON           TO SUFXA.
  9494
  9495     GO TO 1460-EXIT.
  9496
  9497 1460-CERT-NO-ERROR.
  9498     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9499     MOVE AL-UABON               TO SUFXA.
  9500     MOVE AL-UABON               TO CERTA.
  9501     MOVE -1                     TO CERTL.
  9502     MOVE 'X'                    TO ERROR-SWITCH.
  9503
  9504 1460-EXIT.
  9505     EXIT.
  9506
  9507 1470-EDIT-EFF.
  9508     IF CERTEFFI = SPACES
  9509         GO TO 1470-DATE-ERROR.
  9510
  9511     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
  9512     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  9513     IF DEEDIT-DATE = ZERO
  9514         GO TO 1470-DATE-ERROR.
  9515
  9516     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
  9517     MOVE '4'                    TO DC-OPTION-CODE.
  9518     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  9519     IF NOT DATE-CONVERSION-ERROR
  9520         MOVE DC-BIN-DATE-1      TO HOLD-EFF
  9521         MOVE AL-UANON           TO CERTEFFA
  9522         MOVE 'X'                TO UPDATE-SWITCH
  9523         MOVE 'Y'                TO CERT-KEY-SWITCH
  9524         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
  9525         GO TO 1470-EXIT.
  9526
  9527 1470-DATE-ERROR.
  9528     MOVE ER-0215                TO EMI-ERROR.
  9529     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9530     MOVE AL-UABON               TO CERTEFFA.
  9531     MOVE -1                     TO CERTEFFL.
  9532     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 174
* EL131.cbl
  9533
  9534 1470-EXIT.
  9535     EXIT.
  9536
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 175
* EL131.cbl
  9538 1480-EDIT-ACCT.
  9539     IF CERTACTI = SPACES
  9540         MOVE ER-0232            TO EMI-ERROR
  9541         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9542         MOVE AL-UABON           TO CERTACTA
  9543         MOVE -1                 TO CERTACTL
  9544         MOVE 'X'                TO ERROR-SWITCH
  9545     ELSE
  9546         MOVE 'X'                TO UPDATE-SWITCH
  9547         MOVE 'Y'                TO CERT-KEY-SWITCH.
  9548
  9549 1480-EXIT.
  9550     EXIT.
  9551
  9552 1490-EDIT-STATE.
  9553     IF CERTSTI = SPACES
  9554         MOVE ER-0233            TO EMI-ERROR
  9555         GO TO 1490-STATE-ERROR.
  9556
  9557     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9558     MOVE '3'                    TO CNTL-REC-TYPE.
  9559     MOVE SPACES                 TO CNTL-STATE-ACCESS.
  9560     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
  9561     MOVE ZERO                   TO CNTL-SEQ-NO.
  9562
  9563
  9564* EXEC CICS HANDLE CONDITION
  9565*         NOTFND (1490-STATE-NOTFND)
  9566*    END-EXEC.
  9567*    MOVE '"$I                   ! ( #00009025' TO DFHEIV0
  9568     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9569     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9570     MOVE X'2820233030303039303235' TO DFHEIV0(25:11)
  9571     CALL 'kxdfhei1' USING DFHEIV0
  9572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9573
  9574
  9575
  9576* EXEC CICS READ
  9577*         SET        (ADDRESS OF CONTROL-FILE)
  9578*         DATASET    ('ELCNTL')
  9579*         RIDFLD     (CNTL-KEY)
  9580*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9581*         GENERIC
  9582*    END-EXEC.
  9583     MOVE 'ELCNTL' TO DFHEIV1
  9584*    MOVE '&"S  KG    E          (   #00009029' TO DFHEIV0
  9585     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9586     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9587     MOVE X'2020233030303039303239' TO DFHEIV0(25:11)
  9588     CALL 'kxdfhei1' USING DFHEIV0,
  9589           DFHEIV1,
  9590           DFHEIV20,
  9591           DFHEIV99,
  9592           CNTL-KEY,
  9593           CNTL-GENERIC-LENGTH,
  9594           DFHEIV99,
  9595           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 176
* EL131.cbl
  9596     SET ADDRESS OF CONTROL-FILE TO
  9597         DFHEIV20
  9598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9599
  9600
  9601     MOVE AL-UANON               TO CERTSTA.
  9602     MOVE 'X'                    TO UPDATE-SWITCH.
  9603     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9604     GO TO 1490-EXIT.
  9605
  9606 1490-STATE-NOTFND.
  9607     MOVE ER-0149                TO EMI-ERROR.
  9608
  9609 1490-STATE-ERROR.
  9610     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9611     MOVE AL-UABON               TO CERTSTA.
  9612     MOVE -1                     TO CERTSTL.
  9613     MOVE 'X'                    TO ERROR-SWITCH.
  9614
  9615 1490-EXIT.
  9616     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 177
* EL131.cbl
  9618 1500-EDIT-CARR.
  9619     IF CERTCARI = SPACES
  9620         GO TO 1500-CARR-NOTFND.
  9621
  9622     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9623     MOVE '6'                    TO CNTL-REC-TYPE.
  9624     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
  9625     MOVE CERTCARI               TO CNTL-CARRIER.
  9626     MOVE ZERO                   TO CNTL-SEQ-NO.
  9627
  9628
  9629* EXEC CICS HANDLE CONDITION
  9630*         NOTFND   (1500-CARR-NOTFND)
  9631*    END-EXEC.
  9632*    MOVE '"$I                   ! ) #00009064' TO DFHEIV0
  9633     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9634     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9635     MOVE X'2920233030303039303634' TO DFHEIV0(25:11)
  9636     CALL 'kxdfhei1' USING DFHEIV0
  9637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9638
  9639
  9640
  9641* EXEC CICS READ
  9642*         SET        (ADDRESS OF CONTROL-FILE)
  9643*         DATASET    ('ELCNTL')
  9644*         RIDFLD     (CNTL-KEY)
  9645*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9646*         GENERIC
  9647*    END-EXEC.
  9648     MOVE 'ELCNTL' TO DFHEIV1
  9649*    MOVE '&"S  KG    E          (   #00009068' TO DFHEIV0
  9650     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9651     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9652     MOVE X'2020233030303039303638' TO DFHEIV0(25:11)
  9653     CALL 'kxdfhei1' USING DFHEIV0,
  9654           DFHEIV1,
  9655           DFHEIV20,
  9656           DFHEIV99,
  9657           CNTL-KEY,
  9658           CNTL-GENERIC-LENGTH,
  9659           DFHEIV99,
  9660           DFHEIV99
  9661     SET ADDRESS OF CONTROL-FILE TO
  9662         DFHEIV20
  9663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9664
  9665
  9666     MOVE AL-UANON               TO CERTCARA.
  9667     MOVE 'X'                    TO UPDATE-SWITCH.
  9668     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9669     GO TO 1500-EXIT.
  9670
  9671 1500-CARR-NOTFND.
  9672     MOVE ER-0360                TO EMI-ERROR.
  9673     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9674     MOVE AL-UABON               TO CERTCARA.
  9675     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 178
* EL131.cbl
  9676     MOVE 'X'                    TO ERROR-SWITCH.
  9677
  9678 1500-EXIT.
  9679     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 179
* EL131.cbl
  9681 1510-DEEDIT-DATE.
  9682
  9683* EXEC CICS BIF DEEDIT
  9684*         FIELD    (DEEDIT-DATE-INPUT)
  9685*         LENGTH   (DATE-LENGTH)
  9686*    END-EXEC.
  9687*    MOVE '@"L                   #   #00009092' TO DFHEIV0
  9688     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9689     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9690     MOVE X'2020233030303039303932' TO DFHEIV0(25:11)
  9691     CALL 'kxdfhei1' USING DFHEIV0,
  9692           DEEDIT-DATE-INPUT,
  9693           DATE-LENGTH
  9694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9695
  9696
  9697 1510-EXIT.
  9698     EXIT.
  9699
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 180
* EL131.cbl
  9701 1620-VERIFY-ACCT.
  9702
  9703     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
  9704     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9705     MOVE PI-GROUPING            TO ACCT-GROUP.
  9706     MOVE PI-STATE               TO ACCT-STATE.
  9707     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9708
  9709     IF CERTEFFI GREATER THAN LOW-VALUES
  9710         MOVE HOLD-EFF           TO ACCT-DATE
  9711     ELSE
  9712         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
  9713
  9714     IF CERTACTI GREATER THAN LOW-VALUES
  9715         MOVE CERTACTI           TO  ACCT-ACCOUNT.
  9716     IF CERTSTI GREATER THAN LOW-VALUES
  9717         MOVE CERTSTI            TO  ACCT-STATE.
  9718     IF CERTCARI GREATER THAN LOW-VALUES
  9719         MOVE CERTCARI           TO  ACCT-CARRIER.
  9720     IF CERTGRPI GREATER THAN LOW-VALUES
  9721         MOVE CERTGRPI           TO ACCT-GROUP.
  9722
  9723     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
  9724
  9725
  9726* EXEC CICS HANDLE CONDITION
  9727*         NOTFND  (1620-ACCT-NOTFND)
  9728*    END-EXEC.
  9729*    MOVE '"$I                   ! * #00009125' TO DFHEIV0
  9730     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9731     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9732     MOVE X'2A20233030303039313235' TO DFHEIV0(25:11)
  9733     CALL 'kxdfhei1' USING DFHEIV0
  9734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9735
  9736
  9737
  9738* EXEC CICS STARTBR
  9739*         DATASET   (ACCT-FILE-ID)
  9740*         RIDFLD    (ACCT-KEY)
  9741*    END-EXEC.
  9742     MOVE 0
  9743       TO DFHEIV11
  9744*    MOVE '&,         G          &   #00009129' TO DFHEIV0
  9745     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9746     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9747     MOVE X'2020233030303039313239' TO DFHEIV0(25:11)
  9748     CALL 'kxdfhei1' USING DFHEIV0,
  9749           ACCT-FILE-ID,
  9750           ACCT-KEY,
  9751           DFHEIV99,
  9752           DFHEIV11,
  9753           DFHEIV99
  9754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9755
  9756
  9757 1620-ACCT-LOOP.
  9758
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 181
* EL131.cbl
  9759
  9760* EXEC CICS READNEXT
  9761*         DATASET  (ACCT-FILE-ID)
  9762*         RIDFLD   (ACCT-KEY)
  9763*         SET      (ADDRESS OF ACCOUNT-MASTER)
  9764*    END-EXEC.
  9765     MOVE 0
  9766       TO DFHEIV11
  9767*    MOVE '&.S                   )   #00009136' TO DFHEIV0
  9768     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9769     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9770     MOVE X'2020233030303039313336' TO DFHEIV0(25:11)
  9771     CALL 'kxdfhei1' USING DFHEIV0,
  9772           ACCT-FILE-ID,
  9773           DFHEIV20,
  9774           DFHEIV99,
  9775           ACCT-KEY,
  9776           DFHEIV99,
  9777           DFHEIV11,
  9778           DFHEIV99,
  9779           DFHEIV99
  9780     SET ADDRESS OF ACCOUNT-MASTER TO
  9781         DFHEIV20
  9782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9783
  9784
  9785     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
  9786         GO TO 1620-ACCT-NOTFND.
  9787
  9788     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
  9789        HOLD-EFF     LESS AM-EXPIRATION-DT
  9790         NEXT SENTENCE
  9791     ELSE
  9792         GO TO 1620-ACCT-LOOP.
  9793
  9794     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
  9795         GO TO 1620-ACCT-END-BROWSE.
  9796
  9797     IF LOANBALL GREATER THAN +0
  9798         IF AM-MAX-TOT-BEN NUMERIC  AND
  9799            AM-MAX-TOT-BEN GREATER THAN ZERO
  9800             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
  9801                 MOVE AL-UNBON     TO LOANBALA
  9802                 MOVE -1           TO LOANBALL
  9803                 MOVE 'X'          TO ERROR-SWITCH
  9804                 MOVE ER-7641      TO EMI-ERROR
  9805                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9806
  9807     IF ACVBENEL GREATER THAN +0
  9808         IF AM-MAX-MON-BEN NUMERIC  AND
  9809            AM-MAX-MON-BEN GREATER THAN ZERO
  9810             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
  9811                 MOVE AL-UNBON     TO ACVBENEA
  9812                 MOVE -1           TO ACVBENEL
  9813                 MOVE 'X'          TO ERROR-SWITCH
  9814                 MOVE ER-7642      TO EMI-ERROR
  9815                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9816
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 182
* EL131.cbl
  9817 1620-ACCT-END-BROWSE.
  9818
  9819
  9820* EXEC CICS ENDBR
  9821*         DATASET (ACCT-FILE-ID)
  9822*    END-EXEC.
  9823     MOVE 0
  9824       TO DFHEIV11
  9825*    MOVE '&2                    $   #00009176' TO DFHEIV0
  9826     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9827     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9828     MOVE X'2020233030303039313736' TO DFHEIV0(25:11)
  9829     CALL 'kxdfhei1' USING DFHEIV0,
  9830           ACCT-FILE-ID,
  9831           DFHEIV11,
  9832           DFHEIV99
  9833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9834
  9835
  9836     GO TO 1620-EXIT.
  9837
  9838 1620-ACCT-NOTFND.
  9839
  9840     MOVE -1                     TO MAINTL.
  9841     MOVE 'X'                    TO ERROR-SWITCH.
  9842     MOVE ER-0426                TO EMI-ERROR.
  9843     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9844
  9845 1620-EXIT.
  9846     EXIT.
  9847
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 183
* EL131.cbl
  9849 2000-UPDATE-CLAIM.
  9850
  9851     MOVE SPACES                 TO ERROR-SWITCH.
  9852     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
  9853     MOVE PI-CARRIER             TO CARRIER-CODE.
  9854     MOVE PI-CLAIM-NO            TO CLAIM-NO.
  9855     MOVE PI-CERT-NO             TO CERT-NO.
  9856
  9857     IF DELETE-CLAIM
  9858         GO TO 3000-DELETE-CLAIM.
  9859
  9860     IF  NOT MODIFY-CAP
  9861         MOVE ER-0070            TO EMI-ERROR
  9862         MOVE 'X'                TO ERROR-SWITCH
  9863         MOVE -1                 TO MAINTL
  9864         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9865         GO TO 2000-EXIT.
  9866
  9867     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
  9868     MOVE ZERO                   TO TRLR-SEQ-NO.
  9869
  9870
  9871* EXEC CICS READ UPDATE
  9872*         SET       (ADDRESS OF CLAIM-MASTER)
  9873*         DATASET   (CLMS-FILE-ID)
  9874*         RIDFLD    (MSTR-KEY)
  9875*    END-EXEC.
  9876*    MOVE '&"S        EU         (   #00009214' TO DFHEIV0
  9877     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9878     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9879     MOVE X'2020233030303039323134' TO DFHEIV0(25:11)
  9880     CALL 'kxdfhei1' USING DFHEIV0,
  9881           CLMS-FILE-ID,
  9882           DFHEIV20,
  9883           DFHEIV99,
  9884           MSTR-KEY,
  9885           DFHEIV99,
  9886           DFHEIV99,
  9887           DFHEIV99
  9888     SET ADDRESS OF CLAIM-MASTER TO
  9889         DFHEIV20
  9890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9891
  9892
  9893     if (incl > zeros)
  9894        and (cl-no-of-pmts-made > 0)
  9895        and (hold-incur > low-values)
  9896        and (hold-incur not = cl-incurred-dt)
  9897        if hold-incur > cl-incurred-dt
  9898           move cl-incurred-dt   to dc-bin-date-1
  9899           move hold-incur       to dc-bin-date-2
  9900        else
  9901           move hold-incur       to dc-bin-date-1
  9902           move cl-incurred-dt   to dc-bin-date-2
  9903        end-if
  9904        move '1'                 to dc-option-code
  9905        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9906        if dc-elapsed-days > +60
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 184
* EL131.cbl
  9907           MOVE ER-1663             TO EMI-ERROR
  9908           PERFORM 9900-ERROR-FORMAT
  9909                                 THRU 9900-EXIT
  9910           MOVE -1                  TO MAINTL
  9911           GO TO 8110-SEND-DATA
  9912        end-if
  9913     end-if
  9914     IF (CL-PRIORITY-CD = '8')
  9915        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
  9916             AND 'AMWA' AND 'KMSB')
  9917        MOVE ER-8003             TO EMI-ERROR
  9918        PERFORM 9900-ERROR-FORMAT
  9919                                 THRU 9900-EXIT
  9920        MOVE -1                  TO MAINTL
  9921        GO TO 8110-SEND-DATA
  9922     END-IF
  9923
  9924     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
  9925         MOVE ER-0068            TO EMI-ERROR
  9926         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9927         GO TO 2000-EXIT.
  9928
  9929     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
  9930         MOVE ER-0068            TO EMI-ERROR
  9931         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9932         GO TO 2000-EXIT.
  9933
  9934     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  9935         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
  9936
  9937     IF CL-PURGED-DT NOT = LOW-VALUES
  9938         MOVE ER-7691            TO EMI-ERROR
  9939         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9940         GO TO 2000-EXIT.
  9941
  9942     IF CERT-KEY-CHANGED
  9943         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
  9944
  9945     IF SCREEN-ERROR
  9946         MOVE ER-0068            TO EMI-ERROR
  9947         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9948         GO TO 2000-EXIT.
  9949
  9950     IF NINETY-TRLR-UPDATED
  9951         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
  9952
  9953     IF MSTR-KEY-CHANGED
  9954         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
  9955        ELSE
  9956         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
  9957
  9958     IF TRLR-UPDATE-REQUIRED
  9959         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
  9960
  9961 2000-CHECK-CERT.
  9962     IF NOT CERT-UPDATES
  9963         GO TO 2000-EXIT.
  9964
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 185
* EL131.cbl
  9965     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
  9966     MOVE PI-CARRIER             TO CERT-CARRIER.
  9967     MOVE PI-GROUPING            TO CERT-GROUP.
  9968     MOVE PI-STATE               TO CERT-STATE.
  9969     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
  9970     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
  9971     MOVE PI-CERT-NO             TO CERT-CERT.
  9972
  9973     IF CERT-ALT-KEY-CHANGED
  9974         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
  9975     ELSE
  9976         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
  9977
  9978 2000-EXIT.
  9979     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 186
* EL131.cbl
  9981 2010-RELEASE-REC.
  9982
  9983* EXEC CICS UNLOCK
  9984*         DATASET  (CLMS-FILE-ID)
  9985*    END-EXEC
  9986*    MOVE '&*                    #   #00009309' TO DFHEIV0
  9987     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9988     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9989     MOVE X'2020233030303039333039' TO DFHEIV0(25:11)
  9990     CALL 'kxdfhei1' USING DFHEIV0,
  9991           CLMS-FILE-ID,
  9992           DFHEIV99
  9993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9994
  9995     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9996     MOVE 'X'                    TO ERROR-SWITCH.
  9997
  9998 2010-EXIT.
  9999     EXIT.
 10000
 10001 2020-NORMAL-UPDATE.
 10002     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10003
 10004     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10005
 10006     IF WS-OPEN-CLOSE-SW = 'Y'
 10007       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10008       IF PI-REC-FOUND-SW = 'Y'
 10009         IF CL-ACTIVITY-CODE = 09
 10010           NEXT SENTENCE
 10011         ELSE
 10012           IF WS-RESET-SW = 'Y'
 10013             IF CL-CLAIM-STATUS = 'C'
 10014               MOVE 07               TO  CL-ACTIVITY-CODE
 10015               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10016               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10017             ELSE
 10018               MOVE 08               TO  CL-ACTIVITY-CODE
 10019               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10020               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10021
 10022     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10023         MOVE 'Y'                TO CL-YESNOSW
 10024     END-IF.
 10025
 10026     if pi-company-id = 'DCC'
 10027        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10028        perform 2120-check-pdef  thru 2120-exit
 10029     end-if
 10030
 10031* EXEC CICS HANDLE CONDITION
 10032*         DUPKEY   (2020-EXIT)
 10033*    END-EXEC.
 10034*    MOVE '"$$                   ! + #00009348' TO DFHEIV0
 10035     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10036     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10037     MOVE X'2B20233030303039333438' TO DFHEIV0(25:11)
 10038     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 187
* EL131.cbl
 10039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10040
 10041
 10042
 10043* EXEC CICS REWRITE
 10044*         DATASET   (CLMS-FILE-ID)
 10045*         FROM      (CLAIM-MASTER)
 10046*    END-EXEC.
 10047     MOVE LENGTH OF
 10048      CLAIM-MASTER
 10049       TO DFHEIV11
 10050*    MOVE '&& L                  %   #00009352' TO DFHEIV0
 10051     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10052     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10053     MOVE X'2020233030303039333532' TO DFHEIV0(25:11)
 10054     CALL 'kxdfhei1' USING DFHEIV0,
 10055           CLMS-FILE-ID,
 10056           CLAIM-MASTER,
 10057           DFHEIV11,
 10058           DFHEIV99
 10059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10060
 10061
 10062 2020-EXIT.
 10063     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 188
* EL131.cbl
 10065 2030-KEY-UPDATE.
 10066     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10067
 10068
 10069* EXEC CICS DELETE
 10070*        DATASET  (CLMS-FILE-ID)
 10071*    END-EXEC.
 10072*    MOVE '&(                    &   #00009363' TO DFHEIV0
 10073     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10074     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10075     MOVE X'2020233030303039333633' TO DFHEIV0(25:11)
 10076     CALL 'kxdfhei1' USING DFHEIV0,
 10077           CLMS-FILE-ID,
 10078           DFHEIV99,
 10079           DFHEIV99,
 10080           DFHEIV99,
 10081           DFHEIV99
 10082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10083
 10084
 10085
 10086* EXEC CICS GETMAIN
 10087*         SET      (ADDRESS OF CLAIM-MASTER)
 10088*         LENGTH   (MSTR-LENGTH)
 10089*         INITIMG  (GETMAIN-SPACE)
 10090*    END-EXEC.
 10091*    MOVE ',"IL                  $   #00009367' TO DFHEIV0
 10092     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10093     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10094     MOVE X'2020233030303039333637' TO DFHEIV0(25:11)
 10095     CALL 'kxdfhei1' USING DFHEIV0,
 10096           DFHEIV20,
 10097           MSTR-LENGTH,
 10098           GETMAIN-SPACE
 10099     SET ADDRESS OF CLAIM-MASTER TO
 10100         DFHEIV20
 10101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10102
 10103
 10104     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10105
 10106     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10107
 10108     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10109
 10110     IF WS-OPEN-CLOSE-SW = 'Y'
 10111       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10112         IF PI-REC-FOUND-SW = 'Y'
 10113           IF CL-ACTIVITY-CODE = 09
 10114             NEXT SENTENCE
 10115           ELSE
 10116             IF WS-RESET-SW = 'Y'
 10117               IF CL-CLAIM-STATUS = 'C'
 10118                 MOVE 07             TO  CL-ACTIVITY-CODE
 10119                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10120                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10121               ELSE
 10122                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 189
* EL131.cbl
 10123                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10124                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10125
 10126
 10127* EXEC CICS HANDLE CONDITION
 10128*         DUPKEY    (2030-EXIT)
 10129*    END-EXEC.
 10130*    MOVE '"$$                   ! , #00009395' TO DFHEIV0
 10131     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10132     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10133     MOVE X'2C20233030303039333935' TO DFHEIV0(25:11)
 10134     CALL 'kxdfhei1' USING DFHEIV0
 10135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10136
 10137
 10138** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10139*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10140
 10141     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10142         MOVE 'Y'                TO CL-YESNOSW
 10143     END-IF.
 10144
 10145
 10146* EXEC CICS WRITE
 10147*         DATASET   (CLMS-FILE-ID)
 10148*         RIDFLD    (MSTR-KEY)
 10149*         FROM      (CLAIM-MASTER)
 10150*    END-EXEC.
 10151     MOVE LENGTH OF
 10152      CLAIM-MASTER
 10153       TO DFHEIV11
 10154*    MOVE '&$ L                  ''   #00009406' TO DFHEIV0
 10155     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10156     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10157     MOVE X'2020233030303039343036' TO DFHEIV0(25:11)
 10158     CALL 'kxdfhei1' USING DFHEIV0,
 10159           CLMS-FILE-ID,
 10160           CLAIM-MASTER,
 10161           DFHEIV11,
 10162           MSTR-KEY,
 10163           DFHEIV99,
 10164           DFHEIV99
 10165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10166
 10167
 10168 2030-EXIT.
 10169     EXIT.
 10170
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 190
* EL131.cbl
 10172 2040-NORMAL-UPDATE.
 10173
 10174* EXEC CICS READ UPDATE
 10175*         DATASET  (CERT-FILE-ID)
 10176*         RIDFLD   (CERT-KEY)
 10177*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10178*    END-EXEC.
 10179*    MOVE '&"S        EU         (   #00009417' TO DFHEIV0
 10180     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10181     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10182     MOVE X'2020233030303039343137' TO DFHEIV0(25:11)
 10183     CALL 'kxdfhei1' USING DFHEIV0,
 10184           CERT-FILE-ID,
 10185           DFHEIV20,
 10186           DFHEIV99,
 10187           CERT-KEY,
 10188           DFHEIV99,
 10189           DFHEIV99,
 10190           DFHEIV99
 10191     SET ADDRESS OF CERTIFICATE-MASTER TO
 10192         DFHEIV20
 10193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10194
 10195
 10196     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10197
 10198
 10199* EXEC CICS HANDLE CONDITION
 10200*         DUPKEY   (2040-EXIT)
 10201*    END-EXEC.
 10202*    MOVE '"$$                   ! - #00009425' TO DFHEIV0
 10203     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10204     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10205     MOVE X'2D20233030303039343235' TO DFHEIV0(25:11)
 10206     CALL 'kxdfhei1' USING DFHEIV0
 10207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10208
 10209
 10210
 10211* EXEC CICS REWRITE
 10212*         DATASET  (CERT-FILE-ID)
 10213*         FROM     (CERTIFICATE-MASTER)
 10214*    END-EXEC.
 10215     MOVE LENGTH OF
 10216      CERTIFICATE-MASTER
 10217       TO DFHEIV11
 10218*    MOVE '&& L                  %   #00009429' TO DFHEIV0
 10219     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10220     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10221     MOVE X'2020233030303039343239' TO DFHEIV0(25:11)
 10222     CALL 'kxdfhei1' USING DFHEIV0,
 10223           CERT-FILE-ID,
 10224           CERTIFICATE-MASTER,
 10225           DFHEIV11,
 10226           DFHEIV99
 10227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10228
 10229
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 191
* EL131.cbl
 10230 2040-EXIT.
 10231     EXIT.
 10232
 10233 2050-KEY-UPDATE.
 10234
 10235* EXEC CICS READ UPDATE
 10236*         DATASET  (CERT-FILE-ID)
 10237*         RIDFLD   (CERT-KEY)
 10238*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10239*    END-EXEC.
 10240*    MOVE '&"S        EU         (   #00009438' TO DFHEIV0
 10241     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10242     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10243     MOVE X'2020233030303039343338' TO DFHEIV0(25:11)
 10244     CALL 'kxdfhei1' USING DFHEIV0,
 10245           CERT-FILE-ID,
 10246           DFHEIV20,
 10247           DFHEIV99,
 10248           CERT-KEY,
 10249           DFHEIV99,
 10250           DFHEIV99,
 10251           DFHEIV99
 10252     SET ADDRESS OF CERTIFICATE-MASTER TO
 10253         DFHEIV20
 10254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10255
 10256
 10257     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10258
 10259
 10260* EXEC CICS DELETE
 10261*         DATASET   (CERT-FILE-ID)
 10262*    END-EXEC.
 10263*    MOVE '&(                    &   #00009446' TO DFHEIV0
 10264     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10265     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10266     MOVE X'2020233030303039343436' TO DFHEIV0(25:11)
 10267     CALL 'kxdfhei1' USING DFHEIV0,
 10268           CERT-FILE-ID,
 10269           DFHEIV99,
 10270           DFHEIV99,
 10271           DFHEIV99,
 10272           DFHEIV99
 10273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10274
 10275
 10276
 10277* EXEC CICS GETMAIN
 10278*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10279*         LENGTH    (CERT-LENGTH)
 10280*         INITIMG   (GETMAIN-SPACE)
 10281*    END-EXEC.
 10282*    MOVE ',"IL                  $   #00009450' TO DFHEIV0
 10283     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10284     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10285     MOVE X'2020233030303039343530' TO DFHEIV0(25:11)
 10286     CALL 'kxdfhei1' USING DFHEIV0,
 10287           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 192
* EL131.cbl
 10288           CERT-LENGTH,
 10289           GETMAIN-SPACE
 10290     SET ADDRESS OF CERTIFICATE-MASTER TO
 10291         DFHEIV20
 10292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10293
 10294
 10295     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 10296
 10297     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10298
 10299
 10300* EXEC CICS HANDLE CONDITION
 10301*         DUPKEY (2050-EXIT)
 10302*    END-EXEC.
 10303*    MOVE '"$$                   ! . #00009460' TO DFHEIV0
 10304     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10305     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10306     MOVE X'2E20233030303039343630' TO DFHEIV0(25:11)
 10307     CALL 'kxdfhei1' USING DFHEIV0
 10308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10309
 10310
 10311
 10312* EXEC CICS WRITE
 10313*         DATASET  (CERT-FILE-ID)
 10314*         RIDFLD   (CERT-KEY)
 10315*         FROM     (CERTIFICATE-MASTER)
 10316*    END-EXEC.
 10317     MOVE LENGTH OF
 10318      CERTIFICATE-MASTER
 10319       TO DFHEIV11
 10320*    MOVE '&$ L                  ''   #00009464' TO DFHEIV0
 10321     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10322     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10323     MOVE X'2020233030303039343634' TO DFHEIV0(25:11)
 10324     CALL 'kxdfhei1' USING DFHEIV0,
 10325           CERT-FILE-ID,
 10326           CERTIFICATE-MASTER,
 10327           DFHEIV11,
 10328           CERT-KEY,
 10329           DFHEIV99,
 10330           DFHEIV99
 10331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10332
 10333
 10334 2050-EXIT.
 10335     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 193
* EL131.cbl
 10337 2060-CHANGE-CERT.
 10338     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10339     MOVE PI-CARRIER             TO CERT-CARRIER.
 10340     MOVE PI-GROUPING            TO CERT-GROUP.
 10341     MOVE PI-STATE               TO CERT-STATE.
 10342     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10343     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10344     MOVE PI-CERT-NO             TO CERT-CERT.
 10345     IF CERTEFFI GREATER THAN LOW-VALUES
 10346         MOVE HOLD-EFF           TO CERT-DATE.
 10347     IF CERTACTI GREATER THAN LOW-VALUES
 10348         MOVE CERTACTI           TO CERT-ACCOUNT.
 10349     IF CERTSTI GREATER THAN LOW-VALUES
 10350         MOVE CERTSTI            TO CERT-STATE.
 10351     IF CERTCARI GREATER THAN LOW-VALUES
 10352         MOVE CERTCARI           TO CERT-CARRIER.
 10353     IF CERTGRPI GREATER THAN LOW-VALUES
 10354         MOVE CERTGRPI           TO CERT-GROUP.
 10355     IF CERTI GREATER THAN LOW-VALUES
 10356         MOVE CERTI              TO CERT-CERT-PRIME.
 10357     IF SUFXI GREATER THAN LOW-VALUES
 10358         MOVE SUFXI              TO CERT-CERT-SUFX.
 10359
 10360
 10361* EXEC CICS HANDLE CONDITION
 10362*         NOTFND   (2060-CERT-NOTFND)
 10363*    END-EXEC.
 10364*    MOVE '"$I                   ! / #00009496' TO DFHEIV0
 10365     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10367     MOVE X'2F20233030303039343936' TO DFHEIV0(25:11)
 10368     CALL 'kxdfhei1' USING DFHEIV0
 10369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10370
 10371
 10372
 10373* EXEC CICS READ UPDATE
 10374*         DATASET  (CERT-FILE-ID)
 10375*         RIDFLD   (CERT-KEY)
 10376*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10377*    END-EXEC.
 10378*    MOVE '&"S        EU         (   #00009500' TO DFHEIV0
 10379     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10380     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10381     MOVE X'2020233030303039353030' TO DFHEIV0(25:11)
 10382     CALL 'kxdfhei1' USING DFHEIV0,
 10383           CERT-FILE-ID,
 10384           DFHEIV20,
 10385           DFHEIV99,
 10386           CERT-KEY,
 10387           DFHEIV99,
 10388           DFHEIV99,
 10389           DFHEIV99
 10390     SET ADDRESS OF CERTIFICATE-MASTER TO
 10391         DFHEIV20
 10392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10393
 10394
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 194
* EL131.cbl
 10395     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 10396
 10397     IF CM-CLAIM-INTERFACE-SW = SPACES
 10398        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10399
 10400
 10401* EXEC CICS HANDLE CONDITION
 10402*         DUPKEY   (2060-DUPKEY)
 10403*    END-EXEC.
 10404*    MOVE '"$$                   ! 0 #00009511' TO DFHEIV0
 10405     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10406     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10407     MOVE X'3020233030303039353131' TO DFHEIV0(25:11)
 10408     CALL 'kxdfhei1' USING DFHEIV0
 10409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10410
 10411
 10412
 10413* EXEC CICS REWRITE
 10414*         DATASET  (CERT-FILE-ID)
 10415*         FROM     (CERTIFICATE-MASTER)
 10416*    END-EXEC.
 10417     MOVE LENGTH OF
 10418      CERTIFICATE-MASTER
 10419       TO DFHEIV11
 10420*    MOVE '&& L                  %   #00009515' TO DFHEIV0
 10421     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10422     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10423     MOVE X'2020233030303039353135' TO DFHEIV0(25:11)
 10424     CALL 'kxdfhei1' USING DFHEIV0,
 10425           CERT-FILE-ID,
 10426           CERTIFICATE-MASTER,
 10427           DFHEIV11,
 10428           DFHEIV99
 10429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10430
 10431
 10432 2060-DUPKEY.
 10433
 10434     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10435
 10436 2060-CHANGE-TRLR-ACTQ.
 10437     IF SCREEN-ERROR
 10438         GO TO 2060-EXIT.
 10439
 10440     IF CERTI    GREATER LOW-VALUES OR
 10441        SUFXI    GREATER LOW-VALUES OR
 10442        CERTCARI GREATER LOW-VALUES
 10443         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 10444         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 10445
 10446     MOVE SPACES                 TO CERT-KEY-SWITCH
 10447                                    CERT-SWITCH
 10448                                    TRLR-SWITCH
 10449                                    NINETY-TRLR-SWITCH.
 10450     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 10451     GO TO 2060-EXIT.
 10452
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 195
* EL131.cbl
 10453 2060-CERT-NOTFND.
 10454     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10455
 10456     IF WS-REC-FOUND-SW = 'N'
 10457         MOVE ER-0206            TO  EMI-ERROR
 10458         MOVE -1                 TO  MAINTL
 10459         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10460
 10461* EXEC CICS UNLOCK
 10462*            DATASET   (CLMS-FILE-ID)
 10463*        END-EXEC
 10464*    MOVE '&*                    #   #00009548' TO DFHEIV0
 10465     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10466     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10467     MOVE X'2020233030303039353438' TO DFHEIV0(25:11)
 10468     CALL 'kxdfhei1' USING DFHEIV0,
 10469           CLMS-FILE-ID,
 10470           DFHEIV99
 10471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10472         GO TO 8110-SEND-DATA.
 10473
 10474     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 10475
 10476     GO TO 2060-CHANGE-TRLR-ACTQ.
 10477
 10478 2060-EXIT.
 10479     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 196
* EL131.cbl
 10481 2070-CHECK-OLD.
 10482
 10483
 10484* EXEC CICS HANDLE CONDITION
 10485*        NOTFND   (2070-NOT-FOUND)
 10486*    END-EXEC.
 10487*    MOVE '"$I                   ! 1 #00009562' TO DFHEIV0
 10488     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10489     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10490     MOVE X'3120233030303039353632' TO DFHEIV0(25:11)
 10491     CALL 'kxdfhei1' USING DFHEIV0
 10492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10493
 10494
 10495     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10496     MOVE PI-CARRIER             TO CERT-CARRIER.
 10497     MOVE PI-GROUPING            TO CERT-GROUP.
 10498     MOVE PI-STATE               TO CERT-STATE.
 10499     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10500     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10501     MOVE PI-CERT-NO             TO CERT-CERT.
 10502
 10503
 10504* EXEC CICS READ UPDATE
 10505*         DATASET  (CERT-FILE-ID)
 10506*         RIDFLD   (CERT-KEY)
 10507*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10508*    END-EXEC.
 10509*    MOVE '&"S        EU         (   #00009574' TO DFHEIV0
 10510     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10511     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10512     MOVE X'2020233030303039353734' TO DFHEIV0(25:11)
 10513     CALL 'kxdfhei1' USING DFHEIV0,
 10514           CERT-FILE-ID,
 10515           DFHEIV20,
 10516           DFHEIV99,
 10517           CERT-KEY,
 10518           DFHEIV99,
 10519           DFHEIV99,
 10520           DFHEIV99
 10521     SET ADDRESS OF CERTIFICATE-MASTER TO
 10522         DFHEIV20
 10523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10524
 10525
 10526     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 10527     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 10528     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 10529
 10530     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 10531         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 10532
 10533     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10534       AND
 10535        CERT-WAS-CREATED-FOR-CLAIM
 10536         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 10537
 10538* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 197
* EL131.cbl
 10539*             DATASET   (CERT-FILE-ID)
 10540*        END-EXEC
 10541*    MOVE '&(                    &   #00009591' TO DFHEIV0
 10542     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10543     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10544     MOVE X'2020233030303039353931' TO DFHEIV0(25:11)
 10545     CALL 'kxdfhei1' USING DFHEIV0,
 10546           CERT-FILE-ID,
 10547           DFHEIV99,
 10548           DFHEIV99,
 10549           DFHEIV99,
 10550           DFHEIV99
 10551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10552         GO TO 2070-EXIT.
 10553
 10554     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10555         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10556
 10557
 10558* EXEC CICS HANDLE CONDITION
 10559*         DUPKEY   (2070-EXIT)
 10560*    END-EXEC.
 10561*    MOVE '"$$                   ! 2 #00009599' TO DFHEIV0
 10562     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10563     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10564     MOVE X'3220233030303039353939' TO DFHEIV0(25:11)
 10565     CALL 'kxdfhei1' USING DFHEIV0
 10566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10567
 10568
 10569
 10570* EXEC CICS REWRITE
 10571*         DATASET  (CERT-FILE-ID)
 10572*         FROM     (CERTIFICATE-MASTER)
 10573*    END-EXEC.
 10574     MOVE LENGTH OF
 10575      CERTIFICATE-MASTER
 10576       TO DFHEIV11
 10577*    MOVE '&& L                  %   #00009603' TO DFHEIV0
 10578     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10579     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10580     MOVE X'2020233030303039363033' TO DFHEIV0(25:11)
 10581     CALL 'kxdfhei1' USING DFHEIV0,
 10582           CERT-FILE-ID,
 10583           CERTIFICATE-MASTER,
 10584           DFHEIV11,
 10585           DFHEIV99
 10586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10587
 10588
 10589     GO TO 2070-EXIT.
 10590
 10591 2070-NOT-FOUND.
 10592     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 10593
 10594 2070-EXIT.
 10595     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 198
* EL131.cbl
 10597 2080-CREATE-CERT.
 10598
 10599* EXEC CICS GETMAIN
 10600*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10601*         LENGTH    (CERT-LENGTH)
 10602*         INITIMG   (GETMAIN-SPACE)
 10603*    END-EXEC.
 10604*    MOVE ',"IL                  $   #00009617' TO DFHEIV0
 10605     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10606     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10607     MOVE X'2020233030303039363137' TO DFHEIV0(25:11)
 10608     CALL 'kxdfhei1' USING DFHEIV0,
 10609           DFHEIV20,
 10610           CERT-LENGTH,
 10611           GETMAIN-SPACE
 10612     SET ADDRESS OF CERTIFICATE-MASTER TO
 10613         DFHEIV20
 10614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10615
 10616
 10617     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 10618
 10619     IF CERTEFFI GREATER THAN LOW-VALUES
 10620         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 10621                                    DC-BIN-DATE-1
 10622         MOVE '6'                TO DC-OPTION-CODE
 10623         MOVE +1                 TO DC-ELAPSED-MONTHS
 10624         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10625         IF NO-CONVERSION-ERROR
 10626             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 10627
 10628     IF CERTACTI GREATER THAN LOW-VALUES
 10629         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 10630     IF CERTSTI GREATER THAN LOW-VALUES
 10631         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 10632     IF CERTCARI GREATER THAN LOW-VALUES
 10633         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 10634     IF CERTGRPI GREATER THAN LOW-VALUES
 10635         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 10636     IF CERTI GREATER THAN LOW-VALUES
 10637         MOVE CERTI              TO CERT-CERT-PRIME
 10638                                    CM-CERT-PRIME
 10639         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10640
 10641     IF SUFXI GREATER THAN LOW-VALUES
 10642         MOVE SUFXI              TO CERT-CERT-SUFX
 10643                                    CM-CERT-SFX
 10644         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10645
 10646     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10647
 10648     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10649
 10650     MOVE SPACES                 TO CM-ENTRY-BATCH
 10651                                    CM-LF-EXIT-BATCH
 10652                                    CM-AH-EXIT-BATCH
 10653                                    CM-CREDIT-INTERFACE-SW-1
 10654                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 199
* EL131.cbl
 10655
 10656     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10657                               '9' OR 'D' OR 'V'
 10658         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 10659
 10660     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10661                               '9' OR 'D' OR 'V'
 10662         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 10663
 10664     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 10665                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 10666     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 10667
 10668
 10669* EXEC CICS HANDLE CONDITION
 10670*         DUPKEY (2080-EXIT)
 10671*    END-EXEC.
 10672*    MOVE '"$$                   ! 3 #00009674' TO DFHEIV0
 10673     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10674     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10675     MOVE X'3320233030303039363734' TO DFHEIV0(25:11)
 10676     CALL 'kxdfhei1' USING DFHEIV0
 10677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10678
 10679
 10680
 10681* EXEC CICS WRITE
 10682*         DATASET  (CERT-FILE-ID)
 10683*         RIDFLD   (CERT-KEY)
 10684*         FROM     (CERTIFICATE-MASTER)
 10685*    END-EXEC.
 10686     MOVE LENGTH OF
 10687      CERTIFICATE-MASTER
 10688       TO DFHEIV11
 10689*    MOVE '&$ L                  ''   #00009678' TO DFHEIV0
 10690     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10691     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10692     MOVE X'2020233030303039363738' TO DFHEIV0(25:11)
 10693     CALL 'kxdfhei1' USING DFHEIV0,
 10694           CERT-FILE-ID,
 10695           CERTIFICATE-MASTER,
 10696           DFHEIV11,
 10697           CERT-KEY,
 10698           DFHEIV99,
 10699           DFHEIV99
 10700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10701
 10702
 10703 2080-EXIT.
 10704     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 200
* EL131.cbl
 10706 2100-MOVE-MSTR.
 10707     IF TYPEI GREATER THAN LOW-VALUES
 10708         MOVE TYPEI              TO CL-CLAIM-TYPE.
 10709
 10710     IF STATUSI = LOW-VALUES
 10711         GO TO 2100-NO-STATUS-CHANGE.
 10712
 10713     IF STATUSI = 'OPEN' OR 'O'
 10714         IF CL-CLAIM-STATUS = 'O'
 10715             MOVE SPACES         TO TRLR-SWITCH
 10716                 GO TO 2100-NO-STATUS-CHANGE.
 10717
 10718     IF STATUSI = 'CLOSED' OR 'C'
 10719         IF CL-CLAIM-STATUS = 'C'
 10720             MOVE SPACES         TO TRLR-SWITCH
 10721                 GO TO 2100-NO-STATUS-CHANGE.
 10722
 10723     IF PI-COMPANY-ID = 'DMD'
 10724        IF STATUSI = 'OPEN' OR 'O'
 10725           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 10726              MOVE ZERO       TO STATUSL
 10727              MOVE LOW-VALUES TO STATUSI
 10728              GO TO 2100-NO-STATUS-CHANGE.
 10729
 10730     IF PI-COMPANY-ID = 'DMD'
 10731         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 10732
 10733     MOVE STATUSI                TO CL-CLAIM-STATUS.
 10734
 10735 2100-NO-STATUS-CHANGE.
 10736
 10737     IF CCNOI GREATER THAN LOW-VALUES
 10738         MOVE CCNOI              TO CL-CCN.
 10739
 10740     IF PROCI GREATER THAN LOW-VALUES
 10741         MOVE PROCI              TO CL-PROCESSOR-ID.
 10742
 10743     if accswi > low-values
 10744        and accswi = 'Y' OR 'N'
 10745        move accswi              to cl-accident-claim-sw
 10746     end-if
 10747     IF SEXI GREATER THAN LOW-VALUES
 10748         MOVE SEXI               TO CL-INSURED-SEX-CD.
 10749
 10750     IF BIRTHI GREATER THAN LOW-VALUES
 10751         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 10752
 10753     IF SOCIALI GREATER THAN LOW-VALUES
 10754       AND
 10755        SOCIALI = SPACES
 10756         MOVE CL-CERT-STATE      TO CL-SSN-STATE
 10757         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 10758         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 10759     ELSE
 10760         IF SOCIALI GREATER THAN LOW-VALUES
 10761             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 10762
 10763     IF OCCI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 201
* EL131.cbl
 10764         MOVE OCCI               TO CL-INSURED-OCC-CD.
 10765
 10766     IF BENEL GREATER THAN ZERO
 10767         MOVE BENEI              TO CL-BENEFICIARY.
 10768
 10769     IF DIAGI GREATER THAN LOW-VALUES
 10770         MOVE DIAGI              TO WS-DIAGNOSIS.
 10771
 10772     IF PREMTYPI GREATER THAN LOW-VALUES
 10773         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 10774
 10775     IF CAUSEI GREATER THAN LOW-VALUES
 10776         MOVE CAUSEI             TO CL-CAUSE-CD.
 10777
 10778     IF ENDI GREATER THAN LOW-VALUES
 10779         MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 10780
 10781     IF PDTHRUI GREATER THAN LOW-VALUES
 10782        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 10783
 10784     IF PDAMTL GREATER THAN +0
 10785        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 10786
 10787     IF NODAYSI GREATER THAN LOW-VALUES
 10788        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 10789
 10790     IF NOPMTSI GREATER THAN LOW-VALUES
 10791        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 10792
 10793     IF FORMTYPI GREATER THAN LOW-VALUES
 10794        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 10795
 10796     IF INCI GREATER THAN LOW-VALUES
 10797        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 10798
 10799     IF REPI GREATER THAN LOW-VALUES
 10800        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 10801
 10802     IF ADDONDTI GREATER THAN LOW-VALUES
 10803        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 10804
 10805     IF PRICDI GREATER THAN LOW-VALUES
 10806         MOVE PRICDI             TO CL-PRIORITY-CD.
 10807
 10808     IF CRITPTL > ZEROS
 10809        MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 10810     END-IF
 10811
 10812     IF RTWMOSL > ZEROS
 10813        MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 10814     END-IF
 10815     IF FILETOI GREATER THAN LOW-VALUES
 10816         MOVE FILETOI            TO CL-FILE-LOCATION.
 10817
 10818     IF SUPVI GREATER THAN LOW-VALUES
 10819         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 10820
 10821     IF MLNAMEI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 202
* EL131.cbl
 10822         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 10823
 10824     IF MFNAMEI GREATER THAN LOW-VALUES
 10825         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 10826
 10827     IF MMINITI GREATER THAN LOW-VALUES
 10828         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 10829
 10830     IF CERTEFFI GREATER THAN LOW-VALUES
 10831         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 10832
 10833     IF CERTACTI GREATER THAN LOW-VALUES
 10834         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 10835
 10836     IF CERTSTI GREATER THAN LOW-VALUES
 10837         MOVE CERTSTI            TO CL-CERT-STATE.
 10838
 10839     IF CERTCARI GREATER THAN LOW-VALUES
 10840         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 10841                                    CL-CARRIER.
 10842
 10843     IF CERTGRPI GREATER THAN LOW-VALUES
 10844         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 10845
 10846     IF CERTI GREATER THAN LOW-VALUES
 10847         MOVE CERTI              TO CERT-NO-PRIME.
 10848
 10849     IF SUFXI GREATER THAN LOW-VALUES
 10850         MOVE SUFXI              TO CERT-NO-SUFX.
 10851
 10852     MOVE CERT-NO                TO CL-CERT-NO
 10853                                    CL-CERT-NO-A4.
 10854
 10855     IF PI-COMPANY-ID = 'FLA'
 10856          NEXT SENTENCE
 10857     ELSE
 10858         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 10859         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 10860         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 10861         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 10862
 10863     IF TRLR-UPDATE-REQUIRED
 10864        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 10865        MOVE ZEROS              TO TRLR-SEQ-NO
 10866
 10867* EXEC CICS READ
 10868*            DATASET   (TRLR-FILE-ID)
 10869*            RIDFLD    (TRLR-KEY)
 10870*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10871*       END-EXEC
 10872*    MOVE '&"S        E          (   #00009847' TO DFHEIV0
 10873     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10874     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10875     MOVE X'2020233030303039383437' TO DFHEIV0(25:11)
 10876     CALL 'kxdfhei1' USING DFHEIV0,
 10877           TRLR-FILE-ID,
 10878           DFHEIV20,
 10879           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 203
* EL131.cbl
 10880           TRLR-KEY,
 10881           DFHEIV99,
 10882           DFHEIV99,
 10883           DFHEIV99
 10884     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10885         DFHEIV20
 10886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10887        IF AT-TRAILER-TYPE = '1'
 10888           MOVE +1 TO MISC-SUB
 10889           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 10890           MISC-SUB GREATER THAN +6 OR
 10891           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 10892           IF MISC-SUB GREATER THAN +1
 10893              SUBTRACT +1 FROM MISC-SUB
 10894              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 10895                 GO TO 2100-BYPASS-LAST-UPDATE.
 10896
 10897     IF TRLR-UPDATE-REQUIRED AND
 10898        CLAIM-IS-OPEN
 10899         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 10900     ELSE
 10901         IF TRLR-UPDATE-REQUIRED AND
 10902            CLAIM-IS-CLOSED
 10903             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 10904             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 10905
 10906 2100-BYPASS-LAST-UPDATE.
 10907     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10908     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 10909
 10910     GO TO 2100-EXIT.
 10911
 10912 2100-BUMP-OPEN-CLOSE-HIST.
 10913     ADD +1                      TO MISC-SUB.
 10914
 10915 2100-EXIT.
 10916     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 204
* EL131.cbl
 10918 2120-check-pdef.
 10919
 10920
 10921     move +0                     to s1
 10922     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 10923     move spaces                 to ws-dcc-error-line
 10924     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 10925     IF ERPDEF-FOUND
 10926        perform 2130-check-trlr  thru 2130-exit
 10927        move +1                  to s1
 10928*       if cl-accident-claim-sw = ' '
 10929*          move er-1655             to ws-error-no (s1)
 10930*          add +1 to s1
 10931*       end-if
 10932        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 10933        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 10934        MOVE '1'                 TO DC-OPTION-CODE
 10935        MOVE +0                  TO DC-ELAPSED-MONTHS
 10936                                    DC-ELAPSED-DAYS
 10937        PERFORM 9800-CONVERT-DATE
 10938                                 THRU 9800-EXIT
 10939        IF NO-CONVERSION-ERROR
 10940           MOVE DC-ELAPSED-MONTHS
 10941                                 TO WS-MONTHS-BETWEEN
 10942           IF DC-ELAPSED-DAYS > 1
 10943              ADD 1 TO WS-MONTHS-BETWEEN
 10944           END-IF
 10945        ELSE
 10946           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 10947        END-IF
 10948        IF (WS-EXCL-PERIOD = ZEROS)
 10949           OR (WS-MONTHS-BETWEEN = ZEROS)
 10950           CONTINUE
 10951        ELSE
 10952           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 10953              MOVE ER-1651       TO ws-error-no (s1)
 10954              add +1             to s1
 10955           END-IF
 10956        END-IF
 10957        IF (WS-COV-ENDS = ZEROS)
 10958           OR (WS-MONTHS-BETWEEN = ZEROS)
 10959           CONTINUE
 10960        ELSE
 10961           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 10962              MOVE -1            TO MAINTL
 10963              MOVE ER-1653       TO ws-error-no (s1)
 10964              add +1 to s1
 10965           END-IF
 10966        END-IF
 10967        IF (WS-ACC-PERIOD = ZEROS)
 10968           OR (WS-MONTHS-BETWEEN = ZEROS)
 10969           CONTINUE
 10970        ELSE
 10971           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
 10972              and (cl-accident-claim-sw = ' ')
 10973              move er-1655       to ws-error-no (s1)
 10974              add +1             to s1
 10975           end-if
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 205
* EL131.cbl
 10976           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 10977              if cl-accident-claim-sw not = 'Y'
 10978                 MOVE ER-1652    TO ws-error-no (s1)
 10979              else
 10980                 move er-1662    to ws-error-no (s1)
 10981              end-if
 10982              MOVE -1            TO MAINTL
 10983              add +1             to s1
 10984           END-IF
 10985        END-IF
 10986        if cl-claim-type  = 'I'
 10987           move er-1661          to ws-error-no (s1)
 10988           add +1                to s1
 10989        end-if
 10990        perform 2130-check-trlr  thru 2130-exit
 10991     END-IF
 10992
 10993     .
 10994 2120-exit.
 10995     exit.
 10996
 10997 2130-check-trlr.
 10998
 10999     evaluate true
 11000        when s1 = +0
 11001           move cl-control-primary
 11002                                 to trlr-key
 11003           MOVE +95              TO TRLR-SEQ-NO
 11004
 11005* EXEC CICS READ
 11006*             update
 11007*             DATASET  ('ELTRLR')
 11008*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11009*             RIDFLD   (TRLR-KEY)
 11010*             RESP     (WS-RESPONSE)
 11011*          END-EXEC
 11012     MOVE 'ELTRLR' TO DFHEIV1
 11013*    MOVE '&"S        EU         (  N#00009969' TO DFHEIV0
 11014     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11015     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11016     MOVE X'204E233030303039393639' TO DFHEIV0(25:11)
 11017     CALL 'kxdfhei1' USING DFHEIV0,
 11018           DFHEIV1,
 11019           DFHEIV20,
 11020           DFHEIV99,
 11021           TRLR-KEY,
 11022           DFHEIV99,
 11023           DFHEIV99,
 11024           DFHEIV99
 11025     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11026         DFHEIV20
 11027     MOVE EIBRESP  TO WS-RESPONSE
 11028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11029           if ws-resp-normal
 11030              move spaces        to at-info-line-1
 11031           end-if
 11032        when s1 = +1
 11033           if ws-resp-normal
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 206
* EL131.cbl
 11034
 11035* exec cics rewrite
 11036*                dataset   ('ELTRLR')
 11037*                from      (activity-trailers)
 11038*             end-exec
 11039     MOVE LENGTH OF
 11040      activity-trailers
 11041       TO DFHEIV11
 11042     MOVE 'ELTRLR' TO DFHEIV1
 11043*    MOVE '&& L                  %   #00009981' TO DFHEIV0
 11044     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11045     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11046     MOVE X'2020233030303039393831' TO DFHEIV0(25:11)
 11047     CALL 'kxdfhei1' USING DFHEIV0,
 11048           DFHEIV1,
 11049           activity-trailers,
 11050           DFHEIV11,
 11051           DFHEIV99
 11052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11053           end-if
 11054        when s1 > +1
 11055           if ws-resp-normal
 11056              move ws-dcc-error-line
 11057                                 to at-info-line-1
 11058
 11059* exec cics rewrite
 11060*                dataset   ('ELTRLR')
 11061*                from      (activity-trailers)
 11062*             end-exec
 11063     MOVE LENGTH OF
 11064      activity-trailers
 11065       TO DFHEIV11
 11066     MOVE 'ELTRLR' TO DFHEIV1
 11067*    MOVE '&& L                  %   #00009990' TO DFHEIV0
 11068     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11069     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11070     MOVE X'2020233030303039393930' TO DFHEIV0(25:11)
 11071     CALL 'kxdfhei1' USING DFHEIV0,
 11072           DFHEIV1,
 11073           activity-trailers,
 11074           DFHEIV11,
 11075           DFHEIV99
 11076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11077           else
 11078
 11079* EXEC CICS GETMAIN
 11080*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11081*                LENGTH   (TRLR-LENGTH)
 11082*                INITIMG  (GETMAIN-SPACE)
 11083*             END-EXEC
 11084*    MOVE ',"IL                  $   #00009995' TO DFHEIV0
 11085     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11086     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11087     MOVE X'2020233030303039393935' TO DFHEIV0(25:11)
 11088     CALL 'kxdfhei1' USING DFHEIV0,
 11089           DFHEIV20,
 11090           TRLR-LENGTH,
 11091           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 207
* EL131.cbl
 11092     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11093         DFHEIV20
 11094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11095              move 'AT'          to at-record-id
 11096              move cl-control-primary
 11097                                 to at-control-primary
 11098              move +95           to at-sequence-no
 11099              move '6'           to at-trailer-type
 11100              move ws-dcc-error-line
 11101                                 to at-info-line-1
 11102              move 'E'           to at-info-trailer-type
 11103              move save-bin-date to at-recorded-dt
 11104                                    at-gen-info-last-maint-dt
 11105              move pi-processor-id
 11106                                 to at-recorded-by
 11107                                    at-gen-info-last-updated-by
 11108              move eibtime       to at-last-maint-hhmmss
 11109
 11110* exec cics write
 11111*                dataset   ('ELTRLR')
 11112*                from      (activity-trailers)
 11113*                ridfld    (trlr-key)
 11114*             end-exec
 11115     MOVE LENGTH OF
 11116      activity-trailers
 11117       TO DFHEIV11
 11118     MOVE 'ELTRLR' TO DFHEIV1
 11119*    MOVE '&$ L                  ''   #00010014' TO DFHEIV0
 11120     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11121     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11122     MOVE X'2020233030303130303134' TO DFHEIV0(25:11)
 11123     CALL 'kxdfhei1' USING DFHEIV0,
 11124           DFHEIV1,
 11125           activity-trailers,
 11126           DFHEIV11,
 11127           trlr-key,
 11128           DFHEIV99,
 11129           DFHEIV99
 11130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11131              perform varying s1 from +1 by +1 until
 11132                 ws-error-no (s1) = spaces
 11133                 move ws-error-no (s1)
 11134                                 to emi-error
 11135                 PERFORM 9900-ERROR-FORMAT
 11136                                 THRU 9900-EXIT
 11137              end-perform
 11138           end-if
 11139     end-evaluate
 11140
 11141     .
 11142 2130-exit.
 11143     exit.
 11144 2200-MOVE-CERT.
 11145     IF CRTLNMEI GREATER THAN LOW-VALUES
 11146         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 11147
 11148     IF CRTFNMEI GREATER THAN LOW-VALUES
 11149         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 208
* EL131.cbl
 11150         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 11151
 11152     IF CRTINITI GREATER THAN LOW-VALUES
 11153         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 11154
 11155     IF CM-INSURED-INITIALS = SPACES
 11156         MOVE '**'               TO CM-INSURED-INITIALS.
 11157
 11158     IF ISSAGEI GREATER THAN LOW-VALUES
 11159         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 11160
 11161     IF JNTFNMEI GREATER THAN LOW-VALUES
 11162         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 11163
 11164     IF JNTLNMEI GREATER THAN LOW-VALUES
 11165         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 11166
 11167     IF JNTINITI GREATER THAN LOW-VALUES
 11168         MOVE JNTINITI           TO CM-JT-INITIAL.
 11169
 11170     IF JNTAGEI GREATER THAN LOW-VALUES
 11171         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 11172
 11173     IF ADDONDTI GREATER THAN LOW-VALUES
 11174        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 11175
 11176     IF LCVCDI GREATER THAN LOW-VALUES
 11177        IF LCVCDI = SPACES OR ZEROS
 11178           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 11179        ELSE
 11180           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 11181
 11182     IF LCVOTRMI GREATER THAN LOW-VALUES
 11183         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 11184
 11185     IF LCVRATEL GREATER THAN +0
 11186         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 11187
 11188     IF LCVBENEL GREATER THAN +0
 11189         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 11190
 11191     IF LCVFORMI GREATER THAN LOW-VALUES
 11192         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 11193
 11194     IF LCVCNDTI = LOW-VALUES
 11195        GO TO 2210-SET-STATUS.
 11196
 11197     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 11198        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 11199        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 11200        GO TO 2210-SET-STATUS.
 11201
 11202     IF CM-LF-CURRENT-STATUS = '7'
 11203        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 11204        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 11205        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11206                                    CM-LF-DEATH-DT
 11207        GO TO 2210-SET-STATUS.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 209
* EL131.cbl
 11208
 11209     IF CM-LF-CURRENT-STATUS = '8'
 11210        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 11211        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11212                                    CM-LF-CANCEL-DT.
 11213
 11214 2210-SET-STATUS.
 11215
 11216     IF CM-LF-CURRENT-STATUS = SPACES
 11217         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11218
 11219     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 11220         MOVE '6'                TO DC-OPTION-CODE
 11221         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11222         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11223         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11224         IF NO-CONVERSION-ERROR
 11225             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 11226         ELSE
 11227             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 11228     ELSE
 11229         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 11230
 11231 2215-PROCESS-AH-SIDE.
 11232
 11233     IF ACVCDI GREATER THAN LOW-VALUES
 11234        IF ACVCDI = SPACES OR ZEROS
 11235           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 11236        ELSE
 11237           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 11238
 11239     IF ACVOTRMI GREATER THAN LOW-VALUES
 11240         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 11241
 11242     IF ACVRATEL GREATER THAN +0
 11243         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 11244
 11245     IF ACVBENEL GREATER THAN +0
 11246         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
 11247                                    PI-PAYMENT-AMT.
 11248
 11249     IF ACVFORMI GREATER THAN LOW-VALUES
 11250         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 11251
 11252     IF ACVCNDTI = LOW-VALUES
 11253        GO TO 2220-SET-STATUS.
 11254
 11255     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 11256        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 11257        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 11258        GO TO 2220-SET-STATUS.
 11259
 11260     IF CM-AH-CURRENT-STATUS = '6'
 11261        MOVE CM-AH-STATUS-AT-SETTLEMENT
 11262                                 TO CM-AH-CURRENT-STATUS
 11263        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 11264        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11265                                    CM-AH-SETTLEMENT-DT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 210
* EL131.cbl
 11266        GO TO 2220-SET-STATUS.
 11267
 11268     IF CM-AH-CURRENT-STATUS = '8'
 11269        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 11270        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11271                                    CM-AH-CANCEL-DT.
 11272
 11273 2220-SET-STATUS.
 11274     IF CM-AH-CURRENT-STATUS = SPACES
 11275         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11276
 11277     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 11278         MOVE '6'                TO DC-OPTION-CODE
 11279         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11280         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11281         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11282         IF NO-CONVERSION-ERROR
 11283             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 11284         ELSE
 11285             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 11286     ELSE
 11287         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 11288
 11289 2225-FINISH-CERT.
 11290     IF APRL GREATER THAN +0
 11291         MOVE HOLD-APR           TO CM-LOAN-APR.
 11292
 11293     IF PMTFREQI GREATER THAN LOW-VALUES
 11294         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 11295
 11296     IF INDGRPI GREATER THAN LOW-VALUES
 11297         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 11298
 11299     IF LOANNOI GREATER THAN LOW-VALUES
 11300        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 11301
 11302     IF LOANBALL GREATER THAN +0
 11303        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 11304
 11305     IF PREMTYPI GREATER THAN LOW-VALUES
 11306         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 11307
 11308     IF REINCDI GREATER THAN LOW-VALUES
 11309         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 11310                                    WS-REIN-1
 11311                                    WS-REIN-2
 11312                                    WS-REIN-3
 11313         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 11314
 11315     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 11316
 11317     MOVE ZEROS                  TO CM-LOAN-TERM
 11318                                    CM-LIFE-COMM-PCT
 11319                                    CM-AH-COMM-PCT.
 11320
 11321*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 11322*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 11323*         PI-NO-PMTS = ZEROS
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 211
* EL131.cbl
 11324*          IF LOANBALL GREATER THAN +0          OR
 11325*             ACVBENEL GREATER THAN +0          OR
 11326*             APRL     GREATER THAN +0          OR
 11327*             LCVRATEL GREATER THAN +0          OR
 11328*             ACVRATEL GREATER THAN +0
 11329*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 11330
 11331 2200-EXIT.
 11332     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 212
* EL131.cbl
 11334 2300-UPDATE-TRLR.
 11335     MOVE ZERO                   TO TRLR-SEQ-NO.
 11336
 11337* EXEC CICS READ UPDATE
 11338*         DATASET  (TRLR-FILE-ID)
 11339*         RIDFLD   (TRLR-KEY)
 11340*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11341*    END-EXEC.
 11342*    MOVE '&"S        EU         (   #00010224' TO DFHEIV0
 11343     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11344     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11345     MOVE X'2020233030303130323234' TO DFHEIV0(25:11)
 11346     CALL 'kxdfhei1' USING DFHEIV0,
 11347           TRLR-FILE-ID,
 11348           DFHEIV20,
 11349           DFHEIV99,
 11350           TRLR-KEY,
 11351           DFHEIV99,
 11352           DFHEIV99,
 11353           DFHEIV99
 11354     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11355         DFHEIV20
 11356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11357
 11358
 11359     MOVE ZERO                   TO COUNT-2.
 11360
 11361     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11362         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11363
 11364     IF NOT UPDATE-MADE
 11365         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11366
 11367
 11368* EXEC CICS REWRITE
 11369*         DATASET  (TRLR-FILE-ID)
 11370*         FROM     (ACTIVITY-TRAILERS)
 11371*    END-EXEC.
 11372     MOVE LENGTH OF
 11373      ACTIVITY-TRAILERS
 11374       TO DFHEIV11
 11375*    MOVE '&& L                  %   #00010238' TO DFHEIV0
 11376     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11377     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11378     MOVE X'2020233030303130323338' TO DFHEIV0(25:11)
 11379     CALL 'kxdfhei1' USING DFHEIV0,
 11380           TRLR-FILE-ID,
 11381           ACTIVITY-TRAILERS,
 11382           DFHEIV11,
 11383           DFHEIV99
 11384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11385
 11386
 11387 2300-EXIT.
 11388     EXIT.
 11389
 11390 2310-INS-STATUS.
 11391     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 213
* EL131.cbl
 11392     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 11393         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 11394         MOVE 'Y'                TO TRLR-SWITCH.
 11395
 11396 2310-EXIT.
 11397     EXIT.
 11398
 11399 2320-SHIFT-STATUS.
 11400     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 11401        MOVE 6                   TO COUNT-2
 11402        GO TO 2320-EXIT.
 11403
 11404     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 11405     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 11406     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 11407     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 11408     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 11409     MOVE 6       TO COUNT-2.
 11410     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 11411
 11412 2320-EXIT.
 11413     EXIT.
 11414
 11415 2330-ADD-UPDATE.
 11416
 11417     IF COUNT-2 GREATER THAN 1
 11418        COMPUTE MISC-SUB = (COUNT-2 - 1)
 11419        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11420           GO TO 2330-EXIT.
 11421
 11422     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 11423                                   AT-RESERVES-LAST-MAINT-DT
 11424
 11425     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 11426     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 11427     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 11428     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 11429
 11430 2330-EXIT.
 11431     EXIT.
 11432
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 214
* EL131.cbl
 11434 2400-UPDATE-TRLR.
 11435
 11436* EXEC CICS HANDLE CONDITION
 11437*         NOTFND    (2400-TRLR-NOTFND)
 11438*         ENDFILE   (2410-EXIT)
 11439*    END-EXEC.
 11440*    MOVE '"$I''                  ! 4 #00010291' TO DFHEIV0
 11441     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11442     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11443     MOVE X'3420233030303130323931' TO DFHEIV0(25:11)
 11444     CALL 'kxdfhei1' USING DFHEIV0
 11445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11446
 11447
 11448
 11449* EXEC CICS STARTBR
 11450*        DATASET (TRLR-FILE-ID)
 11451*        RIDFLD  (TRLR-KEY)
 11452*    END-EXEC.
 11453     MOVE 0
 11454       TO DFHEIV11
 11455*    MOVE '&,         G          &   #00010296' TO DFHEIV0
 11456     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11457     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11458     MOVE X'2020233030303130323936' TO DFHEIV0(25:11)
 11459     CALL 'kxdfhei1' USING DFHEIV0,
 11460           TRLR-FILE-ID,
 11461           TRLR-KEY,
 11462           DFHEIV99,
 11463           DFHEIV11,
 11464           DFHEIV99
 11465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11466
 11467
 11468
 11469* EXEC CICS GETMAIN
 11470*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11471*         LENGTH    (TRLR-LENGTH)
 11472*         INITIMG   (GETMAIN-SPACE)
 11473*    END-EXEC.
 11474*    MOVE ',"IL                  $   #00010301' TO DFHEIV0
 11475     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11476     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11477     MOVE X'2020233030303130333031' TO DFHEIV0(25:11)
 11478     CALL 'kxdfhei1' USING DFHEIV0,
 11479           DFHEIV20,
 11480           TRLR-LENGTH,
 11481           GETMAIN-SPACE
 11482     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11483         DFHEIV20
 11484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11485
 11486
 11487     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 11488
 11489
 11490* EXEC CICS ENDBR
 11491*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 215
* EL131.cbl
 11492*    END-EXEC.
 11493     MOVE 0
 11494       TO DFHEIV11
 11495*    MOVE '&2                    $   #00010309' TO DFHEIV0
 11496     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11497     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11498     MOVE X'2020233030303130333039' TO DFHEIV0(25:11)
 11499     CALL 'kxdfhei1' USING DFHEIV0,
 11500           TRLR-FILE-ID,
 11501           DFHEIV11,
 11502           DFHEIV99
 11503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11504
 11505
 11506     GO TO 2400-EXIT.
 11507
 11508 2400-TRLR-NOTFND.
 11509     MOVE ER-0205                TO EMI-ERROR.
 11510     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11511     MOVE 'X'                    TO ERROR-SWITCH.
 11512
 11513 2400-EXIT.
 11514     EXIT.
 11515
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 216
* EL131.cbl
 11517 2410-CHANGE-TRLR.
 11518
 11519* EXEC CICS READNEXT
 11520*        DATASET (TRLR-FILE-ID)
 11521*        RIDFLD  (TRLR-KEY)
 11522*        INTO    (ACTIVITY-TRAILERS)
 11523*    END-EXEC.
 11524     MOVE LENGTH OF
 11525      ACTIVITY-TRAILERS
 11526       TO DFHEIV12
 11527     MOVE 0
 11528       TO DFHEIV11
 11529*    MOVE '&.IL                  )   #00010325' TO DFHEIV0
 11530     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11531     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11532     MOVE X'2020233030303130333235' TO DFHEIV0(25:11)
 11533     CALL 'kxdfhei1' USING DFHEIV0,
 11534           TRLR-FILE-ID,
 11535           ACTIVITY-TRAILERS,
 11536           DFHEIV12,
 11537           TRLR-KEY,
 11538           DFHEIV99,
 11539           DFHEIV11,
 11540           DFHEIV99,
 11541           DFHEIV99
 11542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11543
 11544
 11545     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 11546        GO TO 2410-CHANGE-TRLR.
 11547
 11548     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 11549                                    CHECK-KEY.
 11550
 11551     IF CHECK-KEY NOT = MSTR-KEY
 11552         GO TO 2410-EXIT.
 11553
 11554
 11555* EXEC CICS ENDBR
 11556*        DATASET (TRLR-FILE-ID)
 11557*    END-EXEC.
 11558     MOVE 0
 11559       TO DFHEIV11
 11560*    MOVE '&2                    $   #00010340' TO DFHEIV0
 11561     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11562     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11563     MOVE X'2020233030303130333430' TO DFHEIV0(25:11)
 11564     CALL 'kxdfhei1' USING DFHEIV0,
 11565           TRLR-FILE-ID,
 11566           DFHEIV11,
 11567           DFHEIV99
 11568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11569
 11570
 11571
 11572* EXEC CICS READ UPDATE
 11573*        DATASET (TRLR-FILE-ID)
 11574*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 217
* EL131.cbl
 11575*        INTO    (ACTIVITY-TRAILERS)
 11576*    END-EXEC.
 11577     MOVE LENGTH OF
 11578      ACTIVITY-TRAILERS
 11579       TO DFHEIV11
 11580*    MOVE '&"IL       EU         (   #00010344' TO DFHEIV0
 11581     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11582     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11583     MOVE X'2020233030303130333434' TO DFHEIV0(25:11)
 11584     CALL 'kxdfhei1' USING DFHEIV0,
 11585           TRLR-FILE-ID,
 11586           ACTIVITY-TRAILERS,
 11587           DFHEIV11,
 11588           TRLR-KEY,
 11589           DFHEIV99,
 11590           DFHEIV99,
 11591           DFHEIV99
 11592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11593
 11594
 11595
 11596* EXEC CICS DELETE
 11597*        DATASET (TRLR-FILE-ID)
 11598*    END-EXEC.
 11599*    MOVE '&(                    &   #00010350' TO DFHEIV0
 11600     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11601     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11602     MOVE X'2020233030303130333530' TO DFHEIV0(25:11)
 11603     CALL 'kxdfhei1' USING DFHEIV0,
 11604           TRLR-FILE-ID,
 11605           DFHEIV99,
 11606           DFHEIV99,
 11607           DFHEIV99,
 11608           DFHEIV99
 11609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11610
 11611
 11612     IF AT-SEQUENCE-NO = ZERO AND
 11613        TRLR-UPDATE-REQUIRED
 11614         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 11615
 11616     IF CERTI GREATER THAN LOW-VALUES
 11617        MOVE CERTI               TO AT-CERT-PRIME.
 11618
 11619     IF SUFXI GREATER THAN LOW-VALUES
 11620        MOVE SUFXI               TO AT-CERT-SFX.
 11621
 11622     IF CERTCARI GREATER THAN LOW-VALUES
 11623        MOVE CERTCARI            TO AT-CARRIER.
 11624
 11625     IF PAYMENT-TR
 11626        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 11627           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 11628              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 11629
 11630     IF CORRESPONDENCE-TR
 11631        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 11632           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 218
* EL131.cbl
 11633
 11634
 11635* EXEC CICS WRITE
 11636*         DATASET  (TRLR-FILE-ID)
 11637*         RIDFLD   (AT-CONTROL-PRIMARY)
 11638*         FROM     (ACTIVITY-TRAILERS)
 11639*    END-EXEC.
 11640     MOVE LENGTH OF
 11641      ACTIVITY-TRAILERS
 11642       TO DFHEIV11
 11643*    MOVE '&$ L                  ''   #00010376' TO DFHEIV0
 11644     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11645     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11646     MOVE X'2020233030303130333736' TO DFHEIV0(25:11)
 11647     CALL 'kxdfhei1' USING DFHEIV0,
 11648           TRLR-FILE-ID,
 11649           ACTIVITY-TRAILERS,
 11650           DFHEIV11,
 11651           AT-CONTROL-PRIMARY,
 11652           DFHEIV99,
 11653           DFHEIV99
 11654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11655
 11656
 11657
 11658* EXEC CICS STARTBR
 11659*         DATASET  (TRLR-FILE-ID)
 11660*         RIDFLD   (TRLR-KEY)
 11661*    END-EXEC.
 11662     MOVE 0
 11663       TO DFHEIV11
 11664*    MOVE '&,         G          &   #00010382' TO DFHEIV0
 11665     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11666     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11667     MOVE X'2020233030303130333832' TO DFHEIV0(25:11)
 11668     CALL 'kxdfhei1' USING DFHEIV0,
 11669           TRLR-FILE-ID,
 11670           TRLR-KEY,
 11671           DFHEIV99,
 11672           DFHEIV11,
 11673           DFHEIV99
 11674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11675
 11676
 11677     GO TO 2410-CHANGE-TRLR.
 11678
 11679 2410-EXIT.
 11680     EXIT.
 11681
 11682 2420-UPDATE-TRLR.
 11683     MOVE ZERO TO COUNT-2.
 11684     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11685         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11686
 11687     IF NOT UPDATE-MADE
 11688         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11689
 11690 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 219
* EL131.cbl
 11691     EXIT.
 11692
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 220
* EL131.cbl
 11694 2425-UPDATE-NINETY-TRLR.
 11695
 11696     MOVE +90                    TO TRLR-SEQ-NO.
 11697
 11698
 11699* EXEC CICS HANDLE CONDITION
 11700*         NOTFND    (2425-NINETY-NOTFND)
 11701*         ENDFILE   (2425-NINETY-NOTFND)
 11702*    END-EXEC.
 11703*    MOVE '"$I''                  ! 5 #00010408' TO DFHEIV0
 11704     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11705     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11706     MOVE X'3520233030303130343038' TO DFHEIV0(25:11)
 11707     CALL 'kxdfhei1' USING DFHEIV0
 11708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11709
 11710
 11711
 11712* EXEC CICS READ UPDATE
 11713*        DATASET (TRLR-FILE-ID)
 11714*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11715*        RIDFLD  (TRLR-KEY)
 11716*    END-EXEC.
 11717*    MOVE '&"S        EU         (   #00010413' TO DFHEIV0
 11718     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11719     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11720     MOVE X'2020233030303130343133' TO DFHEIV0(25:11)
 11721     CALL 'kxdfhei1' USING DFHEIV0,
 11722           TRLR-FILE-ID,
 11723           DFHEIV20,
 11724           DFHEIV99,
 11725           TRLR-KEY,
 11726           DFHEIV99,
 11727           DFHEIV99,
 11728           DFHEIV99
 11729     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11730         DFHEIV20
 11731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11732
 11733
 11734     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
 11735
 11736     MOVE DIAGI                 TO AT-INFO-LINE-1.
 11737
 11738
 11739* EXEC CICS REWRITE
 11740*        DATASET (TRLR-FILE-ID)
 11741*        FROM    (ACTIVITY-TRAILERS)
 11742*    END-EXEC.
 11743     MOVE LENGTH OF
 11744      ACTIVITY-TRAILERS
 11745       TO DFHEIV11
 11746*    MOVE '&& L                  %   #00010423' TO DFHEIV0
 11747     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11748     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11749     MOVE X'2020233030303130343233' TO DFHEIV0(25:11)
 11750     CALL 'kxdfhei1' USING DFHEIV0,
 11751           TRLR-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 221
* EL131.cbl
 11752           ACTIVITY-TRAILERS,
 11753           DFHEIV11,
 11754           DFHEIV99
 11755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11756
 11757
 11758     IF DIAGI NOT = WS-DIAGNOSIS
 11759         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 11760         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 11761         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11762
 11763     GO TO 2425-EXIT.
 11764
 11765 2425-NINETY-NOTFND.
 11766
 11767
 11768* EXEC CICS GETMAIN
 11769*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11770*         LENGTH    (TRLR-LENGTH)
 11771*         INITIMG   (GETMAIN-SPACE)
 11772*    END-EXEC.
 11773*    MOVE ',"IL                  $   #00010437' TO DFHEIV0
 11774     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11775     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11776     MOVE X'2020233030303130343337' TO DFHEIV0(25:11)
 11777     CALL 'kxdfhei1' USING DFHEIV0,
 11778           DFHEIV20,
 11779           TRLR-LENGTH,
 11780           GETMAIN-SPACE
 11781     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11782         DFHEIV20
 11783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11784
 11785
 11786     MOVE +90                  TO TRLR-SEQ-NO.
 11787     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 11788
 11789     MOVE 'AT'                 TO AT-RECORD-ID
 11790     MOVE '6'                  TO AT-TRAILER-TYPE
 11791     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 11792                                  AT-GEN-INFO-LAST-MAINT-DT
 11793     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 11794                                  AT-GEN-INFO-LAST-UPDATED-BY
 11795     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 11796     MOVE DIAGI                TO AT-INFO-LINE-1.
 11797
 11798
 11799* EXEC CICS WRITE
 11800*        DATASET (TRLR-FILE-ID)
 11801*        FROM    (ACTIVITY-TRAILERS)
 11802*        RIDFLD  (TRLR-KEY)
 11803*    END-EXEC.
 11804     MOVE LENGTH OF
 11805      ACTIVITY-TRAILERS
 11806       TO DFHEIV11
 11807*    MOVE '&$ L                  ''   #00010455' TO DFHEIV0
 11808     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11809     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 222
* EL131.cbl
 11810     MOVE X'2020233030303130343535' TO DFHEIV0(25:11)
 11811     CALL 'kxdfhei1' USING DFHEIV0,
 11812           TRLR-FILE-ID,
 11813           ACTIVITY-TRAILERS,
 11814           DFHEIV11,
 11815           TRLR-KEY,
 11816           DFHEIV99,
 11817           DFHEIV99
 11818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11819
 11820
 11821 2425-EXIT.
 11822     EXIT.
 11823
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 223
* EL131.cbl
 11825 2430-UPDATE-ACTQ.
 11826
 11827* EXEC CICS HANDLE CONDITION
 11828*         NOTFND    (2430-EXIT)
 11829*         ENDFILE   (2440-EXIT)
 11830*    END-EXEC.
 11831*    MOVE '"$I''                  ! 6 #00010466' TO DFHEIV0
 11832     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11833     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11834     MOVE X'3620233030303130343636' TO DFHEIV0(25:11)
 11835     CALL 'kxdfhei1' USING DFHEIV0
 11836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11837
 11838
 11839
 11840* EXEC CICS STARTBR
 11841*         DATASET  (ACTQ-FILE-ID)
 11842*         RIDFLD   (ACTQ-KEY)
 11843*    END-EXEC.
 11844     MOVE 0
 11845       TO DFHEIV11
 11846*    MOVE '&,         G          &   #00010471' TO DFHEIV0
 11847     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11848     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11849     MOVE X'2020233030303130343731' TO DFHEIV0(25:11)
 11850     CALL 'kxdfhei1' USING DFHEIV0,
 11851           ACTQ-FILE-ID,
 11852           ACTQ-KEY,
 11853           DFHEIV99,
 11854           DFHEIV11,
 11855           DFHEIV99
 11856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11857
 11858
 11859
 11860* EXEC CICS GETMAIN
 11861*         SET      (ADDRESS OF ACTIVITY-QUE)
 11862*         LENGTH   (ACTQ-LENGTH)
 11863*         INITIMG  (GETMAIN-SPACE)
 11864*    END-EXEC.
 11865*    MOVE ',"IL                  $   #00010476' TO DFHEIV0
 11866     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11867     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11868     MOVE X'2020233030303130343736' TO DFHEIV0(25:11)
 11869     CALL 'kxdfhei1' USING DFHEIV0,
 11870           DFHEIV20,
 11871           ACTQ-LENGTH,
 11872           GETMAIN-SPACE
 11873     SET ADDRESS OF ACTIVITY-QUE TO
 11874         DFHEIV20
 11875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11876
 11877
 11878     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 11879
 11880 2430-EXIT.
 11881     EXIT.
 11882
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 224
* EL131.cbl
 11883 2440-CHANGE-ACTQ.
 11884
 11885
 11886* EXEC CICS READNEXT
 11887*         DATASET  (ACTQ-FILE-ID)
 11888*         RIDFLD   (ACTQ-KEY)
 11889*         INTO     (ACTIVITY-QUE)
 11890*    END-EXEC.
 11891     MOVE LENGTH OF
 11892      ACTIVITY-QUE
 11893       TO DFHEIV12
 11894     MOVE 0
 11895       TO DFHEIV11
 11896*    MOVE '&.IL                  )   #00010489' TO DFHEIV0
 11897     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11898     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11899     MOVE X'2020233030303130343839' TO DFHEIV0(25:11)
 11900     CALL 'kxdfhei1' USING DFHEIV0,
 11901           ACTQ-FILE-ID,
 11902           ACTIVITY-QUE,
 11903           DFHEIV12,
 11904           ACTQ-KEY,
 11905           DFHEIV99,
 11906           DFHEIV11,
 11907           DFHEIV99,
 11908           DFHEIV99
 11909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11910
 11911
 11912
 11913* EXEC CICS ENDBR
 11914*         DATASET (ACTQ-FILE-ID)
 11915*    END-EXEC.
 11916     MOVE 0
 11917       TO DFHEIV11
 11918*    MOVE '&2                    $   #00010495' TO DFHEIV0
 11919     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11920     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11921     MOVE X'2020233030303130343935' TO DFHEIV0(25:11)
 11922     CALL 'kxdfhei1' USING DFHEIV0,
 11923           ACTQ-FILE-ID,
 11924           DFHEIV11,
 11925           DFHEIV99
 11926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11927
 11928
 11929     IF ACTQ-KEY NOT = MSTR-KEY
 11930         GO TO 2440-EXIT.
 11931
 11932
 11933* EXEC CICS READ UPDATE
 11934*         DATASET  (ACTQ-FILE-ID)
 11935*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11936*         SET      (ADDRESS OF ACTIVITY-QUE)
 11937*    END-EXEC.
 11938*    MOVE '&"S        EU         (   #00010502' TO DFHEIV0
 11939     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11940     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 225
* EL131.cbl
 11941     MOVE X'2020233030303130353032' TO DFHEIV0(25:11)
 11942     CALL 'kxdfhei1' USING DFHEIV0,
 11943           ACTQ-FILE-ID,
 11944           DFHEIV20,
 11945           DFHEIV99,
 11946           AQ-CONTROL-PRIMARY,
 11947           DFHEIV99,
 11948           DFHEIV99,
 11949           DFHEIV99
 11950     SET ADDRESS OF ACTIVITY-QUE TO
 11951         DFHEIV20
 11952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11953
 11954
 11955     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 11956
 11957
 11958* EXEC CICS DELETE
 11959*         DATASET (ACTQ-FILE-ID)
 11960*    END-EXEC.
 11961*    MOVE '&(                    &   #00010510' TO DFHEIV0
 11962     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11963     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11964     MOVE X'2020233030303130353130' TO DFHEIV0(25:11)
 11965     CALL 'kxdfhei1' USING DFHEIV0,
 11966           ACTQ-FILE-ID,
 11967           DFHEIV99,
 11968           DFHEIV99,
 11969           DFHEIV99,
 11970           DFHEIV99
 11971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11972
 11973
 11974     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 11975     IF CERTI GREATER THAN LOW-VALUES
 11976        MOVE CERTI               TO AQ-CERT-PRIME.
 11977     IF SUFXI GREATER THAN LOW-VALUES
 11978        MOVE SUFXI               TO AQ-CERT-SFX.
 11979     IF CERTCARI GREATER THAN LOW-VALUES
 11980        MOVE CERTCARI            TO AQ-CARRIER.
 11981
 11982
 11983* EXEC CICS HANDLE CONDITION
 11984*         DUPREC   (2440-EXIT)
 11985*    END-EXEC.
 11986*    MOVE '"$%                   ! 7 #00010522' TO DFHEIV0
 11987     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11988     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11989     MOVE X'3720233030303130353232' TO DFHEIV0(25:11)
 11990     CALL 'kxdfhei1' USING DFHEIV0
 11991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11992
 11993
 11994
 11995* EXEC CICS WRITE
 11996*         DATASET  (ACTQ-FILE-ID)
 11997*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11998*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 226
* EL131.cbl
 11999*    END-EXEC.
 12000     MOVE LENGTH OF
 12001      ACTIVITY-QUE
 12002       TO DFHEIV11
 12003*    MOVE '&$ L                  ''   #00010526' TO DFHEIV0
 12004     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12005     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12006     MOVE X'2020233030303130353236' TO DFHEIV0(25:11)
 12007     CALL 'kxdfhei1' USING DFHEIV0,
 12008           ACTQ-FILE-ID,
 12009           ACTIVITY-QUE,
 12010           DFHEIV11,
 12011           AQ-CONTROL-PRIMARY,
 12012           DFHEIV99,
 12013           DFHEIV99
 12014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12015
 12016
 12017 2440-EXIT.
 12018     EXIT.
 12019
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 227
* EL131.cbl
 12021 2460-UPDATE-CHECKQ.
 12022
 12023* EXEC CICS HANDLE CONDITION
 12024*         NOTFND   (2460-EXIT)
 12025*    END-EXEC.
 12026*    MOVE '"$I                   ! 8 #00010537' TO DFHEIV0
 12027     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12028     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12029     MOVE X'3820233030303130353337' TO DFHEIV0(25:11)
 12030     CALL 'kxdfhei1' USING DFHEIV0
 12031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12032
 12033
 12034     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 12035     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 12036     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 12037
 12038
 12039* EXEC CICS READ UPDATE
 12040*         DATASET   (CHKQ-FILE-ID)
 12041*         RIDFLD    (CHKQ-KEY)
 12042*         SET       (ADDRESS OF CHECK-QUE)
 12043*    END-EXEC.
 12044*    MOVE '&"S        EU         (   #00010545' TO DFHEIV0
 12045     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12046     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12047     MOVE X'2020233030303130353435' TO DFHEIV0(25:11)
 12048     CALL 'kxdfhei1' USING DFHEIV0,
 12049           CHKQ-FILE-ID,
 12050           DFHEIV20,
 12051           DFHEIV99,
 12052           CHKQ-KEY,
 12053           DFHEIV99,
 12054           DFHEIV99,
 12055           DFHEIV99
 12056     SET ADDRESS OF CHECK-QUE TO
 12057         DFHEIV20
 12058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12059
 12060
 12061     IF CERTI GREATER THAN LOW-VALUES
 12062        MOVE CERTI               TO CQ-CERT-PRIME.
 12063     IF SUFXI GREATER THAN LOW-VALUES
 12064        MOVE SUFXI               TO CQ-CERT-SFX.
 12065     IF CERTCARI GREATER THAN LOW-VALUES
 12066        MOVE CERTCARI            TO CQ-CARRIER.
 12067
 12068
 12069* EXEC CICS REWRITE
 12070*         DATASET  (CHKQ-FILE-ID)
 12071*         FROM     (CHECK-QUE)
 12072*    END-EXEC.
 12073     MOVE LENGTH OF
 12074      CHECK-QUE
 12075       TO DFHEIV11
 12076*    MOVE '&& L                  %   #00010558' TO DFHEIV0
 12077     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12078     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 228
* EL131.cbl
 12079     MOVE X'2020233030303130353538' TO DFHEIV0(25:11)
 12080     CALL 'kxdfhei1' USING DFHEIV0,
 12081           CHKQ-FILE-ID,
 12082           CHECK-QUE,
 12083           DFHEIV11,
 12084           DFHEIV99
 12085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12086
 12087
 12088 2460-EXIT.
 12089     EXIT.
 12090
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 229
* EL131.cbl
 12092 2475-UPDATE-LETTER.
 12093
 12094* EXEC CICS HANDLE CONDITION
 12095*         NOTFND   (2475-EXIT)
 12096*    END-EXEC.
 12097*    MOVE '"$I                   ! 9 #00010568' TO DFHEIV0
 12098     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12099     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12100     MOVE X'3920233030303130353638' TO DFHEIV0(25:11)
 12101     CALL 'kxdfhei1' USING DFHEIV0
 12102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12103
 12104
 12105     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 12106     MOVE '1'                    TO ARCH-RECORD-TYPE.
 12107     MOVE ZEROS                  TO ARCH-SEQ-NO.
 12108     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 12109
 12110
 12111* EXEC CICS READ UPDATE
 12112*         DATASET   (ARCH-FILE-ID)
 12113*         RIDFLD    (ARCH-KEY)
 12114*         SET       (ADDRESS OF LETTER-ARCHIVE)
 12115*    END-EXEC.
 12116*    MOVE '&"S        EU         (   #00010577' TO DFHEIV0
 12117     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12118     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12119     MOVE X'2020233030303130353737' TO DFHEIV0(25:11)
 12120     CALL 'kxdfhei1' USING DFHEIV0,
 12121           ARCH-FILE-ID,
 12122           DFHEIV20,
 12123           DFHEIV99,
 12124           ARCH-KEY,
 12125           DFHEIV99,
 12126           DFHEIV99,
 12127           DFHEIV99
 12128     SET ADDRESS OF LETTER-ARCHIVE TO
 12129         DFHEIV20
 12130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12131
 12132
 12133* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 12134* TO THIS MASTER-KEY INFORMATION.
 12135
 12136     IF LA-CARRIER  = CARRIER-CODE AND
 12137        LA-CLAIM-NO = CLAIM-NO     AND
 12138        LA-CERT-NO  = CERT-NO
 12139        NEXT SENTENCE
 12140     ELSE
 12141        GO TO 2475-UNLOCK.
 12142
 12143     IF CERTI GREATER THAN LOW-VALUES
 12144        MOVE CERTI               TO LA-CERT-PRIME.
 12145     IF SUFXI GREATER THAN LOW-VALUES
 12146        MOVE SUFXI               TO LA-CERT-SFX.
 12147     IF CERTCARI GREATER THAN LOW-VALUES
 12148        MOVE CERTCARI            TO LA-CARRIER.
 12149
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 230
* EL131.cbl
 12150
 12151* EXEC CICS REWRITE
 12152*         DATASET  (ARCH-FILE-ID)
 12153*         FROM     (LETTER-ARCHIVE)
 12154*    END-EXEC.
 12155     MOVE LENGTH OF
 12156      LETTER-ARCHIVE
 12157       TO DFHEIV11
 12158*    MOVE '&& L                  %   #00010600' TO DFHEIV0
 12159     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12160     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12161     MOVE X'2020233030303130363030' TO DFHEIV0(25:11)
 12162     CALL 'kxdfhei1' USING DFHEIV0,
 12163           ARCH-FILE-ID,
 12164           LETTER-ARCHIVE,
 12165           DFHEIV11,
 12166           DFHEIV99
 12167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12168
 12169
 12170     GO TO 2475-EXIT.
 12171
 12172 2475-UNLOCK.
 12173
 12174* EXEC CICS UNLOCK
 12175*         DATASET  (ARCH-FILE-ID)
 12176*    END-EXEC.
 12177*    MOVE '&*                    #   #00010608' TO DFHEIV0
 12178     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12179     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12180     MOVE X'2020233030303130363038' TO DFHEIV0(25:11)
 12181     CALL 'kxdfhei1' USING DFHEIV0,
 12182           ARCH-FILE-ID,
 12183           DFHEIV99
 12184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12185
 12186
 12187 2475-EXIT.
 12188     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 231
* EL131.cbl
 12190 2600-CREATE-MAINT-NOTE.
 12191     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12192     MOVE '1'                    TO CNTL-REC-TYPE.
 12193     MOVE SPACES                 TO CNTL-PROC-ID.
 12194     MOVE ZERO                   TO CNTL-SEQ-NO.
 12195
 12196
 12197* EXEC CICS READ
 12198*         SET        (ADDRESS OF CONTROL-FILE)
 12199*         DATASET    ('ELCNTL')
 12200*         RIDFLD     (CNTL-KEY)
 12201*    END-EXEC.
 12202     MOVE 'ELCNTL' TO DFHEIV1
 12203*    MOVE '&"S        E          (   #00010621' TO DFHEIV0
 12204     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12205     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12206     MOVE X'2020233030303130363231' TO DFHEIV0(25:11)
 12207     CALL 'kxdfhei1' USING DFHEIV0,
 12208           DFHEIV1,
 12209           DFHEIV20,
 12210           DFHEIV99,
 12211           CNTL-KEY,
 12212           DFHEIV99,
 12213           DFHEIV99,
 12214           DFHEIV99
 12215     SET ADDRESS OF CONTROL-FILE TO
 12216         DFHEIV20
 12217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12218
 12219
 12220     IF CO-NO-USE-AUDIT-CHANGES
 12221         GO TO 2600-EXIT.
 12222
 12223     IF PROCL GREATER ZERO
 12224     IF PROCI NOT = LOW-VALUES
 12225     IF PROCI NOT = CL-PROCESSOR-ID
 12226         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 12227         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 12228         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12229
 12230     IF SEXL GREATER ZERO
 12231     IF SEXI NOT = LOW-VALUES
 12232     IF SEXI NOT = CL-INSURED-SEX-CD
 12233         MOVE 'SEX'                TO SPLIT-INFO-DESC
 12234         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 12235         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12236
 12237     IF BIRTHL GREATER ZERO
 12238     IF HOLD-BIRTH NOT = LOW-VALUES
 12239     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 12240         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 12241         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 12242         MOVE SPACES               TO DC-OPTION-CODE
 12243         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12244         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12245         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12246
 12247     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 232
* EL131.cbl
 12248     IF SOCIALI NOT = LOW-VALUES
 12249     IF SOCIALI NOT = CL-SOC-SEC-NO
 12250         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 12251         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 12252         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12253
 12254     IF OCCL GREATER ZERO
 12255     IF OCCI NOT = LOW-VALUES
 12256     IF OCCI NOT = CL-INSURED-OCC-CD
 12257         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 12258         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 12259         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12260
 12261     IF BENEL GREATER ZERO
 12262     IF BENEI NOT = LOW-VALUES
 12263     IF BENEI NOT = CL-BENEFICIARY
 12264         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 12265         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 12266         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12267
 12268     IF PREMTYPL GREATER ZERO
 12269     IF PREMTYPI NOT = LOW-VALUES
 12270     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 12271         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 12272         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 12273         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12274
 12275     IF CAUSEL GREATER ZERO
 12276     IF CAUSEI NOT = LOW-VALUES
 12277     IF CAUSEI NOT = CL-CAUSE-CD
 12278         MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 12279         MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 12280         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12281
 12282     IF ENDL GREATER ZERO
 12283     IF HOLD-END NOT = LOW-VALUES
 12284     IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 12285         MOVE 'END DT'             TO SPLIT-INFO-DESC
 12286         MOVE CL-EST-END-OF-DISAB-DT
 12287                                   TO DC-BIN-DATE-1
 12288         MOVE SPACES               TO DC-OPTION-CODE
 12289         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12290         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12291         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12292
 12293     IF PDTHRUL GREATER ZERO
 12294     IF HOLD-PDTHRU NOT = LOW-VALUES
 12295     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 12296         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 12297         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 12298         MOVE SPACES               TO DC-OPTION-CODE
 12299         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12300         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12301         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12302
 12303     IF PDAMTL GREATER ZERO
 12304     IF HOLD-PDAMT NOT = ZEROS
 12305     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 233
* EL131.cbl
 12306         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 12307         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 12308         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 12309         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12310
 12311     IF NODAYSL GREATER ZERO
 12312     IF HOLD-NODAYS NOT = ZEROS
 12313     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 12314         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 12315         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 12316         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12317         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12318
 12319     IF NOPMTSL GREATER ZERO
 12320     IF HOLD-NOPMTS NOT = ZEROS
 12321     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 12322         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 12323         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 12324         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12325         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12326
 12327     IF FORMTYPL GREATER ZERO
 12328     IF FORMTYPI NOT = LOW-VALUES
 12329     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 12330         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 12331         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 12332         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12333
 12334     IF REPL GREATER ZERO
 12335     IF HOLD-REPORTED NOT = LOW-VALUES
 12336     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 12337         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 12338         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 12339         MOVE SPACES               TO DC-OPTION-CODE
 12340         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12341         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12342         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12343
 12344     IF ADDONDTL GREATER ZERO
 12345     IF HOLD-ADDON NOT = LOW-VALUES
 12346     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 12347         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 12348         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 12349         MOVE SPACES               TO DC-OPTION-CODE
 12350         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12351         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12352         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12353
 12354     IF PRICDL GREATER ZERO
 12355     IF PRICDI NOT = LOW-VALUES
 12356     IF PRICDI NOT = CL-PRIORITY-CD
 12357         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 12358         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 12359         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12360
 12361     IF FILETOL GREATER ZERO
 12362     IF FILETOI NOT = LOW-VALUES
 12363     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 234
* EL131.cbl
 12364         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 12365         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 12366         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12367
 12368     IF SUPVL GREATER ZERO
 12369     IF SUPVI NOT = LOW-VALUES
 12370     IF SUPVI NOT = CL-SUPV-ATTN-CD
 12371         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 12372         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 12373         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12374     IF (CRITPTL > ZERO)
 12375        AND (CRITPTI NOT = LOW-VALUES)
 12376        AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 12377        MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 12378        MOVE CL-CRIT-PER-RECURRENT
 12379                                 TO SPLIT-INFO-OLD
 12380        PERFORM 2650-WRITE-MAINT-NOTE
 12381                                 THRU 2650-EXIT
 12382     END-IF
 12383
 12384     IF (RTWMOSL > ZERO)
 12385        AND (RTWMOSI NOT = LOW-VALUES)
 12386        AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 12387        MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 12388        MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 12389        PERFORM 2650-WRITE-MAINT-NOTE
 12390                                 THRU 2650-EXIT
 12391     END-IF
 12392     IF MLNAMEL GREATER ZERO
 12393     IF MLNAMEI NOT = LOW-VALUES
 12394     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 12395         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 12396         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 12397         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12398
 12399     IF MFNAMEL GREATER ZERO
 12400     IF MFNAMEI NOT = LOW-VALUES
 12401     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 12402         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 12403         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 12404         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12405
 12406     IF MMINITL GREATER ZERO
 12407     IF MMINITI NOT = LOW-VALUES
 12408     IF MMINITI NOT = CL-INSURED-MID-INIT
 12409         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 12410         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 12411         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12412
 12413     IF CERTEFFL GREATER ZERO
 12414     IF HOLD-EFF NOT = LOW-VALUES
 12415     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 12416         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 12417         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 12418         MOVE SPACES               TO DC-OPTION-CODE
 12419         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12420         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12421         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 235
* EL131.cbl
 12422
 12423     IF CERTACTL GREATER ZERO
 12424     IF CERTACTI NOT = LOW-VALUES
 12425     IF CERTACTI NOT = CL-CERT-ACCOUNT
 12426         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 12427         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 12428         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12429
 12430     IF CERTSTL GREATER ZERO
 12431     IF CERTSTI NOT = LOW-VALUES
 12432     IF CERTSTI NOT = CL-CERT-STATE
 12433         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 12434         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 12435         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12436
 12437     IF CERTCARL GREATER ZERO
 12438     IF CERTCARI NOT = LOW-VALUES
 12439     IF CERTCARI NOT = CL-CERT-CARRIER
 12440         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 12441         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 12442         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12443
 12444     IF CERTGRPL GREATER ZERO
 12445     IF CERTGRPI NOT = LOW-VALUES
 12446     IF CERTGRPI NOT = CL-CERT-GROUPING
 12447         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 12448         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 12449         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12450
 12451     IF CERTL GREATER ZERO OR
 12452        SUFXL GREATER ZERO
 12453     IF (CERTI NOT = LOW-VALUES AND
 12454                     CL-CERT-PRIME)
 12455                OR
 12456        (SUFXI NOT = LOW-VALUES AND
 12457                     CL-CERT-SFX)
 12458         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 12459         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 12460         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12461     IF incl > zeros
 12462        IF (HOLD-INCUR NOT = LOW-VALUES)
 12463           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 12464           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 12465           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 12466           MOVE SPACES           TO DC-OPTION-CODE
 12467           PERFORM 9800-CONVERT-DATE
 12468                                 THRU 9800-EXIT
 12469           MOVE DC-GREG-DATE-1-EDIT
 12470                                 TO SPLIT-INFO-OLD
 12471           PERFORM 2650-WRITE-MAINT-NOTE
 12472                                 THRU 2650-EXIT
 12473        END-IF
 12474     END-IF
 12475     .
 12476 2600-EXIT.
 12477      EXIT.
 12478
 12479 2650-WRITE-MAINT-NOTE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 236
* EL131.cbl
 12480
 12481* EXEC CICS GETMAIN
 12482*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12483*         LENGTH   (TRLR-LENGTH)
 12484*         INITIMG  (GETMAIN-SPACE)
 12485*    END-EXEC.
 12486*    MOVE ',"IL                  $   #00010887' TO DFHEIV0
 12487     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12488     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12489     MOVE X'2020233030303130383837' TO DFHEIV0(25:11)
 12490     CALL 'kxdfhei1' USING DFHEIV0,
 12491           DFHEIV20,
 12492           TRLR-LENGTH,
 12493           GETMAIN-SPACE
 12494     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12495         DFHEIV20
 12496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12497
 12498
 12499
 12500* EXEC CICS HANDLE CONDITION
 12501*         DUPREC   (2650-EXIT)
 12502*    END-EXEC.
 12503*    MOVE '"$%                   ! : #00010893' TO DFHEIV0
 12504     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12505     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12506     MOVE X'3A20233030303130383933' TO DFHEIV0(25:11)
 12507     CALL 'kxdfhei1' USING DFHEIV0
 12508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12509
 12510
 12511     MOVE SPACES             TO ACTIVITY-TRAILERS.
 12512
 12513     IF CERTL GREATER ZERO
 12514         MOVE CERTI          TO CL-CERT-PRIME.
 12515
 12516     IF SUFXL GREATER ZERO
 12517         MOVE SUFXI          TO CL-CERT-SFX.
 12518
 12519     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 12520
 12521     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 12522     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 12523
 12524     MOVE 'AT'               TO AT-RECORD-ID.
 12525
 12526     MOVE '6'                TO AT-TRAILER-TYPE.
 12527     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 12528                                AT-GEN-INFO-LAST-MAINT-DT.
 12529     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 12530                                AT-GEN-INFO-LAST-UPDATED-BY.
 12531     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 12532     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 12533     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 12534
 12535
 12536* EXEC CICS WRITE
 12537*         DATASET  (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 237
* EL131.cbl
 12538*         RIDFLD   (AT-CONTROL-PRIMARY)
 12539*         FROM     (ACTIVITY-TRAILERS)
 12540*    END-EXEC.
 12541     MOVE LENGTH OF
 12542      ACTIVITY-TRAILERS
 12543       TO DFHEIV11
 12544*    MOVE '&$ L                  ''   #00010921' TO DFHEIV0
 12545     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12546     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12547     MOVE X'2020233030303130393231' TO DFHEIV0(25:11)
 12548     CALL 'kxdfhei1' USING DFHEIV0,
 12549           TRLR-FILE-ID,
 12550           ACTIVITY-TRAILERS,
 12551           DFHEIV11,
 12552           AT-CONTROL-PRIMARY,
 12553           DFHEIV99,
 12554           DFHEIV99
 12555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12556
 12557
 12558 2650-EXIT.
 12559      EXIT.
 12560
 12561 2800-CHECK-AUTO-PAY.
 12562
 12563     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 12564     MOVE PI-CARRIER         TO TRLR-CARRIER.
 12565     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 12566     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 12567     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 12568
 12569
 12570* EXEC CICS HANDLE CONDITION
 12571*         NOTFND    (2800-EXIT)
 12572*         ENDFILE   (2800-EXIT)
 12573*    END-EXEC.
 12574*    MOVE '"$I''                  ! ; #00010938' TO DFHEIV0
 12575     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12576     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12577     MOVE X'3B20233030303130393338' TO DFHEIV0(25:11)
 12578     CALL 'kxdfhei1' USING DFHEIV0
 12579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12580
 12581
 12582
 12583* EXEC CICS READ
 12584*        DATASET (TRLR-FILE-ID)
 12585*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12586*        RIDFLD  (TRLR-KEY)
 12587*    END-EXEC.
 12588*    MOVE '&"S        E          (   #00010943' TO DFHEIV0
 12589     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12590     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12591     MOVE X'2020233030303130393433' TO DFHEIV0(25:11)
 12592     CALL 'kxdfhei1' USING DFHEIV0,
 12593           TRLR-FILE-ID,
 12594           DFHEIV20,
 12595           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 238
* EL131.cbl
 12596           TRLR-KEY,
 12597           DFHEIV99,
 12598           DFHEIV99,
 12599           DFHEIV99
 12600     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12601         DFHEIV20
 12602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12603
 12604
 12605     IF BENEFICIARY-PAID-AUTO
 12606         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 12607     END-IF.
 12608
 12609 2800-EXIT.
 12610      EXIT.
 12611
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 239
* EL131.cbl
 12613 3000-DELETE-CLAIM.
 12614     IF  NOT MODIFY-CAP
 12615         MOVE ER-0070            TO EMI-ERROR
 12616         MOVE -1                 TO MAINTL
 12617         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12618         GO TO 8110-SEND-DATA.
 12619
 12620
 12621* EXEC CICS READ
 12622*         SET      (ADDRESS OF CLAIM-MASTER)
 12623*         DATASET  (CLMS-FILE-ID)
 12624*         RIDFLD   (MSTR-KEY)
 12625*    END-EXEC.
 12626*    MOVE '&"S        E          (   #00010964' TO DFHEIV0
 12627     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12628     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12629     MOVE X'2020233030303130393634' TO DFHEIV0(25:11)
 12630     CALL 'kxdfhei1' USING DFHEIV0,
 12631           CLMS-FILE-ID,
 12632           DFHEIV20,
 12633           DFHEIV99,
 12634           MSTR-KEY,
 12635           DFHEIV99,
 12636           DFHEIV99,
 12637           DFHEIV99
 12638     SET ADDRESS OF CLAIM-MASTER TO
 12639         DFHEIV20
 12640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12641
 12642
 12643     IF CL-1ST-TRL-AVAIL
 12644         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 12645     ELSE
 12646        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 12647        MOVE 0                   TO TRLR-SEQ-NO
 12648
 12649* EXEC CICS STARTBR
 12650*            DATASET (TRLR-FILE-ID)
 12651*            RIDFLD  (TRLR-KEY)
 12652*        END-EXEC
 12653     MOVE 0
 12654       TO DFHEIV11
 12655*    MOVE '&,         G          &   #00010975' TO DFHEIV0
 12656     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12657     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12658     MOVE X'2020233030303130393735' TO DFHEIV0(25:11)
 12659     CALL 'kxdfhei1' USING DFHEIV0,
 12660           TRLR-FILE-ID,
 12661           TRLR-KEY,
 12662           DFHEIV99,
 12663           DFHEIV11,
 12664           DFHEIV99
 12665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12666         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 12667
 12668* EXEC CICS ENDBR
 12669*            DATASET (TRLR-FILE-ID)
 12670*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 240
* EL131.cbl
 12671     MOVE 0
 12672       TO DFHEIV11
 12673*    MOVE '&2                    $   #00010980' TO DFHEIV0
 12674     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12675     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12676     MOVE X'2020233030303130393830' TO DFHEIV0(25:11)
 12677     CALL 'kxdfhei1' USING DFHEIV0,
 12678           TRLR-FILE-ID,
 12679           DFHEIV11,
 12680           DFHEIV99
 12681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12682        IF SCREEN-ERROR
 12683            MOVE ER-0208         TO EMI-ERROR
 12684            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12685            MOVE -1              TO MAINTL
 12686            GO TO 8110-SEND-DATA
 12687        ELSE
 12688            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 12689
 12690     IF SCREEN-ERROR
 12691         MOVE -1                 TO MAINTL
 12692         GO TO 8110-SEND-DATA.
 12693
 12694     MOVE -1                     TO ONE-OR-MIN1.
 12695     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 12696
 12697     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 12698         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 12699                                    WS-SAVE-CLAIM-KEY
 12700         MOVE +1                 TO ONE-OR-MIN1
 12701         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 12702
 12703     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 12704
 12705     MOVE LOW-VALUES             TO EL131AO.
 12706     MOVE ER-0000                TO EMI-ERROR.
 12707     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12708     MOVE 'X'                    TO PI-RETURN-CD-1.
 12709     MOVE -1                     TO MAINTL.
 12710     GO TO 8100-SEND-MAP.
 12711
 12712 3010-DEL-MSTR-TRLR.
 12713
 12714* EXEC CICS READ UPDATE
 12715*         SET       (ADDRESS OF CLAIM-MASTER)
 12716*         DATASET   (CLMS-FILE-ID)
 12717*         RIDFLD    (MSTR-KEY)
 12718*    END-EXEC.
 12719*    MOVE '&"S        EU         (   #00011014' TO DFHEIV0
 12720     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12721     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12722     MOVE X'2020233030303131303134' TO DFHEIV0(25:11)
 12723     CALL 'kxdfhei1' USING DFHEIV0,
 12724           CLMS-FILE-ID,
 12725           DFHEIV20,
 12726           DFHEIV99,
 12727           MSTR-KEY,
 12728           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 241
* EL131.cbl
 12729           DFHEIV99,
 12730           DFHEIV99
 12731     SET ADDRESS OF CLAIM-MASTER TO
 12732         DFHEIV20
 12733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12734
 12735
 12736     if (cl-priority-cd = '8')
 12737        and (pi-processor-id not = 'PEMA' and 'JMS '
 12738             AND 'AMWA')
 12739        MOVE ER-8003             TO EMI-ERROR
 12740        PERFORM 9900-ERROR-FORMAT
 12741                                 THRU 9900-EXIT
 12742        MOVE -1                  TO MAINTL
 12743        GO TO 8110-SEND-DATA
 12744     end-if
 12745
 12746     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 12747     MOVE ZERO                   TO TRLR-SEQ-NO.
 12748
 12749
 12750* EXEC CICS HANDLE CONDITION
 12751*         NOTFND    (3010-DEL-ACTQ)
 12752*         ENDFILE   (3040-EXIT)
 12753*    END-EXEC.
 12754*    MOVE '"$I''                  ! < #00011033' TO DFHEIV0
 12755     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12756     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12757     MOVE X'3C20233030303131303333' TO DFHEIV0(25:11)
 12758     CALL 'kxdfhei1' USING DFHEIV0
 12759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12760
 12761
 12762     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 12763
 12764 3010-DEL-ACTQ.
 12765
 12766
 12767* EXEC CICS HANDLE CONDITION
 12768*         NOTFND    (3010-NO-ACTIVITY)
 12769*         ENDFILE   (3050-EXIT)
 12770*    END-EXEC.
 12771*    MOVE '"$I''                  ! = #00011042' TO DFHEIV0
 12772     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12773     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12774     MOVE X'3D20233030303131303432' TO DFHEIV0(25:11)
 12775     CALL 'kxdfhei1' USING DFHEIV0
 12776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12777
 12778
 12779
 12780* EXEC CICS STARTBR
 12781*         DATASET  (ACTQ-FILE-ID)
 12782*         RIDFLD   (ACTQ-KEY)
 12783*    END-EXEC.
 12784     MOVE 0
 12785       TO DFHEIV11
 12786*    MOVE '&,         G          &   #00011047' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 242
* EL131.cbl
 12787     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12788     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12789     MOVE X'2020233030303131303437' TO DFHEIV0(25:11)
 12790     CALL 'kxdfhei1' USING DFHEIV0,
 12791           ACTQ-FILE-ID,
 12792           ACTQ-KEY,
 12793           DFHEIV99,
 12794           DFHEIV11,
 12795           DFHEIV99
 12796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12797
 12798
 12799
 12800* EXEC CICS GETMAIN
 12801*         SET      (ADDRESS OF ACTIVITY-QUE)
 12802*         LENGTH   (ACTQ-LENGTH)
 12803*         INITIMG  (GETMAIN-SPACE)
 12804*    END-EXEC.
 12805*    MOVE ',"IL                  $   #00011052' TO DFHEIV0
 12806     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12807     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12808     MOVE X'2020233030303131303532' TO DFHEIV0(25:11)
 12809     CALL 'kxdfhei1' USING DFHEIV0,
 12810           DFHEIV20,
 12811           ACTQ-LENGTH,
 12812           GETMAIN-SPACE
 12813     SET ADDRESS OF ACTIVITY-QUE TO
 12814         DFHEIV20
 12815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12816
 12817
 12818     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 12819
 12820
 12821* EXEC CICS ENDBR
 12822*         DATASET (ACTQ-FILE-ID)
 12823*    END-EXEC.
 12824     MOVE 0
 12825       TO DFHEIV11
 12826*    MOVE '&2                    $   #00011060' TO DFHEIV0
 12827     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12828     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12829     MOVE X'2020233030303131303630' TO DFHEIV0(25:11)
 12830     CALL 'kxdfhei1' USING DFHEIV0,
 12831           ACTQ-FILE-ID,
 12832           DFHEIV11,
 12833           DFHEIV99
 12834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12835
 12836
 12837 3010-NO-ACTIVITY.
 12838
 12839
 12840* EXEC CICS HANDLE CONDITION
 12841*        NOTFND   (3010-CERT-NOT-FOUND)
 12842*    END-EXEC.
 12843*    MOVE '"$I                   ! > #00011066' TO DFHEIV0
 12844     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 243
* EL131.cbl
 12845     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12846     MOVE X'3E20233030303131303636' TO DFHEIV0(25:11)
 12847     CALL 'kxdfhei1' USING DFHEIV0
 12848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12849
 12850
 12851     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 12852     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12853     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 12854     MOVE CL-CERT-STATE          TO CERT-STATE.
 12855     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12856     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 12857     MOVE CL-CERT-NO             TO CERT-CERT.
 12858
 12859
 12860* EXEC CICS READ
 12861*        DATASET   (CERT-FILE-ID)
 12862*        RIDFLD    (CERT-KEY)
 12863*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 12864*    END-EXEC.
 12865*    MOVE '&"S        E          (   #00011078' TO DFHEIV0
 12866     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12867     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12868     MOVE X'2020233030303131303738' TO DFHEIV0(25:11)
 12869     CALL 'kxdfhei1' USING DFHEIV0,
 12870           CERT-FILE-ID,
 12871           DFHEIV20,
 12872           DFHEIV99,
 12873           CERT-KEY,
 12874           DFHEIV99,
 12875           DFHEIV99,
 12876           DFHEIV99
 12877     SET ADDRESS OF CERTIFICATE-MASTER TO
 12878         DFHEIV20
 12879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12880
 12881
 12882     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 12883       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 12884         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 12885     ELSE
 12886         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 12887
 12888  3010-UPDATE-CERT-TRLR.
 12889
 12890      MOVE CERT-KEY              TO ELCRTT-KEY
 12891      MOVE 'B'                   TO CTRLR-REC-TYPE
 12892
 12893* EXEC CICS READ
 12894*        UPDATE
 12895*        DATASET   ('ELCRTT')
 12896*        RIDFLD    (ELCRTT-KEY)
 12897*        INTO      (CERTIFICATE-TRAILERS)
 12898*        RESP      (WS-RESPONSE)
 12899*     END-EXEC
 12900     MOVE LENGTH OF
 12901      CERTIFICATE-TRAILERS
 12902       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 244
* EL131.cbl
 12903     MOVE 'ELCRTT' TO DFHEIV1
 12904*    MOVE '&"IL       EU         (  N#00011094' TO DFHEIV0
 12905     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12906     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12907     MOVE X'204E233030303131303934' TO DFHEIV0(25:11)
 12908     CALL 'kxdfhei1' USING DFHEIV0,
 12909           DFHEIV1,
 12910           CERTIFICATE-TRAILERS,
 12911           DFHEIV11,
 12912           ELCRTT-KEY,
 12913           DFHEIV99,
 12914           DFHEIV99,
 12915           DFHEIV99
 12916     MOVE EIBRESP  TO WS-RESPONSE
 12917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12918      IF WS-RESP-NORMAL
 12919*    if cl-insured-claim = 'S'
 12920*       move +2 to s1
 12921*    else
 12922*       MOVE +1 to s1
 12923*    end-if
 12924
 12925     move +1 to s1
 12926     evaluate cl-claim-type
 12927        when 'A'
 12928           move +1 to s2
 12929        when 'I'
 12930           move +2 to s2
 12931        when 'G'
 12932           move +3 to s2
 12933        when 'L'
 12934           move +4 to s2
 12935        when 'P'
 12936           move +5 to s2
 12937     end-evaluate
 12938     SUBTRACT +1 FROM CS-NO-OF-CLAIMS (S1 S2)
 12939     IF CS-NO-OF-CLAIMS (S1 S2) < ZEROS
 12940        MOVE ZEROS               TO CS-NO-OF-CLAIMS (S1 S2)
 12941     END-IF
 12942     if cs-no-of-claims (s1 s2) = zeros
 12943        move spaces              to cs-claim-type (s1 s2)
 12944     end-if
 12945
 12946
 12947* EXEC CICS REWRITE
 12948*       DATASET   ('ELCRTT')
 12949*       FROM      (CERTIFICATE-TRAILERS)
 12950*    END-EXEC
 12951     MOVE LENGTH OF
 12952      CERTIFICATE-TRAILERS
 12953       TO DFHEIV11
 12954     MOVE 'ELCRTT' TO DFHEIV1
 12955*    MOVE '&& L                  %   #00011129' TO DFHEIV0
 12956     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12957     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12958     MOVE X'2020233030303131313239' TO DFHEIV0(25:11)
 12959     CALL 'kxdfhei1' USING DFHEIV0,
 12960           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 245
* EL131.cbl
 12961           CERTIFICATE-TRAILERS,
 12962           DFHEIV11,
 12963           DFHEIV99
 12964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12965     .
 12966 3010-CERT-NOT-FOUND.
 12967
 12968
 12969* EXEC CICS DELETE
 12970*        DATASET  (CLMS-FILE-ID)
 12971*    END-EXEC.
 12972*    MOVE '&(                    &   #00011136' TO DFHEIV0
 12973     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12974     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12975     MOVE X'2020233030303131313336' TO DFHEIV0(25:11)
 12976     CALL 'kxdfhei1' USING DFHEIV0,
 12977           CLMS-FILE-ID,
 12978           DFHEIV99,
 12979           DFHEIV99,
 12980           DFHEIV99,
 12981           DFHEIV99
 12982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12983
 12984
 12985 3010-EXIT.
 12986      EXIT.
 12987
 12988 3020-UPDATE-CERT.
 12989
 12990* EXEC CICS READ UPDATE
 12991*         DATASET  (CERT-FILE-ID)
 12992*         RIDFLD   (CERT-KEY)
 12993*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12994*    END-EXEC.
 12995*    MOVE '&"S        EU         (   #00011144' TO DFHEIV0
 12996     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12997     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12998     MOVE X'2020233030303131313434' TO DFHEIV0(25:11)
 12999     CALL 'kxdfhei1' USING DFHEIV0,
 13000           CERT-FILE-ID,
 13001           DFHEIV20,
 13002           DFHEIV99,
 13003           CERT-KEY,
 13004           DFHEIV99,
 13005           DFHEIV99,
 13006           DFHEIV99
 13007     SET ADDRESS OF CERTIFICATE-MASTER TO
 13008         DFHEIV20
 13009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13010
 13011
 13012     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 13013
 13014
 13015* EXEC CICS HANDLE CONDITION
 13016*         DUPKEY   (3020-EXIT)
 13017*    END-EXEC.
 13018*    MOVE '"$$                   ! ? #00011152' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 246
* EL131.cbl
 13019     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 13020     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13021     MOVE X'3F20233030303131313532' TO DFHEIV0(25:11)
 13022     CALL 'kxdfhei1' USING DFHEIV0
 13023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13024
 13025
 13026
 13027* EXEC CICS REWRITE
 13028*         DATASET  (CERT-FILE-ID)
 13029*         FROM     (CERTIFICATE-MASTER)
 13030*    END-EXEC.
 13031     MOVE LENGTH OF
 13032      CERTIFICATE-MASTER
 13033       TO DFHEIV11
 13034*    MOVE '&& L                  %   #00011156' TO DFHEIV0
 13035     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13036     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13037     MOVE X'2020233030303131313536' TO DFHEIV0(25:11)
 13038     CALL 'kxdfhei1' USING DFHEIV0,
 13039           CERT-FILE-ID,
 13040           CERTIFICATE-MASTER,
 13041           DFHEIV11,
 13042           DFHEIV99
 13043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13044
 13045
 13046 3020-EXIT.
 13047     EXIT.
 13048
 13049 3030-DELETE-CERT.
 13050
 13051* EXEC CICS READ UPDATE
 13052*         DATASET  (CERT-FILE-ID)
 13053*         RIDFLD   (CERT-KEY)
 13054*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13055*    END-EXEC.
 13056*    MOVE '&"S        EU         (   #00011165' TO DFHEIV0
 13057     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13058     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13059     MOVE X'2020233030303131313635' TO DFHEIV0(25:11)
 13060     CALL 'kxdfhei1' USING DFHEIV0,
 13061           CERT-FILE-ID,
 13062           DFHEIV20,
 13063           DFHEIV99,
 13064           CERT-KEY,
 13065           DFHEIV99,
 13066           DFHEIV99,
 13067           DFHEIV99
 13068     SET ADDRESS OF CERTIFICATE-MASTER TO
 13069         DFHEIV20
 13070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13071
 13072
 13073
 13074* EXEC CICS DELETE
 13075*         DATASET   (CERT-FILE-ID)
 13076*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 247
* EL131.cbl
 13077*    MOVE '&(                    &   #00011171' TO DFHEIV0
 13078     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13079     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13080     MOVE X'2020233030303131313731' TO DFHEIV0(25:11)
 13081     CALL 'kxdfhei1' USING DFHEIV0,
 13082           CERT-FILE-ID,
 13083           DFHEIV99,
 13084           DFHEIV99,
 13085           DFHEIV99,
 13086           DFHEIV99
 13087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13088
 13089
 13090 3030-EXIT.
 13091     EXIT.
 13092
 13093 3040-DELETE-TRLR.
 13094
 13095* EXEC CICS READ
 13096*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13097*         DATASET  (TRLR-FILE-ID)
 13098*         RIDFLD   (TRLR-KEY)
 13099*         GTEQ
 13100*    END-EXEC.
 13101*    MOVE '&"S        G          (   #00011179' TO DFHEIV0
 13102     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13103     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13104     MOVE X'2020233030303131313739' TO DFHEIV0(25:11)
 13105     CALL 'kxdfhei1' USING DFHEIV0,
 13106           TRLR-FILE-ID,
 13107           DFHEIV20,
 13108           DFHEIV99,
 13109           TRLR-KEY,
 13110           DFHEIV99,
 13111           DFHEIV99,
 13112           DFHEIV99
 13113     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13114         DFHEIV20
 13115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13116
 13117
 13118     IF PI-COMPANY-CD = AT-COMPANY-CD
 13119        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 13120        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13121           GO TO 3040-EXIT
 13122        ELSE
 13123           NEXT SENTENCE
 13124     ELSE
 13125        GO TO 3040-EXIT.
 13126
 13127
 13128* EXEC CICS DELETE
 13129*         DATASET  (TRLR-FILE-ID)
 13130*         RIDFLD   (TRLR-KEY)
 13131*    END-EXEC.
 13132*    MOVE '&(  R                 &   #00011195' TO DFHEIV0
 13133     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13134     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 248
* EL131.cbl
 13135     MOVE X'2020233030303131313935' TO DFHEIV0(25:11)
 13136     CALL 'kxdfhei1' USING DFHEIV0,
 13137           TRLR-FILE-ID,
 13138           TRLR-KEY,
 13139           DFHEIV99,
 13140           DFHEIV99,
 13141           DFHEIV99
 13142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13143
 13144
 13145     GO TO 3040-DELETE-TRLR.
 13146
 13147 3040-EXIT.
 13148     EXIT.
 13149
 13150 3050-DELETE-ACTQ.
 13151
 13152* EXEC CICS READNEXT
 13153*         DATASET  (ACTQ-FILE-ID)
 13154*         RIDFLD   (ACTQ-KEY)
 13155*         INTO     (ACTIVITY-QUE)
 13156*    END-EXEC.
 13157     MOVE LENGTH OF
 13158      ACTIVITY-QUE
 13159       TO DFHEIV12
 13160     MOVE 0
 13161       TO DFHEIV11
 13162*    MOVE '&.IL                  )   #00011206' TO DFHEIV0
 13163     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13164     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13165     MOVE X'2020233030303131323036' TO DFHEIV0(25:11)
 13166     CALL 'kxdfhei1' USING DFHEIV0,
 13167           ACTQ-FILE-ID,
 13168           ACTIVITY-QUE,
 13169           DFHEIV12,
 13170           ACTQ-KEY,
 13171           DFHEIV99,
 13172           DFHEIV11,
 13173           DFHEIV99,
 13174           DFHEIV99
 13175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13176
 13177
 13178     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 13179         GO TO 3050-EXIT.
 13180
 13181
 13182* EXEC CICS ENDBR
 13183*         DATASET  (ACTQ-FILE-ID)
 13184*    END-EXEC.
 13185     MOVE 0
 13186       TO DFHEIV11
 13187*    MOVE '&2                    $   #00011215' TO DFHEIV0
 13188     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13189     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13190     MOVE X'2020233030303131323135' TO DFHEIV0(25:11)
 13191     CALL 'kxdfhei1' USING DFHEIV0,
 13192           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 249
* EL131.cbl
 13193           DFHEIV11,
 13194           DFHEIV99
 13195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13196
 13197
 13198
 13199* EXEC CICS DELETE
 13200*         DATASET   (ACTQ-FILE-ID)
 13201*         RIDFLD    (ACTQ-KEY)
 13202*    END-EXEC.
 13203*    MOVE '&(  R                 &   #00011219' TO DFHEIV0
 13204     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13205     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13206     MOVE X'2020233030303131323139' TO DFHEIV0(25:11)
 13207     CALL 'kxdfhei1' USING DFHEIV0,
 13208           ACTQ-FILE-ID,
 13209           ACTQ-KEY,
 13210           DFHEIV99,
 13211           DFHEIV99,
 13212           DFHEIV99
 13213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13214
 13215
 13216
 13217* EXEC CICS STARTBR
 13218*         DATASET   (ACTQ-FILE-ID)
 13219*         RIDFLD    (ACTQ-KEY)
 13220*    END-EXEC.
 13221     MOVE 0
 13222       TO DFHEIV11
 13223*    MOVE '&,         G          &   #00011224' TO DFHEIV0
 13224     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13225     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13226     MOVE X'2020233030303131323234' TO DFHEIV0(25:11)
 13227     CALL 'kxdfhei1' USING DFHEIV0,
 13228           ACTQ-FILE-ID,
 13229           ACTQ-KEY,
 13230           DFHEIV99,
 13231           DFHEIV11,
 13232           DFHEIV99
 13233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13234
 13235
 13236     GO TO 3050-DELETE-ACTQ.
 13237
 13238 3050-EXIT.
 13239     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 250
* EL131.cbl
 13241 3060-READ-TRLR.
 13242
 13243* EXEC CICS HANDLE CONDITION
 13244*         NOTFND    (3060-EXIT)
 13245*         ENDFILE   (3060-EXIT)
 13246*    END-EXEC.
 13247*    MOVE '"$I''                  ! @ #00011235' TO DFHEIV0
 13248     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13249     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13250     MOVE X'4020233030303131323335' TO DFHEIV0(25:11)
 13251     CALL 'kxdfhei1' USING DFHEIV0
 13252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13253
 13254
 13255 3060-LOOP.
 13256
 13257* EXEC CICS READNEXT
 13258*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13259*         DATASET  (TRLR-FILE-ID)
 13260*         RIDFLD   (TRLR-KEY)
 13261*    END-EXEC.
 13262     MOVE 0
 13263       TO DFHEIV11
 13264*    MOVE '&.S                   )   #00011241' TO DFHEIV0
 13265     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13266     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13267     MOVE X'2020233030303131323431' TO DFHEIV0(25:11)
 13268     CALL 'kxdfhei1' USING DFHEIV0,
 13269           TRLR-FILE-ID,
 13270           DFHEIV20,
 13271           DFHEIV99,
 13272           TRLR-KEY,
 13273           DFHEIV99,
 13274           DFHEIV11,
 13275           DFHEIV99,
 13276           DFHEIV99
 13277     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13278         DFHEIV20
 13279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13280
 13281
 13282     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13283         GO TO 3060-EXIT.
 13284
 13285     IF FORM-CONTROL-TR
 13286         IF AT-RECORDED-DT = SAVE-BIN-DATE
 13287             NEXT SENTENCE
 13288         ELSE
 13289             MOVE 'X'            TO ERROR-SWITCH
 13290             GO TO 3060-EXIT
 13291     ELSE
 13292         IF PAYMENT-TR OR CORRESPONDENCE-TR
 13293            MOVE 'X'                 TO ERROR-SWITCH
 13294            GO TO 3060-EXIT.
 13295
 13296     GO TO 3060-LOOP.
 13297
 13298 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 251
* EL131.cbl
 13299     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 252
* EL131.cbl
 13301 3997-GET-ERPDEF.
 13302
 13303     move cl-company-cd          to cert-company-code
 13304     move cl-cert-key-data       to cert-key (2:21)
 13305     move cl-cert-no             to cert-cert
 13306
 13307
 13308* EXEC CICS READ
 13309*        DATASET   (CERT-FILE-ID)
 13310*        RIDFLD    (CERT-KEY)
 13311*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13312*        resp      (ws-response)
 13313*    END-EXEC
 13314*    MOVE '&"S        E          (  N#00011272' TO DFHEIV0
 13315     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13316     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13317     MOVE X'204E233030303131323732' TO DFHEIV0(25:11)
 13318     CALL 'kxdfhei1' USING DFHEIV0,
 13319           CERT-FILE-ID,
 13320           DFHEIV20,
 13321           DFHEIV99,
 13322           CERT-KEY,
 13323           DFHEIV99,
 13324           DFHEIV99,
 13325           DFHEIV99
 13326     SET ADDRESS OF CERTIFICATE-MASTER TO
 13327         DFHEIV20
 13328     MOVE EIBRESP  TO ws-response
 13329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13330
 13331     MOVE SPACES                 TO WS-CRIT-PER-RECURRENT
 13332                                    WS-ERPDEF-SW
 13333     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 13334                                    WS-CRIT-PER-RTW-MOS
 13335
 13336     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 13337     MOVE CM-STATE               TO ERPDEF-STATE
 13338     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 13339     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 13340     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
 13341     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 13342     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 13343
 13344
 13345* EXEC CICS STARTBR
 13346*        DATASET  ('ERPDEF')
 13347*        RIDFLD   (ERPDEF-KEY)
 13348*        GTEQ
 13349*        RESP     (WS-RESPONSE)
 13350*    END-EXEC
 13351     MOVE 'ERPDEF' TO DFHEIV1
 13352     MOVE 0
 13353       TO DFHEIV11
 13354*    MOVE '&,         G          &  N#00011292' TO DFHEIV0
 13355     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13356     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13357     MOVE X'204E233030303131323932' TO DFHEIV0(25:11)
 13358     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 253
* EL131.cbl
 13359           DFHEIV1,
 13360           ERPDEF-KEY,
 13361           DFHEIV99,
 13362           DFHEIV11,
 13363           DFHEIV99
 13364     MOVE EIBRESP  TO WS-RESPONSE
 13365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13366
 13367     IF WS-RESP-NORMAL
 13368
 13369* EXEC CICS READNEXT
 13370*          DATASET  ('ERPDEF')
 13371*          INTO     (PRODUCT-MASTER)
 13372*          RIDFLD   (ERPDEF-KEY)
 13373*          RESP     (WS-RESPONSE)
 13374*       END-EXEC
 13375     MOVE LENGTH OF
 13376      PRODUCT-MASTER
 13377       TO DFHEIV12
 13378     MOVE 'ERPDEF' TO DFHEIV1
 13379     MOVE 0
 13380       TO DFHEIV11
 13381*    MOVE '&.IL                  )  N#00011300' TO DFHEIV0
 13382     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13383     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13384     MOVE X'204E233030303131333030' TO DFHEIV0(25:11)
 13385     CALL 'kxdfhei1' USING DFHEIV0,
 13386           DFHEIV1,
 13387           PRODUCT-MASTER,
 13388           DFHEIV12,
 13389           ERPDEF-KEY,
 13390           DFHEIV99,
 13391           DFHEIV11,
 13392           DFHEIV99,
 13393           DFHEIV99
 13394     MOVE EIBRESP  TO WS-RESPONSE
 13395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13396        IF WS-RESP-NORMAL
 13397           IF (ERPDEF-KEY-SAVE (1:16) =
 13398              PD-CONTROL-PRIMARY (1:16))
 13399              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 13400              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 13401                 (A1 > +8)
 13402                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 13403              END-PERFORM
 13404              IF A1 < +9
 13405                 SET ERPDEF-FOUND TO TRUE
 13406                 MOVE PD-CRIT-PERIOD (A1)
 13407                              TO WS-CRITICAL-PERIOD
 13408                 MOVE PD-REC-CRIT-PERIOD (A1)
 13409                              TO WS-CRIT-PER-RECURRENT
 13410                 IF PD-RTW-MOS (A1) NUMERIC
 13411                    MOVE PD-RTW-MOS (A1)
 13412                              TO WS-CRIT-PER-RTW-MOS
 13413                 ELSE
 13414                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 13415                 END-IF
 13416                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 254
* EL131.cbl
 13417                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 13418                                 TO WS-EXCL-PERIOD
 13419                 END-IF
 13420                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 13421                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 13422                                 TO WS-COV-ENDS
 13423                 END-IF
 13424                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 13425                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 13426                                 TO WS-ACC-PERIOD
 13427                 END-IF
 13428              END-IF
 13429           END-IF
 13430        END-IF
 13431     END-IF
 13432
 13433     .
 13434 3997-EXIT.
 13435     EXIT.
 13436 4000-FORCE-ERRORS.
 13437     IF PI-RETURN-CD-1 = 'X'
 13438         MOVE ER-0311            TO EMI-ERROR
 13439         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13440         MOVE -1                 TO MAINTL
 13441         GO TO 8110-SEND-DATA.
 13442
 13443     IF NOT FORCE-CAP
 13444         MOVE ER-0416            TO EMI-ERROR
 13445         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13446         MOVE -1                 TO MAINTL
 13447         GO TO 8110-SEND-DATA.
 13448
 13449     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 13450     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 13451     IF EMI-FATAL-CTR GREATER THAN ZERO
 13452         GO TO 4000-FATAL-ERRORS.
 13453
 13454     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 13455
 13456     IF EMI-FATAL-CTR GREATER THAN ZERO
 13457         GO TO 4000-FATAL-ERRORS.
 13458
 13459     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 13460
 13461     IF EMI-FATAL-CTR GREATER THAN ZERO
 13462         GO TO 4000-FATAL-ERRORS.
 13463
 13464     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 13465     MOVE AL-UANOF               TO CERTA.
 13466     MOVE ER-0000 TO EMI-ERROR.
 13467     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13468
 13469 4000-FATAL-ERRORS.
 13470     MOVE -1                     TO MAINTL.
 13471     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 255
* EL131.cbl
 13473
 13474 4100-SAVE-CHANGES.
 13475     IF MAINTL > 0
 13476         MOVE MAINTI  TO WS-SAVE-MAINTI
 13477         MOVE MAINTL  TO WS-SAVE-MAINTL
 13478     END-IF
 13479     IF STATUSL > 0
 13480         MOVE STATUSI  TO WS-SAVE-STATUSI
 13481         MOVE STATUSL  TO WS-SAVE-STATUSL
 13482     END-IF
 13483     IF REPL > 0
 13484         MOVE REPI  TO WS-SAVE-REPI
 13485         MOVE REPL  TO WS-SAVE-REPL
 13486     END-IF
 13487     IF CAUSEL > 0
 13488         MOVE CAUSEI  TO WS-SAVE-CAUSEI
 13489         MOVE CAUSEL  TO WS-SAVE-CAUSEL
 13490     END-IF
 13491     IF ENDL > 0
 13492         MOVE ENDI  TO WS-SAVE-ENDI
 13493         MOVE ENDL  TO WS-SAVE-ENDL
 13494     END-IF
 13495     IF DIAGL > 0
 13496         MOVE DIAGI  TO WS-SAVE-DIAGI
 13497         MOVE DIAGL  TO WS-SAVE-DIAGL
 13498     END-IF
 13499     IF BENEL > 0
 13500         MOVE BENEI  TO WS-SAVE-BENEI
 13501         MOVE BENEL  TO WS-SAVE-BENEL
 13502     END-IF
 13503     IF BIRTHL > 0
 13504         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 13505         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 13506     END-IF
 13507     IF SOCIALL > 0
 13508         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 13509         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 13510     END-IF
 13511     IF SEXL > 0
 13512         MOVE SEXI  TO WS-SAVE-SEXI
 13513         MOVE SEXL  TO WS-SAVE-SEXL
 13514     END-IF
 13515     IF MLNAMEL > 0
 13516         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 13517         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 13518     END-IF
 13519     IF MFNAMEL > 0
 13520         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 13521         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 13522     END-IF
 13523     IF MMINITL > 0
 13524         MOVE MMINITI  TO WS-SAVE-MMINITI
 13525         MOVE MMINITL  TO WS-SAVE-MMINITL
 13526     END-IF
 13527     IF LOANNOL > 0
 13528         MOVE LOANNOI  TO WS-SAVE-LOANNOI
 13529         MOVE LOANNOL  TO WS-SAVE-LOANNOL
 13530     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 256
* EL131.cbl
 13531     IF LOANBALL > 0
 13532         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 13533         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 13534     END-IF
 13535     IF PROCL > 0
 13536         MOVE PROCI  TO WS-SAVE-PROCI
 13537         MOVE PROCL  TO WS-SAVE-PROCL
 13538     END-IF
 13539     IF SUPVL > 0
 13540         MOVE SUPVI  TO WS-SAVE-SUPVI
 13541         MOVE SUPVL  TO WS-SAVE-SUPVL
 13542     END-IF
 13543     IF PRICDL > 0
 13544         MOVE PRICDI  TO WS-SAVE-PRICDI
 13545         MOVE PRICDL  TO WS-SAVE-PRICDL
 13546     END-IF
 13547     IF FILETOL > 0
 13548         MOVE FILETOI  TO WS-SAVE-FILETOI
 13549         MOVE FILETOL  TO WS-SAVE-FILETOL
 13550     END-IF
 13551     IF PDTHRUL > 0
 13552         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 13553         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 13554     END-IF
 13555     IF PDAMTL > 0
 13556         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 13557         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 13558     END-IF
 13559     IF NODAYSL > 0
 13560         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 13561         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 13562     END-IF
 13563     IF NOPMTSL > 0
 13564         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 13565         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 13566     END-IF
 13567     IF FORMTYPL > 0
 13568         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 13569         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 13570     END-IF
 13571     IF OCCL > 0
 13572         MOVE OCCI  TO WS-SAVE-OCCI
 13573         MOVE OCCL  TO WS-SAVE-OCCL
 13574     END-IF.
 13575 4100-EXIT.
 13576      EXIT.
 13577
 13578 4200-LOAD-CHANGES.
 13579     IF WS-SAVE-MAINTL > 0
 13580         MOVE WS-SAVE-MAINTI  TO MAINTI
 13581         MOVE WS-SAVE-MAINTL  TO MAINTL
 13582         MOVE AL-UANON        TO MAINTA
 13583     END-IF
 13584     IF WS-SAVE-STATUSL > 0
 13585         MOVE WS-SAVE-STATUSI  TO STATUSI
 13586         MOVE WS-SAVE-STATUSL  TO STATUSL
 13587         MOVE AL-UANON         TO STATUSA
 13588     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 257
* EL131.cbl
 13589     IF WS-SAVE-REPL > 0
 13590         MOVE WS-SAVE-REPI  TO REPI
 13591         MOVE WS-SAVE-REPL  TO REPL
 13592         MOVE AL-UANON      TO REPA
 13593     END-IF
 13594     IF WS-SAVE-CAUSEL > 0
 13595         MOVE WS-SAVE-CAUSEI  TO CAUSEI
 13596         MOVE WS-SAVE-CAUSEL  TO CAUSEL
 13597         MOVE AL-UANON        TO CAUSEA
 13598     END-IF
 13599     IF WS-SAVE-ENDL > 0
 13600         MOVE WS-SAVE-ENDI  TO ENDI
 13601         MOVE WS-SAVE-ENDL  TO ENDL
 13602         MOVE AL-UANON      TO ENDA
 13603     END-IF
 13604     IF WS-SAVE-DIAGL > 0
 13605         MOVE WS-SAVE-DIAGI  TO DIAGI
 13606         MOVE WS-SAVE-DIAGL  TO DIAGL
 13607         MOVE AL-UANON       TO DIAGA
 13608     END-IF
 13609     IF WS-SAVE-BENEL > 0
 13610         MOVE WS-SAVE-BENEI  TO BENEI
 13611         MOVE WS-SAVE-BENEL  TO BENEL
 13612         MOVE AL-UANON       TO BENEA
 13613     END-IF
 13614     IF WS-SAVE-BIRTHL > 0
 13615         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 13616         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 13617         MOVE AL-UANON        TO BIRTHA
 13618     END-IF
 13619     IF WS-SAVE-SOCIALL > 0
 13620         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 13621         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 13622         MOVE AL-UANON         TO SOCIALA
 13623     END-IF
 13624     IF WS-SAVE-SEXL > 0
 13625         MOVE WS-SAVE-SEXI  TO SEXI
 13626         MOVE WS-SAVE-SEXL  TO SEXL
 13627         MOVE AL-UANON      TO SEXA
 13628     END-IF
 13629     IF WS-SAVE-MLNAMEL > 0
 13630         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 13631         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 13632         MOVE AL-UANON         TO MLNAMEA
 13633     END-IF
 13634     IF WS-SAVE-MFNAMEL > 0
 13635         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 13636         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 13637         MOVE AL-UANON         TO MFNAMEA
 13638     END-IF
 13639     IF WS-SAVE-MMINITL > 0
 13640         MOVE WS-SAVE-MMINITI  TO MMINITI
 13641         MOVE WS-SAVE-MMINITL  TO MMINITL
 13642         MOVE AL-UANON         TO MMINITA
 13643     END-IF
 13644     IF WS-SAVE-LOANNOL > 0
 13645         MOVE WS-SAVE-LOANNOI  TO LOANNOI
 13646         MOVE WS-SAVE-LOANNOL  TO LOANNOL
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 258
* EL131.cbl
 13647         MOVE AL-UANON         TO LOANNOA
 13648     END-IF
 13649     IF WS-SAVE-LOANBALL > 0
 13650         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 13651         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 13652         MOVE AL-UANON          TO LOANBALA
 13653     END-IF
 13654     IF WS-SAVE-PROCL > 0
 13655         MOVE WS-SAVE-PROCI  TO PROCI
 13656         MOVE WS-SAVE-PROCL  TO PROCL
 13657         MOVE AL-UANON       TO PROCA
 13658     END-IF
 13659     IF WS-SAVE-SUPVL > 0
 13660         MOVE WS-SAVE-SUPVI  TO SUPVI
 13661         MOVE WS-SAVE-SUPVL  TO SUPVL
 13662         MOVE AL-UANON       TO SUPVA
 13663     END-IF
 13664     IF WS-SAVE-PRICDL > 0
 13665         MOVE WS-SAVE-PRICDI  TO PRICDI
 13666         MOVE WS-SAVE-PRICDL  TO PRICDL
 13667         MOVE AL-UANON        TO PRICDA
 13668     END-IF
 13669     IF WS-SAVE-FILETOL > 0
 13670         MOVE WS-SAVE-FILETOI  TO FILETOI
 13671         MOVE WS-SAVE-FILETOL  TO FILETOL
 13672         MOVE AL-UANON         TO FILETOA
 13673     END-IF
 13674     IF WS-SAVE-PDTHRUL > 0
 13675         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 13676         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 13677         MOVE AL-UANON         TO PDTHRUA
 13678     END-IF
 13679     IF WS-SAVE-PDAMTL > 0
 13680         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 13681         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 13682         MOVE AL-UANON        TO PDAMTA
 13683     END-IF
 13684     IF WS-SAVE-NODAYSL > 0
 13685         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 13686         MOVE WS-SAVE-NODAYSL  TO NODAYSL
 13687         MOVE AL-UANON         TO NODAYSA
 13688     END-IF
 13689     IF WS-SAVE-NOPMTSL > 0
 13690         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 13691         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 13692         MOVE AL-UANON         TO NOPMTSA
 13693     END-IF
 13694     IF WS-SAVE-FORMTYPL > 0
 13695         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 13696         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 13697         MOVE AL-UANON          TO FORMTYPA
 13698     END-IF
 13699     IF WS-SAVE-OCCL > 0
 13700         MOVE WS-SAVE-OCCI  TO OCCI
 13701         MOVE WS-SAVE-OCCL  TO OCCL
 13702         MOVE AL-UANON      TO OCCA
 13703     END-IF.
 13704 4200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 259
* EL131.cbl
 13705      EXIT.
 13706
 13707 5000-BUILD-MAP.
 13708     IF PI-RETURN-CD-1 = SPACE
 13709         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 13710
 13711     MOVE SPACE                  TO PI-RETURN-CD-1.
 13712
 13713     MOVE LOW-VALUES             TO EL131AI.
 13714
 13715     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 13716     MOVE PI-CARRIER             TO CARRIER-CODE.
 13717     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 13718     MOVE PI-CERT-NO             TO CERT-NO.
 13719
 13720 5000-READ-CLAIM-MASTER.
 13721
 13722
 13723* EXEC CICS READ
 13724*         SET      (ADDRESS OF CLAIM-MASTER)
 13725*         DATASET  (CLMS-FILE-ID)
 13726*         RIDFLD   (MSTR-KEY)
 13727*    END-EXEC.
 13728*    MOVE '&"S        E          (   #00011632' TO DFHEIV0
 13729     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13730     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13731     MOVE X'2020233030303131363332' TO DFHEIV0(25:11)
 13732     CALL 'kxdfhei1' USING DFHEIV0,
 13733           CLMS-FILE-ID,
 13734           DFHEIV20,
 13735           DFHEIV99,
 13736           MSTR-KEY,
 13737           DFHEIV99,
 13738           DFHEIV99,
 13739           DFHEIV99
 13740     SET ADDRESS OF CLAIM-MASTER TO
 13741         DFHEIV20
 13742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13743
 13744
 13745     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 13746
 13747 5000-READ-DIAGNOSIS-TRAILER.
 13748
 13749
 13750* EXEC CICS HANDLE CONDITION
 13751*         NOTFND (5000-TRLR-NOT-FOUND)
 13752*    END-EXEC.
 13753*    MOVE '"$I                   ! A #00011642' TO DFHEIV0
 13754     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13755     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13756     MOVE X'4120233030303131363432' TO DFHEIV0(25:11)
 13757     CALL 'kxdfhei1' USING DFHEIV0
 13758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13759
 13760
 13761     MOVE MSTR-KEY               TO TRLR-KEY.
 13762     MOVE NINETY                 TO TRLR-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 260
* EL131.cbl
 13763
 13764
 13765* EXEC CICS READ
 13766*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13767*         DATASET  (TRLR-FILE-ID)
 13768*         RIDFLD   (TRLR-KEY)
 13769*    END-EXEC.
 13770*    MOVE '&"S        E          (   #00011649' TO DFHEIV0
 13771     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13772     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13773     MOVE X'2020233030303131363439' TO DFHEIV0(25:11)
 13774     CALL 'kxdfhei1' USING DFHEIV0,
 13775           TRLR-FILE-ID,
 13776           DFHEIV20,
 13777           DFHEIV99,
 13778           TRLR-KEY,
 13779           DFHEIV99,
 13780           DFHEIV99,
 13781           DFHEIV99
 13782     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13783         DFHEIV20
 13784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13785
 13786
 13787     MOVE AT-INFO-LINE-1         TO DIAGO.
 13788
 13789 5000-READ-CERTIFICATE-MASTER.
 13790
 13791     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 13792     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 13793     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 13794     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 13795     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 13796     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 13797     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 13798
 13799
 13800* EXEC CICS HANDLE CONDITION
 13801*         NOTFND (5000-CERT-NOT-FOUND)
 13802*    END-EXEC.
 13803*    MOVE '"$I                   ! B #00011667' TO DFHEIV0
 13804     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13805     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13806     MOVE X'4220233030303131363637' TO DFHEIV0(25:11)
 13807     CALL 'kxdfhei1' USING DFHEIV0
 13808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13809
 13810
 13811
 13812* EXEC CICS READ
 13813*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13814*         DATASET  (CERT-FILE-ID)
 13815*         RIDFLD   (CERT-KEY)
 13816*    END-EXEC.
 13817*    MOVE '&"S        E          (   #00011671' TO DFHEIV0
 13818     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13819     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13820     MOVE X'2020233030303131363731' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 261
* EL131.cbl
 13821     CALL 'kxdfhei1' USING DFHEIV0,
 13822           CERT-FILE-ID,
 13823           DFHEIV20,
 13824           DFHEIV99,
 13825           CERT-KEY,
 13826           DFHEIV99,
 13827           DFHEIV99,
 13828           DFHEIV99
 13829     SET ADDRESS OF CERTIFICATE-MASTER TO
 13830         DFHEIV20
 13831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13832
 13833
 13834     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 13835     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 13836
 13837     GO TO 5000-EXIT.
 13838
 13839 5000-TRLR-NOT-FOUND.
 13840     MOVE ER-7687                TO EMI-ERROR.
 13841     MOVE -1                     TO DIAGL.
 13842     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13843     GO TO 5000-EXIT.
 13844
 13845 5000-CERT-NOT-FOUND.
 13846     MOVE ER-0206                TO EMI-ERROR.
 13847     MOVE -1                     TO CERTL.
 13848     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13849
 13850 5000-EXIT.
 13851     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 262
* EL131.cbl
 13853 5010-RESET-PI-AREA.
 13854     IF CERTI GREATER THAN LOW-VALUES
 13855         MOVE CERTI              TO PI-CERT-PRIME.
 13856
 13857     IF SUFXI GREATER THAN LOW-VALUES
 13858         MOVE SUFXI              TO PI-CERT-SFX.
 13859
 13860     IF CERTEFFI GREATER THAN LOW-VALUES
 13861         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 13862
 13863     IF CERTACTI GREATER THAN LOW-VALUES
 13864         MOVE CERTACTI           TO PI-ACCOUNT.
 13865
 13866     IF CERTSTI GREATER THAN LOW-VALUES
 13867         MOVE CERTSTI            TO PI-STATE.
 13868
 13869     IF CERTCARI GREATER THAN LOW-VALUES
 13870         MOVE CERTCARI           TO PI-CARRIER.
 13871
 13872     IF CERTGRPI GREATER THAN LOW-VALUES
 13873         MOVE CERTGRPI           TO PI-GROUPING.
 13874
 13875 5010-EXIT.
 13876     EXIT.
 13877
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 263
* EL131.cbl
 13879 5020-MOVE-MSTR.
 13880
 13881     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 13882     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 13883     MOVE WS-CLAIM-SEQU          TO SEQUO.
 13884     MOVE AL-SABON               TO SEQUA.
 13885     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 13886     MOVE CL-CLAIM-TYPE          TO TYPEO
 13887                                    pi-claim-type
 13888
 13889     IF CL-TOTAL-PAID-AMT  = +0 AND
 13890        CL-LAST-PMT-AMT    = +0 AND
 13891        CL-NO-OF-PMTS-MADE = +0
 13892          MOVE AL-UANON          TO TYPEA.
 13893
 13894     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 13895     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 13896     MOVE CL-CERT-PRIME          TO CERTO.
 13897     MOVE CL-CERT-SFX            TO SUFXO.
 13898     MOVE CL-CERT-CARRIER        TO CARRO.
 13899
 13900     IF CL-CLAIM-STATUS = 'C'
 13901         MOVE 'CLOSED'           TO STATUSO
 13902     ELSE
 13903         MOVE 'OPEN  '           TO STATUSO.
 13904
 13905     move cl-accident-claim-sw   to accswo
 13906     MOVE CL-PROCESSOR-ID        TO PROCO.
 13907
 13908     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 13909     MOVE CL-CCN                 TO CCNOO.
 13910
 13911     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 13912     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 13913     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 13914     MOVE CL-INSURED-SEX-CD      TO SEXO.
 13915
 13916     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 13917         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 13918         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13919         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13920         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 13921     ELSE
 13922         MOVE SPACES             TO BIRTHO.
 13923
 13924     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 13925        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 13926         NEXT SENTENCE
 13927       ELSE
 13928         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 13929
 13930     IF PI-COMPANY-ID = 'DMD'
 13931       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
 13932          IF SOCIALO = SPACES OR LOW-VALUES
 13933            MOVE ER-0885         TO EMI-ERROR
 13934            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13935
 13936     MOVE CL-INSURED-OCC-CD      TO OCCO.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 264
* EL131.cbl
 13937     MOVE CL-CAUSE-CD            TO CAUSEO.
 13938
 13939     IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 13940         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 13941         MOVE SPACES                 TO DC-OPTION-CODE
 13942         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13943         MOVE DC-GREG-DATE-1-EDIT TO ENDO
 13944     ELSE
 13945         MOVE SPACES             TO ENDO.
 13946
 13947     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 13948        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 13949        MOVE SPACES             TO DC-OPTION-CODE
 13950        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13951        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 13952        IF PI-USES-PAID-TO
 13953           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 13954           MOVE '6'                TO DC-OPTION-CODE
 13955           MOVE +1                 TO DC-ELAPSED-DAYS
 13956           MOVE +0                 TO DC-ELAPSED-MONTHS
 13957           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13958           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 13959        ELSE
 13960           NEXT SENTENCE
 13961     ELSE
 13962        MOVE SPACES             TO PDTHRUO.
 13963
 13964     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 13965     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 13966     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 13967     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 13968
 13969     IF MODIFY-CAP
 13970        MOVE AL-UNNOF            TO PDAMTA
 13971                                    NODAYSA
 13972                                    NOPMTSA
 13973        MOVE AL-UANOF            TO PDTHRUA.
 13974     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 13975     MOVE '2'                    TO CNTL-REC-TYPE
 13976     MOVE +0                     TO CNTL-SEQ-NO
 13977     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 13978
 13979
 13980* EXEC CICS READ
 13981*         DATASET  (CNTL-FILE-ID)
 13982*         SET      (ADDRESS OF CONTROL-FILE)
 13983*         RIDFLD   (CNTL-KEY)
 13984*         RESP     (WS-RESPONSE)
 13985*    END-EXEC
 13986*    MOVE '&"S        E          (  N#00011822' TO DFHEIV0
 13987     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13988     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13989     MOVE X'204E233030303131383232' TO DFHEIV0(25:11)
 13990     CALL 'kxdfhei1' USING DFHEIV0,
 13991           CNTL-FILE-ID,
 13992           DFHEIV20,
 13993           DFHEIV99,
 13994           CNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 265
* EL131.cbl
 13995           DFHEIV99,
 13996           DFHEIV99,
 13997           DFHEIV99
 13998     SET ADDRESS OF CONTROL-FILE TO
 13999         DFHEIV20
 14000     MOVE EIBRESP  TO WS-RESPONSE
 14001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14002
 14003     IF WS-RESP-NORMAL
 14004        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 14005     end-if
 14006     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 14007         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14008         MOVE SPACES             TO DC-OPTION-CODE
 14009         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14010         MOVE DC-GREG-DATE-1-EDIT TO INCO
 14011     ELSE
 14012         MOVE SPACES             TO INCO.
 14013
 14014     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 14015        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 14016        MOVE AL-UANOF            TO INCA
 14017     end-if
 14018     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 14019
 14020     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 14021         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14022         MOVE SPACES             TO DC-OPTION-CODE
 14023         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14024         MOVE DC-GREG-DATE-1-EDIT TO REPO
 14025     ELSE
 14026         MOVE SPACES             TO REPO.
 14027
 14028     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 14029         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 14030         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14031         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14032         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 14033     ELSE
 14034         MOVE SPACES             TO ESTO.
 14035
 14036     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 14037         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 14038         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14039         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14040         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 14041     ELSE
 14042         MOVE SPACES             TO MNTDTO.
 14043
 14044
 14045     IF CL-LAST-MAINT-TYPE = SPACE
 14046         MOVE 'SET-UP'           TO MNTTYPEO
 14047     ELSE
 14048     IF CL-LAST-MAINT-TYPE = '1'
 14049         MOVE 'PAYMNT'           TO MNTTYPEO
 14050     ELSE
 14051     IF CL-LAST-MAINT-TYPE = '2'
 14052         MOVE 'LETTER'           TO MNTTYPEO
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 266
* EL131.cbl
 14053     ELSE
 14054     IF CL-LAST-MAINT-TYPE = '3'
 14055         MOVE 'UPDATE'           TO MNTTYPEO
 14056     ELSE
 14057     IF CL-LAST-MAINT-TYPE = '4'
 14058         MOVE 'RESTOR'           TO MNTTYPEO
 14059     ELSE
 14060     IF CL-LAST-MAINT-TYPE = '5'
 14061         MOVE 'INC DT'           TO MNTTYPEO
 14062     ELSE
 14063     IF CL-LAST-MAINT-TYPE = '6'
 14064         MOVE ' CONV'            TO MNTTYPEO
 14065     ELSE
 14066     IF CL-LAST-MAINT-TYPE = 'C'
 14067         MOVE 'CHGBEN'           TO MNTTYPEO
 14068     ELSE
 14069     IF CL-LAST-MAINT-TYPE = 'E'
 14070         MOVE 'ERRCOR'           TO MNTTYPEO
 14071     ELSE
 14072         MOVE SPACES             TO MNTTYPEO.
 14073
 14074     MOVE CL-BENEFICIARY         TO BENEO.
 14075     MOVE CL-FILE-LOCATION       TO FILETOO.
 14076     IF CL-CRITICAL-PERIOD NOT NUMERIC
 14077        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 14078     END-IF
 14079     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 14080     MOVE CL-CRIT-PER-RECURRENT
 14081                                 TO CRITPTO
 14082     IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 14083        MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 14084     END-IF
 14085     MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 14086     MOVE CL-PRIORITY-CD         TO PRICDO.
 14087     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14088     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 14089     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 14090     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 14091
 14092 5020-EXIT.
 14093     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 267
* EL131.cbl
 14095 5030-MOVE-CERT.
 14096
 14097     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 14098         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14099         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14100         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14101         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 14102       ELSE
 14103         MOVE SPACES             TO CERTEFFO
 14104         MOVE ZERO               TO HOLD-DATE.
 14105
 14106     MOVE CM-ACCOUNT             TO CERTACTO.
 14107     MOVE CM-STATE               TO CERTSTO PI-STATE.
 14108     MOVE CM-GROUPING            TO CERTGRPO.
 14109     MOVE CM-CARRIER             TO CERTCARO.
 14110     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14111     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14112     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14113     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14114     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14115     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14116     MOVE CM-JT-INITIAL          TO JNTINITO.
 14117     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14118
 14119*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14120     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 14121     MOVE '3'                    TO CNTL-REC-TYPE.
 14122     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 14123     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 14124     MOVE ZERO                   TO CNTL-SEQ-NO.
 14125
 14126
 14127* EXEC CICS READ
 14128*         SET        (ADDRESS OF CONTROL-FILE)
 14129*         DATASET    ('ELCNTL')
 14130*         RIDFLD     (CNTL-KEY)
 14131*         RESP       (WS-RESPONSE)
 14132*    END-EXEC.
 14133     MOVE 'ELCNTL' TO DFHEIV1
 14134*    MOVE '&"S        E          (  N#00011952' TO DFHEIV0
 14135     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14136     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14137     MOVE X'204E233030303131393532' TO DFHEIV0(25:11)
 14138     CALL 'kxdfhei1' USING DFHEIV0,
 14139           DFHEIV1,
 14140           DFHEIV20,
 14141           DFHEIV99,
 14142           CNTL-KEY,
 14143           DFHEIV99,
 14144           DFHEIV99,
 14145           DFHEIV99
 14146     SET ADDRESS OF CONTROL-FILE TO
 14147         DFHEIV20
 14148     MOVE EIBRESP  TO WS-RESPONSE
 14149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14150
 14151
 14152     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 268
* EL131.cbl
 14153        MOVE ZERO                TO CP-FREE-LOOK
 14154     ELSE
 14155        MOVE CF-ST-FREE-LOOK-PERIOD
 14156                                 TO CP-FREE-LOOK.
 14157
 14158     IF CM-LF-BENEFIT-CD = '00'
 14159        GO TO 5030-MOVE-CERT-AH.
 14160
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 269
* EL131.cbl
 14162     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 14163     MOVE '5'                    TO DC-OPTION-CODE
 14164     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14165     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 14166     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14167     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 14168     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 14169     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 14170     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14171     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 14172     MOVE '4'                    TO CP-REM-TERM-METHOD
 14173     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 14174     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14175     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 14176
 14177     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14178     IF CM-LF-PREMIUM-RATE NUMERIC
 14179         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14180     ELSE
 14181         MOVE ZEROS              TO LCVRATEO.
 14182
 14183     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14184         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 14185
 14186     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 14187
 14188     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 14189
 14190     IF CM-LF-CURRENT-STATUS = '8'
 14191        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14192            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14193            MOVE ' '             TO DC-OPTION-CODE
 14194            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14195            IF NOT DATE-CONVERSION-ERROR
 14196                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 14197
 14198     IF CM-LF-CURRENT-STATUS = '7'
 14199        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14200            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 14201            MOVE ' '             TO DC-OPTION-CODE
 14202            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14203            IF NOT DATE-CONVERSION-ERROR
 14204                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 14205
 14206     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14207         MOVE ' '                TO DC-OPTION-CODE
 14208         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 14209         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14210         IF NOT DATE-CONVERSION-ERROR
 14211             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 14212             MOVE HOLD-MONTH     TO WORK-MONTH
 14213             MOVE HOLD-YEAR      TO WORK-YEAR
 14214             MOVE WORK-DATE-MY   TO LCVEXITO.
 14215
 14216     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14217        IF CP-REMAINING-TERM-3 = ZEROS
 14218           MOVE 'EXPIRED'        TO LCVSTATO
 14219        ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 270
* EL131.cbl
 14220           MOVE 'ACTIVE'         TO LCVSTATO.
 14221
 14222     IF CM-LF-CURRENT-STATUS = '2'
 14223        MOVE 'PEND   '           TO LCVSTATO.
 14224     IF CM-LF-CURRENT-STATUS = '3'
 14225        MOVE 'RESTORE'           TO LCVSTATO.
 14226     IF CM-LF-CURRENT-STATUS = '5'
 14227        MOVE 'REISSUE'           TO LCVSTATO.
 14228     IF CM-LF-CURRENT-STATUS = '6'
 14229        MOVE 'LMP DIS'           TO LCVSTATO.
 14230     IF CM-LF-CURRENT-STATUS = '7'
 14231        MOVE 'DEATH  '           TO LCVSTATO.
 14232     IF CM-LF-CURRENT-STATUS = '8'
 14233        MOVE 'CANCEL '           TO LCVSTATO.
 14234     IF CM-LF-CURRENT-STATUS = '9'
 14235        MOVE 'RE-ONLY'           TO LCVSTATO.
 14236     IF CM-LF-CURRENT-STATUS = 'V'
 14237        MOVE 'VOID   '           TO LCVSTATO.
 14238     IF CM-LF-CURRENT-STATUS = 'D'
 14239        MOVE 'DECLINE'           TO LCVSTATO.
 14240
 14241     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 14242     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 14243     MOVE '4'                    TO BEN-REC-TYPE.
 14244     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 14245     MOVE ZERO                   TO BEN-SEQ-NO.
 14246
 14247
 14248* EXEC CICS READ GTEQ
 14249*         DATASET  (CNTL-FILE-ID)
 14250*         RIDFLD   (BENEFIT-KEY)
 14251*         SET      (ADDRESS OF CONTROL-FILE)
 14252*    END-EXEC.
 14253*    MOVE '&"S        G          (   #00012054' TO DFHEIV0
 14254     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14255     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14256     MOVE X'2020233030303132303534' TO DFHEIV0(25:11)
 14257     CALL 'kxdfhei1' USING DFHEIV0,
 14258           CNTL-FILE-ID,
 14259           DFHEIV20,
 14260           DFHEIV99,
 14261           BENEFIT-KEY,
 14262           DFHEIV99,
 14263           DFHEIV99,
 14264           DFHEIV99
 14265     SET ADDRESS OF CONTROL-FILE TO
 14266         DFHEIV20
 14267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14268
 14269
 14270     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 14271        CF-RECORD-TYPE NOT = '4'
 14272         MOVE ER-0240            TO EMI-ERROR
 14273         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14274         GO TO 5030-MOVE-CERT-FINISH.
 14275
 14276     MOVE ZERO                   TO COUNT-2.
 14277     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 271
* EL131.cbl
 14278
 14279     IF SCREEN-ERROR
 14280         MOVE ER-0282            TO EMI-ERROR
 14281         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14282        ELSE
 14283         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 14284
 14285 5030-MOVE-CERT-AH.
 14286
 14287     IF CM-LF-BENEFIT-CD = '00'
 14288         IF CM-AH-BENEFIT-CD = '00'
 14289             GO TO 5030-MOVE-CERT-FINISH.
 14290
 14291     IF CM-AH-BENEFIT-CD = '00'
 14292        MOVE SPACES             TO ACVKINDO
 14293        COMPUTE PI-PAYMENT-AMT =
 14294                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 14295        GO TO 5030-MOVE-CERT-FINISH.
 14296
 14297     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 14298     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 14299     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 14300     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 14301     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 14302     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14303     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14304     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 14305
 14306**DMD **********************************************
 14307     IF PI-COMPANY-ID = 'DMD'
 14308         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 14309                                   CM-PMT-EXTENSION-DAYS
 14310         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 14311                                      CL-NO-OF-DAYS-PAID
 14312         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 14313             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 14314         MOVE WS-REM-MOS         TO ACVRTRMO
 14315                                    CP-REMAINING-TERM-3
 14316*        MOVE WS-REM-DAYS        TO DAYSPO
 14317         GO TO 5030-SKIP-RTRM.
 14318**DMD **********************************************
 14319
 14320     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14321     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14322     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 14323     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 14324
 14325 5030-SKIP-RTRM.
 14326     IF CM-AH-PREMIUM-RATE NUMERIC
 14327         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 14328     ELSE
 14329         MOVE ZEROS              TO ACVRATEO.
 14330
 14331     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 14332     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 14333
 14334     IF CM-AH-CURRENT-STATUS = '8'
 14335        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 272
* EL131.cbl
 14336            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 14337            MOVE ' '             TO DC-OPTION-CODE
 14338            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14339            IF NOT DATE-CONVERSION-ERROR
 14340                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 14341
 14342     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 14343        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 14344            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 14345            MOVE ' '             TO DC-OPTION-CODE
 14346            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14347            IF NOT DATE-CONVERSION-ERROR
 14348                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 14349
 14350     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 14351        IF CP-REMAINING-TERM-3 = ZEROS
 14352           MOVE 'EXPIRED'        TO ACVSTATO
 14353        ELSE
 14354           MOVE 'ACTIVE'         TO ACVSTATO.
 14355
 14356     IF CM-AH-CURRENT-STATUS = '2'
 14357        MOVE 'PEND   '           TO ACVSTATO.
 14358     IF CM-AH-CURRENT-STATUS = '3'
 14359        MOVE 'RESTORE'           TO ACVSTATO.
 14360     IF CM-AH-CURRENT-STATUS = '5'
 14361        MOVE 'REISSUE'           TO ACVSTATO.
 14362     IF CM-AH-CURRENT-STATUS = '6'
 14363        MOVE 'LMP DIS'           TO ACVSTATO.
 14364     IF CM-AH-CURRENT-STATUS = '7'
 14365        MOVE 'DEATH  '           TO ACVSTATO.
 14366     IF CM-AH-CURRENT-STATUS = '8'
 14367        MOVE 'CANCEL '           TO ACVSTATO.
 14368     IF CM-AH-CURRENT-STATUS = '9'
 14369        MOVE 'RE-ONLY'           TO ACVSTATO.
 14370     IF CM-AH-CURRENT-STATUS = 'V'
 14371        MOVE 'VOID   '           TO ACVSTATO.
 14372     IF CM-AH-CURRENT-STATUS = '9'
 14373        MOVE 'DECLINE'           TO ACVSTATO.
 14374
 14375     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 14376         MOVE ' '                TO DC-OPTION-CODE
 14377         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 14378         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14379         IF NOT DATE-CONVERSION-ERROR
 14380             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 14381             MOVE HOLD-MONTH     TO WORK-MONTH
 14382             MOVE HOLD-YEAR      TO WORK-YEAR
 14383             MOVE WORK-DATE-MY   TO ACVEXITO.
 14384
 14385     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 14386
 14387     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 14388     MOVE '5'                    TO BEN-REC-TYPE.
 14389     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 14390     MOVE ZERO                   TO BEN-SEQ-NO.
 14391
 14392
 14393* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 273
* EL131.cbl
 14394*         DATASET  (CNTL-FILE-ID)
 14395*         RIDFLD   (BENEFIT-KEY)
 14396*         SET      (ADDRESS OF CONTROL-FILE)
 14397*    END-EXEC.
 14398*    MOVE '&"S        G          (   #00012182' TO DFHEIV0
 14399     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14400     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14401     MOVE X'2020233030303132313832' TO DFHEIV0(25:11)
 14402     CALL 'kxdfhei1' USING DFHEIV0,
 14403           CNTL-FILE-ID,
 14404           DFHEIV20,
 14405           DFHEIV99,
 14406           BENEFIT-KEY,
 14407           DFHEIV99,
 14408           DFHEIV99,
 14409           DFHEIV99
 14410     SET ADDRESS OF CONTROL-FILE TO
 14411         DFHEIV20
 14412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14413
 14414
 14415     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 14416        CF-RECORD-TYPE NOT = '5'
 14417         MOVE ER-0250            TO EMI-ERROR
 14418         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14419         GO TO 5030-MOVE-CERT-FINISH.
 14420
 14421     MOVE ZERO                   TO COUNT-2.
 14422     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 14423
 14424     IF SCREEN-ERROR
 14425         MOVE ER-0283            TO EMI-ERROR
 14426         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14427       ELSE
 14428         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 14429
 14430 5030-MOVE-CERT-FINISH.
 14431
 14432     MOVE CM-LOAN-APR            TO APRO.
 14433     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 14434     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 14435     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 14436     MOVE CM-LOAN-NUMBER         TO LOANNOO
 14437     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 14438     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 14439
 14440     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 14441         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 14442         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14443         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14444         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 14445     ELSE
 14446         MOVE SPACES               TO ADDONDTO.
 14447
 14448     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 14449
 14450 5030-EXIT.
 14451     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 274
* EL131.cbl
 14453 5040-FIND-BENEFIT.
 14454     ADD 1                       TO COUNT-2.
 14455     IF COUNT-2 GREATER THAN 8
 14456         GO TO 5050-BENEFIT-NOTFND.
 14457
 14458     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 14459         GO TO 5060-EXIT.
 14460
 14461     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 14462         GO TO 5050-BENEFIT-NOTFND.
 14463
 14464     GO TO 5040-FIND-BENEFIT.
 14465
 14466 5050-BENEFIT-NOTFND.
 14467     MOVE 'X'                    TO ERROR-SWITCH.
 14468
 14469 5060-EXIT.
 14470     EXIT.
 14471
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 275
* EL131.cbl
 14473 6000-CALCULATE-CERT-TERM.
 14474
 14475     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 14476         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 14477     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 14478         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 14479     IF CM-LOAN-APR NOT NUMERIC
 14480         MOVE ZEROS              TO CM-LOAN-APR.
 14481
 14482*    IF WS-CALC-METHOD  = 'G'
 14483         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 14484*     ELSE
 14485*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 14486
 14487     IF N GREATER 120
 14488         MOVE 120                TO N.
 14489
 14490     MOVE '6'                    TO DC-OPTION-CODE.
 14491     MOVE N                      TO DC-ELAPSED-MONTHS.
 14492     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14493     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 14494
 14495     IF CM-LF-BENEFIT-CD NOT = ZERO
 14496         MOVE N                  TO CM-LF-ORIG-TERM
 14497         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 14498         IF NO-CONVERSION-ERROR
 14499             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 14500
 14501     IF CM-AH-BENEFIT-CD NOT = ZERO
 14502         MOVE N                  TO CM-AH-ORIG-TERM
 14503         IF NO-CONVERSION-ERROR
 14504             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 14505
 14506 6000-EXIT.
 14507      EXIT.
 14508
 14509 6100-CALC-GROSS-TERM.
 14510     MOVE CM-LOAN-BALANCE         TO L.
 14511     MOVE PI-PAYMENT-AMT          TO M.
 14512
 14513     COMPUTE N = L / M.
 14514     IF N LESS 1
 14515         MOVE 1  TO N.
 14516
 14517     IF CM-LF-BENEFIT-CD NOT = ZERO
 14518         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 14519     ELSE
 14520         MOVE ZEROS               TO WS-LF-RATE.
 14521
 14522     IF CM-AH-BENEFIT-CD NOT = ZERO
 14523         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 14524     ELSE
 14525         MOVE ZEROS               TO WS-AH-RATE.
 14526
 14527     COMPUTE I = CM-LOAN-APR / +1200.
 14528
 14529 6105-LOOP.
 14530     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 276
* EL131.cbl
 14531         GO TO 6200-EXIT.
 14532     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 14533     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 14534         ADD 1 TO N
 14535         GO TO 6105-LOOP.
 14536
 14537 6200-EXIT.
 14538      EXIT.
 14539
 14540 6210-CALC-LEFT-RIGHTONE.
 14541      MOVE L         TO LEFT-TOT-1.
 14542      SUBTRACT 1 FROM N.
 14543      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 14544      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 14545      ADD 1 TO N.
 14546 6211-CALC-TERM1.
 14547      MOVE N         TO TERM1.
 14548      MULTIPLY M BY TERM1.
 14549 6212-LOOP.
 14550      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 14551      ADD 1 TO A-N.
 14552      MULTIPLY A-N BY TERM1.
 14553      SUBTRACT 1 FROM A-N.
 14554      ADD TERM1 TO LEFT-TOT-1.
 14555 6213-CALC-TERM2.
 14556      MOVE M         TO TERM2.
 14557      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 14558      MULTIPLY IA-N BY TERM2.
 14559      SUBTRACT TERM2 FROM LEFT-TOT-1.
 14560 6215-CALC-RIGHTONE.
 14561      MOVE M         TO RIGHT-TOT-1.
 14562      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 14563      MULTIPLY A-N BY RIGHT-TOT-1.
 14564 6220-EXIT.
 14565      EXIT.
 14566
 14567 6300-CALC-A-N.
 14568     IF N LESS 1
 14569         MOVE 0     TO A-N
 14570         GO TO 6300-EXIT.
 14571     IF I = 0
 14572         MOVE .00001 TO I.
 14573     ADD 1 TO I.
 14574     DIVIDE I INTO 1 GIVING V.
 14575     SUBTRACT 1 FROM I.
 14576     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 14577     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 14578     DIVIDE I INTO TERM3 GIVING A-N.
 14579 6300-EXIT.
 14580      EXIT.
 14581
 14582 6350-CALC-IA-N.
 14583     IF N LESS 1
 14584         MOVE 0      TO IA-N
 14585         GO TO 6400-EXIT.
 14586     ADD 1 TO N.
 14587     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 14588     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 277
* EL131.cbl
 14589     MULTIPLY N BY V-EX-N GIVING TERM3.
 14590     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 14591     SUBTRACT V FROM 1 GIVING TERM4.
 14592     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 14593 6400-EXIT.
 14594      EXIT.
 14595
 14596 6450-CALC-V-EX-N.
 14597     IF N LESS 1
 14598         MOVE 1    TO V-EX-N
 14599         GO TO 6490-EXIT.
 14600     MOVE N        TO NV-STORE.
 14601     IF V-EX-ONETIME = 1  OR
 14602        V NOT = V-EXPONENT (1)
 14603          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 14604 6460-LOOP.
 14605     IF N GREATER 248
 14606         MOVE 248 TO N.
 14607     IF N = 1
 14608         MOVE V               TO V-EX-N
 14609      ELSE
 14610         MOVE V-EXPONENT (N)  TO V-EX-N.
 14611     GO TO 6490-EXIT.
 14612
 14613 6470-BUILD-V-EX-TABLE.
 14614     MOVE 2      TO N.
 14615     MOVE V      TO V-EXPONENT (1)
 14616                    V-EX-N.
 14617 6471-LOOP.
 14618     MULTIPLY V BY V-EX-N.
 14619     MOVE V-EX-N   TO V-EXPONENT (N).
 14620     ADD 1 TO N.
 14621     IF N LESS 248
 14622         GO TO 6471-LOOP.
 14623     MOVE NV-STORE     TO N.
 14624     MOVE 0            TO V-EX-ONETIME.
 14625 6480-EXIT.
 14626      EXIT.
 14627
 14628 6490-EXIT.
 14629      EXIT.
 14630
 14631 6500-CALC-NET-TERM.
 14632     MOVE CM-LOAN-BALANCE         TO L.
 14633     MOVE PI-PAYMENT-AMT          TO M.
 14634
 14635     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 14636     IF WS-REMAIN GREATER ZERO
 14637         ADD 1 TO N.
 14638     IF N = 0
 14639         MOVE 1 TO N.
 14640
 14641 6700-EXIT.
 14642      EXIT.
 14643
 14644 6999-CALC-TERM-EXIT.
 14645     EXIT.
 14646
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 278
* EL131.cbl
 14648 7000-RESET-ATTRIBUTE.
 14649
 14650     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 14651                                    CERTSTA   CERTCARA
 14652                                    CERTGRPA.
 14653     MOVE -1                     TO CERTCARL.
 14654
 14655 7000-EXIT.
 14656     EXIT.
 14657
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 279
* EL131.cbl
 14659 7600-BROWSE-CLAIM.
 14660
 14661
 14662* EXEC CICS READ
 14663*        DATASET(CLMS-FILE-ID)
 14664*        SET    (ADDRESS OF CLAIM-MASTER)
 14665*        RIDFLD (MSTR-KEY)
 14666*        GENERIC
 14667*        EQUAL
 14668*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14669*    END-EXEC.
 14670*    MOVE '&"S  KG    E          (   #00012434' TO DFHEIV0
 14671     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14672     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14673     MOVE X'2020233030303132343334' TO DFHEIV0(25:11)
 14674     CALL 'kxdfhei1' USING DFHEIV0,
 14675           CLMS-FILE-ID,
 14676           DFHEIV20,
 14677           DFHEIV99,
 14678           MSTR-KEY,
 14679           ELMSTR-GENERIC-LENGTH,
 14680           DFHEIV99,
 14681           DFHEIV99
 14682     SET ADDRESS OF CLAIM-MASTER TO
 14683         DFHEIV20
 14684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14685
 14686
 14687     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 14688
 14689     if cl-assoc-cert-total = 0
 14690        move 1 to cl-assoc-cert-total
 14691     end-if
 14692     IF CL-ASSOC-CERT-SEQU = 0
 14693        MOVE 1 TO CL-ASSOC-CERT-SEQU
 14694     END-IF
 14695
 14696     IF CL-ASSOC-CERT-TOTAL = 1
 14697         MOVE AL-SADOF           TO BCERT1A
 14698                                    BSUFX1A
 14699                                    BCERT2A
 14700                                    BSUFX2A
 14701                                    BCERT3A
 14702                                    BSUFX3A
 14703                                    BCERT4A
 14704                                    BSUFX4A
 14705                                    BCERT5A
 14706                                    BSUFX5A
 14707                                    PCERTNOA
 14708                                    PSUFXA
 14709                                    LABEL1A
 14710                                    LABEL2A
 14711         GO TO 7699-EXIT.
 14712
 14713 7610-BROWSE-CLAIM-LOOP.
 14714
 14715     MOVE LOW-VALUES             TO BCERT1O
 14716                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 280
* EL131.cbl
 14717                                    BCERT2O
 14718                                    BSUFX2O
 14719                                    BCERT3O
 14720                                    BSUFX3O
 14721                                    BCERT4O
 14722                                    BSUFX4O
 14723                                    BCERT5O
 14724                                    BSUFX5O.
 14725
 14726
 14727* EXEC CICS HANDLE CONDITION
 14728*        ENDFILE  (7630-END-BROWSE)
 14729*    END-EXEC.
 14730*    MOVE '"$''                   ! C #00012482' TO DFHEIV0
 14731     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14732     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14733     MOVE X'4320233030303132343832' TO DFHEIV0(25:11)
 14734     CALL 'kxdfhei1' USING DFHEIV0
 14735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14736
 14737
 14738
 14739* EXEC CICS STARTBR
 14740*        DATASET    (CLMS-FILE-ID)
 14741*        RIDFLD     (MSTR-KEY)
 14742*    END-EXEC.
 14743     MOVE 0
 14744       TO DFHEIV11
 14745*    MOVE '&,         G          &   #00012486' TO DFHEIV0
 14746     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14747     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14748     MOVE X'2020233030303132343836' TO DFHEIV0(25:11)
 14749     CALL 'kxdfhei1' USING DFHEIV0,
 14750           CLMS-FILE-ID,
 14751           MSTR-KEY,
 14752           DFHEIV99,
 14753           DFHEIV11,
 14754           DFHEIV99
 14755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14756
 14757
 14758     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 14759
 14760 7620-READ-CLAIM-LOOP.
 14761
 14762
 14763* EXEC CICS READNEXT
 14764*        DATASET   (CLMS-FILE-ID)
 14765*        SET       (ADDRESS OF CLAIM-MASTER)
 14766*        RIDFLD    (MSTR-KEY)
 14767*    END-EXEC.
 14768     MOVE 0
 14769       TO DFHEIV11
 14770*    MOVE '&.S                   )   #00012495' TO DFHEIV0
 14771     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14772     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14773     MOVE X'2020233030303132343935' TO DFHEIV0(25:11)
 14774     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 281
* EL131.cbl
 14775           CLMS-FILE-ID,
 14776           DFHEIV20,
 14777           DFHEIV99,
 14778           MSTR-KEY,
 14779           DFHEIV99,
 14780           DFHEIV11,
 14781           DFHEIV99,
 14782           DFHEIV99
 14783     SET ADDRESS OF CLAIM-MASTER TO
 14784         DFHEIV20
 14785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14786
 14787
 14788     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 14789        CL-CARRIER     NOT = CARRI           OR
 14790        CL-CLAIM-NO    NOT = CLAIMI
 14791        GO TO 7630-END-BROWSE.
 14792
 14793     IF WS-ASSOCIATED-CERTS = 1
 14794         MOVE CL-CERT-PRIME      TO BCERT1O
 14795         MOVE CL-CERT-SFX        TO BSUFX1O.
 14796
 14797     IF WS-ASSOCIATED-CERTS = 2
 14798         MOVE CL-CERT-PRIME      TO BCERT2O
 14799         MOVE CL-CERT-SFX        TO BSUFX2O.
 14800
 14801     IF WS-ASSOCIATED-CERTS = 3
 14802         MOVE CL-CERT-PRIME      TO BCERT3O
 14803         MOVE CL-CERT-SFX        TO BSUFX3O.
 14804
 14805     IF WS-ASSOCIATED-CERTS = 4
 14806         MOVE CL-CERT-PRIME      TO BCERT4O
 14807         MOVE CL-CERT-SFX        TO BSUFX4O.
 14808
 14809     IF WS-ASSOCIATED-CERTS = 5
 14810         MOVE CL-CERT-PRIME      TO BCERT5O
 14811         MOVE CL-CERT-SFX        TO BSUFX5O
 14812     ELSE
 14813         ADD +1                  TO WS-ASSOCIATED-CERTS
 14814         GO TO 7620-READ-CLAIM-LOOP.
 14815
 14816 7630-END-BROWSE.
 14817
 14818
 14819* EXEC CICS ENDBR
 14820*        DATASET   (CLMS-FILE-ID)
 14821*    END-EXEC.
 14822     MOVE 0
 14823       TO DFHEIV11
 14824*    MOVE '&2                    $   #00012531' TO DFHEIV0
 14825     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14826     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14827     MOVE X'2020233030303132353331' TO DFHEIV0(25:11)
 14828     CALL 'kxdfhei1' USING DFHEIV0,
 14829           CLMS-FILE-ID,
 14830           DFHEIV11,
 14831           DFHEIV99
 14832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 282
* EL131.cbl
 14833
 14834
 14835 7640-HIGHLIGHT-CERT-DISPLAYED.
 14836
 14837     MOVE AL-SANON               TO BCERT1A
 14838                                    BSUFX1A
 14839                                    BCERT2A
 14840                                    BSUFX2A
 14841                                    BCERT3A
 14842                                    BSUFX3A
 14843                                    BCERT4A
 14844                                    BSUFX4A
 14845                                    BCERT5A
 14846                                    BSUFX5A.
 14847
 14848     IF BCERT1O = CERTI AND
 14849        BSUFX1O = SUFXI
 14850            MOVE AL-SABON        TO BCERT1A
 14851                                    BSUFX1A.
 14852
 14853     IF BCERT2O = CERTI AND
 14854        BSUFX2O = SUFXI
 14855            MOVE AL-SABON        TO BCERT2A
 14856                                    BSUFX2A.
 14857
 14858     IF BCERT3O = CERTI AND
 14859        BSUFX3O = SUFXI
 14860            MOVE AL-SABON        TO BCERT3A
 14861                                    BSUFX3A.
 14862
 14863     IF BCERT4O = CERTI AND
 14864        BSUFX4O = SUFXI
 14865            MOVE AL-SABON        TO BCERT4A
 14866                                    BSUFX4A.
 14867
 14868     IF BCERT5O = CERTI AND
 14869        BSUFX5O = SUFXI
 14870            MOVE AL-SABON        TO BCERT5A
 14871                                    BSUFX5A.
 14872
 14873 7699-EXIT.
 14874     EXIT.
 14875
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 283
* EL131.cbl
 14877 7700-CHECK-SEQUENCE.
 14878
 14879
 14880* EXEC CICS HANDLE CONDITION
 14881*        ENDFILE  (7799-EXIT)
 14882*        NOTFND   (7799-EXIT)
 14883*    END-EXEC.
 14884*    MOVE '"$''I                  ! D #00012579' TO DFHEIV0
 14885     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 14886     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14887     MOVE X'4420233030303132353739' TO DFHEIV0(25:11)
 14888     CALL 'kxdfhei1' USING DFHEIV0
 14889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14890
 14891
 14892
 14893* EXEC CICS READ
 14894*        DATASET(CLMS-FILE-ID)
 14895*        SET    (ADDRESS OF CLAIM-MASTER)
 14896*        RIDFLD (MSTR-KEY)
 14897*        GENERIC
 14898*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14899*    END-EXEC.
 14900*    MOVE '&"S  KG    E          (   #00012584' TO DFHEIV0
 14901     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14902     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14903     MOVE X'2020233030303132353834' TO DFHEIV0(25:11)
 14904     CALL 'kxdfhei1' USING DFHEIV0,
 14905           CLMS-FILE-ID,
 14906           DFHEIV20,
 14907           DFHEIV99,
 14908           MSTR-KEY,
 14909           ELMSTR-GENERIC-LENGTH,
 14910           DFHEIV99,
 14911           DFHEIV99
 14912     SET ADDRESS OF CLAIM-MASTER TO
 14913         DFHEIV20
 14914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14915
 14916
 14917     COMPUTE WS-ASSOC-CERT-TOTAL =
 14918             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 14919
 14920     GO TO 7799-EXIT.
 14921
 14922 7710-RESEQUENCE-CLAIMS.
 14923
 14924
 14925* EXEC CICS HANDLE CONDITION
 14926*        ENDFILE  (7799-EXIT)
 14927*    END-EXEC.
 14928*    MOVE '"$''                   ! E #00012599' TO DFHEIV0
 14929     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14930     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14931     MOVE X'4520233030303132353939' TO DFHEIV0(25:11)
 14932     CALL 'kxdfhei1' USING DFHEIV0
 14933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14934
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 284
* EL131.cbl
 14935
 14936
 14937* EXEC CICS STARTBR
 14938*        DATASET(CLMS-FILE-ID)
 14939*        RIDFLD (MSTR-KEY)
 14940*    END-EXEC.
 14941     MOVE 0
 14942       TO DFHEIV11
 14943*    MOVE '&,         G          &   #00012603' TO DFHEIV0
 14944     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14945     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14946     MOVE X'2020233030303132363033' TO DFHEIV0(25:11)
 14947     CALL 'kxdfhei1' USING DFHEIV0,
 14948           CLMS-FILE-ID,
 14949           MSTR-KEY,
 14950           DFHEIV99,
 14951           DFHEIV11,
 14952           DFHEIV99
 14953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14954
 14955
 14956     COMPUTE WS-ASSOC-CERT-SEQU =
 14957             WS-ASSOC-CERT-SEQU + 1.
 14958
 14959     COMPUTE WS-READNEXT-SWITCH =
 14960             WS-READNEXT-SWITCH + 1.
 14961
 14962 7720-READ-CLAIM-LOOP.
 14963
 14964
 14965* EXEC CICS READNEXT
 14966*        DATASET(CLMS-FILE-ID)
 14967*        SET    (ADDRESS OF CLAIM-MASTER)
 14968*        RIDFLD (MSTR-KEY)
 14969*    END-EXEC.
 14970     MOVE 0
 14971       TO DFHEIV11
 14972*    MOVE '&.S                   )   #00012616' TO DFHEIV0
 14973     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14974     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14975     MOVE X'2020233030303132363136' TO DFHEIV0(25:11)
 14976     CALL 'kxdfhei1' USING DFHEIV0,
 14977           CLMS-FILE-ID,
 14978           DFHEIV20,
 14979           DFHEIV99,
 14980           MSTR-KEY,
 14981           DFHEIV99,
 14982           DFHEIV11,
 14983           DFHEIV99,
 14984           DFHEIV99
 14985     SET ADDRESS OF CLAIM-MASTER TO
 14986         DFHEIV20
 14987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14988
 14989
 14990     IF WS-READNEXT-SWITCH = 1
 14991         ADD 1                   TO WS-READNEXT-SWITCH
 14992         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 285
* EL131.cbl
 14993
 14994 7730-END-BROWSE.
 14995
 14996
 14997* EXEC CICS ENDBR
 14998*        DATASET(CLMS-FILE-ID)
 14999*    END-EXEC.
 15000     MOVE 0
 15001       TO DFHEIV11
 15002*    MOVE '&2                    $   #00012628' TO DFHEIV0
 15003     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15004     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15005     MOVE X'2020233030303132363238' TO DFHEIV0(25:11)
 15006     CALL 'kxdfhei1' USING DFHEIV0,
 15007           CLMS-FILE-ID,
 15008           DFHEIV11,
 15009           DFHEIV99
 15010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15011
 15012
 15013 7740-READ-CLAIM-UPDATE.
 15014
 15015     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 15016        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 15017        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 15018        GO TO 7799-EXIT
 15019     ELSE
 15020        MOVE ZERO                TO WS-READNEXT-SWITCH.
 15021
 15022
 15023* EXEC CICS READ
 15024*        DATASET(CLMS-FILE-ID)
 15025*        SET    (ADDRESS OF CLAIM-MASTER)
 15026*        RIDFLD (MSTR-KEY)
 15027*        UPDATE
 15028*    END-EXEC.
 15029*    MOVE '&"S        EU         (   #00012641' TO DFHEIV0
 15030     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15031     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15032     MOVE X'2020233030303132363431' TO DFHEIV0(25:11)
 15033     CALL 'kxdfhei1' USING DFHEIV0,
 15034           CLMS-FILE-ID,
 15035           DFHEIV20,
 15036           DFHEIV99,
 15037           MSTR-KEY,
 15038           DFHEIV99,
 15039           DFHEIV99,
 15040           DFHEIV99
 15041     SET ADDRESS OF CLAIM-MASTER TO
 15042         DFHEIV20
 15043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15044
 15045
 15046     if (cl-priority-cd = '8')
 15047        and (pi-processor-id not = 'PEMA' and 'JMS '
 15048             AND 'AMWA')
 15049        MOVE ER-8003             TO EMI-ERROR
 15050        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 286
* EL131.cbl
 15051                                 THRU 9900-EXIT
 15052        MOVE -1                  TO MAINTL
 15053        GO TO 8110-SEND-DATA
 15054     end-if
 15055
 15056     IF PI-COMPANY-ID = 'CID' or 'AHL'
 15057         MOVE 'Y'                TO CL-YESNOSW
 15058     END-IF.
 15059
 15060     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15061     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15062
 15063
 15064* EXEC CICS REWRITE
 15065*         DATASET(CLMS-FILE-ID)
 15066*         FROM   (CLAIM-MASTER)
 15067*    END-EXEC.
 15068     MOVE LENGTH OF
 15069      CLAIM-MASTER
 15070       TO DFHEIV11
 15071*    MOVE '&& L                  %   #00012665' TO DFHEIV0
 15072     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15073     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15074     MOVE X'2020233030303132363635' TO DFHEIV0(25:11)
 15075     CALL 'kxdfhei1' USING DFHEIV0,
 15076           CLMS-FILE-ID,
 15077           CLAIM-MASTER,
 15078           DFHEIV11,
 15079           DFHEIV99
 15080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15081
 15082
 15083     GO TO 7710-RESEQUENCE-CLAIMS.
 15084
 15085 7799-EXIT.
 15086     EXIT.
 15087
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 287
* EL131.cbl
 15089 7800-CHECK-AUTO-ACTIVITY.
 15090
 15091
 15092* EXEC CICS HANDLE CONDITION
 15093*        NOTFND   (7800-NOT-FOUND)
 15094*    END-EXEC.
 15095*    MOVE '"$I                   ! F #00012678' TO DFHEIV0
 15096     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15097     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15098     MOVE X'4620233030303132363738' TO DFHEIV0(25:11)
 15099     CALL 'kxdfhei1' USING DFHEIV0
 15100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15101
 15102
 15103     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 15104     MOVE 'T'                        TO  CNTL-REC-TYPE.
 15105     MOVE SPACES                     TO  CNTL-PROC-ID.
 15106     MOVE +0                         TO  CNTL-SEQ-NO.
 15107
 15108
 15109* EXEC CICS READ
 15110*        DATASET   (CNTL-FILE-ID)
 15111*        RIDFLD    (CNTL-KEY)
 15112*        SET       (ADDRESS OF CONTROL-FILE)
 15113*    END-EXEC.
 15114*    MOVE '&"S        E          (   #00012687' TO DFHEIV0
 15115     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15116     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15117     MOVE X'2020233030303132363837' TO DFHEIV0(25:11)
 15118     CALL 'kxdfhei1' USING DFHEIV0,
 15119           CNTL-FILE-ID,
 15120           DFHEIV20,
 15121           DFHEIV99,
 15122           CNTL-KEY,
 15123           DFHEIV99,
 15124           DFHEIV99,
 15125           DFHEIV99
 15126     SET ADDRESS OF CONTROL-FILE TO
 15127         DFHEIV20
 15128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15129
 15130
 15131     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 15132         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 15133
 15134     IF CL-ACTIVITY-CODE NOT = ZEROS
 15135         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 15136         IF MISC-SUB IS GREATER THAN +9
 15137             SUBTRACT +9 FROM MISC-SUB
 15138             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 15139         ELSE
 15140             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 15141     ELSE
 15142         MOVE 'Y'                              TO  WS-RESET-SW.
 15143
 15144     IF STATUSI = 'C' OR 'CLOSED'
 15145         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 15146             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 288
* EL131.cbl
 15147                                         PI-LETTER-SW
 15148             GO TO 7800-EXIT.
 15149
 15150     IF STATUSI = 'C' OR 'CLOSED'
 15151         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 15152             MOVE 'N'                TO  PI-LETTER-SW
 15153         ELSE
 15154             MOVE 'Y'                TO  PI-LETTER-SW.
 15155
 15156     IF STATUSI = 'O' OR 'OPEN'
 15157         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 15158             MOVE 'N'                TO  PI-REC-FOUND-SW
 15159                                         PI-LETTER-SW
 15160             GO TO 7800-EXIT.
 15161
 15162     IF STATUSI = 'O' OR 'OPEN'
 15163         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 15164             MOVE 'N'                TO  PI-LETTER-SW
 15165         ELSE
 15166             MOVE 'Y'                TO  PI-LETTER-SW.
 15167
 15168     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 15169     GO TO 7800-EXIT.
 15170
 15171 7800-NOT-FOUND.
 15172
 15173     MOVE 'N'                        TO  PI-REC-FOUND-SW
 15174                                         PI-LETTER-SW.
 15175
 15176 7800-EXIT.
 15177     EXIT.
 15178
 15179 7850-AUTO-LETTER-WRITER.
 15180
 15181     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 15182     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 15183
 15184     IF STATUSI = 'C' OR 'CLOSED'
 15185         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 15186     ELSE
 15187         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 15188
 15189     IF STATUSI = 'C' OR 'CLOSED'
 15190         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 15191             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15192             MOVE '6'                TO  DC-OPTION-CODE
 15193             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 15194             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15195             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15196             IF NO-CONVERSION-ERROR
 15197                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 15198             ELSE
 15199                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 15200
 15201     IF STATUSI = 'C' OR 'CLOSED'
 15202         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 15203             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15204             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 289
* EL131.cbl
 15205             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 15206             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15207             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15208             IF NO-CONVERSION-ERROR
 15209                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 15210             ELSE
 15211                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 15212
 15213     IF STATUSI = 'O' OR 'OPEN'
 15214         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 15215             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15216             MOVE '6'                TO  DC-OPTION-CODE
 15217             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 15218             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15219             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15220             IF NO-CONVERSION-ERROR
 15221                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 15222             ELSE
 15223                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 15224
 15225     IF STATUSI = 'O' OR 'OPEN'
 15226         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 15227             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15228             MOVE '6'                TO  DC-OPTION-CODE
 15229             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 15230             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15231             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15232             IF NO-CONVERSION-ERROR
 15233                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 15234             ELSE
 15235                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 15236
 15237
 15238* EXEC CICS LINK
 15239*        PROGRAM    (LINK-1523)
 15240*        COMMAREA   (W-1523-LINKDATA)
 15241*        LENGTH     (W-1523-COMM-LENGTH)
 15242*    END-EXEC.
 15243*    MOVE '."C                   (   #00012799' TO DFHEIV0
 15244     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15245     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15246     MOVE X'2020233030303132373939' TO DFHEIV0(25:11)
 15247     CALL 'kxdfhei1' USING DFHEIV0,
 15248           LINK-1523,
 15249           W-1523-LINKDATA,
 15250           W-1523-COMM-LENGTH,
 15251           DFHEIV99,
 15252           DFHEIV99,
 15253           DFHEIV99,
 15254           DFHEIV99
 15255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15256
 15257
 15258     IF W-1523-ERROR-CODE = ZEROS
 15259         GO TO 7850-EXIT.
 15260
 15261     IF W-1523-FATAL-ERROR
 15262         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 290
* EL131.cbl
 15263         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15264
 15265     IF W-1523-ERROR-CODE = 0191
 15266         MOVE ER-0803                TO  EMI-ERROR
 15267         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15268
 15269 7850-EXIT.
 15270     EXIT.
 15271
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 291
* EL131.cbl
 15273 8000-CREATE-DMO-REC.
 15274     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 15275     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 15276     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 15277
 15278
 15279* EXEC CICS HANDLE CONDITION
 15280*         NOTFND   (8000-NOTE-NOT-FOUND)
 15281*    END-EXEC.
 15282*    MOVE '"$I                   ! G #00012825' TO DFHEIV0
 15283     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15284     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15285     MOVE X'4720233030303132383235' TO DFHEIV0(25:11)
 15286     CALL 'kxdfhei1' USING DFHEIV0
 15287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15288
 15289
 15290
 15291* EXEC CICS READ
 15292*         DATASET(NOTE-FILE-ID)
 15293*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 15294*         RIDFLD (NOTE-KEY)
 15295*    END-EXEC.
 15296*    MOVE '&"S        E          (   #00012829' TO DFHEIV0
 15297     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15298     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15299     MOVE X'2020233030303132383239' TO DFHEIV0(25:11)
 15300     CALL 'kxdfhei1' USING DFHEIV0,
 15301           NOTE-FILE-ID,
 15302           DFHEIV20,
 15303           DFHEIV99,
 15304           NOTE-KEY,
 15305           DFHEIV99,
 15306           DFHEIV99,
 15307           DFHEIV99
 15308     SET ADDRESS OF CERTIFICATE-NOTE TO
 15309         DFHEIV20
 15310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15311
 15312
 15313     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 15314     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 15315     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 15316
 15317     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 15318         MOVE 'CC'               TO DCT-PRODUCT-CODE
 15319     ELSE
 15320         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 15321
 15322     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 15323     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 15324
 15325
 15326* EXEC CICS LINK
 15327*        PROGRAM    ('DLO006')
 15328*        COMMAREA   (DCT-COMMUNICATION-AREA)
 15329*        LENGTH     (WS-DCT-LENGTH)
 15330*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 292
* EL131.cbl
 15331     MOVE 'DLO006' TO DFHEIV1
 15332*    MOVE '."C                   (   #00012847' TO DFHEIV0
 15333     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15334     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15335     MOVE X'2020233030303132383437' TO DFHEIV0(25:11)
 15336     CALL 'kxdfhei1' USING DFHEIV0,
 15337           DFHEIV1,
 15338           DCT-COMMUNICATION-AREA,
 15339           WS-DCT-LENGTH,
 15340           DFHEIV99,
 15341           DFHEIV99,
 15342           DFHEIV99,
 15343           DFHEIV99
 15344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15345
 15346
 15347     IF  DCT-RETURN-CODE = 'OK'
 15348         GO TO 8000-CONT.
 15349
 15350     IF DCT-RETURN-CODE = '01' OR '02'
 15351         GO TO 8000-EXIT.
 15352
 15353     IF DCT-RETURN-CODE = '03'
 15354         MOVE ER-0951            TO EMI-ERROR
 15355         MOVE -1                 TO MAINTL
 15356         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15357         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15358         GO TO 8110-SEND-DATA.
 15359
 15360     IF DCT-RETURN-CODE = '04'
 15361         MOVE ER-0946            TO EMI-ERROR
 15362         MOVE -1                 TO MAINTL
 15363         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15364         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15365         GO TO 8110-SEND-DATA.
 15366
 15367     IF DCT-RETURN-CODE = '05'
 15368         MOVE ER-0947            TO EMI-ERROR
 15369         MOVE -1                 TO MAINTL
 15370         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15371         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15372         GO TO 8110-SEND-DATA.
 15373
 15374     IF DCT-RETURN-CODE = '06'
 15375         MOVE ER-0921            TO EMI-ERROR
 15376         MOVE -1                 TO MAINTL
 15377         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15378         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15379         GO TO 8110-SEND-DATA.
 15380
 15381     IF DCT-RETURN-CODE = '07'
 15382         MOVE ER-0919            TO EMI-ERROR
 15383         MOVE -1                 TO MAINTL
 15384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15385         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15386         GO TO 8110-SEND-DATA.
 15387
 15388     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 293
* EL131.cbl
 15389         MOVE ER-0948            TO EMI-ERROR
 15390         MOVE -1                 TO MAINTL
 15391         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15392         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15393         GO TO 8110-SEND-DATA.
 15394
 15395     IF DCT-RETURN-CODE = 'N1'
 15396         MOVE ER-0950            TO EMI-ERROR
 15397         MOVE -1                 TO MAINTL
 15398         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15399         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15400         GO TO 8110-SEND-DATA.
 15401
 15402     IF DCT-RETURN-CODE = 'E1'
 15403         MOVE ER-0974            TO EMI-ERROR
 15404         MOVE -1                 TO MAINTL
 15405         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15406         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15407         GO TO 8110-SEND-DATA.
 15408
 15409     IF DCT-RETURN-CODE = 'E2'
 15410         MOVE ER-0975            TO EMI-ERROR
 15411         MOVE -1                 TO MAINTL
 15412         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15413         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15414         GO TO 8110-SEND-DATA.
 15415
 15416     IF DCT-RETURN-CODE NOT = 'OK'
 15417         MOVE ER-0949            TO EMI-ERROR
 15418         MOVE -1                 TO MAINTL
 15419         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15420         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15421         GO TO 8110-SEND-DATA.
 15422
 15423 8000-CONT.
 15424
 15425     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 15426     MOVE 'CS'                   TO DM-RECORD-TYPE.
 15427     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 15428     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 15429     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 15430     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 15431     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 15432     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 15433
 15434     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 15435     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 15436     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 15437     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 15438     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 15439
 15440     IF STATUSI = 'OPEN' OR 'O'
 15441         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 15442      ELSE
 15443         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 15444
 15445     IF STATUSI = 'OPEN' OR 'O'
 15446        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 294
* EL131.cbl
 15447         MOVE '1'                TO DM-CLAIM-STATUS
 15448      ELSE
 15449         MOVE '2'                TO DM-CLAIM-STATUS.
 15450
 15451     IF STATUSI = 'CLOSED' OR 'C'
 15452        IF NOT FINAL-PAID
 15453         MOVE '3'                TO DM-CLAIM-STATUS
 15454      ELSE
 15455         MOVE '4'                TO DM-CLAIM-STATUS.
 15456
 15457     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 15458
 15459
 15460* EXEC CICS LINK
 15461*        PROGRAM    ('DLO025')
 15462*        COMMAREA   (DMO-COMMUNICATION-AREA)
 15463*        LENGTH     (WS-DMO-LENGTH)
 15464*    END-EXEC.
 15465     MOVE 'DLO025' TO DFHEIV1
 15466*    MOVE '."C                   (   #00012965' TO DFHEIV0
 15467     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15468     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15469     MOVE X'2020233030303132393635' TO DFHEIV0(25:11)
 15470     CALL 'kxdfhei1' USING DFHEIV0,
 15471           DFHEIV1,
 15472           DMO-COMMUNICATION-AREA,
 15473           WS-DMO-LENGTH,
 15474           DFHEIV99,
 15475           DFHEIV99,
 15476           DFHEIV99,
 15477           DFHEIV99
 15478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15479
 15480
 15481     IF  DM-RETURN-CODE = 'OK'
 15482         GO TO 8000-EXIT.
 15483
 15484     IF DM-RETURN-CODE = '01'
 15485         MOVE ER-8051            TO EMI-ERROR
 15486         MOVE -1                 TO MAINTL
 15487         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15488         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15489         GO TO 8110-SEND-DATA.
 15490
 15491     IF DM-RETURN-CODE = '02'
 15492         MOVE ER-8052            TO EMI-ERROR
 15493         MOVE -1                 TO MAINTL
 15494         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15495         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15496         GO TO 8110-SEND-DATA.
 15497
 15498     IF DM-RETURN-CODE = '03'
 15499         MOVE ER-8053            TO EMI-ERROR
 15500         MOVE -1                 TO MAINTL
 15501         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15502         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15503         GO TO 8110-SEND-DATA.
 15504
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 295
* EL131.cbl
 15505     IF DM-RETURN-CODE = '04'
 15506         MOVE ER-8054            TO EMI-ERROR
 15507         MOVE -1                 TO MAINTL
 15508         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15509         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15510         GO TO 8110-SEND-DATA.
 15511
 15512     IF DM-RETURN-CODE = '05'
 15513         MOVE ER-8055            TO EMI-ERROR
 15514         MOVE -1                 TO MAINTL
 15515         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15516         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15517         GO TO 8110-SEND-DATA.
 15518
 15519     IF DM-RETURN-CODE = '06'
 15520         MOVE ER-8056            TO EMI-ERROR
 15521         MOVE -1                 TO MAINTL
 15522         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15523         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15524         GO TO 8110-SEND-DATA.
 15525
 15526     IF DM-RETURN-CODE = '07'
 15527         MOVE ER-8057            TO EMI-ERROR
 15528         MOVE -1                 TO MAINTL
 15529         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15530         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15531         GO TO 8110-SEND-DATA.
 15532
 15533     IF DM-RETURN-CODE = '08'
 15534         MOVE ER-8058            TO EMI-ERROR
 15535         MOVE -1                 TO MAINTL
 15536         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15537         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15538         GO TO 8110-SEND-DATA.
 15539
 15540     IF DM-RETURN-CODE = '09'
 15541         MOVE ER-8059            TO EMI-ERROR
 15542         MOVE -1                 TO MAINTL
 15543         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15544         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15545         GO TO 8110-SEND-DATA.
 15546
 15547     IF DM-RETURN-CODE = '10'
 15548         MOVE ER-8060            TO EMI-ERROR
 15549         MOVE -1                 TO MAINTL
 15550         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15551         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15552         GO TO 8110-SEND-DATA.
 15553
 15554     IF DM-RETURN-CODE = '11'
 15555         MOVE ER-8061            TO EMI-ERROR
 15556         MOVE -1                 TO MAINTL
 15557         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15558         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15559         GO TO 8110-SEND-DATA.
 15560
 15561     IF DM-RETURN-CODE = '12'
 15562         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 296
* EL131.cbl
 15563         MOVE -1                 TO MAINTL
 15564         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15565         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15566         GO TO 8110-SEND-DATA.
 15567
 15568     IF DM-RETURN-CODE = '13'
 15569         MOVE ER-8063            TO EMI-ERROR
 15570         MOVE -1                 TO MAINTL
 15571         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15572         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15573         GO TO 8110-SEND-DATA.
 15574
 15575     IF DM-RETURN-CODE = '14'
 15576         MOVE ER-8064            TO EMI-ERROR
 15577         MOVE -1                 TO MAINTL
 15578         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15579         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15580         GO TO 8110-SEND-DATA.
 15581
 15582     IF DM-RETURN-CODE = '15'
 15583         MOVE ER-8065            TO EMI-ERROR
 15584         MOVE -1                 TO MAINTL
 15585         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15586         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15587         GO TO 8110-SEND-DATA.
 15588
 15589     IF DM-RETURN-CODE = '16'
 15590         MOVE ER-8154            TO EMI-ERROR
 15591         MOVE -1                 TO MAINTL
 15592         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15593         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15594         GO TO 8110-SEND-DATA.
 15595
 15596     IF DM-RETURN-CODE = '17'
 15597         MOVE ER-8155            TO EMI-ERROR
 15598         MOVE -1                 TO MAINTL
 15599         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15600         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15601         GO TO 8110-SEND-DATA.
 15602
 15603     IF DM-RETURN-CODE = 'N1'
 15604         MOVE ER-8152            TO EMI-ERROR
 15605         MOVE -1                 TO MAINTL
 15606         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15607         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15608         GO TO 8110-SEND-DATA.
 15609
 15610     IF DM-RETURN-CODE = 'E1'
 15611         MOVE ER-8153            TO EMI-ERROR
 15612         MOVE -1                 TO MAINTL
 15613         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15614         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15615         GO TO 8110-SEND-DATA.
 15616
 15617     MOVE ER-8066                TO EMI-ERROR.
 15618     MOVE -1                     TO MAINTL.
 15619     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15620     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 297
* EL131.cbl
 15621     GO TO 8110-SEND-DATA.
 15622
 15623 8000-NOTE-NOT-FOUND.
 15624
 15625* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15626*    MOVE '6"R                   !   #00013114' TO DFHEIV0
 15627     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15628     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15629     MOVE X'2020233030303133313134' TO DFHEIV0(25:11)
 15630     CALL 'kxdfhei1' USING DFHEIV0
 15631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15632
 15633     MOVE ER-0954                TO EMI-ERROR.
 15634     MOVE -1                     TO MAINTL.
 15635     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15636     GO TO 8110-SEND-DATA.
 15637
 15638 8000-EXIT.
 15639     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 298
* EL131.cbl
 15641 8050-FORMAT-LAST-NAME-1ST.
 15642*****************************************************************
 15643*             M O V E   N A M E   R O U T I N E                 *
 15644*                                                               *
 15645*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15646*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15647*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 15648*                                                               *
 15649*                  FIELD               VALUE                    *
 15650*                  -----               -----                    *
 15651*           W-NAME-LAST    (CL15)      SMITH                    *
 15652*           W-NAME-FIRST   (CL15)      JOHN                     *
 15653*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15654*                                                               *
 15655*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 15656*                SMITH, JOHN ALLEN                              *
 15657*                     OR                                        *
 15658*                SMITH, JOHN A.                                 *
 15659*                                                               *
 15660*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 15661*     COPYBOOK, ELCNWA.                                         *
 15662*****************************************************************.
 15663
 15664     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15665     MOVE ZERO                   TO WS-NAME-SW.
 15666     SET NWA-INDEX               TO +1.
 15667
 15668     IF W-NAME-LAST   = SPACES  AND
 15669        W-NAME-MIDDLE = SPACES
 15670          MOVE +1                TO WS-NAME-SW.
 15671
 15672     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15673     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15674
 15675     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15676     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15677
 15678     SET NWA-INDEX UP BY +1.
 15679
 15680     IF W-NAME-MIDDLE NOT = SPACES
 15681         IF W-NAME-MIDDLE-2 = SPACES
 15682             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15683             SET NWA-INDEX UP BY +1
 15684             MOVE '.'            TO WS-NW (NWA-INDEX)
 15685             SET NWA-INDEX UP BY +2
 15686         ELSE
 15687             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15688             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15689
 15690 8050-EXIT.
 15691     EXIT.
 15692
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 299
* EL131.cbl
 15694 8060-MOVE-NAME.
 15695     IF WS-NAME-SW GREATER THAN +1
 15696         GO TO 8060-EXIT.
 15697
 15698     IF WS-NAME-WORK2 = SPACES
 15699         GO TO 8060-EXIT.
 15700
 15701     SET NWA-INDEX2            TO +1.
 15702     SET NWA-INDEX3            TO +2.
 15703
 15704 8060-MOVE-NAME-CYCLE.
 15705     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15706
 15707     IF NWA-INDEX LESS THAN +30
 15708         SET NWA-INDEX UP BY +1
 15709     ELSE
 15710         ADD +2 TO  WS-NAME-SW
 15711         GO TO 8060-EXIT.
 15712
 15713     IF NWA-INDEX2 LESS THAN +20
 15714         SET NWA-INDEX3 UP BY +1
 15715         SET NWA-INDEX2 UP BY +1.
 15716
 15717     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 15718        WS-NW2 (NWA-INDEX3) = SPACES
 15719         IF WS-NAME-SW = ZERO
 15720             MOVE ','            TO WS-NW (NWA-INDEX)
 15721             SET NWA-INDEX UP BY +2
 15722             MOVE +1             TO WS-NAME-SW
 15723             GO TO 8060-EXIT
 15724         ELSE
 15725             GO TO 8060-EXIT.
 15726
 15727     GO TO 8060-MOVE-NAME-CYCLE.
 15728
 15729 8060-EXIT.
 15730     EXIT.
 15731
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 300
* EL131.cbl
 15733
 15734 8070-UNLOCK-CLAIM-MSTR.
 15735
 15736* EXEC CICS UNLOCK
 15737*        DATASET   (CLMS-FILE-ID)
 15738*    END-EXEC.
 15739*    MOVE '&*                    #   #00013217' TO DFHEIV0
 15740     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 15741     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15742     MOVE X'2020233030303133323137' TO DFHEIV0(25:11)
 15743     CALL 'kxdfhei1' USING DFHEIV0,
 15744           CLMS-FILE-ID,
 15745           DFHEIV99
 15746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15747
 15748
 15749 8070-EXIT.
 15750      EXIT.
 15751
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 301
* EL131.cbl
 15753 8100-SEND-MAP.
 15754     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 15755
 15756     IF NOT PI-NO-CARRIER-SECURITY
 15757        MOVE AL-SANOF            TO CERTCARA.
 15758     IF NOT PI-NO-ACCOUNT-SECURITY
 15759        MOVE AL-SANOF            TO CERTACTA.
 15760
 15761     IF PI-PROCESSOR-ID = 'LGXX'
 15762        MOVE AL-UANON            TO CCNOA.
 15763
 15764     IF PI-COMPANY-ID = 'DMD'
 15765        NEXT SENTENCE
 15766     ELSE
 15767        MOVE AL-SADOF            TO PFKEY6A.
 15768
 15769     IF PI-USES-PAID-TO
 15770        MOVE 'PAID TO  :' TO PTHRHDGO.
 15771
 15772
 15773* EXEC CICS SEND
 15774*         MAP     ('EL131A')
 15775*         MAPSET  ('EL131S')
 15776*         ERASE
 15777*         FREEKB
 15778*         CURSOR
 15779*    END-EXEC.
 15780     MOVE 'EL131A' TO DFHEIV1
 15781     MOVE -1
 15782       TO DFHEIV11
 15783     MOVE 'EL131S' TO DFHEIV2
 15784*    MOVE '8$     CT  E F  H     ,   #00013244' TO DFHEIV0
 15785     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15786     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 15787     MOVE X'2020233030303133323434' TO DFHEIV0(25:11)
 15788     CALL 'kxdfhei1' USING DFHEIV0,
 15789           DFHEIV1,
 15790           EL131AO,
 15791           DFHEIV99,
 15792           DFHEIV2,
 15793           DFHEIV99,
 15794           DFHEIV99,
 15795           DFHEIV99,
 15796           DFHEIV11,
 15797           DFHEIV99,
 15798           DFHEIV99,
 15799           DFHEIV99
 15800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15801
 15802
 15803     GO TO 9000-RETURN-TRANS.
 15804
 15805 8110-SEND-DATA.
 15806     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 15807
 15808     IF PI-USES-PAID-TO
 15809        MOVE 'PAID TO  :' TO PTHRHDGO.
 15810
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 302
* EL131.cbl
 15811     IF PI-PROCESSOR-ID = 'LGXX'
 15812        MOVE AL-UANON            TO CCNOA.
 15813
 15814     IF PI-COMPANY-ID = 'DMD'
 15815        NEXT SENTENCE
 15816     ELSE
 15817        MOVE AL-SADOF            TO PFKEY6A.
 15818
 15819
 15820* EXEC CICS SEND
 15821*         MAP      ('EL131A')
 15822*         MAPSET   ('EL131S')
 15823*         DATAONLY
 15824*         FREEKB
 15825*         CURSOR
 15826*    END-EXEC.
 15827     MOVE 'EL131A' TO DFHEIV1
 15828     MOVE -1
 15829       TO DFHEIV11
 15830     MOVE 'EL131S' TO DFHEIV2
 15831*    MOVE '8$D    CT    F  H     ,   #00013268' TO DFHEIV0
 15832     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 15833     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 15834     MOVE X'2020233030303133323638' TO DFHEIV0(25:11)
 15835     CALL 'kxdfhei1' USING DFHEIV0,
 15836           DFHEIV1,
 15837           EL131AO,
 15838           DFHEIV99,
 15839           DFHEIV2,
 15840           DFHEIV99,
 15841           DFHEIV99,
 15842           DFHEIV99,
 15843           DFHEIV11,
 15844           DFHEIV99,
 15845           DFHEIV99,
 15846           DFHEIV99
 15847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15848
 15849
 15850     GO TO 9000-RETURN-TRANS.
 15851
 15852 8120-FORMAT-TIME-DATE.
 15853     perform 8140-check-for-prev-errors
 15854                                 thru 8140-exit
 15855     IF SKIP-ATTRIBUTE = 'Y'
 15856        MOVE SPACES              TO SKIP-ATTRIBUTE
 15857        MOVE ER-0598             TO EMI-ERROR
 15858        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15859        GO TO 8125-SKIP-ATTRIBUTE.
 15860
 15861*     IF PI-COMPANY-ID = 'DMD'
 15862      IF PI-PROCESSOR-ID <> 'EMER'
 15863         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 15864                                    CERTCARA  CERTGRPA CERTA SUFXA
 15865
 15866     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 15867                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 15868                                    JNTINITA  JNTAGEA   APRA
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 303
* EL131.cbl
 15869                                    LCVCDA    LCVOTRMA  LCVRTRMA
 15870                                    LCVBENEA  LCVFORMA  LCVCNDTA
 15871                                    LCVEXITA  LCVSTATA  LCVKINDA
 15872                                    ACVCDA    ACVOTRMA  ACVRTRMA
 15873                                    ACVBENEA  ACVFORMA  ACVCNDTA
 15874                                    ACVEXITA  ACVSTATA  ACVKINDA
 15875                                    PMTFREQA  INDGRPA   PREMTYPA
 15876                                    REINCDA   LCVRATEA  ACVRATEA
 15877                                    ADDONDTA.
 15878
 15879*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 15880*       IF PI-COMPANY-ID = 'DMD'
 15881*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 15882*                                   SUFXA
 15883*                                   PDAMTA    NODAYSA   NOPMTSA
 15884*                                   INCA      OCCA
 15885*          IF NOT SYSTEM-MODIFY-CAP
 15886*              MOVE AL-SANOF         TO PDTHRUA.
 15887
 15888     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 15889         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15890
 15891 8125-SKIP-ATTRIBUTE.
 15892
 15893     MOVE SAVE-DATE              TO DATEO.
 15894
 15895* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 15896*    END-EXEC
 15897*    MOVE '0"A                   "   #00013320' TO DFHEIV0
 15898     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 15899     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 15900     MOVE X'2020233030303133333230' TO DFHEIV0(25:11)
 15901     CALL 'kxdfhei1' USING DFHEIV0,
 15902           LCP-CICS-TIME
 15903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15904
 15905* EXEC CICS FORMATTIME
 15906*              ABSTIME(LCP-CICS-TIME)
 15907*              TIME(LCP-TIME-OF-DAY-XX)
 15908*    END-EXEC
 15909*    MOVE 'j$(     (             #   #00013322' TO DFHEIV0
 15910     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 15911     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15912     MOVE X'2020233030303133333232' TO DFHEIV0(25:11)
 15913     CALL 'kxdfhei1' USING DFHEIV0,
 15914           LCP-CICS-TIME,
 15915           LCP-TIME-OF-DAY-XX
 15916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15917     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 15918     MOVE UN-HOURS               TO FOR-HOURS.
 15919     MOVE UN-MINUTES             TO FOR-MINUTES.
 15920     MOVE TIME-OUT               TO TIMEO.
 15921     MOVE PI-COMPANY-ID          TO COMPO.
 15922     MOVE PI-PROCESSOR-ID        TO USERIDO.
 15923     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 15924     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 15925     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 15926     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 304
* EL131.cbl
 15927
 15928 8130-EXIT.
 15929     EXIT.
 15930
 15931 8140-check-for-prev-errors.
 15932
 15933     MOVE PI-COMPANY-CD          TO trlr-company-cd
 15934     MOVE PI-CARRIER             TO trlr-carrier
 15935     MOVE PI-CLAIM-NO            TO trlr-claim-no
 15936     MOVE PI-CERT-NO             TO trlr-cert-no
 15937     MOVE +95                    TO TRLR-SEQ-NO
 15938
 15939
 15940* EXEC CICS READ
 15941*       DATASET  ('ELTRLR')
 15942*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15943*       RIDFLD   (TRLR-KEY)
 15944*       RESP     (WS-RESPONSE)
 15945*    END-EXEC
 15946     MOVE 'ELTRLR' TO DFHEIV1
 15947*    MOVE '&"S        E          (  N#00013348' TO DFHEIV0
 15948     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15949     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15950     MOVE X'204E233030303133333438' TO DFHEIV0(25:11)
 15951     CALL 'kxdfhei1' USING DFHEIV0,
 15952           DFHEIV1,
 15953           DFHEIV20,
 15954           DFHEIV99,
 15955           TRLR-KEY,
 15956           DFHEIV99,
 15957           DFHEIV99,
 15958           DFHEIV99
 15959     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15960         DFHEIV20
 15961     MOVE EIBRESP  TO WS-RESPONSE
 15962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15963
 15964     if ws-resp-normal
 15965        perform varying s1 from +1 by +1 until
 15966           at-note-error-no (s1) = spaces
 15967           if at-note-error-no (s1) = '1652'
 15968              continue
 15969           else
 15970              move at-note-error-no (s1)
 15971                                 to emi-error
 15972              move -1 to maintl
 15973              if at-note-error-no (s1) = '1653'
 15974                 evaluate true
 15975                    when pi-claim-type = 'L'
 15976                       move '  LF  '
 15977                        to emi-claim-type
 15978                    when pi-claim-type = 'I'
 15979                       move '  IU  '
 15980                        to emi-claim-type
 15981                    when other
 15982                       move '  AH  '
 15983                        to emi-claim-type
 15984                 end-evaluate
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 305
* EL131.cbl
 15985              end-if
 15986              PERFORM 9900-ERROR-FORMAT
 15987                                 THRU 9900-EXIT
 15988           end-if
 15989*          if at-note-error-no (s1) = '1653'
 15990*             perform varying emi-sub from 1 by 1 until
 15991*                emi-sub > 3
 15992*                if emi-error-number (emi-sub) = '1653'
 15993*                   evaluate true
 15994*                      when pi-claim-type = 'L'
 15995*                         move '  LF  '
 15996*                          to emi-claim-type
 15997*                      when pi-claim-type = 'I'
 15998*                         move '  IU  '
 15999*                          to emi-claim-type
 16000*                      when other
 16001*                         move '  AH  '
 16002*                          to emi-claim-type
 16003*                   end-evaluate
 16004*                end-if
 16005*             end-perform
 16006*          end-if
 16007        end-perform
 16008     else
 16009        display ' resp not normal ' ws-response ' '
 16010        trlr-key (2:19)
 16011     end-if
 16012
 16013     .
 16014 8140-exit.
 16015     exit.
 16016 8150-ENTERED-CLAIM-NOTFOUND.
 16017
 16018     MOVE ER-0204                TO EMI-ERROR.
 16019     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16020     MOVE -1                     TO MAINTL.
 16021     GO TO 8100-SEND-MAP.
 16022
 16023 8200-RETURN-PRIOR.
 16024     MOVE SPACE                  TO PI-RETURN-CD-1.
 16025     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 16026     GO TO 9200-XCTL.
 16027
 16028 8300-GET-HELP.
 16029     MOVE XCTL-EL010             TO CALL-PGM.
 16030     GO TO 9200-XCTL.
 16031
 16032 8400-RETURN-MASTER.
 16033     MOVE SPACE                  TO PI-RETURN-CD-1.
 16034     MOVE XCTL-EL126             TO CALL-PGM.
 16035     GO TO 9200-XCTL.
 16036
 16037 8500-TRLR-MNT.
 16038     IF PI-RETURN-CD-1 = 'X'
 16039         MOVE ER-0311            TO EMI-ERROR
 16040         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16041         MOVE -1                 TO MAINTL
 16042         GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 306
* EL131.cbl
 16043
 16044
 16045* EXEC CICS WRITEQ TS
 16046*         QUEUE     (PI-KEY)
 16047*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16048*         LENGTH    (PI-COMM-LENGTH)
 16049*    END-EXEC.
 16050*    MOVE '*"                    ''   #00013435' TO DFHEIV0
 16051     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16052     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16053     MOVE X'2020233030303133343335' TO DFHEIV0(25:11)
 16054     CALL 'kxdfhei1' USING DFHEIV0,
 16055           PI-KEY,
 16056           PROGRAM-INTERFACE-BLOCK,
 16057           PI-COMM-LENGTH,
 16058           DFHEIV99,
 16059           DFHEIV99,
 16060           DFHEIV99
 16061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16062
 16063
 16064     MOVE XCTL-EL142             TO CALL-PGM.
 16065     GO TO 9200-XCTL.
 16066
 16067 8600-ADDR-MNT.
 16068     IF PI-RETURN-CD-1 = 'X'
 16069         MOVE ER-0311            TO EMI-ERROR
 16070         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16071         MOVE -1                 TO MAINTL
 16072         GO TO 8110-SEND-DATA.
 16073
 16074
 16075* EXEC CICS WRITEQ TS
 16076*         QUEUE     (PI-KEY)
 16077*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16078*         LENGTH    (PI-COMM-LENGTH)
 16079*    END-EXEC.
 16080*    MOVE '*"                    ''   #00013451' TO DFHEIV0
 16081     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16082     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16083     MOVE X'2020233030303133343531' TO DFHEIV0(25:11)
 16084     CALL 'kxdfhei1' USING DFHEIV0,
 16085           PI-KEY,
 16086           PROGRAM-INTERFACE-BLOCK,
 16087           PI-COMM-LENGTH,
 16088           DFHEIV99,
 16089           DFHEIV99,
 16090           DFHEIV99
 16091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16092
 16093
 16094     MOVE XCTL-EL141             TO CALL-PGM.
 16095     GO TO 9200-XCTL.
 16096
 16097 8700-CERT-MNT.
 16098     IF PI-RETURN-CD-1 = 'X'
 16099         MOVE ER-7690            TO EMI-ERROR
 16100         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 307
* EL131.cbl
 16101         MOVE -1                 TO MAINTL
 16102         GO TO 8110-SEND-DATA.
 16103
 16104
 16105* EXEC CICS WRITEQ TS
 16106*         QUEUE     (PI-KEY)
 16107*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16108*         LENGTH    (PI-COMM-LENGTH)
 16109*    END-EXEC.
 16110*    MOVE '*"                    ''   #00013467' TO DFHEIV0
 16111     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16112     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16113     MOVE X'2020233030303133343637' TO DFHEIV0(25:11)
 16114     CALL 'kxdfhei1' USING DFHEIV0,
 16115           PI-KEY,
 16116           PROGRAM-INTERFACE-BLOCK,
 16117           PI-COMM-LENGTH,
 16118           DFHEIV99,
 16119           DFHEIV99,
 16120           DFHEIV99
 16121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16122
 16123
 16124     MOVE XCTL-EL1273            TO CALL-PGM.
 16125     GO TO 9200-XCTL.
 16126
 16127 8725-BENEFICIARY-MNT.
 16128     IF PI-RETURN-CD-1 = 'X'
 16129         MOVE ER-0311            TO EMI-ERROR
 16130         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16131         MOVE -1                 TO MAINTL
 16132         GO TO 8110-SEND-DATA.
 16133
 16134
 16135* EXEC CICS WRITEQ TS
 16136*         QUEUE     (PI-KEY)
 16137*         FROM      (EL131AI)
 16138*         LENGTH    (MAP-LENGTH)
 16139*    END-EXEC.
 16140*    MOVE '*"                    ''   #00013483' TO DFHEIV0
 16141     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16142     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16143     MOVE X'2020233030303133343833' TO DFHEIV0(25:11)
 16144     CALL 'kxdfhei1' USING DFHEIV0,
 16145           PI-KEY,
 16146           EL131AI,
 16147           MAP-LENGTH,
 16148           DFHEIV99,
 16149           DFHEIV99,
 16150           DFHEIV99
 16151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16152
 16153
 16154
 16155* EXEC CICS WRITEQ TS
 16156*         QUEUE     (PI-KEY)
 16157*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16158*         LENGTH    (PI-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 308
* EL131.cbl
 16159*    END-EXEC.
 16160*    MOVE '*"                    ''   #00013489' TO DFHEIV0
 16161     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16162     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16163     MOVE X'2020233030303133343839' TO DFHEIV0(25:11)
 16164     CALL 'kxdfhei1' USING DFHEIV0,
 16165           PI-KEY,
 16166           PROGRAM-INTERFACE-BLOCK,
 16167           PI-COMM-LENGTH,
 16168           DFHEIV99,
 16169           DFHEIV99,
 16170           DFHEIV99
 16171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16172
 16173
 16174     MOVE XCTL-EL114             TO CALL-PGM.
 16175     GO TO 9200-XCTL.
 16176
 16177 8750-DMD-CLM-FIX.
 16178
 16179* EXEC CICS WRITEQ TS
 16180*         QUEUE     (PI-KEY)
 16181*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16182*         LENGTH    (PI-COMM-LENGTH)
 16183*    END-EXEC.
 16184*    MOVE '*"                    ''   #00013499' TO DFHEIV0
 16185     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16186     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16187     MOVE X'2020233030303133343939' TO DFHEIV0(25:11)
 16188     CALL 'kxdfhei1' USING DFHEIV0,
 16189           PI-KEY,
 16190           PROGRAM-INTERFACE-BLOCK,
 16191           PI-COMM-LENGTH,
 16192           DFHEIV99,
 16193           DFHEIV99,
 16194           DFHEIV99
 16195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16196
 16197
 16198     MOVE XCTL-EL400DMD          TO CALL-PGM.
 16199     GO TO 9200-XCTL.
 16200
 16201 8800-UNAUTHORIZED-ACCESS.
 16202     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16203     GO TO 8990-SEND-TEXT.
 16204
 16205 8810-PF23-ENTERED.
 16206     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 16207     MOVE XCTL-EL005             TO CALL-PGM.
 16208     GO TO 9200-XCTL.
 16209
 16210 8820-XCTL-ERROR.
 16211
 16212* EXEC CICS HANDLE CONDITION
 16213*        PGMIDERR (8990-SEND-TEXT)
 16214*    END-EXEC.
 16215*    MOVE '"$L                   ! H #00013518' TO DFHEIV0
 16216     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 309
* EL131.cbl
 16217     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16218     MOVE X'4820233030303133353138' TO DFHEIV0(25:11)
 16219     CALL 'kxdfhei1' USING DFHEIV0
 16220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16221
 16222
 16223     MOVE SPACE                 TO PI-ENTRY-CD-1.
 16224     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 16225     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 16226     MOVE XCTL-EL005            TO CALL-PGM.
 16227     GO TO 9200-XCTL.
 16228
 16229 8990-SEND-TEXT.
 16230
 16231* EXEC CICS SEND TEXT
 16232*         FROM      (LOGOFF-TEXT)
 16233*         LENGTH    (LOGOFF-LENGTH)
 16234*         ERASE
 16235*         FREEKB
 16236*    END-EXEC.
 16237*    MOVE '8&      T  E F  H   F -   #00013529' TO DFHEIV0
 16238     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16239     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16240     MOVE X'2020233030303133353239' TO DFHEIV0(25:11)
 16241     CALL 'kxdfhei1' USING DFHEIV0,
 16242           LOGOFF-TEXT,
 16243           LOGOFF-LENGTH,
 16244           DFHEIV99,
 16245           DFHEIV99,
 16246           DFHEIV99,
 16247           DFHEIV99,
 16248           DFHEIV99,
 16249           DFHEIV99,
 16250           DFHEIV99,
 16251           DFHEIV99,
 16252           DFHEIV99,
 16253           DFHEIV99
 16254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16255
 16256
 16257     GO TO 9100-RETURN-CICS.
 16258
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 310
* EL131.cbl
 16260 9000-RETURN-TRANS.
 16261
 16262* EXEC CICS RETURN
 16263*         TRANSID   (TRANS-ID)
 16264*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16265*         LENGTH    (PI-COMM-LENGTH)
 16266*    END-EXEC.
 16267*    MOVE '.(CT                  ''   #00013540' TO DFHEIV0
 16268     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16269     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16270     MOVE X'2020233030303133353430' TO DFHEIV0(25:11)
 16271     CALL 'kxdfhei1' USING DFHEIV0,
 16272           TRANS-ID,
 16273           PROGRAM-INTERFACE-BLOCK,
 16274           PI-COMM-LENGTH,
 16275           DFHEIV99,
 16276           DFHEIV99,
 16277           DFHEIV99
 16278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16279
 16280
 16281
 16282* GOBACK.
 16283     MOVE '9%                    "   ' TO DFHEIV0
 16284     MOVE 'EL131' TO DFHEIV1
 16285     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16286     GOBACK.
 16287
 16288 9100-RETURN-CICS.
 16289
 16290* EXEC CICS RETURN
 16291*    END-EXEC.
 16292*    MOVE '.(                    ''   #00013549' TO DFHEIV0
 16293     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16294     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16295     MOVE X'2020233030303133353439' TO DFHEIV0(25:11)
 16296     CALL 'kxdfhei1' USING DFHEIV0,
 16297           DFHEIV99,
 16298           DFHEIV99,
 16299           DFHEIV99,
 16300           DFHEIV99,
 16301           DFHEIV99,
 16302           DFHEIV99
 16303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16304
 16305
 16306
 16307* GOBACK.
 16308     MOVE '9%                    "   ' TO DFHEIV0
 16309     MOVE 'EL131' TO DFHEIV1
 16310     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16311     GOBACK.
 16312
 16313 9200-XCTL.
 16314
 16315* EXEC CICS XCTL
 16316*         PROGRAM    (CALL-PGM)
 16317*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 311
* EL131.cbl
 16318*         LENGTH     (PI-COMM-LENGTH)
 16319*    END-EXEC.
 16320*    MOVE '.$C                   %   #00013555' TO DFHEIV0
 16321     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16322     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16323     MOVE X'2020233030303133353535' TO DFHEIV0(25:11)
 16324     CALL 'kxdfhei1' USING DFHEIV0,
 16325           CALL-PGM,
 16326           PROGRAM-INTERFACE-BLOCK,
 16327           PI-COMM-LENGTH,
 16328           DFHEIV99
 16329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16330
 16331
 16332 9700-LINK-RTRM-FILE-ID.
 16333
 16334* EXEC CICS LINK
 16335*        PROGRAM  (RTRM-FILE-ID)
 16336*        COMMAREA (CALCULATION-PASS-AREA)
 16337*        LENGTH   (CP-COMM-LENGTH)
 16338*    END-EXEC.
 16339*    MOVE '."C                   (   #00013562' TO DFHEIV0
 16340     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16341     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16342     MOVE X'2020233030303133353632' TO DFHEIV0(25:11)
 16343     CALL 'kxdfhei1' USING DFHEIV0,
 16344           RTRM-FILE-ID,
 16345           CALCULATION-PASS-AREA,
 16346           CP-COMM-LENGTH,
 16347           DFHEIV99,
 16348           DFHEIV99,
 16349           DFHEIV99,
 16350           DFHEIV99
 16351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16352
 16353
 16354 9700-EXIT.
 16355      EXIT.
 16356
 16357 9800-CONVERT-DATE.
 16358     MOVE SPACES TO DC-ERROR-CODE.
 16359
 16360* EXEC CICS LINK
 16361*         PROGRAM    (DATE-CONV)
 16362*         COMMAREA   (DATE-CONVERSION-DATA)
 16363*         LENGTH     (DC-COMM-LENGTH)
 16364*    END-EXEC.
 16365*    MOVE '."C                   (   #00013573' TO DFHEIV0
 16366     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16367     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16368     MOVE X'2020233030303133353733' TO DFHEIV0(25:11)
 16369     CALL 'kxdfhei1' USING DFHEIV0,
 16370           DATE-CONV,
 16371           DATE-CONVERSION-DATA,
 16372           DC-COMM-LENGTH,
 16373           DFHEIV99,
 16374           DFHEIV99,
 16375           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 312
* EL131.cbl
 16376           DFHEIV99
 16377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16378
 16379
 16380 9800-EXIT.
 16381     EXIT.
 16382
 16383 9900-ERROR-FORMAT.
 16384
 16385* EXEC CICS LINK
 16386*         PROGRAM    (XCTL-EL001)
 16387*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 16388*         LENGTH     (EMI-COMM-LENGTH)
 16389*    END-EXEC.
 16390*    MOVE '."C                   (   #00013583' TO DFHEIV0
 16391     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16392     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16393     MOVE X'2020233030303133353833' TO DFHEIV0(25:11)
 16394     CALL 'kxdfhei1' USING DFHEIV0,
 16395           XCTL-EL001,
 16396           ERROR-MESSAGE-INTERFACE-BLOCK,
 16397           EMI-COMM-LENGTH,
 16398           DFHEIV99,
 16399           DFHEIV99,
 16400           DFHEIV99,
 16401           DFHEIV99
 16402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16403
 16404
 16405 9900-EXIT.
 16406     EXIT.
 16407
 16408 9990-ABEND.
 16409     MOVE DFHEIBLK               TO EMI-LINE1.
 16410
 16411* EXEC CICS LINK
 16412*         PROGRAM   (XCTL-EL004)
 16413*         COMMAREA  (EMI-LINE1)
 16414*         LENGTH    (72)
 16415*     END-EXEC.
 16416     MOVE 72
 16417       TO DFHEIV11
 16418*    MOVE '."C                   (   #00013594' TO DFHEIV0
 16419     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16421     MOVE X'2020233030303133353934' TO DFHEIV0(25:11)
 16422     CALL 'kxdfhei1' USING DFHEIV0,
 16423           XCTL-EL004,
 16424           EMI-LINE1,
 16425           DFHEIV11,
 16426           DFHEIV99,
 16427           DFHEIV99,
 16428           DFHEIV99,
 16429           DFHEIV99
 16430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16431
 16432
 16433     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 313
* EL131.cbl
 16434
 16435     GO TO 8110-SEND-DATA.
 16436
 16437 9995-SECURITY-VIOLATION.
 16438*           COPY ELCSCTP.
 16439******************************************************************
 16440*                                                                *
 16441*                            ELCSCTP                             *
 16442*                            VMOD=2.001                          *
 16443*                                                                *
 16444*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 16445******************************************************************
 16446
 16447
 16448     MOVE EIBDATE          TO SM-JUL-DATE.
 16449     MOVE EIBTRMID         TO SM-TERMID.
 16450     MOVE THIS-PGM         TO SM-PGM.
 16451     MOVE EIBTIME          TO TIME-IN.
 16452     MOVE TIME-OUT         TO SM-TIME.
 16453     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 16454
 16455
 16456* EXEC CICS LINK
 16457*         PROGRAM  ('EL003')
 16458*         COMMAREA (SECURITY-MESSAGE)
 16459*         LENGTH   (80)
 16460*    END-EXEC.
 16461     MOVE 'EL003' TO DFHEIV1
 16462     MOVE 80
 16463       TO DFHEIV11
 16464*    MOVE '."C                   (   #00013622' TO DFHEIV0
 16465     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16466     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16467     MOVE X'2020233030303133363232' TO DFHEIV0(25:11)
 16468     CALL 'kxdfhei1' USING DFHEIV0,
 16469           DFHEIV1,
 16470           SECURITY-MESSAGE,
 16471           DFHEIV11,
 16472           DFHEIV99,
 16473           DFHEIV99,
 16474           DFHEIV99,
 16475           DFHEIV99
 16476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16477
 16478
 16479******************************************************************
 16480
 16481
 16482
 16483 9999-DFHBACK SECTION.
 16484     MOVE '9%                    "   ' TO DFHEIV0
 16485     MOVE 'EL131' TO DFHEIV1
 16486     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16487     GOBACK.
 16488 9999-DFHEXIT.
 16489     IF DFHEIGDJ EQUAL 0001
 16490         NEXT SENTENCE
 16491     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 314
* EL131.cbl
 16492         GO TO 8820-XCTL-ERROR,
 16493               8150-ENTERED-CLAIM-NOTFOUND,
 16494               9990-ABEND
 16495         DEPENDING ON DFHEIGDI
 16496     ELSE IF DFHEIGDJ EQUAL 3
 16497         GO TO 0130-TS-ERROR,
 16498               0130-TS-ERROR
 16499         DEPENDING ON DFHEIGDI
 16500     ELSE IF DFHEIGDJ EQUAL 4
 16501         GO TO 0600-CONTINUE-NAME-UPDATE
 16502         DEPENDING ON DFHEIGDI
 16503     ELSE IF DFHEIGDJ EQUAL 5
 16504         GO TO 1004-BENE-NOT-FOUND
 16505         DEPENDING ON DFHEIGDI
 16506     ELSE IF DFHEIGDJ EQUAL 6
 16507         GO TO 1120-CNTL-NOTFND
 16508         DEPENDING ON DFHEIGDI
 16509     ELSE IF DFHEIGDJ EQUAL 7
 16510         GO TO 1150-NOTOPEN-ERROR,
 16511               1150-EXIT
 16512         DEPENDING ON DFHEIGDI
 16513     ELSE IF DFHEIGDJ EQUAL 8
 16514         GO TO 1490-STATE-NOTFND
 16515         DEPENDING ON DFHEIGDI
 16516     ELSE IF DFHEIGDJ EQUAL 9
 16517         GO TO 1500-CARR-NOTFND
 16518         DEPENDING ON DFHEIGDI
 16519     ELSE IF DFHEIGDJ EQUAL 10
 16520         GO TO 1620-ACCT-NOTFND
 16521         DEPENDING ON DFHEIGDI
 16522     ELSE IF DFHEIGDJ EQUAL 11
 16523         GO TO 2020-EXIT
 16524         DEPENDING ON DFHEIGDI
 16525     ELSE IF DFHEIGDJ EQUAL 12
 16526         GO TO 2030-EXIT
 16527         DEPENDING ON DFHEIGDI
 16528     ELSE IF DFHEIGDJ EQUAL 13
 16529         GO TO 2040-EXIT
 16530         DEPENDING ON DFHEIGDI
 16531     ELSE IF DFHEIGDJ EQUAL 14
 16532         GO TO 2050-EXIT
 16533         DEPENDING ON DFHEIGDI
 16534     ELSE IF DFHEIGDJ EQUAL 15
 16535         GO TO 2060-CERT-NOTFND
 16536         DEPENDING ON DFHEIGDI
 16537     ELSE IF DFHEIGDJ EQUAL 16
 16538         GO TO 2060-DUPKEY
 16539         DEPENDING ON DFHEIGDI
 16540     ELSE IF DFHEIGDJ EQUAL 17
 16541         GO TO 2070-NOT-FOUND
 16542         DEPENDING ON DFHEIGDI
 16543     ELSE IF DFHEIGDJ EQUAL 18
 16544         GO TO 2070-EXIT
 16545         DEPENDING ON DFHEIGDI
 16546     ELSE IF DFHEIGDJ EQUAL 19
 16547         GO TO 2080-EXIT
 16548         DEPENDING ON DFHEIGDI
 16549     ELSE IF DFHEIGDJ EQUAL 20
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 315
* EL131.cbl
 16550         GO TO 2400-TRLR-NOTFND,
 16551               2410-EXIT
 16552         DEPENDING ON DFHEIGDI
 16553     ELSE IF DFHEIGDJ EQUAL 21
 16554         GO TO 2425-NINETY-NOTFND,
 16555               2425-NINETY-NOTFND
 16556         DEPENDING ON DFHEIGDI
 16557     ELSE IF DFHEIGDJ EQUAL 22
 16558         GO TO 2430-EXIT,
 16559               2440-EXIT
 16560         DEPENDING ON DFHEIGDI
 16561     ELSE IF DFHEIGDJ EQUAL 23
 16562         GO TO 2440-EXIT
 16563         DEPENDING ON DFHEIGDI
 16564     ELSE IF DFHEIGDJ EQUAL 24
 16565         GO TO 2460-EXIT
 16566         DEPENDING ON DFHEIGDI
 16567     ELSE IF DFHEIGDJ EQUAL 25
 16568         GO TO 2475-EXIT
 16569         DEPENDING ON DFHEIGDI
 16570     ELSE IF DFHEIGDJ EQUAL 26
 16571         GO TO 2650-EXIT
 16572         DEPENDING ON DFHEIGDI
 16573     ELSE IF DFHEIGDJ EQUAL 27
 16574         GO TO 2800-EXIT,
 16575               2800-EXIT
 16576         DEPENDING ON DFHEIGDI
 16577     ELSE IF DFHEIGDJ EQUAL 28
 16578         GO TO 3010-DEL-ACTQ,
 16579               3040-EXIT
 16580         DEPENDING ON DFHEIGDI
 16581     ELSE IF DFHEIGDJ EQUAL 29
 16582         GO TO 3010-NO-ACTIVITY,
 16583               3050-EXIT
 16584         DEPENDING ON DFHEIGDI
 16585     ELSE IF DFHEIGDJ EQUAL 30
 16586         GO TO 3010-CERT-NOT-FOUND
 16587         DEPENDING ON DFHEIGDI
 16588     ELSE IF DFHEIGDJ EQUAL 31
 16589         GO TO 3020-EXIT
 16590         DEPENDING ON DFHEIGDI
 16591     ELSE IF DFHEIGDJ EQUAL 32
 16592         GO TO 3060-EXIT,
 16593               3060-EXIT
 16594         DEPENDING ON DFHEIGDI
 16595     ELSE IF DFHEIGDJ EQUAL 33
 16596         GO TO 5000-TRLR-NOT-FOUND
 16597         DEPENDING ON DFHEIGDI
 16598     ELSE IF DFHEIGDJ EQUAL 34
 16599         GO TO 5000-CERT-NOT-FOUND
 16600         DEPENDING ON DFHEIGDI
 16601     ELSE IF DFHEIGDJ EQUAL 35
 16602         GO TO 7630-END-BROWSE
 16603         DEPENDING ON DFHEIGDI
 16604     ELSE IF DFHEIGDJ EQUAL 36
 16605         GO TO 7799-EXIT,
 16606               7799-EXIT
 16607         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 14-Nov-13 13:55 Page 316
* EL131.cbl
 16608     ELSE IF DFHEIGDJ EQUAL 37
 16609         GO TO 7799-EXIT
 16610         DEPENDING ON DFHEIGDI
 16611     ELSE IF DFHEIGDJ EQUAL 38
 16612         GO TO 7800-NOT-FOUND
 16613         DEPENDING ON DFHEIGDI
 16614     ELSE IF DFHEIGDJ EQUAL 39
 16615         GO TO 8000-NOTE-NOT-FOUND
 16616         DEPENDING ON DFHEIGDI
 16617     ELSE IF DFHEIGDJ EQUAL 40
 16618         GO TO 8990-SEND-TEXT
 16619         DEPENDING ON DFHEIGDI.
 16620     MOVE '9%                    "   ' TO DFHEIV0
 16621     MOVE 'EL131' TO DFHEIV1
 16622     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16623     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13428     Code:       56998
