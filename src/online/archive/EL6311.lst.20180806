* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
    79* 022017  IR2017022000002  PEMA  PREVENT DEL OF ISS W/CHECK
    80* 101016  CR2015082500001  PEMA  ADD COMPANY VPP
    81* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    82******************************************************************
    83
    84 ENVIRONMENT DIVISION.
    85
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page   4
* EL6311.cbl
    87 DATA DIVISION.
    88 WORKING-STORAGE SECTION.
    89 01  DFH-START PIC X(04).
    90 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    91 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    92 77  FILLER  PIC X(32)  VALUE '********************************'.
    93 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    94 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    95 77  A1                          PIC S999 COMP-3 VALUE +0.
    96 77  N1                          PIC S999 COMP-3 VALUE +0.
    97 77  N2                          PIC S999 COMP-3 VALUE +0.
    98 77  N3                          PIC S999 COMP-3 VALUE +0.
    99 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
   100 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
   101 77  WS-REVERSE-SW               PIC X VALUE 'N'.
   102     88  REVERSAL                    VALUE 'Y'.
   103 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   104 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   105 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   106 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   107 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   108     88  ERMAIL-FOUND                 VALUE 'Y'.
   109 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   110 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   111 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   112 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   113     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   114 77  ws-stop-sw                  pic x value ' '.
   115     88  i-say-stop                 value 'Y'.
   116 77  ws-check-sw                 pic x value ' '.
   117     88  i-have-checks              value 'Y'.
   118 77  ws-proc-check-sw            pic x value ' '.
   119     88  i-have-processed-checks    value 'Y'.
   120 77  ws-any-check-sw             pic x value ' '.
   121     88  i-have-a-check-period      value 'Y'.
   122 77  ws-chek-browse-sw           pic x value ' '.
   123 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   124 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   125 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   126 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   127 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   128 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   129 01  P pointer.
   130 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   131 01  var-ptr pointer.
   132 01  env-var-len                 pic 9(4)  binary.
   133 01  rc                          pic 9(9)  binary.
   134 01  WS-KIXSYS.
   135     05  WS-KIX-FIL1             PIC X(10).
   136     05  WS-KIX-APPS             PIC X(10).
   137     05  WS-KIX-ENV              PIC X(10).
   138     05  WS-KIX-MYENV            PIC X(10).
   139     05  WS-KIX-SYS              PIC X(10).
   140*    COPY ELCSCTM.
   141******************************************************************
   142*                                                                *
   143*                                                                *
   144*                            ELCSCTM                             *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page   5
* EL6311.cbl
   145*                            VMOD=2.001                          *
   146*                                                                *
   147*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   148*                                                                *
   149******************************************************************
   150 01  SECURITY-MESSAGE.
   151     12  FILLER                          PIC X(30)
   152            VALUE '** LOGIC SECURITY VIOLATION -'.
   153     12  SM-READ                         PIC X(6).
   154     12  FILLER                          PIC X(5)
   155            VALUE ' PGM='.
   156     12  SM-PGM                          PIC X(6).
   157     12  FILLER                          PIC X(5)
   158            VALUE ' OPR='.
   159     12  SM-PROCESSOR-ID                 PIC X(4).
   160     12  FILLER                          PIC X(6)
   161            VALUE ' TERM='.
   162     12  SM-TERMID                       PIC X(4).
   163     12  FILLER                          PIC XX   VALUE SPACE.
   164     12  SM-JUL-DATE                     PIC 9(5).
   165     12  FILLER                          PIC X    VALUE SPACE.
   166     12  SM-TIME                         PIC 99.99.
   167
   168
   169*    COPY ELCSCRTY.
   170******************************************************************
   171*                                                                *
   172*                                                                *
   173*                            ELCSCRTY                            *
   174*                            VMOD=2.001                          *
   175*                                                                *
   176*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   177*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   178*        SAVED IN PI-SECURITY-ADDRESS.                           *
   179*                                                                *
   180******************************************************************
   181 01  SECURITY-CONTROL.
   182     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   183     12  FILLER                       PIC XX    VALUE 'SC'.
   184     12  SC-CREDIT-CODES.
   185         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   186             20  SC-CREDIT-DISPLAY    PIC X.
   187             20  SC-CREDIT-UPDATE     PIC X.
   188     12  SC-CLAIMS-CODES.
   189         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   190             20  SC-CLAIMS-DISPLAY    PIC X.
   191             20  SC-CLAIMS-UPDATE     PIC X.
   192
   193 01  WS-VA-NO-COMM-MESS.
   194     12  FILLER                  PIC X(41) VALUE
   195        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   196 01  WS-OC-MESSAGE.
   197     12  FILLER                  PIC X(43) VALUE
   198        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   199     12  WS-OC-DIS-AMT           PIC -----9.99.
   200     12  FILLER                  PIC X(4) VALUE ' ON '.
   201     12  WS-OC-DATE              PIC X(10).
   202 01  WS-DATE-AREA.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page   6
* EL6311.cbl
   203     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   204     12  WS-CURRENT-DT.
   205         16  FILLER              PIC X(6)    VALUE SPACES.
   206         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   207     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   208     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   209     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   210
   211 01  STANDARD-AREAS.
   212     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   213     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   214     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   215     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   216     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   217     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   218     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   219     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   220     12  PGM-NAME                PIC X(8).
   221     12  TIME-IN                 PIC S9(7).
   222     12  TIME-OUT-R  REDEFINES TIME-IN.
   223         16  FILLER              PIC X.
   224         16  TIME-OUT            PIC 99V99.
   225         16  FILLER              PIC XX.
   226     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   227     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   228     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   229     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   230     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   231     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   232     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   233     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   234     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   235     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   236     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   237     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   238     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   239     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   240     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   241     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   242     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   243     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   244     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   245     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   246     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   247     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   248     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   249     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   250     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   251     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   252     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   253     12  FILE-ID                 PIC X(8).
   254     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   255     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   256     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   257     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   258     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   259     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   260     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page   7
* EL6311.cbl
   261     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   262     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   263     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   264     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   265     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   266     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   267     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   268     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   269
   270 01  WS-PASS-AREA.
   271     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   272     05  WS-PASS-VADS-REC    PIC X(350).
   273*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   274*                                COPY ELCZREC.
   275******************************************************************
   276*                                                                *
   277*                                                                *
   278*                            ELCZREC.                            *
   279*                                                                *
   280*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   281*                                                                *
   282******************************************************************
   283*-----------------------------------------------------------------
   284*                   C H A N G E   L O G
   285*
   286* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   287*-----------------------------------------------------------------
   288*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   289* EFFECTIVE    NUMBER
   290*-----------------------------------------------------------------
   291* 122011    2011022800001  AJRA  NEW FILE
   292* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   293* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   294* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   295* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   296*-----------------------------------------------------------------
   297 01  W-Z-CONTROL-DATA.
   298     05  W-NUMBER-OF-COPIES      PIC  9.
   299     05  FILLER                  PIC  X.
   300     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   301     05  FILLER                  PIC  X.
   302     05  W-DAYS-TO-RESEND        PIC  999.
   303     05  FILLER                  PIC  X.
   304     05  W-FORM-TO-RESEND        PIC  X(4).
   305     05  W-ADD-BAR-CODE          PIC  X.
   306     05  W-PROMPT-LETTER         PIC  X.
   307     05  W-HAS-RETURN-ENV        PIC  X.
   308     05  W-ENCLOSURE-CD          PIC  XXX.
   309     05  W-SIG-FLAG-DEFAULT      PIC  X.
   310     05  W-AUTO-CLOSE-IND        PIC  X.
   311     05  FILLER                  PIC  X.
   312     05  W-LETTER-TO-BENE        PIC  X.
   313     05  FILLER                  PIC  X.
   314     05  W-LETTER-TO-ACCT        PIC  X.
   315     05  FILLER                  PIC  X.
   316     05  W-LETTER-TYPE           PIC  X.
   317     05  FILLER                  PIC  X.
   318     05  W-PRINT-CERTIFICATE     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page   8
* EL6311.cbl
   319     05  FILLER                  PIC  X.
   320     05  W-REFUND-REQUIRED       PIC  X.
   321     05  FILLER                  PIC  X.
   322     05  W-ONBASE-CODE           PIC  XX.
   323     05  FILLER                  PIC  X.
   324     05  W-ACCT-SUMM             PIC  X.
   325     05  FILLER                  PIC  X.
   326     05  W-CSO-SUMM              PIC  X.
   327     05  FILLER                  PIC  X.
   328     05  W-REASONS-REQUIRED      PIC  X.
   329     05  FILLER                  PIC  X(29).
   330******************************************************************
   331*                                                                *
   332*              A C C E S S   K E Y S                             *
   333*                                                                *
   334******************************************************************
   335
   336 01  ACCESS-KEYS.
   337     12  ERPYAJ-KEY.
   338         16  ERPYAJ-COMPANY-CD       PIC X.
   339         16  ERPYAJ-CARRIER          PIC X.
   340         16  ERPYAJ-GROUPING         PIC X(6).
   341         16  ERPYAJ-FIN-RESP         PIC X(10).
   342         16  ERPYAJ-ACCOUNT          PIC X(10).
   343         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   344         16  ERPYAJ-TYPE             PIC X.
   345     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   346     12  ELCERT-KEY.
   347         16  ELCERT-COMPANY-CD       PIC X.
   348         16  ELCERT-CARRIER          PIC X.
   349         16  ELCERT-GROUPING         PIC X(6).
   350         16  ELCERT-STATE            PIC XX.
   351         16  ELCERT-ACCOUNT          PIC X(10).
   352         16  ELCERT-CERT-EFF-DT      PIC XX.
   353         16  ELCERT-CERT-NO.
   354             20  ELCERT-CERT-PRIME   PIC X(10).
   355             20  ELCERT-CERT-SFX     PIC X.
   356
   357     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   358     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   359     12  ELCRTO-KEY.
   360         16  ELCRTO-COMPANY-CD       PIC X.
   361         16  ELCRTO-CARRIER          PIC X.
   362         16  ELCRTO-GROUPING         PIC X(6).
   363         16  ELCRTO-STATE            PIC XX.
   364         16  ELCRTO-ACCOUNT          PIC X(10).
   365         16  ELCRTO-CERT-EFF-DT      PIC XX.
   366         16  ELCRTO-CERT-NO.
   367             20  ELCRTO-CERT-PRIME   PIC X(10).
   368             20  ELCRTO-CERT-SFX     PIC X.
   369         16  ELCRTO-RECORD-TYPE      PIC X.
   370         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   371
   372     12  ELCRTT-KEY.
   373         16  ELCRTT-PRIMARY          PIC X(33).
   374         16  ELCRTT-REC-TYPE         PIC X(1).
   375     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   376     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page   9
* EL6311.cbl
   377
   378     12  ERPNDB-KEY.
   379         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   380         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   381         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   382         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   383             ERPNDB-BATCH-SEQ-NO     PIC XX.
   384         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   385
   386     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   387     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   388     12  ERCHEK-KEY.
   389         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   390         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   391         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   392         16  CHEK-STATE              PIC XX      VALUE SPACES.
   393         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   394         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   395         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   396         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   397         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   398     12  ELLETR-KEY.
   399         16  LETR-COMPANY-CD     PIC X.
   400         16  LETR-LETTER-ID      PIC X(4).
   401         16  LETR-FILLER         PIC X(8).
   402         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   403     12  ERPNDM-KEY.
   404         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   405         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   406         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   407         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   408
   409*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   410     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   411*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   412     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   413
   414     12  ERPNDB-ALT-KEY.
   415         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   416         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   417         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   418         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   419         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   420         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   421         16  ERPNDB-CERT-NO.
   422             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   423             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   424         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   425         16  ERPNDB-RECORD-TYPE      PIC X.
   426
   427      12  ERPNDB-CSR-KEY.
   428          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   429          20  ERPNDB-CSR-ID                PIC X(4).
   430          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   431          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   432          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   433
   434     12  ERNOTE-KEY.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  10
* EL6311.cbl
   435         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   436         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   437         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   438         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   439         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   440         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   441         16  ERNOTE-CERT-NO.
   442             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   443             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   444
   445     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   446     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   447
   448     12  ERCNOT-KEY.
   449         16  ERCNOT-PART-KEY.
   450             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   451             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   452             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   453             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   454             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   455             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   456             20  ERCNOT-CERT-NO.
   457                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   458                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   459         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   460         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   461
   462     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   463     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   464
   465     12  ERMAIL-KEY.
   466         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   467         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   468         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   469         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   470         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   471         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   472         16  ERMAIL-CERT-NO.
   473             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   474             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   475
   476     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   477     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   478
   479     12  ERRQST-KEY.
   480         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   481         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   482
   483     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   484     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   485
   486     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   487
   488     12  ERLOFC-KEY.
   489         16  ERLOFC-COMPANY-CD          PIC  X.
   490         16  ERLOFC-CARRIER             PIC  X.
   491         16  ERLOFC-GROUPING            PIC  X(6).
   492         16  ERLOFC-STATE               PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  11
* EL6311.cbl
   493         16  ERLOFC-ACCOUNT             PIC  X(10).
   494         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   495*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   496
   497     12  ERACCT-KEY.
   498         16  ERACCT-COMPANY-CD          PIC  X.
   499         16  ERACCT-CARRIER             PIC  X.
   500         16  ERACCT-GROUPING            PIC  X(6).
   501         16  ERACCT-STATE               PIC  XX.
   502         16  ERACCT-ACCOUNT             PIC  X(10).
   503         16  ERACCT-EXP-DT.
   504             20  ERACCT-DT              PIC  XX.
   505             20  ERACCT-FILL            PIC  X(4).
   506
   507     12  ERENDT-KEY.
   508         16  ENDT-COMPANY-CD       PIC X.
   509         16  ENDT-CARRIER          PIC X.
   510         16  ENDT-GROUPING         PIC X(6).
   511         16  ENDT-STATE            PIC XX.
   512         16  ENDT-ACCOUNT          PIC X(10).
   513         16  ENDT-CERT-EFF-DT      PIC XX.
   514         16  ENDT-CERT-PRIME       PIC X(10).
   515         16  ENDT-CERT-SFX         PIC X.
   516         16  ENDT-RECORD-TYPE      PIC X.
   517         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   518
   519 01  WS-ELMSTR-WORK.
   520     12  ELMSTR-KEY.
   521         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   522         16  MSTR-CERT-NO.
   523             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   524             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   525     12  W-CLAIM-KEY.
   526         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   527         16  W-CL-CERT-NO.
   528             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   529             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   530      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   531 01  CANCEL-GEN-PASS-AREA.
   532     05  CG-OPTION-CODE          PIC X.
   533         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   534         88  CG-FLAT-CANCEL        VALUE '1'.
   535         88  CG-CANCEL             VALUE '2'.
   536         88  CG-CANCEL-REISSUE     VALUE '3'.
   537     05  CG-ERROR-CODE           PIC 99.
   538         88  CG-SUCCESS            VALUE 00.
   539         88  CG-DATE-ERROR         VALUE 01.
   540         88  CG-CERT-NOT-FOUND     VALUE 02.
   541         88  CG-AMOUNT-ERROR       VALUE 04.
   542         88  CG-OPTION-ERROR       VALUE 05.
   543         88  CG-PREV-CAN           VALUE 06.
   544         88  CG-INVALID-DATA       VALUE 07.
   545         88  CG-NO-ACCT-MSTR       VALUE 08.
   546         88  CG-SFX-A-EXIST        VALUE 09.
   547         88  CG-MISC-ERROR         VALUE 99.
   548     05  CG-COMPANY-ID           PIC XXX.
   549     05  CG-PROC-ID              PIC XXXX.
   550     05  CG-CURRENT-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  12
* EL6311.cbl
   551     05  CG-MONTH-END-DT         PIC XX.
   552     05  CG-CERT-KEY.
   553         10  CG-CERT-COMPANY-CD  PIC X.
   554         10  CG-CERT-CARRIER     PIC X.
   555         10  CG-CERT-GROUP       PIC X(6).
   556         10  CG-CERT-STATE       PIC XX.
   557         10  CG-CERT-ACCOUNT     PIC X(10).
   558         10  CG-CERT-EFF-DT      PIC XX.
   559         10  CG-CERT-CERT-NO     PIC X(11).
   560     05  CG-LF-CAN-DATA.
   561         10  CG-LF-CAN-DT        PIC XX.
   562         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   563     05  CG-AH-CAN-DATA.
   564         10  CG-AH-CAN-DT        PIC XX.
   565         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   566     05  CG-CERT-PROFILE-DATA.
   567         10  CG-INS-LNAME        PIC X(15).
   568         10  CG-INS-FNAME        PIC X(10).
   569         10  CG-INS-MID-INIT     PIC X.
   570         10  CG-INS-AGE          PIC 99.
   571         10  CG-JNT-LNAME        PIC X(15).
   572         10  CG-JNT-FNAME        PIC X(10).
   573         10  CG-JNT-MID-INIT     PIC X.
   574         10  CG-JNT-AGE          PIC 99.
   575     05  CG-LF-ISS-DATA.
   576         10  CG-LF-BENCD         PIC XX.
   577         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   578         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   579     05  CG-AH-ISS-DATA.
   580         10  CG-AH-BENCD         PIC XX.
   581         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   582     05  CG-BATCH-NO             PIC X(6).
   583     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   584     05  FILLER                  PIC X(306).
   585******************************************************************
   586*                                                                *
   587*            G E N E R A L   W O R K   A R E A                   *
   588*                                                                *
   589******************************************************************
   590
   591 01  WORK-AREA.
   592     12  WS-RESPONSE             PIC S9(8)   COMP.
   593         88  RESP-NORMAL           VALUE +0.
   594         88  resp-file-notfnd      value +12.
   595         88  RESP-NOTFND           VALUE +13.
   596         88  resp-duprec           value +14.
   597         88  resp-dupkey           value +15.
   598         88  resp-invreq           value +16.
   599         88  RESP-NOTOPEN          VALUE +19.
   600         88  RESP-ENDFILE          VALUE +20.
   601         88  resp-lengtherr        value +22.
   602     12  DEEDIT-FIELD            PIC X(15).
   603     12  FILLER          REDEFINES DEEDIT-FIELD.
   604         16  FILLER              PIC X(4).
   605         16  DEEDIT-FIELD-X11    PIC X(11).
   606     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   607                                 PIC S9(15).
   608     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  13
* EL6311.cbl
   609                                 PIC S9(13)V99.
   610     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   611                                 PIC S9(11)V9999.
   612     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   613     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   614     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   615         16  WS-CALC-TERM-WHOLE  PIC S999.
   616         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   617
   618     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   619     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   620         16  WS-HR-MINS          PIC 99V99.
   621         16  FILLER              PIC XX.
   622
   623     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   624     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   625
   626     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   627     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   628
   629     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   630     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   631     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   632     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   633     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   634     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   635     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   636
   637     12  QID.
   638         16  QID-TERM            PIC X(4).
   639         16  FILLER              PIC X(4)    VALUE '607B'.
   640
   641     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   642         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   643
   644     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   645         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   646
   647     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   648         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   649                                         'A'.
   650
   651     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   652
   653     12  WS-NUMERIC-SW           PIC X.
   654        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   655
   656     12  WS-EDIT-CSO-FIELD.
   657         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   658                                 PIC X.
   659
   660     12  WS-SAVE-INPUT-FIELDS.
   661         16  WS-BAGE             PIC 99       VALUE ZERO.
   662*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   663         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   664         16  FILLER REDEFINES WS-BAPR.
   665             20  WS-APR-WHOLE-NUM    PIC 99.
   666             20  WS-APR-DEC          PIC 9999.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  14
* EL6311.cbl
   667         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   668         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   669
   670         16  WS-B-COVERAGE OCCURS 2 TIMES.
   671             20  WS-TERM-IN-DAYS-SW  PIC X.
   672                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   673             20  WS-BTERM        PIC 999       COMP-3.
   674             20  WS-BALT-TERM    PIC 999       COMP-3.
   675             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   676             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   677             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   678             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   679             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   680             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   681
   682         16  WS-C-FIELDS COMP-3.
   683             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   684             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   685             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   686
   687         16  WS-D-FIELDS COMP-3.
   688             20  WS-DRISS        PIC S9(5)    VALUE +0.
   689             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   690             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   691             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   692             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   693             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   694
   695     12  WS-SAVE-BIRTH-DATE.
   696         16  FILLER              PIC X(4)   VALUE SPACES.
   697         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   698
   699     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   700     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   701     12  FILLER REDEFINES WS-WORK-BIN-RED.
   702         16  FILLER              PIC X(02).
   703         16  WS-WORK-BIN-DT      PIC X(02).
   704     12  WS-SW-1                 PIC X     VALUE SPACE.
   705     12  WS-SW-2                 PIC X     VALUE SPACE.
   706     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   707         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   708     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   709         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   710
   711     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   712     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   713     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   714     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   715     12  WS-CONVERTED-CANCEL-DATES.
   716         16  WS-CONVERTED-CANDT1                  PIC XX.
   717         16  WS-CONVERTED-CANDT2                  PIC XX.
   718
   719     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   720
   721     12  WS-REC-FOUND-SW         PIC X.
   722         88  RECORD-NOT-FOUND    VALUE 'N'.
   723
   724     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  15
* EL6311.cbl
   725         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   726         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   727
   728     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   729         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   730         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   731
   732     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   733         88  BROWSE-STARTED      VALUE 'Y'.
   734
   735     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   736         88  FIRST-TIME          VALUE 'Y'.
   737
   738     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   739         88  FIRST-ENTRY         VALUE 'Y'.
   740
   741     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   742         88  REC-BILLED          VALUE 'Y'.
   743
   744     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   745         88  NO-CURSOR-SET       VALUE +0.
   746         88  CURSOR-SET          VALUE +1.
   747
   748     12  WS-ERR-SW               PIC X.
   749         88  STD-ERRORS          VALUE 'S'.
   750         88  TRN-ERRORS          VALUE 'T'.
   751
   752     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   753         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   754
   755     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   756         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   757
   758     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   759         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   760
   761     12  WS-ERR-CODE.
   762         16  FILLER              PIC 99.
   763         16  WS-ERROR-SUB        PIC 99.
   764
   765     12  WS-DATE-WORK.
   766         16  WS-WORK-MM          PIC XX.
   767         16  WS-WORK-DD          PIC XX.
   768         16  WS-WORK-YY          PIC XX.
   769
   770     12  WS-MM-YY.
   771         16  WS-MM               PIC XX.
   772         16  FILLER              PIC X     VALUE '/'.
   773         16  WS-YY               PIC XX.
   774
   775     12  WS-CERT-EFF-DT          PIC XX.
   776
   777     12  WS-MEMBER-NO            PIC X(12).
   778     12  FILLER  REDEFINES  WS-MEMBER-NO.
   779         16  WS-MEMBER-NO-1-8    PIC 9(8).
   780         16  FILLER              PIC X(4).
   781
   782     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  16
* EL6311.cbl
   783
   784     12  WS-ERPNDB-ALT-KEY.
   785         16  WS-PB-COMPANY-CD-A1         PIC X.
   786         16  WS-PB-CARRIER               PIC X.
   787         16  WS-PB-GROUPING              PIC X(6).
   788         16  WS-PB-STATE                 PIC XX.
   789         16  WS-PB-ACCOUNT               PIC X(10).
   790         16  WS-PB-CERT-EFF-DT           PIC XX.
   791         16  WS-PB-CERT-NO.
   792             20  WS-PB-CERT-PRIME        PIC X(10).
   793             20  WS-PB-CERT-SFX          PIC X.
   794         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   795         16  WS-PB-RECORD-TYPE           PIC X.
   796
   797     12  WS-SHOW-SAVE-AREAS.
   798         16  WS-NEW-CERT-NO.
   799             20  WS-NEW-PRIME    PIC X(10).
   800             20  WS-NEW-SUFFIX   PIC X.
   801         16  WS-NEW-CERT-EFF-DT  PIC XX.
   802         16  WS-NEW-RECORD-TYPE  PIC X.
   803         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   804             88   SHOW-RECORD            VALUE 'Y'.
   805
   806     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   807
   808     12  WS-BATCH-NO.
   809         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   810         16  FILLER              PIC X(5) VALUE SPACES.
   811
   812     12  WS-FIRST-NAME.
   813         16  WS-1ST-INIT         PIC X.
   814         16  FILLER              PIC X(9).
   815
   816     12  WS-INITIALS.
   817         16  WS-INITIAL-1        PIC X.
   818         16  WS-INITIAL-2        PIC X.
   819
   820     12  WS-C-HDG.
   821         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   822         16  FILLER              PIC X(4) VALUE '-REF'.
   823
   824     12  WS-D-PREM-HDG.
   825         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   826         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   827
   828     12  WS-D-REFUND-HDG.
   829         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   830         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   831
   832     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   833
   834     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   835     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   836     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   837     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   838     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   839     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   840     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  17
* EL6311.cbl
   841
   842     12  WS-01-CANCEL-ERR        PIC X(25)
   843         VALUE 'CANCEL DATE ERROR'.
   844     12  WS-02-CANCEL-ERR        PIC X(25)
   845         VALUE 'CERT NOT FOUND'.
   846     12  WS-04-CANCEL-ERR        PIC X(25)
   847         VALUE 'CANCEL AMOUNT ERROR'.
   848     12  WS-05-CANCEL-ERR        PIC X(25)
   849         VALUE 'CANCEL OPTION ERROR'.
   850     12  WS-06-CANCEL-ERR        PIC X(25)
   851         VALUE 'PREVIOUSLY CANCELLED'.
   852     12  WS-07-CANCEL-ERR        PIC X(25)
   853         VALUE 'INVALID DATA'.
   854     12  WS-08-CANCEL-ERR        PIC X(25)
   855         VALUE 'NO ACCOUNT MASTER'.
   856     12  WS-09-CANCEL-ERR        PIC X(25)
   857         VALUE 'SUFFIX ALREADY EXISTS'.
   858     12  WS-99-CANCEL-ERR        PIC X(25)
   859         VALUE 'MISC CANCEL ERROR'.
   860
   861     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   862     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   863
   864     12  WS-AGE-FIELDS.
   865         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   866         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   867         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   868         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   869
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  18
* EL6311.cbl
   871
   872******************************************************************
   873*                                                                *
   874*                 B A T C H   T O T A L S                        *
   875*                                                                *
   876******************************************************************
   877
   878     12  WS-BATCH-RECORD.
   879         16  FILLER                       PIC X(10).
   880         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   881         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   882         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   883         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   884         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   885         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   886         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   887         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   888         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   889         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   890         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   891         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   892         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   893         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   894         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   895         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   896         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   897         16  WS-ACCOUNT-NAME              PIC X(30).
   898         16  FILLER                       PIC X.
   899         16  WS-REFERENCE                 PIC X(12).
   900         16  FILLER                       PIC X(197).
   901
   902     12  WS-BATCH-TOTALS.
   903         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   904         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   905         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   906         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   907         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   908         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   909         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   910         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   911         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   912         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   913         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   914         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   915         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   916         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   917         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   918         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   919         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   920         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   921         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   922
   923     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   924
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  19
* EL6311.cbl
   926
   927******************************************************************
   928*                                                                *
   929*                E R R O R   M E S S A G E S                     *
   930*                                                                *
   931******************************************************************
   932
   933 01  ERROR-MESSAGES.
   934     12  ER-0004                 PIC  9(4) VALUE 0004.
   935     12  ER-0008                 PIC  9(4) VALUE 0008.
   936     12  ER-0023                 PIC  9(4) VALUE 0023.
   937     12  ER-0029                 PIC  9(4) VALUE 0029.
   938     12  ER-0033                 PIC  9(4) VALUE 0033.
   939     12  ER-0070                 PIC  9(4) VALUE 0070.
   940     12  ER-0220                 PIC  9(4) VALUE 0220.
   941     12  ER-0248                 PIC  9(4) VALUE 0248.
   942     12  ER-0280                 PIC  9(4) VALUE 0280.
   943     12  ER-0348                 PIC  9(4) VALUE 0348.
   944     12  ER-0582                 PIC  9(4) VALUE 0582.
   945     12  ER-0877                 PIC  9(4) VALUE 0877.
   946     12  ER-1236                 PIC  9(4) VALUE 1236.
   947     12  ER-1570                 PIC  9(4) VALUE 1570.
   948     12  ER-1575                 PIC  9(4) VALUE 1575.
   949     12  ER-1609                 PIC  9(4) VALUE 1609.
   950     12  ER-1819                 PIC  9(4) VALUE 1819.
   951     12  ER-2077                 PIC  9(4) VALUE 2077.
   952     12  ER-2129                 PIC  9(4) VALUE 2129.
   953     12  ER-2188                 PIC  9(4) VALUE 2188.
   954     12  ER-2192                 PIC  9(4) VALUE 2192.
   955     12  ER-2196                 PIC  9(4) VALUE 2196.
   956     12  ER-2197                 PIC  9(4) VALUE 2197.
   957     12  ER-2198                 PIC  9(4) VALUE 2198.
   958     12  ER-2200                 PIC  9(4) VALUE 2200.
   959     12  ER-2212                 PIC  9(4) VALUE 2212.
   960     12  ER-2218                 PIC  9(4) VALUE 2218.
   961     12  ER-2220                 PIC  9(4) VALUE 2220.
   962     12  ER-2222                 PIC  9(4) VALUE 2222.
   963     12  ER-2223                 PIC  9(4) VALUE 2223.
   964     12  ER-2224                 PIC  9(4) VALUE 2224.
   965     12  ER-2225                 PIC  9(4) VALUE 2225.
   966     12  ER-2226                 PIC  9(4) VALUE 2226.
   967     12  ER-2227                 PIC  9(4) VALUE 2227.
   968     12  ER-2228                 PIC  9(4) VALUE 2228.
   969     12  ER-2240                 PIC  9(4) VALUE 2240.
   970     12  ER-2241                 PIC  9(4) VALUE 2241.
   971     12  ER-2242                 PIC  9(4) VALUE 2242.
   972     12  ER-2243                 PIC  9(4) VALUE 2243.
   973     12  ER-2244                 PIC  9(4) VALUE 2244.
   974     12  ER-2245                 PIC  9(4) VALUE 2245.
   975     12  ER-2246                 PIC  9(4) VALUE 2246.
   976     12  ER-2247                 PIC  9(4) VALUE 2247.
   977     12  ER-2251                 PIC  9(4) VALUE 2251.
   978     12  ER-2252                 PIC  9(4) VALUE 2252.
   979     12  ER-2253                 PIC  9(4) VALUE 2253.
   980     12  ER-2254                 PIC  9(4) VALUE 2254.
   981     12  ER-2255                 PIC  9(4) VALUE 2255.
   982     12  ER-2256                 PIC  9(4) VALUE 2256.
   983     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  20
* EL6311.cbl
   984     12  ER-2258                 PIC  9(4) VALUE 2258.
   985     12  ER-2259                 PIC  9(4) VALUE 2259.
   986     12  ER-2260                 PIC  9(4) VALUE 2260.
   987     12  ER-2261                 PIC  9(4) VALUE 2261.
   988     12  ER-2287                 PIC  9(4) VALUE 2287.
   989     12  ER-2336                 PIC  9(4) VALUE 2336.
   990     12  ER-2337                 PIC  9(4) VALUE 2337.
   991     12  ER-2437                 PIC  9(4) VALUE 2437.
   992     12  ER-2471                 PIC  9(4) VALUE 2471.
   993     12  ER-2530                 PIC  9(4) VALUE 2530.
   994     12  ER-2531                 PIC  9(4) VALUE 2531.
   995     12  ER-2532                 PIC  9(4) VALUE 2532.
   996     12  ER-2533                 PIC  9(4) VALUE 2533.
   997     12  ER-2547                 PIC  9(4) VALUE 2547.
   998     12  ER-2591                 PIC  9(4) VALUE 2591.
   999     12  ER-2592                 PIC  9(4) VALUE 2592.
  1000     12  ER-2593                 PIC  9(4) VALUE 2593.
  1001     12  ER-2600                 PIC  9(4) VALUE 2600.
  1002     12  ER-2601                 PIC  9(4) VALUE 2601.
  1003     12  ER-2604                 PIC  9(4) VALUE 2604.
  1004     12  ER-2605                 PIC  9(4) VALUE 2605.
  1005     12  ER-2606                 PIC  9(4) VALUE 2606.
  1006     12  ER-2607                 PIC  9(4) VALUE 2607.
  1007     12  ER-2622                 PIC  9(4) VALUE 2622.
  1008     12  ER-2625                 PIC  9(4) VALUE 2625.
  1009     12  ER-2626                 PIC  9(4) VALUE 2626.
  1010     12  ER-2627                 PIC  9(4) VALUE 2627.
  1011     12  ER-2628                 PIC  9(4) VALUE 2628.
  1012     12  ER-2629                 PIC  9(4) VALUE 2629.
  1013     12  ER-2630                 PIC  9(4) VALUE 2630.
  1014     12  ER-2631                 PIC  9(4) VALUE 2631.
  1015     12  ER-2632                 PIC  9(4) VALUE 2632.
  1016     12  ER-2633                 PIC  9(4) VALUE 2633.
  1017     12  ER-2634                 PIC  9(4) VALUE 2634.
  1018     12  ER-2635                 PIC  9(4) VALUE 2635.
  1019     12  ER-2636                 PIC  9(4) VALUE 2636.
  1020     12  ER-2639                 PIC  9(4) VALUE 2639.
  1021     12  ER-2640                 PIC  9(4) VALUE 2640.
  1022     12  ER-2647                 PIC  9(4) VALUE 2647.
  1023     12  ER-2648                 PIC  9(4) VALUE 2648.
  1024     12  ER-2649                 PIC  9(4) VALUE 2649.
  1025     12  ER-2650                 PIC  9(4) VALUE 2650.
  1026     12  ER-2653                 PIC  9(4) VALUE 2653.
  1027     12  ER-2654                 PIC  9(4) VALUE 2654.
  1028     12  ER-2655                 PIC  9(4) VALUE 2655.
  1029     12  ER-2656                 PIC  9(4) VALUE 2656.
  1030     12  ER-2657                 PIC  9(4) VALUE 2657.
  1031     12  ER-2660                 PIC  9(4) VALUE 2660.
  1032     12  ER-2661                 PIC  9(4) VALUE 2661.
  1033     12  ER-2662                 PIC  9(4) VALUE 2662.
  1034     12  ER-2663                 PIC  9(4) VALUE 2663.
  1035     12  ER-2664                 PIC  9(4) VALUE 2664.
  1036     12  ER-2667                 PIC  9(4) VALUE 2667.
  1037     12  ER-2668                 PIC  9(4) VALUE 2668.
  1038     12  ER-2669                 PIC  9(4) VALUE 2669.
  1039     12  ER-2670                 PIC  9(4) VALUE 2670.
  1040     12  ER-2671                 PIC  9(4) VALUE 2671.
  1041     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  21
* EL6311.cbl
  1042     12  ER-2673                 PIC  9(4) VALUE 2673.
  1043     12  ER-2677                 PIC  9(4) VALUE 2677.
  1044     12  ER-2678                 PIC  9(4) VALUE 2678.
  1045     12  ER-2679                 PIC  9(4) VALUE 2679.
  1046     12  ER-2680                 PIC  9(4) VALUE 2680.
  1047     12  ER-2681                 PIC  9(4) VALUE 2681.
  1048     12  ER-2682                 PIC  9(4) VALUE 2682.
  1049     12  ER-2683                 PIC  9(4) VALUE 2683.
  1050     12  ER-2684                 PIC  9(4) VALUE 2684.
  1051     12  ER-2686                 PIC  9(4) VALUE 2686.
  1052     12  ER-2689                 PIC  9(4) VALUE 2689.
  1053     12  ER-2690                 PIC  9(4) VALUE 2690.
  1054     12  ER-2693                 PIC  9(4) VALUE 2693.
  1055     12  ER-2695                 PIC  9(4) VALUE 2695.
  1056     12  ER-2701                 PIC  9(4) VALUE 2701.
  1057     12  ER-2720                 PIC  9(4) VALUE 2720.
  1058     12  ER-2709                 PIC  9(4) VALUE 2709.
  1059     12  ER-2704                 PIC  9(4) VALUE 2704.
  1060     12  ER-2725                 PIC  9(4) VALUE 2725.
  1061     12  ER-2726                 PIC  9(4) VALUE 2726.
  1062     12  ER-2728                 PIC  9(4) VALUE 2728.
  1063     12  ER-2729                 PIC  9(4) VALUE 2729.
  1064     12  ER-2731                 PIC  9(4) VALUE 2731.
  1065     12  ER-2732                 PIC  9(4) VALUE 2732.
  1066     12  ER-2733                 PIC  9(4) VALUE 2733.
  1067     12  ER-2735                 PIC  9(4) VALUE 2735.
  1068     12  ER-2738                 PIC  9(4) VALUE 2738.
  1069     12  ER-2742                 PIC  9(4) VALUE 2742.
  1070     12  ER-2743                 PIC  9(4) VALUE 2743.
  1071     12  ER-2744                 PIC  9(4) VALUE 2744.
  1072     12  ER-2747                 PIC  9(4) VALUE 2747.
  1073     12  ER-2749                 PIC  9(4) VALUE 2749.
  1074     12  ER-2753                 PIC  9(4) VALUE 2753.
  1075     12  ER-2755                 PIC  9(4) VALUE 2755.
  1076     12  ER-2757                 PIC  9(4) VALUE 2757.
  1077     12  ER-2771                 PIC  9(4) VALUE 2771.
  1078     12  ER-2774                 PIC  9(4) VALUE 2774.
  1079     12  ER-2775                 PIC  9(4) VALUE 2775.
  1080     12  ER-2776                 PIC  9(4) VALUE 2776.
  1081     12  ER-2777                 PIC  9(4) VALUE 2777.
  1082     12  ER-2794                 PIC  9(4) VALUE 2794.
  1083     12  ER-2799                 PIC  9(4) VALUE 2799.
  1084     12  ER-2900                 PIC  9(4) VALUE 2900.
  1085     12  ER-2902                 PIC  9(4) VALUE 2902.
  1086     12  ER-2945                 PIC  9(4) VALUE 2945.
  1087     12  ER-3000                 PIC  9(4) VALUE 3000.
  1088     12  ER-3006                 PIC  9(4) VALUE 3006.
  1089     12  ER-3054                 PIC  9(4) VALUE 3054.
  1090     12  ER-3224                 PIC  9(4) VALUE 3224.
  1091     12  ER-3269                 PIC  9(4) VALUE 3269.
  1092     12  er-3444                 pic  9(4) value 3444.
  1093     12  er-3446                 pic  9(4) value 3446.
  1094     12  er-3447                 pic  9(4) value 3447.
  1095     12  er-3448                 pic  9(4) value 3448.
  1096     12  er-3449                 pic  9(4) value 3449.
  1097     12  ER-3456                 PIC  9(4) VALUE 3456.
  1098     12  ER-3457                 PIC  9(4) VALUE 3457.
  1099     12  ER-3458                 PIC  9(4) VALUE 3458.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  22
* EL6311.cbl
  1100     12  ER-3504                 PIC  9(4) VALUE 3504.
  1101     12  ER-3513                 PIC  9(4) VALUE 3513.
  1102     12  ER-3831                 PIC  9(4) VALUE 3831.
  1103     12  ER-3834                 PIC  9(4) VALUE 3834.
  1104     12  ER-3835                 PIC  9(4) VALUE 3835.
  1105     12  ER-4005                 PIC  9(4) VALUE 4005.
  1106     12  ER-7144                 PIC  9(4) VALUE 7144.
  1107     12  ER-7401                 PIC  9(4) VALUE 7401.
  1108     12  ER-7402                 PIC  9(4) VALUE 7402.
  1109     12  ER-7403                 PIC  9(4) VALUE 7403.
  1110     12  ER-7404                 PIC  9(4) VALUE 7404.
  1111     12  ER-7423                 PIC  9(4) VALUE 7423.
  1112     12  ER-7424                 PIC  9(4) VALUE 7424.
  1113     12  ER-7433                 PIC  9(4) VALUE 7433.
  1114     12  ER-7450                 PIC  9(4) VALUE 7450.
  1115     12  ER-7451                 PIC  9(4) VALUE 7451.
  1116     12  ER-7530                 PIC  9(4) VALUE 7530.
  1117     12  ER-7573                 PIC  9(4) VALUE 7573.
  1118     12  ER-7631                 PIC  9(4) VALUE 7631.
  1119     12  ER-7632                 PIC  9(4) VALUE 7632.
  1120     12  ER-7633                 PIC  9(4) VALUE 7633.
  1121     12  ER-7537                 PIC  9(4) VALUE 7537.
  1122     12  ER-7538                 PIC  9(4) VALUE 7538.
  1123     12  ER-7574                 PIC  9(4) VALUE 7574.
  1124     12  ER-7997                 PIC  9(4) VALUE 7997.
  1125     12  ER-7998                 PIC  9(4) VALUE 7998.
  1126     12  ER-8148                 PIC  9(4) VALUE 8148.
  1127     12  ER-9063                 PIC  9(4) VALUE 9063.
  1128     12  ER-9076                 PIC  9(4) VALUE 9076.
  1129     12  ER-9618                 PIC  9(4) VALUE 9618.
  1130     12  ER-9841                 PIC  9(4) VALUE 9841.
  1131
  1132*                                COPY ELCTEXT.
  1133******************************************************************
  1134*                                                                *
  1135*                                                                *
  1136*                            ELCTEXT.                            *
  1137*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1138*                            VMOD=2.008                          *
  1139*                                                                *
  1140*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1141*                                     FORM LETTERS,              *
  1142*                                     CERT FORM DISPLAY.
  1143*                                                                *
  1144*   FILE TYPE = VSAM,KSDS                                        *
  1145*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1146*                                                                *
  1147*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1148*       ALTERNATE INDEX = NONE                                   *
  1149*                                                                *
  1150*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1151*       ALTERNATE INDEX = NONE                                   *
  1152*                                                                *
  1153*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1154*       ALTERNATE INDEX = NONE                                   *
  1155*                                                                *
  1156*   LOG = NO                                                     *
  1157*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  23
* EL6311.cbl
  1158******************************************************************
  1159 01  TEXT-FILES.
  1160     12  TEXT-FILE-ID                PIC XX.
  1161         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1162         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1163         88  HELP-FILE-TEXT             VALUE 'TH'.
  1164
  1165     12  TX-CONTROL-PRIMARY.
  1166         16  TX-COMPANY-CD           PIC X.
  1167             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1168         16  TX-ACCESS-CD-GENL       PIC X(12).
  1169
  1170         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1171             20  TX-LETTER-NO        PIC X(4).
  1172             20  FILLER              PIC X(8).
  1173
  1174         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1175             20  TX-FORM-NO          PIC X(12).
  1176
  1177         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1178             20  TX-HELP-TYPE        PIC X.
  1179                 88  HELP-FOR-GENERAL   VALUE ' '.
  1180                 88  HELP-BY-SCREEN     VALUE 'S'.
  1181                 88  HELP-BY-ERROR      VALUE 'E'.
  1182             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1183                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1184             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1185                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1186             20  FILLER              PIC X(4).
  1187
  1188         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1189
  1190     12  TX-PROCESS-CONTROL          PIC XX.
  1191         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1192
  1193     12  TX-TEXT-LINE                PIC X(70).
  1194
  1195     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1196         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1197         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1198         88  TX-VALID-FORM-SQUEEZE-VALUE
  1199                                        VALUE 'Y' ' '.
  1200
  1201     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1202         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1203         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1204         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1205         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1206         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1207         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1208         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1209                                              'K' 'N' ' '
  1210                                              'Z'.
  1211
  1212     12  TX-ARCHIVE-SW               PIC X.
  1213         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1214         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1215         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  24
* EL6311.cbl
  1216
  1217     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1218     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1219
  1220     12  TX-BSR-CODE                 PIC X.
  1221         88  TX-BSR-LETTER              VALUE 'B'.
  1222         88  TX-NON-BSR-LETTER          VALUE ' '.
  1223
  1224     12  FILLER                      PIC X.
  1225*****************************************************************
  1226*                                COPY ELCCRTO.
  1227******************************************************************
  1228*                                                                *
  1229*                            ELCCRTO.                            *
  1230*                                                                *
  1231*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1232*                                                                *
  1233*   FILE TYPE = VSAM,KSDS                                        *
  1234*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1235*                                                                *
  1236*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1237*                                                                *
  1238*   LOG = YES                                                    *
  1239*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1240******************************************************************
  1241*                   C H A N G E   L O G
  1242*
  1243* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1244*-----------------------------------------------------------------
  1245*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1246* EFFECTIVE    NUMBER
  1247*-----------------------------------------------------------------
  1248* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1249* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1250* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1251* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1252* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1253******************************************************************
  1254 01  ORIGINAL-CERTIFICATE.
  1255     12  OC-RECORD-ID                      PIC XX.
  1256         88  VALID-OC-ID                      VALUE 'OC'.
  1257     12  OC-CONTROL-PRIMARY.
  1258         16  OC-COMPANY-CD                 PIC X.
  1259         16  OC-CARRIER                    PIC X.
  1260         16  OC-GROUPING                   PIC X(6).
  1261         16  OC-STATE                      PIC XX.
  1262         16  OC-ACCOUNT                    PIC X(10).
  1263         16  OC-CERT-EFF-DT                PIC XX.
  1264         16  OC-CERT-NO.
  1265             20  OC-CERT-PRIME             PIC X(10).
  1266             20  OC-CERT-SFX               PIC X.
  1267         16  OC-RECORD-TYPE                PIC X.
  1268         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1269     12  OC-LAST-MAINT-DT                  PIC XX.
  1270     12  OC-LAST-MAINT-BY                  PIC X(4).
  1271     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1272     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1273     12  FILLER                            PIC X(49).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  25
* EL6311.cbl
  1274     12  OC-ORIG-REC.
  1275         16  OC-INS-LAST-NAME              PIC X(15).
  1276         16  OC-INS-FIRST-NAME             PIC X(10).
  1277         16  OC-INS-MIDDLE-INIT            PIC X.
  1278         16  OC-INS-AGE                    PIC S999     COMP-3.
  1279         16  OC-JNT-LAST-NAME              PIC X(15).
  1280         16  OC-JNT-FIRST-NAME             PIC X(10).
  1281         16  OC-JNT-MIDDLE-INIT            PIC X.
  1282         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1283         16  OC-LF-BENCD                   PIC XX.
  1284         16  OC-LF-TERM                    PIC S999      COMP-3.
  1285         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1286         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1287         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1288         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1289         16  OC-LF-EXP-DT                  PIC XX.
  1290         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1291         16  OC-LF-CANCEL-DT               PIC XX.
  1292         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1293         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1294         16  OC-AH-BENCD                   PIC XX.
  1295         16  OC-AH-TERM                    PIC S999      COMP-3.
  1296         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1297         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1298         16  OC-AH-EXP-DT                  PIC XX.
  1299         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1300         16  OC-AH-CP                      PIC 99.
  1301         16  OC-AH-CANCEL-DT               PIC XX.
  1302         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1303         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1304         16  OC-CRED-BENE-NAME             PIC X(25).
  1305         16  OC-1ST-PMT-DT                 PIC XX.
  1306         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1307         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1308         16  OC-ISSUE-TRAN-IND             PIC X.
  1309         16  OC-CANCEL-TRAN-IND            PIC X.
  1310         16  FILLER                        PIC X(211).
  1311
  1312     12  FILLER                            PIC X(50).
  1313******************************************************************
  1314*                                COPY ERCACCT.
  1315******************************************************************
  1316*                                                                *
  1317*                                                                *
  1318*                            ERCACCT                             *
  1319*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1320*                            VMOD=2.031                          *
  1321*                                                                *
  1322*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1323*                                                                *
  1324*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1325*   VSAM ACCOUNT MASTER FILES.                                   *
  1326*                                                                *
  1327*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1328*                                                                *
  1329*   FILE TYPE = VSAM,KSDS                                        *
  1330*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1331*                                                                *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  26
* EL6311.cbl
  1332*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1333*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1334*                                                                *
  1335*   LOG = NO                                                     *
  1336*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1337*                                                                *
  1338*                                                                *
  1339******************************************************************
  1340*                   C H A N G E   L O G
  1341*
  1342* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1343*-----------------------------------------------------------------
  1344*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1345* EFFECTIVE    NUMBER
  1346*-----------------------------------------------------------------
  1347* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1348* 092705    2005050300006  PEMA  ADD SPP LEASES
  1349* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1350* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1351* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1352* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1353* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1354* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1355******************************************************************
  1356
  1357 01  ACCOUNT-MASTER.
  1358     12  AM-RECORD-ID                      PIC XX.
  1359         88  VALID-AM-ID                      VALUE 'AM'.
  1360
  1361     12  AM-CONTROL-PRIMARY.
  1362         16  AM-COMPANY-CD                 PIC X.
  1363         16  AM-MSTR-CNTRL.
  1364             20  AM-CONTROL-A.
  1365                 24  AM-CARRIER            PIC X.
  1366                 24  AM-GROUPING.
  1367                     28 AM-GROUPING-PREFIX PIC XXX.
  1368                     28 AM-GROUPING-PRIME  PIC XXX.
  1369                 24  AM-STATE              PIC XX.
  1370                 24  AM-ACCOUNT.
  1371                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1372                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1373             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1374                                           PIC X(19).
  1375             20  AM-CNTRL-B.
  1376                 24  AM-EXPIRATION-DT      PIC XX.
  1377                 24  FILLER                PIC X(4).
  1378             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1379                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1380
  1381     12  AM-CONTROL-BY-VAR-GRP.
  1382         16  AM-COMPANY-CD-A1              PIC X.
  1383         16  AM-VG-CARRIER                 PIC X.
  1384         16  AM-VG-GROUPING                PIC X(6).
  1385         16  AM-VG-STATE                   PIC XX.
  1386         16  AM-VG-ACCOUNT                 PIC X(10).
  1387         16  AM-VG-DATE.
  1388             20  AM-VG-EXPIRATION-DT       PIC XX.
  1389             20  FILLER                    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  27
* EL6311.cbl
  1390         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1391                                           PIC 9(11)      COMP-3.
  1392     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1393         16  FILLER                        PIC X(10).
  1394         16  AM-VG-KEY3.
  1395             20  AM-VG3-ACCOUNT            PIC X(10).
  1396             20  AM-VG3-EXP-DT             PIC XX.
  1397         16  FILLER                        PIC X(4).
  1398     12  AM-MAINT-INFORMATION.
  1399         16  AM-LAST-MAINT-DT              PIC XX.
  1400         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1401         16  AM-LAST-MAINT-USER            PIC X(4).
  1402         16  FILLER                        PIC XX.
  1403
  1404     12  AM-EFFECTIVE-DT                   PIC XX.
  1405     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1406
  1407     12  AM-PREV-DATES  COMP-3.
  1408         16  AM-PREV-EXP-DT                PIC 9(11).
  1409         16  AM-PREV-EFF-DT                PIC 9(11).
  1410
  1411     12  AM-REPORT-CODE-1                  PIC X(10).
  1412     12  AM-REPORT-CODE-2                  PIC X(10).
  1413
  1414     12  AM-CITY-CODE                      PIC X(4).
  1415     12  AM-COUNTY-PARISH                  PIC X(6).
  1416
  1417     12  AM-NAME                           PIC X(30).
  1418     12  AM-PERSON                         PIC X(30).
  1419     12  AM-ADDRS                          PIC X(30).
  1420     12  AM-CITY.
  1421         16  AM-ADDR-CITY                  PIC X(28).
  1422         16  AM-ADDR-STATE                 PIC XX.
  1423     12  AM-ZIP.
  1424         16  AM-ZIP-PRIME.
  1425             20  AM-ZIP-PRI-1ST            PIC X.
  1426                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1427             20  FILLER                    PIC X(4).
  1428         16  AM-ZIP-PLUS4                  PIC X(4).
  1429     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1430         16  AM-CAN-POSTAL-1               PIC XXX.
  1431         16  AM-CAN-POSTAL-2               PIC XXX.
  1432         16  FILLER                        PIC XXX.
  1433     12  AM-TEL-NO.
  1434         16  AM-AREA-CODE                  PIC 999.
  1435         16  AM-TEL-PRE                    PIC 999.
  1436         16  AM-TEL-NBR                    PIC 9(4).
  1437     12  AM-TEL-LOC                        PIC X.
  1438         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1439         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1440
  1441     12  AM-COMM-STRUCTURE.
  1442         16  AM-DEFN-1.
  1443             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1444                 24  AM-AGT.
  1445                     28  AM-AGT-PREFIX     PIC X(4).
  1446                     28  AM-AGT-PRIME      PIC X(6).
  1447                 24  AM-COM-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  28
* EL6311.cbl
  1448                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1449                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1450                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1451                 24  AM-RECALC-LV-INDIC    PIC X.
  1452                 24  AM-RETRO-LV-INDIC     PIC X.
  1453                 24  AM-GL-CODES           PIC X.
  1454                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1455                 24  FILLER                PIC X(01).
  1456         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1457             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1458                 24  FILLER                PIC X(11).
  1459                 24  AM-L-COMA             PIC XXX.
  1460                 24  AM-J-COMA             PIC XXX.
  1461                 24  AM-A-COMA             PIC XXX.
  1462                 24  FILLER                PIC X(6).
  1463
  1464     12  AM-COMM-CHANGE-STATUS             PIC X.
  1465         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1466
  1467     12  AM-CSR-CODE                       PIC X(4).
  1468
  1469     12  AM-BILLING-STATUS                 PIC X.
  1470         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1471         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1472     12  AM-AUTO-REFUND-SW                 PIC X.
  1473         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1474         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1475     12  AM-GPCD                           PIC 99.
  1476     12  AM-IG                             PIC X.
  1477         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1478         88  AM-HAS-GROUP                     VALUE '2'.
  1479     12  AM-STATUS                         PIC X.
  1480         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1481         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1482         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1483         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1484         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1485         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1486         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1487         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1488         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1489         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1490     12  AM-REMIT-TO                       PIC 99.
  1491     12  AM-ID-NO                          PIC X(11).
  1492
  1493     12  AM-CAL-TABLE                      PIC XX.
  1494     12  AM-LF-DEVIATION                   PIC XXX.
  1495     12  AM-AH-DEVIATION                   PIC XXX.
  1496     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1497     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1498     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1499     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1500     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1501     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1502
  1503     12  AM-USER-FIELDS.
  1504         16  AM-FLD-1                      PIC XX.
  1505         16  AM-FLD-2                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  29
* EL6311.cbl
  1506         16  AM-FLD-3                      PIC XX.
  1507         16  AM-FLD-4                      PIC XX.
  1508         16  AM-FLD-5                      PIC XX.
  1509
  1510     12  AM-1ST-PROD-DATE.
  1511         16  AM-1ST-PROD-YR                PIC XX.
  1512         16  AM-1ST-PROD-MO                PIC XX.
  1513         16  AM-1ST-PROD-DA                PIC XX.
  1514     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1515     12  AM-CERTS-PURGED-DATE.
  1516         16  AM-PUR-YR                     PIC XX.
  1517         16  AM-PUR-MO                     PIC XX.
  1518         16  AM-PUR-DA                     PIC XX.
  1519     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1520     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1521     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1522     12  AM-INACTIVE-DATE.
  1523         16  AM-INA-MO                     PIC 99.
  1524         16  AM-INA-DA                     PIC 99.
  1525         16  AM-INA-YR                     PIC 99.
  1526     12  AM-AR-HI-CERT-DATE                PIC XX.
  1527
  1528     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1529     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1530
  1531     12  AM-OB-PAYMENT-MODE                PIC X.
  1532         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1533         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1534         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1535         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1536
  1537     12  AM-AH-ONLY-INDICATOR              PIC X.
  1538         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1539         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1540
  1541     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1542
  1543     12  AM-OVER-SHORT.
  1544         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1545         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1546
  1547     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1548     12  AM-DCC-CLP-STATE                  PIC XX.
  1549
  1550     12  AM-RECALC-COMM                    PIC X.
  1551     12  AM-RECALC-REIN                    PIC X.
  1552
  1553     12  AM-REI-TABLE                      PIC XXX.
  1554     12  AM-REI-ET-LF                      PIC X.
  1555     12  AM-REI-ET-AH                      PIC X.
  1556     12  AM-REI-PE-LF                      PIC X.
  1557     12  AM-REI-PE-AH                      PIC X.
  1558     12  AM-REI-PRT-ST                     PIC X.
  1559     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1560     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1561     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1562     12  AM-REI-GROUP-A                    PIC X(6).
  1563     12  AM-REI-MORT                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  30
* EL6311.cbl
  1564     12  AM-REI-PRT-OW                     PIC X.
  1565     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1566     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1567     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1568     12  AM-REI-GROUP-B                    PIC X(6).
  1569
  1570     12  AM-TRUST-TYPE                     PIC X(2).
  1571
  1572     12  AM-EMPLOYER-STMT-USED             PIC X.
  1573     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1574
  1575     12  AM-STD-AH-TYPE                    PIC XX.
  1576     12  AM-EARN-METHODS.
  1577         16  AM-EARN-METHOD-R              PIC X.
  1578             88 AM-REF-RL-R78                 VALUE 'R'.
  1579             88 AM-REF-RL-PR                  VALUE 'P'.
  1580             88 AM-REF-RL-MEAN                VALUE 'M'.
  1581             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1582         16  AM-EARN-METHOD-L              PIC X.
  1583             88 AM-REF-LL-R78                 VALUE 'R'.
  1584             88 AM-REF-LL-PR                  VALUE 'P'.
  1585             88 AM-REF-LL-MEAN                VALUE 'M'.
  1586             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1587         16  AM-EARN-METHOD-A              PIC X.
  1588             88 AM-REF-AH-R78                 VALUE 'R'.
  1589             88 AM-REF-AH-PR                  VALUE 'P'.
  1590             88 AM-REF-AH-MEAN                VALUE 'M'.
  1591             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1592             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1593             88 AM-REF-AH-NET                 VALUE 'N'.
  1594
  1595     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1596     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1597     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1598
  1599     12  AM-RET-Y-N                        PIC X.
  1600     12  AM-RET-P-E                        PIC X.
  1601     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1602     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1603     12  AM-RET-GRP                        PIC X(6).
  1604     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1605         16  AM-POOL-PRIME                 PIC XXX.
  1606         16  AM-POOL-SUB                   PIC XXX.
  1607     12  AM-RETRO-EARNINGS.
  1608         16  AM-RET-EARN-R                 PIC X.
  1609         16  AM-RET-EARN-L                 PIC X.
  1610         16  AM-RET-EARN-A                 PIC X.
  1611     12  AM-RET-ST-TAX-USE                 PIC X.
  1612         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1613         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1614     12  AM-RETRO-BEG-EARNINGS.
  1615         16  AM-RET-BEG-EARN-R             PIC X.
  1616         16  AM-RET-BEG-EARN-L             PIC X.
  1617         16  AM-RET-BEG-EARN-A             PIC X.
  1618     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1619     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1620
  1621     12  AM-USER-SELECT-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  31
* EL6311.cbl
  1622         16  AM-USER-SELECT-1              PIC X(10).
  1623         16  AM-USER-SELECT-2              PIC X(10).
  1624         16  AM-USER-SELECT-3              PIC X(10).
  1625         16  AM-USER-SELECT-4              PIC X(10).
  1626         16  AM-USER-SELECT-5              PIC X(10).
  1627
  1628     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1629
  1630     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1631
  1632     12  AM-RPT045A-SWITCH                 PIC X.
  1633         88  RPT045A-OFF                   VALUE 'N'.
  1634
  1635     12  AM-INSURANCE-LIMITS.
  1636         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1637         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1638
  1639     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1640         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1641
  1642     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1643         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1644         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1645
  1646     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1647
  1648     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1649     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1650     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1651     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1652     12  AM-DCC-UEF-STATE                  PIC XX.
  1653     12  FILLER                            PIC XXX.
  1654     12  AM-REPORT-CODE-3                  PIC X(10).
  1655*    12  FILLER                            PIC X(22).
  1656
  1657     12  AM-RESERVE-DATE.
  1658         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1659         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1660         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1661
  1662     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1663     12  AM-NOTIFICATION-TYPES.
  1664         16  AM-NOTIF-OF-LETTERS           PIC X.
  1665         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1666         16  AM-NOTIF-OF-REPORTS           PIC X.
  1667         16  AM-NOTIF-OF-STATUS            PIC X.
  1668
  1669     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1670         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1671         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1672         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1673         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1674
  1675     12  AM-BENEFIT-CONTROLS.
  1676         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1677             20  AM-BENEFIT-CODE           PIC XX.
  1678             20  AM-BENEFIT-TYPE           PIC X.
  1679             20  AM-BENEFIT-REVISION       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  32
* EL6311.cbl
  1680             20  AM-BENEFIT-REM-TERM       PIC X.
  1681             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1682             20  FILLER                    PIC XX.
  1683         16  FILLER                        PIC X(80).
  1684
  1685     12  AM-TRANSFER-DATA.
  1686         16  AM-TRANSFERRED-FROM.
  1687             20  AM-TRNFROM-CARRIER        PIC X.
  1688             20  AM-TRNFROM-GROUPING.
  1689                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1690                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1691             20  AM-TRNFROM-STATE          PIC XX.
  1692             20  AM-TRNFROM-ACCOUNT.
  1693                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1694                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1695             20  AM-TRNFROM-DTE            PIC XX.
  1696         16  AM-TRANSFERRED-TO.
  1697             20  AM-TRNTO-CARRIER          PIC X.
  1698             20  AM-TRNTO-GROUPING.
  1699                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1700                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1701             20  AM-TRNTO-STATE            PIC XX.
  1702             20  AM-TRNTO-ACCOUNT.
  1703                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1704                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1705             20  AM-TRNTO-DTE              PIC XX.
  1706         16  FILLER                        PIC X(10).
  1707
  1708     12  AM-SAVED-REMIT-TO                 PIC 99.
  1709
  1710     12  AM-COMM-STRUCTURE-SAVED.
  1711         16  AM-DEFN-1-SAVED.
  1712             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1713                 24  AM-AGT-SV             PIC X(10).
  1714                 24  AM-COM-TYP-SV         PIC X.
  1715                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1716                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1717                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1718                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1719                 24  FILLER                PIC X.
  1720                 24  AM-GL-CODES-SV        PIC X.
  1721                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1722                 24  FILLER                PIC X.
  1723         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1724             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1725                 24  FILLER                PIC X(11).
  1726                 24  AM-L-COMA-SV          PIC XXX.
  1727                 24  AM-J-COMA-SV          PIC XXX.
  1728                 24  AM-A-COMA-SV          PIC XXX.
  1729                 24  FILLER                PIC X(6).
  1730
  1731     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1732         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1733            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1734            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1735            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1736
  1737     12  AM-ORIG-DEALER-NO                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  33
* EL6311.cbl
  1738     12  FILLER                            PIC X(120).
  1739
  1740     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1741         16  AM-CONTROL-NAME               PIC X(30).
  1742         16  AM-EXECUTIVE-ONE.
  1743             20  AM-EXEC1-NAME             PIC X(15).
  1744             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1745                                                          COMP-3.
  1746             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1747                                                          COMP-3.
  1748         16  AM-EXECUTIVE-TWO.
  1749             20  AM-EXEC2-NAME             PIC X(15).
  1750             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1751                                                          COMP-3.
  1752             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1753                                                          COMP-3.
  1754
  1755     12  AM-RETRO-ADDITIONAL-DATA.
  1756         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1757         16  AM-RETRO-PREM-P-E             PIC X.
  1758         16  AM-RETRO-CLMS-P-I             PIC X.
  1759         16  AM-RETRO-RET-BRACKET-LF.
  1760             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1761                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1762                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1763             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1764                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1765                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1766             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1767                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1768                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1769         16  AM-RETRO-RET-BRACKET-AH.
  1770             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1771                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1772                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1773                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1774             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1775                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1776                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1777             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1778                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1779                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1780
  1781     12  AM-COMMENTS.
  1782         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1783
  1784     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1785         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1786         16  AM-FLI-BILLING-CODE           PIC X.
  1787         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1788         16  AM-FLI-UNITED-IDENT           PIC X.
  1789         16  AM-FLI-INTEREST-LOST-DATA.
  1790             20  AM-FLI-BANK-NO            PIC X(5).
  1791             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1792             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1793             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1794         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1795             20  AM-FLI-AGT                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  34
* EL6311.cbl
  1796             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1797             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1798         16  FILLER                        PIC X(102).
  1799
  1800     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1801         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1802             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1803             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1804             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1805             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1806             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1807         16  FILLER                          PIC X(10).
  1808******************************************************************
  1809*                                COPY ELCVADS.
  1810******************************************************************
  1811*                                                                *
  1812*                                                                *
  1813*                            ELCVADS.                            *
  1814*                                                                *
  1815*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1816*   ELVADS                  LENGTH = 350                         *
  1817******************************************************************
  1818******************************************************************
  1819*                   C H A N G E   L O G
  1820*
  1821* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1822*-----------------------------------------------------------------
  1823*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1824* EFFECTIVE    NUMBER
  1825*-----------------------------------------------------------------
  1826* 100111    2011022800001  AJRA  NAPERSOFT
  1827******************************************************************
  1828
  1829 01  VIRGINIA-DISCLOSURE.
  1830     12  VD-COMPANY-CD              PIC X.
  1831     12  VD-CARRIER                 PIC X.
  1832     12  VD-GROUPING.
  1833         20  VD-GROUPING-PREFIX     PIC XXX.
  1834         20  VD-GROUPING-PRIME      PIC XXX.
  1835     12  VD-STATE                   PIC XX.
  1836     12  VD-ACCOUNT.
  1837         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1838         20  VD-ACCOUNT-PRIME       PIC X(6).
  1839     12  VD-CERT-EFF-DT             PIC XX.
  1840     12  VD-CERT-NO.
  1841         20  VD-CERT-PRIME          PIC X(10).
  1842         20  VD-CERT-SFX            PIC X.
  1843     12  VD-ENTRY-BATCH             PIC X(6).
  1844     12  VD-CSR-ID                  PIC X(4).
  1845     12  VD-NAME.
  1846         20  VD-INSURED-LAST-NAME   PIC X(15).
  1847         20  VD-INSURED-FIRST-NAME.
  1848             24  VD-INSURED-1ST-INIT PIC X.
  1849             24  FILLER             PIC X(9).
  1850         20  VD-INSURED-MIDDLE-INIT PIC X.
  1851     12  VD-JOINT-INSURED.
  1852         20 VD-JOINT-LAST-NAME      PIC X(15).
  1853         20 VD-JOINT-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  35
* EL6311.cbl
  1854            24  VD-JOINT-FIRST-INIT PIC X.
  1855            24  FILLER              PIC X(9).
  1856         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1857     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1858     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1859     12  VD-INSURED-CITY-STATE.
  1860         20  VD-INSURED-CITY        PIC X(28).
  1861         20  VD-INSURED-STATE       PIC XX.
  1862     12  VD-INSURED-ZIP-CODE.
  1863         20  VD-INSURED-ZIP-PRIME.
  1864             24  VD-INSURED-ZIP-1   PIC X.
  1865                 88  VD-CANADIAN-POST-CODE
  1866                                       VALUE 'A' THRU 'Z'.
  1867             24  FILLER             PIC X(4).
  1868         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1869     12  VD-BENEFICIARY-NAME        PIC X(30).
  1870     12  VD-ACCOUNT-NAME            PIC X(30).
  1871     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1872     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1873     12  VD-1ST-PMT-DT              PIC XX.
  1874     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1875         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1876         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1877                                             '90' THRU '99'.
  1878     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1879                                    PIC XX.
  1880     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1881     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1882     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1883     12  VD-LF-TERM                 PIC S999   COMP-3.
  1884     12  VD-AH-BENEFIT-CD           PIC XX.
  1885         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1886         88  VD-INVALID-AH             VALUE '  ' '00'
  1887                                             '90' THRU '99'.
  1888     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1889     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1890     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1891     12  VD-AH-TERM                 PIC S999   COMP-3.
  1892     12  VD-LETTER-ID               PIC X(4).
  1893     12  VD-PROC-ID                 PIC X(4).
  1894     12  VD-COMP-ID                 PIC X(3).
  1895     12  VD-CURRENT-DATE            PIC XX.
  1896     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1897     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1898     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  36
* EL6311.cbl
  1900*    COPY ELCDATE.
  1901******************************************************************
  1902*                                                                *
  1903*                                                                *
  1904*                            ELCDATE.                            *
  1905*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1906*                            VMOD=2.003
  1907*                                                                *
  1908*                                                                *
  1909*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1910*                 LENGTH = 200                                   *
  1911******************************************************************
  1912
  1913 01  DATE-CONVERSION-DATA.
  1914     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1915     12  DC-OPTION-CODE                PIC X.
  1916         88  BIN-TO-GREG                VALUE ' '.
  1917         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1918         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1919         88  YMD-GREG-TO-BIN            VALUE '3'.
  1920         88  MDY-GREG-TO-BIN            VALUE '4'.
  1921         88  JULIAN-TO-BIN              VALUE '5'.
  1922         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1923         88  FIND-CENTURY               VALUE '7'.
  1924         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1925         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1926         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1927         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1928         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1929         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1930         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1931         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1932         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1933         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1934         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1935         88  BIN-3-TO-GREG              VALUE 'I'.
  1936         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1937         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1938         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1939         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1940         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1941         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1942         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1943         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1944         88  THREE-CHARACTER-BIN
  1945                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1946         88  GREGORIAN-TO-BIN
  1947                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1948         88  BIN-TO-GREGORIAN
  1949                  VALUES ' ' '1' 'I' '8' 'G'.
  1950         88  JULIAN-TO-BINARY
  1951                  VALUES '5' 'C' 'E' 'F'.
  1952     12  DC-ERROR-CODE                 PIC X.
  1953         88  NO-CONVERSION-ERROR        VALUE ' '.
  1954         88  DATE-CONVERSION-ERROR
  1955                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1956         88  DATE-IS-ZERO               VALUE '1'.
  1957         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  37
* EL6311.cbl
  1958         88  DATE-IS-INVALID            VALUE '3'.
  1959         88  DATE1-GREATER-DATE2        VALUE '4'.
  1960         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1961         88  DATE-INVALID-OPTION        VALUE '9'.
  1962         88  INVALID-CENTURY            VALUE 'A'.
  1963         88  ONLY-CENTURY               VALUE 'B'.
  1964         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1965         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1966     12  DC-END-OF-MONTH               PIC X.
  1967         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1968     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1969         88  USE-NORMAL-PROCESS         VALUE ' '.
  1970         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1971         88  ADJUST-UP-100-YRS          VALUE '2'.
  1972     12  FILLER                        PIC X.
  1973     12  DC-CONVERSION-DATES.
  1974         16  DC-BIN-DATE-1             PIC XX.
  1975         16  DC-BIN-DATE-2             PIC XX.
  1976         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1977         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1978                       DC-GREG-DATE-1-EDIT.
  1979             20  DC-EDIT1-MONTH        PIC 99.
  1980             20  SLASH1-1              PIC X.
  1981             20  DC-EDIT1-DAY          PIC 99.
  1982             20  SLASH1-2              PIC X.
  1983             20  DC-EDIT1-YEAR         PIC 99.
  1984         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1985         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1986                     DC-GREG-DATE-2-EDIT.
  1987             20  DC-EDIT2-MONTH        PIC 99.
  1988             20  SLASH2-1              PIC X.
  1989             20  DC-EDIT2-DAY          PIC 99.
  1990             20  SLASH2-2              PIC X.
  1991             20  DC-EDIT2-YEAR         PIC 99.
  1992         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1993         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1994                     DC-GREG-DATE-1-YMD.
  1995             20  DC-YMD-YEAR           PIC 99.
  1996             20  DC-YMD-MONTH          PIC 99.
  1997             20  DC-YMD-DAY            PIC 99.
  1998         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1999         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2000                      DC-GREG-DATE-1-MDY.
  2001             20  DC-MDY-MONTH          PIC 99.
  2002             20  DC-MDY-DAY            PIC 99.
  2003             20  DC-MDY-YEAR           PIC 99.
  2004         16  DC-GREG-DATE-1-ALPHA.
  2005             20  DC-ALPHA-MONTH        PIC X(10).
  2006             20  DC-ALPHA-DAY          PIC 99.
  2007             20  FILLER                PIC XX.
  2008             20  DC-ALPHA-CENTURY.
  2009                 24 DC-ALPHA-CEN-N     PIC 99.
  2010             20  DC-ALPHA-YEAR         PIC 99.
  2011         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2012         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2013         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2014         16  DC-JULIAN-DATE            PIC 9(05).
  2015         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  38
* EL6311.cbl
  2016                                       PIC 9(05).
  2017         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2018             20  DC-JULIAN-YEAR        PIC 99.
  2019             20  DC-JULIAN-DAYS        PIC 999.
  2020         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2021         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2022         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2023     12  DATE-CONVERSION-VARIBLES.
  2024         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2025         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2026             20  FILLER                PIC 9(3).
  2027             20  HOLD-CEN-1-CCYY.
  2028                 24  HOLD-CEN-1-CC     PIC 99.
  2029                 24  HOLD-CEN-1-YY     PIC 99.
  2030             20  HOLD-CEN-1-MO         PIC 99.
  2031             20  HOLD-CEN-1-DA         PIC 99.
  2032         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2033             20  HOLD-CEN-1-R-MO       PIC 99.
  2034             20  HOLD-CEN-1-R-DA       PIC 99.
  2035             20  HOLD-CEN-1-R-CCYY.
  2036                 24  HOLD-CEN-1-R-CC   PIC 99.
  2037                 24  HOLD-CEN-1-R-YY   PIC 99.
  2038             20  FILLER                PIC 9(3).
  2039         16  HOLD-CENTURY-1-X.
  2040             20  FILLER                PIC X(3)  VALUE SPACES.
  2041             20  HOLD-CEN-1-X-CCYY.
  2042                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2043                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2044             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2045             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2046         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2047             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2048             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2049             20  HOLD-CEN-1-R-X-CCYY.
  2050                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2051                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2052             20  FILLER                PIC XXX.
  2053         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2054         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2055         16  DC-JULIAN-DATE-1          PIC 9(07).
  2056         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2057             20  DC-JULIAN-1-CCYY.
  2058                 24  DC-JULIAN-1-CC    PIC 99.
  2059                 24  DC-JULIAN-1-YR    PIC 99.
  2060             20  DC-JULIAN-DA-1        PIC 999.
  2061         16  DC-JULIAN-DATE-2          PIC 9(07).
  2062         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2063             20  DC-JULIAN-2-CCYY.
  2064                 24  DC-JULIAN-2-CC    PIC 99.
  2065                 24  DC-JULIAN-2-YR    PIC 99.
  2066             20  DC-JULIAN-DA-2        PIC 999.
  2067         16  DC-GREG-DATE-A-EDIT.
  2068             20  DC-EDITA-MONTH        PIC 99.
  2069             20  SLASHA-1              PIC X VALUE '/'.
  2070             20  DC-EDITA-DAY          PIC 99.
  2071             20  SLASHA-2              PIC X VALUE '/'.
  2072             20  DC-EDITA-CCYY.
  2073                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  39
* EL6311.cbl
  2074                 24  DC-EDITA-YEAR     PIC 99.
  2075         16  DC-GREG-DATE-B-EDIT.
  2076             20  DC-EDITB-MONTH        PIC 99.
  2077             20  SLASHB-1              PIC X VALUE '/'.
  2078             20  DC-EDITB-DAY          PIC 99.
  2079             20  SLASHB-2              PIC X VALUE '/'.
  2080             20  DC-EDITB-CCYY.
  2081                 24  DC-EDITB-CENT     PIC 99.
  2082                 24  DC-EDITB-YEAR     PIC 99.
  2083         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2084         16  DC-GREG-DATE-CYMD-R REDEFINES
  2085                              DC-GREG-DATE-CYMD.
  2086             20  DC-CYMD-CEN           PIC 99.
  2087             20  DC-CYMD-YEAR          PIC 99.
  2088             20  DC-CYMD-MONTH         PIC 99.
  2089             20  DC-CYMD-DAY           PIC 99.
  2090         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2091         16  DC-GREG-DATE-MDCY-R REDEFINES
  2092                              DC-GREG-DATE-MDCY.
  2093             20  DC-MDCY-MONTH         PIC 99.
  2094             20  DC-MDCY-DAY           PIC 99.
  2095             20  DC-MDCY-CEN           PIC 99.
  2096             20  DC-MDCY-YEAR          PIC 99.
  2097    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2098        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2099    12  DC-EL310-DATE                  PIC X(21).
  2100    12  FILLER                         PIC X(28).
  2101
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  40
* EL6311.cbl
  2103*    COPY ELCLOGOF.
  2104******************************************************************
  2105*                                                                *
  2106*                                                                *
  2107*                            ELCLOGOF.                           *
  2108*                            VMOD=2.001                          *
  2109*                                                                *
  2110*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2111*                                                                *
  2112******************************************************************
  2113 01  CLASIC-LOGOFF.
  2114     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2115     12  LOGOFF-TEXT.
  2116         16  FILLER          PIC X(5)    VALUE SPACES.
  2117         16  LOGOFF-MSG.
  2118             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2119             20  FILLER      PIC X       VALUE SPACES.
  2120             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2121         16  FILLER          PIC X(80)
  2122           VALUE '* YOU ARE NOW LOGGED OFF'.
  2123         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2124         16  FILLER          PIC X       VALUE QUOTE.
  2125         16  LOGOFF-SYS-MSG  PIC X(17)
  2126           VALUE 'S CLAS-IC SYSTEM '.
  2127     12  TEXT-MESSAGES.
  2128         16  UNACCESS-MSG    PIC X(29)
  2129             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2130         16  PGMIDERR-MSG    PIC X(17)
  2131             VALUE 'PROGRAM NOT FOUND'.
  2132
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  41
* EL6311.cbl
  2134*    COPY ELCATTR.
  2135******************************************************************
  2136*                                                                *
  2137*                            ELCATTR.                            *
  2138*                            VMOD=2.001                          *
  2139*                                                                *
  2140*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2141*                                                                *
  2142*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2143*                                                                *
  2144*                   POS 1   P=PROTECTED                          *
  2145*                           U=UNPROTECTED                        *
  2146*                           S=ASKIP                              *
  2147*                   POS 2   A=ALPHA/NUMERIC                      *
  2148*                           N=NUMERIC                            *
  2149*                   POS 3   N=NORMAL                             *
  2150*                           B=BRIGHT                             *
  2151*                           D=DARK                               *
  2152*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2153*                           OF=MODIFIED DATA TAG OFF             *
  2154*                                                                *
  2155*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2156******************************************************************
  2157 01  ATTRIBUTE-LIST.
  2158     12  AL-PABOF            PIC X       VALUE 'Y'.
  2159     12  AL-PABON            PIC X       VALUE 'Z'.
  2160     12  AL-PADOF            PIC X       VALUE '%'.
  2161     12  AL-PADON            PIC X       VALUE '_'.
  2162     12  AL-PANOF            PIC X       VALUE '-'.
  2163     12  AL-PANON            PIC X       VALUE '/'.
  2164     12  AL-SABOF            PIC X       VALUE '8'.
  2165     12  AL-SABON            PIC X       VALUE '9'.
  2166     12  AL-SADOF            PIC X       VALUE '@'.
  2167     12  AL-SADON            PIC X       VALUE QUOTE.
  2168     12  AL-SANOF            PIC X       VALUE '0'.
  2169     12  AL-SANON            PIC X       VALUE '1'.
  2170     12  AL-UABOF            PIC X       VALUE 'H'.
  2171     12  AL-UABON            PIC X       VALUE 'I'.
  2172     12  AL-UADOF            PIC X       VALUE '<'.
  2173     12  AL-UADON            PIC X       VALUE '('.
  2174     12  AL-UANOF            PIC X       VALUE ' '.
  2175     12  AL-UANON            PIC X       VALUE 'A'.
  2176     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2177     12  AL-UNBON            PIC X       VALUE 'R'.
  2178     12  AL-UNDOF            PIC X       VALUE '*'.
  2179     12  AL-UNDON            PIC X       VALUE ')'.
  2180     12  AL-UNNOF            PIC X       VALUE '&'.
  2181     12  AL-UNNON            PIC X       VALUE 'J'.
  2182
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  42
* EL6311.cbl
  2184*    COPY ELCEMIB.
  2185******************************************************************
  2186*                                                                *
  2187*                                                                *
  2188*                            ELCEMIB.                            *
  2189*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2190*                            VMOD=2.005                          *
  2191*                                                                *
  2192*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2193*                                                                *
  2194******************************************************************
  2195 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2196     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2197     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2198     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2199     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2200     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2201     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2202     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2203     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2204     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2205         88  EMI-NO-ERRORS                    VALUE '1'.
  2206         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2207         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2208     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2209         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2210     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2211         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2212         88  EMI-AREA1-FULL                   VALUE '2'.
  2213     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2214         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2215         88  EMI-AREA2-FULL                   VALUE '2'.
  2216     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2217         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2218         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2219         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2220         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2221         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2222     12  EMI-ERROR-LINES.
  2223         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2224         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2225         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2226         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2227             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2228                 24  EMI-ERR-NUM         PIC X(4).
  2229                 24  EMI-FILLER          PIC X.
  2230                 24  EMI-SEV             PIC X.
  2231                 24  FILLER              PIC X.
  2232             20  FILLER                  PIC X(02).
  2233     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2234         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2235             20  EMI-ERROR-NUMBER    PIC X(4).
  2236             20  EMI-FILL            PIC X.
  2237             20  EMI-SEVERITY        PIC X.
  2238             20  FILLER              PIC X.
  2239             20  EMI-ERROR-TEXT.
  2240                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2241                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  43
* EL6311.cbl
  2242     12  EMI-SEVERITY-SAVE           PIC X.
  2243         88  EMI-NOTE                    VALUE 'N'.
  2244         88  EMI-WARNING                 VALUE 'W'.
  2245         88  EMI-FORCABLE                VALUE 'F'.
  2246         88  EMI-FATAL                   VALUE 'X'.
  2247     12  EMI-MESSAGE-FLAG            PIC X.
  2248         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2249         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2250     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2251     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2252         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2253         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2254         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2255     12  emi-claim-no                pic x(7).
  2256     12  emi-claim-type              pic x(6).
  2257     12  FILLER                      PIC X(124)  VALUE SPACES.
  2258     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2259     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2260     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2261     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2262
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  44
* EL6311.cbl
  2264*    COPY ELCINTF.
  2265******************************************************************
  2266*                                                                *
  2267*                                                                *
  2268*                            ELCINTF.                            *
  2269*                            VMOD=2.017                          *
  2270*                                                                *
  2271*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2272*                                                                *
  2273*       LENGTH = 1024                                            *
  2274*                                                                *
  2275******************************************************************
  2276*                   C H A N G E   L O G
  2277*
  2278* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2279*-----------------------------------------------------------------
  2280*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2281* EFFECTIVE    NUMBER
  2282*-----------------------------------------------------------------
  2283* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2284******************************************************************
  2285 01  PROGRAM-INTERFACE-BLOCK.
  2286     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2287     12  PI-CALLING-PROGRAM              PIC X(8).
  2288     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2289     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2290     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2291     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2292     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2293     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2294     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2295     12  PI-COMPANY-ID                   PIC XXX.
  2296     12  PI-COMPANY-CD                   PIC X.
  2297
  2298     12  PI-COMPANY-PASSWORD             PIC X(8).
  2299
  2300     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2301
  2302     12  PI-CONTROL-IN-PROGRESS.
  2303         16  PI-CARRIER                  PIC X.
  2304         16  PI-GROUPING                 PIC X(6).
  2305         16  PI-STATE                    PIC XX.
  2306         16  PI-ACCOUNT                  PIC X(10).
  2307         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2308                                         PIC X(10).
  2309         16  PI-CLAIM-CERT-GRP.
  2310             20  PI-CLAIM-NO             PIC X(7).
  2311             20  PI-CERT-NO.
  2312                 25  PI-CERT-PRIME       PIC X(10).
  2313                 25  PI-CERT-SFX         PIC X.
  2314             20  PI-CERT-EFF-DT          PIC XX.
  2315         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2316             20  PI-PLAN-CODE            PIC X(2).
  2317             20  PI-REVISION-NUMBER      PIC X(3).
  2318             20  PI-PLAN-EFF-DT          PIC X(2).
  2319             20  PI-PLAN-EXP-DT          PIC X(2).
  2320             20  FILLER                  PIC X(11).
  2321         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  45
* EL6311.cbl
  2322             20  PI-OE-REFERENCE-1.
  2323                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2324                 25  PI-OE-REF-1-SUFF    PIC XX.
  2325
  2326     12  PI-SESSION-IN-PROGRESS          PIC X.
  2327         88  CLAIM-SESSION                   VALUE '1'.
  2328         88  CREDIT-SESSION                  VALUE '2'.
  2329         88  WARRANTY-SESSION                VALUE '3'.
  2330         88  MORTGAGE-SESSION                VALUE '4'.
  2331         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2332
  2333
  2334*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2335
  2336     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2337     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2338
  2339     12  PI-CREDIT-USER                  PIC X.
  2340         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2341         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2342
  2343     12  PI-CLAIM-USER                   PIC X.
  2344         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2345         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2346
  2347     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2348         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2349         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2350         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2351         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2352         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2353
  2354     12  PI-PROCESSOR-ID                 PIC X(4).
  2355
  2356     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2357
  2358     12  PI-MEMBER-CAPTION               PIC X(10).
  2359
  2360     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2361         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2362
  2363     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2364     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2365     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2366     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2367
  2368     12  PI-AH-OVERRIDE-L1               PIC X.
  2369     12  PI-AH-OVERRIDE-L2               PIC XX.
  2370     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2371     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2372
  2373     12  PI-NEW-SYSTEM                   PIC X(2).
  2374
  2375     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2376     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2377         88  PI-USES-PAID-TO                 VALUE '1'.
  2378     12  PI-CRDTCRD-SYSTEM.
  2379         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  46
* EL6311.cbl
  2380             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2381             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2382         16  PI-CC-MONTH-END-DT          PIC XX.
  2383     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2384
  2385     12  PI-OE-REFERENCE-2.
  2386         16  PI-OE-REF-2-PRIME           PIC X(10).
  2387         16  PI-OE-REF-2-SUFF            PIC X.
  2388
  2389     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2390
  2391     12  PI-LANGUAGE-TYPE                PIC X.
  2392             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2393             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2394             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2395
  2396     12  PI-POLICY-LINKAGE-IND           PIC X.
  2397         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2398         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2399                                                   LOW-VALUES.
  2400
  2401     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2402     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2403         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2404         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2405
  2406     12  PI-PROCESSOR-CSR-IND            PIC X.
  2407         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2408         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2409
  2410     12  FILLER                          PIC X(3).
  2411
  2412     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2413
  2414     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2415         PI-SYSTEM-LEVEL.
  2416
  2417         16  PI-ENTRY-CODES.
  2418             20  PI-ENTRY-CD-1           PIC X.
  2419             20  PI-ENTRY-CD-2           PIC X.
  2420
  2421         16  PI-RETURN-CODES.
  2422             20  PI-RETURN-CD-1          PIC X.
  2423             20  PI-RETURN-CD-2          PIC X.
  2424
  2425         16  PI-UPDATE-STATUS-SAVE.
  2426             20  PI-UPDATE-BY            PIC X(4).
  2427             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2428
  2429         16  PI-LOWER-CASE-LETTERS       PIC X.
  2430             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2431
  2432*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2433*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2434*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2435
  2436         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2437             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  47
* EL6311.cbl
  2438             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2439             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2440             88  ACCNT-CNTL                  VALUE '3'.
  2441             88  CARR-ACCNT-CNTL             VALUE '4'.
  2442
  2443         16  PI-PROCESSOR-CAP-LIST.
  2444             20  PI-SYSTEM-CONTROLS.
  2445                24 PI-SYSTEM-DISPLAY     PIC X.
  2446                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2447                24 PI-SYSTEM-MODIFY      PIC X.
  2448                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2449             20  FILLER                  PIC XX.
  2450             20  PI-DISPLAY-CAP          PIC X.
  2451                 88  DISPLAY-CAP             VALUE 'Y'.
  2452             20  PI-MODIFY-CAP           PIC X.
  2453                 88  MODIFY-CAP              VALUE 'Y'.
  2454             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2455                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2456             20  PI-FORCE-CAP            PIC X.
  2457                 88  FORCE-CAP               VALUE 'Y'.
  2458
  2459         16  PI-PROGRAM-CONTROLS.
  2460             20  PI-PGM-PRINT-OPT        PIC X.
  2461             20  PI-PGM-FORMAT-OPT       PIC X.
  2462             20  PI-PGM-PROCESS-OPT      PIC X.
  2463             20  PI-PGM-TOTALS-OPT       PIC X.
  2464
  2465         16  PI-HELP-INTERFACE.
  2466             20  PI-LAST-ERROR-NO        PIC X(4).
  2467             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2468
  2469         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2470             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2471
  2472         16  PI-CR-CONTROL-IN-PROGRESS.
  2473             20  PI-CR-CARRIER           PIC X.
  2474             20  PI-CR-GROUPING          PIC X(6).
  2475             20  PI-CR-STATE             PIC XX.
  2476             20  PI-CR-ACCOUNT           PIC X(10).
  2477             20  PI-CR-FIN-RESP          PIC X(10).
  2478             20  PI-CR-TYPE              PIC X.
  2479
  2480         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2481
  2482         16  PI-CR-MONTH-END-DT          PIC XX.
  2483
  2484         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2485             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2486             88  PI-ZERO-CARRIER             VALUE '1'.
  2487             88  PI-ZERO-GROUPING            VALUE '2'.
  2488             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2489
  2490         16  PI-CARRIER-SECURITY         PIC X.
  2491             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2492
  2493         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2494             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2495             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  48
* EL6311.cbl
  2496
  2497         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2498             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2499                                         INDEXED BY PI-ACCESS-NDX
  2500                                         PIC X.
  2501
  2502         16  PI-GA-BILLING-CONTROL       PIC X.
  2503             88  PI-GA-BILLING               VALUE '1'.
  2504
  2505         16  PI-MAIL-PROCESSING          PIC X.
  2506             88  PI-MAIL-YES                 VALUE 'Y'.
  2507
  2508         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2509
  2510         16  PI-AR-SYSTEM.
  2511             20  PI-AR-PROCESSING-CNTL   PIC X.
  2512                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2513             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2514             20  PI-AR-MONTH-END-DT      PIC XX.
  2515
  2516         16  PI-MP-SYSTEM.
  2517             20  PI-MORTGAGE-USER            PIC X.
  2518                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2519                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2520             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2521                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2522                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2523                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2524                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2525                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2526             20  PI-MP-MONTH-END-DT          PIC XX.
  2527             20  PI-MP-REFERENCE-NO.
  2528                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2529                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2530
  2531         16  PI-LABEL-CONTROL            PIC X(01).
  2532             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2533             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2534
  2535         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2536             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2537
  2538         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2539             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2540             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2541
  2542         16  FILLER                      PIC X(14).
  2543
  2544     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2545******************************************************************
  2546
  2547     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2548*    COPY ELC631PI.
  2549******************************************************************
  2550*                                                                *
  2551*                                                                *
  2552*                            ELC631PI                            *
  2553*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  49
* EL6311.cbl
  2554*                                                                *
  2555*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2556*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2557*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2558*                                                                *
  2559*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2560*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2561*    BETWEEN PROGRAMS.                                           *
  2562*                                                                *
  2563*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2564*                                                                *
  2565*               EL631 - EL6311 - EL6312 - EL6313                 *
  2566*                                                                *
  2567******************************************************************
  2568*                   C H A N G E   L O G
  2569*
  2570* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2571*-----------------------------------------------------------------
  2572*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2573* EFFECTIVE    NUMBER
  2574*-----------------------------------------------------------------
  2575* 021414    2003053000001  PEMA  changes for auto chk request
  2576******************************************************************
  2577
  2578         16  PI-631-DATA.
  2579             20  PI-ERPNDB-KEY.
  2580                 24  PI-PB-COMPANY-CD     PIC X.
  2581                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2582                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2583                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2584
  2585             20  PI-ERPNDB-ALT-KEY.
  2586                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2587                 24  PI-PB-CARRIER        PIC X.
  2588                 24  PI-PB-GROUPING       PIC X(6).
  2589                 24  PI-PB-STATE          PIC XX.
  2590                 24  PI-PB-ACCOUNT        PIC X(10).
  2591                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2592                 24  PI-PB-CERT-NO.
  2593                     28  PI-PB-CERT-PRIME PIC X(10).
  2594                     28  PI-PB-CERT-SFX   PIC X.
  2595                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2596                 24  PI-PB-RECORD-TYPE    PIC X.
  2597
  2598             20  PI-ERPNDB-CSR-KEY.
  2599                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2600                 24  PI-PB-CSR-ID             PIC X(4).
  2601                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2602                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2603                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2604
  2605             20  PI-BROWSE-TYPE               PIC X.
  2606                 88  PI-FILE-BROWSE             VALUE ' '.
  2607                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2608                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2609                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2610                 88  PI-CSR-BROWSE              VALUE '4'.
  2611
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  50
* EL6311.cbl
  2612             20  PI-MAINT-FUNCTION            PIC X.
  2613                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2614                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2615                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2616                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2617                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2618                 88  PI-PF5-FUNCTION            VALUE '5'.
  2619                 88  PI-PF6-FUNCTION            VALUE '6'.
  2620
  2621             20  PI-FILE-SWITCHES.
  2622                 24  PI-ALL-ISSUES-SW         PIC X.
  2623                     88  ALL-ISSUES             VALUE 'Y'.
  2624                 24  PI-ALL-CANCELS-SW        PIC X.
  2625                     88  ALL-CANCELS            VALUE 'Y'.
  2626                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2627                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2628                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2629                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2630                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2631                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2632                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2633                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2634                 24  PI-HOLD-REC-SW           PIC X.
  2635                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2636                 24  PI-CHANGE-REC-SW         PIC X.
  2637                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2638                 24  PI-CHK-REQ-REC-SW        PIC X.
  2639                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2640                 24  PI-ISSUE-WARNING-SW      PIC X.
  2641                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2642                 24  PI-CANCEL-WARNING-SW     PIC X.
  2643                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2644             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2645                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2646             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2647                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2648
  2649             20  PI-MAP-NAME                  PIC X(8).
  2650
  2651             20  PI-CURSOR                    PIC S9(4) COMP.
  2652
  2653             20  PI-PREV-ALT-KEY              PIC X(36).
  2654             20  PI-PREV-CSR-KEY              PIC X(15).
  2655             20  PI-PREV-KEY.
  2656                 24  PI-PREV-COMPANY-CD       PIC X.
  2657                 24  PI-PREV-BATCH            PIC X(6).
  2658                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2659                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2660             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2661             20  PI-BROWSE-SW                 PIC X.
  2662                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2663                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2664             20  PI-SV-CARRIER                PIC X.
  2665             20  PI-SV-GROUPING               PIC X(6).
  2666             20  PI-SV-STATE                  PIC XX.
  2667             20  PI-EDIT-SW                   PIC X.
  2668             20  PI-DISPLAY-SW                PIC XX.
  2669                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  51
* EL6311.cbl
  2670                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2671             20  PI-CRITERIA-DATA             PIC X(350).
  2672             20  PI-BMODE                     PIC X.
  2673             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2674             20  PI-BPMTS                     PIC S999     COMP-3.
  2675             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2676             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2677             20  PI-CSR-SESSION-SW            PIC X.
  2678                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2679             20  PI-ERRORS-SW                 PIC X.
  2680                 88  FATAL-ERRORS               VALUE 'X'.
  2681*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2682             20  pi-unforced-sw               pic x.
  2683                 88  unforced-errors            value 'X'.
  2684             20  FILLER                       PIC X(4).
  2685
  2686        16  FILLER             PIC X(94).
  2687
  2688 01  W-LETTER-COMMUNICATION-AREAS.
  2689*    COPY ELC1042.
  2690******************************************************************
  2691*                                                                *
  2692*                                                                *
  2693*                           ELC1042                              *
  2694*                            VMOD=2.002                          *
  2695*                                                                *
  2696*    NOTE                                                        *
  2697*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2698*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2699*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2700*        TO THESE PROGRAMS.                                      *
  2701*                                                                *
  2702*    NOTE                                                        *
  2703*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2704*        USE ONLY!                                               *
  2705*                                                                *
  2706******************************************************************
  2707
  2708         16  PI-1042-WA.
  2709             20  PI-ACTION       PIC  X(01).
  2710                 88 PI-SHOW-MODE           VALUE '1'.
  2711                 88 PI-CLEAR-MODE          VALUE '2'.
  2712                 88 PI-CREATE-MODE         VALUE '3'.
  2713             20  PI-COMM-CONTROL PIC  X(12).
  2714             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2715             20  PI-EOF-SW       PIC  X(01).
  2716                 88  PI-FILE-EOF           VALUE 'Y'.
  2717             20  PI-FILETYP      PIC  X(01).
  2718             20  PI-FORM-SQUEEZE-CONTROL
  2719                                 PIC  X(01).
  2720                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2721                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2722             20  PI-LAST-CONTROL PIC  X(12).
  2723             20  PI-TEMP-STOR-ITEMS
  2724                                 PIC S9(04) COMP.
  2725             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2726             20  PI-UPDATE-SW    PIC  9(01).
  2727                 88 ANY-UPDATES            VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  52
* EL6311.cbl
  2728             20  PI-104-SCREEN-SENT-IND
  2729                                 PIC  X(01).
  2730                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2731                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2732             20  PI-1042-SCREEN-SENT-IND
  2733                                 PIC  X(01).
  2734                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2735                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2736             20  PI-1042-ARCHIVE-IND
  2737                                 PIC  X(01).
  2738                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2739             20  FILLER          PIC  X(29).
  2740*    COPY ELC689PI.
  2741******************************************************************
  2742*                                                                *
  2743*                            ELC689PI                            *
  2744*                            VMOD=2.003                          *
  2745*                                                                *
  2746*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2747*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2748*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2749*                                                                *
  2750*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2751*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2752*    BETWEEN PROGRAMS.                                           *
  2753*                                                                *
  2754*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2755*                                                                *
  2756*               EL631 - EL689  - EL6891 - EL6892                 *
  2757*                                                                *
  2758******************************************************************
  2759*                   C H A N G E   L O G
  2760*
  2761* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2762*-----------------------------------------------------------------
  2763*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2764* EFFECTIVE    NUMBER
  2765*-----------------------------------------------------------------
  2766* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2767* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2768* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2769******************************************************************
  2770
  2771
  2772         16  PI-689-WORK-AREA.
  2773             20  PI-689-ALT-PRINTER-ID
  2774                                 PIC  X(04).
  2775             20  PI-689-ARCHIVE-NUMBER
  2776                                 PIC  9(08).
  2777             20  PI-689-ARCHIVE-SW
  2778                                 PIC  X(01).
  2779                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2780             20  PI-689-DATA-SOURCE
  2781                                 PIC  X(01).
  2782                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2783                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2784                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2785                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  53
* EL6311.cbl
  2786                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2787             20  PI-689-ERROR-IND
  2788                                 PIC  X(01).
  2789                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2790             20  PI-689-ERROR    PIC  9(04).
  2791                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2792                 88  PI-689-FATAL-ERROR
  2793                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2794                            0042 0047 0051 0066 0067 0070
  2795                            0168 0169 0174 0175 0176 0177 0179
  2796                            0180 0181 0182 0184 0185 0189 0190
  2797                            0191
  2798                            0215 0279 0280
  2799                            0412 0413 0454
  2800                            0533 0537
  2801                            2055 2114 2208 2209 2216 2232 2369
  2802                            2398 2433 2908 2999
  2803                            3000 3770 3771 3775
  2804                            7250 7365 7367 7368 7369 7370 7371
  2805                            7272 7373 7374 7376 7377 7378 7379
  2806                            7381 7388 7390 7393 7395 7396 7398
  2807                            9095 9096 9281 9298 9299 9320 9327
  2808                            9426 9427.
  2809                 88  PI-689-STOP-ERROR
  2810                     VALUES 0004 0008 0013 0023 0029 0033
  2811                            0042 0047 0066 0067 0070
  2812                            0168 0169 0174 0175 0176 0177
  2813                            0181 0182 0184 0185 0189 0190
  2814                            0279 0280
  2815                            0412 0413 0454
  2816                            2055 2208 2209 2216 2232
  2817                            2398 2999
  2818                            3000 3770 3771 3775
  2819                            7250 7365 7369 7370 7371
  2820                            7272 7373 7374 7376 7377 7378 7379
  2821                            7381 7388 7390 7393 7396 7398
  2822                            9095 9096 9299 9320 9426.
  2823             20  PI-689-FOLLOW-UP-DATE
  2824                                 PIC  X(02).
  2825             20  PI-689-FORM-NUMBER
  2826                                 PIC  X(04).
  2827             20  PI-689-LABEL-SOURCE
  2828                                 PIC X(01).
  2829                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2830                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2831                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2832                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2833                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2834                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2835                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2836             20  PI-689-NUMBER-COPIES
  2837                                 PIC  9(01).
  2838             20  PI-689-NUMBER-LABEL-LINES
  2839                                 PIC  9(01).
  2840             20  PI-689-NUMBER-TEXT-RECORDS
  2841                                 PIC  9(03).
  2842             20  PI-689-PRINT-ORDER-SW
  2843                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  54
* EL6311.cbl
  2844                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2845                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2846                 88  PI-689-PRINT-LATER     VALUE '3'.
  2847                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2848             20  PI-689-PRINT-RESTRICTION
  2849                                 PIC  X(01).
  2850                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2851                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2852                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2853             20  PI-689-PRINT-SW PIC  X(01).
  2854                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2855             20  PI-689-RESEND-DATE-1
  2856                                 PIC  X(02).
  2857             20  PI-689-RESEND-LETR-1
  2858                                 PIC X(4).
  2859             20  PI-689-TEMP-STOR-ID
  2860                                 PIC  X(08).
  2861             20  PI-689-USE-SCREEN-IND
  2862                                 PIC  X(01).
  2863                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2864             20  PI-689-ARCH-POINTER
  2865                                 PIC S9(08) COMP.
  2866                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2867             20  PI-689-ARCT-POINTER
  2868                                 PIC S9(08) COMP.
  2869                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2870             20  PI-689-VARIABLE-DATA-GRP.
  2871                 24  PI-689-VARIABLE-DATA-1
  2872                                 PIC  X(30).
  2873                 24  PI-689-VARIABLE-DATA-2
  2874                                 PIC  X(30).
  2875                 24  PI-689-VARIABLE-DATA-3
  2876                                 PIC  X(30).
  2877                 24  PI-689-VARIABLE-DATA-4
  2878                                 PIC  X(30).
  2879
  2880         16  PI-689-KEY-DATA-FIELDS.
  2881             20  PI-689-ACCOUNT  PIC  X(10).
  2882             20  PI-689-CARRIER  PIC  X(01).
  2883             20  PI-689-CERT-NO.
  2884                 24  PI-689-CERT-PRIME
  2885                                 PIC  X(10).
  2886                 24  PI-689-CERT-SFX
  2887                                 PIC  X(01).
  2888             20  PI-689-CHG-SEQ-NO
  2889                                 PIC S9(04)    COMP.
  2890             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2891                                 PIC  X(02).
  2892             20  PI-689-ENTRY-BATCH
  2893                                 PIC  X(06).
  2894             20  PI-689-EFF-DATE PIC  X(02).
  2895             20  PI-689-EXP-DATE PIC  X(02).
  2896             20  PI-689-GROUPING PIC  X(06).
  2897             20  PI-689-RESP-PERSON
  2898                                 PIC  X(10).
  2899             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2900             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2901                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  55
* EL6311.cbl
  2902             20  PI-689-STATE    PIC  X(02).
  2903             20  PI-689-TYPE     PIC  X(01).
  2904             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2905             20  PI-689-ALT-SEQ-NO
  2906                                 PIC S9(04)    COMP.
  2907         16  PI-689-DATE-EDIT    PIC  X(08).
  2908         16  PI-689-FOLLOW-UP-EDIT
  2909                                 PIC  X(08).
  2910         16  PI-689-RESEND1-EDIT PIC  X(08).
  2911         16  PI-689-SEQ-EDIT     PIC  X(08).
  2912         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2913         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2914             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2915         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2916         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  56
* EL6311.cbl
  2918
  2919 01  WS-EL6315-PASS-AREA.
  2920        16  PI-6315-ISS-CAN-SW      PIC X.
  2921        16  FILLER                  PIC X(120).
  2922        16  PI-RES-REF-CLM-TYPE     PIC X.
  2923        16  FILLER                  PIC X.
  2924        16  PI-6315-PASS-AREA.
  2925            20 FILLER               PIC X(236).
  2926            20 PI-6315-FINALIZED    PIC X.
  2927            20 FILLER               PIC X(280).
  2928
  2929 01  WS-EL6316-PASS-AREA.
  2930        16  PI-ISS-CAN-SW           PIC X.
  2931        16  FILLER                  PIC X(121).
  2932        16  PI-CLM-RESC-IND         PIC X.
  2933        16  PI-6316-PASS-AREA.
  2934            20 FILLER               PIC X(236).
  2935            20 PI-6316-FINALIZED    PIC X.
  2936            20 FILLER               PIC X(280).
  2937
  2938******************************************************************
  2939*                                                                *
  2940*         P A S S   A R E A   F O R   E D I T                    *
  2941*                                                                *
  2942******************************************************************
  2943
  2944 01  PASSED-RECORD.
  2945     12  RECORD-SAVE                  PIC X(585).
  2946* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2947*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2948*                    BY  WK-CURRENT-DATE.
  2949******************************************************************
  2950*                                                                *
  2951*                                                                *
  2952*                             ELC50W1                            *
  2953*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2954*                            VMOD=2.004                          *
  2955*                                                                *
  2956*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2957*                                                                *
  2958*                                                                *
  2959******************************************************************
  2960
  2961     12  WK-WORK-AREA.
  2962         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2963         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2964         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2965         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2966         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2967         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2968         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2969         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2970         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2971         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2972         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2973         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2974         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2975         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  57
* EL6311.cbl
  2976         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2977         16  WK-CREDIT-EDIT-CONTROLS.
  2978             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2979             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2980             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2981             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2982             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2983             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2984         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2985         16  WK-SAVE-REIN-DATA.
  2986             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2987             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2988             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2989         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2990             88  ENTRY-FROM-EL6311       VALUE '6'.
  2991         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2992         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2993     12  WK-RECORD-ADDRESSES.
  2994         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2995         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2996         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2997         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2998         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2999         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  3000         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3001         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3002     12  WK-OVER-SHORT-AREA.
  3003         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  3004         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3005         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3006             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3007         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  58
* EL6311.cbl
  3009
  3010*    COPY ELCEDITC.
  3011******************************************************************
  3012*                                                                *
  3013*                                                                *
  3014*                            ELCEDITC                            *
  3015*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3016*                            VMOD=2.012                          *
  3017*                                                                *
  3018*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3019*                     EL6313, EL050 AND EL517.                   *
  3020*                                                                *
  3021******************************************************************
  3022******************************************************************
  3023*                   C H A N G E   L O G
  3024*
  3025* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3026*-----------------------------------------------------------------
  3027*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3028* EFFECTIVE    NUMBER
  3029*-----------------------------------------------------------------
  3030* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3031******************************************************************
  3032
  3033     12  EDIT-CRITERIA-DATA.
  3034         16  EC-CO-MONTH-END-DT       PIC XX.
  3035         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3036         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3037         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3038         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3039         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3040         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3041         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3042         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3043         16  EC-CO-REM-TERM-CALC      PIC X.
  3044               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3045               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3046               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3047               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3048
  3049         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3050               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3051               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3052               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3053               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3054               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3055               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3056               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3057               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3058               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3059               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3060
  3061         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3062               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3063               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3064               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3065               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3066               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  59
* EL6311.cbl
  3067               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3068               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3069               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3070
  3071         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3072                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3073                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3074
  3075         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3076                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3077                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3078                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3079                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3080                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3081                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3082                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3083                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3084
  3085         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3086               88  EC-BR-REDUCING                   VALUE 'R'.
  3087               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3088
  3089         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3090         16  EC-BR-LF-DESC             PIC X(10).
  3091         16  EC-BR-AH-DESC             PIC X(10).
  3092         16  EC-BR-LF-COMMENT          PIC X(10).
  3093         16  EC-BR-AH-COMMENT          PIC X(10).
  3094
  3095         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3096               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3097               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3098               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3099               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3100
  3101         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3102               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3103               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3104               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3105               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3106
  3107         16  EC-BR-LF-REFUND-CALC      PIC X.
  3108                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3109                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3110                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3111                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3112                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3113                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3114                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3115
  3116         16  EC-BR-AH-REFUND-CALC      PIC X.
  3117                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3118                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3119                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3120                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3121                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3122                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3123                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3124                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  60
* EL6311.cbl
  3125
  3126         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3127                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3128                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3129                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3130
  3131         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3132                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3133                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3134                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3135
  3136         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3137         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3138         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3139         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3140
  3141         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3142         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3143                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3144                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3145                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3146                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3147
  3148         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3149               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3150               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3151               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3152               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3153               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3154
  3155         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3156               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3157               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3158               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3159               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3160               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3161
  3162         16  EC-ST-LF-REFUND-CALC      PIC X.
  3163                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3164                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3165                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3166                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3167                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3168                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3169                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3170                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3171
  3172         16  EC-ST-AH-REFUND-CALC      PIC X.
  3173                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3174                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3175                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3176                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3177                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3178                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3179                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3180                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3181
  3182         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  61
* EL6311.cbl
  3183         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3184         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3185         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3186         16  EC-AM-EXPIRATION-DT       PIC XX.
  3187         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3188         16  EC-AM-CLASS-CD            PIC XX.
  3189         16  EC-AM-LF-DEVIATION        PIC XXX.
  3190         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3191         16  EC-AM-AH-DEVIATION        PIC XXX.
  3192         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3193         16  EC-AM-PHONE-NO            PIC X(10).
  3194
  3195         16  EC-AM-LF-REFUND-CALC      PIC X.
  3196                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3197                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3198                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3199                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3200                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3201                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3202                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3203
  3204         16  EC-AM-AH-REFUND-CALC      PIC X.
  3205                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3206                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3207                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3208                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3209                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3210                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3211                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3212
  3213         16  EC-AM-BEN-I-G-CD          PIC X.
  3214                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3215                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3216                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3217
  3218         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3219         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3220         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3221         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3222         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3223         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3224         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3225         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3226         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3227
  3228         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3229         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3230         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3231         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3232         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3233         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3234         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3235         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3236         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3237         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3238         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3239         16  EC-RT-LF-NSP-ST           PIC XX.
  3240         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  62
* EL6311.cbl
  3241         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3242         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3243
  3244         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3245             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3246                                             'M' '5' '9' '2'.
  3247             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3248             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3249             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3250             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3251             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3252             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3253             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3254             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3255             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3256             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3257
  3258         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3259             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3260                                             'M' '5' '9' '2'.
  3261             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3262             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3263             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3264             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3265             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3266             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3267             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3268             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3269             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3270             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3271
  3272         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3273         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3274         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3275         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3276         16  EC-CM-DEATH-DT            PIC XX.
  3277
  3278*DMD CUSTOM CODING FIELDS BELOW
  3279*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3280         16  EC-BR-DMD-RATING-SW       PIC X.
  3281                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3282                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3283                 88  NO-DMD-RATING               VALUE 'N'.
  3284
  3285         16  EC-NEW-CERT               PIC X(11).
  3286         16  EC-NEW-STATE              PIC XX.
  3287         16  FILLER                    PIC X.
  3288*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3289         16  OVER-SHORT-EDIT-FIELDS.
  3290             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3291             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3292             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3293             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3294             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3295             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3296             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3297             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3298             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  63
* EL6311.cbl
  3299         16  FILLER                    PIC X(71).
  3300
  3301******************************************************************
  3302
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  64
* EL6311.cbl
  3304
  3305*    COPY ELCJPFX.
  3306******************************************************************
  3307*                                                                *
  3308*                                                                *
  3309*                            ELCJPFX.                            *
  3310*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3311*                            VMOD=2.002                          *
  3312*                                                                *
  3313*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3314*                                                                *
  3315*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3316*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3317*        ELCNTL - CONTROL FILE                                   *
  3318*        ELMSTR - CLAIM MASTERS                                  *
  3319*        ELTRLR - ACTIVITY TRAILERS                              *
  3320*        ELCHKQ - CHECK QUE                                      *
  3321******************************************************************
  3322 01  JOURNAL-RECORD.
  3323     12  jp-date                     pic s9(5) comp-3.
  3324     12  jp-time                     pic s9(7) comp-3.
  3325     12  JP-USER-ID                  PIC X(4).
  3326     12  JP-FILE-ID                  PIC X(8).
  3327     12  JP-PROGRAM-ID               PIC X(8).
  3328     12  JP-RECORD-TYPE              PIC X.
  3329         88 JP-ADD              VALUE 'A'.
  3330         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3331         88 JP-AFTER-CHANGE     VALUE 'C'.
  3332         88 JP-DELETE           VALUE 'D'.
  3333         88 JP-GENERIC-DELETE   VALUE 'G'.
  3334         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3335         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3336     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3337     12  JP-RECORD-AREA
  3338
  3339
  3340                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  65
* EL6311.cbl
  3342*    COPY ELCAID.
  3343******************************************************************
  3344*                                                                *
  3345*                            ELCAID.                             *
  3346*                            VMOD=2.001                          *
  3347*                                                                *
  3348*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3349*                                                                *
  3350*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3351*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3352******************************************************************
  3353
  3354 01  DFHAID.
  3355   02  DFHNULL   PIC  X  VALUE  ' '.
  3356   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3357   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3358   02  DFHPEN    PIC  X  VALUE  '='.
  3359   02  DFHOPID   PIC  X  VALUE  'W'.
  3360   02  DFHPA1    PIC  X  VALUE  '%'.
  3361   02  DFHPA2    PIC  X  VALUE  '>'.
  3362   02  DFHPA3    PIC  X  VALUE  ','.
  3363   02  DFHPF1    PIC  X  VALUE  '1'.
  3364   02  DFHPF2    PIC  X  VALUE  '2'.
  3365   02  DFHPF3    PIC  X  VALUE  '3'.
  3366   02  DFHPF4    PIC  X  VALUE  '4'.
  3367   02  DFHPF5    PIC  X  VALUE  '5'.
  3368   02  DFHPF6    PIC  X  VALUE  '6'.
  3369   02  DFHPF7    PIC  X  VALUE  '7'.
  3370   02  DFHPF8    PIC  X  VALUE  '8'.
  3371   02  DFHPF9    PIC  X  VALUE  '9'.
  3372   02  DFHPF10   PIC  X  VALUE  ':'.
  3373   02  DFHPF11   PIC  X  VALUE  '#'.
  3374   02  DFHPF12   PIC  X  VALUE  '@'.
  3375   02  DFHPF13   PIC  X  VALUE  'A'.
  3376   02  DFHPF14   PIC  X  VALUE  'B'.
  3377   02  DFHPF15   PIC  X  VALUE  'C'.
  3378   02  DFHPF16   PIC  X  VALUE  'D'.
  3379   02  DFHPF17   PIC  X  VALUE  'E'.
  3380   02  DFHPF18   PIC  X  VALUE  'F'.
  3381   02  DFHPF19   PIC  X  VALUE  'G'.
  3382   02  DFHPF20   PIC  X  VALUE  'H'.
  3383   02  DFHPF21   PIC  X  VALUE  'I'.
  3384*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3385   02  DFHPF22   PIC  X  VALUE  '['.
  3386   02  DFHPF23   PIC  X  VALUE  '.'.
  3387   02  DFHPF24   PIC  X  VALUE  '<'.
  3388   02  DFHMSRE   PIC  X  VALUE  'X'.
  3389   02  DFHSTRF   PIC  X  VALUE  'h'.
  3390   02  DFHTRIG   PIC  X  VALUE  '"'.
  3391
  3392 01  FILLER    REDEFINES DFHAID.
  3393     12  FILLER              PIC X(8).
  3394     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3395
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  66
* EL6311.cbl
  3397*    COPY EL6311S.
  3398 01  EL631BI.
  3399     05  FILLER            PIC  X(0012).
  3400*    -------------------------------
  3401     05  BDATEL PIC S9(0004) COMP.
  3402     05  BDATEF PIC  X(0001).
  3403     05  FILLER REDEFINES BDATEF.
  3404         10  BDATEA PIC  X(0001).
  3405     05  BDATEI PIC  X(0008).
  3406*    -------------------------------
  3407     05  BTIMEL PIC S9(0004) COMP.
  3408     05  BTIMEF PIC  X(0001).
  3409     05  FILLER REDEFINES BTIMEF.
  3410         10  BTIMEA PIC  X(0001).
  3411     05  BTIMEI PIC  X(0005).
  3412*    -------------------------------
  3413     05  BHEADL PIC S9(0004) COMP.
  3414     05  BHEADF PIC  X(0001).
  3415     05  FILLER REDEFINES BHEADF.
  3416         10  BHEADA PIC  X(0001).
  3417     05  BHEADI PIC  X(0038).
  3418*    -------------------------------
  3419     05  BNCERTLL PIC S9(0004) COMP.
  3420     05  BNCERTLF PIC  X(0001).
  3421     05  FILLER REDEFINES BNCERTLF.
  3422         10  BNCERTLA PIC  X(0001).
  3423     05  BNCERTLI PIC  X(0008).
  3424*    -------------------------------
  3425     05  BNCERTL PIC S9(0004) COMP.
  3426     05  BNCERTF PIC  X(0001).
  3427     05  FILLER REDEFINES BNCERTF.
  3428         10  BNCERTA PIC  X(0001).
  3429     05  BNCERTI PIC  X(0011).
  3430*    -------------------------------
  3431     05  BNSTATLL PIC S9(0004) COMP.
  3432     05  BNSTATLF PIC  X(0001).
  3433     05  FILLER REDEFINES BNSTATLF.
  3434         10  BNSTATLA PIC  X(0001).
  3435     05  BNSTATLI PIC  X(0009).
  3436*    -------------------------------
  3437     05  BNSTATL PIC S9(0004) COMP.
  3438     05  BNSTATF PIC  X(0001).
  3439     05  FILLER REDEFINES BNSTATF.
  3440         10  BNSTATA PIC  X(0001).
  3441     05  BNSTATI PIC  X(0002).
  3442*    -------------------------------
  3443     05  BCHGTL PIC S9(0004) COMP.
  3444     05  BCHGTF PIC  X(0001).
  3445     05  FILLER REDEFINES BCHGTF.
  3446         10  BCHGTA PIC  X(0001).
  3447     05  BCHGTI PIC  X(0004).
  3448*    -------------------------------
  3449     05  BCHGL PIC S9(0004) COMP.
  3450     05  BCHGF PIC  X(0001).
  3451     05  FILLER REDEFINES BCHGF.
  3452         10  BCHGA PIC  X(0001).
  3453     05  BCHGI PIC  X(0004).
  3454*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  67
* EL6311.cbl
  3455     05  BCOMPIDL PIC S9(0004) COMP.
  3456     05  BCOMPIDF PIC  X(0001).
  3457     05  FILLER REDEFINES BCOMPIDF.
  3458         10  BCOMPIDA PIC  X(0001).
  3459     05  BCOMPIDI PIC  X(0003).
  3460*    -------------------------------
  3461     05  BREGIONL PIC S9(0004) COMP.
  3462     05  BREGIONF PIC  X(0001).
  3463     05  FILLER REDEFINES BREGIONF.
  3464         10  BREGIONA PIC  X(0001).
  3465     05  BREGIONI PIC  X(0006).
  3466*    -------------------------------
  3467     05  BUSERL PIC S9(0004) COMP.
  3468     05  BUSERF PIC  X(0001).
  3469     05  FILLER REDEFINES BUSERF.
  3470         10  BUSERA PIC  X(0001).
  3471     05  BUSERI PIC  X(0004).
  3472*    -------------------------------
  3473     05  BMAINTL PIC S9(0004) COMP.
  3474     05  BMAINTF PIC  X(0001).
  3475     05  FILLER REDEFINES BMAINTF.
  3476         10  BMAINTA PIC  X(0001).
  3477     05  BMAINTI PIC  X(0001).
  3478*    -------------------------------
  3479     05  BMANTBYL PIC S9(0004) COMP.
  3480     05  BMANTBYF PIC  X(0001).
  3481     05  FILLER REDEFINES BMANTBYF.
  3482         10  BMANTBYA PIC  X(0001).
  3483     05  BMANTBYI PIC  X(0004).
  3484*    -------------------------------
  3485     05  BCHGHDGL PIC S9(0004) COMP.
  3486     05  BCHGHDGF PIC  X(0001).
  3487     05  FILLER REDEFINES BCHGHDGF.
  3488         10  BCHGHDGA PIC  X(0001).
  3489     05  BCHGHDGI PIC  X(0003).
  3490*    -------------------------------
  3491     05  BMANTDTL PIC S9(0004) COMP.
  3492     05  BMANTDTF PIC  X(0001).
  3493     05  FILLER REDEFINES BMANTDTF.
  3494         10  BMANTDTA PIC  X(0001).
  3495     05  BMANTDTI PIC  X(0008).
  3496*    -------------------------------
  3497     05  BMANTATL PIC S9(0004) COMP.
  3498     05  BMANTATF PIC  X(0001).
  3499     05  FILLER REDEFINES BMANTATF.
  3500         10  BMANTATA PIC  X(0001).
  3501     05  BMANTATI PIC  X(0005).
  3502*    -------------------------------
  3503     05  BCSRL PIC S9(0004) COMP.
  3504     05  BCSRF PIC  X(0001).
  3505     05  FILLER REDEFINES BCSRF.
  3506         10  BCSRA PIC  X(0001).
  3507     05  BCSRI PIC  X(0004).
  3508*    -------------------------------
  3509     05  BBATCHL PIC S9(0004) COMP.
  3510     05  BBATCHF PIC  X(0001).
  3511     05  FILLER REDEFINES BBATCHF.
  3512         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  68
* EL6311.cbl
  3513     05  BBATCHI PIC  X(0006).
  3514*    -------------------------------
  3515     05  BSEQL PIC S9(0004) COMP.
  3516     05  BSEQF PIC  X(0001).
  3517     05  FILLER REDEFINES BSEQF.
  3518         10  BSEQA PIC  X(0001).
  3519     05  BSEQI PIC  X(0004).
  3520*    -------------------------------
  3521     05  BMOENDTL PIC S9(0004) COMP.
  3522     05  BMOENDTF PIC  X(0001).
  3523     05  FILLER REDEFINES BMOENDTF.
  3524         10  BMOENDTA PIC  X(0001).
  3525     05  BMOENDTI PIC  X(0008).
  3526*    -------------------------------
  3527     05  BCARRL PIC S9(0004) COMP.
  3528     05  BCARRF PIC  X(0001).
  3529     05  FILLER REDEFINES BCARRF.
  3530         10  BCARRA PIC  X(0001).
  3531     05  BCARRI PIC  X(0001).
  3532*    -------------------------------
  3533     05  BGROUPL PIC S9(0004) COMP.
  3534     05  BGROUPF PIC  X(0001).
  3535     05  FILLER REDEFINES BGROUPF.
  3536         10  BGROUPA PIC  X(0001).
  3537     05  BGROUPI PIC  X(0006).
  3538*    -------------------------------
  3539     05  BSTATEL PIC S9(0004) COMP.
  3540     05  BSTATEF PIC  X(0001).
  3541     05  FILLER REDEFINES BSTATEF.
  3542         10  BSTATEA PIC  X(0001).
  3543     05  BSTATEI PIC  X(0002).
  3544*    -------------------------------
  3545     05  BACCTL PIC S9(0004) COMP.
  3546     05  BACCTF PIC  X(0001).
  3547     05  FILLER REDEFINES BACCTF.
  3548         10  BACCTA PIC  X(0001).
  3549     05  BACCTI PIC  X(0010).
  3550*    -------------------------------
  3551     05  BVINHL PIC S9(0004) COMP.
  3552     05  BVINHF PIC  X(0001).
  3553     05  FILLER REDEFINES BVINHF.
  3554         10  BVINHA PIC  X(0001).
  3555     05  BVINHI PIC  X(0004).
  3556*    -------------------------------
  3557     05  BVINL PIC S9(0004) COMP.
  3558     05  BVINF PIC  X(0001).
  3559     05  FILLER REDEFINES BVINF.
  3560         10  BVINA PIC  X(0001).
  3561     05  BVINI PIC  X(0017).
  3562*    -------------------------------
  3563     05  BREFHDGL PIC S9(0004) COMP.
  3564     05  BREFHDGF PIC  X(0001).
  3565     05  FILLER REDEFINES BREFHDGF.
  3566         10  BREFHDGA PIC  X(0001).
  3567     05  BREFHDGI PIC  X(0004).
  3568*    -------------------------------
  3569     05  BREFL PIC S9(0004) COMP.
  3570     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  69
* EL6311.cbl
  3571     05  FILLER REDEFINES BREFF.
  3572         10  BREFA PIC  X(0001).
  3573     05  BREFI PIC  X(0012).
  3574*    -------------------------------
  3575     05  BAGEDEFL PIC S9(0004) COMP.
  3576     05  BAGEDEFF PIC  X(0001).
  3577     05  FILLER REDEFINES BAGEDEFF.
  3578         10  BAGEDEFA PIC  X(0001).
  3579     05  BAGEDEFI PIC  X(0004).
  3580*    -------------------------------
  3581     05  BCERTNOL PIC S9(0004) COMP.
  3582     05  BCERTNOF PIC  X(0001).
  3583     05  FILLER REDEFINES BCERTNOF.
  3584         10  BCERTNOA PIC  X(0001).
  3585     05  BCERTNOI PIC  X(0010).
  3586*    -------------------------------
  3587     05  BSUFIXL PIC S9(0004) COMP.
  3588     05  BSUFIXF PIC  X(0001).
  3589     05  FILLER REDEFINES BSUFIXF.
  3590         10  BSUFIXA PIC  X(0001).
  3591     05  BSUFIXI PIC  X(0001).
  3592*    -------------------------------
  3593     05  BEFFDTL PIC S9(0004) COMP.
  3594     05  BEFFDTF PIC  X(0001).
  3595     05  FILLER REDEFINES BEFFDTF.
  3596         10  BEFFDTA PIC  X(0001).
  3597     05  BEFFDTI PIC  X(0008).
  3598*    -------------------------------
  3599     05  BLSTNML PIC S9(0004) COMP.
  3600     05  BLSTNMF PIC  X(0001).
  3601     05  FILLER REDEFINES BLSTNMF.
  3602         10  BLSTNMA PIC  X(0001).
  3603     05  BLSTNMI PIC  X(0015).
  3604*    -------------------------------
  3605     05  B1STNML PIC S9(0004) COMP.
  3606     05  B1STNMF PIC  X(0001).
  3607     05  FILLER REDEFINES B1STNMF.
  3608         10  B1STNMA PIC  X(0001).
  3609     05  B1STNMI PIC  X(0010).
  3610*    -------------------------------
  3611     05  BINITL PIC S9(0004) COMP.
  3612     05  BINITF PIC  X(0001).
  3613     05  FILLER REDEFINES BINITF.
  3614         10  BINITA PIC  X(0001).
  3615     05  BINITI PIC  X(0001).
  3616*    -------------------------------
  3617     05  BSEXL PIC S9(0004) COMP.
  3618     05  BSEXF PIC  X(0001).
  3619     05  FILLER REDEFINES BSEXF.
  3620         10  BSEXA PIC  X(0001).
  3621     05  BSEXI PIC  X(0001).
  3622*    -------------------------------
  3623     05  BAGEL PIC S9(0004) COMP.
  3624     05  BAGEF PIC  X(0001).
  3625     05  FILLER REDEFINES BAGEF.
  3626         10  BAGEA PIC  X(0001).
  3627     05  BAGEI PIC  X(0002).
  3628*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  70
* EL6311.cbl
  3629     05  BBIRTHL PIC S9(0004) COMP.
  3630     05  BBIRTHF PIC  X(0001).
  3631     05  FILLER REDEFINES BBIRTHF.
  3632         10  BBIRTHA PIC  X(0001).
  3633     05  BBIRTHI PIC  X(0008).
  3634*    -------------------------------
  3635     05  B1STPMTL PIC S9(0004) COMP.
  3636     05  B1STPMTF PIC  X(0001).
  3637     05  FILLER REDEFINES B1STPMTF.
  3638         10  B1STPMTA PIC  X(0001).
  3639     05  B1STPMTI PIC  X(0008).
  3640*    -------------------------------
  3641     05  BDAYSL PIC S9(0004) COMP.
  3642     05  BDAYSF PIC  X(0001).
  3643     05  FILLER REDEFINES BDAYSF.
  3644         10  BDAYSA PIC  X(0001).
  3645     05  BDAYSI PIC  X(0003).
  3646*    -------------------------------
  3647     05  BLNTRML PIC S9(0004) COMP.
  3648     05  BLNTRMF PIC  X(0001).
  3649     05  FILLER REDEFINES BLNTRMF.
  3650         10  BLNTRMA PIC  X(0001).
  3651     05  BLNTRMI PIC  X(0003).
  3652*    -------------------------------
  3653     05  BLNOFCRL PIC S9(0004) COMP.
  3654     05  BLNOFCRF PIC  X(0001).
  3655     05  FILLER REDEFINES BLNOFCRF.
  3656         10  BLNOFCRA PIC  X(0001).
  3657     05  BLNOFCRI PIC  X(0005).
  3658*    -------------------------------
  3659     05  BMODEL PIC S9(0004) COMP.
  3660     05  BMODEF PIC  X(0001).
  3661     05  FILLER REDEFINES BMODEF.
  3662         10  BMODEA PIC  X(0001).
  3663     05  BMODEI PIC  X(0001).
  3664*    -------------------------------
  3665     05  BFREQL PIC S9(0004) COMP.
  3666     05  BFREQF PIC  X(0001).
  3667     05  FILLER REDEFINES BFREQF.
  3668         10  BFREQA PIC  X(0001).
  3669     05  BFREQI PIC  X(0002).
  3670*    -------------------------------
  3671     05  BPMTSL PIC S9(0004) COMP.
  3672     05  BPMTSF PIC  X(0001).
  3673     05  FILLER REDEFINES BPMTSF.
  3674         10  BPMTSA PIC  X(0001).
  3675     05  BPMTSI PIC  999.
  3676*    -------------------------------
  3677     05  BPMTAMTL PIC S9(0004) COMP.
  3678     05  BPMTAMTF PIC  X(0001).
  3679     05  FILLER REDEFINES BPMTAMTF.
  3680         10  BPMTAMTA PIC  X(0001).
  3681     05  BPMTAMTI PIC  9(7)V99.
  3682*    -------------------------------
  3683     05  BAPRL PIC S9(0004) COMP.
  3684     05  BAPRF PIC  X(0001).
  3685     05  FILLER REDEFINES BAPRF.
  3686         10  BAPRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  71
* EL6311.cbl
  3687     05  BAPRI PIC  X(7).
  3688*    -------------------------------
  3689     05  BLIVESL PIC S9(0004) COMP.
  3690     05  BLIVESF PIC  X(0001).
  3691     05  FILLER REDEFINES BLIVESF.
  3692         10  BLIVESA PIC  X(0001).
  3693     05  BLIVESI PIC  X(0009).
  3694*    -------------------------------
  3695     05  BMEMCAPL PIC S9(0004) COMP.
  3696     05  BMEMCAPF PIC  X(0001).
  3697     05  FILLER REDEFINES BMEMCAPF.
  3698         10  BMEMCAPA PIC  X(0001).
  3699     05  BMEMCAPI PIC  X(0011).
  3700*    -------------------------------
  3701     05  BORIGHDL PIC S9(0004) COMP.
  3702     05  BORIGHDF PIC  X(0001).
  3703     05  FILLER REDEFINES BORIGHDF.
  3704         10  BORIGHDA PIC  X(0001).
  3705     05  BORIGHDI PIC  X(0009).
  3706*    -------------------------------
  3707     05  DMDBILL PIC S9(0004) COMP.
  3708     05  DMDBILF PIC  X(0001).
  3709     05  FILLER REDEFINES DMDBILF.
  3710         10  DMDBILA PIC  X(0001).
  3711     05  DMDBILI PIC  X(0006).
  3712*    -------------------------------
  3713     05  BFORCEL PIC S9(0004) COMP.
  3714     05  BFORCEF PIC  X(0001).
  3715     05  FILLER REDEFINES BFORCEF.
  3716         10  BFORCEA PIC  X(0001).
  3717     05  BFORCEI PIC  X(0001).
  3718*    -------------------------------
  3719     05  BENTRYL PIC S9(0004) COMP.
  3720     05  BENTRYF PIC  X(0001).
  3721     05  FILLER REDEFINES BENTRYF.
  3722         10  BENTRYA PIC  X(0001).
  3723     05  BENTRYI PIC  X(0001).
  3724*    -------------------------------
  3725     05  BREINL PIC S9(0004) COMP.
  3726     05  BREINF PIC  X(0001).
  3727     05  FILLER REDEFINES BREINF.
  3728         10  BREINA PIC  X(0001).
  3729     05  BREINI PIC  X(0001).
  3730*    -------------------------------
  3731     05  BBILCDL PIC S9(0004) COMP.
  3732     05  BBILCDF PIC  X(0001).
  3733     05  FILLER REDEFINES BBILCDF.
  3734         10  BBILCDA PIC  X(0001).
  3735     05  BBILCDI PIC  X(0001).
  3736*    -------------------------------
  3737     05  BUNWRITL PIC S9(0004) COMP.
  3738     05  BUNWRITF PIC  X(0001).
  3739     05  FILLER REDEFINES BUNWRITF.
  3740         10  BUNWRITA PIC  X(0001).
  3741     05  BUNWRITI PIC  X(0001).
  3742*    -------------------------------
  3743     05  BSKPCDL PIC S9(0004) COMP.
  3744     05  BSKPCDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  72
* EL6311.cbl
  3745     05  FILLER REDEFINES BSKPCDF.
  3746         10  BSKPCDA PIC  X(0001).
  3747     05  BSKPCDI PIC  X(0001).
  3748*    -------------------------------
  3749     05  BINDGRPL PIC S9(0004) COMP.
  3750     05  BINDGRPF PIC  X(0001).
  3751     05  FILLER REDEFINES BINDGRPF.
  3752         10  BINDGRPA PIC  X(0001).
  3753     05  BINDGRPI PIC  X(0001).
  3754*    -------------------------------
  3755     05  BSIGL PIC S9(0004) COMP.
  3756     05  BSIGF PIC  X(0001).
  3757     05  FILLER REDEFINES BSIGF.
  3758         10  BSIGA PIC  X(0001).
  3759     05  BSIGI PIC  X(0001).
  3760*    -------------------------------
  3761     05  BRTCLSL PIC S9(0004) COMP.
  3762     05  BRTCLSF PIC  X(0001).
  3763     05  FILLER REDEFINES BRTCLSF.
  3764         10  BRTCLSA PIC  X(0001).
  3765     05  BRTCLSI PIC  X(0002).
  3766*    -------------------------------
  3767     05  BCHGCNTL PIC S9(0004) COMP.
  3768     05  BCHGCNTF PIC  X(0001).
  3769     05  FILLER REDEFINES BCHGCNTF.
  3770         10  BCHGCNTA PIC  X(0001).
  3771     05  BCHGCNTI PIC  X(0003).
  3772*    -------------------------------
  3773     05  BMEMBERL PIC S9(0004) COMP.
  3774     05  BMEMBERF PIC  X(0001).
  3775     05  FILLER REDEFINES BMEMBERF.
  3776         10  BMEMBERA PIC  X(0001).
  3777     05  BMEMBERI PIC  X(0012).
  3778*    -------------------------------
  3779     05  BORGNOL PIC S9(0004) COMP.
  3780     05  BORGNOF PIC  X(0001).
  3781     05  FILLER REDEFINES BORGNOF.
  3782         10  BORGNOA PIC  X(0001).
  3783     05  BORGNOI PIC  X(0006).
  3784*    -------------------------------
  3785     05  BORGSEQL PIC S9(0004) COMP.
  3786     05  BORGSEQF PIC  X(0001).
  3787     05  FILLER REDEFINES BORGSEQF.
  3788         10  BORGSEQA PIC  X(0001).
  3789     05  BORGSEQI PIC  X(0004).
  3790*    -------------------------------
  3791     05  BBILLEDL PIC S9(0004) COMP.
  3792     05  BBILLEDF PIC  X(0001).
  3793     05  FILLER REDEFINES BBILLEDF.
  3794         10  BBILLEDA PIC  X(0001).
  3795     05  BBILLEDI PIC  9(9).
  3796*    -------------------------------
  3797     05  BKIND1L PIC S9(0004) COMP.
  3798     05  BKIND1F PIC  X(0001).
  3799     05  FILLER REDEFINES BKIND1F.
  3800         10  BKIND1A PIC  X(0001).
  3801     05  BKIND1I PIC  X(0002).
  3802*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  73
* EL6311.cbl
  3803     05  BTYPE1L PIC S9(0004) COMP.
  3804     05  BTYPE1F PIC  X(0001).
  3805     05  FILLER REDEFINES BTYPE1F.
  3806         10  BTYPE1A PIC  X(0001).
  3807     05  BTYPE1I PIC  X(0003).
  3808*    -------------------------------
  3809     05  BTERM1L PIC S9(0004) COMP.
  3810     05  BTERM1F PIC  X(0001).
  3811     05  FILLER REDEFINES BTERM1F.
  3812         10  BTERM1A PIC  X(0001).
  3813     05  BTERM1I PIC  X(0003).
  3814*    -------------------------------
  3815     05  BBEN1L PIC S9(0004) COMP.
  3816     05  BBEN1F PIC  X(0001).
  3817     05  FILLER REDEFINES BBEN1F.
  3818         10  BBEN1A PIC  X(0001).
  3819     05  BBEN1I PIC  X(0012).
  3820*    -------------------------------
  3821     05  BPREM1L PIC S9(0004) COMP.
  3822     05  BPREM1F PIC  X(0001).
  3823     05  FILLER REDEFINES BPREM1F.
  3824         10  BPREM1A PIC  X(0001).
  3825     05  BPREM1I PIC  X(0011).
  3826*    -------------------------------
  3827     05  BEXPIR1L PIC S9(0004) COMP.
  3828     05  BEXPIR1F PIC  X(0001).
  3829     05  FILLER REDEFINES BEXPIR1F.
  3830         10  BEXPIR1A PIC  X(0001).
  3831     05  BEXPIR1I PIC  X(0008).
  3832*    -------------------------------
  3833     05  BCP1L PIC S9(0004) COMP.
  3834     05  BCP1F PIC  X(0001).
  3835     05  FILLER REDEFINES BCP1F.
  3836         10  BCP1A PIC  X(0001).
  3837     05  BCP1I PIC  X(0002).
  3838*    -------------------------------
  3839     05  BALTBN1L PIC S9(0004) COMP.
  3840     05  BALTBN1F PIC  X(0001).
  3841     05  FILLER REDEFINES BALTBN1F.
  3842         10  BALTBN1A PIC  X(0001).
  3843     05  BALTBN1I PIC  X(0012).
  3844*    -------------------------------
  3845     05  BALTPR1L PIC S9(0004) COMP.
  3846     05  BALTPR1F PIC  X(0001).
  3847     05  FILLER REDEFINES BALTPR1F.
  3848         10  BALTPR1A PIC  X(0001).
  3849     05  BALTPR1I PIC  X(0011).
  3850*    -------------------------------
  3851     05  BBNCD1L PIC S9(0004) COMP.
  3852     05  BBNCD1F PIC  X(0001).
  3853     05  FILLER REDEFINES BBNCD1F.
  3854         10  BBNCD1A PIC  X(0001).
  3855     05  BBNCD1I PIC  X(0003).
  3856*    -------------------------------
  3857     05  BCPRM1L PIC S9(0004) COMP.
  3858     05  BCPRM1F PIC  X(0001).
  3859     05  FILLER REDEFINES BCPRM1F.
  3860         10  BCPRM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  74
* EL6311.cbl
  3861     05  BCPRM1I PIC  X(0011).
  3862*    -------------------------------
  3863     05  BCAPRM1L PIC S9(0004) COMP.
  3864     05  BCAPRM1F PIC  X(0001).
  3865     05  FILLER REDEFINES BCAPRM1F.
  3866         10  BCAPRM1A PIC  X(0001).
  3867     05  BCAPRM1I PIC  X(0011).
  3868*    -------------------------------
  3869     05  BENABR1L PIC S9(0004) COMP.
  3870     05  BENABR1F PIC  X(0001).
  3871     05  FILLER REDEFINES BENABR1F.
  3872         10  BENABR1A PIC  X(0001).
  3873     05  BENABR1I PIC  X(0005).
  3874*    -------------------------------
  3875     05  BDIFF1L PIC S9(0004) COMP.
  3876     05  BDIFF1F PIC  X(0001).
  3877     05  FILLER REDEFINES BDIFF1F.
  3878         10  BDIFF1A PIC  X(0001).
  3879     05  BDIFF1I PIC  X(0011).
  3880*    -------------------------------
  3881     05  BBILIT1L PIC S9(0004) COMP.
  3882     05  BBILIT1F PIC  X(0001).
  3883     05  FILLER REDEFINES BBILIT1F.
  3884         10  BBILIT1A PIC  X(0001).
  3885     05  BBILIT1I PIC  X(0008).
  3886*    -------------------------------
  3887     05  BADIFF1L PIC S9(0004) COMP.
  3888     05  BADIFF1F PIC  X(0001).
  3889     05  FILLER REDEFINES BADIFF1F.
  3890         10  BADIFF1A PIC  X(0001).
  3891     05  BADIFF1I PIC  X(0011).
  3892*    -------------------------------
  3893     05  BKIND2L PIC S9(0004) COMP.
  3894     05  BKIND2F PIC  X(0001).
  3895     05  FILLER REDEFINES BKIND2F.
  3896         10  BKIND2A PIC  X(0001).
  3897     05  BKIND2I PIC  X(0002).
  3898*    -------------------------------
  3899     05  BTYPE2L PIC S9(0004) COMP.
  3900     05  BTYPE2F PIC  X(0001).
  3901     05  FILLER REDEFINES BTYPE2F.
  3902         10  BTYPE2A PIC  X(0001).
  3903     05  BTYPE2I PIC  X(0003).
  3904*    -------------------------------
  3905     05  BTERM2L PIC S9(0004) COMP.
  3906     05  BTERM2F PIC  X(0001).
  3907     05  FILLER REDEFINES BTERM2F.
  3908         10  BTERM2A PIC  X(0001).
  3909     05  BTERM2I PIC  X(0003).
  3910*    -------------------------------
  3911     05  BBEN2L PIC S9(0004) COMP.
  3912     05  BBEN2F PIC  X(0001).
  3913     05  FILLER REDEFINES BBEN2F.
  3914         10  BBEN2A PIC  X(0001).
  3915     05  BBEN2I PIC  X(0012).
  3916*    -------------------------------
  3917     05  BPREM2L PIC S9(0004) COMP.
  3918     05  BPREM2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  75
* EL6311.cbl
  3919     05  FILLER REDEFINES BPREM2F.
  3920         10  BPREM2A PIC  X(0001).
  3921     05  BPREM2I PIC  X(0011).
  3922*    -------------------------------
  3923     05  BEXPIR2L PIC S9(0004) COMP.
  3924     05  BEXPIR2F PIC  X(0001).
  3925     05  FILLER REDEFINES BEXPIR2F.
  3926         10  BEXPIR2A PIC  X(0001).
  3927     05  BEXPIR2I PIC  X(0008).
  3928*    -------------------------------
  3929     05  BCP2L PIC S9(0004) COMP.
  3930     05  BCP2F PIC  X(0001).
  3931     05  FILLER REDEFINES BCP2F.
  3932         10  BCP2A PIC  X(0001).
  3933     05  BCP2I PIC  X(0002).
  3934*    -------------------------------
  3935     05  BALTBN2L PIC S9(0004) COMP.
  3936     05  BALTBN2F PIC  X(0001).
  3937     05  FILLER REDEFINES BALTBN2F.
  3938         10  BALTBN2A PIC  X(0001).
  3939     05  BALTBN2I PIC  X(0012).
  3940*    -------------------------------
  3941     05  BALTPR2L PIC S9(0004) COMP.
  3942     05  BALTPR2F PIC  X(0001).
  3943     05  FILLER REDEFINES BALTPR2F.
  3944         10  BALTPR2A PIC  X(0001).
  3945     05  BALTPR2I PIC  X(0011).
  3946*    -------------------------------
  3947     05  BBNCD2L PIC S9(0004) COMP.
  3948     05  BBNCD2F PIC  X(0001).
  3949     05  FILLER REDEFINES BBNCD2F.
  3950         10  BBNCD2A PIC  X(0001).
  3951     05  BBNCD2I PIC  X(0003).
  3952*    -------------------------------
  3953     05  BCPRM2L PIC S9(0004) COMP.
  3954     05  BCPRM2F PIC  X(0001).
  3955     05  FILLER REDEFINES BCPRM2F.
  3956         10  BCPRM2A PIC  X(0001).
  3957     05  BCPRM2I PIC  X(0011).
  3958*    -------------------------------
  3959     05  BCAPRM2L PIC S9(0004) COMP.
  3960     05  BCAPRM2F PIC  X(0001).
  3961     05  FILLER REDEFINES BCAPRM2F.
  3962         10  BCAPRM2A PIC  X(0001).
  3963     05  BCAPRM2I PIC  X(0011).
  3964*    -------------------------------
  3965     05  BENABR2L PIC S9(0004) COMP.
  3966     05  BENABR2F PIC  X(0001).
  3967     05  FILLER REDEFINES BENABR2F.
  3968         10  BENABR2A PIC  X(0001).
  3969     05  BENABR2I PIC  X(0005).
  3970*    -------------------------------
  3971     05  BDIFF2L PIC S9(0004) COMP.
  3972     05  BDIFF2F PIC  X(0001).
  3973     05  FILLER REDEFINES BDIFF2F.
  3974         10  BDIFF2A PIC  X(0001).
  3975     05  BDIFF2I PIC  X(0011).
  3976*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  76
* EL6311.cbl
  3977     05  BBILIT2L PIC S9(0004) COMP.
  3978     05  BBILIT2F PIC  X(0001).
  3979     05  FILLER REDEFINES BBILIT2F.
  3980         10  BBILIT2A PIC  X(0001).
  3981     05  BBILIT2I PIC  X(0008).
  3982*    -------------------------------
  3983     05  BADIFF2L PIC S9(0004) COMP.
  3984     05  BADIFF2F PIC  X(0001).
  3985     05  FILLER REDEFINES BADIFF2F.
  3986         10  BADIFF2A PIC  X(0001).
  3987     05  BADIFF2I PIC  X(0011).
  3988*    -------------------------------
  3989     05  BERMSG1L PIC S9(0004) COMP.
  3990     05  BERMSG1F PIC  X(0001).
  3991     05  FILLER REDEFINES BERMSG1F.
  3992         10  BERMSG1A PIC  X(0001).
  3993     05  BERMSG1I PIC  X(0078).
  3994*    -------------------------------
  3995     05  BERMSG2L PIC S9(0004) COMP.
  3996     05  BERMSG2F PIC  X(0001).
  3997     05  FILLER REDEFINES BERMSG2F.
  3998         10  BERMSG2A PIC  X(0001).
  3999     05  BERMSG2I PIC  X(0078).
  4000*    -------------------------------
  4001     05  BERMSG3L PIC S9(0004) COMP.
  4002     05  BERMSG3F PIC  X(0001).
  4003     05  FILLER REDEFINES BERMSG3F.
  4004         10  BERMSG3A PIC  X(0001).
  4005     05  BERMSG3I PIC  X(0078).
  4006*    -------------------------------
  4007     05  BPFENTRL PIC S9(0004) COMP.
  4008     05  BPFENTRF PIC  X(0001).
  4009     05  FILLER REDEFINES BPFENTRF.
  4010         10  BPFENTRA PIC  X(0001).
  4011     05  BPFENTRI PIC  9(2).
  4012*    -------------------------------
  4013     05  BPF5HDRL PIC S9(0004) COMP.
  4014     05  BPF5HDRF PIC  X(0001).
  4015     05  FILLER REDEFINES BPF5HDRF.
  4016         10  BPF5HDRA PIC  X(0001).
  4017     05  BPF5HDRI PIC  X(0005).
  4018*    -------------------------------
  4019     05  BPF4HDRL PIC S9(0004) COMP.
  4020     05  BPF4HDRF PIC  X(0001).
  4021     05  FILLER REDEFINES BPF4HDRF.
  4022         10  BPF4HDRA PIC  X(0001).
  4023     05  BPF4HDRI PIC  X(0013).
  4024*    -------------------------------
  4025     05  BF15HDRL PIC S9(0004) COMP.
  4026     05  BF15HDRF PIC  X(0001).
  4027     05  FILLER REDEFINES BF15HDRF.
  4028         10  BF15HDRA PIC  X(0001).
  4029     05  BF15HDRI PIC  X(0010).
  4030 01  EL631BO REDEFINES EL631BI.
  4031     05  FILLER            PIC  X(0012).
  4032*    -------------------------------
  4033     05  FILLER            PIC  X(0003).
  4034     05  BDATEO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  77
* EL6311.cbl
  4035*    -------------------------------
  4036     05  FILLER            PIC  X(0003).
  4037     05  BTIMEO PIC  99.99.
  4038*    -------------------------------
  4039     05  FILLER            PIC  X(0003).
  4040     05  BHEADO PIC  X(0038).
  4041*    -------------------------------
  4042     05  FILLER            PIC  X(0003).
  4043     05  BNCERTLO PIC  X(0008).
  4044*    -------------------------------
  4045     05  FILLER            PIC  X(0003).
  4046     05  BNCERTO PIC  X(0011).
  4047*    -------------------------------
  4048     05  FILLER            PIC  X(0003).
  4049     05  BNSTATLO PIC  X(0009).
  4050*    -------------------------------
  4051     05  FILLER            PIC  X(0003).
  4052     05  BNSTATO PIC  X(0002).
  4053*    -------------------------------
  4054     05  FILLER            PIC  X(0003).
  4055     05  BCHGTO PIC  X(0004).
  4056*    -------------------------------
  4057     05  FILLER            PIC  X(0003).
  4058     05  BCHGO PIC  ZZZ9.
  4059*    -------------------------------
  4060     05  FILLER            PIC  X(0003).
  4061     05  BCOMPIDO PIC  X(0003).
  4062*    -------------------------------
  4063     05  FILLER            PIC  X(0003).
  4064     05  BREGIONO PIC  X(0006).
  4065*    -------------------------------
  4066     05  FILLER            PIC  X(0003).
  4067     05  BUSERO PIC  X(0004).
  4068*    -------------------------------
  4069     05  FILLER            PIC  X(0003).
  4070     05  BMAINTO PIC  X(0001).
  4071*    -------------------------------
  4072     05  FILLER            PIC  X(0003).
  4073     05  BMANTBYO PIC  X(0004).
  4074*    -------------------------------
  4075     05  FILLER            PIC  X(0003).
  4076     05  BCHGHDGO PIC  X(0003).
  4077*    -------------------------------
  4078     05  FILLER            PIC  X(0003).
  4079     05  BMANTDTO PIC  X(0008).
  4080*    -------------------------------
  4081     05  FILLER            PIC  X(0003).
  4082     05  BMANTATO PIC  99.99.
  4083*    -------------------------------
  4084     05  FILLER            PIC  X(0003).
  4085     05  BCSRO PIC  X(0004).
  4086*    -------------------------------
  4087     05  FILLER            PIC  X(0003).
  4088     05  BBATCHO PIC  X(0006).
  4089*    -------------------------------
  4090     05  FILLER            PIC  X(0003).
  4091     05  BSEQO PIC  X(0004).
  4092*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  78
* EL6311.cbl
  4093     05  FILLER            PIC  X(0003).
  4094     05  BMOENDTO PIC  X(0008).
  4095*    -------------------------------
  4096     05  FILLER            PIC  X(0003).
  4097     05  BCARRO PIC  X(0001).
  4098*    -------------------------------
  4099     05  FILLER            PIC  X(0003).
  4100     05  BGROUPO PIC  X(0006).
  4101*    -------------------------------
  4102     05  FILLER            PIC  X(0003).
  4103     05  BSTATEO PIC  X(0002).
  4104*    -------------------------------
  4105     05  FILLER            PIC  X(0003).
  4106     05  BACCTO PIC  X(0010).
  4107*    -------------------------------
  4108     05  FILLER            PIC  X(0003).
  4109     05  BVINHO PIC  X(0004).
  4110*    -------------------------------
  4111     05  FILLER            PIC  X(0003).
  4112     05  BVINO PIC  X(0017).
  4113*    -------------------------------
  4114     05  FILLER            PIC  X(0003).
  4115     05  BREFHDGO PIC  X(0004).
  4116*    -------------------------------
  4117     05  FILLER            PIC  X(0003).
  4118     05  BREFO PIC  X(0012).
  4119*    -------------------------------
  4120     05  FILLER            PIC  X(0003).
  4121     05  BAGEDEFO PIC  X(0004).
  4122*    -------------------------------
  4123     05  FILLER            PIC  X(0003).
  4124     05  BCERTNOO PIC  X(0010).
  4125*    -------------------------------
  4126     05  FILLER            PIC  X(0003).
  4127     05  BSUFIXO PIC  X(0001).
  4128*    -------------------------------
  4129     05  FILLER            PIC  X(0003).
  4130     05  BEFFDTO PIC  X(0008).
  4131*    -------------------------------
  4132     05  FILLER            PIC  X(0003).
  4133     05  BLSTNMO PIC  X(0015).
  4134*    -------------------------------
  4135     05  FILLER            PIC  X(0003).
  4136     05  B1STNMO PIC  X(0010).
  4137*    -------------------------------
  4138     05  FILLER            PIC  X(0003).
  4139     05  BINITO PIC  X(0001).
  4140*    -------------------------------
  4141     05  FILLER            PIC  X(0003).
  4142     05  BSEXO PIC  X(0001).
  4143*    -------------------------------
  4144     05  FILLER            PIC  X(0003).
  4145     05  BAGEO PIC  X(0002).
  4146*    -------------------------------
  4147     05  FILLER            PIC  X(0003).
  4148     05  BBIRTHO PIC  X(0008).
  4149*    -------------------------------
  4150     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  79
* EL6311.cbl
  4151     05  B1STPMTO PIC  X(0008).
  4152*    -------------------------------
  4153     05  FILLER            PIC  X(0003).
  4154     05  BDAYSO PIC  X(0003).
  4155*    -------------------------------
  4156     05  FILLER            PIC  X(0003).
  4157     05  BLNTRMO PIC  X(0003).
  4158*    -------------------------------
  4159     05  FILLER            PIC  X(0003).
  4160     05  BLNOFCRO PIC  X(0005).
  4161*    -------------------------------
  4162     05  FILLER            PIC  X(0003).
  4163     05  BMODEO PIC  X(0001).
  4164*    -------------------------------
  4165     05  FILLER            PIC  X(0003).
  4166     05  BFREQO PIC  X(0002).
  4167*    -------------------------------
  4168     05  FILLER            PIC  X(0003).
  4169     05  BPMTSO PIC  X(0003).
  4170*    -------------------------------
  4171     05  FILLER            PIC  X(0003).
  4172     05  BPMTAMTO PIC  ZZZZZ9.99.
  4173*    -------------------------------
  4174     05  FILLER            PIC  X(0003).
  4175     05  BAPRO PIC  99.9999.
  4176*    -------------------------------
  4177     05  FILLER            PIC  X(0003).
  4178     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4179*    -------------------------------
  4180     05  FILLER            PIC  X(0003).
  4181     05  BMEMCAPO PIC  X(0011).
  4182*    -------------------------------
  4183     05  FILLER            PIC  X(0003).
  4184     05  BORIGHDO PIC  X(0009).
  4185*    -------------------------------
  4186     05  FILLER            PIC  X(0003).
  4187     05  DMDBILO PIC  X(0006).
  4188*    -------------------------------
  4189     05  FILLER            PIC  X(0003).
  4190     05  BFORCEO PIC  X(0001).
  4191*    -------------------------------
  4192     05  FILLER            PIC  X(0003).
  4193     05  BENTRYO PIC  X(0001).
  4194*    -------------------------------
  4195     05  FILLER            PIC  X(0003).
  4196     05  BREINO PIC  X(0001).
  4197*    -------------------------------
  4198     05  FILLER            PIC  X(0003).
  4199     05  BBILCDO PIC  X(0001).
  4200*    -------------------------------
  4201     05  FILLER            PIC  X(0003).
  4202     05  BUNWRITO PIC  X(0001).
  4203*    -------------------------------
  4204     05  FILLER            PIC  X(0003).
  4205     05  BSKPCDO PIC  X(0001).
  4206*    -------------------------------
  4207     05  FILLER            PIC  X(0003).
  4208     05  BINDGRPO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  80
* EL6311.cbl
  4209*    -------------------------------
  4210     05  FILLER            PIC  X(0003).
  4211     05  BSIGO PIC  X(0001).
  4212*    -------------------------------
  4213     05  FILLER            PIC  X(0003).
  4214     05  BRTCLSO PIC  X(0002).
  4215*    -------------------------------
  4216     05  FILLER            PIC  X(0003).
  4217     05  BCHGCNTO PIC  X(0003).
  4218*    -------------------------------
  4219     05  FILLER            PIC  X(0003).
  4220     05  BMEMBERO PIC  X(0012).
  4221*    -------------------------------
  4222     05  FILLER            PIC  X(0003).
  4223     05  BORGNOO PIC  X(0006).
  4224*    -------------------------------
  4225     05  FILLER            PIC  X(0003).
  4226     05  BORGSEQO PIC  X(0004).
  4227*    -------------------------------
  4228     05  FILLER            PIC  X(0003).
  4229     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4230*    -------------------------------
  4231     05  FILLER            PIC  X(0003).
  4232     05  BKIND1O PIC  X(0002).
  4233*    -------------------------------
  4234     05  FILLER            PIC  X(0003).
  4235     05  BTYPE1O PIC  X(0003).
  4236*    -------------------------------
  4237     05  FILLER            PIC  X(0003).
  4238     05  BTERM1O PIC  X(0003).
  4239*    -------------------------------
  4240     05  FILLER            PIC  X(0003).
  4241     05  BBEN1O PIC  X(0012).
  4242*    -------------------------------
  4243     05  FILLER            PIC  X(0003).
  4244     05  BPREM1O PIC  X(0011).
  4245*    -------------------------------
  4246     05  FILLER            PIC  X(0003).
  4247     05  BEXPIR1O PIC  X(0008).
  4248*    -------------------------------
  4249     05  FILLER            PIC  X(0003).
  4250     05  BCP1O PIC  X(0002).
  4251*    -------------------------------
  4252     05  FILLER            PIC  X(0003).
  4253     05  BALTBN1O PIC  X(0012).
  4254*    -------------------------------
  4255     05  FILLER            PIC  X(0003).
  4256     05  BALTPR1O PIC  X(0011).
  4257*    -------------------------------
  4258     05  FILLER            PIC  X(0003).
  4259     05  BBNCD1O PIC  X(0003).
  4260*    -------------------------------
  4261     05  FILLER            PIC  X(0003).
  4262     05  BCPRM1O PIC  X(0011).
  4263*    -------------------------------
  4264     05  FILLER            PIC  X(0003).
  4265     05  BCAPRM1O PIC  X(0011).
  4266*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  81
* EL6311.cbl
  4267     05  FILLER            PIC  X(0003).
  4268     05  BENABR1O PIC  X(0005).
  4269*    -------------------------------
  4270     05  FILLER            PIC  X(0003).
  4271     05  BDIFF1O PIC  X(0011).
  4272*    -------------------------------
  4273     05  FILLER            PIC  X(0003).
  4274     05  BBILIT1O PIC  X(0008).
  4275*    -------------------------------
  4276     05  FILLER            PIC  X(0003).
  4277     05  BADIFF1O PIC  X(0011).
  4278*    -------------------------------
  4279     05  FILLER            PIC  X(0003).
  4280     05  BKIND2O PIC  X(0002).
  4281*    -------------------------------
  4282     05  FILLER            PIC  X(0003).
  4283     05  BTYPE2O PIC  X(0003).
  4284*    -------------------------------
  4285     05  FILLER            PIC  X(0003).
  4286     05  BTERM2O PIC  X(0003).
  4287*    -------------------------------
  4288     05  FILLER            PIC  X(0003).
  4289     05  BBEN2O PIC  X(0012).
  4290*    -------------------------------
  4291     05  FILLER            PIC  X(0003).
  4292     05  BPREM2O PIC  X(0011).
  4293*    -------------------------------
  4294     05  FILLER            PIC  X(0003).
  4295     05  BEXPIR2O PIC  X(0008).
  4296*    -------------------------------
  4297     05  FILLER            PIC  X(0003).
  4298     05  BCP2O PIC  X(0002).
  4299*    -------------------------------
  4300     05  FILLER            PIC  X(0003).
  4301     05  BALTBN2O PIC  X(0012).
  4302*    -------------------------------
  4303     05  FILLER            PIC  X(0003).
  4304     05  BALTPR2O PIC  X(0011).
  4305*    -------------------------------
  4306     05  FILLER            PIC  X(0003).
  4307     05  BBNCD2O PIC  X(0003).
  4308*    -------------------------------
  4309     05  FILLER            PIC  X(0003).
  4310     05  BCPRM2O PIC  X(0011).
  4311*    -------------------------------
  4312     05  FILLER            PIC  X(0003).
  4313     05  BCAPRM2O PIC  X(0011).
  4314*    -------------------------------
  4315     05  FILLER            PIC  X(0003).
  4316     05  BENABR2O PIC  X(0005).
  4317*    -------------------------------
  4318     05  FILLER            PIC  X(0003).
  4319     05  BDIFF2O PIC  X(0011).
  4320*    -------------------------------
  4321     05  FILLER            PIC  X(0003).
  4322     05  BBILIT2O PIC  X(0008).
  4323*    -------------------------------
  4324     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  82
* EL6311.cbl
  4325     05  BADIFF2O PIC  X(0011).
  4326*    -------------------------------
  4327     05  FILLER            PIC  X(0003).
  4328     05  BERMSG1O PIC  X(0078).
  4329*    -------------------------------
  4330     05  FILLER            PIC  X(0003).
  4331     05  BERMSG2O PIC  X(0078).
  4332*    -------------------------------
  4333     05  FILLER            PIC  X(0003).
  4334     05  BERMSG3O PIC  X(0078).
  4335*    -------------------------------
  4336     05  FILLER            PIC  X(0003).
  4337     05  BPFENTRO PIC  X(0002).
  4338*    -------------------------------
  4339     05  FILLER            PIC  X(0003).
  4340     05  BPF5HDRO PIC  X(0005).
  4341*    -------------------------------
  4342     05  FILLER            PIC  X(0003).
  4343     05  BPF4HDRO PIC  X(0013).
  4344*    -------------------------------
  4345     05  FILLER            PIC  X(0003).
  4346     05  BF15HDRO PIC  X(0010).
  4347*    -------------------------------
  4348 01  EL631CI REDEFINES EL631BI.
  4349     05  FILLER            PIC  X(0012).
  4350*    -------------------------------
  4351     05  CDATEL PIC S9(0004) COMP.
  4352     05  CDATEF PIC  X(0001).
  4353     05  FILLER REDEFINES CDATEF.
  4354         10  CDATEA PIC  X(0001).
  4355     05  CDATEI PIC  X(0008).
  4356*    -------------------------------
  4357     05  CTIMEL PIC S9(0004) COMP.
  4358     05  CTIMEF PIC  X(0001).
  4359     05  FILLER REDEFINES CTIMEF.
  4360         10  CTIMEA PIC  X(0001).
  4361     05  CTIMEI PIC  X(0005).
  4362*    -------------------------------
  4363     05  CHEADL PIC S9(0004) COMP.
  4364     05  CHEADF PIC  X(0001).
  4365     05  FILLER REDEFINES CHEADF.
  4366         10  CHEADA PIC  X(0001).
  4367     05  CHEADI PIC  X(0038).
  4368*    -------------------------------
  4369     05  CCHGTL PIC S9(0004) COMP.
  4370     05  CCHGTF PIC  X(0001).
  4371     05  FILLER REDEFINES CCHGTF.
  4372         10  CCHGTA PIC  X(0001).
  4373     05  CCHGTI PIC  X(0004).
  4374*    -------------------------------
  4375     05  CCHGL PIC S9(0004) COMP.
  4376     05  CCHGF PIC  X(0001).
  4377     05  FILLER REDEFINES CCHGF.
  4378         10  CCHGA PIC  X(0001).
  4379     05  CCHGI PIC  X(0004).
  4380*    -------------------------------
  4381     05  CMAINTL PIC S9(0004) COMP.
  4382     05  CMAINTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  83
* EL6311.cbl
  4383     05  FILLER REDEFINES CMAINTF.
  4384         10  CMAINTA PIC  X(0001).
  4385     05  CMAINTI PIC  X(0001).
  4386*    -------------------------------
  4387     05  CMANTBYL PIC S9(0004) COMP.
  4388     05  CMANTBYF PIC  X(0001).
  4389     05  FILLER REDEFINES CMANTBYF.
  4390         10  CMANTBYA PIC  X(0001).
  4391     05  CMANTBYI PIC  X(0004).
  4392*    -------------------------------
  4393     05  CCHGHDGL PIC S9(0004) COMP.
  4394     05  CCHGHDGF PIC  X(0001).
  4395     05  FILLER REDEFINES CCHGHDGF.
  4396         10  CCHGHDGA PIC  X(0001).
  4397     05  CCHGHDGI PIC  X(0003).
  4398*    -------------------------------
  4399     05  CMANTDTL PIC S9(0004) COMP.
  4400     05  CMANTDTF PIC  X(0001).
  4401     05  FILLER REDEFINES CMANTDTF.
  4402         10  CMANTDTA PIC  X(0001).
  4403     05  CMANTDTI PIC  X(0008).
  4404*    -------------------------------
  4405     05  CMANTATL PIC S9(0004) COMP.
  4406     05  CMANTATF PIC  X(0001).
  4407     05  FILLER REDEFINES CMANTATF.
  4408         10  CMANTATA PIC  X(0001).
  4409     05  CMANTATI PIC  X(0005).
  4410*    -------------------------------
  4411     05  CCSRL PIC S9(0004) COMP.
  4412     05  CCSRF PIC  X(0001).
  4413     05  FILLER REDEFINES CCSRF.
  4414         10  CCSRA PIC  X(0001).
  4415     05  CCSRI PIC  X(0004).
  4416*    -------------------------------
  4417     05  CBATCHL PIC S9(0004) COMP.
  4418     05  CBATCHF PIC  X(0001).
  4419     05  FILLER REDEFINES CBATCHF.
  4420         10  CBATCHA PIC  X(0001).
  4421     05  CBATCHI PIC  X(0006).
  4422*    -------------------------------
  4423     05  CSEQL PIC S9(0004) COMP.
  4424     05  CSEQF PIC  X(0001).
  4425     05  FILLER REDEFINES CSEQF.
  4426         10  CSEQA PIC  X(0001).
  4427     05  CSEQI PIC  X(0004).
  4428*    -------------------------------
  4429     05  CMOENDTL PIC S9(0004) COMP.
  4430     05  CMOENDTF PIC  X(0001).
  4431     05  FILLER REDEFINES CMOENDTF.
  4432         10  CMOENDTA PIC  X(0001).
  4433     05  CMOENDTI PIC  X(0008).
  4434*    -------------------------------
  4435     05  CCARRL PIC S9(0004) COMP.
  4436     05  CCARRF PIC  X(0001).
  4437     05  FILLER REDEFINES CCARRF.
  4438         10  CCARRA PIC  X(0001).
  4439     05  CCARRI PIC  X(0001).
  4440*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  84
* EL6311.cbl
  4441     05  CGROUPL PIC S9(0004) COMP.
  4442     05  CGROUPF PIC  X(0001).
  4443     05  FILLER REDEFINES CGROUPF.
  4444         10  CGROUPA PIC  X(0001).
  4445     05  CGROUPI PIC  X(0006).
  4446*    -------------------------------
  4447     05  CSTATEL PIC S9(0004) COMP.
  4448     05  CSTATEF PIC  X(0001).
  4449     05  FILLER REDEFINES CSTATEF.
  4450         10  CSTATEA PIC  X(0001).
  4451     05  CSTATEI PIC  X(0002).
  4452*    -------------------------------
  4453     05  CACCTL PIC S9(0004) COMP.
  4454     05  CACCTF PIC  X(0001).
  4455     05  FILLER REDEFINES CACCTF.
  4456         10  CACCTA PIC  X(0001).
  4457     05  CACCTI PIC  X(0010).
  4458*    -------------------------------
  4459     05  CORIGHDL PIC S9(0004) COMP.
  4460     05  CORIGHDF PIC  X(0001).
  4461     05  FILLER REDEFINES CORIGHDF.
  4462         10  CORIGHDA PIC  X(0001).
  4463     05  CORIGHDI PIC  X(0011).
  4464*    -------------------------------
  4465     05  CORGNOL PIC S9(0004) COMP.
  4466     05  CORGNOF PIC  X(0001).
  4467     05  FILLER REDEFINES CORGNOF.
  4468         10  CORGNOA PIC  X(0001).
  4469     05  CORGNOI PIC  X(0006).
  4470*    -------------------------------
  4471     05  CORGSEQL PIC S9(0004) COMP.
  4472     05  CORGSEQF PIC  X(0001).
  4473     05  FILLER REDEFINES CORGSEQF.
  4474         10  CORGSEQA PIC  X(0001).
  4475     05  CORGSEQI PIC  X(0004).
  4476*    -------------------------------
  4477     05  CREFHDGL PIC S9(0004) COMP.
  4478     05  CREFHDGF PIC  X(0001).
  4479     05  FILLER REDEFINES CREFHDGF.
  4480         10  CREFHDGA PIC  X(0001).
  4481     05  CREFHDGI PIC  X(0010).
  4482*    -------------------------------
  4483     05  CREFL PIC S9(0004) COMP.
  4484     05  CREFF PIC  X(0001).
  4485     05  FILLER REDEFINES CREFF.
  4486         10  CREFA PIC  X(0001).
  4487     05  CREFI PIC  X(0012).
  4488*    -------------------------------
  4489     05  CNHINTL PIC S9(0004) COMP.
  4490     05  CNHINTF PIC  X(0001).
  4491     05  FILLER REDEFINES CNHINTF.
  4492         10  CNHINTA PIC  X(0001).
  4493     05  CNHINTI PIC  9(7)V99.
  4494*    -------------------------------
  4495     05  CCERTNOL PIC S9(0004) COMP.
  4496     05  CCERTNOF PIC  X(0001).
  4497     05  FILLER REDEFINES CCERTNOF.
  4498         10  CCERTNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  85
* EL6311.cbl
  4499     05  CCERTNOI PIC  X(0010).
  4500*    -------------------------------
  4501     05  CSUFIXL PIC S9(0004) COMP.
  4502     05  CSUFIXF PIC  X(0001).
  4503     05  FILLER REDEFINES CSUFIXF.
  4504         10  CSUFIXA PIC  X(0001).
  4505     05  CSUFIXI PIC  X(0001).
  4506*    -------------------------------
  4507     05  CEFFDTL PIC S9(0004) COMP.
  4508     05  CEFFDTF PIC  X(0001).
  4509     05  FILLER REDEFINES CEFFDTF.
  4510         10  CEFFDTA PIC  X(0001).
  4511     05  CEFFDTI PIC  X(0008).
  4512*    -------------------------------
  4513     05  CLSTNML PIC S9(0004) COMP.
  4514     05  CLSTNMF PIC  X(0001).
  4515     05  FILLER REDEFINES CLSTNMF.
  4516         10  CLSTNMA PIC  X(0001).
  4517     05  CLSTNMI PIC  X(0015).
  4518*    -------------------------------
  4519     05  CPCYNL PIC S9(0004) COMP.
  4520     05  CPCYNF PIC  X(0001).
  4521     05  FILLER REDEFINES CPCYNF.
  4522         10  CPCYNA PIC  X(0001).
  4523     05  CPCYNI PIC  X(0001).
  4524*    -------------------------------
  4525     05  CINAMEL PIC S9(0004) COMP.
  4526     05  CINAMEF PIC  X(0001).
  4527     05  FILLER REDEFINES CINAMEF.
  4528         10  CINAMEA PIC  X(0001).
  4529     05  CINAMEI PIC  X(0015).
  4530*    -------------------------------
  4531     05  CINITSL PIC S9(0004) COMP.
  4532     05  CINITSF PIC  X(0001).
  4533     05  FILLER REDEFINES CINITSF.
  4534         10  CINITSA PIC  X(0001).
  4535     05  CINITSI PIC  X(0010).
  4536*    -------------------------------
  4537     05  CCANREAL PIC S9(0004) COMP.
  4538     05  CCANREAF PIC  X(0001).
  4539     05  FILLER REDEFINES CCANREAF.
  4540         10  CCANREAA PIC  X(0001).
  4541     05  CCANREAI PIC  X(0001).
  4542*    -------------------------------
  4543     05  CKIND1L PIC S9(0004) COMP.
  4544     05  CKIND1F PIC  X(0001).
  4545     05  FILLER REDEFINES CKIND1F.
  4546         10  CKIND1A PIC  X(0001).
  4547     05  CKIND1I PIC  X(0002).
  4548*    -------------------------------
  4549     05  CCANDT1L PIC S9(0004) COMP.
  4550     05  CCANDT1F PIC  X(0001).
  4551     05  FILLER REDEFINES CCANDT1F.
  4552         10  CCANDT1A PIC  X(0001).
  4553     05  CCANDT1I PIC  X(0008).
  4554*    -------------------------------
  4555     05  CREFND1L PIC S9(0004) COMP.
  4556     05  CREFND1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  86
* EL6311.cbl
  4557     05  FILLER REDEFINES CREFND1F.
  4558         10  CREFND1A PIC  X(0001).
  4559     05  CREFND1I PIC  S9(9)V99.
  4560*    -------------------------------
  4561     05  CMTHD1L PIC S9(0004) COMP.
  4562     05  CMTHD1F PIC  X(0001).
  4563     05  FILLER REDEFINES CMTHD1F.
  4564         10  CMTHD1A PIC  X(0001).
  4565     05  CMTHD1I PIC  X(0001).
  4566*    -------------------------------
  4567     05  CKIND2L PIC S9(0004) COMP.
  4568     05  CKIND2F PIC  X(0001).
  4569     05  FILLER REDEFINES CKIND2F.
  4570         10  CKIND2A PIC  X(0001).
  4571     05  CKIND2I PIC  X(0002).
  4572*    -------------------------------
  4573     05  CCANDT2L PIC S9(0004) COMP.
  4574     05  CCANDT2F PIC  X(0001).
  4575     05  FILLER REDEFINES CCANDT2F.
  4576         10  CCANDT2A PIC  X(0001).
  4577     05  CCANDT2I PIC  X(0008).
  4578*    -------------------------------
  4579     05  CREFND2L PIC S9(0004) COMP.
  4580     05  CREFND2F PIC  X(0001).
  4581     05  FILLER REDEFINES CREFND2F.
  4582         10  CREFND2A PIC  X(0001).
  4583     05  CREFND2I PIC  S9(9)V99.
  4584*    -------------------------------
  4585     05  CMTHD2L PIC S9(0004) COMP.
  4586     05  CMTHD2F PIC  X(0001).
  4587     05  FILLER REDEFINES CMTHD2F.
  4588         10  CMTHD2A PIC  X(0001).
  4589     05  CMTHD2I PIC  X(0001).
  4590*    -------------------------------
  4591     05  CLIVESL PIC S9(0004) COMP.
  4592     05  CLIVESF PIC  X(0001).
  4593     05  FILLER REDEFINES CLIVESF.
  4594         10  CLIVESA PIC  X(0001).
  4595     05  CLIVESI PIC  X(0003).
  4596*    -------------------------------
  4597     05  CFORCEL PIC S9(0004) COMP.
  4598     05  CFORCEF PIC  X(0001).
  4599     05  FILLER REDEFINES CFORCEF.
  4600         10  CFORCEA PIC  X(0001).
  4601     05  CFORCEI PIC  X(0001).
  4602*    -------------------------------
  4603     05  CBILCDL PIC S9(0004) COMP.
  4604     05  CBILCDF PIC  X(0001).
  4605     05  FILLER REDEFINES CBILCDF.
  4606         10  CBILCDA PIC  X(0001).
  4607     05  CBILCDI PIC  X(0001).
  4608*    -------------------------------
  4609     05  CCRFND1L PIC S9(0004) COMP.
  4610     05  CCRFND1F PIC  X(0001).
  4611     05  FILLER REDEFINES CCRFND1F.
  4612         10  CCRFND1A PIC  X(0001).
  4613     05  CCRFND1I PIC  X(0011).
  4614*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  87
* EL6311.cbl
  4615     05  CCRFND2L PIC S9(0004) COMP.
  4616     05  CCRFND2F PIC  X(0001).
  4617     05  FILLER REDEFINES CCRFND2F.
  4618         10  CCRFND2A PIC  X(0001).
  4619     05  CCRFND2I PIC  X(0011).
  4620*    -------------------------------
  4621     05  CBILIT1L PIC S9(0004) COMP.
  4622     05  CBILIT1F PIC  X(0001).
  4623     05  FILLER REDEFINES CBILIT1F.
  4624         10  CBILIT1A PIC  X(0001).
  4625     05  CBILIT1I PIC  X(0008).
  4626*    -------------------------------
  4627     05  CDRFND1L PIC S9(0004) COMP.
  4628     05  CDRFND1F PIC  X(0001).
  4629     05  FILLER REDEFINES CDRFND1F.
  4630         10  CDRFND1A PIC  X(0001).
  4631     05  CDRFND1I PIC  X(0011).
  4632*    -------------------------------
  4633     05  CBILIT2L PIC S9(0004) COMP.
  4634     05  CBILIT2F PIC  X(0001).
  4635     05  FILLER REDEFINES CBILIT2F.
  4636         10  CBILIT2A PIC  X(0001).
  4637     05  CBILIT2I PIC  X(0008).
  4638*    -------------------------------
  4639     05  CDRFND2L PIC S9(0004) COMP.
  4640     05  CDRFND2F PIC  X(0001).
  4641     05  FILLER REDEFINES CDRFND2F.
  4642         10  CDRFND2A PIC  X(0001).
  4643     05  CDRFND2I PIC  X(0011).
  4644*    -------------------------------
  4645     05  CCANTXTL PIC S9(0004) COMP.
  4646     05  CCANTXTF PIC  X(0001).
  4647     05  FILLER REDEFINES CCANTXTF.
  4648         10  CCANTXTA PIC  X(0001).
  4649     05  CCANTXTI PIC  X(0005).
  4650*    -------------------------------
  4651     05  CCANFEEL PIC S9(0004) COMP.
  4652     05  CCANFEEF PIC  X(0001).
  4653     05  FILLER REDEFINES CCANFEEF.
  4654         10  CCANFEEA PIC  X(0001).
  4655     05  CCANFEEI PIC  X(0002).
  4656*    -------------------------------
  4657     05  CTERM1L PIC S9(0004) COMP.
  4658     05  CTERM1F PIC  X(0001).
  4659     05  FILLER REDEFINES CTERM1F.
  4660         10  CTERM1A PIC  X(0001).
  4661     05  CTERM1I PIC  X(0003).
  4662*    -------------------------------
  4663     05  CRTERM1L PIC S9(0004) COMP.
  4664     05  CRTERM1F PIC  X(0001).
  4665     05  FILLER REDEFINES CRTERM1F.
  4666         10  CRTERM1A PIC  X(0001).
  4667     05  CRTERM1I PIC  X(0003).
  4668*    -------------------------------
  4669     05  CPREM1L PIC S9(0004) COMP.
  4670     05  CPREM1F PIC  X(0001).
  4671     05  FILLER REDEFINES CPREM1F.
  4672         10  CPREM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  88
* EL6311.cbl
  4673     05  CPREM1I PIC  X(0011).
  4674*    -------------------------------
  4675     05  CTERM2L PIC S9(0004) COMP.
  4676     05  CTERM2F PIC  X(0001).
  4677     05  FILLER REDEFINES CTERM2F.
  4678         10  CTERM2A PIC  X(0001).
  4679     05  CTERM2I PIC  X(0003).
  4680*    -------------------------------
  4681     05  CRTERM2L PIC S9(0004) COMP.
  4682     05  CRTERM2F PIC  X(0001).
  4683     05  FILLER REDEFINES CRTERM2F.
  4684         10  CRTERM2A PIC  X(0001).
  4685     05  CRTERM2I PIC  X(0003).
  4686*    -------------------------------
  4687     05  CPREM2L PIC S9(0004) COMP.
  4688     05  CPREM2F PIC  X(0001).
  4689     05  FILLER REDEFINES CPREM2F.
  4690         10  CPREM2A PIC  X(0001).
  4691     05  CPREM2I PIC  X(0011).
  4692*    -------------------------------
  4693     05  CENTRDTL PIC S9(0004) COMP.
  4694     05  CENTRDTF PIC  X(0001).
  4695     05  FILLER REDEFINES CENTRDTF.
  4696         10  CENTRDTA PIC  X(0001).
  4697     05  CENTRDTI PIC  X(0008).
  4698*    -------------------------------
  4699     05  CPAYEEL PIC S9(0004) COMP.
  4700     05  CPAYEEF PIC  X(0001).
  4701     05  FILLER REDEFINES CPAYEEF.
  4702         10  CPAYEEA PIC  X(0001).
  4703     05  CPAYEEI PIC  X(0006).
  4704*    -------------------------------
  4705     05  CRFNDSWL PIC S9(0004) COMP.
  4706     05  CRFNDSWF PIC  X(0001).
  4707     05  FILLER REDEFINES CRFNDSWF.
  4708         10  CRFNDSWA PIC  X(0001).
  4709     05  CRFNDSWI PIC  X(0003).
  4710*    -------------------------------
  4711     05  CLFHDGL PIC S9(0004) COMP.
  4712     05  CLFHDGF PIC  X(0001).
  4713     05  FILLER REDEFINES CLFHDGF.
  4714         10  CLFHDGA PIC  X(0001).
  4715     05  CLFHDGI PIC  X(0006).
  4716*    -------------------------------
  4717     05  CAHHDGL PIC S9(0004) COMP.
  4718     05  CAHHDGF PIC  X(0001).
  4719     05  FILLER REDEFINES CAHHDGF.
  4720         10  CAHHDGA PIC  X(0001).
  4721     05  CAHHDGI PIC  X(0006).
  4722*    -------------------------------
  4723     05  CENTDTL PIC S9(0004) COMP.
  4724     05  CENTDTF PIC  X(0001).
  4725     05  FILLER REDEFINES CENTDTF.
  4726         10  CENTDTA PIC  X(0001).
  4727     05  CENTDTI PIC  X(0008).
  4728*    -------------------------------
  4729     05  CENTBYL PIC S9(0004) COMP.
  4730     05  CENTBYF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  89
* EL6311.cbl
  4731     05  FILLER REDEFINES CENTBYF.
  4732         10  CENTBYA PIC  X(0001).
  4733     05  CENTBYI PIC  X(0004).
  4734*    -------------------------------
  4735     05  CCHGCNTL PIC S9(0004) COMP.
  4736     05  CCHGCNTF PIC  X(0001).
  4737     05  FILLER REDEFINES CCHGCNTF.
  4738         10  CCHGCNTA PIC  X(0001).
  4739     05  CCHGCNTI PIC  X(0003).
  4740*    -------------------------------
  4741     05  CLFREFNL PIC S9(0004) COMP.
  4742     05  CLFREFNF PIC  X(0001).
  4743     05  FILLER REDEFINES CLFREFNF.
  4744         10  CLFREFNA PIC  X(0001).
  4745     05  CLFREFNI PIC  X(0006).
  4746*    -------------------------------
  4747     05  CAHREFNL PIC S9(0004) COMP.
  4748     05  CAHREFNF PIC  X(0001).
  4749     05  FILLER REDEFINES CAHREFNF.
  4750         10  CAHREFNA PIC  X(0001).
  4751     05  CAHREFNI PIC  X(0006).
  4752*    -------------------------------
  4753     05  CREINCDL PIC S9(0004) COMP.
  4754     05  CREINCDF PIC  X(0001).
  4755     05  FILLER REDEFINES CREINCDF.
  4756         10  CREINCDA PIC  X(0001).
  4757     05  CREINCDI PIC  X(0003).
  4758*    -------------------------------
  4759     05  CAEFFDTL PIC S9(0004) COMP.
  4760     05  CAEFFDTF PIC  X(0001).
  4761     05  FILLER REDEFINES CAEFFDTF.
  4762         10  CAEFFDTA PIC  X(0001).
  4763     05  CAEFFDTI PIC  X(0008).
  4764*    -------------------------------
  4765     05  CAEXPDTL PIC S9(0004) COMP.
  4766     05  CAEXPDTF PIC  X(0001).
  4767     05  FILLER REDEFINES CAEXPDTF.
  4768         10  CAEXPDTA PIC  X(0001).
  4769     05  CAEXPDTI PIC  X(0008).
  4770*    -------------------------------
  4771     05  COMMLFL PIC S9(0004) COMP.
  4772     05  COMMLFF PIC  X(0001).
  4773     05  FILLER REDEFINES COMMLFF.
  4774         10  COMMLFA PIC  X(0001).
  4775     05  COMMLFI PIC  X(0006).
  4776*    -------------------------------
  4777     05  COMMAHL PIC S9(0004) COMP.
  4778     05  COMMAHF PIC  X(0001).
  4779     05  FILLER REDEFINES COMMAHF.
  4780         10  COMMAHA PIC  X(0001).
  4781     05  COMMAHI PIC  X(0006).
  4782*    -------------------------------
  4783     05  CERMSG1L PIC S9(0004) COMP.
  4784     05  CERMSG1F PIC  X(0001).
  4785     05  FILLER REDEFINES CERMSG1F.
  4786         10  CERMSG1A PIC  X(0001).
  4787     05  CERMSG1I PIC  X(0078).
  4788*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  90
* EL6311.cbl
  4789     05  CERMSG2L PIC S9(0004) COMP.
  4790     05  CERMSG2F PIC  X(0001).
  4791     05  FILLER REDEFINES CERMSG2F.
  4792         10  CERMSG2A PIC  X(0001).
  4793     05  CERMSG2I PIC  X(0078).
  4794*    -------------------------------
  4795     05  CERMSG3L PIC S9(0004) COMP.
  4796     05  CERMSG3F PIC  X(0001).
  4797     05  FILLER REDEFINES CERMSG3F.
  4798         10  CERMSG3A PIC  X(0001).
  4799     05  CERMSG3I PIC  X(0078).
  4800*    -------------------------------
  4801     05  CPFENTRL PIC S9(0004) COMP.
  4802     05  CPFENTRF PIC  X(0001).
  4803     05  FILLER REDEFINES CPFENTRF.
  4804         10  CPFENTRA PIC  X(0001).
  4805     05  CPFENTRI PIC  9(2).
  4806*    -------------------------------
  4807     05  CPF5HDRL PIC S9(0004) COMP.
  4808     05  CPF5HDRF PIC  X(0001).
  4809     05  FILLER REDEFINES CPF5HDRF.
  4810         10  CPF5HDRA PIC  X(0001).
  4811     05  CPF5HDRI PIC  X(0005).
  4812*    -------------------------------
  4813     05  CPF4HDRL PIC S9(0004) COMP.
  4814     05  CPF4HDRF PIC  X(0001).
  4815     05  FILLER REDEFINES CPF4HDRF.
  4816         10  CPF4HDRA PIC  X(0001).
  4817     05  CPF4HDRI PIC  X(0013).
  4818*    -------------------------------
  4819     05  CF15HDRL PIC S9(0004) COMP.
  4820     05  CF15HDRF PIC  X(0001).
  4821     05  FILLER REDEFINES CF15HDRF.
  4822         10  CF15HDRA PIC  X(0001).
  4823     05  CF15HDRI PIC  X(0022).
  4824 01  EL631CO REDEFINES EL631BI.
  4825     05  FILLER            PIC  X(0012).
  4826*    -------------------------------
  4827     05  FILLER            PIC  X(0003).
  4828     05  CDATEO PIC  X(0008).
  4829*    -------------------------------
  4830     05  FILLER            PIC  X(0003).
  4831     05  CTIMEO PIC  99.99.
  4832*    -------------------------------
  4833     05  FILLER            PIC  X(0003).
  4834     05  CHEADO PIC  X(0038).
  4835*    -------------------------------
  4836     05  FILLER            PIC  X(0003).
  4837     05  CCHGTO PIC  X(0004).
  4838*    -------------------------------
  4839     05  FILLER            PIC  X(0003).
  4840     05  CCHGO PIC  ZZZ9.
  4841*    -------------------------------
  4842     05  FILLER            PIC  X(0003).
  4843     05  CMAINTO PIC  X(0001).
  4844*    -------------------------------
  4845     05  FILLER            PIC  X(0003).
  4846     05  CMANTBYO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  91
* EL6311.cbl
  4847*    -------------------------------
  4848     05  FILLER            PIC  X(0003).
  4849     05  CCHGHDGO PIC  X(0003).
  4850*    -------------------------------
  4851     05  FILLER            PIC  X(0003).
  4852     05  CMANTDTO PIC  X(0008).
  4853*    -------------------------------
  4854     05  FILLER            PIC  X(0003).
  4855     05  CMANTATO PIC  99.99.
  4856*    -------------------------------
  4857     05  FILLER            PIC  X(0003).
  4858     05  CCSRO PIC  X(0004).
  4859*    -------------------------------
  4860     05  FILLER            PIC  X(0003).
  4861     05  CBATCHO PIC  X(0006).
  4862*    -------------------------------
  4863     05  FILLER            PIC  X(0003).
  4864     05  CSEQO PIC  X(0004).
  4865*    -------------------------------
  4866     05  FILLER            PIC  X(0003).
  4867     05  CMOENDTO PIC  X(0008).
  4868*    -------------------------------
  4869     05  FILLER            PIC  X(0003).
  4870     05  CCARRO PIC  X(0001).
  4871*    -------------------------------
  4872     05  FILLER            PIC  X(0003).
  4873     05  CGROUPO PIC  X(0006).
  4874*    -------------------------------
  4875     05  FILLER            PIC  X(0003).
  4876     05  CSTATEO PIC  X(0002).
  4877*    -------------------------------
  4878     05  FILLER            PIC  X(0003).
  4879     05  CACCTO PIC  X(0010).
  4880*    -------------------------------
  4881     05  FILLER            PIC  X(0003).
  4882     05  CORIGHDO PIC  X(0011).
  4883*    -------------------------------
  4884     05  FILLER            PIC  X(0003).
  4885     05  CORGNOO PIC  X(0006).
  4886*    -------------------------------
  4887     05  FILLER            PIC  X(0003).
  4888     05  CORGSEQO PIC  X(0004).
  4889*    -------------------------------
  4890     05  FILLER            PIC  X(0003).
  4891     05  CREFHDGO PIC  X(0010).
  4892*    -------------------------------
  4893     05  FILLER            PIC  X(0003).
  4894     05  CREFO PIC  X(0012).
  4895*    -------------------------------
  4896     05  FILLER            PIC  X(0003).
  4897     05  CNHINTO PIC  ZZZZZ9.99.
  4898*    -------------------------------
  4899     05  FILLER            PIC  X(0003).
  4900     05  CCERTNOO PIC  X(0010).
  4901*    -------------------------------
  4902     05  FILLER            PIC  X(0003).
  4903     05  CSUFIXO PIC  X(0001).
  4904*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  92
* EL6311.cbl
  4905     05  FILLER            PIC  X(0003).
  4906     05  CEFFDTO PIC  X(0008).
  4907*    -------------------------------
  4908     05  FILLER            PIC  X(0003).
  4909     05  CLSTNMO PIC  X(0015).
  4910*    -------------------------------
  4911     05  FILLER            PIC  X(0003).
  4912     05  CPCYNO PIC  X(0001).
  4913*    -------------------------------
  4914     05  FILLER            PIC  X(0003).
  4915     05  CINAMEO PIC  X(0015).
  4916*    -------------------------------
  4917     05  FILLER            PIC  X(0003).
  4918     05  CINITSO PIC  X(0010).
  4919*    -------------------------------
  4920     05  FILLER            PIC  X(0003).
  4921     05  CCANREAO PIC  X(0001).
  4922*    -------------------------------
  4923     05  FILLER            PIC  X(0003).
  4924     05  CKIND1O PIC  X(0002).
  4925*    -------------------------------
  4926     05  FILLER            PIC  X(0003).
  4927     05  CCANDT1O PIC  X(0008).
  4928*    -------------------------------
  4929     05  FILLER            PIC  X(0003).
  4930     05  CREFND1O PIC  Z(7).99-.
  4931*    -------------------------------
  4932     05  FILLER            PIC  X(0003).
  4933     05  CMTHD1O PIC  X(0001).
  4934*    -------------------------------
  4935     05  FILLER            PIC  X(0003).
  4936     05  CKIND2O PIC  X(0002).
  4937*    -------------------------------
  4938     05  FILLER            PIC  X(0003).
  4939     05  CCANDT2O PIC  X(0008).
  4940*    -------------------------------
  4941     05  FILLER            PIC  X(0003).
  4942     05  CREFND2O PIC  Z(7).99-.
  4943*    -------------------------------
  4944     05  FILLER            PIC  X(0003).
  4945     05  CMTHD2O PIC  X(0001).
  4946*    -------------------------------
  4947     05  FILLER            PIC  X(0003).
  4948     05  CLIVESO PIC  X(0003).
  4949*    -------------------------------
  4950     05  FILLER            PIC  X(0003).
  4951     05  CFORCEO PIC  X(0001).
  4952*    -------------------------------
  4953     05  FILLER            PIC  X(0003).
  4954     05  CBILCDO PIC  X(0001).
  4955*    -------------------------------
  4956     05  FILLER            PIC  X(0003).
  4957     05  CCRFND1O PIC  Z(7).99-.
  4958*    -------------------------------
  4959     05  FILLER            PIC  X(0003).
  4960     05  CCRFND2O PIC  Z(7).99-.
  4961*    -------------------------------
  4962     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  93
* EL6311.cbl
  4963     05  CBILIT1O PIC  X(0008).
  4964*    -------------------------------
  4965     05  FILLER            PIC  X(0003).
  4966     05  CDRFND1O PIC  Z(7).99-.
  4967*    -------------------------------
  4968     05  FILLER            PIC  X(0003).
  4969     05  CBILIT2O PIC  X(0008).
  4970*    -------------------------------
  4971     05  FILLER            PIC  X(0003).
  4972     05  CDRFND2O PIC  Z(7).99-.
  4973*    -------------------------------
  4974     05  FILLER            PIC  X(0003).
  4975     05  CCANTXTO PIC  X(0005).
  4976*    -------------------------------
  4977     05  FILLER            PIC  X(0003).
  4978     05  CCANFEEO PIC  Z9.
  4979*    -------------------------------
  4980     05  FILLER            PIC  X(0003).
  4981     05  CTERM1O PIC  ZZ9.
  4982*    -------------------------------
  4983     05  FILLER            PIC  X(0003).
  4984     05  CRTERM1O PIC  ZZ9.
  4985*    -------------------------------
  4986     05  FILLER            PIC  X(0003).
  4987     05  CPREM1O PIC  ZZZZZZ9.99-.
  4988*    -------------------------------
  4989     05  FILLER            PIC  X(0003).
  4990     05  CTERM2O PIC  ZZ9.
  4991*    -------------------------------
  4992     05  FILLER            PIC  X(0003).
  4993     05  CRTERM2O PIC  ZZ9.
  4994*    -------------------------------
  4995     05  FILLER            PIC  X(0003).
  4996     05  CPREM2O PIC  ZZZZZZ9.99-.
  4997*    -------------------------------
  4998     05  FILLER            PIC  X(0003).
  4999     05  CENTRDTO PIC  X(0008).
  5000*    -------------------------------
  5001     05  FILLER            PIC  X(0003).
  5002     05  CPAYEEO PIC  X(0006).
  5003*    -------------------------------
  5004     05  FILLER            PIC  X(0003).
  5005     05  CRFNDSWO PIC  X(0003).
  5006*    -------------------------------
  5007     05  FILLER            PIC  X(0003).
  5008     05  CLFHDGO PIC  X(0006).
  5009*    -------------------------------
  5010     05  FILLER            PIC  X(0003).
  5011     05  CAHHDGO PIC  X(0006).
  5012*    -------------------------------
  5013     05  FILLER            PIC  X(0003).
  5014     05  CENTDTO PIC  X(0008).
  5015*    -------------------------------
  5016     05  FILLER            PIC  X(0003).
  5017     05  CENTBYO PIC  X(0004).
  5018*    -------------------------------
  5019     05  FILLER            PIC  X(0003).
  5020     05  CCHGCNTO PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  94
* EL6311.cbl
  5021*    -------------------------------
  5022     05  FILLER            PIC  X(0003).
  5023     05  CLFREFNO PIC  X(0006).
  5024*    -------------------------------
  5025     05  FILLER            PIC  X(0003).
  5026     05  CAHREFNO PIC  X(0006).
  5027*    -------------------------------
  5028     05  FILLER            PIC  X(0003).
  5029     05  CREINCDO PIC  X(0003).
  5030*    -------------------------------
  5031     05  FILLER            PIC  X(0003).
  5032     05  CAEFFDTO PIC  X(0008).
  5033*    -------------------------------
  5034     05  FILLER            PIC  X(0003).
  5035     05  CAEXPDTO PIC  X(0008).
  5036*    -------------------------------
  5037     05  FILLER            PIC  X(0003).
  5038     05  COMMLFO PIC  .99999.
  5039*    -------------------------------
  5040     05  FILLER            PIC  X(0003).
  5041     05  COMMAHO PIC  .99999.
  5042*    -------------------------------
  5043     05  FILLER            PIC  X(0003).
  5044     05  CERMSG1O PIC  X(0078).
  5045*    -------------------------------
  5046     05  FILLER            PIC  X(0003).
  5047     05  CERMSG2O PIC  X(0078).
  5048*    -------------------------------
  5049     05  FILLER            PIC  X(0003).
  5050     05  CERMSG3O PIC  X(0078).
  5051*    -------------------------------
  5052     05  FILLER            PIC  X(0003).
  5053     05  CPFENTRO PIC  X(0002).
  5054*    -------------------------------
  5055     05  FILLER            PIC  X(0003).
  5056     05  CPF5HDRO PIC  X(0005).
  5057*    -------------------------------
  5058     05  FILLER            PIC  X(0003).
  5059     05  CPF4HDRO PIC  X(0013).
  5060*    -------------------------------
  5061     05  FILLER            PIC  X(0003).
  5062     05  CF15HDRO PIC  X(0022).
  5063*    -------------------------------
  5064 01  EL631DI REDEFINES EL631BI.
  5065     05  FILLER            PIC  X(0012).
  5066*    -------------------------------
  5067     05  DDATEL PIC S9(0004) COMP.
  5068     05  DDATEF PIC  X(0001).
  5069     05  FILLER REDEFINES DDATEF.
  5070         10  DDATEA PIC  X(0001).
  5071     05  DDATEI PIC  X(0008).
  5072*    -------------------------------
  5073     05  DTIMEL PIC S9(0004) COMP.
  5074     05  DTIMEF PIC  X(0001).
  5075     05  FILLER REDEFINES DTIMEF.
  5076         10  DTIMEA PIC  X(0001).
  5077     05  DTIMEI PIC  X(0005).
  5078*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  95
* EL6311.cbl
  5079     05  DHEADL PIC S9(0004) COMP.
  5080     05  DHEADF PIC  X(0001).
  5081     05  FILLER REDEFINES DHEADF.
  5082         10  DHEADA PIC  X(0001).
  5083     05  DHEADI PIC  X(0038).
  5084*    -------------------------------
  5085     05  DLDATEL PIC S9(0004) COMP.
  5086     05  DLDATEF PIC  X(0001).
  5087     05  FILLER REDEFINES DLDATEF.
  5088         10  DLDATEA PIC  X(0001).
  5089     05  DLDATEI PIC  X(0010).
  5090*    -------------------------------
  5091     05  DBATCHL PIC S9(0004) COMP.
  5092     05  DBATCHF PIC  X(0001).
  5093     05  FILLER REDEFINES DBATCHF.
  5094         10  DBATCHA PIC  X(0001).
  5095     05  DBATCHI PIC  X(0011).
  5096*    -------------------------------
  5097     05  DACCTNML PIC S9(0004) COMP.
  5098     05  DACCTNMF PIC  X(0001).
  5099     05  FILLER REDEFINES DACCTNMF.
  5100         10  DACCTNMA PIC  X(0001).
  5101     05  DACCTNMI PIC  X(0030).
  5102*    -------------------------------
  5103     05  DPROCDTL PIC S9(0004) COMP.
  5104     05  DPROCDTF PIC  X(0001).
  5105     05  FILLER REDEFINES DPROCDTF.
  5106         10  DPROCDTA PIC  X(0001).
  5107     05  DPROCDTI PIC  X(0008).
  5108*    -------------------------------
  5109     05  DINPUTL PIC S9(0004) COMP.
  5110     05  DINPUTF PIC  X(0001).
  5111     05  FILLER REDEFINES DINPUTF.
  5112         10  DINPUTA PIC  X(0001).
  5113     05  DINPUTI PIC  X(0008).
  5114*    -------------------------------
  5115     05  DMAINDTL PIC S9(0004) COMP.
  5116     05  DMAINDTF PIC  X(0001).
  5117     05  FILLER REDEFINES DMAINDTF.
  5118         10  DMAINDTA PIC  X(0001).
  5119     05  DMAINDTI PIC  X(0008).
  5120*    -------------------------------
  5121     05  DCARRL PIC S9(0004) COMP.
  5122     05  DCARRF PIC  X(0001).
  5123     05  FILLER REDEFINES DCARRF.
  5124         10  DCARRA PIC  X(0001).
  5125     05  DCARRI PIC  X(0001).
  5126*    -------------------------------
  5127     05  DGROUPL PIC S9(0004) COMP.
  5128     05  DGROUPF PIC  X(0001).
  5129     05  FILLER REDEFINES DGROUPF.
  5130         10  DGROUPA PIC  X(0001).
  5131     05  DGROUPI PIC  X(0006).
  5132*    -------------------------------
  5133     05  DSTATEL PIC S9(0004) COMP.
  5134     05  DSTATEF PIC  X(0001).
  5135     05  FILLER REDEFINES DSTATEF.
  5136         10  DSTATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  96
* EL6311.cbl
  5137     05  DSTATEI PIC  X(0002).
  5138*    -------------------------------
  5139     05  DACCTL PIC S9(0004) COMP.
  5140     05  DACCTF PIC  X(0001).
  5141     05  FILLER REDEFINES DACCTF.
  5142         10  DACCTA PIC  X(0001).
  5143     05  DACCTI PIC  X(0010).
  5144*    -------------------------------
  5145     05  DRECVDTL PIC S9(0004) COMP.
  5146     05  DRECVDTF PIC  X(0001).
  5147     05  FILLER REDEFINES DRECVDTF.
  5148         10  DRECVDTA PIC  X(0001).
  5149     05  DRECVDTI PIC  X(0008).
  5150*    -------------------------------
  5151     05  DCSRL PIC S9(0004) COMP.
  5152     05  DCSRF PIC  X(0001).
  5153     05  FILLER REDEFINES DCSRF.
  5154         10  DCSRA PIC  X(0001).
  5155     05  DCSRI PIC  X(0004).
  5156*    -------------------------------
  5157     05  DREFHDGL PIC S9(0004) COMP.
  5158     05  DREFHDGF PIC  X(0001).
  5159     05  FILLER REDEFINES DREFHDGF.
  5160         10  DREFHDGA PIC  X(0001).
  5161     05  DREFHDGI PIC  X(0010).
  5162*    -------------------------------
  5163     05  DREFL PIC S9(0004) COMP.
  5164     05  DREFF PIC  X(0001).
  5165     05  FILLER REDEFINES DREFF.
  5166         10  DREFA PIC  X(0001).
  5167     05  DREFI PIC  X(0012).
  5168*    -------------------------------
  5169     05  DLFPHDGL PIC S9(0004) COMP.
  5170     05  DLFPHDGF PIC  X(0001).
  5171     05  FILLER REDEFINES DLFPHDGF.
  5172         10  DLFPHDGA PIC  X(0001).
  5173     05  DLFPHDGI PIC  X(0010).
  5174*    -------------------------------
  5175     05  DAHPHDGL PIC S9(0004) COMP.
  5176     05  DAHPHDGF PIC  X(0001).
  5177     05  FILLER REDEFINES DAHPHDGF.
  5178         10  DAHPHDGA PIC  X(0001).
  5179     05  DAHPHDGI PIC  X(0010).
  5180*    -------------------------------
  5181     05  DLFRHDGL PIC S9(0004) COMP.
  5182     05  DLFRHDGF PIC  X(0001).
  5183     05  FILLER REDEFINES DLFRHDGF.
  5184         10  DLFRHDGA PIC  X(0001).
  5185     05  DLFRHDGI PIC  X(0009).
  5186*    -------------------------------
  5187     05  DAHRHDGL PIC S9(0004) COMP.
  5188     05  DAHRHDGF PIC  X(0001).
  5189     05  FILLER REDEFINES DAHRHDGF.
  5190         10  DAHRHDGA PIC  X(0001).
  5191     05  DAHRHDGI PIC  X(0009).
  5192*    -------------------------------
  5193     05  DRISSL PIC S9(0004) COMP.
  5194     05  DRISSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  97
* EL6311.cbl
  5195     05  FILLER REDEFINES DRISSF.
  5196         10  DRISSA PIC  X(0001).
  5197     05  DRISSI PIC  X(0005).
  5198*    -------------------------------
  5199     05  DRLFPRML PIC S9(0004) COMP.
  5200     05  DRLFPRMF PIC  X(0001).
  5201     05  FILLER REDEFINES DRLFPRMF.
  5202         10  DRLFPRMA PIC  X(0001).
  5203     05  DRLFPRMI PIC  S9(9)V99.
  5204*    -------------------------------
  5205     05  DRAHPRML PIC S9(0004) COMP.
  5206     05  DRAHPRMF PIC  X(0001).
  5207     05  FILLER REDEFINES DRAHPRMF.
  5208         10  DRAHPRMA PIC  X(0001).
  5209     05  DRAHPRMI PIC  S9(9)V99.
  5210*    -------------------------------
  5211     05  DRCANCL PIC S9(0004) COMP.
  5212     05  DRCANCF PIC  X(0001).
  5213     05  FILLER REDEFINES DRCANCF.
  5214         10  DRCANCA PIC  X(0001).
  5215     05  DRCANCI PIC  X(0005).
  5216*    -------------------------------
  5217     05  DRLFRFDL PIC S9(0004) COMP.
  5218     05  DRLFRFDF PIC  X(0001).
  5219     05  FILLER REDEFINES DRLFRFDF.
  5220         10  DRLFRFDA PIC  X(0001).
  5221     05  DRLFRFDI PIC  S9(9)V99.
  5222*    -------------------------------
  5223     05  DRAHRFDL PIC S9(0004) COMP.
  5224     05  DRAHRFDF PIC  X(0001).
  5225     05  FILLER REDEFINES DRAHRFDF.
  5226         10  DRAHRFDA PIC  X(0001).
  5227     05  DRAHRFDI PIC  S9(9)V99.
  5228*    -------------------------------
  5229     05  DEISSL PIC S9(0004) COMP.
  5230     05  DEISSF PIC  X(0001).
  5231     05  FILLER REDEFINES DEISSF.
  5232         10  DEISSA PIC  X(0001).
  5233     05  DEISSI PIC  X(0005).
  5234*    -------------------------------
  5235     05  DELFPRML PIC S9(0004) COMP.
  5236     05  DELFPRMF PIC  X(0001).
  5237     05  FILLER REDEFINES DELFPRMF.
  5238         10  DELFPRMA PIC  X(0001).
  5239     05  DELFPRMI PIC  X(0011).
  5240*    -------------------------------
  5241     05  DEAHPRML PIC S9(0004) COMP.
  5242     05  DEAHPRMF PIC  X(0001).
  5243     05  FILLER REDEFINES DEAHPRMF.
  5244         10  DEAHPRMA PIC  X(0001).
  5245     05  DEAHPRMI PIC  X(0011).
  5246*    -------------------------------
  5247     05  DECANCL PIC S9(0004) COMP.
  5248     05  DECANCF PIC  X(0001).
  5249     05  FILLER REDEFINES DECANCF.
  5250         10  DECANCA PIC  X(0001).
  5251     05  DECANCI PIC  X(0005).
  5252*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  98
* EL6311.cbl
  5253     05  DELFRFDL PIC S9(0004) COMP.
  5254     05  DELFRFDF PIC  X(0001).
  5255     05  FILLER REDEFINES DELFRFDF.
  5256         10  DELFRFDA PIC  X(0001).
  5257     05  DELFRFDI PIC  X(0011).
  5258*    -------------------------------
  5259     05  DEAHRFDL PIC S9(0004) COMP.
  5260     05  DEAHRFDF PIC  X(0001).
  5261     05  FILLER REDEFINES DEAHRFDF.
  5262         10  DEAHRFDA PIC  X(0001).
  5263     05  DEAHRFDI PIC  X(0011).
  5264*    -------------------------------
  5265     05  DCISSL PIC S9(0004) COMP.
  5266     05  DCISSF PIC  X(0001).
  5267     05  FILLER REDEFINES DCISSF.
  5268         10  DCISSA PIC  X(0001).
  5269     05  DCISSI PIC  X(0005).
  5270*    -------------------------------
  5271     05  DCLFPRML PIC S9(0004) COMP.
  5272     05  DCLFPRMF PIC  X(0001).
  5273     05  FILLER REDEFINES DCLFPRMF.
  5274         10  DCLFPRMA PIC  X(0001).
  5275     05  DCLFPRMI PIC  X(0011).
  5276*    -------------------------------
  5277     05  DCAHPRML PIC S9(0004) COMP.
  5278     05  DCAHPRMF PIC  X(0001).
  5279     05  FILLER REDEFINES DCAHPRMF.
  5280         10  DCAHPRMA PIC  X(0001).
  5281     05  DCAHPRMI PIC  X(0011).
  5282*    -------------------------------
  5283     05  DCCANCL PIC S9(0004) COMP.
  5284     05  DCCANCF PIC  X(0001).
  5285     05  FILLER REDEFINES DCCANCF.
  5286         10  DCCANCA PIC  X(0001).
  5287     05  DCCANCI PIC  X(0005).
  5288*    -------------------------------
  5289     05  DCLFRFDL PIC S9(0004) COMP.
  5290     05  DCLFRFDF PIC  X(0001).
  5291     05  FILLER REDEFINES DCLFRFDF.
  5292         10  DCLFRFDA PIC  X(0001).
  5293     05  DCLFRFDI PIC  X(0011).
  5294*    -------------------------------
  5295     05  DCAHRFDL PIC S9(0004) COMP.
  5296     05  DCAHRFDF PIC  X(0001).
  5297     05  FILLER REDEFINES DCAHRFDF.
  5298         10  DCAHRFDA PIC  X(0001).
  5299     05  DCAHRFDI PIC  X(0011).
  5300*    -------------------------------
  5301     05  DOISSL PIC S9(0004) COMP.
  5302     05  DOISSF PIC  X(0001).
  5303     05  FILLER REDEFINES DOISSF.
  5304         10  DOISSA PIC  X(0001).
  5305     05  DOISSI PIC  X(0005).
  5306*    -------------------------------
  5307     05  DOLFPRML PIC S9(0004) COMP.
  5308     05  DOLFPRMF PIC  X(0001).
  5309     05  FILLER REDEFINES DOLFPRMF.
  5310         10  DOLFPRMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page  99
* EL6311.cbl
  5311     05  DOLFPRMI PIC  X(0011).
  5312*    -------------------------------
  5313     05  DOAHPRML PIC S9(0004) COMP.
  5314     05  DOAHPRMF PIC  X(0001).
  5315     05  FILLER REDEFINES DOAHPRMF.
  5316         10  DOAHPRMA PIC  X(0001).
  5317     05  DOAHPRMI PIC  X(0011).
  5318*    -------------------------------
  5319     05  DOCANCL PIC S9(0004) COMP.
  5320     05  DOCANCF PIC  X(0001).
  5321     05  FILLER REDEFINES DOCANCF.
  5322         10  DOCANCA PIC  X(0001).
  5323     05  DOCANCI PIC  X(0005).
  5324*    -------------------------------
  5325     05  DOLFRFDL PIC S9(0004) COMP.
  5326     05  DOLFRFDF PIC  X(0001).
  5327     05  FILLER REDEFINES DOLFRFDF.
  5328         10  DOLFRFDA PIC  X(0001).
  5329     05  DOLFRFDI PIC  X(0011).
  5330*    -------------------------------
  5331     05  DOAHRFDL PIC S9(0004) COMP.
  5332     05  DOAHRFDF PIC  X(0001).
  5333     05  FILLER REDEFINES DOAHRFDF.
  5334         10  DOAHRFDA PIC  X(0001).
  5335     05  DOAHRFDI PIC  X(0011).
  5336*    -------------------------------
  5337     05  DITOTALL PIC S9(0004) COMP.
  5338     05  DITOTALF PIC  X(0001).
  5339     05  FILLER REDEFINES DITOTALF.
  5340         10  DITOTALA PIC  X(0001).
  5341     05  DITOTALI PIC  X(0005).
  5342*    -------------------------------
  5343     05  DIFATALL PIC S9(0004) COMP.
  5344     05  DIFATALF PIC  X(0001).
  5345     05  FILLER REDEFINES DIFATALF.
  5346         10  DIFATALA PIC  X(0001).
  5347     05  DIFATALI PIC  X(0005).
  5348*    -------------------------------
  5349     05  DIFORCEL PIC S9(0004) COMP.
  5350     05  DIFORCEF PIC  X(0001).
  5351     05  FILLER REDEFINES DIFORCEF.
  5352         10  DIFORCEA PIC  X(0001).
  5353     05  DIFORCEI PIC  X(0005).
  5354*    -------------------------------
  5355     05  DIHOLDL PIC S9(0004) COMP.
  5356     05  DIHOLDF PIC  X(0001).
  5357     05  FILLER REDEFINES DIHOLDF.
  5358         10  DIHOLDA PIC  X(0001).
  5359     05  DIHOLDI PIC  X(0005).
  5360*    -------------------------------
  5361     05  DIAVAILL PIC S9(0004) COMP.
  5362     05  DIAVAILF PIC  X(0001).
  5363     05  FILLER REDEFINES DIAVAILF.
  5364         10  DIAVAILA PIC  X(0001).
  5365     05  DIAVAILI PIC  X(0005).
  5366*    -------------------------------
  5367     05  DIGPREML PIC S9(0004) COMP.
  5368     05  DIGPREMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 100
* EL6311.cbl
  5369     05  FILLER REDEFINES DIGPREMF.
  5370         10  DIGPREMA PIC  X(0001).
  5371     05  DIGPREMI PIC  X(0011).
  5372*    -------------------------------
  5373     05  DIBPREML PIC S9(0004) COMP.
  5374     05  DIBPREMF PIC  X(0001).
  5375     05  FILLER REDEFINES DIBPREMF.
  5376         10  DIBPREMA PIC  X(0001).
  5377     05  DIBPREMI PIC  X(0011).
  5378*    -------------------------------
  5379     05  DCTOTALL PIC S9(0004) COMP.
  5380     05  DCTOTALF PIC  X(0001).
  5381     05  FILLER REDEFINES DCTOTALF.
  5382         10  DCTOTALA PIC  X(0001).
  5383     05  DCTOTALI PIC  X(0005).
  5384*    -------------------------------
  5385     05  DCFATALL PIC S9(0004) COMP.
  5386     05  DCFATALF PIC  X(0001).
  5387     05  FILLER REDEFINES DCFATALF.
  5388         10  DCFATALA PIC  X(0001).
  5389     05  DCFATALI PIC  X(0005).
  5390*    -------------------------------
  5391     05  DCFORCEL PIC S9(0004) COMP.
  5392     05  DCFORCEF PIC  X(0001).
  5393     05  FILLER REDEFINES DCFORCEF.
  5394         10  DCFORCEA PIC  X(0001).
  5395     05  DCFORCEI PIC  X(0005).
  5396*    -------------------------------
  5397     05  DCHOLDL PIC S9(0004) COMP.
  5398     05  DCHOLDF PIC  X(0001).
  5399     05  FILLER REDEFINES DCHOLDF.
  5400         10  DCHOLDA PIC  X(0001).
  5401     05  DCHOLDI PIC  X(0005).
  5402*    -------------------------------
  5403     05  DCAVAILL PIC S9(0004) COMP.
  5404     05  DCAVAILF PIC  X(0001).
  5405     05  FILLER REDEFINES DCAVAILF.
  5406         10  DCAVAILA PIC  X(0001).
  5407     05  DCAVAILI PIC  X(0005).
  5408*    -------------------------------
  5409     05  DCGPREML PIC S9(0004) COMP.
  5410     05  DCGPREMF PIC  X(0001).
  5411     05  FILLER REDEFINES DCGPREMF.
  5412         10  DCGPREMA PIC  X(0001).
  5413     05  DCGPREMI PIC  X(0011).
  5414*    -------------------------------
  5415     05  DCBPREML PIC S9(0004) COMP.
  5416     05  DCBPREMF PIC  X(0001).
  5417     05  FILLER REDEFINES DCBPREMF.
  5418         10  DCBPREMA PIC  X(0001).
  5419     05  DCBPREMI PIC  X(0011).
  5420*    -------------------------------
  5421     05  DNTOTALL PIC S9(0004) COMP.
  5422     05  DNTOTALF PIC  X(0001).
  5423     05  FILLER REDEFINES DNTOTALF.
  5424         10  DNTOTALA PIC  X(0001).
  5425     05  DNTOTALI PIC  X(0005).
  5426*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 101
* EL6311.cbl
  5427     05  DNFATALL PIC S9(0004) COMP.
  5428     05  DNFATALF PIC  X(0001).
  5429     05  FILLER REDEFINES DNFATALF.
  5430         10  DNFATALA PIC  X(0001).
  5431     05  DNFATALI PIC  X(0005).
  5432*    -------------------------------
  5433     05  DNFORCEL PIC S9(0004) COMP.
  5434     05  DNFORCEF PIC  X(0001).
  5435     05  FILLER REDEFINES DNFORCEF.
  5436         10  DNFORCEA PIC  X(0001).
  5437     05  DNFORCEI PIC  X(0005).
  5438*    -------------------------------
  5439     05  DNHOLDL PIC S9(0004) COMP.
  5440     05  DNHOLDF PIC  X(0001).
  5441     05  FILLER REDEFINES DNHOLDF.
  5442         10  DNHOLDA PIC  X(0001).
  5443     05  DNHOLDI PIC  X(0005).
  5444*    -------------------------------
  5445     05  DNAVAILL PIC S9(0004) COMP.
  5446     05  DNAVAILF PIC  X(0001).
  5447     05  FILLER REDEFINES DNAVAILF.
  5448         10  DNAVAILA PIC  X(0001).
  5449     05  DNAVAILI PIC  X(0005).
  5450*    -------------------------------
  5451     05  DNGPREML PIC S9(0004) COMP.
  5452     05  DNGPREMF PIC  X(0001).
  5453     05  FILLER REDEFINES DNGPREMF.
  5454         10  DNGPREMA PIC  X(0001).
  5455     05  DNGPREMI PIC  X(0011).
  5456*    -------------------------------
  5457     05  DNBPREML PIC S9(0004) COMP.
  5458     05  DNBPREMF PIC  X(0001).
  5459     05  FILLER REDEFINES DNBPREMF.
  5460         10  DNBPREMA PIC  X(0001).
  5461     05  DNBPREMI PIC  X(0011).
  5462*    -------------------------------
  5463     05  DERMSGL PIC S9(0004) COMP.
  5464     05  DERMSGF PIC  X(0001).
  5465     05  FILLER REDEFINES DERMSGF.
  5466         10  DERMSGA PIC  X(0001).
  5467     05  DERMSGI PIC  X(0075).
  5468*    -------------------------------
  5469     05  DPFENTRL PIC S9(0004) COMP.
  5470     05  DPFENTRF PIC  X(0001).
  5471     05  FILLER REDEFINES DPFENTRF.
  5472         10  DPFENTRA PIC  X(0001).
  5473     05  DPFENTRI PIC  9(2).
  5474 01  EL631DO REDEFINES EL631BI.
  5475     05  FILLER            PIC  X(0012).
  5476*    -------------------------------
  5477     05  FILLER            PIC  X(0003).
  5478     05  DDATEO PIC  X(0008).
  5479*    -------------------------------
  5480     05  FILLER            PIC  X(0003).
  5481     05  DTIMEO PIC  99.99.
  5482*    -------------------------------
  5483     05  FILLER            PIC  X(0003).
  5484     05  DHEADO PIC  X(0038).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 102
* EL6311.cbl
  5485*    -------------------------------
  5486     05  FILLER            PIC  X(0003).
  5487     05  DLDATEO PIC  X(0010).
  5488*    -------------------------------
  5489     05  FILLER            PIC  X(0003).
  5490     05  DBATCHO PIC  X(0011).
  5491*    -------------------------------
  5492     05  FILLER            PIC  X(0003).
  5493     05  DACCTNMO PIC  X(0030).
  5494*    -------------------------------
  5495     05  FILLER            PIC  X(0003).
  5496     05  DPROCDTO PIC  X(0008).
  5497*    -------------------------------
  5498     05  FILLER            PIC  X(0003).
  5499     05  DINPUTO PIC  X(0008).
  5500*    -------------------------------
  5501     05  FILLER            PIC  X(0003).
  5502     05  DMAINDTO PIC  X(0008).
  5503*    -------------------------------
  5504     05  FILLER            PIC  X(0003).
  5505     05  DCARRO PIC  X(0001).
  5506*    -------------------------------
  5507     05  FILLER            PIC  X(0003).
  5508     05  DGROUPO PIC  X(0006).
  5509*    -------------------------------
  5510     05  FILLER            PIC  X(0003).
  5511     05  DSTATEO PIC  X(0002).
  5512*    -------------------------------
  5513     05  FILLER            PIC  X(0003).
  5514     05  DACCTO PIC  X(0010).
  5515*    -------------------------------
  5516     05  FILLER            PIC  X(0003).
  5517     05  DRECVDTO PIC  X(0008).
  5518*    -------------------------------
  5519     05  FILLER            PIC  X(0003).
  5520     05  DCSRO PIC  X(0004).
  5521*    -------------------------------
  5522     05  FILLER            PIC  X(0003).
  5523     05  DREFHDGO PIC  X(0010).
  5524*    -------------------------------
  5525     05  FILLER            PIC  X(0003).
  5526     05  DREFO PIC  X(0012).
  5527*    -------------------------------
  5528     05  FILLER            PIC  X(0003).
  5529     05  DLFPHDGO PIC  X(0010).
  5530*    -------------------------------
  5531     05  FILLER            PIC  X(0003).
  5532     05  DAHPHDGO PIC  X(0010).
  5533*    -------------------------------
  5534     05  FILLER            PIC  X(0003).
  5535     05  DLFRHDGO PIC  X(0009).
  5536*    -------------------------------
  5537     05  FILLER            PIC  X(0003).
  5538     05  DAHRHDGO PIC  X(0009).
  5539*    -------------------------------
  5540     05  FILLER            PIC  X(0003).
  5541     05  DRISSO PIC  ZZ99-.
  5542*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 103
* EL6311.cbl
  5543     05  FILLER            PIC  X(0003).
  5544     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5545*    -------------------------------
  5546     05  FILLER            PIC  X(0003).
  5547     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5548*    -------------------------------
  5549     05  FILLER            PIC  X(0003).
  5550     05  DRCANCO PIC  ZZ99-.
  5551*    -------------------------------
  5552     05  FILLER            PIC  X(0003).
  5553     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5554*    -------------------------------
  5555     05  FILLER            PIC  X(0003).
  5556     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5557*    -------------------------------
  5558     05  FILLER            PIC  X(0003).
  5559     05  DEISSO PIC  ZZ99-.
  5560*    -------------------------------
  5561     05  FILLER            PIC  X(0003).
  5562     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5563*    -------------------------------
  5564     05  FILLER            PIC  X(0003).
  5565     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5566*    -------------------------------
  5567     05  FILLER            PIC  X(0003).
  5568     05  DECANCO PIC  ZZ99-.
  5569*    -------------------------------
  5570     05  FILLER            PIC  X(0003).
  5571     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5572*    -------------------------------
  5573     05  FILLER            PIC  X(0003).
  5574     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5575*    -------------------------------
  5576     05  FILLER            PIC  X(0003).
  5577     05  DCISSO PIC  ZZ99-.
  5578*    -------------------------------
  5579     05  FILLER            PIC  X(0003).
  5580     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5581*    -------------------------------
  5582     05  FILLER            PIC  X(0003).
  5583     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5584*    -------------------------------
  5585     05  FILLER            PIC  X(0003).
  5586     05  DCCANCO PIC  ZZ99-.
  5587*    -------------------------------
  5588     05  FILLER            PIC  X(0003).
  5589     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5590*    -------------------------------
  5591     05  FILLER            PIC  X(0003).
  5592     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5593*    -------------------------------
  5594     05  FILLER            PIC  X(0003).
  5595     05  DOISSO PIC  ZZ99-.
  5596*    -------------------------------
  5597     05  FILLER            PIC  X(0003).
  5598     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5599*    -------------------------------
  5600     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 104
* EL6311.cbl
  5601     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5602*    -------------------------------
  5603     05  FILLER            PIC  X(0003).
  5604     05  DOCANCO PIC  ZZ99-.
  5605*    -------------------------------
  5606     05  FILLER            PIC  X(0003).
  5607     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5608*    -------------------------------
  5609     05  FILLER            PIC  X(0003).
  5610     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5611*    -------------------------------
  5612     05  FILLER            PIC  X(0003).
  5613     05  DITOTALO PIC  ZZZ99.
  5614*    -------------------------------
  5615     05  FILLER            PIC  X(0003).
  5616     05  DIFATALO PIC  ZZZ99.
  5617*    -------------------------------
  5618     05  FILLER            PIC  X(0003).
  5619     05  DIFORCEO PIC  ZZZ99.
  5620*    -------------------------------
  5621     05  FILLER            PIC  X(0003).
  5622     05  DIHOLDO PIC  ZZZ99.
  5623*    -------------------------------
  5624     05  FILLER            PIC  X(0003).
  5625     05  DIAVAILO PIC  ZZZ99.
  5626*    -------------------------------
  5627     05  FILLER            PIC  X(0003).
  5628     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5629*    -------------------------------
  5630     05  FILLER            PIC  X(0003).
  5631     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5632*    -------------------------------
  5633     05  FILLER            PIC  X(0003).
  5634     05  DCTOTALO PIC  ZZZ99.
  5635*    -------------------------------
  5636     05  FILLER            PIC  X(0003).
  5637     05  DCFATALO PIC  ZZZ99.
  5638*    -------------------------------
  5639     05  FILLER            PIC  X(0003).
  5640     05  DCFORCEO PIC  ZZZ99.
  5641*    -------------------------------
  5642     05  FILLER            PIC  X(0003).
  5643     05  DCHOLDO PIC  ZZZ99.
  5644*    -------------------------------
  5645     05  FILLER            PIC  X(0003).
  5646     05  DCAVAILO PIC  ZZZ99.
  5647*    -------------------------------
  5648     05  FILLER            PIC  X(0003).
  5649     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5650*    -------------------------------
  5651     05  FILLER            PIC  X(0003).
  5652     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5653*    -------------------------------
  5654     05  FILLER            PIC  X(0003).
  5655     05  DNTOTALO PIC  ---99.
  5656*    -------------------------------
  5657     05  FILLER            PIC  X(0003).
  5658     05  DNFATALO PIC  ---99.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 105
* EL6311.cbl
  5659*    -------------------------------
  5660     05  FILLER            PIC  X(0003).
  5661     05  DNFORCEO PIC  ---99.
  5662*    -------------------------------
  5663     05  FILLER            PIC  X(0003).
  5664     05  DNHOLDO PIC  ---99.
  5665*    -------------------------------
  5666     05  FILLER            PIC  X(0003).
  5667     05  DNAVAILO PIC  ---99.
  5668*    -------------------------------
  5669     05  FILLER            PIC  X(0003).
  5670     05  DNGPREMO PIC  -------9.99.
  5671*    -------------------------------
  5672     05  FILLER            PIC  X(0003).
  5673     05  DNBPREMO PIC  -------9.99.
  5674*    -------------------------------
  5675     05  FILLER            PIC  X(0003).
  5676     05  DERMSGO PIC  X(0075).
  5677*    -------------------------------
  5678     05  FILLER            PIC  X(0003).
  5679     05  DPFENTRO PIC  X(0002).
  5680*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 106
* EL6311.cbl
  5682 01  MAP-B REDEFINES EL631BI.
  5683     12  FILLER                  PIC X(591).
  5684*    12  FILLER                  PIC X(512).
  5685*    12  FILLER                  PIC X(510).
  5686     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5687         16  BKIND-LEN               PIC S9(4)  COMP.
  5688         16  BKIND-ATTRB             PIC X.
  5689         16  BKIND                   PIC XX.
  5690         16  BTYPE-LEN               PIC S9(4)  COMP.
  5691         16  BTYPE-ATTRB             PIC X.
  5692         16  BTYPE                   PIC X(3).
  5693         16  BTERM-LEN               PIC S9(4)  COMP.
  5694         16  BTERM-ATTRB             PIC X.
  5695         16  BTERMI                  PIC 999.
  5696         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5697         16  BBEN-LEN                PIC S9(4)  COMP.
  5698         16  BBEN-ATTRB              PIC X.
  5699         16  BBENI                   PIC 9(10)V99.
  5700*        16  BBENI                   PIC 9(12).
  5701         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5702         16  BPREM-LEN               PIC S9(4)  COMP.
  5703         16  BPREM-ATTRB             PIC X.
  5704         16  BPREMI                  PIC S9(9)V99.
  5705*        16  BPREMI                  PIC 9(11).
  5706         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5707         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5708         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5709         16  BEXPIRE-ATTRB           PIC X.
  5710         16  BEXPIRE                 PIC X(8).
  5711         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5712         16  BCRIT-PERD-ATTRB        PIC X.
  5713         16  BCRIT-PERDI             PIC 99.
  5714         16  BCRIT-PERDO REDEFINES
  5715                         BCRIT-PERDI PIC ZZ.
  5716         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5717         16  BALT-BEN-ATTRB          PIC X.
  5718         16  BALT-BENI               PIC 9(10)V99.
  5719*        16  BALT-BENI               PIC 9(12).
  5720         16  BALT-BENO REDEFINES
  5721                           BALT-BENI PIC Z(9).ZZ.
  5722         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5723         16  BALT-PREM-ATTRB         PIC X.
  5724         16  BALT-PREMI              PIC 9(9)V99.
  5725*        16  BALT-PREMI              PIC 9(11).
  5726         16  BALT-PREMO REDEFINES
  5727                          BALT-PREMI PIC Z(7).ZZ-.
  5728         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5729         16  BBEN-CD-ATTRB           PIC X.
  5730         16  BBEN-CD                 PIC XXX.
  5731         16  BCPREM-LEN              PIC S9(4)  COMP.
  5732         16  BCPREM-ATTRB            PIC X.
  5733         16  BCPREMI                 PIC S9(9)V99.
  5734*        16  BCPREMI                 PIC X(11).
  5735         16  BCPREMO REDEFINES BCPREMI
  5736                                     PIC Z(7).99-.
  5737         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5738         16  BCALT-PREM-ATTRB        PIC X.
  5739         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 107
* EL6311.cbl
  5740         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5741         16  BBEN-ABBR-ATTRB         PIC X.
  5742         16  BBEN-ABBR               PIC X(5).
  5743         16  BDIFF-LEN               PIC S9(4)  COMP.
  5744         16  BDIFF-ATTRB             PIC X.
  5745         16  BDIFFO                  PIC Z(7).99-.
  5746         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5747         16  BBILL-LIT-ATTRB         PIC X.
  5748         16  BBILL-LIT               PIC X(8).
  5749         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5750         16  BDALT-PREM-ATTRB        PIC X.
  5751         16  BDALT-PREM              PIC Z(7).99-.
  5752
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 108
* EL6311.cbl
  5754
  5755****************************************************************
  5756*
  5757* Copyright (c) 2007-2013 Dell Inc.
  5758* All rights reserved.
  5759*
  5760****************************************************************
  5761 01  DFHEIV.
  5762   02  DFHEIV0               PIC X(35).
  5763   02  DFHEIV1               PIC X(08).
  5764   02  DFHEIV2               PIC X(08).
  5765   02  DFHEIV3               PIC X(08).
  5766   02  DFHEIV4               PIC X(06).
  5767   02  DFHEIV5               PIC X(04).
  5768   02  DFHEIV6               PIC X(04).
  5769   02  DFHEIV7               PIC X(02).
  5770   02  DFHEIV8               PIC X(02).
  5771   02  DFHEIV9               PIC X(01).
  5772   02  DFHEIV10              PIC S9(7) COMP-3.
  5773   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5774   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5775   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5776   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5777   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5778   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5779   02  DFHEIV17              PIC X(04).
  5780   02  DFHEIV18              PIC X(04).
  5781   02  DFHEIV19              PIC X(04).
  5782   02  DFHEIV20              USAGE IS POINTER.
  5783   02  DFHEIV21              USAGE IS POINTER.
  5784   02  DFHEIV22              USAGE IS POINTER.
  5785   02  DFHEIV23              USAGE IS POINTER.
  5786   02  DFHEIV24              USAGE IS POINTER.
  5787   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5788   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5789   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5790   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5791   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5792   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5793   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5794   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5795   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5796   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5797   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5798   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5799   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5800   02  FILLER                PIC X(02).
  5801   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5802   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5803   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5804   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5805   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5806   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5807   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5808 LINKAGE  SECTION.
  5809*****************************************************************
  5810*                                                               *
  5811* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 109
* EL6311.cbl
  5812* All rights reserved.                                          *
  5813*                                                               *
  5814*****************************************************************
  5815 01  dfheiblk.
  5816     02  eibtime          pic s9(7) comp-3.
  5817     02  eibdate          pic s9(7) comp-3.
  5818     02  eibtrnid         pic x(4).
  5819     02  eibtaskn         pic s9(7) comp-3.
  5820     02  eibtrmid         pic x(4).
  5821     02  dfheigdi         pic s9(4) comp.
  5822     02  eibcposn         pic s9(4) comp.
  5823     02  eibcalen         pic s9(4) comp.
  5824     02  eibaid           pic x(1).
  5825     02  eibfiller1       pic x(1).
  5826     02  eibfn            pic x(2).
  5827     02  eibfiller2       pic x(2).
  5828     02  eibrcode         pic x(6).
  5829     02  eibfiller3       pic x(2).
  5830     02  eibds            pic x(8).
  5831     02  eibreqid         pic x(8).
  5832     02  eibrsrce         pic x(8).
  5833     02  eibsync          pic x(1).
  5834     02  eibfree          pic x(1).
  5835     02  eibrecv          pic x(1).
  5836     02  eibsend          pic x(1).
  5837     02  eibatt           pic x(1).
  5838     02  eibeoc           pic x(1).
  5839     02  eibfmh           pic x(1).
  5840     02  eibcompl         pic x(1).
  5841     02  eibsig           pic x(1).
  5842     02  eibconf          pic x(1).
  5843     02  eiberr           pic x(1).
  5844     02  eibrldbk         pic x(1).
  5845     02  eiberrcd         pic x(4).
  5846     02  eibsynrb         pic x(1).
  5847     02  eibnodat         pic x(1).
  5848     02  eibfiller5       pic x(2).
  5849     02  eibresp          pic s9(8) comp.
  5850     02  eibresp2         pic s9(8) comp.
  5851     02  dfheigdj         pic s9(4) comp.
  5852     02  dfheigdk         pic s9(4) comp.
  5853 01  DFHCOMMAREA                 PIC X(1300).
  5854*                                COPY ERCPNDB.
  5855******************************************************************
  5856*                                                                *
  5857*                                                                *
  5858*                            ERCPNDB.                            *
  5859*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5860*                            VMOD=2.025                          *
  5861*                                                                *
  5862*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5863*                                                                *
  5864******************************************************************
  5865*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5866*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5867******************************************************************
  5868*                                                                *
  5869*                                                                *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 110
* EL6311.cbl
  5870*   FILE TYPE = VSAM,KSDS                                        *
  5871*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5872*                                                                *
  5873*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5874*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5875*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5876*                                                 RKP=13,LEN=36  *
  5877*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5878*                                      AND CHG-SEQ.)             *
  5879*                                                RKP=49,LEN=11   *
  5880*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5881*                                      AND CHG-SEQ.)             *
  5882*                                                RKP=60,LEN=15   *
  5883*                                                                *
  5884*   LOG = NO                                                     *
  5885*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5886******************************************************************
  5887******************************************************************
  5888*                   C H A N G E   L O G
  5889*
  5890* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5891*-----------------------------------------------------------------
  5892*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5893* EFFECTIVE    NUMBER
  5894*-----------------------------------------------------------------
  5895* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5896* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5897* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5898* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5899* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5900* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5901* 032306                   PEMA  ADD BOW LOAN NUMBER
  5902* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5903* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5904* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5905* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5906* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5907* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5908* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5909* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5910* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  5911* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5912* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  5913* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  5914******************************************************************
  5915
  5916 01  PENDING-BUSINESS.
  5917     12  PB-RECORD-ID                     PIC XX.
  5918         88  VALID-PB-ID                        VALUE 'PB'.
  5919
  5920     12  PB-CONTROL-PRIMARY.
  5921         16  PB-COMPANY-CD                PIC X.
  5922         16  PB-ENTRY-BATCH               PIC X(6).
  5923         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5924         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5925
  5926     12  PB-CONTROL-BY-ACCOUNT.
  5927         16  PB-COMPANY-CD-A1             PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 111
* EL6311.cbl
  5928         16  PB-CARRIER                   PIC X.
  5929         16  PB-GROUPING.
  5930             20  PB-GROUPING-PREFIX       PIC XXX.
  5931             20  PB-GROUPING-PRIME        PIC XXX.
  5932         16  PB-STATE                     PIC XX.
  5933         16  PB-ACCOUNT.
  5934             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5935             20  PB-ACCOUNT-PRIME         PIC X(6).
  5936         16  PB-CERT-EFF-DT               PIC XX.
  5937         16  PB-CERT-NO.
  5938             20  PB-CERT-PRIME            PIC X(10).
  5939             20  PB-CERT-SFX              PIC X.
  5940         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5941
  5942         16  PB-RECORD-TYPE               PIC X.
  5943             88  PB-MAILING-DATA                VALUE '0'.
  5944             88  PB-ISSUE                       VALUE '1'.
  5945             88  PB-CANCELLATION                VALUE '2'.
  5946             88  PB-BATCH-TRAILER               VALUE '9'.
  5947
  5948     12  PB-CONTROL-BY-ORIG-BATCH.
  5949         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5950         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5951         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5952         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5953
  5954     12  PB-CONTROL-BY-CSR.
  5955         16  PB-CSR-COMPANY-CD            PIC X.
  5956         16  PB-CSR-ID                    PIC X(4).
  5957         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5958         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5959         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5960******************************************************************
  5961*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5962******************************************************************
  5963
  5964     12  PB-LAST-MAINT-DT                 PIC XX.
  5965     12  PB-LAST-MAINT-BY                 PIC X(4).
  5966     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5967
  5968     12  PB-RECORD-BODY                   PIC X(375).
  5969
  5970     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5971         16  PB-CERT-ORIGIN               PIC X.
  5972             88  CLASIC-CREATED-CERT         VALUE '1'.
  5973         16  PB-I-NAME.
  5974             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5975             20  PB-I-INSURED-FIRST-NAME.
  5976                 24  PB-I-INSURED-1ST-INIT PIC X.
  5977                 24  FILLER                PIC X(9).
  5978             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5979         16  PB-I-AGE                     PIC S99   COMP-3.
  5980         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5981         16  PB-I-BIRTHDAY                PIC XX.
  5982         16  PB-I-INSURED-SEX             PIC X.
  5983             88  PB-SEX-MALE     VALUE 'M'.
  5984             88  PB-SEX-FEMALE   VALUE 'F'.
  5985
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 112
* EL6311.cbl
  5986         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5987         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5988         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5989         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5990         16  PB-I-SKIP-CODE               PIC X.
  5991             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5992             88  PB-SKIP-JULY              VALUE '1'.
  5993             88  PB-SKIP-AUGUST            VALUE '2'.
  5994             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5995             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5996             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5997             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5998             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5999             88  PB-SKIP-JUNE              VALUE '8'.
  6000             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  6001             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  6002             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  6003         16  PB-I-TERM-TYPE               PIC X.
  6004             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  6005             88  PB-PAID-WEEKLY            VALUE 'W'.
  6006             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  6007             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  6008             88  PB-PAID-13-YEARLY         VALUE 'T'.
  6009         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  6010         16  PB-I-POLICY-FORM-NO          PIC X(12).
  6011         16  PB-I-DATA-ENTRY-SW           PIC X.
  6012             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6013             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6014             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6015             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6016         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6017         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6018*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6019         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6020         16  FILLER                       PIC X.
  6021
  6022         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6023             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6024             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6025                                                   '90' THRU '99'.
  6026         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6027                                          PIC XX.
  6028         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6029         16  PB-I-AMOUNT-FINANCED REDEFINES
  6030                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6031         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6032         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6033                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6034         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6035         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6036         16  PB-I-CLP-AMOUNT REDEFINES
  6037                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6038         16  PB-I-LF-CALC-FLAG            PIC X.
  6039             88 PB-COMP-LF-PREM               VALUE '?'.
  6040         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6041         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6042         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  6043         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 113
* EL6311.cbl
  6044         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6045         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6046         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6047         16  PB-I-LF-ABBR                 PIC XXX.
  6048         16  PB-I-LF-INPUT-CD             PIC XX.
  6049
  6050         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6051             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6052             88  PB-INVALID-AH               VALUE '  ' '00'
  6053                                                   '90' THRU '99'.
  6054         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6055         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6056         16  PB-I-AH-CALC-FLAG            PIC X.
  6057             88 PB-COMP-AH-PREM                  VALUE '?'.
  6058         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6059         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6060         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  6061         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6062         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6063         16  PB-I-AH-ABBR                 PIC XXX.
  6064         16  PB-I-AH-INPUT-CD             PIC XXX.
  6065
  6066         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6067         16  PB-I-REIN-TABLE              PIC XXX.
  6068         16  PB-I-BUSINESS-TYPE           PIC 99.
  6069         16  PB-I-INDV-GRP-CD             PIC X.
  6070         16  PB-I-MORT-CODE.
  6071             20  PB-I-TABLE               PIC X.
  6072             20  PB-I-INTEREST            PIC XX.
  6073             20  PB-I-MORT-TYP            PIC X.
  6074         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6075         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6076         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6077         16  PB-I-INDV-GRP-OVRD           PIC X.
  6078         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6079         16  PB-I-SIG-SW                  PIC X.
  6080             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6081         16  PB-I-RATE-CLASS              PIC XX.
  6082         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6083         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6084         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6085         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6086         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6087         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6088         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6089         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6090         16  PB-I-OB-FLAG                 PIC X.
  6091             88  PB-I-OB                      VALUE 'B'.
  6092             88  PB-I-SUMMARY                 VALUE 'Z'.
  6093         16  PB-I-ENTRY-STATUS            PIC X.
  6094             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6095                                              'M' '5' '9' '2'.
  6096             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6097             88  PB-I-POLICY-PENDING          VALUE '2'.
  6098             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6099             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6100             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  6101             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 114
* EL6311.cbl
  6102             88  PB-I-REIN-ONLY               VALUE '9'.
  6103             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6104             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6105             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6106             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6107         16  PB-I-INT-CODE                PIC X.
  6108             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6109             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6110         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6111         16  PB-I-SOC-SEC-NO              PIC X(11).
  6112         16  PB-I-MEMBER-NO               PIC X(12).
  6113         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6114*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6115         16  PB-I-OLD-LOF                 PIC XXX.
  6116         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6117         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6118         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6119         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6120         16  PB-I-LIFE-INDICATOR          PIC X.
  6121             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6122         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6123         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6124                                          PIC S9(5)V99    COMP-3.
  6125         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6126             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6127             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6128         16  PB-I-1ST-PMT-DT              PIC XX.
  6129         16  PB-I-JOINT-INSURED.
  6130             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6131             20 PB-I-JOINT-FIRST-NAME.
  6132                24  PB-I-JOINT-FIRST-INIT PIC X.
  6133                24  FILLER                PIC X(9).
  6134             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6135*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6136         16  PB-I-BENEFICIARY-NAME.
  6137             20  PB-I-BANK-NUMBER         PIC X(10).
  6138             20  FILLER                   PIC X(15).
  6139         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6140         16  PB-I-REFERENCE               PIC X(12).
  6141         16  FILLER REDEFINES PB-I-REFERENCE.
  6142             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6143             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6144             20  PB-I-CLP-STATE           PIC XX.
  6145         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6146             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6147             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6148             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6149         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6150         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6151         16  PB-I-RESIDENT-STATE          PIC XX.
  6152         16  PB-I-RATE-CODE               PIC X(4).
  6153         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6154         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6155         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6156         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6157         16  PB-I-BANK-NOCHRGB            PIC 99.
  6158         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6159         16  PB-I-JOINT-BIRTHDAY          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 115
* EL6311.cbl
  6160
  6161     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6162         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6163             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6164         16  PB-C-CANCEL-ORIGIN           PIC X.
  6165             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6166         16  PB-C-LF-CANCEL-DT            PIC XX.
  6167         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6168         16  PB-C-LF-CALC-REQ             PIC X.
  6169             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6170         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6171         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6172         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6173             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6174         16  PB-C-AH-CANCEL-DT            PIC XX.
  6175         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6176         16  PB-C-AH-CALC-REQ             PIC X.
  6177             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6178         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6179         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6180         16  PB-C-LAST-NAME               PIC X(15).
  6181         16  PB-C-REFUND-SW               PIC X.
  6182             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6183             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6184         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6185         16  PB-C-PAYEE-CODE              PIC X(6).
  6186         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6187         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6188         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6189         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6190         16  PB-C-REFERENCE               PIC X(12).
  6191         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6192         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6193         16  PB-C-POST-CARD-IND           PIC X.
  6194         16  PB-C-CANCEL-REASON           PIC X.
  6195         16  PB-C-REF-INTERFACE-SW        PIC X.
  6196         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6197         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6198         16  FILLER                       PIC X(01).
  6199*        16  FILLER                       PIC X(18).
  6200         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6201*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6202         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  6203         16  PB-CANCELED-CERT-DATA.
  6204             20  PB-CI-INSURED-NAME.
  6205                 24  PB-CI-LAST-NAME      PIC X(15).
  6206                 24  PB-CI-INITIALS       PIC XX.
  6207             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6208             20  PB-CI-INSURED-SEX        PIC X.
  6209             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6210             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6211             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6212             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6213             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6214             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6215             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6216             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6217             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 116
* EL6311.cbl
  6218             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6219             20  PB-CI-RATE-CLASS         PIC XX.
  6220             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6221             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6222             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6223             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6224             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6225             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6226             20  PB-CI-LF-ABBR            PIC X(3).
  6227             20  PB-CI-AH-ABBR            PIC X(3).
  6228             20  PB-CI-OB-FLAG            PIC X.
  6229                 88  PB-CI-OB                VALUE 'B'.
  6230             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6231                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6232                                           'M' '4' '5' '9' '2'.
  6233                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6234                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6235                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6236                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6237                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6238                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6239                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6240                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6241                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6242                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6243                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6244                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6245                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6246             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6247                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6248                                           'M' '4' '5' '9' '2'.
  6249                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6250                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6251                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6252                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6253                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6254                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6255                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6256                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6257                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6258                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6259                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6260                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6261                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6262             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6263             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6264             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6265             20  PB-CI-MEMBER-NO          PIC X(12).
  6266             20  PB-CI-INT-CODE           PIC X.
  6267                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6268                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6269             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6270             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6271             20  PB-CI-COMP-EXCP-SW       PIC X.
  6272                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6273                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6274             20  PB-CI-ENTRY-STATUS       PIC X.
  6275             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 117
* EL6311.cbl
  6276             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6277             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6278             20  PB-CI-DEATH-DT           PIC XX.
  6279             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6280             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6281             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6282             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6283             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6284             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6285             20  PB-CI-ENTRY-DT              PIC XX.
  6286             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6287             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6288             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6289             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6290             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6291             20  PB-CI-OLD-LOF               PIC XXX.
  6292*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6293             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6294             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6295             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6296             20  PB-CI-INDV-GRP-CD           PIC X.
  6297             20  PB-CI-BENEFICIARY-NAME.
  6298                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6299                 24  FILLER                  PIC X(15).
  6300             20  PB-CI-NOTE-SW               PIC X.
  6301             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6302             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6303             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6304             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6305             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6306             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6307             20  PB-CI-FIRST-NAME            PIC X(10).
  6308             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6309
  6310         16  FILLER                       PIC X(13).
  6311*032306  16  FILLER                       PIC X(27).
  6312*        16  FILLER                       PIC X(46).
  6313
  6314     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6315         16  FILLER                       PIC X(10).
  6316         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6317         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6318         16  PB-M-INSURED-MID-INIT        PIC X.
  6319         16  PB-M-INSURED-AGE             PIC 99.
  6320         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6321         16  PB-M-INSURED-SEX             PIC X.
  6322         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6323         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6324         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6325         16  PB-M-INSURED-CITY-STATE.
  6326             20  PB-M-INSURED-CITY        PIC X(28).
  6327             20  PB-M-INSURED-STATE       PIC XX.
  6328         16  PB-M-INSURED-ZIP-CODE.
  6329             20  PB-M-INSURED-ZIP-PRIME.
  6330                 24  PB-M-INSURED-ZIP-1   PIC X.
  6331                     88  PB-M-CANADIAN-POST-CODE
  6332                                             VALUE 'A' THRU 'Z'.
  6333                 24  FILLER               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 118
* EL6311.cbl
  6334             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6335         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6336                                        PB-M-INSURED-ZIP-CODE.
  6337             20  PM-M-INS-CAN-POST1       PIC XXX.
  6338             20  PM-M-INS-CAN-POST2       PIC XXX.
  6339             20  FILLER                   PIC XXX.
  6340         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6341         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6342         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6343         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6344         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6345         16  PB-M-CRED-BENE-CITYST.
  6346             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6347             20  PB-M-CRED-BENE-STATE     PIC XX.
  6348         16  FILLER                       PIC X(92).
  6349
  6350     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6351         16  FILLER                       PIC X(10).
  6352         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6353         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6354         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6355         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6356         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6357         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6358         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6359         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6360         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6361         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6362         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6363         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6364         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6365         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6366         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6367         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6368         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6369         16  PB-ACCOUNT-NAME              PIC X(30).
  6370         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6371         16  PB-REFERENCE                 PIC X(12).
  6372         16  PB-B-RECEIVED-DT             PIC XX.
  6373         16  FILLER                       PIC X(234).
  6374
  6375     12  PB-RECORD-STATUS.
  6376         16  PB-CREDIT-SELECT-DT          PIC XX.
  6377         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6378         16  PB-BILLED-DT                 PIC XX.
  6379         16  PB-BILLING-STATUS            PIC X.
  6380             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6381             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6382             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6383         16  PB-RECORD-BILL               PIC X.
  6384             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6385             88  PB-RECORD-RETURNED           VALUE 'R'.
  6386             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6387             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6388             88  PB-OVERRIDE-AH               VALUE 'A'.
  6389             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6390         16  PB-BATCH-ENTRY               PIC X.
  6391             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 119
* EL6311.cbl
  6392             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6393             88  PB-REISSUED-CERT             VALUE 'E'.
  6394             88  PB-CASH-CERT                 VALUE 'C'.
  6395             88  PB-MONTHLY-CERT              VALUE 'M'.
  6396             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6397             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6398             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6399         16  PB-FORCE-CODE                PIC X.
  6400             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6401             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6402             88  PB-CANCEL-FORCE              VALUE '8'.
  6403             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6404             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6405             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6406             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6407             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6408             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6409             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6410             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6411         16  PB-FATAL-FLAG                PIC X.
  6412             88  PB-FATAL-ERRORS              VALUE 'X'.
  6413         16  PB-FORCE-ER-CD               PIC X.
  6414             88  PB-FORCE-ERRORS              VALUE 'F'.
  6415             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6416         16  PB-WARN-ER-CD                PIC X.
  6417             88  PB-WARNING-ERRORS            VALUE 'W'.
  6418         16  FILLER                       PIC X.
  6419         16  PB-OUT-BAL-CD                PIC X.
  6420             88  PB-OUT-OF-BAL                VALUE 'O'.
  6421         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6422         16  PB-AH-OVERRIDE-L1            PIC X.
  6423         16  PB-INPUT-DT                  PIC XX.
  6424         16  PB-INPUT-BY                  PIC X(4).
  6425         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6426         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6427         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6428         16  PB-LF-EARNING-METHOD         PIC X.
  6429         16  PB-AH-EARNING-METHOD         PIC X.
  6430         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6431         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6432         16  PB-REIN-CD                   PIC XXX.
  6433         16  PB-LF-REFUND-TYPE            PIC X.
  6434         16  PB-AH-REFUND-TYPE            PIC X.
  6435         16  PB-ACCT-EFF-DT               PIC XX.
  6436         16  PB-ACCT-EXP-DT               PIC XX.
  6437         16  PB-COMPANY-ID                PIC X(3).
  6438         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6439         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6440         16  PB-SV-CARRIER                PIC X.
  6441         16  PB-SV-GROUPING               PIC X(6).
  6442         16  PB-SV-STATE                  PIC XX.
  6443         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6444         16  PB-GA-BILLING-INFO.
  6445             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6446                                          PIC XX.
  6447         16  PB-SV-REMIT-TO  REDEFINES
  6448             PB-GA-BILLING-INFO           PIC X(10).
  6449         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 120
* EL6311.cbl
  6450         16  PB-I-LOAN-OFFICER            PIC X(5).
  6451         16  PB-I-VIN                     PIC X(17).
  6452
  6453         16  FILLER                       PIC X(04).
  6454         16  IMNET-BYPASS-SW              PIC X.
  6455
  6456******************************************************************
  6457*                COMMON EDIT ERRORS                              *
  6458******************************************************************
  6459
  6460     12  PB-COMMON-ERRORS.
  6461         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6462                                           PIC S9(4)     COMP.
  6463
  6464******************************************************************
  6465*                                COPY ELCCERT.
  6466******************************************************************
  6467*                                                                *
  6468*                            ELCCERT.                            *
  6469*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6470*                            VMOD=2.013                          *
  6471*                                                                *
  6472*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6473*                                                                *
  6474*   FILE TYPE = VSAM,KSDS                                        *
  6475*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6476*                                                                *
  6477*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6478*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6479*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6480*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6481*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6482*                                                                *
  6483*   LOG = YES                                                    *
  6484*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6485******************************************************************
  6486*                   C H A N G E   L O G
  6487*
  6488* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6489*-----------------------------------------------------------------
  6490*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6491* EFFECTIVE    NUMBER
  6492*-----------------------------------------------------------------
  6493* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6494* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6495* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6496* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6497* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6498* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6499* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6500* 032612  CR2011110200001  PEMA  AHL CHANGES
  6501* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6502* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6503* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  6504******************************************************************
  6505
  6506 01  CERTIFICATE-MASTER.
  6507     12  CM-RECORD-ID                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 121
* EL6311.cbl
  6508         88  VALID-CM-ID                      VALUE 'CM'.
  6509
  6510     12  CM-CONTROL-PRIMARY.
  6511         16  CM-COMPANY-CD                 PIC X.
  6512         16  CM-CARRIER                    PIC X.
  6513         16  CM-GROUPING.
  6514             20  CM-GROUPING-PREFIX        PIC X(3).
  6515             20  CM-GROUPING-PRIME         PIC X(3).
  6516         16  CM-STATE                      PIC XX.
  6517         16  CM-ACCOUNT.
  6518             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6519             20  CM-ACCOUNT-PRIME          PIC X(6).
  6520         16  CM-CERT-EFF-DT                PIC XX.
  6521         16  CM-CERT-NO.
  6522             20  CM-CERT-PRIME             PIC X(10).
  6523             20  CM-CERT-SFX               PIC X.
  6524
  6525     12  CM-CONTROL-BY-NAME.
  6526         16  CM-COMPANY-CD-A1              PIC X.
  6527         16  CM-INSURED-LAST-NAME          PIC X(15).
  6528         16  CM-INSURED-INITIALS.
  6529             20  CM-INSURED-INITIAL1       PIC X.
  6530             20  CM-INSURED-INITIAL2       PIC X.
  6531
  6532     12  CM-CONTROL-BY-SSN.
  6533         16  CM-COMPANY-CD-A2              PIC X.
  6534         16  CM-SOC-SEC-NO.
  6535             20  CM-SSN-STATE              PIC XX.
  6536             20  CM-SSN-ACCOUNT            PIC X(6).
  6537             20  CM-SSN-LN3.
  6538                 25  CM-INSURED-INITIALS-A2.
  6539                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6540                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6541                 25 CM-PART-LAST-NAME-A2         PIC X.
  6542
  6543     12  CM-CONTROL-BY-CERT-NO.
  6544         16  CM-COMPANY-CD-A4              PIC X.
  6545         16  CM-CERT-NO-A4                 PIC X(11).
  6546
  6547     12  CM-CONTROL-BY-MEMB.
  6548         16  CM-COMPANY-CD-A5              PIC X.
  6549         16  CM-MEMBER-NO.
  6550             20  CM-MEMB-STATE             PIC XX.
  6551             20  CM-MEMB-ACCOUNT           PIC X(6).
  6552             20  CM-MEMB-LN4.
  6553                 25  CM-INSURED-INITIALS-A5.
  6554                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6555                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6556                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6557
  6558     12  CM-INSURED-PROFILE-DATA.
  6559         16  CM-INSURED-FIRST-NAME.
  6560             20  CM-INSURED-1ST-INIT       PIC X.
  6561             20  FILLER                    PIC X(9).
  6562         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6563         16  CM-INSURED-SEX                PIC X.
  6564             88  CM-SEX-MALE                  VALUE 'M'.
  6565             88  CM-SEX-FEMAL                 VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 122
* EL6311.cbl
  6566         16  CM-INSURED-JOINT-AGE          PIC 99.
  6567         16  CM-JOINT-INSURED-NAME.
  6568             20  CM-JT-LAST-NAME           PIC X(15).
  6569             20  CM-JT-FIRST-NAME.
  6570                 24  CM-JT-1ST-INIT        PIC X.
  6571                 24  FILLER                PIC X(9).
  6572             20  CM-JT-INITIAL             PIC X.
  6573
  6574     12  CM-LIFE-DATA.
  6575         16  CM-LF-BENEFIT-CD              PIC XX.
  6576         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6577         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6578         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6579         16  CM-LF-DEV-CODE                PIC XXX.
  6580         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6581         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6582         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6583         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6584         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6585         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6586         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6587         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6588         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6589         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6590         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6591         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6592         16  cm-temp-epiq                  pic xx.
  6593             88  EPIQ-CLASS                  value 'EQ'.
  6594*        16  FILLER                        PIC XX.
  6595
  6596     12  CM-AH-DATA.
  6597         16  CM-AH-BENEFIT-CD              PIC XX.
  6598         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6599         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6600         16  CM-AH-DEV-CODE                PIC XXX.
  6601         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6602         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6603         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6604         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6605         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6606         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6607         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6608         16  CM-AH-PAID-THRU-DT            PIC XX.
  6609             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6610         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6611         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6612         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6613         16  FILLER                        PIC X.
  6614
  6615     12  CM-LOAN-INFORMATION.
  6616         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6617         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6618                                           PIC S9(5)V99  COMP-3.
  6619         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6620         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6621         16  CM-PAY-FREQUENCY              PIC S99.
  6622         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6623         16  CM-RATE-CLASS                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 123
* EL6311.cbl
  6624         16  CM-BENEFICIARY                PIC X(25).
  6625         16  CM-POLICY-FORM-NO             PIC X(12).
  6626         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6627         16  CM-LAST-ADD-ON-DT             PIC XX.
  6628         16  CM-DEDUCTIBLE-AMOUNTS.
  6629             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6630             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6631         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6632             20  CM-RESIDENT-STATE         PIC XX.
  6633             20  CM-RATE-CODE              PIC X(4).
  6634             20  FILLER                    PIC XX.
  6635         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6636             20  CM-LOAN-OFFICER           PIC X(5).
  6637             20  FILLER                    PIC XXX.
  6638         16  CM-CSR-CODE                   PIC XXX.
  6639         16  CM-UNDERWRITING-CODE          PIC X.
  6640             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6641         16  CM-POST-CARD-IND              PIC X.
  6642         16  CM-REF-INTERFACE-SW           PIC X.
  6643         16  CM-PREMIUM-TYPE               PIC X.
  6644             88  CM-SING-PRM                  VALUE '1'.
  6645             88  CM-O-B-COVERAGE              VALUE '2'.
  6646             88  CM-OPEN-END                  VALUE '3'.
  6647         16  CM-IND-GRP-TYPE               PIC X.
  6648             88  CM-INDIVIDUAL                VALUE 'I'.
  6649             88  CM-GROUP                     VALUE 'G'.
  6650         16  CM-SKIP-CODE                  PIC X.
  6651             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6652             88  SKIP-JULY                    VALUE '1'.
  6653             88  SKIP-AUGUST                  VALUE '2'.
  6654             88  SKIP-SEPTEMBER               VALUE '3'.
  6655             88  SKIP-JULY-AUG                VALUE '4'.
  6656             88  SKIP-AUG-SEPT                VALUE '5'.
  6657             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6658             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6659             88  SKIP-JUNE                    VALUE '8'.
  6660             88  SKIP-JUNE-JULY               VALUE '9'.
  6661             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6662             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6663         16  CM-PAYMENT-MODE               PIC X.
  6664             88  PAY-MONTHLY                  VALUE SPACE.
  6665             88  PAY-WEEKLY                   VALUE '1'.
  6666             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6667             88  PAY-BI-WEEKLY                VALUE '3'.
  6668             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6669         16  CM-LOAN-NUMBER                PIC X(8).
  6670         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6671         16  CM-OLD-LOF                    PIC XXX.
  6672*        16  CM-LOAN-OFFICER               PIC XXX.
  6673         16  CM-REIN-TABLE                 PIC XXX.
  6674         16  CM-SPECIAL-REIN-CODE          PIC X.
  6675         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6676         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6677         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6678
  6679     12  CM-STATUS-DATA.
  6680         16  CM-ENTRY-STATUS               PIC X.
  6681         16  CM-ENTRY-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 124
* EL6311.cbl
  6682
  6683         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6684         16  CM-LF-CANCEL-DT               PIC XX.
  6685         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6686
  6687         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6688         16  CM-LF-DEATH-DT                PIC XX.
  6689         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6690
  6691         16  CM-LF-CURRENT-STATUS          PIC X.
  6692             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6693                                                'M' '4' '5' '9'.
  6694             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6695             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6696             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6697             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6698             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6699             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6700             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6701             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6702             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6703             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6704             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6705             88  CM-LF-DECLINED               VALUE 'D'.
  6706             88  CM-LF-VOIDED                 VALUE 'V'.
  6707
  6708         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6709         16  CM-AH-CANCEL-DT               PIC XX.
  6710         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6711
  6712         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6713         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6714         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6715
  6716         16  CM-AH-CURRENT-STATUS          PIC X.
  6717             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6718                                                'M' '4' '5' '9'.
  6719             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6720             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6721             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6722             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6723             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6724             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6725             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6726             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6727             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6728             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6729             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6730             88  CM-AH-DECLINED               VALUE 'D'.
  6731             88  CM-AH-VOIDED                 VALUE 'V'.
  6732
  6733         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6734             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6735             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6736             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6737         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6738
  6739         16  CM-ENTRY-BATCH                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 125
* EL6311.cbl
  6740         16  CM-LF-EXIT-BATCH              PIC X(6).
  6741         16  CM-AH-EXIT-BATCH              PIC X(6).
  6742         16  CM-LAST-MONTH-END             PIC XX.
  6743
  6744     12  CM-NOTE-SW                        PIC X.
  6745         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6746         88  CERT-NOTES-PRESENT               VALUE '1'.
  6747         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6748         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6749         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6750         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6751         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6752         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6753     12  CM-COMP-EXCP-SW                   PIC X.
  6754         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6755         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6756     12  CM-INSURED-ADDRESS-SW             PIC X.
  6757         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6758         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6759
  6760*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6761     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6762     12  FILLER                            PIC X.
  6763
  6764*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6765     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6766     12  FILLER                            PIC X.
  6767*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6768     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  6769
  6770     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6771         88  CERT-ADDED-BATCH                 VALUE ' '.
  6772         88  CERT-ADDED-ONLINE                VALUE '1'.
  6773         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6774         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6775         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6776     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6777         88  CERT-AS-LOADED                   VALUE ' '.
  6778         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6779         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6780         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6781         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6782         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6783         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6784         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6785
  6786     12  CM-ACCOUNT-COMM-PCTS.
  6787         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6788         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6789
  6790     12  CM-USER-FIELD                     PIC X.
  6791     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6792     12  CM-CLP-STATE                      PIC XX.
  6793     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6794     12  CM-USER-RESERVED                  PIC XXX.
  6795     12  FILLER REDEFINES CM-USER-RESERVED.
  6796         16  CM-AH-CLASS-CD                PIC XX.
  6797         16  F                             PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 126
* EL6311.cbl
  6798******************************************************************
  6799*                                COPY ERCNOTE.
  6800******************************************************************
  6801*                                                                *
  6802*                                                                *
  6803*                            ERCNOTE                             *
  6804*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6805*                            VMOD=2.003                          *
  6806*                                                                *
  6807*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6808*                                                                *
  6809*        FILE TYPE= VSAM,KSDS                                    *
  6810*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6811*                                                                *
  6812*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6813*                                                                *
  6814*        LOG = YES                                               *
  6815*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6816*                                                                *
  6817******************************************************************
  6818*                   C H A N G E   L O G
  6819*
  6820* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6821*-----------------------------------------------------------------
  6822*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6823* EFFECTIVE    NUMBER
  6824*-----------------------------------------------------------------
  6825* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6826*                                FILE WILL CONTAIN BILLING NOTES O
  6827******************************************************************
  6828
  6829 01  CERTIFICATE-NOTE.
  6830     12  CN-RECORD-ID                PIC  XX.
  6831         88  VALID-CN-ID                  VALUE 'CN'.
  6832
  6833     12  CN-CONTROL-PRIMARY.
  6834         16  CN-COMPANY-CD           PIC X.
  6835         16  CN-CARRIER              PIC X.
  6836         16  CN-GROUPING.
  6837             20 CN-GROUPING-PREFIX   PIC XXX.
  6838             20 CN-GROUPING-PRIME    PIC XXX.
  6839         16  CN-STATE                PIC XX.
  6840         16  CN-ACCOUNT.
  6841             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6842             20 CN-ACCOUNT-PRIME     PIC X(6).
  6843         16  CN-CERT-EFF-DT          PIC XX.
  6844         16  CN-CERT-NO.
  6845             20  CN-CERT-PRIME       PIC X(10).
  6846             20  CN-CERT-SFX         PIC X.
  6847
  6848     12  CN-BILLING-START-LINE-NO    PIC 99.
  6849     12  CN-BILLING-END-LINE-NO      PIC 99.
  6850
  6851     12  CN-LINES.
  6852         16  CN-LINE OCCURS 10       PIC X(77).
  6853
  6854     12  CN-LAST-MAINT-DT            PIC XX.
  6855     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 127
* EL6311.cbl
  6856     12  CN-LAST-MAINT-USER          PIC X(4).
  6857     12  FILLER                      PIC X(6).
  6858******************************************************************
  6859*                                COPY ERCPNDM.
  6860******************************************************************
  6861*                                                                *
  6862*                                                                *
  6863*                            ERCPNDM                             *
  6864*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6865*                            VMOD=2.003                          *
  6866*                                                                *
  6867*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6868*                                                                *
  6869*   FILE TYPE = VSAM,KSDS                                        *
  6870*   RECORD SIZE = 374   RECFORM = FIX                            *
  6871*                                                                *
  6872*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6873*   ALTERNATE PATH    = NOT USED                                 *
  6874*                                                                *
  6875*   LOG = YES                                                    *
  6876*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6877******************************************************************
  6878*                   C H A N G E   L O G
  6879*
  6880* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6881*-----------------------------------------------------------------
  6882*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6883* EFFECTIVE    NUMBER
  6884*-----------------------------------------------------------------
  6885* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6886* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6887* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6888* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  6889******************************************************************
  6890
  6891 01  PENDING-MAILING-DATA.
  6892     12  PM-RECORD-ID                      PIC XX.
  6893         88  VALID-MA-ID                       VALUE 'PM'.
  6894
  6895     12  PM-CONTROL-PRIMARY.
  6896         16  PM-COMPANY-CD                 PIC X.
  6897         16  PM-ENTRY-BATCH                PIC X(6).
  6898         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6899         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6900
  6901     12  FILLER                            PIC X(14).
  6902
  6903     12  PM-ACCESS-CONTROL.
  6904         16  PM-SOURCE-SYSTEM              PIC XX.
  6905             88  PM-FROM-CREDIT                VALUE 'CR'.
  6906             88  PM-FROM-VSI                   VALUE 'VS'.
  6907             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6908             88  PM-FROM-OTHER                 VALUE 'OT'.
  6909         16  PM-RECORD-ADD-DT              PIC XX.
  6910         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6911         16  PM-LAST-MAINT-DT              PIC XX.
  6912         16  PM-LAST-MAINT-BY              PIC XXXX.
  6913         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 128
* EL6311.cbl
  6914
  6915     12  PM-PROFILE-INFO.
  6916         16  PM-QUALIFY-CODE-1             PIC XX.
  6917         16  PM-QUALIFY-CODE-2             PIC XX.
  6918         16  PM-QUALIFY-CODE-3             PIC XX.
  6919         16  PM-QUALIFY-CODE-4             PIC XX.
  6920         16  PM-QUALIFY-CODE-5             PIC XX.
  6921
  6922         16  PM-INSURED-LAST-NAME          PIC X(15).
  6923         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6924         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6925         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6926         16  PM-INSURED-BIRTH-DT           PIC XX.
  6927         16  PM-INSURED-SEX                PIC X.
  6928             88  PM-SEX-MALE                   VALUE 'M'.
  6929             88  PM-SEX-FEMALE                 VALUE 'F'.
  6930         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6931
  6932         16  PM-ADDRESS-CORRECTED          PIC X.
  6933         16  PM-JOINT-BIRTH-DT             PIC XX.
  6934*        16  FILLER                        PIC X(12).
  6935
  6936         16  PM-ADDRESS-LINE-1             PIC X(30).
  6937         16  PM-ADDRESS-LINE-2             PIC X(30).
  6938         16  PM-CITY-STATE.
  6939             20  PM-CITY                   PIC X(28).
  6940             20  PM-STATE                  PIC XX.
  6941         16  PM-ZIP.
  6942             20  PM-ZIP-CODE.
  6943                 24  PM-ZIP-1              PIC X.
  6944                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6945                 24  FILLER                PIC X(4).
  6946             20  PM-ZIP-PLUS4              PIC X(4).
  6947         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6948             20  PM-CAN-POST1              PIC XXX.
  6949             20  PM-CAN-POST2              PIC XXX.
  6950             20  FILLER                    PIC XXX.
  6951
  6952         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6953         16  pm-city-st-zip-verified       pic x.
  6954         16  FILLER                        PIC XX.
  6955
  6956     12  PM-CRED-BENE-INFO.
  6957         16  PM-CRED-BENE-NAME             PIC X(25).
  6958         16  PM-CRED-BENE-ADDR             PIC X(30).
  6959         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6960         16  PM-CRED-BENE-CTYST.
  6961             20  PM-CRED-BENE-CITY         PIC X(28).
  6962             20  PM-CRED-BENE-STATE        PIC XX.
  6963         16  PM-CRED-BENE-ZIP.
  6964             20  PM-CB-ZIP-CODE.
  6965                 24  PM-CB-ZIP-1           PIC X.
  6966                     88  PM-CB-CANADIAN-POST-CODE
  6967                                  VALUE 'A' THRU 'Z'.
  6968                 24  FILLER                PIC X(4).
  6969             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6970         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6971             20  PM-CB-CAN-POST1           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 129
* EL6311.cbl
  6972             20  PM-CB-CAN-POST2           PIC XXX.
  6973             20  FILLER                    PIC XXX.
  6974     12  PM-POST-CARD-MAIL-DATA.
  6975         16  PM-MAIL-DATA OCCURS 7.
  6976             20  PM-MAIL-TYPE              PIC X.
  6977                 88  PM-12MO-MAILING           VALUE '1'.
  6978                 88  PM-EXP-MAILING            VALUE '2'.
  6979             20  PM-MAIL-STATUS            PIC X.
  6980                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6981                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6982                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6983             20  PM-MAIL-DATE              PIC XX.
  6984     12  FILLER                            PIC XX.
  6985     12  FILLER                            PIC X(12).
  6986*    12  FILLER                            PIC X(30).
  6987
  6988******************************************************************
  6989*                                COPY ERCMAIL.
  6990******************************************************************
  6991*                                                                *
  6992*                                                                *
  6993*                            ERCMAIL                             *
  6994*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6995*                            VMOD=2.003                          *
  6996*                                                                *
  6997*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6998*                                                                *
  6999*   FILE TYPE = VSAM,KSDS                                        *
  7000*   RECORD SIZE = 374   RECFORM = FIX                            *
  7001*                                                                *
  7002*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7003*   ALTERNATE PATH    = NOT USED                                 *
  7004*                                                                *
  7005*   LOG = YES                                                    *
  7006*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7007******************************************************************
  7008*                   C H A N G E   L O G
  7009*
  7010* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7011*-----------------------------------------------------------------
  7012*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7013* EFFECTIVE    NUMBER
  7014*-----------------------------------------------------------------
  7015* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7016* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7017* 111108                   PEMA  ADD CRED BENE ADDR2
  7018******************************************************************
  7019
  7020 01  MAILING-DATA.
  7021     12  MA-RECORD-ID                      PIC XX.
  7022         88  VALID-MA-ID                       VALUE 'MA'.
  7023
  7024     12  MA-CONTROL-PRIMARY.
  7025         16  MA-COMPANY-CD                 PIC X.
  7026         16  MA-CARRIER                    PIC X.
  7027         16  MA-GROUPING.
  7028             20  MA-GROUPING-PREFIX        PIC XXX.
  7029             20  MA-GROUPING-PRIME         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 130
* EL6311.cbl
  7030         16  MA-STATE                      PIC XX.
  7031         16  MA-ACCOUNT.
  7032             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7033             20  MA-ACCOUNT-PRIME          PIC X(6).
  7034         16  MA-CERT-EFF-DT                PIC XX.
  7035         16  MA-CERT-NO.
  7036             20  MA-CERT-PRIME             PIC X(10).
  7037             20  MA-CERT-SFX               PIC X.
  7038
  7039     12  FILLER                            PIC XX.
  7040
  7041     12  MA-ACCESS-CONTROL.
  7042         16  MA-SOURCE-SYSTEM              PIC XX.
  7043             88  MA-FROM-CREDIT                VALUE 'CR'.
  7044             88  MA-FROM-VSI                   VALUE 'VS'.
  7045             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7046             88  MA-FROM-OTHER                 VALUE 'OT'.
  7047         16  MA-RECORD-ADD-DT              PIC XX.
  7048         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7049         16  MA-LAST-MAINT-DT              PIC XX.
  7050         16  MA-LAST-MAINT-BY              PIC XXXX.
  7051         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7052
  7053     12  MA-PROFILE-INFO.
  7054         16  MA-QUALIFY-CODE-1             PIC XX.
  7055         16  MA-QUALIFY-CODE-2             PIC XX.
  7056         16  MA-QUALIFY-CODE-3             PIC XX.
  7057         16  MA-QUALIFY-CODE-4             PIC XX.
  7058         16  MA-QUALIFY-CODE-5             PIC XX.
  7059
  7060         16  MA-INSURED-LAST-NAME          PIC X(15).
  7061         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7062         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7063         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7064         16  MA-INSURED-BIRTH-DT           PIC XX.
  7065         16  MA-INSURED-SEX                PIC X.
  7066             88  MA-SEX-MALE                   VALUE 'M'.
  7067             88  MA-SEX-FEMALE                 VALUE 'F'.
  7068         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7069
  7070         16  MA-ADDRESS-CORRECTED          PIC X.
  7071         16  MA-JOINT-BIRTH-DT             PIC XX.
  7072*        16  FILLER                        PIC X(12).
  7073
  7074         16  MA-ADDRESS-LINE-1             PIC X(30).
  7075         16  MA-ADDRESS-LINE-2             PIC X(30).
  7076         16  MA-CITY-STATE.
  7077             20  MA-CITY                   PIC X(28).
  7078             20  MA-ADDR-STATE             PIC XX.
  7079         16  MA-ZIP.
  7080             20  MA-ZIP-CODE.
  7081                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7082                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7083                 24  FILLER                PIC X(4).
  7084             20  MA-ZIP-PLUS4              PIC X(4).
  7085         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7086             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7087             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 131
* EL6311.cbl
  7088             20  FILLER                    PIC X(3).
  7089
  7090         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7091
  7092         16  FILLER                        PIC XXX.
  7093*        16  FILLER                        PIC X(10).
  7094
  7095     12  MA-CRED-BENE-INFO.
  7096         16  MA-CRED-BENE-NAME                 PIC X(25).
  7097         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7098         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7099         16  MA-CRED-BENE-CTYST.
  7100             20  MA-CRED-BENE-CITY             PIC X(28).
  7101             20  MA-CRED-BENE-STATE            PIC XX.
  7102         16  MA-CRED-BENE-ZIP.
  7103             20  MA-CB-ZIP-CODE.
  7104                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7105                     88  MA-CB-CANADIAN-POST-CODE
  7106                                           VALUE 'A' THRU 'Z'.
  7107                 24  FILLER                    PIC X(4).
  7108             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7109         16  MA-CB-CANADIAN-POSTAL-CODE
  7110                            REDEFINES MA-CRED-BENE-ZIP.
  7111             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7112             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7113             20  FILLER                        PIC X(3).
  7114     12  MA-POST-CARD-MAIL-DATA.
  7115         16  MA-MAIL-DATA OCCURS 7.
  7116             20  MA-MAIL-TYPE              PIC X.
  7117                 88  MA-12MO-MAILING           VALUE '1'.
  7118                 88  MA-EXP-MAILING            VALUE '2'.
  7119             20  MA-MAIL-STATUS            PIC X.
  7120                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7121                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7122                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7123             20  MA-MAIL-DATE              PIC XX.
  7124     12  FILLER                            PIC XX.
  7125     12  FILLER                            PIC XX.
  7126*    12  FILLER                            PIC X(30).
  7127******************************************************************
  7128*                                COPY ERCRQST.
  7129******************************************************************
  7130*                                                                *
  7131*                                                                *
  7132*                            ERCRQST.                            *
  7133*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7134*                            VMOD=2.002                          *
  7135*                                                                *
  7136*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7137*                                                                *
  7138*   FILE TYPE = VSAM,KSDS                                        *
  7139*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7140*                                                                *
  7141*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7142*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7143*                                   ACCOUNT, REF, BATCH)         *
  7144*                                                RKP=9, LEN=38   *
  7145*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 132
* EL6311.cbl
  7146*                                   ACCOUNT, REF, BATCH)         *
  7147*                                                RKP=47, LEN=46  *
  7148*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7149*                                   BATCH)                       *
  7150*                                                RKP=93, LEN=24  *
  7151*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7152*                                   REF, BATCH)                  *
  7153*                                                RKP=117, LEN=35 *
  7154*   LOG = NO                                                     *
  7155*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7156******************************************************************
  7157
  7158 01  AR-REQUEST-RECORD.
  7159     12  RQ-RECORD-ID                     PIC XX.
  7160         88  VALID-RQ-ID                        VALUE 'RQ'.
  7161
  7162     12  RQ-CONTROL-PRIMARY.
  7163         16  RQ-COMPANY-CD                PIC X.
  7164         16  RQ-ENTRY-BATCH               PIC X(6).
  7165
  7166     12  RQ-CONTROL-BY-ACCT-REF.
  7167         16  RQ-COMPANY-CD-A1             PIC X.
  7168         16  RQ-CARRIER-A1                PIC X.
  7169         16  RQ-GROUPING-A1               PIC X(6).
  7170         16  RQ-STATE-A1                  PIC XX.
  7171         16  RQ-ACCOUNT-A1                PIC X(10).
  7172         16  RQ-REFERENCE-A1              PIC X(12).
  7173         16  RQ-BATCH-A1                  PIC X(6).
  7174
  7175     12  RQ-CONTROL-BY-FIN-RESP.
  7176         16  RQ-COMPANY-CD-A2             PIC X.
  7177         16  RQ-CARRIER-A2                PIC X.
  7178         16  RQ-GROUPING-A2               PIC X(6).
  7179         16  RQ-FIN-RESP-A2               PIC X(10).
  7180         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7181         16  RQ-REFERENCE-A2              PIC X(12).
  7182         16  RQ-BATCH-A2                  PIC X(6).
  7183
  7184     12  RQ-CONTROL-BY-ACCT-AGENT.
  7185         16  RQ-COMPANY-CD-A3             PIC X.
  7186         16  RQ-CARRIER-A3                PIC X.
  7187         16  RQ-GROUPING-A3               PIC X(6).
  7188         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7189         16  RQ-BATCH-A3                  PIC X(6).
  7190
  7191     12  RQ-CONTROL-BY-SUMMARY.
  7192         16  RQ-COMPANY-CD-A4             PIC X.
  7193         16  RQ-SUMMARY-CODE              PIC X(6).
  7194         16  RQ-ACCOUNT-A4                PIC X(10).
  7195         16  RQ-REFERENCE-A4              PIC X(12).
  7196         16  RQ-BATCH-A4                  PIC X(6).
  7197
  7198     12  RQ-REQUEST-METHOD                PIC X.
  7199         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7200         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7201         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7202         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7203     12  FILLER                           PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 133
* EL6311.cbl
  7204     12  RQ-STATUS                        PIC X.
  7205         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7206         88  RQ-RESUBMIT                      VALUE 'R'.
  7207     12  RQ-PROCESSOR-ID                  PIC X(4).
  7208     12  RQ-ENTRY-DT                      PIC XX.
  7209     12  RQ-MO-END-DT                     PIC XX.
  7210     12  RQ-REQUEST-DT                    PIC XX.
  7211     12  RQ-STMT-DT                       PIC XX.
  7212     12  RQ-REVERSAL-DT                   PIC XX.
  7213     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7214     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7215
  7216     12  FILLER                           PIC X(27).
  7217
  7218******************************************************************
  7219
  7220*                                COPY ERCLOFC.
  7221******************************************************************
  7222*                                                                *
  7223*                                                                *
  7224*                            ERCLOFC                             *
  7225*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7226*                            VMOD=2.003                          *
  7227*                                                                *
  7228*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7229*                                                                *
  7230*   FILE TYPE = VSAM,KSDS                                        *
  7231*   RECORD SIZE = 670   RECFORM = FIX                            *
  7232*                                                                *
  7233*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7234*                                                                *
  7235*   LOG = YES                                                    *
  7236*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7237*                                                                *
  7238******************************************************************
  7239
  7240 01  LOAN-OFFICER-MASTER.
  7241     12  LO-RECORD-ID                PIC XX.
  7242         88  VALID-LO-ID                VALUE 'LO'.
  7243
  7244     12  LO-CONTROL-PRIMARY.
  7245         16  LO-COMPANY-CD           PIC X.
  7246         16  LO-CARRIER              PIC X.
  7247         16  LO-GROUPING.
  7248             20  LO-GROUPING-PREFIX  PIC XXX.
  7249             20  LO-GROUPING-PRIME   PIC XXX.
  7250         16  LO-STATE                PIC XX.
  7251         16  LO-ACCOUNT.
  7252             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7253             20  LO-ACCOUNT-PRIME    PIC X(6).
  7254         16  LO-OFFICER-CODE         PIC X(5).
  7255
  7256     12  LO-OFFICER-NAME             PIC X(30).
  7257
  7258     12  LO-LAST-MAINT-DT            PIC XX.
  7259     12  LO-LAST-USER                PIC X(4).
  7260     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7261
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 134
* EL6311.cbl
  7262     12  LO-COMP-CONTROL             PIC X.
  7263             88  LO-SHOW-COMP           VALUE 'Y'.
  7264             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7265     12  LO-DETAIL-CONTROL           PIC X.
  7266             88  LO-PRINT-DETAIL        VALUE 'D'.
  7267             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7268
  7269     12  LO-SV-CARRIER               PIC X.
  7270     12  LO-SV-GROUPING              PIC X(6).
  7271     12  LO-SV-STATE                 PIC XX.
  7272
  7273     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7274     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7275
  7276     12  LO-OFFICER-INFO.
  7277         16  FILLER OCCURS 12 TIMES.
  7278             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7279             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7280             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7281             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7282             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7283             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7284             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7285             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7286     12  FILLER                      PIC X(198).
  7287******************************************************************
  7288*                                COPY ERCPYAJ.
  7289******************************************************************
  7290*                                                                *
  7291*                            ERCPYAJ                             *
  7292*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7293*                            VMOD=2.015                          *
  7294*                                                                *
  7295*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7296*                                                                *
  7297*                                                                *
  7298*   FILE TYPE = VSAM,KSDS                                        *
  7299*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7300*                                                                *
  7301*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7302*       ALTERNATE PATHS = NONE                                   *
  7303*                                                                *
  7304*   LOG = YES                                                    *
  7305*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7306******************************************************************
  7307******************************************************************
  7308*                   C H A N G E   L O G
  7309*
  7310* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7311*-----------------------------------------------------------------
  7312*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7313* EFFECTIVE    NUMBER
  7314*-----------------------------------------------------------------
  7315* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7316* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7317******************************************************************
  7318
  7319 01  PENDING-PAY-ADJ.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 135
* EL6311.cbl
  7320     12  PY-RECORD-ID                     PIC XX.
  7321         88  VALID-PY-ID                        VALUE 'PY'.
  7322
  7323     12  PY-CONTROL-PRIMARY.
  7324         16  PY-COMPANY-CD                PIC X.
  7325         16  PY-CARRIER                   PIC X.
  7326         16  PY-GROUPING                  PIC X(6).
  7327         16  PY-FIN-RESP                  PIC X(10).
  7328         16  PY-ACCOUNT                   PIC X(10).
  7329         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7330                                          PIC X(10).
  7331         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7332         16  PY-RECORD-TYPE               PIC X.
  7333             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7334             88  PY-DEPOSIT                   VALUE 'D'.
  7335             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7336             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7337             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7338             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7339             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7340             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7341             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7342             88  PY-FICA-ENTRY                VALUE 'F'.
  7343             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7344             88  PY-POLICY-FEE                VALUE 'W'.
  7345             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7346
  7347     12  PY-PYMT-TYPE                     PIC X.
  7348             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7349             88  PY-REINS-PYMT                VALUE 'R'.
  7350             88  PY-EXP-PYMT                  VALUE 'E'.
  7351
  7352     12  PY-BIL-INV                       PIC X(6).
  7353     12  PY-REF-NO                        PIC X(12).
  7354
  7355     12  PY-LAST-MAINT-DT                 PIC XX.
  7356     12  PY-LAST-MAINT-BY                 PIC X(4).
  7357     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7358
  7359     12  PY-PYADJ-RECORD.
  7360         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7361         16  PY-ENTRY-COMMENT             PIC X(30).
  7362         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7363             20  PY-GL-ACCOUNT            PIC X(10).
  7364             20  PY-GL-STATE              PIC X(02).
  7365             20  PY-GL-CANC-SW            PIC X(01).
  7366                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7367                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7368             20  PY-GL-COMMENT            PIC X(10).
  7369             20  FILLER      REDEFINES PY-GL-COMMENT.
  7370                 24  PY-GL-CHECK-NO       PIC 9(06).
  7371                 24  FILLER               PIC X(04).
  7372             20  FILLER                   PIC X(07).
  7373         16  PY-SAVE-ACCOUNT              PIC X(10).
  7374         16  PY-SAVE-TYPE                 PIC X(01).
  7375
  7376         16  PY-LETTERS.
  7377             20  PY-LETTER OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 136
* EL6311.cbl
  7378                           INDEXED BY PY-LET-NDX
  7379                                          PIC X(04).
  7380
  7381         16  PY-ERCOMP-TYPE               PIC X.
  7382             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7383             88  PY-GA-TYPE                   VALUE 'G'.
  7384             88  PY-BANK-TYPE                 VALUE 'B'.
  7385         16  FILLER                       PIC X(05).
  7386
  7387     12  PY-RECORD-STATUS.
  7388         16  PY-CREDIT-SELECT-DT          PIC XX.
  7389         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7390         16  PY-BILLED-DATE               PIC XX.
  7391         16  PY-REPORTED-DT               PIC XX.
  7392         16  PY-PMT-APPLIED               PIC X.
  7393             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7394             88  PY-GA-PMT                    VALUE 'G'.
  7395             88  PY-OVWRITE-PMT               VALUE 'O'.
  7396             88  PY-NON-AR-PMT                VALUE 'N'.
  7397         16  FILLER                       PIC X(5).
  7398         16  PY-INPUT-DT                  PIC XX.
  7399         16  PY-CHECK-NUMBER              PIC X(6).
  7400         16  PY-VOID-SW                   PIC X.
  7401             88  PY-CHECK-VOIDED              VALUE 'V'.
  7402         16  PY-CHECK-ORIGIN-SW           PIC X.
  7403             88  PY-BILLING-CHECK             VALUE 'B'.
  7404             88  PY-REFUND-CHECK              VALUE 'R'.
  7405             88  PY-GA-CHECK                  VALUE 'G'.
  7406             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7407             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7408         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7409         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7410         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7411         16  PY-BILL-FLAG                 PIC X.
  7412             88  PY-BILLED                    VALUE 'B'.
  7413         16  PY-AR-FLAG                   PIC X.
  7414             88  PY-AR-CYCLE                  VALUE 'C'.
  7415             88  PY-AR-MONTH-END              VALUE 'M'.
  7416         16  PY-AR-DATE                   PIC XX.
  7417
  7418     12  PY-GL-CODES.
  7419         16  PY-GL-DB                     PIC X(14).
  7420         16  PY-GL-CR                     PIC X(14).
  7421         16  PY-GL-FLAG                   PIC X.
  7422         16  PY-GL-DATE                   PIC XX.
  7423
  7424     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7425     12  FILLER                           PIC X(3).
  7426******************************************************************
  7427*                                COPY ERCCNOT.
  7428******************************************************************
  7429*                                                                *
  7430*                            ERCCNOT                             *
  7431*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7432*                            VMOD=2.003                          *
  7433*                                                                *
  7434*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7435*                                                                *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 137
* EL6311.cbl
  7436*        FILE TYPE= VSAM,KSDS                                    *
  7437*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7438*                                                                *
  7439*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7440*                                                                *
  7441*        LOG = YES                                               *
  7442*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7443*                                                                *
  7444******************************************************************
  7445*                   C H A N G E   L O G
  7446*
  7447* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7448*-----------------------------------------------------------------
  7449*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7450* EFFECTIVE    NUMBER
  7451*-----------------------------------------------------------------
  7452* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7453******************************************************************
  7454
  7455 01  CERT-NOTE-FILE.
  7456     12  CZ-RECORD-ID                PIC  XX.
  7457         88  VALID-CZ-ID                  VALUE 'CZ'.
  7458
  7459     12  CZ-CONTROL-PRIMARY.
  7460         16  CZ-COMPANY-CD           PIC X.
  7461         16  CZ-CARRIER              PIC X.
  7462         16  CZ-GROUPING.
  7463             20 CZ-GROUPING-PREFIX   PIC XXX.
  7464             20 CZ-GROUPING-PRIME    PIC XXX.
  7465         16  CZ-STATE                PIC XX.
  7466         16  CZ-ACCOUNT.
  7467             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7468             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7469         16  CZ-CERT-EFF-DT          PIC XX.
  7470         16  CZ-CERT-NO.
  7471             20  CZ-CERT-PRIME       PIC X(10).
  7472             20  CZ-CERT-SFX         PIC X.
  7473         16  CZ-RECORD-TYPE          PIC X.
  7474             88  CERT-NOTE           VALUE '1'.
  7475             88  CLAIM-CERT-NOTE     VALUE '2'.
  7476         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7477
  7478     12  CZ-LAST-MAINT-DT            PIC XX.
  7479     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7480     12  CZ-LAST-MAINT-USER          PIC X(4).
  7481
  7482     12  CZ-NOTE-INFORMATION.
  7483         16  CZ-NOTE                 PIC X(63).
  7484         16  FILLER                  PIC X(39).
  7485******************************************************************
  7486*                                COPY ELCMSTR.
  7487******************************************************************
  7488*                                                                *
  7489*                            ELCMSTR.                            *
  7490*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7491*                            VMOD=2.012                          *
  7492*                                                                *
  7493*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 138
* EL6311.cbl
  7494*                                                                *
  7495*   FILE TYPE = VSAM,KSDS                                        *
  7496*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7497*                                                                *
  7498*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7499*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7500*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7501*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7502*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7503*                                                 RKP=75,LEN=21  *
  7504*                                                                *
  7505*   **** NOTE ****                                               *
  7506*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7507*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7508*                                                                *
  7509*   LOG = YES                                                    *
  7510*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7511******************************************************************
  7512*                   C H A N G E   L O G
  7513*
  7514* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7515*-----------------------------------------------------------------
  7516*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7517* EFFECTIVE    NUMBER
  7518*-----------------------------------------------------------------
  7519* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7520* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7521* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7522* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7523* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7524* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7525******************************************************************
  7526 01  CLAIM-MASTER.
  7527     12  CL-RECORD-ID                PIC XX.
  7528         88  VALID-CL-ID         VALUE 'CL'.
  7529
  7530     12  CL-CONTROL-PRIMARY.
  7531         16  CL-COMPANY-CD           PIC X.
  7532         16  CL-CARRIER              PIC X.
  7533         16  CL-CLAIM-NO             PIC X(7).
  7534         16  CL-CERT-NO.
  7535             20  CL-CERT-PRIME       PIC X(10).
  7536             20  CL-CERT-SFX         PIC X.
  7537
  7538     12  CL-CONTROL-BY-NAME.
  7539         16  CL-COMPANY-CD-A1        PIC X.
  7540         16  CL-INSURED-LAST-NAME    PIC X(15).
  7541         16  CL-INSURED-NAME.
  7542             20  CL-INSURED-1ST-NAME PIC X(12).
  7543             20  CL-INSURED-MID-INIT PIC X.
  7544
  7545     12  CL-CONTROL-BY-SSN.
  7546         16  CL-COMPANY-CD-A2        PIC X.
  7547         16  CL-SOC-SEC-NO.
  7548             20  CL-SSN-STATE        PIC XX.
  7549             20  CL-SSN-ACCOUNT      PIC X(6).
  7550             20  CL-SSN-LN3          PIC X(3).
  7551
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 139
* EL6311.cbl
  7552     12  CL-CONTROL-BY-CERT-NO.
  7553         16  CL-COMPANY-CD-A4        PIC X.
  7554         16  CL-CERT-NO-A4.
  7555             20  CL-CERT-A4-PRIME    PIC X(10).
  7556             20  CL-CERT-A4-SFX      PIC X.
  7557
  7558     12  CL-CONTROL-BY-CCN.
  7559         16  CL-COMPANY-CD-A5        PIC X.
  7560         16  CL-CCN-A5.
  7561             20  CL-CCN.
  7562                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7563                 24  CL-CCN-PRIME-A5 PIC X(12).
  7564             20  CL-CCN-FILLER-A5    PIC X(4).
  7565
  7566     12  CL-INSURED-PROFILE-DATA.
  7567         16  CL-INSURED-BIRTH-DT     PIC XX.
  7568         16  CL-INSURED-SEX-CD       PIC X.
  7569             88  INSURED-IS-MALE        VALUE 'M'.
  7570             88  INSURED-IS-FEMALE      VALUE 'F'.
  7571             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7572         16  CL-INSURED-OCC-CD       PIC X(6).
  7573         16  FILLER                  PIC X(5).
  7574
  7575     12  CL-PROCESSING-INFO.
  7576         16  CL-PROCESSOR-ID         PIC X(4).
  7577         16  CL-CLAIM-STATUS         PIC X.
  7578             88  CLAIM-IS-OPEN          VALUE 'O'.
  7579             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7580         16  CL-CLAIM-TYPE           PIC X.
  7581*            88  AH-CLAIM               VALUE 'A'.
  7582*            88  LIFE-CLAIM             VALUE 'L'.
  7583*            88  PROPERTY-CLAIM         VALUE 'P'.
  7584*            88  IUI-CLAIM              VALUE 'I'.
  7585*            88  GAP-CLAIM              VALUE 'G'.
  7586*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7587         16  CL-CLAIM-PREM-TYPE      PIC X.
  7588             88  SINGLE-PREMIUM         VALUE '1'.
  7589             88  O-B-COVERAGE           VALUE '2'.
  7590             88  OPEN-END-COVERAGE      VALUE '3'.
  7591         16  CL-INCURRED-DT          PIC XX.
  7592         16  CL-REPORTED-DT          PIC XX.
  7593         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7594         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7595         16  CL-LAST-PMT-DT          PIC XX.
  7596         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7597         16  CL-PAID-THRU-DT         PIC XX.
  7598         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7599         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7600         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7601         16  CL-PMT-CALC-METHOD      PIC X.
  7602             88  CL-360-DAY-YR          VALUE '1'.
  7603             88  CL-365-DAY-YR          VALUE '2'.
  7604             88  CL-FULL-MONTHS         VALUE '3'.
  7605         16  CL-CAUSE-CD             PIC X(6).
  7606
  7607         16  CL-PRIME-CERT-NO.
  7608             20  CL-PRIME-CERT-PRIME PIC X(10).
  7609             20  CL-PRIME-CERT-SFX   PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 140
* EL6311.cbl
  7610
  7611         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7612             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7613             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7614
  7615         16  CL-MICROFILM-NO         PIC X(10).
  7616         16  FILLER REDEFINES CL-MICROFILM-NO.
  7617             20  CL-BENEFIT-PERIOD   PIC 99.
  7618             20  FILLER              PIC X(8).
  7619         16  CL-PROG-FORM-TYPE       PIC X.
  7620         16  CL-LAST-ADD-ON-DT       PIC XX.
  7621
  7622         16  CL-LAST-REOPEN-DT       PIC XX.
  7623         16  CL-LAST-CLOSE-DT        PIC XX.
  7624         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7625             88  FINAL-PAID             VALUE '1'.
  7626             88  CLAIM-DENIED           VALUE '2'.
  7627             88  AUTO-CLOSE             VALUE '3'.
  7628             88  MANUAL-CLOSE           VALUE '4'.
  7629             88  BENEFITS-CHANGED       VALUE 'C'.
  7630             88  SETUP-ERRORS           VALUE 'E'.
  7631         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7632         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7633         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7634             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7635         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7636         16  FILLER                  PIC X.
  7637
  7638     12  CL-CERTIFICATE-DATA.
  7639         16  CL-CERT-ORIGIN          PIC X.
  7640             88  CERT-WAS-ONLINE        VALUE '1'.
  7641             88  CERT-WAS-CREATED       VALUE '2'.
  7642             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7643         16  CL-CERT-KEY-DATA.
  7644             20  CL-CERT-CARRIER     PIC X.
  7645             20  CL-CERT-GROUPING    PIC X(6).
  7646             20  CL-CERT-STATE       PIC XX.
  7647             20  CL-CERT-ACCOUNT.
  7648                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7649                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7650             20  CL-CERT-EFF-DT      PIC XX.
  7651
  7652     12  CL-STATUS-CONTROLS.
  7653         16  CL-PRIORITY-CD          PIC X.
  7654             88  CONFIDENTIAL-DATA      VALUE '8'.
  7655             88  HIGHEST-PRIORITY       VALUE '9'.
  7656         16  CL-SUPV-ATTN-CD         PIC X.
  7657             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7658             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7659         16  CL-PURGED-DT            PIC XX.
  7660         16  CL-RESTORED-DT          PIC XX.
  7661         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7662         16  CL-NEXT-RESEND-DT       PIC XX.
  7663         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7664         16  CL-CRITICAL-PERIOD      PIC 99.
  7665*        16  FILLER                  PIC XX.
  7666         16  CL-LAST-MAINT-DT        PIC XX.
  7667         16  CL-LAST-MAINT-USER      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 141
* EL6311.cbl
  7668         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7669         16  CL-LAST-MAINT-TYPE      PIC X.
  7670             88  CLAIM-SET-UP           VALUE ' '.
  7671             88  PAYMENT-MADE           VALUE '1'.
  7672             88  LETTER-SENT            VALUE '2'.
  7673             88  MASTER-WAS-ALTERED     VALUE '3'.
  7674             88  MASTER-WAS-RESTORED    VALUE '4'.
  7675             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7676             88  FILE-CONVERTED         VALUE '6'.
  7677             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7678             88  ERROR-CORRECTION       VALUE 'E'.
  7679         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7680         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7681         16  CL-BENEFICIARY          PIC X(10).
  7682         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7683         16  CL-DENIAL-TYPE          PIC X.
  7684             88  CL-TYPE-DENIAL          VALUE '1'.
  7685             88  CL-TYPE-RESCISSION      VALUE '2'.
  7686             88  CL-TYPE-REFORMATION     VALUE '3'.
  7687             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7688             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7689         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7690         16  filler                  pic x(3).
  7691*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7692*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7693*        16  CL-RTW-DT               PIC XX.
  7694
  7695     12  CL-TRAILER-CONTROLS.
  7696         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7697             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7698             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7699             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7700         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7701         16  FILLER                  PIC XX.
  7702         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7703         16  CL-ADDRESS-TRAILER-CNT.
  7704             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7705                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7706             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7707                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7708             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7709                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7710             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7711                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7712             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7713                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7714             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7715                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7716             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7717                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7718
  7719     12  CL-CV-REFERENCE-NO.
  7720         16  CL-CV-REFNO-PRIME       PIC X(18).
  7721         16  CL-CV-REFNO-SFX         PIC XX.
  7722
  7723     12  CL-FILE-LOCATION            PIC X(4).
  7724
  7725     12  CL-PROCESS-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 142
* EL6311.cbl
  7726         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7727             88  NO-FATAL-ERRORS        VALUE ZERO.
  7728         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7729             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7730
  7731     12  CL-PRODUCT-CD               PIC X.
  7732
  7733     12  CL-CURRENT-KEY-DATA.
  7734         16  CL-CURRENT-CARRIER      PIC X.
  7735         16  CL-CURRENT-GROUPING     PIC X(6).
  7736         16  CL-CURRENT-STATE        PIC XX.
  7737         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7738
  7739     12  CL-ASSOCIATES               PIC X.
  7740         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7741         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7742         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7743         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7744
  7745     12  CL-ACTIVITY-CODE            PIC 99.
  7746     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7747     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7748
  7749     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7750     12  CL-LAG-REPORT-CODE          PIC 9.
  7751     12  CL-LOAN-TYPE                PIC XX.
  7752     12  CL-LEGAL-STATE              PIC XX.
  7753
  7754     12  CL-YESNOSW                  PIC X.
  7755     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7756         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7757         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7758         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7759     12  cl-insured-type             pic x.
  7760         88  cl-claim-on-primary         value 'P'.
  7761         88  cl-claim-on-co-borrower     value 'C'.
  7762     12  cl-benefit-expiration-dt    PIC XX.
  7763*                                COPY ERCENDT.
  7764******************************************************************
  7765*                                                                *
  7766*                                                                *
  7767*                            ERCENDT.                            *
  7768*                            VMOD=2.001                          *
  7769*                                                                *
  7770*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7771*                                                                *
  7772*   FILE TYPE = VSAM,KSDS                                        *
  7773*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7774*                                                                *
  7775*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7776*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7777*                                                                *
  7778*   LOG = NO                                                     *
  7779*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7780******************************************************************
  7781*-----------------------------------------------------------------
  7782*                   C H A N G E   L O G
  7783*
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 143
* EL6311.cbl
  7784* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7785*-----------------------------------------------------------------
  7786*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7787* EFFECTIVE    NUMBER
  7788*-----------------------------------------------------------------
  7789* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7790*                                WITH OPEN CLAIMS
  7791* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7792* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7793* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7794* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7795*-----------------------------------------------------------------
  7796 01  ENDORSEMENT-RECORD.
  7797     12  EN-RECORD-ID                PIC XX.
  7798         88  VALID-EN-ID                VALUE 'EN'.
  7799     12  EN-CONTROL-PRIMARY.
  7800         16  EN-COMPANY-CD           PIC X.
  7801         16  EN-CARRIER              PIC X.
  7802         16  EN-GROUPING             PIC X(6).
  7803         16  EN-STATE                PIC XX.
  7804         16  EN-ACCOUNT              PIC X(10).
  7805         16  EN-CERT-EFF-DT          PIC XX.
  7806         16  EN-CERT-NO.
  7807             20  EN-CERT-PRIME       PIC X(10).
  7808             20  EN-CERT-SFX         PIC X.
  7809         16  EN-REC-TYPE             PIC X.
  7810             88  EN-ISSUE               VALUE 'I'.
  7811             88  EN-CANCELLATION        VALUE 'C'.
  7812         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7813     12  EN-CONTROL-BY-ARCH-NO.
  7814         16  EN-COMPANY-CD-A1              PIC X.
  7815         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7816     12  EN-LAST-MAINT-DT            PIC XX.
  7817     12  EN-LAST-MAINT-BY            PIC X(4).
  7818     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7819     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7820     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7821         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7822         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7823         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7824         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7825         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7826         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7827         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7828         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7829         16  EN-LF-ORIG-BENCD        PIC XX.
  7830         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7831         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7832         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7833         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7834         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7835         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7836*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7837         16  EN-ORIG-CRED-BENE       PIC X(25).
  7838         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7839         16  FILLER                  PIC X.
  7840         16  EN-AH-ORIG-BENCD        PIC XX.
  7841         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 144
* EL6311.cbl
  7842         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7843         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7844         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7845*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7846*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7847         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7848         16  F                       PIC X(09).
  7849         16  EN-AH-ORIG-CP           PIC 99.
  7850         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7851         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7852         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7853         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7854         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7855         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7856         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7857         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7858         16  EN-LF-NEW-BENCD         PIC XX.
  7859         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7860         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7861         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7862         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7863         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7864         16  EN-LF-NEW-EXP-DT        PIC XX.
  7865         16  EN-NEW-CRED-BENE        PIC X(25).
  7866         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7867         16  FILLER                  PIC X.
  7868         16  EN-AH-NEW-BENCD         PIC XX.
  7869         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7870         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7871         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7872         16  EN-AH-NEW-EXP-DT        PIC XX.
  7873*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7874*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7875*        16  F                       PIC X(12).
  7876         16  EN-AH-NEW-CP            PIC 99.
  7877         16  EN-SIG-SW               PIC X.
  7878         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7879         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7880         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7881         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7882         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7883         16  FILLER                  PIC X(33).
  7884     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7885         16  EN-LF-ORIG-REF-DT       PIC XX.
  7886         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7887         16  EN-AH-ORIG-REF-DT       PIC XX.
  7888         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7889         16  EN-LF-NEW-REF-DT        PIC XX.
  7890         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7891         16  EN-AH-NEW-REF-DT        PIC XX.
  7892         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7893         16  EN-FLAG-CERT            PIC X.
  7894         16  EN-INS-LAST-NAME        PIC X(15).
  7895         16  EN-INS-FIRST-NAME       PIC X(10).
  7896         16  EN-INS-MIDDLE-INIT      PIC X.
  7897         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7898         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7899         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 145
* EL6311.cbl
  7900         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7901         16  FILLER                  PIC X(262).
  7902     12  EN-MONEY-SW             PIC X.
  7903     12  EN-HEALTH-APP           PIC X.
  7904     12  EN-VOUCHER-SW           PIC X.
  7905     12  EN-PAYEE                PIC X(14).
  7906     12  EN-INPUT-DT             PIC XX.
  7907     12  EN-PROCESS-DT           PIC XX.
  7908     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7909     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7910     12  EN-REASON-CODES.
  7911         16  F OCCURS 12.
  7912             20  EN-REASON-CODE  PIC X(4).
  7913     12  EN-TEMPLATE-USED        PIC X(8).
  7914     12  EN-DOCU-TYPE            PIC X.
  7915         88  EN-VERI-DOCU          VALUE 'V'.
  7916         88  EN-GCE-DOCU           VALUE 'G'.
  7917         88  EN-CANC-DOCU          VALUE 'C'.
  7918     12  EN-COMMENTS1            PIC X(13).
  7919     12  EN-COMMENTS2            PIC X(70).
  7920     12  EN-COMM-CHGBK           PIC X.
  7921         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7922         88  EN-CHG-ACCT           VALUE 'Y'.
  7923     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7924     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7925     12  EN-BATCH-NUMBER         PIC X(6).
  7926     12  EN-ACCT-SUMM            PIC X.
  7927     12  EN-CSO-SUMM             PIC X.
  7928     12  en-check-type           pic x.
  7929     12  FILLER                  PIC X(12).
  7930******************************************************************
  7931*                                COPY ELCCRTT.
  7932******************************************************************
  7933*                                                                *
  7934*                            ELCCRTT.                            *
  7935*                                                                *
  7936*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7937*                                                                *
  7938*   FILE TYPE = VSAM,KSDS                                        *
  7939*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7940*                                                                *
  7941*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7942*                                                                *
  7943*   LOG = YES                                                    *
  7944*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7945******************************************************************
  7946*                   C H A N G E   L O G
  7947*
  7948* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7949*-----------------------------------------------------------------
  7950*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7951* EFFECTIVE    NUMBER
  7952*-----------------------------------------------------------------
  7953* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7954* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7955* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7956* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7957* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 146
* EL6311.cbl
  7958* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7959* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7960* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7961* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7962******************************************************************
  7963
  7964 01  CERTIFICATE-TRAILERS.
  7965     12  CS-RECORD-ID                      PIC XX.
  7966         88  VALID-CS-ID                      VALUE 'CS'.
  7967
  7968     12  CS-CONTROL-PRIMARY.
  7969         16  CS-COMPANY-CD                 PIC X.
  7970         16  CS-CARRIER                    PIC X.
  7971         16  CS-GROUPING                   PIC X(6).
  7972         16  CS-STATE                      PIC XX.
  7973         16  CS-ACCOUNT                    PIC X(10).
  7974         16  CS-CERT-EFF-DT                PIC XX.
  7975         16  CS-CERT-NO.
  7976             20  CS-CERT-PRIME             PIC X(10).
  7977             20  CS-CERT-SFX               PIC X.
  7978         16  CS-TRAILER-TYPE               PIC X.
  7979             88  COMM-TRLR           VALUE 'A'.
  7980             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7981             88  CERT-DATA-TRLR      VALUE 'C'.
  7982
  7983     12  CS-DATA-AREA                      PIC X(516).
  7984
  7985     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7986         16  CS-BANK-COMMISSION-AREA.
  7987             20  CS-BANK-COMMS       OCCURS 10.
  7988                 24  CS-AGT                PIC X(10).
  7989                 24  CS-COM-TYP            PIC X.
  7990                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7991                 24  CS-RECALC-LV-INDIC    PIC X.
  7992                 24  FILLER                PIC X(10).
  7993         16  FILLER                        PIC X(256).
  7994
  7995     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7996****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7997         16  CS-MB-CLAIM-DATA OCCURS 24.
  7998             20  CS-CLAIM-NO               PIC X(7).
  7999             20  CS-CLAIM-TYPE             PIC X.
  8000                 88  CS-AH-CLM               VALUE 'A'.
  8001                 88  CS-IU-CLM               VALUE 'I'.
  8002                 88  CS-GP-CLM               VALUE 'G'.
  8003                 88  CS-LF-CLM               VALUE 'L'.
  8004                 88  CS-PR-CLM               VALUE 'P'.
  8005                 88  CS-FL-CLM               VALUE 'F'.
  8006             20  CS-INSURED-TYPE           PIC X.
  8007                 88  CS-PRIM-INSURED          VALUE 'P'.
  8008                 88  CS-CO-BORROWER           VALUE 'C'.
  8009             20  CS-BENEFIT-PERIOD         PIC 99.
  8010             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8011             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8012             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8013         16  FILLER                        PIC X(12).
  8014     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8015         16  CS-VIN-NUMBER                 PIC X(17).
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 147
* EL6311.cbl
  8016         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8017         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8018         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8019         16  cs-agent-name.
  8020             20  cs-agent-fname            pic x(20).
  8021             20  cs-agent-mi               pic x.
  8022             20  cs-agent-lname            pic x(25).
  8023         16  cs-license-no                 pic x(15).
  8024         16  cs-npn-number                 pic x(10).
  8025         16  cs-agent-edit-status          pic x.
  8026             88  cs-ae-refer-to-manager      value 'M'.
  8027             88  cs-ae-cover-sheet           value 'C'.
  8028             88  cs-ae-sig-form              value 'S'.
  8029             88  cs-ae-verified              value 'V'.
  8030             88  cs-unidentified-signature   value 'U'.
  8031             88  cs-cert-returned            value 'R'.
  8032             88  cs-accept-no-commission     value 'N'.
  8033         16  cs-year                       pic 9999.
  8034         16  cs-make                       pic x(20).
  8035         16  cs-model                      pic x(20).
  8036         16  cs-future                     pic x(20).
  8037         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8038         16  FILLER                        PIC X(356). *> was 420
  8039*        16  FILLER                        PIC X(496).
  8040*                                COPY ERCCHEK.
  8041******************************************************************
  8042*                                                                *
  8043*                                                                *
  8044*                            ERCCHEK                             *
  8045*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8046*                            VMOD=2.008                          *
  8047*                                                                *
  8048*   FILE DESCRIPTION = CHECK RECORDS                             *
  8049*                                                                *
  8050*   FILE TYPE = VSAM,KSDS                                        *
  8051*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8052*                                                                *
  8053*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8054*       ALTERNATE INDEX = NONE                                   *
  8055*                                                                *
  8056*   LOG = YES                                                    *
  8057*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8058******************************************************************
  8059*                   C H A N G E   L O G
  8060*
  8061* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8062*-----------------------------------------------------------------
  8063*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8064* EFFECTIVE    NUMBER
  8065*-----------------------------------------------------------------
  8066* 021414    2003053000001  PEMA  changes for auto chk request
  8067******************************************************************
  8068 01  CHECK-RECORDS.
  8069     12  CH-RECORD-ID                      PIC XX.
  8070         88  VALID-CH-ID                      VALUE 'CH'.
  8071
  8072     12  CH-CONTROL-PRIMARY.
  8073         16  CH-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 148
* EL6311.cbl
  8074         16  CH-CARRIER                    PIC X.
  8075         16  CH-GROUPING                   PIC X(6).
  8076         16  CH-STATE                      PIC XX.
  8077         16  CH-ACCOUNT                    PIC X(10).
  8078         16  CH-CERT-EFF-DT                PIC XX.
  8079         16  CH-CERT-NO.
  8080             20  CH-CERT-PRIME             PIC X(10).
  8081             20  CH-CERT-SFX               PIC X.
  8082         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8083
  8084     12  CH-RECORDED-DT                    PIC XX.
  8085     12  CH-RECORDED-BY                    PIC X(4).
  8086     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8087
  8088     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8089     12  CH-CHECK-NO                       PIC X(7).
  8090     12  CH-REASON-FOR-CHECK               PIC X(25).
  8091     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8092     12  FILLER                            PIC X.
  8093
  8094     12  CH-PAYEE-INFO.
  8095         16  CH-PAYEE-NAME-1               PIC X(30).
  8096         16  CH-PAYEE-NAME-2               PIC X(30).
  8097         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8098         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8099         16  CH-PAYEE-CITY-ST.
  8100             20  CH-PAYEE-CITY             PIC X(28).
  8101             20  CH-PAYEE-STATE            PIC XX.
  8102         16  CH-PAYEE-ZIP-CODE.
  8103             20  CH-PAYEE-ZIP.
  8104                 24  CH-ZIP-PRI-1ST        PIC X.
  8105                     88  CH-CANADIAN-POST-CODE
  8106                                           VALUES 'A' THRU 'Z'.
  8107                 24  FILLER                PIC X(4).
  8108             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8109         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8110             20  CH-CAN-POSTAL-1           PIC XXX.
  8111             20  CH-CAN-POSTAL-2           PIC XXX.
  8112             20  FILLER                    PIC XXX.
  8113
  8114     12  CH-CHECK-STUB-TEXT.
  8115         16  CH-STUB-LINE-1                PIC X(30).
  8116         16  CH-TEXT-LINE-1                PIC X(50).
  8117         16  CH-TEXT-LINE-2                PIC X(50).
  8118         16  CH-TEXT-LINE-3                PIC X(40).
  8119     12  CH-RETURN-TO                      PIC X(30).
  8120
  8121     12  CH-COMPENSATION-CONTROL.
  8122         16  CH-COMP-CARRIER               PIC X.
  8123         16  CH-COMP-GROUPING              PIC X(6).
  8124         16  CH-COMP-FIN-RESP              PIC X(10).
  8125         16  CH-COMP-ACCOUNT               PIC X(10).
  8126
  8127     12  CH-CREDIT-SELECT-DT               PIC XX.
  8128     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8129     12  CH-PAYEE-CODE                     PIC X(6).
  8130
  8131     12  CH-VOID-DATA.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 149
* EL6311.cbl
  8132         20  CH-VOID-DT                    PIC XX.
  8133         20  CH-VOID-BY                    PIC X(4).
  8134         20  CH-VOID-REASON                PIC X(25).
  8135
  8136     12  CH-APPROVAL-DATA.
  8137         20  CH-APPROVAL-DT                PIC XX.
  8138         20  CH-APPROVAL-STATUS            PIC X.
  8139             88  CH-IN-LIMBO                  VALUE ' '.
  8140             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8141             88  CH-APPROVED                  VALUE 'A'.
  8142             88  CH-DENIED                    VALUE 'D'.
  8143         20  CH-APPROVED-BY                PIC XXXX.
  8144     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8145             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8146     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8147
  8148     12  ch-released-dt                    pic xx.
  8149     12  ch-check-cashed-dt                pic xx.
  8150     12  FILLER                            PIC X.
  8151*    12  CH-CHECK-REFERENCE                PIC X(12).
  8152     12  CH-CHECK-ORIGIN-SW                PIC X.
  8153             88  CH-REFUND-CHECK              VALUE 'R'.
  8154             88  CH-MAINT-CHECK               VALUE 'M'.
  8155
  8156     12  CH-CANC-DT                        PIC XX.
  8157     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8158     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8159
  8160     12  CH-INSURED-NAME                   PIC X(28).
  8161
  8162     12  ch-released-by                    pic x(4).
  8163     12  ch-csr                            pic x(4).
  8164     12  ch-deduct-commission              pic x.
  8165         88  ch-deduct-comm                  value 'Y'.
  8166         88  ch-do-not-deduct-comm           value 'N'.
  8167
  8168     12  FILLER                            PIC X(11).
  8169*    12  CH-LETTER-TABLE.
  8170*        16  CH-LETTERS OCCURS 3 TIMES
  8171*                       INDEXED BY CH-LT-NDX
  8172*                                          PIC X(04).
  8173
  8174     12  FILLER                            PIC X(07).
  8175
  8176 01  var                         pic x(30).
  8177 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8178                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8179                          PENDING-MAILING-DATA MAILING-DATA
  8180                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8181                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8182                          CLAIM-MASTER ENDORSEMENT-RECORD
  8183                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8184                          VAR.
  8185 0000-DFHEXIT SECTION.
  8186     MOVE '9#                    $   ' TO DFHEIV0.
  8187     MOVE 'EL6311' TO DFHEIV1.
  8188     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8189
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 150
* EL6311.cbl
  8190     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8191     MOVE EIBTRMID               TO QID-TERM.
  8192     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8193     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8194     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8195     MOVE 2                      TO EMI-SWITCH2.
  8196
  8197     move spaces to ws-kix-myenv
  8198     set P to address of KIXSYS
  8199     CALL "getenv" using by value P returning var-ptr
  8200     if var-ptr = null then
  8201        display ' kixsys not set '
  8202     else
  8203        set address of var to var-ptr
  8204        move 0 to env-var-len
  8205        inspect var tallying env-var-len
  8206          for characters before X'00'
  8207        unstring var (1:env-var-len) delimited by '/'
  8208           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8209              WS-KIX-SYS
  8210        end-unstring
  8211     end-if
  8212     perform varying a1 from +1 by +1 until a1 > +10
  8213        if ws-kix-myenv (a1:1) = low-values or high-values
  8214           display ' found low or hi val '
  8215           move spaces to ws-kix-myenv (a1:1)
  8216        end-if
  8217     end-perform
  8218*    display ' env *' ws-kix-myenv '*'
  8219     IF EIBCALEN = 0
  8220         GO TO 8800-UNAUTHORIZED-ACCESS.
  8221
  8222     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8223     MOVE '5'                   TO DC-OPTION-CODE.
  8224     PERFORM 9700-DATE-LINK.
  8225     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8226     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8227
  8228     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8229     MOVE SPACE                  TO DC-OPTION-CODE.
  8230     PERFORM 9700-DATE-LINK.
  8231     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8232     MOVE LOW-VALUES             TO EL631BI.
  8233
  8234
  8235* EXEC CICS HANDLE CONDITION
  8236*        PGMIDERR  (9600-PGMID-ERROR)
  8237*        ERROR     (9990-ABEND)
  8238*        INVREQ    (9990-ABEND)
  8239*        QIDERR    (0010-MAIN-LOGIC)
  8240*    END-EXEC.
  8241*    MOVE '"$L.8N                ! " #00008230' TO DFHEIV0
  8242     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8243     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8244     MOVE X'2220233030303038323330' TO DFHEIV0(25:11)
  8245     CALL 'kxdfhei1' USING DFHEIV0
  8246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8247
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 151
* EL6311.cbl
  8248
  8249     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8250         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8251             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8252             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8253             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8254             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8255             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8256             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8257             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8258             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8259
  8260             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8261                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8262
  8263             ELSE
  8264                 NEXT SENTENCE
  8265
  8266         ELSE
  8267             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8268             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8269             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8270             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8271             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8272             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8273             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8274             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8275             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8276             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8277             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8278             GO TO 3900-RE-DISPLAY-RECORD
  8279     ELSE
  8280         GO TO 0020-MAIN-LOGIC.
  8281
  8282 0010-MAIN-LOGIC.
  8283     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8284                                    WS-FIRST-ENTRY-SW.
  8285
  8286     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8287
  8288     MOVE LOW-VALUES             TO EC-NEW-CERT
  8289                                    EC-NEW-STATE.
  8290
  8291     IF PI-DISPLAY-ORIGINAL-BATCH
  8292         NEXT SENTENCE
  8293     ELSE
  8294         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8295             GO TO 5000-BROWSE-BATCH-HEADERS.
  8296
  8297     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8298         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8299
  8300     IF PI-CSR-BROWSE
  8301        GO TO 4200-BROWSE-CSR-FORWARD.
  8302
  8303     IF PI-FILE-BROWSE
  8304         GO TO 4300-BROWSE-FILE-FORWARD.
  8305
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 152
* EL6311.cbl
  8306     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8307
  8308 0020-MAIN-LOGIC.
  8309     IF EIBAID = DFHCLEAR
  8310         GO TO 9400-CLEAR.
  8311
  8312     MOVE LOW-VALUES             TO EC-NEW-CERT
  8313                                    EC-NEW-STATE.
  8314
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 153
* EL6311.cbl
  8316
  8317******************************************************************
  8318*                                                                *
  8319*              R E C E I V E   M A P                             *
  8320*                                                                *
  8321******************************************************************
  8322
  8323 0200-RECEIVE.
  8324     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8325         MOVE ER-0008            TO EMI-ERROR
  8326         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8327         IF PI-MAP-NAME = EL631B
  8328             MOVE -1                 TO BMAINTL
  8329             GO TO 8200-SEND-DATAONLY
  8330         ELSE
  8331             IF PI-MAP-NAME = EL631C
  8332                 MOVE -1                 TO CMAINTL
  8333                 GO TO 8200-SEND-DATAONLY
  8334             ELSE
  8335                 IF PI-MAP-NAME = EL631D
  8336                     MOVE -1                 TO DPFENTRL
  8337                     GO TO 8200-SEND-DATAONLY.
  8338
  8339
  8340* EXEC CICS RECEIVE
  8341*        MAP      (PI-MAP-NAME)
  8342*        MAPSET   (MAPSET-EL6311S)
  8343*        INTO     (EL631BI)
  8344*    END-EXEC.
  8345     MOVE LENGTH OF
  8346      EL631BI
  8347       TO DFHEIV11
  8348*    MOVE '8"T I  L              ''   #00008327' TO DFHEIV0
  8349     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8350     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8351     MOVE X'2020233030303038333237' TO DFHEIV0(25:11)
  8352     CALL 'kxdfhei1' USING DFHEIV0,
  8353           PI-MAP-NAME,
  8354           EL631BI,
  8355           DFHEIV11,
  8356           MAPSET-EL6311S,
  8357           DFHEIV99,
  8358           DFHEIV99
  8359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8360
  8361
  8362******************************************************************
  8363*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8364******************************************************************
  8365
  8366     IF BTYPE-LEN (1) EQUAL +3
  8367        IF BTYPE (1) EQUAL ALL ' '
  8368            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8369
  8370     IF BTYPE-LEN (2) EQUAL +3
  8371        IF BTYPE (2) EQUAL ALL ' '
  8372            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8373
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 154
* EL6311.cbl
  8374     INSPECT EL631BI CONVERTING '_' TO ' '.
  8375
  8376     IF PI-MAP-NAME = EL631B
  8377         IF BPFENTRL GREATER THAN ZEROS
  8378             IF EIBAID NOT = DFHENTER
  8379                 MOVE ER-0004       TO EMI-ERROR
  8380                 MOVE -1            TO BPFENTRL
  8381                 MOVE AL-UNBOF      TO BPFENTRA
  8382                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8383                 GO TO 8200-SEND-DATAONLY
  8384             ELSE
  8385                 IF BPFENTRI NUMERIC AND
  8386                   (BPFENTRI GREATER 0 AND LESS 25)
  8387                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8388                 ELSE
  8389                     MOVE ER-0029  TO EMI-ERROR
  8390                     MOVE AL-UNBON TO BPFENTRA
  8391                     MOVE -1       TO BPFENTRL
  8392                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8393                     GO TO 8200-SEND-DATAONLY
  8394         ELSE
  8395             NEXT SENTENCE
  8396     ELSE
  8397         IF PI-MAP-NAME = EL631C
  8398            IF CPFENTRL GREATER THAN ZEROS
  8399                IF EIBAID NOT = DFHENTER
  8400                 MOVE ER-0004         TO EMI-ERROR
  8401                 MOVE -1              TO CPFENTRL
  8402                 MOVE AL-UNBOF        TO CPFENTRA
  8403                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8404                 GO TO 8200-SEND-DATAONLY
  8405             ELSE
  8406                 IF CPFENTRI NUMERIC AND
  8407                   (CPFENTRI GREATER 0 AND LESS 25)
  8408                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8409                 ELSE
  8410                     MOVE ER-0029      TO EMI-ERROR
  8411                     MOVE AL-UNBON     TO CPFENTRA
  8412                     MOVE -1           TO CPFENTRL
  8413                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8414                     GO TO 8200-SEND-DATAONLY
  8415         ELSE
  8416             NEXT SENTENCE
  8417     ELSE
  8418     IF PI-MAP-NAME = EL631D
  8419         IF DPFENTRL GREATER THAN ZEROS
  8420             IF EIBAID NOT = DFHENTER
  8421                 MOVE ER-0004         TO EMI-ERROR
  8422                 MOVE -1              TO DPFENTRL
  8423                 MOVE AL-UNBOF        TO DPFENTRA
  8424                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8425                 GO TO 8200-SEND-DATAONLY
  8426             ELSE
  8427                 IF DPFENTRI NUMERIC AND
  8428                   (DPFENTRI GREATER 0 AND LESS 25)
  8429                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8430                 ELSE
  8431                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 155
* EL6311.cbl
  8432                     MOVE AL-UNBON     TO DPFENTRA
  8433                     MOVE -1           TO DPFENTRL
  8434                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8435                     GO TO 8200-SEND-DATAONLY.
  8436
  8437     IF EIBAID = DFHPF23
  8438         GO TO 8810-PF23.
  8439
  8440     IF EIBAID = DFHPF24
  8441         GO TO 9200-RETURN-MAIN-MENU.
  8442
  8443     IF EIBAID = DFHPF12
  8444         GO TO 9500-PF12.
  8445
  8446     IF PI-MAP-NAME = EL631B
  8447        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8448
  8449     IF PI-MAP-NAME = EL631C
  8450        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8451
  8452     IF PI-MAP-NAME = EL631D
  8453        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8454
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 156
* EL6311.cbl
  8456
  8457******************************************************************
  8458*                                                                *
  8459*      ISSUE SCREEN PF KEY CHECKING                              *
  8460*                                                                *
  8461******************************************************************
  8462
  8463******************************************************************
  8464*                                                                *
  8465*      PF KEY FUNCTIONS:                                         *
  8466*                                                                *
  8467*      PF1  = BROWSE FORWARD                                     *
  8468*      PF2  = BROWSE BACKWARD                                    *
  8469*      PF3  = CERTIFICATE LOOKUP                                 *
  8470*      PF4  = DISPLAY BATCH HEADER                               *
  8471*      PF5  = ADD ISSUE  SCREEN                                  *
  8472*      PF6  = ADD CANCEL SCREEN                                  *
  8473*      PF7  = CERTIFICATE DISPLAY                                *
  8474*      PF8  = CERTIFICATE NOTES                                  *
  8475*      PF9  = EDIT CONTROL                                       *
  8476*      PF10 = DISPLAY LETTER SCREEN                              *
  8477*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8478*      PF12 = HELP SCREEN                                        *
  8479*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8480*      PF14 = ACCOUNT MASTER                                     *
  8481*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8482*      PF16 = DISPLAY LETTER REVIEW                              *
  8483*                                                                *
  8484******************************************************************
  8485
  8486 0300-CHECK-ISSUE-PF-KEYS.
  8487     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8488        MOVE ER-2337            TO EMI-ERROR
  8489        MOVE -1                  TO BMAINTL
  8490        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8491        GO TO 8200-SEND-DATAONLY.
  8492
  8493     IF EIBAID = DFHPF1
  8494        MOVE '0'                TO PI-EDIT-SW
  8495        IF PI-PRIMARY-BROWSE
  8496           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8497        ELSE
  8498           IF PI-PRIMARY-WITH-SELECT
  8499              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8500           ELSE
  8501              IF PI-FILE-BROWSE
  8502                 GO TO 4300-BROWSE-FILE-FORWARD
  8503              ELSE
  8504                 IF PI-CSR-BROWSE
  8505                    GO TO 4200-BROWSE-CSR-FORWARD
  8506                 ELSE
  8507                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8508
  8509     IF EIBAID = DFHPF2
  8510        MOVE '0'                TO PI-EDIT-SW
  8511        IF PI-PRIMARY-BROWSE
  8512           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8513        ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 157
* EL6311.cbl
  8514           IF PI-PRIMARY-WITH-SELECT
  8515              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8516           ELSE
  8517              IF PI-FILE-BROWSE
  8518                 GO TO 4800-BROWSE-FILE-BACKWARD
  8519              ELSE
  8520                 IF PI-CSR-BROWSE
  8521                    GO TO 4900-BROWSE-CSR-BACKWARD
  8522                 ELSE
  8523                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8524
  8525     IF EIBAID = DFHPF3
  8526        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8527        MOVE XCTL-EL127         TO PGM-NAME
  8528        GO TO 9300-XCTL.
  8529
  8530     IF (EIBAID = DFHPF15 OR DFHPF6)
  8531        AND (CSR-EDIT-SESSION)
  8532*       AND (FATAL-OR-UNFORCED)
  8533        AND (FATAL-ERRORS)
  8534        MOVE ER-1819             TO EMI-ERROR
  8535        MOVE -1                  TO BMAINTL
  8536        MOVE AL-UANON            TO BMAINTA
  8537        PERFORM 9900-ERROR-FORMAT
  8538                                 THRU 9900-EXIT
  8539        GO TO 8200-SEND-DATAONLY
  8540     END-IF
  8541     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8542      OR (EIBAID = DFHPF10)
  8543        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8544        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8545        IF (RESP-NORMAL)
  8546           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8547              AM-CONTROL-PRIMARY (1:20))
  8548            IF AM-NAME NOT GREATER THAN SPACES OR
  8549               AM-ADDRS NOT GREATER THAN SPACES  OR
  8550               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8551               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8552               AM-ZIP NOT GREATER THAN SPACES
  8553               MOVE ER-3834             TO EMI-ERROR
  8554               MOVE -1                  TO BMAINTL
  8555               MOVE AL-UANON            TO BMAINTA
  8556               PERFORM 9900-ERROR-FORMAT
  8557                                 THRU 9900-EXIT
  8558               GO TO 8200-SEND-DATAONLY
  8559            END-IF
  8560        ELSE
  8561           MOVE ER-1609             TO EMI-ERROR
  8562           MOVE -1                  TO BMAINTL
  8563           MOVE AL-UANON            TO BMAINTA
  8564           PERFORM 9900-ERROR-FORMAT
  8565                                THRU 9900-EXIT
  8566           GO TO 8200-SEND-DATAONLY
  8567        END-IF
  8568
  8569        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8570        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8571        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 158
* EL6311.cbl
  8572            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8573               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8574               MA-CITY NOT GREATER THAN SPACES OR
  8575               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8576               MA-ZIP-CODE NOT GREATER THAN SPACES
  8577               MOVE ER-3835             TO EMI-ERROR
  8578               MOVE -1                  TO BMAINTL
  8579               MOVE AL-UANON            TO BMAINTA
  8580               PERFORM 9900-ERROR-FORMAT
  8581                                 THRU 9900-EXIT
  8582               GO TO 8200-SEND-DATAONLY
  8583            END-IF
  8584        ELSE
  8585           MOVE ER-3000             TO EMI-ERROR
  8586           MOVE -1                  TO BMAINTL
  8587           MOVE AL-UANON            TO BMAINTA
  8588           PERFORM 9900-ERROR-FORMAT
  8589                                THRU 9900-EXIT
  8590           GO TO 8200-SEND-DATAONLY
  8591        END-IF
  8592
  8593     END-IF
  8594     IF (EIBAID = DFHPF15)
  8595        AND (CSR-EDIT-SESSION)
  8596        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8597        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8598        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8599        MOVE PI-SV-STATE         TO PI-STATE
  8600        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8601        MOVE BCERTNOI            TO PI-CERT-PRIME
  8602        MOVE BSUFIXI             TO PI-CERT-SFX
  8603        MOVE BEFFDTI             TO DEEDIT-FIELD
  8604        PERFORM 8600-DEEDIT
  8605        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8606        MOVE '4'                 TO DC-OPTION-CODE
  8607        PERFORM 9700-DATE-LINK
  8608        IF DATE-CONVERSION-ERROR
  8609           MOVE ER-0348          TO EMI-ERROR
  8610           MOVE -1               TO BEFFDTL
  8611           MOVE AL-UABON         TO BEFFDTA
  8612           PERFORM 9900-ERROR-FORMAT
  8613                                 THRU 9900-EXIT
  8614           GO TO 8200-SEND-DATAONLY
  8615        ELSE
  8616           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8617           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8618           MOVE XCTL-EL6315      TO PGM-NAME
  8619           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8620           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8621           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8622           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8623           GO TO 9300-XCTL
  8624        END-IF
  8625     END-IF
  8626
  8627     IF EIBAID = DFHPF4
  8628        MOVE '0'                TO PI-EDIT-SW
  8629        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 159
* EL6311.cbl
  8630           NEXT SENTENCE
  8631        ELSE
  8632           GO TO 7200-DISPLAY-BATCHES.
  8633
  8634     IF EIBAID = DFHPF5
  8635        MOVE ER-0029                TO EMI-ERROR
  8636        MOVE -1                     TO BPFENTRL
  8637        MOVE AL-UNBON               TO BPFENTRA
  8638        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8639        GO TO 8200-SEND-DATAONLY.
  8640*        MOVE '0'                TO PI-EDIT-SW
  8641*        IF PI-DISPLAY-ORIGINAL-BATCH
  8642*           NEXT SENTENCE
  8643*        ELSE
  8644*           MOVE EL631B              TO PI-MAP-NAME
  8645*           MOVE LOW-VALUES          TO EL631BI
  8646*           MOVE 'A'                 TO BMAINTO
  8647*           MOVE AL-UANON            TO BMAINTA
  8648*           MOVE -1                  TO BMAINTL
  8649*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8650*           GO TO 8100-SEND-INITIAL-MAP.
  8651
  8652     IF EIBAID = DFHPF6
  8653        IF NOT CSR-EDIT-SESSION
  8654           MOVE ER-0029                TO EMI-ERROR
  8655           MOVE -1                     TO BPFENTRL
  8656           MOVE AL-UNBON               TO BPFENTRA
  8657           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8658           GO TO 8200-SEND-DATAONLY
  8659*           MOVE '0'              TO PI-EDIT-SW
  8660*           IF PI-DISPLAY-ORIGINAL-BATCH
  8661*              NEXT SENTENCE
  8662*           ELSE
  8663*              MOVE EL631C        TO PI-MAP-NAME
  8664*              MOVE LOW-VALUES    TO EL631CI
  8665*              MOVE 'A'           TO CMAINTO
  8666*              MOVE AL-UANON      TO CMAINTA
  8667*              MOVE -1            TO CMAINTL
  8668*              MOVE '6'           TO PI-MAINT-FUNCTION
  8669*              GO TO 8100-SEND-INITIAL-MAP
  8670*           END-IF
  8671        ELSE
  8672           PERFORM 5100-PROCESS-POL-RESC
  8673                                 THRU 5100-EXIT
  8674           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8675           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8676                                    PI-PREV-SEQ-NO
  8677           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8678*                                    WS-CANCEL-LETTER-SW
  8679                                    PI-ALL-ISSUES-SW
  8680                                    PI-ALL-CANCELS-SW
  8681           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8682        END-IF
  8683     END-IF
  8684     IF EIBAID = DFHPF7
  8685        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8686        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8687        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 160
* EL6311.cbl
  8688        MOVE PI-SV-STATE            TO PI-STATE
  8689        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8690        MOVE BCERTNOI               TO PI-CERT-PRIME
  8691        MOVE BSUFIXI                TO PI-CERT-SFX
  8692        MOVE BEFFDTI                TO DEEDIT-FIELD
  8693        PERFORM 8600-DEEDIT
  8694        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8695        MOVE '4'                    TO DC-OPTION-CODE
  8696        PERFORM 9700-DATE-LINK
  8697        IF DATE-CONVERSION-ERROR
  8698           MOVE ER-0348            TO EMI-ERROR
  8699           MOVE -1                  TO BEFFDTL
  8700           MOVE AL-UABON            TO BEFFDTA
  8701           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8702           GO TO 8200-SEND-DATAONLY
  8703        ELSE
  8704           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8705           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8706           MOVE XCTL-EL1273        TO PGM-NAME
  8707           GO TO 9300-XCTL.
  8708
  8709     IF EIBAID = DFHPF8
  8710        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8711        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8712        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8713        MOVE PI-SV-STATE            TO PI-STATE
  8714        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8715        MOVE BCERTNOI               TO PI-CERT-PRIME
  8716        MOVE BSUFIXI                TO PI-CERT-SFX
  8717        MOVE BEFFDTI                TO DEEDIT-FIELD
  8718        PERFORM 8600-DEEDIT
  8719        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8720        MOVE '4'                    TO DC-OPTION-CODE
  8721        PERFORM 9700-DATE-LINK
  8722        IF DATE-CONVERSION-ERROR
  8723           MOVE ER-0348            TO EMI-ERROR
  8724           MOVE -1                  TO BEFFDTL
  8725           MOVE AL-UABON            TO BEFFDTA
  8726           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8727           GO TO 8200-SEND-DATAONLY
  8728        ELSE
  8729           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8730           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8731           IF PI-COMPANY-ID = 'DMD'
  8732               MOVE XCTL-EL401DMD      TO PGM-NAME
  8733             ELSE
  8734               MOVE XCTL-EL1279        TO PGM-NAME
  8735           END-IF
  8736           GO TO 9300-XCTL.
  8737
  8738     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8739        MOVE XCTL-EL6312         TO PGM-NAME
  8740
  8741* EXEC CICS XCTL
  8742*           PROGRAM   (PGM-NAME)
  8743*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8744*           LENGTH    (WS-COMM-LENGTH)
  8745*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 161
* EL6311.cbl
  8746*    MOVE '.$C                   %   #00008711' TO DFHEIV0
  8747     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8748     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8749     MOVE X'2020233030303038373131' TO DFHEIV0(25:11)
  8750     CALL 'kxdfhei1' USING DFHEIV0,
  8751           PGM-NAME,
  8752           PROGRAM-INTERFACE-BLOCK,
  8753           WS-COMM-LENGTH,
  8754           DFHEIV99
  8755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8756     ELSE
  8757        MOVE '0'                 TO  PI-EDIT-SW.
  8758
  8759     IF  EIBAID = DFHPF10
  8760         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8761         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8762         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8763                                    PI-1042-WA
  8764         MOVE 4                  TO PI-689-DATA-SOURCE
  8765         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8766         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8767         MOVE PI-SV-STATE        TO PI-689-STATE
  8768         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8769         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8770         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8771         MOVE PI-PB-ALT-CHG-SEQ-NO
  8772                                 TO PI-689-ALT-SEQ-NO
  8773         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8774         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8775         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8776         MOVE +0                 TO PI-689-CONTROL
  8777         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8778                                    PI-689-EXP-DATE
  8779                                    PI-689-RESP-PERSON
  8780                                    PI-689-TYPE
  8781                                    PI-689-FOLLOW-UP-EDIT
  8782                                    PI-689-RESEND1-EDIT
  8783                                    PI-689-SEQ-EDIT
  8784                                    PI-689-BCSEQ-EDIT
  8785                                    PI-689-LBL-OVERRIDE
  8786         MOVE W-LETTER-COMMUNICATION-AREAS
  8787                                 TO PI-PROGRAM-WORK-AREA
  8788         MOVE XCTL-EL689         TO PGM-NAME
  8789         GO TO 9300-XCTL.
  8790
  8791     IF  EIBAID = DFHPF16
  8792         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8793         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8794         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8795                                    PI-1042-WA
  8796         MOVE 4                  TO PI-689-DATA-SOURCE
  8797         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8798         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8799         MOVE PI-SV-STATE        TO PI-689-STATE
  8800         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8801         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8802         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8803         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 162
* EL6311.cbl
  8804                                 TO PI-689-ALT-SEQ-NO
  8805         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8806         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8807         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8808         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8809         MOVE W-LETTER-COMMUNICATION-AREAS
  8810                                 TO PI-PROGRAM-WORK-AREA
  8811         MOVE XCTL-EL690         TO PGM-NAME
  8812         GO TO 9300-XCTL.
  8813
  8814     IF EIBAID = DFHPF13
  8815         MOVE XCTL-EL6313        TO PGM-NAME
  8816         GO TO 9300-XCTL.
  8817
  8818     IF EIBAID = DFHPF17
  8819        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8820        IF (PB-I-LOAN-APR numeric)
  8821           and (pb-i-loan-apr < 99.9999)
  8822           AND (PB-I-BENEFICIARY-NAME NOT
  8823              = SPACES AND LOW-VALUES)
  8824
  8825           MOVE LINK-ELVADS          TO PGM-NAME
  8826
  8827* EXEC CICS LINK
  8828*              PROGRAM    (PGM-NAME)
  8829*              COMMAREA   (WS-PASS-AREA)
  8830*              LENGTH     (WS-PASS-AREA-LENGTH)
  8831*          END-EXEC
  8832*    MOVE '."C                   (   #00008786' TO DFHEIV0
  8833     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8834     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8835     MOVE X'2020233030303038373836' TO DFHEIV0(25:11)
  8836     CALL 'kxdfhei1' USING DFHEIV0,
  8837           PGM-NAME,
  8838           WS-PASS-AREA,
  8839           WS-PASS-AREA-LENGTH,
  8840           DFHEIV99,
  8841           DFHEIV99,
  8842           DFHEIV99,
  8843           DFHEIV99
  8844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8845
  8846           MOVE 0000             TO EMI-ERROR
  8847           MOVE -1               TO BMAINTL
  8848           PERFORM 9900-ERROR-FORMAT
  8849                                 THRU 9900-EXIT
  8850           GO TO 8200-SEND-DATAONLY
  8851        ELSE
  8852           MOVE ER-0877            TO EMI-ERROR
  8853           MOVE -1                  TO BEFFDTL
  8854           MOVE AL-UABON            TO BEFFDTA
  8855           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8856           GO TO 8200-SEND-DATAONLY
  8857        END-IF
  8858     END-IF
  8859     IF EIBAID = DFHPF14
  8860        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8861        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 163
* EL6311.cbl
  8862        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8863        MOVE PI-SV-STATE            TO PI-CR-STATE
  8864        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8865        MOVE SPACE                  TO PI-EDIT-SW
  8866        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8867        MOVE XCTL-EL650             TO PGM-NAME
  8868        GO TO 9300-XCTL.
  8869
  8870     IF EIBAID = DFHPF15
  8871        IF PI-COMPANY-ID  =  'HER'
  8872            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8873            MOVE XCTL-EL680         TO PGM-NAME
  8874            GO TO 9300-XCTL.
  8875
  8876     IF EIBAID = DFHENTER OR DFHPF11
  8877        GO TO 1000-ISSUE-MAINLINE.
  8878
  8879     MOVE ER-0029                TO EMI-ERROR
  8880     MOVE -1                     TO BPFENTRL
  8881     MOVE AL-UNBON               TO BPFENTRA
  8882     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8883     GO TO 8200-SEND-DATAONLY.
  8884
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 164
* EL6311.cbl
  8886
  8887******************************************************************
  8888*                                                                *
  8889*      CANCEL SCREEN PF KEY CHECKING                             *
  8890*                                                                *
  8891******************************************************************
  8892
  8893******************************************************************
  8894*                                                                *
  8895*      PF KEY FUNCTIONS:                                         *
  8896*                                                                *
  8897*      PF1  = BROWSE FORWARD                                     *
  8898*      PF2  = BROWSE BACKWARD                                    *
  8899*      PF3  = CERTIFICATE LOOKUP                                 *
  8900*      PF4  = DISPLAY BATCH HEADER                               *
  8901*      PF5  = ADD ISSUE SCREEN                                   *
  8902*      PF6  = ADD CANCEL SCREEN                                  *
  8903*      PF7  = CERTIFICATE DISPLAY                                *
  8904*      PF8  = CERTIFICATE NOTES                                  *
  8905*      PF9  = EDIT CONTROL                                       *
  8906*      PF10 = DISPLAY LETTER SCREEN                              *
  8907*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8908*      PF12 = DISPLAY HELP SCREEN                                *
  8909*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8910*      PF14 = ACCOUNT MASTER                                     *
  8911*      PF16 = LETTER REVIEW                                      *
  8912*                                                                *
  8913******************************************************************
  8914
  8915 0400-CHECK-CANCEL-PF-KEYS.
  8916     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8917        MOVE ER-2337             TO EMI-ERROR
  8918        MOVE -1                  TO CMAINTL
  8919        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8920        GO TO 8200-SEND-DATAONLY.
  8921
  8922     IF EIBAID = DFHPF1
  8923        MOVE '0'                TO PI-EDIT-SW
  8924        IF PI-PRIMARY-BROWSE
  8925           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8926        ELSE
  8927           IF PI-PRIMARY-WITH-SELECT
  8928              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8929           ELSE
  8930              IF PI-FILE-BROWSE
  8931                 GO TO 4300-BROWSE-FILE-FORWARD
  8932              ELSE
  8933                 IF PI-CSR-BROWSE
  8934                    GO TO 4200-BROWSE-CSR-FORWARD
  8935                 ELSE
  8936                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8937
  8938     IF EIBAID = DFHPF2
  8939        MOVE '0'                TO PI-EDIT-SW
  8940        IF PI-PRIMARY-BROWSE
  8941           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8942        ELSE
  8943           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 165
* EL6311.cbl
  8944              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8945           ELSE
  8946              IF PI-FILE-BROWSE
  8947                 GO TO 4800-BROWSE-FILE-BACKWARD
  8948              ELSE
  8949                 IF PI-CSR-BROWSE
  8950                    GO TO 4900-BROWSE-CSR-BACKWARD
  8951                 ELSE
  8952                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8953
  8954     IF EIBAID = DFHPF3
  8955        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8956        MOVE XCTL-EL127         TO PGM-NAME
  8957        GO TO 9300-XCTL.
  8958
  8959     IF (EIBAID = DFHPF15 OR DFHPF17)
  8960        AND (CSR-EDIT-SESSION)
  8961*       AND (FATAL-OR-UNFORCED)
  8962        AND (FATAL-ERRORS)
  8963        MOVE ER-1819             TO EMI-ERROR
  8964        MOVE -1                  TO CMAINTL
  8965        MOVE AL-UANON            TO CMAINTA
  8966        PERFORM 9900-ERROR-FORMAT
  8967                                 THRU 9900-EXIT
  8968        GO TO 8200-SEND-DATAONLY
  8969     END-IF
  8970     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8971       AND (CSR-EDIT-SESSION)
  8972        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8973        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8974        IF (RESP-NORMAL)
  8975           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8976              AM-CONTROL-PRIMARY (1:20))
  8977            IF AM-NAME NOT GREATER THAN SPACES OR
  8978               AM-ADDRS NOT GREATER THAN SPACES  OR
  8979               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8980               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8981               AM-ZIP NOT GREATER THAN SPACES
  8982               MOVE ER-3834             TO EMI-ERROR
  8983               MOVE -1                  TO BMAINTL
  8984               MOVE AL-UANON            TO BMAINTA
  8985               PERFORM 9900-ERROR-FORMAT
  8986                                 THRU 9900-EXIT
  8987               GO TO 8200-SEND-DATAONLY
  8988            END-IF
  8989        ELSE
  8990           MOVE ER-1609             TO EMI-ERROR
  8991           MOVE -1                  TO BMAINTL
  8992           MOVE AL-UANON            TO BMAINTA
  8993           PERFORM 9900-ERROR-FORMAT
  8994                                THRU 9900-EXIT
  8995           GO TO 8200-SEND-DATAONLY
  8996        END-IF
  8997
  8998        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8999        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  9000        IF (ERMAIL-FOUND)
  9001            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 166
* EL6311.cbl
  9002               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  9003               MA-CITY NOT GREATER THAN SPACES OR
  9004               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  9005               MA-ZIP-CODE NOT GREATER THAN SPACES
  9006               MOVE ER-3835             TO EMI-ERROR
  9007               MOVE -1                  TO BMAINTL
  9008               MOVE AL-UANON            TO BMAINTA
  9009               PERFORM 9900-ERROR-FORMAT
  9010                                 THRU 9900-EXIT
  9011               GO TO 8200-SEND-DATAONLY
  9012            END-IF
  9013        ELSE
  9014           MOVE ER-3000             TO EMI-ERROR
  9015           MOVE -1                  TO BMAINTL
  9016           MOVE AL-UANON            TO BMAINTA
  9017           PERFORM 9900-ERROR-FORMAT
  9018                                THRU 9900-EXIT
  9019           GO TO 8200-SEND-DATAONLY
  9020        END-IF
  9021
  9022     END-IF
  9023     IF (EIBAID = DFHPF15 OR DFHPF17)
  9024        AND (CSR-EDIT-SESSION)
  9025        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9026        MOVE PI-SV-CARRIER       TO PI-CARRIER
  9027        MOVE PI-SV-GROUPING      TO PI-GROUPING
  9028        MOVE PI-SV-STATE         TO PI-STATE
  9029        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  9030        MOVE CCERTNOI            TO PI-CERT-PRIME
  9031        MOVE CSUFIXI             TO PI-CERT-SFX
  9032        MOVE CEFFDTI             TO DEEDIT-FIELD
  9033        PERFORM 8600-DEEDIT
  9034        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9035        MOVE '4'                 TO DC-OPTION-CODE
  9036        PERFORM 9700-DATE-LINK
  9037        IF DATE-CONVERSION-ERROR
  9038           MOVE ER-0348          TO EMI-ERROR
  9039           MOVE -1               TO CEFFDTL
  9040           MOVE AL-UABON         TO CEFFDTA
  9041           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9042           GO TO 8200-SEND-DATAONLY
  9043        ELSE
  9044           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9045           PERFORM 6000-CREATE-TEMP-STORAGE
  9046                                 THRU 6000-EXIT
  9047           IF EIBAID = DFHPF17
  9048               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9049                                  THRU 6400-EXIT
  9050               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9051                                 '2' AND '3' AND '4'
  9052                  MOVE ER-3831     TO  EMI-ERROR
  9053                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9054                  GO TO 8200-SEND-DATAONLY
  9055               END-IF
  9056               MOVE 'Y'          TO PI-CLM-RESC-IND
  9057           ELSE
  9058               MOVE 'N'          TO PI-CLM-RESC-IND
  9059           END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 167
* EL6311.cbl
  9060           MOVE XCTL-EL6316      TO PGM-NAME
  9061           MOVE '2'              TO PI-ISS-CAN-SW
  9062           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9063           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9064           GO TO 9300-XCTL
  9065        END-IF
  9066     END-IF
  9067
  9068     IF EIBAID = DFHPF4
  9069        MOVE '0'                TO PI-EDIT-SW
  9070        IF PI-DISPLAY-ORIGINAL-BATCH
  9071           NEXT SENTENCE
  9072        ELSE
  9073           GO TO 7200-DISPLAY-BATCHES.
  9074
  9075     IF EIBAID = DFHPF5
  9076        MOVE ER-0029                TO EMI-ERROR
  9077        MOVE -1                     TO BPFENTRL
  9078        MOVE AL-UNBON               TO BPFENTRA
  9079        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9080        GO TO 8200-SEND-DATAONLY.
  9081*        MOVE '0'                TO PI-EDIT-SW
  9082*        IF PI-DISPLAY-ORIGINAL-BATCH
  9083*           NEXT SENTENCE
  9084*        ELSE
  9085*           MOVE EL631B              TO PI-MAP-NAME
  9086*           MOVE LOW-VALUES          TO EL631BI
  9087*           MOVE 'A'                 TO BMAINTO
  9088*           MOVE AL-UANON            TO BMAINTA
  9089*           MOVE -1                  TO BMAINTL
  9090*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9091*           GO TO 8100-SEND-INITIAL-MAP.
  9092
  9093     IF EIBAID = DFHPF6
  9094        MOVE ER-0029                TO EMI-ERROR
  9095        MOVE -1                     TO BPFENTRL
  9096        MOVE AL-UNBON               TO BPFENTRA
  9097        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9098        GO TO 8200-SEND-DATAONLY.
  9099*        MOVE '0'                TO PI-EDIT-SW
  9100*        IF PI-DISPLAY-ORIGINAL-BATCH
  9101*           NEXT SENTENCE
  9102*        ELSE
  9103*           MOVE EL631C              TO PI-MAP-NAME
  9104*           MOVE LOW-VALUES          TO EL631CI
  9105*           MOVE 'A'                 TO CMAINTO
  9106*           MOVE AL-UANON            TO CMAINTA
  9107*           MOVE -1                  TO CMAINTL
  9108*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9109*           GO TO 8100-SEND-INITIAL-MAP.
  9110
  9111     IF EIBAID = DFHPF7
  9112        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9113        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9114        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9115        MOVE PI-SV-STATE            TO PI-STATE
  9116        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9117        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 168
* EL6311.cbl
  9118        MOVE CSUFIXI                TO PI-CERT-SFX
  9119        MOVE CEFFDTI                TO DEEDIT-FIELD
  9120        PERFORM 8600-DEEDIT
  9121        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9122        MOVE '4'                    TO DC-OPTION-CODE
  9123        PERFORM 9700-DATE-LINK
  9124        IF DATE-CONVERSION-ERROR
  9125           MOVE ER-0348            TO EMI-ERROR
  9126           MOVE -1                  TO BEFFDTL
  9127           MOVE AL-UABON            TO BEFFDTA
  9128           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9129           GO TO 8200-SEND-DATAONLY
  9130        ELSE
  9131           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9132           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9133           MOVE XCTL-EL1273        TO PGM-NAME
  9134           GO TO 9300-XCTL.
  9135
  9136     IF EIBAID = DFHPF8
  9137        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9138        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9139        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9140        MOVE PI-SV-STATE            TO PI-STATE
  9141        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9142        MOVE CCERTNOI               TO PI-CERT-PRIME
  9143        MOVE CSUFIXI                TO PI-CERT-SFX
  9144        MOVE CEFFDTI                TO DEEDIT-FIELD
  9145        PERFORM 8600-DEEDIT
  9146        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9147        MOVE '4'                    TO DC-OPTION-CODE
  9148        PERFORM 9700-DATE-LINK
  9149        IF DATE-CONVERSION-ERROR
  9150           MOVE ER-0348             TO EMI-ERROR
  9151           MOVE -1                  TO BEFFDTL
  9152           MOVE AL-UABON            TO BEFFDTA
  9153           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9154           GO TO 8200-SEND-DATAONLY
  9155        ELSE
  9156           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9157           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9158           IF PI-COMPANY-ID = 'DMD'
  9159               MOVE XCTL-EL401DMD      TO PGM-NAME
  9160             ELSE
  9161               MOVE XCTL-EL1279        TO PGM-NAME
  9162           END-IF
  9163           GO TO 9300-XCTL.
  9164
  9165     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9166        MOVE XCTL-EL6312     TO PGM-NAME
  9167
  9168* EXEC CICS XCTL
  9169*           PROGRAM  (PGM-NAME)
  9170*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9171*           LENGTH   (WS-COMM-LENGTH)
  9172*       END-EXEC
  9173*    MOVE '.$C                   %   #00009113' TO DFHEIV0
  9174     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9175     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 169
* EL6311.cbl
  9176     MOVE X'2020233030303039313133' TO DFHEIV0(25:11)
  9177     CALL 'kxdfhei1' USING DFHEIV0,
  9178           PGM-NAME,
  9179           PROGRAM-INTERFACE-BLOCK,
  9180           WS-COMM-LENGTH,
  9181           DFHEIV99
  9182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9183     ELSE
  9184        MOVE '0'                 TO  PI-EDIT-SW.
  9185
  9186     IF EIBAID = DFHPF10
  9187         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9188         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9189         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9190         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9191                                    PI-1042-WA
  9192         MOVE 4                  TO PI-689-DATA-SOURCE
  9193         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9194         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9195         MOVE PI-SV-STATE        TO PI-689-STATE
  9196         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9197         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9198         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9199         MOVE PI-PB-ALT-CHG-SEQ-NO
  9200                                 TO PI-689-ALT-SEQ-NO
  9201         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9202         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9203         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9204         MOVE +0                 TO PI-689-CONTROL
  9205         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9206                                    PI-689-EXP-DATE
  9207                                    PI-689-RESP-PERSON
  9208                                    PI-689-TYPE
  9209                                    PI-689-FOLLOW-UP-EDIT
  9210                                    PI-689-RESEND1-EDIT
  9211                                    PI-689-SEQ-EDIT
  9212                                    PI-689-BCSEQ-EDIT
  9213                                    PI-689-LBL-OVERRIDE
  9214         MOVE W-LETTER-COMMUNICATION-AREAS
  9215                                 TO PI-PROGRAM-WORK-AREA
  9216         MOVE XCTL-EL689         TO PGM-NAME
  9217         GO TO 9300-XCTL.
  9218
  9219     IF  EIBAID = DFHPF16
  9220         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9221         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9222         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9223                                    PI-1042-WA
  9224         MOVE 4                  TO PI-689-DATA-SOURCE
  9225         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9226         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9227         MOVE PI-SV-STATE        TO PI-689-STATE
  9228         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9229         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9230         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9231         MOVE PI-PB-ALT-CHG-SEQ-NO
  9232                                 TO PI-689-ALT-SEQ-NO
  9233         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 170
* EL6311.cbl
  9234         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9235         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9236         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9237         MOVE W-LETTER-COMMUNICATION-AREAS
  9238                                 TO PI-PROGRAM-WORK-AREA
  9239         MOVE XCTL-EL690         TO PGM-NAME
  9240         GO TO 9300-XCTL.
  9241     IF (EIBAID = DFHPF13)
  9242        if (not fatal-errors)
  9243           and (not unforced-errors)
  9244           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9245           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9246           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9247           MOVE PI-SV-STATE      TO PI-STATE
  9248           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9249           MOVE CCERTNOI         TO PI-CERT-PRIME
  9250           MOVE CSUFIXI          TO PI-CERT-SFX
  9251           MOVE CEFFDTI          TO DEEDIT-FIELD
  9252           PERFORM 8600-DEEDIT
  9253           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9254           MOVE '4'              TO DC-OPTION-CODE
  9255           PERFORM 9700-DATE-LINK
  9256           IF DATE-CONVERSION-ERROR
  9257              MOVE ER-0348       TO EMI-ERROR
  9258              MOVE -1            TO CEFFDTL
  9259              MOVE AL-UABON      TO CEFFDTA
  9260              PERFORM 9900-ERROR-FORMAT
  9261                                 THRU 9900-EXIT
  9262              GO TO 8200-SEND-DATAONLY
  9263           ELSE
  9264              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9265              MOVE AL-UANON      TO CEFFDTA
  9266              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9267              PERFORM 6000-CREATE-TEMP-STORAGE
  9268                                 THRU 6000-EXIT
  9269              MOVE XCTL-EL677    TO PGM-NAME
  9270              GO TO 9300-XCTL
  9271           end-if
  9272        else
  9273           MOVE ER-3444          TO EMI-ERROR
  9274           MOVE -1               TO CPFENTRL
  9275           MOVE AL-UNBON         TO CPFENTRA
  9276           PERFORM 9900-ERROR-FORMAT
  9277                                 THRU 9900-EXIT
  9278           GO TO 8200-SEND-DATAONLY
  9279        end-if
  9280     end-if
  9281
  9282     IF EIBAID = DFHPF14
  9283        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9284        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9285        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9286        MOVE PI-SV-STATE            TO PI-CR-STATE
  9287        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9288        MOVE SPACE                  TO PI-EDIT-SW
  9289        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9290        MOVE XCTL-EL650             TO PGM-NAME
  9291        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 171
* EL6311.cbl
  9292
  9293     IF EIBAID = DFHENTER OR DFHPF11
  9294        GO TO 2000-CANCEL-MAINLINE.
  9295
  9296     MOVE ER-0029                TO EMI-ERROR.
  9297     MOVE -1                     TO CPFENTRL.
  9298     MOVE AL-UNBON               TO CPFENTRA.
  9299     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9300     GO TO 8200-SEND-DATAONLY.
  9301
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 172
* EL6311.cbl
  9303
  9304******************************************************************
  9305*                                                                *
  9306*      BATCH SCREEN PF KEY CHECKING                              *
  9307*                                                                *
  9308******************************************************************
  9309
  9310******************************************************************
  9311*                                                                *
  9312*      PF KEY FUNCTIONS:                                         *
  9313*                                                                *
  9314*      PF1 = BROWSE FORWARD                                      *
  9315*      PF2 = BROWSE BACKWARD                                     *
  9316*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9317*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9318*                                                                *
  9319*                                                                *
  9320******************************************************************
  9321
  9322 0500-CHECK-BATCH-PF-KEYS.
  9323     IF EIBAID = DFHPF1
  9324        MOVE '0'                TO PI-EDIT-SW
  9325        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9326           GO TO 5000-BROWSE-BATCH-HEADERS
  9327        ELSE
  9328           IF PI-GOOD-BROWSE
  9329              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9330                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9331              ELSE
  9332                 IF PI-FILE-BROWSE
  9333                    GO TO 4300-BROWSE-FILE-FORWARD
  9334                 ELSE
  9335                    IF PI-CSR-BROWSE
  9336                       GO TO 4200-BROWSE-CSR-FORWARD
  9337                    ELSE
  9338                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9339           ELSE
  9340              GO TO 0800-BROWSE-ERROR.
  9341
  9342     IF EIBAID = DFHPF2
  9343        MOVE '0'                TO PI-EDIT-SW
  9344        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9345           GO TO 5500-BROWSE-BATCH-BACKWARD
  9346        ELSE
  9347           IF PI-GOOD-BROWSE
  9348              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9349                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9350              ELSE
  9351                 IF PI-FILE-BROWSE
  9352                    GO TO 4800-BROWSE-FILE-BACKWARD
  9353                 ELSE
  9354                    IF PI-CSR-BROWSE
  9355                       GO TO 4900-BROWSE-CSR-BACKWARD
  9356                    ELSE
  9357                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9358           ELSE
  9359              GO TO 0800-BROWSE-ERROR.
  9360
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 173
* EL6311.cbl
  9361     IF EIBAID = DFHPF3
  9362        GO TO 3000-BATCH-MAINLINE.
  9363
  9364     IF  EIBAID = DFHPF4
  9365        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9366        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9367        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9368        MOVE PI-SV-STATE            TO PI-CR-STATE
  9369        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9370                                       PI-CR-FIN-RESP
  9371        MOVE 'A'                    TO PI-CR-TYPE
  9372        MOVE SPACE                  TO PI-EDIT-SW
  9373        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9374        MOVE XCTL-EL640             TO PGM-NAME
  9375        GO TO 9300-XCTL.
  9376
  9377     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9378       AND
  9379        (EIBAID = DFHENTER)
  9380           GO TO 3500-EDIT-BATCH-DATA.
  9381
  9382     IF EIBAID = DFHENTER
  9383        GO TO 3500-EDIT-BATCH-DATA.
  9384
  9385     MOVE ER-0029             TO EMI-ERROR.
  9386     MOVE -1                  TO DPFENTRL.
  9387     MOVE AL-UNBON            TO DPFENTRA.
  9388     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9389     GO TO 8200-SEND-DATAONLY.
  9390
  9391 0800-BROWSE-ERROR.
  9392     MOVE ER-2258                TO EMI-ERROR.
  9393     MOVE -1                     TO DPFENTRL.
  9394     MOVE AL-UNBON               TO DPFENTRA.
  9395     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9396     GO TO 8200-SEND-DATAONLY.
  9397
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 174
* EL6311.cbl
  9399
  9400******************************************************************
  9401*                                                                *
  9402*                I S S U E   M A I N L I N E                     *
  9403*                                                                *
  9404******************************************************************
  9405
  9406 1000-ISSUE-MAINLINE.
  9407     IF PI-DISPLAY-ORIGINAL-BATCH
  9408        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9409           MOVE ER-0023             TO EMI-ERROR
  9410           MOVE -1                  TO BMAINTL
  9411           MOVE AL-UABON            TO BMAINTA
  9412           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9413           GO TO 8200-SEND-DATAONLY
  9414        ELSE
  9415           NEXT SENTENCE
  9416     ELSE
  9417        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9418           MOVE ER-0023             TO EMI-ERROR
  9419           MOVE -1                  TO BMAINTL
  9420           MOVE AL-UABON            TO BMAINTA
  9421           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9422           GO TO 8200-SEND-DATAONLY.
  9423
  9424     IF BMAINTI = 'S'
  9425        GO TO 1100-SHOW-REQUEST.
  9426
  9427     IF NOT MODIFY-CAP
  9428         MOVE 'UPDATE'       TO SM-READ
  9429         PERFORM 9995-SECURITY-VIOLATION
  9430         MOVE ER-0070        TO EMI-ERROR
  9431         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9432         GO TO 8100-SEND-INITIAL-MAP.
  9433
  9434     IF BMAINTL GREATER THAN ZEROS
  9435        IF PI-PF5-FUNCTION
  9436           IF BMAINTI NOT = 'A'
  9437              MOVE AL-UABON  TO BMAINTA
  9438              MOVE -1        TO BMAINTL
  9439              MOVE ER-2260   TO EMI-ERROR
  9440              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9441              GO TO 8200-SEND-DATAONLY.
  9442
  9443     IF BCERTNOL = ZEROS
  9444       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9445         NEXT SENTENCE
  9446     ELSE
  9447         IF BCERTNOL NOT = ZEROS
  9448             MOVE AL-UANON       TO BCERTNOA
  9449         ELSE
  9450             MOVE -1             TO BCERTNOL
  9451             MOVE  1             TO SET-CURSOR-SW
  9452             MOVE ER-2218        TO EMI-ERROR
  9453             MOVE AL-UABON       TO BCERTNOA
  9454             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9455
  9456     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 175
* EL6311.cbl
  9457         MOVE AL-UANON       TO BSUFIXA
  9458     ELSE
  9459         MOVE AL-SANOF       TO BSUFIXA.
  9460
  9461     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9462        NEXT SENTENCE
  9463     ELSE
  9464        IF BEFFDTL NOT = ZEROS
  9465           MOVE AL-UNNON             TO BEFFDTA
  9466           MOVE BEFFDTI              TO DEEDIT-FIELD
  9467           PERFORM 8600-DEEDIT
  9468           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9469           MOVE 4                    TO DC-OPTION-CODE
  9470           PERFORM 9700-DATE-LINK
  9471           IF NO-CONVERSION-ERROR
  9472              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9473              ELSE
  9474              MOVE -1                TO BEFFDTL
  9475              MOVE  1                TO SET-CURSOR-SW
  9476              MOVE ER-2226           TO EMI-ERROR
  9477              MOVE AL-UNBON          TO BEFFDTA
  9478              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9479           ELSE
  9480              MOVE -1                TO BEFFDTL
  9481              MOVE  1                TO SET-CURSOR-SW
  9482              MOVE ER-2220           TO EMI-ERROR
  9483              MOVE AL-UNBON          TO BEFFDTA
  9484              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9485
  9486     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9487
  9488     IF BCERTNOL NOT = ZEROS
  9489        MOVE BCERTNOI                TO WS-NEW-PRIME
  9490     ELSE
  9491        MOVE SPACES                  TO WS-NEW-PRIME.
  9492
  9493     IF BSUFIXL NOT = ZEROS
  9494        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9495     ELSE
  9496        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9497
  9498     IF BEFFDTL NOT = ZEROS
  9499        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9500     ELSE
  9501        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9502
  9503     IF BMAINTI = 'A' OR 'K' OR 'S'
  9504        NEXT SENTENCE
  9505     ELSE
  9506        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9507        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9508           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9509           WS-PB-RECORD-TYPE NOT = '1'
  9510           IF BMAINTI = 'C'
  9511               MOVE ER-2287          TO EMI-ERROR
  9512               MOVE -1               TO BCERTNOL
  9513               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9514               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 176
* EL6311.cbl
  9515               GO TO 8200-SEND-DATAONLY
  9516             ELSE
  9517               MOVE ER-2260          TO EMI-ERROR
  9518               MOVE -1               TO BCERTNOL
  9519               MOVE AL-UABON         TO BCERTNOA
  9520               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9521               GO TO 8200-SEND-DATAONLY.
  9522
  9523     IF BMAINTI = 'D'
  9524         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9525
  9526*    IF BMICRNOL  NOT =  ZEROS
  9527*        IF BMICRNOI  NUMERIC
  9528*            MOVE AL-UNNON       TO  BMICRNOA
  9529*        ELSE
  9530*            MOVE -1             TO  BMICRNOL
  9531*            MOVE 1              TO  SET-CURSOR-SW
  9532*            MOVE AL-UNBON       TO  BMICRNOA
  9533*            MOVE ER-2701        TO  EMI-ERROR
  9534*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9535     IF BVINL NOT = ZEROS
  9536        MOVE AL-UANON            TO BVINA
  9537     END-IF
  9538     IF B1STNML NOT = ZEROS
  9539         MOVE AL-UANON                TO B1STNMA.
  9540
  9541     IF BINITL  NOT = ZEROS
  9542        MOVE AL-UANON                TO BINITA.
  9543
  9544     IF BSEXL NOT = ZEROS
  9545        IF BSEXI = 'M' OR 'F'
  9546           MOVE AL-UANON             TO BSEXA
  9547        ELSE
  9548           MOVE -1               TO BSEXL
  9549           MOVE ER-2629          TO EMI-ERROR
  9550           MOVE AL-UABON         TO BSEXA
  9551           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9552
  9553     IF BAGEL NOT = ZEROS
  9554         IF BAGEI NUMERIC
  9555             MOVE BAGEI              TO WS-BAGE
  9556             MOVE AL-UNNON           TO BAGEA
  9557         ELSE
  9558             MOVE -1                 TO BAGEL
  9559             MOVE  1                 TO SET-CURSOR-SW
  9560             MOVE ER-2223            TO EMI-ERROR
  9561             MOVE AL-UNBON           TO BAGEA
  9562             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9563
  9564     IF BLSTNML NOT = ZERO  OR
  9565        B1STNML NOT = ZERO  OR
  9566        BINITL NOT = ZERO
  9567         IF BAGEL = ZEROS
  9568             MOVE -1                 TO BAGEL
  9569             MOVE  1                 TO SET-CURSOR-SW
  9570             MOVE ER-3269            TO EMI-ERROR
  9571             MOVE AL-UNBON           TO BAGEA
  9572             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 177
* EL6311.cbl
  9573         END-IF
  9574     END-IF.
  9575
  9576     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9577
  9578     IF (BBIRTHL GREATER THAN +0) AND
  9579        (BBIRTHI NOT EQUAL SPACES)
  9580        NEXT SENTENCE
  9581     ELSE
  9582        GO TO 1010-CHECK-AGE.
  9583
  9584     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9585     PERFORM 8600-DEEDIT.
  9586     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9587     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9588     MOVE AL-UNNON               TO BBIRTHA.
  9589     MOVE '4'                    TO DC-OPTION-CODE.
  9590     PERFORM 9700-DATE-LINK.
  9591     IF DATE-CONVERSION-ERROR
  9592        MOVE -1                  TO BBIRTHL
  9593        MOVE  1                  TO SET-CURSOR-SW
  9594        MOVE ER-2228             TO EMI-ERROR
  9595        MOVE AL-UNBON            TO BBIRTHA
  9596        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9597        GO TO 1010-CHECK-AGE.
  9598
  9599     IF (NO-CONVERSION-ERROR) AND
  9600        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9601        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9602        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9603        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9604                                    WS-CONVERTED-BIRTH
  9605        MOVE AL-UANON            TO BBIRTHA
  9606     ELSE
  9607        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9608        MOVE AL-UANON            TO BBIRTHA.
  9609
  9610 1010-CHECK-AGE.
  9611
  9612*    IF BAGEL = ZERO
  9613*       IF BBIRTHL GREATER THAN ZERO
  9614*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9615
  9616     IF B1STPMTL NOT = ZEROS
  9617        IF B1STPMTI = SPACES
  9618           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9619        ELSE
  9620           MOVE B1STPMTI             TO DEEDIT-FIELD
  9621           PERFORM 8600-DEEDIT
  9622           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9623           MOVE AL-UNNON             TO B1STPMTA
  9624           MOVE 4                    TO DC-OPTION-CODE
  9625           PERFORM 9700-DATE-LINK
  9626           IF NO-CONVERSION-ERROR
  9627              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9628              MOVE AL-UANON          TO B1STPMTA
  9629           ELSE
  9630              MOVE -1                TO B1STPMTL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 178
* EL6311.cbl
  9631              MOVE  1                TO SET-CURSOR-SW
  9632              MOVE ER-2200           TO EMI-ERROR
  9633              MOVE AL-UNBON          TO B1STPMTA
  9634              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9635
  9636     IF BDAYSL NOT = ZEROS
  9637         IF BDAYSI NUMERIC
  9638             MOVE AL-UNNON           TO BDAYSA
  9639         ELSE
  9640             MOVE -1                 TO BDAYSL
  9641             MOVE ER-2530            TO EMI-ERROR
  9642             MOVE AL-UNBON           TO BDAYSA
  9643             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9644
  9645     IF BLNTRML NOT = ZEROS
  9646         IF BLNTRMI NUMERIC
  9647             MOVE AL-UNNON       TO BLNTRMA
  9648         ELSE
  9649             MOVE -1             TO BLNTRML
  9650             MOVE ER-2533        TO EMI-ERROR
  9651             MOVE AL-UNBON       TO BLNTRMA
  9652             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9653
  9654**   IF PI-COMPANY-ID = 'DMD'
  9655     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9656        NEXT SENTENCE
  9657     ELSE
  9658         IF BLNOFCRL NOT = ZEROS
  9659            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9660            IF LOAN-OFFICER-FOUND
  9661                MOVE AL-UANON        TO BLNOFCRA
  9662             ELSE
  9663                 MOVE SPACE          TO WS-LOAN-OFFICER
  9664                 MOVE -1             TO BLNOFCRL
  9665                 MOVE  1             TO SET-CURSOR-SW
  9666                 MOVE ER-3006        TO EMI-ERROR
  9667                 MOVE AL-UNBON       TO BLNOFCRA
  9668                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9669
  9670     IF BFREQL NOT = ZEROS
  9671         IF BFREQI NUMERIC
  9672             MOVE AL-UNNON       TO BFREQA
  9673         ELSE
  9674             MOVE -1             TO BFREQL
  9675             MOVE  1             TO SET-CURSOR-SW
  9676             MOVE ER-2223        TO EMI-ERROR
  9677             MOVE AL-UNBON       TO BFREQA
  9678             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9679
  9680     IF BMODEL NOT = ZEROS
  9681         MOVE BMODEI             TO WS-MODE-CODE
  9682                                    PI-BMODE
  9683         IF WS-MODE-CODE-VALID
  9684             MOVE AL-UANON       TO BMODEA
  9685         ELSE
  9686             MOVE -1             TO BMODEL
  9687             MOVE ER-2591        TO EMI-ERROR
  9688             MOVE AL-UABON       TO BMODEA
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 179
* EL6311.cbl
  9689             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9690
  9691     IF BPMTSL NOT = ZEROS
  9692         IF BPMTSI NUMERIC
  9693             MOVE AL-UNNON           TO BPMTSA
  9694             MOVE BPMTSI             TO PI-BPMTS
  9695         ELSE
  9696             MOVE -1                 TO BPMTSL
  9697             MOVE ER-2592            TO EMI-ERROR
  9698             MOVE AL-UNBON           TO BPMTSA
  9699             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9700
  9701     IF BPMTAMTL NOT = ZEROS
  9702
  9703* EXEC CICS BIF DEEDIT
  9704*            FIELD  (BPMTAMTI)
  9705*            LENGTH (9)
  9706*       END-EXEC
  9707     MOVE 9
  9708       TO DFHEIV11
  9709*    MOVE '@"L                   #   #00009637' TO DFHEIV0
  9710     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9711     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9712     MOVE X'2020233030303039363337' TO DFHEIV0(25:11)
  9713     CALL 'kxdfhei1' USING DFHEIV0,
  9714           BPMTAMTI,
  9715           DFHEIV11
  9716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9717        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9718*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9719*        PERFORM 8600-DEEDIT
  9720*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9721
  9722*    IF BAPRL NOT = ZEROS
  9723*        EXEC CICS BIF DEEDIT
  9724*            FIELD  (BAPRI)
  9725*            LENGTH (7)
  9726*        END-EXEC
  9727*        MOVE BAPRI              TO WS-BAPR.
  9728
  9729     IF BAPRL > 0
  9730        MOVE +0                  TO  WS-BAPR
  9731        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9732           (WS-SUB > 7)
  9733           OR (BAPRI (WS-SUB:1) NUMERIC)
  9734           OR (BAPRI (WS-SUB:1) = '.')
  9735        END-PERFORM
  9736        IF WS-SUB > 7
  9737           MOVE ER-2471       TO EMI-ERROR
  9738           MOVE -1            TO BAPRL
  9739           MOVE AL-UNBON      TO BAPRA
  9740           PERFORM 9900-ERROR-FORMAT
  9741                                 THRU 9900-EXIT
  9742        ELSE
  9743           IF BAPRI (WS-SUB:1) NUMERIC
  9744              MOVE WS-SUB           TO WS-BEG
  9745              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9746                 (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 180
* EL6311.cbl
  9747                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9748              END-PERFORM
  9749              COMPUTE WS-END = WS-SUB - WS-BEG
  9750              MOVE BAPRI (WS-BEG:WS-END)
  9751                                 TO WS-APR-WHOLE-NUM
  9752           END-IF
  9753           IF BAPRI (WS-SUB:1) = '.'
  9754              COMPUTE WS-BEG = WS-SUB + 1
  9755              IF (WS-BEG < 8)
  9756                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9757                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9758                    (WS-SUB > 7)
  9759                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9760                 END-PERFORM
  9761                 COMPUTE WS-END = WS-SUB - WS-BEG
  9762                 MOVE BAPRI (WS-BEG:WS-END)
  9763                                 TO WS-APR-DEC (1:WS-END)
  9764              END-IF
  9765           END-IF
  9766           MOVE AL-UNNON      TO BAPRA
  9767           MOVE WS-BAPR       TO BAPRO
  9768        END-IF
  9769     END-IF
  9770*     IF BAPRL NOT = ZEROS
  9771*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9772*        PERFORM 8600-DEEDIT
  9773*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9774
  9775     IF BLIVESL NOT = ZEROS
  9776        MOVE BLIVESI             TO DEEDIT-FIELD
  9777        PERFORM 8600-DEEDIT
  9778        IF DEEDIT-FIELD-V0 NUMERIC
  9779           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9780           MOVE AL-UNNON         TO BLIVESA
  9781        ELSE
  9782           MOVE -1               TO BLIVESL
  9783           MOVE AL-UNBON         TO BLIVESA
  9784           MOVE ER-2223          TO EMI-ERROR
  9785           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9786
  9787*DMD CUSTOM CODING*************START
  9788*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9789     IF PI-COMPANY-ID NOT = 'DMD'
  9790         MOVE ZEROS               TO BBILLEDL
  9791         GO TO 1010-EDIT-CONT.
  9792
  9793     IF BBILLEDL NOT = ZEROS
  9794        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9795        MOVE 'Y'                 TO WS-NUMERIC-SW
  9796        MOVE +1                  TO WS-CSO-SUB
  9797        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9798        IF CSO-NUMERIC-FIELD
  9799
  9800* EXEC CICS BIF DEEDIT
  9801*              FIELD  (BBILLEDI)
  9802*              LENGTH (9)
  9803*          END-EXEC
  9804     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 181
* EL6311.cbl
  9805       TO DFHEIV11
  9806*    MOVE '@"L                   #   #00009723' TO DFHEIV0
  9807     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9808     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9809     MOVE X'2020233030303039373233' TO DFHEIV0(25:11)
  9810     CALL 'kxdfhei1' USING DFHEIV0,
  9811           BBILLEDI,
  9812           DFHEIV11
  9813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9814           MOVE BBILLEDI         TO WS-BILLED
  9815           MOVE AL-UNNON         TO BBILLEDA
  9816        ELSE
  9817           MOVE -1               TO BBILLEDL
  9818           MOVE AL-UNBON         TO BBILLEDA
  9819           MOVE ER-2547          TO EMI-ERROR
  9820           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9821     ELSE
  9822        IF BMAINTI EQUAL 'A'
  9823           MOVE -1               TO BBILLEDL
  9824           MOVE AL-UNBON         TO BBILLEDA
  9825           MOVE ER-8148          TO EMI-ERROR
  9826           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9827
  9828 1010-EDIT-CONT.
  9829
  9830     IF BFORCEL  NOT = ZEROS
  9831         IF FORCE-CAP
  9832            MOVE AL-UANON            TO BFORCEA
  9833         ELSE
  9834            MOVE ER-2945             TO EMI-ERROR
  9835            MOVE AL-UABON            TO BFORCEA
  9836            MOVE -1                  TO BFORCEL
  9837            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9838
  9839     if (bforcel not = zeros)
  9840        and (bforcei = 'L')
  9841        and (not csr-edit-session)
  9842        and (emi-error <> er-2945)
  9843        MOVE ER-2670             TO EMI-ERROR
  9844        MOVE AL-UABON            TO BFORCEA
  9845        MOVE -1                  TO BFORCEL
  9846        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9847     end-if
  9848     IF BENTRYL NOT = ZEROS
  9849        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9850                 'C' and 'D' AND 'V' AND 'U' AND 'M'
  9851           MOVE ER-2224              TO EMI-ERROR
  9852           MOVE AL-UABON             TO BENTRYA
  9853           MOVE -1                   TO BENTRYL
  9854           MOVE  1                   TO SET-CURSOR-SW
  9855           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9856        ELSE
  9857           MOVE AL-UANON             TO BENTRYA.
  9858
  9859     IF BUNWRITL NOT = ZEROS
  9860        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9861           MOVE ER-7574              TO EMI-ERROR
  9862           MOVE AL-UABON             TO BUNWRITA
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 182
* EL6311.cbl
  9863           MOVE -1                   TO BUNWRITL
  9864           MOVE  1                   TO SET-CURSOR-SW
  9865           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9866        ELSE
  9867           MOVE AL-UANON             TO BUNWRITA.
  9868
  9869     IF BREINL  NOT = ZEROS
  9870         MOVE AL-UANON               TO BREINA.
  9871
  9872     IF BBILCDL NOT = ZEROS
  9873        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9874                             AND 'A' AND 'B' AND 'E'
  9875           MOVE ER-2225              TO EMI-ERROR
  9876           MOVE AL-UABON             TO BBILCDA
  9877           MOVE -1                   TO BBILCDL
  9878           MOVE  1                   TO SET-CURSOR-SW
  9879           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9880        ELSE
  9881           MOVE AL-UANON             TO BBILCDA.
  9882
  9883     IF BSKPCDL NOT = ZEROS
  9884         MOVE AL-UANON               TO BSKPCDA.
  9885
  9886     IF BINDGRPL NOT = ZEROS
  9887         MOVE AL-UANON               TO BINDGRPA.
  9888
  9889     IF BSIGL   NOT = ZEROS
  9890         MOVE AL-UANON               TO BSIGA.
  9891
  9892     IF BRTCLSL NOT = ZEROS
  9893         MOVE AL-UANON               TO BRTCLSA.
  9894
  9895     IF BMEMBERL NOT = ZEROS
  9896         MOVE AL-UANON               TO BMEMBERA.
  9897
  9898     MOVE +0                         TO WS-SUB1.
  9899
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 183
* EL6311.cbl
  9901
  9902******************************************************************
  9903*                                                                *
  9904*           E D I T   I S S U E   C O V E R A G E S              *
  9905*                                                                *
  9906******************************************************************
  9907
  9908 1020-EDIT-COVERAGES.
  9909     ADD +1                      TO WS-SUB1.
  9910
  9911     IF WS-SUB1 GREATER +2
  9912        GO TO 1025-EDIT-CONTINUE
  9913     END-IF
  9914
  9915     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9916       IF (BMODEL   GREATER ZERO  OR
  9917            BPMTSL   GREATER ZERO  OR
  9918            BPMTAMTL GREATER ZERO)
  9919          AND
  9920            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9921               GO TO 1021-CONT-EDIT.
  9922
  9923     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9924        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9925        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9926        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9927        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9928        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9929        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9930        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9931        NEXT SENTENCE
  9932         ELSE
  9933            GO TO 1020-EDIT-COVERAGES.
  9934
  9935 1021-CONT-EDIT.
  9936
  9937     IF BMAINTI = 'A'
  9938        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9939           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9940        ELSE
  9941           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9942           MOVE ER-7404          TO EMI-ERROR
  9943           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9944           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9945     ELSE
  9946        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9947           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9948
  9949     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9950        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9951        PERFORM 8600-DEEDIT
  9952        IF DEEDIT-FIELD-V0 NUMERIC
  9953           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9954        ELSE
  9955           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9956
  9957     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9958*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 184
* EL6311.cbl
  9959        IF BMODEL  GREATER THAN ZEROS  AND
  9960           BPMTSL  GREATER THAN ZEROS
  9961           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9962
  9963     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9964         IF BMODEL   GREATER THAN ZEROS  OR
  9965            BPMTSL   GREATER THAN ZEROS  OR
  9966            BPMTAMTL GREATER THAN ZEROS
  9967             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9968
  9969     IF BMAINTI = ('C' OR 'K')
  9970        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9971           NEXT SENTENCE
  9972        ELSE
  9973           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9974           PERFORM 8600-DEEDIT
  9975           IF DEEDIT-FIELD-V0 NUMERIC
  9976              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9977              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9978                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9979              ELSE
  9980                    MOVE ER-2241      TO EMI-ERROR
  9981                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9982                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9983                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9984           ELSE
  9985              MOVE ER-2223          TO EMI-ERROR
  9986              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9987              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9988              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9989     ELSE
  9990        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9991            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9992            PERFORM 8600-DEEDIT
  9993            IF DEEDIT-FIELD-V0      NUMERIC
  9994               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9995                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9996                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9997               ELSE
  9998                  MOVE ER-2241         TO EMI-ERROR
  9999                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
 10000                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
 10001                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10002            ELSE
 10003              MOVE ER-2223             TO EMI-ERROR
 10004              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
 10005              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
 10006              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10007        ELSE
 10008            MOVE ER-2240               TO EMI-ERROR
 10009            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
 10010            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10011*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10012*        IF BMODEL  GREATER THAN ZEROS  AND
 10013*           BPMTSL  GREATER THAN ZEROS
 10014*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10015
 10016     IF BBEN-LEN (WS-SUB1) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 185
* EL6311.cbl
 10017        AND BMAINTI = ('C' OR 'K')
 10018           NEXT SENTENCE
 10019     ELSE
 10020        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
 10021           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
 10022
 10023* EXEC CICS BIF DEEDIT
 10024*              FIELD  (BBENI (WS-SUB1))
 10025*              LENGTH (12)
 10026*          END-EXEC
 10027     MOVE 12
 10028       TO DFHEIV11
 10029*    MOVE '@"L                   #   #00009935' TO DFHEIV0
 10030     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10031     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10032     MOVE X'2020233030303039393335' TO DFHEIV0(25:11)
 10033     CALL 'kxdfhei1' USING DFHEIV0,
 10034           BBENI(WS-SUB1),
 10035           DFHEIV11
 10036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10037           IF BBENI (WS-SUB1)  NUMERIC
 10038              IF BBENI (WS-SUB1) GREATER THAN ZEROS
 10039                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
 10040*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
 10041*          PERFORM 8600-DEEDIT
 10042*          IF DEEDIT-FIELD-V2  NUMERIC
 10043*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10044*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
 10045              ELSE
 10046                 MOVE ER-7632    TO EMI-ERROR
 10047                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10048                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10049                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10050           ELSE
 10051              MOVE ER-2223         TO EMI-ERROR
 10052              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10053              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10054              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10055        ELSE
 10056           MOVE ER-7632    TO EMI-ERROR
 10057           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10058           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10059           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10060
 10061     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10062        AND (BMAINTI = ('C' OR 'K'))
 10063        CONTINUE
 10064     ELSE
 10065        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10066           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10067           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10068              FOR ALL '.'
 10069           IF WS-TALLY > 1
 10070              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10071                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10072              END-PERFORM
 10073              IF A1 < 9
 10074                 ADD 3 TO A1
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 186
* EL6311.cbl
 10075                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10076              END-IF
 10077           ELSE
 10078              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10079                (A1 > 11)
 10080                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10081                  LOW-VALUES OR SPACES)
 10082              END-PERFORM
 10083              IF A1 > 1 AND < 12
 10084                 MOVE SPACES
 10085                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10086              END-IF
 10087           END-IF
 10088
 10089* EXEC CICS BIF DEEDIT
 10090*              FIELD  (BPREMI (WS-SUB1))
 10091*              LENGTH (11)
 10092*          END-EXEC
 10093     MOVE 11
 10094       TO DFHEIV11
 10095*    MOVE '@"L                   #   #00009990' TO DFHEIV0
 10096     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10097     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10098     MOVE X'2020233030303039393930' TO DFHEIV0(25:11)
 10099     CALL 'kxdfhei1' USING DFHEIV0,
 10100           BPREMI(WS-SUB1),
 10101           DFHEIV11
 10102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10103           IF BPREMI (WS-SUB1) NUMERIC
 10104              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10105                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10106*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10107*          PERFORM 8600-DEEDIT
 10108*          IF DEEDIT-FIELD-V2  NUMERIC
 10109*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10110*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10111              ELSE
 10112                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10113                    MOVE ER-7633    TO EMI-ERROR
 10114                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10115                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10116                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10117                 END-IF
 10118              END-IF
 10119           ELSE
 10120              MOVE ER-2223         TO EMI-ERROR
 10121              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10122              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10123              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10124           END-IF
 10125        ELSE
 10126           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10127              MOVE ER-7633         TO EMI-ERROR
 10128              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10129              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10130              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10131           END-IF
 10132        END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 187
* EL6311.cbl
 10133     END-IF
 10134
 10135     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10136        NEXT SENTENCE
 10137     ELSE
 10138        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10139
 10140* EXEC CICS BIF DEEDIT
 10141*           FIELD  (BCPREMI (WS-SUB1))
 10142*           LENGTH (11)
 10143*       END-EXEC
 10144     MOVE 11
 10145       TO DFHEIV11
 10146*    MOVE '@"L                   #   #00010030' TO DFHEIV0
 10147     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10148     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10149     MOVE X'2020233030303130303330' TO DFHEIV0(25:11)
 10150     CALL 'kxdfhei1' USING DFHEIV0,
 10151           BCPREMI(WS-SUB1),
 10152           DFHEIV11
 10153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10154        IF BCPREMI (WS-SUB1) NUMERIC
 10155           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10156*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10157*       PERFORM 8600-DEEDIT
 10158*       IF DEEDIT-FIELD-V2  NUMERIC
 10159*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10160        ELSE
 10161           MOVE ER-2223         TO EMI-ERROR
 10162           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10163           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10164           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10165
 10166     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10167        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10168        PERFORM 8600-DEEDIT
 10169        IF DEEDIT-FIELD-V0 NUMERIC
 10170           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10171           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10172         ELSE
 10173           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10174           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10175           MOVE ER-2223              TO EMI-ERROR
 10176           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10177
 10178     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10179        IF BEXPIRE   (WS-SUB1) = SPACES
 10180           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10181        ELSE
 10182           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10183           PERFORM 8600-DEEDIT
 10184           IF DEEDIT-FIELD-V0        NUMERIC
 10185              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10186              MOVE 4                TO DC-OPTION-CODE
 10187              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10188              PERFORM 9700-DATE-LINK
 10189              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10190                                                        (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 188
* EL6311.cbl
 10191              IF NO-CONVERSION-ERROR
 10192                 NEXT SENTENCE
 10193              ELSE
 10194                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10195                 MOVE ER-2531    TO EMI-ERROR
 10196                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10197                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10198           ELSE
 10199             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10200             MOVE ER-2532        TO EMI-ERROR
 10201             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10202             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10203
 10204     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10205        NEXT SENTENCE
 10206     ELSE
 10207
 10208* EXEC CICS BIF DEEDIT
 10209*           FIELD  (BALT-BENI (WS-SUB1))
 10210*           LENGTH (12)
 10211*       END-EXEC
 10212     MOVE 12
 10213       TO DFHEIV11
 10214*    MOVE '@"L                   #   #00010087' TO DFHEIV0
 10215     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10216     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10217     MOVE X'2020233030303130303837' TO DFHEIV0(25:11)
 10218     CALL 'kxdfhei1' USING DFHEIV0,
 10219           BALT-BENI(WS-SUB1),
 10220           DFHEIV11
 10221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10222        IF BALT-BENI (WS-SUB1) NUMERIC
 10223           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10224*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10225*       PERFORM 8600-DEEDIT
 10226*       IF DEEDIT-FIELD-V0 NUMERIC
 10227*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10228        ELSE
 10229           MOVE ER-2223         TO EMI-ERROR
 10230           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10231           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10232           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10233
 10234     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10235        NEXT SENTENCE
 10236     ELSE
 10237
 10238* EXEC CICS BIF DEEDIT
 10239*           FIELD  (BALT-PREMI (WS-SUB1))
 10240*           LENGTH (11)
 10241*       END-EXEC
 10242     MOVE 11
 10243       TO DFHEIV11
 10244*    MOVE '@"L                   #   #00010106' TO DFHEIV0
 10245     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10246     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10247     MOVE X'2020233030303130313036' TO DFHEIV0(25:11)
 10248     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 189
* EL6311.cbl
 10249           BALT-PREMI(WS-SUB1),
 10250           DFHEIV11
 10251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10252        IF BALT-PREMI (WS-SUB1) NUMERIC
 10253           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10254*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10255*       PERFORM 8600-DEEDIT
 10256*       IF DEEDIT-FIELD-V0 NUMERIC
 10257*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10258        ELSE
 10259           MOVE ER-2223         TO EMI-ERROR
 10260           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10261           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10262           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10263
 10264      GO TO 1020-EDIT-COVERAGES.
 10265     .
 10266 1025-edit-continue.
 10267     IF PI-COMPANY-ID  =  'DMD'
 10268        MOVE LOW-VALUES             TO BNCERTI
 10269                                       BNSTATI.
 10270
 10271     IF EMI-ERROR = ZEROS
 10272         NEXT SENTENCE
 10273     ELSE
 10274         GO TO 8200-SEND-DATAONLY.
 10275
 10276     IF BMAINTI = 'A'
 10277         GO TO 1200-ADD-ISSUE-ROUTINE.
 10278
 10279     IF BMAINTI = 'C'
 10280         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10281
 10282     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10283
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 190
* EL6311.cbl
 10285
 10286 1030-EDIT-FOR-NUMERICS.
 10287     IF WS-CSO-SUB EQUAL 10
 10288        GO TO 1030-EDIT-EXIT.
 10289
 10290     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10291        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10292        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10293           ADD +1               TO WS-CSO-SUB
 10294           GO TO 1030-EDIT-FOR-NUMERICS.
 10295
 10296     MOVE 'N'                   TO WS-NUMERIC-SW.
 10297
 10298 1030-EDIT-EXIT.
 10299******************************************************************
 10300*                                                                *
 10301*                 C A L C U L A T E   A G E                      *
 10302*                                                                *
 10303******************************************************************
 10304
 10305
 10306 1095-CALC-AGE.
 10307
 10308     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10309     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10310     MOVE 1                  TO DC-OPTION-CODE.
 10311     PERFORM 9700-DATE-LINK
 10312     IF NO-CONVERSION-ERROR
 10313         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10314         MOVE WS-BAGE            TO BAGEI
 10315         MOVE +2                 TO BAGEL
 10316         MOVE AL-UNNON TO BAGEA.
 10317
 10318 1099-EXIT.
 10319     EXIT.
 10320
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 191
* EL6311.cbl
 10322
 10323******************************************************************
 10324*                                                                *
 10325*                   S H O W   I S S U E                          *
 10326*                                                                *
 10327******************************************************************
 10328
 10329 1100-SHOW-REQUEST.
 10330     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10331
 10332     IF BCERTNOL = ZEROS AND
 10333        BEFFDTL  = ZEROS
 10334        MOVE -1                  TO BMAINTL
 10335        GO TO 8200-SEND-DATAONLY.
 10336
 10337     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10338
 10339     IF BSUFIXL NOT = ZEROS
 10340        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10341     ELSE
 10342        MOVE SPACE               TO WS-NEW-SUFFIX.
 10343
 10344     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10345     PERFORM 8600-DEEDIT.
 10346     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10347     MOVE '4'                    TO DC-OPTION-CODE.
 10348     PERFORM 9700-DATE-LINK.
 10349     IF DATE-CONVERSION-ERROR
 10350        MOVE ER-0348             TO EMI-ERROR
 10351        MOVE -1                  TO BEFFDTL
 10352        MOVE AL-UABON            TO BEFFDTA
 10353        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10354        GO TO 8200-SEND-DATAONLY
 10355     ELSE
 10356        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10357        MOVE AL-UANON            TO BEFFDTA
 10358        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10359
 10360     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10361
 10362     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10363        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10364          MOVE 'Y'                    TO WS-SHOW-SW
 10365          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10366             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10367           ELSE
 10368             IF PI-FILE-BROWSE
 10369                GO TO 4300-BROWSE-FILE-FORWARD
 10370              ELSE
 10371                IF PI-CSR-BROWSE
 10372                   GO TO 4200-BROWSE-CSR-FORWARD
 10373                ELSE
 10374                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10375        ELSE
 10376           GO TO 3900-RE-DISPLAY-RECORD.
 10377
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 192
* EL6311.cbl
 10379
 10380******************************************************************
 10381*                                                                *
 10382*            A D D   I S S U E   R O U T I N E                   *
 10383*                                                                *
 10384******************************************************************
 10385
 10386***************************************************************
 10387*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10388*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10389*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10390*     4. LINK TO THE EDIT ROUTINE.                            *
 10391*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10392*     6. WRITE THE NEW ISSUE RECORD.                          *
 10393*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10394*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10395*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10396*        ELSE                                                 *
 10397*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10398***************************************************************
 10399
 10400 1200-ADD-ISSUE-ROUTINE.
 10401     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10402
 10403
 10404* EXEC CICS GETMAIN
 10405*        SET     (ADDRESS OF PENDING-BUSINESS)
 10406*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10407*    END-EXEC.
 10408*    MOVE '," L                  $   #00010261' TO DFHEIV0
 10409     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10410     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10411     MOVE X'2020233030303130323631' TO DFHEIV0(25:11)
 10412     CALL 'kxdfhei1' USING DFHEIV0,
 10413           DFHEIV20,
 10414           ERPNDB-RECORD-LENGTH,
 10415           DFHEIV99
 10416     SET ADDRESS OF PENDING-BUSINESS TO
 10417         DFHEIV20
 10418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10419
 10420
 10421
 10422* EXEC CICS HANDLE CONDITION
 10423*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10424*    END-EXEC.
 10425*    MOVE '"$I                   ! # #00010266' TO DFHEIV0
 10426     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10427     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10428     MOVE X'2320233030303130323636' TO DFHEIV0(25:11)
 10429     CALL 'kxdfhei1' USING DFHEIV0
 10430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10431
 10432
 10433     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10434     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10435     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10436
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 193
* EL6311.cbl
 10437
 10438* EXEC CICS READ
 10439*        INTO    (PENDING-BUSINESS)
 10440*        DATASET (FILE-ID-ERPNDB)
 10441*        RIDFLD  (ERPNDB-KEY)
 10442*    END-EXEC.
 10443     MOVE LENGTH OF
 10444      PENDING-BUSINESS
 10445       TO DFHEIV11
 10446*    MOVE '&"IL       E          (   #00010274' TO DFHEIV0
 10447     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10448     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10449     MOVE X'2020233030303130323734' TO DFHEIV0(25:11)
 10450     CALL 'kxdfhei1' USING DFHEIV0,
 10451           FILE-ID-ERPNDB,
 10452           PENDING-BUSINESS,
 10453           DFHEIV11,
 10454           ERPNDB-KEY,
 10455           DFHEIV99,
 10456           DFHEIV99,
 10457           DFHEIV99
 10458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10459
 10460
 10461     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10462
 10463     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10464     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10465     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10466     MOVE SPACES                 TO PENDING-BUSINESS.
 10467     MOVE 'PB'                   TO PB-RECORD-ID.
 10468     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10469     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10470     MOVE SPACES                 TO PB-CERT-SFX.
 10471     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10472     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10473                                    PB-ALT-CHG-SEQ-NO.
 10474
 10475     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10476     MOVE '1'                    TO PB-RECORD-TYPE.
 10477
 10478     IF BSUFIXL NOT = ZEROS
 10479        MOVE BSUFIXI             TO PB-CERT-SFX.
 10480
 10481     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10482
 10483     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10484     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10485
 10486     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10487                                    PB-I-LF-PREM-CALC
 10488                                    PB-I-LF-ALT-PREM-CALC
 10489                                    PB-I-LF-RATE
 10490                                    PB-I-LF-ALT-RATE
 10491                                    PB-I-LF-REI-RATE
 10492                                    PB-I-LF-ALT-REI-RATE
 10493                                    PB-I-RATE-DEV-PCT-LF
 10494                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 194
* EL6311.cbl
 10495                                    PB-I-AH-RATE
 10496                                    PB-I-AH-REI-RATE
 10497                                    PB-I-AH-RATE-TRM
 10498                                    PB-I-RATE-DEV-PCT-AH
 10499                                    PB-I-BUSINESS-TYPE
 10500                                    PB-I-LIFE-COMMISSION
 10501                                    PB-I-JOINT-COMMISSION
 10502                                    PB-I-JOINT-AGE
 10503                                    PB-I-AH-COMMISSION
 10504                                    PB-I-CURR-SEQ
 10505                                    PB-CHG-COUNT
 10506                                    PB-LF-BILLED-AMTS
 10507                                    PB-AH-BILLED-AMTS
 10508                                    PB-CALC-TOLERANCE
 10509                                    PB-I-EXTENTION-DAYS
 10510*                                   PB-I-MICROFILM-NO
 10511                                    PB-I-TERM-IN-DAYS.
 10512
 10513     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10514                                    PB-I-LF-EXPIRE-DT
 10515                                    PB-I-AH-EXPIRE-DT
 10516                                    PB-BILLED-DT
 10517                                    PB-ACCT-EFF-DT
 10518                                    PB-ACCT-EXP-DT
 10519                                    PB-I-1ST-PMT-DT.
 10520
 10521     MOVE 'X'                    TO PB-FATAL-FLAG.
 10522
 10523     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10524
 10525     IF BLSTNML GREATER THAN ZEROS
 10526         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10527
 10528*    IF BMICRNOL  GREATER  ZEROS
 10529*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10530*    ELSE
 10531*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10532     IF BVINL > ZEROS
 10533        MOVE BVINI               TO PB-I-VIN
 10534     END-IF
 10535     IF B1STNML GREATER THAN ZEROS
 10536         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10537
 10538     IF BINITL  GREATER THAN ZEROS
 10539         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10540
 10541     IF BBIRTHL GREATER THAN ZERO
 10542         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10543     ELSE
 10544         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10545
 10546     IF B1STPMTL GREATER THAN ZERO
 10547         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10548     ELSE
 10549         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10550
 10551     IF BAGEL    GREATER THAN ZEROS
 10552         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 195
* EL6311.cbl
 10553        ELSE
 10554         MOVE ZEROS              TO PB-I-AGE.
 10555
 10556     IF BSEXL    GREATER THAN ZEROS
 10557         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10558
 10559     IF BTERM-LEN (1) GREATER THAN ZEROS
 10560        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10561     ELSE
 10562        MOVE ZEROS               TO PB-I-LF-TERM.
 10563
 10564     IF BTERM-LEN (2) GREATER THAN ZEROS
 10565        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10566     ELSE
 10567        MOVE ZEROS               TO PB-I-AH-TERM.
 10568
 10569     IF BLNTRML       GREATER THAN ZEROS
 10570         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10571        ELSE
 10572         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10573
 10574     IF BFREQL        GREATER THAN ZEROS
 10575         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10576        ELSE
 10577         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10578
 10579     IF BSKPCDL       GREATER THAN ZEROS
 10580         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10581
 10582     IF BMODEL        GREATER THAN ZEROS
 10583         MOVE BMODEI             TO PB-I-TERM-TYPE
 10584                                    PI-BMODE.
 10585
 10586     IF BPMTSL        GREATER THAN ZEROS
 10587         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10588                                    PI-BPMTS
 10589        ELSE
 10590         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10591                                    PI-BPMTS.
 10592
 10593     IF BPMTAMTL      GREATER THAN ZEROS
 10594         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10595        ELSE
 10596         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10597
 10598     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10599        IF BTYPE  (1)   NOT = ZEROS
 10600           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10601                                    PI-BTYPE (1)
 10602           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10603           MOVE SPACES           TO PB-I-LF-ABBR
 10604        ELSE
 10605           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10606                                    PB-I-LF-ABBR
 10607           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10608     ELSE
 10609        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10610                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 196
* EL6311.cbl
 10611        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10612
 10613     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10614         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10615     ELSE
 10616         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10617
 10618     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10619         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10620     ELSE
 10621         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10622
 10623     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10624         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10625            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10626            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10627         ELSE
 10628            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10629*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10630*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10631         END-IF
 10632     ELSE
 10633         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10634
 10635     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10636         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10637
 10638     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10639         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10640         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10641     ELSE
 10642         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10643
 10644     IF  BALT-PREM-LEN     (2) > ZEROS
 10645         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10646     ELSE
 10647         MOVE ZEROS            TO PB-I-TOT-FEES.
 10648
 10649     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10650        IF BTYPE      (2)   NOT = ZEROS
 10651           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10652                                  PI-BTYPE (2)
 10653           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10654           MOVE SPACES         TO PB-I-AH-ABBR
 10655        ELSE
 10656           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10657                                  PB-I-AH-ABBR
 10658           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10659     ELSE
 10660        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10661                                  PB-I-AH-ABBR
 10662        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10663
 10664     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10665         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10666     ELSE
 10667         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10668
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 197
* EL6311.cbl
 10669     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10670         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10671            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10672            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10673         ELSE
 10674            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10675*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10676*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10677         END-IF
 10678     ELSE
 10679         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10680
 10681     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10682         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10683
 10684     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10685        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10686     ELSE
 10687        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10688
 10689     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10690        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10691     ELSE
 10692        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10693
 10694     IF BINDGRPL  GREATER THAN ZEROS
 10695         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10696
 10697     IF BRTCLSL   GREATER THAN ZEROS
 10698         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10699
 10700     IF BSIGL     GREATER THAN ZEROS
 10701         MOVE BSIGI              TO PB-I-SIG-SW.
 10702     IF BAPRL > ZEROS
 10703         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10704     ELSE
 10705        if pi-company-id = 'CID'
 10706           move +99.9999         to pb-i-loan-apr
 10707        else
 10708           MOVE ZEROS            TO PB-I-LOAN-APR
 10709        end-if
 10710     end-if
 10711     IF BMEMBERL  GREATER THAN ZEROS
 10712         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10713
 10714     IF BLNOFCRL  GREATER THAN ZEROS
 10715         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10716
 10717     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10718        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10719     ELSE
 10720        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10721
 10722     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10723        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10724     ELSE
 10725        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10726
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 198
* EL6311.cbl
 10727     IF BDAYSL   GREATER THAN ZEROS
 10728        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10729                                    PB-I-EXTENTION-DAYS
 10730     ELSE
 10731        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10732                                    PB-I-EXTENTION-DAYS.
 10733
 10734     IF BDAYSL GREATER THAN ZEROS
 10735        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10736
 10737     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10738        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10739           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10740
 10741     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10742        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10743           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10744
 10745     IF B1STPMTL GREATER THAN ZEROS
 10746        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10747
 10748     IF PB-EXT-DAYS-PROCESSING
 10749        IF PB-I-EXTENTION-DAYS = ZEROS
 10750           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10751
 10752     IF PB-EXPIRE-DT-PROCESSING
 10753        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10754           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10755             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10756
 10757     IF PB-1ST-PMT-DT-PROCESSING
 10758        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10759           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10760
 10761     IF BREINL GREATER THAN ZEROS
 10762        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10763
 10764     IF BENTRYL NOT = ZEROS
 10765        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10766        IF PI-COMPANY-ID = 'CID'
 10767           AND (PB-BATCH-ENTRY = 'P')
 10768           AND (PB-STATE = 'VA')
 10769           PERFORM 1500-UPDATE-ERNOTE
 10770                                 THRU 1500-EXIT
 10771        END-IF
 10772     END-IF
 10773     IF BUNWRITL NOT = ZEROS
 10774        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10775
 10776     IF BFORCEL NOT = ZEROS
 10777        MOVE BFORCEI             TO PB-FORCE-CODE.
 10778
 10779     IF BBILCDL NOT = ZEROS
 10780        MOVE BBILCDI             TO PB-RECORD-BILL.
 10781
 10782     IF BLIVESL GREATER THAN ZEROS
 10783        MOVE WS-BLIVES           TO PB-I-LIVES
 10784     ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 199
* EL6311.cbl
 10785        MOVE ZEROS               TO PB-I-LIVES.
 10786
 10787     IF BBILLEDL GREATER THAN ZEROS
 10788        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10789     ELSE
 10790        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10791
 10792*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10793
 10794 1260-WRITE-PB-RECORD.
 10795     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10796                                    PB-INPUT-BY.
 10797     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10798     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10799                                    PB-INPUT-DT.
 10800
 10801     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10802     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10803                                    PB-CONTROL-BY-ORIG-BATCH.
 10804
 10805
 10806     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10807     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10808     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10809     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10810     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10811
 10812     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10813
 10814     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10815
 10816     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10817     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10818     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10819
 10820     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10821     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10822
 10823 1275-WRITE-PENDING-BUSINESS.
 10824     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10825     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10826     MOVE 'A'                    TO JP-RECORD-TYPE.
 10827     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10828
 10829
 10830* EXEC CICS HANDLE CONDITION
 10831*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10832*    END-EXEC.
 10833*    MOVE '"$%                   ! $ #00010648' TO DFHEIV0
 10834     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10835     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10836     MOVE X'2420233030303130363438' TO DFHEIV0(25:11)
 10837     CALL 'kxdfhei1' USING DFHEIV0
 10838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10839
 10840
 10841
 10842* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 200
* EL6311.cbl
 10843*        DATASET (FILE-ID-ERPNDB)
 10844*        FROM    (PENDING-BUSINESS)
 10845*        RIDFLD  (PB-CONTROL-PRIMARY)
 10846*    END-EXEC.
 10847     MOVE LENGTH OF
 10848      PENDING-BUSINESS
 10849       TO DFHEIV11
 10850*    MOVE '&$ L                  ''   #00010652' TO DFHEIV0
 10851     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10852     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10853     MOVE X'2020233030303130363532' TO DFHEIV0(25:11)
 10854     CALL 'kxdfhei1' USING DFHEIV0,
 10855           FILE-ID-ERPNDB,
 10856           PENDING-BUSINESS,
 10857           DFHEIV11,
 10858           PB-CONTROL-PRIMARY,
 10859           DFHEIV99,
 10860           DFHEIV99
 10861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10862
 10863
 10864     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10865
 10866     PERFORM 8400-LOG-JOURNAL-RECORD.
 10867
 10868******************************************************************
 10869*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10870******************************************************************
 10871     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10872     MOVE ' '                    TO WS-ERMAIL-SW
 10873
 10874* EXEC CICS READ
 10875*       DATASET   (FILE-ID-ERMAIL)
 10876*       SET       (ADDRESS OF MAILING-DATA)
 10877*       RIDFLD    (ERMAIL-KEY)
 10878*       RESP      (WS-RESPONSE)
 10879*    END-EXEC
 10880*    MOVE '&"S        E          (  N#00010668' TO DFHEIV0
 10881     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10882     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10883     MOVE X'204E233030303130363638' TO DFHEIV0(25:11)
 10884     CALL 'kxdfhei1' USING DFHEIV0,
 10885           FILE-ID-ERMAIL,
 10886           DFHEIV20,
 10887           DFHEIV99,
 10888           ERMAIL-KEY,
 10889           DFHEIV99,
 10890           DFHEIV99,
 10891           DFHEIV99
 10892     SET ADDRESS OF MAILING-DATA TO
 10893         DFHEIV20
 10894     MOVE EIBRESP  TO WS-RESPONSE
 10895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10896     IF RESP-NORMAL
 10897        SET ERMAIL-FOUND TO TRUE
 10898     END-IF
 10899
 10900     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 201
* EL6311.cbl
 10901     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10902     MOVE 'OC'                   TO OC-RECORD-ID
 10903     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10904                                 TO OC-CONTROL-PRIMARY (1:33)
 10905     MOVE 'I'                    TO OC-RECORD-TYPE
 10906     MOVE +4096                  TO OC-KEY-SEQ-NO
 10907     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10908     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10909     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10910     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10911     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10912     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10913     MOVE PB-I-AGE               TO OC-INS-AGE
 10914     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10915     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10916     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10917     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10918     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10919     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10920     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10921     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10922     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10923     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10924     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10925     IF PB-I-JOINT-COMMISSION > +0
 10926         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10927     ELSE
 10928         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10929     END-IF
 10930     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10931     MOVE +0                     TO OC-LF-CANCEL-AMT
 10932                                    OC-LF-ITD-CANCEL-AMT
 10933     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10934     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10935     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10936     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10937     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10938     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10939     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10940     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10941     MOVE +0                     TO OC-AH-CANCEL-AMT
 10942                                    OC-AH-ITD-CANCEL-AMT
 10943     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10944     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10945     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10946     IF ERMAIL-FOUND
 10947        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10948     END-IF
 10949     IF NOT CERT-TRL-REC-NOT-FOUND
 10950        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10951                           OC-INS-AGE-DEFAULT-FLAG
 10952        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10953                           OC-JNT-AGE-DEFAULT-FLAG
 10954     END-IF
 10955     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10956     .
 10957 1275-WRITE-ELCRTO.
 10958
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 202
* EL6311.cbl
 10959* EXEC CICS WRITE
 10960*       DATASET   ('ELCRTO')
 10961*       FROM      (ORIGINAL-CERTIFICATE)
 10962*       RIDFLD    (OC-CONTROL-PRIMARY)
 10963*       RESP      (WS-RESPONSE)
 10964*    END-EXEC
 10965     MOVE LENGTH OF
 10966      ORIGINAL-CERTIFICATE
 10967       TO DFHEIV11
 10968     MOVE 'ELCRTO' TO DFHEIV1
 10969*    MOVE '&$ L                  ''  N#00010736' TO DFHEIV0
 10970     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10971     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10972     MOVE X'204E233030303130373336' TO DFHEIV0(25:11)
 10973     CALL 'kxdfhei1' USING DFHEIV0,
 10974           DFHEIV1,
 10975           ORIGINAL-CERTIFICATE,
 10976           DFHEIV11,
 10977           OC-CONTROL-PRIMARY,
 10978           DFHEIV99,
 10979           DFHEIV99
 10980     MOVE EIBRESP  TO WS-RESPONSE
 10981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10982*    display ' just wrote 1275 ' ws-response
 10983     IF RESP-DUPKEY
 10984        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10985        GO TO 1275-WRITE-ELCRTO
 10986     ELSE
 10987        IF NOT RESP-NORMAL
 10988           MOVE -1               TO BMAINTL
 10989           MOVE ER-7450          TO EMI-ERROR
 10990           PERFORM 9900-ERROR-FORMAT
 10991                                 THRU 9900-EXIT
 10992           GO TO 8200-SEND-DATAONLY
 10993        END-IF
 10994     END-IF
 10995******************************************************************
 10996*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10997******************************************************************
 10998
 10999
 11000* EXEC CICS READ
 11001*        INTO    (PENDING-BUSINESS)
 11002*        DATASET (FILE-ID-ERPNDB)
 11003*        RIDFLD  (ERPNDB-KEY)
 11004*        UPDATE
 11005*    END-EXEC.
 11006     MOVE LENGTH OF
 11007      PENDING-BUSINESS
 11008       TO DFHEIV11
 11009*    MOVE '&"IL       EU         (   #00010759' TO DFHEIV0
 11010     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11011     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11012     MOVE X'2020233030303130373539' TO DFHEIV0(25:11)
 11013     CALL 'kxdfhei1' USING DFHEIV0,
 11014           FILE-ID-ERPNDB,
 11015           PENDING-BUSINESS,
 11016           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 203
* EL6311.cbl
 11017           ERPNDB-KEY,
 11018           DFHEIV99,
 11019           DFHEIV99,
 11020           DFHEIV99
 11021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11022
 11023
 11024     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11025     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11026     MOVE 'B'                    TO JP-RECORD-TYPE.
 11027     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11028
 11029     PERFORM 8400-LOG-JOURNAL-RECORD.
 11030
 11031     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 11032
 11033
 11034* EXEC CICS REWRITE
 11035*        DATASET (FILE-ID-ERPNDB)
 11036*        FROM    (PENDING-BUSINESS)
 11037*    END-EXEC.
 11038     MOVE LENGTH OF
 11039      PENDING-BUSINESS
 11040       TO DFHEIV11
 11041*    MOVE '&& L                  %   #00010775' TO DFHEIV0
 11042     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11043     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11044     MOVE X'2020233030303130373735' TO DFHEIV0(25:11)
 11045     CALL 'kxdfhei1' USING DFHEIV0,
 11046           FILE-ID-ERPNDB,
 11047           PENDING-BUSINESS,
 11048           DFHEIV11,
 11049           DFHEIV99
 11050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11051
 11052
 11053     MOVE 'C'                    TO JP-RECORD-TYPE.
 11054     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11055
 11056     PERFORM 8400-LOG-JOURNAL-RECORD.
 11057
 11058     IF WS-ERRORS-PRESENT
 11059         GO TO 3900-RE-DISPLAY-RECORD.
 11060
 11061     MOVE ZEROS                  TO EMI-ERROR.
 11062     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11063     MOVE LOW-VALUES             TO EL631BI.
 11064     MOVE  -1                    TO BMAINTL.
 11065     GO TO 8100-SEND-INITIAL-MAP.
 11066
 11067 1280-BATCH-HDR-NOT-FOUND.
 11068     MOVE -1                     TO BMAINTL.
 11069     MOVE ER-7450                TO EMI-ERROR.
 11070     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11071     GO TO 8200-SEND-DATAONLY.
 11072
 11073 1290-DUPLICATE-ALT-INDEX.
 11074
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 204
* EL6311.cbl
 11075******************************************************************
 11076*                                                                *
 11077*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11078*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11079*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11080*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11081*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11082*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11083*                                                                *
 11084******************************************************************
 11085
 11086     IF LCP-ONCTR-01 =  0
 11087         ADD 1 TO LCP-ONCTR-01
 11088        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11089
 11090     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11091
 11092     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11093         NEXT SENTENCE
 11094     ELSE
 11095         ADD +1 TO PB-BATCH-SEQ-NO
 11096                   PB-CSR-BATCH-SEQ-NO
 11097         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11098         GO TO 1275-WRITE-PENDING-BUSINESS.
 11099
 11100     MOVE -1                     TO BCERTNOL.
 11101     MOVE AL-UABON               TO BCERTNOA.
 11102     MOVE AL-UNBON               TO BEFFDTA.
 11103
 11104     MOVE 1                      TO EMI-SUB
 11105                                    EMI-SWITCH1
 11106                                    EMI-SWITCH-AREA-1
 11107                                    EMI-SWITCH-AREA-2.
 11108
 11109     MOVE SPACES                 TO EMI-ERROR-LINES.
 11110
 11111
 11112* EXEC CICS SYNCPOINT ROLLBACK
 11113*    END-EXEC.
 11114*    MOVE '6"R                   !   #00010838' TO DFHEIV0
 11115     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11116     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11117     MOVE X'2020233030303130383338' TO DFHEIV0(25:11)
 11118     CALL 'kxdfhei1' USING DFHEIV0
 11119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11120
 11121
 11122     MOVE ER-2247                TO EMI-ERROR.
 11123     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11124     GO TO 8200-SEND-DATAONLY.
 11125
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 205
* EL6311.cbl
 11127
 11128
 11129 1295-READ-CERT-TRAILER.
 11130
 11131
 11132* EXEC CICS GETMAIN
 11133*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11134*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11135*        INITIMG (GETMAIN-SPACE)
 11136*    END-EXEC
 11137*    MOVE ',"IL                  $   #00010850' TO DFHEIV0
 11138     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11139     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11140     MOVE X'2020233030303130383530' TO DFHEIV0(25:11)
 11141     CALL 'kxdfhei1' USING DFHEIV0,
 11142           DFHEIV20,
 11143           ELCRTT-RECORD-LENGTH,
 11144           GETMAIN-SPACE
 11145     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11146         DFHEIV20
 11147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11148
 11149     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11150     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11151     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11152
 11153
 11154* EXEC CICS HANDLE CONDITION
 11155*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11156*    END-EXEC.
 11157*    MOVE '"$I                   ! % #00010860' TO DFHEIV0
 11158     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11160     MOVE X'2520233030303130383630' TO DFHEIV0(25:11)
 11161     CALL 'kxdfhei1' USING DFHEIV0
 11162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11163
 11164
 11165
 11166* EXEC CICS READ
 11167*        DATASET  (CRTT-ID)
 11168*        RIDFLD   (ELCRTT-KEY)
 11169*        INTO     (CERTIFICATE-TRAILERS)
 11170*    END-EXEC.
 11171     MOVE LENGTH OF
 11172      CERTIFICATE-TRAILERS
 11173       TO DFHEIV11
 11174*    MOVE '&"IL       E          (   #00010864' TO DFHEIV0
 11175     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11176     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11177     MOVE X'2020233030303130383634' TO DFHEIV0(25:11)
 11178     CALL 'kxdfhei1' USING DFHEIV0,
 11179           CRTT-ID,
 11180           CERTIFICATE-TRAILERS,
 11181           DFHEIV11,
 11182           ELCRTT-KEY,
 11183           DFHEIV99,
 11184           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 206
* EL6311.cbl
 11185           DFHEIV99
 11186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11187
 11188
 11189     GO TO 1295-EXIT.
 11190
 11191 1295-CERT-TRL-REC-NOTFND.
 11192     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11193
 11194 1295-EXIT.
 11195     EXIT.
 11196
 11197******************************************************************
 11198*                                                                *
 11199*          C H A N G E   I S S U E   R O U T I N E               *
 11200*                                                                *
 11201******************************************************************
 11202
 11203***************************************************************
 11204*                                                             *
 11205*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11206*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11207*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11208*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11209*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11210*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11211*     5. LINK TO THE EDIT ROUTINE.                            *
 11212*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11213*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11214*              THE EDIT ROUTINE.                              *
 11215*     7. REWRITE THE NEW ISSUE                                *
 11216*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11217*                                                             *
 11218***************************************************************
 11219
 11220 1300-CHANGE-ISSUE-ROUTINE.
 11221     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11222
 11223     IF BCHGL NOT = ZEROS
 11224        MOVE ER-2196             TO EMI-ERROR
 11225        MOVE AL-UABON            TO BMAINTA
 11226        MOVE -1                  TO BMAINTL
 11227        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11228        GO TO 8200-SEND-DATAONLY.
 11229
 11230     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11231
 11232     IF BSUFIXL NOT = ZEROS
 11233        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11234     ELSE
 11235        MOVE SPACE               TO WS-NEW-SUFFIX.
 11236
 11237     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11238     PERFORM 8600-DEEDIT.
 11239     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11240     MOVE '4'                    TO DC-OPTION-CODE.
 11241     PERFORM 9700-DATE-LINK.
 11242     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 207
* EL6311.cbl
 11243        MOVE ER-0348             TO EMI-ERROR
 11244        MOVE -1                  TO BEFFDTL
 11245        MOVE AL-UABON            TO BEFFDTA
 11246        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11247        GO TO 8200-SEND-DATAONLY
 11248     ELSE
 11249        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11250        MOVE AL-UANON            TO BEFFDTA
 11251        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11252
 11253 1325-PROCESS-ISSUE-CHANGES.
 11254
 11255* EXEC CICS HANDLE CONDITION
 11256*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11257*    END-EXEC.
 11258*    MOVE '"$I                   ! & #00010935' TO DFHEIV0
 11259     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11260     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11261     MOVE X'2620233030303130393335' TO DFHEIV0(25:11)
 11262     CALL 'kxdfhei1' USING DFHEIV0
 11263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11264
 11265
 11266     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11267     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11268     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11269
 11270
 11271* EXEC CICS GETMAIN
 11272*        SET      (ADDRESS OF PENDING-BUSINESS)
 11273*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11274*        INITIMG  (GETMAIN-SPACE)
 11275*     END-EXEC.
 11276*    MOVE ',"IL                  $   #00010943' TO DFHEIV0
 11277     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11278     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11279     MOVE X'2020233030303130393433' TO DFHEIV0(25:11)
 11280     CALL 'kxdfhei1' USING DFHEIV0,
 11281           DFHEIV20,
 11282           ERPNDB-RECORD-LENGTH,
 11283           GETMAIN-SPACE
 11284     SET ADDRESS OF PENDING-BUSINESS TO
 11285         DFHEIV20
 11286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11287
 11288
 11289
 11290* EXEC CICS READ
 11291*        INTO    (PENDING-BUSINESS)
 11292*        DATASET (FILE-ID-ERPNDB)
 11293*        RIDFLD  (ERPNDB-KEY)
 11294*    END-EXEC.
 11295     MOVE LENGTH OF
 11296      PENDING-BUSINESS
 11297       TO DFHEIV11
 11298*    MOVE '&"IL       E          (   #00010949' TO DFHEIV0
 11299     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11300     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 208
* EL6311.cbl
 11301     MOVE X'2020233030303130393439' TO DFHEIV0(25:11)
 11302     CALL 'kxdfhei1' USING DFHEIV0,
 11303           FILE-ID-ERPNDB,
 11304           PENDING-BUSINESS,
 11305           DFHEIV11,
 11306           ERPNDB-KEY,
 11307           DFHEIV99,
 11308           DFHEIV99,
 11309           DFHEIV99
 11310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11311
 11312
 11313     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11314
 11315
 11316* EXEC CICS HANDLE CONDITION
 11317*         NOTFND     (1385-REC-NOT-FOUND)
 11318*    END-EXEC.
 11319*    MOVE '"$I                   ! '' #00010957' TO DFHEIV0
 11320     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11321     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11322     MOVE X'2720233030303130393537' TO DFHEIV0(25:11)
 11323     CALL 'kxdfhei1' USING DFHEIV0
 11324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11325
 11326
 11327**********************************************************
 11328*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11329*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11330**********************************************************
 11331
 11332
 11333* EXEC CICS READ
 11334*        DATASET (FILE-ID-ERPNDB)
 11335*        INTO    (PENDING-BUSINESS)
 11336*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11337*    END-EXEC.
 11338     MOVE LENGTH OF
 11339      PENDING-BUSINESS
 11340       TO DFHEIV11
 11341*    MOVE '&"IL       E          (   #00010966' TO DFHEIV0
 11342     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11343     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11344     MOVE X'2020233030303130393636' TO DFHEIV0(25:11)
 11345     CALL 'kxdfhei1' USING DFHEIV0,
 11346           FILE-ID-ERPNDB,
 11347           PENDING-BUSINESS,
 11348           DFHEIV11,
 11349           PI-PREV-CONTROL-PRIMARY,
 11350           DFHEIV99,
 11351           DFHEIV99,
 11352           DFHEIV99
 11353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11354
 11355
 11356********** DO NOT ALLOW CHANGES IF THRU A/R
 11357     IF BMAINTI = 'C'
 11358         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 209
* EL6311.cbl
 11359             MOVE ER-4005          TO EMI-ERROR
 11360             MOVE -1               TO BMAINTL
 11361             MOVE AL-UABON         TO BMAINTA
 11362             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11363             GO TO 8200-SEND-DATAONLY.
 11364**********
 11365
 11366     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11367        MOVE -1                 TO BMAINTL
 11368        MOVE ER-2197            TO EMI-ERROR
 11369        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11370        GO TO 8200-SEND-DATAONLY.
 11371
 11372     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11373        MOVE ER-2196             TO EMI-ERROR
 11374        MOVE AL-UABON            TO BMAINTA
 11375        MOVE -1                  TO BMAINTL
 11376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11377        GO TO 8200-SEND-DATAONLY.
 11378
 11379     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11380
 11381     IF PB-BILLED-DT = LOW-VALUES AND
 11382        PB-CHG-COUNT = ZEROS
 11383        NEXT SENTENCE
 11384     ELSE
 11385        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11386            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11387           OR
 11388           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11389            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11390           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11391     move zeros                  to ws-check-amts
 11392     move ' '                    to ws-stop-sw
 11393                                    ws-check-sw
 11394                                    ws-proc-check-sw
 11395                                    ws-any-check-sw
 11396                                    ws-chek-browse-sw
 11397
 11398     perform 2500-browse-checks  thru 2500-exit
 11399
 11400     if i-have-processed-checks
 11401        or i-have-checks
 11402        continue
 11403     else
 11404        go to 1330-continue
 11405     end-if
 11406
 11407     compute ws-tot-orig-prem =
 11408        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11409        pb-i-lf-alt-premium-amt
 11410
 11411     if bprem1l <> zeros
 11412        MOVE AL-UNNON            TO bprem1a
 11413        move ws-bprem (1)        to ws-new-iss-total
 11414     else
 11415        move pb-i-lf-premium-amt to ws-new-iss-total
 11416     end-if
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 210
* EL6311.cbl
 11417     display ' new iss totala ' ws-new-iss-total
 11418
 11419     if baltpr1l <> zeros
 11420        MOVE AL-UNNON            TO baltpr1a
 11421        compute ws-new-iss-total =
 11422           ws-new-iss-total + ws-balt-prem(1)
 11423     else
 11424        compute ws-new-iss-total =
 11425           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11426     end-if
 11427
 11428     if bprem2l <> zeros
 11429        MOVE AL-UNNON            TO bprem2a
 11430        compute ws-new-iss-total = ws-new-iss-total +
 11431           ws-bprem (2)
 11432     else
 11433        compute ws-new-iss-total = ws-new-iss-total +
 11434           pb-i-ah-premium-amt
 11435     end-if
 11436
 11437     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11438        if ((bprem1l <> zeros)
 11439           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11440                      or
 11441           ((bprem2l <> zeros)
 11442           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11443           move er-3456          to emi-error
 11444           perform 9900-error-format
 11445                                 thru 9900-exit
 11446           go to 1330-continue
 11447        end-if
 11448     end-if
 11449
 11450     if ws-new-iss-total > ws-tot-orig-prem
 11451        move er-3458             to emi-error
 11452        perform 9900-error-format thru 9900-exit
 11453        move al-uabon            to bmainta
 11454        move -1                  to bmaintl
 11455        go to 8200-send-dataonly
 11456     end-if
 11457
 11458     if ws-new-iss-total < ws-tot-orig-prem
 11459        move er-3457             to emi-error
 11460        move al-uabon            to bprem1a
 11461                                    bprem2a
 11462        move +0 to bprem1l bprem2l
 11463        perform 9900-error-format thru 9900-exit
 11464        move -1                  to bmaintl
 11465        go to 1330-continue
 11466     end-if
 11467
 11468     .
 11469 1330-continue.
 11470
 11471
 11472* EXEC CICS READ
 11473*        DATASET (FILE-ID-ERPNDB)
 11474*        INTO    (PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 211
* EL6311.cbl
 11475*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11476*        UPDATE
 11477*    END-EXEC.
 11478     MOVE LENGTH OF
 11479      PENDING-BUSINESS
 11480       TO DFHEIV11
 11481*    MOVE '&"IL       EU         (   #00011087' TO DFHEIV0
 11482     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11483     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11484     MOVE X'2020233030303131303837' TO DFHEIV0(25:11)
 11485     CALL 'kxdfhei1' USING DFHEIV0,
 11486           FILE-ID-ERPNDB,
 11487           PENDING-BUSINESS,
 11488           DFHEIV11,
 11489           PI-PREV-CONTROL-PRIMARY,
 11490           DFHEIV99,
 11491           DFHEIV99,
 11492           DFHEIV99
 11493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11494
 11495
 11496     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11497     MOVE 'B'                    TO JP-RECORD-TYPE
 11498     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11499     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11500
 11501     PERFORM 8400-LOG-JOURNAL-RECORD.
 11502
 11503     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11504        PB-CHG-COUNT NOT = ZEROS
 11505        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11506            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11507           OR
 11508           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11509            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11510            MOVE LOW-VALUES             TO PB-BILLED-DT
 11511            ADD +1                      TO PB-CHG-COUNT.
 11512
 11513     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11514     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11515     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11516     MOVE '5'                    TO DC-OPTION-CODE.
 11517     PERFORM 9700-DATE-LINK
 11518     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11519
 11520*    IF BMICRNOL  GREATER  ZEROS
 11521*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11522
 11523     IF BVINL > ZEROS
 11524        MOVE BVINI               TO PB-I-VIN
 11525     END-IF
 11526     IF (BFORCEL NOT = ZEROS)
 11527        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11528        AND (BFORCEI = ' ')
 11529        AND (PB-FORCE-CODE = 'O')
 11530        COMPUTE PB-I-AH-PREMIUM-AMT =
 11531           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11532        PERFORM 1800-REMOVE-CERT-NOTES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 212
* EL6311.cbl
 11533                                 THRU 1800-EXIT
 11534        PERFORM 1900-DELETE-ERPYAJ
 11535                                 THRU 1900-EXIT
 11536        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11537     END-IF
 11538     IF (BFORCEL NOT = ZEROS)
 11539        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11540        AND (BFORCEI = 'O')
 11541        AND (PB-FORCE-CODE NOT = 'O')
 11542        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11543           PB-I-AH-PREM-CALC
 11544        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11545        MOVE SPACE               TO DC-OPTION-CODE
 11546        PERFORM 9700-DATE-LINK
 11547        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11548        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11549        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11550        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11551        PERFORM 1500-UPDATE-ERNOTE
 11552                                 THRU 1500-EXIT
 11553        PERFORM 1600-UPDATE-ERPYAJ
 11554                                 THRU 1600-EXIT
 11555     END-IF
 11556     IF BLSTNML  GREATER THAN ZEROS
 11557         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11558
 11559     IF B1STNML  GREATER THAN ZEROS
 11560         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11561
 11562     IF BINITL   GREATER THAN ZEROS
 11563         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11564
 11565     IF BBIRTHL  GREATER THAN ZERO
 11566         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11567
 11568     IF B1STPMTL GREATER THAN ZERO
 11569         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11570
 11571     IF BAGEL    GREATER THAN ZEROS
 11572         MOVE BAGEI              TO PB-I-AGE.
 11573
 11574     MOVE 'N'                    TO WS-INS-AGE-SET
 11575                                    WS-JNT-AGE-SET.
 11576     IF BAGEL    GREATER THAN ZEROS
 11577        MOVE 'Y'                TO WS-INS-AGE-SET
 11578        IF BAGEI = ZERO AND
 11579             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11580           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11581           MOVE 'AGE*'          TO BAGEDEFO
 11582        ELSE
 11583           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11584           MOVE 'AGE '          TO BAGEDEFO
 11585        END-IF
 11586        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11587     END-IF.
 11588
 11589     IF BSEXL    GREATER THAN ZEROS
 11590         MOVE BSEXI              TO PB-I-INSURED-SEX.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 213
* EL6311.cbl
 11591
 11592     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11593        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11594
 11595     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11596        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11597
 11598     IF BLNTRML  GREATER THAN ZEROS
 11599         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11600
 11601     IF BFREQL   GREATER THAN ZEROS
 11602         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11603
 11604     IF BSKPCDL  GREATER THAN ZEROS
 11605         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11606
 11607     IF BMODEL   GREATER THAN ZEROS
 11608         MOVE BMODEI             TO PB-I-TERM-TYPE
 11609                                    PI-BMODE.
 11610
 11611     IF BPMTSL   GREATER THAN ZEROS
 11612         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11613                                    PI-BPMTS.
 11614
 11615     IF BPMTAMTL GREATER THAN ZEROS
 11616         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11617
 11618     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11619         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11620
 11621     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11622         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11623
 11624     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11625
 11626     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11627         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11628            SUBTRACT PB-I-LF-PREMIUM-AMT
 11629                     FROM WS-B-LF-ISS-PRM-ENTERED
 11630            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11631            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11632            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11633         ELSE
 11634            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11635*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11636*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11637         END-IF
 11638     END-IF.
 11639
 11640     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11641            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11642                     FROM WS-B-LF-ISS-PRM-ENTERED
 11643         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11644         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11645
 11646     IF  BALT-PREM-LEN     (2)  > ZEROS
 11647         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11648
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 214
* EL6311.cbl
 11649     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11650         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11651
 11652     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11653         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11654            SUBTRACT PB-I-AH-PREMIUM-AMT
 11655                     FROM WS-B-AH-ISS-PRM-ENTERED
 11656            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11657            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11658            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11659         ELSE
 11660            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11661*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11662*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11663         END-IF
 11664     END-IF
 11665
 11666     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11667        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11668
 11669     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11670        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11671
 11672     IF BINDGRPL            GREATER THAN ZEROS
 11673         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11674
 11675     IF BRTCLSL             GREATER THAN ZEROS
 11676         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11677
 11678     IF BSIGL               GREATER THAN ZEROS
 11679         MOVE BSIGI              TO PB-I-SIG-SW.
 11680
 11681     IF BAPRL               GREATER THAN ZEROS
 11682         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11683
 11684     IF BMEMBERL            GREATER THAN ZEROS
 11685         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11686
 11687     IF BLNOFCRL            GREATER THAN ZEROS
 11688         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11689
 11690     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11691        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11692
 11693     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11694        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11695
 11696     IF BDAYSL              GREATER THAN ZEROS
 11697        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11698                                    PB-I-EXTENTION-DAYS.
 11699
 11700     IF BDAYSL GREATER THAN ZEROS
 11701        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11702
 11703     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11704        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11705           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11706
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 215
* EL6311.cbl
 11707     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11708        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11709           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11710
 11711     IF B1STPMTL GREATER THAN ZEROS
 11712        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11713
 11714     IF PB-EXT-DAYS-PROCESSING
 11715        IF PB-I-EXTENTION-DAYS = ZEROS
 11716           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11717
 11718     IF PB-EXPIRE-DT-PROCESSING
 11719        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11720           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11721             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11722
 11723     IF PB-1ST-PMT-DT-PROCESSING
 11724        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11725           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11726
 11727     IF BREINL GREATER THAN ZEROS
 11728        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11729
 11730     IF BFORCEL NOT = ZEROS
 11731        MOVE BFORCEI             TO PB-FORCE-CODE.
 11732     IF (BENTRYL NOT = ZEROS)
 11733        AND (PB-COMPANY-ID = 'CID')
 11734        AND (PB-STATE = 'VA')
 11735        AND (BENTRYI NOT = 'P')
 11736        AND (PB-BATCH-ENTRY = 'P')
 11737        PERFORM 1800-REMOVE-CERT-NOTES
 11738                                 THRU 1800-EXIT
 11739     END-IF
 11740     IF BENTRYL NOT = ZEROS
 11741        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11742        IF PI-COMPANY-ID = 'CID'
 11743           AND (PB-BATCH-ENTRY = 'P')
 11744           AND (PB-STATE = 'VA')
 11745           PERFORM 1500-UPDATE-ERNOTE
 11746                                 THRU 1500-EXIT
 11747        END-IF
 11748     END-IF
 11749
 11750     IF BUNWRITL NOT = ZEROS
 11751        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11752
 11753     IF BBILCDL NOT = ZEROS
 11754        MOVE BBILCDI             TO PB-RECORD-BILL.
 11755
 11756     IF BLIVESL GREATER THAN ZEROS
 11757        MOVE WS-BLIVES           TO PB-I-LIVES.
 11758
 11759
 11760*DMD CUSTOM CODING*************START
 11761     IF PI-COMPANY-ID NOT = 'DMD'
 11762         MOVE ZEROS               TO BBILLEDL.
 11763*DMD CUSTOM CODING*************END
 11764
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 216
* EL6311.cbl
 11765     IF BBILLEDL GREATER THAN ZEROS
 11766        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11767
 11768
 11769*****************************************************************
 11770*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11771*****************************************************************
 11772
 11773     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11774        IF BTYPE  (1)   = ZEROS OR SPACES
 11775           IF REMOVE-LF-COVERAGE
 11776               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11777                                        PI-BTYPE (1)
 11778               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11779                                        WS-B-LF-ISS-PRM-ENTERED
 11780               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11781                                        WS-B-LF-ISS-PRM-ENTERED
 11782               SUBTRACT PB-I-LF-PREM-CALC FROM
 11783                                        WS-B-LF-ISS-PRM-COMPUTED
 11784               MOVE ZEROS            TO PB-I-LF-TERM
 11785                                        PB-I-LF-BENEFIT-AMT
 11786                                        PB-I-LF-PREMIUM-AMT
 11787                                        PB-I-LF-BENEFIT-CD
 11788                                        PB-I-LF-PREM-CALC
 11789                                        PB-I-LF-CRIT-PER
 11790                                        PB-I-LF-ALT-BENEFIT-AMT
 11791                                        PB-I-LF-ALT-PREMIUM-AMT
 11792               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11793           ELSE
 11794               NEXT SENTENCE
 11795        ELSE
 11796           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11797                                    PI-BTYPE (1).
 11798     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11799        IF BTYPE  (2)   = ZEROS OR SPACES
 11800           IF  REMOVE-AH-COVERAGE
 11801               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11802                                        PI-BTYPE (2)
 11803               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11804                                        WS-B-AH-ISS-PRM-ENTERED
 11805               SUBTRACT PB-I-AH-PREM-CALC FROM
 11806                                        WS-B-AH-ISS-PRM-COMPUTED
 11807               MOVE ZEROS            TO PB-I-AH-TERM
 11808                                        PB-I-AH-BENEFIT-AMT
 11809                                        PB-I-AH-PREMIUM-AMT
 11810                                        PB-I-AH-BENEFIT-CD
 11811                                        PB-I-AH-PREM-CALC
 11812                                        PB-I-AH-CRIT-PER
 11813               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11814           ELSE
 11815               NEXT SENTENCE
 11816        ELSE
 11817           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11818                                    PI-BTYPE (2).
 11819 1360-REWRITE-PB-RECORD.
 11820     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11821
 11822     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 217
* EL6311.cbl
 11823     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11824
 11825     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11826
 11827     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11828     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11829
 11830     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11831         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11832
 11833     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11834         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11835
 11836     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11837
 11838     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11839
 11840     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11841
 11842     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11843     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11844     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11845
 11846     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11847     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11848
 11849 1375-REWRITE-PB-RECORD.
 11850     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11851     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11852     MOVE 'C'                    TO JP-RECORD-TYPE.
 11853     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11854
 11855
 11856* EXEC CICS REWRITE
 11857*        DATASET (FILE-ID-ERPNDB)
 11858*        FROM    (PENDING-BUSINESS)
 11859*    END-EXEC.
 11860     MOVE LENGTH OF
 11861      PENDING-BUSINESS
 11862       TO DFHEIV11
 11863*    MOVE '&& L                  %   #00011453' TO DFHEIV0
 11864     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11865     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11866     MOVE X'2020233030303131343533' TO DFHEIV0(25:11)
 11867     CALL 'kxdfhei1' USING DFHEIV0,
 11868           FILE-ID-ERPNDB,
 11869           PENDING-BUSINESS,
 11870           DFHEIV11,
 11871           DFHEIV99
 11872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11873
 11874
 11875     PERFORM 8400-LOG-JOURNAL-RECORD.
 11876******************************************************************
 11877*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11878******************************************************************
 11879     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11880     MOVE ' '                    TO WS-ERMAIL-SW
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 218
* EL6311.cbl
 11881
 11882* EXEC CICS READ
 11883*       DATASET   (FILE-ID-ERMAIL)
 11884*       SET       (ADDRESS OF MAILING-DATA)
 11885*       RIDFLD    (ERMAIL-KEY)
 11886*       RESP      (WS-RESPONSE)
 11887*    END-EXEC
 11888*    MOVE '&"S        E          (  N#00011464' TO DFHEIV0
 11889     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11890     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11891     MOVE X'204E233030303131343634' TO DFHEIV0(25:11)
 11892     CALL 'kxdfhei1' USING DFHEIV0,
 11893           FILE-ID-ERMAIL,
 11894           DFHEIV20,
 11895           DFHEIV99,
 11896           ERMAIL-KEY,
 11897           DFHEIV99,
 11898           DFHEIV99,
 11899           DFHEIV99
 11900     SET ADDRESS OF MAILING-DATA TO
 11901         DFHEIV20
 11902     MOVE EIBRESP  TO WS-RESPONSE
 11903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11904     IF RESP-NORMAL
 11905        SET ERMAIL-FOUND TO TRUE
 11906     END-IF
 11907
 11908     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11909     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11910                                 TO ELCRTO-KEY
 11911     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11912     MOVE +0                     TO ELCRTO-SEQ-NO
 11913
 11914* EXEC CICS READ
 11915*       DATASET   ('ELCRTO')
 11916*       INTO      (ORIGINAL-CERTIFICATE)
 11917*       RIDFLD    (ELCRTO-KEY)
 11918*       GTEQ
 11919*       RESP      (WS-RESPONSE)
 11920*    END-EXEC
 11921     MOVE LENGTH OF
 11922      ORIGINAL-CERTIFICATE
 11923       TO DFHEIV11
 11924     MOVE 'ELCRTO' TO DFHEIV1
 11925*    MOVE '&"IL       G          (  N#00011479' TO DFHEIV0
 11926     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11927     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11928     MOVE X'204E233030303131343739' TO DFHEIV0(25:11)
 11929     CALL 'kxdfhei1' USING DFHEIV0,
 11930           DFHEIV1,
 11931           ORIGINAL-CERTIFICATE,
 11932           DFHEIV11,
 11933           ELCRTO-KEY,
 11934           DFHEIV99,
 11935           DFHEIV99,
 11936           DFHEIV99
 11937     MOVE EIBRESP  TO WS-RESPONSE
 11938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 219
* EL6311.cbl
 11939*    display ' just read gteq ' ws-response
 11940     IF RESP-NORMAL
 11941        AND (OC-CONTROL-PRIMARY (1:33) =
 11942                 PB-CONTROL-BY-ACCOUNT (1:33))
 11943        AND (OC-RECORD-TYPE = 'I')
 11944        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11945           display ' csr edit session ' PI-CSR-SESSION-SW
 11946           IF NOT CSR-EDIT-SESSION
 11947
 11948* EXEC CICS READ
 11949*                DATASET   ('ELCRTO')
 11950*                INTO      (ORIGINAL-CERTIFICATE)
 11951*                RIDFLD    (OC-CONTROL-PRIMARY)
 11952*                UPDATE
 11953*                RESP      (WS-RESPONSE)
 11954*             END-EXEC
 11955     MOVE LENGTH OF
 11956      ORIGINAL-CERTIFICATE
 11957       TO DFHEIV11
 11958     MOVE 'ELCRTO' TO DFHEIV1
 11959*    MOVE '&"IL       EU         (  N#00011496' TO DFHEIV0
 11960     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11961     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11962     MOVE X'204E233030303131343936' TO DFHEIV0(25:11)
 11963     CALL 'kxdfhei1' USING DFHEIV0,
 11964           DFHEIV1,
 11965           ORIGINAL-CERTIFICATE,
 11966           DFHEIV11,
 11967           OC-CONTROL-PRIMARY,
 11968           DFHEIV99,
 11969           DFHEIV99,
 11970           DFHEIV99
 11971     MOVE EIBRESP  TO WS-RESPONSE
 11972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11973              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11974              IF RESP-NORMAL
 11975                 display ' good read upd '
 11976                 MOVE PB-I-INSURED-LAST-NAME TO
 11977                         OC-INS-LAST-NAME
 11978                 MOVE PB-I-INSURED-FIRST-NAME TO
 11979                         OC-INS-FIRST-NAME
 11980                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11981                         OC-INS-MIDDLE-INIT
 11982                 MOVE PB-I-AGE         TO OC-INS-AGE
 11983                 MOVE PB-I-JOINT-LAST-NAME   TO
 11984                         OC-JNT-LAST-NAME
 11985                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11986                         OC-JNT-FIRST-NAME
 11987                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11988                         OC-JNT-MIDDLE-INIT
 11989                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11990                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11991                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11992                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11993                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11994                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11995                         OC-LF-ALT-BEN-AMT
 11996                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 220
* EL6311.cbl
 11997                         OC-LF-ALT-PRM-AMT
 11998                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11999                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12000                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12001                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12002                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12003                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12004                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12005                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12006                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12007                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12008                 IF OC-CANCEL-TRAN-IND = 'N'
 12009                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 12010                    MOVE +0            TO OC-LF-CANCEL-AMT
 12011                                          OC-LF-ITD-CANCEL-AMT
 12012                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 12013                    MOVE +0            TO OC-AH-CANCEL-AMT
 12014                                          OC-AH-ITD-CANCEL-AMT
 12015                 END-IF
 12016                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12017                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12018                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12019                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12020                 IF ERMAIL-FOUND
 12021                    MOVE MA-CRED-BENE-NAME
 12022                                 TO OC-CRED-BENE-NAME
 12023                 END-IF
 12024                 IF NOT CERT-TRL-REC-NOT-FOUND
 12025                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12026                           OC-INS-AGE-DEFAULT-FLAG
 12027                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12028                           OC-JNT-AGE-DEFAULT-FLAG
 12029                 END-IF
 12030
 12031* EXEC CICS REWRITE
 12032*                   DATASET   ('ELCRTO')
 12033*                   FROM      (ORIGINAL-CERTIFICATE)
 12034*                   RESP      (WS-RESPONSE)
 12035*                END-EXEC
 12036     MOVE LENGTH OF
 12037      ORIGINAL-CERTIFICATE
 12038       TO DFHEIV11
 12039     MOVE 'ELCRTO' TO DFHEIV1
 12040*    MOVE '&& L                  %  N#00011560' TO DFHEIV0
 12041     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12042     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12043     MOVE X'204E233030303131353630' TO DFHEIV0(25:11)
 12044     CALL 'kxdfhei1' USING DFHEIV0,
 12045           DFHEIV1,
 12046           ORIGINAL-CERTIFICATE,
 12047           DFHEIV11,
 12048           DFHEIV99
 12049     MOVE EIBRESP  TO WS-RESPONSE
 12050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12051                 display ' just rewrote ' ws-response
 12052              END-IF
 12053           END-IF
 12054        ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 221
* EL6311.cbl
 12055           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 12056           MOVE 'OC'             TO OC-RECORD-ID
 12057           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12058           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12059           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12060           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12061           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12062           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12063           MOVE PB-I-AGE         TO OC-INS-AGE
 12064           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12065           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12066           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12067           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12068           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12069           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12070           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12071           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12072           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12073           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12074           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12075           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12076           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 12077           MOVE +0               TO OC-LF-CANCEL-AMT
 12078                                    OC-LF-ITD-CANCEL-AMT
 12079           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12080           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12081           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12082           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12083           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12084           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12085           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12086           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 12087           MOVE +0               TO OC-AH-CANCEL-AMT
 12088                                    OC-AH-ITD-CANCEL-AMT
 12089           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12090           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12091           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 12092           IF ERMAIL-FOUND
 12093              MOVE MA-CRED-BENE-NAME
 12094                                 TO OC-CRED-BENE-NAME
 12095           END-IF
 12096           IF NOT CERT-TRL-REC-NOT-FOUND
 12097              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12098                           OC-INS-AGE-DEFAULT-FLAG
 12099              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12100                           OC-JNT-AGE-DEFAULT-FLAG
 12101           END-IF
 12102           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 12103
 12104* EXEC CICS WRITE
 12105*             DATASET   ('ELCRTO')
 12106*             FROM      (ORIGINAL-CERTIFICATE)
 12107*             RIDFLD    (OC-CONTROL-PRIMARY)
 12108*             RESP      (WS-RESPONSE)
 12109*          END-EXEC
 12110     MOVE LENGTH OF
 12111      ORIGINAL-CERTIFICATE
 12112       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 222
* EL6311.cbl
 12113     MOVE 'ELCRTO' TO DFHEIV1
 12114*    MOVE '&$ L                  ''  N#00011617' TO DFHEIV0
 12115     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12116     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12117     MOVE X'204E233030303131363137' TO DFHEIV0(25:11)
 12118     CALL 'kxdfhei1' USING DFHEIV0,
 12119           DFHEIV1,
 12120           ORIGINAL-CERTIFICATE,
 12121           DFHEIV11,
 12122           OC-CONTROL-PRIMARY,
 12123           DFHEIV99,
 12124           DFHEIV99
 12125     MOVE EIBRESP  TO WS-RESPONSE
 12126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12127        END-IF
 12128     ELSE
 12129        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12130        MOVE 'OC'                TO OC-RECORD-ID
 12131        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12132                                 TO OC-CONTROL-PRIMARY (1:33)
 12133        MOVE 'I'                 TO OC-RECORD-TYPE
 12134        MOVE +4096               TO OC-KEY-SEQ-NO
 12135        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12136        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12137        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12138        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12139        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12140        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12141        MOVE PB-I-AGE            TO OC-INS-AGE
 12142        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12143        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12144        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12145        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12146        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12147        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12148        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12149        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12150        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12151        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12152        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12153        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12154        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 12155        MOVE +0                  TO OC-LF-CANCEL-AMT
 12156                                    OC-LF-ITD-CANCEL-AMT
 12157        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12158        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12159        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12160        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12161        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12162        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12163        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12164        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12165        MOVE +0                  TO OC-AH-CANCEL-AMT
 12166                                    OC-AH-ITD-CANCEL-AMT
 12167        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12168        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12169        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 12170        IF ERMAIL-FOUND
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 223
* EL6311.cbl
 12171           MOVE MA-CRED-BENE-NAME
 12172                                 TO OC-CRED-BENE-NAME
 12173        END-IF
 12174        IF NOT CERT-TRL-REC-NOT-FOUND
 12175           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12176                           OC-INS-AGE-DEFAULT-FLAG
 12177           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12178                           OC-JNT-AGE-DEFAULT-FLAG
 12179        END-IF
 12180        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12181
 12182* EXEC CICS WRITE
 12183*          DATASET   ('ELCRTO')
 12184*          FROM      (ORIGINAL-CERTIFICATE)
 12185*          RIDFLD    (OC-CONTROL-PRIMARY)
 12186*          RESP      (WS-RESPONSE)
 12187*       END-EXEC
 12188     MOVE LENGTH OF
 12189      ORIGINAL-CERTIFICATE
 12190       TO DFHEIV11
 12191     MOVE 'ELCRTO' TO DFHEIV1
 12192*    MOVE '&$ L                  ''  N#00011677' TO DFHEIV0
 12193     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12194     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12195     MOVE X'204E233030303131363737' TO DFHEIV0(25:11)
 12196     CALL 'kxdfhei1' USING DFHEIV0,
 12197           DFHEIV1,
 12198           ORIGINAL-CERTIFICATE,
 12199           DFHEIV11,
 12200           OC-CONTROL-PRIMARY,
 12201           DFHEIV99,
 12202           DFHEIV99
 12203     MOVE EIBRESP  TO WS-RESPONSE
 12204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12205     END-IF
 12206******************************************************************
 12207*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12208******************************************************************
 12209
 12210     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12211     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12212
 12213
 12214* EXEC CICS READ
 12215*        INTO    (PENDING-BUSINESS)
 12216*        DATASET (FILE-ID-ERPNDB)
 12217*        RIDFLD  (ERPNDB-KEY)
 12218*        UPDATE
 12219*    END-EXEC.
 12220     MOVE LENGTH OF
 12221      PENDING-BUSINESS
 12222       TO DFHEIV11
 12223*    MOVE '&"IL       EU         (   #00011691' TO DFHEIV0
 12224     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12225     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12226     MOVE X'2020233030303131363931' TO DFHEIV0(25:11)
 12227     CALL 'kxdfhei1' USING DFHEIV0,
 12228           FILE-ID-ERPNDB,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 224
* EL6311.cbl
 12229           PENDING-BUSINESS,
 12230           DFHEIV11,
 12231           ERPNDB-KEY,
 12232           DFHEIV99,
 12233           DFHEIV99,
 12234           DFHEIV99
 12235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12236
 12237
 12238     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12239     MOVE 'B'                    TO JP-RECORD-TYPE.
 12240     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12241
 12242     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12243
 12244     PERFORM 8400-LOG-JOURNAL-RECORD.
 12245
 12246     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 12247
 12248     MOVE 'C'                    TO JP-RECORD-TYPE.
 12249     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12250
 12251
 12252* EXEC CICS REWRITE
 12253*        DATASET    (FILE-ID-ERPNDB)
 12254*        FROM       (PENDING-BUSINESS)
 12255*    END-EXEC.
 12256     MOVE LENGTH OF
 12257      PENDING-BUSINESS
 12258       TO DFHEIV11
 12259*    MOVE '&& L                  %   #00011711' TO DFHEIV0
 12260     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12261     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12262     MOVE X'2020233030303131373131' TO DFHEIV0(25:11)
 12263     CALL 'kxdfhei1' USING DFHEIV0,
 12264           FILE-ID-ERPNDB,
 12265           PENDING-BUSINESS,
 12266           DFHEIV11,
 12267           DFHEIV99
 12268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12269
 12270
 12271     PERFORM 8400-LOG-JOURNAL-RECORD.
 12272
 12273     IF WS-ERRORS-PRESENT
 12274        GO TO 3900-RE-DISPLAY-RECORD.
 12275
 12276     MOVE ZEROS                  TO EMI-ERROR.
 12277     MOVE -1                     TO BMAINTL.
 12278     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12279     GO TO 3900-RE-DISPLAY-RECORD.
 12280
 12281 1380-BATCH-HDR-NOT-FOUND.
 12282     MOVE -1                     TO BMAINTL.
 12283     MOVE ER-7450                TO EMI-ERROR.
 12284     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12285     GO TO 8200-SEND-DATAONLY.
 12286
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 225
* EL6311.cbl
 12287 1385-REC-NOT-FOUND.
 12288     MOVE -1                     TO BMAINTL.
 12289     MOVE ER-7451                TO EMI-ERROR.
 12290     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12291     GO TO 8200-SEND-DATAONLY.
 12292
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 226
* EL6311.cbl
 12294
 12295 1386-UPDATE-AGE-FLAGS.
 12296
 12297
 12298* EXEC CICS GETMAIN
 12299*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12300*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12301*        INITIMG (GETMAIN-SPACE)
 12302*    END-EXEC
 12303*    MOVE ',"IL                  $   #00011742' TO DFHEIV0
 12304     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12305     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12306     MOVE X'2020233030303131373432' TO DFHEIV0(25:11)
 12307     CALL 'kxdfhei1' USING DFHEIV0,
 12308           DFHEIV20,
 12309           ELCRTT-RECORD-LENGTH,
 12310           GETMAIN-SPACE
 12311     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12312         DFHEIV20
 12313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12314
 12315
 12316* EXEC CICS HANDLE CONDITION
 12317*        NOTFND   (1386-NOTFND)
 12318*    END-EXEC.
 12319*    MOVE '"$I                   ! ( #00011748' TO DFHEIV0
 12320     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12321     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12322     MOVE X'2820233030303131373438' TO DFHEIV0(25:11)
 12323     CALL 'kxdfhei1' USING DFHEIV0
 12324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12325
 12326
 12327     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12328     MOVE 'C'                TO ELCRTT-REC-TYPE
 12329
 12330
 12331* EXEC CICS READ
 12332*        UPDATE
 12333*        DATASET  (CRTT-ID)
 12334*        RIDFLD   (ELCRTT-KEY)
 12335*        INTO     (CERTIFICATE-TRAILERS)
 12336*    END-EXEC.
 12337     MOVE LENGTH OF
 12338      CERTIFICATE-TRAILERS
 12339       TO DFHEIV11
 12340*    MOVE '&"IL       EU         (   #00011755' TO DFHEIV0
 12341     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12342     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12343     MOVE X'2020233030303131373535' TO DFHEIV0(25:11)
 12344     CALL 'kxdfhei1' USING DFHEIV0,
 12345           CRTT-ID,
 12346           CERTIFICATE-TRAILERS,
 12347           DFHEIV11,
 12348           ELCRTT-KEY,
 12349           DFHEIV99,
 12350           DFHEIV99,
 12351           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 227
* EL6311.cbl
 12352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12353
 12354
 12355     IF WS-INS-AGE-SET = 'Y'
 12356        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12357     END-IF
 12358     IF WS-JNT-AGE-SET = 'Y'
 12359        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12360     END-IF
 12361
 12362
 12363* EXEC CICS REWRITE
 12364*       DATASET  (CRTT-ID)
 12365*       FROM     (CERTIFICATE-TRAILERS)
 12366*    END-EXEC.
 12367     MOVE LENGTH OF
 12368      CERTIFICATE-TRAILERS
 12369       TO DFHEIV11
 12370*    MOVE '&& L                  %   #00011769' TO DFHEIV0
 12371     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12372     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12373     MOVE X'2020233030303131373639' TO DFHEIV0(25:11)
 12374     CALL 'kxdfhei1' USING DFHEIV0,
 12375           CRTT-ID,
 12376           CERTIFICATE-TRAILERS,
 12377           DFHEIV11,
 12378           DFHEIV99
 12379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12380
 12381
 12382     GO TO 1386-EXIT.
 12383
 12384 1386-NOTFND.
 12385
 12386     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12387     MOVE 'CS'         TO CS-RECORD-ID.
 12388     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12389     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12390     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12391     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12392     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12393
 12394* EXEC CICS WRITE
 12395*       DATASET  (CRTT-ID)
 12396*       RIDFLD   (ELCRTT-KEY)
 12397*       FROM     (CERTIFICATE-TRAILERS)
 12398*    END-EXEC.
 12399     MOVE LENGTH OF
 12400      CERTIFICATE-TRAILERS
 12401       TO DFHEIV11
 12402*    MOVE '&$ L                  ''   #00011785' TO DFHEIV0
 12403     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12404     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12405     MOVE X'2020233030303131373835' TO DFHEIV0(25:11)
 12406     CALL 'kxdfhei1' USING DFHEIV0,
 12407           CRTT-ID,
 12408           CERTIFICATE-TRAILERS,
 12409           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 228
* EL6311.cbl
 12410           ELCRTT-KEY,
 12411           DFHEIV99,
 12412           DFHEIV99
 12413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12414
 12415
 12416 1386-EXIT.
 12417     EXIT.
 12418
 12419 1390-UPDATE-ERPNDM.
 12420
 12421
 12422* EXEC CICS HANDLE CONDITION
 12423*        NOTFND (1399-EXIT)
 12424*    END-EXEC.
 12425*    MOVE '"$I                   ! ) #00011796' TO DFHEIV0
 12426     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12427     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12428     MOVE X'2920233030303131373936' TO DFHEIV0(25:11)
 12429     CALL 'kxdfhei1' USING DFHEIV0
 12430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12431
 12432
 12433     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12434
 12435
 12436* EXEC CICS READ
 12437*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12438*        DATASET (FILE-ID-ERPNDM)
 12439*        RIDFLD  (ERPNDM-KEY)
 12440*        UPDATE
 12441*    END-EXEC.
 12442*    MOVE '&"S        EU         (   #00011802' TO DFHEIV0
 12443     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12444     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12445     MOVE X'2020233030303131383032' TO DFHEIV0(25:11)
 12446     CALL 'kxdfhei1' USING DFHEIV0,
 12447           FILE-ID-ERPNDM,
 12448           DFHEIV20,
 12449           DFHEIV99,
 12450           ERPNDM-KEY,
 12451           DFHEIV99,
 12452           DFHEIV99,
 12453           DFHEIV99
 12454     SET ADDRESS OF PENDING-MAILING-DATA TO
 12455         DFHEIV20
 12456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12457
 12458
 12459     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12460     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12461     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12462
 12463     IF BLSTNML GREATER THAN ZEROS
 12464         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12465
 12466     IF B1STNML GREATER  THAN ZEROS
 12467         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 229
* EL6311.cbl
 12468
 12469     IF BINITL GREATER THAN ZEROS
 12470         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12471
 12472     IF BAGEL GREATER THAN ZEROS
 12473         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12474
 12475     IF BBIRTHL GREATER THAN ZEROS
 12476         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12477
 12478     IF BSEXL GREATER THAN ZEROS
 12479         MOVE  BSEXI             TO PM-INSURED-SEX.
 12480
 12481
 12482* EXEC CICS REWRITE
 12483*        DATASET (FILE-ID-ERPNDM)
 12484*        FROM    (PENDING-MAILING-DATA)
 12485*    END-EXEC.
 12486     MOVE LENGTH OF
 12487      PENDING-MAILING-DATA
 12488       TO DFHEIV11
 12489*    MOVE '&& L                  %   #00011831' TO DFHEIV0
 12490     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12491     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12492     MOVE X'2020233030303131383331' TO DFHEIV0(25:11)
 12493     CALL 'kxdfhei1' USING DFHEIV0,
 12494           FILE-ID-ERPNDM,
 12495           PENDING-MAILING-DATA,
 12496           DFHEIV11,
 12497           DFHEIV99
 12498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12499
 12500
 12501 1399-EXIT.
 12502     EXIT.
 12503
 12504******************************************************************
 12505*                                                                *
 12506*          D E L E T E   I S S U E   R O U T I N E               *
 12507*                                                                *
 12508******************************************************************
 12509
 12510 1400-DELETE-ISSUE-ROUTINE.
 12511     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12512
 12513     IF BCHGL NOT = ZEROS
 12514        MOVE ER-2196             TO EMI-ERROR
 12515        MOVE AL-UABON            TO BMAINTA
 12516        MOVE -1                  TO BMAINTL
 12517        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12518        GO TO 8200-SEND-DATAONLY.
 12519
 12520
 12521* EXEC CICS HANDLE CONDITION
 12522*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12523*    END-EXEC.
 12524*    MOVE '"$I                   ! * #00011855' TO DFHEIV0
 12525     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 230
* EL6311.cbl
 12526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12527     MOVE X'2A20233030303131383535' TO DFHEIV0(25:11)
 12528     CALL 'kxdfhei1' USING DFHEIV0
 12529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12530
 12531
 12532     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12533     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12534     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12535
 12536
 12537* EXEC CICS READ
 12538*        SET     (ADDRESS OF PENDING-BUSINESS)
 12539*        DATASET (FILE-ID-ERPNDB)
 12540*        RIDFLD  (ERPNDB-KEY)
 12541*    END-EXEC.
 12542*    MOVE '&"S        E          (   #00011863' TO DFHEIV0
 12543     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12544     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12545     MOVE X'2020233030303131383633' TO DFHEIV0(25:11)
 12546     CALL 'kxdfhei1' USING DFHEIV0,
 12547           FILE-ID-ERPNDB,
 12548           DFHEIV20,
 12549           DFHEIV99,
 12550           ERPNDB-KEY,
 12551           DFHEIV99,
 12552           DFHEIV99,
 12553           DFHEIV99
 12554     SET ADDRESS OF PENDING-BUSINESS TO
 12555         DFHEIV20
 12556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12557
 12558
 12559     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12560
 12561     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12562
 12563     IF BSUFIXL NOT = ZEROS
 12564        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12565     ELSE
 12566        MOVE SPACE               TO WS-NEW-SUFFIX.
 12567
 12568     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12569     PERFORM 8600-DEEDIT.
 12570     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12571     MOVE '4'                    TO DC-OPTION-CODE.
 12572     PERFORM 9700-DATE-LINK.
 12573     IF DATE-CONVERSION-ERROR
 12574        MOVE ER-0348             TO EMI-ERROR
 12575        MOVE -1                  TO BEFFDTL
 12576        MOVE AL-UABON            TO BEFFDTA
 12577        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12578        GO TO 8200-SEND-DATAONLY
 12579     ELSE
 12580        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12581        MOVE AL-UANON            TO BEFFDTA
 12582        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12583
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 231
* EL6311.cbl
 12584
 12585* EXEC CICS HANDLE CONDITION
 12586*         NOTFND    (1490-RECORD-NOT-FOUND)
 12587*    END-EXEC.
 12588*    MOVE '"$I                   ! + #00011894' TO DFHEIV0
 12589     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12590     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12591     MOVE X'2B20233030303131383934' TO DFHEIV0(25:11)
 12592     CALL 'kxdfhei1' USING DFHEIV0
 12593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12594
 12595
 12596
 12597* EXEC CICS READ
 12598*        SET     (ADDRESS OF PENDING-BUSINESS)
 12599*        DATASET (FILE-ID-ERPNDB)
 12600*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12601*        UPDATE
 12602*    END-EXEC.
 12603*    MOVE '&"S        EU         (   #00011898' TO DFHEIV0
 12604     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12605     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12606     MOVE X'2020233030303131383938' TO DFHEIV0(25:11)
 12607     CALL 'kxdfhei1' USING DFHEIV0,
 12608           FILE-ID-ERPNDB,
 12609           DFHEIV20,
 12610           DFHEIV99,
 12611           PI-PREV-CONTROL-PRIMARY,
 12612           DFHEIV99,
 12613           DFHEIV99,
 12614           DFHEIV99
 12615     SET ADDRESS OF PENDING-BUSINESS TO
 12616         DFHEIV20
 12617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12618
 12619
 12620     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12621        MOVE -1                 TO BMAINTL
 12622        MOVE ER-2197            TO EMI-ERROR
 12623        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12624        GO TO 8200-SEND-DATAONLY.
 12625
 12626     IF PB-BILLED-DT NOT = LOW-VALUES
 12627        MOVE -1                 TO BMAINTL
 12628        MOVE ER-2129            TO EMI-ERROR
 12629        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12630        GO TO 8200-SEND-DATAONLY.
 12631
 12632     IF PB-CHG-COUNT NOT = ZEROS
 12633        MOVE ER-2336            TO EMI-ERROR
 12634        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12635        MOVE AL-UABON            TO BMAINTA
 12636        MOVE -1                  TO BMAINTL
 12637        GO TO 8200-SEND-DATAONLY.
 12638
 12639     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12640        PB-CHG-COUNT NOT = ZEROS
 12641        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 232
* EL6311.cbl
 12642        MOVE AL-UABON            TO BMAINTA
 12643        MOVE -1                  TO BMAINTL
 12644        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12645        GO TO 8200-SEND-DATAONLY.
 12646******************************************************************
 12647*                                                                *
 12648*       Determine if there have been any checks created          *
 12649*                                                                *
 12650******************************************************************
 12651
 12652     perform 2500-browse-checks  thru 2500-exit
 12653
 12654     if i-have-processed-checks
 12655        or i-have-checks
 12656        or i-have-a-check-period
 12657        move er-3446             to emi-error
 12658        perform 9900-error-format thru 9900-exit
 12659        move al-uabon            to bmainta
 12660        move -1                  to bmaintl
 12661        go to 8200-send-dataonly
 12662     end-if
 12663******************************************************************
 12664*                                                                *
 12665*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12666*                                                                *
 12667******************************************************************
 12668     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12669     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12670     MOVE +0                     TO ELCRTO-SEQ-NO
 12671
 12672* EXEC CICS READ
 12673*       DATASET   ('ELCRTO')
 12674*       INTO      (ORIGINAL-CERTIFICATE)
 12675*       RIDFLD    (ELCRTO-KEY)
 12676*       GTEQ
 12677*       RESP      (WS-RESPONSE)
 12678*    END-EXEC
 12679     MOVE LENGTH OF
 12680      ORIGINAL-CERTIFICATE
 12681       TO DFHEIV11
 12682     MOVE 'ELCRTO' TO DFHEIV1
 12683*    MOVE '&"IL       G          (  N#00011956' TO DFHEIV0
 12684     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12685     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12686     MOVE X'204E233030303131393536' TO DFHEIV0(25:11)
 12687     CALL 'kxdfhei1' USING DFHEIV0,
 12688           DFHEIV1,
 12689           ORIGINAL-CERTIFICATE,
 12690           DFHEIV11,
 12691           ELCRTO-KEY,
 12692           DFHEIV99,
 12693           DFHEIV99,
 12694           DFHEIV99
 12695     MOVE EIBRESP  TO WS-RESPONSE
 12696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12697     IF RESP-NORMAL
 12698        AND (OC-CONTROL-PRIMARY (1:33) =
 12699                 PB-CONTROL-BY-ACCOUNT (1:33))
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 233
* EL6311.cbl
 12700        AND (OC-RECORD-TYPE = 'I')
 12701
 12702* EXEC CICS READ
 12703*          DATASET   ('ELCRTO')
 12704*          INTO      (ORIGINAL-CERTIFICATE)
 12705*          RIDFLD    (ELCRTO-KEY)
 12706*          UPDATE
 12707*          RESP      (WS-RESPONSE)
 12708*       END-EXEC
 12709     MOVE LENGTH OF
 12710      ORIGINAL-CERTIFICATE
 12711       TO DFHEIV11
 12712     MOVE 'ELCRTO' TO DFHEIV1
 12713*    MOVE '&"IL       EU         (  N#00011967' TO DFHEIV0
 12714     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12715     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12716     MOVE X'204E233030303131393637' TO DFHEIV0(25:11)
 12717     CALL 'kxdfhei1' USING DFHEIV0,
 12718           DFHEIV1,
 12719           ORIGINAL-CERTIFICATE,
 12720           DFHEIV11,
 12721           ELCRTO-KEY,
 12722           DFHEIV99,
 12723           DFHEIV99,
 12724           DFHEIV99
 12725     MOVE EIBRESP  TO WS-RESPONSE
 12726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12727        IF RESP-NORMAL
 12728
 12729* EXEC CICS DELETE
 12730*             DATASET   ('ELCRTO')
 12731*          END-EXEC
 12732     MOVE 'ELCRTO' TO DFHEIV1
 12733*    MOVE '&(                    &   #00011975' TO DFHEIV0
 12734     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12735     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12736     MOVE X'2020233030303131393735' TO DFHEIV0(25:11)
 12737     CALL 'kxdfhei1' USING DFHEIV0,
 12738           DFHEIV1,
 12739           DFHEIV99,
 12740           DFHEIV99,
 12741           DFHEIV99,
 12742           DFHEIV99
 12743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12744        END-IF
 12745     END-IF
 12746******************************************************************
 12747*                                                                *
 12748*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12749*                                                                *
 12750******************************************************************
 12751
 12752* EXEC CICS HANDLE CONDITION
 12753*        NOTFND    (1405-DELETE-CERTIFICATE)
 12754*    END-EXEC.
 12755*    MOVE '"$I                   ! , #00011985' TO DFHEIV0
 12756     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12757     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 234
* EL6311.cbl
 12758     MOVE X'2C20233030303131393835' TO DFHEIV0(25:11)
 12759     CALL 'kxdfhei1' USING DFHEIV0
 12760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12761
 12762
 12763
 12764* EXEC CICS READ
 12765*        EQUAL
 12766*        DATASET   (FILE-ID-ERPNDM)
 12767*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12768*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12769*        UPDATE
 12770*    END-EXEC.
 12771*    MOVE '&"S        EU         (   #00011989' TO DFHEIV0
 12772     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12773     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12774     MOVE X'2020233030303131393839' TO DFHEIV0(25:11)
 12775     CALL 'kxdfhei1' USING DFHEIV0,
 12776           FILE-ID-ERPNDM,
 12777           DFHEIV20,
 12778           DFHEIV99,
 12779           PI-PREV-CONTROL-PRIMARY,
 12780           DFHEIV99,
 12781           DFHEIV99,
 12782           DFHEIV99
 12783     SET ADDRESS OF PENDING-MAILING-DATA TO
 12784         DFHEIV20
 12785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12786
 12787
 12788     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12789     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12790     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12791
 12792     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12793
 12794
 12795* EXEC CICS DELETE
 12796*        DATASET   (FILE-ID-ERPNDM)
 12797*    END-EXEC.
 12798*    MOVE '&(                    &   #00012003' TO DFHEIV0
 12799     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12800     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12801     MOVE X'2020233030303132303033' TO DFHEIV0(25:11)
 12802     CALL 'kxdfhei1' USING DFHEIV0,
 12803           FILE-ID-ERPNDM,
 12804           DFHEIV99,
 12805           DFHEIV99,
 12806           DFHEIV99,
 12807           DFHEIV99
 12808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12809
 12810
 12811******************************************************************
 12812*                PROCESS   CERTIFICATE                           *
 12813******************************************************************
 12814
 12815 1405-DELETE-CERTIFICATE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 235
* EL6311.cbl
 12816
 12817* EXEC CICS HANDLE CONDITION
 12818*         NOTFND  (1420-CONTINUE-DELETE)
 12819*    END-EXEC.
 12820*    MOVE '"$I                   ! - #00012012' TO DFHEIV0
 12821     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12822     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12823     MOVE X'2D20233030303132303132' TO DFHEIV0(25:11)
 12824     CALL 'kxdfhei1' USING DFHEIV0
 12825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12826
 12827
 12828     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12829     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12830     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12831     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12832
 12833
 12834* EXEC CICS READ
 12835*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12836*        DATASET (FILE-ID-ELCERT)
 12837*        RIDFLD  (ELCERT-KEY)
 12838*        UPDATE
 12839*    END-EXEC.
 12840*    MOVE '&"S        EU         (   #00012021' TO DFHEIV0
 12841     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12842     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12843     MOVE X'2020233030303132303231' TO DFHEIV0(25:11)
 12844     CALL 'kxdfhei1' USING DFHEIV0,
 12845           FILE-ID-ELCERT,
 12846           DFHEIV20,
 12847           DFHEIV99,
 12848           ELCERT-KEY,
 12849           DFHEIV99,
 12850           DFHEIV99,
 12851           DFHEIV99
 12852     SET ADDRESS OF CERTIFICATE-MASTER TO
 12853         DFHEIV20
 12854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12855
 12856
 12857     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12858
 12859     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12860     MOVE 'B'                    TO JP-RECORD-TYPE
 12861     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12862
 12863     PERFORM 8400-LOG-JOURNAL-RECORD.
 12864
 12865     IF CERT-NOTES-ARE-NOT-PRESENT
 12866        MOVE ' '                 TO WS-CERT-NOTE-SW
 12867     ELSE
 12868        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12869
 12870     IF INSURED-ADDR-PRESENT
 12871        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12872
 12873******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 236
* EL6311.cbl
 12874******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12875******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12876******************************************************************
 12877******************************************************************
 12878
 12879     IF CERT-ADDED-BATCH AND
 12880        (NOT NO-CLAIM-ATTACHED
 12881         OR
 12882         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12883        GO TO 1410-REWRITE-CERT.
 12884
 12885******************************************************************
 12886******************************************************************
 12887
 12888     IF CERT-ADDED-BATCH  AND
 12889        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12890        GO TO 1410-REWRITE-CERT.
 12891
 12892     IF NO-CLAIM-ATTACHED
 12893        NEXT SENTENCE
 12894     ELSE
 12895        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12896        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12897        GO TO 1410-REWRITE-CERT.
 12898
 12899     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12900     MOVE 'D'                      TO JP-RECORD-TYPE.
 12901     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12902
 12903
 12904* EXEC CICS DELETE
 12905*         DATASET    (FILE-ID-ELCERT)
 12906*    END-EXEC.
 12907*    MOVE '&(                    &   #00012074' TO DFHEIV0
 12908     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12909     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12910     MOVE X'2020233030303132303734' TO DFHEIV0(25:11)
 12911     CALL 'kxdfhei1' USING DFHEIV0,
 12912           FILE-ID-ELCERT,
 12913           DFHEIV99,
 12914           DFHEIV99,
 12915           DFHEIV99,
 12916           DFHEIV99
 12917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12918
 12919
 12920     PERFORM 8400-LOG-JOURNAL-RECORD.
 12921
 12922******************************************************************
 12923*                                                                *
 12924*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12925*                                                                *
 12926******************************************************************
 12927
 12928     IF  CERT-NOTES-ARE-PRESENT
 12929         NEXT SENTENCE
 12930     ELSE
 12931         GO TO 1407-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 237
* EL6311.cbl
 12932
 12933
 12934* EXEC CICS HANDLE CONDITION
 12935*         NOTFND  (1406-DELETE-ERNOTE)
 12936*    END-EXEC.
 12937*    MOVE '"$I                   ! . #00012091' TO DFHEIV0
 12938     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12939     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12940     MOVE X'2E20233030303132303931' TO DFHEIV0(25:11)
 12941     CALL 'kxdfhei1' USING DFHEIV0
 12942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12943
 12944
 12945     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12946     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12947     MOVE 0                     TO ERCNOT-SEQUENCE.
 12948
 12949 1406-DELETE-ERCNOT-LOOP.
 12950
 12951
 12952* EXEC CICS READ
 12953*        GTEQ
 12954*        DATASET   (FILE-ID-ERCNOT)
 12955*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12956*        RIDFLD    (ERCNOT-KEY)
 12957*    END-EXEC.
 12958*    MOVE '&"S        G          (   #00012101' TO DFHEIV0
 12959     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12960     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12961     MOVE X'2020233030303132313031' TO DFHEIV0(25:11)
 12962     CALL 'kxdfhei1' USING DFHEIV0,
 12963           FILE-ID-ERCNOT,
 12964           DFHEIV20,
 12965           DFHEIV99,
 12966           ERCNOT-KEY,
 12967           DFHEIV99,
 12968           DFHEIV99,
 12969           DFHEIV99
 12970     SET ADDRESS OF CERT-NOTE-FILE TO
 12971         DFHEIV20
 12972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12973
 12974
 12975     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12976     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12977         GO TO 1406-DELETE-ERNOTE
 12978     END-IF.
 12979
 12980     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12981     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12982     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12983
 12984     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12985
 12986
 12987* EXEC CICS DELETE
 12988*        DATASET   (FILE-ID-ERCNOT)
 12989*        RIDFLD    (ERCNOT-KEY)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 238
* EL6311.cbl
 12990*        END-EXEC.
 12991*    MOVE '&(  R                 &   #00012119' TO DFHEIV0
 12992     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12993     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12994     MOVE X'2020233030303132313139' TO DFHEIV0(25:11)
 12995     CALL 'kxdfhei1' USING DFHEIV0,
 12996           FILE-ID-ERCNOT,
 12997           ERCNOT-KEY,
 12998           DFHEIV99,
 12999           DFHEIV99,
 13000           DFHEIV99
 13001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13002
 13003
 13004     PERFORM 8400-LOG-JOURNAL-RECORD.
 13005
 13006     GO TO 1406-DELETE-ERCNOT-LOOP.
 13007
 13008 1406-DELETE-ERNOTE.
 13009
 13010
 13011* EXEC CICS HANDLE CONDITION
 13012*         NOTFND  (1407-DELETE-MAILING)
 13013*    END-EXEC.
 13014*    MOVE '"$I                   ! / #00012130' TO DFHEIV0
 13015     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13016     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13017     MOVE X'2F20233030303132313330' TO DFHEIV0(25:11)
 13018     CALL 'kxdfhei1' USING DFHEIV0
 13019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13020
 13021
 13022
 13023* EXEC CICS READ
 13024*        EQUAL
 13025*        DATASET   (FILE-ID-ERNOTE)
 13026*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 13027*        RIDFLD    (ELCERT-KEY)
 13028*        UPDATE
 13029*    END-EXEC.
 13030*    MOVE '&"S        EU         (   #00012134' TO DFHEIV0
 13031     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13032     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13033     MOVE X'2020233030303132313334' TO DFHEIV0(25:11)
 13034     CALL 'kxdfhei1' USING DFHEIV0,
 13035           FILE-ID-ERNOTE,
 13036           DFHEIV20,
 13037           DFHEIV99,
 13038           ELCERT-KEY,
 13039           DFHEIV99,
 13040           DFHEIV99,
 13041           DFHEIV99
 13042     SET ADDRESS OF CERTIFICATE-NOTE TO
 13043         DFHEIV20
 13044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13045
 13046
 13047     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 239
* EL6311.cbl
 13048     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13049     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 13050
 13051     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13052
 13053
 13054* EXEC CICS DELETE
 13055*        DATASET   (FILE-ID-ERNOTE)
 13056*        END-EXEC.
 13057*    MOVE '&(                    &   #00012148' TO DFHEIV0
 13058     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13059     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13060     MOVE X'2020233030303132313438' TO DFHEIV0(25:11)
 13061     CALL 'kxdfhei1' USING DFHEIV0,
 13062           FILE-ID-ERNOTE,
 13063           DFHEIV99,
 13064           DFHEIV99,
 13065           DFHEIV99,
 13066           DFHEIV99
 13067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13068
 13069
 13070     PERFORM 8400-LOG-JOURNAL-RECORD.
 13071
 13072******************************************************************
 13073*                                                                *
 13074*                DELETE MAILING ADDRESS RECORDS                  *
 13075*                                                                *
 13076******************************************************************
 13077
 13078 1407-DELETE-MAILING.
 13079     IF CERT-ADDRESS-PRESENT
 13080        NEXT SENTENCE
 13081     ELSE
 13082        GO TO 1420-CONTINUE-DELETE.
 13083
 13084
 13085* EXEC CICS HANDLE CONDITION
 13086*         NOTFND  (1420-CONTINUE-DELETE)
 13087*    END-EXEC.
 13088*    MOVE '"$I                   ! 0 #00012166' TO DFHEIV0
 13089     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13090     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13091     MOVE X'3020233030303132313636' TO DFHEIV0(25:11)
 13092     CALL 'kxdfhei1' USING DFHEIV0
 13093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13094
 13095
 13096
 13097* EXEC CICS READ
 13098*        EQUAL
 13099*        DATASET   (FILE-ID-ERMAIL)
 13100*        SET       (ADDRESS OF MAILING-DATA)
 13101*        RIDFLD    (ELCERT-KEY)
 13102*        UPDATE
 13103*    END-EXEC.
 13104*    MOVE '&"S        EU         (   #00012170' TO DFHEIV0
 13105     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 240
* EL6311.cbl
 13106     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13107     MOVE X'2020233030303132313730' TO DFHEIV0(25:11)
 13108     CALL 'kxdfhei1' USING DFHEIV0,
 13109           FILE-ID-ERMAIL,
 13110           DFHEIV20,
 13111           DFHEIV99,
 13112           ELCERT-KEY,
 13113           DFHEIV99,
 13114           DFHEIV99,
 13115           DFHEIV99
 13116     SET ADDRESS OF MAILING-DATA TO
 13117         DFHEIV20
 13118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13119
 13120
 13121     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13122     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13123     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13124
 13125     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13126
 13127
 13128* EXEC CICS DELETE
 13129*        DATASET   (FILE-ID-ERMAIL)
 13130*    END-EXEC.
 13131*    MOVE '&(                    &   #00012184' TO DFHEIV0
 13132     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13133     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13134     MOVE X'2020233030303132313834' TO DFHEIV0(25:11)
 13135     CALL 'kxdfhei1' USING DFHEIV0,
 13136           FILE-ID-ERMAIL,
 13137           DFHEIV99,
 13138           DFHEIV99,
 13139           DFHEIV99,
 13140           DFHEIV99
 13141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13142
 13143
 13144     GO TO 1420-CONTINUE-DELETE.
 13145
 13146 1410-REWRITE-CERT.
 13147     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13148     MOVE 'C'                      TO JP-RECORD-TYPE.
 13149     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13150     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13151
 13152
 13153* EXEC CICS REWRITE
 13154*         DATASET    (FILE-ID-ELCERT)
 13155*         FROM       (CERTIFICATE-MASTER)
 13156*         END-EXEC.
 13157     MOVE LENGTH OF
 13158      CERTIFICATE-MASTER
 13159       TO DFHEIV11
 13160*    MOVE '&& L                  %   #00012196' TO DFHEIV0
 13161     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13162     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13163     MOVE X'2020233030303132313936' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 241
* EL6311.cbl
 13164     CALL 'kxdfhei1' USING DFHEIV0,
 13165           FILE-ID-ELCERT,
 13166           CERTIFICATE-MASTER,
 13167           DFHEIV11,
 13168           DFHEIV99
 13169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13170
 13171
 13172     PERFORM 8400-LOG-JOURNAL-RECORD.
 13173
 13174 1420-CONTINUE-DELETE.
 13175     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 13176     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13177
 13178     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13179     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13180
 13181     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13182
 13183 1450-DELETE-PB-RECORD.
 13184     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13185     MOVE 'D'                      TO JP-RECORD-TYPE
 13186     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13187
 13188
 13189* EXEC CICS DELETE
 13190*        DATASET    (FILE-ID-ERPNDB)
 13191*    END-EXEC.
 13192*    MOVE '&(                    &   #00012217' TO DFHEIV0
 13193     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13194     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13195     MOVE X'2020233030303132323137' TO DFHEIV0(25:11)
 13196     CALL 'kxdfhei1' USING DFHEIV0,
 13197           FILE-ID-ERPNDB,
 13198           DFHEIV99,
 13199           DFHEIV99,
 13200           DFHEIV99,
 13201           DFHEIV99
 13202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13203
 13204
 13205     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13206
 13207     PERFORM 8400-LOG-JOURNAL-RECORD.
 13208
 13209     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13210     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13211     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13212
 13213
 13214* EXEC CICS HANDLE CONDITION
 13215*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13216*    END-EXEC.
 13217*    MOVE '"$I                   ! 1 #00012229' TO DFHEIV0
 13218     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13219     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13220     MOVE X'3120233030303132323239' TO DFHEIV0(25:11)
 13221     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 242
* EL6311.cbl
 13222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13223
 13224
 13225
 13226* EXEC CICS READ
 13227*        SET     (ADDRESS OF PENDING-BUSINESS)
 13228*        DATASET (FILE-ID-ERPNDB)
 13229*        RIDFLD  (ERPNDB-KEY)
 13230*        UPDATE
 13231*    END-EXEC.
 13232*    MOVE '&"S        EU         (   #00012233' TO DFHEIV0
 13233     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13234     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13235     MOVE X'2020233030303132323333' TO DFHEIV0(25:11)
 13236     CALL 'kxdfhei1' USING DFHEIV0,
 13237           FILE-ID-ERPNDB,
 13238           DFHEIV20,
 13239           DFHEIV99,
 13240           ERPNDB-KEY,
 13241           DFHEIV99,
 13242           DFHEIV99,
 13243           DFHEIV99
 13244     SET ADDRESS OF PENDING-BUSINESS TO
 13245         DFHEIV20
 13246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13247
 13248
 13249     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13250
 13251     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13252
 13253     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13254        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13255        MOVE 'D'                   TO JP-RECORD-TYPE
 13256        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13257
 13258* EXEC CICS DELETE
 13259*            DATASET    (FILE-ID-ERPNDB)
 13260*       END-EXEC
 13261*    MOVE '&(                    &   #00012248' TO DFHEIV0
 13262     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13263     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13264     MOVE X'2020233030303132323438' TO DFHEIV0(25:11)
 13265     CALL 'kxdfhei1' USING DFHEIV0,
 13266           FILE-ID-ERPNDB,
 13267           DFHEIV99,
 13268           DFHEIV99,
 13269           DFHEIV99,
 13270           DFHEIV99
 13271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13272        PERFORM 8400-LOG-JOURNAL-RECORD
 13273     ELSE
 13274        MOVE 'B'                 TO JP-RECORD-TYPE
 13275        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13276        PERFORM 8400-LOG-JOURNAL-RECORD
 13277        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13278        MOVE 'C'                 TO JP-RECORD-TYPE
 13279        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 243
* EL6311.cbl
 13280
 13281* EXEC CICS REWRITE
 13282*            DATASET    (FILE-ID-ERPNDB)
 13283*            FROM       (PENDING-BUSINESS)
 13284*       END-EXEC
 13285     MOVE LENGTH OF
 13286      PENDING-BUSINESS
 13287       TO DFHEIV11
 13288*    MOVE '&& L                  %   #00012259' TO DFHEIV0
 13289     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13290     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13291     MOVE X'2020233030303132323539' TO DFHEIV0(25:11)
 13292     CALL 'kxdfhei1' USING DFHEIV0,
 13293           FILE-ID-ERPNDB,
 13294           PENDING-BUSINESS,
 13295           DFHEIV11,
 13296           DFHEIV99
 13297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13298        PERFORM 8400-LOG-JOURNAL-RECORD.
 13299
 13300******************************************************************
 13301*                                                                *
 13302*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13303*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13304*                                                                *
 13305******************************************************************
 13306
 13307     IF NOT PI-AR-PROCESSING
 13308        GO TO 1475-DELETE-FINISHED.
 13309
 13310     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13311        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13312        NEXT SENTENCE
 13313     ELSE
 13314        GO TO 1475-DELETE-FINISHED.
 13315
 13316
 13317* EXEC CICS HANDLE CONDITION
 13318*         NOTFND    (1475-DELETE-FINISHED)
 13319*         END-EXEC.
 13320*    MOVE '"$I                   ! 2 #00012281' TO DFHEIV0
 13321     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13322     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13323     MOVE X'3220233030303132323831' TO DFHEIV0(25:11)
 13324     CALL 'kxdfhei1' USING DFHEIV0
 13325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13326
 13327
 13328     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13329     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13330
 13331
 13332* EXEC CICS READ
 13333*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13334*        DATASET (FILE-ID-ERRQST)
 13335*        RIDFLD  (ERRQST-KEY)
 13336*        UPDATE
 13337*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 244
* EL6311.cbl
 13338*    MOVE '&"S        EU         (   #00012288' TO DFHEIV0
 13339     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13340     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13341     MOVE X'2020233030303132323838' TO DFHEIV0(25:11)
 13342     CALL 'kxdfhei1' USING DFHEIV0,
 13343           FILE-ID-ERRQST,
 13344           DFHEIV20,
 13345           DFHEIV99,
 13346           ERRQST-KEY,
 13347           DFHEIV99,
 13348           DFHEIV99,
 13349           DFHEIV99
 13350     SET ADDRESS OF AR-REQUEST-RECORD TO
 13351         DFHEIV20
 13352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13353
 13354
 13355     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13356
 13357     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13358
 13359     MOVE 'D'                      TO JP-RECORD-TYPE.
 13360     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13361
 13362
 13363* EXEC CICS DELETE
 13364*         DATASET    (FILE-ID-ERRQST)
 13365*    END-EXEC.
 13366*    MOVE '&(                    &   #00012302' TO DFHEIV0
 13367     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13368     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13369     MOVE X'2020233030303132333032' TO DFHEIV0(25:11)
 13370     CALL 'kxdfhei1' USING DFHEIV0,
 13371           FILE-ID-ERRQST,
 13372           DFHEIV99,
 13373           DFHEIV99,
 13374           DFHEIV99,
 13375           DFHEIV99
 13376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13377
 13378
 13379     PERFORM 8400-LOG-JOURNAL-RECORD.
 13380
 13381 1475-DELETE-FINISHED.
 13382     MOVE ZEROS                  TO EMI-ERROR.
 13383     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13384     MOVE LOW-VALUES             TO EL631BI.
 13385     MOVE -1                     TO BMAINTL.
 13386     GO TO 8100-SEND-INITIAL-MAP.
 13387
 13388 1480-BATCH-HDR-NOT-FOUND.
 13389     MOVE -1                     TO BMAINTL.
 13390     MOVE ER-7450                TO EMI-ERROR.
 13391     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13392     GO TO 8200-SEND-DATAONLY.
 13393
 13394 1490-RECORD-NOT-FOUND.
 13395     MOVE -1                     TO BMAINTL.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 245
* EL6311.cbl
 13396     MOVE ER-7451                TO EMI-ERROR.
 13397     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13398     GO TO 8200-SEND-DATAONLY.
 13399
 13400******************************************************************
 13401*            O V E R   C H A R G E   P R O C E S S I N G         *
 13402******************************************************************
 13403 1500-UPDATE-ERNOTE.
 13404     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13405     MOVE 'A'                    TO WS-NOTE-SW
 13406     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13407     .
 13408 1500-EXIT.
 13409     EXIT.
 13410 1510-ADD-ERNOTE-REC.
 13411
 13412* EXEC CICS GETMAIN
 13413*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13414*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13415*        INITIMG (GETMAIN-SPACE)
 13416*    END-EXEC
 13417*    MOVE ',"IL                  $   #00012338' TO DFHEIV0
 13418     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13419     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13420     MOVE X'2020233030303132333338' TO DFHEIV0(25:11)
 13421     CALL 'kxdfhei1' USING DFHEIV0,
 13422           DFHEIV20,
 13423           ERNOTE-RECORD-LENGTH,
 13424           GETMAIN-SPACE
 13425     SET ADDRESS OF CERTIFICATE-NOTE TO
 13426         DFHEIV20
 13427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13428     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13429                                 TO ERNOTE-KEY
 13430
 13431* EXEC CICS READ
 13432*       DATASET    (FILE-ID-ERNOTE)
 13433*       RIDFLD     (ERNOTE-KEY)
 13434*       INTO       (CERTIFICATE-NOTE)
 13435*       RESP       (WS-RESPONSE)
 13436*       UPDATE
 13437*    END-EXEC
 13438     MOVE LENGTH OF
 13439      CERTIFICATE-NOTE
 13440       TO DFHEIV11
 13441*    MOVE '&"IL       EU         (  N#00012345' TO DFHEIV0
 13442     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13443     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13444     MOVE X'204E233030303132333435' TO DFHEIV0(25:11)
 13445     CALL 'kxdfhei1' USING DFHEIV0,
 13446           FILE-ID-ERNOTE,
 13447           CERTIFICATE-NOTE,
 13448           DFHEIV11,
 13449           ERNOTE-KEY,
 13450           DFHEIV99,
 13451           DFHEIV99,
 13452           DFHEIV99
 13453     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 246
* EL6311.cbl
 13454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13455     IF RESP-NORMAL
 13456        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13457           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13458        END-IF
 13459        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13460           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13461        END-IF
 13462        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13463           (N1 > +10)
 13464           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13465           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13466        END-PERFORM
 13467        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13468          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13469
 13470* EXEC CICS UNLOCK
 13471*            DATASET    (FILE-ID-ERNOTE)
 13472*          END-EXEC
 13473*    MOVE '&*                    #   #00012366' TO DFHEIV0
 13474     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13475     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13476     MOVE X'2020233030303132333636' TO DFHEIV0(25:11)
 13477     CALL 'kxdfhei1' USING DFHEIV0,
 13478           FILE-ID-ERNOTE,
 13479           DFHEIV99
 13480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13481        ELSE
 13482          PERFORM VARYING N1 FROM +1 BY +1
 13483           UNTIL (N1 > +10)
 13484           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13485          END-PERFORM
 13486          IF (N1 < +11)
 13487            IF N1 >= CN-BILLING-START-LINE-NO AND
 13488              N1 <= CN-BILLING-END-LINE-NO
 13489              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13490                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13491              ELSE
 13492                 MOVE WS-VA-NO-COMM-MESS
 13493                                    TO CN-LINE (N1)
 13494              END-IF
 13495            ELSE
 13496              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13497               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13498                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13499                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13500                ELSE
 13501                  MOVE WS-VA-NO-COMM-MESS
 13502                                    TO CN-LINE (N1)
 13503                END-IF
 13504                MOVE N1             TO CN-BILLING-END-LINE-NO
 13505              ELSE
 13506                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13507                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13508                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13509                  ELSE
 13510                     MOVE WS-VA-NO-COMM-MESS
 13511                                    TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 247
* EL6311.cbl
 13512                  END-IF
 13513                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13514                                      CN-BILLING-START-LINE-NO
 13515                ELSE
 13516                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13517                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13518                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13519                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13520                     ELSE
 13521                       MOVE WS-VA-NO-COMM-MESS
 13522                                    TO CN-LINE (N1)
 13523                     END-IF
 13524                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13525                  ELSE
 13526                     PERFORM 1700-SQUEEZE-IT-IN
 13527                                 THRU 1700-EXIT
 13528                  END-IF
 13529                END-IF
 13530              END-IF
 13531            END-IF
 13532            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13533            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13534            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13535
 13536* EXEC CICS REWRITE
 13537*              DATASET    (FILE-ID-ERNOTE)
 13538*              FROM       (CERTIFICATE-NOTE)
 13539*              RESP       (WS-RESPONSE)
 13540*           END-EXEC
 13541     MOVE LENGTH OF
 13542      CERTIFICATE-NOTE
 13543       TO DFHEIV11
 13544*    MOVE '&& L                  %  N#00012423' TO DFHEIV0
 13545     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13546     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13547     MOVE X'204E233030303132343233' TO DFHEIV0(25:11)
 13548     CALL 'kxdfhei1' USING DFHEIV0,
 13549           FILE-ID-ERNOTE,
 13550           CERTIFICATE-NOTE,
 13551           DFHEIV11,
 13552           DFHEIV99
 13553     MOVE EIBRESP  TO WS-RESPONSE
 13554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13555          END-IF
 13556        END-IF
 13557     ELSE
 13558        MOVE SPACES              TO CERTIFICATE-NOTE
 13559        MOVE 'CN'                TO CN-RECORD-ID
 13560        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13561                                 TO CN-CONTROL-PRIMARY
 13562                                    ERNOTE-KEY
 13563        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13564                                    CN-BILLING-END-LINE-NO
 13565        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13566           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13567        ELSE
 13568           MOVE WS-VA-NO-COMM-MESS
 13569                                 TO CN-LINE (1)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 248
* EL6311.cbl
 13570        END-IF
 13571        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13572        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13573        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13574
 13575* EXEC CICS WRITE
 13576*          DATASET    (FILE-ID-ERNOTE)
 13577*          FROM       (CERTIFICATE-NOTE)
 13578*          RIDFLD     (ERNOTE-KEY)
 13579*          RESP       (WS-RESPONSE)
 13580*       END-EXEC
 13581     MOVE LENGTH OF
 13582      CERTIFICATE-NOTE
 13583       TO DFHEIV11
 13584*    MOVE '&$ L                  ''  N#00012447' TO DFHEIV0
 13585     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13586     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13587     MOVE X'204E233030303132343437' TO DFHEIV0(25:11)
 13588     CALL 'kxdfhei1' USING DFHEIV0,
 13589           FILE-ID-ERNOTE,
 13590           CERTIFICATE-NOTE,
 13591           DFHEIV11,
 13592           ERNOTE-KEY,
 13593           DFHEIV99,
 13594           DFHEIV99
 13595     MOVE EIBRESP  TO WS-RESPONSE
 13596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13597     END-IF
 13598     .
 13599 1510-EXIT.
 13600     EXIT.
 13601 1520-UPDATE-ELCERT.
 13602     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13603                                 TO ELCERT-KEY
 13604
 13605* EXEC CICS READ
 13606*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13607*        DATASET (FILE-ID-ELCERT)
 13608*        RIDFLD  (ELCERT-KEY)
 13609*        UPDATE
 13610*        RESP    (WS-RESPONSE)
 13611*    END-EXEC
 13612*    MOVE '&"S        EU         (  N#00012460' TO DFHEIV0
 13613     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13614     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13615     MOVE X'204E233030303132343630' TO DFHEIV0(25:11)
 13616     CALL 'kxdfhei1' USING DFHEIV0,
 13617           FILE-ID-ELCERT,
 13618           DFHEIV20,
 13619           DFHEIV99,
 13620           ELCERT-KEY,
 13621           DFHEIV99,
 13622           DFHEIV99,
 13623           DFHEIV99
 13624     SET ADDRESS OF CERTIFICATE-MASTER TO
 13625         DFHEIV20
 13626     MOVE EIBRESP  TO WS-RESPONSE
 13627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 249
* EL6311.cbl
 13628     IF RESP-NORMAL
 13629        IF WS-NOTE-SW = 'A'
 13630           IF CM-NOTE-SW = ' '
 13631              MOVE '2'             TO CM-NOTE-SW
 13632           ELSE
 13633             IF CM-NOTE-SW = '1'
 13634                MOVE '3'           TO CM-NOTE-SW
 13635             ELSE
 13636               IF CM-NOTE-SW = '4'
 13637                  MOVE '6'         TO CM-NOTE-SW
 13638               ELSE
 13639                 IF CM-NOTE-SW = '5'
 13640                    MOVE '7'       TO CM-NOTE-SW
 13641                 END-IF
 13642               END-IF
 13643             END-IF
 13644           END-IF
 13645        ELSE
 13646           IF CM-NOTE-SW = '2'
 13647              MOVE ' '             TO CM-NOTE-SW
 13648           ELSE
 13649             IF CM-NOTE-SW = '3'
 13650                MOVE '1'           TO CM-NOTE-SW
 13651             ELSE
 13652               IF CM-NOTE-SW = '6'
 13653                  MOVE '4'         TO CM-NOTE-SW
 13654               ELSE
 13655                 IF CM-NOTE-SW = '7'
 13656                    MOVE '5'       TO CM-NOTE-SW
 13657                 END-IF
 13658               END-IF
 13659             END-IF
 13660           END-IF
 13661        END-IF
 13662
 13663* EXEC CICS REWRITE
 13664*          DATASET    (FILE-ID-ELCERT)
 13665*          FROM       (CERTIFICATE-MASTER)
 13666*          RESP       (WS-RESPONSE)
 13667*       END-EXEC
 13668     MOVE LENGTH OF
 13669      CERTIFICATE-MASTER
 13670       TO DFHEIV11
 13671*    MOVE '&& L                  %  N#00012501' TO DFHEIV0
 13672     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13673     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13674     MOVE X'204E233030303132353031' TO DFHEIV0(25:11)
 13675     CALL 'kxdfhei1' USING DFHEIV0,
 13676           FILE-ID-ELCERT,
 13677           CERTIFICATE-MASTER,
 13678           DFHEIV11,
 13679           DFHEIV99
 13680     MOVE EIBRESP  TO WS-RESPONSE
 13681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13682        IF RESP-NORMAL
 13683           CONTINUE
 13684        ELSE
 13685           MOVE WS-RESPONSE TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 250
* EL6311.cbl
 13686           PERFORM 9900-ERROR-FORMAT
 13687                                 THRU 9900-EXIT
 13688           GO TO 8200-SEND-DATAONLY
 13689        END-IF
 13690     ELSE
 13691        MOVE -1                  TO BMAINTL
 13692        MOVE 0249                TO EMI-ERROR
 13693        PERFORM 9900-ERROR-FORMAT
 13694                                 THRU 9900-EXIT
 13695        GO TO 8200-SEND-DATAONLY
 13696     END-IF
 13697     .
 13698 1520-EXIT.
 13699     EXIT.
 13700 1600-UPDATE-ERPYAJ.
 13701     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13702                                 THRU 1610-EXIT
 13703     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13704                                 THRU 1620-EXIT
 13705     .
 13706 1600-EXIT.
 13707     EXIT.
 13708 1610-ADD-ERPYAJ-BANK-REC.
 13709
 13710* EXEC CICS GETMAIN
 13711*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13712*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13713*        INITIMG (GETMAIN-SPACE)
 13714*    END-EXEC
 13715*    MOVE ',"IL                  $   #00012533' TO DFHEIV0
 13716     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13717     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13718     MOVE X'2020233030303132353333' TO DFHEIV0(25:11)
 13719     CALL 'kxdfhei1' USING DFHEIV0,
 13720           DFHEIV20,
 13721           ERPYAJ-RECORD-LENGTH,
 13722           GETMAIN-SPACE
 13723     SET ADDRESS OF PENDING-PAY-ADJ TO
 13724         DFHEIV20
 13725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13726     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13727     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13728     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13729     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13730     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13731     MOVE +10                    TO ERPYAJ-SEQ-NO
 13732     MOVE 'R'                    TO ERPYAJ-TYPE
 13733     IF REVERSAL
 13734        MOVE 'C'                 TO ERPYAJ-TYPE
 13735     END-IF
 13736     MOVE SPACES                 TO PENDING-PAY-ADJ
 13737     MOVE 'PY'                   TO PY-RECORD-ID
 13738     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13739     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13740     IF REVERSAL
 13741        MOVE PB-I-DCC-OVER-CHG-AMT
 13742                                 TO PY-ENTRY-AMT
 13743     END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 251
* EL6311.cbl
 13744     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13745                                    PY-INPUT-DT
 13746*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13747*                                   PY-INPUT-DT
 13748     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13749     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13750     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13751     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13752     IF PB-CARRIER = '2'
 13753        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13754     ELSE
 13755        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13756     END-IF
 13757     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13758                                    PY-BILLED-DATE
 13759                                    PY-AR-DATE
 13760                                    PY-REPORTED-DT
 13761                                    PY-CHECK-WRITTEN-DT
 13762     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13763                                    PY-CHECK-QUE-SEQUENCE
 13764     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13765     PERFORM WITH TEST AFTER
 13766        UNTIL (NOT RESP-DUPKEY)
 13767           AND (NOT RESP-DUPREC)
 13768
 13769* EXEC CICS WRITE
 13770*          DATASET    (FILE-ID-ERPYAJ)
 13771*          FROM       (PENDING-PAY-ADJ)
 13772*          RIDFLD     (ERPYAJ-KEY)
 13773*          RESP       (WS-RESPONSE)
 13774*       END-EXEC
 13775     MOVE LENGTH OF
 13776      PENDING-PAY-ADJ
 13777       TO DFHEIV11
 13778*    MOVE '&$ L                  ''  N#00012580' TO DFHEIV0
 13779     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13780     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13781     MOVE X'204E233030303132353830' TO DFHEIV0(25:11)
 13782     CALL 'kxdfhei1' USING DFHEIV0,
 13783           FILE-ID-ERPYAJ,
 13784           PENDING-PAY-ADJ,
 13785           DFHEIV11,
 13786           ERPYAJ-KEY,
 13787           DFHEIV99,
 13788           DFHEIV99
 13789     MOVE EIBRESP  TO WS-RESPONSE
 13790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13791        IF RESP-DUPKEY OR RESP-DUPREC
 13792           ADD +1                TO ERPYAJ-SEQ-NO
 13793           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13794        END-IF
 13795     END-PERFORM
 13796     .
 13797 1610-EXIT.
 13798     EXIT.
 13799 1620-ADD-ERPYAJ-DLR-REC.
 13800     MOVE 'C'                    TO ERPYAJ-TYPE
 13801     IF REVERSAL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 252
* EL6311.cbl
 13802        MOVE 'R'                 TO ERPYAJ-TYPE
 13803     END-IF
 13804     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13805                                    ERPYAJ-ACCOUNT
 13806     ADD +1                      TO ERPYAJ-SEQ-NO
 13807     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13808     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13809     IF PB-CARRIER = '2'
 13810        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13811     ELSE
 13812        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13813     END-IF
 13814     PERFORM WITH TEST AFTER
 13815        UNTIL (NOT RESP-DUPKEY)
 13816           AND (NOT RESP-DUPREC)
 13817
 13818* EXEC CICS WRITE
 13819*          DATASET    (FILE-ID-ERPYAJ)
 13820*          FROM       (PENDING-PAY-ADJ)
 13821*          RIDFLD     (ERPYAJ-KEY)
 13822*          RESP       (WS-RESPONSE)
 13823*       END-EXEC
 13824     MOVE LENGTH OF
 13825      PENDING-PAY-ADJ
 13826       TO DFHEIV11
 13827*    MOVE '&$ L                  ''  N#00012612' TO DFHEIV0
 13828     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13829     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13830     MOVE X'204E233030303132363132' TO DFHEIV0(25:11)
 13831     CALL 'kxdfhei1' USING DFHEIV0,
 13832           FILE-ID-ERPYAJ,
 13833           PENDING-PAY-ADJ,
 13834           DFHEIV11,
 13835           ERPYAJ-KEY,
 13836           DFHEIV99,
 13837           DFHEIV99
 13838     MOVE EIBRESP  TO WS-RESPONSE
 13839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13840        IF RESP-DUPKEY OR RESP-DUPREC
 13841           ADD +1                TO ERPYAJ-SEQ-NO
 13842           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13843        END-IF
 13844     END-PERFORM
 13845     .
 13846 1620-EXIT.
 13847     EXIT.
 13848 1700-SQUEEZE-IT-IN.
 13849     IF (N1 > CN-BILLING-END-LINE-NO)
 13850        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13851           N1 = +1
 13852           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13853           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13854              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13855                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13856              ELSE
 13857                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13858              END-IF
 13859              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 253
* EL6311.cbl
 13860              MOVE +2 TO N1
 13861           END-IF
 13862        END-PERFORM
 13863     ELSE
 13864        IF (N1 < CN-BILLING-START-LINE-NO)
 13865           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13866              N1 = +10
 13867              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13868              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13869                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13870                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13871                 ELSE
 13872                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13873                 END-IF
 13874                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13875                 MOVE +9 TO N1
 13876              END-IF
 13877           END-PERFORM
 13878        END-IF
 13879     END-IF
 13880     .
 13881 1700-EXIT.
 13882     EXIT.
 13883 1800-REMOVE-CERT-NOTES.
 13884     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13885                                 TO ERNOTE-KEY
 13886
 13887* EXEC CICS READ
 13888*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13889*       DATASET    (FILE-ID-ERNOTE)
 13890*       RIDFLD     (ERNOTE-KEY)
 13891*       RESP       (WS-RESPONSE)
 13892*       UPDATE
 13893*    END-EXEC
 13894*    MOVE '&"S        EU         (  N#00012664' TO DFHEIV0
 13895     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13896     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13897     MOVE X'204E233030303132363634' TO DFHEIV0(25:11)
 13898     CALL 'kxdfhei1' USING DFHEIV0,
 13899           FILE-ID-ERNOTE,
 13900           DFHEIV20,
 13901           DFHEIV99,
 13902           ERNOTE-KEY,
 13903           DFHEIV99,
 13904           DFHEIV99,
 13905           DFHEIV99
 13906     SET ADDRESS OF CERTIFICATE-NOTE TO
 13907         DFHEIV20
 13908     MOVE EIBRESP  TO WS-RESPONSE
 13909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13910     IF RESP-NORMAL
 13911        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13912           (N1 > +10)
 13913           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13914           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13915        END-PERFORM
 13916        IF N1 < +11
 13917           MOVE SPACES              TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 254
* EL6311.cbl
 13918           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13919              N1 <= CN-BILLING-END-LINE-NO
 13920              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13921              IF CN-BILLING-END-LINE-NO <
 13922                               CN-BILLING-START-LINE-NO
 13923                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13924                                     CN-BILLING-START-LINE-NO
 13925              END-IF
 13926              PERFORM 1820-SQUEEZE-ERNOTE
 13927                                  THRU 1820-EXIT
 13928           END-IF
 13929           IF CN-LINES = SPACES
 13930
 13931* EXEC CICS DELETE
 13932*                DATASET    (FILE-ID-ERNOTE)
 13933*                RESP       (WS-RESPONSE)
 13934*             END-EXEC
 13935*    MOVE '&(                    &  N#00012691' TO DFHEIV0
 13936     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13937     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13938     MOVE X'204E233030303132363931' TO DFHEIV0(25:11)
 13939     CALL 'kxdfhei1' USING DFHEIV0,
 13940           FILE-ID-ERNOTE,
 13941           DFHEIV99,
 13942           DFHEIV99,
 13943           DFHEIV99,
 13944           DFHEIV99
 13945     MOVE EIBRESP  TO WS-RESPONSE
 13946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13947              IF RESP-NORMAL
 13948                 MOVE 'D'        TO WS-NOTE-SW
 13949                 PERFORM 1520-UPDATE-ELCERT
 13950                                 THRU 1520-EXIT
 13951              END-IF
 13952           ELSE
 13953
 13954* EXEC CICS REWRITE
 13955*                DATASET    (FILE-ID-ERNOTE)
 13956*                FROM       (CERTIFICATE-NOTE)
 13957*                RESP       (WS-RESPONSE)
 13958*             END-EXEC
 13959     MOVE LENGTH OF
 13960      CERTIFICATE-NOTE
 13961       TO DFHEIV11
 13962*    MOVE '&& L                  %  N#00012701' TO DFHEIV0
 13963     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13964     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13965     MOVE X'204E233030303132373031' TO DFHEIV0(25:11)
 13966     CALL 'kxdfhei1' USING DFHEIV0,
 13967           FILE-ID-ERNOTE,
 13968           CERTIFICATE-NOTE,
 13969           DFHEIV11,
 13970           DFHEIV99
 13971     MOVE EIBRESP  TO WS-RESPONSE
 13972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13973           END-IF
 13974        END-IF
 13975     END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 255
* EL6311.cbl
 13976     .
 13977 1800-EXIT.
 13978     EXIT.
 13979 1820-SQUEEZE-ERNOTE.
 13980     MOVE CN-BILLING-START-LINE-NO TO N2
 13981     IF N2 = 0
 13982         MOVE +1                 TO N2
 13983     END-IF
 13984     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13985        (N1 > +9)
 13986        IF CN-LINE (N1) = SPACES
 13987           MOVE CN-LINE (N1 + +1)
 13988                                 TO CN-LINE (N1)
 13989           MOVE SPACES           TO CN-LINE (N1 + +1)
 13990        END-IF
 13991     END-PERFORM
 13992     .
 13993 1820-EXIT.
 13994     EXIT.
 13995 1900-DELETE-ERPYAJ.
 13996     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13997     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13998     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13999     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 14000     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 14001     MOVE +10                    TO ERPYAJ-SEQ-NO
 14002     MOVE 'R'                    TO ERPYAJ-TYPE
 14003     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14004
 14005* EXEC CICS STARTBR
 14006*       DATASET    (FILE-ID-ERPYAJ)
 14007*       RIDFLD     (ERPYAJ-KEY)
 14008*       RESP       (WS-RESPONSE)
 14009*    END-EXEC
 14010     MOVE 0
 14011       TO DFHEIV11
 14012*    MOVE '&,         G          &  N#00012737' TO DFHEIV0
 14013     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14014     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14015     MOVE X'204E233030303132373337' TO DFHEIV0(25:11)
 14016     CALL 'kxdfhei1' USING DFHEIV0,
 14017           FILE-ID-ERPYAJ,
 14018           ERPYAJ-KEY,
 14019           DFHEIV99,
 14020           DFHEIV11,
 14021           DFHEIV99
 14022     MOVE EIBRESP  TO WS-RESPONSE
 14023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14024     IF RESP-NORMAL
 14025        CONTINUE
 14026     ELSE
 14027        GO TO 1900-GET-DEALER
 14028     END-IF
 14029     .
 14030 1900-READNEXT-ERPYAJ-B.
 14031*  GET THE BANK ERPYAJ RECORD
 14032
 14033* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 256
* EL6311.cbl
 14034*       DATASET    (FILE-ID-ERPYAJ)
 14035*       RIDFLD     (ERPYAJ-KEY)
 14036*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14037*       RESP       (WS-RESPONSE)
 14038*    END-EXEC
 14039     MOVE 0
 14040       TO DFHEIV11
 14041*    MOVE '&.S                   )  N#00012750' TO DFHEIV0
 14042     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14043     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14044     MOVE X'204E233030303132373530' TO DFHEIV0(25:11)
 14045     CALL 'kxdfhei1' USING DFHEIV0,
 14046           FILE-ID-ERPYAJ,
 14047           DFHEIV20,
 14048           DFHEIV99,
 14049           ERPYAJ-KEY,
 14050           DFHEIV99,
 14051           DFHEIV11,
 14052           DFHEIV99,
 14053           DFHEIV99
 14054     SET ADDRESS OF PENDING-PAY-ADJ TO
 14055         DFHEIV20
 14056     MOVE EIBRESP  TO WS-RESPONSE
 14057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14058     IF RESP-NORMAL
 14059        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14060           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14061              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14062                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14063
 14064* EXEC CICS READ
 14065*                   DATASET    (FILE-ID-ERPYAJ)
 14066*                   RIDFLD     (ERPYAJ-KEY)
 14067*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14068*                   RESP       (WS-RESPONSE)
 14069*                   UPDATE
 14070*                END-EXEC
 14071*    MOVE '&"S        EU         (  N#00012761' TO DFHEIV0
 14072     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14073     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14074     MOVE X'204E233030303132373631' TO DFHEIV0(25:11)
 14075     CALL 'kxdfhei1' USING DFHEIV0,
 14076           FILE-ID-ERPYAJ,
 14077           DFHEIV20,
 14078           DFHEIV99,
 14079           ERPYAJ-KEY,
 14080           DFHEIV99,
 14081           DFHEIV99,
 14082           DFHEIV99
 14083     SET ADDRESS OF PENDING-PAY-ADJ TO
 14084         DFHEIV20
 14085     MOVE EIBRESP  TO WS-RESPONSE
 14086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14087                 IF RESP-NORMAL
 14088
 14089* EXEC CICS DELETE
 14090*                      DATASET   (FILE-ID-ERPYAJ)
 14091*                      RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 257
* EL6311.cbl
 14092*                   END-EXEC
 14093*    MOVE '&(                    &  N#00012769' TO DFHEIV0
 14094     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14095     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14096     MOVE X'204E233030303132373639' TO DFHEIV0(25:11)
 14097     CALL 'kxdfhei1' USING DFHEIV0,
 14098           FILE-ID-ERPYAJ,
 14099           DFHEIV99,
 14100           DFHEIV99,
 14101           DFHEIV99,
 14102           DFHEIV99
 14103     MOVE EIBRESP  TO WS-RESPONSE
 14104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14105                 END-IF
 14106              ELSE
 14107                 SET REVERSAL    TO TRUE
 14108                 PERFORM 1600-UPDATE-ERPYAJ
 14109                                 THRU 1600-EXIT
 14110                 GO TO 1900-EXIT
 14111              END-IF
 14112           ELSE
 14113              GO TO 1900-READNEXT-ERPYAJ-B
 14114           END-IF
 14115        END-IF
 14116
 14117* EXEC CICS ENDBR
 14118*          DATASET   (FILE-ID-ERPYAJ)
 14119*       END-EXEC
 14120     MOVE 0
 14121       TO DFHEIV11
 14122*    MOVE '&2                    $   #00012784' TO DFHEIV0
 14123     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14124     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14125     MOVE X'2020233030303132373834' TO DFHEIV0(25:11)
 14126     CALL 'kxdfhei1' USING DFHEIV0,
 14127           FILE-ID-ERPYAJ,
 14128           DFHEIV11,
 14129           DFHEIV99
 14130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14131     END-IF
 14132     .
 14133 1900-GET-DEALER.
 14134     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14135     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14136     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14137     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14138     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 14139     MOVE +10                    TO ERPYAJ-SEQ-NO
 14140     MOVE 'C'                    TO ERPYAJ-TYPE
 14141     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14142
 14143* EXEC CICS STARTBR
 14144*       DATASET    (FILE-ID-ERPYAJ)
 14145*       RIDFLD     (ERPYAJ-KEY)
 14146*       RESP       (WS-RESPONSE)
 14147*    END-EXEC
 14148     MOVE 0
 14149       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 258
* EL6311.cbl
 14150*    MOVE '&,         G          &  N#00012798' TO DFHEIV0
 14151     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14152     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14153     MOVE X'204E233030303132373938' TO DFHEIV0(25:11)
 14154     CALL 'kxdfhei1' USING DFHEIV0,
 14155           FILE-ID-ERPYAJ,
 14156           ERPYAJ-KEY,
 14157           DFHEIV99,
 14158           DFHEIV11,
 14159           DFHEIV99
 14160     MOVE EIBRESP  TO WS-RESPONSE
 14161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14162     IF RESP-NORMAL
 14163        CONTINUE
 14164     ELSE
 14165        GO TO 1900-EXIT
 14166     END-IF
 14167     .
 14168 1900-READNEXT-ERPYAJ-D.
 14169*  GET THE DEALER ERPYAJ RECORD
 14170
 14171* EXEC CICS READNEXT
 14172*       DATASET    (FILE-ID-ERPYAJ)
 14173*       RIDFLD     (ERPYAJ-KEY)
 14174*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14175*       RESP       (WS-RESPONSE)
 14176*    END-EXEC
 14177     MOVE 0
 14178       TO DFHEIV11
 14179*    MOVE '&.S                   )  N#00012811' TO DFHEIV0
 14180     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14181     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14182     MOVE X'204E233030303132383131' TO DFHEIV0(25:11)
 14183     CALL 'kxdfhei1' USING DFHEIV0,
 14184           FILE-ID-ERPYAJ,
 14185           DFHEIV20,
 14186           DFHEIV99,
 14187           ERPYAJ-KEY,
 14188           DFHEIV99,
 14189           DFHEIV11,
 14190           DFHEIV99,
 14191           DFHEIV99
 14192     SET ADDRESS OF PENDING-PAY-ADJ TO
 14193         DFHEIV20
 14194     MOVE EIBRESP  TO WS-RESPONSE
 14195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14196     IF RESP-NORMAL
 14197        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14198           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14199              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14200                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14201
 14202* EXEC CICS READ
 14203*                   DATASET    (FILE-ID-ERPYAJ)
 14204*                   RIDFLD     (ERPYAJ-KEY)
 14205*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14206*                   RESP       (WS-RESPONSE)
 14207*                   UPDATE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 259
* EL6311.cbl
 14208*                END-EXEC
 14209*    MOVE '&"S        EU         (  N#00012822' TO DFHEIV0
 14210     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14211     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14212     MOVE X'204E233030303132383232' TO DFHEIV0(25:11)
 14213     CALL 'kxdfhei1' USING DFHEIV0,
 14214           FILE-ID-ERPYAJ,
 14215           DFHEIV20,
 14216           DFHEIV99,
 14217           ERPYAJ-KEY,
 14218           DFHEIV99,
 14219           DFHEIV99,
 14220           DFHEIV99
 14221     SET ADDRESS OF PENDING-PAY-ADJ TO
 14222         DFHEIV20
 14223     MOVE EIBRESP  TO WS-RESPONSE
 14224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14225                 IF RESP-NORMAL
 14226
 14227* EXEC CICS DELETE
 14228*                      DATASET   (FILE-ID-ERPYAJ)
 14229*                      RESP      (WS-RESPONSE)
 14230*                   END-EXEC
 14231*    MOVE '&(                    &  N#00012830' TO DFHEIV0
 14232     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14233     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14234     MOVE X'204E233030303132383330' TO DFHEIV0(25:11)
 14235     CALL 'kxdfhei1' USING DFHEIV0,
 14236           FILE-ID-ERPYAJ,
 14237           DFHEIV99,
 14238           DFHEIV99,
 14239           DFHEIV99,
 14240           DFHEIV99
 14241     MOVE EIBRESP  TO WS-RESPONSE
 14242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14243                 END-IF
 14244              ELSE
 14245                 SET REVERSAL    TO TRUE
 14246              END-IF
 14247           ELSE
 14248              GO TO 1900-READNEXT-ERPYAJ-D
 14249           END-IF
 14250        END-IF
 14251
 14252* EXEC CICS ENDBR
 14253*          DATASET   (FILE-ID-ERPYAJ)
 14254*       END-EXEC
 14255     MOVE 0
 14256       TO DFHEIV11
 14257*    MOVE '&2                    $   #00012842' TO DFHEIV0
 14258     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14259     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14260     MOVE X'2020233030303132383432' TO DFHEIV0(25:11)
 14261     CALL 'kxdfhei1' USING DFHEIV0,
 14262           FILE-ID-ERPYAJ,
 14263           DFHEIV11,
 14264           DFHEIV99
 14265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 260
* EL6311.cbl
 14266     END-IF
 14267     .
 14268 1900-EXIT.
 14269     EXIT.
 14270******************************************************************
 14271*            C A N C E L   M A I N L I N E                       *
 14272******************************************************************
 14273
 14274 2000-CANCEL-MAINLINE.
 14275     IF PI-DISPLAY-ORIGINAL-BATCH
 14276        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14277           MOVE ER-0023             TO EMI-ERROR
 14278           MOVE -1                  TO CMAINTL
 14279           MOVE AL-UABON            TO CMAINTA
 14280           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14281           GO TO 8200-SEND-DATAONLY
 14282        ELSE
 14283           NEXT SENTENCE
 14284     ELSE
 14285        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14286           MOVE ER-0023             TO EMI-ERROR
 14287           MOVE -1                  TO CMAINTL
 14288           MOVE AL-UABON            TO CMAINTA
 14289           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14290           GO TO 8200-SEND-DATAONLY.
 14291
 14292     IF CMAINTI = 'S'
 14293        GO TO 2100-SHOW-REQUEST.
 14294
 14295     IF NOT MODIFY-CAP
 14296         MOVE 'UPDATE'       TO SM-READ
 14297         PERFORM 9995-SECURITY-VIOLATION
 14298         MOVE ER-0070        TO EMI-ERROR
 14299         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14300         GO TO 8100-SEND-INITIAL-MAP.
 14301
 14302     IF CMAINTL GREATER THAN ZEROS
 14303        IF PI-PF6-FUNCTION
 14304           IF CMAINTI NOT = 'A'
 14305              MOVE AL-UABON  TO CMAINTA
 14306              MOVE -1        TO CMAINTL
 14307              MOVE ER-2260   TO EMI-ERROR
 14308              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14309              GO TO 8200-SEND-DATAONLY.
 14310
 14311     IF CCERTNOL = ZEROS
 14312       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14313         NEXT SENTENCE
 14314     ELSE
 14315         IF CCERTNOL NOT = ZEROS
 14316             MOVE AL-UANON       TO CCERTNOA
 14317         ELSE
 14318             MOVE -1             TO CCERTNOL
 14319             MOVE  1             TO SET-CURSOR-SW
 14320             MOVE ER-2218       TO EMI-ERROR
 14321             MOVE AL-UABON       TO CCERTNOA
 14322             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14323
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 261
* EL6311.cbl
 14324     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14325        NEXT SENTENCE
 14326     ELSE
 14327        IF CEFFDTL NOT = ZEROS
 14328           MOVE AL-UNNON         TO CEFFDTA
 14329           MOVE CEFFDTI TO DEEDIT-FIELD
 14330           PERFORM 8600-DEEDIT
 14331           MOVE 4                TO DC-OPTION-CODE
 14332           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14333           PERFORM 9700-DATE-LINK
 14334           IF NO-CONVERSION-ERROR
 14335              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14336              ELSE
 14337              MOVE -1            TO CEFFDTL
 14338              MOVE  1            TO SET-CURSOR-SW
 14339              MOVE ER-2226      TO EMI-ERROR
 14340              MOVE AL-UNBON      TO CEFFDTA
 14341              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14342          ELSE
 14343          MOVE -1                 TO CEFFDTL
 14344          MOVE  1                 TO SET-CURSOR-SW
 14345          MOVE ER-2220            TO EMI-ERROR
 14346          MOVE AL-UNBON           TO CEFFDTA
 14347          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14348
 14349     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14350
 14351     IF CCERTNOL NOT = ZEROS
 14352        MOVE CCERTNOI                TO WS-NEW-PRIME
 14353     ELSE
 14354        MOVE SPACES                  TO WS-NEW-PRIME.
 14355
 14356     IF CSUFIXL NOT = ZEROS
 14357        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14358     ELSE
 14359        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14360
 14361     IF CEFFDTL NOT = ZEROS
 14362        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14363     ELSE
 14364        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14365
 14366     IF CMAINTI = 'A' OR 'K' OR 'S'
 14367        NEXT SENTENCE
 14368     ELSE
 14369        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14370        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14371           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14372           WS-PB-RECORD-TYPE NOT = '2'
 14373           IF CMAINTI = 'C'
 14374              MOVE ER-2287          TO EMI-ERROR
 14375              MOVE -1               TO CCERTNOL
 14376              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14377              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14378              GO TO 8200-SEND-DATAONLY
 14379             ELSE
 14380              MOVE ER-2260          TO EMI-ERROR
 14381              MOVE -1               TO CCERTNOL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 262
* EL6311.cbl
 14382              MOVE AL-UABON         TO CCERTNOA
 14383              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14384              GO TO 8200-SEND-DATAONLY.
 14385
 14386     IF CMAINTI = 'D'
 14387        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14388
 14389     IF CLSTNML GREATER THAN ZEROS
 14390         MOVE AL-UANON           TO CLSTNMA.
 14391
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 263
* EL6311.cbl
 14393
 14394******************************************************************
 14395*                                                                *
 14396*           E D I T   C A N C E L   C O V E R A G E S            *
 14397*                                                                *
 14398******************************************************************
 14399
 14400 2015-EDIT-COVERAGES.
 14401     IF CCANDT1L      GREATER THAN ZEROS OR
 14402        CREFND1L      GREATER THAN ZEROS OR
 14403        CCANDT2L      GREATER THAN ZEROS OR
 14404        CREFND2L      GREATER THAN ZEROS OR
 14405        CMTHD1L       GREATER THAN ZEROS OR
 14406        CMTHD2L       GREATER THAN ZEROS OR
 14407        CLIVESL       GREATER THAN ZEROS OR
 14408        CPAYEEL       GREATER THAN ZEROS OR
 14409        CFORCEL       GREATER THAN ZEROS OR
 14410        CBILCDL       GREATER THAN ZEROS OR
 14411        CCANREAL      GREATER THAN ZEROS
 14412            NEXT SENTENCE
 14413         ELSE
 14414            GO TO 2030-EDIT-COMPLETE.
 14415
 14416     IF CCANDT1L = ZEROS
 14417        AND (CMAINTI = 'C' OR 'K')
 14418        NEXT SENTENCE
 14419     ELSE
 14420        IF CCANDT1L      GREATER THAN ZEROS
 14421            MOVE AL-UNNON            TO CCANDT1A
 14422            IF CCANDT1I = SPACES
 14423               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14424            ELSE
 14425               MOVE CCANDT1I            TO DEEDIT-FIELD
 14426               PERFORM 8600-DEEDIT
 14427               IF DEEDIT-FIELD-V0   NUMERIC
 14428                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14429                  MOVE 4                TO DC-OPTION-CODE
 14430                  PERFORM 9700-DATE-LINK
 14431                  IF NO-CONVERSION-ERROR
 14432                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14433                  ELSE
 14434                      MOVE -1        TO CCANDT1L
 14435                      MOVE ER-2227   TO EMI-ERROR
 14436                      MOVE AL-UNBON  TO CCANDT1A
 14437                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14438               ELSE
 14439                  MOVE -1         TO CCANDT1L
 14440                  MOVE ER-2223    TO EMI-ERROR
 14441                  MOVE AL-UNBON   TO CCANDT1A
 14442                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14443        ELSE
 14444            IF CREFND1L GREATER THAN ZEROS
 14445               MOVE -1             TO CCANDT1L
 14446               MOVE ER-2222        TO EMI-ERROR
 14447               MOVE AL-UNBOF       TO CCANDT1A
 14448               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14449
 14450     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 264
* EL6311.cbl
 14451        AND (CMAINTI = 'C' OR 'K')
 14452         NEXT SENTENCE
 14453     ELSE
 14454         IF CREFND1L NOT = ZEROS
 14455            MOVE AL-UNNON        TO CREFND1A
 14456
 14457* EXEC CICS BIF DEEDIT
 14458*               FIELD  (CREFND1I)
 14459*               LENGTH (11)
 14460*           END-EXEC
 14461     MOVE 11
 14462       TO DFHEIV11
 14463*    MOVE '@"L                   #   #00013035' TO DFHEIV0
 14464     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14465     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14466     MOVE X'2020233030303133303335' TO DFHEIV0(25:11)
 14467     CALL 'kxdfhei1' USING DFHEIV0,
 14468           CREFND1I,
 14469           DFHEIV11
 14470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14471            MOVE CREFND1I        TO WS-CREFND1
 14472*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14473*           PERFORM 8600-DEEDIT
 14474*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14475            IF WS-CREFND1  = ZEROS
 14476               AND CMAINTI = 'A'
 14477             MOVE ER-2437        TO EMI-ERROR
 14478             MOVE -1             TO CREFND1L
 14479             MOVE AL-UNBON       TO CREFND1A
 14480             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14481
 14482     IF CCANREAL > +0
 14483        MOVE AL-UANON            TO CCANREAA
 14484        IF CCANREAI = 'R' OR ' '
 14485           CONTINUE
 14486        ELSE
 14487           MOVE ER-9841        TO EMI-ERROR
 14488           MOVE -1             TO CCANREAL
 14489           MOVE AL-UABON       TO CCANREAA
 14490           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14491        END-IF
 14492     END-IF
 14493     IF CMTHD1L EQUAL +0
 14494        NEXT SENTENCE
 14495     ELSE
 14496        IF CMTHD1L NOT = +0
 14497           MOVE AL-UNNON        TO CMTHD1A
 14498           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14499                         OR '5' OR '6' OR '8' OR '9'
 14500                         OR 'R' OR ' '
 14501              NEXT SENTENCE
 14502           ELSE
 14503              MOVE ER-0582        TO EMI-ERROR
 14504              MOVE -1             TO CMTHD1L
 14505              MOVE AL-UNBON       TO CMTHD1A
 14506              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14507
 14508     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 265
* EL6311.cbl
 14509        AND (CMAINTI = 'C' OR 'K')
 14510         NEXT SENTENCE
 14511     ELSE
 14512         IF CCANDT2L  GREATER THAN ZEROS
 14513             MOVE AL-UNNON       TO CCANDT2A
 14514             IF CCANDT2I = SPACES
 14515                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14516             ELSE
 14517                MOVE CCANDT2I       TO DEEDIT-FIELD
 14518                PERFORM 8600-DEEDIT
 14519                IF DEEDIT-FIELD-V0   NUMERIC
 14520                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14521                   MOVE 4                TO DC-OPTION-CODE
 14522                   PERFORM 9700-DATE-LINK
 14523                   IF NO-CONVERSION-ERROR
 14524                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14525                   ELSE
 14526                      MOVE -1       TO CCANDT2L
 14527                      MOVE ER-2227  TO EMI-ERROR
 14528                      MOVE AL-UNBON TO CCANDT2A
 14529                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14530                ELSE
 14531                   MOVE -1         TO CCANDT2L
 14532                   MOVE ER-2223    TO EMI-ERROR
 14533                   MOVE AL-UNBON   TO CCANDT2A
 14534                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14535         ELSE
 14536            IF CREFND2L GREATER THAN ZEROS
 14537               MOVE -1             TO CCANDT2L
 14538               MOVE ER-2222        TO EMI-ERROR
 14539               MOVE AL-UNBOF       TO CCANDT2A
 14540               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14541
 14542     IF CREFND2L = ZEROS
 14543        AND (CMAINTI = 'C' OR 'K')
 14544         NEXT SENTENCE
 14545     ELSE
 14546         IF CREFND2L NOT = ZEROS
 14547            MOVE AL-UNNON        TO CREFND2A
 14548
 14549* EXEC CICS BIF DEEDIT
 14550*               FIELD  (CREFND2I)
 14551*               LENGTH (11)
 14552*           END-EXEC
 14553     MOVE 11
 14554       TO DFHEIV11
 14555*    MOVE '@"L                   #   #00013116' TO DFHEIV0
 14556     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14557     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14558     MOVE X'2020233030303133313136' TO DFHEIV0(25:11)
 14559     CALL 'kxdfhei1' USING DFHEIV0,
 14560           CREFND2I,
 14561           DFHEIV11
 14562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14563            MOVE CREFND2I        TO WS-CREFND2
 14564*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14565*           PERFORM 8600-DEEDIT
 14566*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 266
* EL6311.cbl
 14567            IF WS-CREFND2  = ZEROS
 14568               AND CMAINTI = 'A'
 14569             MOVE ER-2437        TO EMI-ERROR
 14570             MOVE -1             TO CREFND2L
 14571             MOVE AL-UNBON       TO CREFND2A
 14572             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14573
 14574     IF CMTHD2L EQUAL +0
 14575        NEXT SENTENCE
 14576     ELSE
 14577        IF CMTHD2L NOT = +0
 14578           MOVE AL-UNNON        TO CMTHD2A
 14579           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14580                         OR '5' OR '6' OR '8' OR '9'
 14581                         OR ' ' OR 'R'
 14582              NEXT SENTENCE
 14583           ELSE
 14584              MOVE ER-0582        TO EMI-ERROR
 14585              MOVE -1             TO CMTHD2L
 14586              MOVE AL-UNBON       TO CMTHD2A
 14587              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14588
 14589     IF CLIVESL GREATER THAN ZEROS
 14590         MOVE CLIVESI            TO DEEDIT-FIELD
 14591         PERFORM 8600-DEEDIT
 14592         IF DEEDIT-FIELD-V0 NUMERIC
 14593             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14594             MOVE AL-UNNON       TO CLIVESA
 14595         ELSE
 14596             MOVE -1             TO CLIVESL
 14597             MOVE AL-UNBON       TO CLIVESA
 14598             MOVE ER-2223        TO EMI-ERROR
 14599             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14600
 14601     IF CFORCEL  NOT = ZEROS
 14602         IF FORCE-CAP
 14603            MOVE AL-UANON            TO CFORCEA
 14604         ELSE
 14605            MOVE ER-2945             TO EMI-ERROR
 14606            MOVE AL-UABON            TO CFORCEA
 14607            MOVE -1                  TO CFORCEL
 14608            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14609
 14610     IF CPAYEEL GREATER THAN ZEROS
 14611        MOVE AL-UANON            TO CPAYEEA.
 14612
 14613     IF CBILCDL NOT = ZEROS
 14614        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14615                             AND 'A' AND 'B' AND 'E'
 14616           MOVE ER-2225              TO EMI-ERROR
 14617           MOVE AL-UABON             TO CBILCDA
 14618           MOVE -1                   TO CBILCDL
 14619           MOVE  1                   TO SET-CURSOR-SW
 14620           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14621        ELSE
 14622           MOVE AL-UANON             TO CBILCDA.
 14623
 14624 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 267
* EL6311.cbl
 14625     IF EMI-ERROR = ZEROS
 14626         NEXT SENTENCE
 14627     ELSE
 14628         GO TO 8200-SEND-DATAONLY.
 14629
 14630     IF CMAINTI = 'A'
 14631        GO TO 2200-ADD-CANCEL-ROUTINE.
 14632
 14633     IF CMAINTI = 'C'
 14634        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14635
 14636     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14637
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 268
* EL6311.cbl
 14639
 14640******************************************************************
 14641*                                                                *
 14642*                   S H O W   C A N C E L                        *
 14643*                                                                *
 14644******************************************************************
 14645
 14646 2100-SHOW-REQUEST.
 14647     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14648
 14649     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14650        MOVE -1                  TO CMAINTL
 14651        GO TO 8200-SEND-DATAONLY.
 14652
 14653     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14654
 14655     IF CSUFIXL NOT = ZEROS
 14656        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14657       ELSE
 14658        MOVE SPACE            TO WS-NEW-SUFFIX.
 14659
 14660     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14661     PERFORM 8600-DEEDIT.
 14662     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14663     MOVE '4'                    TO DC-OPTION-CODE.
 14664     PERFORM 9700-DATE-LINK.
 14665     IF DATE-CONVERSION-ERROR
 14666        MOVE ER-0348             TO EMI-ERROR
 14667        MOVE -1                  TO CEFFDTL
 14668        MOVE AL-UABON            TO CEFFDTA
 14669        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14670        GO TO 8200-SEND-DATAONLY
 14671     ELSE
 14672        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14673        MOVE AL-UANON            TO CEFFDTA
 14674        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14675
 14676     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14677
 14678     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14679        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14680        MOVE 'Y'                    TO WS-SHOW-SW
 14681        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14682           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14683        ELSE
 14684           IF PI-FILE-BROWSE
 14685              GO TO 4300-BROWSE-FILE-FORWARD
 14686           ELSE
 14687              IF PI-CSR-BROWSE
 14688                 GO TO 4200-BROWSE-CSR-FORWARD
 14689              ELSE
 14690                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14691     ELSE
 14692        GO TO 3900-RE-DISPLAY-RECORD.
 14693
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 269
* EL6311.cbl
 14695
 14696
 14697******************************************************************
 14698*                                                                *
 14699*            A D D   C A N C E L   R O U T I N E                 *
 14700*                                                                *
 14701******************************************************************
 14702
 14703 2200-ADD-CANCEL-ROUTINE.
 14704     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14705
 14706
 14707* EXEC CICS GETMAIN
 14708*        SET     (ADDRESS OF PENDING-BUSINESS)
 14709*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14710*    END-EXEC.
 14711*    MOVE '," L                  $   #00013263' TO DFHEIV0
 14712     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14713     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14714     MOVE X'2020233030303133323633' TO DFHEIV0(25:11)
 14715     CALL 'kxdfhei1' USING DFHEIV0,
 14716           DFHEIV20,
 14717           ERPNDB-RECORD-LENGTH,
 14718           DFHEIV99
 14719     SET ADDRESS OF PENDING-BUSINESS TO
 14720         DFHEIV20
 14721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14722
 14723
 14724
 14725* EXEC CICS HANDLE CONDITION
 14726*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14727*    END-EXEC.
 14728*    MOVE '"$I                   ! 3 #00013268' TO DFHEIV0
 14729     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14730     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14731     MOVE X'3320233030303133323638' TO DFHEIV0(25:11)
 14732     CALL 'kxdfhei1' USING DFHEIV0
 14733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14734
 14735
 14736     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14737     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14738     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14739
 14740
 14741* EXEC CICS READ
 14742*        INTO    (PENDING-BUSINESS)
 14743*        DATASET (FILE-ID-ERPNDB)
 14744*        RIDFLD  (ERPNDB-KEY)
 14745*    END-EXEC.
 14746     MOVE LENGTH OF
 14747      PENDING-BUSINESS
 14748       TO DFHEIV11
 14749*    MOVE '&"IL       E          (   #00013276' TO DFHEIV0
 14750     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14751     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14752     MOVE X'2020233030303133323736' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 270
* EL6311.cbl
 14753     CALL 'kxdfhei1' USING DFHEIV0,
 14754           FILE-ID-ERPNDB,
 14755           PENDING-BUSINESS,
 14756           DFHEIV11,
 14757           ERPNDB-KEY,
 14758           DFHEIV99,
 14759           DFHEIV99,
 14760           DFHEIV99
 14761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14762
 14763
 14764     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14765
 14766     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14767     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14768     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14769     MOVE SPACES                 TO PENDING-BUSINESS.
 14770     MOVE 'PB'                   TO PB-RECORD-ID.
 14771     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14772     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14773     MOVE SPACES                 TO PB-CERT-SFX.
 14774     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14775     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14776                                    PB-ALT-CHG-SEQ-NO.
 14777
 14778     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14779     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14780     MOVE '2'                    TO PB-RECORD-TYPE.
 14781
 14782     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14783     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14784
 14785
 14786     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14787                                    PB-ALT-CHG-SEQ-NO
 14788                                    PB-C-LF-REF-CALC
 14789                                    PB-C-AH-REF-CALC
 14790                                    PB-C-LF-RFND-CLP
 14791                                    PB-C-AH-RFND-CLP
 14792                                    PB-CI-INSURED-AGE
 14793                                    PB-CI-LF-TERM
 14794                                    PB-CI-AH-TERM
 14795                                    PB-CI-LF-BENEFIT-CD
 14796                                    PB-CI-LF-BENEFIT-AMT
 14797                                    PB-CI-LF-ALT-BENEFIT-AMT
 14798                                    PB-CI-LF-PREMIUM-AMT
 14799                                    PB-CI-LF-ALT-PREMIUM-AMT
 14800                                    PB-CI-AH-BENEFIT-CD
 14801                                    PB-CI-AH-BENEFIT-AMT
 14802                                    PB-CI-AH-PREMIUM-AMT
 14803                                    PB-CI-PAY-FREQUENCY
 14804                                    PB-CI-LOAN-APR
 14805                                    PB-CI-LOAN-TERM
 14806                                    PB-CI-LIFE-COMMISSION
 14807                                    PB-CI-AH-COMMISSION
 14808                                    PB-CI-CURR-SEQ
 14809                                    PB-CI-AH-CANCEL-AMT
 14810                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 271
* EL6311.cbl
 14811                                    PB-CI-RATE-DEV-PCT-LF
 14812                                    PB-CI-RATE-DEV-PCT-AH
 14813                                    PB-CI-EXTENTION-DAYS
 14814                                    PB-CI-TERM-IN-DAYS
 14815                                    PB-CI-LIVES
 14816                                    PB-CI-LF-CRIT-PER
 14817                                    PB-CI-AH-CRIT-PER
 14818                                    PB-C-LF-REM-TERM
 14819                                    PB-C-AH-REM-TERM
 14820                                    PB-CHG-COUNT
 14821                                    PB-LF-BILLED-AMTS
 14822                                    PB-AH-BILLED-AMTS
 14823                                    PB-C-INT-ON-REFS
 14824*                                   PB-C-MICROFILM-NO
 14825                                    PB-CALC-TOLERANCE.
 14826
 14827     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14828                                    PB-CI-AH-SETTLEMENT-DT
 14829                                    PB-CI-DEATH-DT
 14830                                    PB-CI-LF-PRIOR-CANCEL-DT
 14831                                    PB-CI-AH-PRIOR-CANCEL-DT
 14832                                    PB-CI-ENTRY-DT
 14833                                    PB-CI-LF-EXPIRE-DT
 14834                                    PB-CI-AH-EXPIRE-DT
 14835                                    PB-CI-LOAN-1ST-PMT-DT
 14836                                    PB-C-LF-CANCEL-DT
 14837                                    PB-C-AH-CANCEL-DT
 14838                                    PB-CREDIT-ACCEPT-DT
 14839                                    PB-BILLED-DT
 14840                                    PB-ACCT-EFF-DT
 14841                                    PB-ACCT-EXP-DT.
 14842
 14843     MOVE 'X'                    TO PB-FATAL-FLAG.
 14844
 14845     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14846
 14847     IF CSUFIXL     GREATER THAN ZEROS
 14848        MOVE CSUFIXI             TO PB-CERT-SFX.
 14849
 14850*    IF CMICRNOL  GREATER  ZEROS
 14851*        IF CMICRNOI  NUMERIC
 14852*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14853*            MOVE AL-UNNON       TO  CMICRNOA
 14854*        ELSE
 14855*            MOVE -1             TO  CMICRNOL
 14856*            MOVE AL-UNBON       TO  CMICRNOA
 14857*            MOVE ER-2701        TO  EMI-ERROR
 14858*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14859
 14860     IF CLSTNML     GREATER THAN ZEROS
 14861        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14862
 14863     IF CCANREAL > ZEROS
 14864        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14865     END-IF
 14866     IF CPCYNL > ZEROS
 14867        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14868     END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 272
* EL6311.cbl
 14869     IF CCANDT1L    GREATER THAN ZEROS
 14870        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14871
 14872     IF CCANDT2L    GREATER THAN ZEROS
 14873        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14874
 14875     IF CMTHD1L    GREATER THAN +0
 14876        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14877
 14878     IF CMTHD2L    GREATER THAN +0
 14879        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14880
 14881     IF CREFND1L    GREATER THAN ZEROS
 14882        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14883        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14884     ELSE
 14885        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14886
 14887     IF CREFND2L    GREATER THAN ZEROS
 14888        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14889        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14890     ELSE
 14891        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14892
 14893     IF CLIVESL     GREATER THAN ZEROS
 14894        MOVE WS-CLIVES           TO PB-C-LIVES
 14895     ELSE
 14896        MOVE ZEROS               TO PB-C-LIVES.
 14897
 14898     IF CPAYEEL     GREATER THAN ZEROS
 14899        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14900
 14901     IF CFORCEL     GREATER THAN ZEROS
 14902        MOVE CFORCEI             TO PB-FORCE-CODE.
 14903
 14904     IF CBILCDL     GREATER THAN ZEROS
 14905        MOVE CBILCDI             TO PB-RECORD-BILL.
 14906
 14907*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14908
 14909 2260-WRITE-PB-RECORD.
 14910     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14911                                    PB-INPUT-BY.
 14912     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14913     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14914                                    PB-INPUT-DT.
 14915
 14916     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14917     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14918                                    PB-CONTROL-BY-ORIG-BATCH.
 14919
 14920     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14921     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14922     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14923     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14924     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14925
 14926     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 273
* EL6311.cbl
 14927
 14928     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14929
 14930     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14931     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14932     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14933
 14934     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14935     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14936
 14937 2275-WRITE-PENDING-BUSINESS.
 14938     MOVE 'A'                    TO JP-RECORD-TYPE.
 14939     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14940     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14941     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14942
 14943
 14944* EXEC CICS HANDLE CONDITION
 14945*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14946*    END-EXEC.
 14947*    MOVE '"$%                   ! 4 #00013461' TO DFHEIV0
 14948     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14949     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14950     MOVE X'3420233030303133343631' TO DFHEIV0(25:11)
 14951     CALL 'kxdfhei1' USING DFHEIV0
 14952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14953
 14954
 14955
 14956* EXEC CICS WRITE
 14957*        DATASET (FILE-ID-ERPNDB)
 14958*        FROM    (PENDING-BUSINESS)
 14959*        RIDFLD  (PB-CONTROL-PRIMARY)
 14960*    END-EXEC.
 14961     MOVE LENGTH OF
 14962      PENDING-BUSINESS
 14963       TO DFHEIV11
 14964*    MOVE '&$ L                  ''   #00013465' TO DFHEIV0
 14965     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14966     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14967     MOVE X'2020233030303133343635' TO DFHEIV0(25:11)
 14968     CALL 'kxdfhei1' USING DFHEIV0,
 14969           FILE-ID-ERPNDB,
 14970           PENDING-BUSINESS,
 14971           DFHEIV11,
 14972           PB-CONTROL-PRIMARY,
 14973           DFHEIV99,
 14974           DFHEIV99
 14975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14976
 14977
 14978     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14979
 14980     PERFORM 8400-LOG-JOURNAL-RECORD.
 14981
 14982******************************************************************
 14983*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14984******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 274
* EL6311.cbl
 14985
 14986     display ' made it to add orig CANCEL cert '
 14987     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14988     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14989     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14990     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14991
 14992
 14993* EXEC CICS READ
 14994*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14995*        DATASET (FILE-ID-ELCERT)
 14996*        RIDFLD  (ELCERT-KEY)
 14997*        RESP    (WS-RESPONSE)
 14998*    END-EXEC.
 14999*    MOVE '&"S        E          (  N#00013485' TO DFHEIV0
 15000     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15001     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15002     MOVE X'204E233030303133343835' TO DFHEIV0(25:11)
 15003     CALL 'kxdfhei1' USING DFHEIV0,
 15004           FILE-ID-ELCERT,
 15005           DFHEIV20,
 15006           DFHEIV99,
 15007           ELCERT-KEY,
 15008           DFHEIV99,
 15009           DFHEIV99,
 15010           DFHEIV99
 15011     SET ADDRESS OF CERTIFICATE-MASTER TO
 15012         DFHEIV20
 15013     MOVE EIBRESP  TO WS-RESPONSE
 15014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15015
 15016
 15017     IF NOT RESP-NORMAL
 15018        GO TO 2276-BYPASS-CRTO
 15019     END-IF
 15020
 15021     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15022     MOVE ' '                    TO WS-ERMAIL-SW
 15023
 15024
 15025* EXEC CICS READ
 15026*       DATASET   (FILE-ID-ERMAIL)
 15027*       SET       (ADDRESS OF MAILING-DATA)
 15028*       RIDFLD    (ERMAIL-KEY)
 15029*       RESP      (WS-RESPONSE)
 15030*    END-EXEC
 15031*    MOVE '&"S        E          (  N#00013499' TO DFHEIV0
 15032     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15033     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15034     MOVE X'204E233030303133343939' TO DFHEIV0(25:11)
 15035     CALL 'kxdfhei1' USING DFHEIV0,
 15036           FILE-ID-ERMAIL,
 15037           DFHEIV20,
 15038           DFHEIV99,
 15039           ERMAIL-KEY,
 15040           DFHEIV99,
 15041           DFHEIV99,
 15042           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 275
* EL6311.cbl
 15043     SET ADDRESS OF MAILING-DATA TO
 15044         DFHEIV20
 15045     MOVE EIBRESP  TO WS-RESPONSE
 15046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15047
 15048     IF RESP-NORMAL
 15049        SET ERMAIL-FOUND TO TRUE
 15050     END-IF
 15051
 15052     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15053
 15054     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 15055     MOVE 'OC'                   TO OC-RECORD-ID
 15056     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15057                                 TO OC-CONTROL-PRIMARY (1:33)
 15058     MOVE 'I'                    TO OC-RECORD-TYPE
 15059     MOVE +4096                  TO OC-KEY-SEQ-NO
 15060     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 15061     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 15062     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 15063
 15064     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15065     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15066     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15067     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15068     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15069     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15070     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15071     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15072     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15073     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15074     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15075     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15076     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15077     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15078     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15079     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15080     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15081     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15082     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15083     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15084     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15085     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15086     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15087     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15088     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15089     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15090     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15091     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15092     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15093     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15094     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15095     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15096
 15097     IF ERMAIL-FOUND
 15098        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 15099     END-IF
 15100     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 276
* EL6311.cbl
 15101        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15102                           OC-INS-AGE-DEFAULT-FLAG
 15103        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15104                           OC-JNT-AGE-DEFAULT-FLAG
 15105     END-IF
 15106     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 15107     .
 15108 2275-WRITE-ELCRTO.
 15109
 15110
 15111* EXEC CICS WRITE
 15112*       DATASET   ('ELCRTO')
 15113*       FROM      (ORIGINAL-CERTIFICATE)
 15114*       RIDFLD    (OC-CONTROL-PRIMARY)
 15115*       RESP      (WS-RESPONSE)
 15116*    END-EXEC
 15117     MOVE LENGTH OF
 15118      ORIGINAL-CERTIFICATE
 15119       TO DFHEIV11
 15120     MOVE 'ELCRTO' TO DFHEIV1
 15121*    MOVE '&$ L                  ''  N#00013568' TO DFHEIV0
 15122     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15123     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15124     MOVE X'204E233030303133353638' TO DFHEIV0(25:11)
 15125     CALL 'kxdfhei1' USING DFHEIV0,
 15126           DFHEIV1,
 15127           ORIGINAL-CERTIFICATE,
 15128           DFHEIV11,
 15129           OC-CONTROL-PRIMARY,
 15130           DFHEIV99,
 15131           DFHEIV99
 15132     MOVE EIBRESP  TO WS-RESPONSE
 15133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15134
 15135     display ' just wrote 2275 ' ws-response
 15136     IF RESP-DUPKEY
 15137        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 15138        GO TO 2275-WRITE-ELCRTO
 15139     ELSE
 15140        IF NOT RESP-NORMAL
 15141           MOVE -1               TO BMAINTL
 15142           MOVE ER-7450          TO EMI-ERROR
 15143           PERFORM 9900-ERROR-FORMAT
 15144                                 THRU 9900-EXIT
 15145           GO TO 8200-SEND-DATAONLY
 15146        END-IF
 15147     END-IF.
 15148
 15149 2276-BYPASS-CRTO.
 15150******************************************************************
 15151*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15152******************************************************************
 15153
 15154
 15155* EXEC CICS READ
 15156*        INTO    (PENDING-BUSINESS)
 15157*        DATASET (FILE-ID-ERPNDB)
 15158*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 277
* EL6311.cbl
 15159*        UPDATE
 15160*    END-EXEC.
 15161     MOVE LENGTH OF
 15162      PENDING-BUSINESS
 15163       TO DFHEIV11
 15164*    MOVE '&"IL       EU         (   #00013594' TO DFHEIV0
 15165     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15166     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15167     MOVE X'2020233030303133353934' TO DFHEIV0(25:11)
 15168     CALL 'kxdfhei1' USING DFHEIV0,
 15169           FILE-ID-ERPNDB,
 15170           PENDING-BUSINESS,
 15171           DFHEIV11,
 15172           ERPNDB-KEY,
 15173           DFHEIV99,
 15174           DFHEIV99,
 15175           DFHEIV99
 15176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15177
 15178
 15179     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15180     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15181     MOVE 'B'                    TO JP-RECORD-TYPE.
 15182     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15183
 15184     PERFORM 8400-LOG-JOURNAL-RECORD.
 15185
 15186     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15187
 15188
 15189* EXEC CICS REWRITE
 15190*        DATASET (FILE-ID-ERPNDB)
 15191*        FROM    (PENDING-BUSINESS)
 15192*    END-EXEC.
 15193     MOVE LENGTH OF
 15194      PENDING-BUSINESS
 15195       TO DFHEIV11
 15196*    MOVE '&& L                  %   #00013610' TO DFHEIV0
 15197     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15198     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15199     MOVE X'2020233030303133363130' TO DFHEIV0(25:11)
 15200     CALL 'kxdfhei1' USING DFHEIV0,
 15201           FILE-ID-ERPNDB,
 15202           PENDING-BUSINESS,
 15203           DFHEIV11,
 15204           DFHEIV99
 15205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15206
 15207
 15208     MOVE 'C'                    TO JP-RECORD-TYPE.
 15209     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15210
 15211     PERFORM 8400-LOG-JOURNAL-RECORD.
 15212
 15213     IF WS-ERRORS-PRESENT
 15214        GO TO 3900-RE-DISPLAY-RECORD.
 15215
 15216     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 278
* EL6311.cbl
 15217     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15218     MOVE LOW-VALUES             TO EL631CI.
 15219     MOVE  -1                    TO CMAINTL.
 15220     GO TO 8100-SEND-INITIAL-MAP.
 15221
 15222 2280-BATCH-HDR-NOT-FOUND.
 15223     MOVE -1                     TO BMAINTL.
 15224     MOVE ER-7450                TO EMI-ERROR.
 15225     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15226     GO TO 8200-SEND-DATAONLY.
 15227
 15228 2290-DUPLICATE-ALT-INDEX.
 15229
 15230******************************************************************
 15231*                                                                *
 15232*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15233*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15234*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15235*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15236*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15237*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15238*                                                                *
 15239******************************************************************
 15240
 15241     IF LCP-ONCTR-02 =  0
 15242         ADD 1 TO LCP-ONCTR-02
 15243        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15244
 15245     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15246
 15247     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15248         NEXT SENTENCE
 15249     ELSE
 15250         ADD +1 TO PB-BATCH-SEQ-NO
 15251                   PB-CSR-BATCH-SEQ-NO
 15252         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15253         GO TO 2275-WRITE-PENDING-BUSINESS.
 15254
 15255     MOVE -1                     TO CCERTNOL.
 15256     MOVE AL-UABON               TO CCERTNOA.
 15257     MOVE AL-UNBON               TO CEFFDTA.
 15258
 15259     MOVE 1                      TO EMI-SUB
 15260                                    EMI-SWITCH1
 15261                                    EMI-SWITCH-AREA-1
 15262                                    EMI-SWITCH-AREA-2.
 15263
 15264     MOVE SPACES                 TO EMI-ERROR-LINES.
 15265
 15266
 15267* EXEC CICS SYNCPOINT ROLLBACK
 15268*    END-EXEC.
 15269*    MOVE '6"R                   !   #00013673' TO DFHEIV0
 15270     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15271     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15272     MOVE X'2020233030303133363733' TO DFHEIV0(25:11)
 15273     CALL 'kxdfhei1' USING DFHEIV0
 15274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 279
* EL6311.cbl
 15275
 15276
 15277     MOVE ER-2247                TO EMI-ERROR.
 15278     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15279     GO TO 8200-SEND-DATAONLY.
 15280
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 280
* EL6311.cbl
 15282
 15283******************************************************************
 15284*                                                                *
 15285*          C H A N G E   C A N C E L   R O U T I N E             *
 15286*                                                                *
 15287******************************************************************
 15288
 15289***************************************************************
 15290*                                                             *
 15291*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15292*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15293*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15294*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15295*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15296*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15297*     5. LINK TO THE EDIT ROUTINE.                            *
 15298*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15299*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15300*              THE EDIT ROUTINE.                              *
 15301*     7. REWRITE THE NEW ISSUE                                *
 15302*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15303*                                                             *
 15304***************************************************************
 15305 2300-CHANGE-CANCEL-ROUTINE.
 15306     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15307
 15308     IF CCHGL NOT = ZEROS
 15309        MOVE ER-2196             TO EMI-ERROR
 15310        MOVE AL-UABON            TO CMAINTA
 15311        MOVE -1                  TO CMAINTL
 15312        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15313        GO TO 8200-SEND-DATAONLY.
 15314
 15315     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15316
 15317     IF CSUFIXL NOT = ZEROS
 15318        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15319     ELSE
 15320        MOVE SPACE               TO WS-NEW-SUFFIX.
 15321
 15322     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15323     PERFORM 8600-DEEDIT.
 15324     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15325     MOVE '4'                    TO DC-OPTION-CODE.
 15326
 15327     PERFORM 9700-DATE-LINK.
 15328
 15329     IF DATE-CONVERSION-ERROR
 15330        MOVE ER-0348             TO EMI-ERROR
 15331        MOVE -1                  TO CEFFDTL
 15332        MOVE AL-UABON            TO CEFFDTA
 15333        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15334        GO TO 8200-SEND-DATAONLY
 15335     ELSE
 15336        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15337        MOVE AL-UANON            TO CEFFDTA
 15338        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15339
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 281
* EL6311.cbl
 15340 2325-PROCESS-CANCEL-CHANGES.
 15341
 15342* EXEC CICS HANDLE CONDITION
 15343*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15344*    END-EXEC.
 15345*    MOVE '"$I                   ! 5 #00013740' TO DFHEIV0
 15346     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15347     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15348     MOVE X'3520233030303133373430' TO DFHEIV0(25:11)
 15349     CALL 'kxdfhei1' USING DFHEIV0
 15350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15351
 15352
 15353     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15354     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15355     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15356
 15357
 15358* EXEC CICS GETMAIN
 15359*        SET      (ADDRESS OF PENDING-BUSINESS)
 15360*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15361*        INITIMG  (GETMAIN-SPACE)
 15362*     END-EXEC.
 15363*    MOVE ',"IL                  $   #00013748' TO DFHEIV0
 15364     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15365     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15366     MOVE X'2020233030303133373438' TO DFHEIV0(25:11)
 15367     CALL 'kxdfhei1' USING DFHEIV0,
 15368           DFHEIV20,
 15369           ERPNDB-RECORD-LENGTH,
 15370           GETMAIN-SPACE
 15371     SET ADDRESS OF PENDING-BUSINESS TO
 15372         DFHEIV20
 15373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15374
 15375
 15376
 15377* EXEC CICS READ
 15378*        INTO    (PENDING-BUSINESS)
 15379*        DATASET (FILE-ID-ERPNDB)
 15380*        RIDFLD  (ERPNDB-KEY)
 15381*    END-EXEC.
 15382     MOVE LENGTH OF
 15383      PENDING-BUSINESS
 15384       TO DFHEIV11
 15385*    MOVE '&"IL       E          (   #00013754' TO DFHEIV0
 15386     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15387     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15388     MOVE X'2020233030303133373534' TO DFHEIV0(25:11)
 15389     CALL 'kxdfhei1' USING DFHEIV0,
 15390           FILE-ID-ERPNDB,
 15391           PENDING-BUSINESS,
 15392           DFHEIV11,
 15393           ERPNDB-KEY,
 15394           DFHEIV99,
 15395           DFHEIV99,
 15396           DFHEIV99
 15397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 282
* EL6311.cbl
 15398
 15399
 15400     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15401
 15402
 15403* EXEC CICS HANDLE CONDITION
 15404*         NOTFND     (2385-REC-NOT-FOUND)
 15405*    END-EXEC.
 15406*    MOVE '"$I                   ! 6 #00013762' TO DFHEIV0
 15407     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15408     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15409     MOVE X'3620233030303133373632' TO DFHEIV0(25:11)
 15410     CALL 'kxdfhei1' USING DFHEIV0
 15411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15412
 15413
 15414**********************************************************
 15415*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15416*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15417**********************************************************
 15418
 15419
 15420* EXEC CICS READ
 15421*        DATASET (FILE-ID-ERPNDB)
 15422*        INTO    (PENDING-BUSINESS)
 15423*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15424*    END-EXEC.
 15425     MOVE LENGTH OF
 15426      PENDING-BUSINESS
 15427       TO DFHEIV11
 15428*    MOVE '&"IL       E          (   #00013771' TO DFHEIV0
 15429     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15431     MOVE X'2020233030303133373731' TO DFHEIV0(25:11)
 15432     CALL 'kxdfhei1' USING DFHEIV0,
 15433           FILE-ID-ERPNDB,
 15434           PENDING-BUSINESS,
 15435           DFHEIV11,
 15436           PI-PREV-CONTROL-PRIMARY,
 15437           DFHEIV99,
 15438           DFHEIV99,
 15439           DFHEIV99
 15440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15441
 15442
 15443********** DO NOT ALLOW CHANGES IF THRU A/R
 15444     IF BMAINTI = 'C'
 15445         IF PB-EL860-INTERNAL-PROCESS
 15446             MOVE ER-4005          TO EMI-ERROR
 15447             MOVE -1               TO BMAINTL
 15448             MOVE AL-UABON         TO BMAINTA
 15449             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15450             GO TO 8200-SEND-DATAONLY.
 15451**********
 15452
 15453     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15454        MOVE -1                 TO CMAINTL
 15455        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 283
* EL6311.cbl
 15456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15457        GO TO 8200-SEND-DATAONLY.
 15458
 15459     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15460        MOVE ER-2196             TO EMI-ERROR
 15461        MOVE AL-UABON            TO CMAINTA
 15462        MOVE -1                  TO CMAINTL
 15463        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15464        GO TO 8200-SEND-DATAONLY.
 15465     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15466
 15467     IF PB-BILLED-DT = LOW-VALUES AND
 15468        PB-CHG-COUNT = ZEROS
 15469        NEXT SENTENCE
 15470     ELSE
 15471        IF (CREFND1L GREATER THAN ZEROS AND
 15472            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15473           OR
 15474           (CREFND2L GREATER THAN ZEROS AND
 15475            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15476           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15477     if ((crefnd1l <> zeros)
 15478        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15479                      or
 15480        ((crefnd2l <> zeros)
 15481        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15482        continue
 15483     else
 15484        go to 2330-continue-change
 15485     end-if
 15486
 15487     move zeros                  to ws-check-amts
 15488     move ' '                    to ws-stop-sw
 15489                                    ws-check-sw
 15490                                    ws-any-check-sw
 15491                                    ws-proc-check-sw
 15492                                    ws-chek-browse-sw
 15493
 15494     perform 2500-browse-checks  thru 2500-exit
 15495
 15496     if i-have-processed-checks
 15497        or i-have-checks
 15498        continue
 15499     else
 15500        go to 2330-continue-change
 15501     end-if
 15502
 15503     if crefnd1l <> zeros
 15504        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15505        move ws-crefnd1 to ws-new-ref-total
 15506     else
 15507        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15508     end-if
 15509     if crefnd2l <> zeros
 15510        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15511        compute ws-new-ref-total = ws-new-ref-total +
 15512           ws-crefnd2
 15513     else
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 284
* EL6311.cbl
 15514        compute ws-new-ref-total = ws-new-ref-total +
 15515           pb-c-ah-cancel-amt
 15516     end-if
 15517
 15518     if zeros = (ws-lf-diff + ws-ah-diff)
 15519        move er-3449             to emi-error
 15520        perform 9900-error-format thru 9900-exit
 15521        go to 2330-continue-change
 15522     end-if
 15523
 15524     if (ws-new-ref-total < ws-check-amts)
 15525        and (pb-c-refund-sw = 'Y')
 15526        move er-3447             to emi-error
 15527        perform 9900-error-format thru 9900-exit
 15528        move al-uabon            to cmainta
 15529        move -1                  to cmaintl
 15530        go to 8200-send-dataonly
 15531     end-if
 15532
 15533     if (ws-new-ref-total > ws-check-amts)
 15534        and (ws-check-amts not = zeros)
 15535        move er-3448             to emi-error
 15536        move al-uabon            to crefnd1a
 15537                                    crefnd2a
 15538        perform 9900-error-format thru 9900-exit
 15539     end-if
 15540
 15541*     if (ws-lf-diff + ws-ah-diff) < zeros
 15542*        move er-3447             to emi-error
 15543*        perform 9900-error-format thru 9900-exit
 15544*        move al-uabon            to cmainta
 15545*        move -1                  to cmaintl
 15546*        go to 8200-send-dataonly
 15547*     end-if
 15548     .
 15549 2330-continue-change.
 15550
 15551
 15552* EXEC CICS READ
 15553*        DATASET (FILE-ID-ERPNDB)
 15554*        INTO    (PENDING-BUSINESS)
 15555*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15556*        UPDATE
 15557*    END-EXEC.
 15558     MOVE LENGTH OF
 15559      PENDING-BUSINESS
 15560       TO DFHEIV11
 15561*    MOVE '&"IL       EU         (   #00013885' TO DFHEIV0
 15562     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15563     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15564     MOVE X'2020233030303133383835' TO DFHEIV0(25:11)
 15565     CALL 'kxdfhei1' USING DFHEIV0,
 15566           FILE-ID-ERPNDB,
 15567           PENDING-BUSINESS,
 15568           DFHEIV11,
 15569           PI-PREV-CONTROL-PRIMARY,
 15570           DFHEIV99,
 15571           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 285
* EL6311.cbl
 15572           DFHEIV99
 15573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15574
 15575
 15576     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15577     MOVE 'B'                    TO JP-RECORD-TYPE
 15578     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15579     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15580
 15581     PERFORM 8400-LOG-JOURNAL-RECORD.
 15582
 15583     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15584          PB-CHG-COUNT NOT = ZEROS
 15585        IF (CREFND1L GREATER THAN ZEROS AND
 15586            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15587           OR
 15588           (CREFND2L GREATER THAN ZEROS AND
 15589            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15590            ADD +1                      TO PB-CHG-COUNT
 15591            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15592
 15593*    IF CMICRNOL  GREATER  ZEROS
 15594*        IF CMICRNOI  NUMERIC
 15595*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15596*            MOVE AL-UNNON       TO  CMICRNOA
 15597*        ELSE
 15598*            MOVE -1             TO  CMICRNOL
 15599*            MOVE AL-UNBON       TO  CMICRNOA
 15600*            MOVE ER-2701        TO  EMI-ERROR
 15601*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15602
 15603     IF CSUFIXL GREATER THAN ZEROS
 15604        MOVE CSUFIXI             TO PB-CERT-SFX.
 15605
 15606     IF CLSTNML GREATER THAN ZEROS
 15607         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15608
 15609     IF CCANREAL > ZEROS
 15610        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15611     END-IF
 15612     IF CPCYNL > ZEROS
 15613        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15614     END-IF
 15615     IF CCANDT1L    GREATER THAN ZEROS
 15616        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15617
 15618     IF CCANDT2L    GREATER THAN ZEROS
 15619        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15620
 15621     IF CMTHD1L    GREATER THAN +0
 15622        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15623
 15624     IF CMTHD2L    GREATER THAN +0
 15625        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15626
 15627     IF CREFND1L    GREATER THAN ZEROS
 15628        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15629        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 286
* EL6311.cbl
 15630        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15631        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15632
 15633     IF CREFND2L    GREATER THAN ZEROS
 15634        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15635        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15636        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15637        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15638
 15639     IF CLIVESL     GREATER THAN ZEROS
 15640        MOVE WS-CLIVES           TO PB-C-LIVES.
 15641
 15642     IF CPAYEEL     GREATER THAN ZEROS
 15643        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15644
 15645     IF CFORCEL     GREATER THAN ZEROS
 15646        MOVE CFORCEI             TO PB-FORCE-CODE.
 15647
 15648     IF CBILCDL     GREATER THAN ZEROS
 15649        MOVE CBILCDI             TO PB-RECORD-BILL.
 15650
 15651 2360-REWRITE-PB-RECORD.
 15652     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15653     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15654     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15655     MOVE 'C'                    TO JP-RECORD-TYPE.
 15656     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15657     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15658     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15659
 15660     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15661
 15662     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15663     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15664
 15665     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15666
 15667     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15668
 15669     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15670     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15671     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15672
 15673     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15674     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15675
 15676 2375-REWRITE-PENDING-BUSINESS.
 15677     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15678     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15679     MOVE 'C'                    TO JP-RECORD-TYPE.
 15680     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15681
 15682
 15683* EXEC CICS REWRITE
 15684*        DATASET (FILE-ID-ERPNDB)
 15685*        FROM    (PENDING-BUSINESS)
 15686*    END-EXEC.
 15687     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 287
* EL6311.cbl
 15688      PENDING-BUSINESS
 15689       TO DFHEIV11
 15690*    MOVE '&& L                  %   #00013998' TO DFHEIV0
 15691     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15692     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15693     MOVE X'2020233030303133393938' TO DFHEIV0(25:11)
 15694     CALL 'kxdfhei1' USING DFHEIV0,
 15695           FILE-ID-ERPNDB,
 15696           PENDING-BUSINESS,
 15697           DFHEIV11,
 15698           DFHEIV99
 15699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15700
 15701
 15702     PERFORM 8400-LOG-JOURNAL-RECORD.
 15703
 15704******************************************************************
 15705*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15706******************************************************************
 15707
 15708     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15709     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15710     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15711     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15712
 15713
 15714* EXEC CICS READ
 15715*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15716*        DATASET (FILE-ID-ELCERT)
 15717*        RIDFLD  (ELCERT-KEY)
 15718*        RESP    (WS-RESPONSE)
 15719*    END-EXEC.
 15720*    MOVE '&"S        E          (  N#00014014' TO DFHEIV0
 15721     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15722     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15723     MOVE X'204E233030303134303134' TO DFHEIV0(25:11)
 15724     CALL 'kxdfhei1' USING DFHEIV0,
 15725           FILE-ID-ELCERT,
 15726           DFHEIV20,
 15727           DFHEIV99,
 15728           ELCERT-KEY,
 15729           DFHEIV99,
 15730           DFHEIV99,
 15731           DFHEIV99
 15732     SET ADDRESS OF CERTIFICATE-MASTER TO
 15733         DFHEIV20
 15734     MOVE EIBRESP  TO WS-RESPONSE
 15735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15736
 15737
 15738     IF NOT RESP-NORMAL
 15739        GO TO 2376-BYPASS-CRTO
 15740     END-IF
 15741
 15742
 15743     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15744     MOVE ' '                    TO WS-ERMAIL-SW
 15745
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 288
* EL6311.cbl
 15746
 15747* EXEC CICS READ
 15748*       DATASET   (FILE-ID-ERMAIL)
 15749*       SET       (ADDRESS OF MAILING-DATA)
 15750*       RIDFLD    (ERMAIL-KEY)
 15751*       RESP      (WS-RESPONSE)
 15752*    END-EXEC
 15753*    MOVE '&"S        E          (  N#00014029' TO DFHEIV0
 15754     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15755     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15756     MOVE X'204E233030303134303239' TO DFHEIV0(25:11)
 15757     CALL 'kxdfhei1' USING DFHEIV0,
 15758           FILE-ID-ERMAIL,
 15759           DFHEIV20,
 15760           DFHEIV99,
 15761           ERMAIL-KEY,
 15762           DFHEIV99,
 15763           DFHEIV99,
 15764           DFHEIV99
 15765     SET ADDRESS OF MAILING-DATA TO
 15766         DFHEIV20
 15767     MOVE EIBRESP  TO WS-RESPONSE
 15768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15769
 15770     IF RESP-NORMAL
 15771        SET ERMAIL-FOUND TO TRUE
 15772     END-IF
 15773
 15774     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15775
 15776     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15777                                 TO ELCRTO-KEY
 15778     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15779     MOVE +0                     TO ELCRTO-SEQ-NO
 15780
 15781
 15782* EXEC CICS READ
 15783*       DATASET   ('ELCRTO')
 15784*       INTO      (ORIGINAL-CERTIFICATE)
 15785*       RIDFLD    (ELCRTO-KEY)
 15786*       GTEQ
 15787*       RESP      (WS-RESPONSE)
 15788*    END-EXEC
 15789     MOVE LENGTH OF
 15790      ORIGINAL-CERTIFICATE
 15791       TO DFHEIV11
 15792     MOVE 'ELCRTO' TO DFHEIV1
 15793*    MOVE '&"IL       G          (  N#00014047' TO DFHEIV0
 15794     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15795     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15796     MOVE X'204E233030303134303437' TO DFHEIV0(25:11)
 15797     CALL 'kxdfhei1' USING DFHEIV0,
 15798           DFHEIV1,
 15799           ORIGINAL-CERTIFICATE,
 15800           DFHEIV11,
 15801           ELCRTO-KEY,
 15802           DFHEIV99,
 15803           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 289
* EL6311.cbl
 15804           DFHEIV99
 15805     MOVE EIBRESP  TO WS-RESPONSE
 15806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15807
 15808     IF RESP-NORMAL
 15809        AND (OC-CONTROL-PRIMARY (1:33) =
 15810                 PB-CONTROL-BY-ACCOUNT (1:33))
 15811        AND (OC-RECORD-TYPE = 'I')
 15812        display ' resp norm, key =, type i '
 15813        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15814           display ' end proc blank '
 15815           display ' csr edit session ' PI-CSR-SESSION-SW
 15816           IF NOT CSR-EDIT-SESSION
 15817
 15818* EXEC CICS READ
 15819*                DATASET   ('ELCRTO')
 15820*                INTO      (ORIGINAL-CERTIFICATE)
 15821*                RIDFLD    (OC-CONTROL-PRIMARY)
 15822*                UPDATE
 15823*                RESP      (WS-RESPONSE)
 15824*             END-EXEC
 15825     MOVE LENGTH OF
 15826      ORIGINAL-CERTIFICATE
 15827       TO DFHEIV11
 15828     MOVE 'ELCRTO' TO DFHEIV1
 15829*    MOVE '&"IL       EU         (  N#00014064' TO DFHEIV0
 15830     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15831     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15832     MOVE X'204E233030303134303634' TO DFHEIV0(25:11)
 15833     CALL 'kxdfhei1' USING DFHEIV0,
 15834           DFHEIV1,
 15835           ORIGINAL-CERTIFICATE,
 15836           DFHEIV11,
 15837           OC-CONTROL-PRIMARY,
 15838           DFHEIV99,
 15839           DFHEIV99,
 15840           DFHEIV99
 15841     MOVE EIBRESP  TO WS-RESPONSE
 15842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15843              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15844              IF RESP-NORMAL
 15845                 display ' good read upd '
 15846                 IF OC-ISSUE-TRAN-IND = 'N'
 15847                    MOVE CM-INSURED-LAST-NAME   TO
 15848                         OC-INS-LAST-NAME
 15849                    MOVE CM-INSURED-FIRST-NAME  TO
 15850                         OC-INS-FIRST-NAME
 15851                    MOVE CM-INSURED-INITIAL2    TO
 15852                         OC-INS-MIDDLE-INIT
 15853                    MOVE CM-INSURED-ISSUE-AGE   TO
 15854                         OC-INS-AGE
 15855                    MOVE CM-JT-LAST-NAME        TO
 15856                         OC-JNT-LAST-NAME
 15857                    MOVE CM-JT-FIRST-NAME       TO
 15858                         OC-JNT-FIRST-NAME
 15859                    MOVE CM-JT-INITIAL          TO
 15860                         OC-JNT-MIDDLE-INIT
 15861                    MOVE CM-INSURED-JOINT-AGE   TO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 290
* EL6311.cbl
 15862                         OC-JNT-AGE
 15863                    MOVE CM-LF-BENEFIT-CD       TO
 15864                         OC-LF-BENCD
 15865                    MOVE CM-LF-ORIG-TERM        TO
 15866                         OC-LF-TERM
 15867                    MOVE CM-LF-BENEFIT-AMT      TO
 15868                         OC-LF-BEN-AMT
 15869                    MOVE CM-LF-PREMIUM-AMT      TO
 15870                         OC-LF-PRM-AMT
 15871                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15872                         OC-LF-ALT-BEN-AMT
 15873                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15874                         OC-LF-ALT-PRM-AMT
 15875                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15876                         OC-LF-EXP-DT
 15877                    MOVE CM-LIFE-COMM-PCT       TO
 15878                         OC-LF-COMM-PCT
 15879                    MOVE CM-AH-BENEFIT-CD       TO
 15880                         OC-AH-BENCD
 15881                    MOVE CM-AH-ORIG-TERM        TO
 15882                         OC-AH-TERM
 15883                    MOVE CM-AH-BENEFIT-AMT      TO
 15884                         OC-AH-BEN-AMT
 15885                    MOVE CM-AH-PREMIUM-AMT      TO
 15886                         OC-AH-PRM-AMT
 15887                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15888                         OC-AH-EXP-DT
 15889                    MOVE CM-AH-COMM-PCT         TO
 15890                         OC-AH-COMM-PCT
 15891                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15892                         OC-AH-CP
 15893                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15894                         OC-1ST-PMT-DT
 15895                 END-IF
 15896                 MOVE PB-C-LF-CANCEL-DT      TO
 15897                         OC-LF-CANCEL-DT
 15898                 MOVE PB-C-LF-CANCEL-AMT     TO
 15899                         OC-LF-CANCEL-AMT
 15900                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15901                         OC-LF-ITD-CANCEL-AMT
 15902                 MOVE PB-C-AH-CANCEL-DT      TO
 15903                         OC-AH-CANCEL-DT
 15904                 MOVE PB-C-AH-CANCEL-AMT     TO
 15905                         OC-AH-CANCEL-AMT
 15906                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15907                         OC-AH-ITD-CANCEL-AMT
 15908                 MOVE 'Y'                    TO
 15909                         OC-CANCEL-TRAN-IND
 15910                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15911                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15912                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15913                 IF ERMAIL-FOUND
 15914                    MOVE MA-CRED-BENE-NAME
 15915                                 TO OC-CRED-BENE-NAME
 15916                 END-IF
 15917                 IF NOT CERT-TRL-REC-NOT-FOUND
 15918                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15919                           OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 291
* EL6311.cbl
 15920                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15921                           OC-JNT-AGE-DEFAULT-FLAG
 15922                 END-IF
 15923
 15924* EXEC CICS REWRITE
 15925*                   DATASET   ('ELCRTO')
 15926*                   FROM      (ORIGINAL-CERTIFICATE)
 15927*                   RESP      (WS-RESPONSE)
 15928*                END-EXEC
 15929     MOVE LENGTH OF
 15930      ORIGINAL-CERTIFICATE
 15931       TO DFHEIV11
 15932     MOVE 'ELCRTO' TO DFHEIV1
 15933*    MOVE '&& L                  %  N#00014151' TO DFHEIV0
 15934     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15935     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15936     MOVE X'204E233030303134313531' TO DFHEIV0(25:11)
 15937     CALL 'kxdfhei1' USING DFHEIV0,
 15938           DFHEIV1,
 15939           ORIGINAL-CERTIFICATE,
 15940           DFHEIV11,
 15941           DFHEIV99
 15942     MOVE EIBRESP  TO WS-RESPONSE
 15943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15944                 display ' just rewrote ' ws-response
 15945              END-IF
 15946           END-IF
 15947        ELSE
 15948           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15949           MOVE 'OC'             TO OC-RECORD-ID
 15950           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15951           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15952           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15953           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15954           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15955           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15956           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15957           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15958           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15959           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15960           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15961           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15962           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15963           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15964           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15965           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15966           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15967           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15968           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15969           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15970           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15971           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15972           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15973           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15974           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15975           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15976           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15977           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 292
* EL6311.cbl
 15978           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15979           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15980           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15981           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15982           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15983           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15984           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15985           IF ERMAIL-FOUND
 15986              MOVE MA-CRED-BENE-NAME
 15987                                 TO OC-CRED-BENE-NAME
 15988           END-IF
 15989           IF NOT CERT-TRL-REC-NOT-FOUND
 15990              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15991                           OC-INS-AGE-DEFAULT-FLAG
 15992              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15993                           OC-JNT-AGE-DEFAULT-FLAG
 15994           END-IF
 15995           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15996
 15997* EXEC CICS WRITE
 15998*             DATASET   ('ELCRTO')
 15999*             FROM      (ORIGINAL-CERTIFICATE)
 16000*             RIDFLD    (OC-CONTROL-PRIMARY)
 16001*             RESP      (WS-RESPONSE)
 16002*          END-EXEC
 16003     MOVE LENGTH OF
 16004      ORIGINAL-CERTIFICATE
 16005       TO DFHEIV11
 16006     MOVE 'ELCRTO' TO DFHEIV1
 16007*    MOVE '&$ L                  ''  N#00014208' TO DFHEIV0
 16008     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16009     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16010     MOVE X'204E233030303134323038' TO DFHEIV0(25:11)
 16011     CALL 'kxdfhei1' USING DFHEIV0,
 16012           DFHEIV1,
 16013           ORIGINAL-CERTIFICATE,
 16014           DFHEIV11,
 16015           OC-CONTROL-PRIMARY,
 16016           DFHEIV99,
 16017           DFHEIV99
 16018     MOVE EIBRESP  TO WS-RESPONSE
 16019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16020        END-IF
 16021     ELSE
 16022        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 16023        MOVE 'OC'                TO OC-RECORD-ID
 16024        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16025                                 TO OC-CONTROL-PRIMARY (1:33)
 16026        MOVE 'I'                 TO OC-RECORD-TYPE
 16027        MOVE +4096               TO OC-KEY-SEQ-NO
 16028        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 16029        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 16030        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 16031        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16032        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16033        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16034        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16035        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 293
* EL6311.cbl
 16036        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16037        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16038        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16039        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16040        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16041        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16042        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16043        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16044        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16045        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16046        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16047        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16048        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16049        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16050        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16051        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16052        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16053        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16054        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16055        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16056        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16057        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16058        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16059        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16060        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16061        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16062        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16063        IF ERMAIL-FOUND
 16064           MOVE MA-CRED-BENE-NAME
 16065                                 TO OC-CRED-BENE-NAME
 16066        END-IF
 16067        IF NOT CERT-TRL-REC-NOT-FOUND
 16068           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16069                           OC-INS-AGE-DEFAULT-FLAG
 16070           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16071                           OC-JNT-AGE-DEFAULT-FLAG
 16072        END-IF
 16073        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 16074
 16075
 16076* EXEC CICS WRITE
 16077*          DATASET   ('ELCRTO')
 16078*          FROM      (ORIGINAL-CERTIFICATE)
 16079*          RIDFLD    (OC-CONTROL-PRIMARY)
 16080*          RESP      (WS-RESPONSE)
 16081*       END-EXEC
 16082     MOVE LENGTH OF
 16083      ORIGINAL-CERTIFICATE
 16084       TO DFHEIV11
 16085     MOVE 'ELCRTO' TO DFHEIV1
 16086*    MOVE '&$ L                  ''  N#00014269' TO DFHEIV0
 16087     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16088     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16089     MOVE X'204E233030303134323639' TO DFHEIV0(25:11)
 16090     CALL 'kxdfhei1' USING DFHEIV0,
 16091           DFHEIV1,
 16092           ORIGINAL-CERTIFICATE,
 16093           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 294
* EL6311.cbl
 16094           OC-CONTROL-PRIMARY,
 16095           DFHEIV99,
 16096           DFHEIV99
 16097     MOVE EIBRESP  TO WS-RESPONSE
 16098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16099     END-IF.
 16100
 16101 2376-BYPASS-CRTO.
 16102******************************************************************
 16103*       U P D A T E   T H E   B A T C H   H E A D E R            *
 16104******************************************************************
 16105
 16106
 16107* EXEC CICS HANDLE CONDITION
 16108*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 16109*    END-EXEC.
 16110*    MOVE '"$I                   ! 7 #00014282' TO DFHEIV0
 16111     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16112     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16113     MOVE X'3720233030303134323832' TO DFHEIV0(25:11)
 16114     CALL 'kxdfhei1' USING DFHEIV0
 16115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16116
 16117
 16118
 16119* EXEC CICS READ
 16120*        INTO    (PENDING-BUSINESS)
 16121*        DATASET (FILE-ID-ERPNDB)
 16122*        RIDFLD  (ERPNDB-KEY)
 16123*        UPDATE
 16124*    END-EXEC.
 16125     MOVE LENGTH OF
 16126      PENDING-BUSINESS
 16127       TO DFHEIV11
 16128*    MOVE '&"IL       EU         (   #00014286' TO DFHEIV0
 16129     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16130     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16131     MOVE X'2020233030303134323836' TO DFHEIV0(25:11)
 16132     CALL 'kxdfhei1' USING DFHEIV0,
 16133           FILE-ID-ERPNDB,
 16134           PENDING-BUSINESS,
 16135           DFHEIV11,
 16136           ERPNDB-KEY,
 16137           DFHEIV99,
 16138           DFHEIV99,
 16139           DFHEIV99
 16140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16141
 16142
 16143     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16144     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16145     MOVE 'B'                    TO JP-RECORD-TYPE.
 16146     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16147
 16148     PERFORM 8400-LOG-JOURNAL-RECORD.
 16149
 16150     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16151
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 295
* EL6311.cbl
 16152
 16153* EXEC CICS REWRITE
 16154*        DATASET (FILE-ID-ERPNDB)
 16155*        FROM    (PENDING-BUSINESS)
 16156*    END-EXEC.
 16157     MOVE LENGTH OF
 16158      PENDING-BUSINESS
 16159       TO DFHEIV11
 16160*    MOVE '&& L                  %   #00014302' TO DFHEIV0
 16161     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16162     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16163     MOVE X'2020233030303134333032' TO DFHEIV0(25:11)
 16164     CALL 'kxdfhei1' USING DFHEIV0,
 16165           FILE-ID-ERPNDB,
 16166           PENDING-BUSINESS,
 16167           DFHEIV11,
 16168           DFHEIV99
 16169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16170
 16171
 16172     MOVE 'C'                    TO JP-RECORD-TYPE.
 16173     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16174
 16175     PERFORM 8400-LOG-JOURNAL-RECORD.
 16176
 16177     IF WS-ERRORS-PRESENT
 16178         GO TO 3900-RE-DISPLAY-RECORD.
 16179
 16180     MOVE ZEROS                  TO EMI-ERROR
 16181     MOVE -1                     TO CMAINTL
 16182     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16183     GO TO 3900-RE-DISPLAY-RECORD.
 16184
 16185 2380-BATCH-HDR-NOT-FOUND.
 16186     MOVE -1                     TO BMAINTL.
 16187     MOVE ER-7450                TO EMI-ERROR.
 16188     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16189     GO TO 8200-SEND-DATAONLY.
 16190
 16191 2385-REC-NOT-FOUND.
 16192     MOVE -1                     TO BMAINTL.
 16193     MOVE ER-7451                TO EMI-ERROR.
 16194     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16195     GO TO 8200-SEND-DATAONLY.
 16196
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 296
* EL6311.cbl
 16198
 16199******************************************************************
 16200*                                                                *
 16201*          D E L E T E   C A N C E L   R O U T I N E             *
 16202*                                                                *
 16203******************************************************************
 16204
 16205 2400-DELETE-CANCEL-ROUTINE.
 16206     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16207
 16208     IF CCHGL NOT = ZEROS
 16209        MOVE ER-2196             TO EMI-ERROR
 16210        MOVE AL-UABON            TO CMAINTA
 16211        MOVE -1                  TO CMAINTL
 16212        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16213        GO TO 8200-SEND-DATAONLY.
 16214
 16215
 16216* EXEC CICS HANDLE CONDITION
 16217*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16218*    END-EXEC.
 16219*    MOVE '"$I                   ! 8 #00014350' TO DFHEIV0
 16220     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16221     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16222     MOVE X'3820233030303134333530' TO DFHEIV0(25:11)
 16223     CALL 'kxdfhei1' USING DFHEIV0
 16224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16225
 16226
 16227     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16228     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16229     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16230
 16231
 16232* EXEC CICS READ
 16233*        SET     (ADDRESS OF PENDING-BUSINESS)
 16234*        DATASET (FILE-ID-ERPNDB)
 16235*        RIDFLD  (ERPNDB-KEY)
 16236*    END-EXEC.
 16237*    MOVE '&"S        E          (   #00014358' TO DFHEIV0
 16238     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16239     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16240     MOVE X'2020233030303134333538' TO DFHEIV0(25:11)
 16241     CALL 'kxdfhei1' USING DFHEIV0,
 16242           FILE-ID-ERPNDB,
 16243           DFHEIV20,
 16244           DFHEIV99,
 16245           ERPNDB-KEY,
 16246           DFHEIV99,
 16247           DFHEIV99,
 16248           DFHEIV99
 16249     SET ADDRESS OF PENDING-BUSINESS TO
 16250         DFHEIV20
 16251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16252
 16253
 16254     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16255
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 297
* EL6311.cbl
 16256     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16257
 16258     IF CSUFIXL NOT = ZEROS
 16259        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16260     ELSE
 16261        MOVE SPACE               TO WS-NEW-SUFFIX.
 16262
 16263     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16264
 16265     PERFORM 8600-DEEDIT.
 16266     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16267     MOVE '4'                    TO DC-OPTION-CODE.
 16268     PERFORM 9700-DATE-LINK.
 16269
 16270     IF DATE-CONVERSION-ERROR
 16271        MOVE ER-0348             TO EMI-ERROR
 16272        MOVE -1                  TO CEFFDTL
 16273        MOVE AL-UABON            TO CEFFDTA
 16274        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16275        GO TO 8200-SEND-DATAONLY
 16276     ELSE
 16277        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16278        MOVE AL-UANON            TO CEFFDTA
 16279        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16280
 16281
 16282* EXEC CICS HANDLE CONDITION
 16283*         NOTFND    (2490-RECORD-NOT-FOUND)
 16284*    END-EXEC.
 16285*    MOVE '"$I                   ! 9 #00014391' TO DFHEIV0
 16286     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16288     MOVE X'3920233030303134333931' TO DFHEIV0(25:11)
 16289     CALL 'kxdfhei1' USING DFHEIV0
 16290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16291
 16292
 16293
 16294* EXEC CICS READ
 16295*        SET     (ADDRESS OF PENDING-BUSINESS)
 16296*        DATASET (FILE-ID-ERPNDB)
 16297*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16298*        UPDATE
 16299*    END-EXEC.
 16300*    MOVE '&"S        EU         (   #00014395' TO DFHEIV0
 16301     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16302     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16303     MOVE X'2020233030303134333935' TO DFHEIV0(25:11)
 16304     CALL 'kxdfhei1' USING DFHEIV0,
 16305           FILE-ID-ERPNDB,
 16306           DFHEIV20,
 16307           DFHEIV99,
 16308           PI-PREV-CONTROL-PRIMARY,
 16309           DFHEIV99,
 16310           DFHEIV99,
 16311           DFHEIV99
 16312     SET ADDRESS OF PENDING-BUSINESS TO
 16313         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 298
* EL6311.cbl
 16314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16315
 16316
 16317     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16318        MOVE -1                 TO CMAINTL
 16319        MOVE ER-2197            TO EMI-ERROR
 16320        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16321        GO TO 8200-SEND-DATAONLY.
 16322
 16323     IF PB-BILLED-DT NOT = LOW-VALUES
 16324        MOVE -1                 TO CMAINTL
 16325        MOVE ER-2129            TO EMI-ERROR
 16326        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16327        GO TO 8200-SEND-DATAONLY.
 16328
 16329     IF PB-CHG-COUNT NOT = ZEROS
 16330        MOVE ER-2336            TO EMI-ERROR
 16331        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16332        MOVE AL-UABON            TO CMAINTA
 16333        MOVE -1                  TO CMAINTL
 16334        GO TO 8200-SEND-DATAONLY.
 16335
 16336     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16337        PB-CHG-COUNT NOT = ZEROS
 16338        MOVE ER-2196             TO EMI-ERROR
 16339        MOVE AL-UABON            TO CMAINTA
 16340        MOVE -1                  TO CMAINTL
 16341        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16342        GO TO 8200-SEND-DATAONLY.
 16343
 16344     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16345        MOVE ER-2900 TO EMI-ERROR
 16346        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16347        MOVE AL-UABON         TO CMAINTA
 16348        MOVE -1               TO CMAINTL
 16349        GO TO 8200-SEND-DATAONLY.
 16350     move ' '                    to ws-stop-sw
 16351                                    ws-check-sw
 16352                                    ws-any-check-sw
 16353                                    ws-proc-check-sw
 16354                                    ws-chek-browse-sw
 16355
 16356     perform 2500-browse-checks  thru 2500-exit
 16357     if (i-have-processed-checks)
 16358        and (pb-c-refund-sw = 'Y')
 16359        move er-3446             to emi-error
 16360        perform 9900-error-format thru 9900-exit
 16361        move al-uabon            to cmainta
 16362        move -1                  to cmaintl
 16363        go to 8200-send-dataonly
 16364     end-if
 16365
 16366* EXEC CICS HANDLE CONDITION
 16367*         NOTFND  (2475-CONTINUE-DELETE)
 16368*    END-EXEC
 16369*    MOVE '"$I                   ! : #00014450' TO DFHEIV0
 16370     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16371     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 299
* EL6311.cbl
 16372     MOVE X'3A20233030303134343530' TO DFHEIV0(25:11)
 16373     CALL 'kxdfhei1' USING DFHEIV0
 16374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16375
 16376     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16377     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16378     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16379     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16380
 16381
 16382* EXEC CICS READ
 16383*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16384*        DATASET (FILE-ID-ELCERT)
 16385*        RIDFLD  (ELCERT-KEY)
 16386*        UPDATE
 16387*    END-EXEC.
 16388*    MOVE '&"S        EU         (   #00014459' TO DFHEIV0
 16389     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16390     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16391     MOVE X'2020233030303134343539' TO DFHEIV0(25:11)
 16392     CALL 'kxdfhei1' USING DFHEIV0,
 16393           FILE-ID-ELCERT,
 16394           DFHEIV20,
 16395           DFHEIV99,
 16396           ELCERT-KEY,
 16397           DFHEIV99,
 16398           DFHEIV99,
 16399           DFHEIV99
 16400     SET ADDRESS OF CERTIFICATE-MASTER TO
 16401         DFHEIV20
 16402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16403
 16404
 16405     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16406
 16407     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16408     MOVE 'B'                    TO JP-RECORD-TYPE.
 16409     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16410     PERFORM 8400-LOG-JOURNAL-RECORD.
 16411
 16412     IF PB-CI-LIVES NOT NUMERIC
 16413         MOVE ZERO                    TO PB-CI-LIVES.
 16414
 16415     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16416        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16417           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16418           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16419           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16420                                            CM-LF-CANCEL-DT
 16421           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16422        ELSE
 16423           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16424           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16425           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16426           MOVE PB-CI-LIVES              TO CM-LIVES.
 16427
 16428     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16429        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 300
* EL6311.cbl
 16430           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16431               MOVE CM-LF-STATUS-AT-CANCEL
 16432                                        TO CM-LF-CURRENT-STATUS
 16433               MOVE SPACE
 16434                                        TO CM-LF-STATUS-AT-CANCEL
 16435           ELSE
 16436               MOVE PB-CI-LF-POLICY-STATUS
 16437                                        TO CM-LF-CURRENT-STATUS
 16438        ELSE
 16439           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16440
 16441
 16442     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16443        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16444           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16445           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16446           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16447                                            CM-AH-CANCEL-DT
 16448           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16449        ELSE
 16450           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16451           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16452           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16453           MOVE PB-CI-LIVES              TO CM-LIVES.
 16454
 16455     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16456        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16457           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16458               MOVE CM-AH-STATUS-AT-CANCEL
 16459                                        TO CM-AH-CURRENT-STATUS
 16460               MOVE SPACE
 16461                                        TO CM-AH-STATUS-AT-CANCEL
 16462           ELSE
 16463               MOVE PB-CI-AH-POLICY-STATUS
 16464                                        TO CM-AH-CURRENT-STATUS
 16465        ELSE
 16466           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16467
 16468 2450-REWRITE-CERT.
 16469     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16470     MOVE 'C'                      TO JP-RECORD-TYPE.
 16471     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16472
 16473
 16474* EXEC CICS REWRITE
 16475*        DATASET  (FILE-ID-ELCERT)
 16476*        FROM     (CERTIFICATE-MASTER)
 16477*    END-EXEC.
 16478     MOVE LENGTH OF
 16479      CERTIFICATE-MASTER
 16480       TO DFHEIV11
 16481*    MOVE '&& L                  %   #00014534' TO DFHEIV0
 16482     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16483     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16484     MOVE X'2020233030303134353334' TO DFHEIV0(25:11)
 16485     CALL 'kxdfhei1' USING DFHEIV0,
 16486           FILE-ID-ELCERT,
 16487           CERTIFICATE-MASTER,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 301
* EL6311.cbl
 16488           DFHEIV11,
 16489           DFHEIV99
 16490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16491
 16492
 16493     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16494
 16495     PERFORM 8400-LOG-JOURNAL-RECORD.
 16496
 16497     move ' '                    to ws-stop-sw
 16498                                    ws-any-check-sw
 16499                                    ws-proc-check-sw
 16500                                    ws-chek-browse-sw
 16501
 16502     if i-have-checks
 16503        perform until i-say-stop
 16504           perform 2510-startbr-erchek
 16505                                 thru 2510-exit
 16506           if resp-normal
 16507              perform 2520-readnext-erchek
 16508                                 thru 2520-exit
 16509           end-if
 16510           if (not resp-normal)
 16511              or (pb-control-by-account (1:33) not =
 16512                 ch-control-primary (1:33))
 16513                 set i-say-stop to true
 16514           else
 16515              perform 2530-readupd-erchek
 16516                                 thru 2530-exit
 16517              if resp-normal
 16518                 perform 2540-delete-erchek
 16519                                 thru 2540-exit
 16520              end-if
 16521              if ws-chek-browse-sw = 'Y'
 16522                 perform 2525-endbr-erchek
 16523                                 thru 2525-exit
 16524                 move ' '        to ws-chek-browse-sw
 16525              end-if
 16526           end-if
 16527        end-perform
 16528     end-if
 16529
 16530     if ws-chek-browse-sw = 'Y'
 16531        perform 2525-endbr-erchek thru 2525-exit
 16532     end-if
 16533     .
 16534 2475-CONTINUE-DELETE.
 16535     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16536     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16537
 16538     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16539     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16540
 16541     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16542
 16543     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16544     MOVE 'D'                    TO JP-RECORD-TYPE
 16545     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 302
* EL6311.cbl
 16546
 16547
 16548* EXEC CICS DELETE
 16549*        DATASET    (FILE-ID-ERPNDB)
 16550*    END-EXEC.
 16551*    MOVE '&(                    &   #00014593' TO DFHEIV0
 16552     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16553     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16554     MOVE X'2020233030303134353933' TO DFHEIV0(25:11)
 16555     CALL 'kxdfhei1' USING DFHEIV0,
 16556           FILE-ID-ERPNDB,
 16557           DFHEIV99,
 16558           DFHEIV99,
 16559           DFHEIV99,
 16560           DFHEIV99
 16561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16562
 16563
 16564     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16565
 16566     PERFORM 8400-LOG-JOURNAL-RECORD.
 16567
 16568     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16569     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16570
 16571
 16572* EXEC CICS HANDLE CONDITION
 16573*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16574*    END-EXEC.
 16575*    MOVE '"$I                   ! ; #00014604' TO DFHEIV0
 16576     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16577     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16578     MOVE X'3B20233030303134363034' TO DFHEIV0(25:11)
 16579     CALL 'kxdfhei1' USING DFHEIV0
 16580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16581
 16582
 16583
 16584* EXEC CICS READ
 16585*        SET     (ADDRESS OF PENDING-BUSINESS)
 16586*        DATASET (FILE-ID-ERPNDB)
 16587*        RIDFLD  (ERPNDB-KEY)
 16588*        UPDATE
 16589*    END-EXEC.
 16590*    MOVE '&"S        EU         (   #00014608' TO DFHEIV0
 16591     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16592     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16593     MOVE X'2020233030303134363038' TO DFHEIV0(25:11)
 16594     CALL 'kxdfhei1' USING DFHEIV0,
 16595           FILE-ID-ERPNDB,
 16596           DFHEIV20,
 16597           DFHEIV99,
 16598           ERPNDB-KEY,
 16599           DFHEIV99,
 16600           DFHEIV99,
 16601           DFHEIV99
 16602     SET ADDRESS OF PENDING-BUSINESS TO
 16603         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 303
* EL6311.cbl
 16604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16605
 16606
 16607     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16608     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16609
 16610     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16611        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16612        MOVE 'D'                 TO JP-RECORD-TYPE
 16613        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16614
 16615* EXEC CICS DELETE
 16616*            DATASET    (FILE-ID-ERPNDB)
 16617*       END-EXEC
 16618*    MOVE '&(                    &   #00014622' TO DFHEIV0
 16619     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16620     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16621     MOVE X'2020233030303134363232' TO DFHEIV0(25:11)
 16622     CALL 'kxdfhei1' USING DFHEIV0,
 16623           FILE-ID-ERPNDB,
 16624           DFHEIV99,
 16625           DFHEIV99,
 16626           DFHEIV99,
 16627           DFHEIV99
 16628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16629        PERFORM 8400-LOG-JOURNAL-RECORD
 16630     ELSE
 16631        MOVE 'B'                 TO JP-RECORD-TYPE
 16632        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16633        PERFORM 8400-LOG-JOURNAL-RECORD
 16634        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16635        MOVE 'C'                 TO JP-RECORD-TYPE
 16636        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16637
 16638* EXEC CICS REWRITE
 16639*            DATASET    (FILE-ID-ERPNDB)
 16640*            FROM       (PENDING-BUSINESS)
 16641*       END-EXEC
 16642     MOVE LENGTH OF
 16643      PENDING-BUSINESS
 16644       TO DFHEIV11
 16645*    MOVE '&& L                  %   #00014633' TO DFHEIV0
 16646     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16647     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16648     MOVE X'2020233030303134363333' TO DFHEIV0(25:11)
 16649     CALL 'kxdfhei1' USING DFHEIV0,
 16650           FILE-ID-ERPNDB,
 16651           PENDING-BUSINESS,
 16652           DFHEIV11,
 16653           DFHEIV99
 16654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16655        PERFORM 8400-LOG-JOURNAL-RECORD.
 16656
 16657******************************************************************
 16658*                                                                *
 16659*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16660*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16661*                                                                *
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 304
* EL6311.cbl
 16662******************************************************************
 16663
 16664     IF NOT PI-AR-PROCESSING
 16665        GO TO 2480-DELETE-FINISHED.
 16666
 16667     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16668        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16669        NEXT SENTENCE
 16670     ELSE
 16671        GO TO 2480-DELETE-FINISHED.
 16672
 16673
 16674* EXEC CICS HANDLE CONDITION
 16675*         NOTFND    (2480-DELETE-FINISHED)
 16676*    END-EXEC.
 16677*    MOVE '"$I                   ! < #00014655' TO DFHEIV0
 16678     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16679     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16680     MOVE X'3C20233030303134363535' TO DFHEIV0(25:11)
 16681     CALL 'kxdfhei1' USING DFHEIV0
 16682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16683
 16684
 16685     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16686     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16687
 16688
 16689* EXEC CICS READ
 16690*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16691*        DATASET (FILE-ID-ERRQST)
 16692*        RIDFLD  (ERRQST-KEY)
 16693*        UPDATE
 16694*    END-EXEC.
 16695*    MOVE '&"S        EU         (   #00014662' TO DFHEIV0
 16696     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16697     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16698     MOVE X'2020233030303134363632' TO DFHEIV0(25:11)
 16699     CALL 'kxdfhei1' USING DFHEIV0,
 16700           FILE-ID-ERRQST,
 16701           DFHEIV20,
 16702           DFHEIV99,
 16703           ERRQST-KEY,
 16704           DFHEIV99,
 16705           DFHEIV99,
 16706           DFHEIV99
 16707     SET ADDRESS OF AR-REQUEST-RECORD TO
 16708         DFHEIV20
 16709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16710
 16711
 16712     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16713
 16714     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16715
 16716     MOVE 'D'                      TO JP-RECORD-TYPE.
 16717     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16718
 16719
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 305
* EL6311.cbl
 16720* EXEC CICS DELETE
 16721*         DATASET    (FILE-ID-ERRQST)
 16722*    END-EXEC.
 16723*    MOVE '&(                    &   #00014676' TO DFHEIV0
 16724     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16725     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16726     MOVE X'2020233030303134363736' TO DFHEIV0(25:11)
 16727     CALL 'kxdfhei1' USING DFHEIV0,
 16728           FILE-ID-ERRQST,
 16729           DFHEIV99,
 16730           DFHEIV99,
 16731           DFHEIV99,
 16732           DFHEIV99
 16733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16734
 16735
 16736     PERFORM 8400-LOG-JOURNAL-RECORD.
 16737
 16738 2480-DELETE-FINISHED.
 16739     MOVE ZEROS                  TO EMI-ERROR.
 16740     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16741     MOVE LOW-VALUES             TO EL631CI.
 16742     MOVE -1                     TO CMAINTL.
 16743     GO TO 8100-SEND-INITIAL-MAP.
 16744
 16745 2485-BATCH-HDR-NOT-FOUND.
 16746     MOVE -1                     TO CMAINTL
 16747     MOVE AL-UABON               TO CMAINTA.
 16748     MOVE ER-7450                TO EMI-ERROR.
 16749     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16750     GO TO 8200-SEND-DATAONLY.
 16751
 16752 2490-RECORD-NOT-FOUND.
 16753     MOVE -1                     TO CMAINTL
 16754     MOVE AL-UABON               TO CMAINTA.
 16755     MOVE ER-7451                TO EMI-ERROR.
 16756     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16757     GO TO 8200-SEND-DATAONLY.
 16758***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16759***                                                            ***
 16760***     2500  B R O W S E   C H E C K S                        ***
 16761***  We perform this routine from 2 different places.          ***
 16762***  1. If the user changes the refund amount on a cancel, we  ***
 16763***    want to.........                                        ***
 16764***    a. determine if prior checks have been processed        ***
 16765***    b. If the amt is larger, display message instructing    ***
 16766***     them to create another check to make up the difference.***
 16767***    c. If the amt is less, do not allow the change and      ***
 16768***     display a FATAL error suggesting they deal with check  ***
 16769***     records befor continuing.                              ***
 16770***  2. If the user wants to delete a cancel record we......   ***
 16771***    a. browse through all the checks and if there is a      ***
 16772***     processed check, send FATAL message.                   ***
 16773***    b. If there is a non-released check, then delete that   ***
 16774***     check after you delete the pending cancel record.      ***
 16775***                                                            ***
 16776***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16777
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 306
* EL6311.cbl
 16778 2500-browse-checks.
 16779
 16780     perform 2510-startbr-erchek thru 2510-exit
 16781
 16782     if not resp-normal
 16783        go to 2500-exit
 16784     end-if
 16785
 16786     perform until i-say-stop
 16787        perform 2520-readnext-erchek
 16788                                 thru 2520-exit
 16789        if (not resp-normal)
 16790           or (pb-control-by-account (1:33) not =
 16791              ch-control-primary (1:33))
 16792              set i-say-stop to true
 16793        else
 16794           set i-have-a-check-period to true
 16795           if (ch-approval-status) = ' '
 16796              and (ch-void-dt = low-values)
 16797              and (ch-released-dt = low-values)
 16798              set i-have-checks to true
 16799           else
 16800              if ch-void-dt = low-values
 16801                 set i-have-processed-checks to true
 16802              end-if
 16803           end-if
 16804           if (ch-credit-accept-dt = low-values)
 16805              and (ch-void-dt = low-values)
 16806              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16807              if (ch-check-origin-sw not = 'R')
 16808                 and (pb-record-type = '2')
 16809                 continue
 16810              else
 16811                 compute ws-check-amts =
 16812                    ws-check-amts + ch-amount-paid
 16813              end-if
 16814           end-if
 16815        end-if
 16816     end-perform
 16817
 16818     if ws-chek-browse-sw = 'Y'
 16819        perform 2525-endbr-erchek thru 2525-exit
 16820     end-if
 16821
 16822    .
 16823 2500-exit.
 16824     exit.
 16825
 16826 2510-startbr-erchek.
 16827
 16828     move pb-control-by-account  to erchek-key
 16829     move +0                     to chek-record-seq
 16830
 16831
 16832* exec cics startbr
 16833*       dataset   ('ERCHEK')
 16834*       ridfld    (erchek-key)
 16835*       gteq
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 307
* EL6311.cbl
 16836*       resp      (ws-response)
 16837*    end-exec
 16838     MOVE 'ERCHEK' TO DFHEIV1
 16839     MOVE 0
 16840       TO DFHEIV11
 16841*    MOVE '&,         G          &  N#00014775' TO DFHEIV0
 16842     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16843     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16844     MOVE X'204E233030303134373735' TO DFHEIV0(25:11)
 16845     CALL 'kxdfhei1' USING DFHEIV0,
 16846           DFHEIV1,
 16847           erchek-key,
 16848           DFHEIV99,
 16849           DFHEIV11,
 16850           DFHEIV99
 16851     MOVE EIBRESP  TO ws-response
 16852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16853
 16854     IF RESP-NORMAL
 16855        move 'Y'                 to ws-chek-browse-sw
 16856     end-if
 16857
 16858     .
 16859 2510-exit.
 16860     exit.
 16861
 16862 2520-readnext-erchek.
 16863
 16864
 16865* EXEC CICS READNEXT
 16866*       SET     (ADDRESS OF CHECK-RECORDS)
 16867*       DATASET ('ERCHEK')
 16868*       RIDFLD  (ERCHEK-KEY)
 16869*       RESP    (WS-RESPONSE)
 16870*    END-EXEC
 16871     MOVE 'ERCHEK' TO DFHEIV1
 16872     MOVE 0
 16873       TO DFHEIV11
 16874*    MOVE '&.S                   )  N#00014792' TO DFHEIV0
 16875     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16876     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16877     MOVE X'204E233030303134373932' TO DFHEIV0(25:11)
 16878     CALL 'kxdfhei1' USING DFHEIV0,
 16879           DFHEIV1,
 16880           DFHEIV20,
 16881           DFHEIV99,
 16882           ERCHEK-KEY,
 16883           DFHEIV99,
 16884           DFHEIV11,
 16885           DFHEIV99,
 16886           DFHEIV99
 16887     SET ADDRESS OF CHECK-RECORDS TO
 16888         DFHEIV20
 16889     MOVE EIBRESP  TO WS-RESPONSE
 16890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16891
 16892     .
 16893 2520-exit.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 308
* EL6311.cbl
 16894     exit.
 16895
 16896 2525-endbr-erchek.
 16897
 16898
 16899* exec cics endbr
 16900*       dataset  ('ERCHEK')
 16901*    end-exec
 16902     MOVE 'ERCHEK' TO DFHEIV1
 16903     MOVE 0
 16904       TO DFHEIV11
 16905*    MOVE '&2                    $   #00014805' TO DFHEIV0
 16906     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16907     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16908     MOVE X'2020233030303134383035' TO DFHEIV0(25:11)
 16909     CALL 'kxdfhei1' USING DFHEIV0,
 16910           DFHEIV1,
 16911           DFHEIV11,
 16912           DFHEIV99
 16913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16914
 16915     .
 16916 2525-exit.
 16917     exit.
 16918
 16919 2530-readupd-erchek.
 16920
 16921
 16922* EXEC CICS READ
 16923*       UPDATE
 16924*       SET     (ADDRESS OF CHECK-RECORDS)
 16925*       DATASET ('ERCHEK')
 16926*       RIDFLD  (ERCHEK-KEY)
 16927*       RESP    (WS-RESPONSE)
 16928*    END-EXEC
 16929     MOVE 'ERCHEK' TO DFHEIV1
 16930*    MOVE '&"S        EU         (  N#00014815' TO DFHEIV0
 16931     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16932     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16933     MOVE X'204E233030303134383135' TO DFHEIV0(25:11)
 16934     CALL 'kxdfhei1' USING DFHEIV0,
 16935           DFHEIV1,
 16936           DFHEIV20,
 16937           DFHEIV99,
 16938           ERCHEK-KEY,
 16939           DFHEIV99,
 16940           DFHEIV99,
 16941           DFHEIV99
 16942     SET ADDRESS OF CHECK-RECORDS TO
 16943         DFHEIV20
 16944     MOVE EIBRESP  TO WS-RESPONSE
 16945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16946
 16947     .
 16948 2530-exit.
 16949     exit.
 16950
 16951 2540-delete-erchek.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 309
* EL6311.cbl
 16952
 16953
 16954* EXEC CICS DELETE
 16955*       DATASET ('ERCHEK')
 16956*       RESP    (WS-RESPONSE)
 16957*    END-EXEC
 16958     MOVE 'ERCHEK' TO DFHEIV1
 16959*    MOVE '&(                    &  N#00014829' TO DFHEIV0
 16960     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16961     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16962     MOVE X'204E233030303134383239' TO DFHEIV0(25:11)
 16963     CALL 'kxdfhei1' USING DFHEIV0,
 16964           DFHEIV1,
 16965           DFHEIV99,
 16966           DFHEIV99,
 16967           DFHEIV99,
 16968           DFHEIV99
 16969     MOVE EIBRESP  TO WS-RESPONSE
 16970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16971
 16972     .
 16973 2540-exit.
 16974     exit.
 16975***************************************************************
 16976*                                                             *
 16977*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16978*                                                             *
 16979***************************************************************
 16980
 16981***************************************************************
 16982*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16983*     AN ALREADY BILLED RECORD.                               *
 16984***************************************************************
 16985
 16986 2700-BUILD-CORRECTION-RECORD.
 16987     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16988     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16989     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16990     MOVE '5'                    TO DC-OPTION-CODE.
 16991     PERFORM 9700-DATE-LINK.
 16992     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16993
 16994     IF PB-CHG-COUNT = ZEROS
 16995        MOVE +1                  TO WS-SEQ-SAVE
 16996     ELSE
 16997        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16998
 16999     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 17000     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 17001
 17002     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 17003
 17004     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17005     MOVE 'A'                    TO JP-RECORD-TYPE.
 17006     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17007
 17008
 17009* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 310
* EL6311.cbl
 17010*        DATASET    (FILE-ID-ERPNDB)
 17011*        FROM       (PENDING-BUSINESS)
 17012*        RIDFLD     (PB-CONTROL-PRIMARY)
 17013*    END-EXEC.
 17014     MOVE LENGTH OF
 17015      PENDING-BUSINESS
 17016       TO DFHEIV11
 17017*    MOVE '&$ L                  ''   #00014870' TO DFHEIV0
 17018     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17019     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17020     MOVE X'2020233030303134383730' TO DFHEIV0(25:11)
 17021     CALL 'kxdfhei1' USING DFHEIV0,
 17022           FILE-ID-ERPNDB,
 17023           PENDING-BUSINESS,
 17024           DFHEIV11,
 17025           PB-CONTROL-PRIMARY,
 17026           DFHEIV99,
 17027           DFHEIV99
 17028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17029
 17030
 17031     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17032
 17033     PERFORM 8400-LOG-JOURNAL-RECORD.
 17034
 17035 2799-EXIT.
 17036      EXIT.
 17037
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 311
* EL6311.cbl
 17039
 17040******************************************************************
 17041*                                                                *
 17042*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 17043*                                                                *
 17044******************************************************************
 17045
 17046 2800-REWRITE-ISSUE-CERT-KEY.
 17047     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17048
 17049     IF  BCERTNOL GREATER THAN ZEROS
 17050         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 17051
 17052     IF  BSUFIXL  GREATER THAN ZEROS
 17053         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 17054
 17055     IF  BEFFDTL  GREATER THAN ZEROS
 17056         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17057
 17058 2810-READ-BY-ACCOUNT.
 17059
 17060* EXEC CICS HANDLE CONDITION
 17061*         NOTFND    (2820-PROCESS-REWRITE)
 17062*    END-EXEC.
 17063*    MOVE '"$I                   ! = #00014904' TO DFHEIV0
 17064     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17065     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17066     MOVE X'3D20233030303134393034' TO DFHEIV0(25:11)
 17067     CALL 'kxdfhei1' USING DFHEIV0
 17068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17069
 17070
 17071***  read pndb using new key
 17072
 17073* EXEC CICS READ
 17074*        SET     (ADDRESS OF PENDING-BUSINESS)
 17075*        DATASET (FILE-ID-ERPNDB2)
 17076*        RIDFLD  (ERPNDB-ALT-KEY)
 17077*    END-EXEC.
 17078*    MOVE '&"S        E          (   #00014909' TO DFHEIV0
 17079     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17080     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17081     MOVE X'2020233030303134393039' TO DFHEIV0(25:11)
 17082     CALL 'kxdfhei1' USING DFHEIV0,
 17083           FILE-ID-ERPNDB2,
 17084           DFHEIV20,
 17085           DFHEIV99,
 17086           ERPNDB-ALT-KEY,
 17087           DFHEIV99,
 17088           DFHEIV99,
 17089           DFHEIV99
 17090     SET ADDRESS OF PENDING-BUSINESS TO
 17091         DFHEIV20
 17092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17093
 17094
 17095     GO TO 2890-DUPLICATE-RECORD.
 17096
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 312
* EL6311.cbl
 17097  2820-PROCESS-REWRITE.
 17098
 17099* EXEC CICS HANDLE CONDITION
 17100*         NOTFND    (2885-RECORD-MISSING)
 17101*    END-EXEC.
 17102*    MOVE '"$I                   ! > #00014918' TO DFHEIV0
 17103     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17104     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17105     MOVE X'3E20233030303134393138' TO DFHEIV0(25:11)
 17106     CALL 'kxdfhei1' USING DFHEIV0
 17107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17108
 17109
 17110     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17111
 17112***  read pndb using original key
 17113
 17114* EXEC CICS READ
 17115*        SET     (ADDRESS OF PENDING-BUSINESS)
 17116*        DATASET (FILE-ID-ERPNDB)
 17117*        RIDFLD  (ERPNDB-KEY)
 17118*        UPDATE
 17119*    END-EXEC.
 17120*    MOVE '&"S        EU         (   #00014925' TO DFHEIV0
 17121     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17122     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17123     MOVE X'2020233030303134393235' TO DFHEIV0(25:11)
 17124     CALL 'kxdfhei1' USING DFHEIV0,
 17125           FILE-ID-ERPNDB,
 17126           DFHEIV20,
 17127           DFHEIV99,
 17128           ERPNDB-KEY,
 17129           DFHEIV99,
 17130           DFHEIV99,
 17131           DFHEIV99
 17132     SET ADDRESS OF PENDING-BUSINESS TO
 17133         DFHEIV20
 17134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17135
 17136
 17137     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17138     MOVE 'D'                    TO JP-RECORD-TYPE.
 17139     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17140     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17141
 17142     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17143
 17144     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17145     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17146     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17147
 17148***  delete pndb using original key
 17149
 17150* EXEC CICS DELETE
 17151*        DATASET    (FILE-ID-ERPNDB)
 17152*    END-EXEC.
 17153*    MOVE '&(                    &   #00014944' TO DFHEIV0
 17154     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 313
* EL6311.cbl
 17155     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17156     MOVE X'2020233030303134393434' TO DFHEIV0(25:11)
 17157     CALL 'kxdfhei1' USING DFHEIV0,
 17158           FILE-ID-ERPNDB,
 17159           DFHEIV99,
 17160           DFHEIV99,
 17161           DFHEIV99,
 17162           DFHEIV99
 17163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17164
 17165
 17166     PERFORM 8400-LOG-JOURNAL-RECORD.
 17167
 17168
 17169* EXEC CICS GETMAIN
 17170*        SET      (ADDRESS OF PENDING-BUSINESS)
 17171*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17172*        INITIMG  (GETMAIN-SPACE)
 17173*    END-EXEC.
 17174*    MOVE ',"IL                  $   #00014950' TO DFHEIV0
 17175     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17176     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17177     MOVE X'2020233030303134393530' TO DFHEIV0(25:11)
 17178     CALL 'kxdfhei1' USING DFHEIV0,
 17179           DFHEIV20,
 17180           ERPNDB-RECORD-LENGTH,
 17181           GETMAIN-SPACE
 17182     SET ADDRESS OF PENDING-BUSINESS TO
 17183         DFHEIV20
 17184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17185
 17186
 17187***  pending-business now has original record
 17188     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17189
 17190
 17191* EXEC CICS HANDLE CONDITION
 17192*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 17193*    END-EXEC.
 17194*    MOVE '"$I                   ! ? #00014959' TO DFHEIV0
 17195     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17197     MOVE X'3F20233030303134393539' TO DFHEIV0(25:11)
 17198     CALL 'kxdfhei1' USING DFHEIV0
 17199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17200
 17201
 17202***  read elcert using original key
 17203
 17204* EXEC CICS READ
 17205*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17206*        DATASET (FILE-ID-ELCERT)
 17207*        RIDFLD  (ELCERT-KEY)
 17208*        UPDATE
 17209*    END-EXEC.
 17210*    MOVE '&"S        EU         (   #00014964' TO DFHEIV0
 17211     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17212     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 314
* EL6311.cbl
 17213     MOVE X'2020233030303134393634' TO DFHEIV0(25:11)
 17214     CALL 'kxdfhei1' USING DFHEIV0,
 17215           FILE-ID-ELCERT,
 17216           DFHEIV20,
 17217           DFHEIV99,
 17218           ELCERT-KEY,
 17219           DFHEIV99,
 17220           DFHEIV99,
 17221           DFHEIV99
 17222     SET ADDRESS OF CERTIFICATE-MASTER TO
 17223         DFHEIV20
 17224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17225
 17226
 17227     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 17228     MOVE 'B'                    TO JP-RECORD-TYPE
 17229     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17230     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17231
 17232     IF INSURED-ADDR-PRESENT
 17233        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 17234
 17235     IF CERT-NOTES-ARE-NOT-PRESENT
 17236        MOVE SPACE               TO WS-CERT-NOTE-SW
 17237     ELSE
 17238        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 17239
 17240     IF CERT-ADDED-BATCH      OR
 17241        CERT-AND-CLAIM-ONLINE OR
 17242        CERT-WAS-CREATED-FOR-CLAIM
 17243        NEXT SENTENCE
 17244     ELSE
 17245        GO TO 2825-DELETE-CERTIFICATE.
 17246
 17247     PERFORM 8400-LOG-JOURNAL-RECORD.
 17248
 17249*********************************************************
 17250** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 17251     IF CERT-ADDED-BATCH
 17252         GO TO 2822-REWRITE-ELCERT.
 17253*********************************************************
 17254
 17255     IF NO-CLAIM-ATTACHED
 17256        NEXT SENTENCE
 17257     ELSE
 17258        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17259        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17260
 17261 2822-REWRITE-ELCERT.
 17262     MOVE 'C'                    TO JP-RECORD-TYPE
 17263     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17264
 17265     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17266
 17267
 17268* EXEC CICS REWRITE
 17269*         DATASET    (FILE-ID-ELCERT)
 17270*         FROM       (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 315
* EL6311.cbl
 17271*    END-EXEC.
 17272     MOVE LENGTH OF
 17273      CERTIFICATE-MASTER
 17274       TO DFHEIV11
 17275*    MOVE '&& L                  %   #00015011' TO DFHEIV0
 17276     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17277     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17278     MOVE X'2020233030303135303131' TO DFHEIV0(25:11)
 17279     CALL 'kxdfhei1' USING DFHEIV0,
 17280           FILE-ID-ELCERT,
 17281           CERTIFICATE-MASTER,
 17282           DFHEIV11,
 17283           DFHEIV99
 17284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17285
 17286
 17287     PERFORM 8400-LOG-JOURNAL-RECORD.
 17288
 17289     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17290
 17291 2825-DELETE-CERTIFICATE.
 17292     MOVE 'D'                      TO JP-RECORD-TYPE.
 17293     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17294
 17295     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17296
 17297
 17298* EXEC CICS DELETE
 17299*         DATASET    (FILE-ID-ELCERT)
 17300*    END-EXEC.
 17301*    MOVE '&(                    &   #00015026' TO DFHEIV0
 17302     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17303     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17304     MOVE X'2020233030303135303236' TO DFHEIV0(25:11)
 17305     CALL 'kxdfhei1' USING DFHEIV0,
 17306           FILE-ID-ELCERT,
 17307           DFHEIV99,
 17308           DFHEIV99,
 17309           DFHEIV99,
 17310           DFHEIV99
 17311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17312
 17313
 17314     PERFORM 8400-LOG-JOURNAL-RECORD.
 17315
 17316******************************************************************
 17317*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17318******************************************************************
 17319
 17320     IF CERT-NOTES-ARE-PRESENT
 17321        NEXT SENTENCE
 17322     ELSE
 17323        GO TO 2827-DELETE-MAILING.
 17324
 17325
 17326* EXEC CICS HANDLE CONDITION
 17327*         NOTFND  (2827-DELETE-MAILING)
 17328*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 316
* EL6311.cbl
 17329*    MOVE '"$I                   ! @ #00015041' TO DFHEIV0
 17330     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17332     MOVE X'4020233030303135303431' TO DFHEIV0(25:11)
 17333     CALL 'kxdfhei1' USING DFHEIV0
 17334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17335
 17336
 17337
 17338* EXEC CICS READ
 17339*        EQUAL
 17340*        DATASET   (FILE-ID-ERNOTE)
 17341*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17342*        RIDFLD    (ELCERT-KEY)
 17343*        UPDATE
 17344*    END-EXEC.
 17345*    MOVE '&"S        EU         (   #00015045' TO DFHEIV0
 17346     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17347     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17348     MOVE X'2020233030303135303435' TO DFHEIV0(25:11)
 17349     CALL 'kxdfhei1' USING DFHEIV0,
 17350           FILE-ID-ERNOTE,
 17351           DFHEIV20,
 17352           DFHEIV99,
 17353           ELCERT-KEY,
 17354           DFHEIV99,
 17355           DFHEIV99,
 17356           DFHEIV99
 17357     SET ADDRESS OF CERTIFICATE-NOTE TO
 17358         DFHEIV20
 17359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17360
 17361
 17362     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17363     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17364     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17365
 17366     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17367
 17368
 17369* EXEC CICS DELETE
 17370*        DATASET   (FILE-ID-ERNOTE)
 17371*    END-EXEC.
 17372*    MOVE '&(                    &   #00015059' TO DFHEIV0
 17373     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17374     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17375     MOVE X'2020233030303135303539' TO DFHEIV0(25:11)
 17376     CALL 'kxdfhei1' USING DFHEIV0,
 17377           FILE-ID-ERNOTE,
 17378           DFHEIV99,
 17379           DFHEIV99,
 17380           DFHEIV99,
 17381           DFHEIV99
 17382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17383
 17384
 17385     PERFORM 8400-LOG-JOURNAL-RECORD.
 17386
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 317
* EL6311.cbl
 17387******************************************************************
 17388*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17389******************************************************************
 17390
 17391 2827-DELETE-MAILING.
 17392     IF CERT-ADDRESS-PRESENT
 17393        NEXT SENTENCE
 17394     ELSE
 17395        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17396
 17397
 17398* EXEC CICS HANDLE CONDITION
 17399*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17400*    END-EXEC.
 17401*    MOVE '"$I                   ! A #00015075' TO DFHEIV0
 17402     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17403     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17404     MOVE X'4120233030303135303735' TO DFHEIV0(25:11)
 17405     CALL 'kxdfhei1' USING DFHEIV0
 17406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17407
 17408
 17409     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17410
 17411
 17412* EXEC CICS READ
 17413*        EQUAL
 17414*        DATASET   (FILE-ID-ERMAIL)
 17415*        SET       (ADDRESS OF MAILING-DATA)
 17416*        RIDFLD    (ERMAIL-KEY)
 17417*        UPDATE
 17418*    END-EXEC.
 17419*    MOVE '&"S        EU         (   #00015081' TO DFHEIV0
 17420     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17421     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17422     MOVE X'2020233030303135303831' TO DFHEIV0(25:11)
 17423     CALL 'kxdfhei1' USING DFHEIV0,
 17424           FILE-ID-ERMAIL,
 17425           DFHEIV20,
 17426           DFHEIV99,
 17427           ERMAIL-KEY,
 17428           DFHEIV99,
 17429           DFHEIV99,
 17430           DFHEIV99
 17431     SET ADDRESS OF MAILING-DATA TO
 17432         DFHEIV20
 17433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17434
 17435
 17436     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17437     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17438     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17439
 17440     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17441
 17442
 17443* EXEC CICS DELETE
 17444*        DATASET   (FILE-ID-ERMAIL)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 318
* EL6311.cbl
 17445*    END-EXEC.
 17446*    MOVE '&(                    &   #00015095' TO DFHEIV0
 17447     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17448     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17449     MOVE X'2020233030303135303935' TO DFHEIV0(25:11)
 17450     CALL 'kxdfhei1' USING DFHEIV0,
 17451           FILE-ID-ERMAIL,
 17452           DFHEIV99,
 17453           DFHEIV99,
 17454           DFHEIV99,
 17455           DFHEIV99
 17456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17457
 17458
 17459     PERFORM 8400-LOG-JOURNAL-RECORD.
 17460
 17461 2830-BUILD-NEW-ISSUE-RECORD.
 17462     MOVE SPACES                 TO ELCERT-KEY.
 17463
 17464     IF  BCERTNOL GREATER THAN ZEROS
 17465         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17466
 17467     IF  BSUFIXL  GREATER THAN ZEROS
 17468         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17469
 17470     IF BEFFDTL GREATER THAN ZEROS
 17471        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17472
 17473 2870-WRITE-PENDING-BUSINESS.
 17474     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17475     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17476     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17477     MOVE '5'                    TO DC-OPTION-CODE.
 17478     PERFORM 9700-DATE-LINK.
 17479     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17480
 17481     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17482
 17483     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17484     MOVE 'A'                    TO JP-RECORD-TYPE.
 17485     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17486
 17487
 17488* EXEC CICS WRITE
 17489*        DATASET  (FILE-ID-ERPNDB)
 17490*        FROM     (PENDING-BUSINESS)
 17491*        RIDFLD   (PB-CONTROL-PRIMARY)
 17492*    END-EXEC.
 17493     MOVE LENGTH OF
 17494      PENDING-BUSINESS
 17495       TO DFHEIV11
 17496*    MOVE '&$ L                  ''   #00015127' TO DFHEIV0
 17497     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17498     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17499     MOVE X'2020233030303135313237' TO DFHEIV0(25:11)
 17500     CALL 'kxdfhei1' USING DFHEIV0,
 17501           FILE-ID-ERPNDB,
 17502           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 319
* EL6311.cbl
 17503           DFHEIV11,
 17504           PB-CONTROL-PRIMARY,
 17505           DFHEIV99,
 17506           DFHEIV99
 17507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17508
 17509
 17510     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17511
 17512     PERFORM 8400-LOG-JOURNAL-RECORD.
 17513
 17514     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17515
 17516 2885-RECORD-MISSING.
 17517     MOVE -1                     TO BMAINTL
 17518     MOVE AL-UABON               TO BMAINTA
 17519     MOVE ER-2902                TO EMI-ERROR.
 17520     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17521     GO TO 8200-SEND-DATAONLY.
 17522
 17523 2890-DUPLICATE-RECORD.
 17524     MOVE -1                     TO BMAINTL.
 17525     MOVE AL-UABON               TO BCERTNOA.
 17526     MOVE AL-UNBON               TO BEFFDTA.
 17527     MOVE SPACE                  TO BMAINTI.
 17528
 17529     MOVE 1                      TO EMI-SUB
 17530                                    EMI-SWITCH1
 17531                                    EMI-SWITCH-AREA-1
 17532                                    EMI-SWITCH-AREA-2.
 17533
 17534     MOVE SPACES                 TO EMI-ERROR-LINES.
 17535
 17536
 17537* EXEC CICS SYNCPOINT ROLLBACK
 17538*    END-EXEC.
 17539*    MOVE '6"R                   !   #00015159' TO DFHEIV0
 17540     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17541     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17542     MOVE X'2020233030303135313539' TO DFHEIV0(25:11)
 17543     CALL 'kxdfhei1' USING DFHEIV0
 17544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17545
 17546
 17547     MOVE ER-2247                TO EMI-ERROR.
 17548     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17549     GO TO 8200-SEND-DATAONLY.
 17550
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 320
* EL6311.cbl
 17552
 17553******************************************************************
 17554*                                                                *
 17555*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17556*                                                                *
 17557******************************************************************
 17558
 17559 2900-REWRITE-CAN-CERT-KEY.
 17560     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17561
 17562     IF  CCERTNOL GREATER THAN ZEROS
 17563         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17564
 17565     IF  CSUFIXL  GREATER THAN ZEROS
 17566         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17567
 17568     IF  CEFFDTL  GREATER THAN ZEROS
 17569         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17570
 17571 2910-READ-BY-ACCOUNT.
 17572
 17573* EXEC CICS HANDLE CONDITION
 17574*         NOTFND    (2920-PROCESS-REWRITE)
 17575*    END-EXEC.
 17576*    MOVE '"$I                   ! B #00015187' TO DFHEIV0
 17577     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17578     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17579     MOVE X'4220233030303135313837' TO DFHEIV0(25:11)
 17580     CALL 'kxdfhei1' USING DFHEIV0
 17581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17582
 17583
 17584
 17585* EXEC CICS READ
 17586*        SET     (ADDRESS OF PENDING-BUSINESS)
 17587*        DATASET (FILE-ID-ERPNDB2)
 17588*        RIDFLD  (ERPNDB-ALT-KEY)
 17589*    END-EXEC.
 17590*    MOVE '&"S        E          (   #00015191' TO DFHEIV0
 17591     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17592     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17593     MOVE X'2020233030303135313931' TO DFHEIV0(25:11)
 17594     CALL 'kxdfhei1' USING DFHEIV0,
 17595           FILE-ID-ERPNDB2,
 17596           DFHEIV20,
 17597           DFHEIV99,
 17598           ERPNDB-ALT-KEY,
 17599           DFHEIV99,
 17600           DFHEIV99,
 17601           DFHEIV99
 17602     SET ADDRESS OF PENDING-BUSINESS TO
 17603         DFHEIV20
 17604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17605
 17606
 17607     GO TO 2990-DUPLICATE-RECORD.
 17608
 17609  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 321
* EL6311.cbl
 17610
 17611* EXEC CICS HANDLE CONDITION
 17612*         NOTFND    (2985-RECORD-MISSING)
 17613*    END-EXEC.
 17614*    MOVE '"$I                   ! C #00015200' TO DFHEIV0
 17615     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17616     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17617     MOVE X'4320233030303135323030' TO DFHEIV0(25:11)
 17618     CALL 'kxdfhei1' USING DFHEIV0
 17619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17620
 17621
 17622     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17623
 17624
 17625* EXEC CICS READ
 17626*        SET     (ADDRESS OF PENDING-BUSINESS)
 17627*        DATASET (FILE-ID-ERPNDB)
 17628*        RIDFLD  (ERPNDB-KEY)
 17629*        UPDATE
 17630*    END-EXEC.
 17631*    MOVE '&"S        EU         (   #00015206' TO DFHEIV0
 17632     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17633     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17634     MOVE X'2020233030303135323036' TO DFHEIV0(25:11)
 17635     CALL 'kxdfhei1' USING DFHEIV0,
 17636           FILE-ID-ERPNDB,
 17637           DFHEIV20,
 17638           DFHEIV99,
 17639           ERPNDB-KEY,
 17640           DFHEIV99,
 17641           DFHEIV99,
 17642           DFHEIV99
 17643     SET ADDRESS OF PENDING-BUSINESS TO
 17644         DFHEIV20
 17645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17646
 17647
 17648     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17649     MOVE 'D'                    TO JP-RECORD-TYPE.
 17650     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17651     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17652
 17653     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17654
 17655     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17656     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17657     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17658
 17659
 17660* EXEC CICS DELETE
 17661*        DATASET    (FILE-ID-ERPNDB)
 17662*    END-EXEC.
 17663*    MOVE '&(                    &   #00015224' TO DFHEIV0
 17664     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17665     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17666     MOVE X'2020233030303135323234' TO DFHEIV0(25:11)
 17667     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 322
* EL6311.cbl
 17668           FILE-ID-ERPNDB,
 17669           DFHEIV99,
 17670           DFHEIV99,
 17671           DFHEIV99,
 17672           DFHEIV99
 17673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17674
 17675
 17676     PERFORM 8400-LOG-JOURNAL-RECORD.
 17677
 17678
 17679* EXEC CICS GETMAIN
 17680*        SET      (ADDRESS OF PENDING-BUSINESS)
 17681*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17682*        INITIMG  (GETMAIN-SPACE)
 17683*    END-EXEC.
 17684*    MOVE ',"IL                  $   #00015230' TO DFHEIV0
 17685     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17686     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17687     MOVE X'2020233030303135323330' TO DFHEIV0(25:11)
 17688     CALL 'kxdfhei1' USING DFHEIV0,
 17689           DFHEIV20,
 17690           ERPNDB-RECORD-LENGTH,
 17691           GETMAIN-SPACE
 17692     SET ADDRESS OF PENDING-BUSINESS TO
 17693         DFHEIV20
 17694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17695
 17696
 17697     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17698
 17699 2950-PROCESS-CANCELS.
 17700
 17701
 17702* EXEC CICS HANDLE CONDITION
 17703*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17704*    END-EXEC.
 17705*    MOVE '"$I                   ! D #00015240' TO DFHEIV0
 17706     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17707     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17708     MOVE X'4420233030303135323430' TO DFHEIV0(25:11)
 17709     CALL 'kxdfhei1' USING DFHEIV0
 17710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17711
 17712
 17713
 17714* EXEC CICS READ
 17715*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17716*        DATASET (FILE-ID-ELCERT)
 17717*        RIDFLD  (ELCERT-KEY)
 17718*        UPDATE
 17719*    END-EXEC.
 17720*    MOVE '&"S        EU         (   #00015244' TO DFHEIV0
 17721     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17722     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17723     MOVE X'2020233030303135323434' TO DFHEIV0(25:11)
 17724     CALL 'kxdfhei1' USING DFHEIV0,
 17725           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 323
* EL6311.cbl
 17726           DFHEIV20,
 17727           DFHEIV99,
 17728           ELCERT-KEY,
 17729           DFHEIV99,
 17730           DFHEIV99,
 17731           DFHEIV99
 17732     SET ADDRESS OF CERTIFICATE-MASTER TO
 17733         DFHEIV20
 17734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17735
 17736
 17737     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17738
 17739     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17740     MOVE 'B'                      TO JP-RECORD-TYPE.
 17741     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17742     PERFORM 8400-LOG-JOURNAL-RECORD.
 17743
 17744     IF PB-CI-LIVES NOT NUMERIC
 17745         MOVE ZERO                    TO PB-CI-LIVES.
 17746
 17747     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17748        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17749        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17750        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17751                                         CM-LF-CANCEL-DT
 17752     ELSE
 17753        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17754        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17755        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17756        MOVE PB-CI-LIVES              TO CM-LIVES.
 17757
 17758     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17759        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17760            MOVE CM-LF-STATUS-AT-CANCEL
 17761                                     TO CM-LF-CURRENT-STATUS
 17762            MOVE SPACE
 17763                                     TO CM-LF-STATUS-AT-CANCEL
 17764        ELSE
 17765            MOVE PB-CI-LF-POLICY-STATUS
 17766                                     TO CM-LF-CURRENT-STATUS
 17767     ELSE
 17768        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17769
 17770     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17771        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17772        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17773        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17774                                         CM-AH-CANCEL-DT
 17775     ELSE
 17776        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17777        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17778        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17779        MOVE PB-CI-LIVES              TO CM-LIVES.
 17780
 17781     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17782        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17783            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 324
* EL6311.cbl
 17784                                     TO CM-AH-CURRENT-STATUS
 17785            MOVE SPACE
 17786                                     TO CM-AH-STATUS-AT-CANCEL
 17787        ELSE
 17788            MOVE PB-CI-AH-POLICY-STATUS
 17789                                     TO CM-AH-CURRENT-STATUS
 17790     ELSE
 17791        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17792
 17793 2975-REWRITE-CERT.
 17794     MOVE 'C'                      TO JP-RECORD-TYPE.
 17795     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17796
 17797
 17798* EXEC CICS REWRITE
 17799*        DATASET    (FILE-ID-ELCERT)
 17800*        FROM       (CERTIFICATE-MASTER)
 17801*    END-EXEC.
 17802     MOVE LENGTH OF
 17803      CERTIFICATE-MASTER
 17804       TO DFHEIV11
 17805*    MOVE '&& L                  %   #00015311' TO DFHEIV0
 17806     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17807     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17808     MOVE X'2020233030303135333131' TO DFHEIV0(25:11)
 17809     CALL 'kxdfhei1' USING DFHEIV0,
 17810           FILE-ID-ELCERT,
 17811           CERTIFICATE-MASTER,
 17812           DFHEIV11,
 17813           DFHEIV99
 17814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17815
 17816
 17817     PERFORM 8400-LOG-JOURNAL-RECORD.
 17818
 17819 2960-BUILD-NEW-CANCEL-RECORD.
 17820     IF  CCERTNOL GREATER THAN ZEROS
 17821         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17822
 17823     IF  CSUFIXL  GREATER THAN ZEROS
 17824         MOVE CSUFIXI             TO PB-CERT-SFX.
 17825
 17826     IF  CEFFDTL  GREATER  THAN ZEROS
 17827         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17828
 17829 2970-WRITE-PENDING-BUSINESS.
 17830     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17831     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17832     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17833     MOVE '5'                    TO DC-OPTION-CODE.
 17834     PERFORM 9700-DATE-LINK.
 17835     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17836
 17837     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17838
 17839     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17840                                    PB-CI-INSURED-SEX
 17841                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 325
* EL6311.cbl
 17842                                    PB-CI-AH-BENEFIT-CD
 17843                                    PB-CI-RATE-CLASS
 17844                                    PB-CI-RATE-DEV-LF
 17845                                    PB-CI-RATE-DEV-AH
 17846                                    PB-CI-LF-ABBR
 17847                                    PB-CI-AH-ABBR
 17848                                    PB-CI-OB-FLAG
 17849                                    PB-CI-LF-POLICY-STATUS
 17850                                    PB-CI-AH-POLICY-STATUS
 17851                                    PB-CI-INDV-GRP-CD
 17852                                    PB-CI-BENEFICIARY-NAME
 17853                                    PB-CI-NOTE-SW
 17854                                    PB-CI-SOC-SEC-NO
 17855                                    PB-CI-MEMBER-NO
 17856                                    PB-CI-INT-CODE
 17857                                    PB-CI-COMP-EXCP-SW
 17858                                    PB-CI-ENTRY-STATUS
 17859                                    PB-CI-CREDIT-INTERFACE-SW-1
 17860                                    PB-CI-CREDIT-INTERFACE-SW-2
 17861                                    PB-CI-ENTRY-BATCH.
 17862
 17863     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17864                                    PB-CI-AH-SETTLEMENT-DT
 17865                                    PB-CI-DEATH-DT
 17866                                    PB-CI-LF-PRIOR-CANCEL-DT
 17867                                    PB-CI-AH-PRIOR-CANCEL-DT
 17868                                    PB-CI-LOAN-1ST-PMT-DT
 17869                                    PB-CI-ENTRY-DT
 17870                                    PB-CI-LF-EXPIRE-DT
 17871                                    PB-CI-AH-EXPIRE-DT.
 17872
 17873     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17874                                    PB-CI-LF-TERM
 17875                                    PB-CI-LF-BENEFIT-AMT
 17876                                    PB-CI-LF-ALT-BENEFIT-AMT
 17877                                    PB-CI-LF-PREMIUM-AMT
 17878                                    PB-CI-LF-ALT-PREMIUM-AMT
 17879                                    PB-CI-AH-TERM
 17880                                    PB-CI-AH-BENEFIT-AMT
 17881                                    PB-CI-AH-PREMIUM-AMT
 17882                                    PB-CI-RATE-DEV-PCT-LF
 17883                                    PB-CI-RATE-DEV-PCT-AH
 17884                                    PB-CI-LIFE-COMMISSION
 17885                                    PB-CI-AH-COMMISSION
 17886                                    PB-CI-PAY-FREQUENCY
 17887                                    PB-CI-LOAN-APR
 17888                                    PB-CI-LOAN-TERM
 17889                                    PB-CI-CURR-SEQ
 17890                                    PB-CI-AH-CANCEL-AMT
 17891                                    PB-CI-LF-CANCEL-AMT
 17892                                    PB-CI-EXTENTION-DAYS
 17893                                    PB-CI-TERM-IN-DAYS
 17894                                    PB-CI-LOAN-OFFICER
 17895                                    PB-CI-LIVES
 17896                                    PB-CI-LF-CRIT-PER
 17897                                    PB-CI-AH-CRIT-PER
 17898                                    PB-C-LF-REM-TERM
 17899                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 326
* EL6311.cbl
 17900
 17901     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17902     MOVE 'A'                    TO JP-RECORD-TYPE.
 17903     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17904
 17905
 17906* EXEC CICS HANDLE CONDITION
 17907*        DUPREC   (2990-DUPLICATE-RECORD)
 17908*    END-EXEC.
 17909*    MOVE '"$%                   ! E #00015404' TO DFHEIV0
 17910     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17911     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17912     MOVE X'4520233030303135343034' TO DFHEIV0(25:11)
 17913     CALL 'kxdfhei1' USING DFHEIV0
 17914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17915
 17916
 17917
 17918* EXEC CICS WRITE
 17919*        DATASET  (FILE-ID-ERPNDB)
 17920*        FROM     (PENDING-BUSINESS)
 17921*        RIDFLD   (PB-CONTROL-PRIMARY)
 17922*    END-EXEC.
 17923     MOVE LENGTH OF
 17924      PENDING-BUSINESS
 17925       TO DFHEIV11
 17926*    MOVE '&$ L                  ''   #00015408' TO DFHEIV0
 17927     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17928     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17929     MOVE X'2020233030303135343038' TO DFHEIV0(25:11)
 17930     CALL 'kxdfhei1' USING DFHEIV0,
 17931           FILE-ID-ERPNDB,
 17932           PENDING-BUSINESS,
 17933           DFHEIV11,
 17934           PB-CONTROL-PRIMARY,
 17935           DFHEIV99,
 17936           DFHEIV99
 17937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17938
 17939
 17940     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17941
 17942     PERFORM 8400-LOG-JOURNAL-RECORD.
 17943
 17944     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17945
 17946 2985-RECORD-MISSING.
 17947     MOVE -1                     TO CMAINTL
 17948     MOVE AL-UABON               TO CMAINTA.
 17949
 17950     MOVE ER-2902                TO EMI-ERROR.
 17951     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17952     GO TO 8200-SEND-DATAONLY.
 17953
 17954 2990-DUPLICATE-RECORD.
 17955     MOVE SPACE                  TO CMAINTI.
 17956     MOVE -1                     TO CMAINTL.
 17957     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 327
* EL6311.cbl
 17958     MOVE AL-UNBON               TO CEFFDTA.
 17959
 17960     MOVE 1                      TO EMI-SUB
 17961                                    EMI-SWITCH1
 17962                                    EMI-SWITCH-AREA-1
 17963                                    EMI-SWITCH-AREA-2.
 17964     MOVE SPACES                 TO EMI-ERROR-LINES.
 17965
 17966
 17967* EXEC CICS SYNCPOINT ROLLBACK
 17968*    END-EXEC.
 17969*    MOVE '6"R                   !   #00015440' TO DFHEIV0
 17970     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17971     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17972     MOVE X'2020233030303135343430' TO DFHEIV0(25:11)
 17973     CALL 'kxdfhei1' USING DFHEIV0
 17974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17975
 17976
 17977     MOVE ER-2247                TO EMI-ERROR.
 17978     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17979     GO TO 8200-SEND-DATAONLY.
 17980
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 328
* EL6311.cbl
 17982
 17983***************************************************************
 17984*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17985*     PREMIUM FOR A SINGLE BATCH.                             *
 17986*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17987***************************************************************
 17988
 17989 3000-BATCH-MAINLINE.
 17990     IF PI-PREV-KEY NOT = SPACES
 17991         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17992     ELSE
 17993         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17994
 17995     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17996
 17997 3010-READNEXT.
 17998
 17999* EXEC CICS READ
 18000*         DATASET    (FILE-ID-ERPNDB)
 18001*         SET        (ADDRESS OF PENDING-BUSINESS)
 18002*         RIDFLD     (ERPNDB-KEY)
 18003*         GTEQ
 18004*    END-EXEC.
 18005*    MOVE '&"S        G          (   #00015464' TO DFHEIV0
 18006     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18007     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18008     MOVE X'2020233030303135343634' TO DFHEIV0(25:11)
 18009     CALL 'kxdfhei1' USING DFHEIV0,
 18010           FILE-ID-ERPNDB,
 18011           DFHEIV20,
 18012           DFHEIV99,
 18013           ERPNDB-KEY,
 18014           DFHEIV99,
 18015           DFHEIV99,
 18016           DFHEIV99
 18017     SET ADDRESS OF PENDING-BUSINESS TO
 18018         DFHEIV20
 18019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18020
 18021
 18022     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 18023        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 18024          GO TO 3030-END-BATCH.
 18025
 18026     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 18027
 18028     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 18029        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 18030          GO TO 3020-BUMP-SEQ.
 18031
 18032     IF PB-ISSUE
 18033        ADD +1                   TO WS-ISS-TOTAL-CNT
 18034        IF PB-FATAL-ERRORS
 18035           ADD +1                      TO WS-ISS-FATAL-CNT
 18036           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18037           GO TO 3020-BUMP-SEQ
 18038        ELSE
 18039           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 329
* EL6311.cbl
 18040              ADD +1                      TO WS-ISS-FORCE-CNT
 18041              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18042              GO TO 3020-BUMP-SEQ
 18043           ELSE
 18044              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18045                 ADD +1                      TO WS-ISS-HOLD-CNT
 18046                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18047                 GO TO 3020-BUMP-SEQ
 18048              ELSE
 18049                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 18050                     THRU  3299-EXIT
 18051                 GO TO 3020-BUMP-SEQ.
 18052
 18053     IF PB-CANCELLATION
 18054        ADD +1                   TO WS-CAN-TOTAL-CNT
 18055        IF PB-FATAL-ERRORS
 18056           ADD +1                 TO WS-CAN-FATAL-CNT
 18057           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18058           GO TO 3020-BUMP-SEQ
 18059        ELSE
 18060           IF PB-UNFORCED-ERRORS
 18061              ADD +1                 TO WS-CAN-FORCE-CNT
 18062              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18063              GO TO 3020-BUMP-SEQ
 18064           ELSE
 18065              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18066                 ADD +1                 TO WS-CAN-HOLD-CNT
 18067                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18068                 GO TO 3020-BUMP-SEQ
 18069              ELSE
 18070                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 18071                     THRU  3499-EXIT
 18072                 GO TO 3020-BUMP-SEQ.
 18073
 18074     IF PB-BATCH-TRAILER
 18075         GO TO 3030-END-BATCH.
 18076
 18077 3020-BUMP-SEQ.
 18078     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 18079     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18080     GO TO 3010-READNEXT.
 18081
 18082 3030-END-BATCH.
 18083     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 18084     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 18085     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 18086     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 18087
 18088     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18089                                          - WS-ISS-FORCE-CNT
 18090                                          - WS-ISS-HOLD-CNT).
 18091
 18092     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 18093     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 18094
 18095     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 18096     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 18097     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 330
* EL6311.cbl
 18098     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 18099     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18100                                          - WS-CAN-FORCE-CNT
 18101                                          - WS-CAN-HOLD-CNT).
 18102     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 18103     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 18104
 18105     COMPUTE WS-NET-TOTAL-CNT
 18106         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 18107     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 18108     COMPUTE WS-NET-FATAL-CNT
 18109         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 18110     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 18111     COMPUTE WS-NET-FORCE-CNT
 18112         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 18113     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 18114     COMPUTE WS-NET-HOLD-CNT
 18115         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 18116     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 18117
 18118     COMPUTE WS-NET-AVAIL-CNT
 18119          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18120                              - WS-ISS-FORCE-CNT
 18121                              - WS-ISS-HOLD-CNT)
 18122          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18123                              - WS-CAN-FORCE-CNT
 18124                              - WS-CAN-HOLD-CNT).
 18125     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 18126
 18127     COMPUTE WS-NET-GOOD-PREM
 18128         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 18129     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 18130     COMPUTE WS-NET-BAD-PREM
 18131         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 18132     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 18133
 18134     MOVE 0000                   TO EMI-ERROR.
 18135     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18136     MOVE -1                     TO DPFENTRL.
 18137     GO TO 8200-SEND-DATAONLY.
 18138
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 331
* EL6311.cbl
 18140
 18141******************************************************************
 18142*                                                                *
 18143*           A D D    B A D   I S S U E   P R E M I U M           *
 18144*                                                                *
 18145******************************************************************
 18146
 18147 3100-ADD-BAD-ISSUE-PREM.
 18148     IF PB-OVERRIDE-LIFE
 18149       OR PB-OVERRIDE-BOTH
 18150           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18151           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18152       ELSE
 18153           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18154           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18155
 18156     IF PB-OVERRIDE-AH
 18157       OR PB-OVERRIDE-BOTH
 18158           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18159       ELSE
 18160           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18161
 18162 3199-EXIT.
 18163     EXIT.
 18164
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 332
* EL6311.cbl
 18166
 18167******************************************************************
 18168*                                                                *
 18169*       A D D   G O O D   I S S U E   P R E M I U M              *
 18170*                                                                *
 18171******************************************************************
 18172
 18173 3200-ADD-GOOD-ISSUE-PREM.
 18174     IF PB-OVERRIDE-LIFE
 18175       OR PB-OVERRIDE-BOTH
 18176           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18177           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18178       ELSE
 18179           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18180           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18181
 18182     IF PB-OVERRIDE-AH
 18183       OR PB-OVERRIDE-BOTH
 18184           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18185       ELSE
 18186           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18187
 18188 3299-EXIT.
 18189     EXIT.
 18190
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 333
* EL6311.cbl
 18192
 18193
 18194******************************************************************
 18195*                                                                *
 18196*        A D D   B A D   C A N C E L   P R E M I U M             *
 18197*                                                                *
 18198******************************************************************
 18199
 18200 3300-ADD-BAD-CANCEL-PREM.
 18201     IF PB-OVERRIDE-LIFE
 18202       OR PB-OVERRIDE-BOTH
 18203           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18204       ELSE
 18205           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18206
 18207     IF PB-OVERRIDE-AH
 18208       OR PB-OVERRIDE-BOTH
 18209           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18210       ELSE
 18211           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18212
 18213 3399-EXIT.
 18214     EXIT.
 18215
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 334
* EL6311.cbl
 18217
 18218******************************************************************
 18219*                                                                *
 18220*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18221*                                                                *
 18222******************************************************************
 18223
 18224 3400-ADD-GOOD-CANCEL-PREM.
 18225     IF PB-OVERRIDE-LIFE
 18226       OR PB-OVERRIDE-BOTH
 18227           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18228       ELSE
 18229           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18230
 18231     IF PB-OVERRIDE-AH
 18232       OR PB-OVERRIDE-BOTH
 18233           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18234       ELSE
 18235           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18236
 18237 3499-EXIT.
 18238     EXIT.
 18239
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 335
* EL6311.cbl
 18241
 18242******************************************************************
 18243*                                                                *
 18244*           E D I T   B A T C H   D A T A                        *
 18245*                                                                *
 18246******************************************************************
 18247
 18248 3500-EDIT-BATCH-DATA.
 18249     IF PI-PREV-KEY NOT = SPACES
 18250        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18251     ELSE
 18252        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18253
 18254     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18255     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18256
 18257
 18258* EXEC CICS HANDLE CONDITION
 18259*         NOTFND      (3590-NOT-FOUND)
 18260*    END-EXEC.
 18261*    MOVE '"$I                   ! F #00015706' TO DFHEIV0
 18262     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18263     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18264     MOVE X'4620233030303135373036' TO DFHEIV0(25:11)
 18265     CALL 'kxdfhei1' USING DFHEIV0
 18266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18267
 18268
 18269     IF DRISSL   GREATER THAN ZEROS OR
 18270        DRISSL   GREATER THAN ZEROS OR
 18271        DRLFPRML GREATER THAN ZEROS OR
 18272        DRAHPRML GREATER THAN ZEROS OR
 18273        DRCANCL  GREATER THAN ZEROS OR
 18274        DRLFRFDL GREATER THAN ZEROS OR
 18275        DRAHRFDL GREATER THAN ZEROS
 18276              NEXT SENTENCE
 18277          ELSE
 18278              MOVE ER-3224    TO EMI-ERROR
 18279              MOVE -1         TO DPFENTRL
 18280              MOVE AL-UNBON   TO DPFENTRA
 18281              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18282              GO TO 8200-SEND-DATAONLY.
 18283
 18284     IF NOT MODIFY-CAP
 18285         MOVE 'UPDATE'       TO SM-READ
 18286         PERFORM 9995-SECURITY-VIOLATION
 18287         MOVE ER-0070        TO EMI-ERROR
 18288         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18289         GO TO 8100-SEND-INITIAL-MAP.
 18290
 18291        IF DRISSL GREATER THAN ZEROS
 18292           MOVE AL-UNNON         TO DRISSA
 18293           MOVE DRISSI           TO DEEDIT-FIELD
 18294           PERFORM 8600-DEEDIT
 18295           IF DEEDIT-FIELD-V0  NUMERIC
 18296              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18297           ELSE
 18298              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 336
* EL6311.cbl
 18299              MOVE -1         TO DRISSL
 18300              MOVE AL-UNBON   TO DRISSA
 18301              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18302
 18303        IF DRLFPRML GREATER THAN ZEROS
 18304           MOVE AL-UNNON         TO DRLFPRMA
 18305
 18306* EXEC CICS BIF DEEDIT
 18307*              FIELD  (DRLFPRMI)
 18308*              LENGTH (11)
 18309*          END-EXEC
 18310     MOVE 11
 18311       TO DFHEIV11
 18312*    MOVE '@"L                   #   #00015746' TO DFHEIV0
 18313     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18314     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18315     MOVE X'2020233030303135373436' TO DFHEIV0(25:11)
 18316     CALL 'kxdfhei1' USING DFHEIV0,
 18317           DRLFPRMI,
 18318           DFHEIV11
 18319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18320           IF DRLFPRMI NUMERIC
 18321              MOVE DRLFPRMI   TO WS-DRLFPRM
 18322*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18323*          PERFORM 8600-DEEDIT
 18324*          IF DEEDIT-FIELD-V2  NUMERIC
 18325*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18326           ELSE
 18327              MOVE ER-2223    TO EMI-ERROR
 18328              MOVE -1         TO DRLFPRML
 18329              MOVE AL-UNBON   TO DRLFPRMA
 18330              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18331
 18332        IF DRAHPRML GREATER THAN ZEROS
 18333           MOVE AL-UNNON         TO DRAHPRMA
 18334
 18335* EXEC CICS BIF DEEDIT
 18336*              FIELD  (DRAHPRMI)
 18337*              LENGTH (11)
 18338*          END-EXEC
 18339     MOVE 11
 18340       TO DFHEIV11
 18341*    MOVE '@"L                   #   #00015764' TO DFHEIV0
 18342     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18343     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18344     MOVE X'2020233030303135373634' TO DFHEIV0(25:11)
 18345     CALL 'kxdfhei1' USING DFHEIV0,
 18346           DRAHPRMI,
 18347           DFHEIV11
 18348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18349           IF DRAHPRMI NUMERIC
 18350              MOVE DRAHPRMI   TO WS-DRAHPRM
 18351*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18352*          PERFORM 8600-DEEDIT
 18353*          IF DEEDIT-FIELD-V2  NUMERIC
 18354*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18355           ELSE
 18356              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 337
* EL6311.cbl
 18357              MOVE -1         TO DRAHPRML
 18358              MOVE AL-UNBON   TO DRAHPRMA
 18359              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18360
 18361        IF DRCANCL GREATER THAN ZEROS
 18362           MOVE AL-UNNON         TO DRCANCA
 18363           MOVE DRCANCI          TO DEEDIT-FIELD
 18364           PERFORM 8600-DEEDIT
 18365           IF DEEDIT-FIELD-V0  NUMERIC
 18366              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18367           ELSE
 18368              MOVE ER-2223    TO EMI-ERROR
 18369              MOVE -1         TO DRCANCL
 18370              MOVE AL-UNBON   TO DRCANCL
 18371              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18372
 18373        IF DRLFRFDL GREATER THAN ZEROS
 18374           MOVE AL-UNNON         TO DRLFRFDA
 18375
 18376* EXEC CICS BIF DEEDIT
 18377*              FIELD  (DRLFRFDI)
 18378*              LENGTH (11)
 18379*          END-EXEC
 18380     MOVE 11
 18381       TO DFHEIV11
 18382*    MOVE '@"L                   #   #00015794' TO DFHEIV0
 18383     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18384     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18385     MOVE X'2020233030303135373934' TO DFHEIV0(25:11)
 18386     CALL 'kxdfhei1' USING DFHEIV0,
 18387           DRLFRFDI,
 18388           DFHEIV11
 18389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18390           IF DRLFRFDI NUMERIC
 18391              MOVE DRLFRFDI   TO WS-DRLFRFD
 18392*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18393*          PERFORM 8600-DEEDIT
 18394*          IF DEEDIT-FIELD-V2  NUMERIC
 18395*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18396           ELSE
 18397              MOVE ER-2223    TO EMI-ERROR
 18398              MOVE -1         TO DRLFRFDL
 18399              MOVE AL-UNBON   TO DRLFRFDA
 18400              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18401
 18402        IF DRAHRFDL GREATER THAN ZEROS
 18403           MOVE AL-UNNON         TO DRAHRFDA
 18404
 18405* EXEC CICS BIF DEEDIT
 18406*              FIELD  (DRAHRFDI)
 18407*              LENGTH (11)
 18408*          END-EXEC
 18409     MOVE 11
 18410       TO DFHEIV11
 18411*    MOVE '@"L                   #   #00015812' TO DFHEIV0
 18412     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18413     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18414     MOVE X'2020233030303135383132' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 338
* EL6311.cbl
 18415     CALL 'kxdfhei1' USING DFHEIV0,
 18416           DRAHRFDI,
 18417           DFHEIV11
 18418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18419           IF DRAHRFDI NUMERIC
 18420              MOVE DRAHRFDI   TO WS-DRAHRFD
 18421*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18422*          PERFORM 8600-DEEDIT
 18423*          IF DEEDIT-FIELD-V2  NUMERIC
 18424*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18425           ELSE
 18426              MOVE ER-2223    TO EMI-ERROR
 18427              MOVE -1         TO DRAHRFDL
 18428              MOVE AL-UNBON   TO DRAHRFDA
 18429              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18430
 18431     IF EMI-ERROR = ZEROS
 18432        GO 3600-UPDATE-BATCH-HEADER.
 18433
 18434     GO TO 8200-SEND-DATAONLY.
 18435
 18436 3590-NOT-FOUND.
 18437     MOVE ER-2192                TO EMI-ERROR.
 18438     MOVE -1                     TO DPFENTRL.
 18439     MOVE AL-UNBON               TO DPFENTRA.
 18440     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18441     GO TO 8200-SEND-DATAONLY.
 18442
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 339
* EL6311.cbl
 18444
 18445******************************************************************
 18446*                                                                *
 18447*           U P D A T E   B A T C H   H E A D E R                *
 18448*                                                                *
 18449******************************************************************
 18450
 18451 3600-UPDATE-BATCH-HEADER.
 18452
 18453* EXEC CICS HANDLE CONDITION
 18454*         NOTFND      (3690-NOT-FOUND)
 18455*    END-EXEC.
 18456*    MOVE '"$I                   ! G #00015849' TO DFHEIV0
 18457     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18458     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18459     MOVE X'4720233030303135383439' TO DFHEIV0(25:11)
 18460     CALL 'kxdfhei1' USING DFHEIV0
 18461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18462
 18463
 18464
 18465* EXEC CICS READ
 18466*        DATASET (FILE-ID-ERPNDB)
 18467*        RIDFLD  (ERPNDB-KEY)
 18468*        SET     (ADDRESS OF PENDING-BUSINESS)
 18469*        UPDATE
 18470*    END-EXEC.
 18471*    MOVE '&"S        EU         (   #00015853' TO DFHEIV0
 18472     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18473     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18474     MOVE X'2020233030303135383533' TO DFHEIV0(25:11)
 18475     CALL 'kxdfhei1' USING DFHEIV0,
 18476           FILE-ID-ERPNDB,
 18477           DFHEIV20,
 18478           DFHEIV99,
 18479           ERPNDB-KEY,
 18480           DFHEIV99,
 18481           DFHEIV99,
 18482           DFHEIV99
 18483     SET ADDRESS OF PENDING-BUSINESS TO
 18484         DFHEIV20
 18485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18486
 18487
 18488     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18489     MOVE 'B'                    TO JP-RECORD-TYPE.
 18490     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18491
 18492     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18493
 18494     PERFORM 8400-LOG-JOURNAL-RECORD.
 18495
 18496     IF DRISSL GREATER THAN ZEROS
 18497        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18498
 18499     IF DRCANCL GREATER THAN ZEROS
 18500        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18501
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 340
* EL6311.cbl
 18502
 18503     IF DRLFPRML GREATER THAN ZEROS
 18504        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18505
 18506     IF DRAHPRML GREATER THAN ZEROS
 18507        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18508
 18509     IF DRLFRFDL GREATER THAN ZEROS
 18510        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18511
 18512     IF DRAHRFDL GREATER THAN ZEROS
 18513        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18514
 18515 3670-REWRITE-BATCH-HEADER.
 18516     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18517        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18518        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18519        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18520        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18521        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18522        MOVE SPACE               TO PB-OUT-BAL-CD
 18523     ELSE
 18524        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18525
 18526     MOVE 'C'                    TO JP-RECORD-TYPE.
 18527     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18528
 18529
 18530* EXEC CICS REWRITE
 18531*         DATASET      (FILE-ID-ERPNDB)
 18532*         FROM         (PENDING-BUSINESS)
 18533*    END-EXEC.
 18534     MOVE LENGTH OF
 18535      PENDING-BUSINESS
 18536       TO DFHEIV11
 18537*    MOVE '&& L                  %   #00015901' TO DFHEIV0
 18538     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18539     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18540     MOVE X'2020233030303135393031' TO DFHEIV0(25:11)
 18541     CALL 'kxdfhei1' USING DFHEIV0,
 18542           FILE-ID-ERPNDB,
 18543           PENDING-BUSINESS,
 18544           DFHEIV11,
 18545           DFHEIV99
 18546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18547
 18548
 18549     PERFORM 8400-LOG-JOURNAL-RECORD.
 18550
 18551     GO TO 7200-DISPLAY-BATCHES.
 18552
 18553 3690-NOT-FOUND.
 18554     MOVE ER-2192                TO EMI-ERROR.
 18555     MOVE -1                     TO DPFENTRL.
 18556     MOVE AL-UNBON               TO DPFENTRA.
 18557     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18558     GO TO 8200-SEND-DATAONLY.
 18559
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 341
* EL6311.cbl
 18561
 18562******************************************************************
 18563*                                                                *
 18564*           R E - D I S P L A Y   R E C O R D                    *
 18565*                                                                *
 18566******************************************************************
 18567
 18568 3900-RE-DISPLAY-RECORD.
 18569
 18570* EXEC CICS HANDLE CONDITION
 18571*         NOTFND   (3990-NOT-FOUND)
 18572*    END-EXEC.
 18573*    MOVE '"$I                   ! H #00015926' TO DFHEIV0
 18574     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18575     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18576     MOVE X'4820233030303135393236' TO DFHEIV0(25:11)
 18577     CALL 'kxdfhei1' USING DFHEIV0
 18578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18579
 18580
 18581     IF PI-DISPLAY-ORIGINAL-BATCH
 18582         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18583     ELSE
 18584         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18585
 18586
 18587* EXEC CICS READ
 18588*         DATASET   (FILE-ID)
 18589*         RIDFLD    (PI-PREV-KEY)
 18590*         SET       (ADDRESS OF PENDING-BUSINESS)
 18591*    END-EXEC.
 18592*    MOVE '&"S        E          (   #00015935' TO DFHEIV0
 18593     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18594     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18595     MOVE X'2020233030303135393335' TO DFHEIV0(25:11)
 18596     CALL 'kxdfhei1' USING DFHEIV0,
 18597           FILE-ID,
 18598           DFHEIV20,
 18599           DFHEIV99,
 18600           PI-PREV-KEY,
 18601           DFHEIV99,
 18602           DFHEIV99,
 18603           DFHEIV99
 18604     SET ADDRESS OF PENDING-BUSINESS TO
 18605         DFHEIV20
 18606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18607
 18608
 18609     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18610
 18611     IF PB-ISSUE
 18612         GO TO 7000-DISPLAY-ISSUES.
 18613
 18614     IF PB-CANCELLATION
 18615         GO TO 7100-DISPLAY-CANCELS.
 18616
 18617     IF PB-BATCH-TRAILER
 18618         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 342
* EL6311.cbl
 18619
 18620 3990-NOT-FOUND.
 18621     MOVE LOW-VALUES             TO EL631BI.
 18622
 18623     IF PI-MAP-NAME = EL631B
 18624         MOVE -1                  TO BMAINTL
 18625     ELSE
 18626         MOVE -1                  TO CMAINTL.
 18627
 18628     GO TO 8100-SEND-INITIAL-MAP.
 18629
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 343
* EL6311.cbl
 18631
 18632***************************************************************
 18633*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18634*                                                             *
 18635*      1. START BROWSE WITH                                   *
 18636*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18637*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18638*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18639*                                                             *
 18640*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18641*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18642*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18643*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18644*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18645*               AND IS IT TO BE DISPLAYED.                    *
 18646*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18647*               DISPLAYED.                                    *
 18648*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18649*               DISPLAYED.                                    *
 18650*                                                             *
 18651*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18652*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18653***************************************************************
 18654
 18655 4000-BROWSE-DETAIL-FORWARD.
 18656     IF FIRST-TIME
 18657        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18658     ELSE
 18659        IF SHOW-RECORD
 18660           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18661           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18662           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18663           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18664           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18665        ELSE
 18666           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18667
 18668
 18669* EXEC CICS HANDLE CONDITION
 18670*         NOTFND   (4050-END-RECORDS)
 18671*         ENDFILE  (4050-END-RECORDS)
 18672*    END-EXEC.
 18673*    MOVE '"$I''                  ! I #00016000' TO DFHEIV0
 18674     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18675     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18676     MOVE X'4920233030303136303030' TO DFHEIV0(25:11)
 18677     CALL 'kxdfhei1' USING DFHEIV0
 18678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18679
 18680
 18681
 18682* EXEC CICS STARTBR
 18683*         DATASET   (FILE-ID-ERPNDB2)
 18684*         RIDFLD    (ERPNDB-ALT-KEY)
 18685*    END-EXEC.
 18686     MOVE 0
 18687       TO DFHEIV11
 18688*    MOVE '&,         G          &   #00016005' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 344
* EL6311.cbl
 18689     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18690     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18691     MOVE X'2020233030303136303035' TO DFHEIV0(25:11)
 18692     CALL 'kxdfhei1' USING DFHEIV0,
 18693           FILE-ID-ERPNDB2,
 18694           ERPNDB-ALT-KEY,
 18695           DFHEIV99,
 18696           DFHEIV11,
 18697           DFHEIV99
 18698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18699
 18700
 18701     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18702
 18703     IF FIRST-TIME OR SHOW-RECORD
 18704        MOVE SPACE               TO WS-FIRST-TIME-SW
 18705        GO TO 4005-READ-NEXT-RECORD.
 18706
 18707
 18708* EXEC CICS READNEXT
 18709*         DATASET    (FILE-ID-ERPNDB2)
 18710*         SET        (ADDRESS OF PENDING-BUSINESS)
 18711*         RIDFLD     (ERPNDB-ALT-KEY)
 18712*    END-EXEC.
 18713     MOVE 0
 18714       TO DFHEIV11
 18715*    MOVE '&.S                   )   #00016016' TO DFHEIV0
 18716     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18717     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18718     MOVE X'2020233030303136303136' TO DFHEIV0(25:11)
 18719     CALL 'kxdfhei1' USING DFHEIV0,
 18720           FILE-ID-ERPNDB2,
 18721           DFHEIV20,
 18722           DFHEIV99,
 18723           ERPNDB-ALT-KEY,
 18724           DFHEIV99,
 18725           DFHEIV11,
 18726           DFHEIV99,
 18727           DFHEIV99
 18728     SET ADDRESS OF PENDING-BUSINESS TO
 18729         DFHEIV20
 18730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18731
 18732
 18733 4005-READ-NEXT-RECORD.
 18734
 18735* EXEC CICS READNEXT
 18736*         DATASET    (FILE-ID-ERPNDB2)
 18737*         SET        (ADDRESS OF PENDING-BUSINESS)
 18738*         RIDFLD     (ERPNDB-ALT-KEY)
 18739*    END-EXEC.
 18740     MOVE 0
 18741       TO DFHEIV11
 18742*    MOVE '&.S                   )   #00016023' TO DFHEIV0
 18743     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18744     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18745     MOVE X'2020233030303136303233' TO DFHEIV0(25:11)
 18746     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 345
* EL6311.cbl
 18747           FILE-ID-ERPNDB2,
 18748           DFHEIV20,
 18749           DFHEIV99,
 18750           ERPNDB-ALT-KEY,
 18751           DFHEIV99,
 18752           DFHEIV11,
 18753           DFHEIV99,
 18754           DFHEIV99
 18755     SET ADDRESS OF PENDING-BUSINESS TO
 18756         DFHEIV20
 18757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18758
 18759
 18760     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18761
 18762     IF WS-BATCH-PREFIX = '#CL'
 18763        GO TO 4005-READ-NEXT-RECORD.
 18764
 18765     IF SHOW-RECORD
 18766        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18767           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18768           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18769           PB-STATE         NOT = PI-PB-STATE          OR
 18770           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18771           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18772           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18773           GO TO 4050-END-RECORDS
 18774        ELSE
 18775           GO TO 4010-CHECK-REC-TYPE.
 18776
 18777     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18778        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18779        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18780        PB-STATE            NOT = PI-PB-STATE          OR
 18781        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18782        GO TO 4050-END-RECORDS.
 18783
 18784     IF PB-BATCH-TRAILER
 18785        GO TO 4005-READ-NEXT-RECORD.
 18786
 18787     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18788        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18789           GO TO 4005-READ-NEXT-RECORD
 18790        ELSE
 18791           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18792              GO TO 4010-CHECK-REC-TYPE
 18793           ELSE
 18794              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18795                 GO TO 4010-CHECK-REC-TYPE
 18796              ELSE
 18797                 GO TO 4005-READ-NEXT-RECORD.
 18798
 18799     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18800        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18801           GO TO 4005-READ-NEXT-RECORD.
 18802
 18803 4010-CHECK-REC-TYPE.
 18804     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 346
* EL6311.cbl
 18805         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18806             NEXT SENTENCE
 18807         ELSE
 18808             GO TO 4005-READ-NEXT-RECORD.
 18809
 18810     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18811         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18812             NEXT SENTENCE
 18813        ELSE
 18814             GO TO 4005-READ-NEXT-RECORD.
 18815
 18816     IF NOT DISPLAY-CHANGE-RECORDS AND
 18817            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18818        GO TO 4005-READ-NEXT-RECORD.
 18819
 18820     IF DISPLAY-HOLD-RECORDS AND
 18821        NOT PB-RECORD-ON-HOLD
 18822          GO TO 4005-READ-NEXT-RECORD.
 18823
 18824     IF PB-ISSUE
 18825        IF DISPLAY-CHK-REQ-RECORDS
 18826            GO TO 4005-READ-NEXT-RECORD.
 18827
 18828     IF PB-ISSUE
 18829        IF ISSUE-WITH-WARNING
 18830           IF PB-WARNING-ERRORS
 18831              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18832                  GO TO 4005-READ-NEXT-RECORD
 18833              ELSE
 18834                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18835                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18836                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18837                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18838                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18839                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18840                 GO TO 7000-DISPLAY-ISSUES
 18841           ELSE
 18842              GO TO 4005-READ-NEXT-RECORD.
 18843
 18844     IF PB-ISSUE
 18845        IF (ISSUES-IN-ERROR AND
 18846            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18847            ALL-ISSUES
 18848            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18849            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18850            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18851            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18852            MOVE PB-SV-STATE            TO PI-SV-STATE
 18853            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18854            GO TO 7000-DISPLAY-ISSUES
 18855        ELSE
 18856            GO TO 4005-READ-NEXT-RECORD.
 18857
 18858     IF PB-CANCELLATION
 18859        IF DISPLAY-CHK-REQ-RECORDS
 18860           IF PB-C-REFUND-REQUESTED
 18861              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18862              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 347
* EL6311.cbl
 18863              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18864              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18865              MOVE PB-SV-STATE            TO PI-SV-STATE
 18866              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18867              GO TO 7100-DISPLAY-CANCELS
 18868           ELSE
 18869               GO TO 4005-READ-NEXT-RECORD.
 18870
 18871     IF PB-CANCELLATION
 18872        IF CANCEL-WITH-WARNING
 18873           IF PB-WARNING-ERRORS
 18874              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18875                  GO TO 4005-READ-NEXT-RECORD
 18876              ELSE
 18877                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18878                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18879                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18880                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18881                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18882                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18883                 GO TO 7100-DISPLAY-CANCELS
 18884           ELSE
 18885              GO TO 4005-READ-NEXT-RECORD.
 18886
 18887     IF PB-CANCELLATION
 18888        IF (CANCEL-IN-ERROR  AND
 18889            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18890            ALL-CANCELS
 18891            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18892            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18893            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18894            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18895            MOVE PB-SV-STATE            TO PI-SV-STATE
 18896            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18897            GO TO 7100-DISPLAY-CANCELS.
 18898
 18899     GO TO 4005-READ-NEXT-RECORD.
 18900
 18901 4050-END-RECORDS.
 18902******************************************************************
 18903*                                                                *
 18904*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18905*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18906*         PROGRAM.                                               *
 18907*                                                                *
 18908******************************************************************
 18909
 18910     IF BROWSE-STARTED
 18911        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18912
 18913* EXEC CICS ENDBR
 18914*            DATASET  (FILE-ID-ERPNDB2)
 18915*       END-EXEC.
 18916     MOVE 0
 18917       TO DFHEIV11
 18918*    MOVE '&2                    $   #00016181' TO DFHEIV0
 18919     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18920     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 348
* EL6311.cbl
 18921     MOVE X'2020233030303136313831' TO DFHEIV0(25:11)
 18922     CALL 'kxdfhei1' USING DFHEIV0,
 18923           FILE-ID-ERPNDB2,
 18924           DFHEIV11,
 18925           DFHEIV99
 18926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18927
 18928
 18929     IF  EIBTRNID NOT = TRANS-EXB1
 18930         IF PENDING-BUS-RECS-FOUND
 18931             NEXT SENTENCE
 18932           ELSE
 18933             MOVE '9'            TO PI-BROWSE-SW
 18934             GO TO 9400-CLEAR.
 18935
 18936     IF SHOW-RECORD
 18937        MOVE ER-2253            TO EMI-ERROR
 18938       ELSE
 18939        MOVE ER-2254            TO EMI-ERROR.
 18940
 18941     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18942
 18943     IF PI-MAP-NAME = SPACES
 18944        MOVE -1                  TO DPFENTRL
 18945        MOVE EL631D               TO PI-MAP-NAME
 18946        GO TO 8100-SEND-INITIAL-MAP.
 18947
 18948     IF PI-MAP-NAME = EL631B
 18949        MOVE -1                  TO BMAINTL
 18950     ELSE
 18951        IF PI-MAP-NAME = EL631C
 18952           MOVE -1               TO CMAINTL
 18953        ELSE
 18954           MOVE -1               TO DPFENTRL.
 18955
 18956     GO TO 8200-SEND-DATAONLY.
 18957
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 349
* EL6311.cbl
 18959
 18960***************************************************************
 18961*                                                             *
 18962*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18963*                                                             *
 18964*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18965*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18966*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18967*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18968*                                                             *
 18969*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18970*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18971*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18972*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18973*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18974*                AND IS IT TO BE DISPLAYED.                   *
 18975*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18976*                DISPLAYED.                                   *
 18977*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18978*                DISPLAYED.                                   *
 18979*                                                             *
 18980*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18981*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18982*                                                             *
 18983*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18984*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18985*                THEY ARE NOT TO BE DISPLAYED.                *
 18986*                                                             *
 18987***************************************************************
 18988
 18989 4100-BROWSE-PRIMARY-FORWARD.
 18990     IF FIRST-TIME  OR SHOW-RECORD
 18991        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18992        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18993        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18994     ELSE
 18995        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18996        IF ERPNDB-BATCH-SEQ-NO = +9999
 18997           GO TO 4150-END-BATCH
 18998        ELSE
 18999           IF DISPLAY-CHANGE-RECORDS
 19000              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19001           ELSE
 19002              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19003              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19004
 19005     IF FIRST-TIME
 19006         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 19007            PI-PB-BATCH-SEQ-NO NOT = ZERO
 19008              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 19009
 19010
 19011* EXEC CICS HANDLE CONDITION
 19012*         ENDFILE  (4150-END-BATCH)
 19013*    END-EXEC.
 19014*    MOVE '"$''                   ! J #00016266' TO DFHEIV0
 19015     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 19016     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 350
* EL6311.cbl
 19017     MOVE X'4A20233030303136323636' TO DFHEIV0(25:11)
 19018     CALL 'kxdfhei1' USING DFHEIV0
 19019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19020
 19021
 19022 4105-READ-NEXT.
 19023
 19024* EXEC CICS HANDLE CONDITION
 19025*         NOTFND    (4150-END-BATCH)
 19026*    END-EXEC.
 19027*    MOVE '"$I                   ! K #00016271' TO DFHEIV0
 19028     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19029     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19030     MOVE X'4B20233030303136323731' TO DFHEIV0(25:11)
 19031     CALL 'kxdfhei1' USING DFHEIV0
 19032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19033
 19034
 19035     MOVE SPACES                 TO WS-REC-FOUND-SW.
 19036
 19037     IF PI-DISPLAY-ORIGINAL-BATCH
 19038        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19039     ELSE
 19040        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19041
 19042
 19043* EXEC CICS READ
 19044*         DATASET   (FILE-ID)
 19045*         SET       (ADDRESS OF PENDING-BUSINESS)
 19046*         RIDFLD    (ERPNDB-KEY)
 19047*         GTEQ
 19048*    END-EXEC.
 19049*    MOVE '&"S        G          (   #00016282' TO DFHEIV0
 19050     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19051     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19052     MOVE X'2020233030303136323832' TO DFHEIV0(25:11)
 19053     CALL 'kxdfhei1' USING DFHEIV0,
 19054           FILE-ID,
 19055           DFHEIV20,
 19056           DFHEIV99,
 19057           ERPNDB-KEY,
 19058           DFHEIV99,
 19059           DFHEIV99,
 19060           DFHEIV99
 19061     SET ADDRESS OF PENDING-BUSINESS TO
 19062         DFHEIV20
 19063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19064
 19065
 19066     IF PI-DISPLAY-ORIGINAL-BATCH
 19067        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19068           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19069           GO TO 4150-END-BATCH
 19070        ELSE
 19071           IF PB-BATCH-TRAILER
 19072              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 19073              GO TO 4105-READ-NEXT
 19074           ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 351
* EL6311.cbl
 19075              NEXT SENTENCE
 19076     ELSE
 19077        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19078           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19079           GO TO 4150-END-BATCH.
 19080
 19081     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19082
 19083     IF WS-BATCH-PREFIX = '#CL'
 19084         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19085         GO TO 4105-READ-NEXT.
 19086
 19087     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19088     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19089     MOVE PB-STATE               TO PI-PB-STATE.
 19090     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19091
 19092     IF PB-BATCH-TRAILER
 19093        IF SHOW-RECORD
 19094           GO TO 4150-END-BATCH
 19095        ELSE
 19096           MOVE ER-2251         TO EMI-ERROR
 19097           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19098           MOVE 1               TO PI-BROWSE-TYPE
 19099           GO TO 7200-DISPLAY-BATCHES.
 19100
 19101     IF SHOW-RECORD
 19102           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19103              GO TO 4110-BUMP-SEQ
 19104           ELSE
 19105              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19106                 GO TO 4110-BUMP-SEQ
 19107              ELSE
 19108                 GO TO 4107-CHECK-REC-TYPE.
 19109
 19110     IF NOT  PI-PRIMARY-WITH-SELECT
 19111        GO TO 4107-CHECK-REC-TYPE.
 19112
 19113     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19114        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19115           GO TO 4110-BUMP-SEQ
 19116        ELSE
 19117           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19118              GO TO 4107-CHECK-REC-TYPE
 19119           ELSE
 19120              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19121                 GO TO 4107-CHECK-REC-TYPE
 19122              ELSE
 19123                 GO TO 4110-BUMP-SEQ.
 19124
 19125     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19126        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19127           GO TO 4110-BUMP-SEQ.
 19128
 19129 4107-CHECK-REC-TYPE.
 19130     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19131         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19132             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 352
* EL6311.cbl
 19133           ELSE
 19134             GO TO 4110-BUMP-SEQ.
 19135
 19136     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19137         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19138             NEXT SENTENCE
 19139           ELSE
 19140             GO TO 4110-BUMP-SEQ.
 19141
 19142     IF NOT DISPLAY-CHANGE-RECORDS AND
 19143        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19144           GO TO 4110-BUMP-SEQ.
 19145
 19146     IF DISPLAY-HOLD-RECORDS AND
 19147        NOT PB-RECORD-ON-HOLD
 19148          GO TO 4110-BUMP-SEQ.
 19149
 19150     IF PB-ISSUE
 19151        IF DISPLAY-CHK-REQ-RECORDS
 19152            GO TO 4110-BUMP-SEQ.
 19153
 19154     IF PB-ISSUE
 19155        IF ISSUE-WITH-WARNING
 19156           IF PB-WARNING-ERRORS
 19157              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19158                  GO TO 4110-BUMP-SEQ
 19159              ELSE
 19160                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19161                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19162                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19163                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19164                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19165                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19166                 GO TO 7000-DISPLAY-ISSUES
 19167        ELSE
 19168            GO TO 4110-BUMP-SEQ.
 19169
 19170     IF PB-ISSUE
 19171        IF (ISSUES-IN-ERROR AND
 19172            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19173            ALL-ISSUES
 19174            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19175            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19176            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19177            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19178            MOVE PB-SV-STATE            TO PI-SV-STATE
 19179            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19180            GO TO 7000-DISPLAY-ISSUES
 19181        ELSE
 19182            GO TO 4110-BUMP-SEQ.
 19183
 19184     IF PB-CANCELLATION
 19185        IF DISPLAY-CHK-REQ-RECORDS
 19186           IF PB-C-REFUND-REQUESTED
 19187              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19188              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19189              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19190              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 353
* EL6311.cbl
 19191              MOVE PB-SV-STATE            TO PI-SV-STATE
 19192              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19193              GO TO 7100-DISPLAY-CANCELS
 19194           ELSE
 19195              GO TO 4110-BUMP-SEQ.
 19196
 19197     IF PB-CANCELLATION
 19198        IF CANCEL-WITH-WARNING
 19199           IF PB-WARNING-ERRORS
 19200              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19201                  GO TO 4110-BUMP-SEQ
 19202              ELSE
 19203                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19204                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19205                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19206                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19207                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19208                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19209                 GO TO 7100-DISPLAY-CANCELS
 19210           ELSE
 19211              GO TO 4110-BUMP-SEQ.
 19212
 19213     IF PB-CANCELLATION
 19214        IF (CANCEL-IN-ERROR  AND
 19215            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19216            ALL-CANCELS
 19217            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19218            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19219            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19220            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19221            MOVE PB-SV-STATE            TO PI-SV-STATE
 19222            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19223            GO TO 7100-DISPLAY-CANCELS.
 19224
 19225 4110-BUMP-SEQ.
 19226     IF NOT DISPLAY-CHANGE-RECORDS
 19227        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19228        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19229     ELSE
 19230        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19231           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19232           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19233        ELSE
 19234           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19235           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19236
 19237     GO TO 4105-READ-NEXT.
 19238
 19239 4150-END-BATCH.
 19240******************************************************************
 19241*                                                                *
 19242*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19243*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19244*         PROGRAM.                                               *
 19245*                                                                *
 19246******************************************************************
 19247
 19248     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 354
* EL6311.cbl
 19249         IF PENDING-BUS-RECS-FOUND
 19250             NEXT SENTENCE
 19251           ELSE
 19252             MOVE '9'            TO PI-BROWSE-SW
 19253             GO TO 9400-CLEAR.
 19254
 19255     IF SHOW-RECORD
 19256        MOVE ER-2253             TO EMI-ERROR
 19257     ELSE
 19258        MOVE ER-2251             TO EMI-ERROR.
 19259
 19260     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19261
 19262     IF PI-MAP-NAME = SPACES
 19263        MOVE -1                  TO BMAINTL
 19264        MOVE EL631B              TO PI-MAP-NAME
 19265        GO TO 8100-SEND-INITIAL-MAP.
 19266
 19267     IF PI-MAP-NAME = EL631B
 19268        MOVE -1                  TO BMAINTL
 19269     ELSE
 19270        IF PI-MAP-NAME = EL631C
 19271           MOVE -1               TO CMAINTL
 19272        ELSE
 19273           MOVE -1               TO DPFENTRL.
 19274
 19275     GO TO 8200-SEND-DATAONLY.
 19276
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 355
* EL6311.cbl
 19278
 19279***************************************************************
 19280*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19281*                                                             *
 19282*      1. START BROWSE WITH                                   *
 19283*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19284*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19285*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19286*                                                             *
 19287*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19288*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19289*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19290*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19291*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19292*               AND IS IT TO BE DISPLAYED.                    *
 19293*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19294*               DISPLAYED.                                    *
 19295*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19296*               DISPLAYED.                                    *
 19297*                                                             *
 19298*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19299*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19300***************************************************************
 19301
 19302 4200-BROWSE-CSR-FORWARD.
 19303
 19304     IF FIRST-TIME
 19305        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19306     ELSE
 19307        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19308
 19309
 19310* EXEC CICS HANDLE CONDITION
 19311*         NOTFND   (4250-END-RECORDS)
 19312*         ENDFILE  (4250-END-RECORDS)
 19313*    END-EXEC.
 19314*    MOVE '"$I''                  ! L #00016532' TO DFHEIV0
 19315     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19316     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19317     MOVE X'4C20233030303136353332' TO DFHEIV0(25:11)
 19318     CALL 'kxdfhei1' USING DFHEIV0
 19319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19320
 19321
 19322
 19323* EXEC CICS STARTBR
 19324*         DATASET   (FILE-ID-ERPNDB4)
 19325*         RIDFLD    (ERPNDB-CSR-KEY)
 19326*    END-EXEC.
 19327     MOVE 0
 19328       TO DFHEIV11
 19329*    MOVE '&,         G          &   #00016537' TO DFHEIV0
 19330     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19331     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19332     MOVE X'2020233030303136353337' TO DFHEIV0(25:11)
 19333     CALL 'kxdfhei1' USING DFHEIV0,
 19334           FILE-ID-ERPNDB4,
 19335           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 356
* EL6311.cbl
 19336           DFHEIV99,
 19337           DFHEIV11,
 19338           DFHEIV99
 19339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19340
 19341
 19342     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19343
 19344     IF FIRST-TIME
 19345        MOVE SPACE               TO WS-FIRST-TIME-SW
 19346        GO TO 4205-READ-NEXT-RECORD.
 19347
 19348
 19349* EXEC CICS READNEXT
 19350*         DATASET    (FILE-ID-ERPNDB4)
 19351*         SET        (ADDRESS OF PENDING-BUSINESS)
 19352*         RIDFLD     (ERPNDB-CSR-KEY)
 19353*    END-EXEC.
 19354     MOVE 0
 19355       TO DFHEIV11
 19356*    MOVE '&.S                   )   #00016548' TO DFHEIV0
 19357     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19358     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19359     MOVE X'2020233030303136353438' TO DFHEIV0(25:11)
 19360     CALL 'kxdfhei1' USING DFHEIV0,
 19361           FILE-ID-ERPNDB4,
 19362           DFHEIV20,
 19363           DFHEIV99,
 19364           ERPNDB-CSR-KEY,
 19365           DFHEIV99,
 19366           DFHEIV11,
 19367           DFHEIV99,
 19368           DFHEIV99
 19369     SET ADDRESS OF PENDING-BUSINESS TO
 19370         DFHEIV20
 19371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19372
 19373
 19374 4205-READ-NEXT-RECORD.
 19375
 19376
 19377* EXEC CICS READNEXT
 19378*         DATASET    (FILE-ID-ERPNDB4)
 19379*         SET        (ADDRESS OF PENDING-BUSINESS)
 19380*         RIDFLD     (ERPNDB-CSR-KEY)
 19381*    END-EXEC.
 19382     MOVE 0
 19383       TO DFHEIV11
 19384*    MOVE '&.S                   )   #00016556' TO DFHEIV0
 19385     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19386     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19387     MOVE X'2020233030303136353536' TO DFHEIV0(25:11)
 19388     CALL 'kxdfhei1' USING DFHEIV0,
 19389           FILE-ID-ERPNDB4,
 19390           DFHEIV20,
 19391           DFHEIV99,
 19392           ERPNDB-CSR-KEY,
 19393           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 357
* EL6311.cbl
 19394           DFHEIV11,
 19395           DFHEIV99,
 19396           DFHEIV99
 19397     SET ADDRESS OF PENDING-BUSINESS TO
 19398         DFHEIV20
 19399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19400
 19401
 19402     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19403
 19404     IF WS-BATCH-PREFIX = '#CL'
 19405        GO TO 4205-READ-NEXT-RECORD.
 19406
 19407     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19408        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19409        GO TO 4250-END-RECORDS.
 19410
 19411     IF PB-BATCH-TRAILER
 19412        GO TO 4205-READ-NEXT-RECORD.
 19413
 19414     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19415        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19416           GO TO 4205-READ-NEXT-RECORD
 19417        ELSE
 19418           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19419              GO TO 4210-CHECK-REC-TYPE
 19420           ELSE
 19421              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19422                 GO TO 4210-CHECK-REC-TYPE
 19423              ELSE
 19424                 GO TO 4205-READ-NEXT-RECORD.
 19425
 19426     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19427        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19428           GO TO 4205-READ-NEXT-RECORD.
 19429
 19430 4210-CHECK-REC-TYPE.
 19431     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19432         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19433             NEXT SENTENCE
 19434         ELSE
 19435             GO TO 4205-READ-NEXT-RECORD.
 19436
 19437     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19438         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19439             NEXT SENTENCE
 19440        ELSE
 19441             GO TO 4205-READ-NEXT-RECORD.
 19442
 19443     IF NOT DISPLAY-CHANGE-RECORDS AND
 19444            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19445        GO TO 4205-READ-NEXT-RECORD.
 19446
 19447     IF DISPLAY-HOLD-RECORDS AND
 19448        NOT PB-RECORD-ON-HOLD
 19449          GO TO 4205-READ-NEXT-RECORD.
 19450
 19451     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 358
* EL6311.cbl
 19452        IF DISPLAY-CHK-REQ-RECORDS
 19453            GO TO 4205-READ-NEXT-RECORD.
 19454
 19455     IF PB-ISSUE
 19456        IF ISSUE-WITH-WARNING
 19457           IF PB-WARNING-ERRORS
 19458              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19459                  GO TO 4205-READ-NEXT-RECORD
 19460              ELSE
 19461                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19462                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19463                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19464                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19465                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19466                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19467                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19468                 GO TO 7000-DISPLAY-ISSUES
 19469           ELSE
 19470              GO TO 4205-READ-NEXT-RECORD.
 19471
 19472     IF PB-ISSUE
 19473        IF (ISSUES-IN-ERROR AND
 19474            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19475            ALL-ISSUES
 19476            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19477            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19478            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19479            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19480            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19481            MOVE PB-SV-STATE            TO PI-SV-STATE
 19482            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19483            GO TO 7000-DISPLAY-ISSUES
 19484        ELSE
 19485            GO TO 4205-READ-NEXT-RECORD.
 19486
 19487     IF PB-CANCELLATION
 19488        IF DISPLAY-CHK-REQ-RECORDS
 19489           IF PB-C-REFUND-REQUESTED
 19490              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19491              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19492              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19493              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19494              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19495              MOVE PB-SV-STATE            TO PI-SV-STATE
 19496              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19497              GO TO 7100-DISPLAY-CANCELS
 19498           ELSE
 19499               GO TO 4205-READ-NEXT-RECORD.
 19500
 19501     IF PB-CANCELLATION
 19502        IF CANCEL-WITH-WARNING
 19503           IF PB-WARNING-ERRORS
 19504              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19505                  GO TO 4205-READ-NEXT-RECORD
 19506              ELSE
 19507                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19508                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19509                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 359
* EL6311.cbl
 19510                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19511                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19512                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19513                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19514                 GO TO 7100-DISPLAY-CANCELS
 19515           ELSE
 19516              GO TO 4205-READ-NEXT-RECORD.
 19517
 19518     IF PB-CANCELLATION
 19519        IF (CANCEL-IN-ERROR  AND
 19520            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19521            ALL-CANCELS
 19522            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19523            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19524            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19525            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19526            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19527            MOVE PB-SV-STATE            TO PI-SV-STATE
 19528            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19529            GO TO 7100-DISPLAY-CANCELS.
 19530
 19531     GO TO 4205-READ-NEXT-RECORD.
 19532
 19533 4250-END-RECORDS.
 19534******************************************************************
 19535*                                                                *
 19536*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19537*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19538*         PROGRAM.                                               *
 19539*                                                                *
 19540******************************************************************
 19541
 19542     IF BROWSE-STARTED
 19543        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19544
 19545* EXEC CICS ENDBR
 19546*            DATASET  (FILE-ID-ERPNDB4)
 19547*       END-EXEC.
 19548     MOVE 0
 19549       TO DFHEIV11
 19550*    MOVE '&2                    $   #00016704' TO DFHEIV0
 19551     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19552     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19553     MOVE X'2020233030303136373034' TO DFHEIV0(25:11)
 19554     CALL 'kxdfhei1' USING DFHEIV0,
 19555           FILE-ID-ERPNDB4,
 19556           DFHEIV11,
 19557           DFHEIV99
 19558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19559
 19560
 19561     IF  EIBTRNID NOT = TRANS-EXB1
 19562         IF PENDING-BUS-RECS-FOUND
 19563             NEXT SENTENCE
 19564           ELSE
 19565             MOVE '9'            TO PI-BROWSE-SW
 19566             GO TO 9400-CLEAR.
 19567
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 360
* EL6311.cbl
 19568     IF SHOW-RECORD
 19569        MOVE ER-2253            TO EMI-ERROR
 19570       ELSE
 19571        MOVE ER-2254            TO EMI-ERROR.
 19572
 19573     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19574
 19575     IF PI-MAP-NAME = SPACES
 19576        MOVE -1                  TO DPFENTRL
 19577        MOVE EL631D               TO PI-MAP-NAME
 19578        GO TO 8100-SEND-INITIAL-MAP.
 19579
 19580     IF PI-MAP-NAME = EL631B
 19581        MOVE -1                  TO BMAINTL
 19582     ELSE
 19583        IF PI-MAP-NAME = EL631C
 19584           MOVE -1               TO CMAINTL
 19585        ELSE
 19586           MOVE -1               TO DPFENTRL.
 19587
 19588     GO TO 8200-SEND-DATAONLY.
 19589
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 361
* EL6311.cbl
 19591
 19592***************************************************************
 19593*                                                             *
 19594*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19595*                                                             *
 19596*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19597*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19598*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19599*                                                             *
 19600*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19601*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19602*          A. IS IT WITHIN THE SAME COMPANY                   *
 19603*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19604*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19605*                AND IS IT TO BE DISPLAYED.                   *
 19606*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19607*                DISPLAYED.                                   *
 19608*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19609*                DISPLAYED.                                   *
 19610*                                                             *
 19611*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19612*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19613*                                                             *
 19614*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19615*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19616*                THEY ARE NOT TO BE DISPLAYED.                *
 19617*                                                             *
 19618***************************************************************
 19619
 19620 4300-BROWSE-FILE-FORWARD.
 19621     IF FIRST-TIME OR SHOW-RECORD
 19622        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19623        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19624        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19625     ELSE
 19626        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19627        IF ERPNDB-BATCH-SEQ-NO = +9999
 19628           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19629        ELSE
 19630           IF DISPLAY-CHANGE-RECORDS
 19631              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19632           ELSE
 19633              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19634              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19635
 19636
 19637* EXEC CICS HANDLE CONDITION
 19638*         ENDFILE  (4350-END-BATCH)
 19639*         NOTFND   (4350-END-BATCH)
 19640*    END-EXEC.
 19641*    MOVE '"$''I                  ! M #00016783' TO DFHEIV0
 19642     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19643     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19644     MOVE X'4D20233030303136373833' TO DFHEIV0(25:11)
 19645     CALL 'kxdfhei1' USING DFHEIV0
 19646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19647
 19648
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 362
* EL6311.cbl
 19649 4305-READ-NEXT.
 19650     IF PI-DISPLAY-ORIGINAL-BATCH
 19651        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19652     ELSE
 19653        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19654
 19655
 19656* EXEC CICS READ
 19657*         DATASET   (FILE-ID)
 19658*         SET       (ADDRESS OF PENDING-BUSINESS)
 19659*         RIDFLD    (ERPNDB-KEY)
 19660*         GTEQ
 19661*    END-EXEC.
 19662*    MOVE '&"S        G          (   #00016794' TO DFHEIV0
 19663     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19664     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19665     MOVE X'2020233030303136373934' TO DFHEIV0(25:11)
 19666     CALL 'kxdfhei1' USING DFHEIV0,
 19667           FILE-ID,
 19668           DFHEIV20,
 19669           DFHEIV99,
 19670           ERPNDB-KEY,
 19671           DFHEIV99,
 19672           DFHEIV99,
 19673           DFHEIV99
 19674     SET ADDRESS OF PENDING-BUSINESS TO
 19675         DFHEIV20
 19676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19677
 19678
 19679     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19680        GO TO 4350-END-BATCH.
 19681
 19682     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19683                                    WS-BATCH-NO.
 19684
 19685     IF  WS-BATCH-PREFIX = '#CL'
 19686         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19687         GO TO 4305-READ-NEXT.
 19688
 19689     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19690     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19691     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19692     MOVE PB-STATE               TO PI-PB-STATE.
 19693     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19694
 19695     IF PB-BATCH-TRAILER
 19696        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19697        GO TO 4305-READ-NEXT.
 19698
 19699     IF SHOW-RECORD
 19700           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19701              GO TO 4310-BUMP-SEQ
 19702           ELSE
 19703              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19704                 GO TO 4310-BUMP-SEQ
 19705              ELSE
 19706                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 363
* EL6311.cbl
 19707
 19708     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19709        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19710           GO TO 4310-BUMP-SEQ
 19711        ELSE
 19712           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19713              GO TO 4307-CHECK-REC-TYPE
 19714           ELSE
 19715              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19716                 GO TO 4307-CHECK-REC-TYPE
 19717              ELSE
 19718                 GO TO 4310-BUMP-SEQ.
 19719
 19720     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19721        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19722           GO TO 4310-BUMP-SEQ.
 19723
 19724 4307-CHECK-REC-TYPE.
 19725     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19726         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19727             NEXT SENTENCE
 19728         ELSE
 19729             GO TO 4310-BUMP-SEQ.
 19730
 19731     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19732         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19733             NEXT SENTENCE
 19734        ELSE
 19735             GO TO 4310-BUMP-SEQ.
 19736
 19737     IF NOT DISPLAY-CHANGE-RECORDS AND
 19738            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19739        GO TO 4310-BUMP-SEQ.
 19740
 19741     IF DISPLAY-HOLD-RECORDS AND
 19742        NOT PB-RECORD-ON-HOLD
 19743          GO TO 4310-BUMP-SEQ.
 19744
 19745     IF PB-ISSUE
 19746        IF DISPLAY-CHK-REQ-RECORDS
 19747           GO TO 4310-BUMP-SEQ.
 19748
 19749     IF PB-ISSUE
 19750        IF ISSUE-WITH-WARNING
 19751           IF PB-WARNING-ERRORS
 19752              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19753                  GO TO 4310-BUMP-SEQ
 19754              ELSE
 19755                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19756                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19757                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19758                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19759                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19760                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19761                 GO TO 7000-DISPLAY-ISSUES
 19762           ELSE
 19763              GO TO 4310-BUMP-SEQ.
 19764
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 364
* EL6311.cbl
 19765     IF PB-ISSUE
 19766        IF (ISSUES-IN-ERROR AND
 19767            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19768            ALL-ISSUES
 19769            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19770            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19771            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19772            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19773            MOVE PB-SV-STATE            TO PI-SV-STATE
 19774            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19775            GO TO 7000-DISPLAY-ISSUES
 19776        ELSE
 19777            GO TO 4310-BUMP-SEQ.
 19778
 19779     IF PB-CANCELLATION
 19780        IF DISPLAY-CHK-REQ-RECORDS
 19781           IF PB-C-REFUND-REQUESTED
 19782              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19783              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19784              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19785              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19786              MOVE PB-SV-STATE            TO PI-SV-STATE
 19787              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19788              GO TO 7100-DISPLAY-CANCELS
 19789           ELSE
 19790              GO TO 4310-BUMP-SEQ.
 19791
 19792     IF PB-CANCELLATION
 19793        IF CANCEL-WITH-WARNING
 19794           IF PB-WARNING-ERRORS
 19795              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19796                  GO TO 4310-BUMP-SEQ
 19797              ELSE
 19798                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19799                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19800                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19801                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19802                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19803                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19804                 GO TO 7100-DISPLAY-CANCELS
 19805           ELSE
 19806              GO TO 4310-BUMP-SEQ.
 19807
 19808     IF PB-CANCELLATION
 19809        IF (CANCEL-IN-ERROR  AND
 19810            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19811            ALL-CANCELS
 19812            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19813            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19814            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19815            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19816            MOVE PB-SV-STATE            TO PI-SV-STATE
 19817            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19818            GO TO 7100-DISPLAY-CANCELS.
 19819
 19820 4310-BUMP-SEQ.
 19821     IF NOT DISPLAY-CHANGE-RECORDS
 19822        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 365
* EL6311.cbl
 19823        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19824     ELSE
 19825        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19826           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19827           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19828        ELSE
 19829           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19830           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19831
 19832     GO TO 4305-READ-NEXT.
 19833
 19834 4350-END-BATCH.
 19835
 19836******************************************************************
 19837*                                                                *
 19838*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19839*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19840*         PROGRAM.                                               *
 19841*                                                                *
 19842******************************************************************
 19843
 19844     IF  EIBTRNID NOT = TRANS-EXB1
 19845         IF PENDING-BUS-RECS-FOUND
 19846             NEXT SENTENCE
 19847           ELSE
 19848             MOVE '9'            TO PI-BROWSE-SW
 19849             GO TO 9400-CLEAR.
 19850
 19851     IF SHOW-RECORD
 19852        MOVE ER-2253            TO EMI-ERROR
 19853     ELSE
 19854        MOVE ER-2251            TO EMI-ERROR.
 19855
 19856     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19857
 19858     IF PI-MAP-NAME = SPACES
 19859        MOVE -1                  TO BMAINTL
 19860        MOVE EL631B               TO PI-MAP-NAME
 19861        GO TO 8100-SEND-INITIAL-MAP.
 19862
 19863     IF PI-MAP-NAME = EL631B
 19864        MOVE -1                  TO BMAINTL
 19865     ELSE
 19866        IF PI-MAP-NAME = EL631C
 19867           MOVE -1               TO CMAINTL
 19868        ELSE
 19869           MOVE -1               TO DPFENTRL.
 19870
 19871     GO TO 8200-SEND-DATAONLY.
 19872
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 366
* EL6311.cbl
 19874
 19875******************************************************************
 19876*                                                                *
 19877*        B R O W S E   D E T A I L   B A C K W A R D             *
 19878*                                                                *
 19879******************************************************************
 19880
 19881 4500-BROWSE-DETAIL-BACKWARD.
 19882
 19883     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19884
 19885
 19886* EXEC CICS HANDLE CONDITION
 19887*         NOTFND   (4570-NOT-FOUND)
 19888*         ENDFILE  (4550-END-RECORDS)
 19889*    END-EXEC
 19890*    MOVE '"$I''                  ! N #00017007' TO DFHEIV0
 19891     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19893     MOVE X'4E20233030303137303037' TO DFHEIV0(25:11)
 19894     CALL 'kxdfhei1' USING DFHEIV0
 19895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19896
 19897
 19898* EXEC CICS STARTBR
 19899*         DATASET   (FILE-ID-ERPNDB2)
 19900*         RIDFLD    (ERPNDB-ALT-KEY)
 19901*    END-EXEC.
 19902     MOVE 0
 19903       TO DFHEIV11
 19904*    MOVE '&,         G          &   #00017012' TO DFHEIV0
 19905     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19906     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19907     MOVE X'2020233030303137303132' TO DFHEIV0(25:11)
 19908     CALL 'kxdfhei1' USING DFHEIV0,
 19909           FILE-ID-ERPNDB2,
 19910           ERPNDB-ALT-KEY,
 19911           DFHEIV99,
 19912           DFHEIV11,
 19913           DFHEIV99
 19914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19915
 19916
 19917     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19918                                    WS-FIRST-TIME-SW.
 19919
 19920 4505-READ-PREV-RECORD.
 19921
 19922* EXEC CICS READPREV
 19923*         DATASET    (FILE-ID-ERPNDB2)
 19924*         SET        (ADDRESS OF PENDING-BUSINESS)
 19925*         RIDFLD     (ERPNDB-ALT-KEY)
 19926*    END-EXEC.
 19927     MOVE 0
 19928       TO DFHEIV11
 19929*    MOVE '&0S                   )   #00017021' TO DFHEIV0
 19930     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19931     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 367
* EL6311.cbl
 19932     MOVE X'2020233030303137303231' TO DFHEIV0(25:11)
 19933     CALL 'kxdfhei1' USING DFHEIV0,
 19934           FILE-ID-ERPNDB2,
 19935           DFHEIV20,
 19936           DFHEIV99,
 19937           ERPNDB-ALT-KEY,
 19938           DFHEIV99,
 19939           DFHEIV11,
 19940           DFHEIV99,
 19941           DFHEIV99
 19942     SET ADDRESS OF PENDING-BUSINESS TO
 19943         DFHEIV20
 19944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19945
 19946
 19947     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19948
 19949     IF WS-BATCH-PREFIX = '#CL'
 19950         GO TO 4505-READ-PREV-RECORD.
 19951
 19952     IF FIRST-TIME
 19953         MOVE SPACE               TO WS-FIRST-TIME-SW
 19954         GO TO 4505-READ-PREV-RECORD.
 19955
 19956     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19957        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19958        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19959        PB-STATE         NOT = PI-PB-STATE    OR
 19960        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19961          GO TO 4550-END-RECORDS.
 19962
 19963
 19964     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19965
 19966     IF PB-BATCH-TRAILER
 19967        GO TO 4505-READ-PREV-RECORD.
 19968
 19969     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19970
 19971     IF  WS-BATCH-PREFIX = '#CL'
 19972         GO TO 4505-READ-PREV-RECORD.
 19973
 19974     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19975        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19976           GO TO 4505-READ-PREV-RECORD
 19977        ELSE
 19978           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19979              GO TO 4510-CHECK-REC-TYPE
 19980           ELSE
 19981              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19982                 GO TO 4510-CHECK-REC-TYPE
 19983              ELSE
 19984                 GO TO 4505-READ-PREV-RECORD.
 19985
 19986     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19987        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19988           GO TO 4505-READ-PREV-RECORD.
 19989
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 368
* EL6311.cbl
 19990 4510-CHECK-REC-TYPE.
 19991     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19992         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19993             NEXT SENTENCE
 19994         ELSE
 19995             GO TO 4505-READ-PREV-RECORD.
 19996
 19997     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19998         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19999             NEXT SENTENCE
 20000        ELSE
 20001             GO TO 4505-READ-PREV-RECORD.
 20002
 20003     IF NOT DISPLAY-CHANGE-RECORDS AND
 20004            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20005        GO TO 4505-READ-PREV-RECORD.
 20006
 20007     IF DISPLAY-HOLD-RECORDS AND
 20008        NOT PB-RECORD-ON-HOLD
 20009          GO TO 4505-READ-PREV-RECORD.
 20010
 20011     IF PB-ISSUE
 20012        IF DISPLAY-CHK-REQ-RECORDS
 20013           GO TO 4505-READ-PREV-RECORD.
 20014
 20015     IF PB-ISSUE
 20016        IF ISSUE-WITH-WARNING
 20017           IF PB-WARNING-ERRORS
 20018              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20019                  GO TO 4505-READ-PREV-RECORD
 20020              ELSE
 20021                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20022                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20023                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20024                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20025                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20026                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20027                 GO TO 7000-DISPLAY-ISSUES
 20028           ELSE
 20029              GO TO 4505-READ-PREV-RECORD.
 20030
 20031     IF PB-ISSUE
 20032        IF (ISSUES-IN-ERROR AND
 20033            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20034            ALL-ISSUES
 20035            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20036            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20037            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20038            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20039            MOVE PB-SV-STATE            TO PI-SV-STATE
 20040            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20041            GO TO 7000-DISPLAY-ISSUES
 20042        ELSE
 20043            GO TO 4505-READ-PREV-RECORD.
 20044
 20045     IF PB-CANCELLATION
 20046        IF DISPLAY-CHK-REQ-RECORDS
 20047           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 369
* EL6311.cbl
 20048              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20049              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20050              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20051              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20052              MOVE PB-SV-STATE            TO PI-SV-STATE
 20053              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20054              GO TO 7100-DISPLAY-CANCELS
 20055           ELSE
 20056              GO TO 4505-READ-PREV-RECORD.
 20057
 20058     IF PB-CANCELLATION
 20059        IF CANCEL-WITH-WARNING
 20060           IF PB-WARNING-ERRORS
 20061              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20062                  GO TO 4505-READ-PREV-RECORD
 20063              ELSE
 20064                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20065                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20066                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20067                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20068                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20069                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20070                 GO TO 7100-DISPLAY-CANCELS
 20071           ELSE
 20072              GO TO 4505-READ-PREV-RECORD.
 20073
 20074     IF PB-CANCELLATION
 20075        IF (CANCEL-IN-ERROR  AND
 20076            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20077            ALL-CANCELS
 20078            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20079            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20080            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20081            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20082            MOVE PB-SV-STATE            TO PI-SV-STATE
 20083            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20084            GO TO 7100-DISPLAY-CANCELS.
 20085
 20086     GO TO 4505-READ-PREV-RECORD.
 20087
 20088 4550-END-RECORDS.
 20089     IF PI-MAP-NAME = EL631B
 20090        MOVE -1                  TO BMAINTL
 20091     ELSE
 20092        IF PI-MAP-NAME = EL631C
 20093           MOVE -1               TO CMAINTL
 20094        ELSE
 20095           MOVE -1               TO DPFENTRL.
 20096
 20097     MOVE ER-2255               TO EMI-ERROR.
 20098     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20099     GO TO 8200-SEND-DATAONLY.
 20100
 20101 4570-NOT-FOUND.
 20102
 20103******************************************************************
 20104*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20105******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 370
* EL6311.cbl
 20106
 20107
 20108* EXEC CICS RESETBR
 20109*         DATASET    (FILE-ID-ERPNDB2)
 20110*         RIDFLD     (ERPNDB-ALT-KEY)
 20111*    END-EXEC.
 20112     MOVE 0
 20113       TO DFHEIV11
 20114*    MOVE '&4         G          &   #00017187' TO DFHEIV0
 20115     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20116     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20117     MOVE X'2020233030303137313837' TO DFHEIV0(25:11)
 20118     CALL 'kxdfhei1' USING DFHEIV0,
 20119           FILE-ID-ERPNDB2,
 20120           ERPNDB-ALT-KEY,
 20121           DFHEIV99,
 20122           DFHEIV11,
 20123           DFHEIV99
 20124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20125
 20126
 20127
 20128* EXEC CICS READNEXT
 20129*         DATASET    (FILE-ID-ERPNDB2)
 20130*         SET        (ADDRESS OF PENDING-BUSINESS)
 20131*         RIDFLD     (ERPNDB-ALT-KEY)
 20132*    END-EXEC.
 20133     MOVE 0
 20134       TO DFHEIV11
 20135*    MOVE '&.S                   )   #00017192' TO DFHEIV0
 20136     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20137     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20138     MOVE X'2020233030303137313932' TO DFHEIV0(25:11)
 20139     CALL 'kxdfhei1' USING DFHEIV0,
 20140           FILE-ID-ERPNDB2,
 20141           DFHEIV20,
 20142           DFHEIV99,
 20143           ERPNDB-ALT-KEY,
 20144           DFHEIV99,
 20145           DFHEIV11,
 20146           DFHEIV99,
 20147           DFHEIV99
 20148     SET ADDRESS OF PENDING-BUSINESS TO
 20149         DFHEIV20
 20150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20151
 20152
 20153
 20154* EXEC CICS READPREV
 20155*         DATASET    (FILE-ID-ERPNDB2)
 20156*         SET        (ADDRESS OF PENDING-BUSINESS)
 20157*         RIDFLD     (ERPNDB-ALT-KEY)
 20158*    END-EXEC.
 20159     MOVE 0
 20160       TO DFHEIV11
 20161*    MOVE '&0S                   )   #00017198' TO DFHEIV0
 20162     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20163     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 371
* EL6311.cbl
 20164     MOVE X'2020233030303137313938' TO DFHEIV0(25:11)
 20165     CALL 'kxdfhei1' USING DFHEIV0,
 20166           FILE-ID-ERPNDB2,
 20167           DFHEIV20,
 20168           DFHEIV99,
 20169           ERPNDB-ALT-KEY,
 20170           DFHEIV99,
 20171           DFHEIV11,
 20172           DFHEIV99,
 20173           DFHEIV99
 20174     SET ADDRESS OF PENDING-BUSINESS TO
 20175         DFHEIV20
 20176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20177
 20178
 20179 4580-READ-PREV-RECORD.
 20180
 20181* EXEC CICS READPREV
 20182*         DATASET    (FILE-ID-ERPNDB2)
 20183*         SET        (ADDRESS OF PENDING-BUSINESS)
 20184*         RIDFLD     (ERPNDB-ALT-KEY)
 20185*    END-EXEC.
 20186     MOVE 0
 20187       TO DFHEIV11
 20188*    MOVE '&0S                   )   #00017205' TO DFHEIV0
 20189     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20190     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20191     MOVE X'2020233030303137323035' TO DFHEIV0(25:11)
 20192     CALL 'kxdfhei1' USING DFHEIV0,
 20193           FILE-ID-ERPNDB2,
 20194           DFHEIV20,
 20195           DFHEIV99,
 20196           ERPNDB-ALT-KEY,
 20197           DFHEIV99,
 20198           DFHEIV11,
 20199           DFHEIV99,
 20200           DFHEIV99
 20201     SET ADDRESS OF PENDING-BUSINESS TO
 20202         DFHEIV20
 20203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20204
 20205
 20206     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20207
 20208     IF WS-BATCH-PREFIX = '#CL'
 20209        GO TO 4580-READ-PREV-RECORD.
 20210
 20211     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20212     GO TO 4505-READ-PREV-RECORD.
 20213
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 372
* EL6311.cbl
 20215
 20216******************************************************************
 20217*                                                                *
 20218*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20219*                                                                *
 20220******************************************************************
 20221
 20222 4600-BROWSE-PRIMARY-BACKWARD.
 20223        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20224
 20225     IF ERPNDB-BATCH-SEQ-NO = +9999
 20226        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20227
 20228        IF ERPNDB-BATCH-SEQ-NO = +0000
 20229           GO TO 4650-END-BATCH
 20230        ELSE
 20231           IF PI-MAP-NAME NOT = EL631D
 20232              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20233                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20234              ELSE
 20235                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20236                 IF DISPLAY-CHANGE-RECORDS
 20237                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20238                 ELSE
 20239                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20240
 20241
 20242* EXEC CICS HANDLE CONDITION
 20243*         NOTFND    (4680-NOT-FOUND)
 20244*         ENDFILE   (4680-NOT-FOUND)
 20245*    END-EXEC.
 20246*    MOVE '"$I''                  ! O #00017246' TO DFHEIV0
 20247     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20248     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20249     MOVE X'4F20233030303137323436' TO DFHEIV0(25:11)
 20250     CALL 'kxdfhei1' USING DFHEIV0
 20251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20252
 20253
 20254 4605-READ-NEXT.
 20255     IF ERPNDB-BATCH-SEQ-NO = +0000
 20256        GO TO 4650-END-BATCH.
 20257
 20258     IF PI-DISPLAY-ORIGINAL-BATCH
 20259        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20260     ELSE
 20261        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20262
 20263
 20264* EXEC CICS READ
 20265*         DATASET   (FILE-ID)
 20266*         SET       (ADDRESS OF PENDING-BUSINESS)
 20267*         RIDFLD    (ERPNDB-KEY)
 20268*    END-EXEC.
 20269*    MOVE '&"S        E          (   #00017260' TO DFHEIV0
 20270     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20271     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20272     MOVE X'2020233030303137323630' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 373
* EL6311.cbl
 20273     CALL 'kxdfhei1' USING DFHEIV0,
 20274           FILE-ID,
 20275           DFHEIV20,
 20276           DFHEIV99,
 20277           ERPNDB-KEY,
 20278           DFHEIV99,
 20279           DFHEIV99,
 20280           DFHEIV99
 20281     SET ADDRESS OF PENDING-BUSINESS TO
 20282         DFHEIV20
 20283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20284
 20285
 20286     IF NOT  PI-PRIMARY-WITH-SELECT
 20287        GO TO 4607-CHECK-REC-TYPE.
 20288
 20289     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20290
 20291     IF  WS-BATCH-PREFIX = '#CL'
 20292         GO TO 4610-BUMP-SEQ.
 20293
 20294     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20295        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20296           GO TO 4610-BUMP-SEQ
 20297        ELSE
 20298           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20299              GO TO 4607-CHECK-REC-TYPE
 20300           ELSE
 20301              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20302                 GO TO 4607-CHECK-REC-TYPE
 20303              ELSE
 20304                 GO TO 4610-BUMP-SEQ.
 20305
 20306     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20307        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20308           GO TO 4610-BUMP-SEQ.
 20309
 20310 4607-CHECK-REC-TYPE.
 20311     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20312         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20313             NEXT SENTENCE
 20314         ELSE
 20315             GO TO 4610-BUMP-SEQ.
 20316
 20317     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20318         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20319             NEXT SENTENCE
 20320        ELSE
 20321             GO TO 4610-BUMP-SEQ.
 20322
 20323     IF NOT DISPLAY-CHANGE-RECORDS AND
 20324            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20325        GO TO 4610-BUMP-SEQ.
 20326
 20327     IF DISPLAY-HOLD-RECORDS AND
 20328        NOT PB-RECORD-ON-HOLD
 20329          GO TO 4610-BUMP-SEQ.
 20330
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 374
* EL6311.cbl
 20331     IF PB-ISSUE
 20332        IF DISPLAY-CHK-REQ-RECORDS
 20333           GO TO 4610-BUMP-SEQ.
 20334
 20335     IF PB-ISSUE
 20336        IF ISSUE-WITH-WARNING
 20337           IF PB-WARNING-ERRORS
 20338              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20339                  GO TO 4610-BUMP-SEQ
 20340              ELSE
 20341                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20342                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20343                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20344                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20345                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20346                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20347                 GO TO 7000-DISPLAY-ISSUES
 20348           ELSE
 20349              GO TO 4610-BUMP-SEQ.
 20350
 20351     IF PB-ISSUE
 20352        IF (ISSUES-IN-ERROR AND
 20353            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20354            ALL-ISSUES
 20355            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20356            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20357            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20358            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20359            MOVE PB-SV-STATE            TO PI-SV-STATE
 20360            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20361            GO TO 7000-DISPLAY-ISSUES
 20362        ELSE
 20363            GO TO 4610-BUMP-SEQ.
 20364
 20365     IF PB-CANCELLATION
 20366        IF DISPLAY-CHK-REQ-RECORDS
 20367           IF PB-C-REFUND-REQUESTED
 20368              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20369              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20370              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20371              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20372              MOVE PB-SV-STATE            TO PI-SV-STATE
 20373              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20374              GO TO 7100-DISPLAY-CANCELS
 20375           ELSE
 20376              GO TO 4610-BUMP-SEQ.
 20377
 20378     IF PB-CANCELLATION
 20379        IF CANCEL-WITH-WARNING
 20380           IF PB-WARNING-ERRORS
 20381              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20382                  GO TO 4610-BUMP-SEQ
 20383              ELSE
 20384                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20385                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20386                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20387                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20388                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 375
* EL6311.cbl
 20389                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20390                 GO TO 7100-DISPLAY-CANCELS
 20391           ELSE
 20392              GO TO 4610-BUMP-SEQ.
 20393
 20394     IF PB-CANCELLATION
 20395        IF (CANCEL-IN-ERROR  AND
 20396            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20397            ALL-CANCELS
 20398            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20399            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20400            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20401            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20402            MOVE PB-SV-STATE            TO PI-SV-STATE
 20403            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20404            GO TO 7100-DISPLAY-CANCELS.
 20405
 20406 4610-BUMP-SEQ.
 20407     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20408        GO TO 4650-END-BATCH.
 20409
 20410     IF DISPLAY-CHANGE-RECORDS
 20411        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20412           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20413        ELSE
 20414           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20415           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20416        ELSE
 20417           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20418           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20419
 20420        GO TO 4605-READ-NEXT.
 20421
 20422 4650-END-BATCH.
 20423     IF PI-MAP-NAME = EL631B
 20424        MOVE -1                  TO BMAINTL
 20425     ELSE
 20426        IF PI-MAP-NAME = EL631C
 20427           MOVE -1               TO CMAINTL
 20428        ELSE
 20429           MOVE -1               TO DPFENTRL.
 20430
 20431     MOVE ER-2252               TO EMI-ERROR.
 20432     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20433     GO TO 8200-SEND-DATAONLY.
 20434
 20435 4680-NOT-FOUND.
 20436     IF DISPLAY-CHANGE-RECORDS
 20437        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20438           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20439        ELSE
 20440           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20441           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20442     ELSE
 20443        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20444
 20445     GO TO 4605-READ-NEXT.
 20446
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 376
* EL6311.cbl
 20448
 20449******************************************************************
 20450*                                                                *
 20451*        B R O W S E   F I L E   B A C K W A R D S               *
 20452*                                                                *
 20453******************************************************************
 20454
 20455 4800-BROWSE-FILE-BACKWARD.
 20456
 20457* EXEC CICS HANDLE CONDITION
 20458*         NOTFND   (4860-NOT-FOUND)
 20459*         ENDFILE  (4850-END-RECORDS)
 20460*    END-EXEC.
 20461*    MOVE '"$I''                  ! P #00017436' TO DFHEIV0
 20462     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20463     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20464     MOVE X'5020233030303137343336' TO DFHEIV0(25:11)
 20465     CALL 'kxdfhei1' USING DFHEIV0
 20466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20467
 20468
 20469     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20470
 20471     IF PI-DISPLAY-ORIGINAL-BATCH
 20472        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20473     ELSE
 20474        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20475
 20476
 20477* EXEC CICS STARTBR
 20478*         DATASET   (FILE-ID)
 20479*         RIDFLD    (ERPNDB-KEY)
 20480*    END-EXEC.
 20481     MOVE 0
 20482       TO DFHEIV11
 20483*    MOVE '&,         G          &   #00017448' TO DFHEIV0
 20484     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20485     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20486     MOVE X'2020233030303137343438' TO DFHEIV0(25:11)
 20487     CALL 'kxdfhei1' USING DFHEIV0,
 20488           FILE-ID,
 20489           ERPNDB-KEY,
 20490           DFHEIV99,
 20491           DFHEIV11,
 20492           DFHEIV99
 20493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20494
 20495
 20496     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20497
 20498
 20499* EXEC CICS READPREV
 20500*         DATASET    (FILE-ID-ERPNDB)
 20501*         SET        (ADDRESS OF PENDING-BUSINESS)
 20502*         RIDFLD     (ERPNDB-KEY)
 20503*    END-EXEC.
 20504     MOVE 0
 20505       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 377
* EL6311.cbl
 20506*    MOVE '&0S                   )   #00017455' TO DFHEIV0
 20507     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20508     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20509     MOVE X'2020233030303137343535' TO DFHEIV0(25:11)
 20510     CALL 'kxdfhei1' USING DFHEIV0,
 20511           FILE-ID-ERPNDB,
 20512           DFHEIV20,
 20513           DFHEIV99,
 20514           ERPNDB-KEY,
 20515           DFHEIV99,
 20516           DFHEIV11,
 20517           DFHEIV99,
 20518           DFHEIV99
 20519     SET ADDRESS OF PENDING-BUSINESS TO
 20520         DFHEIV20
 20521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20522
 20523
 20524 4810-READ-PREV-RECORD.
 20525
 20526* EXEC CICS READPREV
 20527*         DATASET    (FILE-ID-ERPNDB)
 20528*         SET        (ADDRESS OF PENDING-BUSINESS)
 20529*         RIDFLD     (ERPNDB-KEY)
 20530*    END-EXEC.
 20531     MOVE 0
 20532       TO DFHEIV11
 20533*    MOVE '&0S                   )   #00017462' TO DFHEIV0
 20534     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20535     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20536     MOVE X'2020233030303137343632' TO DFHEIV0(25:11)
 20537     CALL 'kxdfhei1' USING DFHEIV0,
 20538           FILE-ID-ERPNDB,
 20539           DFHEIV20,
 20540           DFHEIV99,
 20541           ERPNDB-KEY,
 20542           DFHEIV99,
 20543           DFHEIV11,
 20544           DFHEIV99,
 20545           DFHEIV99
 20546     SET ADDRESS OF PENDING-BUSINESS TO
 20547         DFHEIV20
 20548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20549
 20550
 20551     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20552        GO TO 4850-END-RECORDS.
 20553
 20554     IF PB-BATCH-TRAILER
 20555        GO TO 4810-READ-PREV-RECORD.
 20556
 20557     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20558
 20559     IF  WS-BATCH-PREFIX = '#CL'
 20560         GO TO 4810-READ-PREV-RECORD.
 20561
 20562     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20563        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 378
* EL6311.cbl
 20564           GO TO 4810-READ-PREV-RECORD
 20565        ELSE
 20566           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20567              GO TO 4820-CHECK-REC-TYPE
 20568           ELSE
 20569              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20570                 GO TO 4820-CHECK-REC-TYPE
 20571              ELSE
 20572                 GO TO 4810-READ-PREV-RECORD.
 20573
 20574     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20575        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20576           GO TO 4810-READ-PREV-RECORD.
 20577
 20578 4820-CHECK-REC-TYPE.
 20579     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20580         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20581             NEXT SENTENCE
 20582         ELSE
 20583             GO TO 4810-READ-PREV-RECORD.
 20584
 20585     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20586         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20587             NEXT SENTENCE
 20588        ELSE
 20589             GO TO 4810-READ-PREV-RECORD.
 20590
 20591     IF NOT DISPLAY-CHANGE-RECORDS AND
 20592            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20593        GO TO 4810-READ-PREV-RECORD.
 20594
 20595     IF DISPLAY-HOLD-RECORDS AND
 20596        NOT PB-RECORD-ON-HOLD
 20597          GO TO 4810-READ-PREV-RECORD.
 20598
 20599     IF PB-ISSUE
 20600        IF DISPLAY-CHK-REQ-RECORDS
 20601           GO TO 4810-READ-PREV-RECORD.
 20602
 20603     IF PB-ISSUE
 20604        IF ISSUE-WITH-WARNING
 20605           IF PB-WARNING-ERRORS
 20606              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20607                  GO TO 4810-READ-PREV-RECORD
 20608              ELSE
 20609                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20610                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20611                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20612                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20613                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20614                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20615                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20616                 GO TO 7000-DISPLAY-ISSUES
 20617           ELSE
 20618              GO TO 4810-READ-PREV-RECORD.
 20619
 20620     IF PB-ISSUE
 20621        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 379
* EL6311.cbl
 20622            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20623            ALL-ISSUES
 20624            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20625            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20626            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20627            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20628            MOVE PB-SV-STATE            TO PI-SV-STATE
 20629            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20630            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20631            GO TO 7000-DISPLAY-ISSUES
 20632        ELSE
 20633            GO TO 4810-READ-PREV-RECORD.
 20634
 20635     IF PB-CANCELLATION
 20636        IF DISPLAY-CHK-REQ-RECORDS
 20637           IF PB-C-REFUND-REQUESTED
 20638              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20639              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20640              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20641              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20642              MOVE PB-SV-STATE            TO PI-SV-STATE
 20643              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20644              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20645              GO TO 7100-DISPLAY-CANCELS
 20646           ELSE
 20647              GO TO 4810-READ-PREV-RECORD.
 20648
 20649     IF PB-CANCELLATION
 20650        IF CANCEL-WITH-WARNING
 20651           IF PB-WARNING-ERRORS
 20652              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20653                  GO TO 4810-READ-PREV-RECORD
 20654              ELSE
 20655                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20656                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20657                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20658                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20659                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20660                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20661                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20662                 GO TO 7100-DISPLAY-CANCELS
 20663           ELSE
 20664              GO TO 4810-READ-PREV-RECORD.
 20665
 20666     IF PB-CANCELLATION
 20667        IF (CANCEL-IN-ERROR  AND
 20668            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20669            ALL-CANCELS
 20670            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20671            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20672            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20673            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20674            MOVE PB-SV-STATE            TO PI-SV-STATE
 20675            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20676            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20677            GO TO 7100-DISPLAY-CANCELS.
 20678
 20679     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 380
* EL6311.cbl
 20680
 20681 4850-END-RECORDS.
 20682     MOVE ER-2252                TO EMI-ERROR.
 20683     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20684
 20685     IF PI-MAP-NAME = EL631B
 20686        MOVE -1                  TO BPFENTRL
 20687     ELSE
 20688        MOVE -1                  TO CPFENTRL.
 20689
 20690     GO TO 8200-SEND-DATAONLY.
 20691
 20692 4860-NOT-FOUND.
 20693
 20694******************************************************************
 20695*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20696******************************************************************
 20697
 20698
 20699* EXEC CICS RESETBR
 20700*         DATASET    (FILE-ID-ERPNDB)
 20701*         RIDFLD     (ERPNDB-KEY)
 20702*     END-EXEC.
 20703     MOVE 0
 20704       TO DFHEIV11
 20705*    MOVE '&4         G          &   #00017615' TO DFHEIV0
 20706     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20707     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20708     MOVE X'2020233030303137363135' TO DFHEIV0(25:11)
 20709     CALL 'kxdfhei1' USING DFHEIV0,
 20710           FILE-ID-ERPNDB,
 20711           ERPNDB-KEY,
 20712           DFHEIV99,
 20713           DFHEIV11,
 20714           DFHEIV99
 20715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20716
 20717
 20718
 20719* EXEC CICS READNEXT
 20720*         DATASET    (FILE-ID-ERPNDB)
 20721*         SET        (ADDRESS OF PENDING-BUSINESS)
 20722*         RIDFLD     (ERPNDB-KEY)
 20723*    END-EXEC.
 20724     MOVE 0
 20725       TO DFHEIV11
 20726*    MOVE '&.S                   )   #00017620' TO DFHEIV0
 20727     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20728     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20729     MOVE X'2020233030303137363230' TO DFHEIV0(25:11)
 20730     CALL 'kxdfhei1' USING DFHEIV0,
 20731           FILE-ID-ERPNDB,
 20732           DFHEIV20,
 20733           DFHEIV99,
 20734           ERPNDB-KEY,
 20735           DFHEIV99,
 20736           DFHEIV11,
 20737           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 381
* EL6311.cbl
 20738           DFHEIV99
 20739     SET ADDRESS OF PENDING-BUSINESS TO
 20740         DFHEIV20
 20741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20742
 20743
 20744
 20745* EXEC CICS READPREV
 20746*         DATASET    (FILE-ID-ERPNDB)
 20747*         SET        (ADDRESS OF PENDING-BUSINESS)
 20748*         RIDFLD     (ERPNDB-KEY)
 20749*    END-EXEC.
 20750     MOVE 0
 20751       TO DFHEIV11
 20752*    MOVE '&0S                   )   #00017626' TO DFHEIV0
 20753     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20754     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20755     MOVE X'2020233030303137363236' TO DFHEIV0(25:11)
 20756     CALL 'kxdfhei1' USING DFHEIV0,
 20757           FILE-ID-ERPNDB,
 20758           DFHEIV20,
 20759           DFHEIV99,
 20760           ERPNDB-KEY,
 20761           DFHEIV99,
 20762           DFHEIV11,
 20763           DFHEIV99,
 20764           DFHEIV99
 20765     SET ADDRESS OF PENDING-BUSINESS TO
 20766         DFHEIV20
 20767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20768
 20769
 20770     GO TO 4810-READ-PREV-RECORD.
 20771
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 382
* EL6311.cbl
 20773
 20774******************************************************************
 20775*                                                                *
 20776*           B R O W S E   C S R   B A C K W A R D                *
 20777*                                                                *
 20778******************************************************************
 20779
 20780 4900-BROWSE-CSR-BACKWARD.
 20781
 20782     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20783
 20784
 20785* EXEC CICS HANDLE CONDITION
 20786*         NOTFND   (4970-NOT-FOUND)
 20787*         ENDFILE  (4950-END-RECORDS)
 20788*    END-EXEC
 20789*    MOVE '"$I''                  ! Q #00017646' TO DFHEIV0
 20790     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20791     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20792     MOVE X'5120233030303137363436' TO DFHEIV0(25:11)
 20793     CALL 'kxdfhei1' USING DFHEIV0
 20794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20795
 20796
 20797* EXEC CICS STARTBR
 20798*         DATASET   (FILE-ID-ERPNDB4)
 20799*         RIDFLD    (ERPNDB-CSR-KEY)
 20800*    END-EXEC.
 20801     MOVE 0
 20802       TO DFHEIV11
 20803*    MOVE '&,         G          &   #00017651' TO DFHEIV0
 20804     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20805     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20806     MOVE X'2020233030303137363531' TO DFHEIV0(25:11)
 20807     CALL 'kxdfhei1' USING DFHEIV0,
 20808           FILE-ID-ERPNDB4,
 20809           ERPNDB-CSR-KEY,
 20810           DFHEIV99,
 20811           DFHEIV11,
 20812           DFHEIV99
 20813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20814
 20815
 20816     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20817                                    WS-FIRST-TIME-SW.
 20818
 20819 4905-READ-PREV-RECORD.
 20820
 20821* EXEC CICS READPREV
 20822*         DATASET    (FILE-ID-ERPNDB4)
 20823*         SET        (ADDRESS OF PENDING-BUSINESS)
 20824*         RIDFLD     (ERPNDB-CSR-KEY)
 20825*    END-EXEC.
 20826     MOVE 0
 20827       TO DFHEIV11
 20828*    MOVE '&0S                   )   #00017660' TO DFHEIV0
 20829     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20830     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 383
* EL6311.cbl
 20831     MOVE X'2020233030303137363630' TO DFHEIV0(25:11)
 20832     CALL 'kxdfhei1' USING DFHEIV0,
 20833           FILE-ID-ERPNDB4,
 20834           DFHEIV20,
 20835           DFHEIV99,
 20836           ERPNDB-CSR-KEY,
 20837           DFHEIV99,
 20838           DFHEIV11,
 20839           DFHEIV99,
 20840           DFHEIV99
 20841     SET ADDRESS OF PENDING-BUSINESS TO
 20842         DFHEIV20
 20843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20844
 20845
 20846     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20847
 20848     IF WS-BATCH-PREFIX = '#CL'
 20849         GO TO 4905-READ-PREV-RECORD.
 20850
 20851     IF FIRST-TIME
 20852         MOVE SPACE               TO WS-FIRST-TIME-SW
 20853         GO TO 4905-READ-PREV-RECORD.
 20854
 20855     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20856        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20857        GO TO 4950-END-RECORDS.
 20858
 20859     IF PB-BATCH-TRAILER
 20860        GO TO 4905-READ-PREV-RECORD.
 20861
 20862     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20863
 20864     IF  WS-BATCH-PREFIX = '#CL'
 20865         GO TO 4905-READ-PREV-RECORD.
 20866
 20867     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20868        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20869           GO TO 4905-READ-PREV-RECORD
 20870        ELSE
 20871           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20872              GO TO 4910-CHECK-REC-TYPE
 20873           ELSE
 20874              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20875                 GO TO 4910-CHECK-REC-TYPE
 20876              ELSE
 20877                 GO TO 4905-READ-PREV-RECORD.
 20878
 20879     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20880        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20881           GO TO 4905-READ-PREV-RECORD.
 20882
 20883 4910-CHECK-REC-TYPE.
 20884     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20885         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20886             NEXT SENTENCE
 20887         ELSE
 20888             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 384
* EL6311.cbl
 20889
 20890     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20891         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20892             NEXT SENTENCE
 20893        ELSE
 20894             GO TO 4905-READ-PREV-RECORD.
 20895
 20896     IF NOT DISPLAY-CHANGE-RECORDS AND
 20897            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20898        GO TO 4905-READ-PREV-RECORD.
 20899
 20900     IF DISPLAY-HOLD-RECORDS AND
 20901        NOT PB-RECORD-ON-HOLD
 20902          GO TO 4905-READ-PREV-RECORD.
 20903
 20904     IF PB-ISSUE
 20905        IF DISPLAY-CHK-REQ-RECORDS
 20906           GO TO 4905-READ-PREV-RECORD.
 20907
 20908     IF PB-ISSUE
 20909        IF ISSUE-WITH-WARNING
 20910           IF PB-WARNING-ERRORS
 20911              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20912                  GO TO 4505-READ-PREV-RECORD
 20913              ELSE
 20914                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20915                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20916                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20917                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20918                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20919                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20920                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20921                 GO TO 7000-DISPLAY-ISSUES
 20922           ELSE
 20923              GO TO 4905-READ-PREV-RECORD.
 20924
 20925     IF PB-ISSUE
 20926        IF (ISSUES-IN-ERROR AND
 20927            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20928            ALL-ISSUES
 20929            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20930            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20931            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20932            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20933            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20934            MOVE PB-SV-STATE            TO PI-SV-STATE
 20935            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20936            GO TO 7000-DISPLAY-ISSUES
 20937        ELSE
 20938            GO TO 4905-READ-PREV-RECORD.
 20939
 20940     IF PB-CANCELLATION
 20941        IF DISPLAY-CHK-REQ-RECORDS
 20942           IF PB-C-REFUND-REQUESTED
 20943              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20944              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20945              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20946              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 385
* EL6311.cbl
 20947              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20948              MOVE PB-SV-STATE            TO PI-SV-STATE
 20949              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20950              GO TO 7100-DISPLAY-CANCELS
 20951           ELSE
 20952              GO TO 4905-READ-PREV-RECORD.
 20953
 20954     IF PB-CANCELLATION
 20955        IF CANCEL-WITH-WARNING
 20956           IF PB-WARNING-ERRORS
 20957              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20958                  GO TO 4505-READ-PREV-RECORD
 20959              ELSE
 20960                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20961                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20962                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20963                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20964                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20965                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20966                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20967                 GO TO 7100-DISPLAY-CANCELS
 20968           ELSE
 20969              GO TO 4905-READ-PREV-RECORD.
 20970
 20971     IF PB-CANCELLATION
 20972        IF (CANCEL-IN-ERROR  AND
 20973            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20974            ALL-CANCELS
 20975            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20976            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20977            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20978            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20979            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20980            MOVE PB-SV-STATE            TO PI-SV-STATE
 20981            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20982            GO TO 7100-DISPLAY-CANCELS.
 20983
 20984     GO TO 4905-READ-PREV-RECORD.
 20985
 20986 4950-END-RECORDS.
 20987     IF PI-MAP-NAME = EL631B
 20988        MOVE -1                  TO BMAINTL
 20989     ELSE
 20990        IF PI-MAP-NAME = EL631C
 20991           MOVE -1               TO CMAINTL
 20992        ELSE
 20993           MOVE -1               TO DPFENTRL.
 20994
 20995     MOVE ER-2255               TO EMI-ERROR.
 20996     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20997     GO TO 8200-SEND-DATAONLY.
 20998
 20999 4970-NOT-FOUND.
 21000
 21001******************************************************************
 21002*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 21003******************************************************************
 21004
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 386
* EL6311.cbl
 21005
 21006* EXEC CICS RESETBR
 21007*         DATASET    (FILE-ID-ERPNDB4)
 21008*         RIDFLD     (ERPNDB-CSR-KEY)
 21009*    END-EXEC.
 21010     MOVE 0
 21011       TO DFHEIV11
 21012*    MOVE '&4         G          &   #00017825' TO DFHEIV0
 21013     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 21014     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21015     MOVE X'2020233030303137383235' TO DFHEIV0(25:11)
 21016     CALL 'kxdfhei1' USING DFHEIV0,
 21017           FILE-ID-ERPNDB4,
 21018           ERPNDB-CSR-KEY,
 21019           DFHEIV99,
 21020           DFHEIV11,
 21021           DFHEIV99
 21022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21023
 21024
 21025
 21026* EXEC CICS READNEXT
 21027*         DATASET    (FILE-ID-ERPNDB4)
 21028*         SET        (ADDRESS OF PENDING-BUSINESS)
 21029*         RIDFLD     (ERPNDB-CSR-KEY)
 21030*    END-EXEC.
 21031     MOVE 0
 21032       TO DFHEIV11
 21033*    MOVE '&.S                   )   #00017830' TO DFHEIV0
 21034     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21035     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21036     MOVE X'2020233030303137383330' TO DFHEIV0(25:11)
 21037     CALL 'kxdfhei1' USING DFHEIV0,
 21038           FILE-ID-ERPNDB4,
 21039           DFHEIV20,
 21040           DFHEIV99,
 21041           ERPNDB-CSR-KEY,
 21042           DFHEIV99,
 21043           DFHEIV11,
 21044           DFHEIV99,
 21045           DFHEIV99
 21046     SET ADDRESS OF PENDING-BUSINESS TO
 21047         DFHEIV20
 21048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21049
 21050
 21051
 21052* EXEC CICS READPREV
 21053*         DATASET    (FILE-ID-ERPNDB4)
 21054*         SET        (ADDRESS OF PENDING-BUSINESS)
 21055*         RIDFLD     (ERPNDB-CSR-KEY)
 21056*    END-EXEC.
 21057     MOVE 0
 21058       TO DFHEIV11
 21059*    MOVE '&0S                   )   #00017836' TO DFHEIV0
 21060     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21061     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21062     MOVE X'2020233030303137383336' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 387
* EL6311.cbl
 21063     CALL 'kxdfhei1' USING DFHEIV0,
 21064           FILE-ID-ERPNDB4,
 21065           DFHEIV20,
 21066           DFHEIV99,
 21067           ERPNDB-CSR-KEY,
 21068           DFHEIV99,
 21069           DFHEIV11,
 21070           DFHEIV99,
 21071           DFHEIV99
 21072     SET ADDRESS OF PENDING-BUSINESS TO
 21073         DFHEIV20
 21074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21075
 21076
 21077 4980-READ-PREV-RECORD.
 21078
 21079* EXEC CICS READPREV
 21080*         DATASET    (FILE-ID-ERPNDB4)
 21081*         SET        (ADDRESS OF PENDING-BUSINESS)
 21082*         RIDFLD     (ERPNDB-CSR-KEY)
 21083*    END-EXEC.
 21084     MOVE 0
 21085       TO DFHEIV11
 21086*    MOVE '&0S                   )   #00017843' TO DFHEIV0
 21087     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21088     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21089     MOVE X'2020233030303137383433' TO DFHEIV0(25:11)
 21090     CALL 'kxdfhei1' USING DFHEIV0,
 21091           FILE-ID-ERPNDB4,
 21092           DFHEIV20,
 21093           DFHEIV99,
 21094           ERPNDB-CSR-KEY,
 21095           DFHEIV99,
 21096           DFHEIV11,
 21097           DFHEIV99,
 21098           DFHEIV99
 21099     SET ADDRESS OF PENDING-BUSINESS TO
 21100         DFHEIV20
 21101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21102
 21103
 21104     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21105
 21106     IF WS-BATCH-PREFIX = '#CL'
 21107        GO TO 4980-READ-PREV-RECORD.
 21108
 21109     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 21110     GO TO 4905-READ-PREV-RECORD.
 21111
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 388
* EL6311.cbl
 21113
 21114
 21115******************************************************************
 21116*                                                                *
 21117*        B R O W S E   B A T C H   H E A D E R S                 *
 21118*                                                                *
 21119******************************************************************
 21120
 21121 5000-BROWSE-BATCH-HEADERS.
 21122
 21123     IF EIBTRNID NOT = TRANS-EXB1
 21124        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 21125        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21126        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21127        GO TO 5010-READ-NEXT-RECORD.
 21128
 21129     IF EIBAID = DFHPF4
 21130        MOVE '0'                TO PI-EDIT-SW
 21131        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21132        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21133        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21134        GO TO 5010-READ-NEXT-RECORD.
 21135
 21136     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21137     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 21138     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21139
 21140
 21141* EXEC CICS HANDLE CONDITION
 21142*         ENDFILE  (5050-NOT-FOUND)
 21143*    END-EXEC.
 21144*    MOVE '"$''                   ! R #00017885' TO DFHEIV0
 21145     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 21146     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21147     MOVE X'5220233030303137383835' TO DFHEIV0(25:11)
 21148     CALL 'kxdfhei1' USING DFHEIV0
 21149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21150
 21151
 21152 5010-READ-NEXT-RECORD.
 21153
 21154* EXEC CICS HANDLE CONDITION
 21155*         NOTFND    (5050-NOT-FOUND)
 21156*    END-EXEC.
 21157*    MOVE '"$I                   ! S #00017890' TO DFHEIV0
 21158     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21160     MOVE X'5320233030303137383930' TO DFHEIV0(25:11)
 21161     CALL 'kxdfhei1' USING DFHEIV0
 21162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21163
 21164
 21165
 21166* EXEC CICS READ
 21167*         DATASET   (FILE-ID-ERPNDB)
 21168*         SET       (ADDRESS OF PENDING-BUSINESS)
 21169*         RIDFLD    (ERPNDB-KEY)
 21170*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 389
* EL6311.cbl
 21171*    END-EXEC.
 21172*    MOVE '&"S        G          (   #00017894' TO DFHEIV0
 21173     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21174     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21175     MOVE X'2020233030303137383934' TO DFHEIV0(25:11)
 21176     CALL 'kxdfhei1' USING DFHEIV0,
 21177           FILE-ID-ERPNDB,
 21178           DFHEIV20,
 21179           DFHEIV99,
 21180           ERPNDB-KEY,
 21181           DFHEIV99,
 21182           DFHEIV99,
 21183           DFHEIV99
 21184     SET ADDRESS OF PENDING-BUSINESS TO
 21185         DFHEIV20
 21186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21187
 21188
 21189     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21190         GO TO 5050-NOT-FOUND.
 21191
 21192     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21193
 21194     IF WS-BATCH-PREFIX = '#CL'
 21195         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21196         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21197         GO TO 5010-READ-NEXT-RECORD.
 21198
 21199     IF NOT PB-BATCH-TRAILER
 21200         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21201         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21202         GO TO 5010-READ-NEXT-RECORD.
 21203
 21204     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21205         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21206             NEXT SENTENCE
 21207         ELSE
 21208             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21209             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21210             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21211             GO TO 5010-READ-NEXT-RECORD.
 21212
 21213     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21214         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21215             NEXT SENTENCE
 21216        ELSE
 21217             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21218             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21219             GO TO 5010-READ-NEXT-RECORD.
 21220
 21221     IF EIBAID = DFHPF4
 21222        MOVE '0'                TO PI-EDIT-SW
 21223        GO TO 7200-DISPLAY-BATCHES.
 21224
 21225     IF PI-CSR-BROWSE
 21226        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21227           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21228           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 390
* EL6311.cbl
 21229           GO TO 5010-READ-NEXT-RECORD.
 21230
 21231     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21232       IF PI-PB-CARRIER    = SPACES AND
 21233          PI-PB-GROUPING   = SPACES AND
 21234          PI-PB-STATE      = SPACES AND
 21235          PI-PB-ACCOUNT    = SPACES
 21236            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21237            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21238            GO TO 7200-DISPLAY-BATCHES
 21239         ELSE
 21240           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21241              PI-PB-GROUPING   = PB-GROUPING AND
 21242              PI-PB-STATE      = PB-STATE    AND
 21243              PI-PB-ACCOUNT    = PB-ACCOUNT
 21244              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21245              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21246              GO TO 7200-DISPLAY-BATCHES.
 21247
 21248     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21249     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21250
 21251
 21252* EXEC CICS HANDLE CONDITION
 21253*         NOTFND    (5050-NOT-FOUND)
 21254*    END-EXEC.
 21255*    MOVE '"$I                   ! T #00017963' TO DFHEIV0
 21256     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21258     MOVE X'5420233030303137393633' TO DFHEIV0(25:11)
 21259     CALL 'kxdfhei1' USING DFHEIV0
 21260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21261
 21262
 21263
 21264* EXEC CICS READ
 21265*         DATASET   (FILE-ID-ERPNDB)
 21266*         SET       (ADDRESS OF PENDING-BUSINESS)
 21267*         RIDFLD    (ERPNDB-KEY)
 21268*         GTEQ
 21269*    END-EXEC.
 21270*    MOVE '&"S        G          (   #00017967' TO DFHEIV0
 21271     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21272     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21273     MOVE X'2020233030303137393637' TO DFHEIV0(25:11)
 21274     CALL 'kxdfhei1' USING DFHEIV0,
 21275           FILE-ID-ERPNDB,
 21276           DFHEIV20,
 21277           DFHEIV99,
 21278           ERPNDB-KEY,
 21279           DFHEIV99,
 21280           DFHEIV99,
 21281           DFHEIV99
 21282     SET ADDRESS OF PENDING-BUSINESS TO
 21283         DFHEIV20
 21284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21285
 21286
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 391
* EL6311.cbl
 21287     GO TO 5010-READ-NEXT-RECORD.
 21288
 21289 5050-NOT-FOUND.
 21290
 21291******************************************************************
 21292*                                                                *
 21293*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21294*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21295*         PROGRAM.                                               *
 21296*                                                                *
 21297******************************************************************
 21298
 21299     IF EIBTRNID NOT = TRANS-EXB1
 21300        IF PENDING-BUS-RECS-FOUND
 21301            NEXT SENTENCE
 21302          ELSE
 21303            MOVE '9'            TO PI-BROWSE-SW
 21304            GO TO 9400-CLEAR.
 21305
 21306     MOVE ER-2256                TO EMI-ERROR.
 21307     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21308
 21309     IF PI-MAP-NAME = SPACES
 21310        MOVE EL631D              TO PI-MAP-NAME
 21311        MOVE -1                  TO DPFENTRL
 21312        GO TO 8100-SEND-INITIAL-MAP.
 21313
 21314     IF PI-MAP-NAME = EL631B
 21315        MOVE -1                  TO BMAINTL
 21316     ELSE
 21317        IF PI-MAP-NAME = EL631C
 21318           MOVE -1               TO CMAINTL
 21319        ELSE
 21320           MOVE -1               TO DPFENTRL
 21321           GO TO 8200-SEND-DATAONLY.
 21322
 21323     GO TO 8100-SEND-INITIAL-MAP.
 21324
 21325     .
 21326 5100-PROCESS-POL-RESC.
 21327     MOVE ZEROS                  TO CG-LF-BENCD
 21328                                    CG-AH-BENCD
 21329                                    CG-LF-CAN-AMT
 21330                                    CG-AH-CAN-AMT
 21331     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21332                                    CG-AH-CAN-DT
 21333     MOVE SPACES                 TO CG-BATCH-NO
 21334     MOVE '4'                    TO CG-OPTION-CODE
 21335     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21336     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21337     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21338     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21339     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21340     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21341     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21342     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21343     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21344     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 392
* EL6311.cbl
 21345     MOVE PI-PREV-ALT-KEY (1:33)
 21346                                 TO CG-CERT-KEY
 21347     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21348     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21349                                    CG-AH-CAN-AMT
 21350     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21351                                    CG-AH-CAN-DT
 21352     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21353     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21354      display 'about to cancel ' cg-cert-key
 21355
 21356* EXEC CICS LINK
 21357*        PROGRAM  ('ELCANC')
 21358*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21359*    END-EXEC
 21360     MOVE LENGTH OF
 21361      CANCEL-GEN-PASS-AREA
 21362       TO DFHEIV11
 21363     MOVE 'ELCANC' TO DFHEIV1
 21364*    MOVE '."C                   (   #00018042' TO DFHEIV0
 21365     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21366     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21367     MOVE X'2020233030303138303432' TO DFHEIV0(25:11)
 21368     CALL 'kxdfhei1' USING DFHEIV0,
 21369           DFHEIV1,
 21370           CANCEL-GEN-PASS-AREA,
 21371           DFHEIV11,
 21372           DFHEIV99,
 21373           DFHEIV99,
 21374           DFHEIV99,
 21375           DFHEIV99
 21376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21377     IF CG-SUCCESS
 21378        CONTINUE
 21379     ELSE
 21380        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21381        MOVE '3'                 TO EMI-SWITCH1
 21382        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21383        EVALUATE TRUE
 21384           WHEN CG-DATE-ERROR
 21385             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21386           WHEN CG-CERT-NOT-FOUND
 21387             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21388           WHEN CG-AMOUNT-ERROR
 21389             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21390           WHEN CG-OPTION-ERROR
 21391             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21392           WHEN CG-PREV-CAN
 21393             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21394           WHEN CG-INVALID-DATA
 21395             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21396           WHEN CG-NO-ACCT-MSTR
 21397             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21398           WHEN CG-SFX-A-EXIST
 21399             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21400           WHEN CG-MISC-ERROR
 21401             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21402           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 393
* EL6311.cbl
 21403             MOVE ' ERROR - ELCANC - RETURN '
 21404                                 TO EMI-ERROR-TEXT (1) (12:25)
 21405        END-EVALUATE
 21406        GO TO 8200-SEND-DATAONLY
 21407     END-IF
 21408     .
 21409 5100-EXIT.
 21410     EXIT.
 21411
 21412******************************************************************
 21413*                                                                *
 21414*        B R O W S E   B A T C H   B A C K W A R D S             *
 21415*                                                                *
 21416******************************************************************
 21417
 21418 5500-BROWSE-BATCH-BACKWARD.
 21419
 21420* EXEC CICS HANDLE CONDITION
 21421*         NOTFND   (5550-END-RECORDS)
 21422*         ENDFILE  (5550-END-RECORDS)
 21423*    END-EXEC.
 21424*    MOVE '"$I''                  ! U #00018088' TO DFHEIV0
 21425     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21426     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21427     MOVE X'5520233030303138303838' TO DFHEIV0(25:11)
 21428     CALL 'kxdfhei1' USING DFHEIV0
 21429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21430
 21431
 21432 5505-START-BROWSE.
 21433     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21434     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21435     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21436
 21437
 21438* EXEC CICS STARTBR
 21439*         DATASET   (FILE-ID-ERPNDB)
 21440*         RIDFLD    (ERPNDB-ALT-KEY)
 21441*    END-EXEC.
 21442     MOVE 0
 21443       TO DFHEIV11
 21444*    MOVE '&,         G          &   #00018098' TO DFHEIV0
 21445     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21446     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21447     MOVE X'2020233030303138303938' TO DFHEIV0(25:11)
 21448     CALL 'kxdfhei1' USING DFHEIV0,
 21449           FILE-ID-ERPNDB,
 21450           ERPNDB-ALT-KEY,
 21451           DFHEIV99,
 21452           DFHEIV11,
 21453           DFHEIV99
 21454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21455
 21456
 21457     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21458
 21459
 21460* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 394
* EL6311.cbl
 21461*         DATASET    (FILE-ID-ERPNDB)
 21462*         SET        (ADDRESS OF PENDING-BUSINESS)
 21463*         RIDFLD     (ERPNDB-KEY)
 21464*    END-EXEC.
 21465     MOVE 0
 21466       TO DFHEIV11
 21467*    MOVE '&.S                   )   #00018105' TO DFHEIV0
 21468     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21469     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21470     MOVE X'2020233030303138313035' TO DFHEIV0(25:11)
 21471     CALL 'kxdfhei1' USING DFHEIV0,
 21472           FILE-ID-ERPNDB,
 21473           DFHEIV20,
 21474           DFHEIV99,
 21475           ERPNDB-KEY,
 21476           DFHEIV99,
 21477           DFHEIV11,
 21478           DFHEIV99,
 21479           DFHEIV99
 21480     SET ADDRESS OF PENDING-BUSINESS TO
 21481         DFHEIV20
 21482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21483
 21484
 21485
 21486* EXEC CICS READPREV
 21487*         DATASET    (FILE-ID-ERPNDB)
 21488*         SET        (ADDRESS OF PENDING-BUSINESS)
 21489*         RIDFLD     (ERPNDB-KEY)
 21490*    END-EXEC.
 21491     MOVE 0
 21492       TO DFHEIV11
 21493*    MOVE '&0S                   )   #00018111' TO DFHEIV0
 21494     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21495     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21496     MOVE X'2020233030303138313131' TO DFHEIV0(25:11)
 21497     CALL 'kxdfhei1' USING DFHEIV0,
 21498           FILE-ID-ERPNDB,
 21499           DFHEIV20,
 21500           DFHEIV99,
 21501           ERPNDB-KEY,
 21502           DFHEIV99,
 21503           DFHEIV11,
 21504           DFHEIV99,
 21505           DFHEIV99
 21506     SET ADDRESS OF PENDING-BUSINESS TO
 21507         DFHEIV20
 21508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21509
 21510
 21511
 21512* EXEC CICS READPREV
 21513*         DATASET    (FILE-ID-ERPNDB)
 21514*         SET        (ADDRESS OF PENDING-BUSINESS)
 21515*         RIDFLD     (ERPNDB-KEY)
 21516*    END-EXEC.
 21517     MOVE 0
 21518       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 395
* EL6311.cbl
 21519*    MOVE '&0S                   )   #00018117' TO DFHEIV0
 21520     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21521     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21522     MOVE X'2020233030303138313137' TO DFHEIV0(25:11)
 21523     CALL 'kxdfhei1' USING DFHEIV0,
 21524           FILE-ID-ERPNDB,
 21525           DFHEIV20,
 21526           DFHEIV99,
 21527           ERPNDB-KEY,
 21528           DFHEIV99,
 21529           DFHEIV11,
 21530           DFHEIV99,
 21531           DFHEIV99
 21532     SET ADDRESS OF PENDING-BUSINESS TO
 21533         DFHEIV20
 21534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21535
 21536
 21537     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21538        GO TO 5550-END-RECORDS.
 21539
 21540     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21541
 21542     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21543
 21544     IF  WS-BATCH-PREFIX = '#CL'
 21545             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21546
 21547* EXEC CICS ENDBR
 21548*                 DATASET  (FILE-ID-ERPNDB)
 21549*            END-EXEC
 21550     MOVE 0
 21551       TO DFHEIV11
 21552*    MOVE '&2                    $   #00018132' TO DFHEIV0
 21553     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21554     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21555     MOVE X'2020233030303138313332' TO DFHEIV0(25:11)
 21556     CALL 'kxdfhei1' USING DFHEIV0,
 21557           FILE-ID-ERPNDB,
 21558           DFHEIV11,
 21559           DFHEIV99
 21560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21561         GO TO 5505-START-BROWSE.
 21562
 21563     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21564         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21565             NEXT SENTENCE
 21566         ELSE
 21567             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21568
 21569* EXEC CICS ENDBR
 21570*                 DATASET  (FILE-ID-ERPNDB)
 21571*            END-EXEC
 21572     MOVE 0
 21573       TO DFHEIV11
 21574*    MOVE '&2                    $   #00018142' TO DFHEIV0
 21575     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21576     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 396
* EL6311.cbl
 21577     MOVE X'2020233030303138313432' TO DFHEIV0(25:11)
 21578     CALL 'kxdfhei1' USING DFHEIV0,
 21579           FILE-ID-ERPNDB,
 21580           DFHEIV11,
 21581           DFHEIV99
 21582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21583             GO TO 5505-START-BROWSE.
 21584
 21585
 21586     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21587         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21588             NEXT SENTENCE
 21589        ELSE
 21590             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21591
 21592* EXEC CICS ENDBR
 21593*                 DATASET  (FILE-ID-ERPNDB)
 21594*            END-EXEC
 21595     MOVE 0
 21596       TO DFHEIV11
 21597*    MOVE '&2                    $   #00018153' TO DFHEIV0
 21598     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21599     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21600     MOVE X'2020233030303138313533' TO DFHEIV0(25:11)
 21601     CALL 'kxdfhei1' USING DFHEIV0,
 21602           FILE-ID-ERPNDB,
 21603           DFHEIV11,
 21604           DFHEIV99
 21605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21606             GO TO 5505-START-BROWSE.
 21607
 21608     IF NOT PB-BATCH-TRAILER
 21609        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21610
 21611* EXEC CICS ENDBR
 21612*            DATASET  (FILE-ID-ERPNDB)
 21613*       END-EXEC
 21614     MOVE 0
 21615       TO DFHEIV11
 21616*    MOVE '&2                    $   #00018160' TO DFHEIV0
 21617     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21618     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21619     MOVE X'2020233030303138313630' TO DFHEIV0(25:11)
 21620     CALL 'kxdfhei1' USING DFHEIV0,
 21621           FILE-ID-ERPNDB,
 21622           DFHEIV11,
 21623           DFHEIV99
 21624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21625        GO TO 5505-START-BROWSE.
 21626
 21627     IF PI-CSR-BROWSE
 21628        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21629           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21630
 21631* EXEC CICS ENDBR
 21632*               DATASET  (FILE-ID-ERPNDB)
 21633*          END-EXEC
 21634     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 397
* EL6311.cbl
 21635       TO DFHEIV11
 21636*    MOVE '&2                    $   #00018168' TO DFHEIV0
 21637     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21638     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21639     MOVE X'2020233030303138313638' TO DFHEIV0(25:11)
 21640     CALL 'kxdfhei1' USING DFHEIV0,
 21641           FILE-ID-ERPNDB,
 21642           DFHEIV11,
 21643           DFHEIV99
 21644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21645           GO TO 5505-START-BROWSE.
 21646
 21647     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21648        IF PI-PB-CARRIER    = SPACES AND
 21649           PI-PB-GROUPING   = SPACES AND
 21650           PI-PB-STATE      = SPACES AND
 21651           PI-PB-ACCOUNT    = SPACES
 21652             GO TO 7200-DISPLAY-BATCHES
 21653          ELSE
 21654            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21655               PI-PB-GROUPING   = PB-GROUPING AND
 21656               PI-PB-STATE      = PB-STATE    AND
 21657               PI-PB-ACCOUNT    = PB-ACCOUNT
 21658                 GO TO 7200-DISPLAY-BATCHES.
 21659
 21660     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21661
 21662
 21663* EXEC CICS ENDBR
 21664*         DATASET  (FILE-ID-ERPNDB)
 21665*    END-EXEC.
 21666     MOVE 0
 21667       TO DFHEIV11
 21668*    MOVE '&2                    $   #00018188' TO DFHEIV0
 21669     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21670     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21671     MOVE X'2020233030303138313838' TO DFHEIV0(25:11)
 21672     CALL 'kxdfhei1' USING DFHEIV0,
 21673           FILE-ID-ERPNDB,
 21674           DFHEIV11,
 21675           DFHEIV99
 21676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21677
 21678
 21679     GO TO 5505-START-BROWSE.
 21680
 21681 5550-END-RECORDS.
 21682     MOVE ER-2257                TO EMI-ERROR.
 21683     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21684     MOVE -1                     TO DPFENTRL.
 21685
 21686     GO TO 8200-SEND-DATAONLY.
 21687
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 398
* EL6311.cbl
 21689
 21690******************************************************************
 21691*                                                                *
 21692*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21693*                                                                *
 21694******************************************************************
 21695
 21696 6000-CREATE-TEMP-STORAGE.
 21697
 21698
 21699* EXEC CICS HANDLE CONDITION
 21700*        QIDERR  (6050-QID-ERROR)
 21701*    END-EXEC.
 21702*    MOVE '"$N                   ! V #00018211' TO DFHEIV0
 21703     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21704     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21705     MOVE X'5620233030303138323131' TO DFHEIV0(25:11)
 21706     CALL 'kxdfhei1' USING DFHEIV0
 21707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21708
 21709
 21710
 21711* EXEC CICS WRITEQ TS
 21712*        QUEUE    (QID)
 21713*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21714*        LENGTH   (WS-COMM-LENGTH)
 21715*        ITEM     (W-ONE)
 21716*    END-EXEC.
 21717*    MOVE '*" I   L              ''   #00018215' TO DFHEIV0
 21718     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 21719     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21720     MOVE X'2020233030303138323135' TO DFHEIV0(25:11)
 21721     CALL 'kxdfhei1' USING DFHEIV0,
 21722           QID,
 21723           PROGRAM-INTERFACE-BLOCK,
 21724           WS-COMM-LENGTH,
 21725           W-ONE,
 21726           DFHEIV99,
 21727           DFHEIV99
 21728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21729
 21730
 21731 6000-EXIT.
 21732      EXIT.
 21733
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 399
* EL6311.cbl
 21735
 21736******************************************************************
 21737*                                                                *
 21738*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21739*                                                                *
 21740******************************************************************
 21741
 21742 6050-RECOVER-TEMP-STORAGE.
 21743     IF PGM-NAME = XCTL-EL6312
 21744        GO TO 6050-EXIT.
 21745
 21746     IF PGM-NAME = XCTL-EL6313
 21747        GO TO 6050-EXIT.
 21748
 21749     IF PGM-NAME = XCTL-EL6315
 21750         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21751     END-IF
 21752
 21753     IF PGM-NAME = XCTL-EL6316
 21754         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21755     END-IF
 21756
 21757
 21758* EXEC CICS HANDLE CONDITION
 21759*        QIDERR  (6050-QID-ERROR)
 21760*    END-EXEC.
 21761*    MOVE '"$N                   ! W #00018248' TO DFHEIV0
 21762     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21763     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21764     MOVE X'5720233030303138323438' TO DFHEIV0(25:11)
 21765     CALL 'kxdfhei1' USING DFHEIV0
 21766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21767
 21768
 21769
 21770* EXEC CICS READQ TS
 21771*         QUEUE   (QID)
 21772*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21773*         LENGTH  (WS-COMM-LENGTH)
 21774*         ITEM    (W-ONE)
 21775*     END-EXEC.
 21776*    MOVE '*$II   L              ''   #00018252' TO DFHEIV0
 21777     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21778     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21779     MOVE X'2020233030303138323532' TO DFHEIV0(25:11)
 21780     CALL 'kxdfhei1' USING DFHEIV0,
 21781           QID,
 21782           PROGRAM-INTERFACE-BLOCK,
 21783           WS-COMM-LENGTH,
 21784           W-ONE,
 21785           DFHEIV99,
 21786           DFHEIV99
 21787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21788
 21789
 21790 6050-DELETE-TEMP-STORAGE.
 21791
 21792
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 400
* EL6311.cbl
 21793* EXEC CICS DELETEQ TS
 21794*        QUEUE   (QID)
 21795*    END-EXEC.
 21796*    MOVE '*&                    #   #00018261' TO DFHEIV0
 21797     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21798     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21799     MOVE X'2020233030303138323631' TO DFHEIV0(25:11)
 21800     CALL 'kxdfhei1' USING DFHEIV0,
 21801           QID,
 21802           DFHEIV99
 21803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21804
 21805
 21806     GO TO 6050-EXIT.
 21807
 21808 6050-QID-ERROR.
 21809     MOVE ER-0033                TO EMI-ERROR
 21810     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21811
 21812 6050-EXIT.
 21813      EXIT.
 21814
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 401
* EL6311.cbl
 21816
 21817******************************************************************
 21818*                                                                *
 21819*            T E R M   C O N V E R S I O N                       *
 21820*                                                                *
 21821******************************************************************
 21822
 21823 6100-TERM-CONVERSION.
 21824
 21825     IF PI-BPMTS = ZERO
 21826         GO TO 6199-EXIT.
 21827
 21828     IF PI-BMODE = ' ' OR 'M'
 21829         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21830         GO TO 6105-ROUND-TERM.
 21831
 21832     IF PI-BMODE = 'S'
 21833         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21834         GO TO 6105-ROUND-TERM.
 21835
 21836     IF PI-BMODE = 'W'
 21837         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21838         GO TO 6105-ROUND-TERM.
 21839
 21840     IF PI-BMODE = 'B'
 21841         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21842         GO TO 6105-ROUND-TERM.
 21843
 21844     IF PI-BMODE = 'T'
 21845         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21846
 21847 6105-ROUND-TERM.
 21848
 21849     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21850         ADD +1                  TO WS-CALC-TERM-WHOLE
 21851         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21852
 21853     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21854         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21855
 21856     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21857         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21858                                      WS-BTERM    (WS-SUB1)
 21859         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21860
 21861     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21862         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21863             MOVE -1               TO BMODEL
 21864             MOVE ER-2593          TO EMI-ERROR
 21865             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21866             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21867
 21868 6124-CHECK-BENEFIT.
 21869
 21870     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21871        GO TO 6126-COMPUTE-BENEFIT.
 21872
 21873     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 402
* EL6311.cbl
 21874
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 403
* EL6311.cbl
 21876******************************************************************
 21877**         COMPUTE TERM AND BENEFIT
 21878******************************************************************
 21879 6125-COMPUTE-TERM-BENEFIT.
 21880
 21881     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21882        PI-BPMTAMT = ZERO
 21883         GO TO 6199-EXIT.
 21884
 21885     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21886                                     WS-BTERM  (WS-SUB1).
 21887     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21888
 21889 6126-COMPUTE-BENEFIT.
 21890
 21891     IF PI-BMODE = 'M' OR  ' '
 21892         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21893
 21894     IF PI-BMODE = 'W'
 21895         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21896
 21897     IF PI-BMODE = 'S'
 21898         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21899
 21900     IF PI-BMODE = 'B'
 21901         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21902
 21903     IF PI-BMODE = 'T'
 21904         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21905
 21906     IF WS-SUB1 = +1
 21907        COMPUTE WS-BBEN (WS-SUB1) =
 21908                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21909
 21910     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21911     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21912     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21913
 21914 6199-EXIT.
 21915     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 404
* EL6311.cbl
 21917
 21918******************************************************************
 21919*                                                                *
 21920*             D I S P L A Y   I S S U E S                        *
 21921*                                                                *
 21922******************************************************************
 21923
 21924 6200-CREATE-VADS.
 21925     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21926     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21927     MOVE SPACES                 TO WS-PASS-VADS-REC
 21928
 21929* EXEC CICS GETMAIN
 21930*       SET      (ADDRESS OF PENDING-BUSINESS)
 21931*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21932*       INITIMG  (GETMAIN-SPACE)
 21933*       RESP     (WS-RESPONSE)
 21934*    END-EXEC
 21935*    MOVE ',"IL                  $  N#00018387' TO DFHEIV0
 21936     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21937     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21938     MOVE X'204E233030303138333837' TO DFHEIV0(25:11)
 21939     CALL 'kxdfhei1' USING DFHEIV0,
 21940           DFHEIV20,
 21941           ERPNDB-RECORD-LENGTH,
 21942           GETMAIN-SPACE
 21943     SET ADDRESS OF PENDING-BUSINESS TO
 21944         DFHEIV20
 21945     MOVE EIBRESP  TO WS-RESPONSE
 21946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21947
 21948* EXEC CICS READ
 21949*       INTO    (PENDING-BUSINESS)
 21950*       DATASET (FILE-ID-ERPNDB)
 21951*       RIDFLD  (ERPNDB-KEY)
 21952*       RESP    (WS-RESPONSE)
 21953*    END-EXEC
 21954     MOVE LENGTH OF
 21955      PENDING-BUSINESS
 21956       TO DFHEIV11
 21957*    MOVE '&"IL       E          (  N#00018393' TO DFHEIV0
 21958     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21959     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21960     MOVE X'204E233030303138333933' TO DFHEIV0(25:11)
 21961     CALL 'kxdfhei1' USING DFHEIV0,
 21962           FILE-ID-ERPNDB,
 21963           PENDING-BUSINESS,
 21964           DFHEIV11,
 21965           ERPNDB-KEY,
 21966           DFHEIV99,
 21967           DFHEIV99,
 21968           DFHEIV99
 21969     MOVE EIBRESP  TO WS-RESPONSE
 21970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21971     IF RESP-NORMAL
 21972        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21973        IF (RESP-NORMAL)
 21974           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 405
* EL6311.cbl
 21975              AM-CONTROL-PRIMARY (1:20))
 21976           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21977        ELSE
 21978           MOVE 'ACCOUNT NOT FOUND'
 21979                                 TO VD-ACCOUNT-NAME
 21980        END-IF
 21981        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21982                                    TO M1
 21983        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21984        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21985           (A2 > M1)
 21986           OR (WS-WORK-FIELD (A2:1) = '*')
 21987           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21988           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21989        END-PERFORM
 21990        IF A2 > M1
 21991           CONTINUE
 21992        ELSE
 21993           MOVE WS-WORK-FIELD (1:A2 - 1)
 21994                                    TO VD-ACCOUNT-NAME
 21995        END-IF
 21996        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21997        MOVE PB-CARRIER          TO VD-CARRIER
 21998        MOVE PB-GROUPING         TO VD-GROUPING
 21999        MOVE PB-STATE            TO VD-STATE
 22000        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 22001        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 22002        MOVE PB-CERT-NO          TO VD-CERT-NO
 22003        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 22004        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 22005        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 22006        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 22007        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 22008        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 22009        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 22010        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 22011        MOVE PB-CSR-ID           TO VD-CSR-ID
 22012        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 22013        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 22014        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 22015        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 22016        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 22017        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 22018        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 22019        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 22020        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 22021        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 22022        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 22023        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 22024        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 22025     END-IF
 22026     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 22027
 22028
 22029* EXEC CICS GETMAIN
 22030*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 22031*       LENGTH   (ERPNDM-RECORD-LENGTH)
 22032*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 406
* EL6311.cbl
 22033*       RESP     (WS-RESPONSE)
 22034*    END-EXEC
 22035*    MOVE ',"IL                  $  N#00018456' TO DFHEIV0
 22036     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22037     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22038     MOVE X'204E233030303138343536' TO DFHEIV0(25:11)
 22039     CALL 'kxdfhei1' USING DFHEIV0,
 22040           DFHEIV20,
 22041           ERPNDM-RECORD-LENGTH,
 22042           GETMAIN-SPACE
 22043     SET ADDRESS OF PENDING-MAILING-DATA TO
 22044         DFHEIV20
 22045     MOVE EIBRESP  TO WS-RESPONSE
 22046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22047
 22048
 22049* EXEC CICS READ
 22050*       INTO    (PENDING-MAILING-DATA)
 22051*       DATASET (FILE-ID-ERPNDM)
 22052*       RIDFLD  (ERPNDM-KEY)
 22053*       RESP    (WS-RESPONSE)
 22054*    END-EXEC
 22055     MOVE LENGTH OF
 22056      PENDING-MAILING-DATA
 22057       TO DFHEIV11
 22058*    MOVE '&"IL       E          (  N#00018463' TO DFHEIV0
 22059     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22060     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22061     MOVE X'204E233030303138343633' TO DFHEIV0(25:11)
 22062     CALL 'kxdfhei1' USING DFHEIV0,
 22063           FILE-ID-ERPNDM,
 22064           PENDING-MAILING-DATA,
 22065           DFHEIV11,
 22066           ERPNDM-KEY,
 22067           DFHEIV99,
 22068           DFHEIV99,
 22069           DFHEIV99
 22070     MOVE EIBRESP  TO WS-RESPONSE
 22071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22072
 22073     IF RESP-NORMAL
 22074        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 22075        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 22076        MOVE PM-CITY              TO VD-INSURED-CITY
 22077        MOVE PM-STATE             TO VD-INSURED-STATE
 22078        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 22079     END-IF
 22080
 22081     MOVE 'VAC1'                  TO VD-LETTER-ID
 22082     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 22083     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 22084     MOVE EIBTIME                 TO VD-CURRENT-TIME
 22085     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 22086     MOVE +0                      TO VD-ARCHIVE-NO
 22087     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 22088     .
 22089 6200-EXIT.
 22090     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 407
* EL6311.cbl
 22091 6210-READ-ERACCT.
 22092     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 22093     MOVE LOW-VALUES             TO ERACCT-FILL
 22094
 22095* EXEC CICS READ
 22096*         DATASET   ('ERACCT')
 22097*         INTO      (ACCOUNT-MASTER)
 22098*         RIDFLD    (ERACCT-KEY)
 22099*         GTEQ
 22100*         RESP      (WS-RESPONSE)
 22101*    END-EXEC
 22102     MOVE LENGTH OF
 22103      ACCOUNT-MASTER
 22104       TO DFHEIV11
 22105     MOVE 'ERACCT' TO DFHEIV1
 22106*    MOVE '&"IL       G          (  N#00018491' TO DFHEIV0
 22107     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22108     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22109     MOVE X'204E233030303138343931' TO DFHEIV0(25:11)
 22110     CALL 'kxdfhei1' USING DFHEIV0,
 22111           DFHEIV1,
 22112           ACCOUNT-MASTER,
 22113           DFHEIV11,
 22114           ERACCT-KEY,
 22115           DFHEIV99,
 22116           DFHEIV99,
 22117           DFHEIV99
 22118     MOVE EIBRESP  TO WS-RESPONSE
 22119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22120     .
 22121 6210-EXIT.
 22122     EXIT.
 22123
 22124 6220-READ-ERMAIL.
 22125
 22126     MOVE ELCERT-KEY             TO ERMAIL-KEY
 22127     MOVE ' '                    TO WS-ERMAIL-SW
 22128
 22129
 22130* EXEC CICS READ
 22131*       DATASET   (FILE-ID-ERMAIL)
 22132*       SET       (ADDRESS OF MAILING-DATA)
 22133*       RIDFLD    (ERMAIL-KEY)
 22134*       RESP      (WS-RESPONSE)
 22135*    END-EXEC
 22136*    MOVE '&"S        E          (  N#00018507' TO DFHEIV0
 22137     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22138     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22139     MOVE X'204E233030303138353037' TO DFHEIV0(25:11)
 22140     CALL 'kxdfhei1' USING DFHEIV0,
 22141           FILE-ID-ERMAIL,
 22142           DFHEIV20,
 22143           DFHEIV99,
 22144           ERMAIL-KEY,
 22145           DFHEIV99,
 22146           DFHEIV99,
 22147           DFHEIV99
 22148     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 408
* EL6311.cbl
 22149         DFHEIV20
 22150     MOVE EIBRESP  TO WS-RESPONSE
 22151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22152
 22153     IF RESP-NORMAL
 22154        SET ERMAIL-FOUND TO TRUE
 22155     END-IF
 22156     .
 22157 6220-EXIT.
 22158     EXIT.
 22159
 22160 6400-CHECK-FOR-RES-REF-CLAIM.
 22161     display 'made it to 6400- for ' pi-cert-no
 22162     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22163
 22164     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22165                                    W-CL-COMP-CD.
 22166     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22167                                    W-CL-CERT-NO.
 22168     MOVE SPACES                 TO MSTR-CERT-SFX.
 22169
 22170
 22171* EXEC CICS HANDLE CONDITION
 22172*        NOTFND  (6400-CONTINUE)
 22173*        ENDFILE (6400-CONTINUE)
 22174*    END-EXEC.
 22175*    MOVE '"$I''                  ! X #00018531' TO DFHEIV0
 22176     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22177     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22178     MOVE X'5820233030303138353331' TO DFHEIV0(25:11)
 22179     CALL 'kxdfhei1' USING DFHEIV0
 22180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22181
 22182
 22183
 22184* EXEC CICS IGNORE CONDITION
 22185*        DUPKEY
 22186*    END-EXEC.
 22187*    MOVE '"*$                   !   #00018536' TO DFHEIV0
 22188     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22189     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22190     MOVE X'2020233030303138353336' TO DFHEIV0(25:11)
 22191     CALL 'kxdfhei1' USING DFHEIV0
 22192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22193
 22194
 22195
 22196* EXEC CICS STARTBR
 22197*        DATASET   (CLMS-ID)
 22198*        RIDFLD    (ELMSTR-KEY)
 22199*        GENERIC   EQUAL
 22200*        KEYLENGTH (ELMSTR-LENGTH)
 22201*    END-EXEC.
 22202     MOVE 0
 22203       TO DFHEIV11
 22204*    MOVE '&,   KG    E          &   #00018540' TO DFHEIV0
 22205     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22206     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 409
* EL6311.cbl
 22207     MOVE X'2020233030303138353430' TO DFHEIV0(25:11)
 22208     CALL 'kxdfhei1' USING DFHEIV0,
 22209           CLMS-ID,
 22210           ELMSTR-KEY,
 22211           ELMSTR-LENGTH,
 22212           DFHEIV11,
 22213           DFHEIV99
 22214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22215
 22216
 22217     display 'browse started'
 22218     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22219
 22220 6400-NEXT-CLAIM.
 22221
 22222
 22223* EXEC CICS READNEXT
 22224*        DATASET   (CLMS-ID)
 22225*        RIDFLD    (ELMSTR-KEY)
 22226*        SET       (ADDRESS OF CLAIM-MASTER)
 22227*    END-EXEC.
 22228     MOVE 0
 22229       TO DFHEIV11
 22230*    MOVE '&.S                   )   #00018552' TO DFHEIV0
 22231     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22232     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22233     MOVE X'2020233030303138353532' TO DFHEIV0(25:11)
 22234     CALL 'kxdfhei1' USING DFHEIV0,
 22235           CLMS-ID,
 22236           DFHEIV20,
 22237           DFHEIV99,
 22238           ELMSTR-KEY,
 22239           DFHEIV99,
 22240           DFHEIV11,
 22241           DFHEIV99,
 22242           DFHEIV99
 22243     SET ADDRESS OF CLAIM-MASTER TO
 22244         DFHEIV20
 22245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22246
 22247
 22248     display 'read claim for ' mstr-cert-no
 22249     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22250        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22251         GO TO 6400-CONTINUE
 22252     END-IF.
 22253
 22254     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22255        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22256        PI-STATE       NOT = CL-CERT-STATE     OR
 22257        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22258        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22259         GO TO 6400-NEXT-CLAIM
 22260     END-IF.
 22261
 22262     display 'found claim ' cl-claim-no
 22263        ' with denial type ' cl-denial-type
 22264     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 410
* EL6311.cbl
 22265         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22266         GO TO 6400-CONTINUE
 22267     END-IF.
 22268
 22269     GO TO 6400-NEXT-CLAIM.
 22270
 22271 6400-CONTINUE.
 22272
 22273     IF WS-BROWSE-STARTED-SW = 'Y'
 22274
 22275* EXEC CICS ENDBR
 22276*            DATASET   (CLMS-ID)
 22277*        END-EXEC
 22278     MOVE 0
 22279       TO DFHEIV11
 22280*    MOVE '&2                    $   #00018584' TO DFHEIV0
 22281     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22282     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22283     MOVE X'2020233030303138353834' TO DFHEIV0(25:11)
 22284     CALL 'kxdfhei1' USING DFHEIV0,
 22285           CLMS-ID,
 22286           DFHEIV11,
 22287           DFHEIV99
 22288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22289         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22290     END-IF.
 22291
 22292 6400-EXIT.
 22293     EXIT.
 22294
 22295 7000-DISPLAY-ISSUES.
 22296
 22297     IF PI-DISPLAY-ORIGINAL-BATCH
 22298        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22299        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22300     ELSE
 22301        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22302
 22303     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22304
 22305     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22306     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22307
 22308     MOVE LOW-VALUES                 TO EL631BI.
 22309     MOVE ZEROS                      TO PI-BPMTAMT
 22310                                        PI-BPMTS.
 22311     MOVE SPACE                      TO PI-BMODE
 22312                                        PI-BTYPE (1)
 22313                                        PI-BTYPE (2).
 22314     MOVE EL631B                     TO PI-MAP-NAME.
 22315     MOVE 'Y'                        TO PI-BROWSE-SW.
 22316     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22317                                        PI-HIGH-SEQ-NO.
 22318
 22319     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22320        MOVE AL-SABOF                TO BCHGTA
 22321        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22322        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 411
* EL6311.cbl
 22323     ELSE
 22324        MOVE AL-SADOF                TO BCHGTA
 22325                                        BCHGA
 22326        MOVE PB-CHG-COUNT            TO BCHGO.
 22327
 22328     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22329     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22330     MOVE WS-HR-MINS                 TO BMANTATO.
 22331
 22332     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22333        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22334        MOVE SPACE                   TO DC-OPTION-CODE
 22335        PERFORM 9700-DATE-LINK
 22336        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22337        MOVE 'INACTIVE'              TO BMOENDTO
 22338     ELSE
 22339        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22340        MOVE SPACE                   TO DC-OPTION-CODE
 22341        PERFORM 9700-DATE-LINK
 22342        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22343        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22344        MOVE SPACE                   TO DC-OPTION-CODE
 22345        PERFORM 9700-DATE-LINK
 22346        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22347
 22348*    MOVE PB-I-REFERENCE             TO BREFO.
 22349
 22350*    IF PI-COMPANY-ID EQUAL 'HER'
 22351*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22352*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22353*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22354*                MOVE WS-MEMBER-NO-1-8
 22355*                                TO  BMICRNOO.
 22356
 22357*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22358*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22359*            MOVE PB-I-MICROFILM-NO
 22360*                                TO  BMICRNOO.
 22361     IF PB-I-VIN NOT = SPACES
 22362        MOVE PB-I-VIN            TO BVINO
 22363     END-IF
 22364
 22365     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22366     MOVE PB-CERT-SFX                TO BSUFIXO.
 22367     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22368     MOVE SPACE                      TO DC-OPTION-CODE.
 22369     PERFORM 9700-DATE-LINK.
 22370     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22371
 22372     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22373     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22374     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22375     MOVE PB-I-INSURED-SEX           TO BSEXO
 22376
 22377     IF PB-I-AGE NOT = ZEROS
 22378         MOVE PB-I-AGE               TO BAGEO.
 22379
 22380     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 412
* EL6311.cbl
 22381                                 TO ELCERT-KEY
 22382     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22383     IF NOT CERT-TRL-REC-NOT-FOUND
 22384         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22385             MOVE 'AGE*'             TO BAGEDEFO
 22386         ELSE
 22387             MOVE 'AGE '             TO BAGEDEFO
 22388         END-IF
 22389     ELSE
 22390         MOVE 'AGE '             TO BAGEDEFO
 22391     END-IF
 22392
 22393     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22394         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22395         MOVE SPACE                  TO DC-OPTION-CODE
 22396         PERFORM 9700-DATE-LINK
 22397         IF NO-CONVERSION-ERROR
 22398            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22399
 22400     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22401         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22402         MOVE SPACE                  TO DC-OPTION-CODE
 22403         PERFORM 9700-DATE-LINK
 22404         IF NO-CONVERSION-ERROR
 22405            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22406
 22407     IF PB-I-EXTENTION-DAYS NUMERIC
 22408        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22409           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22410        ELSE
 22411           IF PB-I-TERM-IN-DAYS NUMERIC
 22412              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22413                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22414
 22415     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22416        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22417
 22418     MOVE PB-FORCE-CODE              TO BFORCEO.
 22419     MOVE PB-I-TERM-TYPE             TO BMODEO
 22420                                        PI-BMODE.
 22421
 22422     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22423        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22424
 22425     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22426         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22427                                        PI-BPMTS.
 22428
 22429     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22430         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22431           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22432                                        PI-BPMTAMT.
 22433
 22434     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22435     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22436     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22437     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22438     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 413
* EL6311.cbl
 22439     MOVE PB-I-SIG-SW                TO BSIGO.
 22440     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22441     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22442     MOVE PB-RECORD-BILL             TO BBILCDO.
 22443     MOVE PB-FORCE-CODE              TO BFORCEO.
 22444
 22445     IF (PB-I-LIVES NUMERIC)
 22446        AND (PB-I-LIVES > ZEROS)
 22447        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22448        IF (RESP-NORMAL)
 22449           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22450           CONTINUE
 22451        ELSE
 22452           MOVE PB-I-LIVES       TO BLIVESO
 22453        END-IF
 22454     END-IF
 22455
 22456     IF PB-I-NUM-BILLED NUMERIC AND
 22457        PB-I-NUM-BILLED GREATER THAN ZEROS
 22458        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22459*    ELSE
 22460*       MOVE ZEROS                   TO BBILLEDO.
 22461
 22462     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22463
 22464     IF PB-I-LOAN-APR NOT = +99.9999
 22465        MOVE PB-I-LOAN-APR           TO BAPRO.
 22466
 22467     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22468        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22469
 22470     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22471        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22472           MOVE AL-SANOF                TO BORIGHDA
 22473           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22474           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22475
 22476     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22477
 22478     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22479        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22480
 22481     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22482        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22483                                        PI-BTYPE (1).
 22484
 22485     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22486        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22487
 22488     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22489        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22490
 22491     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22492        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22493
 22494     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22495        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22496
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 414
* EL6311.cbl
 22497     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22498        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22499
 22500     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22501         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22502         MOVE SPACE                  TO DC-OPTION-CODE
 22503         PERFORM 9700-DATE-LINK
 22504         IF NO-CONVERSION-ERROR
 22505            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22506
 22507     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22508        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22509        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22510        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22511        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22512                 GIVING BDIFFO (1)
 22513     ELSE
 22514        MOVE SPACES                  TO BBEN-CD     (1)
 22515                                        BBEN-ABBR   (1).
 22516
 22517     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22518        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22519        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22520                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22521
 22522     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22523       IF PB-RECORD-ON-HOLD
 22524          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22525
 22526     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22527       IF PB-RECORD-RETURNED
 22528          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22529
 22530     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22531        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22532             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22533
 22534     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22535
 22536     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22537        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22538
 22539     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22540        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22541                                        PI-BTYPE (2).
 22542
 22543     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22544        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22545
 22546     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22547        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22548
 22549     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22550        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22551
 22552     IF PB-I-TOT-FEES NOT NUMERIC
 22553        MOVE ZEROS               TO PB-I-TOT-FEES
 22554     END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 415
* EL6311.cbl
 22555     IF PB-I-TOT-FEES > ZEROS
 22556        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22557
 22558     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22559         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22560         MOVE SPACE                  TO DC-OPTION-CODE
 22561         PERFORM 9700-DATE-LINK
 22562         IF NO-CONVERSION-ERROR
 22563            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22564
 22565     IF PB-I-TOT-FEES > ZEROS
 22566        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22567        SUBTRACT PB-I-TOT-FEES FROM
 22568                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22569
 22570     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22571        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22572        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22573        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22574        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22575                 GIVING BDIFFO (2)
 22576     ELSE
 22577        MOVE SPACES                  TO BBEN-CD     (2)
 22578                                        BBEN-ABBR   (2).
 22579
 22580     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22581       IF PB-RECORD-ON-HOLD
 22582          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22583
 22584     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22585       IF PB-RECORD-RETURNED
 22586          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22587
 22588     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22589        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22590             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22591
 22592     MOVE PB-CSR-ID                  TO BCSRO.
 22593
 22594     IF PI-COMPANY-ID  =  'DMD'
 22595        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22596            NEXT SENTENCE
 22597        ELSE
 22598            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22599               MOVE 'NEW CERT'       TO BNCERTLI
 22600               MOVE EC-NEW-CERT      TO BNCERTO.
 22601
 22602     IF PI-COMPANY-ID  =  'DMD'
 22603        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22604            NEXT SENTENCE
 22605        ELSE
 22606           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22607               MOVE 'NEW STATE'      TO BNSTATLI
 22608               MOVE EC-NEW-STATE     TO BNSTATO.
 22609
 22610 7000-CONTINUE.
 22611     MOVE 'C'                        TO BMAINTI.
 22612     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 416
* EL6311.cbl
 22613
 22614     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22615        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22616
 22617     IF PI-6315-FINALIZED = 'Y'   AND
 22618        PB-UNFORCED-ERRORS
 22619          MOVE -1                TO BFORCEL
 22620          MOVE  1                TO SET-CURSOR-SW
 22621     END-IF
 22622
 22623     IF NO-CURSOR-SET
 22624        MOVE -1                      TO BMAINTL.
 22625
 22626     GO TO 8100-SEND-INITIAL-MAP.
 22627
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 417
* EL6311.cbl
 22629
 22630******************************************************************
 22631*                                                                *
 22632*             D I S P L A Y   C A N C E L S                      *
 22633*                                                                *
 22634******************************************************************
 22635
 22636 7100-DISPLAY-CANCELS.
 22637     IF PI-DISPLAY-ORIGINAL-BATCH
 22638        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22639        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22640     ELSE
 22641        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22642
 22643     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22644
 22645     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22646     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22647
 22648     MOVE LOW-VALUES                 TO EL631CI.
 22649     MOVE EL631C                     TO PI-MAP-NAME.
 22650     MOVE 'Y'                        TO PI-BROWSE-SW.
 22651     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22652                                        PI-HIGH-SEQ-NO.
 22653
 22654     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22655        MOVE AL-SABOF                TO CCHGTA
 22656        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22657        MOVE AL-SANON                TO CCHGA
 22658      ELSE
 22659        MOVE AL-SADOF                TO CCHGTA
 22660                                        CCHGA
 22661        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22662
 22663*    MOVE PB-C-REFERENCE             TO CREFO.
 22664
 22665*    IF PB-C-MICROFILM-NO IS NUMERIC
 22666*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22667*          MOVE PB-C-MICROFILM-NO
 22668*                                TO CMICRNOO
 22669*          MOVE AL-UNNON         TO CMICRNOA
 22670*       END-IF
 22671*    END-IF
 22672     IF PB-C-INT-ON-REFS NUMERIC
 22673        IF PB-C-INT-ON-REFS NOT = ZEROS
 22674           MOVE PB-C-INT-ON-REFS
 22675                                 TO CNHINTO
 22676           MOVE AL-SANOF         TO CNHINTA
 22677        END-IF
 22678     END-IF
 22679     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22680     MOVE PB-CERT-SFX                TO CSUFIXO.
 22681     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22682     MOVE SPACE                      TO DC-OPTION-CODE.
 22683     PERFORM 9700-DATE-LINK.
 22684     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22685
 22686     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 418
* EL6311.cbl
 22687        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22688        MOVE SPACE                   TO DC-OPTION-CODE
 22689        PERFORM 9700-DATE-LINK
 22690        IF NO-CONVERSION-ERROR
 22691           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22692
 22693     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22694        NEXT SENTENCE
 22695     ELSE
 22696        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22697
 22698     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22699        NEXT SENTENCE
 22700     ELSE
 22701        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22702
 22703     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22704        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22705        MOVE SPACE                   TO DC-OPTION-CODE
 22706        PERFORM 9700-DATE-LINK
 22707        IF NO-CONVERSION-ERROR
 22708           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22709
 22710     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22711         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22712
 22713     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22714         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22715
 22716     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22717        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22718        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22719                 GIVING CDRFND1O.
 22720
 22721     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22722        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22723        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22724                 GIVING CDRFND2O.
 22725
 22726     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22727       IF PB-RECORD-ON-HOLD
 22728          MOVE 'ON HOLD'             TO CBILIT1O.
 22729
 22730     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22731       IF PB-RECORD-RETURNED
 22732          MOVE 'RETURNED'            TO CBILIT1O.
 22733
 22734     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22735        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22736             MOVE 'OVERRIDE'         TO CBILIT1O.
 22737
 22738     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22739       IF PB-RECORD-ON-HOLD
 22740          MOVE 'ON HOLD'             TO CBILIT2O.
 22741
 22742     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22743       IF PB-RECORD-RETURNED
 22744          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 419
* EL6311.cbl
 22745
 22746     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22747        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22748             MOVE 'OVERRIDE'         TO CBILIT2O.
 22749
 22750     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22751     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22752     IF PB-C-POST-CARD-IND = 'Y'
 22753        MOVE 'Y'                     TO CPCYNO
 22754     ELSE
 22755        MOVE 'N'                     TO CPCYNO
 22756     END-IF
 22757     MOVE PB-FORCE-CODE              TO CFORCEO.
 22758     MOVE PB-RECORD-BILL             TO CBILCDO.
 22759     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22760     MOVE SPACES                     TO CINITSO.
 22761     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22762         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22763     ELSE
 22764         MOVE PB-CI-INITIALS         TO CINITSO
 22765     END-IF.
 22766
 22767     IF PB-CI-CANCEL-FEE NUMERIC
 22768        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22769        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22770     ELSE
 22771        MOVE ZEROES                  TO W-CANCEL-FEE.
 22772
 22773     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22774
 22775     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22776        ADD PB-CI-LF-PREMIUM-AMT
 22777             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22778
 22779     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22780        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22781
 22782     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22783     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22784     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22785     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22786
 22787     IF PB-C-LIVES NUMERIC
 22788        MOVE PB-C-LIVES              TO CLIVESO.
 22789
 22790     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22791        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22792
 22793     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22794        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22795        MOVE SPACE                   TO DC-OPTION-CODE
 22796        PERFORM 9700-DATE-LINK
 22797        IF NO-CONVERSION-ERROR
 22798           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22799
 22800     IF  PB-C-REFUND-CREATED
 22801         MOVE 'YES'                  TO CRFNDSWO
 22802     ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 420
* EL6311.cbl
 22803         IF PB-C-REFUND-REQUESTED
 22804            MOVE 'REQ'               TO CRFNDSWO
 22805         ELSE
 22806            MOVE 'NO'                TO CRFNDSWO.
 22807
 22808     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22809     MOVE SPACE                      TO DC-OPTION-CODE.
 22810     PERFORM 9700-DATE-LINK.
 22811     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22812     MOVE PB-INPUT-BY                TO CENTBYO.
 22813
 22814     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22815        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22816        MOVE SPACE                   TO DC-OPTION-CODE
 22817        PERFORM 9700-DATE-LINK
 22818        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22819        MOVE 'INACTIVE'              TO CMOENDTO
 22820     ELSE
 22821        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22822        MOVE SPACE                   TO DC-OPTION-CODE
 22823        PERFORM 9700-DATE-LINK
 22824        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22825        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22826        MOVE SPACE                   TO DC-OPTION-CODE
 22827        PERFORM 9700-DATE-LINK
 22828        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22829
 22830     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22831
 22832     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22833     MOVE WS-HR-MINS                 TO CMANTATO.
 22834
 22835     EVALUATE PB-LF-REFUND-TYPE
 22836        WHEN '1'
 22837           MOVE 'RULE78'            TO CLFREFNO
 22838        WHEN '2'
 22839           MOVE 'PRORAT'            TO CLFREFNO
 22840        WHEN '3'
 22841           MOVE 'CALIF'             TO CLFREFNO
 22842        WHEN '4'
 22843           MOVE 'IRREG'             TO CLFREFNO
 22844        WHEN '5'
 22845           MOVE 'NETPAY'            TO CLFREFNO
 22846        WHEN '6'
 22847           MOVE 'ATCP'              TO CLFREFNO
 22848        WHEN '7'
 22849           MOVE 'UTAH'              TO CLFREFNO
 22850        WHEN '8'
 22851           MOVE 'MEAN'              TO CLFREFNO
 22852        WHEN '9'
 22853           MOVE 'SUM '              TO CLFREFNO
 22854        WHEN 'B'
 22855           MOVE 'BALN'              TO CLFREFNO
 22856     END-EVALUATE.
 22857
 22858     EVALUATE TRUE
 22859        WHEN PB-AH-REFUND-TYPE =  '1'
 22860           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 421
* EL6311.cbl
 22861        WHEN PB-AH-REFUND-TYPE =  '2'
 22862           MOVE 'PRORAT'            TO CAHREFNO
 22863        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22864           MOVE 'CALIF'             TO CAHREFNO
 22865        WHEN PB-AH-REFUND-TYPE =  '4'
 22866           MOVE 'IRREG'             TO CAHREFNO
 22867        WHEN PB-AH-REFUND-TYPE =  '5'
 22868           MOVE 'NETPAY'            TO CAHREFNO
 22869        WHEN PB-AH-REFUND-TYPE =  '6'
 22870           MOVE 'ATCP'              TO CAHREFNO
 22871        WHEN PB-AH-REFUND-TYPE =  '7'
 22872           MOVE 'UTAH'              TO CAHREFNO
 22873        WHEN PB-AH-REFUND-TYPE =  '8'
 22874           MOVE 'MEAN'              TO CAHREFNO
 22875        WHEN PB-AH-REFUND-TYPE =  '9'
 22876           MOVE 'SUM '              TO CAHREFNO
 22877        WHEN PB-AH-REFUND-TYPE =  'B'
 22878           MOVE 'BALN'              TO CAHREFNO
 22879     END-EVALUATE.
 22880
 22881     MOVE PB-REIN-CD                 TO CREINCDO.
 22882
 22883     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22884        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22885        MOVE SPACE                   TO DC-OPTION-CODE
 22886        PERFORM 9700-DATE-LINK
 22887        IF NO-CONVERSION-ERROR
 22888           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22889
 22890     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22891        MOVE 999999                  TO WS-EXP-DT-EDIT
 22892        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22893        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22894     ELSE
 22895        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22896           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22897           MOVE SPACE                   TO DC-OPTION-CODE
 22898           PERFORM 9700-DATE-LINK
 22899           IF NO-CONVERSION-ERROR
 22900              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22901
 22902     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22903        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22904           MOVE AL-SANOF                TO CORIGHDA
 22905           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22906           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22907
 22908     MOVE PB-CSR-ID              TO CCSRO.
 22909
 22910     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22911     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22912
 22913     MOVE 'C'                    TO CMAINTI.
 22914     MOVE AL-UANON               TO CMAINTA.
 22915
 22916     IF PI-6316-FINALIZED = 'Y'  AND
 22917        PB-UNFORCED-ERRORS
 22918          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 422
* EL6311.cbl
 22919          MOVE  1                TO SET-CURSOR-SW
 22920     END-IF
 22921
 22922     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22923        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22924
 22925     IF NO-CURSOR-SET
 22926        MOVE -1                  TO CMAINTL.
 22927
 22928     GO TO 8100-SEND-INITIAL-MAP.
 22929
 22930
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 423
* EL6311.cbl
 22932***************************************************************
 22933*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22934*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22935***************************************************************
 22936
 22937 7200-DISPLAY-BATCHES.
 22938     MOVE EL631D                 TO PI-MAP-NAME.
 22939     MOVE LOW-VALUES             TO EL631DI.
 22940
 22941     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22942
 22943
 22944* EXEC CICS HANDLE CONDITION
 22945*         NOTFND   (3690-NOT-FOUND)
 22946*    END-EXEC.
 22947*    MOVE '"$I                   ! Y #00019241' TO DFHEIV0
 22948     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22949     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22950     MOVE X'5920233030303139323431' TO DFHEIV0(25:11)
 22951     CALL 'kxdfhei1' USING DFHEIV0
 22952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22953
 22954
 22955     IF PI-DISPLAY-SCREEN
 22956        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22957     ELSE
 22958        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22959
 22960     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22961     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22962
 22963
 22964* EXEC CICS READ
 22965*         DATASET   (FILE-ID-ERPNDB)
 22966*         RIDFLD    (ERPNDB-KEY)
 22967*         SET       (ADDRESS OF PENDING-BUSINESS)
 22968*    END-EXEC.
 22969*    MOVE '&"S        E          (   #00019253' TO DFHEIV0
 22970     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22971     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22972     MOVE X'2020233030303139323533' TO DFHEIV0(25:11)
 22973     CALL 'kxdfhei1' USING DFHEIV0,
 22974           FILE-ID-ERPNDB,
 22975           DFHEIV20,
 22976           DFHEIV99,
 22977           ERPNDB-KEY,
 22978           DFHEIV99,
 22979           DFHEIV99,
 22980           DFHEIV99
 22981     SET ADDRESS OF PENDING-BUSINESS TO
 22982         DFHEIV20
 22983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22984
 22985
 22986     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22987     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22988     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22989     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 424
* EL6311.cbl
 22990     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22991
 22992     MOVE EL631D                 TO PI-MAP-NAME.
 22993     MOVE LOW-VALUES             TO EL631DI.
 22994     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22995
 22996*    IF PI-AR-PROCESSING
 22997*       MOVE PB-REFERENCE        TO DREFO.
 22998
 22999     MOVE PB-CSR-ID              TO DCSRO.
 23000
 23001     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 23002        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 23003        MOVE SPACE               TO DC-OPTION-CODE
 23004        PERFORM 9700-DATE-LINK
 23005        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 23006        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 23007        MOVE 'INACTIVE'          TO DLDATEO
 23008     ELSE
 23009        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 23010        MOVE SPACE               TO DC-OPTION-CODE
 23011        PERFORM 9700-DATE-LINK
 23012        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 23013
 23014     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 23015     MOVE SPACE                  TO DC-OPTION-CODE.
 23016     PERFORM 9700-DATE-LINK.
 23017     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 23018
 23019     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 23020        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 23021     ELSE
 23022        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 23023        MOVE SPACE               TO DC-OPTION-CODE
 23024        PERFORM 9700-DATE-LINK
 23025        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 23026
 23027     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 23028     MOVE SPACE                  TO DC-OPTION-CODE.
 23029     PERFORM 9700-DATE-LINK.
 23030     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 23031
 23032     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 23033     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 23034
 23035     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 23036        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 23037                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 23038
 23039     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 23040     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 23041     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 23042
 23043     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 23044        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 23045                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 23046
 23047     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 425
* EL6311.cbl
 23048     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 23049     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 23050
 23051     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 23052        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 23053                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 23054
 23055     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 23056     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 23057
 23058     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 23059        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 23060                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 23061
 23062     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 23063     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 23064     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 23065
 23066     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 23067        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 23068                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 23069
 23070     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 23071     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 23072     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 23073
 23074     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 23075        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 23076                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 23077
 23078     MOVE -1                     TO DPFENTRL.
 23079     GO TO 8100-SEND-INITIAL-MAP.
 23080
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 426
* EL6311.cbl
 23082
 23083***************************************************************
 23084*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 23085*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 23086*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 23087*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 23088*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 23089*     ARE THEN SET ACCORDINGLY.                               *
 23090*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 23091*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 23092*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 23093***************************************************************
 23094
 23095******************************************************************
 23096*                                                                *
 23097*            E R R O R   A N A L Y S I S                         *
 23098*                                                                *
 23099******************************************************************
 23100
 23101******************************************************************
 23102*                                                                *
 23103*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 23104*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 23105*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 23106*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 23107*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 23108*                                                                *
 23109*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 23110*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 23111*                                                                *
 23112******************************************************************
 23113
 23114 7300-FORMAT-ERRORS.
 23115     MOVE ' '                    TO PI-ERRORS-SW
 23116     IF PB-COMMON-ERRORS = LOW-VALUES
 23117        IF PB-FATAL-ERRORS
 23118           MOVE ER-2695          TO EMI-ERROR
 23119           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23120           GO TO 7399-EXIT.
 23121
 23122     MOVE +0                     TO WS-SUB4.
 23123
 23124 7310-ERROR-LOOP.
 23125
 23126     ADD +1                      TO WS-SUB4.
 23127
 23128     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23129        GO TO 7350-SET-ERROR-FLAGS.
 23130
 23131     IF PI-COMPANY-ID = 'UCL'
 23132         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 23133             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 23134             MOVE ' '                   TO DC-OPTION-CODE
 23135             PERFORM 9700-DATE-LINK
 23136             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 23137
 23138     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 23139     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 427
* EL6311.cbl
 23140     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 23141
 23142     GO TO 7310-ERROR-LOOP.
 23143
 23144
 23145 7350-SET-ERROR-FLAGS.
 23146
 23147     IF EMI-FATAL-CTR NOT = ZEROS
 23148        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23149        MOVE 'X'                 TO PB-FATAL-FLAG
 23150                                    PI-ERRORS-SW
 23151        GO TO 7355-SET-ERROR-FLAGS.
 23152
 23153     move ' ' to pi-unforced-sw
 23154     IF EMI-FORCABLE-CTR NOT = ZEROS
 23155        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23156        IF PB-ISSUE
 23157           IF PB-ISSUE-FORCE
 23158              MOVE 'F'           TO PB-FORCE-ER-CD
 23159              MOVE ER-2600       TO EMI-ERROR
 23160              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23161             ELSE
 23162              MOVE 'X'           TO PB-FORCE-ER-CD
 23163*                                   PI-ERRORS-SW
 23164          ELSE
 23165           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23166              MOVE 'F'           TO PB-FORCE-ER-CD
 23167                                    pi-unforced-sw
 23168              MOVE ER-2600       TO EMI-ERROR
 23169              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23170             ELSE
 23171              MOVE 'X'           TO PB-FORCE-ER-CD
 23172                                    pi-unforced-sw.
 23173*                                   PI-ERRORS-SW.
 23174
 23175     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23176     IF PB-ISSUE
 23177         MOVE 'I'                TO ENDT-RECORD-TYPE
 23178     ELSE
 23179         MOVE 'C'                TO ENDT-RECORD-TYPE
 23180     END-IF
 23181     MOVE +0                     TO ENDT-SEQ-NO
 23182
 23183
 23184* EXEC CICS READ
 23185*        DATASET   (FILE-ID-ERENDT)
 23186*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23187*        RIDFLD    (ERENDT-KEY)
 23188*        RESP      (WS-RESPONSE)
 23189*        GTEQ
 23190*    END-EXEC
 23191*    MOVE '&"S        G          (  N#00019456' TO DFHEIV0
 23192     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23193     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23194     MOVE X'204E233030303139343536' TO DFHEIV0(25:11)
 23195     CALL 'kxdfhei1' USING DFHEIV0,
 23196           FILE-ID-ERENDT,
 23197           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 428
* EL6311.cbl
 23198           DFHEIV99,
 23199           ERENDT-KEY,
 23200           DFHEIV99,
 23201           DFHEIV99,
 23202           DFHEIV99
 23203     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23204         DFHEIV20
 23205     MOVE EIBRESP  TO WS-RESPONSE
 23206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23207
 23208     IF RESP-NORMAL
 23209        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23210        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23211            MOVE ER-0280          TO EMI-ERROR
 23212            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23213            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23214            EVALUATE TRUE
 23215              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23216                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23217              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23218                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23219              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23220                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23221            END-EVALUATE
 23222        END-IF
 23223     END-IF
 23224
 23225
 23226
 23227     IF FIRST-ENTRY OR
 23228        EIBAID = DFHPF1 OR DFHPF2
 23229        MOVE '0'                TO PI-EDIT-SW
 23230        GO TO 7399-EXIT.
 23231
 23232 7355-SET-ERROR-FLAGS.
 23233
 23234     IF EMI-WARNING-CTR NOT = ZEROS
 23235        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23236        MOVE 'W'                 TO PB-WARN-ER-CD.
 23237
 23238     IF PB-UNFORCED-ERRORS OR
 23239        PB-FATAL-ERRORS    OR
 23240        PB-RECORD-ON-HOLD  OR
 23241        PB-RECORD-RETURNED OR
 23242        PB-CANCELLATION
 23243          NEXT SENTENCE
 23244        ELSE
 23245          GO TO 7399-EXIT.
 23246
 23247
 23248* EXEC CICS  HANDLE CONDITION
 23249*           NOTFND   (7399-EXIT)
 23250*    END-EXEC.
 23251*    MOVE '"$I                   ! Z #00019503' TO DFHEIV0
 23252     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23253     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23254     MOVE X'5A20233030303139353033' TO DFHEIV0(25:11)
 23255     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 429
* EL6311.cbl
 23256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23257
 23258
 23259     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23260     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23261     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23262     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23263
 23264
 23265* EXEC CICS READ
 23266*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23267*        DATASET (FILE-ID-ELCERT)
 23268*        RIDFLD  (ELCERT-KEY)
 23269*        UPDATE
 23270*    END-EXEC.
 23271*    MOVE '&"S        EU         (   #00019512' TO DFHEIV0
 23272     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23273     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23274     MOVE X'2020233030303139353132' TO DFHEIV0(25:11)
 23275     CALL 'kxdfhei1' USING DFHEIV0,
 23276           FILE-ID-ELCERT,
 23277           DFHEIV20,
 23278           DFHEIV99,
 23279           ELCERT-KEY,
 23280           DFHEIV99,
 23281           DFHEIV99,
 23282           DFHEIV99
 23283     SET ADDRESS OF CERTIFICATE-MASTER TO
 23284         DFHEIV20
 23285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23286
 23287
 23288
 23289     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23290     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23291
 23292     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23293        GO TO 7360-REWRITE-CERT-MASTER.
 23294
 23295     IF PB-ISSUE
 23296        IF PB-RECORD-RETURNED
 23297            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23298            GO TO 7360-REWRITE-CERT-MASTER
 23299        ELSE
 23300            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23301            GO TO 7360-REWRITE-CERT-MASTER.
 23302
 23303     IF PB-RECORD-RETURNED
 23304         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 23305         GO TO 7360-REWRITE-CERT-MASTER.
 23306
 23307     IF (PB-C-LF-CANCEL-VOIDED)
 23308        or (pb-c-ah-cancel-voided)
 23309        IF (PB-UNFORCED-ERRORS OR
 23310            PB-FATAL-ERRORS    OR
 23311            PB-RECORD-ON-HOLD)
 23312            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23313            GO TO 7360-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 430
* EL6311.cbl
 23314        ELSE
 23315            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23316            GO TO 7360-REWRITE-CERT-MASTER.
 23317
 23318     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23319                            OR PB-RECORD-ON-HOLD)
 23320        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23321     ELSE
 23322        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23323
 23324 7360-REWRITE-CERT-MASTER.
 23325
 23326     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23327        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23328
 23329* EXEC CICS UNLOCK
 23330*            DATASET    (FILE-ID-ELCERT)
 23331*       END-EXEC
 23332*    MOVE '&*                    #   #00019559' TO DFHEIV0
 23333     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23334     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23335     MOVE X'2020233030303139353539' TO DFHEIV0(25:11)
 23336     CALL 'kxdfhei1' USING DFHEIV0,
 23337           FILE-ID-ELCERT,
 23338           DFHEIV99
 23339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23340        GO TO 7399-EXIT.
 23341
 23342
 23343* EXEC CICS REWRITE
 23344*         DATASET    (FILE-ID-ELCERT)
 23345*         FROM       (CERTIFICATE-MASTER)
 23346*    END-EXEC.
 23347     MOVE LENGTH OF
 23348      CERTIFICATE-MASTER
 23349       TO DFHEIV11
 23350*    MOVE '&& L                  %   #00019564' TO DFHEIV0
 23351     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23352     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23353     MOVE X'2020233030303139353634' TO DFHEIV0(25:11)
 23354     CALL 'kxdfhei1' USING DFHEIV0,
 23355           FILE-ID-ELCERT,
 23356           CERTIFICATE-MASTER,
 23357           DFHEIV11,
 23358           DFHEIV99
 23359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23360
 23361
 23362 7399-EXIT.
 23363      EXIT.
 23364
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 431
* EL6311.cbl
 23366
 23367*************************************************************
 23368*                                                           *
 23369*              S E T   A T T R I B U T E S                  *
 23370*                                                           *
 23371*************************************************************
 23372
 23373 7400-SET-ATTRIBUTES.
 23374
 23375     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23376        GO TO 7499-EXIT.
 23377
 23378**2601**
 23379
 23380     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23381        IF PB-ISSUE
 23382           MOVE AL-UABON         TO BEFFDTA
 23383           GO TO 7499-EXIT
 23384         ELSE
 23385           MOVE AL-UABON         TO CEFFDTA
 23386           GO TO 7499-EXIT.
 23387
 23388**2604**
 23389
 23390     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23391        IF PB-ISSUE
 23392           MOVE AL-UABON         TO BTYPE1A
 23393           MOVE -1               TO BTYPE1L
 23394           MOVE  1               TO SET-CURSOR-SW
 23395           GO TO 7499-EXIT.
 23396
 23397**2605**
 23398
 23399     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23400        IF PB-ISSUE
 23401           MOVE AL-UABON         TO BTYPE2A
 23402           MOVE -1               TO BTYPE2L
 23403           MOVE  1               TO SET-CURSOR-SW
 23404           GO TO 7499-EXIT.
 23405
 23406**2606**
 23407
 23408     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23409        IF PB-ISSUE
 23410           MOVE AL-UABON         TO BSIGA
 23411           MOVE -1               TO BSIGL
 23412           MOVE  1               TO SET-CURSOR-SW
 23413           GO TO 7499-EXIT.
 23414
 23415**2607**
 23416
 23417     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23418        IF PB-ISSUE
 23419           MOVE AL-UABON         TO BSIGA
 23420           MOVE -1               TO BSIGL
 23421           MOVE  1               TO SET-CURSOR-SW
 23422           GO TO 7499-EXIT.
 23423
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 432
* EL6311.cbl
 23424**2615**
 23425
 23426     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23427        IF PB-ISSUE
 23428           MOVE AL-UABOF         TO BREINA
 23429           MOVE -1               TO BREINL
 23430           GO TO 7499-EXIT.
 23431
 23432**2622**
 23433
 23434     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23435        IF PB-ISSUE
 23436           MOVE AL-UABON         TO BEFFDTA
 23437           GO TO 7499-EXIT
 23438        ELSE
 23439           MOVE AL-UABON         TO CEFFDTA
 23440           GO TO 7499-EXIT.
 23441
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 433
* EL6311.cbl
 23443
 23444*************************************************************
 23445*                                                           *
 23446*              I S S U E   E R R O R S                      *
 23447*                                                           *
 23448*************************************************************
 23449
 23450 7420-ISSUE-ERRORS.
 23451
 23452**2626**
 23453
 23454     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23455        MOVE AL-UABON            TO BCERTNOA
 23456        GO TO 7499-EXIT.
 23457
 23458**2627**
 23459
 23460     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23461        MOVE AL-UNBON            TO BAGEA
 23462        MOVE -1                  TO BAGEL
 23463        MOVE  1                  TO SET-CURSOR-SW
 23464        GO TO 7499-EXIT.
 23465
 23466**2628**
 23467
 23468     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23469        MOVE AL-UNBON            TO BAGEA
 23470        MOVE -1                  TO BAGEL
 23471        MOVE  1                  TO SET-CURSOR-SW
 23472        GO TO 7499-EXIT.
 23473
 23474**2629**
 23475
 23476     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23477        MOVE AL-UABON            TO BSEXA
 23478        MOVE -1                  TO BSEXL
 23479        MOVE  1                  TO SET-CURSOR-SW
 23480        GO TO 7499-EXIT.
 23481
 23482**2630**
 23483
 23484     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23485        MOVE -1                  TO BTYPE1L
 23486        MOVE  1                  TO SET-CURSOR-SW
 23487        GO TO 7499-EXIT.
 23488
 23489**2631**
 23490
 23491     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23492        MOVE -1                  TO BTYPE1L
 23493        MOVE  1                  TO SET-CURSOR-SW
 23494        GO TO 7499-EXIT.
 23495
 23496**2632**
 23497
 23498     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23499        MOVE AL-UNBON            TO BBEN1A
 23500        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 434
* EL6311.cbl
 23501        MOVE  1                  TO SET-CURSOR-SW
 23502        GO TO 7499-EXIT.
 23503
 23504**2633**
 23505
 23506     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23507        MOVE AL-UNBON            TO BPREM1A
 23508        MOVE -1                  TO BPREM1L
 23509        MOVE  1                  TO SET-CURSOR-SW
 23510        GO TO 7499-EXIT.
 23511
 23512**2634**
 23513
 23514     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23515        MOVE -1                  TO BTYPE2L
 23516        MOVE  1                  TO SET-CURSOR-SW
 23517        GO TO 7499-EXIT.
 23518
 23519**2635**
 23520
 23521     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23522        MOVE AL-UNBON            TO BBEN2A
 23523        MOVE -1                  TO BBEN2L
 23524        MOVE  1                  TO SET-CURSOR-SW
 23525        GO TO 7499-EXIT.
 23526
 23527**2636**
 23528
 23529     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23530        MOVE AL-UNBON            TO BPREM2A
 23531        MOVE -1                  TO BPREM2L
 23532        MOVE  1                  TO SET-CURSOR-SW
 23533        GO TO 7499-EXIT.
 23534
 23535**2639**
 23536
 23537     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23538        MOVE AL-UNBON            TO BBEN1A
 23539        MOVE -1                  TO BBEN1L
 23540        MOVE  1                  TO SET-CURSOR-SW
 23541        GO TO 7499-EXIT.
 23542
 23543**2640**
 23544
 23545     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23546        MOVE AL-UNBON            TO BBEN2A
 23547        MOVE -1                  TO BBEN2L
 23548        MOVE  1                  TO SET-CURSOR-SW
 23549        GO TO 7499-EXIT.
 23550
 23551**2647**
 23552
 23553     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23554        MOVE AL-UNBON            TO BTERM1A
 23555        MOVE -1                  TO BTERM1L
 23556        MOVE  1                  TO SET-CURSOR-SW
 23557        GO TO 7499-EXIT.
 23558
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 435
* EL6311.cbl
 23559**2648**
 23560
 23561     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23562        MOVE AL-UNBON            TO BLNTRMA
 23563        MOVE -1                  TO BLNTRML
 23564        MOVE  1                  TO SET-CURSOR-SW
 23565        GO TO 7499-EXIT.
 23566
 23567**2649**
 23568
 23569     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23570        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23571            MOVE AL-UNBON            TO BPREM1A
 23572            MOVE -1                  TO BPREM1L
 23573            MOVE  1                  TO SET-CURSOR-SW
 23574            GO TO 7499-EXIT
 23575     ELSE
 23576        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23577           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23578            MOVE AL-UNBON            TO BPREM2A
 23579            MOVE -1                  TO BPREM2L
 23580            MOVE  1                  TO SET-CURSOR-SW
 23581            GO TO 7499-EXIT.
 23582
 23583**2650**
 23584
 23585     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23586        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23587            MOVE AL-UNBON        TO BPREM1A
 23588            MOVE -1              TO BPREM1L
 23589            MOVE  1              TO SET-CURSOR-SW
 23590            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23591                MOVE AL-UNBON        TO BPREM2A
 23592                MOVE -1              TO BPREM2L
 23593                MOVE  1              TO SET-CURSOR-SW
 23594                GO TO 7499-EXIT
 23595            ELSE
 23596                GO TO 7499-EXIT
 23597        ELSE
 23598            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23599                MOVE AL-UNBON        TO BPREM2A
 23600                MOVE -1              TO BPREM2L
 23601                MOVE  1              TO SET-CURSOR-SW
 23602                GO TO 7499-EXIT
 23603            ELSE
 23604                GO TO 7499-EXIT.
 23605
 23606**2651**
 23607
 23608     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23609        MOVE AL-UABON            TO BSIGA
 23610        MOVE -1                  TO BSIGL
 23611        MOVE  1                  TO SET-CURSOR-SW
 23612        GO TO 7499-EXIT.
 23613
 23614**2653**
 23615
 23616     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 436
* EL6311.cbl
 23617        MOVE AL-UABON            TO BFREQA
 23618        MOVE -1                  TO BFREQL
 23619        MOVE  1                  TO SET-CURSOR-SW
 23620        GO TO 7499-EXIT.
 23621
 23622**2654**
 23623
 23624     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23625        MOVE AL-UABON            TO BFREQA
 23626        MOVE -1                  TO BFREQL
 23627        MOVE  1                  TO SET-CURSOR-SW
 23628        GO TO 7499-EXIT.
 23629
 23630**2655**
 23631
 23632     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23633        MOVE AL-UABON            TO BFREQA
 23634        MOVE -1                  TO BFREQL
 23635        MOVE  1                  TO SET-CURSOR-SW
 23636        GO TO 7499-EXIT.
 23637
 23638**2656**
 23639
 23640     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23641        MOVE AL-UNBON            TO BAPRA
 23642        MOVE -1                  TO BAPRL
 23643        MOVE  1                  TO SET-CURSOR-SW
 23644        GO TO 7499-EXIT.
 23645
 23646**2657**
 23647
 23648     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23649        MOVE AL-UNBON            TO BAPRA
 23650        MOVE -1                  TO BAPRL
 23651        MOVE  1                  TO SET-CURSOR-SW
 23652        GO TO 7499-EXIT.
 23653
 23654**2658**
 23655
 23656     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23657        MOVE AL-UNBON            TO BTERM2A
 23658        MOVE -1                  TO BTERM2L
 23659        MOVE  1                  TO SET-CURSOR-SW
 23660        GO TO 7499-EXIT.
 23661
 23662**2660**
 23663
 23664     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23665        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23666        MOVE -1                  TO BLSTNML
 23667        MOVE  1                  TO SET-CURSOR-SW
 23668        GO TO 7499-EXIT.
 23669
 23670
 23671**2662**
 23672
 23673     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23674        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 437
* EL6311.cbl
 23675        MOVE -1                  TO BAGEL
 23676        MOVE  1                  TO SET-CURSOR-SW
 23677        GO TO 7499-EXIT.
 23678
 23679**2663**
 23680
 23681     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23682        MOVE AL-UNBON            TO BAGEA
 23683        MOVE -1                  TO BAGEL
 23684        MOVE  1                  TO SET-CURSOR-SW
 23685        GO TO 7499-EXIT.
 23686
 23687**2664**
 23688
 23689     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23690        MOVE AL-UABON            TO BREINA
 23691        MOVE -1                  TO BREINL
 23692        MOVE  1                  TO SET-CURSOR-SW
 23693        GO TO 7499-EXIT.
 23694
 23695**2667**
 23696
 23697     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23698        MOVE AL-UNBON            TO BBEN2A
 23699        MOVE -1                  TO BBEN2L
 23700        MOVE  1                  TO SET-CURSOR-SW
 23701        GO TO 7499-EXIT.
 23702
 23703**2668**
 23704
 23705     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23706        MOVE AL-UABON            TO BEFFDTA
 23707        GO TO 7499-EXIT.
 23708
 23709**2669**
 23710
 23711     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23712       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23713       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23714        MOVE AL-UNBON            TO BAGEA
 23715        MOVE -1                  TO BAGEL
 23716        MOVE  1                  TO SET-CURSOR-SW
 23717        GO TO 7499-EXIT.
 23718
 23719**2670**
 23720
 23721     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23722        MOVE AL-UABON            TO BFORCEA
 23723        MOVE -1                  TO BFORCEL
 23724        MOVE  1                  TO SET-CURSOR-SW
 23725        GO TO 7499-EXIT.
 23726
 23727**2671**
 23728
 23729     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23730        MOVE AL-UABON            TO BEFFDTA
 23731        GO TO 7499-EXIT.
 23732
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 438
* EL6311.cbl
 23733**2672**
 23734
 23735     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23736        MOVE AL-UABON            TO BEFFDTA
 23737        GO TO 7499-EXIT.
 23738
 23739**2673**
 23740
 23741     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23742        MOVE AL-UABON            TO BEFFDTA
 23743        GO TO 7499-EXIT.
 23744
 23745**2674**
 23746
 23747     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23748        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23749        MOVE -1                  TO BTYPE1L
 23750        MOVE  1                  TO SET-CURSOR-SW
 23751        GO TO 7499-EXIT.
 23752
 23753**2677**
 23754
 23755     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23756        MOVE AL-UNBON            TO BTERM1A
 23757        MOVE -1                  TO BTERM1L
 23758        MOVE  1                  TO SET-CURSOR-SW
 23759        GO TO 7499-EXIT.
 23760
 23761**2678**
 23762
 23763     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23764        MOVE AL-UNBON            TO BTERM2A
 23765        MOVE -1                  TO BTERM2L
 23766        MOVE  1                  TO SET-CURSOR-SW
 23767        GO TO 7499-EXIT.
 23768
 23769**2679**
 23770
 23771     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23772        MOVE AL-UABON            TO BTYPE1A
 23773        MOVE -1                  TO BTYPE1L
 23774        MOVE  1                  TO SET-CURSOR-SW
 23775        GO TO 7499-EXIT.
 23776
 23777**2680**
 23778
 23779     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 23780        MOVE AL-UABOF            TO B1STPMTA
 23781        MOVE -1                  TO B1STPMTL
 23782        MOVE  1                  TO SET-CURSOR-SW
 23783        GO TO 7499-EXIT.
 23784
 23785**2681**
 23786
 23787     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23788        MOVE AL-UABON            TO BDAYSA
 23789        MOVE -1                  TO BDAYSL
 23790        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 439
* EL6311.cbl
 23791        GO TO 7499-EXIT.
 23792
 23793**2682**
 23794
 23795     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23796        MOVE AL-UABON            TO BTERM1A
 23797        MOVE -1                  TO BTERM1L
 23798        MOVE  1                  TO SET-CURSOR-SW
 23799        GO TO 7499-EXIT.
 23800
 23801**2683**
 23802
 23803     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23804        MOVE AL-UABON            TO BSKPCDA
 23805        MOVE -1                  TO BSKPCDL
 23806        MOVE  1                  TO SET-CURSOR-SW
 23807        GO TO 7499-EXIT.
 23808
 23809**2684**
 23810
 23811     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23812        MOVE AL-UABON            TO BTYPE2A
 23813        MOVE -1                  TO BTYPE2L
 23814        MOVE  1                  TO SET-CURSOR-SW
 23815        GO TO 7499-EXIT.
 23816
 23817**2686**
 23818
 23819     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23820        MOVE AL-UABON            TO BTYPE2A
 23821        MOVE -1                  TO BTYPE2L
 23822        MOVE  1                  TO SET-CURSOR-SW
 23823        GO TO 7499-EXIT.
 23824
 23825**2689**
 23826
 23827     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23828        MOVE AL-UABON            TO BSIGA
 23829        MOVE -1                  TO BSIGL
 23830        MOVE  1                  TO SET-CURSOR-SW
 23831        GO TO 7499-EXIT.
 23832
 23833**2690**
 23834
 23835     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23836        MOVE AL-UABOF            TO BLNOFCRA
 23837        MOVE -1                  TO BLNOFCRL
 23838        MOVE  1                  TO SET-CURSOR-SW
 23839        GO TO 7499-EXIT.
 23840
 23841**2693**
 23842
 23843     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23844        MOVE AL-UABOF            TO BLNOFCRA
 23845        MOVE AL-UNBON            TO BBEN1A
 23846        MOVE -1                  TO BBEN1L
 23847        MOVE  1                  TO SET-CURSOR-SW
 23848        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 440
* EL6311.cbl
 23849
 23850**2720**
 23851
 23852     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23853        MOVE AL-UNBON            TO BBEN1A
 23854        MOVE -1                  TO BBEN1L
 23855        MOVE  1                  TO SET-CURSOR-SW
 23856        GO TO 7499-EXIT.
 23857
 23858**2709**
 23859
 23860*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23861*       MOVE AL-UNBON            TO BBEN1A
 23862*       MOVE -1                  TO BBEN1L
 23863*       MOVE  1                  TO SET-CURSOR-SW
 23864*       GO TO 7499-EXIT.
 23865
 23866*************************************************************
 23867*                                                           *
 23868*            C A N C E L   E R R O R S                      *
 23869*                                                           *
 23870*************************************************************
 23871
 23872**2726**
 23873
 23874     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23875        MOVE AL-UABON            TO CCERTNOA
 23876        GO TO 7499-EXIT.
 23877
 23878**2728**
 23879
 23880     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23881        MOVE AL-UABON            TO CCERTNOA
 23882        GO TO 7499-EXIT.
 23883
 23884**2729**
 23885
 23886     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23887        MOVE AL-UABON            TO CCERTNOA
 23888        GO TO 7499-EXIT.
 23889
 23890**2730**
 23891
 23892     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23893        MOVE AL-UABON            TO CCERTNOA
 23894        GO TO 7499-EXIT.
 23895
 23896**2731**
 23897
 23898     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23899        MOVE AL-UABON            TO CCANDT1A
 23900        MOVE -1                  TO CCANDT1L
 23901        MOVE  1                  TO SET-CURSOR-SW
 23902        GO TO 7499-EXIT.
 23903
 23904**2732**
 23905
 23906     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 441
* EL6311.cbl
 23907        MOVE AL-UABON            TO CCANDT1A
 23908        MOVE -1                  TO CCANDT1L
 23909        MOVE  1                  TO SET-CURSOR-SW
 23910        GO TO 7499-EXIT.
 23911
 23912**2733**
 23913
 23914     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23915        MOVE AL-UABON            TO CCANDT1A
 23916        MOVE -1                  TO CCANDT1L
 23917        MOVE  1                  TO SET-CURSOR-SW
 23918        GO TO 7499-EXIT.
 23919
 23920**2734**
 23921
 23922     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23923        MOVE AL-UNBON            TO CREFND1A
 23924        MOVE -1                  TO CREFND1L
 23925        MOVE  1                  TO SET-CURSOR-SW
 23926        GO TO 7499-EXIT.
 23927
 23928**2735**
 23929
 23930     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23931        MOVE AL-UABON            TO CCANDT2A
 23932        MOVE -1                  TO CCANDT2L
 23933        MOVE  1                  TO SET-CURSOR-SW
 23934        GO TO 7499-EXIT.
 23935
 23936**2736**
 23937
 23938     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23939        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23940            MOVE AL-UNBON        TO CREFND1A
 23941            MOVE -1              TO CREFND1L
 23942            MOVE  1              TO SET-CURSOR-SW
 23943            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23944                MOVE AL-UNBON        TO CREFND2A
 23945                MOVE -1              TO CREFND2L
 23946                MOVE  1              TO SET-CURSOR-SW
 23947                GO TO 7499-EXIT
 23948            ELSE
 23949                GO TO 7499-EXIT
 23950        ELSE
 23951            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23952                MOVE AL-UNBON        TO CREFND2A
 23953                MOVE -1              TO CREFND2L
 23954                MOVE  1              TO SET-CURSOR-SW
 23955                GO TO 7499-EXIT
 23956            ELSE
 23957                GO TO 7499-EXIT.
 23958
 23959**2738**
 23960
 23961     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23962        MOVE -1                  TO CREFND2L
 23963        MOVE  1                  TO SET-CURSOR-SW
 23964        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 442
* EL6311.cbl
 23965
 23966**2739**
 23967
 23968     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23969        MOVE -1                  TO CREFND1L
 23970        MOVE  1                  TO SET-CURSOR-SW
 23971        GO TO 7499-EXIT.
 23972
 23973**2741**
 23974
 23975     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23976        MOVE -1                  TO CREFND1L
 23977        MOVE  1                  TO SET-CURSOR-SW
 23978        GO TO 7499-EXIT.
 23979
 23980**2743**
 23981
 23982     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23983        MOVE AL-UNBON            TO CCANDT1A
 23984        MOVE -1                  TO CCANDT1L
 23985        MOVE  1                  TO SET-CURSOR-SW
 23986        GO TO 7499-EXIT.
 23987
 23988**2744**
 23989
 23990     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23991        MOVE AL-UNBON            TO CCANDT2A
 23992        MOVE -1                  TO CCANDT2L
 23993        MOVE  1                  TO SET-CURSOR-SW
 23994        GO TO 7499-EXIT.
 23995
 23996**2747**
 23997
 23998     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23999        MOVE AL-UABON            TO CLSTNMA
 24000        MOVE -1                  TO CLSTNML
 24001        MOVE  1                  TO SET-CURSOR-SW
 24002        GO TO 7499-EXIT.
 24003
 24004**2749**
 24005
 24006     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 24007        MOVE AL-UABON            TO CFORCEA
 24008        MOVE -1                  TO CFORCEL
 24009        MOVE  1                  TO SET-CURSOR-SW
 24010        GO TO 7499-EXIT.
 24011
 24012**2753**
 24013
 24014     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 24015        MOVE AL-UNBON            TO CCANDT1A
 24016        MOVE -1                  TO CCANDT1L
 24017        MOVE  1                  TO SET-CURSOR-SW
 24018        GO TO 7499-EXIT.
 24019
 24020**2755**
 24021
 24022     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 443
* EL6311.cbl
 24023        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24024            MOVE AL-UNBON        TO CREFND1A
 24025            MOVE -1              TO CREFND1L
 24026            MOVE  1              TO SET-CURSOR-SW
 24027            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24028                MOVE AL-UNBON        TO CREFND2A
 24029                MOVE -1              TO CREFND2L
 24030                MOVE  1              TO SET-CURSOR-SW
 24031                GO TO 7499-EXIT
 24032            ELSE
 24033                GO TO 7499-EXIT
 24034        ELSE
 24035            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24036                MOVE AL-UNBON        TO CREFND2A
 24037                MOVE -1              TO CREFND2L
 24038                MOVE  1              TO SET-CURSOR-SW
 24039            ELSE
 24040                GO TO 7499-EXIT.
 24041
 24042**2757**
 24043
 24044     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 24045        MOVE AL-UNBON            TO CLIVESA
 24046        MOVE -1                  TO CLIVESL
 24047        MOVE  1                  TO SET-CURSOR-SW
 24048        GO TO 7499-EXIT.
 24049
 24050**2771**
 24051
 24052     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 24053        MOVE AL-UABON            TO CCANDT2A
 24054        MOVE -1                  TO CCANDT2L
 24055        MOVE  1                  TO SET-CURSOR-SW
 24056        GO TO 7499-EXIT.
 24057
 24058**2774**
 24059
 24060     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 24061        MOVE AL-UABON            TO CCANDT1A
 24062        MOVE -1                  TO CCANDT1L
 24063        MOVE  1                  TO SET-CURSOR-SW
 24064        GO TO 7499-EXIT.
 24065
 24066**2775**
 24067
 24068     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 24069        MOVE AL-UABON            TO CCANDT2A
 24070        MOVE -1                  TO CCANDT2L
 24071        MOVE  1                  TO SET-CURSOR-SW
 24072        GO TO 7499-EXIT.
 24073
 24074**2776**
 24075
 24076     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 24077        MOVE AL-UABON            TO CCANDT1A
 24078        MOVE -1                  TO CCANDT1L
 24079        MOVE  1                  TO SET-CURSOR-SW
 24080        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 444
* EL6311.cbl
 24081
 24082
 24083**2777**
 24084
 24085     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 24086        MOVE AL-UABON            TO CCANDT2A
 24087        MOVE -1                  TO CCANDT2L
 24088        MOVE  1                  TO SET-CURSOR-SW
 24089        GO TO 7499-EXIT.
 24090
 24091**2794**
 24092
 24093     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 24094        MOVE AL-UABON            TO CFORCEA
 24095        MOVE -1                  TO CFORCEL
 24096        MOVE  1                  TO SET-CURSOR-SW
 24097        GO TO 7499-EXIT.
 24098
 24099**2799**
 24100
 24101     IF PI-COMPANY-ID = 'UCL'
 24102         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 24103             MOVE AL-UNBON            TO BEFFDTA
 24104             MOVE -1                  TO BEFFDTL
 24105             MOVE  1                  TO SET-CURSOR-SW
 24106             GO TO 7499-EXIT.
 24107
 24108 7499-EXIT.
 24109      EXIT.
 24110
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 445
* EL6311.cbl
 24112
 24113 7500-READ-ERLOFC.
 24114     MOVE SPACES                 TO  WS-LOAN-OFFICER
 24115                                     ERLOFC-KEY.
 24116
 24117     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 24118
 24119     IF ST-ACCNT-CNTL
 24120         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24121
 24122     IF CARR-GROUP-ST-ACCNT-CNTL
 24123         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24124         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 24125         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 24126
 24127     IF CARR-ST-ACCNT-CNTL
 24128         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24129         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24130
 24131     IF CARR-ACCNT-CNTL
 24132         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 24133
 24134     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 24135
 24136     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 24137
 24138
 24139* EXEC CICS HANDLE CONDITION
 24140*        NOTFND   (7550-OFFICER-NOTFND)
 24141*    END-EXEC.
 24142*    MOVE '"$I                   ! [ #00020345' TO DFHEIV0
 24143     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 24144     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24145     MOVE X'5B20233030303230333435' TO DFHEIV0(25:11)
 24146     CALL 'kxdfhei1' USING DFHEIV0
 24147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24148
 24149
 24150
 24151* EXEC CICS READ
 24152*        DATASET   (FILE-ID-ERLOFC)
 24153*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24154*        RIDFLD    (ERLOFC-KEY)
 24155*        EQUAL
 24156*    END-EXEC.
 24157*    MOVE '&"S        E          (   #00020349' TO DFHEIV0
 24158     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24159     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24160     MOVE X'2020233030303230333439' TO DFHEIV0(25:11)
 24161     CALL 'kxdfhei1' USING DFHEIV0,
 24162           FILE-ID-ERLOFC,
 24163           DFHEIV20,
 24164           DFHEIV99,
 24165           ERLOFC-KEY,
 24166           DFHEIV99,
 24167           DFHEIV99,
 24168           DFHEIV99
 24169     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 446
* EL6311.cbl
 24170         DFHEIV20
 24171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24172
 24173
 24174     GO TO 7599-EXIT.
 24175
 24176 7550-OFFICER-NOTFND.
 24177     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24178
 24179 7599-EXIT.
 24180      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 447
* EL6311.cbl
 24182******************************************************************
 24183*                                                                *
 24184*            S  E N D    I N I T I A L   M A P                   *
 24185*                                                                *
 24186******************************************************************
 24187
 24188 8100-SEND-INITIAL-MAP.
 24189     MOVE EIBTIME                TO TIME-IN.
 24190
 24191     IF EIBAID = DFHPF11
 24192        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24193        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24194
 24195
 24196     IF PI-COMPANY-ID = CLIENT-GIC
 24197        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24198                                       BCPREM-ATTRB (2).
 24199
 24200     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24201                         CLIENT-PEM OR
 24202                         CLIENT-CSO)
 24203        AND PI-DISPLAY-ORIGINAL-BATCH
 24204          IF PI-MAP-NAME = EL631B
 24205             MOVE AL-SADOF               TO BPF5HDRA
 24206                                            BPF4HDRA
 24207          ELSE
 24208             IF PI-MAP-NAME = EL631C
 24209                MOVE AL-SADOF            TO CPF5HDRA
 24210                                            CPF4HDRA.
 24211
 24212     IF PI-MAP-NAME = EL631B
 24213        MOVE AL-SADOF               TO BPF5HDRA
 24214     ELSE
 24215        MOVE AL-SADOF               TO CPF5HDRA
 24216     END-IF
 24217
 24218*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24219     IF PI-MAP-NAME = EL631B
 24220          IF PI-COMPANY-ID NOT = 'DMD'
 24221             MOVE AL-SANOF            TO BBILLEDA
 24222             MOVE AL-SADOF            TO DMDBILA.
 24223*DMD CUSTOM CODING*************END
 24224
 24225     IF PI-PROCESSOR-ID = 'LGXX'
 24226        IF PI-MAP-NAME = EL631B
 24227           MOVE AL-SABOF                    TO BREFHDGA
 24228           MOVE AL-SANOF                    TO BREFA
 24229        ELSE
 24230           IF PI-MAP-NAME = EL631C
 24231              MOVE AL-SABOF                 TO CREFHDGA
 24232              MOVE AL-SANOF                 TO CREFA.
 24233
 24234     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 24235        continue
 24236     ELSE
 24237        IF PI-MAP-NAME = EL631C
 24238           MOVE AL-SADOF         TO CCANTXTA
 24239                                    CCANFEEA
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 448
* EL6311.cbl
 24240        end-if
 24241     end-if
 24242     IF PI-MAP-NAME = EL631D
 24243        IF PI-AR-PROCESSING
 24244           MOVE AL-SANOF            TO DREFHDGA
 24245        ELSE
 24246           MOVE AL-SADOF            TO DREFHDGA.
 24247
 24248     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 24249        AND (PI-MAP-NAME = EL631B)
 24250        MOVE AL-SADOF            TO BVINHA
 24251                                    BVINA
 24252     END-IF
 24253     IF PI-MAP-NAME = EL631B
 24254        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24255        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24256                                 TO BREGIONO
 24257        MOVE PI-PROCESSOR-ID     TO BUSERO
 24258        IF CSR-EDIT-SESSION
 24259           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24260                                 TO BHEADO
 24261           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24262        ELSE
 24263           MOVE AL-SADOF         TO BF15HDRA
 24264           MOVE '4=B-HDR      '  TO BPF4HDRO
 24265        END-IF
 24266        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24267        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24268        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24269        MOVE WS-CURRENT-DT          TO BDATEO
 24270        MOVE TIME-OUT               TO BTIMEO
 24271        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24272        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24273        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24274        IF   WS-DISPLAY-SCREEN
 24275             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24276             MOVE PB-SV-CARRIER     TO BCARRO
 24277             MOVE PB-SV-GROUPING    TO BGROUPO
 24278             MOVE PB-SV-STATE       TO BSTATEO
 24279             MOVE PB-ACCOUNT        TO BACCTO
 24280        ELSE
 24281             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24282     ELSE
 24283        IF PI-MAP-NAME = EL631C
 24284           MOVE '4=B-HDR      '     TO CPF4HDRO
 24285           IF CSR-EDIT-SESSION
 24286              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24287                                 TO CHEADO
 24288           ELSE
 24289              MOVE AL-SADOF      TO CF15HDRA
 24290           END-IF
 24291           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24292           MOVE WS-CURRENT-DT          TO CDATEO
 24293           MOVE TIME-OUT               TO CTIMEO
 24294           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24295           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24296           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24297           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 449
* EL6311.cbl
 24298           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24299           MOVE WS-C-HDG               TO CAHHDGO
 24300           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24301           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24302           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24303           IF   WS-DISPLAY-SCREEN
 24304                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24305                MOVE PB-SV-CARRIER     TO CCARRO
 24306                MOVE PB-SV-GROUPING    TO CGROUPO
 24307                MOVE PB-SV-STATE       TO CSTATEO
 24308                MOVE PB-ACCOUNT        TO CACCTO
 24309           ELSE
 24310                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24311        ELSE
 24312           MOVE WS-CURRENT-DT          TO DDATEO
 24313           MOVE TIME-OUT               TO DTIMEO
 24314           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24315                                          WS-REFUND-HDG-OVERRIDE
 24316           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24317           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24318           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24319                                          WS-REFUND-HDG-OVERRIDE
 24320           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24321           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24322           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24323           IF CSR-EDIT-SESSION
 24324              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24325                                 TO DHEADO
 24326           END-IF
 24327           IF  WS-DISPLAY-SCREEN
 24328               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24329               MOVE PB-CARRIER         TO DCARRO
 24330               MOVE PB-GROUPING        TO DGROUPO
 24331               MOVE PB-STATE           TO DSTATEO
 24332               MOVE PB-ACCOUNT         TO DACCTO
 24333               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24334           ELSE
 24335               MOVE EL631D             TO PI-MAP-NAME
 24336               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24337               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24338
 24339     MOVE SPACE                        TO WS-DISPLAY-SW.
 24340
 24341
 24342* EXEC CICS SEND
 24343*        MAP      (PI-MAP-NAME)
 24344*        MAPSET   (MAPSET-EL6311S)
 24345*        FROM     (EL631BI)
 24346*        ERASE
 24347*        CURSOR
 24348*    END-EXEC.
 24349     MOVE LENGTH OF
 24350      EL631BI
 24351       TO DFHEIV12
 24352     MOVE -1
 24353       TO DFHEIV11
 24354*    MOVE '8$     CT  E    H L F ,   #00020523' TO DFHEIV0
 24355     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 450
* EL6311.cbl
 24356     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24357     MOVE X'2020233030303230353233' TO DFHEIV0(25:11)
 24358     CALL 'kxdfhei1' USING DFHEIV0,
 24359           PI-MAP-NAME,
 24360           EL631BI,
 24361           DFHEIV12,
 24362           MAPSET-EL6311S,
 24363           DFHEIV99,
 24364           DFHEIV99,
 24365           DFHEIV99,
 24366           DFHEIV11,
 24367           DFHEIV99,
 24368           DFHEIV99,
 24369           DFHEIV99
 24370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24371
 24372
 24373     GO TO 9100-RETURN-TRAN.
 24374
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 451
* EL6311.cbl
 24376
 24377******************************************************************
 24378*                                                                *
 24379*              S E N D    D A T A O N L Y                        *
 24380*                                                                *
 24381******************************************************************
 24382
 24383 8200-SEND-DATAONLY.
 24384     MOVE EIBTIME                TO TIME-IN.
 24385
 24386     IF PI-COMPANY-ID = CLIENT-GIC
 24387        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24388                                       BCPREM-ATTRB (2).
 24389
 24390     IF PI-MAP-NAME = EL631B
 24391        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24392        MOVE WS-CURRENT-DT          TO BDATEO
 24393        MOVE TIME-OUT               TO BTIMEO
 24394        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24395        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24396        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24397        MOVE SPACES                 TO BPFENTRO
 24398        MOVE AL-UANOF               TO BPFENTRA
 24399
 24400*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24401        IF PI-COMPANY-ID NOT = 'DMD'
 24402             MOVE AL-SANOF            TO BBILLEDA
 24403             MOVE AL-SADOF            TO DMDBILA
 24404         ELSE
 24405            NEXT SENTENCE
 24406*DMD CUSTOM CODING*************END
 24407     ELSE
 24408        IF PI-MAP-NAME = EL631C
 24409           MOVE WS-CURRENT-DT          TO CDATEO
 24410           MOVE TIME-OUT               TO CTIMEO
 24411           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24412           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24413           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24414           MOVE SPACES                 TO CPFENTRO
 24415           MOVE AL-UANOF               TO CPFENTRA
 24416        ELSE
 24417           MOVE WS-CURRENT-DT          TO DDATEO
 24418           MOVE TIME-OUT               TO DTIMEO
 24419           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24420
 24421
 24422* EXEC CICS SEND
 24423*        MAP      (PI-MAP-NAME)
 24424*        MAPSET   (MAPSET-EL6311S)
 24425*        FROM     (EL631BI)
 24426*        DATAONLY
 24427*        CURSOR
 24428*    END-EXEC.
 24429     MOVE LENGTH OF
 24430      EL631BI
 24431       TO DFHEIV12
 24432     MOVE -1
 24433       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 452
* EL6311.cbl
 24434*    MOVE '8$D    CT       H L F ,   #00020579' TO DFHEIV0
 24435     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24436     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24437     MOVE X'2020233030303230353739' TO DFHEIV0(25:11)
 24438     CALL 'kxdfhei1' USING DFHEIV0,
 24439           PI-MAP-NAME,
 24440           EL631BI,
 24441           DFHEIV12,
 24442           MAPSET-EL6311S,
 24443           DFHEIV99,
 24444           DFHEIV99,
 24445           DFHEIV99,
 24446           DFHEIV11,
 24447           DFHEIV99,
 24448           DFHEIV99,
 24449           DFHEIV99
 24450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24451
 24452
 24453     GO TO 9100-RETURN-TRAN.
 24454
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 453
* EL6311.cbl
 24456
 24457******************************************************************
 24458*                                                                *
 24459*           U T I L I T Y   R O U T I N E S                      *
 24460*                                                                *
 24461******************************************************************
 24462
 24463 8300-SEND-TEXT.
 24464
 24465* EXEC CICS SEND TEXT
 24466*        FROM     (LOGOFF-TEXT)
 24467*        LENGTH   (LOGOFF-LENGTH)
 24468*        ERASE
 24469*        FREEKB
 24470*    END-EXEC.
 24471*    MOVE '8&      T  E F  H   F -   #00020598' TO DFHEIV0
 24472     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24473     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24474     MOVE X'2020233030303230353938' TO DFHEIV0(25:11)
 24475     CALL 'kxdfhei1' USING DFHEIV0,
 24476           LOGOFF-TEXT,
 24477           LOGOFF-LENGTH,
 24478           DFHEIV99,
 24479           DFHEIV99,
 24480           DFHEIV99,
 24481           DFHEIV99,
 24482           DFHEIV99,
 24483           DFHEIV99,
 24484           DFHEIV99,
 24485           DFHEIV99,
 24486           DFHEIV99,
 24487           DFHEIV99
 24488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24489
 24490
 24491
 24492* EXEC CICS RETURN
 24493*    END-EXEC.
 24494*    MOVE '.(                    ''   #00020605' TO DFHEIV0
 24495     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24496     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24497     MOVE X'2020233030303230363035' TO DFHEIV0(25:11)
 24498     CALL 'kxdfhei1' USING DFHEIV0,
 24499           DFHEIV99,
 24500           DFHEIV99,
 24501           DFHEIV99,
 24502           DFHEIV99,
 24503           DFHEIV99,
 24504           DFHEIV99
 24505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24506
 24507
 24508 8400-LOG-JOURNAL-RECORD.
 24509     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24510     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24511
 24512*    EXEC CICS JOURNAL
 24513*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 454
* EL6311.cbl
 24514*        JTYPEID     ('EL')
 24515*        FROM        (JOURNAL-RECORD)
 24516*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24517*    END-EXEC.
 24518
 24519 8600-DEEDIT.
 24520
 24521* EXEC CICS BIF DEEDIT
 24522*         FIELD   (DEEDIT-FIELD)
 24523*         LENGTH  (15)
 24524*    END-EXEC.
 24525     MOVE 15
 24526       TO DFHEIV11
 24527*    MOVE '@"L                   #   #00020620' TO DFHEIV0
 24528     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24529     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24530     MOVE X'2020233030303230363230' TO DFHEIV0(25:11)
 24531     CALL 'kxdfhei1' USING DFHEIV0,
 24532           DEEDIT-FIELD,
 24533           DFHEIV11
 24534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24535
 24536
 24537 8800-UNAUTHORIZED-ACCESS.
 24538     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24539     GO TO 8300-SEND-TEXT.
 24540
 24541 8810-PF23.
 24542     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24543     MOVE XCTL-EL005             TO PGM-NAME.
 24544     GO TO 9300-XCTL.
 24545
 24546 9100-RETURN-TRAN.
 24547     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24548
 24549     IF  PI-MAP-NAME =  EL631B
 24550         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24551
 24552     IF  PI-MAP-NAME =  EL631C
 24553         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24554
 24555     IF  PI-MAP-NAME =  EL631D
 24556         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24557
 24558
 24559* EXEC CICS RETURN
 24560*        TRANSID    (TRANS-EXB1)
 24561*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24562*        LENGTH     (1300)
 24563*    END-EXEC.
 24564     MOVE 1300
 24565       TO DFHEIV11
 24566*    MOVE '.(CT                  ''   #00020646' TO DFHEIV0
 24567     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24568     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24569     MOVE X'2020233030303230363436' TO DFHEIV0(25:11)
 24570     CALL 'kxdfhei1' USING DFHEIV0,
 24571           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 455
* EL6311.cbl
 24572           PROGRAM-INTERFACE-BLOCK,
 24573           DFHEIV11,
 24574           DFHEIV99,
 24575           DFHEIV99,
 24576           DFHEIV99
 24577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24578
 24579
 24580 9200-RETURN-MAIN-MENU.
 24581     MOVE XCTL-EL626             TO PGM-NAME.
 24582     GO TO 9300-XCTL.
 24583
 24584 9300-XCTL.
 24585
 24586* EXEC CICS XCTL
 24587*        PROGRAM    (PGM-NAME)
 24588*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24589*        LENGTH     (PI-COMM-LENGTH)
 24590*    END-EXEC.
 24591*    MOVE '.$C                   %   #00020657' TO DFHEIV0
 24592     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24593     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24594     MOVE X'2020233030303230363537' TO DFHEIV0(25:11)
 24595     CALL 'kxdfhei1' USING DFHEIV0,
 24596           PGM-NAME,
 24597           PROGRAM-INTERFACE-BLOCK,
 24598           PI-COMM-LENGTH,
 24599           DFHEIV99
 24600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24601
 24602
 24603 9400-CLEAR.
 24604     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24605     GO TO 9300-XCTL.
 24606
 24607 9500-PF12.
 24608     MOVE XCTL-EL010             TO PGM-NAME.
 24609     GO TO 9300-XCTL.
 24610
 24611 9600-PGMID-ERROR.
 24612
 24613* EXEC CICS HANDLE CONDITION
 24614*        PGMIDERR    (8300-SEND-TEXT)
 24615*    END-EXEC.
 24616*    MOVE '"$L                   ! \ #00020672' TO DFHEIV0
 24617     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24618     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24619     MOVE X'5C20233030303230363732' TO DFHEIV0(25:11)
 24620     CALL 'kxdfhei1' USING DFHEIV0
 24621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24622
 24623
 24624     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24625     MOVE ' '                    TO PI-ENTRY-CD-1.
 24626     MOVE XCTL-EL005             TO PGM-NAME.
 24627     MOVE PGM-NAME               TO LOGOFF-PGM.
 24628     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24629     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 456
* EL6311.cbl
 24630
 24631 9700-DATE-LINK.
 24632     MOVE LINK-ELDATCV           TO PGM-NAME.
 24633
 24634* EXEC CICS LINK
 24635*        PROGRAM    (PGM-NAME)
 24636*        COMMAREA   (DATE-CONVERSION-DATA)
 24637*        LENGTH     (DC-COMM-LENGTH)
 24638*    END-EXEC.
 24639*    MOVE '."C                   (   #00020685' TO DFHEIV0
 24640     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24641     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24642     MOVE X'2020233030303230363835' TO DFHEIV0(25:11)
 24643     CALL 'kxdfhei1' USING DFHEIV0,
 24644           PGM-NAME,
 24645           DATE-CONVERSION-DATA,
 24646           DC-COMM-LENGTH,
 24647           DFHEIV99,
 24648           DFHEIV99,
 24649           DFHEIV99,
 24650           DFHEIV99
 24651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24652
 24653
 24654 9800-LINK-PENDING-EDIT.
 24655     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24656     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24657
 24658     MOVE LINK-EL050             TO PGM-NAME
 24659     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24660     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24661                                    WK-CO-TOL-CLAIM
 24662                                    WK-CO-TOL-PREM
 24663                                    WK-CO-TOL-REFUND
 24664                                    WK-CO-TOL-PREM-PCT
 24665                                    WK-CO-TOL-REFUND-PCT
 24666                                    WK-REFUND-OVS-AMT
 24667                                    WK-REFUND-OVS-PCT
 24668                                    WK-ACCT-ADDR
 24669                                    WK-LIFE-EDIT-ADDR
 24670                                    WK-AH-EDIT-ADDR
 24671                                    WK-LIFE-BEN-ADDR
 24672                                    WK-AH-BEN-ADDR
 24673                                    WK-STATE-ADDR
 24674                                    WK-PLAN-ADDR
 24675                                    WK-FORM-ADDR
 24676     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24677
 24678     MOVE '6'                    TO WK-ENTRY-SW.
 24679
 24680     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24681
 24682     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24683                                    EC-AM-EXPIRATION-DT
 24684                                    EC-AM-EFFECTIVE-DT
 24685                                    EC-CM-LF-CANCEL-DT
 24686                                    EC-CM-AH-CANCEL-DT
 24687                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 457
* EL6311.cbl
 24688
 24689     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24690                                    EC-CO-TOL-REFUND
 24691                                    EC-CO-MIN-AGE
 24692                                    EC-CO-MIN-PREMIUM
 24693                                    EC-CO-MIN-TERM
 24694                                    EC-CO-MAX-TERM
 24695                                    EC-ST-TOL-PREM
 24696                                    EC-ST-TOL-REFUND
 24697                                    EC-AM-LF-TOL-PREM
 24698                                    EC-AM-AH-TOL-PREM
 24699                                    EC-AM-LF-MAX-ATT-AGE
 24700                                    EC-AM-LF-MAX-AGE
 24701                                    EC-AM-LF-MAX-TERM
 24702                                    EC-AM-LF-MAX-TOT-BEN
 24703                                    EC-AM-AH-MAX-ATT-AGE
 24704                                    EC-AM-AH-MAX-AGE
 24705                                    EC-AM-AH-MAX-TERM
 24706                                    EC-AM-AH-MAX-TOT-BEN
 24707                                    EC-AM-AH-MAX-MON-BEN
 24708                                    EC-RT-LF-MAX-ATT-AGE
 24709                                    EC-RT-LF-MAX-AGE
 24710                                    EC-RT-LF-MAX-TERM
 24711                                    EC-RT-LF-MAX-TOT-BEN
 24712                                    EC-RT-AH-MAX-ATT-AGE
 24713                                    EC-RT-AH-MAX-AGE
 24714                                    EC-RT-AH-MAX-TERM
 24715                                    EC-RT-AH-MAX-TOT-BEN
 24716                                    EC-RT-AH-MAX-MON-BEN
 24717                                    EC-RT-AH-RATE
 24718                                    EC-RT-LF-RATE
 24719                                    EC-RT-LF-NSP-RATE
 24720                                    EC-RT-AH-NSP-RATE
 24721                                    EC-CM-LF-PRIOR-REFUND
 24722                                    EC-CM-AH-PRIOR-REFUND.
 24723
 24724     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24725                                    EC-ST-TOL-PREM-PCT
 24726                                    EC-AM-LF-TOL-REFUND
 24727                                    EC-AM-LF-DEV-PERCENT
 24728                                    EC-CO-TOL-REFUND-PCT
 24729                                    EC-ST-TOL-REFUND-PCT
 24730                                    EC-AM-AH-TOL-REFUND
 24731                                    EC-AM-AH-DEV-PERCENT.
 24732
 24733
 24734* EXEC CICS LINK
 24735*         PROGRAM   (PGM-NAME)
 24736*         COMMAREA  (PASSED-RECORD)
 24737*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24738*    END-EXEC.
 24739*    MOVE '."C                   (   #00020770' TO DFHEIV0
 24740     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24741     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24742     MOVE X'2020233030303230373730' TO DFHEIV0(25:11)
 24743     CALL 'kxdfhei1' USING DFHEIV0,
 24744           PGM-NAME,
 24745           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 458
* EL6311.cbl
 24746           WS-EDIT-PASS-LENGTH,
 24747           DFHEIV99,
 24748           DFHEIV99,
 24749           DFHEIV99,
 24750           DFHEIV99
 24751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24752
 24753
 24754     MOVE '1'                    TO PI-EDIT-SW.
 24755     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24756
 24757     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24758
 24759     IF PI-COMPANY-ID = 'UCL'
 24760         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24761
 24762     IF VALID-PB-ID
 24763        GO TO 9800-EXIT.
 24764
 24765     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24766
 24767     IF PI-MAP-NAME = EL631B
 24768        MOVE -1                  TO BMAINTL
 24769       ELSE
 24770        MOVE -1                  TO CMAINTL.
 24771
 24772     GO TO 8200-SEND-DATAONLY.
 24773
 24774 9800-EXIT.
 24775      EXIT.
 24776
 24777 9900-ERROR-FORMAT.
 24778
 24779     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24780
 24781     IF NOT EMI-ERRORS-COMPLETE
 24782         MOVE LINK-EL001         TO PGM-NAME
 24783
 24784* EXEC CICS LINK
 24785*            PROGRAM    (PGM-NAME)
 24786*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24787*            LENGTH     (EMI-COMM-LENGTH)
 24788*        END-EXEC.
 24789*    MOVE '."C                   (   #00020805' TO DFHEIV0
 24790     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24791     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24792     MOVE X'2020233030303230383035' TO DFHEIV0(25:11)
 24793     CALL 'kxdfhei1' USING DFHEIV0,
 24794           PGM-NAME,
 24795           ERROR-MESSAGE-INTERFACE-BLOCK,
 24796           EMI-COMM-LENGTH,
 24797           DFHEIV99,
 24798           DFHEIV99,
 24799           DFHEIV99,
 24800           DFHEIV99
 24801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24802
 24803
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 459
* EL6311.cbl
 24804 9900-EXIT.
 24805     EXIT.
 24806
 24807 9990-ABEND.
 24808     MOVE LINK-EL004             TO PGM-NAME.
 24809     MOVE DFHEIBLK               TO EMI-LINE1.
 24810
 24811* EXEC CICS LINK
 24812*        PROGRAM   (PGM-NAME)
 24813*        COMMAREA  (EMI-LINE1)
 24814*        LENGTH    (72)
 24815*    END-EXEC.
 24816     MOVE 72
 24817       TO DFHEIV11
 24818*    MOVE '."C                   (   #00020817' TO DFHEIV0
 24819     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24820     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24821     MOVE X'2020233030303230383137' TO DFHEIV0(25:11)
 24822     CALL 'kxdfhei1' USING DFHEIV0,
 24823           PGM-NAME,
 24824           EMI-LINE1,
 24825           DFHEIV11,
 24826           DFHEIV99,
 24827           DFHEIV99,
 24828           DFHEIV99,
 24829           DFHEIV99
 24830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24831
 24832
 24833     IF PI-MAP-NAME = EL631B
 24834        MOVE -1                  TO BMAINTL
 24835       ELSE
 24836        MOVE -1                  TO CMAINTL.
 24837
 24838     IF EIBTRNID NOT = TRANS-EXB1
 24839        GO TO 8100-SEND-INITIAL-MAP
 24840       ELSE
 24841        GO TO 8200-SEND-DATAONLY.
 24842
 24843 9995-SECURITY-VIOLATION.
 24844*                            COPY ELCSCTP.
 24845******************************************************************
 24846*                                                                *
 24847*                            ELCSCTP                             *
 24848*                            VMOD=2.001                          *
 24849*                                                                *
 24850*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24851******************************************************************
 24852
 24853
 24854     MOVE EIBDATE          TO SM-JUL-DATE.
 24855     MOVE EIBTRMID         TO SM-TERMID.
 24856     MOVE THIS-PGM         TO SM-PGM.
 24857     MOVE EIBTIME          TO TIME-IN.
 24858     MOVE TIME-OUT         TO SM-TIME.
 24859     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24860
 24861
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 460
* EL6311.cbl
 24862* EXEC CICS LINK
 24863*         PROGRAM  ('EL003')
 24864*         COMMAREA (SECURITY-MESSAGE)
 24865*         LENGTH   (80)
 24866*    END-EXEC.
 24867     MOVE 'EL003' TO DFHEIV1
 24868     MOVE 80
 24869       TO DFHEIV11
 24870*    MOVE '."C                   (   #00020851' TO DFHEIV0
 24871     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24872     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24873     MOVE X'2020233030303230383531' TO DFHEIV0(25:11)
 24874     CALL 'kxdfhei1' USING DFHEIV0,
 24875           DFHEIV1,
 24876           SECURITY-MESSAGE,
 24877           DFHEIV11,
 24878           DFHEIV99,
 24879           DFHEIV99,
 24880           DFHEIV99,
 24881           DFHEIV99
 24882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24883
 24884
 24885******************************************************************
 24886
 24887
 24888 9999-DFHBACK SECTION.
 24889     MOVE '9%                    "   ' TO DFHEIV0
 24890     MOVE 'EL6311' TO DFHEIV1
 24891     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24892     GOBACK.
 24893 9999-DFHEXIT.
 24894     IF DFHEIGDJ EQUAL 0001
 24895         NEXT SENTENCE
 24896     ELSE IF DFHEIGDJ EQUAL 2
 24897         GO TO 9600-PGMID-ERROR,
 24898               9990-ABEND,
 24899               9990-ABEND,
 24900               0010-MAIN-LOGIC
 24901         DEPENDING ON DFHEIGDI
 24902     ELSE IF DFHEIGDJ EQUAL 3
 24903         GO TO 1280-BATCH-HDR-NOT-FOUND
 24904         DEPENDING ON DFHEIGDI
 24905     ELSE IF DFHEIGDJ EQUAL 4
 24906         GO TO 1290-DUPLICATE-ALT-INDEX
 24907         DEPENDING ON DFHEIGDI
 24908     ELSE IF DFHEIGDJ EQUAL 5
 24909         GO TO 1295-CERT-TRL-REC-NOTFND
 24910         DEPENDING ON DFHEIGDI
 24911     ELSE IF DFHEIGDJ EQUAL 6
 24912         GO TO 1380-BATCH-HDR-NOT-FOUND
 24913         DEPENDING ON DFHEIGDI
 24914     ELSE IF DFHEIGDJ EQUAL 7
 24915         GO TO 1385-REC-NOT-FOUND
 24916         DEPENDING ON DFHEIGDI
 24917     ELSE IF DFHEIGDJ EQUAL 8
 24918         GO TO 1386-NOTFND
 24919         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 461
* EL6311.cbl
 24920     ELSE IF DFHEIGDJ EQUAL 9
 24921         GO TO 1399-EXIT
 24922         DEPENDING ON DFHEIGDI
 24923     ELSE IF DFHEIGDJ EQUAL 10
 24924         GO TO 1480-BATCH-HDR-NOT-FOUND
 24925         DEPENDING ON DFHEIGDI
 24926     ELSE IF DFHEIGDJ EQUAL 11
 24927         GO TO 1490-RECORD-NOT-FOUND
 24928         DEPENDING ON DFHEIGDI
 24929     ELSE IF DFHEIGDJ EQUAL 12
 24930         GO TO 1405-DELETE-CERTIFICATE
 24931         DEPENDING ON DFHEIGDI
 24932     ELSE IF DFHEIGDJ EQUAL 13
 24933         GO TO 1420-CONTINUE-DELETE
 24934         DEPENDING ON DFHEIGDI
 24935     ELSE IF DFHEIGDJ EQUAL 14
 24936         GO TO 1406-DELETE-ERNOTE
 24937         DEPENDING ON DFHEIGDI
 24938     ELSE IF DFHEIGDJ EQUAL 15
 24939         GO TO 1407-DELETE-MAILING
 24940         DEPENDING ON DFHEIGDI
 24941     ELSE IF DFHEIGDJ EQUAL 16
 24942         GO TO 1420-CONTINUE-DELETE
 24943         DEPENDING ON DFHEIGDI
 24944     ELSE IF DFHEIGDJ EQUAL 17
 24945         GO TO 1480-BATCH-HDR-NOT-FOUND
 24946         DEPENDING ON DFHEIGDI
 24947     ELSE IF DFHEIGDJ EQUAL 18
 24948         GO TO 1475-DELETE-FINISHED
 24949         DEPENDING ON DFHEIGDI
 24950     ELSE IF DFHEIGDJ EQUAL 19
 24951         GO TO 2280-BATCH-HDR-NOT-FOUND
 24952         DEPENDING ON DFHEIGDI
 24953     ELSE IF DFHEIGDJ EQUAL 20
 24954         GO TO 2290-DUPLICATE-ALT-INDEX
 24955         DEPENDING ON DFHEIGDI
 24956     ELSE IF DFHEIGDJ EQUAL 21
 24957         GO TO 2380-BATCH-HDR-NOT-FOUND
 24958         DEPENDING ON DFHEIGDI
 24959     ELSE IF DFHEIGDJ EQUAL 22
 24960         GO TO 2385-REC-NOT-FOUND
 24961         DEPENDING ON DFHEIGDI
 24962     ELSE IF DFHEIGDJ EQUAL 23
 24963         GO TO 2380-BATCH-HDR-NOT-FOUND
 24964         DEPENDING ON DFHEIGDI
 24965     ELSE IF DFHEIGDJ EQUAL 24
 24966         GO TO 2485-BATCH-HDR-NOT-FOUND
 24967         DEPENDING ON DFHEIGDI
 24968     ELSE IF DFHEIGDJ EQUAL 25
 24969         GO TO 2490-RECORD-NOT-FOUND
 24970         DEPENDING ON DFHEIGDI
 24971     ELSE IF DFHEIGDJ EQUAL 26
 24972         GO TO 2475-CONTINUE-DELETE
 24973         DEPENDING ON DFHEIGDI
 24974     ELSE IF DFHEIGDJ EQUAL 27
 24975         GO TO 2485-BATCH-HDR-NOT-FOUND
 24976         DEPENDING ON DFHEIGDI
 24977     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 462
* EL6311.cbl
 24978         GO TO 2480-DELETE-FINISHED
 24979         DEPENDING ON DFHEIGDI
 24980     ELSE IF DFHEIGDJ EQUAL 29
 24981         GO TO 2820-PROCESS-REWRITE
 24982         DEPENDING ON DFHEIGDI
 24983     ELSE IF DFHEIGDJ EQUAL 30
 24984         GO TO 2885-RECORD-MISSING
 24985         DEPENDING ON DFHEIGDI
 24986     ELSE IF DFHEIGDJ EQUAL 31
 24987         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24988         DEPENDING ON DFHEIGDI
 24989     ELSE IF DFHEIGDJ EQUAL 32
 24990         GO TO 2827-DELETE-MAILING
 24991         DEPENDING ON DFHEIGDI
 24992     ELSE IF DFHEIGDJ EQUAL 33
 24993         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24994         DEPENDING ON DFHEIGDI
 24995     ELSE IF DFHEIGDJ EQUAL 34
 24996         GO TO 2920-PROCESS-REWRITE
 24997         DEPENDING ON DFHEIGDI
 24998     ELSE IF DFHEIGDJ EQUAL 35
 24999         GO TO 2985-RECORD-MISSING
 25000         DEPENDING ON DFHEIGDI
 25001     ELSE IF DFHEIGDJ EQUAL 36
 25002         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 25003         DEPENDING ON DFHEIGDI
 25004     ELSE IF DFHEIGDJ EQUAL 37
 25005         GO TO 2990-DUPLICATE-RECORD
 25006         DEPENDING ON DFHEIGDI
 25007     ELSE IF DFHEIGDJ EQUAL 38
 25008         GO TO 3590-NOT-FOUND
 25009         DEPENDING ON DFHEIGDI
 25010     ELSE IF DFHEIGDJ EQUAL 39
 25011         GO TO 3690-NOT-FOUND
 25012         DEPENDING ON DFHEIGDI
 25013     ELSE IF DFHEIGDJ EQUAL 40
 25014         GO TO 3990-NOT-FOUND
 25015         DEPENDING ON DFHEIGDI
 25016     ELSE IF DFHEIGDJ EQUAL 41
 25017         GO TO 4050-END-RECORDS,
 25018               4050-END-RECORDS
 25019         DEPENDING ON DFHEIGDI
 25020     ELSE IF DFHEIGDJ EQUAL 42
 25021         GO TO 4150-END-BATCH
 25022         DEPENDING ON DFHEIGDI
 25023     ELSE IF DFHEIGDJ EQUAL 43
 25024         GO TO 4150-END-BATCH
 25025         DEPENDING ON DFHEIGDI
 25026     ELSE IF DFHEIGDJ EQUAL 44
 25027         GO TO 4250-END-RECORDS,
 25028               4250-END-RECORDS
 25029         DEPENDING ON DFHEIGDI
 25030     ELSE IF DFHEIGDJ EQUAL 45
 25031         GO TO 4350-END-BATCH,
 25032               4350-END-BATCH
 25033         DEPENDING ON DFHEIGDI
 25034     ELSE IF DFHEIGDJ EQUAL 46
 25035         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 04-Apr-18 13:35 Page 463
* EL6311.cbl
 25036               4550-END-RECORDS
 25037         DEPENDING ON DFHEIGDI
 25038     ELSE IF DFHEIGDJ EQUAL 47
 25039         GO TO 4680-NOT-FOUND,
 25040               4680-NOT-FOUND
 25041         DEPENDING ON DFHEIGDI
 25042     ELSE IF DFHEIGDJ EQUAL 48
 25043         GO TO 4860-NOT-FOUND,
 25044               4850-END-RECORDS
 25045         DEPENDING ON DFHEIGDI
 25046     ELSE IF DFHEIGDJ EQUAL 49
 25047         GO TO 4970-NOT-FOUND,
 25048               4950-END-RECORDS
 25049         DEPENDING ON DFHEIGDI
 25050     ELSE IF DFHEIGDJ EQUAL 50
 25051         GO TO 5050-NOT-FOUND
 25052         DEPENDING ON DFHEIGDI
 25053     ELSE IF DFHEIGDJ EQUAL 51
 25054         GO TO 5050-NOT-FOUND
 25055         DEPENDING ON DFHEIGDI
 25056     ELSE IF DFHEIGDJ EQUAL 52
 25057         GO TO 5050-NOT-FOUND
 25058         DEPENDING ON DFHEIGDI
 25059     ELSE IF DFHEIGDJ EQUAL 53
 25060         GO TO 5550-END-RECORDS,
 25061               5550-END-RECORDS
 25062         DEPENDING ON DFHEIGDI
 25063     ELSE IF DFHEIGDJ EQUAL 54
 25064         GO TO 6050-QID-ERROR
 25065         DEPENDING ON DFHEIGDI
 25066     ELSE IF DFHEIGDJ EQUAL 55
 25067         GO TO 6050-QID-ERROR
 25068         DEPENDING ON DFHEIGDI
 25069     ELSE IF DFHEIGDJ EQUAL 56
 25070         GO TO 6400-CONTINUE,
 25071               6400-CONTINUE
 25072         DEPENDING ON DFHEIGDI
 25073     ELSE IF DFHEIGDJ EQUAL 57
 25074         GO TO 3690-NOT-FOUND
 25075         DEPENDING ON DFHEIGDI
 25076     ELSE IF DFHEIGDJ EQUAL 58
 25077         GO TO 7399-EXIT
 25078         DEPENDING ON DFHEIGDI
 25079     ELSE IF DFHEIGDJ EQUAL 59
 25080         GO TO 7550-OFFICER-NOTFND
 25081         DEPENDING ON DFHEIGDI
 25082     ELSE IF DFHEIGDJ EQUAL 60
 25083         GO TO 8300-SEND-TEXT
 25084         DEPENDING ON DFHEIGDI.
 25085     MOVE '9%                    "   ' TO DFHEIV0
 25086     MOVE 'EL6311' TO DFHEIV1
 25087     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25088     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15820     Code:       99264
