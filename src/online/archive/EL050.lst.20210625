* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
    57* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    58* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    59* 092618  CR2018050200001  PEMA  Add check for open clm on issue
    60* 101019  CR2019100700001  PEMA  Disallow V status with claim
    61******************************************************************
    62 ENVIRONMENT DIVISION.
    63
    64 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page   3
* EL050.cbl
    66 WORKING-STORAGE SECTION.
    67 01  DFH-START PIC X(04).
    68
    69 77  FILLER   PIC X(32) VALUE '********************************'.
    70 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    71 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    72
    73 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    74 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    75                                   USAGE POINTER.
    76 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    77 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    78 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    79                                   USAGE IS POINTER.
    80 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    81 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    82                                   USAGE IS POINTER.
    83 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    84 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    85                                   USAGE IS POINTER.
    86
    87 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    88 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    89                                   USAGE IS POINTER.
    90
    91*    COPY ELC50WS.
    92*****************************************************************
    93*                                                               *
    94*                            ELC50WS.                           *
    95*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    96*                            VMOD=2.061.                        *
    97*                                                               *
    98*   THIS IS THE WORKING STORAGE FOR EL050                       *
    99*                                   EL517                       *
   100*****************************************************************
   101******************************************************************
   102*                   C H A N G E   L O G
   103*
   104* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   105*-----------------------------------------------------------------
   106*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   107* EFFECTIVE    NUMBER
   108*-----------------------------------------------------------------
   109* 123102                   PEMA  ADD DCC PROCESSING
   110* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   111* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   112* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   113* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   114* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   115* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   116* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   117* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   118* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   119* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   120* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   121* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   122* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   123* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page   4
* EL050.cbl
   124* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   125* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   126* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   127* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   128* 030309  CR2009021700001  PEMA  ADD ER-2883
   129* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   130* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   131* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   132* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   133* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   134* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   135* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   136* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   137* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   138* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   139* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   140* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   141* 061412  CR2011022800001  AJRA  NAPERSOFT
   142* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   143* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   144* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   145* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   146* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   147* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   148* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   149* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   150* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   151* 091114  IR2014091000001  TANA  ADD ERROR 2898
   152* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   153* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   154* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   155* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   156* 100617  CR2017062000003  PEMA  Inforce state comm cap
   157* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
   158* 062017  CR2015091000001  PEMA  ADD ST INT RATE FIELD
   159* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
   160* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
   161* 100518  CR2017061500001  TANA  ADD NEW ERROR MSGS
   162* 092618  CR2018050200001  PEMA  Add check for open clm on issue
   163* 101019  CR2019100700001  PEMA  Add error 3281 V stat on claim
   164* 011020  IR2019121100004  PEMA  Add error 3069 name&age equal
   165* 012220  CR2018092700002  TANA  ADD NEW ERROR MSGS
   166* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM ERROR MSG.
   167* 030920  IR2020030500001  PEMA  ADD ERROR 3071
   168*-----------------------------------------------------------------
   169
   170 01  WORK-AREAS.
   171
   172*****************************************************************
   173*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   174*****************************************************************
   175
   176     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   177     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   178     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   179     12  WS-NAME-EDIT-WORK-AREA.
   180         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   181         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page   5
* EL050.cbl
   182             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   183         16  WS-WORK-NAME.
   184             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   185             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   186             20  FILLER           PIC X(10)     VALUE SPACES.
   187         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   188             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   189
   190*****************************************************************
   191*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   192*****************************************************************
   193
   194     12  WS-ERRESC-KEY.
   195         16 WS-ERRESC-SEARCH-KEY.
   196             20  WS-ERRESC-COMPANY-CD PIC  X.
   197             20  WS-ERRESC-CARRIER    PIC  X.
   198             20  WS-ERRESC-GROUP      PIC X(6).
   199             20  WS-ERRESC-STATE      PIC XX.
   200             20  WS-ERRESC-ACCOUNT    PIC X(10).
   201         16 WS-ERRESC-RESIDUAL-KEY.
   202             20  WS-ERRESC-AGENT      PIC X(10).
   203             20  WS-ERRESC-RES-STATE  PIC XX.
   204             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   205*                                          YYYYMMDD
   206     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   207     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   208
   209*RESIDENT STATE TAX MASTER(ERRESS)
   210*
   211     12  WS-ERRESS-KEY.
   212         16  WS-ERRESS-COMPANY-CD      PIC  X.
   213         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   214         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   215         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   216*                                          YYYYMMDD
   217
   218     12  WS-CONTRACT-DATE              PIC 9(8).
   219*                                          YYYYMMDD
   220     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   221     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   222         16 WS-YEAR-YY                 PIC   9999.
   223         16 FILLER                     PIC 9(4).
   224*                                          YYYYMMDD
   225     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   226     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   227     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   228     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   229
   230     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   231         88  DPRB-1ST-TIME                      VALUE ' '.
   232
   233*****************************************************************
   234*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   235*****************************************************************
   236
   237     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   238     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   239     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page   6
* EL050.cbl
   240     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   241     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   242     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   243     12  ws-st-refund-int-rate   pic s9v9(4) comp-3 value +0.
   244     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   245     12  ws-st-agent-sig-edit    pic x          value spaces.
   246     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   247     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   249     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   250         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   251         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   252     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   253         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   254         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   255     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   256
   257     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   258     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   259
   260     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   261     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   262     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   263     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   264     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   265     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   266     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   267     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   268     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   269     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   270     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   271     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   272     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   273     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   274     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   275     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   276     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   277     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   278     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   279     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   280     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   281     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   282     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   283     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   284     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   285     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   286     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   287     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   288     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   289     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   290     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   291     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   292     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   293     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   294     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   295     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   296     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   297     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page   7
* EL050.cbl
   298     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   299     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   300     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   301     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   302     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   303     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   304     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   305     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   306     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   307     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   308     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   309     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   310     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   311     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   312     12  WS-2671-SW               PIC X         VALUE SPACE.
   313     12  WS-2672-SW               PIC X         VALUE SPACE.
   314     12  ws-9813-sw               pic x         value spaces.
   315     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   316         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   317     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   318         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   319     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   320
   321     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   322         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   323         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   324         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   325         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   326
   327     12  WS-CREDIT-EDIT-CONTROLS.
   328         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   329         16  WS-MIN-AGE           PIC 99                VALUE  0.
   330         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   331         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   332         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   333         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   334
   335     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   336     12  WS-AGE-FIELDS.
   337         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   338         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   339         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   340         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   341
   342     12  WS-SAVE-ALLOWABLE-BENEFIT.
   343         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   344         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   345         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   346         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   347         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   348         16  FILLER                      PIC XX.
   349
   350     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   351     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   352     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   353     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   354     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   355     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page   8
* EL050.cbl
   356     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   357     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   358     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   359     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   360
   361     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   362     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   363     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   364     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   365     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   366     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   367     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   368     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   369         88  WS-REDUCING              VALUE 'R'.
   370         88  WS-LEVEL                 VALUE 'L' 'P'.
   371     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   372
   373     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   374     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   375     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   376     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   377     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   378     12  ws-ah-max-bens           pic 99        value zeros.
   379     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   380     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   381     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   382     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   383
   384     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   385     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   386     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   387     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   388     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   389     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   390     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   391     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   392     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   393     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   394     12  WS-ACCT-SIG-SW.
   395         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   396         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   397     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   398     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   399     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   400     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   401     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   402     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   403     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   404     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   405     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   406     12  WS-INITIALS.
   407         16  WS-INIT-1            PIC X         VALUE SPACES.
   408         16  WS-INIT-2            PIC X         VALUE SPACES.
   409
   410     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   411     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   412     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   413     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page   9
* EL050.cbl
   414     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   415*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   416     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   417     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   418     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   419     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   420     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   421     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   422     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   423     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   424     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   425     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   426     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   427     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   428     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   429     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   430     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   431     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   432     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   433     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   434     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   435     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   436     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   437     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   438******** FLA
   439     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   440     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   441     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   442     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   443     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   444********
   445     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   446     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   447     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   448     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   449     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   450     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   451     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   452     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   453     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   454     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   455
   456     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   457         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   458                                         '0' THRU '9'.
   459
   460     12  NUMBER-OF-MONTHS.
   461         16  SK-MO OCCURS 12 TIMES PIC X.
   462
   463     12  WS-WORK-DATE.
   464         16  WS-YEAR            PIC 99    VALUE 00.
   465         16  WS-MONTH           PIC 99    VALUE 00.
   466         16  WS-DAY             PIC 99    VALUE 00.
   467
   468     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   469     12  WS-WORK-CRIT-DEV       REDEFINES
   470         WS-WORK-LF-CRIT-PER    PIC X(03).
   471
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  10
* EL050.cbl
   472     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   473     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   474
   475     12  WS-WORK-DATE-FROM.
   476         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   477         16  FILLER             PIC X  VALUE SPACE.
   478         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   479         16  FILLER             PIC X         VALUE SPACE.
   480         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   481
   482     12  WS-WORK-DATE-THRU.
   483         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   484         16  FILLER             PIC X         VALUE SPACE.
   485         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   486         16  FILLER             PIC X         VALUE SPACE.
   487         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   488
   489     12  WS-LF-INPUT-CD.
   490         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   491         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   492
   493     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   494     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   495         16  WS-AH-INPUT-CD-1   PIC X.
   496         16  WS-AH-INPUT-CD-2-3 PIC XX.
   497
   498     12  WS-SWITCHES.
   499         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   500         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   501             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   502         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   503             88  BANK-ACCT-FOUND          VALUE 'Y'.
   504         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   505             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   506         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   507             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   508         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   509             88  COMP-MASTER-FOUND        VALUE 'Y'.
   510         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   511             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   512         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   513             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   514         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   515             88  STAT-MASTER-FOUND        VALUE 'Y'.
   516         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   517             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   518         16  ELCRTT-FOUND-SW          PIC X    VALUE SPACES.
   519             88  ELCRTT-FOUND             VALUE 'Y'.
   520         16  ELCRTT-UPDATE-SW         PIC X    VALUE SPACES.
   521             88  ELCRTT-UPDATE            VALUE 'Y'.
   522         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   523             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   524         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   525             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   526         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   527             88  FORM-MASTER-FOUND        VALUE 'Y'.
   528         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   529             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  11
* EL050.cbl
   530         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   531             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   532         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   533             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   534         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   535             88  NO-BENEFIT-FOUND         VALUE 'N'.
   536         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   537             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   538         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   539             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   540         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   541             88  AH-BENEFIT-FOUND         VALUE ' '.
   542             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   543         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   544             88  LF-BENEFIT-FOUND         VALUE ' '.
   545             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   546         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   547             88  NO-STATE-RECORD          VALUE '1'.
   548         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   549             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   550         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   551             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   552         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   553             88  CERT-WAS-FOUND           VALUE ' '.
   554             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   555         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   556             88  BROWSE-STARTED           VALUE 'Y'.
   557         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   558             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   559         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   560             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   561         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   562             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   563         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   564             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   565         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   566             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   567         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   568             88  APP-CERT-USED            VALUE 'Y' 'A'.
   569         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   570             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   571             88  FIRST-TIME-THROUGH       VALUE '1'.
   572             88  CTBL-NOT-FOUND           VALUE '2'.
   573
   574         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   575             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   576
   577         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   578             88  DLO-ERROR-FOUND          VALUE 'Y'.
   579
   580********FLA
   581     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   582     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   583********
   584     12  RC-SW-1                  PIC X           VALUE '0'.
   585     12  RC-SW-2                  PIC X           VALUE '0'.
   586     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   587     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  12
* EL050.cbl
   588     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   589     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   590     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   591     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   592     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   593     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   594     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   595     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   596     12  LIT-SPACES               PIC X           VALUE SPACES.
   597     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   598     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   599     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   600     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   601     12  erpndm-unlock-sw         pic x           value spaces.
   602         88  need-to-unlock-erpndm  value 'Y'.
   603     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   604     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   605     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   606         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   607         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   608     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   609         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   610
   611 01  WS-EXTRA-PERIODS-BY-STATE.
   612     12  WS-INT-PERIODS          PIC 9.
   613     12  WS-EXTRA-PMTS           PIC 9.
   614 01  ws-net-only-state           pic x value 'N'.
   615 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   616     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   617     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   618 01  WS-CRI-SSN-WORK-AREA.
   619     05  WS-CRI-SOC-SEC-NO.
   620         10  WS-SS-REPT-CD       PIC X(5).
   621         10  WS-SS-LAST-NAME     PIC X(5).
   622         10  WS-SS-INITIAL       PIC X.
   623
   624     05  WS-CRI-REPORT-CODE.
   625         10  FILLER              PIC X(5).
   626         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   627
   628     05  WS-CRI-LAST-NAME.
   629         10  WS-CRI-NAME-MOVE    PIC X(5).
   630         10  FILLER              PIC X(10).
   631
   632 01  ws-state-commission-caps.
   633     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   634     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   635     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   636     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   637     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   638     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   639     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   640     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   641     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   642     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   643     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   644     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   645     05  ws-st-cap-limit-to      pic x.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  13
* EL050.cbl
   646     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
   647     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
   648     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
   649     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
   650     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
   651     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
   652     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
   653     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   654     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   655     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   656     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   657     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
   658 01  WS-NUM-TABLE                PIC X(26)  VALUE
   659     '12345678012345070923456789'.
   660 01  FILLER REDEFINES WS-NUM-TABLE.
   661     05  WS-NUM OCCURS 26        PIC 9.
   662 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   663 01  V1                          PIC S999 COMP-3.
   664 01  V2                          PIC S999 COMP-3.
   665 01  V3                          PIC S999 COMP-3.
   666 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   667 01  FILLER REDEFINES WS-WORK-VIN.
   668     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   669 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   670 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   671 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   672 01  WS-HEX-WORK.
   673     05  FILLER                  PIC X  VALUE LOW-VALUES.
   674     05  WS-HEX-BYTE             PIC X.
   675 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   676 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   677 01  WS-WORK-HIN-ROW-B.
   678     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   679
   680 01  ws-benefit-cd-chg-sw      pic x value spaces.
   681     88  benefit-code-chg           value 'Y'.
   682 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   683 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   684     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   685 01  WS-ROW-D-TABLE.
   686     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   687
   688 01  WS-HIN-TABLE-B.
   689     05  F                       PIC XX VALUE 'A2'.
   690     05  F                       PIC XX VALUE 'B3'.
   691     05  F                       PIC XX VALUE 'C4'.
   692     05  F                       PIC XX VALUE 'D5'.
   693     05  F                       PIC XX VALUE 'E6'.
   694     05  F                       PIC XX VALUE 'F7'.
   695     05  F                       PIC XX VALUE 'G8'.
   696     05  F                       PIC XX VALUE 'H9'.
   697     05  F                       PIC XX VALUE 'I1'.
   698     05  F                       PIC XX VALUE 'J2'.
   699     05  F                       PIC XX VALUE 'K3'.
   700     05  F                       PIC XX VALUE 'L4'.
   701     05  F                       PIC XX VALUE 'M5'.
   702     05  F                       PIC XX VALUE 'N6'.
   703     05  F                       PIC XX VALUE 'O0'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  14
* EL050.cbl
   704     05  F                       PIC XX VALUE 'P7'.
   705     05  F                       PIC XX VALUE 'Q0'.
   706     05  F                       PIC XX VALUE 'R8'.
   707     05  F                       PIC XX VALUE 'S9'.
   708     05  F                       PIC XX VALUE 'T2'.
   709     05  F                       PIC XX VALUE 'U3'.
   710     05  F                       PIC XX VALUE 'V4'.
   711     05  F                       PIC XX VALUE 'W5'.
   712     05  F                       PIC XX VALUE 'X6'.
   713     05  F                       PIC XX VALUE 'Y7'.
   714     05  F                       PIC XX VALUE 'Z8'.
   715 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   716     05  WS-VAL-IN               PIC X.
   717     05  WS-VAL-OUT              PIC 9.
   718 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   719 01  ws-greg-eff-date            pic x(10) value ' '.
   720 01  WS-COMPARE-BINARY-DATES.
   721     05  WS-971231                PIC XX VALUE X'92FF'.
   722     05  WS-931231                PIC XX VALUE X'8CFF'.
   723     05  WS-791231                PIC XX VALUE X'77FF'.
   724     05  WS-771001                PIC XX VALUE X'74A1'.
   725     05  WS-820301                PIC XX VALUE X'7B41'.
   726     05  WS-831031                PIC XX VALUE X'7DBF'.
   727     05  WS-831231                PIC XX VALUE X'7DFF'.
   728     05  WS-810831                PIC XX VALUE X'7A7F'.
   729     05  WS-830901                PIC XX VALUE X'7D81'.
   730
   731 01  FILE-ACCESS-IDS.
   732     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   733     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   734     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   735     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   736     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   737     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   738     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   739     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   740     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   741     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   742     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   743     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   744     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   745     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   746     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   747     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   748     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   749 01  DD-IU-SW                    PIC X   VALUE ' '.
   750     88  DD-IU-PRESENT                 VALUE 'Y'.
   751
   752 01  ACCESS-KEYS.
   753     12  ELMSTR-KEY.
   754         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   755         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   756     12  W-CLAIM-KEY.
   757         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   758         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   759
   760     12  ELCNTL-KEY.
   761         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  15
* EL050.cbl
   762         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   763         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   764         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   765
   766     12  ELCERT-KEY.
   767         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   768         16  CERT-CARRIER         PIC X       VALUE SPACE.
   769         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   770         16  CERT-STATE           PIC XX      VALUE SPACES.
   771         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   772         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   773         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   774
   775     12  ELCERT2-KEY.
   776         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   777         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   778
   779     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   780
   781     12  ELCERT-SAVE.
   782         16  FILLER                      PIC XX    VALUE SPACES.
   783
   784         16  WCS-CONTROL-PRIMARY.
   785             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   786             20  WCS-CARRIER             PIC X     VALUE SPACE.
   787             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   788             20  WCS-STATE               PIC XX    VALUE SPACES.
   789             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   790             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   791             20  WCS-CERT-NO.
   792                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   793                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   794
   795         16  CS-CONTROL-BY-NAME.
   796             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   797             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   798             20  CS-INSURED-INITIALS.
   799                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   800                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   801
   802         16  CS-CONTROL-BY-SSN.
   803             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   804             20  CS-SOC-SEC-NO.
   805                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   806                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   807                 24  CS-SSN-LN3.
   808                     28 CS-INSURED-INITIALS-A2   PIC XX
   809                                     VALUE SPACES.
   810                     28 CS-PART-LAST-NAME-A2     PIC X
   811                                     VALUE SPACE.
   812
   813         16  CS-CONTROL-BY-CERT-NO.
   814             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   815             20  CS-CERT-NO-A4           PIC X(11)
   816                                     VALUE SPACES.
   817
   818         16  CS-CONTROL-BY-MEMB.
   819             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  16
* EL050.cbl
   820             20  CS-MEMBER-NO.
   821                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   822                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   823                 24  CS-MEMB-LN4.
   824                     28 CS-INSURED-INITIALS-A5   PIC XX
   825                                      VALUE SPACES.
   826                     28 CS-PART-LAST-NAME-A5     PIC XX
   827                                      VALUE SPACES.
   828
   829         16  FILLER              PIC X(360) VALUE SPACES.
   830
   831     12  ERACCT-KEY.
   832         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   833         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   834         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   835         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   836         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   837         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   838
   839     12  ERCOMP-KEY.
   840         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   841         16  COMP-CARRIER         PIC X     VALUE SPACES.
   842         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   843         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   844         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   845         16  COMP-TYPE            PIC X     VALUE SPACES.
   846
   847     12  ERLOFC-KEY.
   848         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   849         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   850         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   851         16  LOFC-STATE           PIC XX    VALUE SPACES.
   852         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   853         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   854
   855     12  WS-ELCRTT-KEY.
   856         16  WS-ELCRTT-PRIMARY       PIC X(33).
   857         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   858
   859     12  ERBXRF-KEY.
   860         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   861         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   862         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   863         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   864
   865     12  ERAGTC-KEY.
   866         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   867         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   868         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   869         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   870         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   871         16  AGTC-TYPE            PIC X     VALUE SPACES.
   872
   873     12  ERPLAN-KEY.
   874         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   875         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   876         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   877         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  17
* EL050.cbl
   878         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   879         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   880         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   881         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   882
   883     12  ERFORM-KEY.
   884         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   885         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   886         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   887         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   888
   889     12  ERREIN-KEY.
   890         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   891         16  REIN-TYPE            PIC X     VALUE SPACES.
   892         16  REIN-TABLE-CO.
   893             20  REIN-CODE-1      PIC X     VALUE SPACE.
   894             20  REIN-CODE-2      PIC X     VALUE SPACE.
   895             20  REIN-CODE-3      PIC X     VALUE SPACE.
   896         16  FILLER               PIC X(3)  VALUE SPACES.
   897
   898     12  ERCTBL-KEY.
   899         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   900         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   901         16  CTBL-CNTRL-2.
   902             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   903             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   904
   905     12  ELCRTO-KEY.
   906         16  ELCRTO-COMPANY-CD       PIC X.
   907         16  ELCRTO-CARRIER          PIC X.
   908         16  ELCRTO-GROUPING         PIC X(6).
   909         16  ELCRTO-STATE            PIC XX.
   910         16  ELCRTO-ACCOUNT          PIC X(10).
   911         16  ELCRTO-CERT-EFF-DT      PIC XX.
   912         16  ELCRTO-CERT-NO.
   913             20  ELCRTO-CERT-PRIME   PIC X(10).
   914             20  ELCRTO-CERT-SFX     PIC X.
   915         16  ELCRTO-RECORD-TYPE      PIC X.
   916         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   917
   918
   919     12  WS-ACCESS.
   920         16  FILLER               PIC XX    VALUE SPACES.
   921         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   922
   923     12  WS-CARR-ACCESS.
   924         16  FILLER               PIC X(3)  VALUE SPACES.
   925         16  WS-CARR              PIC X     VALUE SPACE.
   926*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   927*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   928     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   929         88  WS-DMD-LF-RATING   VALUE 'Y'.
   930         88  WS-DMD-AH-RATING   VALUE 'Y'.
   931         88  WS-DMD-NO-RATING   VALUE 'N'.
   932
   933     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   934         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   935                                         'NJ' 'NL'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  18
* EL050.cbl
   936                                         'PJ' 'PL'
   937                                         'SJ' 'SL'.
   938     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   939         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   940                                         'NI' 'NJ' 'NL' 'NU'
   941                                         'PJ' 'PL' 'PI' 'PU'
   942                                         'SI' 'SJ' 'SL' 'SU'
   943                                         'MX' 'MY' 'MZ'.
   944 01  ERPDEF-KEY-SAVE             PIC X(18).
   945 01  ERPDEF-KEY.
   946     12  ERPDEF-COMPANY-CD       PIC X.
   947     12  ERPDEF-STATE            PIC XX.
   948     12  ERPDEF-PROD-CD          PIC XXX.
   949     12  F                       PIC X(7).
   950     12  ERPDEF-BEN-TYPE         PIC X.
   951     12  ERPDEF-BEN-CODE         PIC XX.
   952     12  ERPDEF-EXP-DT           PIC XX.
   953
   954 01  ELSTAT-KEY-SAVE             PIC X(20).
   955 01  ELSTAT-KEY.
   956     12  ELSTAT-COMPANY-ID       PIC XXX.
   957     12  ELSTAT-CARRIER          PIC X.
   958     12  ELSTAT-GROUP            PIC X(6).
   959     12  ELSTAT-STATE            PIC XX.
   960     12  ELSTAT-EXP-DT           PIC 9(8).
   961 01  WS-ERROR-VALUES.
   962     12  ER-1570                     PIC S9(4)   VALUE +1570.
   963     12  ER-1571                     PIC S9(4)   VALUE +1571.
   964     12  er-1572                     pic s9(4)   value +1572.
   965     12  er-1573                     pic s9(4)   value +1573.
   966     12  er-1574                     pic s9(4)   value +1574.
   967     12  ER-1575                     PIC S9(4)   VALUE +1575.
   968     12  er-1576                     pic s9(4)   value +1576.
   969     12  er-1577                     pic s9(4)   value +1577.
   970     12  er-1583                     pic s9(4)   value +1583.
   971     12  er-1584                     pic s9(4)   value +1584.
   972     12  er-1743                     pic s9(4)   value +1743.
   973     12  er-1744                     pic s9(4)   value +1744.
   974     12  er-1745                     pic s9(4)   value +1745.
   975     12  er-1746                     pic s9(4)   value +1746.
   976     12  er-1747                     pic s9(4)   value +1747.
   977     12  er-1748                     pic s9(4)   value +1748.
   978     12  er-1749                     pic s9(4)   value +1749.
   979     12  er-1750                     pic s9(4)   value +1750.
   980     12  er-1751                     pic s9(4)   value +1751.
   981     12  er-1752                     pic s9(4)   value +1752.
   982     12  er-1753                     pic s9(4)   value +1753.
   983     12  er-1754                     pic s9(4)   value +1754.
   984     12  er-1755                     pic s9(4)   value +1755.
   985     12  er-1756                     pic s9(4)   value +1756.
   986     12  er-1757                     pic s9(4)   value +1757.
   987     12  er-1758                     pic s9(4)   value +1758.
   988     12  er-1759                     pic s9(4)   value +1759.
   989     12  er-1760                     pic s9(4)   value +1760.
   990     12  er-1761                     pic s9(4)   value +1761.
   991     12  ER-1891                     PIC S9(4)   VALUE +1891.
   992     12  ER-1892                     PIC S9(4)   VALUE +1892.
   993     12  ER-1893                     PIC S9(4)   VALUE +1893.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  19
* EL050.cbl
   994     12  ER-1894                     PIC S9(4)   VALUE +1894.
   995     12  ER-1895                     PIC S9(4)   VALUE +1895.
   996     12  ER-1896                     PIC S9(4)   VALUE +1896.
   997     12  ER-1897                     PIC S9(4)   VALUE +1897.
   998     12  ER-1898                     PIC S9(4)   VALUE +1898.
   999     12  ER-1899                     PIC S9(4)   VALUE +1899.
  1000     12  ER-1900                     PIC S9(4)   VALUE +1900.
  1001     12  ER-1901                     PIC S9(4)   VALUE +1901.
  1002     12  ER-1902                     PIC S9(4)   VALUE +1902.
  1003     12  ER-1903                     PIC S9(4)   VALUE +1903.
  1004     12  ER-1904                     PIC S9(4)   VALUE +1904.
  1005     12  ER-1905                     PIC S9(4)   VALUE +1905.
  1006     12  ER-1906                     PIC S9(4)   VALUE +1906.
  1007     12  ER-1907                     PIC S9(4)   VALUE +1907.
  1008     12  ER-1909                     PIC S9(4)   VALUE +1909.
  1009     12  ER-1910                     PIC S9(4)   VALUE +1910.
  1010     12  ER-1911                     PIC S9(4)   VALUE +1911.
  1011     12  ER-1912                     PIC S9(4)   VALUE +1912.
  1012     12  ER-1913                     PIC S9(4)   VALUE +1913.
  1013     12  ER-1914                     PIC S9(4)   VALUE +1914.
  1014     12  ER-1915                     PIC S9(4)   VALUE +1915.
  1015     12  ER-1916                     PIC S9(4)   VALUE +1916.
  1016     12  ER-1917                     PIC S9(4)   VALUE +1917.
  1017     12  ER-1918                     PIC S9(4)   VALUE +1918.
  1018     12  ER-1919                     PIC S9(4)   VALUE +1919.
  1019     12  ER-1920                     PIC S9(4)   VALUE +1920.
  1020     12  ER-1921                     PIC S9(4)   VALUE +1921.
  1021     12  ER-1922                     PIC S9(4)   VALUE +1922.
  1022     12  ER-1923                     PIC S9(4)   VALUE +1923.
  1023     12  ER-1924                     PIC S9(4)   VALUE +1924.
  1024     12  ER-1925                     PIC S9(4)   VALUE +1925.
  1025     12  ER-1926                     PIC S9(4)   VALUE +1926.
  1026     12  ER-1927                     PIC S9(4)   VALUE +1927.
  1027     12  ER-1955                     PIC s9(4)   VALUE +1955.
  1028     12  ER-1956                     PIC s9(4)   VALUE +1956.
  1029     12  ER-1957                     PIC s9(4)   VALUE +1957.
  1030     12  ER-1958                     PIC s9(4)   VALUE +1958.
  1031     12  ER-1959                     PIC s9(4)   VALUE +1959.
  1032     12  ER-1960                     PIC s9(4)   VALUE +1960.
  1033     12  ER-1961                     PIC s9(4)   VALUE +1961.
  1034     12  ER-1962                     PIC s9(4)   VALUE +1962.
  1035     12  ER-1963                     PIC s9(4)   VALUE +1963.
  1036     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1037     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1038     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1039     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1040     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1041     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1042     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1043     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1044     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1045     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1046     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1047     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1048     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1049     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1050     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1051     12  ER-2614                     PIC S9(4)   VALUE +2614.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  20
* EL050.cbl
  1052     12  ER-2615                     PIC S9(4)   VALUE +2615.
  1053     12  ER-2616                     PIC S9(4)   VALUE +2616.
  1054     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1055     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1056     12  ER-2619                     PIC S9(4)   VALUE +2619.
  1057     12  ER-2620                     PIC S9(4)   VALUE +2620.
  1058     12  ER-2621                     PIC S9(4)   VALUE +2621.
  1059     12  ER-2622                     PIC S9(4)   VALUE +2622.
  1060     12  ER-2623                     PIC S9(4)   VALUE +2623.
  1061     12  ER-2624                     PIC S9(4)   VALUE +2624.
  1062     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1063     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1064     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1065     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1066     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1067     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1068     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1069     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1070     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1071     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1072     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1073     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1074     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1075     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1076     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1077     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1078     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1079     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1080     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1081     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1082     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1083     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1084     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1085     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1086     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1087     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1088     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1089     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1090     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1091     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1092     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1093     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1094     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1095     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1096     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1097     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1098     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1099     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1100     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1101     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1102     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1103     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1104     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1105     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1106     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1107     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1108     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1109     12  ER-2672                     PIC S9(4)   VALUE +2672.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  21
* EL050.cbl
  1110     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1111     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1112     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1113     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1114     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1115     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1116     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1117     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1118     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1119     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1120     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1121     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1122     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1123     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1124     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1125     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1126     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1127     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1128     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1129     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1130     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1131     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1132     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1133     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1134     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1135     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1136     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1137     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1138     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1139     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1140     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1141     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1142     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1143     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1144     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1145     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1146     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1147     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1148     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1149     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1150     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1151     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1152     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1153     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1154     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1155     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1156     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1157     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1158     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1159     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1160     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1161     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1162     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1163     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1164     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1165     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1166     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1167     12  ER-2740                     PIC S9(4)   VALUE +2740.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  22
* EL050.cbl
  1168     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1169     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1170     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1171     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1172     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1173     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1174     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1175     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1176     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1177     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1178     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1179     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1180     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1181     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1182     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1183     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1184     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1185     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1186     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1187     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1188     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1189     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1190     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1191     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1192     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1193     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1194     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1195     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1196     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1197     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1198     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1199     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1200     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1201     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1202     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1203     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1204     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1205     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1206     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1207     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1208     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1209     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1210     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1211     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1212     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1213     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1214     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1215     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1216     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1217     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1218     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1219     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1220     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1221     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1222     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1223     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1224     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1225     12  ER-2883                     PIC S9(4)   VALUE +2883.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  23
* EL050.cbl
  1226     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1227     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1228     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1229     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1230     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1231     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1232     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1233     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1234     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1235     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1236     12  ER-2894                     PIC S9(4)   VALUE +2894.
  1237     12  ER-2895                     PIC S9(4)   VALUE +2895.
  1238     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1239     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1240     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1241     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1242     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1243     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1244     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1245     12  ER-2998                     PIC S9(4)   VALUE +2998.
  1246     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1247     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1248     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1249     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1250     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1251     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1252     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1253     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1254     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1255     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1256     12  ER-3062                     PIC S9(4)   VALUE +3062.
  1257     12  ER-3063                     PIC S9(4)   VALUE +3063.
  1258     12  ER-3068                     PIC S9(4)   VALUE +3068.
  1259     12  ER-3069                     PIC S9(4)   VALUE +3069.
  1260     12  er-3070                     pic s9(4)   value +3070.
  1261     12  er-3071                     pic s9(4)   value +3071.
  1262     12  er-3270                     pic s9(4)   value +3270.
  1263     12  er-3273                     pic s9(4)   value +3273.
  1264     12  er-3281                     pic s9(4)   value +3281.
  1265     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1266     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1267     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1268     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1269     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1270     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1271     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1272     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1273     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1274     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1275     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1276     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1277     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1278     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1279     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1280     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1281     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1282     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1283     12  ER-7823                     PIC S9(4)   VALUE +7823.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  24
* EL050.cbl
  1284     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1285     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1286     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1287     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1288     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1289     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1290     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1291     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1292     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1293     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1294     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1295     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1296     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1297     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1298     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1299     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1300     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1301     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1302     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1303     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1304     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1305     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1306     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1307     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1308     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1309     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1310     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1311     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1312     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1313     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1314     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1315     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1316     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1317     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1318     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1319     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1320     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1321     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1322     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1323     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1324     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1325     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1326     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1327     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1328     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1329     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1330     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1331     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1332     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1333     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1334     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1335     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1336     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1337     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1338     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1339     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1340     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1341     12  ER-8301                     PIC S9(4)   VALUE +8301.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  25
* EL050.cbl
  1342     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1343     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1344     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1345     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1346     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1347     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1348     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1349     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1350     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1351     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1352     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1353     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1354     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1355     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1356     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1357     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1358     12  er-9823                     pic s9(4)   value +9823.
  1359     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1360******************************************************************
  1361***************   END OF ELC50WS     ****************************
  1362******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  26
* EL050.cbl
  1365 01  WORKING-STORAGE-WORK-AREAS.
  1366     12  WS-RESPONSE             PIC S9(8)  COMP.
  1367         88  WS-RESP-NORMAL           VALUE +00.
  1368         88  WS-RESP-ERROR            VALUE +01.
  1369         88  WS-RESP-NOTFND           VALUE +13.
  1370         88  WS-RESP-DUPREC           VALUE +14.
  1371         88  WS-RESP-ENDFILE          VALUE +20.
  1372     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1373     12  WORK-AREAS.
  1374         16  WK-CONV-GREG.
  1375             24  WCG-CENT             PIC XX.
  1376             24  WCG-REST             PIC X(4).
  1377         16  WORK-GREGORIAN-DATE.
  1378             24  WK-GREG-CENT         PIC XX.
  1379             24  WK-GREG-DATE-YYMMDD.
  1380                 28  WK-GREG-YYMM     PIC X(4).
  1381                 28  WK-GREG-DD       PIC XX.
  1382
  1383         16  WORK-SELECT-DATE.
  1384             24  WK-SELECT-CENT            PIC XX.
  1385             24  WK-SELECT-DATE-YYMMDD.
  1386                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1387                 28  FILLER                PIC XX.
  1388
  1389         16  WK-FORM-NO.
  1390             24  WK-FORM-BANK-ID       PIC X(5).
  1391             24  WK-FORM-UNDRWRTR      PIC X(1).
  1392             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1393
  1394         16  WK-MEMBER-NO.
  1395             24  WK-MEMBER-1-6        PIC X(6).
  1396             24  WK-MEMBER-7-12       PIC X(6).
  1397
  1398         16  WK-FULL-CERT-NO.
  1399             24  WK-CERT-POS-1-2      PIC X(2).
  1400             24  WK-CERT-POS-3        PIC X(1).
  1401             24  WK-CERT-POS-4        PIC X(1).
  1402             24  WK-CERT-POS-5-6      PIC X(2).
  1403             24  WK-CERT-POS-7        PIC X(1).
  1404             24  WK-CERT-POS-8-11     PIC X(4).
  1405
  1406         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1407             88  VALID-RATE-CODE        VALUE 'Y'.
  1408             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1409
  1410         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1411         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1412         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1413         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1414         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1415         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1416         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1417         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1418         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1419         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1420
  1421* DLO001
  1422 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  27
* EL050.cbl
  1423     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1424     12  DMPF-RETURN-CODE          PIC XX.
  1425         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1426         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1427         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1428         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1429         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1430         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1431
  1432* DLO002
  1433 01  WS-DLO-INTERNAL-POLICY-FORM.
  1434     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1435     12  DIPF-RETURN-CODE          PIC XX.
  1436         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1437         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1438         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1439         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1440         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1441         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1442
  1443* DLO003
  1444 01  WS-DLO-VALID-BANK-ID.
  1445     12  DVBI-BANK-ID              PIC X(5).
  1446     12  DVBI-BANK-ID-TYPE         PIC X.
  1447         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1448         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1449         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1450         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1451         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1452     12  DVBI-RETURN-CODE          PIC XX.
  1453         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1454         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1455         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1456         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1457         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1458         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1459         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1460         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1461         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1462
  1463* DLO007
  1464 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1465     12  DCUA-RES-STATE            PIC XX.
  1466     12  DCUA-BEN-TYPE             PIC XX.
  1467     12  DCUA-SYS-IDENT            PIC X.
  1468         88  DCUA-CLAIM                        VALUE 'C'.
  1469         88  DCUA-PREMIUM                      VALUE 'P'.
  1470     12  DCUA-COVERAGE-RULE        PIC X.
  1471     12  DCUA-CLIENT-ID            PIC X(10).
  1472     12  DCUA-EFF-DATE             PIC X(8).
  1473     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1474     12  DCUA-RETURN-CODE          PIC XX.
  1475         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1476     12  DCUA-CERT-NUMBER          PIC X(11).
  1477     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1478     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1479
  1480* DLO011
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  28
* EL050.cbl
  1481 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1482     12  DPRB-RATE-CODE            PIC X(4).
  1483     12  DPRB-COVERAGE-CATEG       PIC X.
  1484     12  DPRB-RETURN-CODE          PIC XX.
  1485         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1486         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1487         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1488         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1489         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1490         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1491         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1492         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1493         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1494     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1495     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1496     12  DPRB-BEN-TYPE             PIC XX.
  1497
  1498* DLO017
  1499 01  WS-DLO-VALID-RATE-CODE.
  1500     12  DVRC-RATE-CODE            PIC X(4).
  1501     12  DVRC-RETURN-CODE          PIC XX.
  1502         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1503         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1504         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1505         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1506         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1507         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1508
  1509* DLO019
  1510 01  WS-DLO-ORIG-COV-CAT.
  1511     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1512     12  DOCC-RETURN-CODE          PIC XX.
  1513     12  DOCC-ORIG-COV-CAT         PIC X.
  1514     12  DOCC-UNDERWITER           PIC XX.
  1515     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1516     12  DOCC-FILLER               PIC X(6).
  1517
  1518* DLO021
  1519 01  WS-DLO-VALID-LOAN-OFFICER.
  1520     12  DVLO-LOAN-OFFICER.
  1521         16  DVLO-BILL-TYPE        PIC X.
  1522         16  DVLO-BILL-SOURCE      PIC X.
  1523         16  DVLO-BATCH-TYPE       PIC X.
  1524     12  DVLO-RETURN-CODE          PIC XX.
  1525         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1526         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1527         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1528         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1529         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1530         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1531
  1532* DLO022
  1533 01  WS-DLO-VALID-STATE-CODE.
  1534     12  DVSC-STATE-CODE           PIC XX.
  1535     12  DVSC-RETURN-CODE          PIC XX.
  1536         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1537
  1538* DLO023
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  29
* EL050.cbl
  1539 01  WS-DLO-VALID-CODE-VALUES.
  1540     12  DVCV-SYSTEM-ID            PIC XX.
  1541         88  DVCV-CLAIMS                       VALUE 'CL'.
  1542         88  DVCV-CREDIT                       VALUE 'CR'.
  1543     12  DVCV-RECORD-TYPE          PIC XX.
  1544         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1545         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1546         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1547         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1548         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1549         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1550         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1551         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1552     12  DVCV-RECORD-KEY           PIC X(6).
  1553     12  DVCV-RETURN-CODE          PIC XX.
  1554         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1555         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1556         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1557         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1558         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1559         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1560         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1561     12  DVCV-CODE-DESC            PIC X(60).
  1562     12  DVCV-GEN-DESC-1           PIC X(20).
  1563     12  DVCV-GEN-DESC-2           PIC X(20).
  1564     12  DVCV-GEN-DESC-3           PIC X(20).
  1565
  1566 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1567 01  hldi-pass-area.
  1568     03  PA-VIN                  PIC X(17).
  1569     03  PA-ErrorCode            PIC X(10).
  1570     03  PA-ErrorDesc            PIC X(30).
  1571     03  PA-ModelYear            PIC 9(7).
  1572     03  PA-MakeName             PIC X(50).
  1573     03  PA-ModelName            PIC X(50).
  1574     03  PA-SeriesName           PIC X(50).
  1575 01  zipcd-pass-area-len         pic s9(4) comp value +67.
  1576 01  zipcd-pass-area.
  1577     03  PA-zip                  PIC X(5).
  1578     03  PA-ErrorCode-zip        PIC X(10).
  1579     03  PA-city                 PIC x(50).
  1580     03  PA-state                PIC Xx.
  1581 01  clmhs-pass-area-len         pic s9(4) comp value +40.
  1582 01  clmhs-pass-area.
  1583     03  pa-clmhs-state          pic xx.
  1584     03  pa-account              pic x(10).
  1585     03  pa-eff-dt               pic x(10).
  1586     03  pa-cert-no              pic x(11).
  1587     03  pa-clm-count            pic 9(5).
  1588****  this is for aggregate report.
  1589****  Length is erpndb + 100 of passed-key-area
  1590 01  ws-passed-key-length        pic s9(4) comp value +587.
  1591 01  ws-pass-to-pemaggo.
  1592     05  ws-passed-erpndb        pic x(585).
  1593     05  ws-exceed-limit-yn      pic x.
  1594     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  30
* EL050.cbl
  1596*    COPY ERCBXRF.
  1597******************************************************************
  1598*                                                                *
  1599*                                                                *
  1600*                            ERCBXRF                             *
  1601*                                                                *
  1602*   ONLINE CREDIT SYSTEM                                         *
  1603*                                                                *
  1604*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1605*                                                                *
  1606*   FILE TYPE = VSAM,KSDS                                        *
  1607*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1608*                                                                *
  1609*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1610*       ALTERNATE PATH = NONE                                    *
  1611*                                                                *
  1612*   LOG = NO                                                     *
  1613*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1614*                                                                *
  1615******************************************************************
  1616
  1617 01  BANK-CROSS-REFERENCE.
  1618     12  BK-RECORD-ID                PIC XX.
  1619         88  VALID-BK-ID             VALUE 'BK'.
  1620
  1621     12  BK-CONTROL-PRIMARY.
  1622         16  BK-COMPANY-CD           PIC X.
  1623         16  BK-CARRIER              PIC X.
  1624         16  BK-GROUPING             PIC X(6).
  1625         16  BK-BANK-NO              PIC X(10).
  1626
  1627     12  BK-MAINT-INFORMATION.
  1628         16  BK-LAST-MAINT-DT        PIC XX.
  1629         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1630         16  BK-LAST-MAINT-USER      PIC X(4).
  1631         16  FILLER                  PIC X(9).
  1632
  1633     12  FILLER                      PIC X(37).
  1634
  1635     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1636
  1637     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1638                            DEPENDING ON BK-BANK-POINTER-CNT.
  1639         16  BK-AM-ACCOUNT           PIC X(10).
  1640         16  BK-AM-EXP-DT            PIC XX.
  1641         16  BK-AM-EFF-DT            PIC XX.
  1642         16  BK-AM-STATE             PIC XX.
  1643         16  FILLER                  PIC X(20).
  1644
  1645******************************************************************
  1646
  1647*    COPY ERCCOMP.
  1648******************************************************************
  1649*                                                                *
  1650*                                                                *
  1651*                            ERCCOMP                             *
  1652*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1653*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  31
* EL050.cbl
  1654*                                                                *
  1655*   ONLINE CREDIT SYSTEM                                         *
  1656*                                                                *
  1657*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1658*                                                                *
  1659*   FILE TYPE = VSAM,KSDS                                        *
  1660*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1661*                                                                *
  1662*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1663*       ALTERNATE PATH = NONE                                    *
  1664*                                                                *
  1665*   LOG = NO                                                     *
  1666*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1667*                                                                *
  1668******************************************************************
  1669*                   C H A N G E   L O G
  1670*
  1671* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1672*-----------------------------------------------------------------
  1673*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1674* EFFECTIVE    NUMBER
  1675*-----------------------------------------------------------------
  1676* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1677* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1678* 092205    2005050300006  PEMA  ADD LEASE FEE
  1679* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1680* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1681* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1682* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1683* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1684* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1685******************************************************************
  1686
  1687 01  COMPENSATION-MASTER.
  1688     12  CO-RECORD-ID                          PIC XX.
  1689         88  VALID-CO-ID                          VALUE 'CO'.
  1690
  1691     12  CO-CONTROL-PRIMARY.
  1692         16  CO-COMPANY-CD                     PIC X.
  1693         16  CO-CONTROL.
  1694             20  CO-CTL-1.
  1695                 24  CO-CARR-GROUP.
  1696                     28  CO-CARRIER            PIC X.
  1697                     28  CO-GROUPING.
  1698                         32  CO-GROUP-PREFIX   PIC XXX.
  1699                         32  CO-GROUP-PRIME    PIC XXX.
  1700                 24  CO-RESP-NO.
  1701                     28  CO-RESP-PREFIX        PIC X(4).
  1702                     28  CO-RESP-PRIME         PIC X(6).
  1703             20  CO-CTL-2.
  1704                 24  CO-ACCOUNT.
  1705                     28  CO-ACCT-PREFIX        PIC X(4).
  1706                     28  CO-ACCT-PRIME         PIC X(6).
  1707         16  CO-TYPE                           PIC X.
  1708             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1709             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1710             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1711
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  32
* EL050.cbl
  1712     12  CO-MAINT-INFORMATION.
  1713         16  CO-LAST-MAINT-DT                  PIC XX.
  1714         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1715         16  CO-LAST-MAINT-USER                PIC X(4).
  1716     12  FILLER                                PIC XX.
  1717     12  CO-STMT-TYPE                          PIC XXX.
  1718     12  CO-COMP-TYPE                          PIC X.
  1719         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1720     12  CO-STMT-OWNER                         PIC X(4).
  1721     12  CO-BALANCE-CONTROL                    PIC X.
  1722         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1723         88  CO-NO-BALANCE                        VALUE 'N'.
  1724
  1725     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1726         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1727         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1728         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1729
  1730     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1731         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1732         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1733
  1734     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1735     12  CO-GA-DIRECT-DEP                      PIC X.
  1736     12  CO-FUTURE-SPACE                       PIC X.
  1737         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1738
  1739     12  CO-ACCT-NAME                          PIC X(30).
  1740     12  CO-MAIL-NAME                          PIC X(30).
  1741     12  CO-ADDR-1                             PIC X(30).
  1742     12  CO-ADDR-2                             PIC X(30).
  1743     12  CO-ADDR-3.
  1744         16  CO-ADDR-CITY                      PIC X(27).
  1745         16  CO-ADDR-STATE                     PIC XX.
  1746     12  CO-CSO-1099                           PIC X.
  1747     12  CO-ZIP.
  1748         16  CO-ZIP-PRIME.
  1749             20  CO-ZIP-PRI-1ST                PIC X.
  1750                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1751             20  FILLER                        PIC X(4).
  1752         16  CO-ZIP-PLUS4                      PIC X(4).
  1753     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1754         16  CO-CAN-POSTAL-1                   PIC XXX.
  1755         16  CO-CAN-POSTAL-2                   PIC XXX.
  1756         16  FILLER                            PIC XXX.
  1757     12  CO-SOC-SEC                            PIC X(13).
  1758     12  CO-TELEPHONE.
  1759         16  CO-AREA-CODE                      PIC XXX.
  1760         16  CO-PREFIX                         PIC XXX.
  1761         16  CO-PHONE                          PIC X(4).
  1762
  1763     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1764
  1765     12  CO-AR-BAL-LEVEL                       PIC X.
  1766         88  CO-AR-REF-LVL                        VALUE '1'.
  1767         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1768         88  CO-AR-BILL-LVL                       VALUE '2'.
  1769         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  33
* EL050.cbl
  1770         88  CO-AR-FR-LVL                         VALUE '4'.
  1771
  1772     12  CO-AR-NORMAL-PRINT                    PIC X.
  1773         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1774         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1775
  1776     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1777
  1778     12  CO-AR-REPORTING                       PIC X.
  1779         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1780         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1781
  1782     12  CO-AR-PULL-CHECK                      PIC X.
  1783         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1784         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1785
  1786     12  CO-AR-BALANCE-PRINT                   PIC X.
  1787         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1788
  1789     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1790         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1791         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1792         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1793
  1794     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1795
  1796     12  CO-USER-CODE                          PIC X.
  1797     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1798
  1799******************************************************************
  1800*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1801*    THE LAST MONTH END RUN.
  1802******************************************************************
  1803
  1804     12  CO-LAST-ACTIVITY-DATE.
  1805         16  CO-ACT-YEAR                       PIC 99.
  1806         16  CO-ACT-MONTH                      PIC 99.
  1807         16  CO-ACT-DAY                        PIC 99.
  1808
  1809     12  CO-LAST-STMT-DT.
  1810         16  CO-LAST-STMT-YEAR                 PIC 99.
  1811         16  CO-LAST-STMT-MONTH                PIC 99.
  1812         16  CO-LAST-STMT-DAY                  PIC 99.
  1813
  1814     12  CO-MO-END-TOTALS.
  1815         16  CO-MONTHLY-TOTALS.
  1816             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1817             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1818             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1819             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1820             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1821
  1822         16  CO-AGING-TOTALS.
  1823             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1824             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1825             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1826             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1827
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  34
* EL050.cbl
  1828         16  CO-YTD-TOTALS.
  1829             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1830             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1831
  1832         16  CO-OVER-UNDER-TOTALS.
  1833             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1834             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1835
  1836     12  CO-MISCELLANEOUS-TOTALS.
  1837         16  CO-FICA-TOTALS.
  1838             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1839             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1840
  1841         16  CO-CLAIM-TOTALS.
  1842             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1843             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1844
  1845******************************************************************
  1846*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1847*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1848******************************************************************
  1849
  1850     12  CO-CURRENT-TOTALS.
  1851         16  CO-CURRENT-LAST-STMT-DT.
  1852             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1853             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1854             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1855
  1856         16  CO-CURRENT-MONTHLY-TOTALS.
  1857             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1858             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1859             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1860             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1861             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1862
  1863         16  CO-CURRENT-AGING-TOTALS.
  1864             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1865             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1866             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1867             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1868
  1869         16  CO-CURRENT-YTD-TOTALS.
  1870             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1871             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1872
  1873     12  CO-PAID-COMM-TOTALS.
  1874         16  CO-YTD-PAID-COMMS.
  1875             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1876             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1877
  1878     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1879         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1880         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1881
  1882     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1883         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1884         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1885         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  35
* EL050.cbl
  1886         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1887         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1888         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1889         88  CO-FINAL-LETTER                  VALUE 'F'.
  1890         88  CO-RECONCILING                   VALUE 'R'.
  1891         88  CO-PHONE-CALL                    VALUE 'P'.
  1892         88  CO-LEGAL                         VALUE 'L'.
  1893         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1894         88  CO-WRITE-OFF                     VALUE 'W'.
  1895         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1896
  1897     12  CO-CSR-CODE                       PIC X(4).
  1898
  1899     12  CO-GA-STATUS-INFO.
  1900         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1901         16  CO-GA-TERMINATION-DT          PIC XX.
  1902         16  CO-GA-STATUS-CODE             PIC X.
  1903             88  CO-GA-ACTIVE                 VALUE 'A'.
  1904             88  CO-GA-INACTIVE               VALUE 'I'.
  1905             88  CO-GA-PENDING                VALUE 'P'.
  1906         16  CO-GA-COMMENTS.
  1907             20  CO-GA-COMMENT-1           PIC X(40).
  1908             20  CO-GA-COMMENT-2           PIC X(40).
  1909             20  CO-GA-COMMENT-3           PIC X(40).
  1910             20  CO-GA-COMMENT-4           PIC X(40).
  1911
  1912     12  CO-RPTCD2                         PIC X(10).
  1913     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1914         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1915         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1916
  1917     12  CO-TYPE-AGENT                     PIC X(01).
  1918         88  CO-CORPORATION                   VALUE 'C'.
  1919         88  CO-PARTNERSHIP                   VALUE 'P'.
  1920         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1921         88  CO-TRUST                         VALUE 'T'.
  1922         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1923
  1924     12  CO-FAXNO.
  1925         16  CO-FAX-AREA-CODE                  PIC XXX.
  1926         16  CO-FAX-PREFIX                     PIC XXX.
  1927         16  CO-FAX-PHONE                      PIC X(4).
  1928
  1929     12  CO-BANK-INFORMATION.
  1930         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1931         16  CO-BANK-TRANSIT-NON REDEFINES
  1932             CO-BANK-TRANSIT-NO                PIC 9(8).
  1933
  1934         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1935     12  CO-MISC-DEDUCT-INFO REDEFINES
  1936                  CO-BANK-INFORMATION.
  1937         16  CO-MD-GL-ACCT                     PIC X(10).
  1938         16  CO-MD-DIV                         PIC XX.
  1939         16  CO-MD-CENTER                      PIC X(4).
  1940         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1941         16  CO-CREATE-AP-CHECK                PIC X.
  1942         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1943         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  36
* EL050.cbl
  1944     12  CO-ACH-STATUS                         PIC X.
  1945         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1946         88  CO-ACH-PENDING                        VALUE 'P'.
  1947
  1948     12  CO-BILL-SW                            PIC X.
  1949     12  CO-CONTROL-NAME                       PIC X(30).
  1950     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1951     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1952     12  CO-CLP-STATE                          PIC XX.
  1953     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1954     12  CO-SPP-REFUND-EDIT                    PIC X.
  1955
  1956******************************************************************
  1957
  1958*    COPY ERCAGTC.
  1959******************************************************************
  1960*                                                                *
  1961*                                                                *
  1962*                            ERCAGTC                             *
  1963*                            VMOD=2.001                          *
  1964*                                                                *
  1965*   ONLINE CREDIT SYSTEM                                         *
  1966*                                                                *
  1967*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1968*                                                                *
  1969*   FILE TYPE = VSAM,KSDS                                        *
  1970*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1971*                                                                *
  1972*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1973*       ALTERNATE PATH = NONE                                    *
  1974*                                                                *
  1975*   LOG = NO                                                     *
  1976*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1977*                                                                *
  1978******************************************************************
  1979*                   C H A N G E   L O G
  1980*
  1981* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1982*-----------------------------------------------------------------
  1983*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1984* EFFECTIVE    NUMBER
  1985*-----------------------------------------------------------------
  1986* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1987* 111004                         NEW FILE AND COPYBOOK
  1988* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1989******************************************************************
  1990 01  AGENT-COMMISSIONS.
  1991     12  AG-RECORD-ID                          PIC XX.
  1992         88  VALID-CO-ID                          VALUE 'AG'.
  1993     12  AG-CONTROL-PRIMARY.
  1994         16  AG-COMPANY-CD                     PIC X.
  1995         16  AG-CONTROL.
  1996             20  AG-CTL-1.
  1997                 24  AG-CARR-GROUP.
  1998                     28  AG-CARRIER            PIC X.
  1999                     28  AG-GROUPING           PIC X(6).
  2000                 24  AG-BANK                   PIC X(10).
  2001             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  37
* EL050.cbl
  2002                 24  AG-EXP-DT                 PIC XX.
  2003         16  AG-TYPE                           PIC X.
  2004             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2005             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2006     12  AG-MAINT-INFORMATION.
  2007         16  AG-LAST-MAINT-DT                  PIC XX.
  2008         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2009         16  AG-LAST-MAINT-USER                PIC X(4).
  2010         16  FILLER                            PIC X(10).
  2011     12  AG-EFF-DT                             PIC XX.
  2012     12  AG-COMM-STRUCTURE.
  2013         16  AG-AGT-COMMS OCCURS 10.
  2014             20  AG-AGT                PIC X(10).
  2015             20  AG-COM-TYP            PIC X.
  2016             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2017             20  AG-RECALC-LV-INDIC    PIC X.
  2018             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2019             20  AG-LRCALC-LV-INDIC    PIC X.
  2020             20  FILLER                PIC X(05).
  2021     12  FILLER                  PIC X(145).
  2022******************************************************************
  2023*    COPY ERCRESS.
  2024******************************************************************
  2025*                                                                *
  2026*                            ERCRESS                             *
  2027*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2028*                            VMOD=2.002                          *
  2029*                                                                *
  2030*   CREDIT RESIDENT STATE TAXES MASTER                          *
  2031*                                                                *
  2032*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  2033*   VSAM RESIDENT STATE TAX MASTER                              *
  2034*                                                                *
  2035*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  2036*                                                                *
  2037*   FILE TYPE = VSAM,KSDS                                        *
  2038*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  2039*                                                                *
  2040*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  2041*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  2042*                                                                *
  2043*   LOG = NO                                                     *
  2044*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2045*                                                                *
  2046*                                                                *
  2047******************************************************************
  2048
  2049 01  RESIDENT-STATE-TAX-MASTER.
  2050
  2051     10  ERRESS-PRIMARY-KEY.
  2052         15  RES-COMPANY-CD        PIC X.
  2053         15  RES-RESIDENT-STATE    PIC XX.
  2054         15  RES-COVERAGE-CATEGORY PIC X.
  2055         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  2056*                                      YYYYMMDD
  2057*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  2058
  2059     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  38
* EL050.cbl
  2060
  2061         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2062         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2063         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2064         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2065
  2066     10 RES-RECALC-SW              PIC   X.
  2067         88 RECALC                VALUE 'Y'.
  2068         88 NO-RECALC             VALUE 'N'.
  2069     10  RES-MAINT-BY              PIC X(4).
  2070     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2071     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2072*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  39
* EL050.cbl
  2074*    COPY ERCRESC.
  2075******************************************************************
  2076*                                                                *
  2077*                            ERCRESC                             *
  2078*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2079*                            VMOD=2.003                          *
  2080*                                                                *
  2081*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2082*                                                                *
  2083*   FILE TYPE = VSAM,KSDS                                        *
  2084*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2085*                                                                *
  2086*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2087*       ALTERNATE PATH1 = NONE                                   *
  2088*                                                                *
  2089*   LOG = NO                                                     *
  2090*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2091*                                                                *
  2092******************************************************************
  2093
  2094 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2095
  2096     10  ERRESC-RECORD-KEY.
  2097         15  RESC-COMPANY-CD           PIC   X.
  2098         15  RESC-CARRIER              PIC   X.
  2099         15  RESC-GROUP                PIC   X(6).
  2100         15  RESC-STATE                PIC   XX.
  2101         15  RESC-ACCOUNT              PIC   X(10).
  2102         15  RESC-AGENT                PIC   X(10).
  2103         15  RESC-RESIDENT-STATE       PIC   XX.
  2104         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2105*                                           YYYYMMDD
  2106     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2107
  2108     10  RESC-COMM-RECORD-DATA.
  2109         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2110             20 RESC-COVERAGE-CAT      PIC    X.
  2111             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2112             20 RESC-COMMISSION-TAB REDEFINES
  2113                RESC-COMMISSION-PER    PIC  XXX.
  2114
  2115     10  RESC-MAINT-BY                 PIC X(4).
  2116     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2117     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2118*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  40
* EL050.cbl
  2120*    COPY ERCPLAN.
  2121******************************************************************
  2122*                                                                *
  2123*                                                                *
  2124*                            ERCPLAN                             *
  2125*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2126*                            VMOD=2.003                          *
  2127*                                                                *
  2128*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2129*                                                                *
  2130*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2131*   PLAN MASTER                                                  *
  2132*                                                                *
  2133*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2134*                                                                *
  2135*   FILE TYPE = VSAM,KSDS                                        *
  2136*   RECORD SIZE = 420   RECFORM = FIX                            *
  2137*                                                                *
  2138*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2139*       ALTERNATE PATH1 = N/A                                    *
  2140*                                                                *
  2141*   LOG = NO                                                     *
  2142*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2143*                                                                *
  2144*                                                                *
  2145******************************************************************
  2146
  2147 01  PLAN-MASTER.
  2148     12  PL-RECORD-ID                      PIC XX.
  2149         88  VALID-PL-ID                      VALUE 'PL'.
  2150
  2151     12  PL-CONTROL-PRIMARY.
  2152         16  PL-COMPANY-CD                 PIC X.
  2153         16  PL-MSTR-CNTRL.
  2154             20  PL-CONTROL-A.
  2155                 24  PL-CARRIER            PIC X.
  2156                 24  PL-GROUPING           PIC X(6).
  2157                 24  PL-STATE              PIC XX.
  2158                 24  PL-ACCOUNT            PIC X(10).
  2159             20  PL-BENEFIT-TYPE           PIC X.
  2160             20  PL-BENEFIT-CODE           PIC XX.
  2161             20  PL-REVISION-NO            PIC X(3).
  2162
  2163     12  PL-CONTROL-BY-VAR-GRP.
  2164         16  PL-COMPANY-CD-A1              PIC X.
  2165         16  PL-VG-CARRIER                 PIC X.
  2166         16  PL-VG-GROUPING                PIC X(6).
  2167         16  PL-VG-STATE                   PIC XX.
  2168         16  PL-VG-ACCOUNT                 PIC X(10).
  2169         16  PL-BENEFIT-TYPE-A1            PIC X.
  2170         16  PL-BENEFIT-CODE-A1            PIC XX.
  2171         16  PL-REVISION-NO-A1             PIC 999.
  2172
  2173     12  PL-MAINT-INFORMATION.
  2174         16  PL-LAST-MAINT-DT              PIC XX.
  2175         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2176         16  PL-LAST-MAINT-USER            PIC X(4).
  2177         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  41
* EL050.cbl
  2178
  2179     12  PL-LIABILITY-LIMITS.
  2180         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2181         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2182             20  PL-LM-AGE                 PIC S99        COMP-3.
  2183             20  PL-LM-DUR                 PIC S999       COMP-3.
  2184             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2185             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2186
  2187     12  FILLER                            PIC X(30).
  2188
  2189     12  PL-GL-ACCOUNT-NOS.
  2190         16  PL-PREMIUM-GL                 PIC X(8).
  2191         16  PL-COMM-GL                    PIC X(8).
  2192         16  PL-CLAIM-GL                   PIC X(8).
  2193     12  FILLER                            PIC X(24).
  2194     12  PL-TOLERANCES.
  2195         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2196         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2197         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2198         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2199         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2200         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2201     12  PL-OVER-SHORT.
  2202         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2203         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2204     12  FILLER                            PIC X(24).
  2205     12  PLAN-MISC.
  2206         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2207         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2208         16  PL-IG                         PIC X.
  2209         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2210         16  PL-POLICY-FORM                PIC X(12).
  2211         16  PL-EDIT-FOR-FORM              PIC X(01).
  2212         16  PL-DEV-CODE                   PIC XXX.
  2213         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2214         16  PL-CALC-METHOD                PIC X.
  2215         16  PL-BENEFIT-GROUP              PIC X(05).
  2216         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2217
  2218         16  FILLER                        PIC X(99).
  2219******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  42
* EL050.cbl
  2221*    COPY ELCCERT.
  2222******************************************************************
  2223*                                                                *
  2224*                            ELCCERT.                            *
  2225*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2226*                            VMOD=2.013                          *
  2227*                                                                *
  2228*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2229*                                                                *
  2230*   FILE TYPE = VSAM,KSDS                                        *
  2231*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2232*                                                                *
  2233*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2234*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2235*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2236*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2237*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2238*                                                                *
  2239*   LOG = YES                                                    *
  2240*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2241******************************************************************
  2242*                   C H A N G E   L O G
  2243*
  2244* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2245*-----------------------------------------------------------------
  2246*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2247* EFFECTIVE    NUMBER
  2248*-----------------------------------------------------------------
  2249* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2250* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2251* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2252* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2253* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2254* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2255* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2256* 032612  CR2011110200001  PEMA  AHL CHANGES
  2257* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2258* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2259* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2260******************************************************************
  2261
  2262 01  CERTIFICATE-MASTER.
  2263     12  CM-RECORD-ID                      PIC XX.
  2264         88  VALID-CM-ID                      VALUE 'CM'.
  2265
  2266     12  CM-CONTROL-PRIMARY.
  2267         16  CM-COMPANY-CD                 PIC X.
  2268         16  CM-CARRIER                    PIC X.
  2269         16  CM-GROUPING.
  2270             20  CM-GROUPING-PREFIX        PIC X(3).
  2271             20  CM-GROUPING-PRIME         PIC X(3).
  2272         16  CM-STATE                      PIC XX.
  2273         16  CM-ACCOUNT.
  2274             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2275             20  CM-ACCOUNT-PRIME          PIC X(6).
  2276         16  CM-CERT-EFF-DT                PIC XX.
  2277         16  CM-CERT-NO.
  2278             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  43
* EL050.cbl
  2279             20  CM-CERT-SFX               PIC X.
  2280
  2281     12  CM-CONTROL-BY-NAME.
  2282         16  CM-COMPANY-CD-A1              PIC X.
  2283         16  CM-INSURED-LAST-NAME          PIC X(15).
  2284         16  CM-INSURED-INITIALS.
  2285             20  CM-INSURED-INITIAL1       PIC X.
  2286             20  CM-INSURED-INITIAL2       PIC X.
  2287
  2288     12  CM-CONTROL-BY-SSN.
  2289         16  CM-COMPANY-CD-A2              PIC X.
  2290         16  CM-SOC-SEC-NO.
  2291             20  CM-SSN-STATE              PIC XX.
  2292             20  CM-SSN-ACCOUNT            PIC X(6).
  2293             20  CM-SSN-LN3.
  2294                 25  CM-INSURED-INITIALS-A2.
  2295                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2296                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2297                 25 CM-PART-LAST-NAME-A2         PIC X.
  2298
  2299     12  CM-CONTROL-BY-CERT-NO.
  2300         16  CM-COMPANY-CD-A4              PIC X.
  2301         16  CM-CERT-NO-A4                 PIC X(11).
  2302
  2303     12  CM-CONTROL-BY-MEMB.
  2304         16  CM-COMPANY-CD-A5              PIC X.
  2305         16  CM-MEMBER-NO.
  2306             20  CM-MEMB-STATE             PIC XX.
  2307             20  CM-MEMB-ACCOUNT           PIC X(6).
  2308             20  CM-MEMB-LN4.
  2309                 25  CM-INSURED-INITIALS-A5.
  2310                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2311                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2312                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2313
  2314     12  CM-INSURED-PROFILE-DATA.
  2315         16  CM-INSURED-FIRST-NAME.
  2316             20  CM-INSURED-1ST-INIT       PIC X.
  2317             20  FILLER                    PIC X(9).
  2318         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2319         16  CM-INSURED-SEX                PIC X.
  2320             88  CM-SEX-MALE                  VALUE 'M'.
  2321             88  CM-SEX-FEMAL                 VALUE 'F'.
  2322         16  CM-INSURED-JOINT-AGE          PIC 99.
  2323         16  CM-JOINT-INSURED-NAME.
  2324             20  CM-JT-LAST-NAME           PIC X(15).
  2325             20  CM-JT-FIRST-NAME.
  2326                 24  CM-JT-1ST-INIT        PIC X.
  2327                 24  FILLER                PIC X(9).
  2328             20  CM-JT-INITIAL             PIC X.
  2329
  2330     12  CM-LIFE-DATA.
  2331         16  CM-LF-BENEFIT-CD              PIC XX.
  2332         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2333         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2334         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2335         16  CM-LF-DEV-CODE                PIC XXX.
  2336         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  44
* EL050.cbl
  2337         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2338         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2339         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2340         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2341         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2342         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2343         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2344         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2345         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2346         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2347         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2348         16  cm-temp-epiq                  pic xx.
  2349             88  EPIQ-CLASS                  value 'EQ'.
  2350*        16  FILLER                        PIC XX.
  2351
  2352     12  CM-AH-DATA.
  2353         16  CM-AH-BENEFIT-CD              PIC XX.
  2354         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2355         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2356         16  CM-AH-DEV-CODE                PIC XXX.
  2357         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2358         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2359         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2360         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2361         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2362         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2363         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2364         16  CM-AH-PAID-THRU-DT            PIC XX.
  2365             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2366         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2367         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2368         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2369         16  FILLER                        PIC X.
  2370
  2371     12  CM-LOAN-INFORMATION.
  2372         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2373         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2374                                           PIC S9(5)V99  COMP-3.
  2375         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2376         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2377         16  CM-PAY-FREQUENCY              PIC S99.
  2378         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2379         16  CM-RATE-CLASS                 PIC XX.
  2380         16  CM-BENEFICIARY                PIC X(25).
  2381         16  CM-POLICY-FORM-NO             PIC X(12).
  2382         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2383         16  CM-LAST-ADD-ON-DT             PIC XX.
  2384         16  CM-DEDUCTIBLE-AMOUNTS.
  2385             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2386             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2387         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2388             20  CM-RESIDENT-STATE         PIC XX.
  2389             20  CM-RATE-CODE              PIC X(4).
  2390             20  FILLER                    PIC XX.
  2391         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2392             20  CM-LOAN-OFFICER           PIC X(5).
  2393             20  FILLER                    PIC XXX.
  2394         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  45
* EL050.cbl
  2395         16  CM-UNDERWRITING-CODE          PIC X.
  2396             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2397         16  CM-POST-CARD-IND              PIC X.
  2398         16  CM-REF-INTERFACE-SW           PIC X.
  2399         16  CM-PREMIUM-TYPE               PIC X.
  2400             88  CM-SING-PRM                  VALUE '1'.
  2401             88  CM-O-B-COVERAGE              VALUE '2'.
  2402             88  CM-OPEN-END                  VALUE '3'.
  2403         16  CM-IND-GRP-TYPE               PIC X.
  2404             88  CM-INDIVIDUAL                VALUE 'I'.
  2405             88  CM-GROUP                     VALUE 'G'.
  2406         16  CM-SKIP-CODE                  PIC X.
  2407             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2408             88  SKIP-JULY                    VALUE '1'.
  2409             88  SKIP-AUGUST                  VALUE '2'.
  2410             88  SKIP-SEPTEMBER               VALUE '3'.
  2411             88  SKIP-JULY-AUG                VALUE '4'.
  2412             88  SKIP-AUG-SEPT                VALUE '5'.
  2413             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2414             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2415             88  SKIP-JUNE                    VALUE '8'.
  2416             88  SKIP-JUNE-JULY               VALUE '9'.
  2417             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2418             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2419         16  CM-PAYMENT-MODE               PIC X.
  2420             88  PAY-MONTHLY                  VALUE SPACE.
  2421             88  PAY-WEEKLY                   VALUE '1'.
  2422             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2423             88  PAY-BI-WEEKLY                VALUE '3'.
  2424             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2425         16  CM-LOAN-NUMBER                PIC X(8).
  2426         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2427         16  CM-OLD-LOF                    PIC XXX.
  2428*        16  CM-LOAN-OFFICER               PIC XXX.
  2429         16  CM-REIN-TABLE                 PIC XXX.
  2430         16  CM-SPECIAL-REIN-CODE          PIC X.
  2431         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2432         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2433         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2434
  2435     12  CM-STATUS-DATA.
  2436         16  CM-ENTRY-STATUS               PIC X.
  2437         16  CM-ENTRY-DT                   PIC XX.
  2438
  2439         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2440         16  CM-LF-CANCEL-DT               PIC XX.
  2441         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2442
  2443         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2444         16  CM-LF-DEATH-DT                PIC XX.
  2445         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2446
  2447         16  CM-LF-CURRENT-STATUS          PIC X.
  2448             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2449                                                'M' '4' '5' '9'.
  2450             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2451             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2452             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  46
* EL050.cbl
  2453             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2454             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2455             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2456             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2457             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2458             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2459             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2460             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2461             88  CM-LF-DECLINED               VALUE 'D'.
  2462             88  CM-LF-VOIDED                 VALUE 'V'.
  2463
  2464         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2465         16  CM-AH-CANCEL-DT               PIC XX.
  2466         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2467
  2468         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2469         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2470         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2471
  2472         16  CM-AH-CURRENT-STATUS          PIC X.
  2473             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2474                                                'M' '4' '5' '9'.
  2475             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2476             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2477             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2478             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2479             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2480             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2481             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2482             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2483             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2484             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2485             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2486             88  CM-AH-DECLINED               VALUE 'D'.
  2487             88  CM-AH-VOIDED                 VALUE 'V'.
  2488
  2489         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2490             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2491             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2492             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2493         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2494
  2495         16  CM-ENTRY-BATCH                PIC X(6).
  2496         16  CM-LF-EXIT-BATCH              PIC X(6).
  2497         16  CM-AH-EXIT-BATCH              PIC X(6).
  2498         16  CM-LAST-MONTH-END             PIC XX.
  2499
  2500     12  CM-NOTE-SW                        PIC X.
  2501         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2502         88  CERT-NOTES-PRESENT               VALUE '1'.
  2503         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2504         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2505         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2506         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2507         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2508         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2509     12  CM-COMP-EXCP-SW                   PIC X.
  2510         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  47
* EL050.cbl
  2511         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2512     12  CM-INSURED-ADDRESS-SW             PIC X.
  2513         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2514         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2515
  2516*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2517     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2518     12  FILLER                            PIC X.
  2519
  2520*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2521     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2522     12  FILLER                            PIC X.
  2523*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2524     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2525
  2526     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2527         88  CERT-ADDED-BATCH                 VALUE ' '.
  2528         88  CERT-ADDED-ONLINE                VALUE '1'.
  2529         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2530         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2531         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2532     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2533         88  CERT-AS-LOADED                   VALUE ' '.
  2534         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2535         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2536         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2537         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2538         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2539         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2540         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2541
  2542     12  CM-ACCOUNT-COMM-PCTS.
  2543         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2544         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2545
  2546     12  CM-USER-FIELD                     PIC X.
  2547     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2548     12  CM-CLP-STATE                      PIC XX.
  2549     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2550     12  CM-USER-RESERVED                  PIC XXX.
  2551     12  FILLER REDEFINES CM-USER-RESERVED.
  2552         16  CM-AH-CLASS-CD                PIC XX.
  2553         16  F                             PIC X.
  2554******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  48
* EL050.cbl
  2556*    COPY ERCMAIL.
  2557******************************************************************
  2558*                                                                *
  2559*                                                                *
  2560*                            ERCMAIL                             *
  2561*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2562*                            VMOD=2.003                          *
  2563*                                                                *
  2564*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2565*                                                                *
  2566*   FILE TYPE = VSAM,KSDS                                        *
  2567*   RECORD SIZE = 374   RECFORM = FIX                            *
  2568*                                                                *
  2569*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2570*   ALTERNATE PATH    = NOT USED                                 *
  2571*                                                                *
  2572*   LOG = YES                                                    *
  2573*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2574******************************************************************
  2575*                   C H A N G E   L O G
  2576*
  2577* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2578*-----------------------------------------------------------------
  2579*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2580* EFFECTIVE    NUMBER
  2581*-----------------------------------------------------------------
  2582* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2583* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2584* 111108                   PEMA  ADD CRED BENE ADDR2
  2585******************************************************************
  2586
  2587 01  MAILING-DATA.
  2588     12  MA-RECORD-ID                      PIC XX.
  2589         88  VALID-MA-ID                       VALUE 'MA'.
  2590
  2591     12  MA-CONTROL-PRIMARY.
  2592         16  MA-COMPANY-CD                 PIC X.
  2593         16  MA-CARRIER                    PIC X.
  2594         16  MA-GROUPING.
  2595             20  MA-GROUPING-PREFIX        PIC XXX.
  2596             20  MA-GROUPING-PRIME         PIC XXX.
  2597         16  MA-STATE                      PIC XX.
  2598         16  MA-ACCOUNT.
  2599             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2600             20  MA-ACCOUNT-PRIME          PIC X(6).
  2601         16  MA-CERT-EFF-DT                PIC XX.
  2602         16  MA-CERT-NO.
  2603             20  MA-CERT-PRIME             PIC X(10).
  2604             20  MA-CERT-SFX               PIC X.
  2605
  2606     12  FILLER                            PIC XX.
  2607
  2608     12  MA-ACCESS-CONTROL.
  2609         16  MA-SOURCE-SYSTEM              PIC XX.
  2610             88  MA-FROM-CREDIT                VALUE 'CR'.
  2611             88  MA-FROM-VSI                   VALUE 'VS'.
  2612             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2613             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  49
* EL050.cbl
  2614         16  MA-RECORD-ADD-DT              PIC XX.
  2615         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2616         16  MA-LAST-MAINT-DT              PIC XX.
  2617         16  MA-LAST-MAINT-BY              PIC XXXX.
  2618         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2619
  2620     12  MA-PROFILE-INFO.
  2621         16  MA-QUALIFY-CODE-1             PIC XX.
  2622         16  MA-QUALIFY-CODE-2             PIC XX.
  2623         16  MA-QUALIFY-CODE-3             PIC XX.
  2624         16  MA-QUALIFY-CODE-4             PIC XX.
  2625         16  MA-QUALIFY-CODE-5             PIC XX.
  2626
  2627         16  MA-INSURED-LAST-NAME          PIC X(15).
  2628         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2629         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2630         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2631         16  MA-INSURED-BIRTH-DT           PIC XX.
  2632         16  MA-INSURED-SEX                PIC X.
  2633             88  MA-SEX-MALE                   VALUE 'M'.
  2634             88  MA-SEX-FEMALE                 VALUE 'F'.
  2635         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2636
  2637         16  MA-ADDRESS-CORRECTED          PIC X.
  2638         16  MA-JOINT-BIRTH-DT             PIC XX.
  2639*        16  FILLER                        PIC X(12).
  2640
  2641         16  MA-ADDRESS-LINE-1             PIC X(30).
  2642         16  MA-ADDRESS-LINE-2             PIC X(30).
  2643         16  MA-CITY-STATE.
  2644             20  MA-CITY                   PIC X(28).
  2645             20  MA-ADDR-STATE             PIC XX.
  2646         16  MA-ZIP.
  2647             20  MA-ZIP-CODE.
  2648                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2649                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2650                 24  FILLER                PIC X(4).
  2651             20  MA-ZIP-PLUS4              PIC X(4).
  2652         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2653             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2654             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2655             20  FILLER                    PIC X(3).
  2656
  2657         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2658
  2659         16  FILLER                        PIC XXX.
  2660*        16  FILLER                        PIC X(10).
  2661
  2662     12  MA-CRED-BENE-INFO.
  2663         16  MA-CRED-BENE-NAME                 PIC X(25).
  2664         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2665         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2666         16  MA-CRED-BENE-CTYST.
  2667             20  MA-CRED-BENE-CITY             PIC X(28).
  2668             20  MA-CRED-BENE-STATE            PIC XX.
  2669         16  MA-CRED-BENE-ZIP.
  2670             20  MA-CB-ZIP-CODE.
  2671                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  50
* EL050.cbl
  2672                     88  MA-CB-CANADIAN-POST-CODE
  2673                                           VALUE 'A' THRU 'Z'.
  2674                 24  FILLER                    PIC X(4).
  2675             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2676         16  MA-CB-CANADIAN-POSTAL-CODE
  2677                            REDEFINES MA-CRED-BENE-ZIP.
  2678             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2679             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2680             20  FILLER                        PIC X(3).
  2681     12  MA-POST-CARD-MAIL-DATA.
  2682         16  MA-MAIL-DATA OCCURS 7.
  2683             20  MA-MAIL-TYPE              PIC X.
  2684                 88  MA-12MO-MAILING           VALUE '1'.
  2685                 88  MA-EXP-MAILING            VALUE '2'.
  2686             20  MA-MAIL-STATUS            PIC X.
  2687                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2688                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2689                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2690             20  MA-MAIL-DATE              PIC XX.
  2691     12  FILLER                            PIC XX.
  2692     12  FILLER                            PIC XX.
  2693*    12  FILLER                            PIC X(30).
  2694******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  51
* EL050.cbl
  2696*    COPY ERCPNDM.
  2697******************************************************************
  2698*                                                                *
  2699*                                                                *
  2700*                            ERCPNDM                             *
  2701*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2702*                            VMOD=2.003                          *
  2703*                                                                *
  2704*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2705*                                                                *
  2706*   FILE TYPE = VSAM,KSDS                                        *
  2707*   RECORD SIZE = 374   RECFORM = FIX                            *
  2708*                                                                *
  2709*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2710*   ALTERNATE PATH    = NOT USED                                 *
  2711*                                                                *
  2712*   LOG = YES                                                    *
  2713*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2714******************************************************************
  2715*                   C H A N G E   L O G
  2716*
  2717* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2718*-----------------------------------------------------------------
  2719*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2720* EFFECTIVE    NUMBER
  2721*-----------------------------------------------------------------
  2722* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2723* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2724* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2725* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2726******************************************************************
  2727
  2728 01  PENDING-MAILING-DATA.
  2729     12  PM-RECORD-ID                      PIC XX.
  2730         88  VALID-MA-ID                       VALUE 'PM'.
  2731
  2732     12  PM-CONTROL-PRIMARY.
  2733         16  PM-COMPANY-CD                 PIC X.
  2734         16  PM-ENTRY-BATCH                PIC X(6).
  2735         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2736         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2737
  2738     12  FILLER                            PIC X(14).
  2739
  2740     12  PM-ACCESS-CONTROL.
  2741         16  PM-SOURCE-SYSTEM              PIC XX.
  2742             88  PM-FROM-CREDIT                VALUE 'CR'.
  2743             88  PM-FROM-VSI                   VALUE 'VS'.
  2744             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2745             88  PM-FROM-OTHER                 VALUE 'OT'.
  2746         16  PM-RECORD-ADD-DT              PIC XX.
  2747         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2748         16  PM-LAST-MAINT-DT              PIC XX.
  2749         16  PM-LAST-MAINT-BY              PIC XXXX.
  2750         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2751
  2752     12  PM-PROFILE-INFO.
  2753         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  52
* EL050.cbl
  2754         16  PM-QUALIFY-CODE-2             PIC XX.
  2755         16  PM-QUALIFY-CODE-3             PIC XX.
  2756         16  PM-QUALIFY-CODE-4             PIC XX.
  2757         16  PM-QUALIFY-CODE-5             PIC XX.
  2758
  2759         16  PM-INSURED-LAST-NAME          PIC X(15).
  2760         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2761         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2762         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2763         16  PM-INSURED-BIRTH-DT           PIC XX.
  2764         16  PM-INSURED-SEX                PIC X.
  2765             88  PM-SEX-MALE                   VALUE 'M'.
  2766             88  PM-SEX-FEMALE                 VALUE 'F'.
  2767         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2768
  2769         16  PM-ADDRESS-CORRECTED          PIC X.
  2770         16  PM-JOINT-BIRTH-DT             PIC XX.
  2771*        16  FILLER                        PIC X(12).
  2772
  2773         16  PM-ADDRESS-LINE-1             PIC X(30).
  2774         16  PM-ADDRESS-LINE-2             PIC X(30).
  2775         16  PM-CITY-STATE.
  2776             20  PM-CITY                   PIC X(28).
  2777             20  PM-STATE                  PIC XX.
  2778         16  PM-ZIP.
  2779             20  PM-ZIP-CODE.
  2780                 24  PM-ZIP-1              PIC X.
  2781                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2782                 24  FILLER                PIC X(4).
  2783             20  PM-ZIP-PLUS4              PIC X(4).
  2784         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2785             20  PM-CAN-POST1              PIC XXX.
  2786             20  PM-CAN-POST2              PIC XXX.
  2787             20  FILLER                    PIC XXX.
  2788
  2789         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2790         16  pm-city-st-zip-verified       pic x.
  2791         16  FILLER                        PIC XX.
  2792
  2793     12  PM-CRED-BENE-INFO.
  2794         16  PM-CRED-BENE-NAME             PIC X(25).
  2795         16  PM-CRED-BENE-ADDR             PIC X(30).
  2796         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2797         16  PM-CRED-BENE-CTYST.
  2798             20  PM-CRED-BENE-CITY         PIC X(28).
  2799             20  PM-CRED-BENE-STATE        PIC XX.
  2800         16  PM-CRED-BENE-ZIP.
  2801             20  PM-CB-ZIP-CODE.
  2802                 24  PM-CB-ZIP-1           PIC X.
  2803                     88  PM-CB-CANADIAN-POST-CODE
  2804                                  VALUE 'A' THRU 'Z'.
  2805                 24  FILLER                PIC X(4).
  2806             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2807         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2808             20  PM-CB-CAN-POST1           PIC XXX.
  2809             20  PM-CB-CAN-POST2           PIC XXX.
  2810             20  FILLER                    PIC XXX.
  2811     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  53
* EL050.cbl
  2812         16  PM-MAIL-DATA OCCURS 7.
  2813             20  PM-MAIL-TYPE              PIC X.
  2814                 88  PM-12MO-MAILING           VALUE '1'.
  2815                 88  PM-EXP-MAILING            VALUE '2'.
  2816             20  PM-MAIL-STATUS            PIC X.
  2817                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2818                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2819                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2820             20  PM-MAIL-DATE              PIC XX.
  2821     12  FILLER                            PIC XX.
  2822     12  FILLER                            PIC X(12).
  2823*    12  FILLER                            PIC X(30).
  2824
  2825******************************************************************
  2826*                                COPY ERCLOFC.
  2827******************************************************************
  2828*                                                                *
  2829*                                                                *
  2830*                            ERCLOFC                             *
  2831*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2832*                            VMOD=2.003                          *
  2833*                                                                *
  2834*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2835*                                                                *
  2836*   FILE TYPE = VSAM,KSDS                                        *
  2837*   RECORD SIZE = 670   RECFORM = FIX                            *
  2838*                                                                *
  2839*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2840*                                                                *
  2841*   LOG = YES                                                    *
  2842*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2843*                                                                *
  2844******************************************************************
  2845
  2846 01  LOAN-OFFICER-MASTER.
  2847     12  LO-RECORD-ID                PIC XX.
  2848         88  VALID-LO-ID                VALUE 'LO'.
  2849
  2850     12  LO-CONTROL-PRIMARY.
  2851         16  LO-COMPANY-CD           PIC X.
  2852         16  LO-CARRIER              PIC X.
  2853         16  LO-GROUPING.
  2854             20  LO-GROUPING-PREFIX  PIC XXX.
  2855             20  LO-GROUPING-PRIME   PIC XXX.
  2856         16  LO-STATE                PIC XX.
  2857         16  LO-ACCOUNT.
  2858             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2859             20  LO-ACCOUNT-PRIME    PIC X(6).
  2860         16  LO-OFFICER-CODE         PIC X(5).
  2861
  2862     12  LO-OFFICER-NAME             PIC X(30).
  2863
  2864     12  LO-LAST-MAINT-DT            PIC XX.
  2865     12  LO-LAST-USER                PIC X(4).
  2866     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2867
  2868     12  LO-COMP-CONTROL             PIC X.
  2869             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  54
* EL050.cbl
  2870             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2871     12  LO-DETAIL-CONTROL           PIC X.
  2872             88  LO-PRINT-DETAIL        VALUE 'D'.
  2873             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2874
  2875     12  LO-SV-CARRIER               PIC X.
  2876     12  LO-SV-GROUPING              PIC X(6).
  2877     12  LO-SV-STATE                 PIC XX.
  2878
  2879     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2880     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2881
  2882     12  LO-OFFICER-INFO.
  2883         16  FILLER OCCURS 12 TIMES.
  2884             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2885             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2886             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2887             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2888             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2889             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2890             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2891             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2892     12  FILLER                      PIC X(198).
  2893******************************************************************
  2894*                                COPY ERCPDEF.
  2895******************************************************************
  2896*                                                                *
  2897*                                                                *
  2898*                            ERCPDEF.                            *
  2899*                                                                *
  2900*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2901*                                                                *
  2902*    FILE TYPE = VSAM,KSDS                                       *
  2903*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2904*                                                                *
  2905*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2906*                                                                *
  2907*    LOG = YES                                                   *
  2908*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2909******************************************************************
  2910*                   C H A N G E   L O G
  2911*
  2912* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2913*-----------------------------------------------------------------
  2914*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2915* EFFECTIVE    NUMBER
  2916*-----------------------------------------------------------------
  2917* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2918* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2919* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2920* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  2921******************************************************************
  2922 01  PRODUCT-MASTER.
  2923    12  PD-RECORD-ID                 PIC X(02).
  2924        88  VALID-PD-ID                  VALUE 'PD'.
  2925    12  PD-CONTROL-PRIMARY.
  2926        16  PD-COMPANY-CD            PIC X.
  2927        16  PD-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  55
* EL050.cbl
  2928        16  PD-PRODUCT-CD            PIC XXX.
  2929        16  PD-FILLER                PIC X(7).
  2930        16  PD-BEN-TYPE              PIC X.
  2931        16  PD-BEN-CODE              PIC XX.
  2932        16  PD-PROD-EXP-DT           PIC XX.
  2933    12  FILLER                       PIC X(50).
  2934    12  PD-PRODUCT-DATA OCCURS 8.
  2935        16  PD-PROD-CODE             PIC X.
  2936            88  PD-PROD-LIFE           VALUE 'L'.
  2937            88  PD-PROD-PROP           VALUE 'P'.
  2938            88  PD-PROD-AH             VALUE 'A'.
  2939            88  PD-PROD-IU             VALUE 'I'.
  2940            88  PD-PROD-GAP            VALUE 'G'.
  2941            88  PD-PROD-FAML           VALUE 'F'.
  2942            88  PD-PROD-OTH            VALUE 'O'.
  2943        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2944        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2945        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2946        16  PD-MAX-TERM              PIC S999        COMP-3.
  2947        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2948        16  FILLER                   PIC X.
  2949        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2950        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2951        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2952        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2953        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2954        16  PD-REC-CRIT-PERIOD       PIC 99.
  2955        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2956            20  PD-RECURRING-YN      PIC X.
  2957            20  FILLER               PIC X.
  2958        16  PD-RTW-MOS               PIC 99.
  2959        16  PD-MAX-EXTENSION         PIC 99.
  2960        16  pd-ben-pct               pic sv999 comp-3.
  2961*       16  FILLER                   PIC XX.
  2962    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2963    12  PD-TERM-LIMITS OCCURS 15.
  2964        16  PD-LOW-TERM              PIC S999        COMP-3.
  2965        16  PD-HI-TERM               PIC S999        COMP-3.
  2966*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2967    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2968        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2969        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2970    12  PD-EARN-FACTORS.
  2971        16  FILLER OCCURS 15.
  2972            20  FILLER OCCURS 15.
  2973                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2974    12  PD-PRODUCT-DESC              PIC X(80).
  2975    12  PD-TRUNCATED                 PIC X.
  2976    12  FILLER                       PIC X(59).
  2977    12  PD-MAINT-INFORMATION.
  2978        16  PD-LAST-MAINT-DT         PIC X(02).
  2979        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2980        16  PD-LAST-MAINT-BY         PIC X(04).
  2981*                                COPY ELCSTATE.
  2982******************************************************************
  2983*                                                                *
  2984*                                                                *
  2985*                            ELCSTATE.                           *
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  56
* EL050.cbl
  2986*                                                                *
  2987*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2988*                                                                *
  2989*   FILE TYPE = VSAM,KSDS                                        *
  2990*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2991*                                                                *
  2992*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2993*       ALTERNATE INDEX = NONE                                   *
  2994*                                                                *
  2995*   LOG = YES                                                    *
  2996*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2997******************************************************************
  2998*                   C H A N G E   L O G
  2999*
  3000* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3001*-----------------------------------------------------------------
  3002*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3003* EFFECTIVE    NUMBER
  3004*-----------------------------------------------------------------
  3005* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  3006******************************************************************
  3007*
  3008 01  STATE-FILE.
  3009     12  SF-RECORD-ID                       PIC XX.
  3010         88  VALID-CF-ID                        VALUE 'SF'.
  3011     12  SF-CONTROL-PRIMARY.
  3012         16  SF-COMPANY-ID                  PIC XXX.
  3013         16  SF-CARRIER-CODE                PIC X.
  3014         16  SF-GROUPING                    PIC X(6).
  3015         16  SF-STATE-CODE                  PIC XX.
  3016         16  SF-EXPIRE-DATE                 PIC 9(8).
  3017****************************************************************
  3018*             STATE CONTROLS
  3019****************************************************************
  3020     12  SF-LAST-MAINT-DT                   PIC XX.
  3021     12  SF-LAST-MAINT-BY                   PIC X(4).
  3022     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3023     12  SF-STATE-RT-CONTROLS.
  3024         16  SF-ST-RT-CALC                  PIC X.
  3025     12  SF-ST-TAX-CONTROLS.
  3026         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3027         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3028         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3029     12  SF-ST-REFUND-OPTIONS.
  3030         16  SF-ST-RF-LR-CALC               PIC X.
  3031         16  SF-ST-RF-LL-CALC               PIC X.
  3032         16  SF-ST-RF-LN-CALC               PIC X.
  3033         16  SF-ST-RF-AH-CALC               PIC X.
  3034         16  SF-ST-RF-CP-CALC               PIC X.
  3035     12  SF-ST-UNEARN-PREM-OPTIONS.
  3036         16  SF-ST-LUEP-R78                 PIC X.
  3037         16  SF-ST-LUEP-PRO                 PIC X.
  3038         16  SF-ST-LUEP-ST                  PIC X.
  3039         16  SF-ST-LUEP-DOM                 PIC X.
  3040         16  SF-ST-AUEP-R78                 PIC X.
  3041         16  SF-ST-AUEP-PRO                 PIC X.
  3042         16  SF-ST-AUEP-ST                  PIC X.
  3043         16  SF-ST-AUEP-DOM                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  57
* EL050.cbl
  3044         16  SF-ST-CUEP-R78                 PIC X.
  3045         16  SF-ST-CUEP-PRO                 PIC X.
  3046         16  SF-ST-CUEP-ST                  PIC X.
  3047         16  SF-ST-CUEP-DOM                 PIC X.
  3048     12  SF-ST-EARN-PREM-OPTIONS.
  3049         16  SF-ST-LEP-R78                  PIC X.
  3050         16  SF-ST-LEP-PRO                  PIC X.
  3051         16  SF-ST-LEP-ST                   PIC X.
  3052         16  SF-ST-LEP-DOM                  PIC X.
  3053         16  SF-ST-AEP-R78                  PIC X.
  3054         16  SF-ST-AEP-PRO                  PIC X.
  3055         16  SF-ST-AEP-ST                   PIC X.
  3056         16  SF-ST-AEP-DOM                  PIC X.
  3057         16  SF-ST-CEP-R78                  PIC X.
  3058         16  SF-ST-CEP-PRO                  PIC X.
  3059         16  SF-ST-CEP-ST                   PIC X.
  3060         16  SF-ST-CEP-DOM                  PIC X.
  3061     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  58
* EL050.cbl
  3063*    COPY ELCCRTT.
  3064******************************************************************
  3065*                                                                *
  3066*                            ELCCRTT.                            *
  3067*                                                                *
  3068*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3069*                                                                *
  3070*   FILE TYPE = VSAM,KSDS                                        *
  3071*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3072*                                                                *
  3073*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3074*                                                                *
  3075*   LOG = YES                                                    *
  3076*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3077******************************************************************
  3078*                   C H A N G E   L O G
  3079*
  3080* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3081*-----------------------------------------------------------------
  3082*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3083* EFFECTIVE    NUMBER
  3084*-----------------------------------------------------------------
  3085* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3086* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3087* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3088* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3089* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3090* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3091* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3092* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3093* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3094* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3095* 091318  CR2018073000001  PEMA  ADD Refund methods
  3096* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3097******************************************************************
  3098
  3099 01  CERTIFICATE-TRAILERS.
  3100     12  CS-RECORD-ID                      PIC XX.
  3101         88  VALID-CS-ID                      VALUE 'CS'.
  3102
  3103     12  CS-CONTROL-PRIMARY.
  3104         16  CS-COMPANY-CD                 PIC X.
  3105         16  CS-CARRIER                    PIC X.
  3106         16  CS-GROUPING                   PIC X(6).
  3107         16  CS-STATE                      PIC XX.
  3108         16  CS-ACCOUNT                    PIC X(10).
  3109         16  CS-CERT-EFF-DT                PIC XX.
  3110         16  CS-CERT-NO.
  3111             20  CS-CERT-PRIME             PIC X(10).
  3112             20  CS-CERT-SFX               PIC X.
  3113         16  CS-TRAILER-TYPE               PIC X.
  3114             88  COMM-TRLR           VALUE 'A'.
  3115             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3116             88  CERT-DATA-TRLR      VALUE 'C'.
  3117
  3118     12  CS-DATA-AREA                      PIC X(516).
  3119
  3120     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  59
* EL050.cbl
  3121         16  CS-BANK-COMMISSION-AREA.
  3122             20  CS-BANK-COMMS       OCCURS 10.
  3123                 24  CS-AGT                PIC X(10).
  3124                 24  CS-COM-TYP            PIC X.
  3125                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3126                 24  CS-RECALC-LV-INDIC    PIC X.
  3127                 24  FILLER                PIC X(10).
  3128         16  FILLER                        PIC X(256).
  3129
  3130     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3131****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3132         16  CS-MB-CLAIM-DATA OCCURS 24.
  3133             20  CS-CLAIM-NO               PIC X(7).
  3134             20  CS-CLAIM-TYPE             PIC X.
  3135                 88  CS-AH-CLM               VALUE 'A'.
  3136                 88  CS-IU-CLM               VALUE 'I'.
  3137                 88  CS-GP-CLM               VALUE 'G'.
  3138                 88  CS-LF-CLM               VALUE 'L'.
  3139                 88  CS-PR-CLM               VALUE 'P'.
  3140                 88  CS-FL-CLM               VALUE 'F'.
  3141                 88  CS-OT-CLM               VALUE 'O'.
  3142             20  CS-INSURED-TYPE           PIC X.
  3143                 88  CS-PRIM-INSURED          VALUE 'P'.
  3144                 88  CS-CO-BORROWER           VALUE 'C'.
  3145             20  CS-BENEFIT-PERIOD         PIC 99.
  3146             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3147             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3148             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3149         16  FILLER                        PIC X(12).
  3150     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3151         16  CS-VIN-NUMBER                 PIC X(17).
  3152         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3153         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3154         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3155         16  cs-agent-name.
  3156             20  cs-agent-fname            pic x(20).
  3157             20  cs-agent-mi               pic x.
  3158             20  cs-agent-lname            pic x(25).
  3159         16  cs-license-no                 pic x(15).
  3160         16  cs-npn-number                 pic x(10).
  3161         16  cs-agent-edit-status          pic x.
  3162             88  cs-ae-refer-to-manager      value 'M'.
  3163             88  cs-ae-cover-sheet           value 'C'.
  3164             88  cs-ae-sig-form              value 'S'.
  3165             88  cs-ae-verified              value 'V'.
  3166             88  cs-unidentified-signature   value 'U'.
  3167             88  cs-cert-returned            value 'R'.
  3168             88  cs-accept-no-commission     value 'N'.
  3169         16  cs-year                       pic 9999.
  3170         16  cs-make                       pic x(20).
  3171         16  cs-model                      pic x(20).
  3172         16  cs-future                     pic x(20).
  3173         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3174         16  cs-claim-verification-status  pic x.
  3175             88  cs-clm-ver-eligible         value 'A'.
  3176             88  cs-clm-ver-partial-elig     value 'B'.
  3177             88  cs-clm-ver-not-eligible     value 'C'.
  3178             88  cs-clm-ver-not-elig-opn-clm value 'D'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  60
* EL050.cbl
  3179             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3180             88  cs-clm-ver-ND-CERT          value 'F'.
  3181             88  cs-clm-ver-spec-other       value 'G'.
  3182             88  cs-clam-ver-pratial-corrected
  3183                                             value 'H'.
  3184             88  cs-clm-ver-no-matches       value 'I'.
  3185             88  cs-clm-ver-not-elig-corrected
  3186                                             value 'J'.
  3187             88  cs-clm-ver-needs-review     value 'R'.
  3188             88  cs-clm-ver-sent-to-claims   value 'W'.
  3189         16  CS-LF-REFUND-METHOD           PIC X.
  3190         16  CS-AH-REFUND-METHOD           PIC X.
  3191         16  FILLER                        PIC X(353). *> was 420
  3192*        16  FILLER                        PIC X(496).
  3193*    COPY ELCCRTO.
  3194******************************************************************
  3195*                                                                *
  3196*                            ELCCRTO.                            *
  3197*                                                                *
  3198*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3199*                                                                *
  3200*   FILE TYPE = VSAM,KSDS                                        *
  3201*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3202*                                                                *
  3203*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3204*                                                                *
  3205*   LOG = YES                                                    *
  3206*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3207******************************************************************
  3208*                   C H A N G E   L O G
  3209*
  3210* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3211*-----------------------------------------------------------------
  3212*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3213* EFFECTIVE    NUMBER
  3214*-----------------------------------------------------------------
  3215* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3216* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3217* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3218* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3219* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3220******************************************************************
  3221 01  ORIGINAL-CERTIFICATE.
  3222     12  OC-RECORD-ID                      PIC XX.
  3223         88  VALID-OC-ID                      VALUE 'OC'.
  3224     12  OC-CONTROL-PRIMARY.
  3225         16  OC-COMPANY-CD                 PIC X.
  3226         16  OC-CARRIER                    PIC X.
  3227         16  OC-GROUPING                   PIC X(6).
  3228         16  OC-STATE                      PIC XX.
  3229         16  OC-ACCOUNT                    PIC X(10).
  3230         16  OC-CERT-EFF-DT                PIC XX.
  3231         16  OC-CERT-NO.
  3232             20  OC-CERT-PRIME             PIC X(10).
  3233             20  OC-CERT-SFX               PIC X.
  3234         16  OC-RECORD-TYPE                PIC X.
  3235         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3236     12  OC-LAST-MAINT-DT                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  61
* EL050.cbl
  3237     12  OC-LAST-MAINT-BY                  PIC X(4).
  3238     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3239     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3240     12  FILLER                            PIC X(49).
  3241     12  OC-ORIG-REC.
  3242         16  OC-INS-LAST-NAME              PIC X(15).
  3243         16  OC-INS-FIRST-NAME             PIC X(10).
  3244         16  OC-INS-MIDDLE-INIT            PIC X.
  3245         16  OC-INS-AGE                    PIC S999     COMP-3.
  3246         16  OC-JNT-LAST-NAME              PIC X(15).
  3247         16  OC-JNT-FIRST-NAME             PIC X(10).
  3248         16  OC-JNT-MIDDLE-INIT            PIC X.
  3249         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3250         16  OC-LF-BENCD                   PIC XX.
  3251         16  OC-LF-TERM                    PIC S999      COMP-3.
  3252         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3253         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3254         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3255         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3256         16  OC-LF-EXP-DT                  PIC XX.
  3257         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3258         16  OC-LF-CANCEL-DT               PIC XX.
  3259         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3260         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3261         16  OC-AH-BENCD                   PIC XX.
  3262         16  OC-AH-TERM                    PIC S999      COMP-3.
  3263         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3264         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3265         16  OC-AH-EXP-DT                  PIC XX.
  3266         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3267         16  OC-AH-CP                      PIC 99.
  3268         16  OC-AH-CANCEL-DT               PIC XX.
  3269         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3270         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3271         16  OC-CRED-BENE-NAME             PIC X(25).
  3272         16  OC-1ST-PMT-DT                 PIC XX.
  3273         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3274         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3275         16  OC-ISSUE-TRAN-IND             PIC X.
  3276         16  OC-CANCEL-TRAN-IND            PIC X.
  3277         16  FILLER                        PIC X(211).
  3278
  3279     12  FILLER                            PIC X(50).
  3280******************************************************************
  3281
  3282*    COPY ELCDATE.
  3283******************************************************************
  3284*                                                                *
  3285*                                                                *
  3286*                            ELCDATE.                            *
  3287*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3288*                            VMOD=2.003
  3289*                                                                *
  3290*                                                                *
  3291*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3292*                 LENGTH = 200                                   *
  3293******************************************************************
  3294
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  62
* EL050.cbl
  3295 01  DATE-CONVERSION-DATA.
  3296     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3297     12  DC-OPTION-CODE                PIC X.
  3298         88  BIN-TO-GREG                VALUE ' '.
  3299         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3300         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3301         88  YMD-GREG-TO-BIN            VALUE '3'.
  3302         88  MDY-GREG-TO-BIN            VALUE '4'.
  3303         88  JULIAN-TO-BIN              VALUE '5'.
  3304         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3305         88  FIND-CENTURY               VALUE '7'.
  3306         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3307         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3308         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3309         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3310         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3311         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3312         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3313         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3314         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3315         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3316         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3317         88  BIN-3-TO-GREG              VALUE 'I'.
  3318         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3319         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3320         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3321         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3322         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3323         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3324         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3325         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3326         88  THREE-CHARACTER-BIN
  3327                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3328         88  GREGORIAN-TO-BIN
  3329                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3330         88  BIN-TO-GREGORIAN
  3331                  VALUES ' ' '1' 'I' '8' 'G'.
  3332         88  JULIAN-TO-BINARY
  3333                  VALUES '5' 'C' 'E' 'F'.
  3334     12  DC-ERROR-CODE                 PIC X.
  3335         88  NO-CONVERSION-ERROR        VALUE ' '.
  3336         88  DATE-CONVERSION-ERROR
  3337                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3338         88  DATE-IS-ZERO               VALUE '1'.
  3339         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3340         88  DATE-IS-INVALID            VALUE '3'.
  3341         88  DATE1-GREATER-DATE2        VALUE '4'.
  3342         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3343         88  DATE-INVALID-OPTION        VALUE '9'.
  3344         88  INVALID-CENTURY            VALUE 'A'.
  3345         88  ONLY-CENTURY               VALUE 'B'.
  3346         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3347         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3348     12  DC-END-OF-MONTH               PIC X.
  3349         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3350     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3351         88  USE-NORMAL-PROCESS         VALUE ' '.
  3352         88  ADJUST-DOWN-100-YRS        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  63
* EL050.cbl
  3353         88  ADJUST-UP-100-YRS          VALUE '2'.
  3354     12  FILLER                        PIC X.
  3355     12  DC-CONVERSION-DATES.
  3356         16  DC-BIN-DATE-1             PIC XX.
  3357         16  DC-BIN-DATE-2             PIC XX.
  3358         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3359         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3360                       DC-GREG-DATE-1-EDIT.
  3361             20  DC-EDIT1-MONTH        PIC 99.
  3362             20  SLASH1-1              PIC X.
  3363             20  DC-EDIT1-DAY          PIC 99.
  3364             20  SLASH1-2              PIC X.
  3365             20  DC-EDIT1-YEAR         PIC 99.
  3366         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3367         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3368                     DC-GREG-DATE-2-EDIT.
  3369             20  DC-EDIT2-MONTH        PIC 99.
  3370             20  SLASH2-1              PIC X.
  3371             20  DC-EDIT2-DAY          PIC 99.
  3372             20  SLASH2-2              PIC X.
  3373             20  DC-EDIT2-YEAR         PIC 99.
  3374         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3375         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3376                     DC-GREG-DATE-1-YMD.
  3377             20  DC-YMD-YEAR           PIC 99.
  3378             20  DC-YMD-MONTH          PIC 99.
  3379             20  DC-YMD-DAY            PIC 99.
  3380         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3381         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3382                      DC-GREG-DATE-1-MDY.
  3383             20  DC-MDY-MONTH          PIC 99.
  3384             20  DC-MDY-DAY            PIC 99.
  3385             20  DC-MDY-YEAR           PIC 99.
  3386         16  DC-GREG-DATE-1-ALPHA.
  3387             20  DC-ALPHA-MONTH        PIC X(10).
  3388             20  DC-ALPHA-DAY          PIC 99.
  3389             20  FILLER                PIC XX.
  3390             20  DC-ALPHA-CENTURY.
  3391                 24 DC-ALPHA-CEN-N     PIC 99.
  3392             20  DC-ALPHA-YEAR         PIC 99.
  3393         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3394         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3395         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3396         16  DC-JULIAN-DATE            PIC 9(05).
  3397         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3398                                       PIC 9(05).
  3399         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3400             20  DC-JULIAN-YEAR        PIC 99.
  3401             20  DC-JULIAN-DAYS        PIC 999.
  3402         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3403         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3404         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3405     12  DATE-CONVERSION-VARIBLES.
  3406         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3407         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3408             20  FILLER                PIC 9(3).
  3409             20  HOLD-CEN-1-CCYY.
  3410                 24  HOLD-CEN-1-CC     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  64
* EL050.cbl
  3411                 24  HOLD-CEN-1-YY     PIC 99.
  3412             20  HOLD-CEN-1-MO         PIC 99.
  3413             20  HOLD-CEN-1-DA         PIC 99.
  3414         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3415             20  HOLD-CEN-1-R-MO       PIC 99.
  3416             20  HOLD-CEN-1-R-DA       PIC 99.
  3417             20  HOLD-CEN-1-R-CCYY.
  3418                 24  HOLD-CEN-1-R-CC   PIC 99.
  3419                 24  HOLD-CEN-1-R-YY   PIC 99.
  3420             20  FILLER                PIC 9(3).
  3421         16  HOLD-CENTURY-1-X.
  3422             20  FILLER                PIC X(3)  VALUE SPACES.
  3423             20  HOLD-CEN-1-X-CCYY.
  3424                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3425                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3426             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3427             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3428         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3429             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3430             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3431             20  HOLD-CEN-1-R-X-CCYY.
  3432                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3433                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3434             20  FILLER                PIC XXX.
  3435         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3436         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3437         16  DC-JULIAN-DATE-1          PIC 9(07).
  3438         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3439             20  DC-JULIAN-1-CCYY.
  3440                 24  DC-JULIAN-1-CC    PIC 99.
  3441                 24  DC-JULIAN-1-YR    PIC 99.
  3442             20  DC-JULIAN-DA-1        PIC 999.
  3443         16  DC-JULIAN-DATE-2          PIC 9(07).
  3444         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3445             20  DC-JULIAN-2-CCYY.
  3446                 24  DC-JULIAN-2-CC    PIC 99.
  3447                 24  DC-JULIAN-2-YR    PIC 99.
  3448             20  DC-JULIAN-DA-2        PIC 999.
  3449         16  DC-GREG-DATE-A-EDIT.
  3450             20  DC-EDITA-MONTH        PIC 99.
  3451             20  SLASHA-1              PIC X VALUE '/'.
  3452             20  DC-EDITA-DAY          PIC 99.
  3453             20  SLASHA-2              PIC X VALUE '/'.
  3454             20  DC-EDITA-CCYY.
  3455                 24  DC-EDITA-CENT     PIC 99.
  3456                 24  DC-EDITA-YEAR     PIC 99.
  3457         16  DC-GREG-DATE-B-EDIT.
  3458             20  DC-EDITB-MONTH        PIC 99.
  3459             20  SLASHB-1              PIC X VALUE '/'.
  3460             20  DC-EDITB-DAY          PIC 99.
  3461             20  SLASHB-2              PIC X VALUE '/'.
  3462             20  DC-EDITB-CCYY.
  3463                 24  DC-EDITB-CENT     PIC 99.
  3464                 24  DC-EDITB-YEAR     PIC 99.
  3465         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3466         16  DC-GREG-DATE-CYMD-R REDEFINES
  3467                              DC-GREG-DATE-CYMD.
  3468             20  DC-CYMD-CEN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  65
* EL050.cbl
  3469             20  DC-CYMD-YEAR          PIC 99.
  3470             20  DC-CYMD-MONTH         PIC 99.
  3471             20  DC-CYMD-DAY           PIC 99.
  3472         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3473         16  DC-GREG-DATE-MDCY-R REDEFINES
  3474                              DC-GREG-DATE-MDCY.
  3475             20  DC-MDCY-MONTH         PIC 99.
  3476             20  DC-MDCY-DAY           PIC 99.
  3477             20  DC-MDCY-CEN           PIC 99.
  3478             20  DC-MDCY-YEAR          PIC 99.
  3479    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3480        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3481    12  DC-EL310-DATE                  PIC X(21).
  3482    12  FILLER                         PIC X(28).
  3483
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  66
* EL050.cbl
  3485*    COPY ELCCALC.
  3486******************************************************************
  3487*                                                                *
  3488*                           ELCCALC.                            *
  3489*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3490*                            VMOD=2.025                          *
  3491*                                                                *
  3492*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3493*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3494*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3495*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3496*                                                                *
  3497*  PASSED TO ELRTRM                                              *
  3498*  -----------------                                             *
  3499*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3500*  ORIGINAL TERM                                                 *
  3501*  BEGINNING DATE                                                *
  3502*  ENDING DATE                                                   *
  3503*  COMPANY I.D.                                                  *
  3504*  ACCOUNT MASTER USER FIELD                                     *
  3505*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3506*  FREE LOOK DAYS                                                *
  3507*                                                                *
  3508*  RETURNED FROM ELRTRM                                          *
  3509*  ---------------------                                         *
  3510*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3511*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3512*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3513*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3514*----------------------------------------------------------------*
  3515*  PASSED TO ELRAMT                                              *
  3516*  ----------------                                              *
  3517*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3518*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3519*  ORIGINAL AMOUNT                                               *
  3520*  ALTERNATE BENEFIT (BALLON)                                    *
  3521*  A.P.R. - NET PAY ONLY                                         *
  3522*  METHOD
  3523*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3524*  COMPANY I.D.                                                  *
  3525*  BENEFIT TYPE                                                  *
  3526*                                                                *
  3527*  RETURNED FROM ELRAMT                                          *
  3528*  --------------------                                          *
  3529*  REMAINING AMOUNT 1 - CURRENT                                  *
  3530*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3531*  REMAINING AMOUNT FACTOR
  3532*----------------------------------------------------------------*
  3533*  PASSED TO ELRESV                                              *
  3534*  -----------------                                             *
  3535*  CERTIFICATE EFFECTIVE DATE                                    *
  3536*  VALUATION DATE                                                *
  3537*  PAID THRU DATE                                                *
  3538*  BENEFIT                                                       *
  3539*  INCURRED DATE                                                 *
  3540*  REPORTED DATE                                                 *
  3541*  ISSUE AGE                                                     *
  3542*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  67
* EL050.cbl
  3543*  CDT PERCENT                                                   *
  3544*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3545* *CLAIM TYPE (LIFE, A/H)                                        *
  3546* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3547* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3548*                                                                *
  3549*  RETURNED FROM ELRESV                                          *
  3550*  --------------------                                          *
  3551*  CDT TABLE USED                                                *
  3552*  CDT FACTOR USED                                               *
  3553*  PAY TO CURRENT RESERVE                                        *
  3554*  I.B.N.R. - A/H ONLY                                           *
  3555*  FUTURE (ACCRUED) AH ONLY                                      *
  3556*----------------------------------------------------------------*
  3557*  PASSED TO ELRATE                                              *
  3558*  ----------------                                              *
  3559*  CERT ISSUE DATE                                               *
  3560*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3561*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3562*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3563*  STATE CODE (CLIENT DEFINED)                                   *
  3564*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3565*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3566*  DEVIATION CODE                                                *
  3567*  ISSUE AGE                                                     *
  3568*  ORIGINAL BENEFIT AMOUNT                                       *
  3569*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3570*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3571*  BENEFIT KIND (LIFE OR A/H)                                    *
  3572*  A.P.R.                                                        *
  3573*  METHOD
  3574*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3575*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3576*  COMPANY I.D. (3 CHARACTER)                                    *
  3577*  BENEFIT CODE                                                  *
  3578*  BENEFIT OVERRIDE CODE                                         *
  3579*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3580*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3581*  JOINT INDICATOR (CSL ONLY)                                    *
  3582*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3583*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3584*                                                                *
  3585*  RETURNED FROM ELRATE                                          *
  3586*  --------------------                                          *
  3587*  CALCULATED PREMIUM                                            *
  3588*  PREMIUM RATE                                                  *
  3589*  MORTALITY CODE                                                *
  3590*  MAX ATTAINED AGE                                              *
  3591*  MAX AGE                                                       *
  3592*  MAX TERM                                                      *
  3593*  MAX MONTHLY BENEFIT                                           *
  3594*  MAX TOTAL BENIFIT                                             *
  3595*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3596*----------------------------------------------------------------*
  3597*  PASSED TO ELRFND                                              *
  3598*  ----------------                                              *
  3599*  CERT ISSUE DATE                                               *
  3600*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  68
* EL050.cbl
  3601*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3602*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3603*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3604*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3605*  STATE CODE (CLIENT DEFINED)                                   *
  3606*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3607*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3608*  DEVIATION CODE                                                *
  3609*  ISSUE AGE                                                     *
  3610*  ORIGINAL BENEFIT AMOUNT                                       *
  3611*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3612*  PROCESS TYPE (CANCEL)                                         *
  3613*  BENEFIT KIND (LIFE OR A/H)                                    *
  3614*  A.P.R.                                                        *
  3615*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3616*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3617*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3618*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3619*  COMPANY I.D. (3 CHARACTER)                                    *
  3620*  BENEFIT CODE                                                  *
  3621*  BENEFIT OVERRIDE CODE                                         *
  3622*                                                                *
  3623*  RETURNED FROM ELRFND                                          *
  3624*  --------------------                                          *
  3625*  CALCULATED REFUND                                             *
  3626*----------------------------------------------------------------*
  3627*  PASSED TO ELEARN                                              *
  3628*  ----------------                                              *
  3629*  CERT ISSUE DATE                                               *
  3630*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3631*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3632*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3633*  STATE CODE (CLIENT DEFINED)                                   *
  3634*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3635*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3636*  DEVIATION CODE                                                *
  3637*  ISSUE AGE                                                     *
  3638*  ORIGINAL BENEFIT AMOUNT                                       *
  3639*  BENEFIT KIND (LIFE OR A/H)                                    *
  3640*  A.P.R.                                                        *
  3641*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3642*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3643*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3644*  COMPANY I.D. (3 CHARACTER)                                    *
  3645*  BENEFIT CODE                                                  *
  3646*  BENEFIT OVERRIDE CODE                                         *
  3647*                                                                *
  3648*  RETURNED FROM ELEARN                                          *
  3649*  --------------------                                          *
  3650*  INDICATED  EARNINGS                                           *
  3651*----------------------------------------------------------------*
  3652*                 LENGTH = 450                                   *
  3653*                                                                *
  3654******************************************************************
  3655******************************************************************
  3656*                   C H A N G E   L O G
  3657*
  3658* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  69
* EL050.cbl
  3659*-----------------------------------------------------------------
  3660*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3661* EFFECTIVE    NUMBER
  3662*-----------------------------------------------------------------
  3663* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3664* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3665* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3666* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3667* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3668* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3669* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3670* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3671* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3672* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3673* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3674* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
  3675******************************************************************
  3676
  3677 01  CALCULATION-PASS-AREA.
  3678     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3679                                     COMP.
  3680
  3681     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3682       88  NO-CP-ERROR                             VALUE ZERO.
  3683       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3684                                  '9' 'A' 'B' 'C' 'D' 'E' 'H' 'I'.
  3685       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3686       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3687       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3688       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3689       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3690       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3691       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3692       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3693       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3694       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3695       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3696       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3697       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3698       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3699       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3700       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3701       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3702       88  CP-ERROR-TERM-BELOW-MINIMUM             VALUE 'I'.
  3703
  3704     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3705       88  NO-CP-ERROR-2                           VALUE ZERO.
  3706***********************  INPUT AREAS ****************************
  3707
  3708     12  CP-CALCULATION-AREA.
  3709         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3710         16  CP-CERT-EFF-DT        PIC XX.
  3711         16  CP-VALUATION-DT       PIC XX.
  3712         16  CP-PAID-THRU-DT       PIC XX.
  3713         16  CP-BENEFIT-TYPE       PIC X.
  3714           88  CP-AH                               VALUE 'A' 'D'
  3715                                                   'I' 'U'.
  3716           88  CP-REDUCING-LIFE                    VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  70
* EL050.cbl
  3717           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3718         16  CP-INCURRED-DT        PIC XX.
  3719         16  CP-REPORTED-DT        PIC XX.
  3720         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3721         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3722         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3723                                     COMP-3.
  3724         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3725                                     COMP-3.
  3726         16  CP-CDT-METHOD         PIC X.
  3727           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3728           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3729           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3730         16  CP-CLAIM-TYPE         PIC X.
  3731           88  CP-AH-CLAIM                         VALUE 'A'.
  3732           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3733         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3734                                     COMP-3.
  3735         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3736                                     COMP-3.
  3737         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3738                                     COMP-3.
  3739         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3740                                     COMP-3.
  3741         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3742                                     COMP-3.
  3743         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3744                                     COMP-3.
  3745         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3746                                     COMP-3.
  3747         16  CP-REM-TERM-METHOD    PIC X.
  3748           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3749           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3750           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3751           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3752           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3753           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3754           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3755         16  CP-EARNING-METHOD     PIC X.
  3756           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3757           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3758           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3759           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3760           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3761           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3762           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3763           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3764           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3765           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3766           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3767           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3768           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3769           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3770         16  CP-PROCESS-TYPE       PIC X.
  3771           88  CP-CLAIM                            VALUE '1'.
  3772           88  CP-CANCEL                           VALUE '2'.
  3773           88  CP-ISSUE                            VALUE '3'.
  3774         16  CP-SPECIAL-CALC-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  71
* EL050.cbl
  3775           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3776           88  CP-1-MTH-INTEREST               VALUE ' '.
  3777           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3778           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3779           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3780           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3781           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3782           88  CP-FARM-PLAN                    VALUE 'F'.
  3783           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3784           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3785           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3786           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3787           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3788           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3789           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3790           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3791           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3792           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3793                                                     'W' 'X'.
  3794           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3795           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3796           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3797           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3798           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3799           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3800           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3801           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3802           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3803           88  CP-CSL-METH-1                   VALUE '5'.
  3804           88  CP-CSL-METH-2                   VALUE '6'.
  3805           88  CP-CSL-METH-3                   VALUE '7'.
  3806           88  CP-CSL-METH-4                   VALUE '8'.
  3807
  3808         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3809                                     COMP-3.
  3810         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3811         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3812         16  CP-STATE              PIC XX          VALUE SPACE.
  3813         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3814         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3815           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3816               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3817         16  CP-R78-OPTION         PIC X.
  3818           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3819           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3820
  3821         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3822         16  CP-IBNR-RESERVE-SW    PIC X.
  3823         16  CP-CLAIM-STATUS       PIC X.
  3824         16  CP-RATE-FILE          PIC X.
  3825         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3826                                     COMP-3.
  3827
  3828         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3829         16  CP-AH-OVERRIDE-CODE   PIC X.
  3830
  3831         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3832                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  72
* EL050.cbl
  3833         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3834                                   PIC S9(5)V99 COMP-3.
  3835         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3836                                     COMP-3.
  3837         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3838                                     COMP-3.
  3839         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3840                                     COMP-3.
  3841         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3842                                  PIC S9(7)V99 COMP-3.
  3843
  3844         16  CP-PAID-FROM-DATE     PIC X(02).
  3845         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3846         16  CP-EXT-DAYS-CALC      PIC X.
  3847           88  CP-EXT-NO-CHG                   VALUE ' '.
  3848           88  CP-EXT-CHG-LF                   VALUE '1'.
  3849           88  CP-EXT-CHG-AH                   VALUE '2'.
  3850           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3851         16  CP-DOMICILE-STATE     PIC XX.
  3852         16  CP-CARRIER            PIC X.
  3853         16  CP-REIN-FLAG          PIC X.
  3854         16  CP-REM-TRM-CALC-OPTION PIC X.
  3855           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3856                      '2' '3' '4' '5'.
  3857           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3858           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3859           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3860           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3861           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3862           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3863           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3864           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3865         16  CP-SIG-SWITCH         PIC X.
  3866         16  CP-RATING-METHOD      PIC X.
  3867           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3868           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3869           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3870           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3871           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3872           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3873           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3874           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3875           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3876         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3877                                     COMP-3.
  3878         16  CP-BEN-CATEGORY       PIC X.
  3879         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3880         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3881                                   PIC S99V9(5) COMP-3.
  3882         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3883         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3884                                   PIC S99V9(5) COMP-3.
  3885         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3886         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3887         16  CP-EXPIRE-DT          PIC XX.
  3888         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3889         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3890         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  73
* EL050.cbl
  3891         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3892         16  CP-DDF-SPEC-CALC      PIC X.
  3893             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3894             88  CP-CALC-CLP              VALUE 'C'.
  3895         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3896         16  CP-CANCEL-REASON      PIC X.
  3897         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3898         16  CP-PMT-MODE           PIC X.
  3899         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3900         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3901         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3902         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3903         16  FILLER                PIC X.
  3904
  3905***************    OUTPUT FROM ELRESV   ************************
  3906
  3907         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3908
  3909         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3910                                     COMP-3.
  3911         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3912                                     COMP-3.
  3913         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3914                                     COMP-3.
  3915         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3916                                     COMP-3.
  3917         16  FILLER                PIC X(09).
  3918***************    OUTPUT FROM ELRTRM   *************************
  3919
  3920         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3921                                     COMP-3.
  3922         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3923                                     COMP-3.
  3924         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3925                                     COMP-3.
  3926         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3927                                     COMP-3.
  3928         16  FILLER                PIC X(12).
  3929
  3930***************    OUTPUT FROM ELRAMT   *************************
  3931
  3932         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3933                                     COMP-3.
  3934         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3935                                     COMP-3.
  3936         16  FILLER                PIC X(12).
  3937
  3938***************    OUTPUT FROM ELRATE   *************************
  3939
  3940         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3941                                     COMP-3.
  3942         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3943                                     COMP-3.
  3944         16  CP-MORTALITY-CODE     PIC X(4).
  3945         16  CP-RATE-EDIT-FLAG     PIC X.
  3946             88  CP-RATES-NEED-APR                  VALUE '1'.
  3947         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3948                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  74
* EL050.cbl
  3949         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3950         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3951         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3952                                   PIC S9(7)V99 COMP-3.
  3953         16  FILLER                PIC X(07).
  3954
  3955***************    OUTPUT FROM ELRFND   *************************
  3956
  3957         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3958                                     COMP-3.
  3959         16  CP-REFUND-TYPE-USED   PIC X.
  3960           88  CP-R-AS-R78                         VALUE '1'.
  3961           88  CP-R-AS-PRORATA                     VALUE '2'.
  3962           88  CP-R-AS-CALIF                       VALUE '3'.
  3963           88  CP-R-AS-TEXAS                       VALUE '4'.
  3964           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3965           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3966           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3967           88  CP-R-AS-MEAN                        VALUE '8'.
  3968           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3969           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3970           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3971           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3972           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3973           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3974         16  FILLER                PIC X(12).
  3975
  3976***************    OUTPUT FROM ELEARN   *************************
  3977
  3978         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3979                                     COMP-3.
  3980         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3981                                     COMP-3.
  3982         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3983                                     COMP-3.
  3984         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3985                                     COMP-3.
  3986         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3987                                     COMP-3.
  3988         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3989                                     COMP-3.
  3990         16  CP-EARNING-TYPE-USED  PIC X.
  3991           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3992           88  CP-E-AS-R78                         VALUE '1'.
  3993           88  CP-E-AS-PRORATA                     VALUE '2'.
  3994           88  CP-E-AS-TEXAS                       VALUE '4'.
  3995           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3996           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3997           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3998           88  CP-E-AS-MEAN                        VALUE '8'.
  3999           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  4000         16  FILLER                PIC X(12).
  4001
  4002***************    OUTPUT FROM ELPMNT   *************************
  4003
  4004         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  4005                                     COMP-3.
  4006         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  75
* EL050.cbl
  4007                                     COMP-3.
  4008         16  FILLER                PIC X(12).
  4009
  4010***************   MISC WORK AREAS    *****************************
  4011         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  4012                                     COMP-3.
  4013         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  4014                                     COMP-3.
  4015         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  4016                                     COMP-3.
  4017         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  4018                                     COMP-3.
  4019         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  4020                                     COMP-3.
  4021         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  4022                                     COMP-3.
  4023         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  4024             88  OPEN-RATE-FILE                   VALUE 'O'.
  4025             88  CLOSE-RATE-FILE                  VALUE 'C'.
  4026             88  IO-ERROR                         VALUE 'E'.
  4027
  4028         16  CP-FIRST-PAY-DATE     PIC XX.
  4029
  4030         16  CP-JOINT-INDICATOR    PIC X.
  4031
  4032         16  CP-RESERVE-REMAINING-TERM
  4033                                   PIC S9(4)V9    VALUE ZERO
  4034                                     COMP-3.
  4035
  4036         16  CP-INSURED-BIRTH-DT   PIC XX.
  4037
  4038         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4039                                     COMP-3.
  4040
  4041         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4042                                     COMP-3.
  4043
  4044         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4045                                     COMP-3.
  4046
  4047         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4048                                     COMP-3.
  4049
  4050         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4051                                     COMP-3.
  4052
  4053         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4054                                     COMP-3.
  4055
  4056         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4057                                     COMP-3.
  4058
  4059         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4060             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4061
  4062         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4063                                     COMP-3.
  4064         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  76
* EL050.cbl
  4065                                     COMP-3.
  4066         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  4067         16  cp-extra-periods      pic 9 value zeros.
  4068         16  cp-net-only-state     pic x value spaces.
  4069         16  FILLER                PIC X(13).
  4070******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  77
* EL050.cbl
  4072******************************************************************
  4073*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  4074*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  4075*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  4076*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  4077*** MODIFICATION.                                              ***
  4078*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  4079*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  4080******************************************************************
  4081*    COPY ERCPNDB.
  4082******************************************************************
  4083*                                                                *
  4084*                                                                *
  4085*                            ERCPNDB.                            *
  4086*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4087*                            VMOD=2.025                          *
  4088*                                                                *
  4089*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4090*                                                                *
  4091******************************************************************
  4092*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4093*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4094******************************************************************
  4095*                                                                *
  4096*                                                                *
  4097*   FILE TYPE = VSAM,KSDS                                        *
  4098*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4099*                                                                *
  4100*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4101*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4102*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4103*                                                 RKP=13,LEN=36  *
  4104*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4105*                                      AND CHG-SEQ.)             *
  4106*                                                RKP=49,LEN=11   *
  4107*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4108*                                      AND CHG-SEQ.)             *
  4109*                                                RKP=60,LEN=15   *
  4110*                                                                *
  4111*   LOG = NO                                                     *
  4112*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4113******************************************************************
  4114******************************************************************
  4115*                   C H A N G E   L O G
  4116*
  4117* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4118*-----------------------------------------------------------------
  4119*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4120* EFFECTIVE    NUMBER
  4121*-----------------------------------------------------------------
  4122* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4123* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4124* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4125* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4126* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4127* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4128* 032306                   PEMA  ADD BOW LOAN NUMBER
  4129* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  78
* EL050.cbl
  4130* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4131* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4132* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4133* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4134* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4135* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4136* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4137* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4138* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4139* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4140* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4141* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  4142******************************************************************
  4143
  4144 01  PENDING-BUSINESS.
  4145     12  PB-RECORD-ID                     PIC XX.
  4146         88  VALID-PB-ID                        VALUE 'PB'.
  4147
  4148     12  PB-CONTROL-PRIMARY.
  4149         16  PB-COMPANY-CD                PIC X.
  4150         16  PB-ENTRY-BATCH               PIC X(6).
  4151         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4152         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4153
  4154     12  PB-CONTROL-BY-ACCOUNT.
  4155         16  PB-COMPANY-CD-A1             PIC X.
  4156         16  PB-CARRIER                   PIC X.
  4157         16  PB-GROUPING.
  4158             20  PB-GROUPING-PREFIX       PIC XXX.
  4159             20  PB-GROUPING-PRIME        PIC XXX.
  4160         16  PB-STATE                     PIC XX.
  4161         16  PB-ACCOUNT.
  4162             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4163             20  PB-ACCOUNT-PRIME         PIC X(6).
  4164         16  PB-CERT-EFF-DT               PIC XX.
  4165         16  PB-CERT-NO.
  4166             20  PB-CERT-PRIME            PIC X(10).
  4167             20  PB-CERT-SFX              PIC X.
  4168         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4169
  4170         16  PB-RECORD-TYPE               PIC X.
  4171             88  PB-MAILING-DATA                VALUE '0'.
  4172             88  PB-ISSUE                       VALUE '1'.
  4173             88  PB-CANCELLATION                VALUE '2'.
  4174             88  PB-BATCH-TRAILER               VALUE '9'.
  4175
  4176     12  PB-CONTROL-BY-ORIG-BATCH.
  4177         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4178         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4179         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4180         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4181
  4182     12  PB-CONTROL-BY-CSR.
  4183         16  PB-CSR-COMPANY-CD            PIC X.
  4184         16  PB-CSR-ID                    PIC X(4).
  4185         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4186         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4187         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  79
* EL050.cbl
  4188******************************************************************
  4189*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4190******************************************************************
  4191
  4192     12  PB-LAST-MAINT-DT                 PIC XX.
  4193     12  PB-LAST-MAINT-BY                 PIC X(4).
  4194     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4195
  4196     12  PB-RECORD-BODY                   PIC X(375).
  4197
  4198     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4199         16  PB-CERT-ORIGIN               PIC X.
  4200             88  CLASIC-CREATED-CERT         VALUE '1'.
  4201         16  PB-I-NAME.
  4202             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4203             20  PB-I-INSURED-FIRST-NAME.
  4204                 24  PB-I-INSURED-1ST-INIT PIC X.
  4205                 24  FILLER                PIC X(9).
  4206             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4207         16  PB-I-AGE                     PIC S99   COMP-3.
  4208         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4209         16  PB-I-BIRTHDAY                PIC XX.
  4210         16  PB-I-INSURED-SEX             PIC X.
  4211             88  PB-SEX-MALE     VALUE 'M'.
  4212             88  PB-SEX-FEMALE   VALUE 'F'.
  4213
  4214         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4215         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4216         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4217         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4218         16  PB-I-SKIP-CODE               PIC X.
  4219             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4220             88  PB-SKIP-JULY              VALUE '1'.
  4221             88  PB-SKIP-AUGUST            VALUE '2'.
  4222             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4223             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4224             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4225             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4226             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4227             88  PB-SKIP-JUNE              VALUE '8'.
  4228             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4229             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4230             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4231         16  PB-I-TERM-TYPE               PIC X.
  4232             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4233             88  PB-PAID-WEEKLY            VALUE 'W'.
  4234             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4235             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4236             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4237         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4238         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4239         16  PB-I-DATA-ENTRY-SW           PIC X.
  4240             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4241             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4242             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4243             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4244         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4245         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  80
* EL050.cbl
  4246*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4247         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4248         16  PB-I-LETTER-REQD             PIC X.
  4249
  4250         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4251             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4252             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4253                                                   '90' THRU '99'.
  4254         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4255                                          PIC XX.
  4256         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4257         16  PB-I-AMOUNT-FINANCED REDEFINES
  4258                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4259         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4260         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4261                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4262         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4263         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4264         16  PB-I-CLP-AMOUNT REDEFINES
  4265                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4266         16  PB-I-LF-CALC-FLAG            PIC X.
  4267             88 PB-COMP-LF-PREM               VALUE '?'.
  4268         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4269         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4270         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4271         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4272         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4273         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4274         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4275         16  PB-I-LF-ABBR                 PIC XXX.
  4276         16  PB-I-LF-INPUT-CD             PIC XX.
  4277
  4278         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4279             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4280             88  PB-INVALID-AH               VALUE '  ' '00'
  4281                                                   '90' THRU '99'.
  4282         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4283         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4284         16  PB-I-AH-CALC-FLAG            PIC X.
  4285             88 PB-COMP-AH-PREM                  VALUE '?'.
  4286         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4287         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4288         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4289         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4290         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4291         16  PB-I-AH-ABBR                 PIC XXX.
  4292         16  PB-I-AH-INPUT-CD             PIC XXX.
  4293
  4294         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4295         16  PB-I-REIN-TABLE              PIC XXX.
  4296         16  PB-I-BUSINESS-TYPE           PIC 99.
  4297         16  PB-I-INDV-GRP-CD             PIC X.
  4298         16  PB-I-MORT-CODE.
  4299             20  PB-I-TABLE               PIC X.
  4300             20  PB-I-INTEREST            PIC XX.
  4301             20  PB-I-MORT-TYP            PIC X.
  4302         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4303         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  81
* EL050.cbl
  4304         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4305         16  PB-I-INDV-GRP-OVRD           PIC X.
  4306         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4307         16  PB-I-SIG-SW                  PIC X.
  4308             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4309         16  PB-I-RATE-CLASS              PIC XX.
  4310         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4311         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4312         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4313         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4314         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4315         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4316         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4317         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4318         16  PB-I-OB-FLAG                 PIC X.
  4319             88  PB-I-OB                      VALUE 'B'.
  4320             88  PB-I-SUMMARY                 VALUE 'Z'.
  4321         16  PB-I-ENTRY-STATUS            PIC X.
  4322             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4323                                              'M' '5' '9' '2'.
  4324             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4325             88  PB-I-POLICY-PENDING          VALUE '2'.
  4326             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4327             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4328             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4329             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4330             88  PB-I-REIN-ONLY               VALUE '9'.
  4331             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4332             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4333             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4334             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4335         16  PB-I-INT-CODE                PIC X.
  4336             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4337             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4338         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4339         16  PB-I-SOC-SEC-NO              PIC X(11).
  4340         16  PB-I-MEMBER-NO               PIC X(12).
  4341         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4342*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4343         16  PB-I-OLD-LOF                 PIC XXX.
  4344         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4345         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4346         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4347         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4348         16  PB-I-LIFE-INDICATOR          PIC X.
  4349             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4350         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4351         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4352                                          PIC S9(5)V99    COMP-3.
  4353         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4354             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4355             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4356         16  PB-I-1ST-PMT-DT              PIC XX.
  4357         16  PB-I-JOINT-INSURED.
  4358             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4359             20 PB-I-JOINT-FIRST-NAME.
  4360                24  PB-I-JOINT-FIRST-INIT PIC X.
  4361                24  FILLER                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  82
* EL050.cbl
  4362             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4363*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4364         16  PB-I-BENEFICIARY-NAME.
  4365             20  PB-I-BANK-NUMBER         PIC X(10).
  4366             20  FILLER                   PIC X(15).
  4367         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4368         16  PB-I-REFERENCE               PIC X(12).
  4369         16  FILLER REDEFINES PB-I-REFERENCE.
  4370             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4371             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4372             20  PB-I-CLP-STATE           PIC XX.
  4373         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4374             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4375             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4376             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4377         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4378         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4379         16  PB-I-RESIDENT-STATE          PIC XX.
  4380         16  PB-I-RATE-CODE               PIC X(4).
  4381         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4382         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4383         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4384         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4385         16  PB-I-BANK-NOCHRGB            PIC 99.
  4386         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4387         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4388
  4389     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4390         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4391             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4392         16  PB-C-CANCEL-ORIGIN           PIC X.
  4393             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4394         16  PB-C-LF-CANCEL-DT            PIC XX.
  4395         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4396         16  PB-C-LF-CALC-REQ             PIC X.
  4397             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4398         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4399         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4400         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4401             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4402         16  PB-C-AH-CANCEL-DT            PIC XX.
  4403         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4404         16  PB-C-AH-CALC-REQ             PIC X.
  4405             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4406         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4407         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4408         16  PB-C-LAST-NAME               PIC X(15).
  4409         16  PB-C-REFUND-SW               PIC X.
  4410             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4411             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4412         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4413         16  PB-C-PAYEE-CODE              PIC X(6).
  4414         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4415         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4416         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4417         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4418         16  PB-C-REFERENCE               PIC X(12).
  4419         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  83
* EL050.cbl
  4420         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4421         16  PB-C-POST-CARD-IND           PIC X.
  4422         16  PB-C-CANCEL-REASON           PIC X.
  4423         16  PB-C-REF-INTERFACE-SW        PIC X.
  4424         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4425         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4426         16  FILLER                       PIC X(01).
  4427*        16  FILLER                       PIC X(18).
  4428         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4429*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4430         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  4431         16  PB-CANCELED-CERT-DATA.
  4432             20  PB-CI-INSURED-NAME.
  4433                 24  PB-CI-LAST-NAME      PIC X(15).
  4434                 24  PB-CI-INITIALS       PIC XX.
  4435             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4436             20  PB-CI-INSURED-SEX        PIC X.
  4437             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4438             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4439             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4440             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4441             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4442             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4443             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4444             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4445             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4446             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4447             20  PB-CI-RATE-CLASS         PIC XX.
  4448             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4449             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4450             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4451             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4452             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4453             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4454             20  PB-CI-LF-ABBR            PIC X(3).
  4455             20  PB-CI-AH-ABBR            PIC X(3).
  4456             20  PB-CI-OB-FLAG            PIC X.
  4457                 88  PB-CI-OB                VALUE 'B'.
  4458             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4459                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4460                                           'M' '4' '5' '9' '2'.
  4461                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4462                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4463                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4464                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4465                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4466                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4467                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4468                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4469                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4470                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4471                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4472                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4473                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4474             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4475                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4476                                           'M' '4' '5' '9' '2'.
  4477                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  84
* EL050.cbl
  4478                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4479                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4480                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4481                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4482                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4483                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4484                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4485                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4486                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4487                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4488                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4489                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4490             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4491             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4492             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4493             20  PB-CI-MEMBER-NO          PIC X(12).
  4494             20  PB-CI-INT-CODE           PIC X.
  4495                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4496                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4497             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4498             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4499             20  PB-CI-COMP-EXCP-SW       PIC X.
  4500                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4501                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4502             20  PB-CI-ENTRY-STATUS       PIC X.
  4503             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4504             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4505             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4506             20  PB-CI-DEATH-DT           PIC XX.
  4507             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4508             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4509             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4510             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4511             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4512             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4513             20  PB-CI-ENTRY-DT              PIC XX.
  4514             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4515             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4516             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4517             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4518             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4519             20  PB-CI-OLD-LOF               PIC XXX.
  4520*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4521             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4522             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4523             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4524             20  PB-CI-INDV-GRP-CD           PIC X.
  4525             20  PB-CI-BENEFICIARY-NAME.
  4526                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4527                 24  FILLER                  PIC X(15).
  4528             20  PB-CI-NOTE-SW               PIC X.
  4529             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4530             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4531             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4532             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4533             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4534             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4535             20  PB-CI-FIRST-NAME            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  85
* EL050.cbl
  4536             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4537
  4538         16  FILLER                       PIC X(13).
  4539*032306  16  FILLER                       PIC X(27).
  4540*        16  FILLER                       PIC X(46).
  4541
  4542     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4543         16  FILLER                       PIC X(10).
  4544         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4545         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4546         16  PB-M-INSURED-MID-INIT        PIC X.
  4547         16  PB-M-INSURED-AGE             PIC 99.
  4548         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4549         16  PB-M-INSURED-SEX             PIC X.
  4550         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4551         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4552         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4553         16  PB-M-INSURED-CITY-STATE.
  4554             20  PB-M-INSURED-CITY        PIC X(28).
  4555             20  PB-M-INSURED-STATE       PIC XX.
  4556         16  PB-M-INSURED-ZIP-CODE.
  4557             20  PB-M-INSURED-ZIP-PRIME.
  4558                 24  PB-M-INSURED-ZIP-1   PIC X.
  4559                     88  PB-M-CANADIAN-POST-CODE
  4560                                             VALUE 'A' THRU 'Z'.
  4561                 24  FILLER               PIC X(4).
  4562             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4563         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4564                                        PB-M-INSURED-ZIP-CODE.
  4565             20  PM-M-INS-CAN-POST1       PIC XXX.
  4566             20  PM-M-INS-CAN-POST2       PIC XXX.
  4567             20  FILLER                   PIC XXX.
  4568         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4569         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4570         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4571         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4572         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4573         16  PB-M-CRED-BENE-CITYST.
  4574             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4575             20  PB-M-CRED-BENE-STATE     PIC XX.
  4576         16  FILLER                       PIC X(92).
  4577
  4578     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4579         16  FILLER                       PIC X(10).
  4580         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4581         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4582         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4583         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4584         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4585         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4586         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4587         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4588         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4589         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4590         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4591         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4592         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4593         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  86
* EL050.cbl
  4594         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4595         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4596         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4597         16  PB-ACCOUNT-NAME              PIC X(30).
  4598         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4599         16  PB-REFERENCE                 PIC X(12).
  4600         16  PB-B-RECEIVED-DT             PIC XX.
  4601         16  FILLER                       PIC X(234).
  4602
  4603     12  PB-RECORD-STATUS.
  4604         16  PB-CREDIT-SELECT-DT          PIC XX.
  4605         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4606         16  PB-BILLED-DT                 PIC XX.
  4607         16  PB-BILLING-STATUS            PIC X.
  4608             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4609             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4610             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4611         16  PB-RECORD-BILL               PIC X.
  4612             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4613             88  PB-RECORD-RETURNED           VALUE 'R'.
  4614             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4615             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4616             88  PB-OVERRIDE-AH               VALUE 'A'.
  4617             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4618         16  PB-BATCH-ENTRY               PIC X.
  4619             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4620             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4621             88  PB-REISSUED-CERT             VALUE 'E'.
  4622             88  PB-CASH-CERT                 VALUE 'C'.
  4623             88  PB-MONTHLY-CERT              VALUE 'M'.
  4624             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4625             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4626             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4627         16  PB-FORCE-CODE                PIC X.
  4628             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4629             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4630             88  PB-CANCEL-FORCE              VALUE '8'.
  4631             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4632             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4633             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4634             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4635             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4636             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4637             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4638             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4639         16  PB-FATAL-FLAG                PIC X.
  4640             88  PB-FATAL-ERRORS              VALUE 'X'.
  4641         16  PB-FORCE-ER-CD               PIC X.
  4642             88  PB-FORCE-ERRORS              VALUE 'F'.
  4643             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4644         16  PB-WARN-ER-CD                PIC X.
  4645             88  PB-WARNING-ERRORS            VALUE 'W'.
  4646         16  FILLER                       PIC X.
  4647         16  PB-OUT-BAL-CD                PIC X.
  4648             88  PB-OUT-OF-BAL                VALUE 'O'.
  4649         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4650         16  PB-AH-OVERRIDE-L1            PIC X.
  4651         16  PB-INPUT-DT                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  87
* EL050.cbl
  4652         16  PB-INPUT-BY                  PIC X(4).
  4653         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4654         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4655         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4656         16  PB-LF-EARNING-METHOD         PIC X.
  4657         16  PB-AH-EARNING-METHOD         PIC X.
  4658         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4659         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4660         16  PB-REIN-CD                   PIC XXX.
  4661         16  PB-LF-REFUND-TYPE            PIC X.
  4662         16  PB-AH-REFUND-TYPE            PIC X.
  4663         16  PB-ACCT-EFF-DT               PIC XX.
  4664         16  PB-ACCT-EXP-DT               PIC XX.
  4665         16  PB-COMPANY-ID                PIC X(3).
  4666         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4667         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4668         16  PB-SV-CARRIER                PIC X.
  4669         16  PB-SV-GROUPING               PIC X(6).
  4670         16  PB-SV-STATE                  PIC XX.
  4671         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4672         16  PB-GA-BILLING-INFO.
  4673             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4674                                          PIC XX.
  4675         16  PB-SV-REMIT-TO  REDEFINES
  4676             PB-GA-BILLING-INFO           PIC X(10).
  4677         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4678         16  PB-I-LOAN-OFFICER            PIC X(5).
  4679         16  PB-I-VIN                     PIC X(17).
  4680
  4681         16  FILLER                       PIC X(04).
  4682         16  IMNET-BYPASS-SW              PIC X.
  4683
  4684******************************************************************
  4685*                COMMON EDIT ERRORS                              *
  4686******************************************************************
  4687
  4688     12  PB-COMMON-ERRORS.
  4689         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4690                                           PIC S9(4)     COMP.
  4691
  4692******************************************************************
  4693
  4694* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4695*    COPY ELC50W1.
  4696******************************************************************
  4697*                                                                *
  4698*                                                                *
  4699*                             ELC50W1                            *
  4700*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4701*                            VMOD=2.004                          *
  4702*                                                                *
  4703*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4704*                                                                *
  4705*                                                                *
  4706******************************************************************
  4707
  4708     12  WK-WORK-AREA.
  4709         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  88
* EL050.cbl
  4710         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4711         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4712         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4713         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4714         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4715         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4716         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4717         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4718         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4719         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4720         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4721         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4722         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4723         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4724         16  WK-CREDIT-EDIT-CONTROLS.
  4725             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4726             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4727             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4728             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4729             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4730             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4731         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4732         16  WK-SAVE-REIN-DATA.
  4733             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4734             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4735             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4736         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4737             88  ENTRY-FROM-EL6311       VALUE '6'.
  4738         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4739         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4740     12  WK-RECORD-ADDRESSES.
  4741         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4742         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4743         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4744         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4745         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4746         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4747         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4748         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4749     12  WK-OVER-SHORT-AREA.
  4750         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4751         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4752         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4753             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4754         16  FILLER                   PIC X(5) VALUE SPACES.
  4755
  4756*    COPY ELCEDITC.
  4757******************************************************************
  4758*                                                                *
  4759*                                                                *
  4760*                            ELCEDITC                            *
  4761*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4762*                            VMOD=2.012                          *
  4763*                                                                *
  4764*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4765*                     EL6313, EL050 AND EL517.                   *
  4766*                                                                *
  4767******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  89
* EL050.cbl
  4768******************************************************************
  4769*                   C H A N G E   L O G
  4770*
  4771* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4772*-----------------------------------------------------------------
  4773*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4774* EFFECTIVE    NUMBER
  4775*-----------------------------------------------------------------
  4776* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4777******************************************************************
  4778
  4779     12  EDIT-CRITERIA-DATA.
  4780         16  EC-CO-MONTH-END-DT       PIC XX.
  4781         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4782         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4783         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4784         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4785         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4786         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4787         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4788         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4789         16  EC-CO-REM-TERM-CALC      PIC X.
  4790               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4791               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4792               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4793               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4794
  4795         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4796               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4797               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4798               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4799               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4800               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4801               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4802               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4803               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4804               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4805               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4806
  4807         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4808               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4809               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4810               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4811               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4812               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4813               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4814               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4815               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4816
  4817         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4818                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4819                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4820
  4821         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4822                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4823                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4824                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4825                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  90
* EL050.cbl
  4826                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4827                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4828                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4829                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4830
  4831         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4832               88  EC-BR-REDUCING                   VALUE 'R'.
  4833               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4834
  4835         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4836         16  EC-BR-LF-DESC             PIC X(10).
  4837         16  EC-BR-AH-DESC             PIC X(10).
  4838         16  EC-BR-LF-COMMENT          PIC X(10).
  4839         16  EC-BR-AH-COMMENT          PIC X(10).
  4840
  4841         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4842               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4843               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4844               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4845               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4846
  4847         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4848               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4849               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4850               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4851               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4852
  4853         16  EC-BR-LF-REFUND-CALC      PIC X.
  4854                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4855                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4856                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4857                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4858                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4859                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4860                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4861
  4862         16  EC-BR-AH-REFUND-CALC      PIC X.
  4863                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4864                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4865                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4866                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4867                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4868                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4869                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4870                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4871
  4872         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4873                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4874                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4875                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4876
  4877         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4878                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4879                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4880                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4881
  4882         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4883         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  91
* EL050.cbl
  4884         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4885         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4886
  4887         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4888         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4889                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4890                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4891                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4892                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4893
  4894         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4895               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4896               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4897               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4898               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4899               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4900
  4901         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4902               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4903               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4904               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4905               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4906               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4907
  4908         16  EC-ST-LF-REFUND-CALC      PIC X.
  4909                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4910                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4911                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4912                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4913                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4914                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4915                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4916                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4917
  4918         16  EC-ST-AH-REFUND-CALC      PIC X.
  4919                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4920                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4921                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4922                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4923                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4924                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4925                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4926                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4927
  4928         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4929         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4930         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4931         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4932         16  EC-AM-EXPIRATION-DT       PIC XX.
  4933         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4934         16  EC-AM-CLASS-CD            PIC XX.
  4935         16  EC-AM-LF-DEVIATION        PIC XXX.
  4936         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4937         16  EC-AM-AH-DEVIATION        PIC XXX.
  4938         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4939         16  EC-AM-PHONE-NO            PIC X(10).
  4940
  4941         16  EC-AM-LF-REFUND-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  92
* EL050.cbl
  4942                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4943                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4944                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4945                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4946                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4947                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4948                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4949
  4950         16  EC-AM-AH-REFUND-CALC      PIC X.
  4951                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4952                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4953                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4954                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4955                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4956                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4957                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4958
  4959         16  EC-AM-BEN-I-G-CD          PIC X.
  4960                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4961                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4962                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4963
  4964         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4965         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4966         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4967         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4968         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4969         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4970         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4971         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4972         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4973
  4974         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4975         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4976         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4977         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4978         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4979         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4980         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4981         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4982         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4983         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4984         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4985         16  EC-RT-LF-NSP-ST           PIC XX.
  4986         16  EC-RT-AH-NSP-ST           PIC XX.
  4987         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4988         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4989
  4990         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4991             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4992                                             'M' '5' '9' '2'.
  4993             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4994             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4995             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4996             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4997             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4998             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4999             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  93
* EL050.cbl
  5000             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  5001             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  5002             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  5003
  5004         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  5005             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  5006                                             'M' '5' '9' '2'.
  5007             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  5008             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  5009             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  5010             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  5011             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  5012             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  5013             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  5014             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  5015             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  5016             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  5017
  5018         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  5019         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  5020         16  EC-CM-LF-CANCEL-DT        PIC XX.
  5021         16  EC-CM-AH-CANCEL-DT        PIC XX.
  5022         16  EC-CM-DEATH-DT            PIC XX.
  5023
  5024*DMD CUSTOM CODING FIELDS BELOW
  5025*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  5026         16  EC-BR-DMD-RATING-SW       PIC X.
  5027                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  5028                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  5029                 88  NO-DMD-RATING               VALUE 'N'.
  5030
  5031         16  EC-NEW-CERT               PIC X(11).
  5032         16  EC-NEW-STATE              PIC XX.
  5033         16  FILLER                    PIC X.
  5034*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  5035         16  OVER-SHORT-EDIT-FIELDS.
  5036             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5037             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5038             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5039             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5040             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  5041             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5042             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5043             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5044             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5045         16  FILLER                    PIC X(71).
  5046******************************************************************
  5047
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  94
* EL050.cbl
  5049*    COPY ELCDIFRD.
  5050******************************************************************
  5051*                                                                *
  5052*                                                                *
  5053*                            ELCDIFRD.                           *
  5054*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5055*                            VMOD=2.004                          *
  5056*                                                                *
  5057*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  5058*                                                                *
  5059******************************************************************
  5060*
  5061  01  WS-DIFFERENCE-CALCULATION.
  5062        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  5063        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  5064        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  5065        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  5066        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  5067        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5068        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5069        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5070        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5071        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5072        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5073
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  95
* EL050.cbl
  5075****************************************************************
  5076*
  5077* Copyright (c) 2007-2013 Dell Inc.
  5078* All rights reserved.
  5079*
  5080****************************************************************
  5081 01  DFHEIV.
  5082   02  DFHEIV0               PIC X(35).
  5083   02  DFHEIV1               PIC X(08).
  5084   02  DFHEIV2               PIC X(08).
  5085   02  DFHEIV3               PIC X(08).
  5086   02  DFHEIV4               PIC X(06).
  5087   02  DFHEIV5               PIC X(04).
  5088   02  DFHEIV6               PIC X(04).
  5089   02  DFHEIV7               PIC X(02).
  5090   02  DFHEIV8               PIC X(02).
  5091   02  DFHEIV9               PIC X(01).
  5092   02  DFHEIV10              PIC S9(7) COMP-3.
  5093   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5094   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5095   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5096   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5097   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5098   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5099   02  DFHEIV17              PIC X(04).
  5100   02  DFHEIV18              PIC X(04).
  5101   02  DFHEIV19              PIC X(04).
  5102   02  DFHEIV20              USAGE IS POINTER.
  5103   02  DFHEIV21              USAGE IS POINTER.
  5104   02  DFHEIV22              USAGE IS POINTER.
  5105   02  DFHEIV23              USAGE IS POINTER.
  5106   02  DFHEIV24              USAGE IS POINTER.
  5107   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5108   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5109   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5110   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5111   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5112   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5113   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5114   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5115   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5116   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5117   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5118   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5119   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5120   02  FILLER                PIC X(02).
  5121   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5122   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5123   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5124   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5125   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5126   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5127   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5128 LINKAGE  SECTION.
  5129*****************************************************************
  5130*                                                               *
  5131* Copyright (c) 2007-2013 Dell Inc.                             *
  5132* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  96
* EL050.cbl
  5133*                                                               *
  5134*****************************************************************
  5135 01  dfheiblk.
  5136     02  eibtime          pic s9(7) comp-3.
  5137     02  eibdate          pic s9(7) comp-3.
  5138     02  eibtrnid         pic x(4).
  5139     02  eibtaskn         pic s9(7) comp-3.
  5140     02  eibtrmid         pic x(4).
  5141     02  dfheigdi         pic s9(4) comp.
  5142     02  eibcposn         pic s9(4) comp.
  5143     02  eibcalen         pic s9(4) comp.
  5144     02  eibaid           pic x(1).
  5145     02  eibfiller1       pic x(1).
  5146     02  eibfn            pic x(2).
  5147     02  eibfiller2       pic x(2).
  5148     02  eibrcode         pic x(6).
  5149     02  eibfiller3       pic x(2).
  5150     02  eibds            pic x(8).
  5151     02  eibreqid         pic x(8).
  5152     02  eibrsrce         pic x(8).
  5153     02  eibsync          pic x(1).
  5154     02  eibfree          pic x(1).
  5155     02  eibrecv          pic x(1).
  5156     02  eibsend          pic x(1).
  5157     02  eibatt           pic x(1).
  5158     02  eibeoc           pic x(1).
  5159     02  eibfmh           pic x(1).
  5160     02  eibcompl         pic x(1).
  5161     02  eibsig           pic x(1).
  5162     02  eibconf          pic x(1).
  5163     02  eiberr           pic x(1).
  5164     02  eibrldbk         pic x(1).
  5165     02  eiberrcd         pic x(4).
  5166     02  eibsynrb         pic x(1).
  5167     02  eibnodat         pic x(1).
  5168     02  eibfiller5       pic x(2).
  5169     02  eibresp          pic s9(8) comp.
  5170     02  eibresp2         pic s9(8) comp.
  5171     02  dfheigdj         pic s9(4) comp.
  5172     02  dfheigdk         pic s9(4) comp.
  5173
  5174 01  DFHCOMMAREA                   PIC X(1036).
  5175
  5176*01 PARMLIST .
  5177*    02  FILLER                    PIC S9(8)   COMP.
  5178*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5179*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5180*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5181*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5182*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5183*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5184*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5185
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  97
* EL050.cbl
  5187*    COPY ELCCNTL.
  5188******************************************************************
  5189*                                                                *
  5190*                                                                *
  5191*                            ELCCNTL.                            *
  5192*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5193*                            VMOD=2.059                          *
  5194*                                                                *
  5195*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5196*                                                                *
  5197*   FILE TYPE = VSAM,KSDS                                        *
  5198*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5199*                                                                *
  5200*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5201*       ALTERNATE INDEX = NONE                                   *
  5202*                                                                *
  5203*   LOG = YES                                                    *
  5204*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5205******************************************************************
  5206*                   C H A N G E   L O G
  5207*
  5208* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5209*-----------------------------------------------------------------
  5210*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5211* EFFECTIVE    NUMBER
  5212*-----------------------------------------------------------------
  5213* 082503                   PEMA  ADD BENEFIT GROUP
  5214* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5215* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5216* 092705    2005050300006  PEMA  ADD SPP LEASES
  5217* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5218* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5219* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5220* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5221* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5222* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5223* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5224* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5225* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5226* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5227* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5228******************************************************************
  5229*
  5230 01  CONTROL-FILE.
  5231     12  CF-RECORD-ID                       PIC XX.
  5232         88  VALID-CF-ID                        VALUE 'CF'.
  5233
  5234     12  CF-CONTROL-PRIMARY.
  5235         16  CF-COMPANY-ID                  PIC XXX.
  5236         16  CF-RECORD-TYPE                 PIC X.
  5237             88  CF-COMPANY-MASTER              VALUE '1'.
  5238             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5239             88  CF-STATE-MASTER                VALUE '3'.
  5240             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5241             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5242             88  CF-CARRIER-MASTER              VALUE '6'.
  5243             88  CF-MORTALITY-MASTER            VALUE '7'.
  5244             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  98
* EL050.cbl
  5245             88  CF-TERMINAL-MASTER             VALUE '9'.
  5246             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5247             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5248             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5249             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5250             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5251             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5252             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5253             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5254             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5255         16  CF-ACCESS-CD-GENL              PIC X(4).
  5256         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5257             20  CF-PROCESSOR               PIC X(4).
  5258         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5259             20  CF-STATE-CODE              PIC XX.
  5260             20  FILLER                     PIC XX.
  5261         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5262             20  FILLER                     PIC XX.
  5263             20  CF-HI-BEN-IN-REC           PIC XX.
  5264         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5265             20  FILLER                     PIC XXX.
  5266             20  CF-CARRIER-CNTL            PIC X.
  5267         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5268             20  FILLER                     PIC XX.
  5269             20  CF-HI-TYPE-IN-REC          PIC 99.
  5270         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5271             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5272                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5273             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5274             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5275         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5276             20  FILLER                     PIC X.
  5277             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5278         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5279             20  FILLER                     PIC XX.
  5280             20  CF-MORTGAGE-PLAN           PIC XX.
  5281         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5282
  5283     12  CF-LAST-MAINT-DT                   PIC XX.
  5284     12  CF-LAST-MAINT-BY                   PIC X(4).
  5285     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5286
  5287     12  CF-RECORD-BODY                     PIC X(728).
  5288
  5289
  5290****************************************************************
  5291*             COMPANY MASTER RECORD                            *
  5292****************************************************************
  5293
  5294     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5295         16  CF-COMPANY-ADDRESS.
  5296             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5297             20  CF-CL-IN-CARE-OF           PIC X(30).
  5298             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5299             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5300             20  CF-CL-CITY-STATE           PIC X(30).
  5301             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5302             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page  99
* EL050.cbl
  5303         16  CF-COMPANY-CD                  PIC X.
  5304         16  CF-COMPANY-PASSWORD            PIC X(8).
  5305         16  CF-SECURITY-OPTION             PIC X.
  5306             88  ALL-SECURITY                   VALUE '1'.
  5307             88  COMPANY-VERIFY                 VALUE '2'.
  5308             88  PROCESSOR-VERIFY               VALUE '3'.
  5309             88  NO-SECURITY                    VALUE '4'.
  5310             88  ALL-BUT-TERM                   VALUE '5'.
  5311         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5312             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5313         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5314             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5315         16  CF-INFORCE-LOCATION            PIC X.
  5316             88  CERTS-ARE-ONLINE               VALUE '1'.
  5317             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5318             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5319         16  CF-LOWER-CASE-LETTERS          PIC X.
  5320         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5321             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5322             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5323             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5324             88  CF-ACCNT-CNTL                  VALUE '3'.
  5325             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5326
  5327         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5328         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5329
  5330         16  CF-LGX-CREDIT-USER             PIC X.
  5331             88  CO-IS-NOT-USER                 VALUE 'N'.
  5332             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5333
  5334         16 CF-CREDIT-CALC-CODES.
  5335             20  CF-CR-REM-TERM-CALC PIC X.
  5336               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5337               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5338               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5339               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5340               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5341               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5342               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5343             20  CF-CR-R78-METHOD           PIC X.
  5344               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5345               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5346
  5347         16  CF-CLAIM-CONTROL-COUNTS.
  5348             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5349                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5350
  5351             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5352                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5353
  5354             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5355                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5356
  5357             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5358                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5359
  5360         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 100
* EL050.cbl
  5361
  5362         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5363             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5364             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5365             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5366             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5367                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5368                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5369             20  CF-CO-PREM-REJECT-SW       PIC X.
  5370                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5371                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5372             20  CF-CO-REF-REJECT-SW        PIC X.
  5373                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5374                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5375
  5376         16  CF-CO-REPORTING-DT             PIC XX.
  5377         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5378         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5379           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5380           88  CF-CO-MONTH-END                  VALUE '1'.
  5381
  5382         16  CF-LGX-CLAIM-USER              PIC X.
  5383             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5384             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5385
  5386         16  CF-CREDIT-EDIT-CONTROLS.
  5387             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5388             20  CF-MIN-AGE                 PIC 99.
  5389             20  CF-DEFAULT-AGE             PIC 99.
  5390             20  CF-MIN-TERM                PIC S999      COMP-3.
  5391             20  CF-MAX-TERM                PIC S999      COMP-3.
  5392             20  CF-DEFAULT-SEX             PIC X.
  5393             20  CF-JOINT-AGE-INPUT         PIC X.
  5394                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5395             20  CF-BIRTH-DATE-INPUT        PIC X.
  5396                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5397             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5398                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5399                 88  CF-ZERO-CARRIER            VALUE '1'.
  5400                 88  CF-ZERO-GROUPING           VALUE '2'.
  5401                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5402             20  CF-EDIT-SW                 PIC X.
  5403                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5404             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5405             20  CF-CR-PR-METHOD            PIC X.
  5406               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5407               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5408             20  FILLER                     PIC X.
  5409
  5410         16  CF-CREDIT-MISC-CONTROLS.
  5411             20  CF-REIN-TABLE-SW           PIC X.
  5412                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5413             20  CF-COMP-TABLE-SW           PIC X.
  5414                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5415             20  CF-EXPERIENCE-RETENTION-AGE
  5416                                            PIC S9        COMP-3.
  5417             20  CF-CONVERSION-DT           PIC XX.
  5418             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 101
* EL050.cbl
  5419             20  CF-RUN-FREQUENCY-SW        PIC X.
  5420                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5421                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5422
  5423             20  CF-CR-CHECK-NO-CONTROL.
  5424                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5425                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5426                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5427                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5428                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5429                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5430
  5431                 24  CF-CR-CHECK-COUNT       REDEFINES
  5432                     CF-CR-CHECK-COUNTER      PIC X(4).
  5433
  5434                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5435                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5436
  5437                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5438                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5439                 24  CF-MAIL-PROCESSING       PIC X.
  5440                     88  MAIL-PROCESSING          VALUE 'Y'.
  5441
  5442         16  CF-MISC-SYSTEM-CONTROL.
  5443             20  CF-SYSTEM-C                 PIC X.
  5444                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5445             20  CF-SYSTEM-D                 PIC X.
  5446                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5447             20  CF-SOC-SEC-NO-SW            PIC X.
  5448                 88  SOC-SEC-NO-USED             VALUE '1'.
  5449             20  CF-MEMBER-NO-SW             PIC X.
  5450                 88  MEMBER-NO-USED              VALUE '1'.
  5451             20  CF-TAX-ID-NUMBER            PIC X(11).
  5452             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5453             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5454                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5455                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5456                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5457                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5458             20  CF-SYSTEM-E                 PIC X.
  5459                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5460
  5461         16  CF-LGX-LIFE-USER               PIC X.
  5462             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5463             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5464
  5465         16  CF-CR-MONTH-END-DT             PIC XX.
  5466
  5467         16  CF-FILE-MAINT-DATES.
  5468             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5469                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5470             20  CF-LAST-BATCH       REDEFINES
  5471                 CF-LAST-BATCH-NO               PIC X(4).
  5472             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5473             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5474             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5475             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5476             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 102
* EL050.cbl
  5477             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5478             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5479             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5480             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5481             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5482
  5483         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5484         16  FILLER                         PIC X.
  5485
  5486         16  CF-ALT-MORT-CODE               PIC X(4).
  5487         16  CF-MEMBER-CAPTION              PIC X(10).
  5488
  5489         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5490             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5491             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5492             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5493             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5494             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5495
  5496         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5497
  5498         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5499         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5500         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5501         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5502
  5503         16  CF-AH-OVERRIDE-L1              PIC X.
  5504         16  CF-AH-OVERRIDE-L2              PIC XX.
  5505         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5506         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5507
  5508         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5509         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5510
  5511         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5512         16  CF-AR-LAST-EL860-DT            PIC XX.
  5513         16  CF-MP-MONTH-END-DT             PIC XX.
  5514
  5515         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5516         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5517             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5518
  5519         16  CF-AR-MONTH-END-DT             PIC XX.
  5520
  5521         16  CF-CRDTCRD-USER                PIC X.
  5522             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5523             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5524
  5525         16  CF-CC-MONTH-END-DT             PIC XX.
  5526
  5527         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5528
  5529         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5530             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5531             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5532             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5533         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5534         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 103
* EL050.cbl
  5535         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5536         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5537             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5538             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5539         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5540         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5541         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5542             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5543         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5544
  5545         16  CF-CL-ZIP-CODE.
  5546             20  CF-CL-ZIP-PRIME.
  5547                 24  CF-CL-ZIP-1ST          PIC X.
  5548                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5549                 24  FILLER                 PIC X(4).
  5550             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5551         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5552             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5553             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5554             20  FILLER                     PIC XXX.
  5555
  5556         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5557         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5558         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5559         16  CF-CO-OPTION-START-DATE        PIC XX.
  5560         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5561           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5562                                                      '3' '4'.
  5563           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5564           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5565           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5566           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5567           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5568           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5569
  5570         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5571
  5572         16  CF-PAYMENT-APPROVAL-LEVELS.
  5573             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5574             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5575             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5576             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5577             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5578             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5579
  5580         16  CF-END-USER-REPORTING-USER     PIC X.
  5581             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5582             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5583
  5584         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5585             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5586             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5587
  5588         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5589
  5590         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5591         16  FILLER                         PIC X.
  5592
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 104
* EL050.cbl
  5593         16  CF-CREDIT-ARCHIVE-CNTL.
  5594             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5595             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5596             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5597
  5598         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5599
  5600         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5601             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5602             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5603
  5604         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5605             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5606             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5607
  5608         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5609
  5610         16  CF-CO-ACH-ID-CODE              PIC  X.
  5611             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5612             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5613             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5614         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5615         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5616         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5617         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5618         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5619         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5620         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5621         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5622         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5623                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5624         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5625                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5626
  5627         16  CF-CO-OVER-SHORT.
  5628             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5629             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5630
  5631*         16  FILLER                         PIC X(102).
  5632         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5633             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5634             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5635
  5636         16  CF-AH-APPROVAL-DAYS.
  5637             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5638             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5639             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5640             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5641
  5642         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5643
  5644         16  CF-APPROV-LEV-5.
  5645             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5646             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5647             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5648
  5649         16  FILLER                         PIC X(68).
  5650****************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 105
* EL050.cbl
  5651*             PROCESSOR/USER RECORD                            *
  5652****************************************************************
  5653
  5654     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5655         16  CF-PROCESSOR-NAME              PIC X(30).
  5656         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5657         16  CF-PROCESSOR-TITLE             PIC X(26).
  5658         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5659                 88  MESSAGE-YES                VALUE 'Y'.
  5660                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5661
  5662*****************************************************
  5663****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5664****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5665****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5666****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5667*****************************************************
  5668
  5669         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5670             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5671             20  CF-APPLICATION-FORCE       PIC X.
  5672             20  CF-INDIVIDUAL-APP.
  5673                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5674                     28  CF-BROWSE-APP      PIC X.
  5675                     28  CF-UPDATE-APP      PIC X.
  5676
  5677         16  CF-CURRENT-TERM-ON             PIC X(4).
  5678         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5679             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5680             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5681             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5682             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5683             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5684             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5685             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5686         16  CF-PROCESSOR-CARRIER           PIC X.
  5687             88  NO-CARRIER-SECURITY            VALUE ' '.
  5688         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5689             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5690         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5691             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5692         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5693             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5694
  5695         16  CF-PROC-SYS-ACCESS-SW.
  5696             20  CF-PROC-CREDIT-CLAIMS-SW.
  5697                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5698                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5699                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5700                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5701             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5702                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5703                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5704             20  CF-PROC-LIFE-GNRLDGR-SW.
  5705                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5706                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5707                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5708                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 106
* EL050.cbl
  5709             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5710                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5711                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5712         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5713             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5714             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5715         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5716
  5717         16  CF-APPROVAL-LEVEL                  PIC X.
  5718             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5719             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5720             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5721             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5722             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5723
  5724         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5725
  5726         16  CF-LANGUAGE-TYPE                   PIC X.
  5727             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5728             88  CF-LANG-IS-FR                      VALUE 'F'.
  5729
  5730         16  CF-CSR-IND                         PIC X.
  5731         16  FILLER                             PIC X(239).
  5732
  5733****************************************************************
  5734*             PROCESSOR/REMINDERS RECORD                       *
  5735****************************************************************
  5736
  5737     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5738         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5739             20  CF-START-REMIND-DT         PIC XX.
  5740             20  CF-END-REMIND-DT           PIC XX.
  5741             20  CF-REMINDER-TEXT           PIC X(50).
  5742         16  FILLER                         PIC X(296).
  5743
  5744
  5745****************************************************************
  5746*             STATE MASTER RECORD                              *
  5747****************************************************************
  5748
  5749     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5750         16  CF-STATE-ABBREVIATION          PIC XX.
  5751         16  CF-STATE-NAME                  PIC X(25).
  5752         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5753         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5754             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5755             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5756             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5757             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5758                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5759                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5760             20  CF-ST-PREM-REJECT-SW       PIC X.
  5761                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5762                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5763             20  CF-ST-REF-REJECT-SW        PIC X.
  5764                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5765                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5766         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 107
* EL050.cbl
  5767         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5768         16  CF-ST-REFUND-RULES.
  5769             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5770             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5771             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5772         16  CF-ST-FST-PMT-EXTENSION.
  5773             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5774             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5775                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5776                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5777                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5778                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5779         16  CF-ST-STATE-CALL.
  5780             20  CF-ST-CALL-UNEARNED        PIC X.
  5781             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5782             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5783         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5784             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5785             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5786         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5787         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5788         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5789         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5790         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5791         16  FILLER                         PIC X.
  5792         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5793             20  CF-ST-BENEFIT-CD           PIC XX.
  5794             20  CF-ST-BENEFIT-KIND         PIC X.
  5795                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5796                 88  CF-ST-AH-KIND              VALUE 'A'.
  5797             20  CF-ST-REM-TERM-CALC        PIC X.
  5798                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5799                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5800                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5801                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5802                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5803                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5804                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5805                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5806
  5807             20  CF-ST-REFUND-CALC          PIC X.
  5808                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5809                 88  ST-REFD-BY-R78             VALUE '1'.
  5810                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5811                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5812                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5813                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5814                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5815                 88  ST-REFD-UTAH               VALUE '7'.
  5816                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5817                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5818                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5819
  5820             20  CF-ST-EARNING-CALC         PIC X.
  5821                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5822                 88  ST-EARN-BY-R78             VALUE '1'.
  5823                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5824                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 108
* EL050.cbl
  5825                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5826                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5827                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5828                 88  ST-EARN-MEAN               VALUE '8'.
  5829                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5830
  5831             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5832                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5833                 88  ST-OVRD-BY-R78             VALUE '1'.
  5834                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5835                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5836                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5837                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5838                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5839                 88  ST-OVRD-MEAN               VALUE '8'.
  5840                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5841             20  cf-st-extra-periods        pic 9.
  5842*            20  FILLER                     PIC X.
  5843
  5844         16  CF-ST-COMMISSION-CAPS.
  5845             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5846             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5847             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5848             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5849         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5850                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5851                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5852                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5853
  5854         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5855
  5856         16  CF-ST-STATUTORY-INTEREST.
  5857             20  CF-ST-STAT-DATE-FROM       PIC X.
  5858                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5859                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5860             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5861             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5862             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5863             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5864             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5865
  5866         16  CF-ST-OVER-SHORT.
  5867             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5868             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5869
  5870         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5871
  5872         16  CF-ST-RT-CALC                  PIC X.
  5873
  5874         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5875         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5876         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5877         16  CF-ST-RF-LR-CALC               PIC X.
  5878         16  CF-ST-RF-LL-CALC               PIC X.
  5879         16  CF-ST-RF-LN-CALC               PIC X.
  5880         16  CF-ST-RF-AH-CALC               PIC X.
  5881         16  CF-ST-RF-CP-CALC               PIC X.
  5882*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 109
* EL050.cbl
  5883*CIDMOD         16  FILLER                         PIC X(192).
  5884         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5885             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5886         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5887         16  CF-ST-VFY-2ND-BENE             PIC X.
  5888         16  CF-ST-CAUSAL-STATE             PIC X.
  5889         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5890         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5891         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5892             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5893         16  CF-ST-NET-ONLY-STATE           PIC X.
  5894             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5895         16  cf-commission-cap-required     pic x.
  5896         16  CF-ST-GA-COMMISSION-CAPS.
  5897             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5898             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5899             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5900             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5901         16  CF-ST-TOT-COMMISSION-CAPS.
  5902             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5903             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5904             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5905             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5906         16  FILLER                         PIC X(156).
  5907
  5908****************************************************************
  5909*             BENEFIT MASTER RECORD                            *
  5910****************************************************************
  5911
  5912     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5913         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5914             20  CF-BENEFIT-CODE            PIC XX.
  5915             20  CF-BENEFIT-NUMERIC  REDEFINES
  5916                 CF-BENEFIT-CODE            PIC XX.
  5917             20  CF-BENEFIT-ALPHA           PIC XXX.
  5918             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5919             20  CF-BENEFIT-COMMENT         PIC X(10).
  5920
  5921             20  CF-LF-COVERAGE-TYPE        PIC X.
  5922                 88  CF-REDUCING                VALUE 'R'.
  5923                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5924
  5925             20  CF-SPECIAL-CALC-CD         PIC X.
  5926                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5927                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5928                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5929                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5930                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5931                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5932                 88  CF-FARM-PLAN               VALUE 'F'.
  5933                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5934                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5935                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5936                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5937                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5938                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5939                 88  CF-PRUDENTIAL              VALUE 'P'.
  5940                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 110
* EL050.cbl
  5941                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5942                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5943                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5944                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5945                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5946
  5947             20  CF-JOINT-INDICATOR         PIC X.
  5948                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5949
  5950*            20  FILLER                     PIC X(12).
  5951             20  cf-maximum-benefits        pic s999 comp-3.
  5952             20  FILLER                     PIC X(09).
  5953             20  CF-BENEFIT-CATEGORY        PIC X.
  5954             20  CF-LOAN-TYPE               PIC X(8).
  5955
  5956             20  CF-CO-REM-TERM-CALC        PIC X.
  5957                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5958                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5959                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5960                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5961                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5962
  5963             20  CF-CO-EARNINGS-CALC        PIC X.
  5964                 88  CO-EARN-BY-R78             VALUE '1'.
  5965                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5966                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5967                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5968                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5969                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5970                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5971                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5972
  5973             20  CF-CO-REFUND-CALC          PIC X.
  5974                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5975                 88  CO-REFD-BY-R78             VALUE '1'.
  5976                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5977                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5978                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5979                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5980                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5981                 88  CO-REFD-MEAN               VALUE '8'.
  5982                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5983                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5984                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5985
  5986             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5987                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5988                 88  CO-OVRD-BY-R78             VALUE '1'.
  5989                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5990                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5991                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5992                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5993                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5994                 88  CO-OVRD-MEAN               VALUE '8'.
  5995                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5996
  5997             20  CF-CO-BEN-I-G-CD           PIC X.
  5998                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 111
* EL050.cbl
  5999                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  6000                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  6001
  6002         16  FILLER                         PIC X(304).
  6003
  6004
  6005****************************************************************
  6006*             CARRIER MASTER RECORD                            *
  6007****************************************************************
  6008
  6009     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6010         16  CF-ADDRESS-DATA.
  6011             20  CF-MAIL-TO-NAME            PIC X(30).
  6012             20  CF-IN-CARE-OF              PIC X(30).
  6013             20  CF-ADDRESS-LINE-1          PIC X(30).
  6014             20  CF-ADDRESS-LINE-2          PIC X(30).
  6015             20  CF-CITY-STATE              PIC X(30).
  6016             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  6017             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  6018
  6019         16  CF-CLAIM-NO-CONTROL.
  6020             20  CF-CLAIM-NO-METHOD         PIC X.
  6021                 88  CLAIM-NO-MANUAL            VALUE '1'.
  6022                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  6023                 88  CLAIM-NO-SEQ               VALUE '3'.
  6024                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  6025             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  6026                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  6027                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  6028                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  6029
  6030         16  CF-CHECK-NO-CONTROL.
  6031             20  CF-CHECK-NO-METHOD         PIC X.
  6032                 88  CHECK-NO-MANUAL            VALUE '1'.
  6033                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  6034                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  6035                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  6036             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  6037                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  6038
  6039         16  CF-DOMICILE-STATE              PIC XX.
  6040
  6041         16  CF-EXPENSE-CONTROLS.
  6042             20  CF-EXPENSE-METHOD          PIC X.
  6043                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  6044                 88  DOLLARS-PER-PMT            VALUE '2'.
  6045                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  6046                 88  DOLLARS-PER-MONTH          VALUE '4'.
  6047             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  6048             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  6049
  6050         16  CF-CORRESPONDENCE-CONTROL.
  6051             20  CF-LETTER-RESEND-OPT       PIC X.
  6052                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  6053                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  6054             20  FILLER                     PIC X(4).
  6055
  6056         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 112
* EL050.cbl
  6057             20  CF-MANUAL-SW               PIC X.
  6058                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  6059             20  CF-FUTURE-SW               PIC X.
  6060                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  6061             20  CF-PTC-SW                  PIC X.
  6062                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  6063             20  CF-IBNR-SW                 PIC X.
  6064                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  6065             20  CF-PTC-LF-SW               PIC X.
  6066                 88  CF-LF-PTC-USED             VALUE '1'.
  6067             20  CF-CDT-ACCESS-METHOD       PIC X.
  6068                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  6069                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  6070                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  6071             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  6072
  6073         16  CF-CLAIM-CALC-METHOD           PIC X.
  6074             88  360-PLUS-MONTHS                VALUE '1'.
  6075             88  365-PLUS-MONTHS                VALUE '2'.
  6076             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6077             88  360-DAILY                      VALUE '4'.
  6078             88  365-DAILY                      VALUE '5'.
  6079
  6080         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6081         16  FILLER                         PIC X(11).
  6082
  6083         16  CF-LIMIT-AMOUNTS.
  6084             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6085             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6086             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6087             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6088             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6089             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6090             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6091             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6092             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6093             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6094
  6095         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6096         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6097         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6098
  6099         16  CF-ZIP-CODE.
  6100             20  CF-ZIP-PRIME.
  6101                 24  CF-ZIP-1ST             PIC X.
  6102                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6103                 24  FILLER                 PIC X(4).
  6104             20  CF-ZIP-PLUS4               PIC X(4).
  6105         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6106             20  CF-CAN-POSTAL-1            PIC XXX.
  6107             20  CF-CAN-POSTAL-2            PIC XXX.
  6108             20  FILLER                     PIC XXX.
  6109
  6110         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6111         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6112         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6113
  6114         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 113
* EL050.cbl
  6115             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6116             88  CF-NO-RATING                   VALUE 'N'.
  6117
  6118         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6119
  6120         16  CF-CARRIER-OVER-SHORT.
  6121             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6122             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6123
  6124         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6125         16  CF-SECPAY-SWITCH               PIC X.
  6126             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6127             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6128         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6129         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6130         16  FILLER                         PIC X(444).
  6131*        16  FILLER                         PIC X(452).
  6132
  6133
  6134****************************************************************
  6135*             MORTALITY MASTER RECORD                          *
  6136****************************************************************
  6137
  6138     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6139         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6140                                INDEXED BY CF-MORT-NDX.
  6141             20  CF-MORT-TABLE              PIC X(5).
  6142             20  CF-MORT-TABLE-TYPE         PIC X.
  6143                 88  CF-MORT-JOINT              VALUE 'J'.
  6144                 88  CF-MORT-SINGLE             VALUE 'S'.
  6145                 88  CF-MORT-COMBINED           VALUE 'C'.
  6146                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6147                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6148             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6149             20  CF-MORT-AGE-METHOD         PIC XX.
  6150                 88  CF-AGE-LAST                VALUE 'AL'.
  6151                 88  CF-AGE-NEAR                VALUE 'AN'.
  6152             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6153             20  CF-MORT-ADJUSTMENT-DIRECTION
  6154                                            PIC X.
  6155                 88  CF-MINUS                   VALUE '-'.
  6156                 88  CF-PLUS                    VALUE '+'.
  6157             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6158             20  CF-MORT-JOINT-CODE         PIC X.
  6159                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6160             20  CF-MORT-PC-Q               PIC X.
  6161                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6162             20  CF-MORT-TABLE-CODE         PIC X(4).
  6163             20  CF-MORT-COMMENTS           PIC X(15).
  6164             20  FILLER                     PIC X(14).
  6165
  6166         16  FILLER                         PIC X(251).
  6167
  6168
  6169****************************************************************
  6170*             BUSSINESS TYPE MASTER RECORD                     *
  6171****************************************************************
  6172
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 114
* EL050.cbl
  6173     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6174* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6175* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6176* AND RECORD 05 IS TYPES 81-99
  6177         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6178             20  CF-BUSINESS-TITLE          PIC  X(19).
  6179             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6180                                            PIC S9V9(4) COMP-3.
  6181             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6182             20  FILLER                     PIC  X.
  6183         16  FILLER                         PIC  X(248).
  6184
  6185
  6186****************************************************************
  6187*             TERMINAL MASTER RECORD                           *
  6188****************************************************************
  6189
  6190     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6191
  6192         16  CF-COMPANY-TERMINALS.
  6193             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6194                                  PIC X(4).
  6195         16  FILLER               PIC X(248).
  6196
  6197
  6198****************************************************************
  6199*             LIFE EDIT MASTER RECORD                          *
  6200****************************************************************
  6201
  6202     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6203         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6204             20  CF-LIFE-CODE-IN            PIC XX.
  6205             20  CF-LIFE-CODE-OUT           PIC XX.
  6206         16  FILLER                         PIC X(248).
  6207
  6208
  6209****************************************************************
  6210*             AH EDIT MASTER RECORD                            *
  6211****************************************************************
  6212
  6213     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6214         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6215             20  CF-AH-CODE-IN              PIC XXX.
  6216             20  CF-AH-CODE-OUT             PIC XX.
  6217         16  FILLER                         PIC X(248).
  6218
  6219
  6220****************************************************************
  6221*             CREDIBILITY TABLES                               *
  6222****************************************************************
  6223
  6224     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6225         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6226                             INDEXED BY CF-CRDB-NDX.
  6227             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6228             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6229             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6230         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 115
* EL050.cbl
  6231
  6232
  6233****************************************************************
  6234*             REPORT CUSTOMIZATION RECORD                      *
  6235****************************************************************
  6236
  6237     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6238         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6239             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6240             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6241             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6242**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6243****       A T-TRANSFER.                                   ****
  6244             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6245
  6246         16  FILLER                         PIC XX.
  6247
  6248         16  CF-CARRIER-CNTL-OPT.
  6249             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6250                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6251                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6252             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6253                                            PIC X.
  6254         16  CF-GROUP-CNTL-OPT.
  6255             20  CF-GROUP-OPT-SEQ           PIC 9.
  6256                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6257                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6258             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6259                                            PIC X(6).
  6260         16  CF-STATE-CNTL-OPT.
  6261             20  CF-STATE-OPT-SEQ           PIC 9.
  6262                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6263                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6264             20  CF-STATE-SELECT OCCURS 3 TIMES
  6265                                            PIC XX.
  6266         16  CF-ACCOUNT-CNTL-OPT.
  6267             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6268                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6269                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6270             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6271                                            PIC X(10).
  6272         16  CF-BUS-TYP-CNTL-OPT.
  6273             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6274                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6275                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6276             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6277                                            PIC XX.
  6278         16  CF-LF-TYP-CNTL-OPT.
  6279             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6280                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6281                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6282             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6283                                            PIC XX.
  6284         16  CF-AH-TYP-CNTL-OPT.
  6285             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6286                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6287                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6288             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 116
* EL050.cbl
  6289                                            PIC XX.
  6290         16  CF-REPTCD1-CNTL-OPT.
  6291             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6292                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6293                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6294             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6295                                            PIC X(10).
  6296         16  CF-REPTCD2-CNTL-OPT.
  6297             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6298                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6299                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6300             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6301                                            PIC X(10).
  6302         16  CF-USER1-CNTL-OPT.
  6303             20  CF-USER1-OPT-SEQ           PIC 9.
  6304                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6305                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6306             20  CF-USER1-SELECT OCCURS 3 TIMES
  6307                                            PIC X(10).
  6308         16  CF-USER2-CNTL-OPT.
  6309             20  CF-USER2-OPT-SEQ           PIC 9.
  6310                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6311                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6312             20  CF-USER2-SELECT OCCURS 3 TIMES
  6313                                            PIC X(10).
  6314         16  CF-USER3-CNTL-OPT.
  6315             20  CF-USER3-OPT-SEQ           PIC 9.
  6316                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6317                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6318             20  CF-USER3-SELECT OCCURS 3 TIMES
  6319                                            PIC X(10).
  6320         16  CF-USER4-CNTL-OPT.
  6321             20  CF-USER4-OPT-SEQ           PIC 9.
  6322                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6323                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6324             20  CF-USER4-SELECT OCCURS 3 TIMES
  6325                                            PIC X(10).
  6326         16  CF-USER5-CNTL-OPT.
  6327             20  CF-USER5-OPT-SEQ           PIC 9.
  6328                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6329                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6330             20  CF-USER5-SELECT OCCURS 3 TIMES
  6331                                            PIC X(10).
  6332         16  CF-REINS-CNTL-OPT.
  6333             20  CF-REINS-OPT-SEQ           PIC 9.
  6334                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6335                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6336             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6337                 24  CF-REINS-PRIME         PIC XXX.
  6338                 24  CF-REINS-SUB           PIC XXX.
  6339
  6340         16  CF-AGENT-CNTL-OPT.
  6341             20  CF-AGENT-OPT-SEQ           PIC 9.
  6342                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6343                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6344             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6345                                            PIC X(10).
  6346
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 117
* EL050.cbl
  6347         16  FILLER                         PIC X(43).
  6348
  6349         16  CF-LOSS-RATIO-SELECT.
  6350             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6351             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6352         16  CF-ENTRY-DATE-SELECT.
  6353             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6354             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6355         16  CF-EFFECTIVE-DATE-SELECT.
  6356             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6357             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6358
  6359         16  CF-EXCEPTION-LIST-IND          PIC X.
  6360             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6361
  6362         16  FILLER                         PIC X(318).
  6363
  6364****************************************************************
  6365*                  EXCEPTION REPORTING RECORD                  *
  6366****************************************************************
  6367
  6368     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6369         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6370             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6371
  6372         16  CF-COMBINED-LIFE-AH-OPT.
  6373             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6374             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6375             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6376             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6377
  6378         16  CF-LIFE-OPT.
  6379             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6380             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6381             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6382             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6383             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6384             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6385             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6386             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6387             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6388             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6389
  6390         16  CF-AH-OPT.
  6391             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6392             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6393             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6394             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6395             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6396             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6397             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6398             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6399             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6400             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6401
  6402         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6403             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6404             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 118
* EL050.cbl
  6405             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6406
  6407         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6408
  6409         16  FILLER                         PIC X(673).
  6410
  6411
  6412****************************************************************
  6413*             MORTGAGE SYSTEM PLAN RECORD                      *
  6414****************************************************************
  6415
  6416     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6417         16  CF-PLAN-TYPE                   PIC X.
  6418             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6419             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6420             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6421         16  CF-PLAN-ABBREV                 PIC XXX.
  6422         16  CF-PLAN-DESCRIPT               PIC X(10).
  6423         16  CF-PLAN-NOTES                  PIC X(20).
  6424         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6425         16  CF-PLAN-UNDERWRITING.
  6426             20  CF-PLAN-TERM-DATA.
  6427                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6428                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6429             20  CF-PLAN-AGE-DATA.
  6430                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6431                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6432                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6433             20  CF-PLAN-BENEFIT-DATA.
  6434                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6435                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6436                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6437                                            PIC S9(7)V99  COMP-3.
  6438         16  CF-PLAN-POLICY-FORMS.
  6439             20  CF-POLICY-FORM             PIC X(12).
  6440             20  CF-MASTER-APPLICATION      PIC X(12).
  6441             20  CF-MASTER-POLICY           PIC X(12).
  6442         16  CF-PLAN-RATING.
  6443             20  CF-RATE-CODE               PIC X(5).
  6444             20  CF-SEX-RATING              PIC X.
  6445                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6446                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6447             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6448             20  CF-SUB-STD-TYPE            PIC X.
  6449                 88  CF-PCT-OF-PREM            VALUE '1'.
  6450                 88  CF-PCT-OF-BENE            VALUE '2'.
  6451         16  CF-PLAN-PREM-TOLERANCES.
  6452             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6453             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6454         16  CF-PLAN-PYMT-TOLERANCES.
  6455             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6456             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6457         16  CF-PLAN-MISC-DATA.
  6458             20  FILLER                     PIC X.
  6459             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6460             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6461         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6462         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 119
* EL050.cbl
  6463             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6464                                                     '1'.
  6465             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6466                                                     '2'.
  6467         16  CF-MIB-SEARCH-SW               PIC X.
  6468             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6469             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6470             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6471             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6472         16  CF-ALPHA-SEARCH-SW             PIC X.
  6473             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6474             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6475             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6476             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6477             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6478             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6479             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6480             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6481             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6482             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6483                                                     'A' 'B' 'C'
  6484                                                     'X' 'Y' 'Z'.
  6485         16  CF-EFF-DT-RULE-SW              PIC X.
  6486             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6487             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6488             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6489             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6490             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6491         16  FILLER                         PIC X(4).
  6492         16  CF-HEALTH-QUESTIONS            PIC X.
  6493             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6494         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6495         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6496         16  CF-PLAN-SNGL-JNT               PIC X.
  6497             88  CF-COMBINED-PLAN              VALUE 'C'.
  6498             88  CF-JNT-PLAN                   VALUE 'J'.
  6499             88  CF-SNGL-PLAN                  VALUE 'S'.
  6500         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6501         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6502         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6503         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6504         16  CF-RERATE-CNTL                 PIC  X.
  6505             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6506             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6507             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6508             88  CF-AUTO-RECALC                 VALUE '4'.
  6509         16  CF-BENEFIT-TYPE                PIC  X.
  6510             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6511             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6512         16  CF-POLICY-FEE                  PIC S999V99
  6513                                                    COMP-3.
  6514         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6515         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6516         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6517         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6518         16  FILLER                         PIC  X(32).
  6519         16  CF-TERMINATION-FORM            PIC  X(04).
  6520         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 120
* EL050.cbl
  6521         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6522                                                       COMP-3.
  6523         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6524         16  CF-ISSUE-LETTER                PIC  X(4).
  6525         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6526         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6527             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6528             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6529         16  CF-MP-REFUND-CALC              PIC X.
  6530             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6531             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6532             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6533             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6534             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6535             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6536             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6537             88  CF-MP-REFD-MEAN                VALUE '8'.
  6538         16  CF-ALT-RATE-CODE               PIC  X(5).
  6539
  6540
  6541         16  FILLER                         PIC X(498).
  6542****************************************************************
  6543*             MORTGAGE COMPANY MASTER RECORD                   *
  6544****************************************************************
  6545
  6546     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6547         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6548         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6549             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6550             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6551             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6552             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6553             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6554
  6555         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6556         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6557         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6558         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6559         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6560
  6561         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6562             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6563         16  CF-MP-RECON-USE-IND            PIC X(1).
  6564             88  CF-MP-USE-RECON             VALUE 'Y'.
  6565         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6566             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6567         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6568             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6569             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6570         16  FILLER                         PIC X(1).
  6571         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6572             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6573         16  CF-MORTG-MIB-VERSION           PIC X.
  6574             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6575             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6576             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6577         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6578             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 121
* EL050.cbl
  6579                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6580             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6581                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6582             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6583                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6584             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6585                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6586             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6587                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6588             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6589                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6590         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6591         16  FILLER                         PIC X(7).
  6592         16  CF-MORTG-DESTINATION-SYMBOL.
  6593             20  CF-MORTG-MIB-COMM          PIC X(5).
  6594             20  CF-MORTG-MIB-TERM          PIC X(5).
  6595         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6596             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6597         16  FILLER                         PIC X(03).
  6598         16  CF-MP-CHECK-NO-CONTROL.
  6599             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6600                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6601                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6602                                                ' ' LOW-VALUES.
  6603                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6604                                               VALUE '3'.
  6605         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6606         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6607         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6608             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6609                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6610             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6611                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6612             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6613                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6614             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6615                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6616             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6617                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6618             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6619                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6620         16  CF-MORTG-BILLING-AREA.
  6621             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6622                                            PIC X.
  6623         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6624         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6625         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6626         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6627             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6628             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6629         16  FILLER                         PIC X.
  6630         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6631             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6632             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6633         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6634         16  FILLER                         PIC X(8).
  6635         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6636         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 122
* EL050.cbl
  6637         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6638         16  CF-ACH-COMPANY-ID.
  6639             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6640                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6641                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6642                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6643             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6644         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6645             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6646         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6647             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6648             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6649         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6650         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6651         16  FILLER                         PIC X(536).
  6652
  6653****************************************************************
  6654*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6655****************************************************************
  6656
  6657     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6658         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6659             20  CF-FEMALE-HEIGHT.
  6660                 24  CF-FEMALE-FT           PIC 99.
  6661                 24  CF-FEMALE-IN           PIC 99.
  6662             20  CF-FEMALE-MIN-WT           PIC 999.
  6663             20  CF-FEMALE-MAX-WT           PIC 999.
  6664         16  FILLER                         PIC X(428).
  6665
  6666     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6667         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6668             20  CF-MALE-HEIGHT.
  6669                 24  CF-MALE-FT             PIC 99.
  6670                 24  CF-MALE-IN             PIC 99.
  6671             20  CF-MALE-MIN-WT             PIC 999.
  6672             20  CF-MALE-MAX-WT             PIC 999.
  6673         16  FILLER                         PIC X(428).
  6674******************************************************************
  6675*             AUTOMATIC ACTIVITY RECORD                          *
  6676******************************************************************
  6677     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6678         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6679             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6680             20  CF-SYS-LETTER-ID           PIC X(04).
  6681             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6682             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6683             20  CF-SYS-RESET-SW            PIC X(01).
  6684             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6685             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6686
  6687         16  FILLER                         PIC X(50).
  6688
  6689         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6690             20  CF-USER-ACTIVE-SW          PIC X(01).
  6691             20  CF-USER-LETTER-ID          PIC X(04).
  6692             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6693             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6694             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 123
* EL050.cbl
  6695             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6696             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6697             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6698
  6699         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 124
* EL050.cbl
  6701*    COPY ERCACCT.
  6702******************************************************************
  6703*                                                                *
  6704*                                                                *
  6705*                            ERCACCT                             *
  6706*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6707*                            VMOD=2.031                          *
  6708*                                                                *
  6709*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6710*                                                                *
  6711*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6712*   VSAM ACCOUNT MASTER FILES.                                   *
  6713*                                                                *
  6714*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6715*                                                                *
  6716*   FILE TYPE = VSAM,KSDS                                        *
  6717*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6718*                                                                *
  6719*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6720*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6721*                                                                *
  6722*   LOG = NO                                                     *
  6723*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6724*                                                                *
  6725*                                                                *
  6726******************************************************************
  6727*                   C H A N G E   L O G
  6728*
  6729* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6730*-----------------------------------------------------------------
  6731*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6732* EFFECTIVE    NUMBER
  6733*-----------------------------------------------------------------
  6734* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6735* 092705    2005050300006  PEMA  ADD SPP LEASES
  6736* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6737* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6738* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6739* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6740* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6741* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6742******************************************************************
  6743
  6744 01  ACCOUNT-MASTER.
  6745     12  AM-RECORD-ID                      PIC XX.
  6746         88  VALID-AM-ID                      VALUE 'AM'.
  6747
  6748     12  AM-CONTROL-PRIMARY.
  6749         16  AM-COMPANY-CD                 PIC X.
  6750         16  AM-MSTR-CNTRL.
  6751             20  AM-CONTROL-A.
  6752                 24  AM-CARRIER            PIC X.
  6753                 24  AM-GROUPING.
  6754                     28 AM-GROUPING-PREFIX PIC XXX.
  6755                     28 AM-GROUPING-PRIME  PIC XXX.
  6756                 24  AM-STATE              PIC XX.
  6757                 24  AM-ACCOUNT.
  6758                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 125
* EL050.cbl
  6759                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6760             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6761                                           PIC X(19).
  6762             20  AM-CNTRL-B.
  6763                 24  AM-EXPIRATION-DT      PIC XX.
  6764                 24  FILLER                PIC X(4).
  6765             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6766                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6767
  6768     12  AM-CONTROL-BY-VAR-GRP.
  6769         16  AM-COMPANY-CD-A1              PIC X.
  6770         16  AM-VG-CARRIER                 PIC X.
  6771         16  AM-VG-GROUPING                PIC X(6).
  6772         16  AM-VG-STATE                   PIC XX.
  6773         16  AM-VG-ACCOUNT                 PIC X(10).
  6774         16  AM-VG-DATE.
  6775             20  AM-VG-EXPIRATION-DT       PIC XX.
  6776             20  FILLER                    PIC X(4).
  6777         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6778                                           PIC 9(11)      COMP-3.
  6779     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6780         16  FILLER                        PIC X(10).
  6781         16  AM-VG-KEY3.
  6782             20  AM-VG3-ACCOUNT            PIC X(10).
  6783             20  AM-VG3-EXP-DT             PIC XX.
  6784         16  FILLER                        PIC X(4).
  6785     12  AM-MAINT-INFORMATION.
  6786         16  AM-LAST-MAINT-DT              PIC XX.
  6787         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6788         16  AM-LAST-MAINT-USER            PIC X(4).
  6789         16  FILLER                        PIC XX.
  6790
  6791     12  AM-EFFECTIVE-DT                   PIC XX.
  6792     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6793
  6794     12  AM-PREV-DATES  COMP-3.
  6795         16  AM-PREV-EXP-DT                PIC 9(11).
  6796         16  AM-PREV-EFF-DT                PIC 9(11).
  6797
  6798     12  AM-REPORT-CODE-1                  PIC X(10).
  6799     12  AM-REPORT-CODE-2                  PIC X(10).
  6800
  6801     12  AM-CITY-CODE                      PIC X(4).
  6802     12  AM-COUNTY-PARISH                  PIC X(6).
  6803
  6804     12  AM-NAME                           PIC X(30).
  6805     12  AM-PERSON                         PIC X(30).
  6806     12  AM-ADDRS                          PIC X(30).
  6807     12  AM-CITY.
  6808         16  AM-ADDR-CITY                  PIC X(28).
  6809         16  AM-ADDR-STATE                 PIC XX.
  6810     12  AM-ZIP.
  6811         16  AM-ZIP-PRIME.
  6812             20  AM-ZIP-PRI-1ST            PIC X.
  6813                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6814             20  FILLER                    PIC X(4).
  6815         16  AM-ZIP-PLUS4                  PIC X(4).
  6816     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 126
* EL050.cbl
  6817         16  AM-CAN-POSTAL-1               PIC XXX.
  6818         16  AM-CAN-POSTAL-2               PIC XXX.
  6819         16  FILLER                        PIC XXX.
  6820     12  AM-TEL-NO.
  6821         16  AM-AREA-CODE                  PIC 999.
  6822         16  AM-TEL-PRE                    PIC 999.
  6823         16  AM-TEL-NBR                    PIC 9(4).
  6824     12  AM-TEL-LOC                        PIC X.
  6825         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6826         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6827
  6828     12  AM-COMM-STRUCTURE.
  6829         16  AM-DEFN-1.
  6830             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6831                 24  AM-AGT.
  6832                     28  AM-AGT-PREFIX     PIC X(4).
  6833                     28  AM-AGT-PRIME      PIC X(6).
  6834                 24  AM-COM-TYP            PIC X.
  6835                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6836                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6837                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6838                 24  AM-RECALC-LV-INDIC    PIC X.
  6839                 24  AM-RETRO-LV-INDIC     PIC X.
  6840                 24  AM-GL-CODES           PIC X.
  6841                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6842                 24  FILLER                PIC X(01).
  6843         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6844             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6845                 24  FILLER                PIC X(11).
  6846                 24  AM-L-COMA             PIC XXX.
  6847                 24  AM-J-COMA             PIC XXX.
  6848                 24  AM-A-COMA             PIC XXX.
  6849                 24  FILLER                PIC X(6).
  6850
  6851     12  AM-COMM-CHANGE-STATUS             PIC X.
  6852         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6853
  6854     12  AM-CSR-CODE                       PIC X(4).
  6855
  6856     12  AM-BILLING-STATUS                 PIC X.
  6857         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6858         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6859     12  AM-AUTO-REFUND-SW                 PIC X.
  6860         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6861         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6862     12  AM-GPCD                           PIC 99.
  6863     12  AM-IG                             PIC X.
  6864         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6865         88  AM-HAS-GROUP                     VALUE '2'.
  6866     12  AM-STATUS                         PIC X.
  6867         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6868         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6869         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6870         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6871         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6872         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6873         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6874         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 127
* EL050.cbl
  6875         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6876         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6877     12  AM-REMIT-TO                       PIC 99.
  6878     12  AM-ID-NO                          PIC X(11).
  6879
  6880     12  AM-CAL-TABLE                      PIC XX.
  6881     12  AM-LF-DEVIATION                   PIC XXX.
  6882     12  AM-AH-DEVIATION                   PIC XXX.
  6883     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6884     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6885     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6886     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6887     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6888     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6889
  6890     12  AM-USER-FIELDS.
  6891         16  AM-FLD-1                      PIC XX.
  6892         16  AM-FLD-2                      PIC XX.
  6893         16  AM-FLD-3                      PIC XX.
  6894         16  AM-FLD-4                      PIC XX.
  6895         16  AM-FLD-5                      PIC XX.
  6896
  6897     12  AM-1ST-PROD-DATE.
  6898         16  AM-1ST-PROD-YR                PIC XX.
  6899         16  AM-1ST-PROD-MO                PIC XX.
  6900         16  AM-1ST-PROD-DA                PIC XX.
  6901     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6902     12  AM-CERTS-PURGED-DATE.
  6903         16  AM-PUR-YR                     PIC XX.
  6904         16  AM-PUR-MO                     PIC XX.
  6905         16  AM-PUR-DA                     PIC XX.
  6906     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6907     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6908     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6909     12  AM-INACTIVE-DATE.
  6910         16  AM-INA-MO                     PIC 99.
  6911         16  AM-INA-DA                     PIC 99.
  6912         16  AM-INA-YR                     PIC 99.
  6913     12  AM-AR-HI-CERT-DATE                PIC XX.
  6914
  6915     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6916     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6917
  6918     12  AM-OB-PAYMENT-MODE                PIC X.
  6919         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6920         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6921         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6922         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6923
  6924     12  AM-AH-ONLY-INDICATOR              PIC X.
  6925         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6926         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6927
  6928     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6929
  6930     12  AM-OVER-SHORT.
  6931         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6932         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 128
* EL050.cbl
  6933
  6934     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6935     12  AM-DCC-CLP-STATE                  PIC XX.
  6936
  6937     12  AM-RECALC-COMM                    PIC X.
  6938     12  AM-RECALC-REIN                    PIC X.
  6939
  6940     12  AM-REI-TABLE                      PIC XXX.
  6941     12  AM-REI-ET-LF                      PIC X.
  6942     12  AM-REI-ET-AH                      PIC X.
  6943     12  AM-REI-PE-LF                      PIC X.
  6944     12  AM-REI-PE-AH                      PIC X.
  6945     12  AM-REI-PRT-ST                     PIC X.
  6946     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6947     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6948     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6949     12  AM-REI-GROUP-A                    PIC X(6).
  6950     12  AM-REI-MORT                       PIC X(4).
  6951     12  AM-REI-PRT-OW                     PIC X.
  6952     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6953     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6954     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6955     12  AM-REI-GROUP-B                    PIC X(6).
  6956
  6957     12  AM-TRUST-TYPE                     PIC X(2).
  6958
  6959     12  AM-EMPLOYER-STMT-USED             PIC X.
  6960     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6961
  6962     12  AM-STD-AH-TYPE                    PIC XX.
  6963     12  AM-EARN-METHODS.
  6964         16  AM-EARN-METHOD-R              PIC X.
  6965             88 AM-REF-RL-R78                 VALUE 'R'.
  6966             88 AM-REF-RL-PR                  VALUE 'P'.
  6967             88 AM-REF-RL-MEAN                VALUE 'M'.
  6968             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6969         16  AM-EARN-METHOD-L              PIC X.
  6970             88 AM-REF-LL-R78                 VALUE 'R'.
  6971             88 AM-REF-LL-PR                  VALUE 'P'.
  6972             88 AM-REF-LL-MEAN                VALUE 'M'.
  6973             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6974         16  AM-EARN-METHOD-A              PIC X.
  6975             88 AM-REF-AH-R78                 VALUE 'R'.
  6976             88 AM-REF-AH-PR                  VALUE 'P'.
  6977             88 AM-REF-AH-MEAN                VALUE 'M'.
  6978             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6979             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6980             88 AM-REF-AH-NET                 VALUE 'N'.
  6981
  6982     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6983     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6984     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6985
  6986     12  AM-RET-Y-N                        PIC X.
  6987     12  AM-RET-P-E                        PIC X.
  6988     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6989     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6990     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 129
* EL050.cbl
  6991     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6992         16  AM-POOL-PRIME                 PIC XXX.
  6993         16  AM-POOL-SUB                   PIC XXX.
  6994     12  AM-RETRO-EARNINGS.
  6995         16  AM-RET-EARN-R                 PIC X.
  6996         16  AM-RET-EARN-L                 PIC X.
  6997         16  AM-RET-EARN-A                 PIC X.
  6998     12  AM-RET-ST-TAX-USE                 PIC X.
  6999         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  7000         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  7001     12  AM-RETRO-BEG-EARNINGS.
  7002         16  AM-RET-BEG-EARN-R             PIC X.
  7003         16  AM-RET-BEG-EARN-L             PIC X.
  7004         16  AM-RET-BEG-EARN-A             PIC X.
  7005     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  7006     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  7007
  7008     12  AM-USER-SELECT-OPTIONS.
  7009         16  AM-USER-SELECT-1              PIC X(10).
  7010         16  AM-USER-SELECT-2              PIC X(10).
  7011         16  AM-USER-SELECT-3              PIC X(10).
  7012         16  AM-USER-SELECT-4              PIC X(10).
  7013         16  AM-USER-SELECT-5              PIC X(10).
  7014
  7015     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  7016
  7017     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  7018
  7019     12  AM-RPT045A-SWITCH                 PIC X.
  7020         88  RPT045A-OFF                   VALUE 'N'.
  7021
  7022     12  AM-INSURANCE-LIMITS.
  7023         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  7024         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  7025
  7026     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  7027         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  7028
  7029     12  AM-DISMBR-COVERAGE-SW             PIC X.
  7030         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  7031         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  7032
  7033     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  7034
  7035     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  7036     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  7037     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  7038     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  7039     12  AM-DCC-UEF-STATE                  PIC XX.
  7040     12  FILLER                            PIC XXX.
  7041     12  AM-REPORT-CODE-3                  PIC X(10).
  7042*    12  FILLER                            PIC X(22).
  7043
  7044     12  AM-RESERVE-DATE.
  7045         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  7046         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  7047         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  7048
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 130
* EL050.cbl
  7049     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  7050     12  AM-NOTIFICATION-TYPES.
  7051         16  AM-NOTIF-OF-LETTERS           PIC X.
  7052         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  7053         16  AM-NOTIF-OF-REPORTS           PIC X.
  7054         16  AM-NOTIF-OF-STATUS            PIC X.
  7055
  7056     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  7057         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  7058         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  7059         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  7060         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  7061
  7062     12  AM-BENEFIT-CONTROLS.
  7063         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  7064             20  AM-BENEFIT-CODE           PIC XX.
  7065             20  AM-BENEFIT-TYPE           PIC X.
  7066             20  AM-BENEFIT-REVISION       PIC XXX.
  7067             20  AM-BENEFIT-REM-TERM       PIC X.
  7068             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  7069             20  FILLER                    PIC XX.
  7070         16  FILLER                        PIC X(80).
  7071
  7072     12  AM-TRANSFER-DATA.
  7073         16  AM-TRANSFERRED-FROM.
  7074             20  AM-TRNFROM-CARRIER        PIC X.
  7075             20  AM-TRNFROM-GROUPING.
  7076                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  7077                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  7078             20  AM-TRNFROM-STATE          PIC XX.
  7079             20  AM-TRNFROM-ACCOUNT.
  7080                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  7081                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  7082             20  AM-TRNFROM-DTE            PIC XX.
  7083         16  AM-TRANSFERRED-TO.
  7084             20  AM-TRNTO-CARRIER          PIC X.
  7085             20  AM-TRNTO-GROUPING.
  7086                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  7087                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7088             20  AM-TRNTO-STATE            PIC XX.
  7089             20  AM-TRNTO-ACCOUNT.
  7090                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7091                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7092             20  AM-TRNTO-DTE              PIC XX.
  7093         16  FILLER                        PIC X(10).
  7094
  7095     12  AM-SAVED-REMIT-TO                 PIC 99.
  7096
  7097     12  AM-COMM-STRUCTURE-SAVED.
  7098         16  AM-DEFN-1-SAVED.
  7099             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7100                 24  AM-AGT-SV             PIC X(10).
  7101                 24  AM-COM-TYP-SV         PIC X.
  7102                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7103                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7104                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7105                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7106                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 131
* EL050.cbl
  7107                 24  AM-GL-CODES-SV        PIC X.
  7108                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7109                 24  FILLER                PIC X.
  7110         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7111             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7112                 24  FILLER                PIC X(11).
  7113                 24  AM-L-COMA-SV          PIC XXX.
  7114                 24  AM-J-COMA-SV          PIC XXX.
  7115                 24  AM-A-COMA-SV          PIC XXX.
  7116                 24  FILLER                PIC X(6).
  7117
  7118     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7119         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7120            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7121            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7122            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7123
  7124     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7125     12  FILLER                            PIC X(120).
  7126
  7127     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7128         16  AM-CONTROL-NAME               PIC X(30).
  7129         16  AM-EXECUTIVE-ONE.
  7130             20  AM-EXEC1-NAME             PIC X(15).
  7131             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7132                                                          COMP-3.
  7133             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7134                                                          COMP-3.
  7135         16  AM-EXECUTIVE-TWO.
  7136             20  AM-EXEC2-NAME             PIC X(15).
  7137             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7138                                                          COMP-3.
  7139             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7140                                                          COMP-3.
  7141
  7142     12  AM-RETRO-ADDITIONAL-DATA.
  7143         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7144         16  AM-RETRO-PREM-P-E             PIC X.
  7145         16  AM-RETRO-CLMS-P-I             PIC X.
  7146         16  AM-RETRO-RET-BRACKET-LF.
  7147             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7148                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7149                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7150             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7151                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7152                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7153             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7154                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7155                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7156         16  AM-RETRO-RET-BRACKET-AH.
  7157             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7158                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7159                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7160                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7161             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7162                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7163                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7164             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 132
* EL050.cbl
  7165                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7166                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7167
  7168     12  AM-COMMENTS.
  7169         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7170
  7171     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7172         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7173         16  AM-FLI-BILLING-CODE           PIC X.
  7174         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7175         16  AM-FLI-UNITED-IDENT           PIC X.
  7176         16  AM-FLI-INTEREST-LOST-DATA.
  7177             20  AM-FLI-BANK-NO            PIC X(5).
  7178             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7179             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7180             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7181         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7182             20  AM-FLI-AGT                PIC X(9).
  7183             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7184             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7185         16  FILLER                        PIC X(102).
  7186
  7187     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7188         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7189             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7190             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7191             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7192             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7193             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7194         16  FILLER                          PIC X(10).
  7195******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 133
* EL050.cbl
  7197*    COPY ERCREIN.
  7198******************************************************************
  7199*                                                                *
  7200*                            ERCREIN                             *
  7201*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7202*                            VMOD=2.010                          *
  7203*                                                                *
  7204*   ONLINE CREDIT SYSTEM                                         *
  7205*                                                                *
  7206*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7207*                                                                *
  7208*   FILE TYPE = VSAM,KSDS                                        *
  7209*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7210*                                                                *
  7211*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7212*       ALTERNATE PATH = NONE                                    *
  7213*                                                                *
  7214*   LOG = NO                                                     *
  7215*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7216*                                                                *
  7217******************************************************************
  7218*                   C H A N G E   L O G
  7219*
  7220* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7221*-----------------------------------------------------------------
  7222*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7223* EFFECTIVE    NUMBER
  7224*-----------------------------------------------------------------
  7225* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7226* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7227******************************************************************
  7228 01  REINSURANCE-RECORD.
  7229     12  RE-RECORD-ID                      PIC XX.
  7230         88  VALID-RE-ID                      VALUE 'RE'.
  7231
  7232     12  RE-CONTROL-PRIMARY.
  7233         16  RE-COMPANY-CD                 PIC X.
  7234         16  RE-KEY.
  7235             20  RE-CODE                   PIC X.
  7236                 88  RE-TABLE-RECORD          VALUE 'A'.
  7237                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7238             20  RE-TABLE                  PIC XXX.
  7239             20  FILLER                    PIC XXX.
  7240         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7241             20  FILLER                    PIC X.
  7242             20  RE-COMPANY.
  7243                 24  RE-COMP-PRIME         PIC XXX.
  7244                 24  RE-COMP-SUB           PIC XXX.
  7245
  7246     12  RE-MAINT-INFORMATION.
  7247         16  RE-LAST-MAINT-DT              PIC XX.
  7248         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7249         16  RE-LAST-MAINT-USER            PIC X(4).
  7250         16  FILLER                        PIC X(10).
  7251
  7252     12  RE-TABLE-DATA.
  7253         16  RE-100-COMP                   PIC 99.
  7254
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 134
* EL050.cbl
  7255         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7256             20  RE-REI-COMP-NO.
  7257                 24  RE-REI-COMP           PIC XXX.
  7258                 24  RE-REI-COMP-SUB       PIC XXX.
  7259             20  RE-LF-QC                  PIC X.
  7260             20  RE-AH-QC                  PIC X.
  7261             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7262             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7263             20  RE-LFAGE-LO               PIC 99.
  7264             20  RE-LFAGE-HI               PIC 99.
  7265             20  RE-AHAGE-LO               PIC 99.
  7266             20  RE-AHAGE-HI               PIC 99.
  7267             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7268             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7269             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7270             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7271             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7272             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7273             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7274             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7275             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7276             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7277             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7278             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7279             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7280             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7281             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7282             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7283             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7284             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7285             20  RE-LF-BEN-CODE            PIC X.
  7286             20  RE-AH-BEN-CODE            PIC X.
  7287             20  RE-INTERACTIVE            PIC X.
  7288             20  RE-REMAINING              PIC X.
  7289             20  RE-LF-RUNOFF-SW           PIC X.
  7290             20  RE-AH-RUNOFF-SW           PIC X.
  7291             20  FILLER                    PIC X(19).
  7292
  7293         16  RE-COMP-INFO-END              PIC X(6).
  7294         16  RE-NSP-ST-CD-LF               PIC XX.
  7295         16  RE-NSP-ST-CD-AH               PIC XX.
  7296         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7297             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7298
  7299         16  FILLER                        PIC X(27).
  7300
  7301     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7302         16  RE-NAME                       PIC X(30).
  7303         16  RE-LF-PE                      PIC X.
  7304         16  RE-AH-PE                      PIC X.
  7305         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7306         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7307         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7308         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7309         16  RE-PRT-ST                     PIC X.
  7310         16  RE-PRT-OW                     PIC X.
  7311         16  RE-MORT-CODE                  PIC X(4).
  7312         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 135
* EL050.cbl
  7313         16  RE-ZERO-LF-FEE                PIC X.
  7314         16  RE-ZERO-AH-FEE                PIC X.
  7315         16  RE-CEDE-NAME                  PIC X(30).
  7316         16  RE-LF-COMM                    PIC X.
  7317         16  RE-AH-COMM                    PIC X.
  7318         16  RE-LF-TAX                     PIC X.
  7319         16  RE-AH-TAX                     PIC X.
  7320         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7321         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7322         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7323
  7324         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7325             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7326
  7327         16  RE-LF-CEDING-FEE-BRACKETS.
  7328             20  RE-LF-FEE-METHOD          PIC X.
  7329                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7330                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7331                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7332                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7333             20  RE-LF-FEE-BASIS           PIC X.
  7334                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7335                 88  RE-LF-NET-CEDED               VALUE '2'.
  7336                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7337                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7338                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7339                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7340                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7341                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7342             20  FILLER                    PIC XXX.
  7343             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7344                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7345                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7346
  7347         16  RE-AH-CEDING-FEE-BRACKETS.
  7348             20  RE-AH-FEE-METHOD          PIC X.
  7349                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7350                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7351                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7352                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7353             20  RE-AH-FEE-BASIS           PIC X.
  7354                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7355                 88  RE-AH-NET-CEDED               VALUE '2'.
  7356                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7357                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7358                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7359                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7360                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7361                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7362             20  FILLER                    PIC XXX.
  7363             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7364                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7365                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7366
  7367         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7368
  7369         16  RE-OLD-CEDING-STMT            PIC X.
  7370
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 136
* EL050.cbl
  7371         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7372         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7373         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7374         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7375         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7376         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7377         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7378         16  RE-MORT-SW                    PIC X.
  7379         16  RE-CEDING-TYPE-FLAG           PIC X.
  7380             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7381             88  RE-CEDED                          VALUE 'C'.
  7382             88  RE-ASSUMED                        VALUE 'A'.
  7383             88  RE-PHANTOM                        VALUE 'P'.
  7384
  7385         16  RE-CEDING-STMT-OPT-A          PIC X.
  7386             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7387         16  RE-CEDING-STMT-OPT-B          PIC X.
  7388             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7389         16  RE-CEDING-STMT-OPT-C          PIC X.
  7390             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7391         16  RE-CEDING-STMT-OPT-D          PIC X.
  7392             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7393         16  RE-CEDING-STMT-OPT-E          PIC X.
  7394             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7395
  7396         16  RE-PRT-CRSV                   PIC X.
  7397
  7398         16  RE-GL-CENTER                  PIC X(4).
  7399
  7400         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7401
  7402         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7403
  7404         16  RE-EARN-STOP-CODE             PIC X.
  7405             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7406             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7407
  7408         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7409             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7410
  7411         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7412         16  FILLER                        PIC X(2281).
  7413
  7414         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7415
  7416******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 137
* EL050.cbl
  7418*    COPY ERCCTBL.
  7419******************************************************************
  7420*                                                                *
  7421*                                                                *
  7422*                            ERCCTBL                             *
  7423*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7424*                            VMOD=2.003
  7425*                                                                *
  7426*   ONLINE CREDIT SYSTEM                                         *
  7427*                                                                *
  7428*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7429*                                                                *
  7430*   FILE TYPE = VSAM,KSDS                                        *
  7431*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7432*                                                                *
  7433*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7434*       ALTERNATE PATH = NONE                                    *
  7435*                                                                *
  7436*   LOG = NO                                                     *
  7437*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7438*                                                                *
  7439*                                                                *
  7440******************************************************************
  7441
  7442 01  COMM-TABLE-RECORD.
  7443     12  CT-RECORD-ID                      PIC XX.
  7444         88  VALID-CT-ID                      VALUE 'CT'.
  7445
  7446     12  CT-CONTROL-PRIMARY.
  7447         16  CT-COMPANY-CD                 PIC X.
  7448         16  CT-TABLE                      PIC XXX.
  7449         16  CT-CNTRL-2.
  7450             20  CT-BEN-TYPE               PIC X.
  7451             20  CT-BEN-CODE               PIC XX.
  7452
  7453     12  CT-MAINT-INFORMATION.
  7454         16  CT-LAST-MAINT-DT              PIC XX.
  7455         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7456         16  CT-LAST-MAINT-USER            PIC X(4).
  7457         16  FILLER                        PIC X(31).
  7458
  7459     12  CT-LIMITS.
  7460         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7461
  7462         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7463
  7464         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7465
  7466     12  CT-RATES.
  7467         16  CT-RTX          OCCURS 27 TIMES.
  7468             20  CT-RT                     PIC SV9(5)     COMP-3.
  7469             20  CT-RT-R   REDEFINES
  7470                 CT-RT                     PIC XXX.
  7471
  7472     12  FILLER                            PIC  X(42).
  7473
  7474******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 138
* EL050.cbl
  7476*    COPY ERCFORM.
  7477******************************************************************
  7478*                                                                *
  7479*                                                                *
  7480*                            ERCFORM.                            *
  7481*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7482*                            VMOD=2.003                          *
  7483*                                                                *
  7484*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7485*                                                                *
  7486*    FILE TYPE = VSAM,KSDS                                       *
  7487*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7488*                                                                *
  7489*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7490*                                                                *
  7491*    LOG = YES                                                   *
  7492*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7493******************************************************************
  7494 01  FORM-MASTER.
  7495    12  FO-RECORD-ID                 PIC X(02).
  7496        88  VALID-FO-ID                  VALUE 'FO'.
  7497
  7498    12  FO-CONTROL-PRIMARY.
  7499        16  FO-COMPANY-CD            PIC X(01).
  7500        16  FO-STATE                 PIC X(02).
  7501        16  FO-FORM-ID               PIC X(12).
  7502        16  FO-FORM-EXP-DT           PIC X(02).
  7503
  7504    12  FO-POLICY-FORM-DATA.
  7505        16  FO-IND-GRP-CD            PIC X(01).
  7506        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7507        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7508        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7509        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7510        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7511        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7512        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7513        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7514        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7515        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7516        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7517        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7518        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7519        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7520        16  FO-APP-CERT-USE-CD       PIC X(01).
  7521
  7522    12  FILLER                       PIC X(29).
  7523
  7524    12  FO-FORM-PLAN-TABLE.
  7525        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7526            20  FO-PLAN-TYPE         PIC X(01).
  7527            20  FO-PLAN-ID           PIC X(02).
  7528            20  FO-PLAN-TERM         PIC 9(03).
  7529            20  FO-PLAN-REFUND-METHOD
  7530                                     PIC X.
  7531
  7532    12  FILLER                       PIC X(30).
  7533
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 139
* EL050.cbl
  7534    12  FO-COMMENTS-AREA.
  7535        16  FO-COMMENT-LINE-1        PIC X(78).
  7536
  7537    12  FILLER                       PIC X(20).
  7538
  7539    12  FO-MAINT-INFORMATION.
  7540        16  FO-LAST-MAINT-DT         PIC X(02).
  7541        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7542        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 140
* EL050.cbl
  7544*    COPY ELCMSTR.
  7545******************************************************************
  7546*                                                                *
  7547*                            ELCMSTR.                            *
  7548*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7549*                            VMOD=2.012                          *
  7550*                                                                *
  7551*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7552*                                                                *
  7553*   FILE TYPE = VSAM,KSDS                                        *
  7554*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7555*                                                                *
  7556*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7557*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7558*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7559*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7560*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7561*                                                 RKP=75,LEN=21  *
  7562*                                                                *
  7563*   **** NOTE ****                                               *
  7564*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7565*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7566*                                                                *
  7567*   LOG = YES                                                    *
  7568*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7569******************************************************************
  7570*                   C H A N G E   L O G
  7571*
  7572* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7573*-----------------------------------------------------------------
  7574*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7575* EFFECTIVE    NUMBER
  7576*-----------------------------------------------------------------
  7577* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7578* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7579* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7580* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7581* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7582* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7583* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7584******************************************************************
  7585 01  CLAIM-MASTER.
  7586     12  CL-RECORD-ID                PIC XX.
  7587         88  VALID-CL-ID         VALUE 'CL'.
  7588
  7589     12  CL-CONTROL-PRIMARY.
  7590         16  CL-COMPANY-CD           PIC X.
  7591         16  CL-CARRIER              PIC X.
  7592         16  CL-CLAIM-NO             PIC X(7).
  7593         16  CL-CERT-NO.
  7594             20  CL-CERT-PRIME       PIC X(10).
  7595             20  CL-CERT-SFX         PIC X.
  7596
  7597     12  CL-CONTROL-BY-NAME.
  7598         16  CL-COMPANY-CD-A1        PIC X.
  7599         16  CL-INSURED-LAST-NAME    PIC X(15).
  7600         16  CL-INSURED-NAME.
  7601             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 141
* EL050.cbl
  7602             20  CL-INSURED-MID-INIT PIC X.
  7603
  7604     12  CL-CONTROL-BY-SSN.
  7605         16  CL-COMPANY-CD-A2        PIC X.
  7606         16  CL-SOC-SEC-NO.
  7607             20  CL-SSN-STATE        PIC XX.
  7608             20  CL-SSN-ACCOUNT      PIC X(6).
  7609             20  CL-SSN-LN3          PIC X(3).
  7610
  7611     12  CL-CONTROL-BY-CERT-NO.
  7612         16  CL-COMPANY-CD-A4        PIC X.
  7613         16  CL-CERT-NO-A4.
  7614             20  CL-CERT-A4-PRIME    PIC X(10).
  7615             20  CL-CERT-A4-SFX      PIC X.
  7616
  7617     12  CL-CONTROL-BY-CCN.
  7618         16  CL-COMPANY-CD-A5        PIC X.
  7619         16  CL-CCN-A5.
  7620             20  CL-CCN.
  7621                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7622                 24  CL-CCN-PRIME-A5 PIC X(12).
  7623             20  CL-CCN-FILLER-A5    PIC X(4).
  7624
  7625     12  CL-INSURED-PROFILE-DATA.
  7626         16  CL-INSURED-BIRTH-DT     PIC XX.
  7627         16  CL-INSURED-SEX-CD       PIC X.
  7628             88  INSURED-IS-MALE        VALUE 'M'.
  7629             88  INSURED-IS-FEMALE      VALUE 'F'.
  7630             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7631         16  CL-INSURED-OCC-CD       PIC X(6).
  7632         16  FILLER                  PIC X(5).
  7633
  7634     12  CL-PROCESSING-INFO.
  7635         16  CL-PROCESSOR-ID         PIC X(4).
  7636         16  CL-CLAIM-STATUS         PIC X.
  7637             88  CLAIM-IS-OPEN          VALUE 'O'.
  7638             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7639         16  CL-CLAIM-TYPE           PIC X.
  7640*            88  AH-CLAIM               VALUE 'A'.
  7641*            88  LIFE-CLAIM             VALUE 'L'.
  7642*            88  PROPERTY-CLAIM         VALUE 'P'.
  7643*            88  IUI-CLAIM              VALUE 'I'.
  7644*            88  GAP-CLAIM              VALUE 'G'.
  7645*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7646*            88  OTHER-CLAIM            VALUE 'O'.
  7647         16  CL-CLAIM-PREM-TYPE      PIC X.
  7648             88  SINGLE-PREMIUM         VALUE '1'.
  7649             88  O-B-COVERAGE           VALUE '2'.
  7650             88  OPEN-END-COVERAGE      VALUE '3'.
  7651         16  CL-INCURRED-DT          PIC XX.
  7652         16  CL-REPORTED-DT          PIC XX.
  7653         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7654         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7655         16  CL-LAST-PMT-DT          PIC XX.
  7656         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7657         16  CL-PAID-THRU-DT         PIC XX.
  7658         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7659         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 142
* EL050.cbl
  7660         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7661         16  CL-PMT-CALC-METHOD      PIC X.
  7662             88  CL-360-DAY-YR          VALUE '1'.
  7663             88  CL-365-DAY-YR          VALUE '2'.
  7664             88  CL-FULL-MONTHS         VALUE '3'.
  7665         16  CL-CAUSE-CD             PIC X(6).
  7666
  7667         16  CL-PRIME-CERT-NO.
  7668             20  CL-PRIME-CERT-PRIME PIC X(10).
  7669             20  CL-PRIME-CERT-SFX   PIC X.
  7670
  7671         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7672             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7673             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7674
  7675         16  CL-MICROFILM-NO         PIC X(10).
  7676         16  FILLER REDEFINES CL-MICROFILM-NO.
  7677             20  CL-BENEFIT-PERIOD   PIC 99.
  7678             20  FILLER              PIC X(8).
  7679         16  CL-PROG-FORM-TYPE       PIC X.
  7680         16  CL-LAST-ADD-ON-DT       PIC XX.
  7681
  7682         16  CL-LAST-REOPEN-DT       PIC XX.
  7683         16  CL-LAST-CLOSE-DT        PIC XX.
  7684         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7685             88  FINAL-PAID             VALUE '1'.
  7686             88  CLAIM-DENIED           VALUE '2'.
  7687             88  AUTO-CLOSE             VALUE '3'.
  7688             88  MANUAL-CLOSE           VALUE '4'.
  7689             88  BENEFITS-CHANGED       VALUE 'C'.
  7690             88  SETUP-ERRORS           VALUE 'E'.
  7691         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7692         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7693         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7694             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7695         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7696         16  FILLER                  PIC X.
  7697
  7698     12  CL-CERTIFICATE-DATA.
  7699         16  CL-CERT-ORIGIN          PIC X.
  7700             88  CERT-WAS-ONLINE        VALUE '1'.
  7701             88  CERT-WAS-CREATED       VALUE '2'.
  7702             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7703         16  CL-CERT-KEY-DATA.
  7704             20  CL-CERT-CARRIER     PIC X.
  7705             20  CL-CERT-GROUPING    PIC X(6).
  7706             20  CL-CERT-STATE       PIC XX.
  7707             20  CL-CERT-ACCOUNT.
  7708                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7709                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7710             20  CL-CERT-EFF-DT      PIC XX.
  7711
  7712     12  CL-STATUS-CONTROLS.
  7713         16  CL-PRIORITY-CD          PIC X.
  7714             88  CONFIDENTIAL-DATA      VALUE '8'.
  7715             88  HIGHEST-PRIORITY       VALUE '9'.
  7716         16  CL-SUPV-ATTN-CD         PIC X.
  7717             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 143
* EL050.cbl
  7718             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7719         16  CL-PURGED-DT            PIC XX.
  7720         16  CL-RESTORED-DT          PIC XX.
  7721         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7722         16  CL-NEXT-RESEND-DT       PIC XX.
  7723         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7724         16  CL-CRITICAL-PERIOD      PIC 99.
  7725*        16  FILLER                  PIC XX.
  7726         16  CL-LAST-MAINT-DT        PIC XX.
  7727         16  CL-LAST-MAINT-USER      PIC X(4).
  7728         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7729         16  CL-LAST-MAINT-TYPE      PIC X.
  7730             88  CLAIM-SET-UP           VALUE ' '.
  7731             88  PAYMENT-MADE           VALUE '1'.
  7732             88  LETTER-SENT            VALUE '2'.
  7733             88  MASTER-WAS-ALTERED     VALUE '3'.
  7734             88  MASTER-WAS-RESTORED    VALUE '4'.
  7735             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7736             88  FILE-CONVERTED         VALUE '6'.
  7737             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7738             88  ERROR-CORRECTION       VALUE 'E'.
  7739         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7740         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7741         16  CL-BENEFICIARY          PIC X(10).
  7742         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7743         16  CL-DENIAL-TYPE          PIC X.
  7744             88  CL-TYPE-DENIAL          VALUE '1'.
  7745             88  CL-TYPE-RESCISSION      VALUE '2'.
  7746             88  CL-TYPE-REFORMATION     VALUE '3'.
  7747             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7748             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7749         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7750         16  filler                  pic x(3).
  7751*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7752*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7753*        16  CL-RTW-DT               PIC XX.
  7754
  7755     12  CL-TRAILER-CONTROLS.
  7756         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7757             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7758             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7759             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7760         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7761         16  FILLER                  PIC XX.
  7762         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7763         16  CL-ADDRESS-TRAILER-CNT.
  7764             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7765                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7766             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7767                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7768             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7769                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7770             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7771                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7772             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7773                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7774             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7775                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 144
* EL050.cbl
  7776             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7777                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7778
  7779     12  CL-CV-REFERENCE-NO.
  7780         16  CL-CV-REFNO-PRIME       PIC X(18).
  7781         16  CL-CV-REFNO-SFX         PIC XX.
  7782
  7783     12  CL-FILE-LOCATION            PIC X(4).
  7784
  7785     12  CL-PROCESS-ERRORS.
  7786         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7787             88  NO-FATAL-ERRORS        VALUE ZERO.
  7788         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7789             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7790
  7791     12  CL-PRODUCT-CD               PIC X.
  7792
  7793     12  CL-CURRENT-KEY-DATA.
  7794         16  CL-CURRENT-CARRIER      PIC X.
  7795         16  CL-CURRENT-GROUPING     PIC X(6).
  7796         16  CL-CURRENT-STATE        PIC XX.
  7797         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7798
  7799     12  CL-ASSOCIATES               PIC X.
  7800         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7801         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7802         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7803         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7804
  7805     12  CL-ACTIVITY-CODE            PIC 99.
  7806     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7807     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7808
  7809     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7810     12  CL-LAG-REPORT-CODE          PIC 9.
  7811     12  CL-LOAN-TYPE                PIC XX.
  7812     12  CL-LEGAL-STATE              PIC XX.
  7813
  7814     12  CL-YESNOSW                  PIC X.
  7815     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7816         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7817         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7818         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7819     12  cl-insured-type             pic x.
  7820         88  cl-claim-on-primary         value 'P'.
  7821         88  cl-claim-on-co-borrower     value 'C'.
  7822     12  cl-benefit-expiration-dt    PIC XX.
  7823
  7824 01  PLAN-RECORDS.
  7825     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7826     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7827
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 145
* EL050.cbl
  7829 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7830                          ACCOUNT-MASTER REINSURANCE-RECORD
  7831                          COMM-TABLE-RECORD FORM-MASTER
  7832                          CLAIM-MASTER PLAN-RECORDS.
  7833 0000-DFHEXIT SECTION.
  7834     MOVE '9#                    $   ' TO DFHEIV0.
  7835     MOVE 'EL050' TO DFHEIV1.
  7836     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7837
  7838     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7839
  7840
  7841* EXEC CICS  HANDLE CONDITION
  7842*           ERROR    (9300-ABEND)
  7843*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7844*    END-EXEC.
  7845*    MOVE '"$.J                  ! " #00007836' TO DFHEIV0
  7846     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7847     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7848     MOVE X'2220233030303037383336' TO DFHEIV0(25:11)
  7849     CALL 'kxdfhei1' USING DFHEIV0
  7850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7851
  7852
  7853 0000-COPY-PROCEDURE-DIV.
  7854*                          COPY ELC50PD.
  7855******************************************************************
  7856*                                                                *
  7857*                            ELC50PD                             *
  7858*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7859*                            VMOD=2.188                          *
  7860*                                                                *
  7861******************************************************************
  7862*                   C H A N G E   L O G
  7863*
  7864* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7865*-----------------------------------------------------------------
  7866*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7867* EFFECTIVE    NUMBER
  7868*-----------------------------------------------------------------
  7869* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7870* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7871* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7872*                             2709 AND 2718
  7873* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7874* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7875* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7876* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7877* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7878*                                IS OPEN OR CNC DT < PD THRU
  7879* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7880* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7881* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7882* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7883* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7884* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7885* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7886* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 146
* EL050.cbl
  7887* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7888* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7889* 020906                   PEMA  EXPAND LOAN OFFICER
  7890* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7891* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7892* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7893* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7894* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7895* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7896* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7897* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7898* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7899* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7900* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7901* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7902* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7903* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7904* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7905* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7906* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7907* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7908* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7909* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7910* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7911* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7912* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7913* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7914* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7915*                                UPDATE VIN ON CERT TRAILER
  7916* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7917* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7918* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7919* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7920* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7921* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7922* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7923* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7924* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7925* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7926* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7927* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7928* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7929* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7930* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7931* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7932* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7933* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7934* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7935* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7936* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7937* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7938* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7939* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7940* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7941* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7942* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7943* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7944* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 147
* EL050.cbl
  7945* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7946* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7947* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7948* 032912  CR2011110200001  PEMA  AHL CHANGES
  7949* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7950* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7951* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7952* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7953* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7954* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7955* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7956* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7957* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7958* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7959* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7960* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7961* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7962* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7963* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7964* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7965* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7966* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7967* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7968* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7969* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7970* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7971* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7972* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7973* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7974* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7975* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7976*                                CERT #, ADD 2898 FORCIBLE ERROR
  7977* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7978* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7979* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7980* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7981* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7982* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7983* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7984* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7985* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7986* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7987* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7988* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7989* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7990* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7991* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7992* 100617  CR2017062000003  PEMA  New comm cap edits
  7993* 121117  IR2017121100002  PEMA  INITIALIZE NEW COMM CAP FIELDS.
  7994* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
  7995* 011718  IR2018011200001  PEMA  CORRECT ROA EXTENSION DAYS ISSUE
  7996* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
  7997* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  7998* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
  7999* 070218  IR2018062700001  PEMA  Fix edit for spaces in certno
  8000* 092118  CR2018073000001  PEMA  Add lf & ah refund method to ELCR
  8001* 092618  CR2018050200001  PEMA  Add check for open clm on issue
  8002* 021519  CR2019021100001  PEMA  Non-monthly calcs for AL.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 148
* EL050.cbl
  8003* 101019  CR2019100700001  PEMA  Disallow V status with claim
  8004* 011020  IR2019121100004  PEMA  Add error 3069 name&age equal
  8005* 012220  CR2018092700002  TANA  Add edit for letter required
  8006* 012820  CR2020012800001  PEMA  ADD MIN LOAN TERM FOR EXTD TERM.
  8007* 030920  IR2020030500001  PEMA  ADD ERROR 3071 FOR MOB BUSINESS
  8008******************************************************************
  8009************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  8010******************************************************************
  8011
  8012     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  8013
  8014     MOVE SPACES                 TO PB-FATAL-FLAG
  8015                                    PB-FORCE-ER-CD
  8016                                    PB-WARN-ER-CD
  8017                                    PB-OUT-BAL-CD.
  8018
  8019     MOVE SPACE                  TO WS-IG-OVRD-AH
  8020                                    WS-IG-OVRD-LF
  8021                                    WS-IG-OVRD-AM
  8022                                    WS-IG-OVRD
  8023                                    WS-IG-OVRD-AH-PL
  8024                                    WS-IG-OVRD-LF-PL
  8025                                    WS-IG-OVRD-AH-BEN
  8026                                    WS-IG-OVRD-LF-BEN.
  8027
  8028******************************************************************
  8029*************       INITIALIZE COMMON ERRORS       ***************
  8030******************************************************************
  8031
  8032     MOVE +0                     TO PB-NO-OF-ERRORS.
  8033     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  8034
  8035******************************************************************
  8036
  8037     MOVE EIBDATE                TO DC-JULIAN-DATE.
  8038     SET JULIAN-TO-BIN           TO TRUE.
  8039*    MOVE 5                      TO DC-OPTION-CODE.
  8040     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8041     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  8042
  8043     MOVE ZERO                   TO  SUB4.
  8044
  8045 0040-INITIALIZE-GA-BILL-DT.
  8046
  8047     ADD +1                      TO  SUB4.
  8048
  8049     IF  SUB4 GREATER THAN +5
  8050         GO TO 0050-CHECK-CNTL-FOUND.
  8051
  8052     IF  PB-GA-BILL-DT (SUB4) = SPACES
  8053         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  8054
  8055     GO TO 0040-INITIALIZE-GA-BILL-DT.
  8056
  8057 0050-CHECK-CNTL-FOUND.
  8058
  8059     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  8060        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 149
* EL050.cbl
  8061                                         WS-AH-REM-TERM-CALC
  8062                                         EC-CO-REM-TERM-CALC
  8063        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  8064        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  8065        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  8066                                         WS-TOL-AH-CLAIM
  8067        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  8068                                         WS-TOL-AH-PREM
  8069                                         EC-CO-TOL-PREM
  8070        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  8071                                         WS-TOL-AH-REFUND
  8072                                         EC-CO-TOL-REFUND
  8073        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  8074                                         WS-AH-REFUND-OVS-AMT
  8075                                         EC-CO-OVR-SHT-AMT
  8076        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  8077                                         WS-TOL-AH-PREM-PCT
  8078                                         EC-CO-TOL-PREM-PCT
  8079        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  8080                                         WS-TOL-AH-REFUND-PCT
  8081                                         EC-CO-TOL-REFUND-PCT
  8082        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  8083                                         WS-AH-REFUND-OVS-PCT
  8084                                         EC-CO-OVR-SHT-PCT
  8085        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  8086        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  8087        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  8088        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  8089        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  8090        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  8091        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  8092        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  8093        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  8094        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  8095        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  8096        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  8097                                         EC-CO-MONTH-END-DT
  8098        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  8099          GO TO 0100-READ-ACCT.
  8100
  8101     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8102     MOVE SPACES                 TO CNTL-ACCESS.
  8103     MOVE '1'                    TO CNTL-REC-TYPE.
  8104     MOVE +0                     TO CNTL-SEQ-NO.
  8105
  8106     MOVE '1' TO RC-SW-1.
  8107     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8108     IF NOT CF-COMPANY-MASTER
  8109         MOVE ZEROS             TO WK-CO-TOL-PREM
  8110                                   WK-CO-TOL-CLAIM
  8111                                   WK-CO-TOL-REFUND
  8112                                   WK-REFUND-OVS-AMT
  8113                                   WK-REFUND-OVS-PCT
  8114                                   WK-CO-TOL-PREM-PCT
  8115                                   WK-CO-TOL-REFUND-PCT
  8116                                   WK-DEFAULT-APR
  8117                                   WK-CO-MAX-CAP
  8118        MOVE SPACES             TO WK-CR-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 150
* EL050.cbl
  8119                                   WK-CR-R78-METHOD
  8120                                   WK-CO-REF-REJECT-SW
  8121                                   WK-CO-PREM-REJECT-SW
  8122                                   WK-REM-TRM-CALC-OPTION
  8123                                   WK-BIRTH-DATE-INPUT
  8124                                   WK-JOINT-AGE-INPUT
  8125        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  8126        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  8127        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  8128        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  8129          GO TO 0099-COMPANY-NOT-FOUND.
  8130
  8131     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  8132        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  8133     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  8134        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8135     IF CF-CO-TOL-CAP NOT NUMERIC
  8136        MOVE +0                    TO CF-CO-TOL-CAP.
  8137     IF CF-DEFAULT-APR NOT NUMERIC
  8138        MOVE +0                    TO CF-DEFAULT-APR.
  8139
  8140     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8141     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8142     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8143     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8144     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8145     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8146     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8147     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8148     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8149     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8150     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8151     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8152
  8153     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8154          CF-CO-OVR-SHT-AMT > +0
  8155        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8156
  8157     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8158          CF-CO-OVR-SHT-PCT > +0
  8159        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8160
  8161     IF CF-VALID-REM-TRM-OPTION
  8162         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8163     ELSE
  8164         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8165
  8166     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8167     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8168     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8169     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8170
  8171     GO TO 0050-CHECK-CNTL-FOUND.
  8172
  8173 0099-COMPANY-NOT-FOUND.
  8174
  8175     MOVE ER-2616                TO WS-ERROR.
  8176     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 151
* EL050.cbl
  8177
  8178 0100-READ-ACCT.
  8179
  8180     MOVE SPACES                 TO DATE-RANGE-SW.
  8181
  8182     IF WK-ACCT-ADDR = ZEROS
  8183        GO TO 0102-ACCT-GETMAIN.
  8184
  8185     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8186     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8187     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8188
  8189     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8190        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8191        GO TO 0105-READ-ACCT
  8192     END-IF
  8193
  8194     IF PB-CARRIER NOT = SPACES
  8195        IF PB-CARRIER NOT = AM-VG-CARRIER
  8196           GO TO 0105-READ-ACCT.
  8197
  8198     IF PB-STATE NOT = SPACES
  8199        IF PB-STATE NOT = AM-VG-STATE
  8200           GO TO 0105-READ-ACCT.
  8201
  8202     IF PB-GROUPING NOT = SPACES
  8203        IF PB-GROUPING NOT = AM-VG-GROUPING
  8204           GO TO 0105-READ-ACCT.
  8205
  8206     MOVE 'X'                 TO DATE-RANGE-SW.
  8207
  8208     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8209        MOVE 'X'                 TO DATE-RANGE-SW
  8210        GO TO 0105-READ-ACCT.
  8211
  8212     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8213        GO TO 0105-READ-ACCT.
  8214
  8215     GO TO 0180-ACCOUNT-FOUND.
  8216
  8217 0102-ACCT-GETMAIN.
  8218     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8219     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8220
  8221 0105-READ-ACCT.
  8222     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8223     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8224     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8225     MOVE PB-STATE               TO ACCT-STATE.
  8226     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8227     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8228
  8229     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8230
  8231     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8232
  8233 0110-FIND-ACCT-TOLERANCES-LOOP.
  8234     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 152
* EL050.cbl
  8235
  8236     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8237        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8238        GO TO 0199-ACCT-NOT-FOUND
  8239     END-IF
  8240     IF PB-CARRIER NOT = SPACES
  8241        IF PB-CARRIER NOT = AM-VG-CARRIER
  8242           GO TO 0199-ACCT-NOT-FOUND.
  8243
  8244     IF PB-STATE NOT = SPACES
  8245        IF PB-STATE NOT = AM-VG-STATE
  8246           GO TO 0199-ACCT-NOT-FOUND.
  8247
  8248     IF PB-GROUPING NOT = SPACES
  8249        IF PB-GROUPING NOT = AM-VG-GROUPING
  8250           GO TO 0199-ACCT-NOT-FOUND.
  8251
  8252     MOVE 'X'                    TO DATE-RANGE-SW.
  8253
  8254     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8255        MOVE 'X'                 TO DATE-RANGE-SW
  8256        GO TO 0199-ACCT-NOT-FOUND.
  8257
  8258     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8259        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8260
  8261 0180-ACCOUNT-FOUND.
  8262     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8263     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8264     MOVE AM-STATE               TO PB-SV-STATE.
  8265     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8266
  8267     IF AM-CANCEL-FEE  NOT NUMERIC
  8268        MOVE ZEROS TO AM-CANCEL-FEE.
  8269
  8270     IF AM-MAX-MON-BEN NOT NUMERIC
  8271        MOVE ZEROS TO AM-MAX-MON-BEN.
  8272
  8273     IF AM-MAX-TOT-BEN NOT NUMERIC
  8274        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8275
  8276     IF AM-CLP-TOL-PCT NOT NUMERIC
  8277        MOVE +0                  TO AM-CLP-TOL-PCT
  8278     END-IF
  8279     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8280        MOVE +0                  TO AM-SPP-LEASE-COMM
  8281     END-IF
  8282     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8283        MOVE ER-2611             TO   WS-ERROR
  8284        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8285
  8286     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8287        MOVE ER-2621             TO   WS-ERROR
  8288        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8289
  8290     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8291        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8292        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 153
* EL050.cbl
  8293        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8294         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8295
  8296     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8297     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8298     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8299     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8300     IF AM-CLP-TOL-PCT NOT = ZEROS
  8301        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8302     END-IF
  8303     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8304        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8305     END-IF
  8306*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8307*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8308*                                   WS-ADMIN-FEES
  8309*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8310*          (SUB5 > +10)
  8311*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8312*             AND (AM-A-COM (SUB5) NUMERIC)
  8313*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8314*                + (AM-A-COM (SUB5) * 1000)
  8315*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8316*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8317*                + (AM-A-COM (SUB5) * 1000)
  8318*             END-IF
  8319*             IF AM-COM-TYP (SUB5) = 'N'
  8320*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8321*                + (AM-A-COM (SUB5) * 1000)
  8322*             END-IF
  8323*          END-IF
  8324*       END-PERFORM
  8325*    END-IF
  8326     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8327        AND (PB-ISSUE)
  8328        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8329                                    ws-cred-union-fees
  8330        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8331           (SUB5 > +10)
  8332           MOVE +0 TO WS-WK-RATE
  8333           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8334                                   'O' OR 'S')
  8335              IF (AM-A-COM (SUB5) NUMERIC)
  8336                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8337                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8338              ELSE
  8339                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8340                 IF PB-ISSUE
  8341                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8342                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8343                 ELSE
  8344                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8345                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8346                 END-IF
  8347                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8348                 MOVE ZEROS             TO WS-SUB1
  8349                                           WS-COMMISSION
  8350                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 154
* EL050.cbl
  8351                 MOVE '0530'               TO CTBL-SW
  8352                 MOVE ' '                  TO WS-CTBL-READ-SW
  8353                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8354                 IF FIRST-TIME-THROUGH
  8355                    MOVE 'AA'              TO CTBL-BEN-CODE
  8356                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8357                 END-IF
  8358                 IF CTBL-TABLE-FOUND
  8359                    IF PB-ISSUE
  8360                       COMPUTE WS-COMM-CK-AMT =
  8361                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8362                    ELSE
  8363                       COMPUTE WS-COMM-CK-AMT =
  8364                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8365                    END-IF
  8366                    PERFORM 8800-GET-COMP-RATE
  8367                              THRU 8800-EXIT
  8368                 END-IF
  8369              END-IF
  8370              if am-com-typ (sub5) = 'O' or 'S'
  8371                 compute ws-cred-union-fees rounded =
  8372                    ws-cred-union-fees +
  8373                    (pb-i-ah-premium-amt * ws-wk-rate)
  8374              else
  8375                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8376                + (WS-WK-RATE * 1000)
  8377              end-if
  8378           END-IF
  8379        END-PERFORM
  8380     END-IF
  8381     IF PB-COMPANY-ID EQUAL 'CRI'
  8382         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8383
  8384     IF PB-COMPANY-ID EQUAL 'NCL'
  8385         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8386     END-IF
  8387
  8388     GO TO 0200-READ-CERT.
  8389
  8390 0199-ACCT-NOT-FOUND.
  8391
  8392     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8393
  8394     IF DATE-RANGE-SW NOT = SPACES
  8395        MOVE ER-2601             TO WS-ERROR
  8396        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8397     ELSE
  8398        MOVE ER-2619             TO WS-ERROR
  8399        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8400
  8401     GO TO 9990-RETURN.
  8402
  8403 0200-READ-CERT.
  8404
  8405     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8406     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8407     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8408     MOVE PB-SV-STATE            TO CERT-STATE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 155
* EL050.cbl
  8409     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8410     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8411     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8412
  8413     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8414
  8415     IF CERT-WAS-NOT-FOUND
  8416        GO TO 0299-CERT-NOT-FOUND.
  8417
  8418     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8419        MOVE ER-2759             TO WS-ERROR
  8420        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8421        GO TO 0298-UNLOCK-RETURN.
  8422
  8423     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8424         MOVE ER-2758            TO WS-ERROR
  8425         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8426         GO TO 0298-UNLOCK-RETURN.
  8427
  8428     IF PB-ISSUE
  8429        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8430           IF CERT-WAS-CREATED-FOR-CLAIM
  8431              NEXT SENTENCE
  8432            ELSE
  8433              MOVE ER-2626       TO WS-ERROR
  8434              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8435              GO TO 0298-UNLOCK-RETURN.
  8436
  8437     IF NOT PB-CANCELLATION
  8438        GO TO 0300-CONTINUE-EDIT.
  8439
  8440     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8441     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8442     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8443     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8444     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8445     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8446
  8447     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8448     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8449     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8450     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8451     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8452     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8453     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8454     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8455     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8456
  8457     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8458     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8459     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8460     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8461     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8462     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8463     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8464
  8465     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8466     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 156
* EL050.cbl
  8467
  8468     MOVE CM-CREDIT-INTERFACE-SW-1
  8469                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8470     MOVE CM-CREDIT-INTERFACE-SW-2
  8471                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8472
  8473     IF CM-O-B-COVERAGE
  8474         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8475
  8476     IF CM-LIVES NOT NUMERIC
  8477         MOVE ZERO                TO CM-LIVES.
  8478
  8479     IF CM-BILLED NOT NUMERIC
  8480         MOVE ZERO                TO CM-BILLED.
  8481
  8482     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8483         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8484         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8485         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8486         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8487         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8488         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8489         MOVE CM-LIVES             TO PB-CI-LIVES
  8490*The next line causes a problem with my change  I dont think it is
  8491*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8492
  8493     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8494     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8495     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8496     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8497     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8498     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8499
  8500     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8501     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8502     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8503     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8504
  8505     IF CM-LIFE-COMM-PCT NUMERIC
  8506         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8507     ELSE
  8508         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8509
  8510     IF CM-AH-COMM-PCT NUMERIC
  8511         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8512     ELSE
  8513         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8514
  8515     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8516
  8517     IF CM-LOAN-APR       NOT NUMERIC
  8518           MOVE ZERO               TO CM-LOAN-APR.
  8519
  8520     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8521           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8522
  8523     IF CM-LOAN-TERM      NOT NUMERIC
  8524           MOVE ZERO               TO CM-LOAN-TERM.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 157
* EL050.cbl
  8525
  8526     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8527           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8528
  8529     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8530           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8531
  8532     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8533     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8534     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8535     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8536     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8537     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8538     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8539     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8540     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8541     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8542     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8543     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8544     MOVE CM-BENEFICIARY           TO PB-CI-BENEFICIARY-NAME
  8545
  8546     IF CM-STATE = CM-SSN-STATE
  8547         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8548
  8549     IF CM-STATE NOT = CM-MEMB-STATE
  8550         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8551
  8552     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8553
  8554     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8555*       MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8556        IF CM-ADDL-CLP NOT NUMERIC
  8557           MOVE +0               TO CM-ADDL-CLP
  8558        END-IF
  8559        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8560        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8561           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8562        END-IF
  8563     END-IF
  8564     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8565        MOVE +0                  TO WS-ADMIN-FEES
  8566                                    WS-CSO-ADMIN-FEE
  8567                                    WS-COMM-AND-MFEE
  8568                                    WS-1ST-YR-ALLOW
  8569        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8570           (SUB5 > +10)
  8571           MOVE +0 TO WS-WK-RATE
  8572           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8573              IF (AM-A-COM (SUB5) NUMERIC)
  8574                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8575                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8576              ELSE
  8577                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8578                 IF PB-ISSUE
  8579                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8580                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8581                 ELSE
  8582                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 158
* EL050.cbl
  8583                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8584                 END-IF
  8585                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8586                 MOVE ZEROS             TO WS-SUB1
  8587                                           WS-COMMISSION
  8588                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8589                 MOVE '0530'               TO CTBL-SW
  8590                 MOVE ' '                  TO WS-CTBL-READ-SW
  8591                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8592                 IF FIRST-TIME-THROUGH
  8593                    MOVE 'AA'              TO CTBL-BEN-CODE
  8594                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8595                 END-IF
  8596                 IF CTBL-TABLE-FOUND
  8597                    IF PB-ISSUE
  8598                       COMPUTE WS-COMM-CK-AMT =
  8599                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8600                    ELSE
  8601                       COMPUTE WS-COMM-CK-AMT =
  8602                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8603                    END-IF
  8604                    PERFORM 8800-GET-COMP-RATE
  8605                              THRU 8800-EXIT
  8606                 END-IF
  8607              END-IF
  8608              IF AM-COM-TYP (SUB5) = 'I'
  8609                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8610                   + (WS-WK-RATE * 1000)
  8611              END-IF
  8612              IF AM-COM-TYP (SUB5) = 'N'
  8613                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8614                   + (WS-WK-RATE * 1000)
  8615              END-IF
  8616              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8617                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8618                   + (WS-WK-RATE * 1000)
  8619              END-IF
  8620              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8621                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8622                   + (WS-WK-RATE * 1000)
  8623              END-IF
  8624           END-IF
  8625        END-PERFORM
  8626     END-IF
  8627     GO TO 0300-CONTINUE-EDIT.
  8628
  8629 0298-UNLOCK-RETURN.
  8630      PERFORM 9250-UNLOCK-RETURN
  8631      GO TO 9990-RETURN.
  8632
  8633 0299-CERT-NOT-FOUND.
  8634
  8635     MOVE '1'                     TO CERT-STATUS-SW.
  8636
  8637     IF PB-COMPANY-ID = 'UCL'
  8638         IF WS-ERROR = ER-2799
  8639             GO TO 3000-CONTINUE-EDIT.
  8640
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 159
* EL050.cbl
  8641     IF NOT PB-CANCELLATION
  8642         GO TO 0300-CONTINUE-EDIT.
  8643
  8644     MOVE ER-2726                  TO  WS-ERROR.
  8645     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8646     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8647     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8648                                    PB-CI-LF-TERM
  8649                                    PB-C-LF-REM-TERM
  8650                                    PB-CI-AH-TERM
  8651                                    PB-C-AH-REM-TERM
  8652                                    PB-CI-LF-BENEFIT-CD
  8653                                    PB-CI-LF-BENEFIT-AMT
  8654                                    PB-CI-LF-ALT-BENEFIT-AMT
  8655                                    PB-CI-LF-PREMIUM-AMT
  8656                                    PB-CI-LF-ALT-PREMIUM-AMT
  8657                                    PB-CI-AH-BENEFIT-CD
  8658                                    PB-CI-AH-BENEFIT-AMT
  8659                                    PB-CI-AH-PREMIUM-AMT
  8660                                    PB-CI-PAY-FREQUENCY
  8661                                    PB-CI-LOAN-APR
  8662                                    PB-CI-LOAN-TERM
  8663                                    PB-CI-LIFE-COMMISSION
  8664                                    PB-CI-AH-COMMISSION
  8665                                    PB-CI-CURR-SEQ
  8666                                    PB-CI-AH-CANCEL-AMT
  8667                                    PB-CI-LF-CANCEL-AMT
  8668                                    PB-CI-RATE-DEV-PCT-LF
  8669                                    PB-CI-RATE-DEV-PCT-AH
  8670                                    PB-CI-EXTENTION-DAYS
  8671                                    PB-CI-TERM-IN-DAYS
  8672                                    PB-CI-LIVES
  8673                                    PB-CI-LF-CRIT-PER
  8674                                    PB-CI-AH-CRIT-PER
  8675                                    PB-CI-ADDL-CLP
  8676                                    PB-CI-DDF-IU-RATE-UP.
  8677
  8678     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8679                                    PB-CI-AH-SETTLEMENT-DT
  8680                                    PB-CI-DEATH-DT
  8681                                    PB-CI-LF-PRIOR-CANCEL-DT
  8682                                    PB-CI-AH-PRIOR-CANCEL-DT
  8683                                    PB-CI-ENTRY-DT
  8684                                    PB-CI-LF-EXPIRE-DT
  8685                                    PB-CI-AH-EXPIRE-DT
  8686                                    PB-CI-LOAN-1ST-PMT-DT.
  8687
  8688     IF ACCOUNT-MAST-FOUND
  8689        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8690        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8691
  8692
  8693 0300-CONTINUE-EDIT.
  8694
  8695     IF PB-ISSUE
  8696        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8697            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8698
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 160
* EL050.cbl
  8699     IF PB-ISSUE
  8700        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8701            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8702
  8703     IF PB-ISSUE
  8704       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8705          (AM-NO-AH-ONLY)
  8706           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8707               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8708                   MOVE ER-2679 TO WS-ERROR
  8709                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8710
  8711     IF PB-ISSUE
  8712        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8713        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8714        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8715     ELSE
  8716        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8717        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8718        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8719
  8720     MOVE 'N'                    TO PLAN-MASTER-SW
  8721                                    PLAN-MASTER-LIFE-SW
  8722                                    FORM-MASTER-SW
  8723                                    WS-APP-CERT-SW.
  8724
  8725     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8726                                    WS-PL-TOL-LF-REFUND
  8727                                    WS-PL-REF-OVS-AMT
  8728                                    WS-PL-TOL-LF-PREM-PCT
  8729                                    WS-PL-TOL-LF-REFUND-PCT
  8730                                    WS-PL-REF-OVS-PCT
  8731                                    WS-PL-TOL-LF-CLAIM.
  8732
  8733     IF PB-COMPANY-ID = 'NCL'
  8734       IF PB-ISSUE
  8735         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8736             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8737             IF FORM-MASTER-FOUND
  8738                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8739
  8740     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8741        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8742
  8743********************** MON CODE **********************
  8744     IF PB-COMPANY-ID = 'MON'
  8745     IF PB-ISSUE
  8746     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8747        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8748             PB-I-LOAN-APR = ZERO)
  8749               MOVE 14.0         TO PB-I-LOAN-APR.
  8750******************************************************
  8751
  8752     IF PB-COMPANY-ID = 'NCL'
  8753       IF PB-ISSUE
  8754           IF FORM-MASTER-FOUND
  8755             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8756                AM-DISMBR-COVERAGE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 161
* EL050.cbl
  8757                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8758                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8759                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8760                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8761                                           PB-I-LIFE-BENEFIT-CD.
  8762
  8763     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8764
  8765     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8766         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8767         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8768         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8769         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8770         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8771           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8772             GO TO 0301-LIFE-BENEFIT-SEARCH
  8773         ELSE
  8774             NEXT SENTENCE
  8775     ELSE
  8776         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8777
  8778     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8779     MOVE '4'                    TO CNTL-REC-TYPE.
  8780     MOVE +0                     TO CNTL-SEQ-NO.
  8781     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8782
  8783     MOVE '1' TO RC-SW-2.
  8784     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8785
  8786     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8787        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8788         GO TO 0305-BENEFIT-NOT-FOUND.
  8789
  8790     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8791
  8792 0301-LIFE-BENEFIT-SEARCH.
  8793
  8794     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8795
  8796     IF NO-BENEFIT-FOUND
  8797        GO TO 0305-BENEFIT-NOT-FOUND.
  8798
  8799     IF WS-BEN-CD = '99'
  8800        GO TO 0305-BENEFIT-NOT-FOUND.
  8801
  8802     IF PB-COMPANY-ID = 'NCL'
  8803         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8804             GO TO 0304-LIFE-BENEFIT-FOUND.
  8805
  8806     MOVE +1                     TO SUB5.
  8807     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8808
  8809* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8810* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8811     IF PB-COMPANY-ID = 'DMD'
  8812         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8813
  8814 0302-EDIT-ACCT-LF-BENEFITS.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 162
* EL050.cbl
  8815
  8816     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8817        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8818           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8819                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8820           GO TO 03XX-GET-LIFE-ERPLAN.
  8821
  8822     IF SUB5 LESS THAN +20
  8823        ADD +1                   TO SUB5
  8824        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8825
  8826     MOVE +1                     TO SUB5.
  8827
  8828     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8829        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8830
  8831 0303-EDIT-DMD-EXTRA-BENEFITS.
  8832
  8833     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8834        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8835           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8836                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8837           GO TO 03XX-GET-LIFE-ERPLAN.
  8838
  8839     IF SUB5 LESS THAN +30
  8840        ADD +1                   TO SUB5
  8841        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8842
  8843     MOVE +1                     TO SUB5.
  8844
  8845 03XX-EDIT-FOR-NINETY-LF.
  8846
  8847***************************************************************
  8848*                                                             *
  8849*    NINETY BENEFIT PLAN TYPES:                               *
  8850*                                                             *
  8851*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8852*      92 = ALL GROUP REDUCING BENEFITS                       *
  8853*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8854*      94 = ALL GROUP LEVEL BENEFITS                          *
  8855*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8856*           BENEFIT CONTROLS.                                 *
  8857*      99 = ALL BENEFITS                                      *
  8858*                                                             *
  8859***************************************************************
  8860
  8861     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8862                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8863
  8864     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8865       AND
  8866        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8867        GO TO 03XX-GET-LIFE-ERPLAN.
  8868
  8869     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8870       AND
  8871        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8872        IF CF-REDUCING (SUB3)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 163
* EL050.cbl
  8873           IF (PB-I-INDV-GRP-OVRD = 'I')
  8874              OR
  8875           ((AM-IG = '1') AND
  8876           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8877              OR
  8878           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8879           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8880           (AM-IG NOT = '2'))
  8881              GO TO 03XX-GET-LIFE-ERPLAN.
  8882
  8883     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8884       AND
  8885        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8886        IF CF-REDUCING (SUB3)
  8887           IF (PB-I-INDV-GRP-OVRD = 'G')
  8888              OR
  8889           ((AM-IG = '2') AND
  8890           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8891              OR
  8892           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8893           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8894           (AM-IG NOT = '1'))
  8895              GO TO 03XX-GET-LIFE-ERPLAN.
  8896
  8897     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8898       AND
  8899        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8900        IF CF-LEVEL    (SUB3)
  8901           IF (PB-I-INDV-GRP-OVRD = 'I')
  8902              OR
  8903           ((AM-IG = '1') AND
  8904           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8905              OR
  8906           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8907           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8908            (AM-IG NOT = '2'))
  8909              GO TO 03XX-GET-LIFE-ERPLAN.
  8910
  8911     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8912       AND
  8913        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8914        IF CF-LEVEL    (SUB3)
  8915           IF (PB-I-INDV-GRP-OVRD = 'G')
  8916              OR
  8917           ((AM-IG = '2') AND
  8918           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8919              OR
  8920           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8921           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8922           (AM-IG NOT = '1'))
  8923              GO TO 03XX-GET-LIFE-ERPLAN.
  8924
  8925     IF SUB5 LESS THAN +20
  8926        ADD +1                   TO SUB5
  8927        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8928
  8929     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8930
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 164
* EL050.cbl
  8931     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8932        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8933
  8934     MOVE +1                     TO SUB5.
  8935
  8936 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8937
  8938     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8939                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8940
  8941     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8942       AND
  8943        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8944        GO TO 03XX-GET-LIFE-ERPLAN.
  8945
  8946     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8947       AND
  8948        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8949        IF CF-REDUCING (SUB3)
  8950           IF (PB-I-INDV-GRP-OVRD = 'I')
  8951              OR
  8952           ((AM-IG = '1') AND
  8953           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8954              OR
  8955           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8956           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8957           (AM-IG NOT = '2'))
  8958              GO TO 03XX-GET-LIFE-ERPLAN.
  8959
  8960     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8961       AND
  8962        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8963        IF CF-REDUCING (SUB3)
  8964           IF (PB-I-INDV-GRP-OVRD = 'G')
  8965              OR
  8966           ((AM-IG = '2') AND
  8967           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8968              OR
  8969           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8970           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8971           (AM-IG NOT = '1'))
  8972              GO TO 03XX-GET-LIFE-ERPLAN.
  8973
  8974     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8975       AND
  8976        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8977        IF CF-LEVEL    (SUB3)
  8978           IF (PB-I-INDV-GRP-OVRD = 'I')
  8979              OR
  8980           ((AM-IG = '1') AND
  8981           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8982              OR
  8983           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8984           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8985            (AM-IG NOT = '2'))
  8986              GO TO 03XX-GET-LIFE-ERPLAN.
  8987
  8988     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 165
* EL050.cbl
  8989       AND
  8990        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8991        IF CF-LEVEL    (SUB3)
  8992           IF (PB-I-INDV-GRP-OVRD = 'G')
  8993              OR
  8994           ((AM-IG = '2') AND
  8995           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8996              OR
  8997           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8998           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8999           (AM-IG NOT = '1'))
  9000              GO TO 03XX-GET-LIFE-ERPLAN.
  9001
  9002     IF SUB5 LESS THAN +30
  9003        ADD +1                   TO SUB5
  9004        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  9005
  9006     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9007
  9008 03XX-EDIT-FOR-NINETY-LF-CONT.
  9009
  9010     MOVE +99                    TO SUB5.
  9011
  9012     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9013        IF PB-ISSUE
  9014           MOVE ER-1924          TO  WS-ERROR
  9015           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9016
  9017     GO TO 0304-LIFE-BENEFIT-FOUND.
  9018
  9019 03XX-GET-LIFE-ERPLAN.
  9020
  9021     IF WK-PLAN-ADDR EQUAL +0
  9022        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  9023
  9024     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9025     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9026     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9027     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  9028     MOVE 'Y'                    TO PLAN-MASTER-SW
  9029                                    PLAN-MASTER-LIFE-SW.
  9030     GO TO XXXX-CHECK-LF-PLAN-KEY.
  9031
  9032 03XX-ERPLAN-LIFE-GETMAIN.
  9033
  9034     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9035     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9036
  9037 03XX-ERPLAN-LIFE-READ.
  9038
  9039     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9040     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9041     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9042     MOVE PB-SV-STATE            TO PLAN-STATE.
  9043     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9044     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  9045     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9046     MOVE WS-SAVE-BENEFIT-REVISION
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 166
* EL050.cbl
  9047                                 TO PLAN-REVISION-NO.
  9048
  9049     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9050     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  9051
  9052     IF PB-COMPANY-ID = 'NCL'
  9053       IF NOT LF-PLAN-MASTER-FOUND
  9054         IF NOT PB-POLICY-IS-DECLINED  AND
  9055            NOT PB-POLICY-IS-VOIDED
  9056             MOVE  ER-1921         TO  WS-ERROR
  9057             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9058             GO TO 0304-LIFE-BENEFIT-FOUND.
  9059
  9060     IF NOT LF-PLAN-MASTER-FOUND
  9061        GO TO 0304-LIFE-BENEFIT-FOUND.
  9062
  9063 XXXX-CHECK-LF-PLAN-KEY.
  9064
  9065     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9066        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9067        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9068        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9069        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9070        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9071        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9072        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9073        MOVE 'N'                 TO PLAN-MASTER-SW
  9074          GO TO 03XX-ERPLAN-LIFE-READ.
  9075
  9076     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  9077
  9078     IF  PB-CANCELLATION
  9079         GO TO  0303-LF-ACCT-BEN-FOUND.
  9080
  9081     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9082        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9083           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9084           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9085              MOVE ER-2644             TO WS-ERROR
  9086              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9087           ELSE
  9088              NEXT SENTENCE
  9089        ELSE
  9090           IF PB-COMPANY-ID NOT = 'NCL'
  9091              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9092                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9093
  9094 0303-LF-ACCT-BEN-FOUND.
  9095
  9096     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  9097
  9098     IF PL-DEV-CODE NOT = SPACES
  9099        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  9100
  9101     IF PL-DEV-PCT NUMERIC AND
  9102        PL-DEV-PCT NOT = ZEROS
  9103        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  9104
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 167
* EL050.cbl
  9105     IF PL-TOL-PREM-AMT GREATER THAN +0
  9106        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  9107
  9108     IF PL-TOL-REF-AMT GREATER THAN +0
  9109        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  9110
  9111     IF PL-TOL-PREM-PCT GREATER THAN +0
  9112        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  9113
  9114     IF PL-TOL-REF-PCT GREATER THAN +0
  9115        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  9116
  9117     IF PL-TOL-CLM-AMT GREATER THAN +0
  9118        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  9119
  9120     IF PL-OVER-SHORT-AMT NUMERIC  AND
  9121                          PL-OVER-SHORT-AMT > +0
  9122        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9123
  9124     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9125                          PL-OVER-SHORT-PCT > +0
  9126        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9127
  9128     IF PL-SALES-TAX NUMERIC AND
  9129                          PL-SALES-TAX > +0
  9130         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9131
  9132     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9133        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9134                                    WS-IG-OVRD-AM.
  9135
  9136 0304-LIFE-BENEFIT-FOUND.
  9137
  9138     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9139
  9140     IF PB-ISSUE
  9141        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9142     ELSE
  9143        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9144
  9145     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9146     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9147     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9148     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9149     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9150                                         WS-LF-REFUND-CALC.
  9151     if (ws-lf-earnings-calc = '5')
  9152        and (pb-i-loan-apr = zeros)
  9153        and (benefit-code-chg)
  9154        move +99.9999 to pb-i-loan-apr
  9155     end-if
  9156
  9157     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9158        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9159
  9160     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9161        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  9162     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 168
* EL050.cbl
  9163
  9164     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  9165     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  9166     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  9167     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  9168     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9169     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9170
  9171     IF PB-COMPANY-ID = 'NCL'  AND
  9172        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9173         NEXT SENTENCE
  9174     ELSE
  9175         IF SUB5 NOT GREATER THAN +20
  9176            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9177               MOVE WS-SAVE-BENEFIT-REM-TERM
  9178                                      TO WS-AM-LF-BENE-REM-TERM
  9179                                         EC-BR-LF-REM-TERM-CALC.
  9180
  9181     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9182     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9183
  9184     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9185
  9186 0305-BENEFIT-NOT-FOUND.
  9187
  9188     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9189     MOVE ER-2604                TO WS-ERROR.
  9190     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9191
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 169
* EL050.cbl
  9193
  9194 0310-FIND-AH-BENEFIT-RECORD.
  9195
  9196     MOVE 'N'                    TO PLAN-MASTER-SW
  9197                                    PLAN-MASTER-AH-SW.
  9198
  9199     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9200                                    WS-PL-TOL-AH-REFUND
  9201                                    WS-AH-PL-REF-OVS-AMT
  9202                                    WS-PL-TOL-AH-PREM-PCT
  9203                                    WS-PL-TOL-AH-REFUND-PCT
  9204                                    WS-AH-PL-REF-OVS-PCT
  9205                                    WS-PL-TOL-AH-CLAIM.
  9206     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9207
  9208
  9209     if pb-issue
  9210        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9211           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9212        end-if
  9213        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9214           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9215           GO TO 0399-BENEFIT-NOT-FOUND
  9216        end-if
  9217     end-if
  9218
  9219     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9220        GO TO 0400-FIND-CARRIER.
  9221
  9222     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9223
  9224     IF WK-AH-BEN-ADDR NOT = ZEROS
  9225         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9226         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9227         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9228         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9229           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9230             GO TO 0311-AH-BENEFIT-SEARCH
  9231         ELSE
  9232             NEXT SENTENCE
  9233     ELSE
  9234         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9235
  9236     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9237     MOVE '5'                    TO CNTL-REC-TYPE.
  9238     MOVE +0                     TO CNTL-SEQ-NO.
  9239     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9240
  9241     MOVE '2' TO RC-SW-2.
  9242     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9243
  9244     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9245        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9246          GO TO 0399-BENEFIT-NOT-FOUND.
  9247
  9248     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9249
  9250 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 170
* EL050.cbl
  9251
  9252     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9253
  9254     IF NO-BENEFIT-FOUND
  9255         GO TO 0399-BENEFIT-NOT-FOUND.
  9256
  9257     IF WS-BEN-CD = '99'
  9258        GO TO 0399-BENEFIT-NOT-FOUND.
  9259
  9260     IF PB-COMPANY-ID  =  'NCL'
  9261         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9262             GO TO 0314-A-H-BENEFIT-FOUND.
  9263
  9264     MOVE +1                     TO SUB5.
  9265     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9266
  9267* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9268* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9269     IF PB-COMPANY-ID = 'DMD'
  9270         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9271
  9272 0312-EDIT-ACCT-AH-BENEFITS.
  9273
  9274     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9275        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9276           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9277                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9278           GO TO 03XX-GET-AH-ERPLAN.
  9279
  9280     IF SUB5 LESS THAN +20
  9281        ADD +1                   TO SUB5
  9282        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9283
  9284     MOVE +1                     TO SUB5.
  9285
  9286     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9287        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9288
  9289 0313-EDIT-DMD-EXTRA-BENEFITS.
  9290
  9291     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9292        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9293           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9294                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9295           GO TO 03XX-GET-AH-ERPLAN.
  9296
  9297     IF SUB5 LESS THAN +30
  9298        ADD +1                   TO SUB5
  9299        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9300
  9301     MOVE +1                     TO SUB5.
  9302
  9303 03XX-EDIT-FOR-NINETY-AH.
  9304
  9305***************************************************************
  9306*                                                             *
  9307*    NINETY BENEFIT PLAN TYPES:                               *
  9308*                                                             *
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 171
* EL050.cbl
  9309*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9310*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9311*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9312*           BENEFIT CONTROLS.                                 *
  9313*      99 = ALL BENEFITS.                                     *
  9314*                                                             *
  9315***************************************************************
  9316
  9317     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9318                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9319
  9320     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9321       AND
  9322        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9323        GO TO 03XX-GET-AH-ERPLAN.
  9324
  9325     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9326       AND
  9327        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9328           IF (PB-I-INDV-GRP-OVRD = 'I')
  9329              OR
  9330           ((AM-IG = '1') AND
  9331           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9332              OR
  9333           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9334           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9335           (AM-IG NOT = '2'))
  9336              GO TO 03XX-GET-AH-ERPLAN.
  9337
  9338     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9339       AND
  9340        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9341           IF (PB-I-INDV-GRP-OVRD = 'G')
  9342              OR
  9343           ((AM-IG = '2') AND
  9344           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9345              OR
  9346           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9347           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9348           (AM-IG NOT = '1'))
  9349              GO TO 03XX-GET-AH-ERPLAN.
  9350
  9351     IF SUB5 LESS THAN +20
  9352        ADD +1                   TO SUB5
  9353        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9354
  9355     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9356        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9357
  9358     MOVE +1                    TO SUB5.
  9359
  9360 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9361
  9362     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9363                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9364
  9365     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9366       AND
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 172
* EL050.cbl
  9367        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9368        GO TO 03XX-GET-AH-ERPLAN.
  9369
  9370     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9371       AND
  9372        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9373           IF (PB-I-INDV-GRP-OVRD = 'I')
  9374              OR
  9375           ((AM-IG = '1') AND
  9376           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9377              OR
  9378           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9379           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9380           (AM-IG NOT = '2'))
  9381              GO TO 03XX-GET-AH-ERPLAN.
  9382
  9383     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9384       AND
  9385        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9386           IF (PB-I-INDV-GRP-OVRD = 'G')
  9387              OR
  9388           ((AM-IG = '2') AND
  9389           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9390              OR
  9391           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9392           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9393           (AM-IG NOT = '1'))
  9394              GO TO 03XX-GET-AH-ERPLAN.
  9395
  9396     IF SUB5 LESS THAN +30
  9397        ADD +1                   TO SUB5
  9398        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9399
  9400 03XX-EDIT-FOR-NINETY-AH-CONT.
  9401
  9402     MOVE +99                    TO SUB5.
  9403
  9404     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9405
  9406     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9407        IF PB-ISSUE
  9408           MOVE ER-1925          TO  WS-ERROR
  9409           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9410
  9411     GO TO 0314-A-H-BENEFIT-FOUND.
  9412
  9413 03XX-GET-AH-ERPLAN.
  9414
  9415     IF WK-PLAN-ADDR EQUAL +0
  9416         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9417
  9418     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9419     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9420     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9421     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9422     MOVE 'Y'                    TO PLAN-MASTER-SW
  9423                                    PLAN-MASTER-AH-SW.
  9424*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 173
* EL050.cbl
  9425     GO TO 03XX-ERPLAN-AH-READ.
  9426
  9427 03XX-ERPLAN-AH-GETMAIN.
  9428
  9429     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9430     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9431
  9432 03XX-ERPLAN-AH-READ.
  9433
  9434     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9435     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9436     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9437     MOVE PB-SV-STATE            TO PLAN-STATE.
  9438     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9439     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9440     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9441     MOVE WS-SAVE-BENEFIT-REVISION
  9442                                 TO PLAN-REVISION-NO.
  9443
  9444     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9445     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9446
  9447     IF PB-COMPANY-ID = 'NCL'
  9448       IF NOT AH-PLAN-MASTER-FOUND
  9449         IF NOT PB-POLICY-IS-DECLINED  AND
  9450            NOT PB-POLICY-IS-VOIDED
  9451             MOVE  ER-1922         TO  WS-ERROR
  9452             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9453             GO TO 0314-A-H-BENEFIT-FOUND.
  9454
  9455     IF NOT AH-PLAN-MASTER-FOUND
  9456        GO TO 0314-A-H-BENEFIT-FOUND.
  9457
  9458 XXXX-CHECK-AH-PLAN-KEY.
  9459
  9460     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9461        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9462        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9463        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9464        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9465        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9466        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9467        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9468        MOVE 'N'                 TO PLAN-MASTER-SW
  9469          GO TO 03XX-ERPLAN-AH-READ.
  9470
  9471     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9472
  9473     IF  PB-CANCELLATION
  9474         GO TO  0313-AH-ACCT-BEN-FOUND.
  9475
  9476     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9477       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9478          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9479          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9480             MOVE ER-2644             TO WS-ERROR
  9481             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9482          ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 174
* EL050.cbl
  9483             NEXT SENTENCE
  9484       ELSE
  9485          IF PB-COMPANY-ID NOT = 'NCL'
  9486             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9487                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9488
  9489 0313-AH-ACCT-BEN-FOUND.
  9490
  9491     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9492
  9493     IF PL-DEV-CODE NOT = SPACES
  9494        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9495
  9496     IF PL-DEV-PCT NUMERIC AND
  9497        PL-DEV-PCT NOT = ZEROS
  9498        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9499
  9500     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9501        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9502
  9503     IF PL-TOL-REF-AMT NOT EQUAL +0
  9504        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9505
  9506     IF PL-TOL-PREM-PCT GREATER THAN +0
  9507        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9508
  9509     IF PL-TOL-REF-PCT GREATER THAN +0
  9510        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9511
  9512     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9513        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9514
  9515     IF PL-OVER-SHORT-AMT NUMERIC AND
  9516                          PL-OVER-SHORT-AMT > +0
  9517        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9518
  9519     IF PL-OVER-SHORT-PCT NUMERIC AND
  9520                          PL-OVER-SHORT-PCT > +0
  9521        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9522
  9523     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9524        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9525        IF WS-IG-OVRD-AM EQUAL SPACES
  9526            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9527
  9528 0314-A-H-BENEFIT-FOUND.
  9529
  9530     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9531
  9532     IF PB-ISSUE
  9533        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9534       ELSE
  9535        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9536
  9537     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9538     if cf-maximum-benefits (sub3) numeric
  9539        move cf-maximum-benefits (sub3)
  9540                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 175
* EL050.cbl
  9541     else
  9542        move zeros               to ws-ah-max-bens
  9543     end-if
  9544     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9545     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9546     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9547                                         WS-AH-REFUND-CALC.
  9548
  9549     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9550        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9551
  9552     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9553        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9554     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9555
  9556     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9557     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9558     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9559     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9560     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9561     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9562
  9563     IF PB-COMPANY-ID = 'NCL'  AND
  9564        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9565         NEXT SENTENCE
  9566     ELSE
  9567         IF SUB5 NOT GREATER THAN +20
  9568            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9569                MOVE WS-SAVE-BENEFIT-REM-TERM
  9570                                      TO WS-AM-AH-BENE-REM-TERM
  9571                                         EC-BR-AH-REM-TERM-CALC.
  9572
  9573     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9574     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9575
  9576     GO TO 0400-FIND-CARRIER.
  9577
  9578 0399-BENEFIT-NOT-FOUND.
  9579
  9580     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9581     MOVE ER-2605                TO WS-ERROR.
  9582     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9583
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 176
* EL050.cbl
  9585
  9586 0400-FIND-CARRIER.
  9587
  9588     MOVE PB-SV-CARRIER          TO WS-CARR.
  9589
  9590     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9591     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9592     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9593     MOVE '6'                    TO CNTL-REC-TYPE.
  9594
  9595*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9596     MOVE SPACE                  TO WS-DMD-RATING-SW
  9597                                    EC-BR-DMD-RATING-SW.
  9598
  9599     MOVE '2'                    TO RC-SW-1.
  9600     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9601
  9602     IF NOT CF-CARRIER-MASTER
  9603        GO TO 0400-CARRIER-NOT-FOUND.
  9604
  9605 0400-BUILD-CARR-TOL.
  9606
  9607     IF CF-CR-TOL-PREM NUMERIC AND
  9608        CF-CR-TOL-PREM GREATER THAN +0
  9609        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9610                                    WS-TOL-AH-PREM.
  9611
  9612     IF CF-CR-TOL-REFUND NUMERIC AND
  9613        CF-CR-TOL-REFUND GREATER THAN +0
  9614        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9615                                    WS-TOL-AH-REFUND.
  9616
  9617     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9618        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9619        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9620                                    WS-AH-REFUND-OVS-AMT.
  9621
  9622     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9623        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9624        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9625                                    WS-AH-REFUND-OVS-PCT.
  9626
  9627     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9628        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9629        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9630                                    WS-TOL-AH-PREM-PCT.
  9631
  9632     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9633        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9634        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9635                                     WS-TOL-AH-REFUND-PCT.
  9636
  9637     IF CF-COMPANY-ID EQUAL 'DMD'
  9638         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9639                                    EC-BR-DMD-RATING-SW.
  9640
  9641     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9642     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 177
* EL050.cbl
  9643        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9644     END-IF
  9645     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9646        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9647     END-IF
  9648     IF WS-TOL-CLP-PCT = ZEROS
  9649        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9650     END-IF
  9651
  9652     IF WS-SPP-LEASE-COMM = ZEROS
  9653        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9654     END-IF
  9655     GO TO 0400-FIND-ERPDEF.
  9656
  9657 0400-CARRIER-NOT-FOUND.
  9658
  9659     MOVE ER-2602                TO WS-ERROR.
  9660     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9661
  9662 0400-FIND-ERPDEF.
  9663*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9664     IF (PB-COMPANY-ID = 'DCC')
  9665        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9666        CONTINUE
  9667     ELSE
  9668        GO TO 0400-FIND-ERCOMP
  9669     END-IF
  9670     MOVE ' '                    TO PDEF-MASTER-SW
  9671     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9672     MOVE PB-STATE               TO ERPDEF-STATE
  9673     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9674        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9675     END-IF
  9676     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9677     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9678     IF PB-ISSUE
  9679        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9680     ELSE
  9681        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9682     END-IF
  9683     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9684     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9685     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9686     IF PDEF-MASTER-FOUND
  9687        MOVE 'N'                 TO PDEF-MASTER-SW
  9688        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9689        IF PDEF-MASTER-FOUND
  9690           IF (ERPDEF-KEY-SAVE (1:16) =
  9691                        PD-CONTROL-PRIMARY (1:16))
  9692              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9693              CONTINUE
  9694           ELSE
  9695              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9696              IF (ERPDEF-KEY-SAVE (1:16) =
  9697                        PD-CONTROL-PRIMARY (1:16))
  9698                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9699                 CONTINUE
  9700              ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 178
* EL050.cbl
  9701                 MOVE 'N'        TO PDEF-MASTER-SW
  9702              END-IF
  9703           END-IF
  9704        END-IF
  9705        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9706     END-IF
  9707     IF PDEF-MASTER-FOUND
  9708        IF PD-TRUNCATED = 'Y'
  9709           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9710        END-IF
  9711     END-IF
  9712     .
  9713 0400-FIND-ERCOMP.
  9714     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9715        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9716           (WS-SUB1 > +10)
  9717           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9718                 OR 'A' OR 'N'
  9719              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9720              MOVE PB-CARRIER    TO COMP-CARRIER
  9721              MOVE PB-GROUPING   TO COMP-GROUPING
  9722              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9723              MOVE AM-AGT (WS-SUB1)
  9724                                 TO COMP-FIN-RESP
  9725              MOVE 'G'           TO COMP-TYPE
  9726              PERFORM 8582-READ-COMPENSATION-MASTER
  9727                                 THRU 8582-EXIT
  9728              IF COMP-MASTER-FOUND
  9729                 IF CO-GA-INACTIVE
  9730                    MOVE ER-2763 TO WS-ERROR
  9731                    PERFORM 9900-ERROR-FORMAT
  9732                                 THRU 9900-EXIT
  9733                    MOVE +11     TO WS-SUB1
  9734                 END-IF
  9735                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9736                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9737                    MOVE ER-2788 TO WS-ERROR
  9738                    PERFORM 9900-ERROR-FORMAT
  9739                                 THRU 9900-EXIT
  9740                    MOVE +11     TO WS-SUB1
  9741                 END-IF
  9742              END-IF
  9743           END-IF
  9744        END-PERFORM
  9745     END-IF
  9746     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9747        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9748           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9749                                    WS-CLP-STATE
  9750        ELSE
  9751           MOVE SPACES           TO PB-I-CLP-STATE
  9752                                    WS-CLP-STATE
  9753        END-IF
  9754     END-IF
  9755
  9756     IF (PB-COMPANY-ID = 'DCC')
  9757        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9758        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 179
* EL050.cbl
  9759        CONTINUE
  9760     ELSE
  9761        GO TO 0400-FIND-STATE-RECORD
  9762     END-IF
  9763     MOVE SPACES                 TO WS-CLP-STATE
  9764     MOVE +0                     TO WS-BANK-FEE
  9765                                    WS-BANK-LFEE
  9766                                    WS-BANK-NOCHRGB
  9767
  9768     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9769     IF (PB-ISSUE)
  9770        AND (PB-I-BANK-NUMBER NOT =
  9771            SPACES AND ZEROS AND LOW-VALUES)
  9772        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9773     ELSE
  9774        IF (PB-CANCELLATION)
  9775           AND (PB-CI-BANK-NUMBER NOT =
  9776                SPACES AND ZEROS AND LOW-VALUES)
  9777           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9778        END-IF
  9779     END-IF
  9780     IF COMP-FIN-RESP NOT = LOW-VALUES
  9781        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9782        MOVE PB-CARRIER          TO COMP-CARRIER
  9783        MOVE PB-GROUPING         TO COMP-GROUPING
  9784        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9785        MOVE 'B'                 TO COMP-TYPE
  9786        PERFORM 8582-READ-COMPENSATION-MASTER
  9787                                 THRU 8582-EXIT
  9788        IF COMP-MASTER-FOUND
  9789           IF CO-MAX-BANK-FEE NOT NUMERIC
  9790              MOVE +0            TO CO-MAX-BANK-FEE
  9791           END-IF
  9792           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9793              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9794           END-IF
  9795           IF CO-GA-INACTIVE
  9796              MOVE ER-2763       TO WS-ERROR
  9797              PERFORM 9900-ERROR-FORMAT
  9798                                 THRU 9900-EXIT
  9799           END-IF
  9800           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9801              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9802              MOVE ER-2788 TO WS-ERROR
  9803              PERFORM 9900-ERROR-FORMAT
  9804                                 THRU 9900-EXIT
  9805              MOVE +11     TO WS-SUB1
  9806           END-IF
  9807           IF WS-AH-BEN-CATEGORY = 'G'
  9808              MOVE CO-MAX-BANK-FEE
  9809                                 TO WS-BANK-FEE
  9810                                    PB-I-BANK-FEE
  9811           ELSE
  9812              MOVE CO-MAX-BANK-FEE-LEASE
  9813                                 TO WS-BANK-LFEE
  9814                                    PB-I-BANK-FEE
  9815           END-IF
  9816           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 180
* EL050.cbl
  9817              AND (WS-AH-REFUND-CALC = 'G'))
  9818                        OR
  9819              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9820              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9821              CONTINUE
  9822           ELSE
  9823              MOVE ER-2789 TO WS-ERROR
  9824              PERFORM 9900-ERROR-FORMAT
  9825                                 THRU 9900-EXIT
  9826           END-IF
  9827           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9828                                    PB-I-CLP-STATE
  9829           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9830           MOVE CO-CARRIER       TO BXRF-CARRIER
  9831           MOVE CO-GROUPING      TO BXRF-GROUPING
  9832           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9833           MOVE BXRF-MAX-REC-LENGTH
  9834                                 TO BXRF-REC-LENGTH
  9835           PERFORM 8584-READ-BANK-CROSS-REF
  9836                                 THRU 8584-EXIT
  9837           IF BXRF-MASTER-FOUND
  9838              MOVE ' '           TO BANK-ACCT-SW
  9839              MOVE BK-BANK-POINTER-CNT
  9840                                 TO BK-BANK-POINTER-CNT
  9841              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9842                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9843                 OR (BANK-ACCT-FOUND)
  9844                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9845                    AND (BK-AM-EXP-DT (WS-SUB1)
  9846                                 > PB-CERT-EFF-DT)
  9847                    AND (BK-AM-EFF-DT (WS-SUB1)
  9848                                 NOT > PB-CERT-EFF-DT)
  9849                    SET BANK-ACCT-FOUND TO TRUE
  9850                 END-IF
  9851              END-PERFORM
  9852              IF NOT BANK-ACCT-FOUND
  9853                 MOVE ZEROS      TO WS-BANK-FEE
  9854                                    WS-BANK-LFEE
  9855                 MOVE ER-2869    TO WS-ERROR
  9856                 PERFORM 9900-ERROR-FORMAT
  9857                                 THRU 9900-EXIT
  9858              ELSE
  9859                 PERFORM 5000-PROCESS-REPS
  9860                                 THRU 5000-EXIT
  9861                 IF AGENT-MASTER-FOUND
  9862                    MOVE +0      TO WS-BANK-FEE
  9863                                    WS-BANK-LFEE
  9864*                   MOVE AG-SPP-FEES (1)
  9865*                                TO PB-I-BANK-FEE
  9866*                                   WS-BANK-FEE
  9867                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9868                       (WS-SUB1 > +10)
  9869                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9870                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9871                       END-IF
  9872                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9873                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9874                       END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 181
* EL050.cbl
  9875                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9876                          AG-SPP-FEES (WS-SUB1)
  9877                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9878                          AG-SPP-LFEES (WS-SUB1)
  9879                    END-PERFORM
  9880                    IF WS-AH-BEN-CATEGORY = 'G'
  9881                       MOVE WS-BANK-FEE
  9882                                 TO PB-I-BANK-FEE
  9883                    ELSE
  9884                       MOVE WS-BANK-LFEE
  9885                                 TO PB-I-BANK-FEE
  9886                    END-IF
  9887                 END-IF
  9888              END-IF
  9889           END-IF
  9890        ELSE
  9891           MOVE ER-2879          TO WS-ERROR
  9892           PERFORM 9900-ERROR-FORMAT
  9893                                 THRU 9900-EXIT
  9894        END-IF
  9895     ELSE
  9896        MOVE ER-2879             TO WS-ERROR
  9897        PERFORM 9900-ERROR-FORMAT
  9898                                 THRU 9900-EXIT
  9899     END-IF
  9900     IF WS-AH-BEN-CATEGORY = 'G'
  9901        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9902        + WS-BANK-FEE
  9903     ELSE
  9904        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9905        + WS-BANK-LFEE
  9906     END-IF
  9907     .
  9908 0400-FIND-STATE-RECORD.
  9909
  9910     IF WK-STATE-ADDR NOT = ZEROS
  9911         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9912         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9913         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9914         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9915         IF PB-SV-STATE = CF-STATE-CODE
  9916             GO TO 0405-CONTINUE-EDIT
  9917         ELSE
  9918             NEXT SENTENCE
  9919     ELSE
  9920         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9921
  9922     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9923     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9924     MOVE '3'                    TO CNTL-REC-TYPE.
  9925     MOVE +0                     TO CNTL-SEQ-NO.
  9926
  9927     MOVE '3'                    TO RC-SW-2.
  9928     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9929
  9930     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9931        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9932        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 182
* EL050.cbl
  9933        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9934                                    WS-TOL-AH-CLAIM
  9935                                    WS-MINIMUM-REFUND
  9936                                    WS-TOL-LF-PREM
  9937                                    WS-TOL-AH-PREM
  9938                                    WS-TOL-LF-REFUND
  9939                                    WS-TOL-AH-REFUND
  9940                                    EC-ST-TOL-PREM-PCT
  9941                                    WS-TOL-LF-PREM-PCT
  9942                                    WS-TOL-AH-PREM-PCT
  9943                                    EC-ST-TOL-REFUND-PCT
  9944                                    WS-TOL-LF-REFUND-PCT
  9945                                    WS-TOL-AH-REFUND-PCT
  9946                                    EC-ST-TOL-PREM
  9947                                    EC-ST-TOL-REFUND
  9948                                    EC-ST-FST-PMT-DAYS-MAX
  9949                                    WS-FREE-LOOK-PERIOD
  9950                                    WS-ST-LF-PREM-TAX
  9951                                    WS-ST-AH-PREM-TAX-I
  9952                                    WS-ST-AH-PREM-TAX-G
  9953                                    WS-BANK-FEE
  9954                                    WS-BANK-LFEE
  9955                                    WS-TOL-CLP-PCT
  9956                                    WS-SPP-LEASE-COMM
  9957                                    WS-INT-PERIODS
  9958                                    WS-EXTRA-PMTS
  9959        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9960                                    EC-ST-FST-PMT-DAYS-CHG
  9961                                    WS-LF-REM-TERM-CALC
  9962                                    WS-LF-REFUND-CALC
  9963                                    EC-ST-LF-REM-TERM-CALC
  9964                                    EC-ST-LF-REFUND-CALC
  9965                                    WS-AH-REM-TERM-CALC
  9966                                    WS-AH-REFUND-CALC
  9967                                    WS-LF-BEN-CATEGORY
  9968                                    WS-AH-BEN-CATEGORY
  9969                                    WS-CLP-STATE
  9970                                    WS-ST-REFUND-CLAIM-FLAG
  9971                                    WS-ST-CAUSAL-STATE
  9972                                    ws-st-agent-sig-edit
  9973                                    EC-ST-AH-REM-TERM-CALC
  9974                                    EC-ST-AH-REFUND-CALC
  9975          GO TO 0499-STATE-NOT-FOUND.
  9976
  9977     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9978
  9979 0405-CONTINUE-EDIT.
  9980
  9981     IF (PB-COMPANY-ID <> 'AHL')
  9982        and (pb-issue)
  9983        MOVE +0                  TO SUB3
  9984        INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9985        IF SUB3 > +0
  9986           MOVE ER-3270          TO WS-ERROR
  9987           PERFORM 9900-ERROR-FORMAT
  9988                                 THRU 9900-EXIT
  9989        else
  9990           IF PB-CERT-PRIME NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 183
* EL050.cbl
  9991              MOVE ER-2722       TO WS-ERROR
  9992              PERFORM 9900-ERROR-FORMAT
  9993                                 THRU 9900-EXIT
  9994           end-if
  9995        END-IF
  9996     END-IF
  9997     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9998
  9999     IF CF-ST-TOL-CLAIM NOT = ZEROS
 10000        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
 10001                                    WS-TOL-AH-CLAIM.
 10002
 10003     IF CF-ST-REFUND-MIN NOT NUMERIC
 10004        MOVE ZEROS               TO CF-ST-REFUND-MIN.
 10005
 10006     IF CF-ST-REFUND-MIN NOT = ZEROS
 10007        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
 10008
 10009     IF CF-ST-TOL-PREM  NOT = ZEROS
 10010        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
 10011                                    WS-TOL-AH-PREM
 10012        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
 10013
 10014     IF CF-ST-TOL-REFUND NOT = ZEROS
 10015        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
 10016                                    WS-TOL-AH-REFUND
 10017        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
 10018
 10019     IF CF-ST-OVR-SHT-AMT NUMERIC AND
 10020        CF-ST-OVR-SHT-AMT GREATER THAN +0
 10021        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
 10022                                    WS-AH-REFUND-OVS-AMT
 10023                                    EC-ST-OVR-SHT-AMT.
 10024
 10025     IF CF-ST-TOL-PREM-PCT NUMERIC AND
 10026        CF-ST-TOL-PREM-PCT GREATER THAN +0
 10027        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
 10028                                    WS-TOL-LF-PREM-PCT
 10029                                    WS-TOL-AH-PREM-PCT.
 10030
 10031     IF CF-ST-TOL-REF-PCT NUMERIC AND
 10032        CF-ST-TOL-REF-PCT GREATER THAN +0
 10033        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
 10034                                    WS-TOL-LF-REFUND-PCT
 10035                                    WS-TOL-AH-REFUND-PCT.
 10036
 10037     IF CF-ST-OVR-SHT-PCT NUMERIC AND
 10038        CF-ST-OVR-SHT-PCT GREATER THAN +0
 10039        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
 10040                                    WS-AH-REFUND-OVS-PCT
 10041                                    EC-ST-OVR-SHT-PCT.
 10042
 10043     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
 10044     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
 10045
 10046     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
 10047          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
 10048
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 184
* EL050.cbl
 10049     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
 10050     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
 10051     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
 10052
 10053     IF CF-ST-LF-PREM-TAX NUMERIC
 10054        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10055     END-IF
 10056     IF CF-ST-AH-PREM-TAX-I NUMERIC
 10057        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10058     END-IF
 10059     IF CF-ST-AH-PREM-TAX-G NUMERIC
 10060        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10061     END-IF
 10062
 10063     IF CF-ST-REF-AH-DEATH-IND > SPACES
 10064         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 10065     END-IF.
 10066
 10067     IF CF-ST-CAUSAL-STATE > SPACES
 10068         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
 10069     END-IF.
 10070     if cf-st-extra-interest-periods not numeric
 10071        move zeros               to cf-st-extra-interest-periods
 10072     end-if
 10073     if cf-st-extra-payments not numeric
 10074        move zeros               to cf-st-extra-payments
 10075     end-if
 10076
 10077     move cf-st-extra-interest-periods
 10078                                 to ws-int-periods
 10079     move cf-st-extra-payments   to ws-extra-pmts
 10080     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
 10081     move cf-st-net-only-state   to ws-net-only-state
 10082     if cf-st-comm-cap-sl not numeric
 10083        move zeros               to cf-st-comm-cap-sl
 10084     end-if
 10085     if cf-st-comm-cap-jl not numeric
 10086        move zeros               to cf-st-comm-cap-jl
 10087     end-if
 10088     if cf-st-comm-cap-sa not numeric
 10089        move zeros               to cf-st-comm-cap-sa
 10090     end-if
 10091     if cf-st-comm-cap-ja not numeric
 10092        move zeros               to cf-st-comm-cap-ja
 10093     end-if
 10094     if cf-st-ga-comm-cap-sl not numeric
 10095        move zeros               to cf-st-ga-comm-cap-sl
 10096     end-if
 10097     if cf-st-ga-comm-cap-jl not numeric
 10098        move zeros               to cf-st-ga-comm-cap-jl
 10099     end-if
 10100     if cf-st-ga-comm-cap-sa not numeric
 10101        move zeros               to cf-st-ga-comm-cap-sa
 10102     end-if
 10103     if cf-st-ga-comm-cap-ja not numeric
 10104        move zeros               to cf-st-ga-comm-cap-ja
 10105     end-if
 10106
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 185
* EL050.cbl
 10107     if cf-st-tot-comm-cap-sl not numeric
 10108        move zeros               to cf-st-tot-comm-cap-sl
 10109     end-if
 10110     if cf-st-tot-comm-cap-jl not numeric
 10111        move zeros               to cf-st-tot-comm-cap-jl
 10112     end-if
 10113     if cf-st-tot-comm-cap-sa not numeric
 10114        move zeros               to cf-st-tot-comm-cap-sa
 10115     end-if
 10116     if cf-st-tot-comm-cap-ja not numeric
 10117        move zeros               to cf-st-tot-comm-cap-ja
 10118     end-if
 10119
 10120     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10121     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10122     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10123     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10124     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10125     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10126     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10127     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10128     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10129     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10130     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10131     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10132     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10133     IF WS-LF-BENEFIT-CD = ZEROS
 10134        GO TO 0410-CHECK-AH.
 10135
 10136     IF CF-ST-RT-CALC NOT = SPACES
 10137        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10138                                    EC-ST-LF-REM-TERM-CALC
 10139     END-IF
 10140
 10141     IF WS-LF-COVERAGE-TYPE = 'R'
 10142        IF WS-LF-EARNINGS-CALC = '5'
 10143           IF CF-ST-RF-LN-CALC > '0'
 10144              MOVE CF-ST-RF-LN-CALC
 10145                                 TO WS-LF-REFUND-CALC
 10146                                    EC-ST-LF-REFUND-CALC
 10147           END-IF
 10148        ELSE
 10149           IF CF-ST-RF-LR-CALC > '0'
 10150              MOVE CF-ST-RF-LR-CALC
 10151                                 TO WS-LF-REFUND-CALC
 10152                                    EC-ST-LF-REFUND-CALC
 10153           END-IF
 10154        END-IF
 10155     ELSE
 10156        IF CF-ST-RF-LL-CALC > '0'
 10157           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10158                                    EC-ST-LF-REFUND-CALC
 10159        END-IF
 10160     END-IF
 10161
 10162     IF CF-ST-RT-CALC NOT = SPACES
 10163        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10164                                    EC-ST-LF-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 186
* EL050.cbl
 10165     END-IF
 10166
 10167     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10168     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10169
 10170     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10171
 10172     IF NO-BENEFIT-FOUND
 10173        GO TO 0410-CHECK-AH.
 10174
 10175     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10176        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10177                                 TO EC-ST-LF-REM-TERM-CALC
 10178                                    WS-LF-REM-TERM-CALC
 10179     END-IF
 10180
 10181     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10182        MOVE CF-ST-REFUND-CALC (SUB3)
 10183                                 TO WS-LF-REFUND-CALC
 10184                                    EC-ST-LF-REFUND-CALC
 10185     END-IF
 10186*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10187     if cf-st-extra-periods (sub3) not numeric
 10188        move zeros               to cf-st-extra-periods (sub3)
 10189     end-if
 10190     if cf-st-extra-periods (sub3) > zeros
 10191        if ws-lf-ben-category = 'P'
 10192           move cf-st-extra-periods (sub3)
 10193                                 to ws-extra-pmts
 10194        else
 10195           if ws-lf-ben-category = 'I'
 10196              move cf-st-extra-periods (sub3)
 10197                                 to ws-int-periods
 10198           end-if
 10199        end-if
 10200     end-if
 10201     .
 10202 0410-CHECK-AH.
 10203
 10204     IF WS-AH-BENEFIT-CD = ZEROS
 10205        GO TO 0500-SET-ACCOUNT.
 10206
 10207     IF CF-ST-RT-CALC NOT = SPACES
 10208        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10209                                    EC-ST-AH-REM-TERM-CALC
 10210     END-IF
 10211
 10212     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10213        IF CF-ST-RF-CP-CALC > '0'
 10214           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10215                                    EC-ST-AH-REFUND-CALC
 10216        END-IF
 10217     ELSE
 10218        IF CF-ST-RF-AH-CALC > '0'
 10219           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10220                                    EC-ST-AH-REFUND-CALC
 10221        END-IF
 10222     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 187
* EL050.cbl
 10223     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10224     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10225
 10226     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10227
 10228     IF NO-BENEFIT-FOUND
 10229        GO TO 0500-SET-ACCOUNT.
 10230
 10231     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10232        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10233                                 TO WS-AH-REM-TERM-CALC
 10234                                    EC-ST-AH-REM-TERM-CALC
 10235     END-IF
 10236
 10237     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10238        MOVE CF-ST-REFUND-CALC (SUB3)
 10239                                 TO WS-AH-REFUND-CALC
 10240                                    EC-ST-AH-REFUND-CALC
 10241     END-IF
 10242
 10243*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10244
 10245     GO TO 0500-SET-ACCOUNT.
 10246
 10247 0499-STATE-NOT-FOUND.
 10248
 10249     MOVE ER-2603                TO WS-ERROR.
 10250     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10251
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 188
* EL050.cbl
 10253
 10254 0500-SET-ACCOUNT.
 10255*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10256     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10257        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10258        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10259        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10260        MOVE '3'                 TO CNTL-REC-TYPE
 10261        MOVE +0                  TO CNTL-SEQ-NO
 10262
 10263        MOVE '3'                 TO RC-SW-2
 10264        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10265
 10266        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10267           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10268           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10269           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10270                                    WS-ST-AH-PREM-TAX-I
 10271                                    WS-ST-AH-PREM-TAX-G
 10272        ELSE
 10273           IF CF-ST-LF-PREM-TAX NUMERIC
 10274              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10275           END-IF
 10276           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10277              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10278           END-IF
 10279           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10280              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10281           END-IF
 10282        END-IF
 10283        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10284     END-IF
 10285*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10286*  FOR DCC ONLY
 10287     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10288
 10289        MOVE ' '                 TO STAT-MASTER-SW
 10290        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10291        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10292        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10293        MOVE PB-STATE            TO ELSTAT-STATE
 10294        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10295           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10296        END-IF
 10297
 10298        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10299        SET BIN-TO-GREG          TO TRUE
 10300        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10301        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10302        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10303
 10304        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10305        IF STAT-MASTER-FOUND
 10306           MOVE 'N'              TO STAT-MASTER-SW
 10307           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10308           IF STAT-MASTER-FOUND
 10309              IF (ELSTAT-KEY-SAVE (1:12) =
 10310                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 189
* EL050.cbl
 10311                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10312                    MOVE 'F'        TO STAT-MASTER-SW
 10313                 ELSE
 10314                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10315                    IF (STAT-MASTER-FOUND)
 10316                       AND (ELSTAT-KEY-SAVE (1:12) =
 10317                           SF-CONTROL-PRIMARY (1:12))
 10318                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10319                       MOVE 'F'     TO STAT-MASTER-SW
 10320                    END-IF
 10321                 END-IF
 10322              END-IF
 10323           END-IF
 10324        END-IF
 10325
 10326        IF STAT-MASTER-SW = 'F'
 10327           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10328              and (sf-st-lf-prem-tax > zeros)
 10329              MOVE SF-ST-LF-PREM-TAX
 10330                                 TO WS-ST-LF-PREM-TAX
 10331           END-IF
 10332           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10333              and (sf-st-ah-prem-tax-i > zeros)
 10334              MOVE SF-ST-AH-PREM-TAX-I
 10335                                 TO WS-ST-AH-PREM-TAX-I
 10336           END-IF
 10337           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10338              and (sf-st-ah-prem-tax-g > zeros)
 10339              MOVE SF-ST-AH-PREM-TAX-G
 10340                                 TO WS-ST-AH-PREM-TAX-G
 10341           END-IF
 10342        END-IF
 10343     END-IF
 10344     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10345        AND (PB-ISSUE)
 10346        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10347        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10348        AND (AM-GPCD = 06)
 10349        MOVE 'Y'                 TO WS-GOOD-HIN
 10350        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10351           MOVE PB-I-VIN         TO WS-WORK-VIN
 10352           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10353              (V1 > 16)
 10354              IF WS-WORK-VIN (V1:1) NUMERIC
 10355                 MOVE WS-WORK-VIN-N (V1)
 10356                                 TO WS-ROW-B-VAL (V1)
 10357              ELSE
 10358                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10359                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10360                    OR (V2 > 26)
 10361                 END-PERFORM
 10362                 IF V2 < 27
 10363                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10364                 ELSE
 10365                    MOVE 'N'     TO WS-GOOD-HIN
 10366                 END-IF
 10367              END-IF
 10368              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 190
* EL050.cbl
 10369                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10370              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10371                 WS-ROW-D-VAL (V1)
 10372           END-PERFORM
 10373           MOVE ZEROS            TO WS-VIN-REMAINDER
 10374           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10375             REMAINDER WS-VIN-REMAINDER
 10376           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10377              CONTINUE
 10378           ELSE
 10379              MOVE 'N'           TO WS-GOOD-HIN
 10380           END-IF
 10381        ELSE
 10382           MOVE 'N'              TO WS-GOOD-HIN
 10383        END-IF
 10384        IF WS-GOOD-HIN NOT = 'Y'
 10385           MOVE ER-3826           TO WS-ERROR
 10386           PERFORM 9900-ERROR-FORMAT
 10387                                 THRU 9900-EXIT
 10388        END-IF
 10389     END-IF
 10390     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10391        AND (PB-ISSUE)
 10392        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10393        AND (AM-GPCD NOT = 06)
 10394        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10395           perform 3400-edit-vin thru 3400-exit
 10396        ELSE
 10397          MOVE ER-3826           TO WS-ERROR
 10398          PERFORM 9900-ERROR-FORMAT
 10399                                 THRU 9900-EXIT
 10400        END-IF
 10401     END-IF
 10402     if (pb-company-id = 'CID')
 10403        and (pb-issue)
 10404        and (pb-i-vin not = spaces and low-values and zeros)
 10405        perform 3400-edit-vin    thru 3400-exit
 10406     end-if
 10407******************************************************************
 10408******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10409******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10410******* METHODS.
 10411******************************************************************
 10412     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10413        IF PB-CANCELLATION
 10414           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10415              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10416                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10417                IF FORM-MASTER-FOUND
 10418                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10419******************************************************************
 10420
 10421     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10422     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10423
 10424     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10425     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10426     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 191
* EL050.cbl
 10427     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10428
 10429
 10430     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10431     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10432     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10433
 10434     IF AM-LF-OB-RATE NOT NUMERIC
 10435         MOVE ZERO               TO AM-LF-OB-RATE.
 10436
 10437     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10438         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10439
 10440     IF AM-AH-OB-RATE NOT NUMERIC
 10441         MOVE ZERO               TO AM-AH-OB-RATE.
 10442
 10443     IF WS-LF-JOINT-INDICATOR = 'J'
 10444         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10445     ELSE
 10446         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10447
 10448     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10449
 10450     IF WS-IG-OVRD-AM  EQUAL SPACE
 10451         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10452
 10453     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10454         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10455                                       WS-IG-OVRD
 10456     ELSE
 10457         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10458             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10459                                       WS-IG-OVRD
 10460         ELSE
 10461             MOVE AM-IG             TO WS-IG-OVRD-AH
 10462                                       WS-IG-OVRD.
 10463
 10464     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10465         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10466                                       WS-IG-OVRD
 10467     ELSE
 10468         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10469             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10470                                       WS-IG-OVRD
 10471         ELSE
 10472             MOVE AM-IG             TO WS-IG-OVRD-LF
 10473                                       WS-IG-OVRD.
 10474
 10475     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10476     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10477     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10478     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10479*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10480     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10481                                              TO 'PRLDSFCTIA'.
 10482
 10483     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10484     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 192
* EL050.cbl
 10485     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10486     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10487
 10488     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10489     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10490     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10491     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10492     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10493     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10494     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10495
 10496     IF WS-ACCT-AH-DEV-PCT > +0
 10497        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10498     ELSE
 10499        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10500
 10501     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10502        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10503     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10504        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10505
 10506        IF AM-EARN-METHOD-L = 'S'
 10507            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10508                                        WS-LF-REFUND-CALC.
 10509
 10510        IF AM-EARN-METHOD-R = 'S'
 10511            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10512                                        WS-LF-REFUND-CALC.
 10513
 10514     IF WS-LF-COVERAGE-TYPE = 'R'
 10515         IF AM-EARN-METHOD-R = 'R'
 10516            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10517                                    WS-LF-REFUND-CALC.
 10518     IF WS-LF-COVERAGE-TYPE = 'R'
 10519         IF AM-EARN-METHOD-R = 'P'
 10520            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10521                                    WS-LF-REFUND-CALC.
 10522     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10523         IF AM-EARN-METHOD-L = 'R'
 10524            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10525                                    WS-LF-REFUND-CALC.
 10526     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10527         IF AM-EARN-METHOD-L = 'P'
 10528            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10529                                    WS-LF-REFUND-CALC.
 10530     IF WS-LF-COVERAGE-TYPE = 'R'
 10531         IF AM-EARN-METHOD-R = 'A'
 10532            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10533                                    WS-LF-REFUND-CALC.
 10534     IF WS-LF-COVERAGE-TYPE = 'R'
 10535         IF AM-EARN-METHOD-R = 'M'
 10536            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10537                                    WS-LF-REFUND-CALC.
 10538     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10539         IF AM-EARN-METHOD-L = 'A'
 10540            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10541                                    WS-LF-REFUND-CALC.
 10542     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 193
* EL050.cbl
 10543         IF AM-EARN-METHOD-L = 'M'
 10544            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10545                                    WS-LF-REFUND-CALC.
 10546
 10547     IF AM-EARN-METHOD-A = 'R'
 10548        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10549                                    WS-AH-REFUND-CALC.
 10550     IF AM-EARN-METHOD-A = 'P'
 10551        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10552                                    WS-AH-REFUND-CALC.
 10553     IF AM-EARN-METHOD-A = 'C'
 10554        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10555                                    WS-AH-REFUND-CALC.
 10556     IF AM-EARN-METHOD-A = 'A'
 10557        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10558                                    WS-AH-REFUND-CALC.
 10559     IF AM-EARN-METHOD-A = 'M'
 10560        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10561                                    WS-AH-REFUND-CALC.
 10562     IF AM-EARN-METHOD-A = 'N'
 10563        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10564                                    WS-AH-REFUND-CALC.
 10565     IF AM-EARN-METHOD-A = 'S'
 10566        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10567                                    WS-AH-REFUND-CALC.
 10568
 10569     IF AM-TOL-PREM NOT = ZEROS
 10570        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10571                                    WS-TOL-AH-PREM.
 10572
 10573     IF AM-OVR-SHT-AMT NUMERIC AND
 10574                  AM-OVR-SHT-AMT > 0
 10575        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10576                                    EC-AM-LF-OVR-SHT-AMT
 10577                                    WS-AH-REFUND-OVS-AMT
 10578                                    EC-AM-AH-OVR-SHT-AMT.
 10579
 10580     IF AM-OVR-SHT-PCT NUMERIC AND
 10581                    AM-OVR-SHT-PCT > 0
 10582        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10583                                    EC-AM-LF-OVR-SHT-PCT
 10584                                    WS-AH-REFUND-OVS-PCT
 10585                                    EC-AM-AH-OVR-SHT-PCT.
 10586
 10587     IF AM-TOL-REF-PCT NUMERIC AND
 10588                  AM-TOL-REF-PCT > 0
 10589        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10590                                    WS-TOL-AH-REFUND-PCT.
 10591
 10592     IF AM-TOL-REF  NOT = ZEROS  AND
 10593                  AM-TOL-REF NUMERIC
 10594        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10595                                    EC-AM-LF-TOL-REFUND
 10596                                    WS-TOL-AH-REFUND
 10597                                    EC-AM-AH-TOL-REFUND.
 10598
 10599     IF AM-TOL-CLM  NOT = ZEROS
 10600        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 194
* EL050.cbl
 10601                                    WS-TOL-AH-CLAIM.
 10602
 10603     IF AM-CLP-TOL-PCT NOT NUMERIC
 10604        MOVE +0                  TO AM-CLP-TOL-PCT
 10605     END-IF
 10606
 10607     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10608        MOVE +0                  TO AM-SPP-LEASE-COMM
 10609     END-IF
 10610     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10611        MOVE WS-PL-TOL-LF-PREM-PCT
 10612                                 TO WS-TOL-LF-PREM-PCT.
 10613
 10614     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10615        MOVE WS-PL-TOL-AH-PREM-PCT
 10616                                 TO WS-TOL-AH-PREM-PCT.
 10617
 10618     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10619        MOVE WS-PL-TOL-LF-REFUND-PCT
 10620                                 TO WS-TOL-LF-REFUND-PCT.
 10621
 10622     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10623        MOVE WS-PL-TOL-AH-REFUND-PCT
 10624                                 TO WS-TOL-AH-REFUND-PCT.
 10625
 10626     IF WS-PL-REF-OVS-AMT > +0
 10627        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10628
 10629     IF WS-PL-REF-OVS-PCT > +0
 10630        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10631
 10632     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10633        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10634     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10635        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10636     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10637        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10638     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10639        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10640     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10641        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10642     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10643        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10644
 10645     IF WS-AH-PL-REF-OVS-AMT > +0
 10646        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10647
 10648     IF WS-AH-PL-REF-OVS-PCT > +0
 10649        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10650
 10651     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10652     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10653
 10654     IF PB-CANCELLATION
 10655        GO TO 3000-CONTINUE-EDIT.
 10656
 10657     MOVE +1 TO SUB1.
 10658     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 195
* EL050.cbl
 10659     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10660
 10661     IF CF-COMPANY-ID = 'DMD'
 10662       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10663         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10664        ELSE
 10665         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10666
 10667  0525-FIND-ACCT-COMM.
 10668     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10669        NEXT SENTENCE
 10670      ELSE
 10671         ADD +1 TO SUB1
 10672         IF SUB1 LESS +11
 10673            GO TO 0525-FIND-ACCT-COMM
 10674          ELSE
 10675             GO TO 0550-st-comm-cap-check.
 10676
 10677     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10678     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10679                                    PB-I-LIFE-COMMISSION.
 10680***  IF PB-COMPANY-ID = 'CRI'
 10681     IF PB-PREM-ACCTNG-ONLY
 10682         GO TO 0550-st-comm-cap-check.
 10683
 10684     MOVE '0530' TO CTBL-SW.
 10685     MOVE ' '    TO WS-CTBL-READ-SW.
 10686
 10687
 10688 0530-GET-AH-COMP.
 10689     IF NO-AH-COVERAGE  OR
 10690        NO-AH-BENEFIT-MATCH
 10691           GO TO 0540-NEXT-READ-STEP.
 10692
 10693     IF AM-A-COM (SUB1) NUMERIC
 10694        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10695         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10696         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10697         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10698         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10699     ELSE
 10700          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10701          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10702          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10703          MOVE ZEROS             TO WS-SUB1
 10704                                    WS-COMMISSION
 10705          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10706          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10707          IF WS-COMMISSION > ZEROS
 10708             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10709             GO TO 0540-NEXT-READ-STEP
 10710          END-IF
 10711          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10712          IF CTBL-TABLE-FOUND
 10713             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10714                                        PB-I-AH-TERM
 10715             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10716             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 196
* EL050.cbl
 10717             GO TO 0540-NEXT-READ-STEP
 10718          ELSE
 10719             IF FIRST-TIME-THROUGH
 10720                 GO TO 0530-GET-AH-COMP
 10721             ELSE
 10722                 MOVE ER-2609                TO WS-ERROR
 10723                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10724
 10725 0540-NEXT-READ-STEP.
 10726     MOVE '0540' TO CTBL-SW.
 10727     MOVE ' '    TO WS-CTBL-READ-SW.
 10728
 10729 0540-GET-LF-COMP.
 10730     IF NO-LIFE-COVERAGE  OR
 10731        NO-LF-BENEFIT-MATCH
 10732           GO TO 0550-st-comm-cap-check.
 10733
 10734     IF WS-LF-JOINT-INDICATOR = 'J'
 10735        IF AM-J-COM (SUB1) NUMERIC
 10736           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10737           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10738           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10739           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10740           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10741        ELSE
 10742           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10743           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10744           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10745           MOVE ZEROS                TO WS-SUB1
 10746                                        WS-COMMISSION
 10747           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10748           IF WS-COMMISSION > ZEROS
 10749              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10750              GO TO 0550-st-comm-cap-check
 10751           END-IF
 10752           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10753           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10754           IF CTBL-TABLE-FOUND
 10755              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10756              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10757              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10758              GO TO 0550-st-comm-cap-check
 10759           ELSE
 10760              IF FIRST-TIME-THROUGH
 10761                  GO TO 0540-GET-LF-COMP
 10762              ELSE
 10763                  MOVE ER-2609                TO WS-ERROR
 10764                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10765                  GO TO 0550-st-comm-cap-check.
 10766
 10767     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10768        IF AM-L-COM (SUB1) NUMERIC
 10769           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10770           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10771           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10772           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10773           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10774        ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 197
* EL050.cbl
 10775           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10776           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10777           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10778           MOVE ZEROS                TO WS-SUB1
 10779                                        WS-COMMISSION
 10780           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10781           IF WS-COMMISSION IS GREATER THAN ZEROS
 10782              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10783              GO TO 0550-st-comm-cap-check
 10784           END-IF
 10785           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10786           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10787           IF CTBL-TABLE-FOUND
 10788              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10789              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10790              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10791              GO TO 0550-st-comm-cap-check
 10792           ELSE
 10793              IF FIRST-TIME-THROUGH
 10794                  GO TO 0540-GET-LF-COMP
 10795              ELSE
 10796                  MOVE ER-2609                TO WS-ERROR
 10797                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10798
 10799 0550-st-comm-cap-check.
 10800
 10801     move +0                     to ws-tot-sl-wk-rate
 10802                                    ws-sl-wk-rate
 10803                                    ws-ga-sl-wk-rate
 10804                                    ws-tot-jl-wk-rate
 10805                                    ws-jl-wk-rate
 10806                                    ws-ga-jl-wk-rate
 10807                                    ws-tot-sa-wk-rate
 10808                                    ws-sa-wk-rate
 10809                                    ws-ga-sa-wk-rate
 10810                                    ws-tot-ja-wk-rate
 10811                                    ws-ja-wk-rate
 10812                                    ws-ga-ja-wk-rate
 10813     perform varying sub5 from +1 by +1 until
 10814        (sub5 > +10)
 10815        move +0                  to ws-wk-rate
 10816        if (am-gl-codes (sub5) <> 'Y')
 10817           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10818           if pb-i-lf-benefit-cd <> '  ' and '00'
 10819              move zeros         to ws-wk-rate
 10820              if (am-l-com (sub5) numeric)
 10821                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10822                 move am-l-com(sub5)
 10823                                 to ws-wk-rate
 10824              else
 10825                 move pb-company-cd to ctbl-company-cd
 10826                 move pb-i-lf-benefit-cd
 10827                                 to ctbl-ben-code
 10828                 move pb-i-lf-term  to ws-work-term
 10829                 move pb-life-override-l1
 10830                                 to ctbl-ben-type
 10831                 move zeros      to ws-sub1
 10832                                    ws-commission
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 198
* EL050.cbl
 10833                 move am-l-coma (sub5)
 10834                                 to ctbl-table
 10835                 move '0540'     to ctbl-sw
 10836                 perform 0552-get-it
 10837                                 thru 0552-exit
 10838              end-if
 10839              compute ws-tot-sl-wk-rate =
 10840                 ws-tot-sl-wk-rate + ws-wk-rate
 10841              if am-com-typ(sub5) = 'C' or 'D'
 10842                 compute ws-sl-wk-rate =
 10843                    ws-sl-wk-rate + ws-wk-rate
 10844              else
 10845                 if am-com-typ(sub5) = 'O' or 'P'
 10846                    compute ws-ga-sl-wk-rate =
 10847                       ws-ga-sl-wk-rate + ws-wk-rate
 10848                 end-if
 10849              end-if
 10850
 10851              move zeros         to ws-wk-rate
 10852              if (am-j-com (sub5) numeric)
 10853                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10854                 move am-j-com(sub5)
 10855                                 to ws-wk-rate
 10856              else
 10857                 move pb-company-cd to ctbl-company-cd
 10858                 move pb-i-lf-benefit-cd
 10859                                 to ctbl-ben-code
 10860                 move pb-i-lf-term  to ws-work-term
 10861                 move pb-life-override-l1
 10862                                 to ctbl-ben-type
 10863                 move zeros      to ws-sub1
 10864                                    ws-commission
 10865                 move am-j-coma (sub5)
 10866                                 to ctbl-table
 10867                 move '0540'     to ctbl-sw
 10868                 perform 0552-get-it
 10869                                 thru 0552-exit
 10870              end-if
 10871              compute ws-tot-jl-wk-rate =
 10872                 ws-tot-jl-wk-rate + ws-wk-rate
 10873              if am-com-typ(sub5) = 'C' or 'D'
 10874                 compute ws-jl-wk-rate =
 10875                    ws-jl-wk-rate + ws-wk-rate
 10876              else
 10877                 if am-com-typ(sub5) = 'O' or 'P'
 10878                    compute ws-ga-jl-wk-rate =
 10879                       ws-ga-jl-wk-rate + ws-wk-rate
 10880                 end-if
 10881              end-if
 10882           end-if
 10883           move zeros            to ws-wk-rate
 10884
 10885           if pb-i-ah-benefit-cd <> '  ' and '00'
 10886              if (am-a-com (sub5) numeric)
 10887                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10888                 move am-a-com(sub5)
 10889                                 to ws-wk-rate
 10890              else
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 199
* EL050.cbl
 10891                 move pb-company-cd to ctbl-company-cd
 10892                 move pb-i-ah-benefit-cd
 10893                                 to ctbl-ben-code
 10894                 move pb-i-ah-term  to ws-work-term
 10895                 move pb-ah-override-l1
 10896                                 to ctbl-ben-type
 10897                 move zeros      to ws-sub1
 10898                                    ws-commission
 10899                 move am-a-coma (sub5)
 10900                                 to ctbl-table
 10901                 move '0530'     to ctbl-sw
 10902                 perform 0552-get-it
 10903                                 thru 0552-exit
 10904              end-if
 10905              compute ws-tot-sa-wk-rate =
 10906                 ws-tot-sa-wk-rate + ws-wk-rate
 10907              if am-com-typ(sub5) = 'C' or 'D'
 10908                 compute ws-sa-wk-rate =
 10909                    ws-sa-wk-rate + ws-wk-rate
 10910              else
 10911                 if am-com-typ(sub5) = 'O' or 'P'
 10912                    compute ws-ga-sa-wk-rate =
 10913                       ws-ga-sa-wk-rate + ws-wk-rate
 10914                 end-if
 10915              end-if
 10916           end-if
 10917        end-if
 10918     end-perform
 10919
 10920     go to 0550-continue
 10921
 10922     .
 10923 0552-get-it.
 10924
 10925     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10926     MOVE ZEROS                  TO WS-SUB1
 10927                                    WS-COMMISSION
 10928     MOVE ' '                    TO WS-CTBL-READ-SW
 10929     PERFORM 8300-READ-CTBL-TABLE
 10930                                 THRU 8300-EXIT
 10931     IF FIRST-TIME-THROUGH
 10932        MOVE 'AA'                TO CTBL-BEN-CODE
 10933        PERFORM 8300-READ-CTBL-TABLE
 10934                                 THRU 8300-EXIT
 10935     END-IF
 10936     IF CTBL-TABLE-FOUND
 10937        if pb-life-override-l1 = ctbl-ben-type
 10938           move pb-i-lf-benefit-amt
 10939                                 to WS-COMM-CK-AMT
 10940        else
 10941           compute ws-comm-ck-amt =
 10942              pb-I-ah-benefit-amt * pb-i-ah-term
 10943        end-if
 10944        PERFORM 8800-GET-COMP-RATE
 10945                                 THRU 8800-EXIT
 10946     else
 10947        move zeros               to ws-wk-rate
 10948     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 200
* EL050.cbl
 10949
 10950     .
 10951 0552-exit.
 10952     exit.
 10953
 10954 0550-continue.
 10955
 10956     if ws-lf-joint-indicator = 'J'
 10957        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10958           and (ws-st-comm-cap-jl <> zeros)
 10959           MOVE ER-1956          TO WS-ERROR
 10960           PERFORM 9900-ERROR-FORMAT
 10961                                 THRU 9900-EXIT
 10962        end-if
 10963        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10964           and (ws-st-ga-comm-cap-jl <> zeros)
 10965           MOVE ER-1959          TO WS-ERROR
 10966           PERFORM 9900-ERROR-FORMAT
 10967                                 THRU 9900-EXIT
 10968        end-if
 10969        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10970           and (ws-st-tot-comm-cap-jl <> zeros)
 10971           MOVE ER-1962          TO WS-ERROR
 10972           PERFORM 9900-ERROR-FORMAT
 10973                                 THRU 9900-EXIT
 10974        end-if
 10975     else
 10976        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10977           and (ws-st-comm-cap-sl <> zeros)
 10978           MOVE ER-1955          TO WS-ERROR
 10979           PERFORM 9900-ERROR-FORMAT
 10980                                 THRU 9900-EXIT
 10981        end-if
 10982        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10983           and (ws-st-ga-comm-cap-sl <> zeros)
 10984           MOVE ER-1958          TO WS-ERROR
 10985           PERFORM 9900-ERROR-FORMAT
 10986                                 THRU 9900-EXIT
 10987        end-if
 10988        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10989           and (ws-st-tot-comm-cap-sl <> zeros)
 10990           MOVE ER-1961          TO WS-ERROR
 10991           PERFORM 9900-ERROR-FORMAT
 10992                                 THRU 9900-EXIT
 10993        end-if
 10994
 10995     if ws-ah-joint-indicator = 'J'
 10996        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10997           and (ws-st-comm-cap-ja <> zeros)
 10998           MOVE ER-1957          TO WS-ERROR
 10999           PERFORM 9900-ERROR-FORMAT
 11000                                 THRU 9900-EXIT
 11001        end-if
 11002        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 11003           and (ws-st-ga-comm-cap-ja <> zeros)
 11004           MOVE ER-1960          TO WS-ERROR
 11005           PERFORM 9900-ERROR-FORMAT
 11006                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 201
* EL050.cbl
 11007        end-if
 11008        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 11009           and (ws-st-tot-comm-cap-ja <> zeros)
 11010           MOVE ER-1963          TO WS-ERROR
 11011           PERFORM 9900-ERROR-FORMAT
 11012                                 THRU 9900-EXIT
 11013        end-if
 11014     else
 11015        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 11016           and (ws-st-comm-cap-sa <> zeros)
 11017           MOVE ER-1957          TO WS-ERROR
 11018           PERFORM 9900-ERROR-FORMAT
 11019                                 THRU 9900-EXIT
 11020        end-if
 11021        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 11022           and (ws-st-ga-comm-cap-sa <> zeros)
 11023           MOVE ER-1960          TO WS-ERROR
 11024           PERFORM 9900-ERROR-FORMAT
 11025                                 THRU 9900-EXIT
 11026        end-if
 11027        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 11028           and (ws-st-tot-comm-cap-sa <> zeros)
 11029           MOVE ER-1963          TO WS-ERROR
 11030           PERFORM 9900-ERROR-FORMAT
 11031                                 THRU 9900-EXIT
 11032        end-if
 11033     end-if
 11034     .
 11035 0560-EDIT-CONTINUE.
 11036     MOVE ZEROS                  TO WS-LF-PMF-COMM
 11037                                    WS-AH-PMF-COMM
 11038*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 11039*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 11040     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 11041        (SUB1 > +10)
 11042        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 11043           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 11044           MOVE '0530'           TO CTBL-SW
 11045           MOVE ' '              TO WS-CTBL-READ-SW
 11046           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 11047           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 11048           MOVE '0540'           TO CTBL-SW
 11049           MOVE ' '              TO WS-CTBL-READ-SW
 11050           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 11051        END-IF
 11052     END-PERFORM
 11053     GO TO 0564-EDIT-CONTINUE
 11054     .
 11055 0561-CHECK-AH.
 11056     IF (NO-AH-COVERAGE)
 11057        OR (NO-AH-BENEFIT-MATCH)
 11058        CONTINUE
 11059     ELSE
 11060        IF (AM-A-COM (SUB1) NUMERIC)
 11061           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11062           IF (AM-COM-TYP (SUB1) = 'A')
 11063              AND (WS-AH-PMF-COMM = ZEROS)
 11064              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 202
* EL050.cbl
 11065           END-IF
 11066           CONTINUE
 11067        ELSE
 11068           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 11069           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 11070           MOVE PB-AH-OVERRIDE-L1
 11071                                 TO CTBL-BEN-TYPE
 11072           MOVE ZEROS            TO WS-SUB1
 11073                                    WS-COMMISSION
 11074           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 11075           PERFORM 8300-READ-CTBL-TABLE
 11076                                 THRU 8300-EXIT
 11077           IF CTBL-TABLE-FOUND
 11078              IF (AM-COM-TYP (SUB1) = 'A')
 11079                 AND (WS-AH-PMF-COMM = ZEROS)
 11080                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 11081                                        PB-I-AH-TERM
 11082                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11083                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 11084              END-IF
 11085              CONTINUE
 11086           ELSE
 11087              IF FIRST-TIME-THROUGH
 11088                 GO TO 0561-CHECK-AH
 11089              ELSE
 11090                 MOVE ER-2609    TO WS-ERROR
 11091                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11092              END-IF
 11093           END-IF
 11094        END-IF
 11095     END-IF
 11096     .
 11097 0561-EXIT.
 11098     EXIT.
 11099 0563-CHECK-LF.
 11100     IF (NO-LIFE-COVERAGE)
 11101        OR (NO-LF-BENEFIT-MATCH)
 11102        CONTINUE
 11103     ELSE
 11104        IF WS-LF-JOINT-INDICATOR = 'J'
 11105           IF AM-J-COM (SUB1) NUMERIC
 11106              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11107              IF (AM-COM-TYP (SUB1) = 'A')
 11108                 AND (WS-LF-PMF-COMM = ZEROS)
 11109                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11110              END-IF
 11111              CONTINUE
 11112           ELSE
 11113              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11114              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11115              MOVE PB-LIFE-OVERRIDE-L1
 11116                                 TO CTBL-BEN-TYPE
 11117              MOVE ZEROS         TO WS-SUB1
 11118                                    WS-COMMISSION
 11119              MOVE AM-J-COMA (SUB1)
 11120                                 TO CTBL-TABLE
 11121              PERFORM 8300-READ-CTBL-TABLE
 11122                                 THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 203
* EL050.cbl
 11123              IF CTBL-TABLE-FOUND
 11124                 IF (AM-COM-TYP (SUB1) = 'A')
 11125                    AND (WS-LF-PMF-COMM = ZEROS)
 11126                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11127                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11128                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11129                 END-IF
 11130                 CONTINUE
 11131              ELSE
 11132                 IF FIRST-TIME-THROUGH
 11133                    GO TO 0563-CHECK-LF
 11134                 ELSE
 11135                    MOVE ER-2609 TO WS-ERROR
 11136                    PERFORM 9900-ERROR-FORMAT
 11137                                 THRU 9900-EXIT
 11138*                   GO TO 0560-EDIT-CONTINUE
 11139                 END-IF
 11140              END-IF
 11141           END-IF
 11142        ELSE
 11143           IF AM-L-COM (SUB1) NUMERIC
 11144              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11145              IF (AM-COM-TYP (SUB1) = 'A')
 11146                 AND (WS-LF-PMF-COMM = ZEROS)
 11147                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11148              END-IF
 11149              CONTINUE
 11150           ELSE
 11151              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11152              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11153              MOVE PB-LIFE-OVERRIDE-L1
 11154                                 TO CTBL-BEN-TYPE
 11155              MOVE ZEROS         TO WS-SUB1
 11156                                    WS-COMMISSION
 11157              MOVE AM-L-COMA (SUB1)
 11158                                 TO CTBL-TABLE
 11159              PERFORM 8300-READ-CTBL-TABLE
 11160                                 THRU 8300-EXIT
 11161              IF CTBL-TABLE-FOUND
 11162                 CONTINUE
 11163              ELSE
 11164                 IF FIRST-TIME-THROUGH
 11165                    GO TO 0563-CHECK-LF
 11166                 ELSE
 11167                    MOVE ER-2609 TO WS-ERROR
 11168                    PERFORM 9900-ERROR-FORMAT
 11169                                 THRU 9900-EXIT
 11170                 END-IF
 11171              END-IF
 11172           END-IF
 11173        END-IF
 11174     END-IF
 11175     .
 11176 0563-EXIT.
 11177     EXIT.
 11178 0564-EDIT-CONTINUE.
 11179
 11180     IF  PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 204
* EL050.cbl
 11181         IF PB-I-NUM-BILLED EQUAL ZEROS
 11182            MOVE ER-8148       TO WS-ERROR
 11183            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11184
 11185*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11186*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11187*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11188*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11189*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11190*         IF NO-CONVERSION-ERROR
 11191*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11192*         ELSE
 11193*             IF PB-COMPANY-ID EQUAL 'HAN'
 11194*                 MOVE ZEROS     TO PB-I-AGE.
 11195     IF PB-I-BIRTHDAY > LOW-VALUES
 11196        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11197        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11198        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11199        PERFORM 8500-DATE-CONVERT
 11200                                 THRU 8500-EXIT
 11201        IF NO-CONVERSION-ERROR
 11202           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11203           IF PB-I-AGE > ZEROS
 11204              IF WS-WORK-AGE NOT = PB-I-AGE
 11205                 MOVE ER-9501    TO WS-ERROR
 11206                 PERFORM 9900-ERROR-FORMAT
 11207                                 THRU 9900-EXIT
 11208              END-IF
 11209           ELSE
 11210              MOVE WS-WORK-AGE   TO PB-I-AGE
 11211           END-IF
 11212        END-IF
 11213     END-IF
 11214     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11215                                   WS-INS-AGE-SET
 11216     IF PB-I-AGE = ZEROS
 11217        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11218           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11219                                   WS-INS-AGE-SET
 11220           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11221
 11222     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11223                                   WS-AH-EDIT-AGE.
 11224
 11225     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11226        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11227        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11228        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11229        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11230        IF NO-CONVERSION-ERROR
 11231           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11232           IF PB-I-JOINT-AGE > 0
 11233              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11234                 MOVE ER-9503    TO WS-ERROR
 11235                 PERFORM 9900-ERROR-FORMAT
 11236                                 THRU 9900-EXIT
 11237              END-IF
 11238           ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 205
* EL050.cbl
 11239              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11240           END-IF
 11241        ELSE
 11242           MOVE ZEROS            TO PB-I-JOINT-AGE
 11243        END-IF
 11244     END-IF
 11245     IF PB-I-JOINT-AGE NOT NUMERIC
 11246        MOVE ZERO               TO PB-I-JOINT-AGE.
 11247
 11248     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 11249                                   WS-JNT-AGE-SET
 11250     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11251        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11252           (WS-AH-JOINT-INDICATOR = 'J')
 11253           IF PB-I-JOINT-AGE = ZEROS
 11254               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11255                                          WS-JNT-AGE-SET
 11256               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11257           END-IF
 11258        END-IF
 11259     END-IF
 11260
 11261     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11262     IF WS-LF-JOINT-INDICATOR = 'J'
 11263        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11264        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11265            IF  PB-I-JOINT-AGE = ZERO
 11266                MOVE ER-2686       TO WS-ERROR
 11267                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11268            ELSE
 11269                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11270                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11271                    IF PB-COMPANY-ID NOT = 'LBL'
 11272                        MOVE ER-2685    TO WS-ERROR
 11273                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11274
 11275     IF WS-AH-JOINT-INDICATOR = 'J'
 11276        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11277            IF  PB-I-JOINT-AGE = ZERO
 11278                MOVE ER-2686       TO WS-ERROR
 11279                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11280            ELSE
 11281                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11282                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11283                                           WS-EDIT-AGE
 11284                    IF PB-COMPANY-ID NOT = 'LBL'
 11285                        MOVE ER-2685    TO WS-ERROR
 11286                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11287
 11288******************************************************************
 11289*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11290******************************************************************
 11291
 11292     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11293        (WS-AH-SPECIAL-CALC-CD = 'O')
 11294        NEXT SENTENCE
 11295     ELSE
 11296        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 206
* EL050.cbl
 11297          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11298           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11299            WS-AH-JOINT-INDICATOR = 'J')  AND
 11300           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11301            MOVE ER-2627             TO WS-ERROR
 11302            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11303
 11304     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11305        (WS-AH-SPECIAL-CALC-CD = 'O')
 11306         NEXT SENTENCE
 11307     ELSE
 11308         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11309            WS-AH-JOINT-INDICATOR = 'J'
 11310             IF PB-I-JOINT-INSURED = SPACES
 11311                 IF PB-COMPANY-ID NOT = 'JAL'
 11312                     MOVE ER-2696    TO WS-ERROR
 11313                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11314
 11315     IF PB-COMPANY-ID NOT = 'BOA'
 11316        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11317           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11318           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11319               PB-I-JOINT-INSURED NOT = SPACES)
 11320                MOVE ER-2691         TO WS-ERROR
 11321                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11322
 11323     IF PB-COMPANY-ID = 'BOA'
 11324        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11325           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11326            IF PB-I-JOINT-AGE NOT = ZEROS
 11327                MOVE ER-2691         TO WS-ERROR
 11328                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11329
 11330     IF PB-COMPANY-ID = 'CRI'
 11331        IF PB-I-SIG-SW = 'J'
 11332           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11333              WS-AH-JOINT-INDICATOR NOT = 'J'
 11334              MOVE ER-2675       TO WS-ERROR
 11335              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11336
 11337     IF PB-COMPANY-ID = 'CRI'
 11338        IF PB-I-SIG-SW = 'S'
 11339           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11340              WS-AH-JOINT-INDICATOR = 'J'
 11341              MOVE ER-2676       TO WS-ERROR
 11342              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11343
 11344     IF PB-COMPANY-ID = 'CVL'
 11345         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11346            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11347              MOVE ER-2783           TO WS-ERROR
 11348              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11349     IF (WS-LF-JOINT-INDICATOR = 'J')
 11350        AND (WS-AH-JOINT-INDICATOR = 'J')
 11351        AND (PB-I-LF-TERM > 120)
 11352        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11353        MOVE ER-2783             TO WS-ERROR
 11354        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 207
* EL050.cbl
 11355     END-IF
 11356     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11357
 11358     IF PB-I-INDV-GRP-OVRD = 'I'
 11359        MOVE ER-2666             TO WS-ERROR
 11360        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11361        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11362
 11363     IF PB-I-INDV-GRP-OVRD = 'G'
 11364        MOVE ER-2666             TO WS-ERROR
 11365        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11366        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 11367
 11368     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11369        NEXT SENTENCE
 11370     ELSE
 11371        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11372
 11373     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11374        IF WS-ERROR = ER-2666
 11375           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11376           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11377
 11378     IF PB-COMPANY-ID = 'CID'
 11379        IF PB-STATE = 'UT' OR 'MO'
 11380           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11381                 OR '76' OR '77')
 11382                      OR
 11383               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11384                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11385                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11386                   OR '2K' OR '2L'))
 11387              AND PB-I-INDV-GRP-CD = 'I'
 11388              MOVE ER-2721             TO WS-ERROR
 11389              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11390           END-IF
 11391        END-IF
 11392     END-IF
 11393
 11394     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11395     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11396        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11397     ELSE
 11398        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11399     END-IF
 11400
 11401*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11402*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11403     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11404                                    ACCOUNT-AH-CK-SW.
 11405
 11406     IF PB-REISSUED-CERT       OR
 11407        PB-REIN-ONLY-CERT      OR
 11408        PB-POLICY-IS-DECLINED  OR
 11409        PB-POLICY-IS-VOIDED
 11410*       OR PB-MONTHLY-CERT
 11411         GO TO 3000-CONTINUE-EDIT.
 11412
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 208
* EL050.cbl
 11413     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11414        IF WS-EDIT-AGE           > +65
 11415           MOVE ER-2709          TO WS-ERROR
 11416           PERFORM 9900-ERROR-FORMAT
 11417                                 THRU 9900-EXIT
 11418        ELSE
 11419           IF WS-EDIT-AGE        > +55
 11420              MOVE ER-2718       TO WS-ERROR
 11421              PERFORM 9900-ERROR-FORMAT
 11422                                 THRU 9900-EXIT
 11423           END-IF
 11424        END-IF
 11425     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11426        IF WS-EDIT-AGE           > +65
 11427           MOVE ER-2709          TO WS-ERROR
 11428           PERFORM 9900-ERROR-FORMAT
 11429                                 THRU 9900-EXIT
 11430        END-IF
 11431     END-IF
 11432     .
 11433
 11434 0565-LIFE-PLAN-LIMIT-EDITS.
 11435
 11436     IF NOT LF-PLAN-MASTER-FOUND
 11437        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11438                                    EC-AM-LF-MAX-TOT-BEN
 11439        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11440
 11441     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11442
 11443     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11444         IF PL-LM-AGE (1) = ZEROS
 11445             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11446
 11447     IF NO-LF-BENEFIT-MATCH          OR
 11448        WS-LF-BENEFIT-CD = ZEROS     OR
 11449        WS-LF-SPECIAL-CALC-CD = 'M'
 11450        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11451
 11452     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11453     MOVE +1                     TO SUB2.
 11454
 11455     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11456        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11457           MOVE +5   TO SUB2
 11458           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11459              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11460              (PL-LM-AGE (SUB2) EQUAL +0)
 11461              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11462              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11463
 11464     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11465
 11466     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11467                               + PB-I-LF-ALT-BENEFIT-AMT.
 11468
 11469 0568-CHECK-LIFE-ATT-AGE.
 11470
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 209
* EL050.cbl
 11471     IF PL-ATT-AGE NUMERIC AND
 11472        PL-ATT-AGE > +0
 11473        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11474     END-IF
 11475*    IF PL-ATT-AGE NUMERIC AND
 11476*       PL-ATT-AGE > +0
 11477*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11478*       IF PB-I-BIRTHDAY > LOW-VALUES
 11479*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11480*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11481*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11482*          SET BIN-PLUS-ELAPSED  TO TRUE
 11483*          PERFORM 8500-DATE-CONVERT
 11484*                                THRU 8500-EXIT
 11485*          IF NO-CONVERSION-ERROR
 11486*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11487*             MOVE ER-2669       TO WS-ERROR
 11488*             PERFORM 9900-ERROR-FORMAT
 11489*                                THRU 9900-EXIT
 11490*          END-IF
 11491*       ELSE
 11492*          IF WS-ATT-AGE >= PL-ATT-AGE
 11493*             MOVE ER-2669       TO WS-ERROR
 11494*             PERFORM 9900-ERROR-FORMAT
 11495*                                THRU 9900-EXIT
 11496*          END-IF
 11497*       END-IF
 11498*    END-IF
 11499     .
 11500 0570-CHECK-LIFE-LIMITS.
 11501
 11502     IF PB-COMPANY-ID EQUAL 'CRI'
 11503        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11504           IF SUB2 GREATER THAN +4
 11505              MOVE ER-2637 TO WS-ERROR
 11506              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11507              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11508
 11509     IF PB-COMPANY-ID  =  'NCL'
 11510        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11511            SUB2 GREATER THAN +8
 11512             MOVE 'U'         TO PB-BATCH-ENTRY
 11513             MOVE ER-2637     TO WS-ERROR
 11514             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11515             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11516
 11517     IF SUB2 > +8
 11518        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11519           AND (PB-I-SIG-SW = 'Y')
 11520           CONTINUE
 11521        ELSE
 11522           MOVE ER-2637          TO WS-ERROR
 11523           PERFORM 9900-ERROR-FORMAT
 11524                                 THRU 9900-EXIT
 11525        END-IF
 11526        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11527     END-IF
 11528     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 210
* EL050.cbl
 11529     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11530     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11531
 11532     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11533        ADD +1  TO SUB2
 11534        GO TO 0570-CHECK-LIFE-LIMITS.
 11535
 11536     IF PB-COMPANY-ID = 'NCL'
 11537         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11538
 11539     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11540        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11541        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11542           AND (PB-I-SIG-SW = 'Y')
 11543           CONTINUE
 11544        ELSE
 11545           MOVE ER-2637          TO WS-ERROR
 11546           PERFORM 9900-ERROR-FORMAT
 11547                                 THRU 9900-EXIT
 11548        END-IF
 11549     END-IF
 11550     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11551
 11552
 11553 0570-CHECK-NCL-LIFE-LIMITS.
 11554
 11555     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11556        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11557         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11558
 11559     IF APP-CERT-USED
 11560         IF SUB2  LESS THAN  +5
 11561             MOVE +5          TO SUB2
 11562             GO TO 0570-CHECK-LIFE-LIMITS.
 11563
 11564     MOVE ER-2637             TO WS-ERROR.
 11565     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11566
 11567     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11568
 11569 0575-CHECK-NCL-SIG-SWITCH.
 11570
 11571     IF NOT APP-CERT-USED
 11572         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11573
 11574     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11575        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11576        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11577        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11578         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11579
 11580     IF SUB2 GREATER THAN +4
 11581         IF PL-LM-AGE (5) = ZEROS  AND
 11582            PL-LM-AGE (6) = ZEROS  AND
 11583            PL-LM-AGE (7) = ZEROS  AND
 11584            PL-LM-AGE (8) = ZEROS
 11585             MOVE  ER-1927        TO WS-ERROR
 11586             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 211
* EL050.cbl
 11587             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11588         ELSE
 11589             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11590                 MOVE  ER-1920    TO WS-ERROR
 11591                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11592
 11593     IF PB-I-SIG-SW  = 'Y'
 11594       IF NOT PB-I-POLICY-ACCEPTED  AND
 11595          NOT PB-I-POLICY-DECLINED
 11596           MOVE 'U'               TO PB-BATCH-ENTRY
 11597           MOVE  ER-1926          TO WS-ERROR
 11598           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11599
 11600
 11601 0580-AH-PLAN-LIMIT-EDITS.
 11602
 11603     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11604        IF PB-I-AH-BENEFIT-AMT > +1250
 11605           MOVE ER-2702          TO WS-ERROR
 11606           PERFORM 9900-ERROR-FORMAT
 11607                                 THRU 9900-EXIT
 11608        END-IF
 11609     END-IF
 11610
 11611     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11612        AND (PB-MONTHLY-CERT)
 11613        IF PB-I-AH-BENEFIT-AMT > +3000
 11614           MOVE ER-2881          TO WS-ERROR
 11615           PERFORM 9900-ERROR-FORMAT
 11616                                 THRU 9900-EXIT
 11617        END-IF
 11618     END-IF
 11619     IF NOT AH-PLAN-MASTER-FOUND
 11620        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11621        GO TO 3000-CONTINUE-EDIT.
 11622
 11623     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11624
 11625     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11626         IF PL-LM-AGE (1) = ZEROS
 11627             GO TO 3000-CONTINUE-EDIT.
 11628
 11629     IF NO-AH-BENEFIT-MATCH          OR
 11630        WS-AH-BENEFIT-CD = ZEROS     OR
 11631        WS-AH-SPECIAL-CALC-CD = 'M'
 11632        GO TO 3000-CONTINUE-EDIT.
 11633
 11634     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11635     MOVE +1                     TO SUB2.
 11636
 11637     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11638        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11639           MOVE +5 TO SUB2
 11640           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11641              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11642              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11643              (PL-LM-AGE (SUB2) EQUAL +0)
 11644              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 212
* EL050.cbl
 11645              GO TO 3000-CONTINUE-EDIT.
 11646
 11647     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11648
 11649 0590-CHECK-AH-ATT-AGE.
 11650
 11651     IF PL-ATT-AGE NUMERIC AND
 11652        PL-ATT-AGE GREATER THAN +0
 11653        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11654     END-IF
 11655*       IF WS-ATT-AGE >= PL-ATT-AGE
 11656*          MOVE ER-3054          TO WS-ERROR
 11657*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11658     .
 11659 0597-CHECK-AH-LIMITS.
 11660
 11661     IF PB-COMPANY-ID EQUAL 'CRI'
 11662        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11663           IF SUB2 GREATER THAN +4
 11664              MOVE ER-2638       TO WS-ERROR
 11665              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11666              GO TO 3000-CONTINUE-EDIT.
 11667
 11668     IF PB-COMPANY-ID  =  'NCL'
 11669        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11670            SUB2 GREATER THAN +8
 11671             MOVE 'U'            TO PB-BATCH-ENTRY
 11672             MOVE ER-2638        TO WS-ERROR
 11673             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11674             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11675
 11676     IF SUB2 > +8
 11677        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11678           AND (PB-I-SIG-SW = 'Y')
 11679           CONTINUE
 11680        ELSE
 11681           MOVE ER-2638          TO WS-ERROR
 11682           PERFORM 9900-ERROR-FORMAT
 11683                                 THRU 9900-EXIT
 11684        END-IF
 11685        GO TO 3000-CONTINUE-EDIT
 11686     END-IF
 11687
 11688     IF PB-COMPANY-ID = 'CRI'
 11689        IF WS-ERROR = ER-2638
 11690           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11691
 11692     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11693     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11694     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11695     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11696
 11697     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11698        ADD +1                   TO SUB2
 11699        GO TO 0597-CHECK-AH-LIMITS.
 11700
 11701     IF PB-COMPANY-ID = 'NCL'
 11702         GO TO 0597-CHECK-NCL-AH-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 213
* EL050.cbl
 11703
 11704     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11705        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11706        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11707                                 > PL-LM-AMT (SUB2))
 11708        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11709           AND (PB-I-SIG-SW = 'Y')
 11710           CONTINUE
 11711        ELSE
 11712           MOVE ER-2638          TO WS-ERROR
 11713           PERFORM 9900-ERROR-FORMAT
 11714                                 THRU 9900-EXIT
 11715        END-IF
 11716     END-IF
 11717
 11718     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11719         IF  WS-ERROR    EQUAL    ER-2638
 11720             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11721                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11722                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11723                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11724                MOVE  ER-1910    TO  WS-ERROR
 11725                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11726
 11727     IF PB-COMPANY-ID = 'CRI'
 11728        IF WS-ERROR = ER-2638
 11729            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11730            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11731            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11732
 11733     GO TO 3000-CONTINUE-EDIT.
 11734
 11735 0597-CHECK-NCL-AH-LIMITS.
 11736
 11737     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11738        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11739        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11740                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11741         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11742
 11743     IF APP-CERT-USED
 11744         IF SUB2  LESS THAN  +5
 11745             MOVE +5             TO SUB2
 11746             GO TO 0597-CHECK-AH-LIMITS.
 11747
 11748     MOVE ER-2638                TO WS-ERROR.
 11749     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11750
 11751     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11752
 11753 0599-CHECK-NCL-SIG-SWITCH.
 11754
 11755     IF NOT APP-CERT-USED
 11756         GO TO 3000-CONTINUE-EDIT.
 11757
 11758     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11759        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11760        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 214
* EL050.cbl
 11761        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11762         GO TO 3000-CONTINUE-EDIT.
 11763
 11764     IF SUB2 GREATER THAN +4
 11765         IF PL-LM-AGE (5) = ZEROS  AND
 11766            PL-LM-AGE (6) = ZEROS  AND
 11767            PL-LM-AGE (7) = ZEROS  AND
 11768            PL-LM-AGE (8) = ZEROS
 11769             MOVE  ER-1927        TO WS-ERROR
 11770             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11771             GO TO 3000-CONTINUE-EDIT
 11772         ELSE
 11773             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11774                 MOVE  ER-1920    TO WS-ERROR
 11775                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11776
 11777     IF PB-I-SIG-SW  = 'Y'
 11778       IF NOT PB-I-POLICY-ACCEPTED  AND
 11779          NOT PB-I-POLICY-DECLINED
 11780           MOVE 'U'               TO PB-BATCH-ENTRY
 11781           MOVE  ER-1926          TO WS-ERROR
 11782           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11783
 11784******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 215
* EL050.cbl
 11786
 11787 3000-CONTINUE-EDIT.
 11788
 11789     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11790     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11791     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11792     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11793     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11794
 11795     IF BROWSE-STARTED
 11796        PERFORM 9990-RETURN THRU 9990-EXIT
 11797        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11798
 11799     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11800        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11801        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11802        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11803*       MOVE 1                   TO DC-OPTION-CODE
 11804        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11805        IF DATE-CONVERSION-ERROR
 11806           MOVE ER-2622          TO WS-ERROR
 11807           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11808        ELSE
 11809           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11810              MOVE ER-2623       TO WS-ERROR
 11811              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11812           ELSE
 11813              MOVE ER-2622       TO WS-ERROR
 11814              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11815
 11816     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11817     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11818     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11819*    MOVE 1                      TO DC-OPTION-CODE.
 11820     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11821     IF DATE-CONVERSION-ERROR
 11822        GO TO 3005-EDIT-CONTINUE
 11823     ELSE
 11824        IF DC-ELAPSED-DAYS GREATER +180
 11825           MOVE ER-2613          TO WS-ERROR
 11826           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11827        ELSE
 11828           IF DC-ELAPSED-DAYS GREATER +90
 11829              MOVE ER-2612       TO WS-ERROR
 11830              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11831           ELSE
 11832             IF DC-ELAPSED-DAYS GREATER +60
 11833                MOVE ER-2614     TO WS-ERROR
 11834                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11835
 11836 3005-EDIT-CONTINUE.
 11837
 11838     IF PB-CANCELLATION
 11839         GO TO 3700-EDIT-CANCEL.
 11840
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 216
* EL050.cbl
 11842******************************************************************
 11843*                  E D I T   I S S U E                           *
 11844******************************************************************
 11845
 11846 3020-EDIT-ISSUE.
 11847
 11848      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11849      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11850      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11851      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11852      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11853
 11854     IF PB-ISSUE-FORCE
 11855        OR PB-ISSUE-DATE-FORCED
 11856        OR PB-FORCE-OFF
 11857        OR PB-OVERCHARGE-FORCE
 11858        or pb-exceeded-limit-forced
 11859        CONTINUE
 11860     ELSE
 11861        MOVE ER-2670             TO WS-ERROR
 11862        PERFORM 9900-ERROR-FORMAT
 11863                                 THRU 9900-EXIT
 11864     END-IF
 11865     .
 11866 3022-SET-POLICY-STATUS.
 11867
 11868     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11869
 11870     IF (PB-REISSUED-CERT)
 11871             OR
 11872        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11873         AND (PB-MONTHLY-CERT))
 11874         MOVE '5'                TO PB-I-ENTRY-STATUS
 11875         MOVE 'E'                TO PB-BATCH-ENTRY
 11876     END-IF
 11877
 11878     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11879        IF PB-MONTHLY-CERT
 11880           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11881        END-IF
 11882        IF PB-CASH-CERT
 11883           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11884        END-IF
 11885     END-IF
 11886     IF PB-POLICY-IS-DECLINED
 11887         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11888     IF PB-POLICY-IS-VOIDED
 11889         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11890     IF PB-NEEDS-UNDERWRITING
 11891         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11892     IF PB-REIN-ONLY-CERT
 11893         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11894     IF PB-PREM-ACCTNG-ONLY
 11895         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11896
 11897     MOVE SPACE                  TO PB-I-OB-FLAG.
 11898
 11899     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 217
* EL050.cbl
 11900         MOVE ER-2665            TO WS-ERROR
 11901         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11902         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11903
 11904     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11905        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11906           MOVE 'Z'             TO PB-I-OB-FLAG.
 11907
 11908     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11909        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11910           MOVE 'Z'             TO PB-I-OB-FLAG.
 11911
 11912     IF ACCOUNT-MAST-FOUND
 11913         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11914         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11915         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11916         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11917         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11918         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11919         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11920     END-IF
 11921
 11922     IF ACCOUNT-MAST-FOUND
 11923        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11924         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11925
 11926     IF (ACCOUNT-MAST-FOUND)
 11927*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11928        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11929        IF PB-REISSUED-CERT
 11930           CONTINUE
 11931        ELSE
 11932           MOVE ER-2608          TO WS-ERROR
 11933           PERFORM 9900-ERROR-FORMAT
 11934                                 THRU 9900-EXIT
 11935         END-IF
 11936     END-IF
 11937
 11938     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11939        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11940        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11941
 11942**********   DMD CUSTOM CODE FOLLOWS  **********
 11943 3024-EDIT-DMD-FIELDS.
 11944     IF PB-COMPANY-ID NOT = 'DMD'
 11945        GO TO 3025-EDIT-REINSURANCE.
 11946
 11947*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11948*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11949*** ERROR IF THEY ARE NOT EQUAL.
 11950
 11951     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11952     SET BIN-TO-GREG               TO TRUE.
 11953     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11954     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11955**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11956
 11957     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 218
* EL050.cbl
 11958     SET BIN-TO-GREG               TO TRUE.
 11959     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11960     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11961**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11962
 11963     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11964        MOVE ER-8116               TO WS-ERROR
 11965        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11966
 11967     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11968
 11969     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11970                                      WK-FULL-CERT-NO.
 11971     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11972
 11973     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11974
 11975     IF PB-VALID-LIFE
 11976        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11977     ELSE
 11978        IF PB-VALID-AH
 11979          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11980
 11981
 11982     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11983     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11984     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11985                                      DCUA-UNDRWRTR-CODE
 11986                                      DCUA-UNDRWRTR-GROUP-CODE
 11987                                      DCUA-RETURN-CODE.
 11988
 11989****************************************************************
 11990*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11991***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11992***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11993***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11994***   TO THIS RECORD.                                        ***
 11995****************************************************************
 11996     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11997     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11998     IF DCUA-SUCCESSFUL-PROCESS
 11999        GO TO 3024-EDIT-DL7-CONT.
 12000
 12001     IF DCUA-RETURN-CODE EQUAL '01'
 12002        MOVE ER-8110               TO WS-ERROR
 12003        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12004        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12005        GO TO 3024-EDIT-DL7-CONT.
 12006
 12007     IF DCUA-RETURN-CODE EQUAL '02'
 12008        MOVE ER-8111               TO WS-ERROR
 12009        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12010        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12011        GO TO 3024-EDIT-DL7-CONT.
 12012
 12013     IF DCUA-RETURN-CODE EQUAL '03'
 12014        MOVE ER-8074               TO WS-ERROR
 12015        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 219
* EL050.cbl
 12016        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12017        GO TO 3024-EDIT-DL7-CONT.
 12018
 12019     IF DCUA-RETURN-CODE EQUAL '04'
 12020        MOVE ER-8075               TO WS-ERROR
 12021        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12022        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12023        GO TO 3024-EDIT-DL7-CONT.
 12024
 12025     IF DCUA-RETURN-CODE EQUAL '05'
 12026        MOVE ER-8076               TO WS-ERROR
 12027        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12028        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12029        GO TO 3024-EDIT-DL7-CONT.
 12030
 12031     IF DCUA-RETURN-CODE EQUAL '06'
 12032        MOVE ER-8077               TO WS-ERROR
 12033        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12034        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12035        GO TO 3024-EDIT-DL7-CONT.
 12036
 12037     IF DCUA-RETURN-CODE EQUAL '07'
 12038        MOVE ER-8078               TO WS-ERROR
 12039        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12040        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12041        GO TO 3024-EDIT-DL7-CONT.
 12042
 12043     IF DCUA-RETURN-CODE EQUAL 'E1'
 12044        MOVE ER-8079               TO WS-ERROR
 12045        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12046        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12047        GO TO 3024-EDIT-DL7-CONT.
 12048
 12049     IF DCUA-RETURN-CODE EQUAL 'E2'
 12050        MOVE ER-8080               TO WS-ERROR
 12051        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12052        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12053        GO TO 3024-EDIT-DL7-CONT.
 12054
 12055     IF DCUA-RETURN-CODE EQUAL 'E3'
 12056        MOVE ER-8098               TO WS-ERROR
 12057        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12058        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12059        GO TO 3024-EDIT-DL7-CONT.
 12060
 12061     IF DCUA-RETURN-CODE EQUAL 'C1'
 12062        MOVE ER-8099               TO WS-ERROR
 12063        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12064        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12065        GO TO 3024-EDIT-DL7-CONT.
 12066
 12067     IF DCUA-RETURN-CODE EQUAL 'U1'
 12068        MOVE ER-8109               TO WS-ERROR
 12069        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12070        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12071        GO TO 3024-EDIT-DL7-CONT.
 12072
 12073     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 220
* EL050.cbl
 12074        MOVE ER-8112               TO WS-ERROR
 12075        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12076        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12077        GO TO 3024-EDIT-DL7-CONT.
 12078
 12079     IF DCUA-RETURN-CODE EQUAL 'N2'
 12080        MOVE ER-8113               TO WS-ERROR
 12081        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12082        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12083        GO TO 3024-EDIT-DL7-CONT.
 12084
 12085     IF DCUA-RETURN-CODE EQUAL 'N3'
 12086        MOVE ER-8114               TO WS-ERROR
 12087        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12088        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12089        GO TO 3024-EDIT-DL7-CONT.
 12090
 12091     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 12092     MOVE ER-8097                  TO WS-ERROR.
 12093     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 12094     GO TO 3024-EDIT-DL7-CONT.
 12095
 12096 3024-EDIT-DL7-CONT.
 12097
 12098     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 12099     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 12100     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12101        NEXT SENTENCE
 12102     ELSE
 12103        MOVE ER-9263               TO WS-ERROR
 12104        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12105
 12106******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12107******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12108     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12109        NEXT SENTENCE
 12110     ELSE
 12111        MOVE ER-8039               TO WS-ERROR
 12112        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12113
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 221
* EL050.cbl
 12115****************************************************************
 12116*** VALIDATE STATE  : DLO022                                 ***
 12117****************************************************************
 12118     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12119     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12120
 12121     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12122     IF DVSC-SUCCESSFUL-EDIT
 12123        GO TO 3024-EDIT-DL22-CONT.
 12124
 12125     IF DVSC-RETURN-CODE EQUAL '01'
 12126        MOVE ER-8300               TO WS-ERROR
 12127        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12128        GO TO 3024-EDIT-DL22-CONT.
 12129
 12130     IF DVSC-RETURN-CODE EQUAL '02'
 12131        MOVE ER-8301               TO WS-ERROR
 12132        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12133        GO TO 3024-EDIT-DL22-CONT.
 12134
 12135     IF DVSC-RETURN-CODE EQUAL '03'
 12136        MOVE ER-8302               TO WS-ERROR
 12137        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12138        GO TO 3024-EDIT-DL22-CONT.
 12139
 12140     IF DVSC-RETURN-CODE EQUAL 'N1'
 12141        MOVE ER-8304               TO WS-ERROR
 12142        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12143        GO TO 3024-EDIT-DL22-CONT.
 12144
 12145     MOVE ER-8303                  TO WS-ERROR
 12146     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12147
 12148 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 222
* EL050.cbl
 12150****************************************************************
 12151*** VALIDATE LOAN OFFICER : DLO021                           ***
 12152****************************************************************
 12153
 12154     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12155     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12156     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12157     IF DVLO-SUCCESSFUL-EDIT
 12158        GO TO 3024-EDIT-DL21-CONT.
 12159
 12160     IF DVLO-RETURN-CODE EQUAL '01'
 12161        MOVE ER-8081               TO WS-ERROR
 12162        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12163        GO TO 3024-EDIT-DL21-CONT.
 12164
 12165     IF DVLO-RETURN-CODE EQUAL '02'
 12166        MOVE ER-8082               TO WS-ERROR
 12167        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12168        GO TO 3024-EDIT-DL21-CONT.
 12169
 12170     IF DVLO-RETURN-CODE EQUAL '03'
 12171        MOVE ER-8083               TO WS-ERROR
 12172        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12173        GO TO 3024-EDIT-DL21-CONT.
 12174
 12175     IF DVLO-RETURN-CODE EQUAL '04'
 12176        MOVE ER-8084               TO WS-ERROR
 12177        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12178        GO TO 3024-EDIT-DL21-CONT.
 12179
 12180     IF DVLO-RETURN-CODE EQUAL '05'
 12181        MOVE ER-8085               TO WS-ERROR
 12182        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12183        GO TO 3024-EDIT-DL21-CONT.
 12184
 12185     MOVE ER-7825                  TO WS-ERROR
 12186     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12187     GO TO 3024-EDIT-DL21-CONT.
 12188
 12189 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 223
* EL050.cbl
 12191
 12192****************************************************************
 12193*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12194****************************************************************
 12195
 12196     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12197     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12198     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12199     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12200     IF DIPF-SUCCESSFUL-EDIT
 12201        GO TO 3024-EDIT-DL02-CONT.
 12202
 12203     IF DIPF-RETURN-CODE EQUAL '01'
 12204        MOVE ER-8086               TO WS-ERROR
 12205        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12206        GO TO 3024-EDIT-DL02-CONT.
 12207
 12208     IF DIPF-RETURN-CODE EQUAL '02'
 12209        MOVE ER-8087               TO WS-ERROR
 12210        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12211        GO TO 3024-EDIT-DL02-CONT.
 12212
 12213     IF DIPF-RETURN-CODE EQUAL '03'
 12214        MOVE ER-8088               TO WS-ERROR
 12215        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12216        GO TO 3024-EDIT-DL02-CONT.
 12217
 12218     MOVE ER-8095                  TO WS-ERROR
 12219     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12220     GO TO 3024-EDIT-DL02-CONT.
 12221
 12222 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 224
* EL050.cbl
 12224
 12225****************************************************************
 12226*** VALIDATE BANK ID : DLO003                                ***
 12227****************************************************************
 12228
 12229     MOVE WK-GREG-CENT           TO WCG-CENT.
 12230     MOVE WK-GREG-YYMM           TO WCG-REST.
 12231     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12232        MOVE ER-8040               TO WS-ERROR
 12233        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12234
 12235     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12236     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12237     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12238     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12239     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12240     IF DVBI-SUCCESSFUL-EDIT
 12241        GO TO 3024-EDIT-DL03-CONT.
 12242
 12243     IF DVBI-RETURN-CODE EQUAL '01'
 12244        MOVE ER-8089               TO WS-ERROR
 12245        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12246        GO TO 3024-EDIT-DL03-CONT.
 12247
 12248     IF DVBI-RETURN-CODE EQUAL '02'
 12249        MOVE ER-8090               TO WS-ERROR
 12250        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12251        GO TO 3024-EDIT-DL03-CONT.
 12252
 12253     IF DVBI-RETURN-CODE EQUAL '03'
 12254        MOVE ER-8091               TO WS-ERROR
 12255        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12256        GO TO 3024-EDIT-DL03-CONT.
 12257
 12258     IF DVBI-RETURN-CODE EQUAL '04'
 12259        MOVE ER-8092               TO WS-ERROR
 12260        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12261        GO TO 3024-EDIT-DL03-CONT.
 12262
 12263     IF DVBI-RETURN-CODE EQUAL '05'
 12264        MOVE ER-8093               TO WS-ERROR
 12265        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12266        GO TO 3024-EDIT-DL03-CONT.
 12267
 12268     IF DVBI-RETURN-CODE EQUAL '06'
 12269        MOVE ER-8094               TO WS-ERROR
 12270        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12271        GO TO 3024-EDIT-DL03-CONT.
 12272
 12273     MOVE ER-8096                  TO WS-ERROR
 12274     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12275     GO TO 3024-EDIT-DL03-CONT.
 12276
 12277 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 225
* EL050.cbl
 12279
 12280     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12281        NEXT SENTENCE
 12282     ELSE
 12283        MOVE ER-8042               TO WS-ERROR
 12284        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12285
 12286     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12287     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12288     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12289
 12290     IF DMPF-RETURN-CODE = '01'
 12291        MOVE ER-8067               TO WS-ERROR
 12292        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12293        GO TO 3024-EDIT-DL01-CONT.
 12294
 12295     IF DMPF-RETURN-CODE = '02'
 12296        MOVE ER-8068               TO WS-ERROR
 12297        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12298        GO TO 3024-EDIT-DL01-CONT.
 12299
 12300     IF DMPF-RETURN-CODE = '03'
 12301        MOVE ER-8069               TO WS-ERROR
 12302        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12303        GO TO 3024-EDIT-DL01-CONT.
 12304
 12305     IF DMPF-RETURN-CODE = 'E1'
 12306        MOVE ER-8070               TO WS-ERROR
 12307        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12308        GO TO 3024-EDIT-DL01-CONT.
 12309
 12310     IF DMPF-RETURN-CODE = 'N1'
 12311        MOVE ER-8071               TO WS-ERROR
 12312        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12313        GO TO 3024-EDIT-DL01-CONT.
 12314
 12315     IF DMPF-RETURN-CODE NOT = 'OK'
 12316        MOVE ER-8072               TO WS-ERROR
 12317        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12318
 12319 3024-EDIT-DL01-CONT.
 12320******************************************************************
 12321***  VALIDATES RATE CODES : DLO017                             ***
 12322******************************************************************
 12323
 12324      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12325      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12326      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12327      IF DVRC-SUCCESSFUL-EDIT
 12328        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12329        GO TO 3024-CHECK-VALID-RATE.
 12330
 12331      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12332
 12333      IF DVRC-RETURN-CODE EQUAL '01'
 12334         MOVE ER-7817                   TO WS-ERROR
 12335         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12336         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 226
* EL050.cbl
 12337
 12338      IF DVRC-RETURN-CODE EQUAL '02'
 12339         MOVE ER-7818                   TO WS-ERROR
 12340         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12341         GO TO 3025-EDIT-REINSURANCE.
 12342
 12343      IF DVRC-RETURN-CODE EQUAL '03'
 12344         MOVE ER-7819                   TO WS-ERROR
 12345         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12346         GO TO 3025-EDIT-REINSURANCE.
 12347
 12348       MOVE ER-7820                     TO WS-ERROR.
 12349       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12350       GO TO 3025-EDIT-REINSURANCE.
 12351
 12352******************************************************************
 12353***  GET PREMIUM RATES : DLO011                                ***
 12354******************************************************************
 12355
 12356 3024-CHECK-VALID-RATE.
 12357
 12358     IF VALID-RATE-CODE
 12359        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12360        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12361        MOVE SPACES                TO DPRB-RETURN-CODE
 12362        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12363     ELSE
 12364         GO TO 3025-EDIT-REINSURANCE.
 12365
 12366      IF DPRB-SUCCESSFUL-PROCESS
 12367         IF PB-VALID-LIFE
 12368             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12369             GO TO 3025-EDIT-REINSURANCE
 12370         ELSE
 12371             IF PB-VALID-AH
 12372                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12373                 GO TO 3025-EDIT-REINSURANCE.
 12374
 12375      IF DPRB-RETURN-CODE EQUAL '01'
 12376         MOVE ER-7812                   TO WS-ERROR
 12377         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12378         GO TO 3025-EDIT-REINSURANCE.
 12379
 12380      IF DPRB-RETURN-CODE EQUAL '02'
 12381         MOVE ER-7813                   TO WS-ERROR
 12382         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12383         GO TO 3025-EDIT-REINSURANCE.
 12384
 12385      IF DPRB-RETURN-CODE EQUAL '03'
 12386         MOVE ER-7814                   TO WS-ERROR
 12387         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12388         GO TO 3025-EDIT-REINSURANCE.
 12389
 12390      IF DPRB-RETURN-CODE EQUAL '04'
 12391         IF NOT DPRB-1ST-TIME
 12392            MOVE ER-7815                   TO WS-ERROR
 12393            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12394            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 227
* EL050.cbl
 12395          ELSE
 12396         IF PB-VALID-LIFE
 12397            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12398          ELSE
 12399            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12400         END-IF
 12401         MOVE SPACES                TO DOCC-RETURN-CODE
 12402         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12403         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12404         IF DOCC-RETURN-CODE = 'OK'
 12405             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12406             GO TO 3024-CHECK-VALID-RATE
 12407           ELSE
 12408             MOVE ER-7823               TO WS-ERROR
 12409             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12410             GO TO 3025-EDIT-REINSURANCE.
 12411
 12412       MOVE ER-7816                     TO WS-ERROR.
 12413       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12414       GO TO 3025-EDIT-REINSURANCE.
 12415
 12416**********   DMD CUSTOM CODE ABOVE    **********
 12417
 12418 3025-EDIT-REINSURANCE.
 12419     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12420         GO TO 3027-EDIT-CONTINUE.
 12421
 12422     MOVE LOW-VALUES               TO ERREIN-KEY.
 12423     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12424     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12425                                      REIN-CODE-2
 12426                                      REIN-CODE-3.
 12427     MOVE 'A'                      TO REIN-TYPE.
 12428
 12429     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12430
 12431     MOVE '3026' TO REIN-SW.
 12432     MOVE ' '                   TO WS-REIN-READ-SW.
 12433
 12434     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12435     IF REIN-TABLE-NOT-FOUND
 12436         GO TO 3026-NO-SPEC-TABLE.
 12437
 12438     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12439     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12440                                   WS-NSP-ST-CD-LF.
 12441     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12442                                   WS-NSP-ST-CD-AH.
 12443
 12444     GO TO 3040-EDIT-CONTINUE.
 12445
 12446 3026-NO-SPEC-TABLE.
 12447
 12448     MOVE ER-2664                TO WS-ERROR.
 12449     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12450     GO TO 3040-EDIT-CONTINUE.
 12451
 12452 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 228
* EL050.cbl
 12453
 12454     IF PB-I-REIN-TABLE = SPACES
 12455       GO TO 3040-EDIT-CONTINUE.
 12456
 12457     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12458          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12459          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12460           GO TO 3040-EDIT-CONTINUE.
 12461
 12462     MOVE LOW-VALUES            TO ERREIN-KEY.
 12463     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12464     MOVE 'A'                   TO REIN-TYPE.
 12465     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12466
 12467     MOVE '3028'                TO REIN-SW.
 12468     MOVE ' '                   TO WS-REIN-READ-SW.
 12469
 12470     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12471     IF REIN-TABLE-NOT-FOUND
 12472         GO TO 3028-NO-REIN-TABLE.
 12473
 12474     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12475     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12476                                   WS-NSP-ST-CD-LF.
 12477     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12478                                   WS-NSP-ST-CD-AH.
 12479
 12480     GO TO 3040-EDIT-CONTINUE.
 12481
 12482 3028-NO-REIN-TABLE.
 12483
 12484     MOVE ER-2615                TO WS-ERROR.
 12485     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12486     GO TO 3040-EDIT-CONTINUE.
 12487
 12488 3040-EDIT-CONTINUE.
 12489
 12490     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12491         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12492
 12493     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12494         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12495
 12496     IF (NOT PB-REISSUED-CERT)
 12497        AND (NOT PB-MONTHLY-CERT)
 12498        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12499            MOVE '001'           TO PB-I-LF-TERM
 12500            MOVE 'M'             TO PB-I-INSURED-SEX.
 12501
 12502     IF (NOT PB-REISSUED-CERT)
 12503        AND (NOT PB-MONTHLY-CERT)
 12504        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12505            MOVE '001'           TO PB-I-AH-TERM
 12506            MOVE 'M'             TO PB-I-INSURED-SEX.
 12507
 12508 3040-EDIT-1ST-PMT-DT.
 12509     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12510     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 229
* EL050.cbl
 12511         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12512
 12513******************************************************************
 12514*                                                                *
 12515*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12516*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12517*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12518*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12519*                                                                *
 12520******************************************************************
 12521
 12522     IF PB-EFF-DT-PROCESSING
 12523        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12524                                    PB-I-LF-EXPIRE-DT
 12525                                    PB-I-AH-EXPIRE-DT
 12526        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12527        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12528        MOVE ZERO                TO DC-ELAPSED-DAYS
 12529        MOVE +1                  TO DC-ELAPSED-MONTHS
 12530        SET BIN-PLUS-ELAPSED     TO TRUE
 12531*       MOVE 6                   TO DC-OPTION-CODE
 12532        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12533        IF NO-CONVERSION-ERROR
 12534           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12535
 12536******************************************************************
 12537*                                                                *
 12538*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12539*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12540*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12541*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12542*                                                                *
 12543******************************************************************
 12544
 12545     IF PB-EXT-DAYS-PROCESSING
 12546          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12547                                         PB-I-LF-EXPIRE-DT
 12548                                         PB-I-AH-EXPIRE-DT
 12549          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12550          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12551          MOVE +1                     TO DC-ELAPSED-MONTHS
 12552          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12553          SET BIN-PLUS-ELAPSED        TO TRUE
 12554*         MOVE 6                      TO DC-OPTION-CODE
 12555          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12556          IF NO-CONVERSION-ERROR
 12557             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12558
 12559******************************************************************
 12560*                                                                *
 12561*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12562*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12563*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12564*        (EXPIRE DATE - (TERM -1))  *  -1.
 12565*                                                                *
 12566******************************************************************
 12567
 12568     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 230
* EL050.cbl
 12569        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12570           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12571              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12572              MOVE PB-I-AH-TERM      TO WS-TERM
 12573           ELSE
 12574              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12575              MOVE PB-I-LF-TERM      TO WS-TERM
 12576        ELSE
 12577           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12578              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12579              MOVE PB-I-LF-TERM      TO WS-TERM
 12580           ELSE
 12581              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12582              MOVE PB-I-AH-TERM      TO WS-TERM.
 12583
 12584     IF PB-EXPIRE-DT-PROCESSING
 12585        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12586        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12587        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12588        MOVE ZERO                TO DC-ELAPSED-DAYS
 12589                                    DC-ODD-DAYS-OVER
 12590          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12591          SET BIN-PLUS-ELAPSED    TO TRUE
 12592*         MOVE 6                  TO DC-OPTION-CODE
 12593          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12594          IF NO-CONVERSION-ERROR
 12595             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12596
 12597******************************************************************
 12598*                                                                *
 12599*            1ST PAYMENT DATE PROCESSING                         *
 12600*                                                                *
 12601******************************************************************
 12602
 12603     IF PB-1ST-PMT-DT-PROCESSING
 12604        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12605                                    PB-I-AH-EXPIRE-DT
 12606        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12607
 12608     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12609         NEXT SENTENCE
 12610     ELSE
 12611         MOVE ER-2680                 TO WS-ERROR
 12612         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12613         GO TO 3060-ORIG-TERM-CHECK.
 12614
 12615     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12616     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12617     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12618*    MOVE 1                      TO DC-OPTION-CODE.
 12619     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12620                                    DC-ELAPSED-DAYS
 12621                                    DC-ODD-DAYS-OVER.
 12622
 12623     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12624
 12625     IF DATE-CONVERSION-ERROR
 12626        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 231
* EL050.cbl
 12627
 12628     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12629     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12630        AND (WS-LF-COVERAGE-TYPE = 'L')
 12631        IF (DC-ELAPSED-MONTHS > 1)
 12632                      OR
 12633           ((DC-ELAPSED-MONTHS = 1)
 12634           AND (DC-ODD-DAYS-OVER > 0))
 12635           MOVE ER-2882          TO WS-ERROR
 12636           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12637        END-IF
 12638     END-IF
 12639     if dc-elapsed-months > 0
 12640        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12641        + dc-odd-days-over
 12642     end-if
 12643     IF PB-EXT-DAYS-PROCESSING
 12644        CONTINUE
 12645     ELSE
 12646        IF DC-ELAPSED-MONTHS = +0
 12647           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12648        ELSE
 12649           IF (WS-LF-EARNINGS-CALC = '4')
 12650              AND (DC-ELAPSED-MONTHS > ZERO)
 12651              AND (DC-ELAPSED-DAYS > ZERO)
 12652              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12653           ELSE
 12654              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12655                                 THRU 6499-EXIT
 12656              MOVE WS-ODD-DAYS-OVER
 12657                                 TO PB-I-EXTENTION-DAYS
 12658           END-IF
 12659        END-IF
 12660     END-IF
 12661******************************************************************
 12662*                                                                *
 12663*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12664*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12665*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12666*            AND ANY ODD DAYS.                                   *
 12667*                                                                *
 12668******************************************************************
 12669
 12670     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12671                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12672     IF WS-LF-EARNINGS-CALC NOT = '4'
 12673        IF DC-ELAPSED-DAYS > ZEROS
 12674           MOVE ER-2681          TO WS-ERROR
 12675           PERFORM 9900-ERROR-FORMAT
 12676                                 THRU 9900-EXIT
 12677        END-IF
 12678     END-IF
 12679
 12680     IF WS-LF-EARNINGS-CALC NOT = '4'
 12681        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12682           MOVE ER-2681          TO WS-ERROR
 12683           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12684
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 232
* EL050.cbl
 12685     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12686        (PB-I-LF-TERM NOT = ZERO) AND
 12687         NOT NO-LIFE-COVERAGE
 12688          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12689          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12690          IF WS-LF-EARNINGS-CALC = '4'
 12691             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12692             PB-I-PAY-FREQUENCY
 12693          END-IF
 12694          MOVE ZERO              TO DC-ELAPSED-DAYS
 12695                                    DC-ODD-DAYS-OVER
 12696          MOVE 1                 TO DC-END-OF-MONTH
 12697          SET BIN-PLUS-ELAPSED        TO TRUE
 12698*         MOVE 6                 TO DC-OPTION-CODE
 12699          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12700          IF NO-CONVERSION-ERROR
 12701             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12702             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12703                (WS-LF-SPECIAL-CALC-CD = 'L')
 12704                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12705                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12706                  MOVE +1             TO DC-ELAPSED-MONTHS
 12707                  SET BIN-PLUS-ELAPSED  TO TRUE
 12708*                 MOVE 6              TO DC-OPTION-CODE
 12709                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12710                  IF NO-CONVERSION-ERROR
 12711                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12712
 12713* okay, i had to move the new att age edit down here because the
 12714* expiration date could get recalculated and i need the exp date
 12715     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12716        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12717        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12718        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12719           AND ZEROS
 12720           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12721           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12722           SET ELAPSED-BETWEEN-BIN TO TRUE
 12723           PERFORM 8500-DATE-CONVERT
 12724                                 THRU 8500-EXIT
 12725           IF NO-CONVERSION-ERROR
 12726              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12727                 MOVE ER-2669       TO WS-ERROR
 12728*                PERFORM 9900-ERROR-FORMAT
 12729*                                THRU 9900-EXIT
 12730              END-IF
 12731           END-IF
 12732        ELSE
 12733           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12734           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12735              MOVE ER-2669       TO WS-ERROR
 12736*             PERFORM 9900-ERROR-FORMAT
 12737*                                THRU 9900-EXIT
 12738           ELSE
 12739              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12740                 MOVE ER-1570    TO WS-ERROR
 12741                 PERFORM 9900-ERROR-FORMAT
 12742                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 233
* EL050.cbl
 12743              END-IF
 12744           END-IF
 12745        END-IF
 12746        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12747           AND ZEROS
 12748           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12749           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12750           SET ELAPSED-BETWEEN-BIN TO TRUE
 12751           PERFORM 8500-DATE-CONVERT
 12752                                 THRU 8500-EXIT
 12753           IF NO-CONVERSION-ERROR
 12754              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12755                 MOVE ER-2669       TO WS-ERROR
 12756*                PERFORM 9900-ERROR-FORMAT
 12757*                                THRU 9900-EXIT
 12758              END-IF
 12759           END-IF
 12760        ELSE
 12761           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12762             (PB-I-LF-TERM / 12)
 12763           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12764              MOVE ER-2669       TO WS-ERROR
 12765*             PERFORM 9900-ERROR-FORMAT
 12766*                                THRU 9900-EXIT
 12767           ELSE
 12768              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12769                 MOVE ER-1571    TO WS-ERROR
 12770                 PERFORM 9900-ERROR-FORMAT
 12771                                 THRU 9900-EXIT
 12772              END-IF
 12773           END-IF
 12774        END-IF
 12775        IF WS-ERROR = ER-2669
 12776           PERFORM 9900-ERROR-FORMAT
 12777                                 THRU 9900-EXIT
 12778        END-IF
 12779     END-IF
 12780     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12781        (PB-I-AH-TERM NOT = ZERO) AND
 12782         NOT NO-AH-COVERAGE
 12783          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12784             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12785             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12786             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12787          ELSE
 12788             IF WS-LF-EARNINGS-CALC = '4'
 12789                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12790                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12791                PB-I-PAY-FREQUENCY
 12792             ELSE
 12793                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12794                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12795             END-IF
 12796          END-IF
 12797          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12798                                         DC-ODD-DAYS-OVER
 12799          MOVE 1                      TO DC-END-OF-MONTH
 12800          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 234
* EL050.cbl
 12801*         MOVE 6                      TO DC-OPTION-CODE
 12802          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12803          IF NO-CONVERSION-ERROR
 12804             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12805     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12806        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12807        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12808        IF PB-I-BIRTHDAY > LOW-VALUES
 12809           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12810           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12811           SET ELAPSED-BETWEEN-BIN TO TRUE
 12812           PERFORM 8500-DATE-CONVERT
 12813                                 THRU 8500-EXIT
 12814           IF NO-CONVERSION-ERROR
 12815              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12816                 MOVE ER-3054       TO WS-ERROR
 12817*                PERFORM 9900-ERROR-FORMAT
 12818*                                THRU 9900-EXIT
 12819              END-IF
 12820           END-IF
 12821        ELSE
 12822           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12823           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12824              MOVE ER-3054       TO WS-ERROR
 12825*             PERFORM 9900-ERROR-FORMAT
 12826*                                THRU 9900-EXIT
 12827           END-IF
 12828        END-IF
 12829        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12830           AND ZEROS
 12831           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12832           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12833           SET ELAPSED-BETWEEN-BIN TO TRUE
 12834           PERFORM 8500-DATE-CONVERT
 12835                                 THRU 8500-EXIT
 12836           IF NO-CONVERSION-ERROR
 12837              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12838                 MOVE ER-3054       TO WS-ERROR
 12839*                PERFORM 9900-ERROR-FORMAT
 12840*                                THRU 9900-EXIT
 12841              END-IF
 12842           END-IF
 12843        ELSE
 12844           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12845             (PB-I-AH-TERM / 12)
 12846           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12847              MOVE ER-3054       TO WS-ERROR
 12848*             PERFORM 9900-ERROR-FORMAT
 12849*                                THRU 9900-EXIT
 12850           END-IF
 12851        END-IF
 12852        IF WS-ERROR = ER-3054
 12853           PERFORM 9900-ERROR-FORMAT
 12854                                 THRU 9900-EXIT
 12855        END-IF
 12856     END-IF
 12857     MOVE SPACE                       TO DC-END-OF-MONTH.
 12858
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 235
* EL050.cbl
 12859     IF PB-COMPANY-ID = 'NCB'
 12860        GO TO 3040-EDIT-EXTENSION-DAYS.
 12861
 12862     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12863       AND
 12864        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12865        NEXT SENTENCE
 12866     ELSE
 12867        GO TO 3040-EDIT-EXTENSION-DAYS.
 12868
 12869     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12870        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12871        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12872     ELSE
 12873        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12874        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12875
 12876     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12877*    MOVE '1'      TO DC-OPTION-CODE
 12878     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12879     IF (NO-CONVERSION-ERROR)
 12880        AND (DC-ELAPSED-MONTHS > +1)
 12881        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12882        MOVE ER-2668   TO WS-ERROR
 12883        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12884
 12885 3040-EDIT-EXTENSION-DAYS.
 12886
 12887     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12888        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12889         GO TO 3050-EDIT-TERM-IN-DAYS
 12890     ELSE
 12891         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12892
 12893     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12894         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12895     ELSE
 12896        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12897           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12898           MOVE ER-2681         TO WS-ERROR
 12899           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12900
 12901     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12902        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12903        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12904         GO TO 3060-ORIG-TERM-CHECK.
 12905
 12906     GO TO 3060-ORIG-TERM-CHECK.
 12907
 12908 3050-EDIT-TERM-IN-DAYS.
 12909
 12910     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12911
 12912     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12913         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12914     ELSE
 12915         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12916            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 236
* EL050.cbl
 12917            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12918
 12919     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12920                                       REMAINDER WS-WORK-TERM.
 12921     IF WS-WORK-TERM GREATER THAN ZERO
 12922         ADD +1 TO PB-I-LF-TERM.
 12923
 12924     IF NOT NO-AH-COVERAGE
 12925         MOVE ER-2684            TO WS-ERROR
 12926         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12927
 12928
 12929 3060-ORIG-TERM-CHECK.
 12930
 12931******************************************************************
 12932*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12933******************************************************************
 12934
 12935     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12936        NEXT SENTENCE
 12937     ELSE
 12938        IF NOT NO-LIFE-COVERAGE
 12939           IF PB-I-LF-TERM NUMERIC
 12940              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12941              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12942              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12943                  NEXT SENTENCE
 12944           ELSE
 12945              MOVE ER-2647       TO WS-ERROR
 12946              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12947
 12948     IF NOT NO-AH-COVERAGE
 12949         IF PB-I-AH-TERM NUMERIC
 12950            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12951            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12952            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12953             NEXT SENTENCE
 12954          ELSE
 12955              MOVE ER-2658       TO WS-ERROR
 12956              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12957
 12958     IF PB-COMPANY-ID = 'NCB'
 12959        GO TO 3070-LOAN-TERM-CHECK.
 12960
 12961     IF POLICY-HAS-AH
 12962       AND
 12963        POLICY-HAS-LIFE
 12964       AND
 12965        PB-I-LF-TERM NUMERIC
 12966       AND
 12967        PB-I-AH-TERM NUMERIC
 12968        NEXT SENTENCE
 12969     ELSE
 12970        GO TO 3070-LOAN-TERM-CHECK.
 12971
 12972     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12973     IF WS-TEX-FACT-2 LESS THAN +0
 12974        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 237
* EL050.cbl
 12975
 12976     IF WS-TEX-FACT-2 GREATER THAN +1
 12977        MOVE ER-2668             TO WS-ERROR
 12978        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12979
 12980 3070-LOAN-TERM-CHECK.
 12981
 12982     IF (WS-LF-BENEFIT-CD = ZERO)
 12983         OR (NO-LF-BENEFIT-MATCH)
 12984            GO TO 3125-EDIT-PMT-FREQ.
 12985*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12986*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12987*          AND 'V' AND 'W' AND 'X'
 12988*          GO TO 3125-EDIT-PMT-FREQ
 12989*       END-IF
 12990*    ELSE
 12991*       IF WS-AH-DCC-TRUNC = 'T'
 12992*          CONTINUE
 12993*       ELSE
 12994*          GO TO 3125-EDIT-PMT-FREQ
 12995*       END-IF
 12996*    END-IF
 12997     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12998                    OR
 12999        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 13000        AND (WS-AH-DCC-TRUNC = 'T'))
 13001        CONTINUE
 13002     ELSE
 13003        GO TO 3125-EDIT-PMT-FREQ
 13004     END-IF
 13005     IF PB-I-LOAN-TERM NOT NUMERIC
 13006         MOVE ZEROS              TO PB-I-LOAN-TERM.
 13007
 13008     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 13009        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 13010*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 13011        PB-I-LOAN-TERM NOT GREATER THAN +360
 13012         NEXT SENTENCE
 13013     ELSE
 13014         MOVE ER-2648            TO WS-ERROR
 13015         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13016
 13017     if  PB-I-LOAN-TERM > WS-MAX-TERM
 13018        MOVE ER-3058             TO WS-ERROR
 13019        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13020     end-if
 13021
 13022     IF WS-STATE-ABBREVIATION = 'NC'
 13023        IF PB-I-LOAN-TERM > +59
 13024           CONTINUE
 13025        ELSE
 13026           MOVE ER-2792          TO WS-ERROR
 13027           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13028        END-IF
 13029     END-IF
 13030
 13031     .
 13032 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 238
* EL050.cbl
 13033     IF (WS-LF-BENEFIT-CD = ZERO)
 13034         OR (NO-LF-BENEFIT-MATCH)
 13035         or (pb-state = 'AL')
 13036            GO TO 3127-EDIT-LOAN-OFFICER.
 13037     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 13038                    OR
 13039        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 13040        AND (WS-AH-DCC-TRUNC = 'T'))
 13041                    OR
 13042         (PB-COMPANY-ID = 'AHL')
 13043        CONTINUE
 13044     ELSE
 13045        IF (PB-I-LOAN-TERM > ZEROS)
 13046           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 13047           MOVE ER-1575          TO WS-ERROR
 13048           PERFORM 9900-ERROR-FORMAT
 13049                                 THRU 9900-EXIT
 13050        END-IF
 13051     END-IF
 13052     IF WS-LF-EARNINGS-CALC NOT = '4'
 13053         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 13054            MOVE ER-2653         TO WS-ERROR
 13055            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13056            GO TO 3127-EDIT-LOAN-OFFICER
 13057         ELSE
 13058            GO TO 3127-EDIT-LOAN-OFFICER.
 13059
 13060     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 13061         MOVE ER-2655            TO WS-ERROR
 13062         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13063         GO TO 3127-EDIT-LOAN-OFFICER.
 13064
 13065     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 13066         MOVE ER-2654            TO WS-ERROR
 13067         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13068         GO TO 3127-EDIT-LOAN-OFFICER.
 13069
 13070     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 13071         GIVING WS-TEX-FACT-2
 13072             REMAINDER WS-TEX-FACT-3.
 13073
 13074*    IF WS-TEX-FACT-3 NOT = ZERO
 13075*       MOVE ER-2654             TO WS-ERROR
 13076*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13077
 13078
 13079 3127-EDIT-LOAN-OFFICER.
 13080
 13081     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 13082        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 13083           MOVE ER-2690          TO WS-ERROR
 13084           PERFORM 9900-ERROR-FORMAT
 13085                                 THRU 9900-EXIT
 13086        ELSE
 13087           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 13088           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 13089           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 13090           MOVE PB-SV-STATE      TO LOFC-STATE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 239
* EL050.cbl
 13091           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 13092           MOVE PB-I-LOAN-OFFICER
 13093                                 TO LOFC-CODE
 13094           PERFORM 8586-READ-LOAN-OFFICER
 13095                                 THRU 8586-EXIT
 13096           IF (NOT LOFC-MASTER-FOUND)
 13097              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 13098              MOVE ER-3006       TO WS-ERROR
 13099              PERFORM 9900-ERROR-FORMAT
 13100                                 THRU 9900-EXIT
 13101           END-IF
 13102        END-IF
 13103     END-IF
 13104     .
 13105 3129-EDIT-APR.
 13106
 13107     IF (WS-LF-BENEFIT-CD = ZERO)
 13108        OR (NO-LF-BENEFIT-MATCH)
 13109        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13110           GO TO 3130-EDIT-AGE
 13111*       ELSE
 13112*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13113*             GO TO 3130-EDIT-AGE
 13114*          END-IF
 13115        END-IF
 13116     END-IF
 13117
 13118     IF (WS-STATE-ABBREVIATION = 'OH')
 13119         AND (PB-I-RATE-CLASS NOT = 'L ')
 13120         AND (PB-I-LF-TERM GREATER THAN 60)
 13121         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13122         GO TO 3129-APR-CONT.
 13123
 13124     IF (WS-STATE-ABBREVIATION = 'RI')
 13125         AND (PB-I-LF-TERM GREATER THAN 60)
 13126         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13127         GO TO 3129-APR-CONT.
 13128
 13129     IF (WS-STATE-ABBREVIATION = 'UT')
 13130         AND (PB-I-LF-TERM GREATER THAN 62)
 13131         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13132         AND (PB-CERT-EFF-DT LESS WS-830901)
 13133         GO TO 3129-APR-CONT.
 13134
 13135     IF PB-COMPANY-ID = 'LAP'
 13136        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13137           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13138              MOVE ER-2656         TO WS-ERROR
 13139              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13140              GO TO 3130-EDIT-AGE.
 13141
 13142     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13143        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13144        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13145        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13146        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13147        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13148         GO TO 3130-EDIT-AGE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 240
* EL050.cbl
 13149
 13150 3129-APR-CONT.
 13151     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13152         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13153         GO TO 3130-EDIT-AGE.
 13154
 13155     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13156         WS-AH-BENEFIT-CD (1:1) = 'S')
 13157        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13158        AND (PB-I-LOAN-APR = ZERO)
 13159        MOVE ER-2657             TO WS-ERROR
 13160        PERFORM 9900-ERROR-FORMAT
 13161                                 THRU 9900-EXIT
 13162        GO TO 3130-EDIT-AGE
 13163     END-IF
 13164*    IF PB-I-LOAN-APR = ZERO
 13165*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13166*    END-IF
 13167
 13168     if pb-i-loan-apr = +99.9999
 13169        move er-2656             to ws-error
 13170        PERFORM 9900-ERROR-FORMAT
 13171                                 THRU 9900-EXIT
 13172        GO TO 3130-EDIT-AGE
 13173     end-if
 13174*    IF PB-I-LOAN-APR = ZERO
 13175*       MOVE ER-2656             TO WS-ERROR
 13176*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13177*       GO TO 3130-EDIT-AGE.
 13178
 13179*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13180     if pb-i-loan-apr not = +99.9999
 13181        IF PB-I-LOAN-APR > +30.000
 13182           MOVE ER-2657          TO WS-ERROR
 13183           PERFORM 9900-ERROR-FORMAT
 13184                                 THRU 9900-EXIT
 13185        end-if
 13186     end-if
 13187     .
 13188 3130-EDIT-AGE.
 13189
 13190******************************************************************
 13191*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13192******************************************************************
 13193
 13194     IF NOT NO-LIFE-COVERAGE
 13195        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13196           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13197               MOVE ER-2628             TO WS-ERROR
 13198               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13199
 13200     IF NOT NO-AH-COVERAGE
 13201        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13202           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13203               MOVE ER-2628         TO WS-ERROR
 13204               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13205
 13206 3133-SEX-CODE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 241
* EL050.cbl
 13207     IF PB-I-INSURED-SEX = SPACE OR ZERO
 13208         IF WS-DEFAULT-SEX = 'M'
 13209             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13210          ELSE
 13211             IF WS-DEFAULT-SEX = 'F'
 13212             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13213
 13214     IF PB-I-INSURED-SEX = '1'
 13215         MOVE 'M' TO PB-I-INSURED-SEX.
 13216
 13217     IF PB-I-INSURED-SEX = '2'
 13218         MOVE 'F' TO PB-I-INSURED-SEX.
 13219
 13220 3134-SIG-SW-EDIT.
 13221     IF PB-I-SIG-SW = SPACE
 13222         MOVE 'N'                TO  PB-I-SIG-SW.
 13223
 13224     IF PB-COMPANY-ID = 'NCL'
 13225         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13226             NEXT SENTENCE
 13227         ELSE
 13228             MOVE ER-1923        TO  WS-ERROR
 13229             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13230     ELSE
 13231     IF PB-COMPANY-ID = 'CRI'
 13232         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13233             NEXT SENTENCE
 13234         ELSE
 13235             MOVE ER-2606        TO  WS-ERROR
 13236             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13237     ELSE
 13238     IF PB-COMPANY-ID = 'TMS'
 13239         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13240             NEXT SENTENCE
 13241         ELSE
 13242             MOVE ER-2689        TO  WS-ERROR
 13243             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13244     ELSE
 13245         IF PB-I-SIG-SW = 'Y' OR 'N'
 13246             NEXT SENTENCE
 13247         ELSE
 13248             MOVE ER-2651        TO  WS-ERROR
 13249             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13250
 13251     IF PB-COMPANY-ID = 'FLA'
 13252         IF (WS-EDIT-AGE GREATER 54  OR
 13253             WS-AH-EDIT-AGE GREATER 54)  AND
 13254            PB-I-SIG-SW = 'N'
 13255            MOVE ER-2651         TO  WS-ERROR
 13256            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13257
 13258 3135-NAME-EDIT.
 13259
 13260     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13261        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13262        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13263           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13264                                 TO PB-I-JOINT-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 242
* EL050.cbl
 13265        END-PERFORM
 13266     END-IF
 13267     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13268        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13269        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13270           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13271                                 TO PB-I-JOINT-LAST-NAME
 13272        END-PERFORM
 13273     END-IF
 13274     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13275        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13276        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13277           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13278                                 TO PB-I-INSURED-FIRST-NAME
 13279        END-PERFORM
 13280     END-IF
 13281     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13282        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13283        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13284           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13285                                 TO PB-I-INSURED-LAST-NAME
 13286        END-PERFORM
 13287     END-IF
 13288     if PB-I-JOINT-COVERAGE *> and
 13289*       pb-i-insured-last-name <> spaces
 13290        if pb-i-insured-last-name = pb-i-joint-last-name and
 13291           pb-i-insured-first-name = pb-i-joint-first-name and
 13292           pb-i-birthday = pb-i-joint-birthday
 13293           move er-3069          to ws-error
 13294           perform 9900-error-format
 13295                                 thru 9900-exit
 13296        end-if
 13297     end-if
 13298     IF PB-I-INSURED-LAST-NAME = SPACES
 13299       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13300       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13301           MOVE ER-2660    TO WS-ERROR
 13302           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13303
 13304 3136-EDIT-SEX.
 13305
 13306******************************************************************
 13307*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13308******************************************************************
 13309
 13310     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13311        (WS-AH-SPECIAL-CALC-CD = 'O')
 13312        NEXT SENTENCE
 13313     ELSE
 13314        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13315           NEXT SENTENCE
 13316        ELSE
 13317           MOVE ER-2629            TO WS-ERROR
 13318           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13319
 13320 3137-EDIT-EFF-DATE.
 13321
 13322     IF PB-REISSUED-CERT       OR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 243
* EL050.cbl
 13323        PB-POLICY-IS-DECLINED  OR
 13324        PB-POLICY-IS-VOIDED
 13325         GO TO 3139-EDIT-COVERAGE-CODES.
 13326
 13327     MOVE SPACE                  TO WS-2671-SW
 13328                                    WS-2672-SW.
 13329
 13330     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13331         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13332             MOVE ER-2703        TO WS-ERROR
 13333             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13334             GO TO 3139-EDIT-COVERAGE-CODES.
 13335
 13336     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13337         GO TO 3139-EDIT-COVERAGE-CODES.
 13338
 13339     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13340     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13341*    MOVE '1'                    TO DC-OPTION-CODE.
 13342     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13343     MOVE +0                     TO DC-ELAPSED-MONTHS
 13344                                    DC-ELAPSED-DAYS.
 13345     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13346
 13347     IF DATE-CONVERSION-ERROR
 13348         GO TO 3139-EDIT-COVERAGE-CODES.
 13349
 13350     IF DC-ELAPSED-DAYS GREATER +180
 13351         MOVE ER-2672            TO WS-ERROR
 13352         MOVE 'Y'                TO WS-2672-SW
 13353         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13354     END-IF
 13355
 13356     IF WS-ERROR = ER-2671  AND
 13357        PB-COMPANY-ID  = 'LBL'
 13358        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13359        MOVE SPACE               TO WS-2671-SW
 13360        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13361
 13362     IF PB-ISSUE-DATE-FORCED  AND
 13363      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13364         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13365         MOVE ER-2673            TO WS-ERROR
 13366         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13367         MOVE SPACE              TO WS-2671-SW
 13368                                    WS-2672-SW.
 13369
 13370     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13371         IF PB-ISSUE-DATE-FORCED
 13372             MOVE ER-2600          TO  WS-ERROR
 13373             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13374         ELSE
 13375             MOVE ER-2692          TO  WS-ERROR
 13376             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13377
 13378
 13379 3139-EDIT-COVERAGE-CODES.
 13380
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 244
* EL050.cbl
 13381     if pb-company-id not = 'AHL'
 13382        IF (WS-LF-SPECIAL-CALC-CD = 'O')
 13383           or (ws-ah-special-calc-cd = 'O')
 13384           IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13385              PB-I-LF-ALT-PREMIUM-AMT) > 500000.00
 13386              MOVE ER-3071       TO WS-ERROR
 13387              PERFORM 9900-ERROR-FORMAT
 13388                                 THRU 9900-EXIT
 13389           end-if
 13390        END-IF
 13391     end-if
 13392     IF (WS-LF-SPECIAL-CALC-CD NOT = 'O')
 13393        and (ws-ah-special-calc-cd not = 'O')
 13394        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 13395                                 > 250000.00
 13396           MOVE ER-2719          TO WS-ERROR
 13397           PERFORM 9900-ERROR-FORMAT
 13398                                 THRU 9900-EXIT
 13399        END-IF
 13400        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13401           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13402           MOVE ER-2787          TO WS-ERROR
 13403           PERFORM 9900-ERROR-FORMAT
 13404                                 THRU 9900-EXIT
 13405        END-IF
 13406     END-IF
 13407
 13408     IF PB-POLICY-IS-DECLINED  OR
 13409        PB-POLICY-IS-VOIDED
 13410         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13411
 13412     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13413        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13414         MOVE ER-2630                TO WS-ERROR
 13415         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13416
 13417     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13418        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13419        PB-I-LF-PREMIUM-AMT = ZERO
 13420         GO TO 3140-CHECK-AH-FOR-ZERO.
 13421
 13422     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13423        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13424        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13425         GO TO 3140-CHECK-AH-FOR-ZERO.
 13426
 13427     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13428        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13429        MOVE ER-2631             TO WS-ERROR
 13430        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13431     END-IF
 13432
 13433
 13434******************************************************************
 13435*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13436******************************************************************
 13437
 13438     IF WS-LF-SPECIAL-CALC-CD = 'O'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 245
* EL050.cbl
 13439        NEXT SENTENCE
 13440     ELSE
 13441        IF PB-I-LF-BENEFIT-AMT = ZERO
 13442           MOVE ER-2632             TO WS-ERROR
 13443           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13444
 13445
 13446******************************************************************
 13447*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13448******************************************************************
 13449
 13450     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13451        CONTINUE
 13452     ELSE
 13453        IF PB-I-LF-PREMIUM-AMT = ZERO
 13454           IF (NOT PB-COMP-LF-PREM)
 13455              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13456              and (ws-lf-ben-category not = 'C')
 13457              MOVE ER-2633       TO WS-ERROR
 13458              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13459           END-IF
 13460        END-IF
 13461     END-IF
 13462     .
 13463 3140-CHECK-AH-FOR-ZERO.
 13464
 13465     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13466        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13467        PB-I-AH-PREMIUM-AMT = ZERO
 13468         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13469
 13470     IF PB-COMPANY-ID = 'CSL'  AND
 13471        PB-I-AH-BENEFIT-CD = ZERO  AND
 13472        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13473        PB-I-AH-PREMIUM-AMT = ZERO
 13474         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13475
 13476     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13477        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13478        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13479         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13480
 13481     IF PB-I-AH-BENEFIT-CD = ZERO
 13482         MOVE ER-2634            TO WS-ERROR
 13483         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13484
 13485******************************************************************
 13486*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13487******************************************************************
 13488
 13489     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13490        NEXT SENTENCE
 13491     ELSE
 13492        IF PB-I-AH-BENEFIT-AMT = ZERO
 13493           MOVE ER-2635             TO WS-ERROR
 13494           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13495
 13496******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 246
* EL050.cbl
 13497*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13498******************************************************************
 13499
 13500     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13501        NEXT SENTENCE
 13502     ELSE
 13503        IF PB-I-AH-PREMIUM-AMT = ZERO
 13504            IF NOT PB-COMP-AH-PREM
 13505                MOVE ER-2636    TO WS-ERROR
 13506                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13507
 13508
 13509 3140-EDIT-MAX-AMT-SIZES.
 13510* CUSTOM CODE FOR CLIENT    'DMD'
 13511     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13512                                     WS-RES-MUNI-TAX
 13513                                     PB-I-STATE-TAX
 13514                                     PB-I-MUNI-TAX.
 13515
 13516     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13517
 13518     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13519        GO TO 3150-RATE-OUTSTAND-BAL.
 13520
 13521     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13522        GO TO 3150-RATE-OUTSTAND-BAL.
 13523
 13524     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13525        GO TO 3150-RATE-OUTSTAND-BAL.
 13526
 13527     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13528                             OR 'RIC')
 13529        GO TO 3150-RATE-OUTSTAND-BAL.
 13530
 13531     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13532        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13533            GO TO 3150-RATE-OUTSTAND-BAL
 13534        ELSE
 13535           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13536               GO TO 3150-RATE-OUTSTAND-BAL.
 13537
 13538     IF NOT PB-NO-MONTHS-SKIPPED
 13539        GO TO 3150-RATE-OUTSTAND-BAL.
 13540
 13541     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13542        GO TO 3150-RATE-OUTSTAND-BAL.
 13543
 13544     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13545        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13546           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13547             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13548           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13549           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13550              MOVE ER-2693     TO WS-ERROR
 13551              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13552              GO TO 3150-RATE-OUTSTAND-BAL
 13553           ELSE
 13554              GO TO 3150-RATE-OUTSTAND-BAL.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 247
* EL050.cbl
 13555
 13556 3150-RATE-OUTSTAND-BAL.
 13557
 13558* DMD RATING TEST
 13559     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13560         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13561         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13562         MOVE ER-2687                 TO WS-ERROR
 13563         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13564         MOVE 'B'                     TO PB-I-OB-FLAG
 13565         GO TO 3260-EDIT-CONTINUE.
 13566
 13567     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13568         IF  WS-ERROR    EQUAL    ER-2693
 13569             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13570                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13571                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13572                 MOVE  +0            TO  WS-ERROR.
 13573
 13574     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13575         IF  WS-ERROR    EQUAL    ER-2693
 13576             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13577                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13578                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13579                 MOVE  +0            TO  WS-ERROR.
 13580
 13581     IF PLAN-MASTER-AH-SW = 'Y'
 13582        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13583            IF  WS-ERROR    EQUAL    ER-2693
 13584              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13585                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13586                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13587                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13588                 MOVE  ER-1910           TO  WS-ERROR
 13589                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13590
 13591     IF PLAN-MASTER-AH-SW = 'Y'
 13592        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13593            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13594               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13595               MOVE  ER-1910           TO  WS-ERROR
 13596               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13597
 13598     IF PLAN-MASTER-AH-SW = 'Y'
 13599        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13600            IF  WS-ERROR    EQUAL    ER-2693
 13601                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13602                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13603                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13604                 MOVE  +0       TO  WS-ERROR.
 13605
 13606     IF WS-ERROR = ER-2693
 13607        IF PB-COMPANY-ID = 'JAL' AND
 13608           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13609           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13610           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13611
 13612     IF WS-ERROR = ER-2693
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 248
* EL050.cbl
 13613        IF PB-COMPANY-ID = 'NCL'  AND
 13614           PB-I-AH-BENEFIT-CD = 'OA'
 13615           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13616           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13617
 13618     IF WS-ERROR = ER-2693
 13619        IF PB-COMPANY-ID = 'CNL' AND
 13620           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13621           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13622           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13623
 13624     IF WS-ERROR = ER-2693
 13625        IF PB-COMPANY-ID = 'HER'
 13626           IF WS-LEVEL
 13627              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13628              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13629
 13630     IF ((LF-BENEFIT-FOUND) AND
 13631         (NOT NO-LIFE-COVERAGE)  AND
 13632         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13633       OR   ((AH-BENEFIT-FOUND) AND
 13634             (NOT NO-AH-COVERAGE)    AND
 13635             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13636         NEXT SENTENCE
 13637     ELSE
 13638         GO TO 3215-EDIT-RATES.
 13639
 13640     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13641        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13642           MOVE ER-2674          TO WS-ERROR
 13643           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13644           GO TO 3215-EDIT-RATES.
 13645
 13646     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13647        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13648           MOVE ER-2674          TO WS-ERROR
 13649           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13650           GO TO 3215-EDIT-RATES.
 13651
 13652     MOVE 'B'                    TO PB-I-OB-FLAG.
 13653
 13654     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13655         NEXT SENTENCE
 13656     ELSE
 13657         IF NOT NO-LIFE-COVERAGE
 13658             IF WS-ACCT-LF-OB-RT = ZERO
 13659                MOVE ER-2641    TO WS-ERROR
 13660                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13661
 13662     IF PB-COMPANY-ID = 'CRI'
 13663       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13664         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13665         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13666         IF WS-ERROR = ER-2675
 13667            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13668            MOVE ER-2687              TO WS-ERROR
 13669            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13670         ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 249
* EL050.cbl
 13671            MOVE ER-2687              TO WS-ERROR
 13672            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13673
 13674
 13675     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13676         NEXT SENTENCE
 13677     ELSE
 13678       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13679            NEXT SENTENCE
 13680       ELSE
 13681         IF NOT NO-AH-COVERAGE
 13682             IF WS-ACCT-AH-OB-RT = ZERO
 13683                MOVE ER-2642    TO WS-ERROR
 13684                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13685
 13686     IF PB-COMPANY-ID = 'CRI'
 13687       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13688         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13689         IF WS-ERROR = ER-2676
 13690            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13691            MOVE ER-2687              TO WS-ERROR
 13692            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13693         ELSE
 13694            MOVE ER-2687              TO WS-ERROR
 13695            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13696
 13697     IF PB-COMPANY-ID NOT = 'GIC'
 13698         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13699            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13700     ELSE
 13701         IF PB-I-LF-PREM-CALC = ZEROS
 13702             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13703                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13704
 13705     IF PB-COMPANY-ID NOT = 'GIC'
 13706         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13707            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13708     ELSE
 13709         IF PB-I-AH-PREM-CALC = ZEROS
 13710             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13711                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13712
 13713     MOVE ZEROS TO PB-I-MORT-CODE.
 13714
 13715     GO TO 3260-EDIT-CONTINUE.
 13716
 13717
 13718 3215-EDIT-RATES.
 13719     IF ACCOUNT-MAST-FOUND
 13720         NEXT SENTENCE
 13721     ELSE
 13722         GO TO 3999-END-EDIT.
 13723
 13724 3220-CHECK-LF-RATES.
 13725
 13726     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13727        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13728        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 250
* EL050.cbl
 13729        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13730           AND (NOT WS-LF-CASH))
 13731                           OR
 13732           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13733           AND (NOT WS-AH-CASH)))
 13734                       AND
 13735           (PB-I-ENTRY-STATUS NOT = '5')
 13736           MOVE 'M'              TO PB-BATCH-ENTRY
 13737                                    PB-I-ENTRY-STATUS
 13738        END-IF
 13739     END-IF
 13740     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13741                                    PB-I-AH-PREM-CALC
 13742                                    PB-I-LF-ALT-PREM-CALC
 13743                                    PB-I-LF-ALT-RATE
 13744                                    PB-I-LF-REI-RATE
 13745                                    PB-I-LF-ALT-REI-RATE
 13746                                    PB-I-AH-REI-RATE
 13747                                    PB-I-TOT-FEES-CALC.
 13748
 13749     IF PB-COMPANY-ID EQUAL 'DMD'
 13750        NEXT SENTENCE
 13751     ELSE
 13752        MOVE ZEROS               TO PB-I-LF-RATE
 13753                                    PB-I-AH-RATE.
 13754
 13755     IF PB-I-TOT-FEES NOT NUMERIC
 13756        MOVE ZEROS               TO PB-I-TOT-FEES
 13757     END-IF
 13758     IF PB-I-LIVES NOT NUMERIC
 13759         MOVE ZERO               TO PB-I-LIVES.
 13760
 13761     IF PB-I-NUM-BILLED NOT NUMERIC
 13762         MOVE ZERO               TO PB-I-NUM-BILLED.
 13763
 13764     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13765        MOVE +0                  TO PB-I-LF-PREM-TAX
 13766     END-IF
 13767
 13768     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13769        MOVE +0                  TO PB-I-AH-PREM-TAX
 13770     END-IF
 13771
 13772     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13773        PB-I-PAY-FREQUENCY = ZEROS
 13774            MOVE 12 TO CP-PAY-FREQUENCY
 13775     ELSE
 13776            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13777
 13778     IF PB-I-STATE-TAX NOT NUMERIC
 13779         MOVE ZEROS               TO PB-I-STATE-TAX.
 13780
 13781     IF PB-I-MUNI-TAX NOT NUMERIC
 13782         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13783
 13784     MOVE SPACES                 TO CP-BEN-CATEGORY
 13785     IF PB-COMPANY-ID  = 'CSL'  AND
 13786        PB-I-LF-TERM NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 251
* EL050.cbl
 13787        COMPUTE WS-PAYMENT-AMT =
 13788             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13789        COMPUTE WS-CSL-AMT1 =
 13790             PB-I-LF-TERM * AM-MAX-MON-BEN
 13791        COMPUTE WS-CSL-AMT2 =
 13792             WS-PAYMENT-AMT * PB-I-LF-TERM
 13793        IF CP-PAY-FREQUENCY NOT = 12
 13794           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13795           MOVE '8' TO WS-CSL-CALC-CD
 13796        ELSE
 13797           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13798              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13799               AM-MAX-TOT-BEN
 13800               MOVE '6' TO WS-CSL-CALC-CD
 13801           ELSE
 13802              IF (WS-CSL-AMT1  GREATER THAN
 13803                 AM-MAX-TOT-BEN) AND
 13804                 (WS-CSL-AMT2  GREATER THAN
 13805                 AM-MAX-TOT-BEN)
 13806                 MOVE '7' TO WS-CSL-CALC-CD
 13807              ELSE
 13808                 MOVE '5' TO WS-CSL-CALC-CD.
 13809
 13810     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13811         NEXT SENTENCE
 13812     ELSE
 13813         GO TO 3300-CHECK-AH-RATES.
 13814
 13815*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13816
 13817     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13818        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13819              OR
 13820           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13821           MOVE ER-2618          TO WS-ERROR
 13822           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13823           GO TO 3300-CHECK-AH-RATES.
 13824
 13825     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13826           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13827                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13828
 13829     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13830         MOVE ER-2687             TO WS-ERROR
 13831         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13832         MOVE 'Z000'              TO PB-I-MORT-CODE
 13833         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13834         GO TO 3300-CHECK-AH-RATES.
 13835
 13836     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13837        IF PB-I-LIVES = ZERO
 13838           MOVE ER-2688          TO WS-ERROR
 13839           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13840
 13841     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13842
 13843     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13844     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 252
* EL050.cbl
 13845     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13846     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13847     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13848     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13849     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13850     MOVE '3'                    TO CP-PROCESS-TYPE.
 13851     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13852     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13853
 13854******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13855     IF PB-COMPANY-ID EQUAL 'CDL'
 13856         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13857            CP-EARN-AS-NET-PAY)
 13858             IF PB-CERT-EFF-DT GREATER  WS-931231
 13859                 MOVE '1'        TO CP-EARNING-METHOD.
 13860*******
 13861
 13862     MOVE PB-SV-STATE            TO CP-STATE.
 13863     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13864     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13865     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13866     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13867     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13868                                    CP-RATING-BENEFIT-AMT.
 13869     IF CP-STATE-STD-ABBRV = 'OR'
 13870         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13871                                         PB-I-LF-ALT-BENEFIT-AMT.
 13872     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13873     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13874     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13875     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13876     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13877     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13878     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13879     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13880     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13881                                    CP-REMAINING-TERM
 13882                                    CP-LOAN-TERM.
 13883
 13884     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13885         NEXT SENTENCE
 13886     ELSE
 13887         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13888             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13889                                           PB-I-LF-PREMIUM-AMT.
 13890
 13891     IF PB-COMPANY-ID EQUAL 'CSL'
 13892        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13893           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13894                                         PB-I-LF-PREMIUM-AMT.
 13895
 13896     IF PB-COMPANY-ID EQUAL 'NCB'
 13897         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13898            CP-EARN-AS-NET-PAY
 13899             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13900                 PB-I-LF-PREMIUM-AMT.
 13901
 13902     IF (CP-TRUNCATED-LIFE)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 253
* EL050.cbl
 13903        or ((pb-company-id = 'AHL')
 13904           and (pb-i-loan-term > pb-i-lf-term))
 13905        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13906
 13907     IF PB-COMPANY-ID EQUAL 'CRI'
 13908        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13909
 13910     IF CP-TERM-IS-DAYS
 13911         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13912     ELSE
 13913         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13914     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13915        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13916        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13917        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13918        IF WS-LF-BEN-CATEGORY = 'D'
 13919           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13920           MOVE PB-I-LIFE-COMMISSION
 13921                                 TO CP-DCC-ACT-COMM
 13922           MOVE WS-LF-BEN-CATEGORY
 13923                                 TO CP-BEN-CATEGORY
 13924        END-IF
 13925        IF (CP-BENEFIT-CD (1:1) = 'P')
 13926           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13927           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13928           add pb-i-ah-premium-amt to cp-original-premium
 13929        END-IF
 13930     END-IF
 13931     IF PB-COMPANY-ID = 'CSL'
 13932         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13933         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13934         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13935
 13936     IF PB-COMPANY-ID = 'CSL'
 13937        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13938
 13939     IF (CP-SPECIAL-CALC-CD = 'H')
 13940        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13941         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13942                                    TO CP-ALTERNATE-BENEFIT
 13943         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13944     if (pb-company-id = 'CID')
 13945        and (ws-lf-earnings-calc = '4')
 13946        and (cp-state-std-abbrv = 'MN' OR 'WA' or 'AL')
 13947        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13948        move pb-i-term-type      to cp-pmt-mode
 13949        move pb-i-no-of-payments to cp-no-of-pmts
 13950        move pb-i-ah-benefit-amt to cp-monthly-payment
 13951     end-if
 13952     move ws-net-only-state      to cp-net-only-state
 13953     IF (PB-COMPANY-ID = 'CID')
 13954        AND (WS-LF-EARNINGS-CALC = 'B')
 13955        AND (CP-STATE-STD-ABBRV = 'MN')
 13956        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13957                                 TO CP-ALTERNATE-BENEFIT
 13958        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13959     END-IF
 13960     IF (PB-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 254
* EL050.cbl
 13961        AND (WS-LF-EARNINGS-CALC = 'B')
 13962        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13963                                 TO CP-ALTERNATE-BENEFIT
 13964        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13965        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13966*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13967*         pb-i-lf-alt-premium-amt
 13968        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13969        IF WS-LF-BEN-CATEGORY = 'P'
 13970           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13971        ELSE
 13972           IF WS-LF-BEN-CATEGORY = 'I'
 13973              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13974           END-IF
 13975        END-IF
 13976     END-IF
 13977     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13978     MOVE 'R'                   TO CP-RATE-FILE.
 13979     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13980
 13981     IF CP-ERROR-RATE-NOT-FOUND
 13982        MOVE ER-2641            TO WS-ERROR
 13983        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13984        GO TO 3300-CHECK-AH-RATES.
 13985
 13986     IF PB-COMPANY-ID EQUAL 'CRI'
 13987        IF CP-ERROR-NO-LIMITS-CRI
 13988           IF NOT ACCOUNT-LIFE-CHECKED
 13989              MOVE ER-2607      TO WS-ERROR
 13990              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13991
 13992******************************************************************
 13993*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13994*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13995******************************************************************
 13996
 13997* CALC LIFE AGE AT EXPIRATION.
 13998
 13999     COMPUTE WS-AGE-AT-EXPIRE =
 14000          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 14001
 14002*    IF PB-STATE = 'CO' OR 'UT'
 14003*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 14004*        MOVE 'F'            TO PB-FATAL-FLAG
 14005*        MOVE ER-2709        TO WS-ERROR
 14006*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14007*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 14008
 14009*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 14010*        MOVE 'X'            TO PB-FATAL-FLAG
 14011*        MOVE ER-2718        TO WS-ERROR
 14012*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14013*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 14014
 14015* CALC A & H AGE AT EXPIRATION.
 14016
 14017     COMPUTE WS-AGE-AT-EXPIRE =
 14018          ((PB-I-AH-TERM / 12) + PB-I-AGE).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 255
* EL050.cbl
 14019
 14020*    IF PB-STATE = 'CO' OR 'UT'
 14021*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 14022*        MOVE 'F'            TO PB-FATAL-FLAG
 14023*        MOVE ER-2709        TO WS-ERROR
 14024*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14025*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 14026
 14027*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 14028*        MOVE 'X'            TO PB-FATAL-FLAG
 14029*        MOVE ER-2718        TO WS-ERROR
 14030*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14031*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 14032
 14033     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 14034        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 14035
 14036     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14037        and (not pb-monthly-cert)
 14038        GO TO 3221-CHECK-ERROR-RATE-OPEN
 14039     end-if
 14040
 14041     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14042        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 14043
 14044     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14045         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 14046         MOVE ER-2639        TO WS-ERROR
 14047         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14048
 14049
 14050******************************************************************
 14051*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14052******************************************************************
 14053
 14054 PREMIUM-EDITING-IS-BYPASSED.
 14055     IF (CP-R-MAX-ATT-AGE NUMERIC)
 14056        AND (CP-R-MAX-ATT-AGE > +0)
 14057        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 14058        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14059           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14060           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14061           MOVE '1'              TO DC-OPTION-CODE
 14062           PERFORM 8500-DATE-CONVERT
 14063                                 THRU 8500-EXIT
 14064           IF NO-CONVERSION-ERROR
 14065              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14066                 MOVE ER-2661       TO WS-ERROR
 14067*                PERFORM 9900-ERROR-FORMAT
 14068*                                THRU 9900-EXIT
 14069              END-IF
 14070           END-IF
 14071        ELSE
 14072           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 14073           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14074              MOVE ER-2661       TO WS-ERROR
 14075*             PERFORM 9900-ERROR-FORMAT
 14076*                                THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 256
* EL050.cbl
 14077           ELSE
 14078              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14079                 MOVE ER-1570    TO WS-ERROR
 14080                 PERFORM 9900-ERROR-FORMAT
 14081                                 THRU 9900-EXIT
 14082              END-IF
 14083           END-IF
 14084        END-IF
 14085        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14086           MOVE PB-I-JOINT-BIRTHDAY
 14087                                 TO DC-BIN-DATE-1
 14088           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14089           MOVE '1'              TO DC-OPTION-CODE
 14090           PERFORM 8500-DATE-CONVERT
 14091                                 THRU 8500-EXIT
 14092           IF NO-CONVERSION-ERROR
 14093              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14094                 MOVE ER-2661       TO WS-ERROR
 14095*                PERFORM 9900-ERROR-FORMAT
 14096*                                THRU 9900-EXIT
 14097              END-IF
 14098           ELSE
 14099              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 14100           END-IF
 14101        ELSE
 14102           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14103             (PB-I-LF-TERM / 12)
 14104           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14105              MOVE ER-2661       TO WS-ERROR
 14106*             PERFORM 9900-ERROR-FORMAT
 14107*                                THRU 9900-EXIT
 14108           ELSE
 14109              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14110                 MOVE ER-1571    TO WS-ERROR
 14111                 PERFORM 9900-ERROR-FORMAT
 14112                                 THRU 9900-EXIT
 14113              END-IF
 14114           END-IF
 14115        END-IF
 14116        IF WS-ERROR = ER-2661
 14117           PERFORM 9900-ERROR-FORMAT
 14118                                 THRU 9900-EXIT
 14119        END-IF
 14120     END-IF
 14121*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14122*       MOVE ER-2661             TO WS-ERROR
 14123*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14124
 14125     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14126        MOVE ER-2662             TO WS-ERROR
 14127        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14128
 14129     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14130        MOVE ER-2677             TO WS-ERROR
 14131        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14132
 14133     IF CP-ERROR-LOAN-TERM
 14134        MOVE ER-2648             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 257
* EL050.cbl
 14135        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14136     if cp-error-term-below-minimum
 14137        move er-3070             to ws-error
 14138        perform 9900-error-format thru 9900-exit
 14139     end-if
 14140     .
 14141 3221-CHECK-ERROR-RATE-OPEN.
 14142
 14143     IF CP-ERROR-RATE-FILE-NOTOPEN
 14144         GO TO 3990-FILES-NOT-OPEN.
 14145
 14146     IF PB-COMPANY-ID NOT = 'DMD'
 14147        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14148     END-IF
 14149     .
 14150 3221-CONTINUE.
 14151     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14152                                    WS-DCC-AH-RATE
 14153     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14154        IF WS-LF-BEN-CATEGORY = 'D'
 14155           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14156              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14157        END-IF
 14158     END-IF
 14159     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14160*   X'A4FF' = 12/31/2009
 14161     IF (PB-COMPANY-ID = 'CID')
 14162        AND (WS-LF-EARNINGS-CALC = 'B')
 14163        AND (CP-STATE-STD-ABBRV = 'MN')
 14164        AND (PB-CERT-EFF-DT > X'A4FF')
 14165        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14166     END-IF
 14167     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14168
 14169     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14170     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14171        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14172        AND (PB-I-POLICY-IS-MONTHLY)
 14173        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14174        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14175     END-IF
 14176     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14177     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14178     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14179     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14180     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14181        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14182        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14183        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14184        MOVE ER-2786             TO WS-ERROR
 14185        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14186     END-IF
 14187
 14188     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14189
 14190******************************************************************
 14191*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14192******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 258
* EL050.cbl
 14193     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14194        and ((not pb-monthly-cert)
 14195        or (ws-lf-ben-category = 'C'))
 14196        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14197
 14198     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14199        GO TO 3225-CHECK-ALT-LIFE-RATE
 14200     ELSE
 14201       IF PB-I-LF-RATE = ZERO
 14202          MOVE ER-2641          TO WS-ERROR
 14203          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14204
 14205 3225-CHECK-ALT-LIFE-RATE.
 14206
 14207     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14208        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14209        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14210         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14211
 14212     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14213         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14214             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14215                   OR
 14216              (PB-I-LF-ALT-PREMIUM-AMT > +0
 14217              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14218              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14219             MOVE ER-2720        TO  WS-ERROR
 14220             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14221             GO TO 3225-RATING-CONT
 14222         ELSE
 14223             GO TO 3225-RATING-CONT.
 14224     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14225        AND (AM-GPCD = 01 OR 06 OR 15)
 14226        MOVE ER-2798             TO WS-ERROR
 14227        PERFORM 9900-ERROR-FORMAT
 14228                                 THRU 9900-EXIT
 14229*       GO TO 3225-RATING-CONT
 14230     END-IF
 14231     if (pb-company-id = 'CID')
 14232        and (ws-lf-earnings-calc = 'B')
 14233        and (ws-lf-ben-category = 'P' or 'I')
 14234        and (ws-net-only-state = 'Y')
 14235        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14236*       display ' balloon prem ' pb-i-lf-alt-prem-calc
 14237        go to 3225-rating-cont
 14238     end-if
 14239     IF (PB-COMPANY-ID = 'CID')
 14240        AND (WS-LF-EARNINGS-CALC = 'B')
 14241        AND (CP-STATE-STD-ABBRV = 'MN')
 14242        AND (PB-CERT-EFF-DT > X'A4FF')
 14243        GO TO 3225-RATING-CONT
 14244     END-IF
 14245     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14246        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14247           AND (PB-I-POLICY-IS-MONTHLY)
 14248           GO TO 3225-RATING-CONT
 14249        END-IF
 14250     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 259
* EL050.cbl
 14251
 14252     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14253        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14254        CP-EARN-AS-REG-BALLOON
 14255        NEXT SENTENCE
 14256     ELSE
 14257        MOVE '2'                 TO CP-EARNING-METHOD.
 14258
 14259 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14260
 14261     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14262
 14263     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14264        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14265        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14266         NEXT SENTENCE
 14267     ELSE
 14268         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14269
 14270     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14271     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14272     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14273                                     CP-RATING-BENEFIT-AMT.
 14274     IF CP-STATE-STD-ABBRV = 'OR'
 14275         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14276                                         PB-I-LF-ALT-BENEFIT-AMT.
 14277     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14278        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14279     END-IF
 14280     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14281     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14282     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14283                                    CP-REMAINING-TERM
 14284                                    CP-LOAN-TERM.
 14285     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14286        ADD +1                   TO CP-ORIGINAL-TERM
 14287                                    CP-REMAINING-TERM
 14288                                    CP-LOAN-TERM.
 14289
 14290     MOVE 'R'                   TO CP-RATE-FILE.
 14291     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14292
 14293     IF CP-ERROR-RATE-NOT-FOUND
 14294         MOVE ER-2641            TO WS-ERROR
 14295         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14296         GO TO 3300-CHECK-AH-RATES.
 14297
 14298     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14299     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14300
 14301     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14302         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14303
 14304     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14305                               + PB-I-LF-ALT-BENEFIT-AMT.
 14306
 14307     IF ACCOUNT-LIFE-CHECKED  OR
 14308        PB-POLICY-IS-VOIDED   OR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 260
* EL050.cbl
 14309        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14310        and (not pb-monthly-cert))
 14311        GO TO 3225-CONTINUE.
 14312
 14313     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14314        GO TO 3225-CONTINUE.
 14315
 14316     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14317                             EC-RT-LF-MAX-TOT-BEN
 14318        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 14319        MOVE ER-2639       TO WS-ERROR
 14320        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14321
 14322 3225-CONTINUE.
 14323     IF PB-I-LF-ALT-RATE = ZERO
 14324         MOVE ER-2659            TO WS-ERROR
 14325         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14326
 14327     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14328        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14329        MOVE ER-2698             TO WS-ERROR
 14330        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14331
 14332 3225-RATING-CONT.
 14333
 14334     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14335        and (not pb-monthly-cert)
 14336         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14337         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14338         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14339            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14340            CONTINUE
 14341         ELSE
 14342            MOVE ER-2687         TO WS-ERROR
 14343            PERFORM 9900-ERROR-FORMAT
 14344                                 THRU 9900-EXIT
 14345         END-IF
 14346         GO TO 3290-EDIT-LF-REIN-RATE
 14347     END-IF
 14348
 14349* DMD RATING TEST
 14350     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14351         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14352         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14353         MOVE ER-2687                 TO WS-ERROR
 14354         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14355         GO TO 3290-EDIT-LF-REIN-RATE.
 14356
 14357 3230-CLIENT-MORT-CD-SPECIALS.
 14358
 14359     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14360     SET BIN-TO-GREG          TO TRUE.
 14361*    MOVE ' '                 TO DC-OPTION-CODE.
 14362     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14363     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14364
 14365 C-POS-3230-MORT-CD.
 14366     IF PB-COMPANY-ID = 'POS' AND
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 261
* EL050.cbl
 14367        PB-SV-CARRIER = '2'
 14368         NEXT SENTENCE
 14369     ELSE
 14370         GO TO C-POS-3240-MORT-CD.
 14371
 14372     IF PB-SV-GROUPING = '030'
 14373        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14374         MOVE '2350' TO PB-I-MORT-CODE
 14375      ELSE
 14376         MOVE '3300' TO PB-I-MORT-CODE.
 14377
 14378
 14379 C-POS-3240-MORT-CD.
 14380     IF PB-COMPANY-ID = 'POS' AND
 14381        PB-SV-CARRIER = '1'
 14382         NEXT SENTENCE
 14383     ELSE
 14384         GO TO 3230-CONTINUE.
 14385
 14386     IF PB-SV-STATE = '45' OR '47'
 14387        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14388         MOVE '5200' TO PB-I-MORT-CODE
 14389     ELSE
 14390         MOVE '8300' TO PB-I-MORT-CODE.
 14391
 14392 3230-CONTINUE.
 14393
 14394     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14395        GO TO 3240-CONTINUE
 14396     END-IF
 14397
 14398     IF PB-CERT-EFF-DT > WS-971231
 14399        GO TO 3240-CONTINUE
 14400     END-IF
 14401
 14402     IF LF-BENEFIT-FOUND AND
 14403        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14404         MOVE 'F250'       TO PB-I-MORT-CODE
 14405     ELSE
 14406         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14407             MOVE '7250'   TO PB-I-MORT-CODE
 14408         ELSE
 14409             MOVE '4251'   TO PB-I-MORT-CODE
 14410         END-IF
 14411     END-IF
 14412
 14413     .
 14414 3240-CONTINUE.
 14415
 14416     IF PB-COMPANY-ID NOT = 'GNL'
 14417         GO TO 3256-CONTINUE.
 14418
 14419     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14420         MOVE 'A300' TO PB-I-MORT-CODE
 14421     ELSE
 14422         MOVE '8350' TO PB-I-MORT-CODE.
 14423
 14424 3256-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 262
* EL050.cbl
 14425     IF PB-COMPANY-ID NOT = 'ABL'
 14426         GO TO 3260-EDIT-CONTINUE.
 14427
 14428     IF PB-I-LF-TERM GREATER THAN 59
 14429         MOVE 'F550' TO PB-I-MORT-CODE
 14430     ELSE
 14431         MOVE 'E550' TO PB-I-MORT-CODE.
 14432
 14433 3260-EDIT-CONTINUE.
 14434     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 14435
 14436 3290-EDIT-LF-REIN-RATE.
 14437     IF LF-REIN-NSP-NOT-USED
 14438         GO TO 3290-RATING-CONT.
 14439
 14440     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14441        GO TO 3290-RATING-CONT.
 14442     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14443     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14444     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14445     MOVE '3'                   TO CP-PROCESS-TYPE.
 14446     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14447
 14448******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 14449     IF PB-COMPANY-ID EQUAL 'CDL'
 14450         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14451            CP-EARN-AS-NET-PAY)
 14452             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14453*            MOVE SPACE          TO DC-OPTION-CODE
 14454             SET BIN-TO-GREG     TO TRUE
 14455             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14456***  Y2K PROJ 7744
 14457             IF DC-GREG-DATE-CYMD GREATER 19931231
 14458                 MOVE '1'        TO CP-EARNING-METHOD.
 14459***  Y2K PROJ 7744
 14460*******
 14461
 14462     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14463     MOVE PB-SV-STATE           TO CP-STATE.
 14464     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14465     MOVE ZERO                  TO CP-DEVIATION-CODE
 14466                                   CP-RATE-DEV-PCT.
 14467     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14468     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14469                                   CP-RATING-BENEFIT-AMT.
 14470
 14471************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14472     IF PB-COMPANY-ID EQUAL 'NCB'
 14473         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14474            CP-EARN-AS-NET-PAY
 14475             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14476                 PB-I-LF-PREMIUM-AMT.
 14477************
 14478
 14479     IF CP-STATE-STD-ABBRV = 'OR'
 14480         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14481                                         PB-I-LF-ALT-BENEFIT-AMT.
 14482     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 263
* EL050.cbl
 14483     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14484     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14485     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14486     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14487     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14488     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14489     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14490                                   CP-REMAINING-TERM
 14491                                   CP-LOAN-TERM.
 14492     IF CP-TRUNCATED-LIFE
 14493        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14494
 14495     IF CP-TERM-IS-DAYS
 14496         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14497     ELSE
 14498         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14499
 14500     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14501        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14502     END-IF
 14503     IF PB-COMPANY-ID NOT = 'TIC'
 14504          MOVE ZERO          TO CP-CLASS-CODE.
 14505
 14506     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14507
 14508     MOVE 'R'                   TO CP-RATE-FILE.
 14509     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14510
 14511     IF CP-ERROR-RATE-NOT-FOUND
 14512        IF PB-I-OB
 14513           MOVE ER-2625      TO WS-ERROR
 14514           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14515           GO TO 3299-EDIT-CONTINUE
 14516        ELSE
 14517           MOVE ER-2643      TO WS-ERROR
 14518           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14519           GO TO 3299-EDIT-CONTINUE.
 14520
 14521     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14522
 14523     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14524     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14525
 14526     IF PB-I-LF-REI-RATE = ZERO
 14527         MOVE ER-2643        TO WS-ERROR
 14528         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14529
 14530 3290-CHECK-ALT-REIN-RATE.
 14531
 14532     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14533        GO TO 3290-RATING-CONT.
 14534
 14535     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14536     MOVE '2'                    TO CP-EARNING-METHOD.
 14537     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14538     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14539     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14540     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 264
* EL050.cbl
 14541                                     CP-RATING-BENEFIT-AMT.
 14542     IF CP-STATE-STD-ABBRV = 'OR'
 14543         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14544                                         PB-I-LF-ALT-BENEFIT-AMT.
 14545     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14546        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14547     END-IF
 14548     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14549     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14550     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14551                                    CP-REMAINING-TERM
 14552                                    CP-LOAN-TERM.
 14553     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14554        ADD +1                   TO CP-ORIGINAL-TERM
 14555                                    CP-REMAINING-TERM
 14556                                    CP-LOAN-TERM.
 14557
 14558     MOVE 'R'                   TO CP-RATE-FILE.
 14559     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14560
 14561     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14562
 14563     IF PB-I-LF-ALT-REI-RATE = ZERO
 14564         MOVE ER-2643            TO WS-ERROR
 14565         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14566
 14567 3290-RATING-CONT.
 14568
 14569     IF PB-I-OB
 14570*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14571        GO TO 3300-CHECK-AH-RATES.
 14572
 14573 3299-EDIT-CONTINUE.
 14574
 14575     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14576         NEXT SENTENCE
 14577     ELSE
 14578         MOVE ER-2620           TO WS-ERROR
 14579         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14580
 14581 3300-CHECK-AH-RATES.
 14582     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14583         NEXT SENTENCE
 14584     ELSE
 14585         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14586
 14587     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14588        and (not pb-monthly-cert))
 14589                  or
 14590        ((CF-COMPANY-ID = 'DMD') AND
 14591                (NO-DMD-RATING))
 14592         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14593            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14594            CONTINUE
 14595         ELSE
 14596            MOVE ER-2687         TO WS-ERROR
 14597            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14598         END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 265
* EL050.cbl
 14599         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14600         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14601     END-IF
 14602
 14603     IF PB-I-OB
 14604        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14605
 14606     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14607         MOVE ER-2687             TO WS-ERROR
 14608         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14609         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14610         GO TO 3999-END-EDIT.
 14611
 14612*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14613     if pb-company-id = 'AHL'
 14614        go to 3300-skip-crit-per
 14615     end-if
 14616     if (pb-i-ah-crit-per not = zeros)
 14617        and (ws-ah-special-calc-cd not = 'C')
 14618        MOVE ER-1572             TO WS-ERROR
 14619        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14620        go to 3300-skip-crit-per
 14621     END-IF
 14622     if (pb-company-id = 'DCC' or 'VPP')
 14623        and (am-dcc-product-code not = spaces)
 14624        go to 3300-skip-crit-per
 14625     end-if
 14626     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14627        IF PB-I-AH-CRIT-PER = ZERO
 14628           move ws-ah-max-bens   to pb-i-ah-crit-per
 14629*          MOVE ER-2618       TO WS-ERROR
 14630*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14631*          GO TO 3999-END-EDIT
 14632        END-IF
 14633     END-IF
 14634     if (ws-ah-special-calc-cd = 'C')
 14635        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14636        MOVE ER-1576             TO WS-ERROR
 14637        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14638     end-if
 14639
 14640     .
 14641 3300-skip-crit-per.
 14642     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14643     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14644     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14645     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14646     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14647     MOVE PB-SV-STATE            TO CP-STATE.
 14648     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14649     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14650     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14651*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14652     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14653     MOVE '3'                    TO CP-PROCESS-TYPE.
 14654     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14655     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14656                                    CP-RATING-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 266
* EL050.cbl
 14657     IF PB-COMPANY-ID = 'CID'
 14658               OR
 14659        CP-STATE-STD-ABBRV = 'OR'
 14660         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14661                                         PB-I-AH-TERM.
 14662     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14663        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14664           AND (PB-I-POLICY-IS-MONTHLY)
 14665           MOVE PB-I-LF-BENEFIT-AMT
 14666                                 TO CP-NET-BENEFIT-AMT
 14667           move pb-i-ah-premium-amt to cp-original-premium
 14668           add pb-i-lf-premium-amt to cp-original-premium
 14669        END-IF
 14670     END-IF
 14671     MOVE SPACES                 TO CP-BEN-CATEGORY
 14672     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14673        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14674        EVALUATE TRUE
 14675           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14676              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14677              MOVE PB-I-LF-BENEFIT-AMT
 14678                                 TO CP-RATING-BENEFIT-AMT
 14679              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14680           WHEN WS-AH-BEN-CATEGORY = 'G'
 14681              MOVE PB-I-UNPAID-CASH-PRICE
 14682                                 TO CP-RATING-BENEFIT-AMT
 14683           WHEN WS-AH-BEN-CATEGORY = 'D'
 14684              MOVE WS-AH-PMF-COMM
 14685                                 TO CP-DCC-PMF-COMM
 14686              MOVE PB-I-AH-COMMISSION
 14687                                 TO CP-DCC-ACT-COMM
 14688        END-EVALUATE
 14689     END-IF
 14690     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14691     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14692     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14693     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14694     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14695     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14696     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14697                                    CP-REMAINING-TERM
 14698                                    WS-WORK-TERM.
 14699     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14700
 14701     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14702     SET BIN-TO-GREG             TO TRUE.
 14703*    MOVE ' '                    TO DC-OPTION-CODE.
 14704     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14705     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE
 14706
 14707     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14708     IF NOT VALID-SKIP-CODE
 14709         MOVE ER-2683            TO WS-ERROR
 14710         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14711         GO TO 3320-RATE-CONTINUE.
 14712
 14713     IF PB-NO-MONTHS-SKIPPED
 14714         GO TO 3320-RATE-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 267
* EL050.cbl
 14715
 14716     MOVE SPACE TO NUMBER-OF-MONTHS.
 14717
 14718     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14719         MOVE 'S'                TO SK-MO (6).
 14720     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14721         MOVE 'S'                TO SK-MO (7).
 14722     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14723         MOVE 'S'                TO SK-MO (8).
 14724     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14725         MOVE 'S'                TO SK-MO (9).
 14726     IF PB-I-SKIP-CODE = 'A'
 14727         MOVE 'S'                TO SK-MO (10).
 14728
 14729     MOVE 1                      TO SUB2.
 14730     MOVE PB-I-AH-TERM           TO SUB3.
 14731     MOVE WS-MONTH               TO SUB1.
 14732     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14733     GO TO 3320-RATE-CONTINUE.
 14734
 14735 3310-GET-SKIP-MO.
 14736     IF SUB1 = 13
 14737         MOVE 1                  TO SUB1.
 14738
 14739     IF SK-MO (SUB1) = 'S'
 14740         SUBTRACT 1 FROM WS-WORK-TERM.
 14741
 14742     ADD 1 TO SUB2
 14743              SUB1.
 14744
 14745 3320-RATE-CONTINUE.
 14746
 14747     IF WS-WORK-TERM = ZERO
 14748         MOVE 1                  TO WS-WORK-TERM.
 14749
 14750     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14751                                    CP-LOAN-TERM.
 14752
 14753     IF PB-COMPANY-ID EQUAL 'DMD'
 14754         NEXT SENTENCE
 14755     ELSE
 14756         MOVE ZERO               TO PB-I-AH-RATE
 14757                                    PB-I-AH-REI-RATE.
 14758
 14759
 14760     IF PB-COMPANY-ID EQUAL 'CRI'
 14761        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14762
 14763     IF PB-COMPANY-ID = 'CSL'
 14764         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14765         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14766         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14767         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14768
 14769     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14770        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14771           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14772              PB-I-RATE-DEV-PCT-LF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 268
* EL050.cbl
 14773        END-IF
 14774        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14775                                 TO CP-ALTERNATE-BENEFIT
 14776        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14777        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14778        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14779     END-IF
 14780*    if ws-clp-state not = spaces
 14781*       move ws-clp-state to cp-state
 14782*    end-if
 14783     IF (PB-COMPANY-ID = 'CID')
 14784        AND (WS-LF-EARNINGS-CALC = 'B')
 14785        AND (CP-STATE-STD-ABBRV = 'MN')
 14786        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14787     ELSE
 14788        MOVE ' '                 TO CP-AH-BALLOON-SW
 14789     END-IF
 14790     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14791     MOVE 'R'                   TO CP-RATE-FILE.
 14792     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14793
 14794     IF (CP-ERROR-RATE-NOT-FOUND)
 14795        and (not pb-monthly-cert)
 14796        IF PB-I-OB
 14797           MOVE ER-2624          TO WS-ERROR
 14798           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14799           GO TO 3340-CALCULATE-PREMIUM-AMT
 14800        ELSE
 14801          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14802              NEXT SENTENCE
 14803          ELSE
 14804           MOVE ER-2642          TO WS-ERROR
 14805           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14806           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14807
 14808     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14809        CP-ERROR-DIV-BY-ZERO
 14810           MOVE ER-3782          TO WS-ERROR
 14811           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14812
 14813     IF PB-COMPANY-ID EQUAL 'CRI'
 14814        IF CP-ERROR-NO-LIMITS-CRI
 14815           IF NOT ACCOUNT-AH-CHECKED
 14816              MOVE ER-2607          TO WS-ERROR
 14817              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14818
 14819     IF ACCOUNT-AH-CHECKED
 14820        NEXT SENTENCE
 14821     ELSE
 14822       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14823          MOVE ER-2640           TO WS-ERROR
 14824          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14825
 14826     IF PB-COMPANY-ID = 'CRI'
 14827         IF WS-ERROR = ER-2640
 14828             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14829     IF ACCOUNT-AH-CHECKED
 14830        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 269
* EL050.cbl
 14831     ELSE
 14832        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14833           AND (CP-R-MAX-ATT-AGE > +0)
 14834           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14835           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14836              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14837              MOVE PB-I-AH-EXPIRE-DT
 14838                                 TO DC-BIN-DATE-2
 14839              MOVE '1'           TO DC-OPTION-CODE
 14840              PERFORM 8500-DATE-CONVERT
 14841                                 THRU 8500-EXIT
 14842              IF NO-CONVERSION-ERROR
 14843                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14844                    MOVE ER-2661       TO WS-ERROR
 14845*                   PERFORM 9900-ERROR-FORMAT
 14846*                                THRU 9900-EXIT
 14847                 END-IF
 14848              END-IF
 14849           ELSE
 14850              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14851              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14852                 MOVE ER-2661    TO WS-ERROR
 14853*                PERFORM 9900-ERROR-FORMAT
 14854*                                THRU 9900-EXIT
 14855              ELSE
 14856                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14857                    MOVE ER-1570 TO WS-ERROR
 14858                    PERFORM 9900-ERROR-FORMAT
 14859                                 THRU 9900-EXIT
 14860                 END-IF
 14861              END-IF
 14862           END-IF
 14863           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14864              MOVE PB-I-JOINT-BIRTHDAY
 14865                                    TO DC-BIN-DATE-1
 14866              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14867              MOVE '1'              TO DC-OPTION-CODE
 14868              PERFORM 8500-DATE-CONVERT
 14869                                    THRU 8500-EXIT
 14870              IF NO-CONVERSION-ERROR
 14871                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14872                    MOVE ER-2661       TO WS-ERROR
 14873*                   PERFORM 9900-ERROR-FORMAT
 14874*                                   THRU 9900-EXIT
 14875                 END-IF
 14876              END-IF
 14877           ELSE
 14878              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14879                (PB-I-AH-TERM / 12)
 14880              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14881                 MOVE ER-2661       TO WS-ERROR
 14882*                PERFORM 9900-ERROR-FORMAT
 14883*                                   THRU 9900-EXIT
 14884              ELSE
 14885                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14886                    MOVE ER-1571 TO WS-ERROR
 14887                    PERFORM 9900-ERROR-FORMAT
 14888                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 270
* EL050.cbl
 14889                 END-IF
 14890              END-IF
 14891           END-IF
 14892           IF WS-ERROR = ER-2661
 14893              PERFORM 9900-ERROR-FORMAT
 14894                                    THRU 9900-EXIT
 14895           END-IF
 14896        END-IF
 14897     END-IF
 14898*    IF ACCOUNT-AH-CHECKED
 14899*       NEXT SENTENCE
 14900*    ELSE
 14901*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14902*          MOVE ER-2661          TO WS-ERROR
 14903*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14904
 14905     IF ACCOUNT-AH-CHECKED
 14906        NEXT SENTENCE
 14907     ELSE
 14908        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14909           MOVE ER-2663          TO WS-ERROR
 14910           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14911
 14912     IF ACCOUNT-AH-CHECKED OR
 14913        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14914         PB-POLICY-IS-VOIDED
 14915        NEXT SENTENCE
 14916     ELSE
 14917        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14918           MOVE ER-2667            TO WS-ERROR
 14919           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14920
 14921     IF PB-COMPANY-ID = 'CRI'
 14922         IF WS-ERROR = ER-2667
 14923             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14924
 14925     IF ACCOUNT-AH-CHECKED
 14926        NEXT SENTENCE
 14927     ELSE
 14928        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14929           MOVE ER-2678            TO WS-ERROR
 14930           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14931
 14932     IF CP-ERROR-RATE-FILE-NOTOPEN
 14933         GO TO 3990-FILES-NOT-OPEN.
 14934
 14935 3321-CONTINUE.
 14936     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14937     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14938     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14939*    IF (PB-COMPANY-ID = 'DCC')
 14940        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14941        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14942                                    PB-I-LF-ALT-PREM-CALC
 14943        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14944        IF WS-AH-BEN-CATEGORY = 'G'
 14945           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14946           + PB-I-ADDL-CLP)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 271
* EL050.cbl
 14947           * (1 + WS-TOL-CLP-PCT)
 14948*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14949        ELSE
 14950           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14951           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14952*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14953        END-IF
 14954        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14955                                 TO PB-I-AH-PREM-CALC
 14956        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14957           MOVE ER-8152          TO WS-ERROR
 14958           PERFORM 9900-ERROR-FORMAT
 14959                                 THRU 9900-EXIT
 14960        ELSE
 14961           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14962                 PB-I-ADDL-CLP)
 14963              MOVE ER-8148       TO WS-ERROR
 14964              PERFORM 9900-ERROR-FORMAT
 14965                                 THRU 9900-EXIT
 14966           END-IF
 14967        END-IF
 14968     END-IF
 14969     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14970        AND (PB-I-POLICY-IS-MONTHLY)
 14971        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14972        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14973        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14974           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14975        END-IF
 14976     END-IF
 14977     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14978        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14979        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14980        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14981        MOVE ER-2786             TO WS-ERROR
 14982        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14983     END-IF
 14984     MOVE +0                     TO PB-I-AH-CLP
 14985     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14986        evaluate true
 14987           when WS-AH-BEN-CATEGORY = 'D'
 14988              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14989                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14990           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14991              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14992           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14993              compute ws-cred-union-fees rounded =
 14994                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14995                    pb-i-ah-commission)
 14996              COMPUTE PB-I-AH-CLP =
 14997                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14998        end-evaluate
 14999     END-IF
 15000     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 15001
 15002     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 15003         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 15004
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 272
* EL050.cbl
 15005     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 15006         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 15007
 15008     if (ws-ah-special-calc-cd = 'E')
 15009        and (pb-monthly-cert)
 15010        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 15011     end-if
 15012     IF PB-COMPANY-ID = 'CRI'
 15013         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 15014            PB-I-PAYMENT-AMOUNT = ZERO
 15015             NEXT SENTENCE
 15016         ELSE
 15017             COMPUTE PB-I-AH-PREM-CALC =
 15018                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 15019                 (CP-PREMIUM-RATE / 100)
 15020             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 15021                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 15022                                             PB-I-RATE-DEV-PCT-AH.
 15023
 15024     IF (PB-I-AH-RATE  = ZERO)
 15025        and (not pb-monthly-cert)
 15026       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 15027           NEXT SENTENCE
 15028       ELSE
 15029         MOVE ER-2642            TO WS-ERROR
 15030         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15031
 15032     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 15033     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 15034     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 15035     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 15036     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 15037     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 15038
 15039     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15040        AND (WS-AH-BEN-CATEGORY = 'G')
 15041        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15042        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 15043        IF CP-DEVIATION-CODE NOT = '000'
 15044           MOVE '000'            TO CP-DEVIATION-CODE
 15045           PERFORM 7000-GET-RATE THRU 7000-EXIT
 15046           IF NO-CP-ERROR
 15047              COMPUTE PB-I-DDF-IU-RATE-UP =
 15048              PB-I-AH-CLP - CP-CALC-PREMIUM
 15049           ELSE
 15050              MOVE ER-3057        TO WS-ERROR
 15051              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15052           END-IF
 15053        END-IF
 15054     END-IF
 15055     .
 15056 3335-EDIT-AH-REIN-NSP-RATE.
 15057     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15058        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 15059              compute ws-cred-union-fees rounded =
 15060                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 15061                    pb-i-ah-commission)
 15062              COMPUTE PB-I-AH-CLP =
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 273
* EL050.cbl
 15063                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 15064        end-if
 15065     END-IF
 15066     IF AH-REIN-NSP-NOT-USED
 15067         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15068
 15069     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 15070     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15071         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15072     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 15073     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 15074     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 15075     MOVE PB-SV-STATE            TO CP-STATE.
 15076     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15077     MOVE ZERO                   TO CP-DEVIATION-CODE
 15078                                    CP-RATE-DEV-PCT.
 15079*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 15080     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15081     MOVE '3'                    TO CP-PROCESS-TYPE.
 15082     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 15083     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15084                                    CP-RATING-BENEFIT-AMT.
 15085     IF CP-STATE-STD-ABBRV = 'OR'
 15086         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 15087                                         PB-I-AH-TERM.
 15088     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 15089     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15090     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15091     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15092     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15093     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 15094                                    CP-REMAINING-TERM
 15095                                    WS-WORK-TERM.
 15096     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 15097     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15098        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15099     END-IF
 15100     IF  PB-COMPANY-ID = 'TIC'
 15101         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 15102            MOVE ZERO TO CP-CLASS-CODE.
 15103
 15104     IF PB-COMPANY-ID NOT = 'TIC'
 15105          MOVE ZERO          TO CP-CLASS-CODE.
 15106
 15107     MOVE ZERO               TO CP-DEVIATION-CODE.
 15108
 15109     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 15110
 15111     MOVE ZERO               TO PB-I-AH-REI-RATE.
 15112
 15113     MOVE 'R'                   TO CP-RATE-FILE.
 15114     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 15115
 15116     IF CP-ERROR-RATE-NOT-FOUND
 15117         MOVE ER-2645        TO WS-ERROR
 15118         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15119         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15120
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 274
* EL050.cbl
 15121     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 15122
 15123     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 15124     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 15125
 15126     IF PB-I-AH-REI-RATE = ZERO
 15127         MOVE ER-2645        TO WS-ERROR
 15128         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15129
 15130
 15131 3340-CALCULATE-PREMIUM-AMT.
 15132     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15133     SET BIN-TO-GREG             TO TRUE
 15134     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 15135     move dc-greg-date-a-edit    to ws-greg-eff-date
 15136
 15137     IF PB-COMPANY-ID = 'NCL'
 15138         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15139             WS-AH-SPECIAL-CALC-CD = 'O')
 15140             GO TO 3999-END-EDIT.
 15141
 15142     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15143                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15144                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 15145                         OR 'AHL'
 15146         NEXT SENTENCE
 15147     ELSE
 15148         IF WS-STATE-ABBREVIATION = 'CT'
 15149             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15150                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 15151                 COMPUTE PB-I-LF-PREM-CALC =
 15152                                     PB-I-LF-PREM-CALC * .90
 15153                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15154                                     PB-I-LF-ALT-PREM-CALC * .90
 15155                 COMPUTE PB-I-AH-PREM-CALC =
 15156                                     PB-I-AH-PREM-CALC * .90.
 15157
 15158     IF PB-COMP-LF-PREM
 15159        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15160        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15161
 15162     IF PB-COMP-AH-PREM
 15163        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15164
 15165 3340-CHECK-DCC-TOT-FEES.
 15166     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15167        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15168        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15169        AND (PB-I-POLICY-IS-MONTHLY)
 15170        CONTINUE
 15171     ELSE
 15172        GO TO 3340-EDIT-LF-AH-TOL
 15173     END-IF
 15174     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15175     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15176     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15177        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15178           PB-I-RATE-DEV-PCT-LF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 275
* EL050.cbl
 15179     END-IF
 15180     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15181        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15182           PB-I-RATE-DEV-PCT-AH
 15183     END-IF
 15184     MOVE 'N'                    TO CP-BEN-CATEGORY
 15185     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15186
 15187     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15188     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 15189     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15190     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15191     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15192     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15193     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15194     MOVE '3'                    TO CP-PROCESS-TYPE.
 15195     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15196     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15197
 15198     MOVE PB-SV-STATE            TO CP-STATE.
 15199     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15200     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15201     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15202     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 15203     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15204                                    CP-RATING-BENEFIT-AMT.
 15205     IF CP-STATE-STD-ABBRV = 'OR'
 15206         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15207                                         PB-I-LF-ALT-BENEFIT-AMT.
 15208     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 15209     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15210     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15211     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15212     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15213     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15214     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15215     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15216     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15217                                    CP-REMAINING-TERM
 15218                                    CP-LOAN-TERM.
 15219     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15220        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15221           PB-I-LF-PREMIUM-AMT
 15222     end-if
 15223
 15224     IF CP-TRUNCATED-LIFE
 15225        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15226
 15227     IF CP-TERM-IS-DAYS
 15228         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15229     ELSE
 15230         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15231
 15232     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15233     IF CP-SPECIAL-CALC-CD = 'H'
 15234         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15235                                    TO CP-ALTERNATE-BENEFIT
 15236         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 276
* EL050.cbl
 15237     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15238     MOVE 'R'                    TO CP-RATE-FILE
 15239     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15240     IF NOT CP-ERROR-RATE-NOT-FOUND
 15241        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15242        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15243           AND (CP-BENEFIT-CD (1:1) = 'S')
 15244           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15245                                    PB-I-LF-PREMIUM-AMT
 15246        END-IF
 15247     ELSE
 15248        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15249     END-IF
 15250     .
 15251 3340-EDIT-LF-AH-TOL.
 15252
 15253***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15254***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15255***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15256***
 15257     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15258         PB-I-AH-PREMIUM-AMT
 15259          GIVING WS-CALC-WORK.
 15260
 15261     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15262        AND WS-CALC-WORK NOT = ZERO
 15263         MOVE ER-2649            TO WS-ERROR
 15264         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15265
 15266     SUBTRACT PB-I-LF-PREM-CALC
 15267             FROM PB-I-LF-PREMIUM-AMT
 15268                 GIVING WS-UNSIGN-WRK1.
 15269
 15270     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15271             FROM PB-I-LF-ALT-PREMIUM-AMT
 15272                 GIVING WS-UNSIGN-WRK4.
 15273
 15274     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15275                                + WS-UNSIGN-WRK4.
 15276
 15277     SUBTRACT PB-I-AH-PREM-CALC
 15278             FROM PB-I-AH-PREMIUM-AMT
 15279                 GIVING WS-UNSIGN-WRK2.
 15280
 15281******************************************************************
 15282*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15283******************************************************************
 15284
 15285     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15286         MOVE ZERO TO WS-UNSIGN-WRK1.
 15287
 15288     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15289         MOVE ZERO TO WS-UNSIGN-WRK2.
 15290
 15291     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15292             GIVING WS-UNSIGN-WRK3.
 15293
 15294 3342-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 277
* EL050.cbl
 15295
 15296     IF (PB-I-LF-RATE = ZERO  AND
 15297         PB-I-AH-RATE = ZERO)
 15298         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15299            WS-AH-SPECIAL-CALC-CD = 'O'
 15300              NEXT SENTENCE
 15301         ELSE
 15302             GO TO 3345-EDIT-CONTINUE.
 15303
 15304     IF  PB-RECORD-BILL   =  'B' OR  'L'
 15305         NEXT SENTENCE
 15306     ELSE
 15307     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15308        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 15309           IF (PB-REISSUED-CERT         OR
 15310               PB-POLICY-IS-DECLINED    OR
 15311               PB-POLICY-IS-VOIDED)
 15312              NEXT SENTENCE
 15313           ELSE
 15314              IF WS-PREM-REJECT-SW = SPACE
 15315                 MOVE ER-2652    TO WS-ERROR
 15316                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15317                 GO TO 3344-CHECK-AH
 15318              ELSE
 15319                 MOVE ER-2650    TO WS-ERROR
 15320                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15321                 GO TO 3344-CHECK-AH.
 15322
 15323***
 15324***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 15325***
 15326
 15327     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15328         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15329            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15330             (1 + WS-TOL-LF-PREM-PCT)
 15331         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15332            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15333             (1 - WS-TOL-LF-PREM-PCT)
 15334     ELSE
 15335         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15336         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15337
 15338***
 15339***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15340***
 15341
 15342     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15343         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15344          WS-TOL-LF-PREM.
 15345
 15346     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15347         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15348          WS-TOL-LF-PREM.
 15349
 15350     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15351        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15352
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 278
* EL050.cbl
 15353     IF PB-REISSUED-CERT
 15354        or PB-POLICY-IS-DECLINED
 15355        or PB-POLICY-IS-VOIDED
 15356        continue
 15357     ELSE
 15358        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15359              > WS-TOL-LF-HIGH-PREM-AMT)
 15360           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15361              < WS-TOL-LF-LOW-PREM-AMT))
 15362                      or
 15363           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15364              > WS-TOL-LF-HIGH-PREM-PCT)
 15365           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15366              < WS-TOL-LF-LOW-PREM-PCT))
 15367           IF WS-PREM-REJECT-SW = SPACE
 15368              MOVE ER-2652       TO WS-ERROR
 15369              PERFORM 9900-ERROR-FORMAT
 15370                                 THRU 9900-EXIT
 15371           ELSE
 15372              MOVE ER-2650       TO WS-ERROR
 15373              PERFORM 9900-ERROR-FORMAT
 15374                                 THRU 9900-EXIT
 15375           end-if
 15376        end-if
 15377     end-if
 15378
 15379*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15380*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15381*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15382*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15383
 15384     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15385        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15386                      OR
 15387           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15388           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15389           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15390           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15391        END-IF
 15392     END-IF
 15393
 15394     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15395        IF WS-COMP-MAX-CAP GREATER THAN +0
 15396           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15397              IF (PB-REISSUED-CERT         OR
 15398                  PB-POLICY-IS-DECLINED    OR
 15399                  PB-POLICY-IS-VOIDED)
 15400                 NEXT SENTENCE
 15401              ELSE
 15402                  MOVE ER-2646   TO  WS-ERROR
 15403                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15404
 15405 3344-CVL-TOLERANCE-CHECK.
 15406
 15407      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15408          GO TO 3344-CHECK-AH.
 15409
 15410      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 279
* EL050.cbl
 15411          GO TO 3344-CHECK-AH.
 15412
 15413      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15414                                     WS-UNSIGN-WRK6.
 15415
 15416      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15417          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15418                                 + PB-I-LF-PREMIUM-AMT
 15419                                 - PB-I-LF-PREM-CALC.
 15420
 15421      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15422          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15423                                 + PB-I-LF-ALT-PREMIUM-AMT
 15424                                 - PB-I-LF-ALT-PREM-CALC.
 15425
 15426      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15427          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15428              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15429                 MOVE ER-2652    TO  WS-ERROR
 15430                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15431              ELSE
 15432                 MOVE ER-2650    TO  WS-ERROR
 15433                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15434
 15435      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15436          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 15437              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15438                 MOVE ER-2652    TO  WS-ERROR
 15439                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15440              ELSE
 15441                 MOVE ER-2650    TO  WS-ERROR
 15442                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15443
 15444 3344-CHECK-AH.
 15445
 15446****************************************************************
 15447***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15448***
 15449
 15450     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15451         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15452             (1 + WS-TOL-AH-PREM-PCT)
 15453         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15454             (1 - WS-TOL-AH-PREM-PCT)
 15455     ELSE
 15456         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15457         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15458
 15459***
 15460***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15461***
 15462
 15463     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15464         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15465
 15466     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15467         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15468
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 280
* EL050.cbl
 15469     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15470        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15471
 15472     IF (PB-REISSUED-CERT)
 15473        OR (PB-POLICY-IS-DECLINED)
 15474        OR (PB-POLICY-IS-VOIDED)
 15475        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15476        CONTINUE
 15477     ELSE
 15478        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15479              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15480                          or
 15481           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15482              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15483           IF WS-PREM-REJECT-SW = SPACE
 15484              MOVE ER-3052       TO WS-ERROR
 15485              PERFORM 9900-ERROR-FORMAT
 15486                                 THRU 9900-EXIT
 15487           ELSE
 15488              MOVE ER-3050       TO WS-ERROR
 15489              PERFORM 9900-ERROR-FORMAT
 15490                                 THRU 9900-EXIT
 15491           END-IF
 15492        END-IF
 15493     END-IF
 15494     if (pb-company-id = 'DCC' or 'VPP')
 15495        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15496        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15497        and (pb-i-policy-is-monthly)
 15498        compute ws-tol-ah-high-prem-amt =
 15499           pb-i-tot-fees-calc + ws-tol-ah-prem
 15500        compute ws-tol-ah-low-prem-amt =
 15501           pb-i-tot-fees-calc - ws-tol-ah-prem
 15502        if ws-tol-ah-prem-pct > zeros
 15503           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15504              (1 + ws-tol-ah-prem-pct)
 15505           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15506              (1 - ws-tol-ah-prem-pct)
 15507        else
 15508           move +9999999.99      to ws-tol-ah-high-prem-pct
 15509           move +0               to ws-tol-ah-low-prem-pct
 15510        end-if
 15511        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15512            or
 15513           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15514                          or
 15515           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15516           or
 15517           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15518            move er-3049         to ws-error
 15519           perform 9900-error-format
 15520                                 thru 9900-exit
 15521
 15522        end-if
 15523     end-if
 15524     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15525         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15526             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 281
* EL050.cbl
 15527             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15528
 15529     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15530        IF WS-COMP-MAX-CAP GREATER THAN +0
 15531           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15532              IF (PB-REISSUED-CERT         OR
 15533                  PB-POLICY-IS-DECLINED    OR
 15534                  PB-POLICY-IS-VOIDED)
 15535                 NEXT SENTENCE
 15536              ELSE
 15537                  MOVE ER-2646   TO  WS-ERROR
 15538                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15539
 15540     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15541        (WS-COMP-MAX-CAP EQUAL +0)
 15542           GO TO 3345-EDIT-CONTINUE.
 15543
 15544     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15545        GREATER THAN WS-COMP-MAX-CAP
 15546           MOVE ER-2646          TO  WS-ERROR
 15547           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15548
 15549 3345-EDIT-CONTINUE.
 15550
 15551*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15552*       IF PB-ENTRY-BATCH   NUMERIC
 15553*          IF PB-ISSUE
 15554*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15555*          ELSE
 15556*              IF PB-CANCELLATION
 15557*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15558
 15559*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15560*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15561*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15562*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15563*        ELSE
 15564*            MOVE  ER-1909            TO  WS-ERROR
 15565*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15566
 15567     IF PB-I-POLICY-ACCEPTED
 15568        IF PB-POLICY-IS-DECLINED  OR
 15569           PB-REISSUED-CERT  OR
 15570           PB-REIN-ONLY-CERT  OR
 15571           PB-POLICY-IS-VOIDED
 15572            MOVE  ER-1891         TO  WS-ERROR
 15573            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15574        ELSE
 15575            MOVE SPACE            TO  PB-BATCH-ENTRY
 15576            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15577
 15578     IF PB-I-POLICY-DECLINED
 15579        IF PB-REISSUED-CERT  OR
 15580           PB-REIN-ONLY-CERT  OR
 15581           PB-POLICY-IS-VOIDED
 15582            MOVE  ER-1906         TO  WS-ERROR
 15583            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15584        ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 282
* EL050.cbl
 15585            MOVE  'D'             TO  PB-BATCH-ENTRY
 15586                                      PB-I-ENTRY-STATUS.
 15587
 15588     IF PB-I-NEEDS-UNDERWRITING
 15589        IF PB-POLICY-IS-DECLINED OR
 15590           PB-REISSUED-CERT  OR
 15591           PB-REIN-ONLY-CERT  OR
 15592           PB-POLICY-IS-VOIDED
 15593            MOVE  ER-1907         TO  WS-ERROR
 15594            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15595        ELSE
 15596            MOVE 'U'              TO  PB-BATCH-ENTRY
 15597                                      PB-I-ENTRY-STATUS.
 15598
 15599     IF PB-NEEDS-UNDERWRITING
 15600        MOVE  ER-1901             TO  WS-ERROR
 15601        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15602     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15603        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15604        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15605        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15606           AND (NOT WS-LF-CASH))
 15607                           OR
 15608           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15609           AND (NOT WS-AH-CASH)))
 15610                       AND
 15611           (PB-I-ENTRY-STATUS NOT = '5')
 15612           MOVE 'M'              TO PB-BATCH-ENTRY
 15613                                    PB-I-ENTRY-STATUS
 15614        END-IF
 15615     END-IF
 15616     move pending-business       to ws-passed-erpndb
 15617     move ' '                    to ws-exceed-limit-yn
 15618     perform 7780-call-agg       thru 7780-exit
 15619*    display ' el050 exceed ' ws-exceed-limit-yn
 15620     if ws-exceed-limit-yn = 'Y'
 15621        MOVE  ER-9813            TO WS-ERROR
 15622        move 'Y'                 to ws-9813-sw
 15623        PERFORM  9900-ERROR-FORMAT
 15624                                 THRU 9900-EXIT
 15625     end-if
 15626     if (PB-EXCEEDED-LIMIT-FORCED)
 15627        and (ws-9813-sw = 'Y')
 15628        subtract +1 from PB-NO-OF-ERRORS
 15629        move er-9823             to ws-error
 15630        PERFORM  9900-ERROR-FORMAT
 15631                                 THRU 9900-EXIT
 15632     end-if
 15633     IF  PB-COMPANY-ID NOT = 'NCL'
 15634         GO TO 3999-END-EDIT.
 15635
 15636     IF PB-REISSUED-CERT  OR
 15637        PB-POLICY-IS-DECLINED  OR
 15638        PB-POLICY-IS-VOIDED  OR
 15639        PB-I-OB
 15640         GO TO 3999-END-EDIT.
 15641
 15642     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 283
* EL050.cbl
 15643         MOVE  ER-2644            TO  WS-ERROR
 15644         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15645         GO TO 3999-END-EDIT.
 15646
 15647     MOVE 'N'                     TO  FORM-MASTER-SW.
 15648     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15649
 15650     IF NOT FORM-MASTER-FOUND
 15651         GO TO 3999-END-EDIT.
 15652
 15653     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15654                                      FORM-MASTER-AH-SW.
 15655
 15656     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15657         MOVE  +1                 TO SUB6
 15658         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15659
 15660     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15661         MOVE  +1                 TO SUB6
 15662         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15663
 15664     IF LF-FORM-MASTER-FOUND  OR
 15665        AH-FORM-MASTER-FOUND
 15666         GO TO 3360-CHECK-FORM-LIMITS
 15667     ELSE
 15668         GO TO 3999-END-EDIT.
 15669
 15670******************************************************************
 15671*                  3350-GET-ERFORM                               *
 15672*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15673*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15674******************************************************************
 15675
 15676 3350-GET-ERFORM.
 15677
 15678     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15679         GO TO  3350-ERFORM-GETMAIN.
 15680
 15681     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15682     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15683     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15684     MOVE 'Y'                     TO FORM-MASTER-SW.
 15685
 15686     IF PB-CANCELLATION
 15687         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15688            PB-SV-STATE          EQUAL   FO-STATE       AND
 15689            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15690              GO TO 3350-EXIT
 15691         ELSE
 15692             NEXT SENTENCE
 15693     ELSE
 15694         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15695            PB-SV-STATE          EQUAL   FO-STATE       AND
 15696            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15697              GO TO 3350-EXIT.
 15698
 15699 3350-ERFORM-GETMAIN.
 15700
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 284
* EL050.cbl
 15701     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15702     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15703
 15704 3350-ERFORM-READ.
 15705
 15706     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15707     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15708     IF PB-CANCELLATION
 15709         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15710     ELSE
 15711         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15712     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15713
 15714     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15715
 15716     IF FORM-MASTER-FOUND
 15717       IF PB-CANCELLATION
 15718          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15719             PB-SV-STATE          EQUAL   FO-STATE       AND
 15720             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15721              GO  TO 3350-EXIT
 15722          ELSE
 15723              NEXT SENTENCE
 15724       ELSE
 15725          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15726             PB-SV-STATE          EQUAL   FO-STATE       AND
 15727             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15728              GO  TO 3350-EXIT.
 15729
 15730     MOVE  'N'                    TO  FORM-MASTER-SW.
 15731     MOVE  ER-1895                TO  WS-ERROR.
 15732     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15733
 15734 3350-EXIT.
 15735      EXIT.
 15736
 15737******************************************************************
 15738*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15739*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15740*   VALID FOR THE POLICY FORM USED.                              *
 15741******************************************************************
 15742
 15743 3355-EDIT-FORM-LF-BENEFITS.
 15744
 15745     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15746        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15747         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15748         GO TO   3355-EXIT.
 15749
 15750     IF  SUB6    LESS THAN   +40
 15751         ADD  +1      TO  SUB6
 15752         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15753
 15754     MOVE  ER-1896         TO  WS-ERROR.
 15755     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15756
 15757 3355-EXIT.
 15758      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 285
* EL050.cbl
 15759
 15760******************************************************************
 15761*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15762*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15763*   VALID FOR THE POLICY FORM USED.                              *
 15764******************************************************************
 15765
 15766 3356-EDIT-FORM-AH-BENEFITS.
 15767
 15768     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15769        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15770         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15771         GO TO  3356-EXIT.
 15772
 15773      IF  SUB6    LESS THAN     +40
 15774          ADD  +1      TO  SUB6
 15775          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15776
 15777     MOVE  ER-1897         TO  WS-ERROR.
 15778     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15779
 15780 3356-EXIT.
 15781      EXIT.
 15782
 15783******************************************************************
 15784*                  3357-BENEFIT-SEARCH                           *
 15785*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15786*   CANCELLATIONS ONLY.                                          *
 15787******************************************************************
 15788 3357-BENEFIT-SEARCH.
 15789     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15790         MOVE +1                          TO SUB6
 15791         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15792
 15793     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15794         MOVE +1                          TO SUB6
 15795         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15796
 15797 3357-EXIT.
 15798     EXIT.
 15799
 15800******************************************************************
 15801*                  3358-BENEFIT-LIFE-SEARCH                      *
 15802*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15803*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15804*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15805******************************************************************
 15806 3358-BENEFIT-LIFE-SEARCH.
 15807     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15808       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15809         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15810           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15811              IF FO-PLAN-REFUND-METHOD (SUB6)
 15812                     IS GREATER THAN SPACES
 15813                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15814                                          WS-LF-REFUND-CALC
 15815                 GO TO 3358-EXIT.
 15816
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 286
* EL050.cbl
 15817     IF SUB6 LESS THAN +40
 15818         ADD +1                 TO SUB6
 15819         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15820
 15821 3358-EXIT.
 15822     EXIT.
 15823******************************************************************
 15824*                  3359-BENEFIT-AH-SEARCH                        *
 15825*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15826*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15827*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15828******************************************************************
 15829 3359-BENEFIT-AH-SEARCH.
 15830     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15831       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15832         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15833           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15834              IF FO-PLAN-REFUND-METHOD (SUB6)
 15835                      IS GREATER THAN SPACES
 15836                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15837                                          WS-AH-REFUND-CALC
 15838                 GO TO 3359-EXIT.
 15839
 15840     IF SUB6 LESS THAN +40
 15841         ADD +1                 TO SUB6
 15842         GO TO 3359-BENEFIT-AH-SEARCH.
 15843
 15844 3359-EXIT.
 15845     EXIT.
 15846
 15847******************************************************************
 15848*                  3360-CHECK-FORM-LIMITS                        *
 15849*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15850*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15851******************************************************************
 15852
 15853 3360-CHECK-FORM-LIMITS.
 15854
 15855     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15856         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15857
 15858     IF NOT LF-FORM-MASTER-FOUND
 15859         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15860
 15861 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15862
 15863     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15864       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15865        WS-LF-JOINT-INDICATOR = 'J'  AND
 15866        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15867         IF PB-COMPANY-ID = 'NCL'
 15868            MOVE  ER-1911          TO  WS-ERROR
 15869            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15870         ELSE
 15871            MOVE  ER-1892          TO  WS-ERROR
 15872            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15873
 15874 3360-CHECK-FORM-LF-ATT-AGE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 287
* EL050.cbl
 15875
 15876     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15877
 15878     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15879         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15880         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15881            IF PB-COMPANY-ID = 'NCL'
 15882                MOVE  ER-1913      TO  WS-ERROR
 15883                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15884            ELSE
 15885                MOVE  ER-1894      TO  WS-ERROR
 15886                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15887
 15888 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15889
 15890     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15891         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15892         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15893            IF PB-COMPANY-ID = 'NCL'
 15894                MOVE  ER-1914      TO  WS-ERROR
 15895                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15896            ELSE
 15897                MOVE  ER-1899      TO  WS-ERROR
 15898                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15899
 15900 3360-CHECK-FORM-LF-TERM-BAMT.
 15901
 15902     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15903         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15904         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15905           IF  PB-COMPANY-ID = 'NCL'
 15906               MOVE  ER-1916       TO  WS-ERROR
 15907               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15908           ELSE
 15909               MOVE  ER-1902       TO  WS-ERROR
 15910               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15911
 15912     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15913                                    PB-I-LF-ALT-BENEFIT-AMT.
 15914
 15915     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15916         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15917         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15918             IF  PB-COMPANY-ID = 'NCL'
 15919                 MOVE  ER-1918     TO  WS-ERROR
 15920                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15921             ELSE
 15922                 MOVE  ER-1904     TO  WS-ERROR
 15923                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15924
 15925******************************************************************
 15926*                  3360-CHECK-FORM-AH-LIMITS                     *
 15927*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15928*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15929******************************************************************
 15930
 15931 3360-CHECK-FORM-AH-LIMITS.
 15932
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 288
* EL050.cbl
 15933     IF NOT AH-FORM-MASTER-FOUND
 15934         GO TO 3999-END-EDIT.
 15935
 15936 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15937
 15938     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15939       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15940        WS-AH-JOINT-INDICATOR = 'J'  AND
 15941        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15942         IF PB-COMPANY-ID = 'NCL'
 15943            MOVE  ER-1912          TO  WS-ERROR
 15944            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15945         ELSE
 15946            MOVE  ER-1893          TO  WS-ERROR
 15947            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15948
 15949 3360-CHECK-FORM-AH-ATT-AGE.
 15950
 15951     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15952
 15953     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15954         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15955         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15956            IF PB-COMPANY-ID = 'NCL'
 15957                MOVE  ER-1913      TO  WS-ERROR
 15958                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15959            ELSE
 15960                MOVE  ER-1894      TO  WS-ERROR
 15961                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15962
 15963 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15964
 15965     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15966         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15967         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15968            IF PB-COMPANY-ID = 'NCL'
 15969                MOVE  ER-1915      TO  WS-ERROR
 15970                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15971            ELSE
 15972                MOVE  ER-1900      TO  WS-ERROR
 15973                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15974
 15975 3360-CHECK-FORM-AH-TERM-BAMT.
 15976
 15977     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15978         FO-AH-MAX-TERM    GREATER THAN  +0
 15979         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15980             IF  PB-COMPANY-ID = 'NCL'
 15981                 MOVE  ER-1917     TO  WS-ERROR
 15982                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15983             ELSE
 15984                  MOVE  ER-1903    TO  WS-ERROR
 15985                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15986
 15987     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15988         FO-MAX-AH-AMT    GREATER THAN  +0
 15989         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15990             IF  PB-COMPANY-ID = 'NCL'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 289
* EL050.cbl
 15991                 MOVE  ER-1919     TO  WS-ERROR
 15992                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15993             ELSE
 15994                 MOVE  ER-1905     TO  WS-ERROR
 15995                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15996
 15997     GO TO 3999-END-EDIT.
 15998
 15999******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 290
* EL050.cbl
 16001 3400-edit-vin.
 16002
 16003     move spaces                 to hldi-pass-area
 16004     MOVE PB-I-VIN               TO WS-WORK-VIN
 16005     MOVE +8                     TO V2
 16006     MOVE ZEROS                  TO WS-VIN-TOTAL
 16007     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16008      (V1 > 17)
 16009        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 16010           MOVE ER-3825          TO WS-ERROR
 16011           PERFORM 9900-ERROR-FORMAT
 16012                                 THRU 9900-EXIT
 16013        ELSE
 16014           IF V1 = 8
 16015              MOVE 10            TO V2
 16016           END-IF
 16017           IF V1 = 9
 16018              MOVE 0             TO V2
 16019           END-IF
 16020           IF V1 = 10
 16021              MOVE 9             TO V2
 16022           END-IF
 16023           IF WS-WORK-VIN (V1:1) NUMERIC
 16024              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 16025               + (WS-WORK-VIN-N (V1) * V2)
 16026           ELSE
 16027              MOVE WS-WORK-VIN (V1:1)
 16028                            TO WS-HEX-BYTE
 16029              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 16030              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 16031               + (WS-NUM (V3) * V2)
 16032           END-IF
 16033           COMPUTE V2 = V2 - 1
 16034        END-IF
 16035     END-PERFORM
 16036     MOVE ZEROS                  TO WS-VIN-REMAINDER
 16037     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 16038        REMAINDER WS-VIN-REMAINDER
 16039     IF ((WS-WORK-VIN (9:1) = 'X')
 16040        AND (WS-VIN-REMAINDER = 10))
 16041                OR
 16042        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 16043        if pb-company-id = 'VPP'
 16044           perform 3410-check-with-hldi
 16045                                 thru 3410-exit
 16046        end-if
 16047     ELSE
 16048        IF WS-WORK-VIN (1:1) > 0 AND < 6
 16049           MOVE ER-3826          TO WS-ERROR
 16050           PERFORM 9900-ERROR-FORMAT
 16051                                 THRU 9900-EXIT
 16052        ELSE
 16053           MOVE ER-3827          TO WS-ERROR
 16054           PERFORM 9900-ERROR-FORMAT
 16055                                 THRU 9900-EXIT
 16056        END-IF
 16057     END-IF
 16058
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 291
* EL050.cbl
 16059     .
 16060 3400-exit.
 16061     exit.
 16062 3410-check-with-hldi.
 16063     move spaces                 to hldi-pass-area
 16064     move pb-i-vin               to pa-vin
 16065     perform 7785-call-hldi      thru 7785-exit
 16066*    display 'PA-VIN        ' PA-VIN
 16067*    display 'PA-ErrorCode  ' PA-ErrorCode
 16068*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 16069*    display 'PA-ModelYear  ' PA-ModelYear
 16070*    display 'PA-MakeName   ' PA-MakeName
 16071*    display 'PA-ModelName  ' PA-ModelName
 16072*    display 'PA-SeriesName ' PA-SeriesName
 16073     if pa-errorcode (1:1) not = '0'
 16074        move spaces              to hldi-pass-area
 16075        move pb-i-vin            to pa-vin
 16076*       move pa-errordesc        to pa-seriesname
 16077*       perform 7786-call-hldim  thru 7786-exit
 16078*       display 'PA-VIN        ' PA-VIN
 16079*       display 'PA-ErrorCode  ' PA-ErrorCode
 16080*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 16081*       display 'PA-ModelYear  ' PA-ModelYear
 16082*       display 'PA-MakeName   ' PA-MakeName
 16083*       display 'PA-ModelName  ' PA-ModelName
 16084*       display 'PA-SeriesName ' PA-SeriesName
 16085     end-if
 16086     .
 16087 3410-exit.
 16088     exit.
 16089******************************************************************
 16090*                  E D I T   C A N C E L                         *
 16091******************************************************************
 16092
 16093 3700-EDIT-CANCEL.
 16094     IF PB-COMPANY-ID = 'DMD'
 16095         MOVE ZEROS                   TO WS-RES-STATE-TAX
 16096                                         WS-RES-MUNI-TAX
 16097                                         PB-CI-STATE-TAX
 16098                                         PB-CI-MUNI-TAX
 16099         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 16100
 16101*    IF PB-COMPANY-ID  EQUAL  'NCL'
 16102*       IF PB-ENTRY-BATCH  NUMERIC
 16103*          IF PB-CANCELLATION
 16104*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 16105*          ELSE
 16106*             IF PB-ISSUE
 16107*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 16108
 16109     IF PB-C-INT-ON-REFS NOT NUMERIC
 16110        MOVE ZEROS               TO PB-C-INT-ON-REFS
 16111     END-IF
 16112*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 16113*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 16114
 16115     IF CM-ENTRY-STATUS = 'V'
 16116        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 292
* EL050.cbl
 16117        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16118        GO TO 3999-END-EDIT.
 16119
 16120     IF CM-ENTRY-STATUS = 'D'
 16121        MOVE ER-2781             TO WS-ERROR
 16122        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16123        GO TO 3999-END-EDIT.
 16124
 16125     IF CM-ENTRY-STATUS = 'U'
 16126        MOVE ER-2782             TO WS-ERROR
 16127        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16128
 16129***************************************************************
 16130*                                                             *
 16131*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16132*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16133*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16134*   OF ANOTHER COVERAGE.                                      *
 16135*                                                             *
 16136***************************************************************
 16137
 16138     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16139                                    PB-C-AH-CANCEL-VOID-SW.
 16140
 16141     if pb-company-id = 'DCC' or 'VPP'
 16142        if ((pb-ci-lf-cancel-amt <> zeros)
 16143                       or
 16144            (pb-ci-ah-cancel-amt <> zeros))
 16145           MOVE ER-3068          TO WS-ERROR
 16146           PERFORM 9900-ERROR-FORMAT
 16147                                 THRU 9900-EXIT
 16148           GO TO 3999-END-EDIT
 16149        end-if
 16150     end-if
 16151     IF PB-C-LF-CANCEL-AMT = ZERO
 16152        NEXT SENTENCE
 16153     ELSE
 16154        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16155           AND
 16156           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16157               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16158               MOVE ER-2745           TO WS-ERROR
 16159               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16160
 16161     IF PB-C-AH-CANCEL-AMT = ZERO
 16162        NEXT SENTENCE
 16163     ELSE
 16164        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16165           AND
 16166           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16167               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16168               MOVE ER-2745           TO WS-ERROR
 16169               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16170
 16171     IF WS-LF-EARNINGS-CALC = '4'
 16172        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16173
 16174     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 293
* EL050.cbl
 16175     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16176     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16177     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16178     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16179     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16180
 16181     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16182                                      PB-C-AH-REF-CALC.
 16183     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16184
 16185******************************************************************
 16186*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16187*             TO VALIDATE COVERAGE.                              *
 16188******************************************************************
 16189
 16190     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16191        PB-C-LF-CANCEL-AMT = ZEROS
 16192          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16193      ELSE
 16194          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16195
 16196     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16197        PB-C-AH-CANCEL-AMT = ZEROS
 16198          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16199      ELSE
 16200          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16201
 16202     EVALUATE TRUE
 16203         WHEN PB-CANCEL-FORCE             OR
 16204              PB-CANCEL-DATE-FORCED       OR
 16205              PB-FORCE-OFF
 16206                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16207                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16208                  END-IF
 16209         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16210               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16211              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16212                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16213         WHEN OTHER
 16214              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16215                 MOVE ER-2794              TO WS-ERROR
 16216              ELSE
 16217                 MOVE ER-2749              TO WS-ERROR
 16218              END-IF
 16219              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16220     END-EVALUATE.
 16221
 16222
 16223*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16224*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16225*            MOVE  ER-1909            TO  WS-ERROR
 16226*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16227*        ELSE
 16228*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16229
 16230     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16231     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16232        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 294
* EL050.cbl
 16233     ELSE
 16234        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16235     END-IF
 16236     .
 16237 3705-EDIT-CANCEL-DT.
 16238
 16239     IF LF-COVERAGE-CANCELLED
 16240        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16241         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16242         MOVE WS-CURRENT-MONTH-END
 16243                                 TO DC-BIN-DATE-2
 16244         SET ELAPSED-BETWEEN-BIN TO TRUE
 16245*        MOVE 1                  TO DC-OPTION-CODE
 16246         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16247         IF DATE-CONVERSION-ERROR
 16248            NEXT SENTENCE
 16249          ELSE
 16250             IF DC-ELAPSED-DAYS GREATER +180
 16251                IF PB-CANCEL-DATE-FORCED  OR
 16252                   PB-CANCEL-DATE-FORCED-NO-FEE
 16253                      MOVE ER-2751  TO WS-ERROR
 16254                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16255                 ELSE
 16256                   MOVE ER-2752  TO WS-ERROR
 16257                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16258
 16259     IF AH-COVERAGE-CANCELLED
 16260        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16261         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16262         MOVE WS-CURRENT-MONTH-END
 16263                                 TO DC-BIN-DATE-2
 16264         SET ELAPSED-BETWEEN-BIN TO TRUE
 16265*        MOVE 1                  TO DC-OPTION-CODE
 16266         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16267         IF DATE-CONVERSION-ERROR
 16268            NEXT SENTENCE
 16269          ELSE
 16270             IF DC-ELAPSED-DAYS GREATER +180
 16271                IF PB-CANCEL-DATE-FORCED OR
 16272                   PB-CANCEL-DATE-FORCED-NO-FEE
 16273                      MOVE ER-2751  TO WS-ERROR
 16274                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16275                 ELSE
 16276                   MOVE ER-2752  TO WS-ERROR
 16277                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16278
 16279     IF WS-ERROR = ER-2752
 16280        AND (PB-COMPANY-ID = 'ABL'
 16281         OR  PB-COMPANY-ID = 'FGL'
 16282         OR  PB-COMPANY-ID = 'IST'
 16283         OR  PB-COMPANY-ID = 'JHL'
 16284         OR  PB-COMPANY-ID = 'LAP'
 16285         OR  PB-COMPANY-ID = 'LBL'
 16286         OR  PB-COMPANY-ID = 'NCB'
 16287         OR  PB-COMPANY-ID = 'NLI'
 16288         OR  PB-COMPANY-ID = 'OFI'
 16289         OR  PB-COMPANY-ID = 'PLI'
 16290         OR  PB-COMPANY-ID = 'TAO'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 295
* EL050.cbl
 16291         OR  PB-COMPANY-ID = 'TIC'
 16292         OR  PB-COMPANY-ID = 'HER'
 16293         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16294         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16295            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16296            MOVE ER-2762     TO WS-ERROR
 16297            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16298
 16299     IF LF-COVERAGE-CANCELLED
 16300        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16301        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16302             MOVE ER-2733         TO WS-ERROR
 16303             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16304
 16305     IF AH-COVERAGE-CANCELLED
 16306        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16307        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16308              MOVE ER-2733        TO WS-ERROR
 16309              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16310
 16311     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16312        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16313        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16314           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16315            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16316              IF PB-COMPANY-ID NOT = 'LAP'
 16317               MOVE ER-2704            TO WS-ERROR
 16318               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16319
 16320     IF CERT-WAS-NOT-FOUND
 16321         GO TO 3999-END-EDIT.
 16322
 16323     IF PB-COMPANY-ID EQUAL 'CDC'
 16324        IF LF-COVERAGE-CANCELLED
 16325           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16326            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16327            MOVE PB-C-LF-CANCEL-DT
 16328                                 TO DC-BIN-DATE-2
 16329            SET ELAPSED-BETWEEN-BIN TO TRUE
 16330*           MOVE 1               TO DC-OPTION-CODE
 16331            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16332            IF DATE-CONVERSION-ERROR
 16333               NEXT SENTENCE
 16334             ELSE
 16335                IF DC-ELAPSED-DAYS GREATER +60
 16336                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16337
 16338     IF PB-COMPANY-ID EQUAL 'CDC'
 16339        IF AH-COVERAGE-CANCELLED
 16340           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16341            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16342            MOVE PB-C-AH-CANCEL-DT
 16343                                 TO DC-BIN-DATE-2
 16344            MOVE +0              TO DC-ELAPSED-DAYS
 16345                                    DC-ELAPSED-MONTHS
 16346            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16347*           MOVE 1               TO DC-OPTION-CODE
 16348            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 296
* EL050.cbl
 16349            IF DATE-CONVERSION-ERROR
 16350               NEXT SENTENCE
 16351             ELSE
 16352                IF DC-ELAPSED-DAYS GREATER +60
 16353                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16354
 16355     MOVE +0                     TO DC-ELAPSED-DAYS
 16356                                    DC-ELAPSED-MONTHS.
 16357
 16358     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 16359        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16360          MOVE 'Z'                TO PB-CI-OB-FLAG
 16361          MOVE ER-2767            TO WS-ERROR
 16362          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16363          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16364          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16365          GO TO 3775-OVER-REF-CHK
 16366        ELSE
 16367          MOVE ZEROS              TO PB-CI-LIVES
 16368                                     PB-C-LIVES
 16369          IF PB-CI-OB-FLAG NOT = 'B'
 16370             MOVE SPACE           TO PB-CI-OB-FLAG.
 16371
 16372     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16373         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16374     ELSE
 16375         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16376
 16377     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16378        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16379            MOVE ER-2760         TO WS-ERROR
 16380            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16381
 16382     IF LF-COVERAGE-CANCELLED
 16383        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16384         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16385            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16386               MOVE ER-2774       TO WS-ERROR
 16387               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16388
 16389     IF AH-COVERAGE-CANCELLED
 16390        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16391         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16392            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16393               MOVE ER-2775       TO WS-ERROR
 16394               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16395
 16396     IF LF-COVERAGE-CANCELLED
 16397        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16398         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16399            MOVE ER-2776         TO WS-ERROR
 16400            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16401
 16402     IF AH-COVERAGE-CANCELLED
 16403        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16404         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16405            MOVE ER-2777         TO WS-ERROR
 16406            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 297
* EL050.cbl
 16407
 16408     IF LF-COVERAGE-CANCELLED
 16409        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16410        if pb-ci-lf-expire-dt = low-values or spaces
 16411           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16412           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16413           MOVE PB-CI-EXTENTION-DAYS
 16414                                 TO DC-ELAPSED-DAYS
 16415           SET BIN-PLUS-ELAPSED  TO TRUE
 16416           PERFORM 8500-DATE-CONVERT
 16417                                 THRU 8500-EXIT
 16418           IF DATE-CONVERSION-ERROR
 16419              move low-values    to dc-bin-date-2
 16420           end-if
 16421        else
 16422           move pb-ci-lf-expire-dt
 16423                                 to dc-bin-date-2
 16424        end-if
 16425        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16426           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16427                             OR  'FIA'
 16428              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16429           ELSE
 16430              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16431              MOVE ER-2731       TO WS-ERROR
 16432              PERFORM 9900-ERROR-FORMAT
 16433                                 THRU 9900-EXIT
 16434           end-if
 16435        end-if
 16436     end-if
 16437*    IF LF-COVERAGE-CANCELLED
 16438*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16439*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16440*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16441*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16442*        SET BIN-PLUS-ELAPSED      TO TRUE
 16443*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16444*        IF DATE-CONVERSION-ERROR
 16445*           NEXT SENTENCE
 16446*         ELSE
 16447*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16448*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16449*                            OR  'FIA'
 16450*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16451*              ELSE
 16452*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16453*               MOVE ER-2731       TO WS-ERROR
 16454*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16455     .
 16456 3705-EDIT-AH-CANCEL-DT.
 16457     IF AH-COVERAGE-CANCELLED
 16458        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16459        if pb-ci-AH-expire-dt = low-values or spaces
 16460           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16461           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16462           MOVE PB-CI-EXTENTION-DAYS
 16463                                 TO DC-ELAPSED-DAYS
 16464           SET BIN-PLUS-ELAPSED  TO TRUE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 298
* EL050.cbl
 16465           PERFORM 8500-DATE-CONVERT
 16466                                 THRU 8500-EXIT
 16467           IF DATE-CONVERSION-ERROR
 16468              move low-values    to dc-bin-date-2
 16469           end-if
 16470        else
 16471           move pb-ci-ah-expire-dt
 16472                                 to dc-bin-date-2
 16473        end-if
 16474        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16475           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16476                             OR  'FIA'
 16477              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16478           ELSE
 16479              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16480              MOVE ER-2771       TO WS-ERROR
 16481              PERFORM 9900-ERROR-FORMAT
 16482                                 THRU 9900-EXIT
 16483           end-if
 16484        end-if
 16485     end-if
 16486*    IF AH-COVERAGE-CANCELLED
 16487*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16488*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16489*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16490*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16491**       MOVE 6                    TO DC-OPTION-CODE
 16492*        SET BIN-PLUS-ELAPSED      TO TRUE
 16493*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16494*        IF DATE-CONVERSION-ERROR
 16495*           NEXT SENTENCE
 16496*         ELSE
 16497*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16498*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16499*                             OR 'FIA'
 16500*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16501*             ELSE
 16502*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16503*              MOVE ER-2771       TO WS-ERROR
 16504*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16505     .
 16506 3705-EDIT-CONTINUED.
 16507
 16508*    IF LF-COVERAGE-CANCELLED
 16509*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16510*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16511*            MOVE ER-2727         TO WS-ERROR
 16512*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16513*
 16514*    IF AH-COVERAGE-CANCELLED
 16515*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16516*        IF PB-COMPANY-ID = 'ACE'
 16517*           MOVE ER-2727        TO WS-ERROR
 16518*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16519*        ELSE
 16520*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16521*              MOVE ER-2727     TO WS-ERROR
 16522*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 299
* EL050.cbl
 16523
 16524     IF PB-COMPANY-ID = 'ACE'
 16525       IF AH-COVERAGE-CANCELLED
 16526         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16527           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16528              MOVE ER-2732      TO WS-ERROR
 16529              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16530
 16531     IF PB-COMPANY-ID      EQUAL   'HER'
 16532        IF WS-ERROR        EQUAL   ER-2727
 16533            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16534            MOVE  ER-2725          TO  WS-ERROR
 16535            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16536
 16537     IF PB-C-CLAIM-CREATED-CANCEL
 16538            MOVE ER-2748         TO WS-ERROR
 16539            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16540
 16541     IF PB-C-LAST-NAME NOT = SPACES
 16542         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16543            MOVE ER-2747         TO WS-ERROR
 16544            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16545
 16546 3710-EDIT-LUMP-SUM-PRIOR.
 16547
 16548     IF AH-COVERAGE-CANCELLED
 16549         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16550             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16551                MOVE ER-2735    TO WS-ERROR
 16552                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16553
 16554     IF LF-COVERAGE-CANCELLED
 16555         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16556             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16557                MOVE ER-2735    TO WS-ERROR
 16558                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16559
 16560 3710-EDIT-PRIOR-DEATH.
 16561
 16562*    IF LF-COVERAGE-CANCELLED
 16563*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16564*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16565*           (NOT PB-CI-OB)
 16566*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16567*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16568*                   MOVE ER-2732  TO WS-ERROR
 16569*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16570*
 16571*    IF AH-COVERAGE-CANCELLED
 16572*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16573*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16574*           (NOT PB-CI-OB)
 16575*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16576*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16577*                   MOVE ER-2732  TO WS-ERROR
 16578*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16579
 16580     IF PB-CI-DEATH-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 300
* EL050.cbl
 16581         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16582            (NOT PB-COMP-LF-CANCEL)
 16583             NEXT SENTENCE
 16584         ELSE
 16585           IF PB-C-LF-CANCEL-VOIDED
 16586              NEXT SENTENCE
 16587           ELSE
 16588              MOVE ER-2753      TO WS-ERROR
 16589              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16590
 16591     IF CANCEL-FUTURE-DT
 16592         GO TO 3999-END-EDIT.
 16593
 16594 3715-GET-REMAIN-TERM-LF.
 16595
 16596     IF NO-LF-BENEFIT-MATCH  OR
 16597        WS-LF-BENEFIT-CD = ZEROS
 16598        GO TO 3730-GET-AH-REMAIN-TERM.
 16599
 16600     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16601     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16602     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16603     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16604     MOVE PB-SV-STATE            TO CP-STATE.
 16605     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16606     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16607     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16608     MOVE '2'                    TO CP-PROCESS-TYPE.
 16609     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16610     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16611     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16612     IF (PB-COMPANY-ID = 'CID')
 16613        AND (CP-STATE-STD-ABBRV = 'WI')
 16614        MOVE '7'                 TO CP-REM-TERM-METHOD
 16615        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16616     ELSE
 16617        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16618        MOVE WS-REM-TRM-CALC-OPTION
 16619                                 TO CP-REM-TRM-CALC-OPTION
 16620     END-IF
 16621**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16622     IF (PB-COMPANY-ID = 'CID')
 16623        AND (CP-STATE-STD-ABBRV = 'MO')
 16624        AND (PB-CERT-EFF-DT >= X'9B41')
 16625        AND (PB-CERT-EFF-DT <= X'A2FB')
 16626        MOVE '7'                 TO CP-REM-TERM-METHOD
 16627        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16628     END-IF
 16629     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16630                                    CP-LOAN-TERM.
 16631     IF CP-TRUNCATED-LIFE
 16632        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16633
 16634     IF CP-TERM-IS-DAYS
 16635         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16636     ELSE
 16637         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16638
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 301
* EL050.cbl
 16639     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16640
 16641     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16642
 16643     IF LF-COVERAGE-CANCELLED
 16644        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16645        NEXT SENTENCE
 16646      ELSE
 16647          GO TO 3730-GET-AH-REMAIN-TERM.
 16648
 16649 3720-GET-LF-REFUND.
 16650
 16651     IF PB-C-LF-CANCEL-VOIDED
 16652        GO TO 3730-GET-AH-REMAIN-TERM
 16653     end-if
 16654
 16655     IF PB-COMPANY-ID EQUAL 'BOA'
 16656         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16657         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16658         GO TO 3730-GET-AH-REMAIN-TERM.
 16659
 16660     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16661        (WS-AH-SPECIAL-CALC-CD = 'M')
 16662         MOVE ER-2767            TO WS-ERROR
 16663         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16664         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16665         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16666         GO TO 3780-UPDATE-CANCEL-CERT.
 16667
 16668*    if (ws-lf-earnings-calc = '6')
 16669*       or (pb-c-lf-refund-override = '6')
 16670*       move cp-remaining-term-1 to cp-remaining-term-2
 16671*    end-if
 16672     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16673
 16674     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16675     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16676     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16677     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16678     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16679     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16680     IF PB-COMPANY-ID = 'DCC'
 16681        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16682        IF PDEF-MASTER-FOUND
 16683           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16684              (V1 > +8)
 16685              OR (PD-PROD-CODE (V1) = 'L')
 16686           END-PERFORM
 16687           IF V1 < +9
 16688              MOVE PD-MAX-AMT (V1)
 16689                           TO CP-R-MAX-TOT-BEN
 16690                              EC-AM-LF-MAX-TOT-BEN
 16691           END-IF
 16692        ELSE
 16693        MOVE ' '                 TO PDEF-MASTER-SW
 16694        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16695        MOVE PB-STATE            TO ERPDEF-STATE
 16696        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 302
* EL050.cbl
 16697           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16698        END-IF
 16699        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16700        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16701        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16702        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16703        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16704        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16705        IF PDEF-MASTER-FOUND
 16706           MOVE 'N'              TO PDEF-MASTER-SW
 16707           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16708           IF PDEF-MASTER-FOUND
 16709              IF (ERPDEF-KEY-SAVE (1:16) =
 16710                           PD-CONTROL-PRIMARY (1:16))
 16711                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16712                 CONTINUE
 16713              ELSE
 16714                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16715                 IF (ERPDEF-KEY-SAVE (1:16) =
 16716                           PD-CONTROL-PRIMARY (1:16))
 16717                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16718                    CONTINUE
 16719                 ELSE
 16720                    MOVE 'N'     TO PDEF-MASTER-SW
 16721                 END-IF
 16722              END-IF
 16723
 16724              IF PDEF-MASTER-FOUND
 16725                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16726                    (V1 > +8)
 16727                    OR (PD-PROD-CODE (V1) = 'L')
 16728                 END-PERFORM
 16729                 IF V1 < +9
 16730                    MOVE PD-MAX-AMT (V1)
 16731                                 TO CP-R-MAX-TOT-BEN
 16732                                    EC-AM-LF-MAX-TOT-BEN
 16733                 END-IF
 16734              END-IF
 16735           END-IF
 16736           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16737        END-IF
 16738        END-IF
 16739     END-IF
 16740     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16741
 16742     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16743
 16744     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16745                                    PB-C-LF-REM-TERM.
 16746
 16747     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16748     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16749
 16750     IF PB-COMPANY-ID EQUAL 'FLC'
 16751        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16752           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16753           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16754                    + PB-CI-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 303
* EL050.cbl
 16755                    - CM-LF-ITD-DEATH-AMT
 16756           IF PB-C-LF-REF-CALC LESS THAN +0
 16757              MOVE +0            TO PB-C-LF-REF-CALC
 16758              GO TO 3730-GET-AH-REMAIN-TERM
 16759           ELSE
 16760              GO TO 3730-GET-AH-REMAIN-TERM.
 16761
 16762     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16763                            OR '4' OR '5' OR '6' OR '8'
 16764                            OR '9' OR 'G'
 16765        MOVE PB-C-LF-REFUND-OVERRIDE
 16766                                 TO CP-EARNING-METHOD.
 16767
 16768     if pb-company-id = 'AHL'
 16769        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16770        if cp-class-code = spaces
 16771           move zeros            to cp-class-code
 16772        end-if
 16773     ELSE
 16774        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16775     END-IF
 16776*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16777     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16778     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16779                                    CP-RATING-BENEFIT-AMT.
 16780     IF CP-STATE-STD-ABBRV = 'OR'
 16781         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16782                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16783     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16784     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16785     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16786     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16787     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16788     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16789     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16790     IF WS-DEFAULT-APR NOT NUMERIC
 16791         MOVE ZEROS TO WS-DEFAULT-APR.
 16792****   N O T E   ****
 16793*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16794*      THE OH HARD CODING IN ELCRFNDP
 16795
 16796     IF PB-COMPANY-ID = 'CID'
 16797        IF CP-STATE-STD-ABBRV = 'OH'
 16798           MOVE WS-LF-EARNINGS-CALC
 16799                                 TO CP-EARNING-METHOD
 16800        END-IF
 16801     END-IF
 16802
 16803****   N O T E   ****
 16804
 16805*    IF CP-EARN-AS-NET-PAY
 16806*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16807*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16808*               MOVE WS-DEFAULT-APR
 16809*                                TO  CP-LOAN-APR
 16810*               MOVE ER-3780     TO  WS-ERROR
 16811*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16812*           ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 304
* EL050.cbl
 16813*               MOVE ER-3781     TO  WS-ERROR
 16814*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16815*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16816     move ' '                    to cp-ext-days-calc
 16817     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16818
 16819     IF CP-REFUND-TYPE-USED NOT = SPACE
 16820         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16821
 16822     IF CP-ERROR-RATE-IS-ZERO OR
 16823        CP-ERROR-RATE-NOT-FOUND
 16824        MOVE ER-2740             TO WS-ERROR
 16825        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16826
 16827     IF CP-ERROR-RATE-FILE-NOTOPEN
 16828        MOVE ER-2617             TO WS-ERROR
 16829        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16830
 16831     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16832        AND PB-CI-ENTRY-STATUS = 'M'
 16833        MOVE +0                  TO PB-C-LF-REF-CALC
 16834     ELSE
 16835        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16836     END-IF
 16837
 16838     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16839         GO TO 3730-GET-AH-REMAIN-TERM.
 16840
 16841*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16842*       ADD +1                   TO PB-C-LF-REM-TERM
 16843*                                   CP-REMAINING-TERM
 16844*                                   CP-ORIGINAL-TERM.
 16845
 16846     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16847     MOVE '2'                    TO CP-EARNING-METHOD
 16848                                    CP-RATING-METHOD.
 16849     IF PB-COMPANY-ID = 'CID'
 16850        IF (CP-STATE-STD-ABBRV = 'MN')
 16851           AND (PB-CERT-EFF-DT > X'A4FF')
 16852           AND (WS-LF-EARNINGS-CALC = 'B')
 16853           MOVE '5'              TO CP-EARNING-METHOD
 16854           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16855        END-IF
 16856     END-IF
 16857     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16858                                        CP-REMAINING-BENEFIT
 16859                                        CP-RATING-BENEFIT-AMT.
 16860     IF CP-STATE-STD-ABBRV = 'OR'
 16861         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16862                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16863     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16864     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16865
 16866     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16867
 16868     IF CP-ERROR-RATE-IS-ZERO OR
 16869        CP-ERROR-RATE-NOT-FOUND
 16870        MOVE ER-2740             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 305
* EL050.cbl
 16871        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16872
 16873     IF CP-ERROR-RATE-FILE-NOTOPEN
 16874        MOVE ER-2617             TO WS-ERROR
 16875        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16876
 16877     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16878
 16879******************************************************************
 16880
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 306
* EL050.cbl
 16882 3730-GET-AH-REMAIN-TERM.
 16883     IF NO-AH-BENEFIT-MATCH  OR
 16884        WS-AH-BENEFIT-CD = ZEROS
 16885         GO TO 3770-CHECK-REFUNDS.
 16886
 16887     IF PB-CI-AH-LUMP-SUM-DISAB
 16888         IF  PB-C-AH-CANCEL-AMT = ZERO
 16889            IF NOT PB-COMP-AH-CANCEL
 16890             GO TO 3770-CHECK-REFUNDS.
 16891
 16892     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16893     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16894     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16895     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16896     MOVE PB-SV-STATE            TO CP-STATE.
 16897     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16898     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16899     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16900     MOVE '2'                    TO CP-PROCESS-TYPE.
 16901     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16902     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16903     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16904     IF (PB-COMPANY-ID = 'CID')
 16905        AND (CP-STATE-STD-ABBRV = 'WI')
 16906        MOVE '7'                 TO CP-REM-TERM-METHOD
 16907        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16908     ELSE
 16909        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16910        MOVE WS-REM-TRM-CALC-OPTION
 16911                                 TO CP-REM-TRM-CALC-OPTION
 16912     END-IF
 16913     IF (PB-COMPANY-ID = 'CID')
 16914        AND (CP-STATE-STD-ABBRV = 'MO')
 16915        AND (PB-CERT-EFF-DT >= X'9B41')
 16916        AND (PB-CERT-EFF-DT <= X'A2FB')
 16917        MOVE '7'                 TO CP-REM-TERM-METHOD
 16918        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16919     END-IF
 16920     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16921                                    CP-LOAN-TERM.
 16922     IF NOT CP-TERM-IS-DAYS
 16923         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16924
 16925     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16926
 16927     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16928
 16929     IF AH-COVERAGE-CANCELLED
 16930        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16931        NEXT SENTENCE
 16932      ELSE
 16933         GO TO 3770-CHECK-REFUNDS.
 16934
 16935 3740-GET-AH-REFUND.
 16936
 16937     IF PB-C-AH-CANCEL-VOIDED
 16938        GO TO 3780-UPDATE-CANCEL-CERT
 16939     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 307
* EL050.cbl
 16940
 16941     IF PB-COMPANY-ID = 'BOA'
 16942         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16943         GO TO 3770-CHECK-REFUNDS.
 16944
 16945     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16946*    MOVE ' '                    TO DC-OPTION-CODE
 16947     SET BIN-TO-GREG             TO TRUE
 16948     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16949     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16950                                    PB-C-AH-REM-TERM.
 16951     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16952     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16953
 16954     IF PB-COMPANY-ID EQUAL 'FLC'
 16955        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16956           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16957           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16958                    - CM-AH-ITD-AH-PMT)
 16959           IF PB-C-AH-REF-CALC LESS THAN +0
 16960              MOVE +0            TO PB-C-AH-REF-CALC
 16961              GO TO 3770-CHECK-REFUNDS
 16962           ELSE
 16963              GO TO 3770-CHECK-REFUNDS.
 16964
 16965     IF PB-COMPANY-ID = 'DCC'
 16966        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16967            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16968           MOVE 'S'              TO CP-EARNING-METHOD
 16969        END-IF
 16970     END-IF
 16971     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16972                            OR '4' OR '5' OR '6' OR '8'
 16973                            OR '9' OR 'G' OR 'S'
 16974        MOVE PB-C-AH-REFUND-OVERRIDE
 16975                                 TO CP-EARNING-METHOD.
 16976
 16977     if pb-company-id = 'AHL'
 16978        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16979        if cp-class-code = spaces
 16980           move zeros            to cp-class-code
 16981        end-if
 16982     ELSE
 16983        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16984     END-IF
 16985*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16986     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16987     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16988                                    CP-RATING-BENEFIT-AMT.
 16989     IF CP-STATE-STD-ABBRV = 'OR'
 16990         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16991                                         PB-CI-AH-TERM.
 16992     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16993     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16994     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16995     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16996     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16997     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 308
* EL050.cbl
 16998
 16999     IF CP-STATE-STD-ABBRV = 'OH'
 17000        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 17001                                AND 'CID' AND 'DCC' and 'VPP'
 17002                                AND 'AHL')
 17003           IF (CP-ORIGINAL-TERM GREATER 60) AND
 17004              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 17005              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 17006              MOVE '6' TO CP-EARNING-METHOD
 17007           END-IF
 17008        END-IF
 17009        IF PB-COMPANY-ID = 'CID'
 17010           IF NO-LIFE-COVERAGE
 17011              IF CP-CRITICAL-PERIOD
 17012                 MOVE '2'       TO CP-EARNING-METHOD
 17013              ELSE
 17014                 MOVE '6'       TO CP-EARNING-METHOD
 17015              END-IF
 17016           ELSE
 17017              IF WS-LF-COVERAGE-TYPE = 'L'
 17018                 MOVE '2'       TO CP-EARNING-METHOD
 17019              ELSE
 17020                 IF (PB-CI-LF-TERM > +60) OR
 17021                    (WS-LF-EARNINGS-CALC = '5')
 17022                    IF CP-CRITICAL-PERIOD
 17023                       MOVE '2'  TO CP-EARNING-METHOD
 17024                    ELSE
 17025                       MOVE '6'  TO CP-EARNING-METHOD
 17026                    END-IF
 17027                 ELSE
 17028                    MOVE '1'     TO CP-EARNING-METHOD
 17029                 END-IF
 17030              END-IF
 17031           END-IF
 17032        END-IF
 17033     END-IF
 17034
 17035*    IF CP-STATE-STD-ABBRV = 'VA'
 17036*       IF DC-GREG-DATE-CYMD GREATER 19921231
 17037*          IF CP-ORIGINAL-TERM GREATER 61
 17038*             MOVE '6' TO CP-EARNING-METHOD
 17039*          ELSE
 17040*             MOVE '1' TO CP-EARNING-METHOD.
 17041
 17042     IF WS-DEFAULT-APR NOT NUMERIC
 17043         MOVE ZEROS TO WS-DEFAULT-APR.
 17044     IF CP-EARN-AS-NET-PAY
 17045         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 17046            IF WS-DEFAULT-APR GREATER THAN ZEROS
 17047                MOVE WS-DEFAULT-APR
 17048                                 TO  CP-LOAN-APR
 17049                MOVE ER-3780     TO  WS-ERROR
 17050                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 17051            ELSE
 17052                MOVE ER-3781     TO  WS-ERROR
 17053                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 17054     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 17055     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 309
* EL050.cbl
 17056        AND CP-CANCEL-REASON = 'R'
 17057        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17058        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 17059     END-IF
 17060     IF PB-COMPANY-ID = 'DCC'
 17061        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17062        AND (CP-EARNING-METHOD = 'D')
 17063        AND (CP-CANCEL-REASON NOT = 'R')
 17064        CONTINUE
 17065     ELSE
 17066        GO TO 3750-CONTINUE
 17067     END-IF
 17068     MOVE ' '                    TO DD-IU-SW
 17069     IF NOT PDEF-MASTER-FOUND
 17070        MOVE ' '                 TO PDEF-MASTER-SW
 17071        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17072        MOVE PB-STATE            TO ERPDEF-STATE
 17073        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 17074           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 17075        END-IF
 17076        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17077        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17078        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17079        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17080        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17081        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17082        IF PDEF-MASTER-FOUND
 17083           MOVE 'N'              TO PDEF-MASTER-SW
 17084           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17085           IF PDEF-MASTER-FOUND
 17086              IF (ERPDEF-KEY-SAVE (1:16) =
 17087                           PD-CONTROL-PRIMARY (1:16))
 17088                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17089                 CONTINUE
 17090              ELSE
 17091                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17092                 IF (ERPDEF-KEY-SAVE (1:16) =
 17093                           PD-CONTROL-PRIMARY (1:16))
 17094                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17095                    CONTINUE
 17096                 ELSE
 17097                    MOVE ER-2740 TO WS-ERROR
 17098                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17099                    GO TO 3770-CHECK-REFUNDS
 17100                 END-IF
 17101              END-IF
 17102           END-IF
 17103           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17104        END-IF
 17105     END-IF
 17106     IF PDEF-MASTER-FOUND
 17107        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17108           (V1 > +8)
 17109           OR (PD-PROD-CODE (V1) = 'I')
 17110        END-PERFORM
 17111        IF V1 < +9
 17112           SET DD-IU-PRESENT        TO TRUE
 17113        END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 310
* EL050.cbl
 17114        IF WS-AH-DCC-TRUNC = 'T'
 17115           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 17116        ELSE
 17117           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 17118        END-IF
 17119        EVALUATE TRUE
 17120           WHEN WS-TERM > +168
 17121              MOVE 15               TO V1
 17122           WHEN WS-TERM > +156
 17123              MOVE 14               TO V1
 17124           WHEN WS-TERM > +144
 17125              MOVE 13               TO V1
 17126           WHEN WS-TERM > +132
 17127              MOVE 12               TO V1
 17128           WHEN WS-TERM > +120
 17129              MOVE 11               TO V1
 17130           WHEN WS-TERM > +108
 17131              MOVE 10               TO V1
 17132           WHEN WS-TERM > +96
 17133              MOVE 9                TO V1
 17134           WHEN WS-TERM > +84
 17135              MOVE 8                TO V1
 17136           WHEN WS-TERM > +72
 17137              MOVE 7                TO V1
 17138           WHEN WS-TERM > +60
 17139              MOVE 6                TO V1
 17140           WHEN WS-TERM > +48
 17141              MOVE 5                TO V1
 17142           WHEN WS-TERM > +36
 17143              MOVE 4                TO V1
 17144           WHEN WS-TERM > +24
 17145              MOVE 3                TO V1
 17146           WHEN WS-TERM > +12
 17147              MOVE 2                TO V1
 17148           WHEN OTHER
 17149              MOVE 1                TO V1
 17150        END-EVALUATE
 17151
 17152        EVALUATE TRUE
 17153*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17154*             < +13)
 17155*             AND (DD-IU-PRESENT)
 17156*             MOVE 2                TO V2
 17157*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17158*             MOVE 1                TO V2
 17159           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17160              MOVE 2                TO V2
 17161           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17162              MOVE 3                TO V2
 17163           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17164              MOVE 4                TO V2
 17165           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17166              MOVE 5                TO V2
 17167           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17168              MOVE 6                TO V2
 17169           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17170              MOVE 7                TO V2
 17171           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 311
* EL050.cbl
 17172              MOVE 8                TO V2
 17173           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17174              MOVE 9                TO V2
 17175           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17176              MOVE 10               TO V2
 17177           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17178              MOVE 11               TO V2
 17179           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17180              MOVE 12               TO V2
 17181           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17182              MOVE 13               TO V2
 17183           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17184              MOVE 14               TO V2
 17185           WHEN OTHER
 17186              MOVE 15               TO V2
 17187        END-EVALUATE
 17188
 17189        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17190                                 TO CP-DDF-LO-FACT
 17191        MOVE PD-UEP-FACTOR (V1 V2)
 17192                                 TO CP-DDF-HI-FACT
 17193
 17194        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17195        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17196        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17197           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17198        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17199        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17200        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17201           + PD-1ST-YR-ADMIN-ALLOW
 17202
 17203        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17204*       IF PI-CLP-YN = 'Y'
 17205*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17206*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17207*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17208*       END-IF
 17209
 17210        IF DD-IU-PRESENT
 17211           MOVE 'I'              TO CP-EARNING-METHOD
 17212        END-IF
 17213        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17214                                     CP-CLP-RATE-UP
 17215        IF CP-IU-RATE-UP NOT = ZEROS
 17216           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17217              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17218           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17219              / (1 - WS-WORK-FACT)
 17220        END-IF
 17221     END-IF
 17222     .
 17223 3750-CONTINUE.
 17224     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17225
 17226     IF CP-REFUND-TYPE-USED NOT = SPACE
 17227         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17228
 17229     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 312
* EL050.cbl
 17230        CP-ERROR-RATE-NOT-FOUND
 17231        MOVE ER-2740             TO WS-ERROR
 17232        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17233
 17234     IF CP-ERROR-RATE-FILE-NOTOPEN
 17235        MOVE ER-2617             TO WS-ERROR
 17236        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17237     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17238        AND (PB-CI-ENTRY-STATUS = 'M')
 17239        MOVE +0                  TO PB-C-AH-REF-CALC
 17240     ELSE
 17241        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17242     END-IF
 17243     if pb-company-id = 'VPP'
 17244        MOVE cm-ah-clp           to cp-original-premium
 17245        move zeros               to cp-calc-refund
 17246        perform 7600-get-refund  thru 7600-exit
 17247        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17248           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17249        else
 17250           move zeros            to pb-c-ah-rfnd-clp
 17251        end-if
 17252        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17253           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17254           pb-ci-cancel-fee
 17255     end-if
 17256     IF PB-COMPANY-ID = 'DCC'
 17257        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17258        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17259        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17260        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17261        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17262        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17263        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17264        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17265*       if pb-c-cancel-amt < +0
 17266*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
 17267*       end-if
 17268*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17269     END-IF
 17270     .
 17271 3770-CHECK-REFUNDS.
 17272
 17273     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17274        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17275           MOVE ER-2766          TO WS-ERROR
 17276           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17277           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17278           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17279              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17280
 17281     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17282        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17283           MOVE ER-2766          TO WS-ERROR
 17284           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17285           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17286           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17287              MOVE ZEROS         TO PB-C-AH-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 313
* EL050.cbl
 17288
 17289     IF PB-COMP-LF-CANCEL
 17290        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 17291        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17292           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17293              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17294
 17295     IF PB-COMP-AH-CANCEL
 17296        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17297        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17298           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17299              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17300
 17301     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17302             GIVING WS-UNSIGN-WRK1
 17303     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17304             GIVING WS-UNSIGN-WRK2.
 17305
 17306     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17307         MOVE ZERO TO WS-UNSIGN-WRK1.
 17308
 17309     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17310         MOVE ZERO TO WS-UNSIGN-WRK2.
 17311
 17312     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17313
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 314
* EL050.cbl
 17315
 17316 3772-CONTINUE.
 17317
 17318**********************************
 17319*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17320*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17321*** DOUBLES THE TOLERANCE AMOUNT.
 17322***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17323**********************************
 17324     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17325     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17326         IF WS-REF-REJECT-SW = SPACE
 17327             MOVE ER-2754        TO WS-ERROR
 17328             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17329           ELSE
 17330             MOVE ER-2736        TO WS-ERROR
 17331             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17332**********************************
 17333
 17334 3773-CONTINUE.
 17335
 17336     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17337        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17338           MOVE ER-2723          TO WS-ERROR
 17339           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17340
 17341     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17342        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17343           MOVE ER-2724          TO WS-ERROR
 17344           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17345
 17346     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17347         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17348             (1 + WS-LF-REFUND-OVS-PCT)
 17349     ELSE
 17350         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17351
 17352     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17353         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17354             (1 - WS-TOL-LF-REFUND-PCT)
 17355     ELSE
 17356         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17357
 17358     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17359        AND (PB-CI-ENTRY-STATUS = 'M')
 17360        AND (PB-C-LF-CANCEL-AMT > +0)
 17361        MOVE ER-3843             TO WS-ERROR
 17362        PERFORM 9900-ERROR-FORMAT
 17363                                 THRU 9900-EXIT
 17364     END-IF
 17365     EVALUATE TRUE
 17366        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17367           CONTINUE
 17368        WHEN PB-C-LF-CANCEL-AMT = +0
 17369                 AND PB-C-LF-REF-CALC > +0
 17370           CONTINUE
 17371        WHEN WS-LF-REFUND-OVS-AMT = 0
 17372                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 315
* EL050.cbl
 17373           CONTINUE
 17374        WHEN OTHER
 17375           IF WS-TOL-LF-REFUND  = +0
 17376              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17377           END-IF
 17378           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17379                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17380                          (PB-C-LF-CANCEL-AMT))
 17381              CONTINUE
 17382           ELSE
 17383              IF WS-LF-REFUND-OVS-AMT = +0
 17384                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17385              END-IF
 17386              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17387                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17388                                       PB-C-LF-CANCEL-AMT)
 17389                 CONTINUE
 17390              ELSE
 17391                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17392                   MOVE ER-2754   TO  WS-ERROR
 17393                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17394                 ELSE
 17395                    MOVE ER-2736   TO  WS-ERROR
 17396                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17397                 END-IF
 17398              END-IF
 17399           END-IF
 17400     END-EVALUATE.
 17401
 17402     EVALUATE TRUE
 17403        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17404           CONTINUE
 17405        WHEN PB-C-LF-CANCEL-AMT = +0
 17406                 AND PB-C-LF-REF-CALC > +0
 17407           CONTINUE
 17408        WHEN OTHER
 17409           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17410               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17411              CONTINUE
 17412           ELSE
 17413              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17414               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17415                CONTINUE
 17416              ELSE
 17417                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17418                     MOVE ER-2754   TO  WS-ERROR
 17419                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17420                 ELSE
 17421                     MOVE ER-2736   TO  WS-ERROR
 17422                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17423                 END-IF
 17424              END-IF
 17425           END-IF
 17426     END-EVALUATE.
 17427
 17428     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17429         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17430             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 316
* EL050.cbl
 17431     ELSE
 17432         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17433
 17434     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17435         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17436             (1 - WS-TOL-AH-REFUND-PCT)
 17437     ELSE
 17438         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17439
 17440     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17441        AND (PB-CI-ENTRY-STATUS = 'M')
 17442        AND (PB-C-AH-CANCEL-AMT > +0)
 17443        MOVE ER-3843             TO WS-ERROR
 17444        PERFORM 9900-ERROR-FORMAT
 17445                                 THRU 9900-EXIT
 17446     END-IF
 17447     EVALUATE TRUE
 17448        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17449           CONTINUE
 17450*       WHEN PB-C-AH-REF-CALC = +0 AND
 17451*                  PB-C-AH-CANCEL-AMT > +0
 17452        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17453                   PB-C-AH-REF-CALC > +0
 17454           CONTINUE
 17455        WHEN WS-AH-REFUND-OVS-AMT = +0
 17456                AND WS-TOL-AH-REFUND = +0
 17457           CONTINUE
 17458        WHEN OTHER
 17459           IF WS-TOL-AH-REFUND = +0
 17460              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17461           END-IF
 17462           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17463               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17464                                         PB-C-AH-CANCEL-AMT)
 17465              CONTINUE
 17466           ELSE
 17467              IF WS-AH-REFUND-OVS-AMT = +0
 17468                 MOVE +9999999.99 TO
 17469                         WS-AH-REFUND-OVS-AMT
 17470              END-IF
 17471              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17472                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17473                                         PB-C-AH-CANCEL-AMT)
 17474                 CONTINUE
 17475              ELSE
 17476                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17477                    MOVE ER-2754   TO  WS-ERROR
 17478                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17479                 ELSE
 17480                    MOVE ER-2736   TO  WS-ERROR
 17481                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17482                 END-IF
 17483              END-IF
 17484           END-IF
 17485     END-EVALUATE.
 17486
 17487     EVALUATE TRUE
 17488        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 317
* EL050.cbl
 17489           CONTINUE
 17490*       WHEN PB-C-AH-REF-CALC > +0 AND
 17491*                  PB-C-AH-CANCEL-AMT = +0
 17492        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17493                   PB-C-AH-REF-CALC = +0
 17494           CONTINUE
 17495        WHEN OTHER
 17496           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17497               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17498              CONTINUE
 17499           ELSE
 17500              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17501                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17502                 CONTINUE
 17503              ELSE
 17504                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17505                     MOVE ER-2754   TO  WS-ERROR
 17506                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17507                 ELSE
 17508                     MOVE ER-2736   TO  WS-ERROR
 17509                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17510                 END-IF
 17511              END-IF
 17512           END-IF
 17513     END-EVALUATE.
 17514
 17515     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17516        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17517        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17518           AND  PB-C-LF-REF-CALC < +1.00
 17519           AND  PB-C-AH-REF-CALC < +1.00
 17520           CONTINUE
 17521        ELSE
 17522           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17523              AND (PB-CI-ENTRY-STATUS = 'M')
 17524              CONTINUE
 17525           ELSE
 17526              MOVE ER-2741       TO WS-ERROR
 17527              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17528           END-IF
 17529        END-IF
 17530     END-IF
 17531
 17532     IF (PB-C-LF-CANCEL-AMT = ZERO
 17533        AND WS-LF-BENEFIT-CD NOT = ZERO
 17534        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17535        AND PB-C-LF-REF-CALC NOT = ZERO)
 17536        OR
 17537        (PB-C-LF-CANCEL-AMT = ZERO
 17538        AND WS-LF-BENEFIT-CD NOT = ZERO
 17539        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17540             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17541                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17542                NEXT SENTENCE
 17543             ELSE
 17544                MOVE ER-2739        TO WS-ERROR
 17545                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17546
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 318
* EL050.cbl
 17547     IF (PB-C-AH-CANCEL-AMT = ZERO
 17548        AND WS-AH-BENEFIT-CD NOT = ZERO
 17549        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17550        AND PB-C-AH-REF-CALC NOT = ZERO)
 17551        OR
 17552        (PB-C-AH-CANCEL-AMT = ZERO
 17553        AND WS-AH-BENEFIT-CD NOT = ZERO
 17554        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17555             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17556                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17557                NEXT SENTENCE
 17558             ELSE
 17559                MOVE ER-2738        TO WS-ERROR
 17560                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17561
 17562 3775-OVER-REF-CHK.
 17563
 17564     IF PB-CI-ENTRY-STATUS = '5'
 17565        GO TO 3780-UPDATE-CANCEL-CERT.
 17566
 17567     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17568                              PB-CI-LF-ALT-PREMIUM-AMT.
 17569
 17570     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17571        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17572                                 PB-C-LF-REF-CALC
 17573      ELSE
 17574        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17575                                 PB-C-LF-CANCEL-AMT.
 17576
 17577     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17578        MOVE ER-2755             TO WS-ERROR
 17579        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17580
 17581     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17582
 17583     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17584        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17585                                 PB-C-AH-REF-CALC
 17586      ELSE
 17587        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17588                                 PB-C-AH-CANCEL-AMT.
 17589
 17590     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17591        MOVE ER-2778             TO WS-ERROR
 17592        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17593
 17594     IF PB-CI-OB-FLAG NOT = 'Z'
 17595        NEXT SENTENCE
 17596       ELSE
 17597         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17598            MOVE ER-2757           TO WS-ERROR
 17599            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17600
 17601 3780-UPDATE-CANCEL-CERT.
 17602
 17603     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17604        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 319
* EL050.cbl
 17605        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17606
 17607     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17608         MOVE ER-2729              TO WS-ERROR
 17609         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17610
 17611     IF PB-CI-LF-BENEFIT-CD = ZERO
 17612         GO TO 3780-UPDATE-CONT-1.
 17613
 17614     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17615         GO TO 3780-UPDATE-CONT-1.
 17616
 17617     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17618       AND
 17619        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17620       AND
 17621        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17622       AND
 17623        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17624            NEXT SENTENCE
 17625       ELSE
 17626        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17627          AND
 17628***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17629***       AND
 17630           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17631            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17632               MOVE ER-2730      TO WS-ERROR
 17633               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17634               GO TO 3999-END-EDIT
 17635            ELSE
 17636               GO TO 3999-END-EDIT
 17637        ELSE
 17638            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17639               MOVE ER-2765           TO WS-ERROR
 17640               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17641               GO TO 3785-CHECK-REF-INT.
 17642*              GO TO 3999-END-EDIT.
 17643
 17644 3780-UPDATE-CONT-1.
 17645     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17646
 17647     IF PB-CI-AH-BENEFIT-CD = ZERO
 17648         GO TO 3780-UPDATE-CONT-2.
 17649
 17650     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17651         GO TO 3780-UPDATE-CONT-2.
 17652
 17653     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17654
 17655     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17656       AND
 17657        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17658       AND
 17659        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17660       AND
 17661        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17662            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 320
* EL050.cbl
 17663       ELSE
 17664        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17665          AND
 17666***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17667***       AND
 17668           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17669           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17670            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17671               MOVE ER-2773      TO WS-ERROR
 17672               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17673               GO TO 3999-END-EDIT
 17674            ELSE
 17675               GO TO 3999-END-EDIT
 17676            END-IF
 17677           ELSE
 17678             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17679                IF MSTR-CERT-NO = W-CL-CERT-NO
 17680                   MOVE ER-2890 TO WS-ERROR
 17681                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17682                   GO TO 3999-END-EDIT
 17683                ELSE
 17684                   MOVE ER-2898 TO WS-ERROR
 17685                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17686                   GO TO 3999-END-EDIT
 17687                END-IF
 17688             ELSE
 17689                GO TO 3785-CHECK-REF-INT
 17690             END-IF
 17691           END-IF
 17692          ELSE
 17693            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17694              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17695                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17696                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17697                      MOVE ER-2890 TO WS-ERROR
 17698                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17699                      GO TO 3999-END-EDIT
 17700                   ELSE
 17701                      MOVE ER-2898 TO WS-ERROR
 17702                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17703                      GO TO 3999-END-EDIT
 17704                   END-IF
 17705                ELSE
 17706                   MOVE ER-2765 TO WS-ERROR
 17707                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17708                   GO TO 3785-CHECK-REF-INT
 17709                END-IF
 17710              ELSE
 17711               MOVE ER-2765      TO WS-ERROR
 17712               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17713               GO TO 3785-CHECK-REF-INT.
 17714*              GO TO 3999-END-EDIT.
 17715
 17716 3780-UPDATE-CONT-2.
 17717
 17718     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17719        AND WS-LF-BENEFIT-CD = ZERO
 17720           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 321
* EL050.cbl
 17721           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17722
 17723     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17724        AND WS-AH-BENEFIT-CD = ZERO
 17725           MOVE ER-2744           TO WS-ERROR
 17726           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17727
 17728     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17729        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17730        AND
 17731        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17732         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17733           MOVE ER-2746           TO WS-ERROR
 17734           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17735
 17736     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17737       AND
 17738        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17739             MOVE ER-2737        TO WS-ERROR
 17740             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17741
 17742     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17743       AND
 17744        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17745             MOVE ER-2737        TO WS-ERROR
 17746             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17747
 17748     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17749         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17750             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17751             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17752         ELSE
 17753             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17754                 MOVE ER-2768    TO WS-ERROR
 17755                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17756             ELSE
 17757                 MOVE ER-2756    TO WS-ERROR
 17758                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17759
 17760     IF CERT-PEND-ISSUE-RETURNED
 17761        MOVE ER-2772             TO WS-ERROR
 17762        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17763 3785-CHECK-REF-INT.
 17764*    IF PB-STATE NOT = 'NH' and 'TN'
 17765     IF PB-STATE NOT = 'NH'
 17766        GO TO 3999-END-EDIT
 17767     END-IF
 17768
 17769     MOVE ER-2796                TO WS-ERROR
 17770     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17771     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17772        OR (CM-REF-INTERFACE-SW = 'Y')
 17773        MOVE ER-2793             TO WS-ERROR
 17774        PERFORM 9900-ERROR-FORMAT
 17775                                 THRU 9900-EXIT
 17776     END-IF
 17777     MOVE +0                     TO WS-PAYMENT-AMT
 17778     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 322
* EL050.cbl
 17779        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17780               PB-C-AH-CANCEL-DT
 17781           GO TO 3999-END-EDIT
 17782        END-IF
 17783     end-if
 17784***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17785***-_-
 17786***-_-   For TN it's only flat cancels
 17787***-_-
 17788***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17789     if pb-state = 'TN'
 17790        if ((pb-c-lf-cancel-dt <> low-values)
 17791           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17792                      or
 17793           ((pb-c-ah-cancel-dt <> low-values)
 17794           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17795           GO TO 3999-END-EDIT
 17796        END-IF
 17797     end-if
 17798     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17799        GO TO 3999-END-EDIT
 17800     END-IF
 17801***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17802***-_-
 17803***-_-   if cancel date within 15 days of effective date, bypass
 17804***-_-
 17805***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17806     IF PB-STATE NOT = 'NH'
 17807        GO TO 3785-CONTINUE
 17808     END-IF
 17809     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17810     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17811     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17812        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17813     END-IF
 17814     MOVE '1'                    TO DC-OPTION-CODE
 17815     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17816     IF NO-CONVERSION-ERROR
 17817        IF DC-ELAPSED-DAYS < +16
 17818           GO TO 3999-END-EDIT
 17819        END-IF
 17820     END-IF
 17821***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17822***-_-
 17823***-_-   if cancel date within 30 days of current date then
 17824***-_-   bypass else subtract 15 days from period
 17825***-_-
 17826***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17827     MOVE +0                     TO DC-ELAPSED-DAYS
 17828     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17829     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17830     MOVE '1'                    TO DC-OPTION-CODE
 17831     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17832     IF NO-CONVERSION-ERROR
 17833        IF DC-ELAPSED-DAYS > +30
 17834           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17835        ELSE
 17836           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 323
* EL050.cbl
 17837        END-IF
 17838     ELSE
 17839        GO TO 3999-END-EDIT
 17840     END-IF
 17841     .
 17842 3785-CONTINUE.
 17843     if pb-state = 'TN'
 17844        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17845        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17846        MOVE '1'                 TO DC-OPTION-CODE
 17847        PERFORM 8500-DATE-CONVERT
 17848                                 THRU 8500-EXIT
 17849        IF no-CONVERSION-ERROR
 17850           IF DC-ELAPSED-DAYS < +16
 17851              GO TO 3999-END-EDIT
 17852           END-IF
 17853        END-IF
 17854     end-if
 17855***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17856***-_-
 17857***-_-   'NH' is 10%, TN is 3.5%
 17858***-_-
 17859***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17860*    if pb-state = 'NH'
 17861*       move +1.10               to ws-work-rate
 17862*    else
 17863*       move +1.035              to ws-work-rate
 17864*    end-if
 17865     compute ws-work-rate = (1 + ws-st-refund-int-rate)
 17866     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17867        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17868           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17869     IF WS-PAYMENT-AMT < 10.00
 17870        GO TO 3999-END-EDIT
 17871     END-IF
 17872*    PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17873
 17874     if (cm-soc-sec-no(1:9) numeric)
 17875        and (cm-soc-sec-no(1:9) not = zeros)
 17876        GO TO 3999-END-EDIT
 17877     END-IF
 17878     MOVE ER-2795                TO WS-ERROR
 17879     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17880
 17881     GO TO 3999-END-EDIT.
 17882******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 324
* EL050.cbl
 17884 3990-FILES-NOT-OPEN.
 17885
 17886     MOVE ER-2617                TO WS-ERROR.
 17887     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17888     GO TO 9990-RETURN.
 17889
 17890 3999-END-EDIT.
 17891
 17892     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17893
 17894     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17895         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17896         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17897             PERFORM 9250-UNLOCK-RETURN
 17898             GO TO 9990-RETURN
 17899          ELSE
 17900             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17901             GO TO 9990-RETURN.
 17902
 17903     IF PB-CANCELLATION
 17904          GO TO 9990-RETURN.
 17905
 17906     IF CERT-WAS-NOT-FOUND
 17907        MOVE SPACES              TO CERTIFICATE-MASTER.
 17908
 17909     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17910
 17911     IF CERT-WAS-FOUND
 17912         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17913             PERFORM 9250-UNLOCK-RETURN
 17914          ELSE
 17915            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17916      ELSE
 17917         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17918
 17919*    if pb-company-id = 'VPP'
 17920*       perform 8150-read-elcrtt thru 8150-exit
 17921*       if ws-vehicle-odometer numeric
 17922*          if ws-vehicle-odometer > 6000
 17923*             move er-1583       to ws-error
 17924*             PERFORM 9900-ERROR-FORMAT
 17925*                                THRU 9900-EXIT
 17926*          end-if
 17927*       end-if
 17928*    end-if
 17929     if (pb-cert-sfx not = ' ')
 17930                 or
 17931        (pb-i-entry-status = 'V')
 17932        perform 7320-CHECK-FOR-OPEN-CLMS-issue
 17933                                 thru 7320-exit
 17934     end-if
 17935     perform 8145-read-elcrtt-upd thru 8145-exit
 17936     if not elcrtt-found
 17937        move 'CS'                to certificate-trailers
 17938        move cm-control-primary  to cs-control-primary
 17939        move 'C'                 TO cs-trailer-type
 17940        move zeros               to cs-vehicle-odometer
 17941     end-if
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 325
* EL050.cbl
 17942     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17943        IF ((PB-COMPANY-ID = 'DCC')
 17944           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17945                         or
 17946           (pb-company-id = 'CID' or 'VPP')
 17947           IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 17948               or (hldi-pass-area not = spaces)
 17949               move pa-modelyear        to cs-year
 17950               move pa-makename         to cs-make
 17951               move pa-modelname        to cs-model
 17952               move pa-seriesname       to cs-future
 17953               MOVE PB-I-VIN            TO CS-VIN-NUMBER
 17954               move 'Y'                 to elcrtt-update-sw
 17955           end-if
 17956        end-if
 17957     end-if
 17958     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17959        IF WS-INS-AGE-SET = 'Y'
 17960           MOVE WS-INS-AGE-DEFAULTED
 17961                                 TO CS-INS-AGE-DEFAULT-FLAG
 17962           move 'Y'              to elcrtt-update-sw
 17963        END-IF
 17964        IF WS-JNT-AGE-SET = 'Y'
 17965           MOVE WS-JNT-AGE-DEFAULTED
 17966                                 TO CS-JNT-AGE-DEFAULT-FLAG
 17967           move 'Y'              to elcrtt-update-sw
 17968        END-IF
 17969     end-if
 17970     IF PB-I-LETTER-REQD = 'Y'
 17971        MOVE ER-1577             TO WS-ERROR
 17972        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17973     ELSE
 17974     IF PB-I-LETTER-REQD = 'N'
 17975        MOVE ER-1584             TO WS-ERROR
 17976        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17977     END-IF.
 17978
 17979     move cs-ins-age-default-flag to ws-ins-age-defaulted
 17980     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 17981     move cs-vehicle-odometer    to ws-vehicle-odometer
 17982     if ws-ins-age-defaulted = 'Y'
 17983        move er-1573             to ws-error
 17984        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17985     end-if
 17986
 17987     if ws-jnt-age-defaulted = 'Y'
 17988        move er-1574             to ws-error
 17989        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17990     end-if
 17991***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17992***                                                           ****
 17993***  Set an error if the state requires verification of agent ****
 17994***  and agent hasn't verified yet and the status is not =    ****
 17995***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17996***  and the entry date > 09/01/2015.                         ****
 17997***                                                           ****
 17998***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17999     if (pb-input-dt >= X'AD81')    *> 09/01/2015
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 326
* EL050.cbl
 18000        and (pb-i-entry-status not = '5' and 'D' and 'V')
 18001        and (pb-account (9:2) not = 'OB')
 18002        if (ws-st-agent-sig-edit = 'Y')
 18003           and (am-report-code-1 not = 'CONLEY')
 18004           evaluate true
 18005              when cs-agent-edit-status = 'C'
 18006                 move er-1743    to ws-error
 18007                 perform 9900-error-format
 18008                                 thru 9900-exit
 18009              when cs-agent-edit-status = 'S'
 18010                 move er-1744    to ws-error
 18011                 perform 9900-error-format
 18012                                 thru 9900-exit
 18013              when cs-agent-edit-status = 'M'
 18014                 move er-1745    to ws-error
 18015                 perform 9900-error-format
 18016                                 thru 9900-exit
 18017              when cs-agent-edit-status = 'R'
 18018                 move er-1747    to ws-error
 18019                 perform 9900-error-format
 18020                                 thru 9900-exit
 18021              when cs-agent-edit-status = 'N'
 18022                 move er-1748    to ws-error
 18023                 perform 9900-error-format
 18024                                 thru 9900-exit
 18025              when cs-agent-edit-status <> 'V' and 'U' and
 18026                                           'R' and 'N' and
 18027                                           'H'
 18028                 move er-1746    to ws-error
 18029                 perform 9900-error-format
 18030                                 thru 9900-exit
 18031           end-evaluate
 18032        end-if
 18033     end-if
 18034*    move ' ' to cs-claim-verification-status
 18035*    move 'Y' to elcrtt-update-sw
 18036     if cs-claim-verification-status = ' ' or 'R'
 18037        move pb-state            to pa-clmhs-state
 18038        move pb-account          to pa-account
 18039        move ws-greg-eff-date    to pa-eff-dt
 18040        move pb-cert-no          to pa-cert-no
 18041        perform 7795-call-sqlclmhs
 18042                                 thru 7795-exit
 18043        if pa-clm-count > 0
 18044           if cs-claim-verification-status = ' '
 18045              move 'R'           to cs-claim-verification-status
 18046*             display 'Updating elcrtt ' pb-state ' '
 18047*                pb-account ' ' pb-cert-no
 18048              move 'Y'           to elcrtt-update-sw
 18049           end-if
 18050        else
 18051           if cs-claim-verification-status = 'R'
 18052              move ' '           to cs-claim-verification-status
 18053              move 'Y'           to elcrtt-update-sw
 18054           end-if
 18055        end-if
 18056     end-if
 18057
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 327
* EL050.cbl
 18058     if cs-claim-verification-status <> ' '
 18059        evaluate true
 18060           when cs-claim-verification-status = 'R'
 18061              move er-1749    to ws-error
 18062              perform 9900-error-format
 18063                              thru 9900-exit
 18064           when cs-claim-verification-status = 'W'
 18065              move er-1750    to ws-error
 18066              perform 9900-error-format
 18067                              thru 9900-exit
 18068           when cs-claim-verification-status = 'I'
 18069              move er-1751    to ws-error
 18070              perform 9900-error-format
 18071                              thru 9900-exit
 18072           when cs-claim-verification-status = 'K'
 18073              move er-1761    to ws-error
 18074              perform 9900-error-format
 18075                              thru 9900-exit
 18076           when cs-claim-verification-status = 'A'
 18077              move er-1752    to ws-error
 18078              perform 9900-error-format
 18079                              thru 9900-exit
 18080           when cs-claim-verification-status = 'B'
 18081              move er-1754    to ws-error
 18082              perform 9900-error-format
 18083                              thru 9900-exit
 18084           when cs-claim-verification-status = 'C'
 18085              move er-1753    to ws-error
 18086              perform 9900-error-format
 18087                              thru 9900-exit
 18088           when cs-claim-verification-status = 'D'
 18089              move er-1757    to ws-error
 18090              perform 9900-error-format
 18091                              thru 9900-exit
 18092           when cs-claim-verification-status = 'E'
 18093              move er-1758    to ws-error
 18094              perform 9900-error-format
 18095                              thru 9900-exit
 18096           when cs-claim-verification-status = 'F'
 18097              move er-1759    to ws-error
 18098              perform 9900-error-format
 18099                              thru 9900-exit
 18100           when cs-claim-verification-status = 'G'
 18101              move er-1760    to ws-error
 18102              perform 9900-error-format
 18103                              thru 9900-exit
 18104*          when cs-claim-verification-status = 'H'
 18105*             move er-1756    to ws-error
 18106*             perform 9900-error-format
 18107*                             thru 9900-exit
 18108*          when cs-claim-verification-status = 'J'
 18109*             move er-1755    to ws-error
 18110*             perform 9900-error-format
 18111*                             thru 9900-exit
 18112        end-evaluate
 18113     end-if
 18114
 18115     IF ELCRTT-UPDATE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 328
* EL050.cbl
 18116        perform 8150-update-elcrtt thru 8150-exit
 18117*       display ' back from 8150 ' elcrtt-file-status
 18118     else
 18119        if elcrtt-found
 18120           perform 8155-unlock-elcrtt
 18121                                 thru 8155-exit
 18122        end-if
 18123     end-if
 18124     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 18125     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 18126        AND (WS-NO-SECURE-PAY))
 18127                  OR
 18128        (WS-LF-SPECIAL-CALC-CD = 'O'
 18129        OR WS-AH-SPECIAL-CALC-CD = 'O')
 18130        SET SKIP-ADDR-EDIT       TO TRUE
 18131     END-IF
 18132     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 18133        AND (NOT SKIP-ADDR-EDIT)
 18134        MOVE ER-2963             TO WS-ERROR
 18135        PERFORM 9900-ERROR-FORMAT
 18136                                 THRU 9900-EXIT
 18137        GO TO 9990-RETURN
 18138     END-IF
 18139     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 18140     IF ERPNDM-FOUND NOT = 'X'
 18141        move 'Y'                 to erpndm-unlock-sw
 18142        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18143           OR (PM-CITY        = SPACES OR LOW-VALUES)
 18144           OR (PM-STATE       = SPACES OR LOW-VALUES)
 18145           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 18146           or (pm-zip-code    = zeros)
 18147           or (pm-zip-code not numeric))
 18148           AND (NOT SKIP-ADDR-EDIT)
 18149           MOVE ER-2694          TO WS-ERROR
 18150           PERFORM 9900-ERROR-FORMAT
 18151                                 THRU 9900-EXIT
 18152        END-IF
 18153        MOVE ' '                 TO STATE-RECORD-ERROR
 18154        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18155        MOVE PM-STATE            TO CNTL-ACCESS
 18156        MOVE '3'                 TO CNTL-REC-TYPE
 18157        MOVE +0                  TO CNTL-SEQ-NO
 18158        MOVE '0'                 TO RC-SW-2
 18159        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18160        IF (NO-STATE-RECORD)
 18161           OR (CF-RECORD-TYPE NOT = '3')
 18162           OR (PM-STATE NOT = CF-STATE-CODE)
 18163           IF (PM-STATE = SPACES)
 18164              AND (SKIP-ADDR-EDIT)
 18165              CONTINUE
 18166           ELSE
 18167              MOVE ER-2963       TO WS-ERROR
 18168              PERFORM 9900-ERROR-FORMAT
 18169                                 THRU 9900-EXIT
 18170           END-IF
 18171        END-IF
 18172        if (ws-error not = er-2963 and er-2694)
 18173           and (pm-city-st-zip-verified = ' ')
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 329
* EL050.cbl
 18174           and (pb-company-id = 'CID')
 18175           move spaces           to zipcd-pass-area
 18176           move pm-zip-code      to pa-zip
 18177           move pm-city          to pa-city
 18178           move pm-state         to pa-state
 18179           perform 7790-call-zip-verify
 18180                                 thru 7790-exit
 18181           if pa-errorcode-zip (1:1) = ' '
 18182                    move 'Y'     to pm-city-st-zip-verified
 18183                    PERFORM 8102-REWRITE-ERPNDM
 18184                                 THRU 8102-EXIT
 18185                    move 'N'     to erpndm-unlock-sw
 18186           else
 18187              MOVE ER-3061       TO WS-ERROR
 18188              PERFORM 9900-ERROR-FORMAT
 18189                                 THRU 9900-EXIT
 18190           end-if
 18191        end-if
 18192        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 18193           MOVE ER-2883          TO WS-ERROR
 18194           PERFORM 9900-ERROR-FORMAT
 18195                                 THRU 9900-EXIT
 18196        END-IF
 18197        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 18198           MOVE ' '                 TO STATE-RECORD-ERROR
 18199           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18200           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 18201           MOVE '3'                 TO CNTL-REC-TYPE
 18202           MOVE +0                  TO CNTL-SEQ-NO
 18203           MOVE '0'                 TO RC-SW-2
 18204           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18205           IF NO-STATE-RECORD
 18206              OR (CF-RECORD-TYPE NOT = '3')
 18207              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 18208              MOVE ER-2964          TO WS-ERROR
 18209              PERFORM 9900-ERROR-FORMAT
 18210                                    THRU 9900-EXIT
 18211           END-IF
 18212        END-IF
 18213     ELSE
 18214        IF NOT SKIP-ADDR-EDIT
 18215           MOVE ER-2393          TO WS-ERROR
 18216           PERFORM 9900-ERROR-FORMAT
 18217                                 THRU 9900-EXIT
 18218        END-IF
 18219     END-IF
 18220     if need-to-unlock-erpndm
 18221        perform 8104-unlock-erpndm
 18222                                 thru 8104-exit
 18223     end-if
 18224     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 18225
 18226     IF (ERMAIL-FOUND = ' ' AND
 18227        ERPNDM-FOUND = ' ')
 18228        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 18229           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 18230           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 18231          OR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 330
* EL050.cbl
 18232           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 18233          OR
 18234           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 18235           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 18236           GO TO 3999-UNLOCK-ERMAIL.
 18237
 18238     IF ERPNDM-FOUND = 'X'
 18239        GO TO 3999-UNLOCK-ERMAIL.
 18240
 18241     IF PM-INSURED-LAST-NAME      = SPACES
 18242        AND PM-INSURED-FIRST-NAME = SPACES
 18243        AND PM-ADDRESS-LINE-1     = SPACES
 18244        AND PM-ADDRESS-LINE-2     = SPACES
 18245        AND PM-CITY-STATE         = SPACES
 18246        AND PM-CRED-BENE-NAME     = SPACES
 18247        AND PM-CRED-BENE-ADDR     = SPACES
 18248        AND PM-CRED-BENE-CTYST    = SPACES
 18249        GO TO 3999-UNLOCK-ERMAIL
 18250     END-IF
 18251
 18252     MOVE SPACES                 TO MAILING-DATA.
 18253
 18254     MOVE 'MA'                   TO MA-RECORD-ID.
 18255     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18256     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 18257     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18258     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18259     MOVE PB-SV-STATE            TO MA-STATE.
 18260     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18261     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18262
 18263     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 18264     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 18265
 18266     IF ERMAIL-FOUND = ' '
 18267        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 18268     ELSE
 18269        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 18270        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 18271        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 18272
 18273     GO TO 9990-RETURN.
 18274
 18275 3999-UNLOCK-ERMAIL.
 18276     IF ERMAIL-FOUND = ' '
 18277        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 18278
 18279     GO TO 9990-RETURN.
 18280******************************************************************
 18281
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 331
* EL050.cbl
 18283 4000-UPDATE-CANCELLED-CERT.
 18284     IF CERT-WAS-NOT-FOUND
 18285        GO TO 4299-EXIT.
 18286
 18287*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 18288     IF PB-C-INT-ON-REFS > ZEROS
 18289        MOVE PB-C-INT-ON-REFS TO CM-INT-ON-REFS
 18290     END-IF
 18291     IF PB-C-REF-INTERFACE-SW = 'Y'
 18292        MOVE PB-C-REF-INTERFACE-SW
 18293                                 TO CM-ref-INTERFACE-SW
 18294     END-IF
 18295*    IF ERMAIL-FOUND = ' '
 18296*       PERFORM 8140-UNLOCK-ERMAIL
 18297*                                THRU 8140-EXIT
 18298*    end-if
 18299     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18300     IF ERMAIL-FOUND = 'X'
 18301        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18302        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18303        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18304        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18305           MOVE ER-2694          TO WS-ERROR
 18306           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18307     END-IF
 18308
 18309     IF PB-C-POST-CARD-IND = 'Y'
 18310        MOVE +8                  TO SUB
 18311*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18312        IF ERMAIL-FOUND = ' '
 18313           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18314              (SUB > +7)
 18315              OR (MA-MAIL-STATUS (SUB) = '1')
 18316           END-PERFORM
 18317        END-IF
 18318        IF (SUB > +7)
 18319           OR (ERMAIL-FOUND = 'X')
 18320           MOVE ER-3789          TO WS-ERROR
 18321           PERFORM 9900-ERROR-FORMAT
 18322                                 THRU 9900-EXIT
 18323        END-IF
 18324     ELSE
 18325        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18326     END-IF
 18327
 18328     IF ERMAIL-FOUND = ' '
 18329        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18330     END-IF.
 18331
 18332     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18333
 18334     IF PB-CI-OB-FLAG = 'Z'
 18335        GO TO 4150-SUMMARY-CERT-CANCEL.
 18336     perform 8145-read-elcrtt-upd thru 8145-exit
 18337     if not elcrtt-found
 18338        move 'CS'                to certificate-trailers
 18339        move cm-control-primary  to cs-control-primary
 18340        move 'C'                 TO cs-trailer-type
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 332
* EL050.cbl
 18341        move zeros               to cs-vehicle-odometer
 18342     end-if
 18343
 18344     if pb-lf-refund-type <> cs-lf-refund-method
 18345        move pb-lf-refund-type   to cs-lf-refund-method
 18346        set elcrtt-update to true
 18347     end-if
 18348     if pb-ah-refund-type <> cs-ah-refund-method
 18349        move pb-ah-refund-type   to cs-ah-refund-method
 18350        set elcrtt-update to true
 18351     end-if
 18352     IF PB-C-LF-CANCEL-VOIDED
 18353         PERFORM 4200-REVERSE-LF-CANCEL.
 18354     IF PB-C-AH-CANCEL-VOIDED
 18355         PERFORM 4200-REVERSE-AH-CANCEL.
 18356     IF ELCRTT-UPDATE
 18357        perform 8150-update-elcrtt thru 8150-exit
 18358     else
 18359        if elcrtt-found
 18360           perform 8155-unlock-elcrtt
 18361                                 thru 8155-exit
 18362        end-if
 18363     end-if
 18364     .
 18365 4100-APPLY-LF-CANCEL.
 18366
 18367     MOVE +0                     TO WS-SUB.
 18368
 18369 4100-CHECK-LF-ERRORS.
 18370
 18371     ADD +1                       TO WS-SUB.
 18372
 18373     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18374        IF LF-COVERAGE-CANCELLED
 18375           GO TO 4100-LF-CANCEL-CONT
 18376        ELSE
 18377           GO TO 4100-UPDATE-LF-COVERAGE.
 18378
 18379     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18380                                   ER-2729 OR
 18381                                   ER-2730 OR
 18382                                   ER-2731 OR
 18383                                   ER-2732 OR
 18384                                   ER-2737 OR
 18385                                   ER-2740 OR
 18386                                   ER-2743 OR
 18387                                   ER-2749 OR
 18388                                   ER-2750 OR
 18389                                   ER-2755 OR
 18390                                   ER-2757 OR
 18391                                   ER-2760 OR
 18392                                   ER-2772 OR
 18393                                   ER-2774 OR
 18394                                   ER-2776 OR
 18395                                   ER-2794
 18396        GO TO 4100-UPDATE-LF-COVERAGE.
 18397
 18398     GO TO 4100-CHECK-LF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 333
* EL050.cbl
 18399
 18400 4100-UPDATE-LF-COVERAGE.
 18401
 18402     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18403     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18404     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18405        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18406     END-IF
 18407     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18408                                      TO CM-CREDIT-INTERFACE-SW-2.
 18409     IF CM-LF-CANCEL-DT = LOW-VALUE
 18410         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18411
 18412     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18413         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18414                                         CM-LF-STATUS-AT-CANCEL.
 18415
 18416     GO TO 4100-APPLY-AH-CANCEL.
 18417
 18418 4100-LF-CANCEL-CONT.
 18419     IF PB-C-LF-CANCEL-VOIDED
 18420         GO TO 4100-APPLY-AH-CANCEL.
 18421
 18422     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18423         GO TO 4100-APPLY-AH-CANCEL.
 18424
 18425     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 18426        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18427           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18428        ELSE
 18429           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18430
 18431     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18432     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18433
 18434     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18435         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18436
 18437     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18438        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18439         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18440         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18441
 18442     IF PB-RECORD-RETURNED
 18443        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18444      ELSE
 18445        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18446
 18447 4100-APPLY-AH-CANCEL.
 18448
 18449     MOVE +0                      TO WS-SUB.
 18450
 18451 4100-CHECK-AH-ERRORS.
 18452
 18453     ADD +1                       TO WS-SUB.
 18454
 18455     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18456        IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 334
* EL050.cbl
 18457           GO TO 4100-AH-CANCEL-CONT
 18458        ELSE
 18459           GO TO 4100-UPDATE-AH-COVERAGE.
 18460
 18461     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18462                                   ER-2729 OR
 18463                                   ER-2732 OR
 18464                                   ER-2737 OR
 18465                                   ER-2740 OR
 18466                                   ER-2744 OR
 18467                                   ER-2749 OR
 18468                                   ER-2750 OR
 18469                                   ER-2755 OR
 18470                                   ER-2757 OR
 18471                                   ER-2760 OR
 18472                                   ER-2771 OR
 18473                                   ER-2772 OR
 18474                                   ER-2773 OR
 18475                                   ER-2775 OR
 18476                                   ER-2777 OR
 18477                                   ER-2778 OR
 18478                                   ER-2794
 18479        GO TO 4100-UPDATE-AH-COVERAGE.
 18480
 18481     GO TO 4100-CHECK-AH-ERRORS.
 18482
 18483 4100-UPDATE-AH-COVERAGE.
 18484
 18485     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18486     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18487     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18488     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18489                                      TO CM-CREDIT-INTERFACE-SW-2.
 18490     IF CM-AH-CANCEL-DT = LOW-VALUE
 18491         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18492
 18493     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18494         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18495                                         CM-AH-STATUS-AT-CANCEL.
 18496
 18497     IF LF-COVERAGE-CANCELLED
 18498         IF PB-RECORD-RETURNED
 18499              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18500          ELSE
 18501              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18502
 18503     GO TO 4299-EXIT.
 18504
 18505 4100-AH-CANCEL-CONT.
 18506     IF PB-C-AH-CANCEL-VOIDED
 18507         GO TO 4299-EXIT.
 18508
 18509     if cm-credit-interface-sw-2 = ' '
 18510        if pb-fatal-errors or pb-unforced-errors
 18511           move '4'              to cm-credit-interface-sw-2
 18512        else
 18513           move '1'              to cm-credit-interface-sw-2
 18514        end-if
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 335
* EL050.cbl
 18515     end-if
 18516     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18517         GO TO 4299-EXIT.
 18518
 18519     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18520        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18521           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18522        ELSE
 18523           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18524
 18525     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18526     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18527
 18528     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18529         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18530
 18531     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18532         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18533         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18534
 18535     IF PB-RECORD-RETURNED
 18536        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18537      ELSE
 18538        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18539
 18540     GO TO 4299-EXIT.
 18541
 18542 4150-SUMMARY-CERT-CANCEL.
 18543     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18544
 18545     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18546        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18547                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18548     ELSE
 18549        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18550                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18551
 18552     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18553        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18554                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18555     ELSE
 18556        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18557                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18558
 18559     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18560        NEXT SENTENCE
 18561     ELSE
 18562        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18563
 18564     GO TO 4299-EXIT.
 18565
 18566 4200-REVERSE-LF-CANCEL.
 18567     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18568
 18569     IF CM-LF-CANCEL-APPLIED
 18570        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18571        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18572        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 336
* EL050.cbl
 18573
 18574     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18575
 18576     IF PB-RECORD-RETURNED
 18577        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18578       ELSE
 18579        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18580
 18581 4200-REVERSE-LF-EXIT.
 18582       EXIT.
 18583
 18584 4200-REVERSE-AH-CANCEL.
 18585     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18586
 18587     IF CM-AH-CANCEL-APPLIED
 18588        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18589        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18590        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18591
 18592     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18593
 18594     IF PB-RECORD-RETURNED
 18595        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18596       ELSE
 18597        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18598
 18599 4200-REVERSE-AH-EXIT.
 18600       EXIT.
 18601
 18602 4299-EXIT.
 18603       EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 337
* EL050.cbl
 18605
 18606 4500-UPDATE-NEW-CERT.
 18607     IF CERT-WAS-FOUND
 18608         NEXT SENTENCE
 18609       ELSE
 18610         GO TO 4520-BUILD-NEW-KEY.
 18611
 18612     IF  CLASIC-CREATED-CERT
 18613         GO TO 4999-EXIT.
 18614
 18615     IF  CERT-WAS-CREATED-FOR-CLAIM
 18616         GO TO 4520-BUILD-NEW-KEY.
 18617
 18618     IF CERT-ADDED-BATCH
 18619        IF CM-RECORD-ID = 'CM'
 18620            GO TO 4999-EXIT.
 18621
 18622 4520-BUILD-NEW-KEY.
 18623* BUILD CONTROL PRIMARY
 18624
 18625     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18626                                       CM-COMPANY-CD-A1
 18627                                       CM-COMPANY-CD-A2
 18628                                       CM-COMPANY-CD-A4
 18629                                       CM-COMPANY-CD-A5.
 18630
 18631     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18632     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18633     MOVE PB-SV-STATE               TO CM-STATE.
 18634     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18635     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18636     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18637     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18638
 18639     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18640
 18641     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18642     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18643     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18644     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18645
 18646     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18647        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18648
 18649     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18650         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18651         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18652         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18653         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18654     ELSE
 18655         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18656
 18657     IF PB-COMPANY-ID   EQUAL  'CRI'
 18658         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18659         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18660         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18661         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18662         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 338
* EL050.cbl
 18663
 18664     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18665        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18666         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18667
 18668     IF PB-COMPANY-ID  = 'LBL'
 18669        IF PB-I-JOINT-COVERAGE
 18670            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18671                                           PB-I-MEMBER-NO
 18672            GO TO 4550-CONT-CERT-PROCESS.
 18673
 18674     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18675        NEXT SENTENCE
 18676     ELSE
 18677        GO TO 4540-BUILD-MEMBER-NO.
 18678
 18679******************************************************************
 18680*                                                                *
 18681*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18682*    FOR 'MON'.                                                  *
 18683*                                                                *
 18684******************************************************************
 18685
 18686     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18687     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18688     MOVE +1                     TO WS-SUB1
 18689                                    WS-SUB2.
 18690
 18691 4530-EDIT-MEMB-NAME.
 18692
 18693     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18694        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18695        ADD +1                       TO WS-SUB2.
 18696
 18697     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18698        ADD +1                       TO WS-SUB1
 18699        GO TO 4530-EDIT-MEMB-NAME.
 18700
 18701     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18702     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18703     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18704*    MOVE SPACE                      TO DC-OPTION-CODE.
 18705     SET  BIN-TO-GREG                TO TRUE.
 18706     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18707     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18708
 18709     GO TO 4550-CONT-CERT-PROCESS.
 18710
 18711******************************************************************
 18712*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18713******************************************************************
 18714
 18715 4540-BUILD-MEMBER-NO.
 18716
 18717     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18718         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18719         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18720         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 339
* EL050.cbl
 18721         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18722     ELSE
 18723         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18724
 18725     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18726        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18727         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18728
 18729 4550-CONT-CERT-PROCESS.
 18730
 18731*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18732*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18733*    ELSE
 18734*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18735
 18736     IF CERT-WAS-CREATED-FOR-CLAIM
 18737        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18738        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18739
 18740     IF CERT-AND-CLAIM-ONLINE
 18741        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18742        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18743
 18744     MOVE 'CM'                     TO CM-RECORD-ID.
 18745     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18746
 18747     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18748        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18749        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18750     ELSE
 18751        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18752        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18753
 18754     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18755     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18756     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18757     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18758     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18759     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18760     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18761                                      CM-LF-ITD-CANCEL-AMT
 18762                                      CM-LF-ITD-DEATH-AMT
 18763                                      CM-AH-ITD-AH-PMT
 18764                                      CM-AH-ITD-LUMP-PMT
 18765                                      CM-AH-ITD-CANCEL-AMT
 18766                                      CM-LF-NSP-PREMIUM-AMT
 18767                                      CM-AH-NSP-PREMIUM-AMT.
 18768*                                     CM-CLAIM-DEDUCT-WITHHELD
 18769*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18770     if pb-i-loan-apr = +99.9999
 18771        move zeros                 to cm-loan-apr
 18772     else
 18773        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18774     end-if
 18775     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18776     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18777     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18778     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 340
* EL050.cbl
 18779     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18780     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18781     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18782     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18783     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18784     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18785     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18786
 18787     IF PB-I-LIVES NOT NUMERIC
 18788         MOVE ZERO                 TO PB-I-LIVES.
 18789
 18790     IF PB-I-NUM-BILLED NOT NUMERIC
 18791         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18792
 18793     MOVE PB-I-LIVES               TO CM-LIVES.
 18794     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18795
 18796     IF PB-COMPANY-ID EQUAL  'DMD'
 18797         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18798         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18799
 18800     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18801     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18802     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18803     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18804     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18805     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18806
 18807     IF PB-I-LF-POLICY-FEE NUMERIC
 18808        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18809     ELSE
 18810        MOVE +0                    TO CM-LF-POLICY-FEE.
 18811
 18812     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18813        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18814        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18815     ELSE
 18816        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18817
 18818     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18819     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18820     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18821     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18822     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18823     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18824     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18825     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18826     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18827
 18828     IF PB-I-CANCEL-FEE NUMERIC
 18829        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18830     ELSE
 18831        MOVE +0                  TO CM-CANCEL-FEE
 18832     END-IF
 18833
 18834     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18835        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18836     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 341
* EL050.cbl
 18837        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18838
 18839     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18840     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18841
 18842     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18843                                      CM-LF-DEATH-EXIT-DT
 18844                                      CM-AH-SETTLEMENT-EXIT-DT.
 18845
 18846*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18847*                       'TIH' OR 'OFL' OR 'FLA' OR
 18848*                       'TII' OR 'TMS' OR 'CRI' OR
 18849*                       'NCL'
 18850     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18851
 18852     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18853         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18854            MOVE '2'                TO CM-PREMIUM-TYPE.
 18855
 18856     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18857         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18858            MOVE '2'                TO CM-PREMIUM-TYPE.
 18859
 18860     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18861         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18862     ELSE
 18863         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18864         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18865
 18866     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18867     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18868     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18869     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18870     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18871     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18872     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18873     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18874
 18875     IF PB-NO-MONTHS-SKIPPED
 18876         MOVE SPACE                 TO CM-SKIP-CODE
 18877     ELSE
 18878         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18879
 18880     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18881     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18882                                       CM-LF-STATUS-AT-CANCEL.
 18883
 18884     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18885     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18886                                       CM-AH-STATUS-AT-CANCEL.
 18887
 18888     MOVE '1'                       TO CM-ENTRY-STATUS.
 18889
 18890     IF PB-REISSUED-CERT
 18891        MOVE '5'                    TO CM-ENTRY-STATUS.
 18892
 18893     IF PB-MONTHLY-CERT
 18894        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 342
* EL050.cbl
 18895
 18896     IF PB-CASH-CERT
 18897        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18898
 18899     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18900     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18901     IF PB-POLICY-IS-DECLINED
 18902        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18903
 18904     IF PB-POLICY-IS-VOIDED
 18905        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18906
 18907     IF PB-NEEDS-UNDERWRITING
 18908        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18909
 18910     IF PB-REIN-ONLY-CERT
 18911        MOVE '9'                    TO CM-ENTRY-STATUS.
 18912
 18913     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18914         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18915     ELSE
 18916         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18917
 18918     IF PB-RECORD-RETURNED
 18919        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18920      ELSE
 18921        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18922
 18923     IF PB-I-MAIL-ADDRS-PRESENT
 18924        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18925
 18926     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18927                                       CM-ENTRY-DT.
 18928
 18929 4999-EXIT.
 18930     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 343
* EL050.cbl
 18932
 18933 5000-PROCESS-REPS.
 18934     MOVE ' '                    TO AGTC-MASTER-SW
 18935     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18936     MOVE CO-TYPE                TO AGTC-TYPE
 18937     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18938     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18939     IF (AGTC-MASTER-SW NOT = 'N')
 18940        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18941        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18942        PERFORM 8583-READ-ERAGTC-NEXT
 18943                                 THRU 8583-EXIT
 18944     END-IF
 18945     IF AGTC-MASTER-SW = 'N'
 18946        CONTINUE
 18947     ELSE
 18948        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18949           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18950              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18951              MOVE 'Y'           TO AGTC-MASTER-SW
 18952           END-IF
 18953        END-IF
 18954     END-IF
 18955     .
 18956 5000-EXIT.
 18957     EXIT.
 18958 6370-EDIT-INPUT-LF-CODE.
 18959     move ' ' to ws-benefit-cd-chg-sw
 18960     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18961        MOVE +1                  TO SUB
 18962        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18963        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18964        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18965        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18966        GO TO 6370-SEARCH-LOOP.
 18967
 18968     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18969
 18970     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18971     MOVE SPACES                 TO CNTL-ACCESS.
 18972*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18973     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18974     MOVE +0                     TO CNTL-SEQ-NO.
 18975     MOVE '4' TO RC-SW-2.
 18976     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18977
 18978     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18979        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18980        GO TO 6370-NO-LF-FOUND.
 18981
 18982     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18983     MOVE +1                     TO SUB.
 18984
 18985 6370-SEARCH-LOOP.
 18986     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18987         GO TO 6370-NO-LF-FOUND.
 18988
 18989     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 344
* EL050.cbl
 18990        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18991           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18992           set benefit-code-chg to true
 18993        end-if
 18994        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18995        GO TO 6370-HER-NET-PAY-CHECK.
 18996
 18997     ADD 1   TO SUB.
 18998*    IF SUB GREATER 120
 18999     IF SUB GREATER 200
 19000         GO TO 6370-NO-LF-FOUND.
 19001
 19002     GO TO 6370-SEARCH-LOOP.
 19003
 19004 6370-NO-LF-FOUND.
 19005
 19006     if (pb-i-lf-benefit-cd not = zeros and spaces)
 19007        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 19008        set benefit-code-chg to true
 19009     end-if
 19010     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 19011
 19012 6370-HER-NET-PAY-CHECK.
 19013
 19014     IF PB-COMPANY-ID = 'CID'
 19015        IF PB-SV-STATE = 'CA' OR 'MN'
 19016           IF PB-I-LF-BENEFIT-CD = '02'
 19017              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 19018           ELSE
 19019              IF PB-I-LF-BENEFIT-CD = '04'
 19020                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 19021              END-IF
 19022           END-IF
 19023        END-IF
 19024     END-IF
 19025
 19026     IF PB-COMPANY-ID NOT = 'HER'
 19027         GO TO 6370-EXIT.
 19028
 19029     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 19030         GO TO 6370-EXIT.
 19031
 19032     IF PB-I-LF-TERM NOT NUMERIC
 19033         MOVE ZEROS              TO PB-I-LF-TERM.
 19034
 19035     IF PB-I-LOAN-TERM NOT NUMERIC
 19036         MOVE ZEROS              TO PB-I-LOAN-TERM.
 19037
 19038     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 19039         GO TO 6370-EXIT.
 19040
 19041     IF PB-I-LF-BENEFIT-CD = '33'
 19042         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 19043
 19044     IF PB-I-LF-BENEFIT-CD = '34'
 19045         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 19046
 19047 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 345
* EL050.cbl
 19048     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 346
* EL050.cbl
 19050
 19051 6380-EDIT-INPUT-AH-CODE.
 19052     IF WK-AH-EDIT-ADDR NOT = ZEROS
 19053        MOVE +1                  TO SUB
 19054        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 19055        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 19056        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 19057        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 19058        GO TO 6380-SEARCH-LOOP.
 19059
 19060     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 19061
 19062     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 19063     MOVE SPACES                 TO CNTL-ACCESS.
 19064     MOVE 'A'                    TO CNTL-REC-TYPE.
 19065*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 19066     MOVE +0                     TO CNTL-SEQ-NO.
 19067     MOVE '5' TO RC-SW-2.
 19068     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 19069
 19070     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 19071        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 19072        GO TO 6380-NO-AH-FOUND.
 19073
 19074     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 19075     MOVE +1 TO SUB.
 19076
 19077 6380-SEARCH-LOOP.
 19078     IF CF-AH-CODE-OUT (SUB) = ZEROS
 19079         GO TO 6380-NO-AH-FOUND.
 19080
 19081     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 19082         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 19083         GO TO 6380-CSO-AH-ONLY-CHECKS.
 19084
 19085     ADD 1   TO SUB.
 19086     IF SUB GREATER THAN 96
 19087*    IF SUB GREATER THAN 300
 19088         GO TO 6380-NO-AH-FOUND.
 19089
 19090     GO TO 6380-SEARCH-LOOP.
 19091
 19092 6380-NO-AH-FOUND.
 19093
 19094     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 19095
 19096     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 19097         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 19098     ELSE
 19099         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 19100
 19101 6380-CSO-AH-ONLY-CHECKS.
 19102
 19103     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 19104        NEXT SENTENCE
 19105      ELSE
 19106        GO TO 6380-EXIT.
 19107
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 347
* EL050.cbl
 19108     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 19109         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 19110
 19111
 19112     GO TO 6380-EXIT
 19113     .
 19114 6380-CSO-LIFE-WITH-AH-CHECKS.
 19115
 19116
 19117     .
 19118 6380-EXIT.
 19119     EXIT.
 19120
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 348
* EL050.cbl
 19122
 19123 6400-COMPUTE-EXTENSION-DAYS.
 19124
 19125******************************************************************
 19126*                                                                *
 19127*                   COMPUTE EXTENSION DAYS                       *
 19128*                                                                *
 19129*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 19130*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 19131*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 19132*    THE EXTENSION DAYS.                                         *
 19133*                                                                *
 19134******************************************************************
 19135
 19136     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 19137     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 19138
 19139******************************************************************
 19140*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 19141*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 19142******************************************************************
 19143
 19144     IF DC-ELAPSED-MONTHS GREATER THAN +0
 19145        COMPUTE WS-ODD-DAYS-OVER =
 19146               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 19147     ELSE
 19148        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 19149
 19150     IF WS-ODD-DAYS-OVER = ZEROS
 19151           GO TO 6499-EXIT
 19152     ELSE
 19153        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 19154           IF WS-WDF-MONTH = 02
 19155              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 19156              ADD 2       TO  WS-ODD-DAYS-OVER
 19157              GO TO 6499-EXIT
 19158           ELSE
 19159              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 19160                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 19161                 GO TO 6499-EXIT
 19162               ELSE
 19163                 GO TO 6499-EXIT
 19164        ELSE
 19165           GO TO 6499-EXIT.
 19166
 19167 6412-CHECK-TO-DAY.
 19168
 19169        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 19170           IF WS-WDT-DAY = 28
 19171              ADD 2              TO WS-ODD-DAYS-OVER
 19172           ELSE
 19173              IF WS-WDT-DAY = 29
 19174                 ADD 1           TO WS-ODD-DAYS-OVER
 19175              ELSE
 19176                 NEXT SENTENCE
 19177        ELSE
 19178           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 19179              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 349
* EL050.cbl
 19180
 19181     GO TO 6499-EXIT.
 19182
 19183
 19184 6415-CHECK-LEAP-YEAR.
 19185
 19186     IF DC-DAYS-IN-MONTH = 29
 19187        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 19188
 19189 6415-EXIT.
 19190     EXIT.
 19191
 19192 6499-EXIT.
 19193      EXIT.
 19194
 19195 6500-END.
 19196     EXIT.
 19197
 19198
 19199******************************************************************
 19200************* PROCEDURE DIVISION FOR EL050 ***********************
 19201********************** ELC50PD END *******************************
 19202
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 350
* EL050.cbl
 19204
 19205**START***********************************************************
 19206*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 19207*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 19208******************************************************************
 19209*
 19210 6600-GET-STATE-MUNICIPAL-TAX.
 19211
 19212     IF PB-COMPANY-ID NOT = 'DMD'
 19213         GO TO 6640-EXIT.
 19214
 19215     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 19216     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 19217     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 19218*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 19219*
 19220***  Y2K PROJ 7744
 19221     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19222     SET BIN-TO-GREG          TO TRUE.
 19223     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19224
 19225     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19226
 19227     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 19228     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 19229
 19230
 19231* EXEC CICS HANDLE CONDITION
 19232*        INVREQ    (6610-START-BROWSE)
 19233*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19234*        NOTFND    (6630-END-OF-FILE)
 19235*    END-EXEC.
 19236*    MOVE '"$8JI                 ! # #00019220' TO DFHEIV0
 19237     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 19238     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19239     MOVE X'2320233030303139323230' TO DFHEIV0(25:11)
 19240     CALL 'kxdfhei1' USING DFHEIV0
 19241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19242
 19243
 19244 6610-START-BROWSE.
 19245
 19246
 19247* EXEC CICS HANDLE CONDITION
 19248*        NOTFND    (6630-END-OF-FILE)
 19249*        DISABLED  (6630-ERRESS-PROBLEM)
 19250*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19251*        ENDFILE   (6630-END-OF-FILE)
 19252*    END-EXEC.
 19253*    MOVE '"$IcJ''                ! $ #00019228' TO DFHEIV0
 19254     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19255     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19256     MOVE X'2420233030303139323238' TO DFHEIV0(25:11)
 19257     CALL 'kxdfhei1' USING DFHEIV0
 19258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19259
 19260
 19261
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 351
* EL050.cbl
 19262* EXEC CICS STARTBR
 19263*        DATASET (FILE-ID-ERRESS)
 19264*        RIDFLD  (WS-ERRESS-KEY)
 19265*        GTEQ
 19266*    END-EXEC.
 19267     MOVE 0
 19268       TO DFHEIV11
 19269*    MOVE '&,         G          &   #00019235' TO DFHEIV0
 19270     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19271     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19272     MOVE X'2020233030303139323335' TO DFHEIV0(25:11)
 19273     CALL 'kxdfhei1' USING DFHEIV0,
 19274           FILE-ID-ERRESS,
 19275           WS-ERRESS-KEY,
 19276           DFHEIV99,
 19277           DFHEIV11,
 19278           DFHEIV99
 19279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19280
 19281
 19282 6620-READ-NEXT-ERRESS-MASTER.
 19283
 19284
 19285* EXEC CICS HANDLE CONDITION
 19286*        NOTFND    (6630-END-OF-FILE)
 19287*        ENDFILE   (6630-END-OF-FILE)
 19288*        DISABLED  (6630-ERRESS-PROBLEM)
 19289*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19290*    END-EXEC.
 19291*    MOVE '"$I''cJ                ! % #00019243' TO DFHEIV0
 19292     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 19293     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19294     MOVE X'2520233030303139323433' TO DFHEIV0(25:11)
 19295     CALL 'kxdfhei1' USING DFHEIV0
 19296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19297
 19298
 19299
 19300* EXEC CICS READNEXT
 19301*        DATASET (FILE-ID-ERRESS)
 19302*        INTO    (RESIDENT-STATE-TAX-MASTER)
 19303*        RIDFLD  (WS-ERRESS-KEY)
 19304*    END-EXEC.
 19305     MOVE LENGTH OF
 19306      RESIDENT-STATE-TAX-MASTER
 19307       TO DFHEIV12
 19308     MOVE 0
 19309       TO DFHEIV11
 19310*    MOVE '&.IL                  )   #00019250' TO DFHEIV0
 19311     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19312     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19313     MOVE X'2020233030303139323530' TO DFHEIV0(25:11)
 19314     CALL 'kxdfhei1' USING DFHEIV0,
 19315           FILE-ID-ERRESS,
 19316           RESIDENT-STATE-TAX-MASTER,
 19317           DFHEIV12,
 19318           WS-ERRESS-KEY,
 19319           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 352
* EL050.cbl
 19320           DFHEIV11,
 19321           DFHEIV99,
 19322           DFHEIV99
 19323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19324
 19325
 19326     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19327
 19328* EXEC CICS ENDBR
 19329*            DATASET (FILE-ID-ERRESS)
 19330*       END-EXEC
 19331     MOVE 0
 19332       TO DFHEIV11
 19333*    MOVE '&2                    $   #00019257' TO DFHEIV0
 19334     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19335     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19336     MOVE X'2020233030303139323537' TO DFHEIV0(25:11)
 19337     CALL 'kxdfhei1' USING DFHEIV0,
 19338           FILE-ID-ERRESS,
 19339           DFHEIV11,
 19340           DFHEIV99
 19341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19342        GO TO 6630-END-OF-FILE.
 19343
 19344     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19345        NEXT SENTENCE
 19346      ELSE
 19347        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19348
 19349*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19350*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19351*
 19352     MOVE +2                     TO WS-SUB1.
 19353
 19354     IF PB-ISSUE
 19355     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19356        MOVE +1                  TO WS-SUB1.
 19357
 19358     IF PB-CANCELLATION
 19359     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19360        MOVE +1                  TO WS-SUB1.
 19361*
 19362*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19363*
 19364***  Y2K PROJ 7744
 19365     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19366***  Y2K PROJ 7744
 19367
 19368*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19369* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19370* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19371
 19372     ADD 1                    TO WS-YEAR-YY.
 19373
 19374     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19375         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19376                              TO WS-RES-STATE-TAX
 19377         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 353
* EL050.cbl
 19378                              TO WS-RES-MUNI-TAX
 19379     ELSE
 19380         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19381                              TO WS-RES-STATE-TAX
 19382         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19383                              TO WS-RES-MUNI-TAX.
 19384
 19385*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19386
 19387     IF PB-CANCELLATION
 19388         GO TO 6640-CANCEL-TAX.
 19389
 19390     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19391         COMPUTE PB-I-STATE-TAX ROUNDED =
 19392                                   PB-I-LF-PREMIUM-AMT
 19393                                 * WS-RES-STATE-TAX
 19394         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19395                                   PB-I-LF-PREMIUM-AMT
 19396                                 * WS-RES-MUNI-TAX
 19397     ELSE
 19398     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19399         COMPUTE PB-I-STATE-TAX ROUNDED =
 19400                                   PB-I-AH-PREMIUM-AMT
 19401                                 * WS-RES-STATE-TAX
 19402         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19403                                   PB-I-AH-PREMIUM-AMT
 19404                                 * WS-RES-MUNI-TAX.
 19405
 19406
 19407* EXEC CICS ENDBR
 19408*         DATASET (FILE-ID-ERRESS)
 19409*    END-EXEC.
 19410     MOVE 0
 19411       TO DFHEIV11
 19412*    MOVE '&2                    $   #00019324' TO DFHEIV0
 19413     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19414     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19415     MOVE X'2020233030303139333234' TO DFHEIV0(25:11)
 19416     CALL 'kxdfhei1' USING DFHEIV0,
 19417           FILE-ID-ERRESS,
 19418           DFHEIV11,
 19419           DFHEIV99
 19420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19421
 19422
 19423     GO TO 6640-EXIT.
 19424
 19425 6640-CANCEL-TAX.
 19426     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19427
 19428     IF PB-C-LF-CANCEL-AMT > ZEROS
 19429         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19430                                   PB-C-LF-CANCEL-AMT
 19431                                 * WS-RES-STATE-TAX
 19432         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19433                                   PB-C-LF-CANCEL-AMT
 19434                                *  WS-RES-MUNI-TAX
 19435     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 354
* EL050.cbl
 19436     IF PB-C-AH-CANCEL-AMT > ZEROS
 19437         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19438                                   PB-C-AH-CANCEL-AMT
 19439                                 * WS-RES-STATE-TAX
 19440         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19441                                   PB-C-AH-CANCEL-AMT
 19442                                *  WS-RES-MUNI-TAX.
 19443
 19444
 19445* EXEC CICS ENDBR
 19446*         DATASET (FILE-ID-ERRESS)
 19447*    END-EXEC.
 19448     MOVE 0
 19449       TO DFHEIV11
 19450*    MOVE '&2                    $   #00019349' TO DFHEIV0
 19451     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19452     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19453     MOVE X'2020233030303139333439' TO DFHEIV0(25:11)
 19454     CALL 'kxdfhei1' USING DFHEIV0,
 19455           FILE-ID-ERRESS,
 19456           DFHEIV11,
 19457           DFHEIV99
 19458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19459
 19460
 19461     GO TO 6640-EXIT.
 19462
 19463 6630-END-OF-FILE.
 19464     MOVE ER-8002              TO WS-ERROR.
 19465     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19466
 19467     GO TO 6640-EXIT.
 19468
 19469 6630-ERRESS-PROBLEM.
 19470     MOVE ER-8044              TO WS-ERROR.
 19471     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19472
 19473 6640-EXIT.
 19474     EXIT.
 19475
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 355
* EL050.cbl
 19477 6650-GET-RES-STATE-COMM.
 19478
 19479     IF PB-COMPANY-ID NOT = 'DMD'
 19480         GO TO 6700-COMM-EXIT.
 19481
 19482     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19483     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19484     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19485     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19486     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19487     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19488     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19489
 19490*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19491*
 19492***  Y2K PROJ 7744
 19493     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19494     SET BIN-TO-GREG          TO TRUE.
 19495     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19496
 19497     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19498***  Y2K PROJ 7744
 19499
 19500     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19501
 19502
 19503* EXEC CICS HANDLE CONDITION
 19504*        INVREQ    (6660-START-BROWSE)
 19505*        DISABLED  (6690-ERRESC-PROBLEM)
 19506*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19507*        NOTFND    (6690-END-OF-FILE)
 19508*    END-EXEC.
 19509*    MOVE '"$8cJI                ! & #00019394' TO DFHEIV0
 19510     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19511     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19512     MOVE X'2620233030303139333934' TO DFHEIV0(25:11)
 19513     CALL 'kxdfhei1' USING DFHEIV0
 19514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19515
 19516
 19517
 19518* EXEC CICS RESETBR
 19519*        DATASET (FILE-ID-ERRESC)
 19520*        RIDFLD  (WS-ERRESC-KEY)
 19521*    END-EXEC.
 19522     MOVE 0
 19523       TO DFHEIV11
 19524*    MOVE '&4         G          &   #00019401' TO DFHEIV0
 19525     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19526     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19527     MOVE X'2020233030303139343031' TO DFHEIV0(25:11)
 19528     CALL 'kxdfhei1' USING DFHEIV0,
 19529           FILE-ID-ERRESC,
 19530           WS-ERRESC-KEY,
 19531           DFHEIV99,
 19532           DFHEIV11,
 19533           DFHEIV99
 19534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 356
* EL050.cbl
 19535
 19536
 19537 6660-START-BROWSE.
 19538
 19539
 19540* EXEC CICS HANDLE CONDITION
 19541*        NOTFND    (6690-END-OF-FILE)
 19542*        DISABLED  (6690-ERRESC-PROBLEM)
 19543*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19544*        ENDFILE   (6690-END-OF-FILE)
 19545*    END-EXEC.
 19546*    MOVE '"$IcJ''                ! '' #00019408' TO DFHEIV0
 19547     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19548     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19549     MOVE X'2720233030303139343038' TO DFHEIV0(25:11)
 19550     CALL 'kxdfhei1' USING DFHEIV0
 19551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19552
 19553
 19554
 19555* EXEC CICS STARTBR
 19556*        DATASET (FILE-ID-ERRESC)
 19557*        RIDFLD  (WS-ERRESC-KEY)
 19558*        GTEQ
 19559*    END-EXEC.
 19560     MOVE 0
 19561       TO DFHEIV11
 19562*    MOVE '&,         G          &   #00019415' TO DFHEIV0
 19563     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19564     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19565     MOVE X'2020233030303139343135' TO DFHEIV0(25:11)
 19566     CALL 'kxdfhei1' USING DFHEIV0,
 19567           FILE-ID-ERRESC,
 19568           WS-ERRESC-KEY,
 19569           DFHEIV99,
 19570           DFHEIV11,
 19571           DFHEIV99
 19572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19573
 19574
 19575     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19576
 19577 6670-READ-NEXT-ERRESC-MASTER.
 19578
 19579
 19580* EXEC CICS HANDLE CONDITION
 19581*        NOTFND    (6690-END-OF-FILE)
 19582*        DISABLED  (6690-ERRESC-PROBLEM)
 19583*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19584*        ENDFILE   (6690-END-OF-FILE)
 19585*    END-EXEC.
 19586*    MOVE '"$IcJ''                ! ( #00019425' TO DFHEIV0
 19587     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19588     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19589     MOVE X'2820233030303139343235' TO DFHEIV0(25:11)
 19590     CALL 'kxdfhei1' USING DFHEIV0
 19591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19592
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 357
* EL050.cbl
 19593
 19594
 19595* EXEC CICS READNEXT
 19596*        DATASET (FILE-ID-ERRESC)
 19597*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19598*        RIDFLD  (ERRESC-RECORD-KEY)
 19599*    END-EXEC.
 19600     MOVE LENGTH OF
 19601      ACCOUNT-RESIDENT-ST-COMMISSION
 19602       TO DFHEIV12
 19603     MOVE 0
 19604       TO DFHEIV11
 19605*    MOVE '&.IL                  )   #00019432' TO DFHEIV0
 19606     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19607     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19608     MOVE X'2020233030303139343332' TO DFHEIV0(25:11)
 19609     CALL 'kxdfhei1' USING DFHEIV0,
 19610           FILE-ID-ERRESC,
 19611           ACCOUNT-RESIDENT-ST-COMMISSION,
 19612           DFHEIV12,
 19613           ERRESC-RECORD-KEY,
 19614           DFHEIV99,
 19615           DFHEIV11,
 19616           DFHEIV99,
 19617           DFHEIV99
 19618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19619
 19620
 19621     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19622        NEXT SENTENCE
 19623     ELSE
 19624
 19625* EXEC CICS ENDBR
 19626*            DATASET (FILE-ID-ERRESC)
 19627*       END-EXEC
 19628     MOVE 0
 19629       TO DFHEIV11
 19630*    MOVE '&2                    $   #00019441' TO DFHEIV0
 19631     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19632     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19633     MOVE X'2020233030303139343431' TO DFHEIV0(25:11)
 19634     CALL 'kxdfhei1' USING DFHEIV0,
 19635           FILE-ID-ERRESC,
 19636           DFHEIV11,
 19637           DFHEIV99
 19638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19639        GO TO 6690-END-OF-FILE.
 19640
 19641     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19642
 19643* EXEC CICS ENDBR
 19644*            DATASET (FILE-ID-ERRESC)
 19645*       END-EXEC
 19646     MOVE 0
 19647       TO DFHEIV11
 19648*    MOVE '&2                    $   #00019447' TO DFHEIV0
 19649     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19650     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 358
* EL050.cbl
 19651     MOVE X'2020233030303139343437' TO DFHEIV0(25:11)
 19652     CALL 'kxdfhei1' USING DFHEIV0,
 19653           FILE-ID-ERRESC,
 19654           DFHEIV11,
 19655           DFHEIV99
 19656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19657        GO TO 6690-END-OF-FILE.
 19658
 19659     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19660        NEXT SENTENCE
 19661      ELSE
 19662        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19663
 19664* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19665*
 19666     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19667
 19668     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19669
 19670     IF WS-SUB1 > ZERO
 19671         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19672             PERFORM 6680-SET-COMMISSION
 19673         ELSE
 19674             PERFORM 6680-SET-TABLE-CODE.
 19675
 19676
 19677* EXEC CICS ENDBR
 19678*         DATASET (FILE-ID-ERRESC)
 19679*    END-EXEC.
 19680     MOVE 0
 19681       TO DFHEIV11
 19682*    MOVE '&2                    $   #00019469' TO DFHEIV0
 19683     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19684     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19685     MOVE X'2020233030303139343639' TO DFHEIV0(25:11)
 19686     CALL 'kxdfhei1' USING DFHEIV0,
 19687           FILE-ID-ERRESC,
 19688           DFHEIV11,
 19689           DFHEIV99
 19690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19691
 19692
 19693     GO TO 6700-COMM-EXIT.
 19694
 19695 6680-SET-TABLE-CODE.
 19696     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19697        MOVE ZEROS             TO WS-SUB1
 19698     ELSE
 19699* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19700* TO COMPUTE AH COMMISSION.
 19701        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19702        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19703        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19704        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19705        PERFORM 6680-READ-CTBL-TABLE
 19706        IF WS-CTBL-READ-SW NOT = 'Y'
 19707           MOVE ZEROS          TO WS-SUB1.
 19708
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 359
* EL050.cbl
 19709 6680-READ-CTBL-TABLE.
 19710*
 19711* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19712* TO COMPUTE LIFE COMMISSION
 19713
 19714     IF CTBL-SW = '0540'
 19715        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19716        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19717        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19718
 19719     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19720
 19721     IF CTBL-TABLE-FOUND
 19722        IF CTBL-SW = '0530'
 19723             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19724                                    * PB-I-AH-TERM
 19725             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19726             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19727        ELSE
 19728             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19729             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19730             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19731     ELSE
 19732        IF FIRST-TIME-THROUGH
 19733            GO TO 6680-READ-CTBL-TABLE
 19734        ELSE
 19735            MOVE ZEROS         TO WS-SUB1.
 19736
 19737 6680-SET-COMMISSION.
 19738     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19739           MOVE ZEROS          TO WS-SUB1
 19740       ELSE
 19741           MOVE RESC-COMMISSION-PER (WS-SUB)
 19742                               TO WS-COMMISSION
 19743           IF CTBL-SW = '0530'
 19744               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19745           ELSE
 19746               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19747
 19748 6680-SEARCH-CATEGORY.
 19749     ADD +1                   TO WS-SUB.
 19750     IF WS-SUB > +12
 19751         GO TO 6680-EXIT.
 19752
 19753     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19754          MOVE WS-SUB         TO WS-SUB1
 19755          GO TO 6680-EXIT.
 19756
 19757     GO TO 6680-SEARCH-CATEGORY.
 19758
 19759 6680-EXIT.
 19760     EXIT.
 19761
 19762 6690-END-OF-FILE.
 19763     GO TO 6700-COMM-EXIT.
 19764
 19765 6690-ERRESC-PROBLEM.
 19766      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 360
* EL050.cbl
 19767      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19768
 19769      GO TO 6700-COMM-EXIT.
 19770
 19771 6700-COMM-EXIT.
 19772     EXIT.
 19773
 19774 7000-GET-RATE.
 19775
 19776* EXEC CICS LINK
 19777*        PROGRAM    ('ELRATE')
 19778*        COMMAREA   (CALCULATION-PASS-AREA)
 19779*        LENGTH     (CP-COMM-LENGTH)
 19780*    END-EXEC.
 19781     MOVE 'ELRATE' TO DFHEIV1
 19782*    MOVE '."C                   (   #00019555' TO DFHEIV0
 19783     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19784     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19785     MOVE X'2020233030303139353535' TO DFHEIV0(25:11)
 19786     CALL 'kxdfhei1' USING DFHEIV0,
 19787           DFHEIV1,
 19788           CALCULATION-PASS-AREA,
 19789           CP-COMM-LENGTH,
 19790           DFHEIV99,
 19791           DFHEIV99,
 19792           DFHEIV99,
 19793           DFHEIV99
 19794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19795
 19796
 19797 7000-EXIT.
 19798     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 361
* EL050.cbl
 19800 7100-FIND-BENEFIT-IN-STATE.
 19801     MOVE 'N'                    TO BEN-SEARCH-SW.
 19802
 19803     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19804         VARYING SUB3 FROM 1 BY 1 UNTIL
 19805            ((SUB3 GREATER 50) OR
 19806              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19807               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19808
 19809     IF SUB3 NOT = 51
 19810         MOVE 'Y'                TO BEN-SEARCH-SW.
 19811
 19812     GO TO 7199-EXIT.
 19813
 19814 7100-BENEFIT-DUMMY.
 19815
 19816 7100-DUMMY-EXIT.
 19817     EXIT.
 19818
 19819 7199-EXIT.
 19820     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 362
* EL050.cbl
 19822 7200-FIND-BENEFIT.
 19823     MOVE 'N'                    TO BEN-SEARCH-SW.
 19824
 19825     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19826         VARYING SUB3 FROM 1 BY 1 UNTIL
 19827            ((SUB3 GREATER 8) OR
 19828            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19829
 19830     IF SUB3 NOT = 9
 19831         MOVE 'Y'                TO BEN-SEARCH-SW.
 19832
 19833     GO TO 7200-EXIT.
 19834
 19835 7200-BENEFIT-DUMMY.
 19836
 19837 7200-DUMMY-EXIT.
 19838     EXIT.
 19839
 19840 7200-EXIT.
 19841     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 363
* EL050.cbl
 19843 7250-LOOK-FOR-RESCINDED-CLAIM.
 19844     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19845                                    W-CL-COMP-CD.
 19846     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19847                                    W-CL-CERT-NO.
 19848
 19849
 19850* EXEC CICS HANDLE CONDITION
 19851*        NOTFND  (7250-CONTINUE)
 19852*        ENDFILE (7250-CONTINUE)
 19853*    END-EXEC.
 19854*    MOVE '"$I''                  ! ) #00019613' TO DFHEIV0
 19855     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19856     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19857     MOVE X'2920233030303139363133' TO DFHEIV0(25:11)
 19858     CALL 'kxdfhei1' USING DFHEIV0
 19859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19860
 19861
 19862
 19863* EXEC CICS IGNORE CONDITION
 19864*        DUPKEY
 19865*    END-EXEC.
 19866*    MOVE '"*$                   !   #00019618' TO DFHEIV0
 19867     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19868     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19869     MOVE X'2020233030303139363138' TO DFHEIV0(25:11)
 19870     CALL 'kxdfhei1' USING DFHEIV0
 19871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19872
 19873
 19874
 19875* EXEC CICS STARTBR
 19876*        DATASET   (CLMS-ID)
 19877*        RIDFLD    (ELMSTR-KEY)
 19878*        GENERIC   EQUAL
 19879*        KEYLENGTH (ELMSTR-LENGTH)
 19880*    END-EXEC.
 19881     MOVE 0
 19882       TO DFHEIV11
 19883*    MOVE '&,   KG    E          &   #00019622' TO DFHEIV0
 19884     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19885     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19886     MOVE X'2020233030303139363232' TO DFHEIV0(25:11)
 19887     CALL 'kxdfhei1' USING DFHEIV0,
 19888           CLMS-ID,
 19889           ELMSTR-KEY,
 19890           ELMSTR-LENGTH,
 19891           DFHEIV11,
 19892           DFHEIV99
 19893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19894
 19895
 19896     MOVE 'Y'                    TO W-BROWSE-SW.
 19897
 19898 7250-NEXT-CLAIM.
 19899
 19900
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 364
* EL050.cbl
 19901* EXEC CICS READNEXT
 19902*        DATASET   (CLMS-ID)
 19903*        RIDFLD    (ELMSTR-KEY)
 19904*        SET       (ADDRESS OF CLAIM-MASTER)
 19905*    END-EXEC.
 19906     MOVE 0
 19907       TO DFHEIV11
 19908*    MOVE '&.S                   )   #00019633' TO DFHEIV0
 19909     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19910     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19911     MOVE X'2020233030303139363333' TO DFHEIV0(25:11)
 19912     CALL 'kxdfhei1' USING DFHEIV0,
 19913           CLMS-ID,
 19914           DFHEIV20,
 19915           DFHEIV99,
 19916           ELMSTR-KEY,
 19917           DFHEIV99,
 19918           DFHEIV11,
 19919           DFHEIV99,
 19920           DFHEIV99
 19921     SET ADDRESS OF CLAIM-MASTER TO
 19922         DFHEIV20
 19923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19924
 19925
 19926     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19927        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19928         GO TO 7250-CONTINUE
 19929     END-IF.
 19930
 19931     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19932        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19933        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19934        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19935        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19936         GO TO 7250-NEXT-CLAIM
 19937     END-IF.
 19938
 19939     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19940        OR (CL-CLAIM-TYPE = 'I')
 19941        OR (CL-CLAIM-TYPE = 'G')
 19942        OR (CL-CLAIM-TYPE = 'F')
 19943          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19944              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19945              GO TO 7250-CONTINUE
 19946          END-IF
 19947     END-IF.
 19948
 19949     GO TO 7250-NEXT-CLAIM.
 19950
 19951 7250-CONTINUE.
 19952
 19953     IF W-BROWSE-SW = 'Y'
 19954
 19955* EXEC CICS ENDBR
 19956*            DATASET   (CLMS-ID)
 19957*        END-EXEC
 19958     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 365
* EL050.cbl
 19959       TO DFHEIV11
 19960*    MOVE '&2                    $   #00019667' TO DFHEIV0
 19961     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19962     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19963     MOVE X'2020233030303139363637' TO DFHEIV0(25:11)
 19964     CALL 'kxdfhei1' USING DFHEIV0,
 19965           CLMS-ID,
 19966           DFHEIV11,
 19967           DFHEIV99
 19968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19969         MOVE 'N' TO W-BROWSE-SW
 19970     END-IF.
 19971
 19972 7250-EXIT.
 19973     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 366
* EL050.cbl
 19975 7300-CHECK-FOR-OPEN-CLMS.
 19976
 19977*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19978*    MOVE SPACES                 TO CNTL-ACCESS.
 19979*    MOVE '1'                    TO CNTL-REC-TYPE.
 19980*    MOVE +0                     TO CNTL-SEQ-NO.
 19981
 19982*    MOVE '3'                    TO RC-SW-1.
 19983*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19984
 19985*    IF NOT CF-COMPANY-MASTER
 19986*         PERFORM 0099-COMPANY-NOT-FOUND
 19987*         GO TO 7300-EXIT.
 19988
 19989     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19990                                    W-CL-COMP-CD.
 19991     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19992                                    W-CL-CERT-NO.
 19993
 19994
 19995* EXEC CICS HANDLE CONDITION
 19996*        NOTFND  (7300-CONTINUE)
 19997*        ENDFILE (7300-CONTINUE)
 19998*    END-EXEC.
 19999*    MOVE '"$I''                  ! * #00019695' TO DFHEIV0
 20000     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20001     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20002     MOVE X'2A20233030303139363935' TO DFHEIV0(25:11)
 20003     CALL 'kxdfhei1' USING DFHEIV0
 20004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20005
 20006
 20007
 20008* EXEC CICS IGNORE CONDITION
 20009*        DUPKEY
 20010*    END-EXEC.
 20011*    MOVE '"*$                   !   #00019700' TO DFHEIV0
 20012     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 20013     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20014     MOVE X'2020233030303139373030' TO DFHEIV0(25:11)
 20015     CALL 'kxdfhei1' USING DFHEIV0
 20016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20017
 20018
 20019
 20020* EXEC CICS STARTBR
 20021*        DATASET   (CLMS-ID)
 20022*        RIDFLD    (ELMSTR-KEY)
 20023*        GENERIC   EQUAL
 20024*        KEYLENGTH (ELMSTR-LENGTH)
 20025*    END-EXEC.
 20026     MOVE 0
 20027       TO DFHEIV11
 20028*    MOVE '&,   KG    E          &   #00019704' TO DFHEIV0
 20029     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 20030     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20031     MOVE X'2020233030303139373034' TO DFHEIV0(25:11)
 20032     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 367
* EL050.cbl
 20033           CLMS-ID,
 20034           ELMSTR-KEY,
 20035           ELMSTR-LENGTH,
 20036           DFHEIV11,
 20037           DFHEIV99
 20038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20039
 20040
 20041     MOVE 'Y'                    TO W-BROWSE-SW.
 20042
 20043 7300-NEXT-CLAIM.
 20044
 20045
 20046* EXEC CICS READNEXT
 20047*        DATASET   (CLMS-ID)
 20048*        RIDFLD    (ELMSTR-KEY)
 20049*        SET       (ADDRESS OF CLAIM-MASTER)
 20050*    END-EXEC.
 20051     MOVE 0
 20052       TO DFHEIV11
 20053*    MOVE '&.S                   )   #00019715' TO DFHEIV0
 20054     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20055     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20056     MOVE X'2020233030303139373135' TO DFHEIV0(25:11)
 20057     CALL 'kxdfhei1' USING DFHEIV0,
 20058           CLMS-ID,
 20059           DFHEIV20,
 20060           DFHEIV99,
 20061           ELMSTR-KEY,
 20062           DFHEIV99,
 20063           DFHEIV11,
 20064           DFHEIV99,
 20065           DFHEIV99
 20066     SET ADDRESS OF CLAIM-MASTER TO
 20067         DFHEIV20
 20068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20069
 20070
 20071     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 20072        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 20073         GO TO 7300-CONTINUE.
 20074
 20075     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 20076        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 20077        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 20078        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 20079        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20080         GO TO 7300-NEXT-CLAIM.
 20081
 20082*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 20083     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20084        OR (CL-CLAIM-TYPE = 'I')
 20085        OR (CL-CLAIM-TYPE = 'G')
 20086        OR (CL-CLAIM-TYPE = 'F')
 20087        IF CLAIM-IS-OPEN
 20088           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20089             AND PB-C-AH-CANCEL-DT > SPACES
 20090              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 368
* EL050.cbl
 20091              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20092           END-IF
 20093           EVALUATE TRUE
 20094             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20095                 MOVE ER-2884      TO WS-ERROR
 20096             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20097                 MOVE ER-2887      TO WS-ERROR
 20098             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20099                 MOVE ER-2886      TO WS-ERROR
 20100             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20101                 MOVE ER-2888      TO WS-ERROR
 20102             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20103                 MOVE ER-2885      TO WS-ERROR
 20104             WHEN OTHER
 20105                 MOVE ER-2768      TO WS-ERROR
 20106           END-EVALUATE
 20107           IF PB-C-AH-CANCEL-VOIDED OR
 20108              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20109                NOT AH-COVERAGE-CANCELLED)
 20110               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20111               MOVE ER-2768      TO WS-ERROR
 20112           END-IF
 20113           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20114           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20115              PB-FORCE-CODE NOT EQUAL '8'
 20116               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20117           END-IF
 20118           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20119           GO TO 7300-NEXT-CLAIM
 20120        ELSE
 20121           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20122*****THIS IS A RESCISSION OR REFORMATION
 20123              IF AH-COVERAGE-CANCELLED
 20124                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 20125                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 20126                    MOVE 1                   TO DC-ELAPSED-DAYS
 20127                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 20128                    SET BIN-PLUS-ELAPSED     TO TRUE
 20129                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 20130                    IF NO-CONVERSION-ERROR
 20131                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 20132                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 20133                          MOVE ER-2897 TO WS-ERROR
 20134                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20135                          GO TO 7300-NEXT-CLAIM
 20136                       END-IF
 20137                    END-IF
 20138                 ELSE
 20139                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 20140                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20141                         MOVE ER-2890 TO WS-ERROR
 20142                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20143                         GO TO 7300-NEXT-CLAIM
 20144                      ELSE
 20145                         MOVE ER-2898 TO WS-ERROR
 20146                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20147                         GO TO 7300-NEXT-CLAIM
 20148                      END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 369
* EL050.cbl
 20149                   END-IF
 20150                 END-IF
 20151              END-IF
 20152           ELSE
 20153              IF CL-DENIAL-TYPE = '1'  AND
 20154                 CL-TOTAL-PAID-AMT = 0
 20155                    GO TO 7300-NEXT-CLAIM
 20156              END-IF
 20157              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20158               AND PB-C-AH-CANCEL-DT > SPACES
 20159                 MOVE ER-2756        TO WS-ERROR
 20160                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20161                 GO TO 7300-NEXT-CLAIM
 20162              END-IF
 20163           END-IF
 20164        END-IF
 20165     ELSE
 20166*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 20167        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 20168          OR (CL-CLAIM-TYPE = 'O')
 20169           IF (CLAIM-IS-OPEN)
 20170              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 20171                 <> zeros
 20172              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 20173                 <> zeros)
 20174              MOVE ER-2889      TO WS-ERROR
 20175              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20176              GO TO 7300-NEXT-CLAIM
 20177           ELSE
 20178              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20179*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 20180                 IF (LF-COVERAGE-CANCELLED AND
 20181                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20182                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20183                         MOVE ER-2890 TO WS-ERROR
 20184                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20185                         GO TO 7300-NEXT-CLAIM
 20186                      ELSE
 20187                         MOVE ER-2898 TO WS-ERROR
 20188                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20189                         GO TO 7300-NEXT-CLAIM
 20190                      END-IF
 20191                 END-IF
 20192              ELSE
 20193                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 20194                    and (CL-TOTAL-PAID-AMT = 0)
 20195                    GO TO 7300-NEXT-CLAIM
 20196                 END-IF
 20197                 IF (
 20198                      (AH-COVERAGE-CANCELLED)
 20199                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 20200                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 20201                      and (pb-ci-ah-cancel-amt +
 20202                         pb-c-ah-cancel-amt) <> zeros
 20203                    )
 20204                               OR
 20205                    (
 20206                      (LF-COVERAGE-CANCELLED)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 370
* EL050.cbl
 20207                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
 20208                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 20209                      and (pb-ci-lf-cancel-amt +
 20210                         pb-c-lf-cancel-amt) <> zeros
 20211                    )
 20212                       IF CL-CLAIM-TYPE = 'O'
 20213                          MOVE ER-2998 TO WS-ERROR
 20214                       ELSE
 20215                          MOVE ER-2965 TO WS-ERROR
 20216                       END-IF
 20217                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20218                       GO TO 7300-NEXT-CLAIM
 20219                 END-IF
 20220                 IF LF-COVERAGE-CANCELLED
 20221                  IF CL-TOTAL-PAID-AMT > 0
 20222                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20223                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20224                        MOVE ER-2891 TO WS-ERROR
 20225                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20226                        GO TO 7300-NEXT-CLAIM
 20227                      END-IF
 20228                    ELSE
 20229****only show this error if cert num matches exactly
 20230                      IF PB-CERT-NO = CL-CERT-NO
 20231                         IF CL-CLAIM-TYPE = 'O'
 20232                            MOVE ER-2895 TO WS-ERROR
 20233                         ELSE
 20234                            MOVE ER-2892 TO WS-ERROR
 20235                         END-IF
 20236                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20237                         GO TO 7300-NEXT-CLAIM
 20238                      END-IF
 20239                    END-IF
 20240                  END-IF
 20241                 END-IF
 20242              END-IF
 20243           END-IF
 20244        END-IF
 20245     END-IF
 20246
 20247     GO TO 7300-NEXT-CLAIM.
 20248
 20249 7300-CONTINUE.
 20250
 20251     IF W-BROWSE-SW = 'Y'
 20252
 20253* EXEC CICS ENDBR
 20254*            DATASET   (CLMS-ID)
 20255*        END-EXEC.
 20256     MOVE 0
 20257       TO DFHEIV11
 20258*    MOVE '&2                    $   #00019902' TO DFHEIV0
 20259     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20260     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20261     MOVE X'2020233030303139393032' TO DFHEIV0(25:11)
 20262     CALL 'kxdfhei1' USING DFHEIV0,
 20263           CLMS-ID,
 20264           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 371
* EL050.cbl
 20265           DFHEIV99
 20266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20267
 20268
 20269 7300-EXIT.
 20270     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 372
* EL050.cbl
 20272 7320-CHECK-FOR-OPEN-CLMS-issue.
 20273
 20274     move ' '                    to w-browse-sw
 20275     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20276                                    W-CL-COMP-CD
 20277     MOVE PB-CERT-NO(1:10)       TO MSTR-CERT-NO
 20278                                    W-CL-CERT-NO
 20279
 20280
 20281* EXEC CICS HANDLE CONDITION
 20282*        NOTFND  (7320-CONTINUE)
 20283*        ENDFILE (7320-CONTINUE)
 20284*    END-EXEC.
 20285*    MOVE '"$I''                  ! + #00019917' TO DFHEIV0
 20286     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20288     MOVE X'2B20233030303139393137' TO DFHEIV0(25:11)
 20289     CALL 'kxdfhei1' USING DFHEIV0
 20290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20291
 20292
 20293
 20294* EXEC CICS IGNORE CONDITION
 20295*        DUPKEY
 20296*    END-EXEC.
 20297*    MOVE '"*$                   !   #00019922' TO DFHEIV0
 20298     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 20299     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20300     MOVE X'2020233030303139393232' TO DFHEIV0(25:11)
 20301     CALL 'kxdfhei1' USING DFHEIV0
 20302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20303
 20304
 20305
 20306* EXEC CICS STARTBR
 20307*        DATASET   (CLMS-ID)
 20308*        RIDFLD    (ELMSTR-KEY)
 20309*        GENERIC   EQUAL
 20310*        KEYLENGTH (ELMSTR-LENGTH)
 20311*    END-EXEC.
 20312     MOVE 0
 20313       TO DFHEIV11
 20314*    MOVE '&,   KG    E          &   #00019926' TO DFHEIV0
 20315     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 20316     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20317     MOVE X'2020233030303139393236' TO DFHEIV0(25:11)
 20318     CALL 'kxdfhei1' USING DFHEIV0,
 20319           CLMS-ID,
 20320           ELMSTR-KEY,
 20321           ELMSTR-LENGTH,
 20322           DFHEIV11,
 20323           DFHEIV99
 20324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20325
 20326
 20327     MOVE 'Y'                    TO W-BROWSE-SW.
 20328
 20329 7320-NEXT-CLAIM.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 373
* EL050.cbl
 20330
 20331
 20332* EXEC CICS READNEXT
 20333*        DATASET   (CLMS-ID)
 20334*        RIDFLD    (ELMSTR-KEY)
 20335*        SET       (ADDRESS OF CLAIM-MASTER)
 20336*    END-EXEC.
 20337     MOVE 0
 20338       TO DFHEIV11
 20339*    MOVE '&.S                   )   #00019937' TO DFHEIV0
 20340     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20341     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20342     MOVE X'2020233030303139393337' TO DFHEIV0(25:11)
 20343     CALL 'kxdfhei1' USING DFHEIV0,
 20344           CLMS-ID,
 20345           DFHEIV20,
 20346           DFHEIV99,
 20347           ELMSTR-KEY,
 20348           DFHEIV99,
 20349           DFHEIV11,
 20350           DFHEIV99,
 20351           DFHEIV99
 20352     SET ADDRESS OF CLAIM-MASTER TO
 20353         DFHEIV20
 20354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20355
 20356
 20357     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 20358        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 20359         GO TO 7320-CONTINUE.
 20360
 20361     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 20362        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 20363        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 20364        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 20365        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20366         GO TO 7320-NEXT-CLAIM.
 20367
 20368     IF CLAIM-IS-OPEN
 20369        MOVE ER-3273             TO WS-ERROR
 20370        PERFORM 9900-ERROR-FORMAT
 20371                                 THRU 9900-EXIT
 20372     END-IF
 20373     if pb-i-entry-status = 'V'
 20374        IF CLAIM-IS-OPEN
 20375             OR
 20376           CL-LAST-PMT-DT NOT = LOW-VALUES
 20377             OR
 20378           CL-LAST-PMT-AMT > 0
 20379           MOVE ER-3281          TO WS-ERROR
 20380           PERFORM 9900-ERROR-FORMAT
 20381                                 THRU 9900-EXIT
 20382        END-IF
 20383     END-IF
 20384
 20385     GO TO 7320-NEXT-CLAIM.
 20386
 20387 7320-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 374
* EL050.cbl
 20388
 20389     IF W-BROWSE-SW = 'Y'
 20390
 20391* EXEC CICS ENDBR
 20392*            DATASET   (CLMS-ID)
 20393*        END-EXEC.
 20394     MOVE 0
 20395       TO DFHEIV11
 20396*    MOVE '&2                    $   #00019976' TO DFHEIV0
 20397     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20398     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20399     MOVE X'2020233030303139393736' TO DFHEIV0(25:11)
 20400     CALL 'kxdfhei1' USING DFHEIV0,
 20401           CLMS-ID,
 20402           DFHEIV11,
 20403           DFHEIV99
 20404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20405
 20406
 20407 7320-EXIT.
 20408     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 375
* EL050.cbl
 20410 7400-GET-REMAIN-TERM.
 20411
 20412* EXEC CICS LINK
 20413*        PROGRAM    ('ELRTRM')
 20414*        COMMAREA   (CALCULATION-PASS-AREA)
 20415*        LENGTH     (CP-COMM-LENGTH)
 20416*    END-EXEC.
 20417     MOVE 'ELRTRM' TO DFHEIV1
 20418*    MOVE '."C                   (   #00019984' TO DFHEIV0
 20419     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20421     MOVE X'2020233030303139393834' TO DFHEIV0(25:11)
 20422     CALL 'kxdfhei1' USING DFHEIV0,
 20423           DFHEIV1,
 20424           CALCULATION-PASS-AREA,
 20425           CP-COMM-LENGTH,
 20426           DFHEIV99,
 20427           DFHEIV99,
 20428           DFHEIV99,
 20429           DFHEIV99
 20430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20431
 20432
 20433 7400-EXIT.
 20434     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 376
* EL050.cbl
 20436
 20437 7500-GET-REMAIN-AMOUNT.
 20438
 20439* EXEC CICS LINK
 20440*        PROGRAM    ('ELRAMT')
 20441*        COMMAREA   (CALCULATION-PASS-AREA)
 20442*        LENGTH     (CP-COMM-LENGTH)
 20443*    END-EXEC.
 20444     MOVE 'ELRAMT' TO DFHEIV1
 20445*    MOVE '."C                   (   #00019995' TO DFHEIV0
 20446     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20447     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20448     MOVE X'2020233030303139393935' TO DFHEIV0(25:11)
 20449     CALL 'kxdfhei1' USING DFHEIV0,
 20450           DFHEIV1,
 20451           CALCULATION-PASS-AREA,
 20452           CP-COMM-LENGTH,
 20453           DFHEIV99,
 20454           DFHEIV99,
 20455           DFHEIV99,
 20456           DFHEIV99
 20457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20458
 20459
 20460 7500-EXIT.
 20461     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 377
* EL050.cbl
 20463
 20464 7600-GET-REFUND.
 20465
 20466* EXEC CICS LINK
 20467*        PROGRAM    ('ELRFND')
 20468*        COMMAREA   (CALCULATION-PASS-AREA)
 20469*        LENGTH     (CP-COMM-LENGTH)
 20470*    END-EXEC.
 20471     MOVE 'ELRFND' TO DFHEIV1
 20472*    MOVE '."C                   (   #00020006' TO DFHEIV0
 20473     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20474     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20475     MOVE X'2020233030303230303036' TO DFHEIV0(25:11)
 20476     CALL 'kxdfhei1' USING DFHEIV0,
 20477           DFHEIV1,
 20478           CALCULATION-PASS-AREA,
 20479           CP-COMM-LENGTH,
 20480           DFHEIV99,
 20481           DFHEIV99,
 20482           DFHEIV99,
 20483           DFHEIV99
 20484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20485
 20486
 20487 7600-EXIT.
 20488     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 378
* EL050.cbl
 20490 7700-CALL-DL1.
 20491
 20492* EXEC CICS LINK
 20493*        PROGRAM    ('DLO001')
 20494*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20495*        LENGTH     (DLO001-COMM-LENGTH)
 20496*    END-EXEC.
 20497     MOVE 'DLO001' TO DFHEIV1
 20498*    MOVE '."C                   (   #00020016' TO DFHEIV0
 20499     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20500     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20501     MOVE X'2020233030303230303136' TO DFHEIV0(25:11)
 20502     CALL 'kxdfhei1' USING DFHEIV0,
 20503           DFHEIV1,
 20504           WS-DLO-MASTER-POLICY-FORM,
 20505           DLO001-COMM-LENGTH,
 20506           DFHEIV99,
 20507           DFHEIV99,
 20508           DFHEIV99,
 20509           DFHEIV99
 20510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20511
 20512
 20513 7700-EXIT.
 20514     EXIT.
 20515
 20516 7710-CALL-DL2.
 20517
 20518* EXEC CICS LINK
 20519*        PROGRAM    ('DLO002')
 20520*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20521*        LENGTH     (DLO002-COMM-LENGTH)
 20522*    END-EXEC.
 20523     MOVE 'DLO002' TO DFHEIV1
 20524*    MOVE '."C                   (   #00020026' TO DFHEIV0
 20525     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20526     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20527     MOVE X'2020233030303230303236' TO DFHEIV0(25:11)
 20528     CALL 'kxdfhei1' USING DFHEIV0,
 20529           DFHEIV1,
 20530           WS-DLO-INTERNAL-POLICY-FORM,
 20531           DLO002-COMM-LENGTH,
 20532           DFHEIV99,
 20533           DFHEIV99,
 20534           DFHEIV99,
 20535           DFHEIV99
 20536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20537
 20538
 20539 7710-EXIT.
 20540     EXIT.
 20541
 20542 7720-CALL-DL3.
 20543
 20544* EXEC CICS LINK
 20545*        PROGRAM    ('DLO003')
 20546*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20547*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 379
* EL050.cbl
 20548*    END-EXEC.
 20549     MOVE 'DLO003' TO DFHEIV1
 20550*    MOVE '."C                   (   #00020036' TO DFHEIV0
 20551     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20552     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20553     MOVE X'2020233030303230303336' TO DFHEIV0(25:11)
 20554     CALL 'kxdfhei1' USING DFHEIV0,
 20555           DFHEIV1,
 20556           WS-DLO-VALID-BANK-ID,
 20557           DLO003-COMM-LENGTH,
 20558           DFHEIV99,
 20559           DFHEIV99,
 20560           DFHEIV99,
 20561           DFHEIV99
 20562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20563
 20564
 20565 7720-EXIT.
 20566     EXIT.
 20567
 20568 7730-CALL-DL7.
 20569
 20570* EXEC CICS LINK
 20571*        PROGRAM    ('DLO007')
 20572*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20573*        LENGTH     (DLO007-COMM-LENGTH)
 20574*    END-EXEC.
 20575     MOVE 'DLO007' TO DFHEIV1
 20576*    MOVE '."C                   (   #00020046' TO DFHEIV0
 20577     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20578     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20579     MOVE X'2020233030303230303436' TO DFHEIV0(25:11)
 20580     CALL 'kxdfhei1' USING DFHEIV0,
 20581           DFHEIV1,
 20582           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20583           DLO007-COMM-LENGTH,
 20584           DFHEIV99,
 20585           DFHEIV99,
 20586           DFHEIV99,
 20587           DFHEIV99
 20588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20589
 20590
 20591 7730-EXIT.
 20592     EXIT.
 20593
 20594 7740-CALL-DL11.
 20595
 20596* EXEC CICS LINK
 20597*        PROGRAM    ('DLO011')
 20598*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20599*        LENGTH     (DLO011-COMM-LENGTH)
 20600*    END-EXEC.
 20601     MOVE 'DLO011' TO DFHEIV1
 20602*    MOVE '."C                   (   #00020056' TO DFHEIV0
 20603     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20604     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20605     MOVE X'2020233030303230303536' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 380
* EL050.cbl
 20606     CALL 'kxdfhei1' USING DFHEIV0,
 20607           DFHEIV1,
 20608           WS-DLO-PREM-RATES-BEN-TYPE,
 20609           DLO011-COMM-LENGTH,
 20610           DFHEIV99,
 20611           DFHEIV99,
 20612           DFHEIV99,
 20613           DFHEIV99
 20614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20615
 20616
 20617 7740-EXIT.
 20618     EXIT.
 20619
 20620 7750-CALL-DL17.
 20621
 20622* EXEC CICS LINK
 20623*        PROGRAM    ('DLO017')
 20624*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20625*        LENGTH     (DLO017-COMM-LENGTH)
 20626*    END-EXEC.
 20627     MOVE 'DLO017' TO DFHEIV1
 20628*    MOVE '."C                   (   #00020066' TO DFHEIV0
 20629     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20630     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20631     MOVE X'2020233030303230303636' TO DFHEIV0(25:11)
 20632     CALL 'kxdfhei1' USING DFHEIV0,
 20633           DFHEIV1,
 20634           WS-DLO-VALID-RATE-CODE,
 20635           DLO017-COMM-LENGTH,
 20636           DFHEIV99,
 20637           DFHEIV99,
 20638           DFHEIV99,
 20639           DFHEIV99
 20640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20641
 20642
 20643 7750-EXIT.
 20644     EXIT.
 20645
 20646 7755-CALL-DL19.
 20647
 20648* EXEC CICS LINK
 20649*        PROGRAM    ('DLO019')
 20650*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20651*        LENGTH     (DLO019-COMM-LENGTH)
 20652*    END-EXEC.
 20653     MOVE 'DLO019' TO DFHEIV1
 20654*    MOVE '."C                   (   #00020076' TO DFHEIV0
 20655     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20656     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20657     MOVE X'2020233030303230303736' TO DFHEIV0(25:11)
 20658     CALL 'kxdfhei1' USING DFHEIV0,
 20659           DFHEIV1,
 20660           WS-DLO-ORIG-COV-CAT,
 20661           DLO019-COMM-LENGTH,
 20662           DFHEIV99,
 20663           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 381
* EL050.cbl
 20664           DFHEIV99,
 20665           DFHEIV99
 20666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20667
 20668
 20669 7755-EXIT.
 20670     EXIT.
 20671
 20672 7760-CALL-DL21.
 20673
 20674* EXEC CICS LINK
 20675*        PROGRAM    ('DLO021')
 20676*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20677*        LENGTH     (DLO021-COMM-LENGTH)
 20678*    END-EXEC.
 20679     MOVE 'DLO021' TO DFHEIV1
 20680*    MOVE '."C                   (   #00020086' TO DFHEIV0
 20681     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20682     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20683     MOVE X'2020233030303230303836' TO DFHEIV0(25:11)
 20684     CALL 'kxdfhei1' USING DFHEIV0,
 20685           DFHEIV1,
 20686           WS-DLO-VALID-LOAN-OFFICER,
 20687           DLO021-COMM-LENGTH,
 20688           DFHEIV99,
 20689           DFHEIV99,
 20690           DFHEIV99,
 20691           DFHEIV99
 20692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20693
 20694
 20695 7760-EXIT.
 20696     EXIT.
 20697
 20698 7770-CALL-DL22.
 20699
 20700* EXEC CICS LINK
 20701*        PROGRAM    ('DLO022')
 20702*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20703*        LENGTH     (DLO022-COMM-LENGTH)
 20704*    END-EXEC.
 20705     MOVE 'DLO022' TO DFHEIV1
 20706*    MOVE '."C                   (   #00020096' TO DFHEIV0
 20707     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20708     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20709     MOVE X'2020233030303230303936' TO DFHEIV0(25:11)
 20710     CALL 'kxdfhei1' USING DFHEIV0,
 20711           DFHEIV1,
 20712           WS-DLO-VALID-STATE-CODE,
 20713           DLO022-COMM-LENGTH,
 20714           DFHEIV99,
 20715           DFHEIV99,
 20716           DFHEIV99,
 20717           DFHEIV99
 20718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20719
 20720
 20721 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 382
* EL050.cbl
 20722     EXIT.
 20723
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 383
* EL050.cbl
 20725
 20726 7780-CALL-AGG.
 20727
 20728* EXEC CICS LINK
 20729*        PROGRAM    ('ELAGGO')
 20730*        COMMAREA   (WS-PASS-to-pemaggo)
 20731*        LENGTH     (ws-passed-key-LENGTH)
 20732*    END-EXEC.
 20733     MOVE 'ELAGGO' TO DFHEIV1
 20734*    MOVE '."C                   (   #00020108' TO DFHEIV0
 20735     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20736     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20737     MOVE X'2020233030303230313038' TO DFHEIV0(25:11)
 20738     CALL 'kxdfhei1' USING DFHEIV0,
 20739           DFHEIV1,
 20740           WS-PASS-to-pemaggo,
 20741           ws-passed-key-LENGTH,
 20742           DFHEIV99,
 20743           DFHEIV99,
 20744           DFHEIV99,
 20745           DFHEIV99
 20746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20747
 20748 7780-EXIT.
 20749     EXIT.
 20750 7785-CALL-HLDI.
 20751
 20752* EXEC CICS LINK
 20753*        PROGRAM    ('ELHLDI')
 20754*        COMMAREA   (HLDI-PASS-AREA)
 20755*        LENGTH     (HLDI-PASS-AREA-LEN)
 20756*    END-EXEC.
 20757     MOVE 'ELHLDI' TO DFHEIV1
 20758*    MOVE '."C                   (   #00020116' TO DFHEIV0
 20759     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20760     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20761     MOVE X'2020233030303230313136' TO DFHEIV0(25:11)
 20762     CALL 'kxdfhei1' USING DFHEIV0,
 20763           DFHEIV1,
 20764           HLDI-PASS-AREA,
 20765           HLDI-PASS-AREA-LEN,
 20766           DFHEIV99,
 20767           DFHEIV99,
 20768           DFHEIV99,
 20769           DFHEIV99
 20770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20771
 20772 7785-EXIT.
 20773     EXIT.
 20774 7786-CALL-HLDIM.
 20775
 20776* EXEC CICS LINK
 20777*        PROGRAM    ('ELHLDIM')
 20778*        COMMAREA   (HLDI-PASS-AREA)
 20779*        LENGTH     (HLDI-PASS-AREA-LEN)
 20780*    END-EXEC.
 20781     MOVE 'ELHLDIM' TO DFHEIV1
 20782*    MOVE '."C                   (   #00020124' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 384
* EL050.cbl
 20783     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20784     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20785     MOVE X'2020233030303230313234' TO DFHEIV0(25:11)
 20786     CALL 'kxdfhei1' USING DFHEIV0,
 20787           DFHEIV1,
 20788           HLDI-PASS-AREA,
 20789           HLDI-PASS-AREA-LEN,
 20790           DFHEIV99,
 20791           DFHEIV99,
 20792           DFHEIV99,
 20793           DFHEIV99
 20794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20795
 20796 7786-EXIT.
 20797     EXIT.
 20798 7790-CALL-ZIP-VERIFY.
 20799
 20800
 20801* EXEC CICS LINK
 20802*        PROGRAM    ('WSZIPCD')
 20803*        COMMAREA   (ZIPCD-PASS-AREA)
 20804*        LENGTH     (ZIPCD-PASS-AREA-LEN)
 20805*    END-EXEC.
 20806     MOVE 'WSZIPCD' TO DFHEIV1
 20807*    MOVE '."C                   (   #00020133' TO DFHEIV0
 20808     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20809     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20810     MOVE X'2020233030303230313333' TO DFHEIV0(25:11)
 20811     CALL 'kxdfhei1' USING DFHEIV0,
 20812           DFHEIV1,
 20813           ZIPCD-PASS-AREA,
 20814           ZIPCD-PASS-AREA-LEN,
 20815           DFHEIV99,
 20816           DFHEIV99,
 20817           DFHEIV99,
 20818           DFHEIV99
 20819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20820
 20821
 20822 7790-EXIT.
 20823     EXIT.
 20824 7795-call-sqlclmhs.
 20825
 20826
 20827* EXEC CICS LINK
 20828*        PROGRAM    ('SQLCLMHS')
 20829*        COMMAREA   (clmhs-PASS-AREA)
 20830*        LENGTH     (clmhs-PASS-AREA-LEN)
 20831*    END-EXEC.
 20832     MOVE 'SQLCLMHS' TO DFHEIV1
 20833*    MOVE '."C                   (   #00020143' TO DFHEIV0
 20834     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20835     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20836     MOVE X'2020233030303230313433' TO DFHEIV0(25:11)
 20837     CALL 'kxdfhei1' USING DFHEIV0,
 20838           DFHEIV1,
 20839           clmhs-PASS-AREA,
 20840           clmhs-PASS-AREA-LEN,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 385
* EL050.cbl
 20841           DFHEIV99,
 20842           DFHEIV99,
 20843           DFHEIV99,
 20844           DFHEIV99
 20845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20846
 20847
 20848 7795-EXIT.
 20849     EXIT.
 20850 7800-REWRITE-CERT.
 20851******************************************************************
 20852*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20853*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20854******************************************************************
 20855
 20856     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20857        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20858        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20859        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20860
 20861* EXEC CICS REWRITE
 20862*                  DATASET (CERT-ID)
 20863*                  FROM    (CERTIFICATE-MASTER)
 20864*              END-EXEC
 20865     MOVE LENGTH OF
 20866      CERTIFICATE-MASTER
 20867       TO DFHEIV11
 20868*    MOVE '&& L                  %   #00020161' TO DFHEIV0
 20869     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20870     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20871     MOVE X'2020233030303230313631' TO DFHEIV0(25:11)
 20872     CALL 'kxdfhei1' USING DFHEIV0,
 20873           CERT-ID,
 20874           CERTIFICATE-MASTER,
 20875           DFHEIV11,
 20876           DFHEIV99
 20877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20878        GO TO 7800-EXIT.
 20879
 20880       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20881       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20882
 20883 7800-EXIT.
 20884      EXIT.
 20885
 20886 7900-DELETE-CERT.
 20887
 20888* EXEC CICS DELETE
 20889*        DATASET (CERT-ID)
 20890*    END-EXEC.
 20891*    MOVE '&(                    &   #00020174' TO DFHEIV0
 20892     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 20893     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20894     MOVE X'2020233030303230313734' TO DFHEIV0(25:11)
 20895     CALL 'kxdfhei1' USING DFHEIV0,
 20896           CERT-ID,
 20897           DFHEIV99,
 20898           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 386
* EL050.cbl
 20899           DFHEIV99,
 20900           DFHEIV99
 20901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20902
 20903
 20904 7900-EXIT.
 20905     EXIT.
 20906
 20907 8000-WRITE-CERT.
 20908
 20909* EXEC CICS HANDLE CONDITION
 20910*        DUPKEY    (8000-FREE-MAIN)
 20911*    END-EXEC.
 20912*    MOVE '"$$                   ! , #00020182' TO DFHEIV0
 20913     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20914     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20915     MOVE X'2C20233030303230313832' TO DFHEIV0(25:11)
 20916     CALL 'kxdfhei1' USING DFHEIV0
 20917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20918
 20919
 20920
 20921* EXEC CICS WRITE
 20922*        DATASET     (CERT-ID)
 20923*        FROM        (CERTIFICATE-MASTER)
 20924*        RIDFLD      (ELCERT-KEY)
 20925*    END-EXEC.
 20926     MOVE LENGTH OF
 20927      CERTIFICATE-MASTER
 20928       TO DFHEIV11
 20929*    MOVE '&$ L                  ''   #00020186' TO DFHEIV0
 20930     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20931     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20932     MOVE X'2020233030303230313836' TO DFHEIV0(25:11)
 20933     CALL 'kxdfhei1' USING DFHEIV0,
 20934           CERT-ID,
 20935           CERTIFICATE-MASTER,
 20936           DFHEIV11,
 20937           ELCERT-KEY,
 20938           DFHEIV99,
 20939           DFHEIV99
 20940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20941
 20942
 20943 8000-FREE-MAIN.
 20944
 20945 8000-EXIT.
 20946      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 387
* EL050.cbl
 20948
 20949 8100-READ-ERPNDM.
 20950
 20951* EXEC CICS HANDLE CONDITION
 20952*         NOTFND     (8100-NOTFND)
 20953*         ENDFILE    (8100-NOTFND)
 20954*    END-EXEC.
 20955*    MOVE '"$I''                  ! - #00020199' TO DFHEIV0
 20956     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20957     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20958     MOVE X'2D20233030303230313939' TO DFHEIV0(25:11)
 20959     CALL 'kxdfhei1' USING DFHEIV0
 20960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20961
 20962
 20963     MOVE SPACES                 TO ERPNDM-FOUND.
 20964     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20965
 20966
 20967* EXEC CICS READ UPDATE
 20968*         DATASET   (FILE-ERPNDM)
 20969*         RIDFLD    (PM-CONTROL-PRIMARY)
 20970*         INTO      (PENDING-MAILING-DATA)
 20971*    END-EXEC.
 20972     MOVE LENGTH OF
 20973      PENDING-MAILING-DATA
 20974       TO DFHEIV11
 20975*    MOVE '&"IL       EU         (   #00020207' TO DFHEIV0
 20976     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20977     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20978     MOVE X'2020233030303230323037' TO DFHEIV0(25:11)
 20979     CALL 'kxdfhei1' USING DFHEIV0,
 20980           FILE-ERPNDM,
 20981           PENDING-MAILING-DATA,
 20982           DFHEIV11,
 20983           PM-CONTROL-PRIMARY,
 20984           DFHEIV99,
 20985           DFHEIV99,
 20986           DFHEIV99
 20987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20988
 20989
 20990     GO TO 8100-EXIT.
 20991
 20992 8100-NOTFND.
 20993
 20994     MOVE 'X'                    TO ERPNDM-FOUND.
 20995     MOVE ER-2694                TO WS-ERROR.
 20996     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20997     MOVE ER-2883                TO WS-ERROR
 20998     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20999     .
 21000 8100-EXIT.
 21001     EXIT.
 21002 8102-REWRITE-ERPNDM.
 21003
 21004
 21005* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 388
* EL050.cbl
 21006*         DATASET    (FILE-ERPNDM)
 21007*         FROM       (PENDING-MAILING-DATA)
 21008*    END-EXEC
 21009     MOVE LENGTH OF
 21010      PENDING-MAILING-DATA
 21011       TO DFHEIV11
 21012*    MOVE '&& L                  %   #00020227' TO DFHEIV0
 21013     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21014     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21015     MOVE X'2020233030303230323237' TO DFHEIV0(25:11)
 21016     CALL 'kxdfhei1' USING DFHEIV0,
 21017           FILE-ERPNDM,
 21018           PENDING-MAILING-DATA,
 21019           DFHEIV11,
 21020           DFHEIV99
 21021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21022
 21023     .
 21024 8102-EXIT.
 21025     EXIT.
 21026 8104-UNLOCK-ERPNDM.
 21027
 21028
 21029* EXEC CICS UNLOCK
 21030*         DATASET   (FILE-ERPNDM)
 21031*    END-EXEC
 21032*    MOVE '&*                    #   #00020237' TO DFHEIV0
 21033     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21034     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21035     MOVE X'2020233030303230323337' TO DFHEIV0(25:11)
 21036     CALL 'kxdfhei1' USING DFHEIV0,
 21037           FILE-ERPNDM,
 21038           DFHEIV99
 21039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21040
 21041     .
 21042 8104-EXIT.
 21043     EXIT.
 21044 8110-READ-ERMAIL.
 21045
 21046* EXEC CICS HANDLE CONDITION
 21047*         NOTFND     (8110-NOTFND)
 21048*         ENDFILE    (8110-NOTFND)
 21049*    END-EXEC.
 21050*    MOVE '"$I''                  ! . #00020245' TO DFHEIV0
 21051     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21052     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21053     MOVE X'2E20233030303230323435' TO DFHEIV0(25:11)
 21054     CALL 'kxdfhei1' USING DFHEIV0
 21055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21056
 21057
 21058     MOVE SPACES                 TO ERMAIL-FOUND.
 21059     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 21060     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 21061     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 21062     MOVE PB-SV-STATE            TO MA-STATE.
 21063
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 389
* EL050.cbl
 21064
 21065* EXEC CICS READ
 21066*         UPDATE
 21067*         DATASET   (FILE-ERMAIL)
 21068*         RIDFLD    (MA-CONTROL-PRIMARY)
 21069*         INTO      (MAILING-DATA)
 21070*    END-EXEC.
 21071     MOVE LENGTH OF
 21072      MAILING-DATA
 21073       TO DFHEIV11
 21074*    MOVE '&"IL       EU         (   #00020256' TO DFHEIV0
 21075     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21076     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21077     MOVE X'2020233030303230323536' TO DFHEIV0(25:11)
 21078     CALL 'kxdfhei1' USING DFHEIV0,
 21079           FILE-ERMAIL,
 21080           MAILING-DATA,
 21081           DFHEIV11,
 21082           MA-CONTROL-PRIMARY,
 21083           DFHEIV99,
 21084           DFHEIV99,
 21085           DFHEIV99
 21086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21087
 21088
 21089     GO TO 8110-EXIT.
 21090
 21091 8110-NOTFND.
 21092     MOVE 'X'                    TO ERMAIL-FOUND.
 21093
 21094 8110-EXIT.
 21095     EXIT.
 21096
 21097 8120-REWRITE-ERMAIL.
 21098
 21099* EXEC CICS REWRITE
 21100*         DATASET    (FILE-ERMAIL)
 21101*         FROM       (MAILING-DATA)
 21102*    END-EXEC.
 21103     MOVE LENGTH OF
 21104      MAILING-DATA
 21105       TO DFHEIV11
 21106*    MOVE '&& L                  %   #00020272' TO DFHEIV0
 21107     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21108     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21109     MOVE X'2020233030303230323732' TO DFHEIV0(25:11)
 21110     CALL 'kxdfhei1' USING DFHEIV0,
 21111           FILE-ERMAIL,
 21112           MAILING-DATA,
 21113           DFHEIV11,
 21114           DFHEIV99
 21115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21116
 21117
 21118 8120-EXIT.
 21119     EXIT.
 21120
 21121 8130-WRITE-ERMAIL.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 390
* EL050.cbl
 21122
 21123* EXEC CICS HANDLE CONDITION
 21124*         DUPKEY   (8130-EXIT)
 21125*    END-EXEC.
 21126*    MOVE '"$$                   ! / #00020281' TO DFHEIV0
 21127     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 21128     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21129     MOVE X'2F20233030303230323831' TO DFHEIV0(25:11)
 21130     CALL 'kxdfhei1' USING DFHEIV0
 21131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21132
 21133
 21134
 21135* EXEC CICS WRITE
 21136*         DATASET     (FILE-ERMAIL)
 21137*         RIDFLD      (MA-CONTROL-PRIMARY)
 21138*         FROM        (MAILING-DATA)
 21139*    END-EXEC.
 21140     MOVE LENGTH OF
 21141      MAILING-DATA
 21142       TO DFHEIV11
 21143*    MOVE '&$ L                  ''   #00020285' TO DFHEIV0
 21144     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21145     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21146     MOVE X'2020233030303230323835' TO DFHEIV0(25:11)
 21147     CALL 'kxdfhei1' USING DFHEIV0,
 21148           FILE-ERMAIL,
 21149           MAILING-DATA,
 21150           DFHEIV11,
 21151           MA-CONTROL-PRIMARY,
 21152           DFHEIV99,
 21153           DFHEIV99
 21154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21155
 21156
 21157 8130-EXIT.
 21158     EXIT.
 21159
 21160 8140-UNLOCK-ERMAIL.
 21161
 21162* EXEC CICS UNLOCK
 21163*         DATASET   (FILE-ERMAIL)
 21164*    END-EXEC.
 21165*    MOVE '&*                    #   #00020295' TO DFHEIV0
 21166     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21167     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21168     MOVE X'2020233030303230323935' TO DFHEIV0(25:11)
 21169     CALL 'kxdfhei1' USING DFHEIV0,
 21170           FILE-ERMAIL,
 21171           DFHEIV99
 21172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21173
 21174
 21175 8140-EXIT.
 21176     EXIT.
 21177
 21178 8145-read-elcrtt-upd.
 21179
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 391
* EL050.cbl
 21180     move ' '                    to elcrtt-found-sw
 21181                                    elcrtt-update-sw
 21182
 21183* EXEC CICS HANDLE CONDITION
 21184*        NOTFND   (8145-exit)
 21185*    END-EXEC
 21186*    MOVE '"$I                   ! 0 #00020306' TO DFHEIV0
 21187     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21188     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21189     MOVE X'3020233030303230333036' TO DFHEIV0(25:11)
 21190     CALL 'kxdfhei1' USING DFHEIV0
 21191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21192
 21193     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21194     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21195
 21196
 21197* EXEC CICS READ UPDATE
 21198*        DATASET  (CRTT-ID)
 21199*        RIDFLD   (WS-ELCRTT-KEY)
 21200*        INTO     (CERTIFICATE-TRAILERS)
 21201*    END-EXEC
 21202     MOVE LENGTH OF
 21203      CERTIFICATE-TRAILERS
 21204       TO DFHEIV11
 21205*    MOVE '&"IL       EU         (   #00020313' TO DFHEIV0
 21206     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21207     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21208     MOVE X'2020233030303230333133' TO DFHEIV0(25:11)
 21209     CALL 'kxdfhei1' USING DFHEIV0,
 21210           CRTT-ID,
 21211           CERTIFICATE-TRAILERS,
 21212           DFHEIV11,
 21213           WS-ELCRTT-KEY,
 21214           DFHEIV99,
 21215           DFHEIV99,
 21216           DFHEIV99
 21217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21218
 21219     set elcrtt-found to true
 21220
 21221     .
 21222 8145-exit.
 21223     exit.
 21224 8150-UPDATE-ELCRTT.
 21225
 21226     if elcrtt-found
 21227
 21228* EXEC CICS REWRITE
 21229*           DATASET  (CRTT-ID)
 21230*           FROM     (CERTIFICATE-TRAILERS)
 21231*        END-EXEC
 21232     MOVE LENGTH OF
 21233      CERTIFICATE-TRAILERS
 21234       TO DFHEIV11
 21235*    MOVE '&& L                  %   #00020327' TO DFHEIV0
 21236     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21237     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 392
* EL050.cbl
 21238     MOVE X'2020233030303230333237' TO DFHEIV0(25:11)
 21239     CALL 'kxdfhei1' USING DFHEIV0,
 21240           CRTT-ID,
 21241           CERTIFICATE-TRAILERS,
 21242           DFHEIV11,
 21243           DFHEIV99
 21244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21245     ELSE
 21246
 21247* EXEC CICS WRITE
 21248*          DATASET  (CRTT-ID)
 21249*          RIDFLD   (WS-ELCRTT-KEY)
 21250*          FROM     (CERTIFICATE-TRAILERS)
 21251*       END-EXEC
 21252     MOVE LENGTH OF
 21253      CERTIFICATE-TRAILERS
 21254       TO DFHEIV11
 21255*    MOVE '&$ L                  ''   #00020332' TO DFHEIV0
 21256     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21257     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21258     MOVE X'2020233030303230333332' TO DFHEIV0(25:11)
 21259     CALL 'kxdfhei1' USING DFHEIV0,
 21260           CRTT-ID,
 21261           CERTIFICATE-TRAILERS,
 21262           DFHEIV11,
 21263           WS-ELCRTT-KEY,
 21264           DFHEIV99,
 21265           DFHEIV99
 21266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21267     end-if
 21268
 21269     .
 21270 8150-EXIT.
 21271     EXIT.
 21272
 21273 8155-unlock-elcrtt.
 21274
 21275
 21276* EXEC CICS UNLOCK
 21277*       DATASET  (CRTT-ID)
 21278*    END-EXEC
 21279*    MOVE '&*                    #   #00020345' TO DFHEIV0
 21280     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21281     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21282     MOVE X'2020233030303230333435' TO DFHEIV0(25:11)
 21283     CALL 'kxdfhei1' USING DFHEIV0,
 21284           CRTT-ID,
 21285           DFHEIV99
 21286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21287
 21288     .
 21289 8155-exit.
 21290     exit.
 21291
 21292 8190-UPDATE-REFUND-CLAIM-FLAG.
 21293
 21294* EXEC CICS HANDLE CONDITION
 21295*        NOTFND   (8190-NOTFND)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 393
* EL050.cbl
 21296*    END-EXEC.
 21297*    MOVE '"$I                   ! 1 #00020354' TO DFHEIV0
 21298     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21299     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21300     MOVE X'3120233030303230333534' TO DFHEIV0(25:11)
 21301     CALL 'kxdfhei1' USING DFHEIV0
 21302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21303
 21304
 21305     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21306     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21307
 21308
 21309* EXEC CICS READ
 21310*        UPDATE
 21311*        DATASET  (CRTT-ID)
 21312*        RIDFLD   (WS-ELCRTT-KEY)
 21313*        INTO     (CERTIFICATE-TRAILERS)
 21314*    END-EXEC.
 21315     MOVE LENGTH OF
 21316      CERTIFICATE-TRAILERS
 21317       TO DFHEIV11
 21318*    MOVE '&"IL       EU         (   #00020361' TO DFHEIV0
 21319     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21320     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21321     MOVE X'2020233030303230333631' TO DFHEIV0(25:11)
 21322     CALL 'kxdfhei1' USING DFHEIV0,
 21323           CRTT-ID,
 21324           CERTIFICATE-TRAILERS,
 21325           DFHEIV11,
 21326           WS-ELCRTT-KEY,
 21327           DFHEIV99,
 21328           DFHEIV99,
 21329           DFHEIV99
 21330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21331
 21332
 21333     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21334
 21335* EXEC CICS REWRITE
 21336*       DATASET  (CRTT-ID)
 21337*       FROM     (CERTIFICATE-TRAILERS)
 21338*    END-EXEC.
 21339     MOVE LENGTH OF
 21340      CERTIFICATE-TRAILERS
 21341       TO DFHEIV11
 21342*    MOVE '&& L                  %   #00020369' TO DFHEIV0
 21343     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21344     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21345     MOVE X'2020233030303230333639' TO DFHEIV0(25:11)
 21346     CALL 'kxdfhei1' USING DFHEIV0,
 21347           CRTT-ID,
 21348           CERTIFICATE-TRAILERS,
 21349           DFHEIV11,
 21350           DFHEIV99
 21351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21352
 21353
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 394
* EL050.cbl
 21354     GO TO 8190-EXIT.
 21355
 21356 8190-NOTFND.
 21357
 21358     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21359     MOVE 'CS'         TO CS-RECORD-ID.
 21360     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21361     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21362     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21363     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21364
 21365* EXEC CICS WRITE
 21366*       DATASET  (CRTT-ID)
 21367*       RIDFLD   (WS-ELCRTT-KEY)
 21368*       FROM     (CERTIFICATE-TRAILERS)
 21369*    END-EXEC.
 21370     MOVE LENGTH OF
 21371      CERTIFICATE-TRAILERS
 21372       TO DFHEIV11
 21373*    MOVE '&$ L                  ''   #00020384' TO DFHEIV0
 21374     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21375     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21376     MOVE X'2020233030303230333834' TO DFHEIV0(25:11)
 21377     CALL 'kxdfhei1' USING DFHEIV0,
 21378           CRTT-ID,
 21379           CERTIFICATE-TRAILERS,
 21380           DFHEIV11,
 21381           WS-ELCRTT-KEY,
 21382           DFHEIV99,
 21383           DFHEIV99
 21384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21385
 21386
 21387 8190-EXIT.
 21388     EXIT.
 21389
 21390 8195-UPDATE-AGE-FLAGS.
 21391
 21392* EXEC CICS HANDLE CONDITION
 21393*        NOTFND   (8195-NOTFND)
 21394*    END-EXEC.
 21395*    MOVE '"$I                   ! 2 #00020394' TO DFHEIV0
 21396     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21397     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21398     MOVE X'3220233030303230333934' TO DFHEIV0(25:11)
 21399     CALL 'kxdfhei1' USING DFHEIV0
 21400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21401
 21402
 21403     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21404     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21405
 21406
 21407* EXEC CICS READ
 21408*        UPDATE
 21409*        DATASET  (CRTT-ID)
 21410*        RIDFLD   (WS-ELCRTT-KEY)
 21411*        INTO     (CERTIFICATE-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 395
* EL050.cbl
 21412*    END-EXEC.
 21413     MOVE LENGTH OF
 21414      CERTIFICATE-TRAILERS
 21415       TO DFHEIV11
 21416*    MOVE '&"IL       EU         (   #00020401' TO DFHEIV0
 21417     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21418     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21419     MOVE X'2020233030303230343031' TO DFHEIV0(25:11)
 21420     CALL 'kxdfhei1' USING DFHEIV0,
 21421           CRTT-ID,
 21422           CERTIFICATE-TRAILERS,
 21423           DFHEIV11,
 21424           WS-ELCRTT-KEY,
 21425           DFHEIV99,
 21426           DFHEIV99,
 21427           DFHEIV99
 21428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21429
 21430
 21431     IF WS-INS-AGE-SET = 'Y'
 21432        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21433     END-IF
 21434     IF WS-JNT-AGE-SET = 'Y'
 21435        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21436     END-IF
 21437
 21438
 21439* EXEC CICS REWRITE
 21440*       DATASET  (CRTT-ID)
 21441*       FROM     (CERTIFICATE-TRAILERS)
 21442*    END-EXEC.
 21443     MOVE LENGTH OF
 21444      CERTIFICATE-TRAILERS
 21445       TO DFHEIV11
 21446*    MOVE '&& L                  %   #00020415' TO DFHEIV0
 21447     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21448     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21449     MOVE X'2020233030303230343135' TO DFHEIV0(25:11)
 21450     CALL 'kxdfhei1' USING DFHEIV0,
 21451           CRTT-ID,
 21452           CERTIFICATE-TRAILERS,
 21453           DFHEIV11,
 21454           DFHEIV99
 21455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21456
 21457
 21458     GO TO 8195-EXIT.
 21459
 21460 8195-NOTFND.
 21461
 21462     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21463     MOVE 'CS'         TO CS-RECORD-ID.
 21464     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21465     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21466     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21467     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21468     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21469
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 396
* EL050.cbl
 21470* EXEC CICS WRITE
 21471*       DATASET  (CRTT-ID)
 21472*       RIDFLD   (WS-ELCRTT-KEY)
 21473*       FROM     (CERTIFICATE-TRAILERS)
 21474*    END-EXEC.
 21475     MOVE LENGTH OF
 21476      CERTIFICATE-TRAILERS
 21477       TO DFHEIV11
 21478*    MOVE '&$ L                  ''   #00020431' TO DFHEIV0
 21479     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21480     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21481     MOVE X'2020233030303230343331' TO DFHEIV0(25:11)
 21482     CALL 'kxdfhei1' USING DFHEIV0,
 21483           CRTT-ID,
 21484           CERTIFICATE-TRAILERS,
 21485           DFHEIV11,
 21486           WS-ELCRTT-KEY,
 21487           DFHEIV99,
 21488           DFHEIV99
 21489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21490
 21491
 21492 8195-EXIT.
 21493     EXIT.
 21494
 21495 8200-READ-REIN-TABLE.
 21496
 21497* EXEC CICS HANDLE CONDITION
 21498*         NOTFND   (8200-NOTFND)
 21499*    END-EXEC.
 21500*    MOVE '"$I                   ! 3 #00020441' TO DFHEIV0
 21501     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21502     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21503     MOVE X'3320233030303230343431' TO DFHEIV0(25:11)
 21504     CALL 'kxdfhei1' USING DFHEIV0
 21505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21506
 21507
 21508
 21509* EXEC CICS READ
 21510*        DATASET     (REIN-ID)
 21511*        SET         (ADDRESS OF REINSURANCE-RECORD)
 21512*        RIDFLD      (ERREIN-KEY)
 21513*    END-EXEC.
 21514*    MOVE '&"S        E          (   #00020445' TO DFHEIV0
 21515     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21516     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21517     MOVE X'2020233030303230343435' TO DFHEIV0(25:11)
 21518     CALL 'kxdfhei1' USING DFHEIV0,
 21519           REIN-ID,
 21520           DFHEIV20,
 21521           DFHEIV99,
 21522           ERREIN-KEY,
 21523           DFHEIV99,
 21524           DFHEIV99,
 21525           DFHEIV99
 21526     SET ADDRESS OF REINSURANCE-RECORD TO
 21527         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 397
* EL050.cbl
 21528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21529
 21530
 21531     GO TO 8200-EXIT.
 21532
 21533 8200-NOTFND.
 21534     MOVE 'N'             TO WS-REIN-READ-SW.
 21535
 21536 8200-EXIT.
 21537      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 398
* EL050.cbl
 21539
 21540 8300-READ-CTBL-TABLE.
 21541
 21542* EXEC CICS HANDLE CONDITION
 21543*        NOTFND    (8300-NOTFND)
 21544*        DISABLED  (8300-ERRESS-PROBLEM)
 21545*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21546*        ENDFILE   (8300-NOTFND)
 21547*    END-EXEC.
 21548*    MOVE '"$IcJ''                ! 4 #00020461' TO DFHEIV0
 21549     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21550     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21551     MOVE X'3420233030303230343631' TO DFHEIV0(25:11)
 21552     CALL 'kxdfhei1' USING DFHEIV0
 21553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21554
 21555
 21556
 21557* EXEC CICS READ
 21558*        DATASET     (CTBL-ID)
 21559*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21560*        RIDFLD      (ERCTBL-KEY)
 21561*    END-EXEC.
 21562*    MOVE '&"S        E          (   #00020468' TO DFHEIV0
 21563     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21564     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21565     MOVE X'2020233030303230343638' TO DFHEIV0(25:11)
 21566     CALL 'kxdfhei1' USING DFHEIV0,
 21567           CTBL-ID,
 21568           DFHEIV20,
 21569           DFHEIV99,
 21570           ERCTBL-KEY,
 21571           DFHEIV99,
 21572           DFHEIV99,
 21573           DFHEIV99
 21574     SET ADDRESS OF COMM-TABLE-RECORD TO
 21575         DFHEIV20
 21576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21577
 21578
 21579     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21580
 21581     GO TO 8300-EXIT.
 21582
 21583 8300-NOTFND.
 21584
 21585     IF CTBL-SW = '0530'
 21586         MOVE 'AA'                     TO WS-AH-COMP-CD
 21587         MOVE '0550'                   TO CTBL-SW
 21588         MOVE '1'                      TO WS-CTBL-READ-SW
 21589         GO TO 8300-EXIT.
 21590
 21591     IF CTBL-SW = '0540'
 21592         MOVE 'AA'                     TO WS-LF-COMP-CD
 21593         MOVE '0550'                   TO CTBL-SW
 21594         MOVE '1'                      TO WS-CTBL-READ-SW
 21595         GO TO 8300-EXIT.
 21596
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 399
* EL050.cbl
 21597     IF CTBL-SW = '0550'
 21598         MOVE '2'                      TO WS-CTBL-READ-SW
 21599         GO TO 8300-EXIT.
 21600
 21601     GO TO 8300-EXIT.
 21602
 21603 8300-ERRESS-PROBLEM.
 21604
 21605      MOVE ER-8050              TO WS-ERROR.
 21606      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21607
 21608     GO TO 8300-EXIT.
 21609
 21610 8300-EXIT.
 21611      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 400
* EL050.cbl
 21613
 21614
 21615 8400-GETMAIN-ERFORM.
 21616
 21617
 21618* EXEC CICS   GETMAIN
 21619*        LENGTH  (500)
 21620*        SET     (ADDRESS OF FORM-MASTER)
 21621*    END-EXEC.
 21622     MOVE 500
 21623       TO DFHEIV11
 21624*    MOVE '," L                  $   #00020512' TO DFHEIV0
 21625     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21626     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21627     MOVE X'2020233030303230353132' TO DFHEIV0(25:11)
 21628     CALL 'kxdfhei1' USING DFHEIV0,
 21629           DFHEIV20,
 21630           DFHEIV11,
 21631           DFHEIV99
 21632     SET ADDRESS OF FORM-MASTER TO
 21633         DFHEIV20
 21634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21635
 21636
 21637     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21638
 21639 8400-EXIT.
 21640      EXIT.
 21641
 21642 8450-READ-FORM-MASTER.
 21643
 21644
 21645* EXEC CICS  HANDLE CONDITION
 21646*        NOTFND   (8450-FORM-NOT-FOUND)
 21647*        ENDFILE  (8450-FORM-NOT-FOUND)
 21648*    END-EXEC.
 21649*    MOVE '"$I''                  ! 5 #00020524' TO DFHEIV0
 21650     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21651     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21652     MOVE X'3520233030303230353234' TO DFHEIV0(25:11)
 21653     CALL 'kxdfhei1' USING DFHEIV0
 21654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21655
 21656
 21657
 21658* EXEC CICS   READ
 21659*        DATASET   (FORM-ID)
 21660*        RIDFLD    (ERFORM-KEY)
 21661*        INTO      (FORM-MASTER)
 21662*        GTEQ
 21663*    END-EXEC.
 21664     MOVE LENGTH OF
 21665      FORM-MASTER
 21666       TO DFHEIV11
 21667*    MOVE '&"IL       G          (   #00020529' TO DFHEIV0
 21668     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21669     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21670     MOVE X'2020233030303230353239' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 401
* EL050.cbl
 21671     CALL 'kxdfhei1' USING DFHEIV0,
 21672           FORM-ID,
 21673           FORM-MASTER,
 21674           DFHEIV11,
 21675           ERFORM-KEY,
 21676           DFHEIV99,
 21677           DFHEIV99,
 21678           DFHEIV99
 21679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21680
 21681
 21682     MOVE  'Y'           TO  FORM-MASTER-SW.
 21683
 21684     GO TO  8450-EXIT.
 21685
 21686 8450-FORM-NOT-FOUND.
 21687
 21688     MOVE  'N'           TO  FORM-MASTER-SW.
 21689
 21690 8450-EXIT.
 21691      EXIT.
 21692
 21693 8500-DATE-CONVERT.
 21694
 21695* EXEC CICS LINK
 21696*        PROGRAM    ('ELDATCV')
 21697*        COMMAREA   (DATE-CONVERSION-DATA)
 21698*        LENGTH     (DC-COMM-LENGTH)
 21699*    END-EXEC.
 21700     MOVE 'ELDATCV' TO DFHEIV1
 21701*    MOVE '."C                   (   #00020548' TO DFHEIV0
 21702     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21703     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21704     MOVE X'2020233030303230353438' TO DFHEIV0(25:11)
 21705     CALL 'kxdfhei1' USING DFHEIV0,
 21706           DFHEIV1,
 21707           DATE-CONVERSION-DATA,
 21708           DC-COMM-LENGTH,
 21709           DFHEIV99,
 21710           DFHEIV99,
 21711           DFHEIV99,
 21712           DFHEIV99
 21713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21714
 21715
 21716 8500-EXIT.
 21717     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 402
* EL050.cbl
 21719
 21720 8555-RELOAD-CONTROL-FILE.
 21721     CONTINUE.
 21722
 21723 8555-EXIT.
 21724     EXIT.
 21725
 21726 8557-GETMAIN-ERPLAN.
 21727
 21728
 21729* EXEC CICS GETMAIN
 21730*        LENGTH    (840)
 21731*        SET       (ADDRESS OF PLAN-RECORDS)
 21732*    END-EXEC.
 21733     MOVE 840
 21734       TO DFHEIV11
 21735*    MOVE '," L                  $   #00020566' TO DFHEIV0
 21736     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21737     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21738     MOVE X'2020233030303230353636' TO DFHEIV0(25:11)
 21739     CALL 'kxdfhei1' USING DFHEIV0,
 21740           DFHEIV20,
 21741           DFHEIV11,
 21742           DFHEIV99
 21743     SET ADDRESS OF PLAN-RECORDS TO
 21744         DFHEIV20
 21745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21746
 21747
 21748     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21749
 21750 8557-EXIT.
 21751     EXIT.
 21752
 21753 8560-GETMAIN.
 21754
 21755* EXEC CICS GETMAIN
 21756*        LENGTH    (2000)
 21757*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21758*    END-EXEC.
 21759     MOVE 2000
 21760       TO DFHEIV11
 21761*    MOVE '," L                  $   #00020577' TO DFHEIV0
 21762     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21763     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21764     MOVE X'2020233030303230353737' TO DFHEIV0(25:11)
 21765     CALL 'kxdfhei1' USING DFHEIV0,
 21766           DFHEIV20,
 21767           DFHEIV11,
 21768           DFHEIV99
 21769     SET ADDRESS OF ACCOUNT-MASTER TO
 21770         DFHEIV20
 21771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21772
 21773
 21774     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21775
 21776 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 403
* EL050.cbl
 21777     EXIT.
 21778
 21779 8570-START-ACCOUNT-MASTER.
 21780
 21781* EXEC CICS HANDLE CONDITION
 21782*        NOTFND    (0199-ACCT-NOT-FOUND)
 21783*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21784*    END-EXEC.
 21785*    MOVE '"$I''                  ! 6 #00020588' TO DFHEIV0
 21786     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21787     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21788     MOVE X'3620233030303230353838' TO DFHEIV0(25:11)
 21789     CALL 'kxdfhei1' USING DFHEIV0
 21790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21791
 21792
 21793
 21794* EXEC CICS STARTBR
 21795*        DATASET    (ACCT-ID)
 21796*        RIDFLD     (ERACCT-KEY)
 21797*        GTEQ
 21798*    END-EXEC.
 21799     MOVE 0
 21800       TO DFHEIV11
 21801*    MOVE '&,         G          &   #00020593' TO DFHEIV0
 21802     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21803     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21804     MOVE X'2020233030303230353933' TO DFHEIV0(25:11)
 21805     CALL 'kxdfhei1' USING DFHEIV0,
 21806           ACCT-ID,
 21807           ERACCT-KEY,
 21808           DFHEIV99,
 21809           DFHEIV11,
 21810           DFHEIV99
 21811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21812
 21813
 21814 8570-EXIT.
 21815     EXIT.
 21816
 21817 8580-READ-ACCOUNT-MASTER.
 21818
 21819* EXEC CICS HANDLE CONDITION
 21820*        NOTFND    (0199-ACCT-NOT-FOUND)
 21821*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21822*    END-EXEC.
 21823*    MOVE '"$I''                  ! 7 #00020603' TO DFHEIV0
 21824     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21825     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21826     MOVE X'3720233030303230363033' TO DFHEIV0(25:11)
 21827     CALL 'kxdfhei1' USING DFHEIV0
 21828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21829
 21830
 21831
 21832* EXEC CICS READNEXT
 21833*        DATASET     (ACCT-ID)
 21834*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 404
* EL050.cbl
 21835*        RIDFLD      (ERACCT-KEY)
 21836*    END-EXEC.
 21837     MOVE LENGTH OF
 21838      ACCOUNT-MASTER
 21839       TO DFHEIV12
 21840     MOVE 0
 21841       TO DFHEIV11
 21842*    MOVE '&.IL                  )   #00020608' TO DFHEIV0
 21843     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21844     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21845     MOVE X'2020233030303230363038' TO DFHEIV0(25:11)
 21846     CALL 'kxdfhei1' USING DFHEIV0,
 21847           ACCT-ID,
 21848           ACCOUNT-MASTER,
 21849           DFHEIV12,
 21850           ERACCT-KEY,
 21851           DFHEIV99,
 21852           DFHEIV11,
 21853           DFHEIV99,
 21854           DFHEIV99
 21855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21856
 21857
 21858 8580-EXIT.
 21859     EXIT.
 21860
 21861 8582-READ-COMPENSATION-MASTER.
 21862
 21863* EXEC CICS HANDLE CONDITION
 21864*        NOTFND    (8582-COMP-NOT-FOUND)
 21865*        ENDFILE   (8582-COMP-NOT-FOUND)
 21866*    END-EXEC.
 21867*    MOVE '"$I''                  ! 8 #00020618' TO DFHEIV0
 21868     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21869     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21870     MOVE X'3820233030303230363138' TO DFHEIV0(25:11)
 21871     CALL 'kxdfhei1' USING DFHEIV0
 21872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21873
 21874
 21875
 21876* EXEC CICS READ
 21877*        DATASET     (COMP-ID)
 21878*        INTO        (COMPENSATION-MASTER)
 21879*        RIDFLD      (ERCOMP-KEY)
 21880*    END-EXEC.
 21881     MOVE LENGTH OF
 21882      COMPENSATION-MASTER
 21883       TO DFHEIV11
 21884*    MOVE '&"IL       E          (   #00020623' TO DFHEIV0
 21885     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21886     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21887     MOVE X'2020233030303230363233' TO DFHEIV0(25:11)
 21888     CALL 'kxdfhei1' USING DFHEIV0,
 21889           COMP-ID,
 21890           COMPENSATION-MASTER,
 21891           DFHEIV11,
 21892           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 405
* EL050.cbl
 21893           DFHEIV99,
 21894           DFHEIV99,
 21895           DFHEIV99
 21896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21897
 21898
 21899     MOVE 'Y'                    TO COMP-MASTER-SW
 21900
 21901     GO TO 8582-EXIT
 21902     .
 21903 8582-COMP-NOT-FOUND.
 21904
 21905     MOVE 'N'                    TO COMP-MASTER-SW.
 21906
 21907 8582-EXIT.
 21908     EXIT.
 21909
 21910 8583-READ-ERAGTC.
 21911
 21912* EXEC CICS HANDLE CONDITION
 21913*        NOTFND    (8583-AGTC-NOT-FOUND)
 21914*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21915*    END-EXEC.
 21916*    MOVE '"$I''                  ! 9 #00020641' TO DFHEIV0
 21917     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21918     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21919     MOVE X'3920233030303230363431' TO DFHEIV0(25:11)
 21920     CALL 'kxdfhei1' USING DFHEIV0
 21921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21922
 21923
 21924
 21925* EXEC CICS STARTBR
 21926*        DATASET    (AGTC-ID)
 21927*        RIDFLD     (ERAGTC-KEY)
 21928*        GTEQ
 21929*    END-EXEC.
 21930     MOVE 0
 21931       TO DFHEIV11
 21932*    MOVE '&,         G          &   #00020646' TO DFHEIV0
 21933     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21934     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21935     MOVE X'2020233030303230363436' TO DFHEIV0(25:11)
 21936     CALL 'kxdfhei1' USING DFHEIV0,
 21937           AGTC-ID,
 21938           ERAGTC-KEY,
 21939           DFHEIV99,
 21940           DFHEIV11,
 21941           DFHEIV99
 21942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21943
 21944
 21945 8583-READ-ERAGTC-NEXT.
 21946
 21947* EXEC CICS READNEXT
 21948*        DATASET     (AGTC-ID)
 21949*        INTO        (AGENT-COMMISSIONS)
 21950*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 406
* EL050.cbl
 21951*    END-EXEC.
 21952     MOVE LENGTH OF
 21953      AGENT-COMMISSIONS
 21954       TO DFHEIV12
 21955     MOVE 0
 21956       TO DFHEIV11
 21957*    MOVE '&.IL                  )   #00020653' TO DFHEIV0
 21958     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21959     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21960     MOVE X'2020233030303230363533' TO DFHEIV0(25:11)
 21961     CALL 'kxdfhei1' USING DFHEIV0,
 21962           AGTC-ID,
 21963           AGENT-COMMISSIONS,
 21964           DFHEIV12,
 21965           ERAGTC-KEY,
 21966           DFHEIV99,
 21967           DFHEIV11,
 21968           DFHEIV99,
 21969           DFHEIV99
 21970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21971
 21972
 21973*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21974
 21975     GO TO 8583-EXIT
 21976     .
 21977 8583-AGTC-NOT-FOUND.
 21978
 21979     MOVE 'N'                    TO AGTC-MASTER-SW.
 21980
 21981 8583-EXIT.
 21982     EXIT.
 21983
 21984 8584-READ-BANK-CROSS-REF.
 21985
 21986* EXEC CICS HANDLE CONDITION
 21987*        NOTFND    (8584-BXRF-NOT-FOUND)
 21988*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21989*    END-EXEC.
 21990*    MOVE '"$I''                  ! : #00020671' TO DFHEIV0
 21991     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21992     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21993     MOVE X'3A20233030303230363731' TO DFHEIV0(25:11)
 21994     CALL 'kxdfhei1' USING DFHEIV0
 21995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21996
 21997
 21998
 21999* EXEC CICS READ
 22000*        DATASET     (BXRF-ID)
 22001*        INTO        (BANK-CROSS-REFERENCE)
 22002*        RIDFLD      (ERBXRF-KEY)
 22003*        LENGTH      (BXRF-REC-LENGTH)
 22004*    END-EXEC.
 22005*    MOVE '&"IL       E          (   #00020676' TO DFHEIV0
 22006     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22007     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22008     MOVE X'2020233030303230363736' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 407
* EL050.cbl
 22009     CALL 'kxdfhei1' USING DFHEIV0,
 22010           BXRF-ID,
 22011           BANK-CROSS-REFERENCE,
 22012           BXRF-REC-LENGTH,
 22013           ERBXRF-KEY,
 22014           DFHEIV99,
 22015           DFHEIV99,
 22016           DFHEIV99
 22017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22018
 22019
 22020     MOVE 'Y'                    TO BXRF-MASTER-SW
 22021
 22022     GO TO 8584-EXIT
 22023     .
 22024 8584-BXRF-NOT-FOUND.
 22025
 22026     MOVE 'N'                    TO BXRF-MASTER-SW.
 22027
 22028 8584-EXIT.
 22029     EXIT.
 22030
 22031 8585-READ-PLAN-MASTER.
 22032
 22033
 22034* EXEC CICS HANDLE CONDITION
 22035*        NOTFND    (8585-PLAN-NOT-FOUND)
 22036*        ENDFILE   (8585-PLAN-NOT-FOUND)
 22037*    END-EXEC.
 22038*    MOVE '"$I''                  ! ; #00020696' TO DFHEIV0
 22039     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22040     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22041     MOVE X'3B20233030303230363936' TO DFHEIV0(25:11)
 22042     CALL 'kxdfhei1' USING DFHEIV0
 22043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22044
 22045
 22046
 22047* EXEC CICS READ
 22048*        DATASET     (PLAN-ID)
 22049*        INTO        (PLAN-MASTER)
 22050*        RIDFLD      (ERPLAN-KEY)
 22051*    END-EXEC.
 22052     MOVE LENGTH OF
 22053      PLAN-MASTER
 22054       TO DFHEIV11
 22055*    MOVE '&"IL       E          (   #00020701' TO DFHEIV0
 22056     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22057     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22058     MOVE X'2020233030303230373031' TO DFHEIV0(25:11)
 22059     CALL 'kxdfhei1' USING DFHEIV0,
 22060           PLAN-ID,
 22061           PLAN-MASTER,
 22062           DFHEIV11,
 22063           ERPLAN-KEY,
 22064           DFHEIV99,
 22065           DFHEIV99,
 22066           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 408
* EL050.cbl
 22067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22068
 22069
 22070     MOVE 'Y'                    TO PLAN-MASTER-SW.
 22071
 22072     GO TO 8585-EXIT.
 22073
 22074 8585-PLAN-NOT-FOUND.
 22075
 22076     MOVE 'N'                    TO PLAN-MASTER-SW.
 22077
 22078 8585-EXIT.
 22079     EXIT.
 22080
 22081 8586-READ-LOAN-OFFICER.
 22082
 22083* EXEC CICS READ
 22084*        DATASET     (LOFC-ID)
 22085*        INTO        (LOAN-OFFICER-MASTER)
 22086*        RIDFLD      (ERLOFC-KEY)
 22087*        RESP        (WS-RESPONSE)
 22088*    END-EXEC
 22089     MOVE LENGTH OF
 22090      LOAN-OFFICER-MASTER
 22091       TO DFHEIV11
 22092*    MOVE '&"IL       E          (  N#00020719' TO DFHEIV0
 22093     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22094     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22095     MOVE X'204E233030303230373139' TO DFHEIV0(25:11)
 22096     CALL 'kxdfhei1' USING DFHEIV0,
 22097           LOFC-ID,
 22098           LOAN-OFFICER-MASTER,
 22099           DFHEIV11,
 22100           ERLOFC-KEY,
 22101           DFHEIV99,
 22102           DFHEIV99,
 22103           DFHEIV99
 22104     MOVE EIBRESP  TO WS-RESPONSE
 22105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22106
 22107     IF WS-RESP-NORMAL
 22108        MOVE 'Y'                 TO LOFC-MASTER-SW
 22109     ELSE
 22110        MOVE 'N'                 TO LOFC-MASTER-SW
 22111     END-IF
 22112     .
 22113 8586-EXIT.
 22114     EXIT.
 22115 8587-START-ERPDEF.
 22116
 22117* EXEC CICS STARTBR
 22118*       DATASET   (PDEF-ID)
 22119*       RIDFLD    (ERPDEF-KEY)
 22120*       GTEQ
 22121*       RESP      (WS-RESPONSE)
 22122*    END-EXEC
 22123     MOVE 0
 22124       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 409
* EL050.cbl
 22125*    MOVE '&,         G          &  N#00020735' TO DFHEIV0
 22126     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22127     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22128     MOVE X'204E233030303230373335' TO DFHEIV0(25:11)
 22129     CALL 'kxdfhei1' USING DFHEIV0,
 22130           PDEF-ID,
 22131           ERPDEF-KEY,
 22132           DFHEIV99,
 22133           DFHEIV11,
 22134           DFHEIV99
 22135     MOVE EIBRESP  TO WS-RESPONSE
 22136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22137     IF WS-RESP-NORMAL
 22138        MOVE 'Y'                 TO PDEF-MASTER-SW
 22139     ELSE
 22140        MOVE 'N'                 TO PDEF-MASTER-SW
 22141     END-IF
 22142     .
 22143 8587-EXIT.
 22144     EXIT.
 22145 8588-READ-ERPDEF.
 22146
 22147* EXEC CICS READNEXT
 22148*       DATASET   (PDEF-ID)
 22149*       RIDFLD    (ERPDEF-KEY)
 22150*       INTO      (PRODUCT-MASTER)
 22151*       RESP      (WS-RESPONSE)
 22152*    END-EXEC
 22153     MOVE LENGTH OF
 22154      PRODUCT-MASTER
 22155       TO DFHEIV12
 22156     MOVE 0
 22157       TO DFHEIV11
 22158*    MOVE '&.IL                  )  N#00020750' TO DFHEIV0
 22159     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22160     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22161     MOVE X'204E233030303230373530' TO DFHEIV0(25:11)
 22162     CALL 'kxdfhei1' USING DFHEIV0,
 22163           PDEF-ID,
 22164           PRODUCT-MASTER,
 22165           DFHEIV12,
 22166           ERPDEF-KEY,
 22167           DFHEIV99,
 22168           DFHEIV11,
 22169           DFHEIV99,
 22170           DFHEIV99
 22171     MOVE EIBRESP  TO WS-RESPONSE
 22172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22173     IF WS-RESP-NORMAL
 22174        MOVE 'Y'                 TO PDEF-MASTER-SW
 22175     ELSE
 22176        MOVE 'N'                 TO PDEF-MASTER-SW
 22177     END-IF
 22178     .
 22179 8588-EXIT.
 22180     EXIT.
 22181 8589-ENDBR-ERPDEF.
 22182
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 410
* EL050.cbl
 22183* EXEC CICS ENDBR
 22184*       DATASET   (PDEF-ID)
 22185*    END-EXEC
 22186     MOVE 0
 22187       TO DFHEIV11
 22188*    MOVE '&2                    $   #00020765' TO DFHEIV0
 22189     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22190     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22191     MOVE X'2020233030303230373635' TO DFHEIV0(25:11)
 22192     CALL 'kxdfhei1' USING DFHEIV0,
 22193           PDEF-ID,
 22194           DFHEIV11,
 22195           DFHEIV99
 22196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22197     .
 22198 8589-EXIT.
 22199     EXIT.
 22200 8590-READ-CERT-MASTER.
 22201     IF PB-COMPANY-ID = 'UCL'
 22202         GO TO 8690-READ-CERT-MASTER-UCL.
 22203
 22204
 22205* EXEC CICS HANDLE CONDITION
 22206*         NOTFND    (0299-CERT-NOT-FOUND)
 22207*    END-EXEC.
 22208*    MOVE '"$I                   ! < #00020775' TO DFHEIV0
 22209     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22210     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22211     MOVE X'3C20233030303230373735' TO DFHEIV0(25:11)
 22212     CALL 'kxdfhei1' USING DFHEIV0
 22213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22214
 22215
 22216
 22217* EXEC CICS READ
 22218*        DATASET     (CERT-ID)
 22219*        INTO        (CERTIFICATE-MASTER)
 22220*        RIDFLD      (ELCERT-KEY)
 22221*        UPDATE
 22222*    END-EXEC.
 22223     MOVE LENGTH OF
 22224      CERTIFICATE-MASTER
 22225       TO DFHEIV11
 22226*    MOVE '&"IL       EU         (   #00020779' TO DFHEIV0
 22227     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22228     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22229     MOVE X'2020233030303230373739' TO DFHEIV0(25:11)
 22230     CALL 'kxdfhei1' USING DFHEIV0,
 22231           CERT-ID,
 22232           CERTIFICATE-MASTER,
 22233           DFHEIV11,
 22234           ELCERT-KEY,
 22235           DFHEIV99,
 22236           DFHEIV99,
 22237           DFHEIV99
 22238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22239
 22240
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 411
* EL050.cbl
 22241 8590-EXIT.
 22242     EXIT.
 22243
 22244 8690-READ-CERT-MASTER-UCL.
 22245
 22246* EXEC CICS HANDLE CONDITION
 22247*         NOTFND    (8700-READ-CERT-MASTER)
 22248*    END-EXEC.
 22249*    MOVE '"$I                   ! = #00020790' TO DFHEIV0
 22250     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22251     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22252     MOVE X'3D20233030303230373930' TO DFHEIV0(25:11)
 22253     CALL 'kxdfhei1' USING DFHEIV0
 22254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22255
 22256
 22257 8690-READ-CERT-CONT.
 22258
 22259* EXEC CICS READ
 22260*        DATASET     (CERT-ID)
 22261*        INTO        (CERTIFICATE-MASTER)
 22262*        RIDFLD      (ELCERT-KEY)
 22263*        UPDATE
 22264*    END-EXEC.
 22265     MOVE LENGTH OF
 22266      CERTIFICATE-MASTER
 22267       TO DFHEIV11
 22268*    MOVE '&"IL       EU         (   #00020795' TO DFHEIV0
 22269     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22270     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22271     MOVE X'2020233030303230373935' TO DFHEIV0(25:11)
 22272     CALL 'kxdfhei1' USING DFHEIV0,
 22273           CERT-ID,
 22274           CERTIFICATE-MASTER,
 22275           DFHEIV11,
 22276           ELCERT-KEY,
 22277           DFHEIV99,
 22278           DFHEIV99,
 22279           DFHEIV99
 22280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22281
 22282
 22283     GO TO 8590-EXIT.
 22284
 22285 8700-READ-CERT-MASTER.
 22286     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 22287     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 22288
 22289* EXEC CICS HANDLE CONDITION
 22290*         DUPKEY    (8720-COMP-ACCOUNTS)
 22291*         ENDFILE   (8730-END-BROWSE)
 22292*         NOTFND    (8740-NOT-FOUND)
 22293*    END-EXEC.
 22294*    MOVE '"$$''I                 ! > #00020807' TO DFHEIV0
 22295     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 22296     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22297     MOVE X'3E20233030303230383037' TO DFHEIV0(25:11)
 22298     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 412
* EL050.cbl
 22299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22300
 22301
 22302
 22303* EXEC CICS STARTBR
 22304*        DATASET     ('ELCERT5')
 22305*        RIDFLD      (ELCERT2-KEY)
 22306*        EQUAL
 22307*    END-EXEC.
 22308     MOVE 'ELCERT5' TO DFHEIV1
 22309     MOVE 0
 22310       TO DFHEIV11
 22311*    MOVE '&,         E          &   #00020813' TO DFHEIV0
 22312     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 22313     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22314     MOVE X'2020233030303230383133' TO DFHEIV0(25:11)
 22315     CALL 'kxdfhei1' USING DFHEIV0,
 22316           DFHEIV1,
 22317           ELCERT2-KEY,
 22318           DFHEIV99,
 22319           DFHEIV11,
 22320           DFHEIV99
 22321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22322
 22323
 22324 8710-READ-NEXT.
 22325
 22326* EXEC CICS READNEXT
 22327*        DATASET     ('ELCERT5')
 22328*        INTO        (CERTIFICATE-MASTER)
 22329*        RIDFLD      (ELCERT2-KEY)
 22330*    END-EXEC.
 22331     MOVE LENGTH OF
 22332      CERTIFICATE-MASTER
 22333       TO DFHEIV12
 22334     MOVE 'ELCERT5' TO DFHEIV1
 22335     MOVE 0
 22336       TO DFHEIV11
 22337*    MOVE '&.IL                  )   #00020820' TO DFHEIV0
 22338     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22339     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22340     MOVE X'2020233030303230383230' TO DFHEIV0(25:11)
 22341     CALL 'kxdfhei1' USING DFHEIV0,
 22342           DFHEIV1,
 22343           CERTIFICATE-MASTER,
 22344           DFHEIV12,
 22345           ELCERT2-KEY,
 22346           DFHEIV99,
 22347           DFHEIV11,
 22348           DFHEIV99,
 22349           DFHEIV99
 22350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22351
 22352
 22353 8720-COMP-ACCOUNTS.
 22354
 22355* EXEC CICS ENTER
 22356*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 413
* EL050.cbl
 22357*         FROM (PB-C-LAST-NAME)
 22358*    END-EXEC.
 22359     MOVE 001
 22360       TO DFHEIV11
 22361*    MOVE ':$F                   %   #00020827' TO DFHEIV0
 22362     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22363     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22364     MOVE X'2020233030303230383237' TO DFHEIV0(25:11)
 22365     CALL 'kxdfhei1' USING DFHEIV0,
 22366           DFHEIV11,
 22367           PB-C-LAST-NAME,
 22368           DFHEIV99,
 22369           DFHEIV99
 22370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22371
 22372
 22373
 22374* EXEC CICS ENTER
 22375*         TRACEID (002)
 22376*         FROM (CM-INSURED-LAST-NAME)
 22377*    END-EXEC.
 22378     MOVE 002
 22379       TO DFHEIV11
 22380*    MOVE ':$F                   %   #00020832' TO DFHEIV0
 22381     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22382     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22383     MOVE X'2020233030303230383332' TO DFHEIV0(25:11)
 22384     CALL 'kxdfhei1' USING DFHEIV0,
 22385           DFHEIV11,
 22386           CM-INSURED-LAST-NAME,
 22387           DFHEIV99,
 22388           DFHEIV99
 22389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22390
 22391
 22392     IF PB-CERT-NO NOT = CM-CERT-NO
 22393         GO TO 8730-END-BROWSE.
 22394
 22395     IF PB-ACCOUNT = CM-ACCOUNT
 22396         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 22397             MOVE ER-2799        TO WS-ERROR
 22398             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22399             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 22400             GO TO 8730-END-BROWSE.
 22401
 22402     GO TO 8710-READ-NEXT.
 22403
 22404 8730-END-BROWSE.
 22405
 22406* EXEC CICS ENDBR
 22407*         DATASET    ('ELCERT5')
 22408*    END-EXEC.
 22409     MOVE 'ELCERT5' TO DFHEIV1
 22410     MOVE 0
 22411       TO DFHEIV11
 22412*    MOVE '&2                    $   #00020850' TO DFHEIV0
 22413     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22414     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 414
* EL050.cbl
 22415     MOVE X'2020233030303230383530' TO DFHEIV0(25:11)
 22416     CALL 'kxdfhei1' USING DFHEIV0,
 22417           DFHEIV1,
 22418           DFHEIV11,
 22419           DFHEIV99
 22420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22421
 22422
 22423 8740-NOT-FOUND.
 22424     GO TO 0299-CERT-NOT-FOUND.
 22425
 22426 8750-START-ELSTAT.
 22427
 22428* EXEC CICS STARTBR
 22429*       DATASET   (STAT-ID)
 22430*       RIDFLD    (ELSTAT-KEY)
 22431*       GTEQ
 22432*       RESP      (WS-RESPONSE)
 22433*    END-EXEC
 22434     MOVE 0
 22435       TO DFHEIV11
 22436*    MOVE '&,         G          &  N#00020858' TO DFHEIV0
 22437     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22438     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22439     MOVE X'204E233030303230383538' TO DFHEIV0(25:11)
 22440     CALL 'kxdfhei1' USING DFHEIV0,
 22441           STAT-ID,
 22442           ELSTAT-KEY,
 22443           DFHEIV99,
 22444           DFHEIV11,
 22445           DFHEIV99
 22446     MOVE EIBRESP  TO WS-RESPONSE
 22447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22448     IF WS-RESP-NORMAL
 22449        MOVE 'Y'                 TO STAT-MASTER-SW
 22450     ELSE
 22451        MOVE 'N'                 TO STAT-MASTER-SW
 22452     END-IF
 22453     .
 22454 8750-EXIT.
 22455     EXIT.
 22456 8752-READ-ELSTAT.
 22457
 22458* EXEC CICS READNEXT
 22459*       DATASET   (STAT-ID)
 22460*       RIDFLD    (ELSTAT-KEY)
 22461*       INTO      (STATE-FILE)
 22462*       RESP      (WS-RESPONSE)
 22463*    END-EXEC
 22464     MOVE LENGTH OF
 22465      STATE-FILE
 22466       TO DFHEIV12
 22467     MOVE 0
 22468       TO DFHEIV11
 22469*    MOVE '&.IL                  )  N#00020873' TO DFHEIV0
 22470     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22471     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22472     MOVE X'204E233030303230383733' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 415
* EL050.cbl
 22473     CALL 'kxdfhei1' USING DFHEIV0,
 22474           STAT-ID,
 22475           STATE-FILE,
 22476           DFHEIV12,
 22477           ELSTAT-KEY,
 22478           DFHEIV99,
 22479           DFHEIV11,
 22480           DFHEIV99,
 22481           DFHEIV99
 22482     MOVE EIBRESP  TO WS-RESPONSE
 22483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22484     IF WS-RESP-NORMAL
 22485        MOVE 'Y'                 TO STAT-MASTER-SW
 22486     ELSE
 22487        MOVE 'N'                 TO STAT-MASTER-SW
 22488     END-IF
 22489     .
 22490 8752-EXIT.
 22491     EXIT.
 22492 8800-GET-COMP-RATE.
 22493     MOVE +1 TO IB.
 22494     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 22495         ADD +9 TO IB
 22496         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 22497             ADD +9 TO IB
 22498             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 22499                MOVE ZEROS       TO WS-WK-RATE
 22500                GO TO 8800-EXIT.
 22501
 22502     IF PB-I-AGE GREATER CT-AGE (1)
 22503         ADD +3 TO IB
 22504         IF PB-I-AGE GREATER CT-AGE (2)
 22505             ADD +3 TO IB
 22506             IF PB-I-AGE GREATER CT-AGE (3)
 22507                MOVE ZEROS       TO WS-WK-RATE
 22508                GO TO 8800-EXIT.
 22509
 22510     IF WS-WORK-TERM GREATER CT-TRM (1)
 22511         ADD +1 TO IB
 22512         IF WS-WORK-TERM GREATER CT-TRM (2)
 22513             ADD +1 TO IB
 22514             IF WS-WORK-TERM GREATER CT-TRM (3)
 22515                MOVE ZEROS       TO WS-WK-RATE
 22516                GO TO 8800-EXIT.
 22517
 22518     IF CT-RT (IB) NOT NUMERIC
 22519         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22520         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22521         GO TO 8800-GET-COMP-RATE.
 22522
 22523     MOVE CT-RT (IB) TO WS-WK-RATE.
 22524
 22525 8800-EXIT.
 22526     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 416
* EL050.cbl
 22528 8900-ADDRESS-FILE.
 22529     IF ERACCT-FILE-ADDRESSED
 22530         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22531         GO TO 8900-ADDRESS-EXIT.
 22532
 22533     IF ELCNTL-FILE-ADDRESSED
 22534         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22535         GO TO 8900-ADDRESS-EXIT.
 22536
 22537     IF ERPLAN-FILE-ADDRESSED
 22538         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22539         GO TO 8900-ADDRESS-EXIT.
 22540
 22541     IF ERFORM-FILE-ADDRESSED
 22542         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22543         GO TO 8900-ADDRESS-EXIT.
 22544
 22545 8900-ADDRESS-EXIT.
 22546     EXIT.
 22547
 22548 9000-READ-CONTROL.
 22549
 22550* EXEC CICS HANDLE CONDITION
 22551*        NOTFND    (9000-NOTFND)
 22552*    END-EXEC.
 22553*    MOVE '"$I                   ! ? #00020944' TO DFHEIV0
 22554     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22555     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22556     MOVE X'3F20233030303230393434' TO DFHEIV0(25:11)
 22557     CALL 'kxdfhei1' USING DFHEIV0
 22558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22559
 22560
 22561
 22562* EXEC CICS READ
 22563*        DATASET     (CNTL-ID)
 22564*        SET         (ADDRESS OF CONTROL-FILE)
 22565*        RIDFLD      (ELCNTL-KEY)
 22566*        GTEQ
 22567*    END-EXEC.
 22568*    MOVE '&"S        G          (   #00020948' TO DFHEIV0
 22569     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22570     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22571     MOVE X'2020233030303230393438' TO DFHEIV0(25:11)
 22572     CALL 'kxdfhei1' USING DFHEIV0,
 22573           CNTL-ID,
 22574           DFHEIV20,
 22575           DFHEIV99,
 22576           ELCNTL-KEY,
 22577           DFHEIV99,
 22578           DFHEIV99,
 22579           DFHEIV99
 22580     SET ADDRESS OF CONTROL-FILE TO
 22581         DFHEIV20
 22582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22583
 22584
 22585     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 417
* EL050.cbl
 22586
 22587 9000-NOTFND.
 22588     IF RC-SW-1 = '1'
 22589        MOVE ER-2616              TO WS-ERROR
 22590        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22591        GO TO 9000-EXIT.
 22592
 22593     IF RC-SW-1 = '2'
 22594        MOVE ER-2602              TO WS-ERROR
 22595        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22596
 22597 9000-EXIT.
 22598      EXIT.
 22599
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 418
* EL050.cbl
 22601 9100-READ-CONTROL.
 22602
 22603* EXEC CICS HANDLE CONDITION
 22604*        NOTFND  (9100-NOTFND)
 22605*        ENDFILE (9100-NOTFND)
 22606*    END-EXEC.
 22607*    MOVE '"$I''                  ! @ #00020972' TO DFHEIV0
 22608     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22609     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22610     MOVE X'4020233030303230393732' TO DFHEIV0(25:11)
 22611     CALL 'kxdfhei1' USING DFHEIV0
 22612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22613
 22614
 22615
 22616* EXEC CICS READ
 22617*        DATASET     (CNTL-ID)
 22618*        INTO        (CONTROL-FILE)
 22619*        RIDFLD      (ELCNTL-KEY)
 22620*        GTEQ
 22621*    END-EXEC.
 22622     MOVE LENGTH OF
 22623      CONTROL-FILE
 22624       TO DFHEIV11
 22625*    MOVE '&"IL       G          (   #00020977' TO DFHEIV0
 22626     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22627     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22628     MOVE X'2020233030303230393737' TO DFHEIV0(25:11)
 22629     CALL 'kxdfhei1' USING DFHEIV0,
 22630           CNTL-ID,
 22631           CONTROL-FILE,
 22632           DFHEIV11,
 22633           ELCNTL-KEY,
 22634           DFHEIV99,
 22635           DFHEIV99,
 22636           DFHEIV99
 22637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22638
 22639
 22640     GO TO 9100-EXIT.
 22641
 22642 9100-NOTFND.
 22643     IF RC-SW-2 = '0'
 22644        MOVE '1'                  TO STATE-RECORD-ERROR
 22645        GO TO 9100-EXIT
 22646     END-IF
 22647     IF RC-SW-2 = '1'
 22648        MOVE '1'                  TO LF-BENEFIT-ERROR
 22649        MOVE ER-2604              TO WS-ERROR
 22650        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22651        GO TO 9100-EXIT.
 22652
 22653     IF RC-SW-2 = '2'
 22654        MOVE '1'                  TO AH-BENEFIT-ERROR
 22655        MOVE ER-2605              TO WS-ERROR
 22656        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22657        GO TO 9100-EXIT.
 22658
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 419
* EL050.cbl
 22659     IF RC-SW-2 = '3'
 22660         MOVE ER-2603           TO WS-ERROR
 22661         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22662         GO TO 9100-EXIT.
 22663
 22664     IF RC-SW-2 = '4'
 22665         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22666         GO TO 9100-EXIT.
 22667
 22668     IF RC-SW-2 = '5'
 22669         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22670         IF WS-AH-INPUT-CD-1 = SPACE
 22671             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22672         ELSE
 22673             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22674
 22675 9100-EXIT.
 22676      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 420
* EL050.cbl
 22678 9200-CONTROL-GETMAIN.
 22679
 22680* EXEC CICS GETMAIN
 22681*         LENGTH   (750)
 22682*         SET      (ADDRESS OF CONTROL-FILE)
 22683*    END-EXEC.
 22684     MOVE 750
 22685       TO DFHEIV11
 22686*    MOVE '," L                  $   #00021023' TO DFHEIV0
 22687     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22688     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22689     MOVE X'2020233030303231303233' TO DFHEIV0(25:11)
 22690     CALL 'kxdfhei1' USING DFHEIV0,
 22691           DFHEIV20,
 22692           DFHEIV11,
 22693           DFHEIV99
 22694     SET ADDRESS OF CONTROL-FILE TO
 22695         DFHEIV20
 22696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22697
 22698
 22699     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22700
 22701 9200-EXIT.
 22702     EXIT.
 22703
 22704 9250-UNLOCK-RETURN.
 22705
 22706* EXEC CICS UNLOCK
 22707*        DATASET   (CERT-ID)
 22708*    END-EXEC.
 22709*    MOVE '&*                    #   #00021034' TO DFHEIV0
 22710     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22711     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22712     MOVE X'2020233030303231303334' TO DFHEIV0(25:11)
 22713     CALL 'kxdfhei1' USING DFHEIV0,
 22714           CERT-ID,
 22715           DFHEIV99
 22716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22717
 22718
 22719 9300-ABEND.
 22720     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22721
 22722
 22723* EXEC CICS LINK
 22724*        PROGRAM   ('EL004')
 22725*        COMMAREA  (WS-ERROR-LINE)
 22726*        LENGTH    (72)
 22727*    END-EXEC.
 22728     MOVE 'EL004' TO DFHEIV1
 22729     MOVE 72
 22730       TO DFHEIV11
 22731*    MOVE '."C                   (   #00021041' TO DFHEIV0
 22732     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22733     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22734     MOVE X'2020233030303231303431' TO DFHEIV0(25:11)
 22735     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 421
* EL050.cbl
 22736           DFHEIV1,
 22737           WS-ERROR-LINE,
 22738           DFHEIV11,
 22739           DFHEIV99,
 22740           DFHEIV99,
 22741           DFHEIV99,
 22742           DFHEIV99
 22743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22744
 22745
 22746     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22747
 22748
 22749* EXEC CICS ABEND
 22750*        ABCODE ('EL50')
 22751*    END-EXEC.
 22752     MOVE 'EL50' TO DFHEIV5
 22753*    MOVE '.,A                   "   #00021049' TO DFHEIV0
 22754     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22755     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22756     MOVE X'2020233030303231303439' TO DFHEIV0(25:11)
 22757     CALL 'kxdfhei1' USING DFHEIV0,
 22758           DFHEIV5
 22759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22760
 22761
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 422
* EL050.cbl
 22763
 22764******************************************************************
 22765*                                                                *
 22766*            E R R O R   F O R M A T   R O U T I N E             *
 22767*                                                                *
 22768******************************************************************
 22769
 22770 9900-ERROR-FORMAT.
 22771
 22772     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22773                    PB-COMMON-ERROR (2) OR
 22774                    PB-COMMON-ERROR (3) OR
 22775                    PB-COMMON-ERROR (4) OR
 22776                    PB-COMMON-ERROR (5) OR
 22777                    PB-COMMON-ERROR (6) OR
 22778                    PB-COMMON-ERROR (7) OR
 22779                    PB-COMMON-ERROR (8) OR
 22780                    PB-COMMON-ERROR (9) OR
 22781                    PB-COMMON-ERROR (10)
 22782        GO TO 9900-EXIT.
 22783
 22784     IF PB-NO-OF-ERRORS = +10
 22785        GO TO 9900-EXIT.
 22786
 22787     ADD +1  TO PB-NO-OF-ERRORS.
 22788     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22789                                       (PB-NO-OF-ERRORS).
 22790 9900-EXIT.
 22791     EXIT.
 22792
 22793 9990-RETURN.
 22794     IF BROWSE-STARTED
 22795
 22796* EXEC CICS ENDBR
 22797*            DATASET  (ACCT-ID)
 22798*       END-EXEC.
 22799     MOVE 0
 22800       TO DFHEIV11
 22801*    MOVE '&2                    $   #00021086' TO DFHEIV0
 22802     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22803     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22804     MOVE X'2020233030303231303836' TO DFHEIV0(25:11)
 22805     CALL 'kxdfhei1' USING DFHEIV0,
 22806           ACCT-ID,
 22807           DFHEIV11,
 22808           DFHEIV99
 22809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22810
 22811
 22812 9990-EXIT.
 22813     EXIT.
 22814
 22815
 22816****Check for CRTO record, add one if not found.
 22817 9991-CHECK-FOR-ELCRTO.
 22818
 22819* EXEC CICS HANDLE CONDITION
 22820*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 423
* EL050.cbl
 22821*         ENDFILE (9991-CRTO-NOT-FOUND)
 22822*     END-EXEC.
 22823*    MOVE '"$I''                  ! A #00021096' TO DFHEIV0
 22824     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22825     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22826     MOVE X'4120233030303231303936' TO DFHEIV0(25:11)
 22827     CALL 'kxdfhei1' USING DFHEIV0
 22828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22829
 22830     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22831     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22832     MOVE +0                     TO ELCRTO-SEQ-NO
 22833
 22834
 22835* EXEC CICS READ
 22836*       DATASET   ('ELCRTO')
 22837*       INTO      (ORIGINAL-CERTIFICATE)
 22838*       RIDFLD    (ELCRTO-KEY)
 22839*       GTEQ
 22840*       RESP      (WS-RESPONSE)
 22841*    END-EXEC
 22842     MOVE LENGTH OF
 22843      ORIGINAL-CERTIFICATE
 22844       TO DFHEIV11
 22845     MOVE 'ELCRTO' TO DFHEIV1
 22846*    MOVE '&"IL       G          (  N#00021104' TO DFHEIV0
 22847     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22848     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22849     MOVE X'204E233030303231313034' TO DFHEIV0(25:11)
 22850     CALL 'kxdfhei1' USING DFHEIV0,
 22851           DFHEIV1,
 22852           ORIGINAL-CERTIFICATE,
 22853           DFHEIV11,
 22854           ELCRTO-KEY,
 22855           DFHEIV99,
 22856           DFHEIV99,
 22857           DFHEIV99
 22858     MOVE EIBRESP  TO WS-RESPONSE
 22859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22860
 22861     IF WS-RESP-NORMAL
 22862        AND (OC-CONTROL-PRIMARY (1:33) =
 22863                 PB-CONTROL-BY-ACCOUNT (1:33))
 22864        AND (OC-RECORD-TYPE =  'I')
 22865           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22866               GO TO 9991-CHECK-INDICATORS
 22867           ELSE
 22868               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22869               GO TO 9991-CRTO-ADD-REC
 22870           END-IF
 22871     END-IF.
 22872
 22873 9991-CRTO-NOT-FOUND.
 22874
 22875     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22876     MOVE 'OC'                TO OC-RECORD-ID
 22877     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22878                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 424
* EL050.cbl
 22879     MOVE +4096               TO OC-KEY-SEQ-NO.
 22880
 22881 9991-CRTO-ADD-REC.
 22882
 22883     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22884     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22885     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22886     MOVE 'I'                 TO OC-RECORD-TYPE
 22887     IF PB-ISSUE
 22888         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22889         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22890         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22891         MOVE PB-I-AGE               TO OC-INS-AGE
 22892         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22893         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22894         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22895         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22896         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22897         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22898         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22899         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22900         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22901         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22902         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22903         IF PB-I-JOINT-COMMISSION > +0
 22904             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22905         ELSE
 22906             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22907         END-IF
 22908         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22909         MOVE +0                     TO OC-LF-CANCEL-AMT
 22910                                        OC-LF-ITD-CANCEL-AMT
 22911         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22912         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22913         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22914         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22915         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22916         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22917         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22918         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22919         MOVE +0                     TO OC-AH-CANCEL-AMT
 22920                                        OC-AH-ITD-CANCEL-AMT
 22921         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22922         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22923         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22924     ELSE
 22925         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22926         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22927         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22928         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22929         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22930         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22931         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22932         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22933         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22934          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22935             MOVE SPACES             TO OC-LF-BENCD
 22936             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 425
* EL050.cbl
 22937                                        OC-LF-BEN-AMT
 22938                                        OC-LF-PRM-AMT
 22939                                        OC-LF-ALT-BEN-AMT
 22940                                        OC-LF-ALT-PRM-AMT
 22941                                        OC-LF-COMM-PCT
 22942                                        OC-LF-CANCEL-AMT
 22943             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22944             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22945         ELSE
 22946             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22947             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22948             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22949             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22950             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22951             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22952             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22953             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22954             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22955             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22956         END-IF
 22957         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22958         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22959          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22960             MOVE SPACES             TO OC-AH-BENCD
 22961             MOVE ZEROS              TO OC-AH-TERM
 22962                                        OC-AH-BEN-AMT
 22963                                        OC-AH-PRM-AMT
 22964                                        OC-AH-COMM-PCT
 22965                                        OC-AH-CANCEL-AMT
 22966                                        OC-AH-CP
 22967             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22968             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22969         ELSE
 22970             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22971             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22972             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22973             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22974             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22975             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22976             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22977             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22978             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22979         END-IF
 22980         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22981         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22982         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22983         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22984     END-IF
 22985     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22986
 22987     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22988
 22989
 22990* EXEC CICS READ
 22991*         DATASET   (FILE-ERMAIL)
 22992*         RIDFLD    (MA-CONTROL-PRIMARY)
 22993*         INTO      (MAILING-DATA)
 22994*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 426
* EL050.cbl
 22995*    END-EXEC
 22996     MOVE LENGTH OF
 22997      MAILING-DATA
 22998       TO DFHEIV11
 22999*    MOVE '&"IL       E          (  N#00021240' TO DFHEIV0
 23000     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23001     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23002     MOVE X'204E233030303231323430' TO DFHEIV0(25:11)
 23003     CALL 'kxdfhei1' USING DFHEIV0,
 23004           FILE-ERMAIL,
 23005           MAILING-DATA,
 23006           DFHEIV11,
 23007           MA-CONTROL-PRIMARY,
 23008           DFHEIV99,
 23009           DFHEIV99,
 23010           DFHEIV99
 23011     MOVE EIBRESP  TO WS-RESPONSE
 23012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23013
 23014     IF WS-RESP-NORMAL
 23015         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 23016     END-IF.
 23017
 23018     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 23019     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 23020
 23021
 23022* EXEC CICS READ
 23023*         DATASET  (CRTT-ID)
 23024*         RIDFLD   (WS-ELCRTT-KEY)
 23025*         INTO     (CERTIFICATE-TRAILERS)
 23026*         RESP     (WS-RESPONSE)
 23027*    END-EXEC
 23028     MOVE LENGTH OF
 23029      CERTIFICATE-TRAILERS
 23030       TO DFHEIV11
 23031*    MOVE '&"IL       E          (  N#00021254' TO DFHEIV0
 23032     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23033     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23034     MOVE X'204E233030303231323534' TO DFHEIV0(25:11)
 23035     CALL 'kxdfhei1' USING DFHEIV0,
 23036           CRTT-ID,
 23037           CERTIFICATE-TRAILERS,
 23038           DFHEIV11,
 23039           WS-ELCRTT-KEY,
 23040           DFHEIV99,
 23041           DFHEIV99,
 23042           DFHEIV99
 23043     MOVE EIBRESP  TO WS-RESPONSE
 23044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23045
 23046     IF WS-RESP-NORMAL
 23047         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 23048         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 23049     END-IF.
 23050
 23051
 23052* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 427
* EL050.cbl
 23053*       DATASET   ('ELCRTO')
 23054*       FROM      (ORIGINAL-CERTIFICATE)
 23055*       RIDFLD    (OC-CONTROL-PRIMARY)
 23056*       RESP      (WS-RESPONSE)
 23057*    END-EXEC.
 23058     MOVE LENGTH OF
 23059      ORIGINAL-CERTIFICATE
 23060       TO DFHEIV11
 23061     MOVE 'ELCRTO' TO DFHEIV1
 23062*    MOVE '&$ L                  ''  N#00021266' TO DFHEIV0
 23063     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 23064     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23065     MOVE X'204E233030303231323636' TO DFHEIV0(25:11)
 23066     CALL 'kxdfhei1' USING DFHEIV0,
 23067           DFHEIV1,
 23068           ORIGINAL-CERTIFICATE,
 23069           DFHEIV11,
 23070           OC-CONTROL-PRIMARY,
 23071           DFHEIV99,
 23072           DFHEIV99
 23073     MOVE EIBRESP  TO WS-RESPONSE
 23074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23075
 23076
 23077     GO TO 9991-EXIT.
 23078
 23079 9991-CHECK-INDICATORS.
 23080
 23081     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 23082         GO TO 9991-EXIT
 23083     END-IF.
 23084
 23085     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 23086         GO TO 9991-EXIT
 23087     END-IF.
 23088
 23089
 23090* EXEC CICS READ
 23091*       DATASET   ('ELCRTO')
 23092*       INTO      (ORIGINAL-CERTIFICATE)
 23093*       RIDFLD    (OC-CONTROL-PRIMARY)
 23094*       UPDATE
 23095*       RESP      (WS-RESPONSE)
 23096*    END-EXEC
 23097     MOVE LENGTH OF
 23098      ORIGINAL-CERTIFICATE
 23099       TO DFHEIV11
 23100     MOVE 'ELCRTO' TO DFHEIV1
 23101*    MOVE '&"IL       EU         (  N#00021285' TO DFHEIV0
 23102     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23103     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23104     MOVE X'204E233030303231323835' TO DFHEIV0(25:11)
 23105     CALL 'kxdfhei1' USING DFHEIV0,
 23106           DFHEIV1,
 23107           ORIGINAL-CERTIFICATE,
 23108           DFHEIV11,
 23109           OC-CONTROL-PRIMARY,
 23110           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 428
* EL050.cbl
 23111           DFHEIV99,
 23112           DFHEIV99
 23113     MOVE EIBRESP  TO WS-RESPONSE
 23114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23115     IF WS-RESP-NORMAL
 23116        IF PB-ISSUE
 23117          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 23118          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 23119          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 23120          MOVE PB-I-AGE               TO OC-INS-AGE
 23121          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 23122          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 23123          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 23124          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 23125          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 23126          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 23127          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 23128          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 23129          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 23130          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 23131          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 23132          IF PB-I-JOINT-COMMISSION > +0
 23133              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 23134          ELSE
 23135              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 23136          END-IF
 23137          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 23138          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 23139          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 23140          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 23141          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 23142          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 23143          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 23144          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 23145          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 23146
 23147          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 23148
 23149* EXEC CICS READ
 23150*             DATASET   (FILE-ERMAIL)
 23151*             RIDFLD    (MA-CONTROL-PRIMARY)
 23152*             INTO      (MAILING-DATA)
 23153*             RESP      (WS-RESPONSE)
 23154*         END-EXEC
 23155     MOVE LENGTH OF
 23156      MAILING-DATA
 23157       TO DFHEIV11
 23158*    MOVE '&"IL       E          (  N#00021325' TO DFHEIV0
 23159     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23160     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23161     MOVE X'204E233030303231333235' TO DFHEIV0(25:11)
 23162     CALL 'kxdfhei1' USING DFHEIV0,
 23163           FILE-ERMAIL,
 23164           MAILING-DATA,
 23165           DFHEIV11,
 23166           MA-CONTROL-PRIMARY,
 23167           DFHEIV99,
 23168           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 429
* EL050.cbl
 23169           DFHEIV99
 23170     MOVE EIBRESP  TO WS-RESPONSE
 23171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23172          IF WS-RESP-NORMAL
 23173             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 23174          END-IF
 23175
 23176          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 23177          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 23178
 23179* EXEC CICS READ
 23180*             DATASET  (CRTT-ID)
 23181*             RIDFLD   (WS-ELCRTT-KEY)
 23182*             INTO     (CERTIFICATE-TRAILERS)
 23183*             RESP     (WS-RESPONSE)
 23184*         END-EXEC
 23185     MOVE LENGTH OF
 23186      CERTIFICATE-TRAILERS
 23187       TO DFHEIV11
 23188*    MOVE '&"IL       E          (  N#00021337' TO DFHEIV0
 23189     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23190     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23191     MOVE X'204E233030303231333337' TO DFHEIV0(25:11)
 23192     CALL 'kxdfhei1' USING DFHEIV0,
 23193           CRTT-ID,
 23194           CERTIFICATE-TRAILERS,
 23195           DFHEIV11,
 23196           WS-ELCRTT-KEY,
 23197           DFHEIV99,
 23198           DFHEIV99,
 23199           DFHEIV99
 23200     MOVE EIBRESP  TO WS-RESPONSE
 23201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23202          IF WS-RESP-NORMAL
 23203             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 23204                               OC-INS-AGE-DEFAULT-FLAG
 23205             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 23206                               OC-JNT-AGE-DEFAULT-FLAG
 23207          END-IF
 23208
 23209        ELSE
 23210          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 23211             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 23212             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 23213             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 23214          END-IF
 23215          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 23216             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 23217             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 23218             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 23219          END-IF
 23220          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 23221        END-IF
 23222
 23223* EXEC CICS REWRITE
 23224*          DATASET   ('ELCRTO')
 23225*          FROM      (ORIGINAL-CERTIFICATE)
 23226*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 430
* EL050.cbl
 23227*       END-EXEC
 23228     MOVE LENGTH OF
 23229      ORIGINAL-CERTIFICATE
 23230       TO DFHEIV11
 23231     MOVE 'ELCRTO' TO DFHEIV1
 23232*    MOVE '&& L                  %  N#00021363' TO DFHEIV0
 23233     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23234     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23235     MOVE X'204E233030303231333633' TO DFHEIV0(25:11)
 23236     CALL 'kxdfhei1' USING DFHEIV0,
 23237           DFHEIV1,
 23238           ORIGINAL-CERTIFICATE,
 23239           DFHEIV11,
 23240           DFHEIV99
 23241     MOVE EIBRESP  TO WS-RESPONSE
 23242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23243     END-IF.
 23244
 23245 9991-EXIT.
 23246     EXIT.
 23247
 23248
 23249 9999-RETURN.
 23250     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 23251
 23252
 23253* EXEC CICS RETURN
 23254*    END-EXEC.
 23255*    MOVE '.(                    ''   #00021377' TO DFHEIV0
 23256     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23257     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23258     MOVE X'2020233030303231333737' TO DFHEIV0(25:11)
 23259     CALL 'kxdfhei1' USING DFHEIV0,
 23260           DFHEIV99,
 23261           DFHEIV99,
 23262           DFHEIV99,
 23263           DFHEIV99,
 23264           DFHEIV99,
 23265           DFHEIV99
 23266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23267
 23268
 23269
 23270* GOBACK.
 23271     MOVE '9%                    "   ' TO DFHEIV0
 23272     MOVE 'EL050' TO DFHEIV1
 23273     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23274     GOBACK.
 23275
 23276 9999-DFHBACK SECTION.
 23277     MOVE '9%                    "   ' TO DFHEIV0
 23278     MOVE 'EL050' TO DFHEIV1
 23279     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23280     GOBACK.
 23281 9999-DFHEXIT.
 23282     IF DFHEIGDJ EQUAL 0001
 23283         NEXT SENTENCE
 23284     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 431
* EL050.cbl
 23285         GO TO 9300-ABEND,
 23286               3990-FILES-NOT-OPEN
 23287         DEPENDING ON DFHEIGDI
 23288     ELSE IF DFHEIGDJ EQUAL 3
 23289         GO TO 6610-START-BROWSE,
 23290               6630-ERRESS-PROBLEM,
 23291               6630-END-OF-FILE
 23292         DEPENDING ON DFHEIGDI
 23293     ELSE IF DFHEIGDJ EQUAL 4
 23294         GO TO 6630-END-OF-FILE,
 23295               6630-ERRESS-PROBLEM,
 23296               6630-ERRESS-PROBLEM,
 23297               6630-END-OF-FILE
 23298         DEPENDING ON DFHEIGDI
 23299     ELSE IF DFHEIGDJ EQUAL 5
 23300         GO TO 6630-END-OF-FILE,
 23301               6630-END-OF-FILE,
 23302               6630-ERRESS-PROBLEM,
 23303               6630-ERRESS-PROBLEM
 23304         DEPENDING ON DFHEIGDI
 23305     ELSE IF DFHEIGDJ EQUAL 6
 23306         GO TO 6660-START-BROWSE,
 23307               6690-ERRESC-PROBLEM,
 23308               6690-ERRESC-PROBLEM,
 23309               6690-END-OF-FILE
 23310         DEPENDING ON DFHEIGDI
 23311     ELSE IF DFHEIGDJ EQUAL 7
 23312         GO TO 6690-END-OF-FILE,
 23313               6690-ERRESC-PROBLEM,
 23314               6690-ERRESC-PROBLEM,
 23315               6690-END-OF-FILE
 23316         DEPENDING ON DFHEIGDI
 23317     ELSE IF DFHEIGDJ EQUAL 8
 23318         GO TO 6690-END-OF-FILE,
 23319               6690-ERRESC-PROBLEM,
 23320               6690-ERRESC-PROBLEM,
 23321               6690-END-OF-FILE
 23322         DEPENDING ON DFHEIGDI
 23323     ELSE IF DFHEIGDJ EQUAL 9
 23324         GO TO 7250-CONTINUE,
 23325               7250-CONTINUE
 23326         DEPENDING ON DFHEIGDI
 23327     ELSE IF DFHEIGDJ EQUAL 10
 23328         GO TO 7300-CONTINUE,
 23329               7300-CONTINUE
 23330         DEPENDING ON DFHEIGDI
 23331     ELSE IF DFHEIGDJ EQUAL 11
 23332         GO TO 7320-CONTINUE,
 23333               7320-CONTINUE
 23334         DEPENDING ON DFHEIGDI
 23335     ELSE IF DFHEIGDJ EQUAL 12
 23336         GO TO 8000-FREE-MAIN
 23337         DEPENDING ON DFHEIGDI
 23338     ELSE IF DFHEIGDJ EQUAL 13
 23339         GO TO 8100-NOTFND,
 23340               8100-NOTFND
 23341         DEPENDING ON DFHEIGDI
 23342     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 432
* EL050.cbl
 23343         GO TO 8110-NOTFND,
 23344               8110-NOTFND
 23345         DEPENDING ON DFHEIGDI
 23346     ELSE IF DFHEIGDJ EQUAL 15
 23347         GO TO 8130-EXIT
 23348         DEPENDING ON DFHEIGDI
 23349     ELSE IF DFHEIGDJ EQUAL 16
 23350         GO TO 8145-exit
 23351         DEPENDING ON DFHEIGDI
 23352     ELSE IF DFHEIGDJ EQUAL 17
 23353         GO TO 8190-NOTFND
 23354         DEPENDING ON DFHEIGDI
 23355     ELSE IF DFHEIGDJ EQUAL 18
 23356         GO TO 8195-NOTFND
 23357         DEPENDING ON DFHEIGDI
 23358     ELSE IF DFHEIGDJ EQUAL 19
 23359         GO TO 8200-NOTFND
 23360         DEPENDING ON DFHEIGDI
 23361     ELSE IF DFHEIGDJ EQUAL 20
 23362         GO TO 8300-NOTFND,
 23363               8300-ERRESS-PROBLEM,
 23364               8300-ERRESS-PROBLEM,
 23365               8300-NOTFND
 23366         DEPENDING ON DFHEIGDI
 23367     ELSE IF DFHEIGDJ EQUAL 21
 23368         GO TO 8450-FORM-NOT-FOUND,
 23369               8450-FORM-NOT-FOUND
 23370         DEPENDING ON DFHEIGDI
 23371     ELSE IF DFHEIGDJ EQUAL 22
 23372         GO TO 0199-ACCT-NOT-FOUND,
 23373               0199-ACCT-NOT-FOUND
 23374         DEPENDING ON DFHEIGDI
 23375     ELSE IF DFHEIGDJ EQUAL 23
 23376         GO TO 0199-ACCT-NOT-FOUND,
 23377               0199-ACCT-NOT-FOUND
 23378         DEPENDING ON DFHEIGDI
 23379     ELSE IF DFHEIGDJ EQUAL 24
 23380         GO TO 8582-COMP-NOT-FOUND,
 23381               8582-COMP-NOT-FOUND
 23382         DEPENDING ON DFHEIGDI
 23383     ELSE IF DFHEIGDJ EQUAL 25
 23384         GO TO 8583-AGTC-NOT-FOUND,
 23385               8583-AGTC-NOT-FOUND
 23386         DEPENDING ON DFHEIGDI
 23387     ELSE IF DFHEIGDJ EQUAL 26
 23388         GO TO 8584-BXRF-NOT-FOUND,
 23389               8584-BXRF-NOT-FOUND
 23390         DEPENDING ON DFHEIGDI
 23391     ELSE IF DFHEIGDJ EQUAL 27
 23392         GO TO 8585-PLAN-NOT-FOUND,
 23393               8585-PLAN-NOT-FOUND
 23394         DEPENDING ON DFHEIGDI
 23395     ELSE IF DFHEIGDJ EQUAL 28
 23396         GO TO 0299-CERT-NOT-FOUND
 23397         DEPENDING ON DFHEIGDI
 23398     ELSE IF DFHEIGDJ EQUAL 29
 23399         GO TO 8700-READ-CERT-MASTER
 23400         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 12-Mar-20 14:28 Page 433
* EL050.cbl
 23401     ELSE IF DFHEIGDJ EQUAL 30
 23402         GO TO 8720-COMP-ACCOUNTS,
 23403               8730-END-BROWSE,
 23404               8740-NOT-FOUND
 23405         DEPENDING ON DFHEIGDI
 23406     ELSE IF DFHEIGDJ EQUAL 31
 23407         GO TO 9000-NOTFND
 23408         DEPENDING ON DFHEIGDI
 23409     ELSE IF DFHEIGDJ EQUAL 32
 23410         GO TO 9100-NOTFND,
 23411               9100-NOTFND
 23412         DEPENDING ON DFHEIGDI
 23413     ELSE IF DFHEIGDJ EQUAL 33
 23414         GO TO 9991-CRTO-NOT-FOUND,
 23415               9991-CRTO-NOT-FOUND
 23416         DEPENDING ON DFHEIGDI.
 23417     MOVE '9%                    "   ' TO DFHEIV0
 23418     MOVE 'EL050' TO DFHEIV1
 23419     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23420     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41848     Code:       96093
