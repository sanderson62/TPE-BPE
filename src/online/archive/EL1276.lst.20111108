* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   1
* EL1276.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL1276.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1276.lst" LISTPATH
*          "" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL1276.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/13/96 09:59:22.
     7*                            VMOD=2.004.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   2
* EL1276.cbl
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*                                                                *
    21*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    22*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    23*            *                                                   *
    24*            *****************************************************
    25*
    26*REMARKS.    TRANSACTION - EXX6 - CERTIFICATE AND BILLING NOTES.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101201    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL127FO FILLER
    38* 092309    2008100900003  AJRA  CERT NOTES MOVED TO NEW SCREEN
    39******************************************************************
    40 ENVIRONMENT DIVISION.
    41
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   3
* EL1276.cbl
    43 DATA DIVISION.
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46 77  FILLER  PIC X(32)  VALUE '********************************'.
    47 77  FILLER  PIC X(32)  VALUE '*    EL1276 WORKING STORAGE    *'.
    48 77  FILLER  PIC X(32)  VALUE '************ V/M 2.004 *********'.
    49
    50*    COPY ELCSCTM.
    51******************************************************************
    52*                                                                *
    53*                                                                *
    54*                            ELCSCTM                             *
    55*                            VMOD=2.001                          *
    56*                                                                *
    57*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    58*                                                                *
    59******************************************************************
    60 01  SECURITY-MESSAGE.
    61     12  FILLER                          PIC X(30)
    62            VALUE '** LOGIC SECURITY VIOLATION -'.
    63     12  SM-READ                         PIC X(6).
    64     12  FILLER                          PIC X(5)
    65            VALUE ' PGM='.
    66     12  SM-PGM                          PIC X(6).
    67     12  FILLER                          PIC X(5)
    68            VALUE ' OPR='.
    69     12  SM-PROCESSOR-ID                 PIC X(4).
    70     12  FILLER                          PIC X(6)
    71            VALUE ' TERM='.
    72     12  SM-TERMID                       PIC X(4).
    73     12  FILLER                          PIC XX   VALUE SPACE.
    74     12  SM-JUL-DATE                     PIC 9(5).
    75     12  FILLER                          PIC X    VALUE SPACE.
    76     12  SM-TIME                         PIC 99.99.
    77
    78
    79*    COPY ELCSCRTY.
    80******************************************************************
    81*                                                                *
    82*                                                                *
    83*                            ELCSCRTY                            *
    84*                            VMOD=2.001                          *
    85*                                                                *
    86*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    87*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    88*        SAVED IN PI-SECURITY-ADDRESS.                           *
    89*                                                                *
    90******************************************************************
    91 01  SECURITY-CONTROL.
    92     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    93     12  FILLER                       PIC XX    VALUE 'SC'.
    94     12  SC-CREDIT-CODES.
    95         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    96             20  SC-CREDIT-DISPLAY    PIC X.
    97             20  SC-CREDIT-UPDATE     PIC X.
    98     12  SC-CLAIMS-CODES.
    99         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   100             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   4
* EL1276.cbl
   101             20  SC-CLAIMS-UPDATE     PIC X.
   102
   103 01  WS-DATE-AREA.
   104     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   105     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   106
   107 01  STANDARD-AREAS.
   108     12  SC-ITEM                     PIC S9(4)   VALUE +0001 COMP.
   109     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   110     12  MAP-NAME                    PIC X(8)    VALUE 'EL127F'.
   111     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL1276S'.
   112     12  SCREEN-NUMBER               PIC X(4)    VALUE '127F'.
   113     12  TRANS-ID                    PIC X(4)    VALUE 'EXX6'.
   114     12  THIS-PGM                    PIC X(8)    VALUE 'EL1276'.
   115     12  PGM-NAME                    PIC X(8).
   116     12  TIME-IN                     PIC S9(7).
   117     12  TIME-OUT-R  REDEFINES TIME-IN.
   118         16  FILLER                  PIC X.
   119         16  TIME-OUT                PIC 99V99.
   120         16  FILLER                  PIC XX.
   121     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   122     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   123     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
   124     12  PGM-1279                    PIC X(8)    VALUE 'EL1279'.
   125     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   126     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   127     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   128     12  ERNOTE-ID                   PIC X(8)    VALUE 'ERNOTE'.
   129     12  ELCERT-ID                   PIC X(8)    VALUE 'ELCERT'.
   130     12  WS-RECORD-LENGTHS   COMP.
   131         16  WS-ERNOTE-RECORD-LENGTH  PIC S9(4)  VALUE +825.
   132         16  WS-ELCERT-RECORD-LENGTH  PIC S9(4)  VALUE +450.
   133         16  WS-JOURNAL-RECORD-LENGTH PIC S9(4)  VALUE ZEROS.
   134
   135     12  DEEDIT-FIELD                PIC X(15).
   136     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD   PIC S9(15).
   137
   138     12  RETURN-FROM                 PIC X(8).
   139     12  QID.
   140         16  QID-TERM                PIC X(4).
   141         16  FILLER                  PIC X(4)    VALUE '127F'.
   142     12  WS-SUB1                     PIC  S99  COMP.
   143     12  WS-NOTE-LINE-SW             PIC  X      VALUE SPACE.
   144         88  NOTE-LINES-PRESENT                  VALUE 'Y'.
   145     12  WS-RECORD-FOUND-SW          PIC  X      VALUE SPACE.
   146         88  RECORD-FOUND                        VALUE 'Y'.
   147         88  RECORD-NOT-FOUND                    VALUE 'N'.
   148     12  WS-DUPREC-SW                PIC  X      VALUE SPACE.
   149         88  DUPLICATE-RECORD-FOUND              VALUE 'Y'.
   150
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   5
* EL1276.cbl
   152     12  ERROR-MESSAGES.
   153         16  ER-0000                 PIC  X(4)   VALUE '0000'.
   154         16  ER-0004                 PIC  X(4)   VALUE '0004'.
   155         16  ER-0008                 PIC  X(4)   VALUE '0008'.
   156         16  ER-0023                 PIC  X(4)   VALUE '0023'.
   157         16  ER-0029                 PIC  X(4)   VALUE '0029'.
   158         16  ER-0070                 PIC  X(4)   VALUE '0070'.
   159         16  ER-0142                 PIC  X(4)   VALUE '0142'.
   160         16  ER-2520                 PIC  X(4)   VALUE '2520'.
   161         16  ER-2521                 PIC  X(4)   VALUE '2521'.
   162         16  ER-2522                 PIC  X(4)   VALUE '2522'.
   163         16  ER-2523                 PIC  X(4)   VALUE '2523'.
   164         16  ER-2524                 PIC  X(4)   VALUE '2524'.
   165         16  ER-2525                 PIC  X(4)   VALUE '2525'.
   166         16  ER-2528                 PIC  X(4)   VALUE '2528'.
   167         16  ER-2706                 PIC  X(4)   VALUE '2706'.
   168
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   6
* EL1276.cbl
   170
   171 01  WS-CM-CONTROL-PRIMARY.
   172     05  WS-CM-COMPANY-CD            PIC  X.
   173     05  WS-CM-CARRIER               PIC  X.
   174     05  WS-CM-GROUPING              PIC  X(6).
   175     05  WS-CM-STATE                 PIC  XX.
   176     05  WS-CM-ACCOUNT               PIC  X(10).
   177     05  WS-CM-CERT-EFF-DT           PIC  XX.
   178     05  WS-CM-CERT-NO.
   179         10  WS-CM-CERT-PRIME        PIC  X(10).
   180         10  WS-CM-CERT-SFX          PIC  X.
   181
   182*    COPY ELCDATE.
   183******************************************************************
   184*                                                                *
   185*                                                                *
   186*                            ELCDATE.                            *
   187*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   188*                            VMOD=2.003
   189*                                                                *
   190*                                                                *
   191*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   192*                 LENGTH = 200                                   *
   193******************************************************************
   194
   195 01  DATE-CONVERSION-DATA.
   196     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   197     12  DC-OPTION-CODE                PIC X.
   198         88  BIN-TO-GREG                VALUE ' '.
   199         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   200         88  EDIT-GREG-TO-BIN           VALUE '2'.
   201         88  YMD-GREG-TO-BIN            VALUE '3'.
   202         88  MDY-GREG-TO-BIN            VALUE '4'.
   203         88  JULIAN-TO-BIN              VALUE '5'.
   204         88  BIN-PLUS-ELAPSED           VALUE '6'.
   205         88  FIND-CENTURY               VALUE '7'.
   206         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   207         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   208         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   209         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   210         88  JULIAN-TO-BIN-3            VALUE 'C'.
   211         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   212         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   213         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   214         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   215         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   216         88  CHECK-LEAP-YEAR            VALUE 'H'.
   217         88  BIN-3-TO-GREG              VALUE 'I'.
   218         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   219         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   220         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   221         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   222         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   223         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   224         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   225         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   226         88  THREE-CHARACTER-BIN
   227                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   7
* EL1276.cbl
   228         88  GREGORIAN-TO-BIN
   229                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   230         88  BIN-TO-GREGORIAN
   231                  VALUES ' ' '1' 'I' '8' 'G'.
   232         88  JULIAN-TO-BINARY
   233                  VALUES '5' 'C' 'E' 'F'.
   234     12  DC-ERROR-CODE                 PIC X.
   235         88  NO-CONVERSION-ERROR        VALUE ' '.
   236         88  DATE-CONVERSION-ERROR
   237                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   238         88  DATE-IS-ZERO               VALUE '1'.
   239         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   240         88  DATE-IS-INVALID            VALUE '3'.
   241         88  DATE1-GREATER-DATE2        VALUE '4'.
   242         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   243         88  DATE-INVALID-OPTION        VALUE '9'.
   244         88  INVALID-CENTURY            VALUE 'A'.
   245         88  ONLY-CENTURY               VALUE 'B'.
   246         88  ONLY-LEAP-YEAR             VALUE 'C'.
   247         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   248     12  DC-END-OF-MONTH               PIC X.
   249         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   250     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   251         88  USE-NORMAL-PROCESS         VALUE ' '.
   252         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   253         88  ADJUST-UP-100-YRS          VALUE '2'.
   254     12  FILLER                        PIC X.
   255     12  DC-CONVERSION-DATES.
   256         16  DC-BIN-DATE-1             PIC XX.
   257         16  DC-BIN-DATE-2             PIC XX.
   258         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   259         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   260                       DC-GREG-DATE-1-EDIT.
   261             20  DC-EDIT1-MONTH        PIC 99.
   262             20  SLASH1-1              PIC X.
   263             20  DC-EDIT1-DAY          PIC 99.
   264             20  SLASH1-2              PIC X.
   265             20  DC-EDIT1-YEAR         PIC 99.
   266         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   267         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   268                     DC-GREG-DATE-2-EDIT.
   269             20  DC-EDIT2-MONTH        PIC 99.
   270             20  SLASH2-1              PIC X.
   271             20  DC-EDIT2-DAY          PIC 99.
   272             20  SLASH2-2              PIC X.
   273             20  DC-EDIT2-YEAR         PIC 99.
   274         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   275         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   276                     DC-GREG-DATE-1-YMD.
   277             20  DC-YMD-YEAR           PIC 99.
   278             20  DC-YMD-MONTH          PIC 99.
   279             20  DC-YMD-DAY            PIC 99.
   280         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   281         16  DC-GREG-DATE-1-MDY-R REDEFINES
   282                      DC-GREG-DATE-1-MDY.
   283             20  DC-MDY-MONTH          PIC 99.
   284             20  DC-MDY-DAY            PIC 99.
   285             20  DC-MDY-YEAR           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   8
* EL1276.cbl
   286         16  DC-GREG-DATE-1-ALPHA.
   287             20  DC-ALPHA-MONTH        PIC X(10).
   288             20  DC-ALPHA-DAY          PIC 99.
   289             20  FILLER                PIC XX.
   290             20  DC-ALPHA-CENTURY.
   291                 24 DC-ALPHA-CEN-N     PIC 99.
   292             20  DC-ALPHA-YEAR         PIC 99.
   293         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   294         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   295         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   296         16  DC-JULIAN-DATE            PIC 9(05).
   297         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   298                                       PIC 9(05).
   299         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   300             20  DC-JULIAN-YEAR        PIC 99.
   301             20  DC-JULIAN-DAYS        PIC 999.
   302         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   303         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   304         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   305     12  DATE-CONVERSION-VARIBLES.
   306         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   307         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   308             20  FILLER                PIC 9(3).
   309             20  HOLD-CEN-1-CCYY.
   310                 24  HOLD-CEN-1-CC     PIC 99.
   311                 24  HOLD-CEN-1-YY     PIC 99.
   312             20  HOLD-CEN-1-MO         PIC 99.
   313             20  HOLD-CEN-1-DA         PIC 99.
   314         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   315             20  HOLD-CEN-1-R-MO       PIC 99.
   316             20  HOLD-CEN-1-R-DA       PIC 99.
   317             20  HOLD-CEN-1-R-CCYY.
   318                 24  HOLD-CEN-1-R-CC   PIC 99.
   319                 24  HOLD-CEN-1-R-YY   PIC 99.
   320             20  FILLER                PIC 9(3).
   321         16  HOLD-CENTURY-1-X.
   322             20  FILLER                PIC X(3)  VALUE SPACES.
   323             20  HOLD-CEN-1-X-CCYY.
   324                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   325                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   326             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   327             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   328         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   329             20  HOLD-CEN-1-R-X-MO     PIC XX.
   330             20  HOLD-CEN-1-R-X-DA     PIC XX.
   331             20  HOLD-CEN-1-R-X-CCYY.
   332                 24  HOLD-CEN-1-R-X-CC PIC XX.
   333                 24  HOLD-CEN-1-R-X-YY PIC XX.
   334             20  FILLER                PIC XXX.
   335         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   336         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   337         16  DC-JULIAN-DATE-1          PIC 9(07).
   338         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   339             20  DC-JULIAN-1-CCYY.
   340                 24  DC-JULIAN-1-CC    PIC 99.
   341                 24  DC-JULIAN-1-YR    PIC 99.
   342             20  DC-JULIAN-DA-1        PIC 999.
   343         16  DC-JULIAN-DATE-2          PIC 9(07).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   9
* EL1276.cbl
   344         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   345             20  DC-JULIAN-2-CCYY.
   346                 24  DC-JULIAN-2-CC    PIC 99.
   347                 24  DC-JULIAN-2-YR    PIC 99.
   348             20  DC-JULIAN-DA-2        PIC 999.
   349         16  DC-GREG-DATE-A-EDIT.
   350             20  DC-EDITA-MONTH        PIC 99.
   351             20  SLASHA-1              PIC X VALUE '/'.
   352             20  DC-EDITA-DAY          PIC 99.
   353             20  SLASHA-2              PIC X VALUE '/'.
   354             20  DC-EDITA-CCYY.
   355                 24  DC-EDITA-CENT     PIC 99.
   356                 24  DC-EDITA-YEAR     PIC 99.
   357         16  DC-GREG-DATE-B-EDIT.
   358             20  DC-EDITB-MONTH        PIC 99.
   359             20  SLASHB-1              PIC X VALUE '/'.
   360             20  DC-EDITB-DAY          PIC 99.
   361             20  SLASHB-2              PIC X VALUE '/'.
   362             20  DC-EDITB-CCYY.
   363                 24  DC-EDITB-CENT     PIC 99.
   364                 24  DC-EDITB-YEAR     PIC 99.
   365         16  DC-GREG-DATE-CYMD         PIC 9(08).
   366         16  DC-GREG-DATE-CYMD-R REDEFINES
   367                              DC-GREG-DATE-CYMD.
   368             20  DC-CYMD-CEN           PIC 99.
   369             20  DC-CYMD-YEAR          PIC 99.
   370             20  DC-CYMD-MONTH         PIC 99.
   371             20  DC-CYMD-DAY           PIC 99.
   372         16  DC-GREG-DATE-MDCY         PIC 9(08).
   373         16  DC-GREG-DATE-MDCY-R REDEFINES
   374                              DC-GREG-DATE-MDCY.
   375             20  DC-MDCY-MONTH         PIC 99.
   376             20  DC-MDCY-DAY           PIC 99.
   377             20  DC-MDCY-CEN           PIC 99.
   378             20  DC-MDCY-YEAR          PIC 99.
   379    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   380        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   381    12  DC-EL310-DATE                  PIC X(21).
   382    12  FILLER                         PIC X(28).
   383
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  10
* EL1276.cbl
   385*    COPY ELCLOGOF.
   386******************************************************************
   387*                                                                *
   388*                                                                *
   389*                            ELCLOGOF.                           *
   390*                            VMOD=2.001                          *
   391*                                                                *
   392*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   393*                                                                *
   394******************************************************************
   395 01  CLASIC-LOGOFF.
   396     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   397     12  LOGOFF-TEXT.
   398         16  FILLER          PIC X(5)    VALUE SPACES.
   399         16  LOGOFF-MSG.
   400             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   401             20  FILLER      PIC X       VALUE SPACES.
   402             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   403         16  FILLER          PIC X(80)
   404           VALUE '* YOU ARE NOW LOGGED OFF'.
   405         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   406         16  FILLER          PIC X       VALUE QUOTE.
   407         16  LOGOFF-SYS-MSG  PIC X(17)
   408           VALUE 'S CLAS-IC SYSTEM '.
   409     12  TEXT-MESSAGES.
   410         16  UNACCESS-MSG    PIC X(29)
   411             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   412         16  PGMIDERR-MSG    PIC X(17)
   413             VALUE 'PROGRAM NOT FOUND'.
   414
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  11
* EL1276.cbl
   416*    COPY ELCATTR.
   417******************************************************************
   418*                                                                *
   419*                            ELCATTR.                            *
   420*                            VMOD=2.001                          *
   421*                                                                *
   422*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   423*                                                                *
   424*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   425*                                                                *
   426*                   POS 1   P=PROTECTED                          *
   427*                           U=UNPROTECTED                        *
   428*                           S=ASKIP                              *
   429*                   POS 2   A=ALPHA/NUMERIC                      *
   430*                           N=NUMERIC                            *
   431*                   POS 3   N=NORMAL                             *
   432*                           B=BRIGHT                             *
   433*                           D=DARK                               *
   434*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   435*                           OF=MODIFIED DATA TAG OFF             *
   436*                                                                *
   437*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   438******************************************************************
   439 01  ATTRIBUTE-LIST.
   440     12  AL-PABOF            PIC X       VALUE 'Y'.
   441     12  AL-PABON            PIC X       VALUE 'Z'.
   442     12  AL-PADOF            PIC X       VALUE '%'.
   443     12  AL-PADON            PIC X       VALUE '_'.
   444     12  AL-PANOF            PIC X       VALUE '-'.
   445     12  AL-PANON            PIC X       VALUE '/'.
   446     12  AL-SABOF            PIC X       VALUE '8'.
   447     12  AL-SABON            PIC X       VALUE '9'.
   448     12  AL-SADOF            PIC X       VALUE '@'.
   449     12  AL-SADON            PIC X       VALUE QUOTE.
   450     12  AL-SANOF            PIC X       VALUE '0'.
   451     12  AL-SANON            PIC X       VALUE '1'.
   452     12  AL-UABOF            PIC X       VALUE 'H'.
   453     12  AL-UABON            PIC X       VALUE 'I'.
   454     12  AL-UADOF            PIC X       VALUE '<'.
   455     12  AL-UADON            PIC X       VALUE '('.
   456     12  AL-UANOF            PIC X       VALUE ' '.
   457     12  AL-UANON            PIC X       VALUE 'A'.
   458     12  AL-UNBOF            PIC X       VALUE 'Q'.
   459     12  AL-UNBON            PIC X       VALUE 'R'.
   460     12  AL-UNDOF            PIC X       VALUE '*'.
   461     12  AL-UNDON            PIC X       VALUE ')'.
   462     12  AL-UNNOF            PIC X       VALUE '&'.
   463     12  AL-UNNON            PIC X       VALUE 'J'.
   464
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  12
* EL1276.cbl
   466*    COPY ELCEMIB.
   467******************************************************************
   468*                                                                *
   469*                                                                *
   470*                            ELCEMIB.                            *
   471*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   472*                            VMOD=2.005                          *
   473*                                                                *
   474*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   475*                                                                *
   476******************************************************************
   477 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   478     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   479     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   480     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   481     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   482     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   483     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   484     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   485     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   486     12  EMI-SWITCH1             PIC X        VALUE '1'.
   487         88  EMI-NO-ERRORS                    VALUE '1'.
   488         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   489         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   490     12  EMI-SWITCH2             PIC X        VALUE '1'.
   491         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   492     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   493         88  EMI-AREA1-EMPTY                  VALUE '1'.
   494         88  EMI-AREA1-FULL                   VALUE '2'.
   495     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   496         88  EMI-AREA2-EMPTY                  VALUE '1'.
   497         88  EMI-AREA2-FULL                   VALUE '2'.
   498     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   499         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   500         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   501         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   502         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   503         88  EMI-BYPASS-FATALS                VALUE 'X'.
   504     12  EMI-ERROR-LINES.
   505         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   506         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   507         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   508         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   509             20  EMI-ERR-CODES OCCURS 10 TIMES.
   510                 24  EMI-ERR-NUM         PIC X(4).
   511                 24  EMI-FILLER          PIC X.
   512                 24  EMI-SEV             PIC X.
   513                 24  FILLER              PIC X.
   514             20  FILLER                  PIC X(02).
   515     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   516         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   517             20  EMI-ERROR-NUMBER    PIC X(4).
   518             20  EMI-FILL            PIC X.
   519             20  EMI-SEVERITY        PIC X.
   520             20  FILLER              PIC X.
   521             20  EMI-ERROR-TEXT.
   522                 24  EMI-TEXT-VARIABLE   PIC X(10).
   523                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  13
* EL1276.cbl
   524     12  EMI-SEVERITY-SAVE           PIC X.
   525         88  EMI-NOTE                    VALUE 'N'.
   526         88  EMI-WARNING                 VALUE 'W'.
   527         88  EMI-FORCABLE                VALUE 'F'.
   528         88  EMI-FATAL                   VALUE 'X'.
   529     12  EMI-MESSAGE-FLAG            PIC X.
   530         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   531         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   532     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   533     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   534         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   535         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   536         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   537     12  FILLER                      PIC X(137)  VALUE SPACES.
   538     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   539     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   540     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   541     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   542
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  14
* EL1276.cbl
   544*    COPY ELCINTF.
   545******************************************************************
   546*                                                                *
   547*                                                                *
   548*                            ELCINTF.                            *
   549*                            VMOD=2.017                          *
   550*                                                                *
   551*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   552*                                                                *
   553*       LENGTH = 1024                                            *
   554*                                                                *
   555******************************************************************
   556 01  PROGRAM-INTERFACE-BLOCK.
   557     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   558     12  PI-CALLING-PROGRAM              PIC X(8).
   559     12  PI-SAVED-PROGRAM-1              PIC X(8).
   560     12  PI-SAVED-PROGRAM-2              PIC X(8).
   561     12  PI-SAVED-PROGRAM-3              PIC X(8).
   562     12  PI-SAVED-PROGRAM-4              PIC X(8).
   563     12  PI-SAVED-PROGRAM-5              PIC X(8).
   564     12  PI-SAVED-PROGRAM-6              PIC X(8).
   565     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   566     12  PI-COMPANY-ID                   PIC XXX.
   567     12  PI-COMPANY-CD                   PIC X.
   568
   569     12  PI-COMPANY-PASSWORD             PIC X(8).
   570
   571     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   572
   573     12  PI-CONTROL-IN-PROGRESS.
   574         16  PI-CARRIER                  PIC X.
   575         16  PI-GROUPING                 PIC X(6).
   576         16  PI-STATE                    PIC XX.
   577         16  PI-ACCOUNT                  PIC X(10).
   578         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   579                                         PIC X(10).
   580         16  PI-CLAIM-CERT-GRP.
   581             20  PI-CLAIM-NO             PIC X(7).
   582             20  PI-CERT-NO.
   583                 25  PI-CERT-PRIME       PIC X(10).
   584                 25  PI-CERT-SFX         PIC X.
   585             20  PI-CERT-EFF-DT          PIC XX.
   586         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   587             20  PI-PLAN-CODE            PIC X(2).
   588             20  PI-REVISION-NUMBER      PIC X(3).
   589             20  PI-PLAN-EFF-DT          PIC X(2).
   590             20  PI-PLAN-EXP-DT          PIC X(2).
   591             20  FILLER                  PIC X(11).
   592         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   593             20  PI-OE-REFERENCE-1.
   594                 25  PI-OE-REF-1-PRIME   PIC X(18).
   595                 25  PI-OE-REF-1-SUFF    PIC XX.
   596
   597     12  PI-SESSION-IN-PROGRESS          PIC X.
   598         88  CLAIM-SESSION                   VALUE '1'.
   599         88  CREDIT-SESSION                  VALUE '2'.
   600         88  WARRANTY-SESSION                VALUE '3'.
   601         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  15
* EL1276.cbl
   602         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   603
   604
   605*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   606
   607     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   608     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   609
   610     12  PI-CREDIT-USER                  PIC X.
   611         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   612         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   613
   614     12  PI-CLAIM-USER                   PIC X.
   615         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   616         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   617
   618     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   619         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   620         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   621         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   622         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   623         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   624
   625     12  PI-PROCESSOR-ID                 PIC X(4).
   626
   627     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   628
   629     12  PI-MEMBER-CAPTION               PIC X(10).
   630
   631     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   632         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   633
   634     12  PI-LIFE-OVERRIDE-L1             PIC X.
   635     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   636     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   637     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   638
   639     12  PI-AH-OVERRIDE-L1               PIC X.
   640     12  PI-AH-OVERRIDE-L2               PIC XX.
   641     12  PI-AH-OVERRIDE-L6               PIC X(6).
   642     12  PI-AH-OVERRIDE-L12              PIC X(12).
   643
   644     12  PI-NEW-SYSTEM                   PIC X(2).
   645
   646     12  PI-PRIMARY-CERT-NO              PIC X(11).
   647     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   648         88  PI-USES-PAID-TO                 VALUE '1'.
   649     12  PI-CRDTCRD-SYSTEM.
   650         16  PI-CRDTCRD-USER             PIC X.
   651             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   652             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   653         16  PI-CC-MONTH-END-DT          PIC XX.
   654     12  PI-PROCESSOR-PRINTER            PIC X(4).
   655
   656     12  PI-OE-REFERENCE-2.
   657         16  PI-OE-REF-2-PRIME           PIC X(10).
   658         16  PI-OE-REF-2-SUFF            PIC X.
   659
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  16
* EL1276.cbl
   660     12  PI-REM-TRM-CALC-OPTION          PIC X.
   661
   662     12  PI-LANGUAGE-TYPE                PIC X.
   663             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   664             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   665             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   666
   667     12  PI-POLICY-LINKAGE-IND           PIC X.
   668         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   669         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   670                                                   LOW-VALUES.
   671
   672     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   673     12  PI-CLAIM-PW-SESSION             PIC X(1).
   674         88  PI-CLAIM-CREDIT                 VALUE '1'.
   675         88  PI-CLAIM-CONVEN                 VALUE '2'.
   676     12  FILLER                          PIC X(4).
   677
   678     12  PI-SYSTEM-LEVEL                 PIC X(145).
   679
   680     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   681         PI-SYSTEM-LEVEL.
   682
   683         16  PI-ENTRY-CODES.
   684             20  PI-ENTRY-CD-1           PIC X.
   685             20  PI-ENTRY-CD-2           PIC X.
   686
   687         16  PI-RETURN-CODES.
   688             20  PI-RETURN-CD-1          PIC X.
   689             20  PI-RETURN-CD-2          PIC X.
   690
   691         16  PI-UPDATE-STATUS-SAVE.
   692             20  PI-UPDATE-BY            PIC X(4).
   693             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   694
   695         16  PI-LOWER-CASE-LETTERS       PIC X.
   696             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   697
   698*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   699*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   700*            88  CARRIER-CLM-CNTL            VALUE '2'.
   701
   702         16  PI-CERT-ACCESS-CONTROL      PIC X.
   703             88  ST-ACCNT-CNTL               VALUE ' '.
   704             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   705             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   706             88  ACCNT-CNTL                  VALUE '3'.
   707             88  CARR-ACCNT-CNTL             VALUE '4'.
   708
   709         16  PI-PROCESSOR-CAP-LIST.
   710             20  PI-SYSTEM-CONTROLS.
   711                24 PI-SYSTEM-DISPLAY     PIC X.
   712                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   713                24 PI-SYSTEM-MODIFY      PIC X.
   714                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   715             20  FILLER                  PIC XX.
   716             20  PI-DISPLAY-CAP          PIC X.
   717                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  17
* EL1276.cbl
   718             20  PI-MODIFY-CAP           PIC X.
   719                 88  MODIFY-CAP              VALUE 'Y'.
   720             20  PI-MSG-AT-LOGON-CAP     PIC X.
   721                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   722             20  PI-FORCE-CAP            PIC X.
   723                 88  FORCE-CAP               VALUE 'Y'.
   724
   725         16  PI-PROGRAM-CONTROLS.
   726             20  PI-PGM-PRINT-OPT        PIC X.
   727             20  PI-PGM-FORMAT-OPT       PIC X.
   728             20  PI-PGM-PROCESS-OPT      PIC X.
   729             20  PI-PGM-TOTALS-OPT       PIC X.
   730
   731         16  PI-HELP-INTERFACE.
   732             20  PI-LAST-ERROR-NO        PIC X(4).
   733             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   734
   735         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   736             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   737
   738         16  PI-CR-CONTROL-IN-PROGRESS.
   739             20  PI-CR-CARRIER           PIC X.
   740             20  PI-CR-GROUPING          PIC X(6).
   741             20  PI-CR-STATE             PIC XX.
   742             20  PI-CR-ACCOUNT           PIC X(10).
   743             20  PI-CR-FIN-RESP          PIC X(10).
   744             20  PI-CR-TYPE              PIC X.
   745
   746         16  PI-CR-BATCH-NUMBER          PIC X(6).
   747
   748         16  PI-CR-MONTH-END-DT          PIC XX.
   749
   750         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   751             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   752             88  PI-ZERO-CARRIER             VALUE '1'.
   753             88  PI-ZERO-GROUPING            VALUE '2'.
   754             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   755
   756         16  PI-CARRIER-SECURITY         PIC X.
   757             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   758
   759         16  PI-ACCOUNT-SECURITY         PIC X(10).
   760             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   761             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   762
   763         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   764             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   765                                         INDEXED BY PI-ACCESS-NDX
   766                                         PIC X.
   767
   768         16  PI-GA-BILLING-CONTROL       PIC X.
   769             88  PI-GA-BILLING               VALUE '1'.
   770
   771         16  PI-MAIL-PROCESSING          PIC X.
   772             88  PI-MAIL-YES                 VALUE 'Y'.
   773
   774         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   775
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  18
* EL1276.cbl
   776         16  PI-AR-SYSTEM.
   777             20  PI-AR-PROCESSING-CNTL   PIC X.
   778                 88  PI-AR-PROCESSING        VALUE 'Y'.
   779             20  PI-AR-SUMMARY-CODE      PIC X(6).
   780             20  PI-AR-MONTH-END-DT      PIC XX.
   781
   782         16  PI-MP-SYSTEM.
   783             20  PI-MORTGAGE-USER            PIC X.
   784                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   785                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   786             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   787                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   788                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   789                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   790                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   791                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   792             20  PI-MP-MONTH-END-DT          PIC XX.
   793             20  PI-MP-REFERENCE-NO.
   794                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   795                 24  PI-MP-REFERENCE-SFX     PIC XX.
   796
   797         16  PI-LABEL-CONTROL            PIC X(01).
   798             88  PI-CREATE-LABELS                    VALUE 'Y'.
   799             88  PI-BYPASS-LABELS                    VALUE 'N'.
   800
   801         16  PI-BILL-GROUPING-CODE       PIC X(01).
   802             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   803
   804         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   805             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   806             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   807
   808         16  FILLER                      PIC X(14).
   809
   810     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   811******************************************************************
   812     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   813         16  FILLER              PIC X(328).
   814         16  PI-CURR-NOTE-REC-TYPE PIC X.
   815             88 PI-CERT-NOTE                 VALUE '1'.
   816             88 PI-CLAIM-NOTE                VALUE '2'.
   817         16  PI-BILLING-NOTES-EXIST PIC X.
   818         16  PI-CERT-NOTES-EXIST    PIC X.
   819         16  PI-CLAIM-NOTES-EXIST   PIC X.
   820
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  19
* EL1276.cbl
   822
   823*    COPY ELCJPFX.
   824******************************************************************
   825*                                                                *
   826*                                                                *
   827*                            ELCJPFX.                            *
   828*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   829*                            VMOD=2.002                          *
   830*                                                                *
   831*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   832*                                                                *
   833*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   834*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   835*        ELCNTL - CONTROL FILE                                   *
   836*        ELMSTR - CLAIM MASTERS                                  *
   837*        ELTRLR - ACTIVITY TRAILERS                              *
   838*        ELCHKQ - CHECK QUE                                      *
   839******************************************************************
   840 01  JOURNAL-RECORD.
   841     12  JP-USER-ID                  PIC X(4).
   842     12  JP-FILE-ID                  PIC X(8).
   843     12  JP-PROGRAM-ID               PIC X(8).
   844     12  JP-RECORD-TYPE              PIC X.
   845         88 JP-ADD              VALUE 'A'.
   846         88 JP-BEFORE-CHANGE    VALUE 'B'.
   847         88 JP-AFTER-CHANGE     VALUE 'C'.
   848         88 JP-DELETE           VALUE 'D'.
   849         88 JP-GENERIC-DELETE   VALUE 'G'.
   850         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   851         88 JP-KEY-CHG-ADD      VALUE 'N'.
   852     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   853     12  JP-RECORD-AREA
   854
   855
   856                                     PIC X(523).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  20
* EL1276.cbl
   858
   859*    COPY ELCAID.
   860******************************************************************
   861*                                                                *
   862*                            ELCAID.                             *
   863*                            VMOD=2.001                          *
   864*                                                                *
   865*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   866*                                                                *
   867*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   868*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   869******************************************************************
   870
   871 01  DFHAID.
   872   02  DFHNULL   PIC  X  VALUE  ' '.
   873   02  DFHENTER  PIC  X  VALUE  QUOTE.
   874   02  DFHCLEAR  PIC  X  VALUE  '_'.
   875   02  DFHPEN    PIC  X  VALUE  '='.
   876   02  DFHOPID   PIC  X  VALUE  'W'.
   877   02  DFHPA1    PIC  X  VALUE  '%'.
   878   02  DFHPA2    PIC  X  VALUE  '>'.
   879   02  DFHPA3    PIC  X  VALUE  ','.
   880   02  DFHPF1    PIC  X  VALUE  '1'.
   881   02  DFHPF2    PIC  X  VALUE  '2'.
   882   02  DFHPF3    PIC  X  VALUE  '3'.
   883   02  DFHPF4    PIC  X  VALUE  '4'.
   884   02  DFHPF5    PIC  X  VALUE  '5'.
   885   02  DFHPF6    PIC  X  VALUE  '6'.
   886   02  DFHPF7    PIC  X  VALUE  '7'.
   887   02  DFHPF8    PIC  X  VALUE  '8'.
   888   02  DFHPF9    PIC  X  VALUE  '9'.
   889   02  DFHPF10   PIC  X  VALUE  ':'.
   890   02  DFHPF11   PIC  X  VALUE  '#'.
   891   02  DFHPF12   PIC  X  VALUE  '@'.
   892   02  DFHPF13   PIC  X  VALUE  'A'.
   893   02  DFHPF14   PIC  X  VALUE  'B'.
   894   02  DFHPF15   PIC  X  VALUE  'C'.
   895   02  DFHPF16   PIC  X  VALUE  'D'.
   896   02  DFHPF17   PIC  X  VALUE  'E'.
   897   02  DFHPF18   PIC  X  VALUE  'F'.
   898   02  DFHPF19   PIC  X  VALUE  'G'.
   899   02  DFHPF20   PIC  X  VALUE  'H'.
   900   02  DFHPF21   PIC  X  VALUE  'I'.
   901*00039    02  DFHPF22   PIC  X  VALUE  ''.
   902   02  DFHPF22   PIC  X  VALUE  '['.
   903   02  DFHPF23   PIC  X  VALUE  '.'.
   904   02  DFHPF24   PIC  X  VALUE  '<'.
   905   02  DFHMSRE   PIC  X  VALUE  'X'.
   906   02  DFHSTRF   PIC  X  VALUE  'h'.
   907   02  DFHTRIG   PIC  X  VALUE  '"'.
   908 01  FILLER    REDEFINES DFHAID.
   909     12  FILLER                      PIC X(8).
   910     12  PF-VALUES                   PIC X       OCCURS 24 TIMES.
   911
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  21
* EL1276.cbl
   913*    COPY EL1276S.
   914 01  EL127FI.
   915     05  FILLER            PIC  X(0012).
   916*    -------------------------------
   917     05  FDATEL PIC S9(0004) COMP.
   918     05  FDATEF PIC  X(0001).
   919     05  FILLER REDEFINES FDATEF.
   920         10  FDATEA PIC  X(0001).
   921     05  FDATEI PIC  X(0008).
   922*    -------------------------------
   923     05  FTIMEL PIC S9(0004) COMP.
   924     05  FTIMEF PIC  X(0001).
   925     05  FILLER REDEFINES FTIMEF.
   926         10  FTIMEA PIC  X(0001).
   927     05  FTIMEI PIC  X(0005).
   928*    -------------------------------
   929     05  CMPNYIDL PIC S9(0004) COMP.
   930     05  CMPNYIDF PIC  X(0001).
   931     05  FILLER REDEFINES CMPNYIDF.
   932         10  CMPNYIDA PIC  X(0001).
   933     05  CMPNYIDI PIC  X(0003).
   934*    -------------------------------
   935     05  USERIDL PIC S9(0004) COMP.
   936     05  USERIDF PIC  X(0001).
   937     05  FILLER REDEFINES USERIDF.
   938         10  USERIDA PIC  X(0001).
   939     05  USERIDI PIC  X(0004).
   940*    -------------------------------
   941     05  FMAINTL PIC S9(0004) COMP.
   942     05  FMAINTF PIC  X(0001).
   943     05  FILLER REDEFINES FMAINTF.
   944         10  FMAINTA PIC  X(0001).
   945     05  FMAINTI PIC  X(0001).
   946*    -------------------------------
   947     05  FCERTL PIC S9(0004) COMP.
   948     05  FCERTF PIC  X(0001).
   949     05  FILLER REDEFINES FCERTF.
   950         10  FCERTA PIC  X(0001).
   951     05  FCERTI PIC  X(0010).
   952*    -------------------------------
   953     05  FCRTSFXL PIC S9(0004) COMP.
   954     05  FCRTSFXF PIC  X(0001).
   955     05  FILLER REDEFINES FCRTSFXF.
   956         10  FCRTSFXA PIC  X(0001).
   957     05  FCRTSFXI PIC  X(0001).
   958*    -------------------------------
   959     05  FACOUNTL PIC S9(0004) COMP.
   960     05  FACOUNTF PIC  X(0001).
   961     05  FILLER REDEFINES FACOUNTF.
   962         10  FACOUNTA PIC  X(0001).
   963     05  FACOUNTI PIC  X(0010).
   964*    -------------------------------
   965     05  FSTL PIC S9(0004) COMP.
   966     05  FSTF PIC  X(0001).
   967     05  FILLER REDEFINES FSTF.
   968         10  FSTA PIC  X(0001).
   969     05  FSTI PIC  X(0002).
   970*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  22
* EL1276.cbl
   971     05  FCARRIRL PIC S9(0004) COMP.
   972     05  FCARRIRF PIC  X(0001).
   973     05  FILLER REDEFINES FCARRIRF.
   974         10  FCARRIRA PIC  X(0001).
   975     05  FCARRIRI PIC  X(0001).
   976*    -------------------------------
   977     05  FGROUPL PIC S9(0004) COMP.
   978     05  FGROUPF PIC  X(0001).
   979     05  FILLER REDEFINES FGROUPF.
   980         10  FGROUPA PIC  X(0001).
   981     05  FGROUPI PIC  X(0006).
   982*    -------------------------------
   983     05  FEFFDTL PIC S9(0004) COMP.
   984     05  FEFFDTF PIC  X(0001).
   985     05  FILLER REDEFINES FEFFDTF.
   986         10  FEFFDTA PIC  X(0001).
   987     05  FEFFDTI PIC  X(0008).
   988*    -------------------------------
   989     05  FBSTARTL PIC S9(0004) COMP.
   990     05  FBSTARTF PIC  X(0001).
   991     05  FILLER REDEFINES FBSTARTF.
   992         10  FBSTARTA PIC  X(0001).
   993     05  FBSTARTI PIC  X(0002).
   994*    -------------------------------
   995     05  MAINTONL PIC S9(0004) COMP.
   996     05  MAINTONF PIC  X(0001).
   997     05  FILLER REDEFINES MAINTONF.
   998         10  MAINTONA PIC  X(0001).
   999     05  MAINTONI PIC  X(0008).
  1000*    -------------------------------
  1001     05  MAINTATL PIC S9(0004) COMP.
  1002     05  MAINTATF PIC  X(0001).
  1003     05  FILLER REDEFINES MAINTATF.
  1004         10  MAINTATA PIC  X(0001).
  1005     05  MAINTATI PIC  X(0005).
  1006*    -------------------------------
  1007     05  MAINTBYL PIC S9(0004) COMP.
  1008     05  MAINTBYF PIC  X(0001).
  1009     05  FILLER REDEFINES MAINTBYF.
  1010         10  MAINTBYA PIC  X(0001).
  1011     05  MAINTBYI PIC  X(0004).
  1012*    -------------------------------
  1013     05  FBENDL PIC S9(0004) COMP.
  1014     05  FBENDF PIC  X(0001).
  1015     05  FILLER REDEFINES FBENDF.
  1016         10  FBENDA PIC  X(0001).
  1017     05  FBENDI PIC  X(0002).
  1018*    -------------------------------
  1019     05  FCERTYNL PIC S9(0004) COMP.
  1020     05  FCERTYNF PIC  X(0001).
  1021     05  FILLER REDEFINES FCERTYNF.
  1022         10  FCERTYNA PIC  X(0001).
  1023     05  FCERTYNI PIC  X(0003).
  1024*    -------------------------------
  1025     05  FCLMYNL PIC S9(0004) COMP.
  1026     05  FCLMYNF PIC  X(0001).
  1027     05  FILLER REDEFINES FCLMYNF.
  1028         10  FCLMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  23
* EL1276.cbl
  1029     05  FCLMYNI PIC  X(0003).
  1030*    -------------------------------
  1031     05  FNLINE1L PIC S9(0004) COMP.
  1032     05  FNLINE1F PIC  X(0001).
  1033     05  FILLER REDEFINES FNLINE1F.
  1034         10  FNLINE1A PIC  X(0001).
  1035     05  FNLINE1I PIC  X(0077).
  1036*    -------------------------------
  1037     05  FNLINE2L PIC S9(0004) COMP.
  1038     05  FNLINE2F PIC  X(0001).
  1039     05  FILLER REDEFINES FNLINE2F.
  1040         10  FNLINE2A PIC  X(0001).
  1041     05  FNLINE2I PIC  X(0077).
  1042*    -------------------------------
  1043     05  FNLINE3L PIC S9(0004) COMP.
  1044     05  FNLINE3F PIC  X(0001).
  1045     05  FILLER REDEFINES FNLINE3F.
  1046         10  FNLINE3A PIC  X(0001).
  1047     05  FNLINE3I PIC  X(0077).
  1048*    -------------------------------
  1049     05  FNLINE4L PIC S9(0004) COMP.
  1050     05  FNLINE4F PIC  X(0001).
  1051     05  FILLER REDEFINES FNLINE4F.
  1052         10  FNLINE4A PIC  X(0001).
  1053     05  FNLINE4I PIC  X(0077).
  1054*    -------------------------------
  1055     05  FNLINE5L PIC S9(0004) COMP.
  1056     05  FNLINE5F PIC  X(0001).
  1057     05  FILLER REDEFINES FNLINE5F.
  1058         10  FNLINE5A PIC  X(0001).
  1059     05  FNLINE5I PIC  X(0077).
  1060*    -------------------------------
  1061     05  FNLINE6L PIC S9(0004) COMP.
  1062     05  FNLINE6F PIC  X(0001).
  1063     05  FILLER REDEFINES FNLINE6F.
  1064         10  FNLINE6A PIC  X(0001).
  1065     05  FNLINE6I PIC  X(0077).
  1066*    -------------------------------
  1067     05  FNLINE7L PIC S9(0004) COMP.
  1068     05  FNLINE7F PIC  X(0001).
  1069     05  FILLER REDEFINES FNLINE7F.
  1070         10  FNLINE7A PIC  X(0001).
  1071     05  FNLINE7I PIC  X(0077).
  1072*    -------------------------------
  1073     05  FNLINE8L PIC S9(0004) COMP.
  1074     05  FNLINE8F PIC  X(0001).
  1075     05  FILLER REDEFINES FNLINE8F.
  1076         10  FNLINE8A PIC  X(0001).
  1077     05  FNLINE8I PIC  X(0077).
  1078*    -------------------------------
  1079     05  FNLINE9L PIC S9(0004) COMP.
  1080     05  FNLINE9F PIC  X(0001).
  1081     05  FILLER REDEFINES FNLINE9F.
  1082         10  FNLINE9A PIC  X(0001).
  1083     05  FNLINE9I PIC  X(0077).
  1084*    -------------------------------
  1085     05  FNLINEAL PIC S9(0004) COMP.
  1086     05  FNLINEAF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  24
* EL1276.cbl
  1087     05  FILLER REDEFINES FNLINEAF.
  1088         10  FNLINEAA PIC  X(0001).
  1089     05  FNLINEAI PIC  X(0077).
  1090*    -------------------------------
  1091     05  FERRMSGL PIC S9(0004) COMP.
  1092     05  FERRMSGF PIC  X(0001).
  1093     05  FILLER REDEFINES FERRMSGF.
  1094         10  FERRMSGA PIC  X(0001).
  1095     05  FERRMSGI PIC  X(0077).
  1096*    -------------------------------
  1097     05  FPFENTRL PIC S9(0004) COMP.
  1098     05  FPFENTRF PIC  X(0001).
  1099     05  FILLER REDEFINES FPFENTRF.
  1100         10  FPFENTRA PIC  X(0001).
  1101     05  FPFENTRI PIC  99.
  1102 01  EL127FO REDEFINES EL127FI.
  1103     05  FILLER            PIC  X(0012).
  1104*    -------------------------------
  1105     05  FILLER            PIC  X(0003).
  1106     05  FDATEO PIC  X(0008).
  1107*    -------------------------------
  1108     05  FILLER            PIC  X(0003).
  1109     05  FTIMEO PIC  99.99.
  1110*    -------------------------------
  1111     05  FILLER            PIC  X(0003).
  1112     05  CMPNYIDO PIC  X(0003).
  1113*    -------------------------------
  1114     05  FILLER            PIC  X(0003).
  1115     05  USERIDO PIC  X(0004).
  1116*    -------------------------------
  1117     05  FILLER            PIC  X(0003).
  1118     05  FMAINTO PIC  X(0001).
  1119*    -------------------------------
  1120     05  FILLER            PIC  X(0003).
  1121     05  FCERTO PIC  X(0010).
  1122*    -------------------------------
  1123     05  FILLER            PIC  X(0003).
  1124     05  FCRTSFXO PIC  X(0001).
  1125*    -------------------------------
  1126     05  FILLER            PIC  X(0003).
  1127     05  FACOUNTO PIC  X(0010).
  1128*    -------------------------------
  1129     05  FILLER            PIC  X(0003).
  1130     05  FSTO PIC  X(0002).
  1131*    -------------------------------
  1132     05  FILLER            PIC  X(0003).
  1133     05  FCARRIRO PIC  X(0001).
  1134*    -------------------------------
  1135     05  FILLER            PIC  X(0003).
  1136     05  FGROUPO PIC  X(0006).
  1137*    -------------------------------
  1138     05  FILLER            PIC  X(0003).
  1139     05  FEFFDTO PIC  X(0008).
  1140*    -------------------------------
  1141     05  FILLER            PIC  X(0003).
  1142     05  FBSTARTO PIC  99.
  1143*    -------------------------------
  1144     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  25
* EL1276.cbl
  1145     05  MAINTONO PIC  X(0008).
  1146*    -------------------------------
  1147     05  FILLER            PIC  X(0003).
  1148     05  MAINTATO PIC  99.99.
  1149*    -------------------------------
  1150     05  FILLER            PIC  X(0003).
  1151     05  MAINTBYO PIC  X(0004).
  1152*    -------------------------------
  1153     05  FILLER            PIC  X(0003).
  1154     05  FBENDO PIC  99.
  1155*    -------------------------------
  1156     05  FILLER            PIC  X(0003).
  1157     05  FCERTYNO PIC  X(0003).
  1158*    -------------------------------
  1159     05  FILLER            PIC  X(0003).
  1160     05  FCLMYNO PIC  X(0003).
  1161*    -------------------------------
  1162     05  FILLER            PIC  X(0003).
  1163     05  FNLINE1O PIC  X(0077).
  1164*    -------------------------------
  1165     05  FILLER            PIC  X(0003).
  1166     05  FNLINE2O PIC  X(0077).
  1167*    -------------------------------
  1168     05  FILLER            PIC  X(0003).
  1169     05  FNLINE3O PIC  X(0077).
  1170*    -------------------------------
  1171     05  FILLER            PIC  X(0003).
  1172     05  FNLINE4O PIC  X(0077).
  1173*    -------------------------------
  1174     05  FILLER            PIC  X(0003).
  1175     05  FNLINE5O PIC  X(0077).
  1176*    -------------------------------
  1177     05  FILLER            PIC  X(0003).
  1178     05  FNLINE6O PIC  X(0077).
  1179*    -------------------------------
  1180     05  FILLER            PIC  X(0003).
  1181     05  FNLINE7O PIC  X(0077).
  1182*    -------------------------------
  1183     05  FILLER            PIC  X(0003).
  1184     05  FNLINE8O PIC  X(0077).
  1185*    -------------------------------
  1186     05  FILLER            PIC  X(0003).
  1187     05  FNLINE9O PIC  X(0077).
  1188*    -------------------------------
  1189     05  FILLER            PIC  X(0003).
  1190     05  FNLINEAO PIC  X(0077).
  1191*    -------------------------------
  1192     05  FILLER            PIC  X(0003).
  1193     05  FERRMSGO PIC  X(0077).
  1194*    -------------------------------
  1195     05  FILLER            PIC  X(0003).
  1196     05  FPFENTRO PIC  X(0002).
  1197*    -------------------------------
  1198
  1199 01  FILLER REDEFINES EL127FO.
  1200     05  FILLER                      PIC X(155).
  1201     05  DNOTE-LINES   OCCURS 10 TIMES.
  1202         10  DNOTE-LINE-LENGTH       PIC S9(4) COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  26
* EL1276.cbl
  1203         10  DNOTE-LINE-ATTRB        PIC X.
  1204         10  DNOTE-LINE              PIC X(77).
  1205     05  FILLER                      PIC X(85).
  1206
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  27
* EL1276.cbl
  1208
  1209****************************************************************
  1210*
  1211* Copyright (c) 2007 by Clerity Solutions, Inc.
  1212* All rights reserved.
  1213*
  1214****************************************************************
  1215 01  DFHEIV.
  1216   02  DFHEIV0               PIC X(35).
  1217   02  DFHEIV1               PIC X(08).
  1218   02  DFHEIV2               PIC X(08).
  1219   02  DFHEIV3               PIC X(08).
  1220   02  DFHEIV4               PIC X(06).
  1221   02  DFHEIV5               PIC X(04).
  1222   02  DFHEIV6               PIC X(04).
  1223   02  DFHEIV7               PIC X(02).
  1224   02  DFHEIV8               PIC X(02).
  1225   02  DFHEIV9               PIC X(01).
  1226   02  DFHEIV10              PIC S9(7) COMP-3.
  1227   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1228   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1229   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1230   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1231   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1232   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1233   02  DFHEIV17              PIC X(04).
  1234   02  DFHEIV18              PIC X(04).
  1235   02  DFHEIV19              PIC X(04).
  1236   02  DFHEIV20              USAGE IS POINTER.
  1237   02  DFHEIV21              USAGE IS POINTER.
  1238   02  DFHEIV22              USAGE IS POINTER.
  1239   02  DFHEIV23              USAGE IS POINTER.
  1240   02  DFHEIV24              USAGE IS POINTER.
  1241   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1242   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1243   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1244   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1245   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1246   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1247   02  FILLER                PIC X(02).
  1248   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1249   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1250   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1251   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1252   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1253 LINKAGE  SECTION.
  1254*****************************************************************
  1255*                                                               *
  1256* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1257* All rights reserved.                                          *
  1258*                                                               *
  1259*****************************************************************
  1260 01  dfheiblk.
  1261     02  eibtime          pic s9(7) comp-3.
  1262     02  eibdate          pic s9(7) comp-3.
  1263     02  eibtrnid         pic x(4).
  1264     02  eibtaskn         pic s9(7) comp-3.
  1265     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  28
* EL1276.cbl
  1266     02  dfheigdi         pic s9(4) comp.
  1267     02  eibcposn         pic s9(4) comp.
  1268     02  eibcalen         pic s9(4) comp.
  1269     02  eibaid           pic x(1).
  1270     02  eibfiller1       pic x(1).
  1271     02  eibfn            pic x(2).
  1272     02  eibfiller2       pic x(2).
  1273     02  eibrcode         pic x(6).
  1274     02  eibfiller3       pic x(2).
  1275     02  eibds            pic x(8).
  1276     02  eibreqid         pic x(8).
  1277     02  eibrsrce         pic x(8).
  1278     02  eibsync          pic x(1).
  1279     02  eibfree          pic x(1).
  1280     02  eibrecv          pic x(1).
  1281     02  eibsend          pic x(1).
  1282     02  eibatt           pic x(1).
  1283     02  eibeoc           pic x(1).
  1284     02  eibfmh           pic x(1).
  1285     02  eibcompl         pic x(1).
  1286     02  eibsig           pic x(1).
  1287     02  eibconf          pic x(1).
  1288     02  eiberr           pic x(1).
  1289     02  eibrldbk         pic x(1).
  1290     02  eiberrcd         pic x(4).
  1291     02  eibsynrb         pic x(1).
  1292     02  eibnodat         pic x(1).
  1293     02  eibfiller5       pic x(2).
  1294     02  eibresp          pic 9(09) comp.
  1295     02  eibresp2         pic 9(09) comp.
  1296     02  dfheigdj         pic s9(4) comp.
  1297     02  dfheigdk         pic s9(4) comp.
  1298 01  DFHCOMMAREA                     PIC X(1024).
  1299
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  29
* EL1276.cbl
  1301
  1302*    COPY ERCNOTE.
  1303******************************************************************
  1304*                                                                *
  1305*                                                                *
  1306*                            ERCNOTE                             *
  1307*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1308*                            VMOD=2.003                          *
  1309*                                                                *
  1310*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  1311*                                                                *
  1312*        FILE TYPE= VSAM,KSDS                                    *
  1313*        RECORD SIZE = 825    RECFORM = FIXED                    *
  1314*                                                                *
  1315*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  1316*                                                                *
  1317*        LOG = YES                                               *
  1318*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1319*                                                                *
  1320******************************************************************
  1321*                   C H A N G E   L O G
  1322*
  1323* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1324*-----------------------------------------------------------------
  1325*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1326* EFFECTIVE    NUMBER
  1327*-----------------------------------------------------------------
  1328* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  1329*                                FILE WILL CONTAIN BILLING NOTES O
  1330******************************************************************
  1331
  1332 01  CERTIFICATE-NOTE.
  1333     12  CN-RECORD-ID                PIC  XX.
  1334         88  VALID-CN-ID                  VALUE 'CN'.
  1335
  1336     12  CN-CONTROL-PRIMARY.
  1337         16  CN-COMPANY-CD           PIC X.
  1338         16  CN-CARRIER              PIC X.
  1339         16  CN-GROUPING.
  1340             20 CN-GROUPING-PREFIX   PIC XXX.
  1341             20 CN-GROUPING-PRIME    PIC XXX.
  1342         16  CN-STATE                PIC XX.
  1343         16  CN-ACCOUNT.
  1344             20 CN-ACCOUNT-PREFIX    PIC X(4).
  1345             20 CN-ACCOUNT-PRIME     PIC X(6).
  1346         16  CN-CERT-EFF-DT          PIC XX.
  1347         16  CN-CERT-NO.
  1348             20  CN-CERT-PRIME       PIC X(10).
  1349             20  CN-CERT-SFX         PIC X.
  1350
  1351     12  CN-BILLING-START-LINE-NO    PIC 99.
  1352     12  CN-BILLING-END-LINE-NO      PIC 99.
  1353
  1354     12  CN-LINES.
  1355         16  CN-LINE OCCURS 10       PIC X(77).
  1356
  1357     12  CN-LAST-MAINT-DT            PIC XX.
  1358     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  30
* EL1276.cbl
  1359     12  CN-LAST-MAINT-USER          PIC X(4).
  1360     12  FILLER                      PIC X(6).
  1361******************************************************************
  1362
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  31
* EL1276.cbl
  1364
  1365*    COPY ELCCERT.
  1366******************************************************************
  1367*                                                                *
  1368*                            ELCCERT.                            *
  1369*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1370*                            VMOD=2.013                          *
  1371*                                                                *
  1372*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1373*                                                                *
  1374*   FILE TYPE = VSAM,KSDS                                        *
  1375*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1376*                                                                *
  1377*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1378*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1379*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1380*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1381*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1382*                                                                *
  1383*   LOG = YES                                                    *
  1384*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1385******************************************************************
  1386*                   C H A N G E   L O G
  1387*
  1388* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1389*-----------------------------------------------------------------
  1390*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1391* EFFECTIVE    NUMBER
  1392*-----------------------------------------------------------------
  1393* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1394* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1395* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1396* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1397* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1398* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1399* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1400******************************************************************
  1401
  1402 01  CERTIFICATE-MASTER.
  1403     12  CM-RECORD-ID                      PIC XX.
  1404         88  VALID-CM-ID                      VALUE 'CM'.
  1405
  1406     12  CM-CONTROL-PRIMARY.
  1407         16  CM-COMPANY-CD                 PIC X.
  1408         16  CM-CARRIER                    PIC X.
  1409         16  CM-GROUPING.
  1410             20  CM-GROUPING-PREFIX        PIC X(3).
  1411             20  CM-GROUPING-PRIME         PIC X(3).
  1412         16  CM-STATE                      PIC XX.
  1413         16  CM-ACCOUNT.
  1414             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1415             20  CM-ACCOUNT-PRIME          PIC X(6).
  1416         16  CM-CERT-EFF-DT                PIC XX.
  1417         16  CM-CERT-NO.
  1418             20  CM-CERT-PRIME             PIC X(10).
  1419             20  CM-CERT-SFX               PIC X.
  1420
  1421     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  32
* EL1276.cbl
  1422         16  CM-COMPANY-CD-A1              PIC X.
  1423         16  CM-INSURED-LAST-NAME          PIC X(15).
  1424         16  CM-INSURED-INITIALS.
  1425             20  CM-INSURED-INITIAL1       PIC X.
  1426             20  CM-INSURED-INITIAL2       PIC X.
  1427
  1428     12  CM-CONTROL-BY-SSN.
  1429         16  CM-COMPANY-CD-A2              PIC X.
  1430         16  CM-SOC-SEC-NO.
  1431             20  CM-SSN-STATE              PIC XX.
  1432             20  CM-SSN-ACCOUNT            PIC X(6).
  1433             20  CM-SSN-LN3.
  1434                 25  CM-INSURED-INITIALS-A2.
  1435                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1436                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1437                 25 CM-PART-LAST-NAME-A2         PIC X.
  1438
  1439     12  CM-CONTROL-BY-CERT-NO.
  1440         16  CM-COMPANY-CD-A4              PIC X.
  1441         16  CM-CERT-NO-A4                 PIC X(11).
  1442
  1443     12  CM-CONTROL-BY-MEMB.
  1444         16  CM-COMPANY-CD-A5              PIC X.
  1445         16  CM-MEMBER-NO.
  1446             20  CM-MEMB-STATE             PIC XX.
  1447             20  CM-MEMB-ACCOUNT           PIC X(6).
  1448             20  CM-MEMB-LN4.
  1449                 25  CM-INSURED-INITIALS-A5.
  1450                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1451                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1452                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1453
  1454     12  CM-INSURED-PROFILE-DATA.
  1455         16  CM-INSURED-FIRST-NAME.
  1456             20  CM-INSURED-1ST-INIT       PIC X.
  1457             20  FILLER                    PIC X(9).
  1458         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1459         16  CM-INSURED-SEX                PIC X.
  1460             88  CM-SEX-MALE                  VALUE 'M'.
  1461             88  CM-SEX-FEMAL                 VALUE 'F'.
  1462         16  CM-INSURED-JOINT-AGE          PIC 99.
  1463         16  CM-JOINT-INSURED-NAME.
  1464             20  CM-JT-LAST-NAME           PIC X(15).
  1465             20  CM-JT-FIRST-NAME.
  1466                 24  CM-JT-1ST-INIT        PIC X.
  1467                 24  FILLER                PIC X(9).
  1468             20  CM-JT-INITIAL             PIC X.
  1469
  1470     12  CM-LIFE-DATA.
  1471         16  CM-LF-BENEFIT-CD              PIC XX.
  1472         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1473         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1474         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1475         16  CM-LF-DEV-CODE                PIC XXX.
  1476         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1477         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1478         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1479         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  33
* EL1276.cbl
  1480         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1481         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1482         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1483         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1484         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1485         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1486         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1487         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1488         16  FILLER                        PIC XX.
  1489
  1490     12  CM-AH-DATA.
  1491         16  CM-AH-BENEFIT-CD              PIC XX.
  1492         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1493         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1494         16  CM-AH-DEV-CODE                PIC XXX.
  1495         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1496         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1497         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1498         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1499         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1500         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1501         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1502         16  CM-AH-PAID-THRU-DT            PIC XX.
  1503             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1504         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1505         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1506         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1507         16  FILLER                        PIC X.
  1508
  1509     12  CM-LOAN-INFORMATION.
  1510         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1511         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1512         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1513         16  CM-PAY-FREQUENCY              PIC S99.
  1514         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1515         16  CM-RATE-CLASS                 PIC XX.
  1516         16  CM-BENEFICIARY                PIC X(25).
  1517         16  CM-POLICY-FORM-NO             PIC X(12).
  1518         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1519         16  CM-LAST-ADD-ON-DT             PIC XX.
  1520         16  CM-DEDUCTIBLE-AMOUNTS.
  1521             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1522             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1523         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1524             20  CM-RESIDENT-STATE         PIC XX.
  1525             20  CM-RATE-CODE              PIC X(4).
  1526             20  FILLER                    PIC XX.
  1527         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1528             20  CM-LOAN-OFFICER           PIC X(5).
  1529             20  FILLER                    PIC XXX.
  1530         16  CM-CSR-CODE                   PIC XXX.
  1531         16  CM-UNDERWRITING-CODE          PIC X.
  1532             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1533         16  CM-POST-CARD-IND              PIC X.
  1534         16  CM-NH-INTERFACE-SW            PIC X.
  1535         16  CM-PREMIUM-TYPE               PIC X.
  1536             88  CM-SING-PRM                  VALUE '1'.
  1537             88  CM-O-B-COVERAGE              VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  34
* EL1276.cbl
  1538             88  CM-OPEN-END                  VALUE '3'.
  1539         16  CM-IND-GRP-TYPE               PIC X.
  1540             88  CM-INDIVIDUAL                VALUE 'I'.
  1541             88  CM-GROUP                     VALUE 'G'.
  1542         16  CM-SKIP-CODE                  PIC X.
  1543             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1544             88  SKIP-JULY                    VALUE '1'.
  1545             88  SKIP-AUGUST                  VALUE '2'.
  1546             88  SKIP-SEPTEMBER               VALUE '3'.
  1547             88  SKIP-JULY-AUG                VALUE '4'.
  1548             88  SKIP-AUG-SEPT                VALUE '5'.
  1549             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1550             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1551             88  SKIP-JUNE                    VALUE '8'.
  1552             88  SKIP-JUNE-JULY               VALUE '9'.
  1553             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1554             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1555         16  CM-PAYMENT-MODE               PIC X.
  1556             88  PAY-MONTHLY                  VALUE SPACE.
  1557             88  PAY-WEEKLY                   VALUE '1'.
  1558             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1559             88  PAY-BI-WEEKLY                VALUE '3'.
  1560             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1561         16  CM-LOAN-NUMBER                PIC X(8).
  1562         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1563         16  CM-OLD-LOF                    PIC XXX.
  1564*        16  CM-LOAN-OFFICER               PIC XXX.
  1565         16  CM-REIN-TABLE                 PIC XXX.
  1566         16  CM-SPECIAL-REIN-CODE          PIC X.
  1567         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1568         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1569         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1570
  1571     12  CM-STATUS-DATA.
  1572         16  CM-ENTRY-STATUS               PIC X.
  1573         16  CM-ENTRY-DT                   PIC XX.
  1574
  1575         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1576         16  CM-LF-CANCEL-DT               PIC XX.
  1577         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1578
  1579         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1580         16  CM-LF-DEATH-DT                PIC XX.
  1581         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1582
  1583         16  CM-LF-CURRENT-STATUS          PIC X.
  1584             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1585                                                'M' '4' '5' '9'.
  1586             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1587             88  CM-LF-POLICY-PENDING         VALUE '2'.
  1588             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1589             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1590             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1591             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1592             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1593             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1594             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1595             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  35
* EL1276.cbl
  1596             88  CM-LF-DECLINED               VALUE 'D'.
  1597             88  CM-LF-VOIDED                 VALUE 'V'.
  1598
  1599         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1600         16  CM-AH-CANCEL-DT               PIC XX.
  1601         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1602
  1603         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1604         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1605         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1606
  1607         16  CM-AH-CURRENT-STATUS          PIC X.
  1608             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1609                                                'M' '4' '5' '9'.
  1610             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1611             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1612             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1613             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1614             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1615             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1616             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1617             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1618             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1619             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1620             88  CM-AH-DECLINED               VALUE 'D'.
  1621             88  CM-AH-VOIDED                 VALUE 'V'.
  1622
  1623         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1624             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1625             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1626             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1627         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1628
  1629         16  CM-ENTRY-BATCH                PIC X(6).
  1630         16  CM-LF-EXIT-BATCH              PIC X(6).
  1631         16  CM-AH-EXIT-BATCH              PIC X(6).
  1632         16  CM-LAST-MONTH-END             PIC XX.
  1633
  1634     12  CM-NOTE-SW                        PIC X.
  1635         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1636         88  CERT-NOTES-PRESENT               VALUE '1'.
  1637         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1638         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1639         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1640         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1641         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1642         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1643     12  CM-COMP-EXCP-SW                   PIC X.
  1644         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1645         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1646     12  CM-INSURED-ADDRESS-SW             PIC X.
  1647         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1648         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1649
  1650*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1651     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1652     12  FILLER                            PIC X.
  1653
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  36
* EL1276.cbl
  1654*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1655     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1656     12  FILLER                            PIC X.
  1657*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1658     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  1659
  1660     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1661         88  CERT-ADDED-BATCH                 VALUE ' '.
  1662         88  CERT-ADDED-ONLINE                VALUE '1'.
  1663         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1664         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1665         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1666     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1667         88  CERT-AS-LOADED                   VALUE ' '.
  1668         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1669         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1670         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1671         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1672         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1673         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1674         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1675
  1676     12  CM-ACCOUNT-COMM-PCTS.
  1677         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1678         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1679
  1680     12  CM-USER-FIELD                     PIC X.
  1681     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1682     12  CM-CLP-STATE                      PIC XX.
  1683     12  CM-USER-RESERVED                  PIC XXX.
  1684******************************************************************
  1685
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  37
* EL1276.cbl
  1687
  1688 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CERTIFICATE-NOTE
  1689                          CERTIFICATE-MASTER.
  1690 0000-DFHEXIT SECTION.
  1691     MOVE '9#                    $   ' TO DFHEIV0.
  1692     MOVE 'EL1276' TO DFHEIV1.
  1693     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1694
  1695     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  1696     MOVE '5'                    TO  DC-OPTION-CODE.
  1697     PERFORM 9700-DATE-LINK.
  1698     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  1699     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  1700
  1701     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  1702     MOVE 1                      TO  EMI-NUMBER-OF-LINES.
  1703     MOVE EIBTRMID               TO  QID-TERM.
  1704
  1705     IF EIBCALEN = 0
  1706         GO TO 8800-UNAUTHORIZED-ACCESS.
  1707
  1708     IF PI-CALLING-PROGRAM = PGM-1279
  1709         MOVE THIS-PGM           TO PI-CALLING-PROGRAM
  1710     END-IF.
  1711
  1712     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1713         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1714             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1715             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1716             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1717             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1718             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1719             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1720             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1721             MOVE THIS-PGM TO PI-CALLING-PROGRAM
  1722         ELSE
  1723             MOVE PI-CALLING-PROGRAM   TO RETURN-FROM
  1724             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1725             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1726             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1727             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1728             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1729             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1730             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1731             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  1732
  1733
  1734* EXEC CICS HANDLE AID
  1735*         CLEAR(9400-CLEAR)
  1736*    END-EXEC.
  1737*    MOVE '"&=                  V! " #00001729' TO DFHEIV0
  1738     MOVE X'22263D202020202020202020' TO DFHEIV0(1:12)
  1739     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  1740     MOVE X'2220233030303031373239' TO DFHEIV0(25:11)
  1741     CALL 'kxdfhei1' USING DFHEIV0
  1742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1743
  1744*     IF EIBAID = DFHCLEAR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  38
* EL1276.cbl
  1745*         GO TO 9400-CLEAR.
  1746
  1747     IF PI-PROCESSOR-ID = 'LGXX'
  1748         NEXT SENTENCE
  1749     ELSE
  1750
  1751* EXEC CICS READQ TS
  1752*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  1753*            INTO    (SECURITY-CONTROL)
  1754*            LENGTH  (SC-COMM-LENGTH)
  1755*            ITEM    (SC-ITEM)
  1756*        END-EXEC
  1757*    MOVE '*$II   L              ''   #00001738' TO DFHEIV0
  1758     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1759     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1760     MOVE X'2020233030303031373338' TO DFHEIV0(25:11)
  1761     CALL 'kxdfhei1' USING DFHEIV0,
  1762           PI-SECURITY-TEMP-STORE-ID,
  1763           SECURITY-CONTROL,
  1764           SC-COMM-LENGTH,
  1765           SC-ITEM,
  1766           DFHEIV99,
  1767           DFHEIV99
  1768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1769         MOVE SC-CREDIT-DISPLAY (32)   TO  PI-DISPLAY-CAP
  1770         MOVE SC-CREDIT-UPDATE  (32)   TO  PI-MODIFY-CAP
  1771         IF NOT DISPLAY-CAP
  1772             MOVE 'READ'               TO  SM-READ
  1773             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1774             MOVE ER-0070              TO  EMI-ERROR
  1775             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1776             GO TO 8100-SEND-INITIAL-MAP.
  1777
  1778     IF  EIBTRNID NOT = TRANS-ID
  1779         MOVE LOW-VALUES         TO  EL127FI
  1780         PERFORM 7000-FORMAT-SCREEN
  1781         GO TO 8100-SEND-INITIAL-MAP.
  1782
  1783     IF NOT MODIFY-CAP
  1784         MOVE 'UPDATE'           TO  SM-READ
  1785         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1786         MOVE ER-0070            TO  EMI-ERROR
  1787         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1788         GO TO 8100-SEND-INITIAL-MAP.
  1789
  1790
  1791* EXEC CICS    HANDLE    CONDITION
  1792*         PGMIDERR          (9600-PGMID-ERROR)
  1793*         ERROR             (9990-ABEND)
  1794*         END-EXEC.
  1795*    MOVE '"$L.                  ! # #00001765' TO DFHEIV0
  1796     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1797     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1798     MOVE X'2320233030303031373635' TO DFHEIV0(25:11)
  1799     CALL 'kxdfhei1' USING DFHEIV0
  1800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1801
  1802
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  39
* EL1276.cbl
  1804
  1805 0200-RECEIVE.
  1806     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1807         MOVE ER-0008            TO  EMI-ERROR
  1808         PERFORM 9900-ERROR-FORMAT
  1809         MOVE -1                 TO  FMAINTL
  1810         GO TO 8200-SEND-DATAONLY.
  1811
  1812
  1813* EXEC CICS RECEIVE
  1814*        MAP      (MAP-NAME)
  1815*        MAPSET   (MAPSET-NAME)
  1816*        INTO     (EL127FI)
  1817*    END-EXEC.
  1818     MOVE LENGTH OF
  1819      EL127FI
  1820       TO DFHEIV11
  1821*    MOVE '8"T I  L              ''   #00001779' TO DFHEIV0
  1822     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1823     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1824     MOVE X'2020233030303031373739' TO DFHEIV0(25:11)
  1825     CALL 'kxdfhei1' USING DFHEIV0,
  1826           MAP-NAME,
  1827           EL127FI,
  1828           DFHEIV11,
  1829           MAPSET-NAME,
  1830           DFHEIV99,
  1831           DFHEIV99
  1832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1833
  1834
  1835     IF FPFENTRL = 0
  1836         GO TO 0300-CHECK-PFKEYS.
  1837
  1838     IF EIBAID NOT = DFHENTER
  1839         MOVE ER-0004            TO  EMI-ERROR
  1840         GO TO 0320-INPUT-ERROR.
  1841
  1842     IF  FPFENTRI NUMERIC
  1843         IF  FPFENTRI = '12' OR '23' OR '24'
  1844             MOVE PF-VALUES (FPFENTRI)   TO  EIBAID
  1845         ELSE
  1846             MOVE ER-0029                TO  EMI-ERROR
  1847             GO TO 0320-INPUT-ERROR.
  1848
  1849 0300-CHECK-PFKEYS.
  1850     IF EIBAID = DFHPF23
  1851         GO TO 8810-PF23.
  1852
  1853     IF EIBAID = DFHPF24
  1854         GO TO 9200-RETURN-MAIN-MENU.
  1855
  1856     IF EIBAID = DFHPF12
  1857         GO TO 9500-PF12.
  1858
  1859     IF EIBAID = DFHPF5
  1860         MOVE PGM-1279         TO PGM-NAME
  1861         SET PI-CERT-NOTE     TO TRUE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  40
* EL1276.cbl
  1862         GO TO 9300-XCTL
  1863     END-IF.
  1864
  1865     IF EIBAID = DFHPF6
  1866         MOVE PGM-1279         TO PGM-NAME
  1867         SET PI-CLAIM-NOTE     TO TRUE
  1868         GO TO 9300-XCTL
  1869     END-IF.
  1870
  1871     IF EIBAID = DFHENTER
  1872         GO TO 400-EDIT-INPUT-DATA.
  1873
  1874     MOVE ER-0029                TO  EMI-ERROR.
  1875
  1876 0320-INPUT-ERROR.
  1877     PERFORM 9900-ERROR-FORMAT.
  1878     MOVE AL-UNBON               TO  FPFENTRA.
  1879
  1880     IF FPFENTRL = 0
  1881         MOVE -1                 TO  FMAINTL
  1882     ELSE
  1883         MOVE -1                 TO  FPFENTRL.
  1884
  1885     GO TO 8200-SEND-DATAONLY.
  1886
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  41
* EL1276.cbl
  1888
  1889 400-EDIT-INPUT-DATA.
  1890     IF FMAINTI = 'A' OR 'C' OR 'D'
  1891         NEXT SENTENCE
  1892     ELSE
  1893         MOVE ER-0023            TO  EMI-ERROR
  1894         MOVE -1                 TO  FMAINTL
  1895         MOVE AL-UABON           TO  FMAINTA
  1896         PERFORM 9900-ERROR-FORMAT
  1897         GO TO 8200-SEND-DATAONLY.
  1898
  1899     IF FMAINTI = 'D'
  1900         GO TO 410-CHECK-ERRORS.
  1901
  1902     IF FBSTARTL GREATER THAN ZERO
  1903        IF FBSTARTI NOT NUMERIC
  1904            MOVE ER-2520         TO  EMI-ERROR
  1905            MOVE AL-UNBON        TO  FBSTARTA
  1906            MOVE -1              TO  FBSTARTL
  1907            PERFORM 9900-ERROR-FORMAT
  1908        ELSE
  1909            IF FBSTARTI LESS '01' OR GREATER '10'
  1910                MOVE ER-2520     TO  EMI-ERROR
  1911                MOVE -1          TO  FBSTARTL
  1912                PERFORM 9900-ERROR-FORMAT.
  1913
  1914     IF FBENDL GREATER THAN ZERO
  1915        IF FBENDI NOT NUMERIC
  1916            MOVE ER-2521         TO  EMI-ERROR
  1917            MOVE AL-UNBON        TO  FBENDA
  1918            MOVE -1              TO  FBENDL
  1919            PERFORM 9900-ERROR-FORMAT
  1920        ELSE
  1921            IF FBENDI LESS '01' OR GREATER '10'
  1922                MOVE ER-2521     TO  EMI-ERROR
  1923                MOVE -1          TO  FBENDL
  1924                PERFORM 9900-ERROR-FORMAT.
  1925
  1926     IF FBENDL GREATER THAN ZEROS
  1927        IF FBSTARTL = ZEROS
  1928            MOVE ER-2524         TO  EMI-ERROR
  1929            MOVE -1              TO  FBSTARTL
  1930            PERFORM 9900-ERROR-FORMAT
  1931            GO TO 410-CHECK-ERRORS.
  1932
  1933     IF FBSTARTL = ZERO OR
  1934        FBENDL   = ZERO
  1935           GO TO 410-CHECK-ERRORS.
  1936
  1937     IF FBSTARTI GREATER THAN FBENDI
  1938         MOVE ER-2522            TO  EMI-ERROR
  1939         MOVE -1                 TO  FBSTARTL
  1940         PERFORM 9900-ERROR-FORMAT.
  1941
  1942 410-CHECK-ERRORS.
  1943     IF EMI-ERROR = ZEROS
  1944        NEXT SENTENCE
  1945     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  42
* EL1276.cbl
  1946         GO TO 8200-SEND-DATAONLY.
  1947
  1948     IF FMAINTI = 'A'
  1949         GO TO 1000-ADD-RECORD.
  1950
  1951     IF FMAINTI = 'C'
  1952         GO TO 2000-CHANGE-RECORD.
  1953
  1954     GO TO 3000-DELETE-RECORD.
  1955
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  43
* EL1276.cbl
  1957
  1958 1000-ADD-RECORD       SECTION.
  1959
  1960
  1961* EXEC CICS GETMAIN
  1962*        SET      (ADDRESS OF CERTIFICATE-NOTE)
  1963*        LENGTH   (825)
  1964*        INITIMG  (GETMAIN-SPACE)
  1965*    END-EXEC.
  1966     MOVE 825
  1967       TO DFHEIV11
  1968*    MOVE ',"IL                  $   #00001910' TO DFHEIV0
  1969     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  1970     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1971     MOVE X'2020233030303031393130' TO DFHEIV0(25:11)
  1972     CALL 'kxdfhei1' USING DFHEIV0,
  1973           DFHEIV20,
  1974           DFHEIV11,
  1975           GETMAIN-SPACE
  1976     SET ADDRESS OF CERTIFICATE-NOTE TO
  1977         DFHEIV20
  1978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1979
  1980
  1981     MOVE  SPACES                TO  CERTIFICATE-NOTE.
  1982
  1983     MOVE  'CN'                  TO  CN-RECORD-ID.
  1984
  1985     MOVE  PI-CARRIER            TO  WS-CM-CARRIER.
  1986     MOVE  PI-GROUPING           TO  WS-CM-GROUPING.
  1987     MOVE  PI-STATE              TO  WS-CM-STATE.
  1988     MOVE  PI-ACCOUNT            TO  WS-CM-ACCOUNT.
  1989     MOVE  PI-CERT-PRIME         TO  WS-CM-CERT-PRIME.
  1990     MOVE  PI-CERT-SFX           TO  WS-CM-CERT-SFX.
  1991     MOVE  PI-CERT-EFF-DT        TO  WS-CM-CERT-EFF-DT.
  1992     MOVE  PI-COMPANY-CD         TO  WS-CM-COMPANY-CD.
  1993
  1994     MOVE  WS-CM-CONTROL-PRIMARY TO  CN-CONTROL-PRIMARY.
  1995
  1996     IF FBSTARTL GREATER ZERO
  1997         MOVE FBSTARTI           TO  CN-BILLING-START-LINE-NO
  1998     ELSE
  1999         MOVE ZEROS              TO  CN-BILLING-START-LINE-NO.
  2000
  2001     IF FBENDL GREATER ZERO
  2002         MOVE FBENDI             TO  CN-BILLING-END-LINE-NO
  2003     ELSE
  2004         MOVE ZEROS              TO  CN-BILLING-END-LINE-NO.
  2005
  2006     IF FBENDL = ZEROS
  2007         IF FBSTARTL GREATER ZERO
  2008            MOVE FBSTARTI        TO  CN-BILLING-END-LINE-NO.
  2009
  2010     MOVE +0                     TO  WS-SUB1.
  2011
  2012 1100-BUILD-NOTE-LINES.
  2013     ADD +1                      TO  WS-SUB1.
  2014
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  44
* EL1276.cbl
  2015     IF WS-SUB1 GREATER +10
  2016        GO TO 1700-WRITE-RECORD.
  2017
  2018     IF DNOTE-LINE-LENGTH (WS-SUB1) GREATER ZERO
  2019         MOVE DNOTE-LINE   (WS-SUB1) TO  CN-LINE (WS-SUB1)
  2020         MOVE 'Y'                    TO  WS-NOTE-LINE-SW
  2021       ELSE
  2022         MOVE SPACES                 TO  CN-LINE (WS-SUB1).
  2023
  2024     GO TO 1100-BUILD-NOTE-LINES.
  2025
  2026 1700-WRITE-RECORD.
  2027     IF NOTE-LINES-PRESENT
  2028         NEXT SENTENCE
  2029     ELSE
  2030         MOVE ER-2523            TO  EMI-ERROR
  2031         MOVE -1                 TO  FMAINTL
  2032         PERFORM 9900-ERROR-FORMAT
  2033         GO TO 8200-SEND-DATAONLY.
  2034
  2035     MOVE PI-PROCESSOR-ID        TO  CN-LAST-MAINT-USER.
  2036     MOVE EIBTIME                TO  CN-LAST-MAINT-HHMMSS.
  2037     MOVE SAVE-BIN-DATE          TO  CN-LAST-MAINT-DT.
  2038
  2039     MOVE 'A'                    TO  JP-RECORD-TYPE.
  2040     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
  2041
  2042     PERFORM 6400-WRITE-NOTE-RECORD.
  2043
  2044     IF DUPLICATE-RECORD-FOUND
  2045         GO TO 1800-DUPLICATE-RECORD.
  2046
  2047     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2048             WS-ERNOTE-RECORD-LENGTH  +  23.
  2049
  2050     PERFORM 8400-LOG-JOURNAL-RECORD.
  2051     MOVE ER-0000                TO  EMI-ERROR.
  2052     PERFORM 9900-ERROR-FORMAT.
  2053     PERFORM 7000-FORMAT-SCREEN.
  2054     PERFORM 4000-CERTIFICATE-UPDATE.
  2055     GO TO 8100-SEND-INITIAL-MAP.
  2056
  2057 1800-DUPLICATE-RECORD.
  2058     MOVE ER-2525                TO  EMI-ERROR.
  2059     PERFORM 9900-ERROR-FORMAT.
  2060     PERFORM 7000-FORMAT-SCREEN.
  2061     GO TO 8100-SEND-INITIAL-MAP.
  2062
  2063 1900-EXIT.
  2064     EXIT.
  2065
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  45
* EL1276.cbl
  2067
  2068 2000-CHANGE-RECORD   SECTION.
  2069
  2070     MOVE  PI-CARRIER            TO  WS-CM-CARRIER.
  2071     MOVE  PI-GROUPING           TO  WS-CM-GROUPING.
  2072     MOVE  PI-STATE              TO  WS-CM-STATE.
  2073     MOVE  PI-ACCOUNT            TO  WS-CM-ACCOUNT.
  2074     MOVE  PI-CERT-PRIME         TO  WS-CM-CERT-PRIME.
  2075     MOVE  PI-CERT-SFX           TO  WS-CM-CERT-SFX.
  2076     MOVE  PI-CERT-EFF-DT        TO  WS-CM-CERT-EFF-DT.
  2077     MOVE  PI-COMPANY-CD         TO  WS-CM-COMPANY-CD.
  2078
  2079     PERFORM 6300-READ-NOTE-FILE-UPDT.
  2080
  2081     IF RECORD-NOT-FOUND
  2082         GO TO 1000-ADD-RECORD.
  2083
  2084     MOVE 'B'                    TO  JP-RECORD-TYPE.
  2085     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
  2086
  2087     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2088             WS-ERNOTE-RECORD-LENGTH  +  23.
  2089
  2090     PERFORM 8400-LOG-JOURNAL-RECORD.
  2091
  2092     IF FBSTARTL GREATER ZERO
  2093         MOVE FBSTARTI           TO  CN-BILLING-START-LINE-NO
  2094     ELSE
  2095         MOVE ZEROS              TO  CN-BILLING-START-LINE-NO.
  2096
  2097     IF FBENDL GREATER ZERO
  2098         MOVE FBENDI             TO  CN-BILLING-END-LINE-NO
  2099     ELSE
  2100         MOVE ZEROS              TO  CN-BILLING-END-LINE-NO.
  2101
  2102     MOVE +0                     TO  WS-SUB1.
  2103
  2104 2100-BUILD-NOTE-LINES.
  2105     ADD +1                      TO  WS-SUB1.
  2106
  2107     IF WS-SUB1 GREATER 10
  2108        GO TO 2700-REWRITE-RECORD.
  2109
  2110     IF DNOTE-LINE-LENGTH (WS-SUB1) GREATER ZERO
  2111         MOVE DNOTE-LINE   (WS-SUB1) TO  CN-LINE (WS-SUB1)
  2112         MOVE 'Y'                    TO  WS-NOTE-LINE-SW
  2113     ELSE
  2114         MOVE SPACES                 TO  CN-LINE (WS-SUB1).
  2115
  2116     GO TO 2100-BUILD-NOTE-LINES.
  2117
  2118 2700-REWRITE-RECORD.
  2119     IF NOTE-LINES-PRESENT
  2120         NEXT SENTENCE
  2121     ELSE
  2122         MOVE ER-2523            TO  EMI-ERROR
  2123         MOVE -1                 TO  FMAINTL
  2124         PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  46
* EL1276.cbl
  2125         GO TO 8200-SEND-DATAONLY.
  2126
  2127     MOVE PI-PROCESSOR-ID        TO  CN-LAST-MAINT-USER.
  2128     MOVE EIBTIME                TO  CN-LAST-MAINT-HHMMSS.
  2129     MOVE SAVE-BIN-DATE          TO  CN-LAST-MAINT-DT.
  2130
  2131     MOVE 'C'                    TO  JP-RECORD-TYPE.
  2132     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
  2133
  2134     PERFORM 6500-REWRITE-NOTE-RECORD.
  2135
  2136     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2137             WS-ERNOTE-RECORD-LENGTH  +  23.
  2138
  2139     PERFORM 8400-LOG-JOURNAL-RECORD.
  2140
  2141     MOVE ER-0000                TO  EMI-ERROR.
  2142     PERFORM 9900-ERROR-FORMAT.
  2143     PERFORM 7000-FORMAT-SCREEN.
  2144     PERFORM 4000-CERTIFICATE-UPDATE.
  2145     GO TO 8100-SEND-INITIAL-MAP.
  2146
  2147 2900-EXIT.
  2148     EXIT.
  2149
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  47
* EL1276.cbl
  2151
  2152 3000-DELETE-RECORD    SECTION.
  2153
  2154     MOVE  PI-CARRIER            TO  WS-CM-CARRIER.
  2155     MOVE  PI-GROUPING           TO  WS-CM-GROUPING.
  2156     MOVE  PI-STATE              TO  WS-CM-STATE.
  2157     MOVE  PI-ACCOUNT            TO  WS-CM-ACCOUNT.
  2158     MOVE  PI-CERT-PRIME         TO  WS-CM-CERT-PRIME.
  2159     MOVE  PI-CERT-SFX           TO  WS-CM-CERT-SFX.
  2160     MOVE  PI-CERT-EFF-DT        TO  WS-CM-CERT-EFF-DT.
  2161     MOVE  PI-COMPANY-CD         TO  WS-CM-COMPANY-CD.
  2162
  2163     PERFORM 6300-READ-NOTE-FILE-UPDT.
  2164
  2165     IF RECORD-NOT-FOUND
  2166        GO TO 3600-RECORD-PREVS-DELETED.
  2167
  2168     MOVE 'D'                    TO  JP-RECORD-TYPE.
  2169     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
  2170
  2171     PERFORM 6600-DELETE-NOTE-RECORD.
  2172
  2173     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2174             WS-ERNOTE-RECORD-LENGTH  +  23.
  2175
  2176     PERFORM 8400-LOG-JOURNAL-RECORD.
  2177     PERFORM 4000-CERTIFICATE-UPDATE.
  2178
  2179 3500-RECORD-DELETED.
  2180     MOVE SPACE                  TO  FMAINTO.
  2181     MOVE ER-0000                TO  EMI-ERROR.
  2182     MOVE -1                     TO  FMAINTL.
  2183     PERFORM 9900-ERROR-FORMAT.
  2184     GO TO 8200-SEND-DATAONLY.
  2185
  2186 3600-RECORD-PREVS-DELETED.
  2187     MOVE ER-2528                TO  EMI-ERROR.
  2188     MOVE -1                     TO  FMAINTL.
  2189     PERFORM 9900-ERROR-FORMAT.
  2190     GO TO 8200-SEND-DATAONLY.
  2191
  2192 3900-EXIT.
  2193     EXIT.
  2194
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  48
* EL1276.cbl
  2196
  2197 4000-CERTIFICATE-UPDATE         SECTION.
  2198
  2199
  2200* EXEC CICS HANDLE CONDITION
  2201*        NOTFND   (4400-NOT-FOUND)
  2202*    END-EXEC.
  2203*    MOVE '"$I                   ! $ #00002134' TO DFHEIV0
  2204     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2205     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2206     MOVE X'2420233030303032313334' TO DFHEIV0(25:11)
  2207     CALL 'kxdfhei1' USING DFHEIV0
  2208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2209
  2210
  2211
  2212* EXEC CICS READ
  2213*        EQUAL
  2214*        DATASET   (ELCERT-ID)
  2215*        SET       (ADDRESS OF CERTIFICATE-MASTER)
  2216*        RIDFLD    (WS-CM-CONTROL-PRIMARY)
  2217*        UPDATE
  2218*    END-EXEC.
  2219*    MOVE '&"S        EU         (   #00002138' TO DFHEIV0
  2220     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2221     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2222     MOVE X'2020233030303032313338' TO DFHEIV0(25:11)
  2223     CALL 'kxdfhei1' USING DFHEIV0,
  2224           ELCERT-ID,
  2225           DFHEIV20,
  2226           DFHEIV99,
  2227           WS-CM-CONTROL-PRIMARY,
  2228           DFHEIV99,
  2229           DFHEIV99,
  2230           DFHEIV99
  2231     SET ADDRESS OF CERTIFICATE-MASTER TO
  2232         DFHEIV20
  2233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2234
  2235
  2236     IF FMAINTI = 'D'
  2237       IF CM-NOTE-SW = '2'
  2238         MOVE SPACE              TO  CM-NOTE-SW
  2239       ELSE
  2240         IF CM-NOTE-SW = '3'
  2241            MOVE '1'             TO  CM-NOTE-SW
  2242         ELSE
  2243           IF CM-NOTE-SW = '6'
  2244              MOVE '4'           TO  CM-NOTE-SW
  2245           ELSE
  2246             IF CM-NOTE-SW = '7'
  2247                MOVE '5'         TO  CM-NOTE-SW
  2248             END-IF
  2249           END-IF
  2250         END-IF
  2251       END-IF
  2252       MOVE 'N'                  TO  PI-BILLING-NOTES-EXIST
  2253       GO TO 4200-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  49
* EL1276.cbl
  2254     END-IF.
  2255
  2256     IF CM-NOTE-SW = ' '
  2257         MOVE '2'                TO  CM-NOTE-SW
  2258     ELSE
  2259       IF CM-NOTE-SW = '1'
  2260          MOVE '3'               TO  CM-NOTE-SW
  2261       ELSE
  2262         IF CM-NOTE-SW = '4'
  2263            MOVE '6'             TO  CM-NOTE-SW
  2264         ELSE
  2265           IF CM-NOTE-SW = '5'
  2266              MOVE '7'           TO  CM-NOTE-SW
  2267           END-IF
  2268         END-IF
  2269       END-IF
  2270     END-IF.
  2271     MOVE 'Y'                    TO  PI-BILLING-NOTES-EXIST
  2272     GO TO 4200-REWRITE-CERT-MASTER.
  2273
  2274     MOVE 'B'                    TO  JP-RECORD-TYPE.
  2275     MOVE CERTIFICATE-MASTER     TO  JP-RECORD-AREA.
  2276
  2277     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2278             WS-ELCERT-RECORD-LENGTH  +  23.
  2279
  2280     PERFORM 8400-LOG-JOURNAL-RECORD.
  2281
  2282*00619      IF CN-BILLING-START-LINE-NO = ZERO
  2283*00620          MOVE '1'                TO  CM-NOTE-SW
  2284*00621          GO TO 4200-REWRITE-CERT-MASTER.
  2285*00622
  2286*00623      MOVE +0                     TO  WS-SUB1.
  2287*00624      MOVE +2                     TO  CM-NOTE-SW.
  2288*00625
  2289*00626  4100-CHECK-NOTE-LINE.
  2290*00627      ADD +1  TO  WS-SUB1.
  2291*00628
  2292*00629      IF WS-SUB1 GREATER +10
  2293*00630          GO TO 4200-REWRITE-CERT-MASTER.
  2294*00631
  2295*00632      IF WS-SUB1 LESS    CN-BILLING-START-LINE-NO  OR
  2296*00633                 GREATER CN-BILLING-END-LINE-NO
  2297*00634          NEXT SENTENCE
  2298*00635      ELSE
  2299*00636          GO TO 4100-CHECK-NOTE-LINE.
  2300*00637
  2301*00638      IF CN-LINE (WS-SUB1) GREATER THAN SPACES
  2302*00639          MOVE  3                 TO  CM-NOTE-SW
  2303*00640          GO TO 4200-REWRITE-CERT-MASTER
  2304*00641      ELSE
  2305*00642          GO TO 4100-CHECK-NOTE-LINE.
  2306
  2307 4200-REWRITE-CERT-MASTER.
  2308     MOVE 'C'                    TO  JP-RECORD-TYPE.
  2309     MOVE CERTIFICATE-MASTER     TO  JP-RECORD-AREA.
  2310
  2311
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  50
* EL1276.cbl
  2312* EXEC CICS REWRITE
  2313*        FROM      (CERTIFICATE-MASTER)
  2314*        DATASET   (ELCERT-ID)
  2315*    END-EXEC.
  2316     MOVE LENGTH OF
  2317      CERTIFICATE-MASTER
  2318       TO DFHEIV11
  2319*    MOVE '&& L                  %   #00002221' TO DFHEIV0
  2320     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2321     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2322     MOVE X'2020233030303032323231' TO DFHEIV0(25:11)
  2323     CALL 'kxdfhei1' USING DFHEIV0,
  2324           ELCERT-ID,
  2325           CERTIFICATE-MASTER,
  2326           DFHEIV11,
  2327           DFHEIV99
  2328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2329
  2330
  2331     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2332             WS-ELCERT-RECORD-LENGTH  +  23.
  2333
  2334     PERFORM 8400-LOG-JOURNAL-RECORD.
  2335
  2336     GO TO 4500-EXIT.
  2337
  2338 4400-NOT-FOUND.
  2339     MOVE -1                     TO  FMAINTL.
  2340     MOVE ER-0142                TO  EMI-ERROR.
  2341     PERFORM 9900-ERROR-FORMAT.
  2342     GO TO 8200-SEND-DATAONLY.
  2343
  2344 4500-EXIT.
  2345     EXIT.
  2346
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  51
* EL1276.cbl
  2348
  2349 6200-READ-NOTE-FILE             SECTION.
  2350
  2351
  2352* EXEC CICS HANDLE CONDITION
  2353*        NOTFND   (6250-NOT-FOUND)
  2354*    END-EXEC.
  2355*    MOVE '"$I                   ! % #00002246' TO DFHEIV0
  2356     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2357     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2358     MOVE X'2520233030303032323436' TO DFHEIV0(25:11)
  2359     CALL 'kxdfhei1' USING DFHEIV0
  2360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2361
  2362
  2363
  2364* EXEC CICS READ
  2365*        EQUAL
  2366*        DATASET   (ERNOTE-ID)
  2367*        SET       (ADDRESS OF CERTIFICATE-NOTE)
  2368*        RIDFLD    (WS-CM-CONTROL-PRIMARY)
  2369*    END-EXEC.
  2370*    MOVE '&"S        E          (   #00002250' TO DFHEIV0
  2371     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2372     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2373     MOVE X'2020233030303032323530' TO DFHEIV0(25:11)
  2374     CALL 'kxdfhei1' USING DFHEIV0,
  2375           ERNOTE-ID,
  2376           DFHEIV20,
  2377           DFHEIV99,
  2378           WS-CM-CONTROL-PRIMARY,
  2379           DFHEIV99,
  2380           DFHEIV99,
  2381           DFHEIV99
  2382     SET ADDRESS OF CERTIFICATE-NOTE TO
  2383         DFHEIV20
  2384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2385
  2386
  2387     GO TO 6290-EXIT.
  2388
  2389 6250-NOT-FOUND.
  2390     MOVE 'N'                    TO  WS-RECORD-FOUND-SW.
  2391
  2392 6290-EXIT.
  2393      EXIT.
  2394
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  52
* EL1276.cbl
  2396
  2397 6300-READ-NOTE-FILE-UPDT        SECTION.
  2398
  2399
  2400* EXEC CICS HANDLE CONDITION
  2401*        NOTFND   (6350-NOT-FOUND)
  2402*    END-EXEC.
  2403*    MOVE '"$I                   ! & #00002269' TO DFHEIV0
  2404     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2405     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2406     MOVE X'2620233030303032323639' TO DFHEIV0(25:11)
  2407     CALL 'kxdfhei1' USING DFHEIV0
  2408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2409
  2410
  2411
  2412* EXEC CICS READ
  2413*        EQUAL
  2414*        DATASET   (ERNOTE-ID)
  2415*        SET       (ADDRESS OF CERTIFICATE-NOTE)
  2416*        RIDFLD    (WS-CM-CONTROL-PRIMARY)
  2417*        UPDATE
  2418*    END-EXEC.
  2419*    MOVE '&"S        EU         (   #00002273' TO DFHEIV0
  2420     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2421     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2422     MOVE X'2020233030303032323733' TO DFHEIV0(25:11)
  2423     CALL 'kxdfhei1' USING DFHEIV0,
  2424           ERNOTE-ID,
  2425           DFHEIV20,
  2426           DFHEIV99,
  2427           WS-CM-CONTROL-PRIMARY,
  2428           DFHEIV99,
  2429           DFHEIV99,
  2430           DFHEIV99
  2431     SET ADDRESS OF CERTIFICATE-NOTE TO
  2432         DFHEIV20
  2433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2434
  2435
  2436        GO TO 6390-EXIT.
  2437
  2438 6350-NOT-FOUND.
  2439     MOVE 'N'                    TO  WS-RECORD-FOUND-SW.
  2440
  2441 6390-EXIT.
  2442      EXIT.
  2443
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  53
* EL1276.cbl
  2445
  2446 6400-WRITE-NOTE-RECORD          SECTION.
  2447
  2448
  2449* EXEC CICS HANDLE CONDITION
  2450*        DUPREC   (6450-DUPLICATE-RECORD)
  2451*    END-EXEC.
  2452*    MOVE '"$%                   ! '' #00002293' TO DFHEIV0
  2453     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  2454     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2455     MOVE X'2720233030303032323933' TO DFHEIV0(25:11)
  2456     CALL 'kxdfhei1' USING DFHEIV0
  2457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2458
  2459
  2460
  2461* EXEC CICS WRITE
  2462*        FROM      (CERTIFICATE-NOTE)
  2463*        DATASET   (ERNOTE-ID)
  2464*        RIDFLD    (WS-CM-CONTROL-PRIMARY)
  2465*    END-EXEC.
  2466     MOVE LENGTH OF
  2467      CERTIFICATE-NOTE
  2468       TO DFHEIV11
  2469*    MOVE '&$ L                  ''   #00002297' TO DFHEIV0
  2470     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2471     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2472     MOVE X'2020233030303032323937' TO DFHEIV0(25:11)
  2473     CALL 'kxdfhei1' USING DFHEIV0,
  2474           ERNOTE-ID,
  2475           CERTIFICATE-NOTE,
  2476           DFHEIV11,
  2477           WS-CM-CONTROL-PRIMARY,
  2478           DFHEIV99,
  2479           DFHEIV99
  2480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2481
  2482
  2483        GO TO 6490-EXIT.
  2484
  2485 6450-DUPLICATE-RECORD.
  2486     MOVE 'Y'                    TO  WS-DUPREC-SW.
  2487
  2488 6490-EXIT.
  2489     EXIT.
  2490
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  54
* EL1276.cbl
  2492
  2493 6500-REWRITE-NOTE-RECORD        SECTION.
  2494
  2495
  2496* EXEC CICS REWRITE
  2497*        FROM      (CERTIFICATE-NOTE)
  2498*        DATASET   (ERNOTE-ID)
  2499*    END-EXEC.
  2500     MOVE LENGTH OF
  2501      CERTIFICATE-NOTE
  2502       TO DFHEIV11
  2503*    MOVE '&& L                  %   #00002315' TO DFHEIV0
  2504     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2505     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2506     MOVE X'2020233030303032333135' TO DFHEIV0(25:11)
  2507     CALL 'kxdfhei1' USING DFHEIV0,
  2508           ERNOTE-ID,
  2509           CERTIFICATE-NOTE,
  2510           DFHEIV11,
  2511           DFHEIV99
  2512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2513
  2514
  2515
  2516 6590-EXIT.
  2517     EXIT.
  2518
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  55
* EL1276.cbl
  2520
  2521 6600-DELETE-NOTE-RECORD         SECTION.
  2522
  2523
  2524* EXEC CICS HANDLE CONDITION
  2525*        NOTFND (6650-RECORD-PREVS-DELETED)
  2526*    END-EXEC.
  2527*    MOVE '"$I                   ! ( #00002328' TO DFHEIV0
  2528     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2529     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2530     MOVE X'2820233030303032333238' TO DFHEIV0(25:11)
  2531     CALL 'kxdfhei1' USING DFHEIV0
  2532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2533
  2534
  2535
  2536* EXEC CICS DELETE
  2537*        DATASET   (ERNOTE-ID)
  2538*    END-EXEC.
  2539*    MOVE '&(                    &   #00002332' TO DFHEIV0
  2540     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2541     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2542     MOVE X'2020233030303032333332' TO DFHEIV0(25:11)
  2543     CALL 'kxdfhei1' USING DFHEIV0,
  2544           ERNOTE-ID,
  2545           DFHEIV99,
  2546           DFHEIV99,
  2547           DFHEIV99,
  2548           DFHEIV99
  2549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2550
  2551
  2552     GO TO 6690-EXIT.
  2553
  2554 6650-RECORD-PREVS-DELETED.
  2555     MOVE 'N'                    TO  WS-RECORD-FOUND-SW.
  2556
  2557 6690-EXIT.
  2558     EXIT.
  2559
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  56
* EL1276.cbl
  2561
  2562 7000-FORMAT-SCREEN              SECTION.
  2563
  2564     MOVE LOW-VALUES             TO  EL127FI.
  2565
  2566     MOVE  PI-CARRIER            TO  FCARRIRO.
  2567     MOVE  PI-GROUPING           TO  FGROUPO.
  2568     MOVE  PI-STATE              TO  FSTO
  2569     MOVE  PI-ACCOUNT            TO  FACOUNTO.
  2570     MOVE  PI-CERT-PRIME         TO  FCERTO.
  2571     MOVE  PI-CERT-SFX           TO  FCRTSFXO.
  2572     MOVE  ' '                   TO  DC-OPTION-CODE.
  2573     MOVE  PI-CERT-EFF-DT        TO  DC-BIN-DATE-1.
  2574     PERFORM 9700-DATE-LINK.
  2575     MOVE DC-GREG-DATE-1-EDIT    TO  FEFFDTO.
  2576     IF PI-CERT-NOTES-EXIST EQUAL 'Y'
  2577         MOVE 'YES'              TO  FCERTYNO
  2578     ELSE
  2579         MOVE 'NO '              TO  FCERTYNO
  2580     END-IF.
  2581     IF PI-CLAIM-NOTES-EXIST EQUAL 'Y'
  2582         MOVE 'YES'              TO  FCLMYNO
  2583     ELSE
  2584         MOVE 'NO '              TO  FCLMYNO
  2585     END-IF.
  2586
  2587     MOVE  PI-CARRIER            TO  WS-CM-CARRIER.
  2588     MOVE  PI-GROUPING           TO  WS-CM-GROUPING.
  2589     MOVE  PI-STATE              TO  WS-CM-STATE.
  2590     MOVE  PI-ACCOUNT            TO  WS-CM-ACCOUNT.
  2591     MOVE  PI-CERT-PRIME         TO  WS-CM-CERT-PRIME.
  2592     MOVE  PI-CERT-SFX           TO  WS-CM-CERT-SFX.
  2593     MOVE  PI-CERT-EFF-DT        TO  WS-CM-CERT-EFF-DT.
  2594     MOVE  PI-COMPANY-CD         TO  WS-CM-COMPANY-CD.
  2595
  2596     PERFORM 6200-READ-NOTE-FILE.
  2597
  2598     IF RECORD-NOT-FOUND
  2599        MOVE 'A'                 TO  FMAINTI
  2600        MOVE AL-UANON            TO  FMAINTA
  2601        GO TO 7900-EXIT.
  2602
  2603     MOVE 'C'                    TO  FMAINTO.
  2604     MOVE AL-UANON               TO  FMAINTA.
  2605
  2606     IF CN-LAST-MAINT-DT = SPACES
  2607         MOVE EIBTIME            TO  CN-LAST-MAINT-HHMMSS
  2608         MOVE SAVE-BIN-DATE      TO  CN-LAST-MAINT-DT.
  2609
  2610     IF CN-LAST-MAINT-DT NOT = SPACES AND LOW-VALUES
  2611         MOVE  ' '               TO  DC-OPTION-CODE
  2612         MOVE  CN-LAST-MAINT-DT  TO  DC-BIN-DATE-1
  2613         PERFORM 9700-DATE-LINK
  2614         MOVE DC-GREG-DATE-1-EDIT TO  MAINTONO.
  2615
  2616     IF CN-LAST-MAINT-HHMMSS NUMERIC
  2617         MOVE CN-LAST-MAINT-HHMMSS TO TIME-IN
  2618         MOVE TIME-OUT             TO MAINTATO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  57
* EL1276.cbl
  2619       ELSE
  2620         MOVE ZEROS                TO TIME-IN
  2621         MOVE TIME-OUT             TO MAINTATO.
  2622
  2623     MOVE CN-LAST-MAINT-USER       TO MAINTBYO.
  2624
  2625     IF CN-BILLING-START-LINE-NO GREATER THAN ZEROS
  2626         MOVE CN-BILLING-START-LINE-NO   TO  FBSTARTO
  2627         MOVE AL-UNNON                   TO  FBSTARTA.
  2628
  2629     IF CN-BILLING-END-LINE-NO GREATER THAN ZEROS
  2630         MOVE CN-BILLING-END-LINE-NO     TO  FBENDO
  2631         MOVE AL-UNNON                   TO  FBENDA.
  2632
  2633     MOVE +0                     TO  WS-SUB1.
  2634
  2635 7100-BUILD-NOTE-LINES.
  2636     ADD +1 TO  WS-SUB1.
  2637
  2638     IF WS-SUB1 GREATER THAN +10
  2639        GO TO 7900-EXIT.
  2640
  2641     MOVE  CN-LINE (WS-SUB1)     TO  DNOTE-LINE       (WS-SUB1).
  2642     MOVE  AL-UANON              TO  DNOTE-LINE-ATTRB (WS-SUB1).
  2643
  2644     GO TO 7100-BUILD-NOTE-LINES.
  2645
  2646 7900-EXIT.
  2647     EXIT.
  2648
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  58
* EL1276.cbl
  2650
  2651 8100-SEND-INITIAL-MAP SECTION.
  2652
  2653     MOVE SAVE-DATE              TO  FDATEO.
  2654     MOVE EIBTIME                TO  TIME-IN.
  2655     MOVE TIME-OUT               TO  FTIMEO.
  2656     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  2657     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  2658     MOVE -1                     TO  FMAINTL.
  2659     MOVE EMI-MESSAGE-AREA (1)   TO  FERRMSGO.
  2660
  2661* EXEC CICS SEND
  2662*        MAP      (MAP-NAME)
  2663*        MAPSET   (MAPSET-NAME)
  2664*        FROM     (EL127FO)
  2665*        ERASE
  2666*        CURSOR
  2667*    END-EXEC.
  2668     MOVE LENGTH OF
  2669      EL127FO
  2670       TO DFHEIV12
  2671     MOVE -1
  2672       TO DFHEIV11
  2673*    MOVE '8$     CT  E    H L F ,   #00002444' TO DFHEIV0
  2674     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2675     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2676     MOVE X'2020233030303032343434' TO DFHEIV0(25:11)
  2677     CALL 'kxdfhei1' USING DFHEIV0,
  2678           MAP-NAME,
  2679           EL127FO,
  2680           DFHEIV12,
  2681           MAPSET-NAME,
  2682           DFHEIV99,
  2683           DFHEIV99,
  2684           DFHEIV99,
  2685           DFHEIV11,
  2686           DFHEIV99,
  2687           DFHEIV99,
  2688           DFHEIV99
  2689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2690
  2691
  2692     GO TO 9100-RETURN-TRAN.
  2693
  2694 8200-SEND-DATAONLY     SECTION.
  2695
  2696     MOVE SAVE-DATE              TO  FDATEO.
  2697     MOVE EIBTIME                TO  TIME-IN.
  2698     MOVE TIME-OUT               TO  FTIMEO.
  2699     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  2700     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  2701     MOVE EMI-MESSAGE-AREA (1)   TO  FERRMSGO.
  2702
  2703* EXEC CICS SEND
  2704*        MAP      (MAP-NAME)
  2705*        MAPSET   (MAPSET-NAME)
  2706*        FROM     (EL127FO)
  2707*        DATAONLY
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  59
* EL1276.cbl
  2708*        ERASEAUP
  2709*        CURSOR
  2710*    END-EXEC.
  2711     MOVE LENGTH OF
  2712      EL127FO
  2713       TO DFHEIV12
  2714     MOVE -1
  2715       TO DFHEIV11
  2716*    MOVE '8$D    CT  A    H L F ,   #00002462' TO DFHEIV0
  2717     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  2718     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2719     MOVE X'2020233030303032343632' TO DFHEIV0(25:11)
  2720     CALL 'kxdfhei1' USING DFHEIV0,
  2721           MAP-NAME,
  2722           EL127FO,
  2723           DFHEIV12,
  2724           MAPSET-NAME,
  2725           DFHEIV99,
  2726           DFHEIV99,
  2727           DFHEIV99,
  2728           DFHEIV11,
  2729           DFHEIV99,
  2730           DFHEIV99,
  2731           DFHEIV99
  2732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2733
  2734
  2735     GO TO 9100-RETURN-TRAN.
  2736
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  60
* EL1276.cbl
  2738
  2739 8300-SEND-TEXT         SECTION.
  2740
  2741* EXEC CICS SEND TEXT
  2742*        FROM     (LOGOFF-TEXT)
  2743*        LENGTH   (LOGOFF-LENGTH)
  2744*        ERASE
  2745*        FREEKB
  2746*    END-EXEC.
  2747*    MOVE '8&      T  E F  H   F -   #00002476' TO DFHEIV0
  2748     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2749     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2750     MOVE X'2020233030303032343736' TO DFHEIV0(25:11)
  2751     CALL 'kxdfhei1' USING DFHEIV0,
  2752           LOGOFF-TEXT,
  2753           LOGOFF-LENGTH,
  2754           DFHEIV99,
  2755           DFHEIV99,
  2756           DFHEIV99,
  2757           DFHEIV99,
  2758           DFHEIV99,
  2759           DFHEIV99,
  2760           DFHEIV99,
  2761           DFHEIV99,
  2762           DFHEIV99,
  2763           DFHEIV99
  2764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2765
  2766
  2767
  2768* EXEC CICS RETURN
  2769*    END-EXEC.
  2770*    MOVE '.(                    &   #00002483' TO DFHEIV0
  2771     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2772     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2773     MOVE X'2020233030303032343833' TO DFHEIV0(25:11)
  2774     CALL 'kxdfhei1' USING DFHEIV0,
  2775           DFHEIV99,
  2776           DFHEIV99,
  2777           DFHEIV99,
  2778           DFHEIV99,
  2779           DFHEIV99
  2780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2781
  2782
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  61
* EL1276.cbl
  2784
  2785 8400-LOG-JOURNAL-RECORD         SECTION.
  2786
  2787*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  2788*    MOVE ERNOTE-ID              TO  JP-FILE-ID.
  2789*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  2790*    EXEC CICS JOURNAL
  2791*        JFILEID     (PI-JOURNAL-FILE-ID)
  2792*        JTYPEID     ('ER')
  2793*        FROM        (JOURNAL-RECORD)
  2794*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
  2795*    END-EXEC.
  2796
  2797 8400-EXIT.
  2798     EXIT.
  2799
  2800 8600-DEEDIT           SECTION.
  2801
  2802* EXEC CICS BIF DEEDIT
  2803*         FIELD   (DEEDIT-FIELD)
  2804*         LENGTH  (15)
  2805*    END-EXEC.
  2806     MOVE 15
  2807       TO DFHEIV11
  2808*    MOVE '@"L                   #   #00002504' TO DFHEIV0
  2809     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2810     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2811     MOVE X'2020233030303032353034' TO DFHEIV0(25:11)
  2812     CALL 'kxdfhei1' USING DFHEIV0,
  2813           DEEDIT-FIELD,
  2814           DFHEIV11
  2815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2816
  2817
  2818 8800-UNAUTHORIZED-ACCESS        SECTION.
  2819     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  2820     GO TO 8300-SEND-TEXT.
  2821
  2822 8810-PF23              SECTION.
  2823     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  2824     MOVE XCTL-005               TO  PGM-NAME.
  2825     GO TO 9300-XCTL.
  2826
  2827 9100-RETURN-TRAN       SECTION.
  2828     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  2829     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  2830
  2831* EXEC CICS RETURN
  2832*        TRANSID    (TRANS-ID)
  2833*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2834*        LENGTH     (PI-COMM-LENGTH)
  2835*    END-EXEC.
  2836*    MOVE '.(CT                  &   #00002521' TO DFHEIV0
  2837     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2838     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2839     MOVE X'2020233030303032353231' TO DFHEIV0(25:11)
  2840     CALL 'kxdfhei1' USING DFHEIV0,
  2841           TRANS-ID,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  62
* EL1276.cbl
  2842           PROGRAM-INTERFACE-BLOCK,
  2843           PI-COMM-LENGTH,
  2844           DFHEIV99,
  2845           DFHEIV99
  2846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2847
  2848
  2849 9200-RETURN-MAIN-MENU SECTION.
  2850     MOVE XCTL-626               TO  PGM-NAME.
  2851     GO TO 9300-XCTL.
  2852
  2853 9300-XCTL             SECTION.
  2854
  2855* EXEC CICS XCTL
  2856*        PROGRAM    (PGM-NAME)
  2857*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2858*        LENGTH     (PI-COMM-LENGTH)
  2859*    END-EXEC.
  2860*    MOVE '.$C                   $   #00002532' TO DFHEIV0
  2861     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2862     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2863     MOVE X'2020233030303032353332' TO DFHEIV0(25:11)
  2864     CALL 'kxdfhei1' USING DFHEIV0,
  2865           PGM-NAME,
  2866           PROGRAM-INTERFACE-BLOCK,
  2867           PI-COMM-LENGTH
  2868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2869
  2870
  2871 9400-CLEAR            SECTION.
  2872     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  2873     GO TO 9300-XCTL.
  2874
  2875 9500-PF12             SECTION.
  2876     MOVE XCTL-010               TO  PGM-NAME.
  2877     GO TO 9300-XCTL.
  2878
  2879 9600-PGMID-ERROR      SECTION.
  2880
  2881* EXEC CICS HANDLE CONDITION
  2882*        PGMIDERR    (8300-SEND-TEXT)
  2883*    END-EXEC.
  2884*    MOVE '"$L                   ! ) #00002547' TO DFHEIV0
  2885     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2886     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2887     MOVE X'2920233030303032353437' TO DFHEIV0(25:11)
  2888     CALL 'kxdfhei1' USING DFHEIV0
  2889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2890
  2891
  2892     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  2893     MOVE ' '                    TO  PI-ENTRY-CD-1.
  2894     MOVE XCTL-005               TO  PGM-NAME.
  2895     MOVE PGM-NAME               TO  LOGOFF-PGM.
  2896     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  2897     GO TO 9300-XCTL.
  2898
  2899 9700-DATE-LINK         SECTION.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  63
* EL1276.cbl
  2900     MOVE LINK-ELDATCV           TO  PGM-NAME
  2901
  2902* EXEC CICS LINK
  2903*        PROGRAM    (PGM-NAME)
  2904*        COMMAREA   (DATE-CONVERSION-DATA)
  2905*        LENGTH     (DC-COMM-LENGTH)
  2906*    END-EXEC.
  2907*    MOVE '."C                   ''   #00002560' TO DFHEIV0
  2908     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2909     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2910     MOVE X'2020233030303032353630' TO DFHEIV0(25:11)
  2911     CALL 'kxdfhei1' USING DFHEIV0,
  2912           PGM-NAME,
  2913           DATE-CONVERSION-DATA,
  2914           DC-COMM-LENGTH,
  2915           DFHEIV99,
  2916           DFHEIV99,
  2917           DFHEIV99
  2918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2919
  2920
  2921 9900-ERROR-FORMAT       SECTION.
  2922     IF NOT EMI-ERRORS-COMPLETE
  2923         MOVE LINK-001           TO  PGM-NAME
  2924
  2925* EXEC CICS LINK
  2926*            PROGRAM    (PGM-NAME)
  2927*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  2928*            LENGTH     (EMI-COMM-LENGTH)
  2929*        END-EXEC.
  2930*    MOVE '."C                   ''   #00002569' TO DFHEIV0
  2931     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2932     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2933     MOVE X'2020233030303032353639' TO DFHEIV0(25:11)
  2934     CALL 'kxdfhei1' USING DFHEIV0,
  2935           PGM-NAME,
  2936           ERROR-MESSAGE-INTERFACE-BLOCK,
  2937           EMI-COMM-LENGTH,
  2938           DFHEIV99,
  2939           DFHEIV99,
  2940           DFHEIV99
  2941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2942
  2943
  2944 9900-EXIT.
  2945     EXIT.
  2946
  2947 9990-ABEND             SECTION.
  2948     MOVE LINK-004               TO  PGM-NAME.
  2949     MOVE DFHEIBLK               TO  EMI-LINE1
  2950
  2951
  2952* EXEC CICS LINK
  2953*        PROGRAM   (PGM-NAME)
  2954*        COMMAREA  (EMI-LINE1)
  2955*        LENGTH    (72)
  2956*    END-EXEC.
  2957     MOVE 72
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  64
* EL1276.cbl
  2958       TO DFHEIV11
  2959*    MOVE '."C                   ''   #00002582' TO DFHEIV0
  2960     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2961     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2962     MOVE X'2020233030303032353832' TO DFHEIV0(25:11)
  2963     CALL 'kxdfhei1' USING DFHEIV0,
  2964           PGM-NAME,
  2965           EMI-LINE1,
  2966           DFHEIV11,
  2967           DFHEIV99,
  2968           DFHEIV99,
  2969           DFHEIV99
  2970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2971
  2972
  2973     MOVE -1                     TO  FMAINTL.
  2974     GO TO 8200-SEND-DATAONLY.
  2975
  2976 9995-SECURITY-VIOLATION.
  2977*    COPY ELCSCTP.
  2978******************************************************************
  2979*                                                                *
  2980*                            ELCSCTP                             *
  2981*                            VMOD=2.001                          *
  2982*                                                                *
  2983*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2984******************************************************************
  2985
  2986
  2987     MOVE EIBDATE          TO SM-JUL-DATE.
  2988     MOVE EIBTRMID         TO SM-TERMID.
  2989     MOVE THIS-PGM         TO SM-PGM.
  2990     MOVE EIBTIME          TO TIME-IN.
  2991     MOVE TIME-OUT         TO SM-TIME.
  2992     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2993
  2994
  2995* EXEC CICS LINK
  2996*         PROGRAM  ('EL003')
  2997*         COMMAREA (SECURITY-MESSAGE)
  2998*         LENGTH   (80)
  2999*    END-EXEC.
  3000     MOVE 'EL003' TO DFHEIV1
  3001     MOVE 80
  3002       TO DFHEIV11
  3003*    MOVE '."C                   ''   #00002609' TO DFHEIV0
  3004     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3005     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3006     MOVE X'2020233030303032363039' TO DFHEIV0(25:11)
  3007     CALL 'kxdfhei1' USING DFHEIV0,
  3008           DFHEIV1,
  3009           SECURITY-MESSAGE,
  3010           DFHEIV11,
  3011           DFHEIV99,
  3012           DFHEIV99,
  3013           DFHEIV99
  3014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3015
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  65
* EL1276.cbl
  3016
  3017******************************************************************
  3018
  3019
  3020 9995-EXIT.
  3021     EXIT.
  3022
  3023
  3024 9999-DFHBACK SECTION.
  3025     MOVE '9%                    "   ' TO DFHEIV0
  3026     MOVE 'EL1276' TO DFHEIV1
  3027     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3028     GOBACK.
  3029 9999-DFHEXIT.
  3030     IF DFHEIGDJ EQUAL 0001
  3031         NEXT SENTENCE
  3032     ELSE IF DFHEIGDJ EQUAL 2
  3033         GO TO 9400-CLEAR
  3034         DEPENDING ON DFHEIGDI
  3035     ELSE IF DFHEIGDJ EQUAL 3
  3036         GO TO 9600-PGMID-ERROR,
  3037               9990-ABEND
  3038         DEPENDING ON DFHEIGDI
  3039     ELSE IF DFHEIGDJ EQUAL 4
  3040         GO TO 4400-NOT-FOUND
  3041         DEPENDING ON DFHEIGDI
  3042     ELSE IF DFHEIGDJ EQUAL 5
  3043         GO TO 6250-NOT-FOUND
  3044         DEPENDING ON DFHEIGDI
  3045     ELSE IF DFHEIGDJ EQUAL 6
  3046         GO TO 6350-NOT-FOUND
  3047         DEPENDING ON DFHEIGDI
  3048     ELSE IF DFHEIGDJ EQUAL 7
  3049         GO TO 6450-DUPLICATE-RECORD
  3050         DEPENDING ON DFHEIGDI
  3051     ELSE IF DFHEIGDJ EQUAL 8
  3052         GO TO 6650-RECORD-PREVS-DELETED
  3053         DEPENDING ON DFHEIGDI
  3054     ELSE IF DFHEIGDJ EQUAL 9
  3055         GO TO 8300-SEND-TEXT
  3056         DEPENDING ON DFHEIGDI.
  3057     MOVE '9%                    "   ' TO DFHEIV0
  3058     MOVE 'EL1276' TO DFHEIV1
  3059     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3060     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        5084     Code:        7532
