* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   1
* EL652.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL652.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL652.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL652 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 09/14/94 07:57:28.
     7*                            VMOD=2.059
     8*
     9*AUTHOR.        LOGIC,INC.
    10*               DALLAS, TEXAS.
    11*
    12*REMARKS.
    13*        TRANSACTION - EXD4 - COMPENSATION MASTER MAINT
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   2
* EL652.cbl
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    24* 102202    2002032200002  SMVA  ADD PF8 KEY FOR COMP MSTR NOTES
    25* 111103    2003080800002  PEMA  ADD BANKFEE,CLPST,MAXFEE  & PF10
    26*                                FOR SECURE PAY
    27* 111204    2004110300005  PEMA  SPLIT AGENT COMMISSION CHANGES
    28* 033105    2005031100003  PEMA  ADD VALID TYPE OF 'B' (BANK)
    29* 042005    2005031100004  PEMA  ALLOW UPDATES TO PCONT FOR 'B'
    30* 042005                         AND 'G' RECORD TYPES.
    31* 092205    2005050300006  PEMA  ADD LEASE FEES
    32* 041106    2006022800001  AJRA  INIT CO-FIRST-WRITTEN-DT ON ADD
    33* 060506    2002061100007  PEMA  ADD CODES TO ERCOMP FILE
    34* 072406    2006022400001  PEMA  ADD REFUND ONLY EDIT
    35* 110706  CR2006071700002  PEMA  FIX NAME LOOK UP
    36* 043007  IR2007042600002  PEMA  TURN OFF YTDCOMM ATTR
    37* 102908  CR2007052100005  PEMA  UNPROT PCONT ATTRB
    38* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    39* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    40******************************************************************
    41
    42 ENVIRONMENT DIVISION.
    43 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   3
* EL652.cbl
    45 WORKING-STORAGE SECTION.
    46 01  DFH-START PIC X(04).
    47 77  FILLER  PIC X(32)  VALUE '********************************'.
    48 77  FILLER  PIC X(32)  VALUE '*    EL652 WORKING STORAGE     *'.
    49 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.059 *********'.
    50 77  WS-TOT-FEES                 PIC S9(3)V99 COMP-3 VALUE +0.
    51 77  S1                          PIC S999 VALUE +0 COMP-3.
    52
    53 01  WS-DATE-AREA.
    54     12  SAVE-DATE           PIC  X(8)       VALUE SPACES.
    55     12  SAVE-BIN-DATE       PIC  XX         VALUE SPACES.
    56
    57 01  STANDARD-AREAS.
    58     12  WS-RESPONSE             PIC S9(8)   COMP.
    59         88  RESP-NORMAL                  VALUE +00.
    60         88  RESP-NOTFND                  VALUE +13.
    61         88  RESP-NOTOPEN                 VALUE +19.
    62         88  RESP-ENDFILE                 VALUE +20.
    63     12  RETURNED-FROM       PIC X(8)        VALUE SPACES.
    64     12  QID-PI.
    65         16  QID-TERM        PIC X(4).
    66         16  FILLER          PIC X(4)        VALUE '652A'.
    67     12  QID-ITEM            PIC S9(4) COMP  VALUE +0001.
    68     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
    69     12  MAP-NAME            PIC  X(8)       VALUE 'EL652A'.
    70     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL652S'.
    71     12  TRANS-ID            PIC  X(4)       VALUE 'EXD4'.
    72     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
    73     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
    74     12  EL633-TRANS-ID      PIC  X(4)       VALUE 'EXB7'.
    75     12  EL633DMD-TRANS-ID   PIC  X(4)       VALUE 'EX1F'.
    76     12  EL635-TRANS-ID      PIC  X(4)       VALUE 'EXJ4'.
    77     12  EL6501-TRANS-ID     PIC  X(4)       VALUE 'EXC5'.
    78     12  EL6592-TRANS-ID     PIC  X(4)       VALUE 'EX66'.
    79     12  EL856-TRANS-ID      PIC  X(4)       VALUE 'EXJ8'.
    80     12  EM6508-TRANS-ID     PIC  X(4)       VALUE 'MXG8'.
    81     12  THIS-PGM            PIC  X(8)       VALUE 'EL652'.
    82     12  PGM-NAME            PIC  X(8).
    83     12  WS-COMP-CD-R.
    84         16  FILLER          PIC  X.
    85         16  WS-COMP-CD-X    PIC  X.
    86     12  WS-COMP-CD  REDEFINES
    87         WS-COMP-CD-R        PIC S9(4)                  COMP.
    88     12  TIME-IN             PIC S9(7).
    89     12  TIME-OUT-R  REDEFINES  TIME-IN.
    90         16  FILLER          PIC  X.
    91         16  TIME-OUT        PIC  99V99.
    92         16  FILLER          PIC  XX.
    93     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
    94     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
    95     12  XCTL-126            PIC  X(8)       VALUE 'EL126'.
    96     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
    97     12  XCTL-633            PIC  X(8)       VALUE 'EL633'.
    98     12  XCTL-633DMD         PIC  X(8)       VALUE 'EL633DMD'.
    99     12  XCTL-635            PIC  X(8)       VALUE 'EL635'.
   100     12  XCTL-650            PIC  X(8)       VALUE 'EL650'.
   101     12  XCTL-6521           PIC  X(8)       VALUE 'EL6521'.
   102     12  XCTL-6522           PIC  X(8)       VALUE 'EL6522'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   4
* EL652.cbl
   103     12  XCTL-6523           PIC  X(8)       VALUE 'EL6523'.
   104     12  XCTL-6524           PIC  X(8)       VALUE 'EL6524'.
   105     12  XCTL-689            PIC  X(8)       VALUE 'EL689'.
   106     12  XCTL-690            PIC  X(8)       VALUE 'EL690'.
   107     12  XCTL-856            PIC  X(8)       VALUE 'EL856'.
   108     12  XCTL-EM626          PIC  X(8)       VALUE 'EM626'.
   109     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   110     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   111     12  LINK-ELDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   112     12  FILE-ID             PIC  X(8)       VALUE SPACES.
   113     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   114     12  NAME-FILE-ID        PIC  X(8)       VALUE 'ERNAME'.
   115     12  CNTL-FILE-ID        PIC  X(8)       VALUE 'ELCNTL'.
   116     12  SUMM-FILE-ID        PIC  X(8)       VALUE 'ERSUMM'.
   117     12  RQST-FILE-ID        PIC  X(8)       VALUE 'ERRQST'.
   118     12  RQST-FILE-ID-3      PIC  X(8)       VALUE 'ERRQST3'.
   119
   120 01  MISC-WORK-AREAS.
   121     12  WS-SRCH-STATE       PIC X(30)  VALUE SPACES.
   122     12  STNDX               PIC S999   COMP-3 VALUE +0.
   123     12  W-APPL-SCRTY-NDX    PIC S9(04) COMP   VALUE +35.
   124     12  WS-PHONE-IN         PIC  9(10).
   125     12  WS-PHONE-IN-R  REDEFINES  WS-PHONE-IN.
   126         16  WSPI-AREA       PIC  X(3).
   127         16  WSPI-PFX        PIC  X(3).
   128         16  WSPI-SFX        PIC  X(4).
   129     12  WS-PHONE-OUT.
   130         16  WSPO-AREA       PIC  X(3).
   131         16  FILLER          PIC  X            VALUE '-'.
   132         16  WSPO-PFX        PIC  X(3).
   133         16  FILLER          PIC  X            VALUE '-'.
   134         16  WSPO-SFX        PIC  X(4).
   135     12  DEEDIT-FIELD        PIC  X(15).
   136     12  DEEDIT-FIELD-V0  REDEFINES
   137         DEEDIT-FIELD        PIC S9(15).
   138     12  DEEDIT-FIELD-V1  REDEFINES
   139         DEEDIT-FIELD        PIC S9(13)V99.
   140     12  SUB1                PIC S9(4)         VALUE +0   COMP.
   141     12  SUB2                PIC S9(4)         VALUE +0   COMP.
   142     12  SC-ITEM-CL-CR       PIC S9(4)         VALUE +1   COMP.
   143     12  ERCOMP-LENGTH       PIC S9(4)         VALUE +700 COMP.
   144     12  ERSUMM-LENGTH       PIC S9(4)         VALUE +150 COMP.
   145     12  ERNAME-LENGTH       PIC S9(4)         VALUE +160 COMP.
   146     12  SV-CLMTOL           PIC  9(3)V99      VALUE ZEROS.
   147     12  WK-DATE.
   148         16  WK-MO           PIC  99.
   149         16  WK-DA           PIC  99.
   150         16  WK-YR           PIC  99.
   151     12  DATE-TEST-AREA      PIC  9(6).
   152     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   153         16  DATE-TEST-MM    PIC  99.
   154         16  DATE-TEST-DD    PIC  99.
   155         16  DATE-TEST-YY    PIC  99.
   156     12  DIVIDE-RESULT       PIC  99.
   157     12  DIVIDE-REMAINDER    PIC  9.
   158     12  WS-ZERO             PIC  X            VALUE '0'.
   159     12  WS-ONE              PIC  X            VALUE '1'.
   160     12  WS-TWO              PIC  X            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   5
* EL652.cbl
   161     12  WS-ACCESS.
   162         16  FILLER          PIC  X(3)         VALUE SPACES.
   163         16  WS-CARRIER      PIC  X.
   164     12  BIN-CURRENT-SAVE    PIC  XX.
   165     12  WS-BROWSE-SW        PIC  X.
   166         88  BROWSE-STARTED                    VALUE 'Y'.
   167     12  WS-SAVE-KEY         PIC  X(29)        VALUE SPACES.
   168     12  WS-SAVE-SUMM        PIC  X(6)         VALUE SPACES.
   169     12  WS-SUMM-FOR-RQST    PIC  X(6)         VALUE SPACES.
   170     12  WS-SAVE-RQST        PIC X(46)         VALUE SPACES.
   171     12  WS-SHOW-SAVE-TOTALS PIC  X            VALUE SPACE.
   172         88  SHOW-SAVE-TOTALS                  VALUE 'Y'.
   173     12  ELCNTL-KEY.
   174         16  CNTL-COMP-ID    PIC  X(3)         VALUE SPACES.
   175         16  CNTL-REC-TYPE   PIC  X            VALUE SPACES.
   176         16  CNTL-ACCESS     PIC  X(4)         VALUE SPACES.
   177         16  CNTL-SEQ-NO     PIC S9(4)         VALUE +0   COMP.
   178     12  ELCNTL-KEY2.
   179         16  CNTL-COMP-ID-2  PIC  X(3)         VALUE SPACES.
   180         16  CNTL-REC-TYPE-2 PIC  X            VALUE SPACES.
   181         16  CNTL-STATE-2    PIC  X(2)         VALUE SPACES.
   182         16  FILLER          PIC  X(2)         VALUE SPACES.
   183         16  CNTL-SEQ-NO-2   PIC S9(4)         VALUE +0   COMP.
   184     12  ERSUMM-KEY.
   185         16  SUMM-COMP-ID    PIC  X            VALUE SPACES.
   186         16  SUMM-SUMMARY    PIC  X(6)         VALUE SPACES.
   187         16  SUMM-CARRIER    PIC  X            VALUE SPACES.
   188         16  SUMM-GROUP      PIC  X(6)         VALUE SPACES.
   189         16  SUMM-FIN-RESP   PIC  X(10)        VALUE SPACES.
   190         16  SUMM-ACCT-AGENT PIC  X(10)        VALUE SPACES.
   191     12  ERRQST-KEY.
   192         16  RQST-COMP-ID-PC PIC  X            VALUE SPACES.
   193         16  RQST-BATCH-PC   PIC  X(6)         VALUE SPACES.
   194     12  ERRQST-KEY-3.
   195         16  RQST-COMP-ID    PIC  X            VALUE SPACES.
   196         16  RQST-CARRIER    PIC  X            VALUE SPACES.
   197         16  RQST-GROUP      PIC  X(6)         VALUE SPACES.
   198         16  RQST-FIN-RESP   PIC  X(10)        VALUE SPACES.
   199         16  RQST-ACCT-AGENT PIC  X(10)        VALUE SPACES.
   200         16  RQST-REFERENCE  PIC  X(12)        VALUE SPACES.
   201         16  RQST-BATCH      PIC  X(06)        VALUE SPACES.
   202     12  WS-DATE-MDY-8.
   203         16  WS-DMDY8-MM     PIC  XX.
   204         16  WS-DMDY8-SL1    PIC  X.
   205         16  WS-DMDY8-DD     PIC  XX.
   206         16  WS-DMDY8-SL2    PIC  X.
   207         16  WS-DMDY8-YY     PIC  XX.
   208     12  WS-DATE-MDY-6  REDEFINES  WS-DATE-MDY-8.
   209         16  WS-DMDY6-MM     PIC  XX.
   210         16  WS-DMDY6-DD     PIC  XX.
   211         16  WS-DMDY6-YY     PIC  XX.
   212         16  WS-DMDY6-BLNK   PIC  XX.
   213     12  WS-YMD-DATE.
   214         16  WS-YMD-YY       PIC  XX.
   215         16  WS-YMD-MM       PIC  XX.
   216         16  WS-YMD-DD       PIC  XX.
   217     12  WS-YMD-DATE-NUM  REDEFINES
   218         WS-YMD-DATE         PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   6
* EL652.cbl
   219     12  WS-SAVE-SUMMARY     PIC X(6)          VALUE SPACES.
   220     12  WS-SAVE-NAME        PIC X(30)         VALUE SPACES.
   221     12  WS-SAVE-BALFWD      PIC S9(7)V99      VALUE +0   COMP-3.
   222     12  WS-SAVE-CURCOM      PIC S9(7)V99      VALUE +0   COMP-3.
   223     12  WS-SAVE-CURCHG      PIC S9(7)V99      VALUE +0   COMP-3.
   224     12  WS-SAVE-CURPMT      PIC S9(7)V99      VALUE +0   COMP-3.
   225     12  WS-SAVE-ENDBAL      PIC S9(7)V99      VALUE +0   COMP-3.
   226     12  WS-SAVE-YTDCOM      PIC S9(7)V99      VALUE +0   COMP-3.
   227     12  WS-SOC-SEC-WORK-FIELD.
   228         16  WS-SS-TYPE          PIC X.
   229         16  WS-SOC-SEC          PIC X(12).
   230
   231     12  WS-ZIP-CODE.
   232         16  WS-ZIP-1            PIC X.
   233             88  WS-CANADIAN-ZIP    VALUE 'A' THRU 'Z'.
   234         16  WS-ZIP-2-3          PIC XX.
   235         16  WS-ZIP-4            PIC X.
   236         16  WS-ZIP-5            PIC X.
   237         16  WS-ZIP-6            PIC X.
   238         16  FILLER              PIC X(4).
   239     12  WS-ZIP-AM-1  REDEFINES  WS-ZIP-CODE.
   240         16  WS-ZIP-AM-1-CODE    PIC X(5).
   241         16  WS-ZIP-AM-1-PLUS4   PIC X(4).
   242         16  FILLER              PIC X.
   243     12  WS-ZIP-AM-2  REDEFINES  WS-ZIP-CODE.
   244         16  WS-ZIP-AM-2-CODE    PIC X(5).
   245         16  WS-ZIP-AM-2-DASH    PIC X.
   246         16  WS-ZIP-AM-2-PLUS4   PIC X(4).
   247     12  WS-ZIP-CAN-1  REDEFINES  WS-ZIP-CODE.
   248         16  WS-ZIP-CAN-1-POST1  PIC XXX.
   249         16  WS-ZIP-CAN-1-POST2  PIC XXX.
   250         16  FILLER              PIC X(4).
   251     12  WS-ZIP-CAN-2  REDEFINES  WS-ZIP-CODE.
   252         16  WS-ZIP-CAN-2-POST1  PIC XXX.
   253         16  FILLER              PIC X.
   254         16  WS-ZIP-CAN-2-POST2  PIC XXX.
   255         16  FILLER              PIC XXX.
   256
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   7
* EL652.cbl
   258 01  ERROR-NUMBERS.
   259     12  ER-0000             PIC  X(4)       VALUE '0000'.
   260     12  ER-0002             PIC  X(4)       VALUE '0002'.
   261     12  ER-0004             PIC  X(4)       VALUE '0004'.
   262     12  ER-0008             PIC  X(4)       VALUE '0008'.
   263     12  ER-0029             PIC  X(4)       VALUE '0029'.
   264     12  ER-0033             PIC  X(4)       VALUE '0033'.
   265     12  ER-0035             PIC  X(4)       VALUE '0035'.
   266     12  ER-0046             PIC  X(4)       VALUE '0046'.
   267     12  ER-0068             PIC  X(4)       VALUE '0068'.
   268     12  ER-0070             PIC  X(4)       VALUE '0070'.
   269     12  ER-0142             PIC  X(4)       VALUE '0142'.
   270     12  ER-0144             PIC  X(4)       VALUE '0144'.
   271     12  ER-0187             PIC  X(4)       VALUE '0187'.
   272     12  ER-0193             PIC  X(4)       VALUE '0193'.
   273     12  ER-0314             PIC  X(4)       VALUE '0314'.
   274     12  ER-0584             PIC  X(4)       VALUE '0584'.
   275     12  ER-0829             PIC  X(4)       VALUE '0829'.
   276     12  ER-1299             PIC  X(4)       VALUE '1299'.
   277     12  ER-1778             PIC  X(4)       VALUE '1778'.
   278     12  ER-1883             PIC  X(4)       VALUE '1883'.
   279     12  ER-2039             PIC  X(4)       VALUE '2039'.
   280     12  ER-2042             PIC  X(4)       VALUE '2042'.
   281     12  ER-2045             PIC  X(4)       VALUE '2045'.
   282     12  ER-2046             PIC  X(4)       VALUE '2046'.
   283     12  ER-2047             PIC  X(4)       VALUE '2047'.
   284     12  ER-2048             PIC  X(4)       VALUE '2048'.
   285     12  ER-2049             PIC  X(4)       VALUE '2049'.
   286     12  ER-2050             PIC  X(4)       VALUE '2050'.
   287     12  ER-2055             PIC  X(4)       VALUE '2055'.
   288     12  ER-2056             PIC  X(4)       VALUE '2056'.
   289     12  ER-2057             PIC  X(4)       VALUE '2057'.
   290     12  ER-2067             PIC  X(4)       VALUE '2067'.
   291     12  ER-2088             PIC  X(4)       VALUE '2088'.
   292     12  ER-2089             PIC  X(4)       VALUE '2089'.
   293     12  ER-2091             PIC  X(4)       VALUE '2091'.
   294     12  ER-2092             PIC  X(4)       VALUE '2092'.
   295     12  ER-2093             PIC  X(4)       VALUE '2093'.
   296     12  ER-2094             PIC  X(4)       VALUE '2094'.
   297     12  ER-2095             PIC  X(4)       VALUE '2095'.
   298     12  ER-2096             PIC  X(4)       VALUE '2096'.
   299     12  ER-2097             PIC  X(4)       VALUE '2097'.
   300     12  ER-2209             PIC  X(4)       VALUE '2209'.
   301     12  ER-2238             PIC  X(4)       VALUE '2238'.
   302     12  ER-2370             PIC  X(4)       VALUE '2370'.
   303     12  ER-2572             PIC  X(4)       VALUE '2572'.
   304     12  ER-2717             PIC  X(4)       VALUE '2717'.
   305     12  ER-2790             PIC  X(4)       VALUE '2790'.
   306     12  ER-2872             PIC  X(4)       VALUE '2872'.
   307     12  ER-3021             PIC  X(4)       VALUE '3021'.
   308     12  ER-3053             PIC  X(4)       VALUE '3053'.
   309     12  ER-3055             PIC  X(4)       VALUE '3055'.
   310     12  ER-3056             PIC  X(4)       VALUE '3056'.
   311     12  ER-3150             PIC  X(4)       VALUE '3150'.
   312     12  ER-3151             PIC  X(4)       VALUE '3151'.
   313     12  ER-3152             PIC  X(4)       VALUE '3152'.
   314     12  ER-3153             PIC  X(4)       VALUE '3153'.
   315     12  ER-3154             PIC  X(4)       VALUE '3154'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   8
* EL652.cbl
   316     12  ER-3168             PIC  X(4)       VALUE '3168'.
   317     12  ER-3170             PIC  X(4)       VALUE '3170'.
   318     12  ER-3174             PIC  X(4)       VALUE '3174'.
   319     12  ER-3261             PIC  X(4)       VALUE '3261'.
   320     12  ER-9096             PIC  X(4)       VALUE '9096'.
   321     12  ER-9097             PIC  X(4)       VALUE '9097'.
   322     12  ER-9999             PIC  X(4)       VALUE '9999'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page   9
* EL652.cbl
   324*                          COPY ELCSCTM.
   325******************************************************************
   326*                                                                *
   327*                                                                *
   328*                            ELCSCTM                             *
   329*                            VMOD=2.001                          *
   330*                                                                *
   331*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   332*                                                                *
   333******************************************************************
   334 01  SECURITY-MESSAGE.
   335     12  FILLER                          PIC X(30)
   336            VALUE '** LOGIC SECURITY VIOLATION -'.
   337     12  SM-READ                         PIC X(6).
   338     12  FILLER                          PIC X(5)
   339            VALUE ' PGM='.
   340     12  SM-PGM                          PIC X(6).
   341     12  FILLER                          PIC X(5)
   342            VALUE ' OPR='.
   343     12  SM-PROCESSOR-ID                 PIC X(4).
   344     12  FILLER                          PIC X(6)
   345            VALUE ' TERM='.
   346     12  SM-TERMID                       PIC X(4).
   347     12  FILLER                          PIC XX   VALUE SPACE.
   348     12  SM-JUL-DATE                     PIC 9(5).
   349     12  FILLER                          PIC X    VALUE SPACE.
   350     12  SM-TIME                         PIC 99.99.
   351
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  10
* EL652.cbl
   353*                          COPY ELCSCRTY.
   354******************************************************************
   355*                                                                *
   356*                                                                *
   357*                            ELCSCRTY                            *
   358*                            VMOD=2.001                          *
   359*                                                                *
   360*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   361*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   362*        SAVED IN PI-SECURITY-ADDRESS.                           *
   363*                                                                *
   364******************************************************************
   365 01  SECURITY-CONTROL.
   366     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   367     12  FILLER                       PIC XX    VALUE 'SC'.
   368     12  SC-CREDIT-CODES.
   369         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   370             20  SC-CREDIT-DISPLAY    PIC X.
   371             20  SC-CREDIT-UPDATE     PIC X.
   372     12  SC-CLAIMS-CODES.
   373         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   374             20  SC-CLAIMS-DISPLAY    PIC X.
   375             20  SC-CLAIMS-UPDATE     PIC X.
   376*                          COPY MPCSCRT.
   377******************************************************************
   378*                                                                *
   379*                            MPCSCRT                             *
   380*                            VMOD=1.001                          *
   381*                                                                *
   382*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   383*        ACQUIRED BY SIGN-ON PROGRAM EL125.                      *
   384*                                      (MP MORTGAGE PROTECTION)  *
   385*                                                                *
   386******************************************************************
   387*
   388 01  SECURITY-CONTROL-E.
   389     12  SC-COMM-LENGTH-E             PIC S9(04) VALUE +144 COMP.
   390     12  FILLER                       PIC  X(02) VALUE 'SC'.
   391     12  SC-QUID-KEY.
   392         16  SC-QUID-TERMINAL         PIC  X(04).
   393         16  SC-QUID-SYSTEM           PIC  X(04).
   394     12  SC-ITEM                      PIC S9(04) VALUE +1   COMP.
   395     12  SC-SECURITY-ACCESS-CODE      PIC  X(01).
   396     12  SC-PRODUCER-AUTHORIZED-SW    PIC  X(01).
   397         88 SC-PRODUCER-AUTHORIZED               VALUE ' '.
   398         88 SC-PRODUCER-NOT-AUTHORIZED           VALUE 'N'.
   399     12  SC-MP-CODES.
   400         16  SC-MP-AUTHORIZATION OCCURS 44 TIMES.
   401             20  SC-MP-DISPLAY        PIC  X(01).
   402             20  SC-MP-UPDATE         PIC  X(01).
   403     12  FILLER                       PIC  X(40).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  11
* EL652.cbl
   405 01  FILLER                  PIC X(16)  VALUE ALL 'A'.
   406*                          COPY ELCDATE.
   407******************************************************************
   408*                                                                *
   409*                                                                *
   410*                            ELCDATE.                            *
   411*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   412*                            VMOD=2.003
   413*                                                                *
   414*                                                                *
   415*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   416*                 LENGTH = 200                                   *
   417******************************************************************
   418
   419 01  DATE-CONVERSION-DATA.
   420     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   421     12  DC-OPTION-CODE                PIC X.
   422         88  BIN-TO-GREG                VALUE ' '.
   423         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   424         88  EDIT-GREG-TO-BIN           VALUE '2'.
   425         88  YMD-GREG-TO-BIN            VALUE '3'.
   426         88  MDY-GREG-TO-BIN            VALUE '4'.
   427         88  JULIAN-TO-BIN              VALUE '5'.
   428         88  BIN-PLUS-ELAPSED           VALUE '6'.
   429         88  FIND-CENTURY               VALUE '7'.
   430         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   431         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   432         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   433         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   434         88  JULIAN-TO-BIN-3            VALUE 'C'.
   435         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   436         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   437         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   438         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   439         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   440         88  CHECK-LEAP-YEAR            VALUE 'H'.
   441         88  BIN-3-TO-GREG              VALUE 'I'.
   442         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   443         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   444         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   445         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   446         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   447         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   448         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   449         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   450         88  THREE-CHARACTER-BIN
   451                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   452         88  GREGORIAN-TO-BIN
   453                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   454         88  BIN-TO-GREGORIAN
   455                  VALUES ' ' '1' 'I' '8' 'G'.
   456         88  JULIAN-TO-BINARY
   457                  VALUES '5' 'C' 'E' 'F'.
   458     12  DC-ERROR-CODE                 PIC X.
   459         88  NO-CONVERSION-ERROR        VALUE ' '.
   460         88  DATE-CONVERSION-ERROR
   461                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   462         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  12
* EL652.cbl
   463         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   464         88  DATE-IS-INVALID            VALUE '3'.
   465         88  DATE1-GREATER-DATE2        VALUE '4'.
   466         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   467         88  DATE-INVALID-OPTION        VALUE '9'.
   468         88  INVALID-CENTURY            VALUE 'A'.
   469         88  ONLY-CENTURY               VALUE 'B'.
   470         88  ONLY-LEAP-YEAR             VALUE 'C'.
   471         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   472     12  DC-END-OF-MONTH               PIC X.
   473         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   474     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   475         88  USE-NORMAL-PROCESS         VALUE ' '.
   476         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   477         88  ADJUST-UP-100-YRS          VALUE '2'.
   478     12  FILLER                        PIC X.
   479     12  DC-CONVERSION-DATES.
   480         16  DC-BIN-DATE-1             PIC XX.
   481         16  DC-BIN-DATE-2             PIC XX.
   482         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   483         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   484                       DC-GREG-DATE-1-EDIT.
   485             20  DC-EDIT1-MONTH        PIC 99.
   486             20  SLASH1-1              PIC X.
   487             20  DC-EDIT1-DAY          PIC 99.
   488             20  SLASH1-2              PIC X.
   489             20  DC-EDIT1-YEAR         PIC 99.
   490         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   491         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   492                     DC-GREG-DATE-2-EDIT.
   493             20  DC-EDIT2-MONTH        PIC 99.
   494             20  SLASH2-1              PIC X.
   495             20  DC-EDIT2-DAY          PIC 99.
   496             20  SLASH2-2              PIC X.
   497             20  DC-EDIT2-YEAR         PIC 99.
   498         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   499         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   500                     DC-GREG-DATE-1-YMD.
   501             20  DC-YMD-YEAR           PIC 99.
   502             20  DC-YMD-MONTH          PIC 99.
   503             20  DC-YMD-DAY            PIC 99.
   504         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   505         16  DC-GREG-DATE-1-MDY-R REDEFINES
   506                      DC-GREG-DATE-1-MDY.
   507             20  DC-MDY-MONTH          PIC 99.
   508             20  DC-MDY-DAY            PIC 99.
   509             20  DC-MDY-YEAR           PIC 99.
   510         16  DC-GREG-DATE-1-ALPHA.
   511             20  DC-ALPHA-MONTH        PIC X(10).
   512             20  DC-ALPHA-DAY          PIC 99.
   513             20  FILLER                PIC XX.
   514             20  DC-ALPHA-CENTURY.
   515                 24 DC-ALPHA-CEN-N     PIC 99.
   516             20  DC-ALPHA-YEAR         PIC 99.
   517         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   518         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   519         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   520         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  13
* EL652.cbl
   521         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   522                                       PIC 9(05).
   523         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   524             20  DC-JULIAN-YEAR        PIC 99.
   525             20  DC-JULIAN-DAYS        PIC 999.
   526         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   527         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   528         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   529     12  DATE-CONVERSION-VARIBLES.
   530         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   531         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   532             20  FILLER                PIC 9(3).
   533             20  HOLD-CEN-1-CCYY.
   534                 24  HOLD-CEN-1-CC     PIC 99.
   535                 24  HOLD-CEN-1-YY     PIC 99.
   536             20  HOLD-CEN-1-MO         PIC 99.
   537             20  HOLD-CEN-1-DA         PIC 99.
   538         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   539             20  HOLD-CEN-1-R-MO       PIC 99.
   540             20  HOLD-CEN-1-R-DA       PIC 99.
   541             20  HOLD-CEN-1-R-CCYY.
   542                 24  HOLD-CEN-1-R-CC   PIC 99.
   543                 24  HOLD-CEN-1-R-YY   PIC 99.
   544             20  FILLER                PIC 9(3).
   545         16  HOLD-CENTURY-1-X.
   546             20  FILLER                PIC X(3)  VALUE SPACES.
   547             20  HOLD-CEN-1-X-CCYY.
   548                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   549                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   550             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   551             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   552         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   553             20  HOLD-CEN-1-R-X-MO     PIC XX.
   554             20  HOLD-CEN-1-R-X-DA     PIC XX.
   555             20  HOLD-CEN-1-R-X-CCYY.
   556                 24  HOLD-CEN-1-R-X-CC PIC XX.
   557                 24  HOLD-CEN-1-R-X-YY PIC XX.
   558             20  FILLER                PIC XXX.
   559         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   560         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   561         16  DC-JULIAN-DATE-1          PIC 9(07).
   562         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   563             20  DC-JULIAN-1-CCYY.
   564                 24  DC-JULIAN-1-CC    PIC 99.
   565                 24  DC-JULIAN-1-YR    PIC 99.
   566             20  DC-JULIAN-DA-1        PIC 999.
   567         16  DC-JULIAN-DATE-2          PIC 9(07).
   568         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   569             20  DC-JULIAN-2-CCYY.
   570                 24  DC-JULIAN-2-CC    PIC 99.
   571                 24  DC-JULIAN-2-YR    PIC 99.
   572             20  DC-JULIAN-DA-2        PIC 999.
   573         16  DC-GREG-DATE-A-EDIT.
   574             20  DC-EDITA-MONTH        PIC 99.
   575             20  SLASHA-1              PIC X VALUE '/'.
   576             20  DC-EDITA-DAY          PIC 99.
   577             20  SLASHA-2              PIC X VALUE '/'.
   578             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  14
* EL652.cbl
   579                 24  DC-EDITA-CENT     PIC 99.
   580                 24  DC-EDITA-YEAR     PIC 99.
   581         16  DC-GREG-DATE-B-EDIT.
   582             20  DC-EDITB-MONTH        PIC 99.
   583             20  SLASHB-1              PIC X VALUE '/'.
   584             20  DC-EDITB-DAY          PIC 99.
   585             20  SLASHB-2              PIC X VALUE '/'.
   586             20  DC-EDITB-CCYY.
   587                 24  DC-EDITB-CENT     PIC 99.
   588                 24  DC-EDITB-YEAR     PIC 99.
   589         16  DC-GREG-DATE-CYMD         PIC 9(08).
   590         16  DC-GREG-DATE-CYMD-R REDEFINES
   591                              DC-GREG-DATE-CYMD.
   592             20  DC-CYMD-CEN           PIC 99.
   593             20  DC-CYMD-YEAR          PIC 99.
   594             20  DC-CYMD-MONTH         PIC 99.
   595             20  DC-CYMD-DAY           PIC 99.
   596         16  DC-GREG-DATE-MDCY         PIC 9(08).
   597         16  DC-GREG-DATE-MDCY-R REDEFINES
   598                              DC-GREG-DATE-MDCY.
   599             20  DC-MDCY-MONTH         PIC 99.
   600             20  DC-MDCY-DAY           PIC 99.
   601             20  DC-MDCY-CEN           PIC 99.
   602             20  DC-MDCY-YEAR          PIC 99.
   603    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   604        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   605    12  DC-EL310-DATE                  PIC X(21).
   606    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  15
* EL652.cbl
   608*                          COPY ELCLOGOF.
   609******************************************************************
   610*                                                                *
   611*                                                                *
   612*                            ELCLOGOF.                           *
   613*                            VMOD=2.001                          *
   614*                                                                *
   615*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   616*                                                                *
   617******************************************************************
   618 01  CLASIC-LOGOFF.
   619     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   620     12  LOGOFF-TEXT.
   621         16  FILLER          PIC X(5)    VALUE SPACES.
   622         16  LOGOFF-MSG.
   623             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   624             20  FILLER      PIC X       VALUE SPACES.
   625             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   626         16  FILLER          PIC X(80)
   627           VALUE '* YOU ARE NOW LOGGED OFF'.
   628         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   629         16  FILLER          PIC X       VALUE QUOTE.
   630         16  LOGOFF-SYS-MSG  PIC X(17)
   631           VALUE 'S CLAS-IC SYSTEM '.
   632     12  TEXT-MESSAGES.
   633         16  UNACCESS-MSG    PIC X(29)
   634             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   635         16  PGMIDERR-MSG    PIC X(17)
   636             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  16
* EL652.cbl
   638*                          COPY ELCATTR.
   639******************************************************************
   640*                                                                *
   641*                            ELCATTR.                            *
   642*                            VMOD=2.001                          *
   643*                                                                *
   644*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   645*                                                                *
   646*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   647*                                                                *
   648*                   POS 1   P=PROTECTED                          *
   649*                           U=UNPROTECTED                        *
   650*                           S=ASKIP                              *
   651*                   POS 2   A=ALPHA/NUMERIC                      *
   652*                           N=NUMERIC                            *
   653*                   POS 3   N=NORMAL                             *
   654*                           B=BRIGHT                             *
   655*                           D=DARK                               *
   656*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   657*                           OF=MODIFIED DATA TAG OFF             *
   658*                                                                *
   659*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   660******************************************************************
   661 01  ATTRIBUTE-LIST.
   662     12  AL-PABOF            PIC X       VALUE 'Y'.
   663     12  AL-PABON            PIC X       VALUE 'Z'.
   664     12  AL-PADOF            PIC X       VALUE '%'.
   665     12  AL-PADON            PIC X       VALUE '_'.
   666     12  AL-PANOF            PIC X       VALUE '-'.
   667     12  AL-PANON            PIC X       VALUE '/'.
   668     12  AL-SABOF            PIC X       VALUE '8'.
   669     12  AL-SABON            PIC X       VALUE '9'.
   670     12  AL-SADOF            PIC X       VALUE '@'.
   671     12  AL-SADON            PIC X       VALUE QUOTE.
   672     12  AL-SANOF            PIC X       VALUE '0'.
   673     12  AL-SANON            PIC X       VALUE '1'.
   674     12  AL-UABOF            PIC X       VALUE 'H'.
   675     12  AL-UABON            PIC X       VALUE 'I'.
   676     12  AL-UADOF            PIC X       VALUE '<'.
   677     12  AL-UADON            PIC X       VALUE '('.
   678     12  AL-UANOF            PIC X       VALUE ' '.
   679     12  AL-UANON            PIC X       VALUE 'A'.
   680     12  AL-UNBOF            PIC X       VALUE 'Q'.
   681     12  AL-UNBON            PIC X       VALUE 'R'.
   682     12  AL-UNDOF            PIC X       VALUE '*'.
   683     12  AL-UNDON            PIC X       VALUE ')'.
   684     12  AL-UNNOF            PIC X       VALUE '&'.
   685     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  17
* EL652.cbl
   687*                          COPY ELCEMIB.
   688******************************************************************
   689*                                                                *
   690*                                                                *
   691*                            ELCEMIB.                            *
   692*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   693*                            VMOD=2.005                          *
   694*                                                                *
   695*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   696*                                                                *
   697******************************************************************
   698 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   699     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   700     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   701     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   702     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   703     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   704     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   705     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   706     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   707     12  EMI-SWITCH1             PIC X        VALUE '1'.
   708         88  EMI-NO-ERRORS                    VALUE '1'.
   709         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   710         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   711     12  EMI-SWITCH2             PIC X        VALUE '1'.
   712         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   713     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   714         88  EMI-AREA1-EMPTY                  VALUE '1'.
   715         88  EMI-AREA1-FULL                   VALUE '2'.
   716     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   717         88  EMI-AREA2-EMPTY                  VALUE '1'.
   718         88  EMI-AREA2-FULL                   VALUE '2'.
   719     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   720         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   721         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   722         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   723         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   724         88  EMI-BYPASS-FATALS                VALUE 'X'.
   725     12  EMI-ERROR-LINES.
   726         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   727         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   728         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   729         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   730             20  EMI-ERR-CODES OCCURS 10 TIMES.
   731                 24  EMI-ERR-NUM         PIC X(4).
   732                 24  EMI-FILLER          PIC X.
   733                 24  EMI-SEV             PIC X.
   734                 24  FILLER              PIC X.
   735             20  FILLER                  PIC X(02).
   736     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   737         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   738             20  EMI-ERROR-NUMBER    PIC X(4).
   739             20  EMI-FILL            PIC X.
   740             20  EMI-SEVERITY        PIC X.
   741             20  FILLER              PIC X.
   742             20  EMI-ERROR-TEXT.
   743                 24  EMI-TEXT-VARIABLE   PIC X(10).
   744                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  18
* EL652.cbl
   745     12  EMI-SEVERITY-SAVE           PIC X.
   746         88  EMI-NOTE                    VALUE 'N'.
   747         88  EMI-WARNING                 VALUE 'W'.
   748         88  EMI-FORCABLE                VALUE 'F'.
   749         88  EMI-FATAL                   VALUE 'X'.
   750     12  EMI-MESSAGE-FLAG            PIC X.
   751         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   752         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   753     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   754     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   755         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   756         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   757         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   758     12  FILLER                      PIC X(137)  VALUE SPACES.
   759     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   760     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   761     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   762     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  19
* EL652.cbl
   764 01  FILLER                  PIC X(16)  VALUE ALL 'B'.
   765*                          COPY ELCINTF.
   766******************************************************************
   767*                                                                *
   768*                                                                *
   769*                            ELCINTF.                            *
   770*                            VMOD=2.017                          *
   771*                                                                *
   772*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   773*                                                                *
   774*       LENGTH = 1024                                            *
   775*                                                                *
   776******************************************************************
   777 01  PROGRAM-INTERFACE-BLOCK.
   778     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   779     12  PI-CALLING-PROGRAM              PIC X(8).
   780     12  PI-SAVED-PROGRAM-1              PIC X(8).
   781     12  PI-SAVED-PROGRAM-2              PIC X(8).
   782     12  PI-SAVED-PROGRAM-3              PIC X(8).
   783     12  PI-SAVED-PROGRAM-4              PIC X(8).
   784     12  PI-SAVED-PROGRAM-5              PIC X(8).
   785     12  PI-SAVED-PROGRAM-6              PIC X(8).
   786     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   787     12  PI-COMPANY-ID                   PIC XXX.
   788     12  PI-COMPANY-CD                   PIC X.
   789
   790     12  PI-COMPANY-PASSWORD             PIC X(8).
   791
   792     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   793
   794     12  PI-CONTROL-IN-PROGRESS.
   795         16  PI-CARRIER                  PIC X.
   796         16  PI-GROUPING                 PIC X(6).
   797         16  PI-STATE                    PIC XX.
   798         16  PI-ACCOUNT                  PIC X(10).
   799         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   800                                         PIC X(10).
   801         16  PI-CLAIM-CERT-GRP.
   802             20  PI-CLAIM-NO             PIC X(7).
   803             20  PI-CERT-NO.
   804                 25  PI-CERT-PRIME       PIC X(10).
   805                 25  PI-CERT-SFX         PIC X.
   806             20  PI-CERT-EFF-DT          PIC XX.
   807         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   808             20  PI-PLAN-CODE            PIC X(2).
   809             20  PI-REVISION-NUMBER      PIC X(3).
   810             20  PI-PLAN-EFF-DT          PIC X(2).
   811             20  PI-PLAN-EXP-DT          PIC X(2).
   812             20  FILLER                  PIC X(11).
   813         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   814             20  PI-OE-REFERENCE-1.
   815                 25  PI-OE-REF-1-PRIME   PIC X(18).
   816                 25  PI-OE-REF-1-SUFF    PIC XX.
   817
   818     12  PI-SESSION-IN-PROGRESS          PIC X.
   819         88  CLAIM-SESSION                   VALUE '1'.
   820         88  CREDIT-SESSION                  VALUE '2'.
   821         88  WARRANTY-SESSION                VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  20
* EL652.cbl
   822         88  MORTGAGE-SESSION                VALUE '4'.
   823         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   824
   825
   826*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   827
   828     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   829     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   830
   831     12  PI-CREDIT-USER                  PIC X.
   832         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   833         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   834
   835     12  PI-CLAIM-USER                   PIC X.
   836         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   837         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   838
   839     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   840         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   841         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   842         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   843         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   844         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   845
   846     12  PI-PROCESSOR-ID                 PIC X(4).
   847
   848     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   849
   850     12  PI-MEMBER-CAPTION               PIC X(10).
   851
   852     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   853         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   854
   855     12  PI-LIFE-OVERRIDE-L1             PIC X.
   856     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   857     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   858     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   859
   860     12  PI-AH-OVERRIDE-L1               PIC X.
   861     12  PI-AH-OVERRIDE-L2               PIC XX.
   862     12  PI-AH-OVERRIDE-L6               PIC X(6).
   863     12  PI-AH-OVERRIDE-L12              PIC X(12).
   864
   865     12  PI-NEW-SYSTEM                   PIC X(2).
   866
   867     12  PI-PRIMARY-CERT-NO              PIC X(11).
   868     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   869         88  PI-USES-PAID-TO                 VALUE '1'.
   870     12  PI-CRDTCRD-SYSTEM.
   871         16  PI-CRDTCRD-USER             PIC X.
   872             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   873             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   874         16  PI-CC-MONTH-END-DT          PIC XX.
   875     12  PI-PROCESSOR-PRINTER            PIC X(4).
   876
   877     12  PI-OE-REFERENCE-2.
   878         16  PI-OE-REF-2-PRIME           PIC X(10).
   879         16  PI-OE-REF-2-SUFF            PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  21
* EL652.cbl
   880
   881     12  PI-REM-TRM-CALC-OPTION          PIC X.
   882
   883     12  PI-LANGUAGE-TYPE                PIC X.
   884             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   885             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   886             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   887
   888     12  PI-POLICY-LINKAGE-IND           PIC X.
   889         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   890         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   891                                                   LOW-VALUES.
   892
   893     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   894     12  PI-CLAIM-PW-SESSION             PIC X(1).
   895         88  PI-CLAIM-CREDIT                 VALUE '1'.
   896         88  PI-CLAIM-CONVEN                 VALUE '2'.
   897     12  FILLER                          PIC X(4).
   898
   899     12  PI-SYSTEM-LEVEL                 PIC X(145).
   900
   901     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   902         PI-SYSTEM-LEVEL.
   903
   904         16  PI-ENTRY-CODES.
   905             20  PI-ENTRY-CD-1           PIC X.
   906             20  PI-ENTRY-CD-2           PIC X.
   907
   908         16  PI-RETURN-CODES.
   909             20  PI-RETURN-CD-1          PIC X.
   910             20  PI-RETURN-CD-2          PIC X.
   911
   912         16  PI-UPDATE-STATUS-SAVE.
   913             20  PI-UPDATE-BY            PIC X(4).
   914             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   915
   916         16  PI-LOWER-CASE-LETTERS       PIC X.
   917             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   918
   919*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   920*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   921*            88  CARRIER-CLM-CNTL            VALUE '2'.
   922
   923         16  PI-CERT-ACCESS-CONTROL      PIC X.
   924             88  ST-ACCNT-CNTL               VALUE ' '.
   925             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   926             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   927             88  ACCNT-CNTL                  VALUE '3'.
   928             88  CARR-ACCNT-CNTL             VALUE '4'.
   929
   930         16  PI-PROCESSOR-CAP-LIST.
   931             20  PI-SYSTEM-CONTROLS.
   932                24 PI-SYSTEM-DISPLAY     PIC X.
   933                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   934                24 PI-SYSTEM-MODIFY      PIC X.
   935                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   936             20  FILLER                  PIC XX.
   937             20  PI-DISPLAY-CAP          PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  22
* EL652.cbl
   938                 88  DISPLAY-CAP             VALUE 'Y'.
   939             20  PI-MODIFY-CAP           PIC X.
   940                 88  MODIFY-CAP              VALUE 'Y'.
   941             20  PI-MSG-AT-LOGON-CAP     PIC X.
   942                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   943             20  PI-FORCE-CAP            PIC X.
   944                 88  FORCE-CAP               VALUE 'Y'.
   945
   946         16  PI-PROGRAM-CONTROLS.
   947             20  PI-PGM-PRINT-OPT        PIC X.
   948             20  PI-PGM-FORMAT-OPT       PIC X.
   949             20  PI-PGM-PROCESS-OPT      PIC X.
   950             20  PI-PGM-TOTALS-OPT       PIC X.
   951
   952         16  PI-HELP-INTERFACE.
   953             20  PI-LAST-ERROR-NO        PIC X(4).
   954             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   955
   956         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   957             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   958
   959         16  PI-CR-CONTROL-IN-PROGRESS.
   960             20  PI-CR-CARRIER           PIC X.
   961             20  PI-CR-GROUPING          PIC X(6).
   962             20  PI-CR-STATE             PIC XX.
   963             20  PI-CR-ACCOUNT           PIC X(10).
   964             20  PI-CR-FIN-RESP          PIC X(10).
   965             20  PI-CR-TYPE              PIC X.
   966
   967         16  PI-CR-BATCH-NUMBER          PIC X(6).
   968
   969         16  PI-CR-MONTH-END-DT          PIC XX.
   970
   971         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   972             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   973             88  PI-ZERO-CARRIER             VALUE '1'.
   974             88  PI-ZERO-GROUPING            VALUE '2'.
   975             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   976
   977         16  PI-CARRIER-SECURITY         PIC X.
   978             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   979
   980         16  PI-ACCOUNT-SECURITY         PIC X(10).
   981             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   982             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   983
   984         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   985             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   986                                         INDEXED BY PI-ACCESS-NDX
   987                                         PIC X.
   988
   989         16  PI-GA-BILLING-CONTROL       PIC X.
   990             88  PI-GA-BILLING               VALUE '1'.
   991
   992         16  PI-MAIL-PROCESSING          PIC X.
   993             88  PI-MAIL-YES                 VALUE 'Y'.
   994
   995         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  23
* EL652.cbl
   996
   997         16  PI-AR-SYSTEM.
   998             20  PI-AR-PROCESSING-CNTL   PIC X.
   999                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1000             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1001             20  PI-AR-MONTH-END-DT      PIC XX.
  1002
  1003         16  PI-MP-SYSTEM.
  1004             20  PI-MORTGAGE-USER            PIC X.
  1005                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1006                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1007             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1008                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1009                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1010                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1011                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1012                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1013             20  PI-MP-MONTH-END-DT          PIC XX.
  1014             20  PI-MP-REFERENCE-NO.
  1015                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1016                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1017
  1018         16  PI-LABEL-CONTROL            PIC X(01).
  1019             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1020             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1021
  1022         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1023             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1024
  1025         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1026             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1027             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1028
  1029         16  FILLER                      PIC X(14).
  1030
  1031     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1032******************************************************************
  1033     12  PI-WORK-AREA  REDEFINES  PI-PROGRAM-WORK-AREA.
  1034         16  PI-CHECK-MAINT-TYPE     PIC  X.
  1035             88  VALID-MAINT-TYPE            VALUE 'S' 'A'
  1036                                                   'C' 'D'.
  1037             88  ADD-FUNCTION                VALUE 'A'.
  1038             88  SHOW-FUNCTION               VALUE 'S'.
  1039             88  DELETE-FUNCTION             VALUE 'D'.
  1040             88  CHANGE-FUNCTION             VALUE 'C'.
  1041         16  PI-CHECK-TYPE           PIC  X.
  1042             88  VALID-TYPE                  VALUE 'A' 'B' 'C'
  1043                                                           'G'.
  1044         16  PI-CHECK-CARRY-BAL      PIC  X.
  1045             88  VALID-CARRY-BAL             VALUE 'Y' 'N'.
  1046         16  PI-FIRST-TIME-SW        PIC  X.
  1047             88  FIRST-TIME                  VALUE 'Y'.
  1048         16  PI-ERCOMP-EOF-SW        PIC  X.
  1049             88  ERCOMP-EOF                  VALUE 'Y'.
  1050         16  PI-SAVE-PHONE           PIC  X(10).
  1051         16  PI-SAVE-PHONE-RED REDEFINES PI-SAVE-PHONE  PIC 9(10).
  1052         16  PI-ERC-END-BAL          PIC S9(9)V99       COMP-3.
  1053         16  PI-ERCOMP-KEY.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  24
* EL652.cbl
  1054             20  PI-ERC-COMPANY-CD   PIC  X.
  1055             20  PI-ERC-CARRIER      PIC  X.
  1056             20  PI-ERC-GROUP        PIC  X(6).
  1057             20  PI-ERC-RESP         PIC  X(10).
  1058             20  PI-ERC-ACCT         PIC  X(10).
  1059             20  PI-ERC-TYPE         PIC  X.
  1060         16  PI-SAVE-ERCOMP-KEY      PIC  X(29).
  1061         16  PI-SAVE-FAXNO           PIC  X(10).
  1062         16  PI-SAVE-FAXNO-RED REDEFINES PI-SAVE-FAXNO  PIC 9(10).
  1063         16  PI-SAVE-ADDR2           PIC X(30).
  1064         16  PI-SAVE-CITYST.
  1065             20  PI-SAVE-CITY        PIC X(28).
  1066             20  PI-SAVE-STATE       PIC XX.
  1067         16  PI-SAVE-ACCT-NAME       PIC X(30).
  1068         16  PI-EL652-DEL-SW         PIC X.
  1069         16  PI-UPDATE-SW            PIC X.
  1070         16  FILLER                  PIC  X(457).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  25
* EL652.cbl
  1072*                            COPY ELCJPFX.
  1073******************************************************************
  1074*                                                                *
  1075*                                                                *
  1076*                            ELCJPFX.                            *
  1077*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1078*                            VMOD=2.002                          *
  1079*                                                                *
  1080*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1081*                                                                *
  1082*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1083*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1084*        ELCNTL - CONTROL FILE                                   *
  1085*        ELMSTR - CLAIM MASTERS                                  *
  1086*        ELTRLR - ACTIVITY TRAILERS                              *
  1087*        ELCHKQ - CHECK QUE                                      *
  1088******************************************************************
  1089 01  JOURNAL-RECORD.
  1090     12  JP-USER-ID                  PIC X(4).
  1091     12  JP-FILE-ID                  PIC X(8).
  1092     12  JP-PROGRAM-ID               PIC X(8).
  1093     12  JP-RECORD-TYPE              PIC X.
  1094         88 JP-ADD              VALUE 'A'.
  1095         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1096         88 JP-AFTER-CHANGE     VALUE 'C'.
  1097         88 JP-DELETE           VALUE 'D'.
  1098         88 JP-GENERIC-DELETE   VALUE 'G'.
  1099         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1100         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1101     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1102     12  JP-RECORD-AREA
  1103
  1104
  1105                             PIC  X(750).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  26
* EL652.cbl
  1107*                            COPY ELCAID.
  1108******************************************************************
  1109*                                                                *
  1110*                            ELCAID.                             *
  1111*                            VMOD=2.001                          *
  1112*                                                                *
  1113*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1114*                                                                *
  1115*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1116*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1117******************************************************************
  1118
  1119 01  DFHAID.
  1120   02  DFHNULL   PIC  X  VALUE  ' '.
  1121   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1122   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1123   02  DFHPEN    PIC  X  VALUE  '='.
  1124   02  DFHOPID   PIC  X  VALUE  'W'.
  1125   02  DFHPA1    PIC  X  VALUE  '%'.
  1126   02  DFHPA2    PIC  X  VALUE  '>'.
  1127   02  DFHPA3    PIC  X  VALUE  ','.
  1128   02  DFHPF1    PIC  X  VALUE  '1'.
  1129   02  DFHPF2    PIC  X  VALUE  '2'.
  1130   02  DFHPF3    PIC  X  VALUE  '3'.
  1131   02  DFHPF4    PIC  X  VALUE  '4'.
  1132   02  DFHPF5    PIC  X  VALUE  '5'.
  1133   02  DFHPF6    PIC  X  VALUE  '6'.
  1134   02  DFHPF7    PIC  X  VALUE  '7'.
  1135   02  DFHPF8    PIC  X  VALUE  '8'.
  1136   02  DFHPF9    PIC  X  VALUE  '9'.
  1137   02  DFHPF10   PIC  X  VALUE  ':'.
  1138   02  DFHPF11   PIC  X  VALUE  '#'.
  1139   02  DFHPF12   PIC  X  VALUE  '@'.
  1140   02  DFHPF13   PIC  X  VALUE  'A'.
  1141   02  DFHPF14   PIC  X  VALUE  'B'.
  1142   02  DFHPF15   PIC  X  VALUE  'C'.
  1143   02  DFHPF16   PIC  X  VALUE  'D'.
  1144   02  DFHPF17   PIC  X  VALUE  'E'.
  1145   02  DFHPF18   PIC  X  VALUE  'F'.
  1146   02  DFHPF19   PIC  X  VALUE  'G'.
  1147   02  DFHPF20   PIC  X  VALUE  'H'.
  1148   02  DFHPF21   PIC  X  VALUE  'I'.
  1149*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1150   02  DFHPF22   PIC  X  VALUE  '['.
  1151   02  DFHPF23   PIC  X  VALUE  '.'.
  1152   02  DFHPF24   PIC  X  VALUE  '<'.
  1153   02  DFHMSRE   PIC  X  VALUE  'X'.
  1154   02  DFHSTRF   PIC  X  VALUE  'h'.
  1155   02  DFHTRIG   PIC  X  VALUE  '"'.
  1156
  1157 01  FILLER  REDEFINES  DFHAID.
  1158     12  FILLER              PIC  X(8).
  1159     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  27
* EL652.cbl
  1161*                            COPY EL652S.
  1162 01  EL652AI.
  1163     05  FILLER            PIC  X(0012).
  1164*    -------------------------------
  1165     05  RUNDATEL PIC S9(0004) COMP.
  1166     05  RUNDATEF PIC  X(0001).
  1167     05  FILLER REDEFINES RUNDATEF.
  1168         10  RUNDATEA PIC  X(0001).
  1169     05  RUNDATEI PIC  X(0008).
  1170*    -------------------------------
  1171     05  RUNTIMEL PIC S9(0004) COMP.
  1172     05  RUNTIMEF PIC  X(0001).
  1173     05  FILLER REDEFINES RUNTIMEF.
  1174         10  RUNTIMEA PIC  X(0001).
  1175     05  RUNTIMEI PIC  X(0005).
  1176*    -------------------------------
  1177     05  CMPNYIDL PIC S9(0004) COMP.
  1178     05  CMPNYIDF PIC  X(0001).
  1179     05  FILLER REDEFINES CMPNYIDF.
  1180         10  CMPNYIDA PIC  X(0001).
  1181     05  CMPNYIDI PIC  X(0003).
  1182*    -------------------------------
  1183     05  USERIDL PIC S9(0004) COMP.
  1184     05  USERIDF PIC  X(0001).
  1185     05  FILLER REDEFINES USERIDF.
  1186         10  USERIDA PIC  X(0001).
  1187     05  USERIDI PIC  X(0004).
  1188*    -------------------------------
  1189     05  MAINTYPL PIC S9(0004) COMP.
  1190     05  MAINTYPF PIC  X(0001).
  1191     05  FILLER REDEFINES MAINTYPF.
  1192         10  MAINTYPA PIC  X(0001).
  1193     05  MAINTYPI PIC  X(0001).
  1194*    -------------------------------
  1195     05  SCDESCL PIC S9(0004) COMP.
  1196     05  SCDESCF PIC  X(0001).
  1197     05  FILLER REDEFINES SCDESCF.
  1198         10  SCDESCA PIC  X(0001).
  1199     05  SCDESCI PIC  X(0008).
  1200*    -------------------------------
  1201     05  FLITYPEL PIC S9(0004) COMP.
  1202     05  FLITYPEF PIC  X(0001).
  1203     05  FILLER REDEFINES FLITYPEF.
  1204         10  FLITYPEA PIC  X(0001).
  1205     05  FLITYPEI PIC  X(0004).
  1206*    -------------------------------
  1207     05  CARRIERL PIC S9(0004) COMP.
  1208     05  CARRIERF PIC  X(0001).
  1209     05  FILLER REDEFINES CARRIERF.
  1210         10  CARRIERA PIC  X(0001).
  1211     05  CARRIERI PIC  X(0001).
  1212*    -------------------------------
  1213     05  GROUPL PIC S9(0004) COMP.
  1214     05  GROUPF PIC  X(0001).
  1215     05  FILLER REDEFINES GROUPF.
  1216         10  GROUPA PIC  X(0001).
  1217     05  GROUPI PIC  X(0006).
  1218*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  28
* EL652.cbl
  1219     05  TYPEL PIC S9(0004) COMP.
  1220     05  TYPEF PIC  X(0001).
  1221     05  FILLER REDEFINES TYPEF.
  1222         10  TYPEA PIC  X(0001).
  1223     05  TYPEI PIC  X(0001).
  1224*    -------------------------------
  1225     05  FINRESPL PIC S9(0004) COMP.
  1226     05  FINRESPF PIC  X(0001).
  1227     05  FILLER REDEFINES FINRESPF.
  1228         10  FINRESPA PIC  X(0001).
  1229     05  FINRESPI PIC  X(0010).
  1230*    -------------------------------
  1231     05  ACCTNOL PIC S9(0004) COMP.
  1232     05  ACCTNOF PIC  X(0001).
  1233     05  FILLER REDEFINES ACCTNOF.
  1234         10  ACCTNOA PIC  X(0001).
  1235     05  ACCTNOI PIC  X(0010).
  1236*    -------------------------------
  1237     05  SUMMNOL PIC S9(0004) COMP.
  1238     05  SUMMNOF PIC  X(0001).
  1239     05  FILLER REDEFINES SUMMNOF.
  1240         10  SUMMNOA PIC  X(0001).
  1241     05  SUMMNOI PIC  X(0006).
  1242*    -------------------------------
  1243     05  LSTMDTL PIC S9(0004) COMP.
  1244     05  LSTMDTF PIC  X(0001).
  1245     05  FILLER REDEFINES LSTMDTF.
  1246         10  LSTMDTA PIC  X(0001).
  1247     05  LSTMDTI PIC  X(0008).
  1248*    -------------------------------
  1249     05  FLITYPL PIC S9(0004) COMP.
  1250     05  FLITYPF PIC  X(0001).
  1251     05  FILLER REDEFINES FLITYPF.
  1252         10  FLITYPA PIC  X(0001).
  1253     05  FLITYPI PIC  X(0001).
  1254*    -------------------------------
  1255     05  PCONTL PIC S9(0004) COMP.
  1256     05  PCONTF PIC  X(0001).
  1257     05  FILLER REDEFINES PCONTF.
  1258         10  PCONTA PIC  X(0001).
  1259     05  PCONTI PIC  X(0030).
  1260*    -------------------------------
  1261     05  PNT1099L PIC S9(0004) COMP.
  1262     05  PNT1099F PIC  X(0001).
  1263     05  FILLER REDEFINES PNT1099F.
  1264         10  PNT1099A PIC  X(0001).
  1265     05  PNT1099I PIC  X(0001).
  1266*    -------------------------------
  1267     05  MAILNAML PIC S9(0004) COMP.
  1268     05  MAILNAMF PIC  X(0001).
  1269     05  FILLER REDEFINES MAILNAMF.
  1270         10  MAILNAMA PIC  X(0001).
  1271     05  MAILNAMI PIC  X(0030).
  1272*    -------------------------------
  1273     05  SSNL PIC S9(0004) COMP.
  1274     05  SSNF PIC  X(0001).
  1275     05  FILLER REDEFINES SSNF.
  1276         10  SSNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  29
* EL652.cbl
  1277     05  SSNI PIC  X(0013).
  1278*    -------------------------------
  1279     05  ACCTNAML PIC S9(0004) COMP.
  1280     05  ACCTNAMF PIC  X(0001).
  1281     05  FILLER REDEFINES ACCTNAMF.
  1282         10  ACCTNAMA PIC  X(0001).
  1283     05  ACCTNAMI PIC  X(0030).
  1284*    -------------------------------
  1285     05  PHONEL PIC S9(0004) COMP.
  1286     05  PHONEF PIC  X(0001).
  1287     05  FILLER REDEFINES PHONEF.
  1288         10  PHONEA PIC  X(0001).
  1289     05  PHONEI PIC  X(0012).
  1290*    -------------------------------
  1291     05  ADDR1L PIC S9(0004) COMP.
  1292     05  ADDR1F PIC  X(0001).
  1293     05  FILLER REDEFINES ADDR1F.
  1294         10  ADDR1A PIC  X(0001).
  1295     05  ADDR1I PIC  X(0030).
  1296*    -------------------------------
  1297     05  FAXDESCL PIC S9(0004) COMP.
  1298     05  FAXDESCF PIC  X(0001).
  1299     05  FILLER REDEFINES FAXDESCF.
  1300         10  FAXDESCA PIC  X(0001).
  1301     05  FAXDESCI PIC  X(0016).
  1302*    -------------------------------
  1303     05  FAXNOL PIC S9(0004) COMP.
  1304     05  FAXNOF PIC  X(0001).
  1305     05  FILLER REDEFINES FAXNOF.
  1306         10  FAXNOA PIC  X(0001).
  1307     05  FAXNOI PIC  X(0012).
  1308*    -------------------------------
  1309     05  ADDR2L PIC S9(0004) COMP.
  1310     05  ADDR2F PIC  X(0001).
  1311     05  FILLER REDEFINES ADDR2F.
  1312         10  ADDR2A PIC  X(0001).
  1313     05  ADDR2I PIC  X(0030).
  1314*    -------------------------------
  1315     05  CARBALL PIC S9(0004) COMP.
  1316     05  CARBALF PIC  X(0001).
  1317     05  FILLER REDEFINES CARBALF.
  1318         10  CARBALA PIC  X(0001).
  1319     05  CARBALI PIC  X(0001).
  1320*    -------------------------------
  1321     05  CITYL PIC S9(0004) COMP.
  1322     05  CITYF PIC  X(0001).
  1323     05  FILLER REDEFINES CITYF.
  1324         10  CITYA PIC  X(0001).
  1325     05  CITYI PIC  X(0028).
  1326*    -------------------------------
  1327     05  STATEL PIC S9(0004) COMP.
  1328     05  STATEF PIC  X(0001).
  1329     05  FILLER REDEFINES STATEF.
  1330         10  STATEA PIC  X(0001).
  1331     05  STATEI PIC  X(0002).
  1332*    -------------------------------
  1333     05  REFEHL PIC S9(0004) COMP.
  1334     05  REFEHF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  30
* EL652.cbl
  1335     05  FILLER REDEFINES REFEHF.
  1336         10  REFEHA PIC  X(0001).
  1337     05  REFEHI PIC  X(0013).
  1338*    -------------------------------
  1339     05  REFEL PIC S9(0004) COMP.
  1340     05  REFEF PIC  X(0001).
  1341     05  FILLER REDEFINES REFEF.
  1342         10  REFEA PIC  X(0001).
  1343     05  REFEI PIC  X(0001).
  1344*    -------------------------------
  1345     05  ZIPCODEL PIC S9(0004) COMP.
  1346     05  ZIPCODEF PIC  X(0001).
  1347     05  FILLER REDEFINES ZIPCODEF.
  1348         10  ZIPCODEA PIC  X(0001).
  1349     05  ZIPCODEI PIC  X(0010).
  1350*    -------------------------------
  1351     05  NGDESCL PIC S9(0004) COMP.
  1352     05  NGDESCF PIC  X(0001).
  1353     05  FILLER REDEFINES NGDESCF.
  1354         10  NGDESCA PIC  X(0001).
  1355     05  NGDESCI PIC  X(0012).
  1356*    -------------------------------
  1357     05  NETGRSL PIC S9(0004) COMP.
  1358     05  NETGRSF PIC  X(0001).
  1359     05  FILLER REDEFINES NETGRSF.
  1360         10  NETGRSA PIC  X(0001).
  1361     05  NETGRSI PIC  X(0001).
  1362*    -------------------------------
  1363     05  BALDESCL PIC S9(0004) COMP.
  1364     05  BALDESCF PIC  X(0001).
  1365     05  FILLER REDEFINES BALDESCF.
  1366         10  BALDESCA PIC  X(0001).
  1367     05  BALDESCI PIC  X(0016).
  1368*    -------------------------------
  1369     05  ARBALL PIC S9(0004) COMP.
  1370     05  ARBALF PIC  X(0001).
  1371     05  FILLER REDEFINES ARBALF.
  1372         10  ARBALA PIC  X(0001).
  1373     05  ARBALI PIC  X(0001).
  1374*    -------------------------------
  1375     05  CSRL PIC S9(0004) COMP.
  1376     05  CSRF PIC  X(0001).
  1377     05  FILLER REDEFINES CSRF.
  1378         10  CSRA PIC  X(0001).
  1379     05  CSRI PIC  X(0004).
  1380*    -------------------------------
  1381     05  RPTCDDL PIC S9(0004) COMP.
  1382     05  RPTCDDF PIC  X(0001).
  1383     05  FILLER REDEFINES RPTCDDF.
  1384         10  RPTCDDA PIC  X(0001).
  1385     05  RPTCDDI PIC  X(0010).
  1386*    -------------------------------
  1387     05  RPTCD2L PIC S9(0004) COMP.
  1388     05  RPTCD2F PIC  X(0001).
  1389     05  FILLER REDEFINES RPTCD2F.
  1390         10  RPTCD2A PIC  X(0001).
  1391     05  RPTCD2I PIC  X(0010).
  1392*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  31
* EL652.cbl
  1393     05  CKDESCL PIC S9(0004) COMP.
  1394     05  CKDESCF PIC  X(0001).
  1395     05  FILLER REDEFINES CKDESCF.
  1396         10  CKDESCA PIC  X(0001).
  1397     05  CKDESCI PIC  X(0016).
  1398*    -------------------------------
  1399     05  CKPULLL PIC S9(0004) COMP.
  1400     05  CKPULLF PIC  X(0001).
  1401     05  FILLER REDEFINES CKPULLF.
  1402         10  CKPULLA PIC  X(0001).
  1403     05  CKPULLI PIC  X(0001).
  1404*    -------------------------------
  1405     05  BILLPRTL PIC S9(0004) COMP.
  1406     05  BILLPRTF PIC  X(0001).
  1407     05  FILLER REDEFINES BILLPRTF.
  1408         10  BILLPRTA PIC  X(0001).
  1409     05  BILLPRTI PIC  X(0001).
  1410*    -------------------------------
  1411     05  LETDESCL PIC S9(0004) COMP.
  1412     05  LETDESCF PIC  X(0001).
  1413     05  FILLER REDEFINES LETDESCF.
  1414         10  LETDESCA PIC  X(0001).
  1415     05  LETDESCI PIC  X(0011).
  1416*    -------------------------------
  1417     05  LETRCDL PIC S9(0004) COMP.
  1418     05  LETRCDF PIC  X(0001).
  1419     05  FILLER REDEFINES LETRCDF.
  1420         10  LETRCDA PIC  X(0001).
  1421     05  LETRCDI PIC  X(0001).
  1422*    -------------------------------
  1423     05  BALPRTL PIC S9(0004) COMP.
  1424     05  BALPRTF PIC  X(0001).
  1425     05  FILLER REDEFINES BALPRTF.
  1426         10  BALPRTA PIC  X(0001).
  1427     05  BALPRTI PIC  X(0011).
  1428*    -------------------------------
  1429     05  BALCDL PIC S9(0004) COMP.
  1430     05  BALCDF PIC  X(0001).
  1431     05  FILLER REDEFINES BALCDF.
  1432         10  BALCDA PIC  X(0001).
  1433     05  BALCDI PIC  X(0001).
  1434*    -------------------------------
  1435     05  SPPDDHL PIC S9(0004) COMP.
  1436     05  SPPDDHF PIC  X(0001).
  1437     05  FILLER REDEFINES SPPDDHF.
  1438         10  SPPDDHA PIC  X(0001).
  1439     05  SPPDDHI PIC  X(0012).
  1440*    -------------------------------
  1441     05  SPPDDL PIC S9(0004) COMP.
  1442     05  SPPDDF PIC  X(0001).
  1443     05  FILLER REDEFINES SPPDDF.
  1444         10  SPPDDA PIC  X(0001).
  1445     05  SPPDDI PIC  X(0001).
  1446*    -------------------------------
  1447     05  MFLABLL PIC S9(0004) COMP.
  1448     05  MFLABLF PIC  X(0001).
  1449     05  FILLER REDEFINES MFLABLF.
  1450         10  MFLABLA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  32
* EL652.cbl
  1451     05  MFLABLI PIC  X(0016).
  1452*    -------------------------------
  1453     05  MAXFEEL PIC S9(0004) COMP.
  1454     05  MAXFEEF PIC  X(0001).
  1455     05  FILLER REDEFINES MAXFEEF.
  1456         10  MAXFEEA PIC  X(0001).
  1457     05  MAXFEEI PIC  S9(04)V99.
  1458*    -------------------------------
  1459     05  CSLABLL PIC S9(0004) COMP.
  1460     05  CSLABLF PIC  X(0001).
  1461     05  FILLER REDEFINES CSLABLF.
  1462         10  CSLABLA PIC  X(0001).
  1463     05  CSLABLI PIC  X(0012).
  1464*    -------------------------------
  1465     05  CLPSTL PIC S9(0004) COMP.
  1466     05  CLPSTF PIC  X(0001).
  1467     05  FILLER REDEFINES CLPSTF.
  1468         10  CLPSTA PIC  X(0001).
  1469     05  CLPSTI PIC  X(0002).
  1470*    -------------------------------
  1471     05  LFLABLL PIC S9(0004) COMP.
  1472     05  LFLABLF PIC  X(0001).
  1473     05  FILLER REDEFINES LFLABLF.
  1474         10  LFLABLA PIC  X(0001).
  1475     05  LFLABLI PIC  X(0016).
  1476*    -------------------------------
  1477     05  MAXLFL PIC S9(0004) COMP.
  1478     05  MAXLFF PIC  X(0001).
  1479     05  FILLER REDEFINES MAXLFF.
  1480         10  MAXLFA PIC  X(0001).
  1481     05  MAXLFI PIC  S9(04)V99.
  1482*    -------------------------------
  1483     05  BALFWDL PIC S9(0004) COMP.
  1484     05  BALFWDF PIC  X(0001).
  1485     05  FILLER REDEFINES BALFWDF.
  1486         10  BALFWDA PIC  X(0001).
  1487     05  BALFWDI PIC  S9(11)V99.
  1488*    -------------------------------
  1489     05  CURCOML PIC S9(0004) COMP.
  1490     05  CURCOMF PIC  X(0001).
  1491     05  FILLER REDEFINES CURCOMF.
  1492         10  CURCOMA PIC  X(0001).
  1493     05  CURCOMI PIC  S9(11)V99.
  1494*    -------------------------------
  1495     05  CURCHGL PIC S9(0004) COMP.
  1496     05  CURCHGF PIC  X(0001).
  1497     05  FILLER REDEFINES CURCHGF.
  1498         10  CURCHGA PIC  X(0001).
  1499     05  CURCHGI PIC  S9(11)V99.
  1500*    -------------------------------
  1501     05  CURPMTL PIC S9(0004) COMP.
  1502     05  CURPMTF PIC  X(0001).
  1503     05  FILLER REDEFINES CURPMTF.
  1504         10  CURPMTA PIC  X(0001).
  1505     05  CURPMTI PIC  S9(11)V99.
  1506*    -------------------------------
  1507     05  ENDBALL PIC S9(0004) COMP.
  1508     05  ENDBALF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  33
* EL652.cbl
  1509     05  FILLER REDEFINES ENDBALF.
  1510         10  ENDBALA PIC  X(0001).
  1511     05  ENDBALI PIC  S9(11)V99.
  1512*    -------------------------------
  1513     05  CURRENTL PIC S9(0004) COMP.
  1514     05  CURRENTF PIC  X(0001).
  1515     05  FILLER REDEFINES CURRENTF.
  1516         10  CURRENTA PIC  X(0001).
  1517     05  CURRENTI PIC  X(0013).
  1518*    -------------------------------
  1519     05  OVER30L PIC S9(0004) COMP.
  1520     05  OVER30F PIC  X(0001).
  1521     05  FILLER REDEFINES OVER30F.
  1522         10  OVER30A PIC  X(0001).
  1523     05  OVER30I PIC  X(0013).
  1524*    -------------------------------
  1525     05  OVER60L PIC S9(0004) COMP.
  1526     05  OVER60F PIC  X(0001).
  1527     05  FILLER REDEFINES OVER60F.
  1528         10  OVER60A PIC  X(0001).
  1529     05  OVER60I PIC  X(0013).
  1530*    -------------------------------
  1531     05  OVER90L PIC S9(0004) COMP.
  1532     05  OVER90F PIC  X(0001).
  1533     05  FILLER REDEFINES OVER90F.
  1534         10  OVER90A PIC  X(0001).
  1535     05  OVER90I PIC  X(0013).
  1536*    -------------------------------
  1537     05  YTDCOML PIC S9(0004) COMP.
  1538     05  YTDCOMF PIC  X(0001).
  1539     05  FILLER REDEFINES YTDCOMF.
  1540         10  YTDCOMA PIC  X(0001).
  1541     05  YTDCOMI PIC  S9(11)V99.
  1542*    -------------------------------
  1543     05  LSTDTEL PIC S9(0004) COMP.
  1544     05  LSTDTEF PIC  X(0001).
  1545     05  FILLER REDEFINES LSTDTEF.
  1546         10  LSTDTEA PIC  X(0001).
  1547     05  LSTDTEI PIC  X(0008).
  1548*    -------------------------------
  1549     05  LSTTIMEL PIC S9(0004) COMP.
  1550     05  LSTTIMEF PIC  X(0001).
  1551     05  FILLER REDEFINES LSTTIMEF.
  1552         10  LSTTIMEA PIC  X(0001).
  1553     05  LSTTIMEI PIC  X(0005).
  1554*    -------------------------------
  1555     05  LSTUSRL PIC S9(0004) COMP.
  1556     05  LSTUSRF PIC  X(0001).
  1557     05  FILLER REDEFINES LSTUSRF.
  1558         10  LSTUSRA PIC  X(0001).
  1559     05  LSTUSRI PIC  X(0004).
  1560*    -------------------------------
  1561     05  ERRMSG1L PIC S9(0004) COMP.
  1562     05  ERRMSG1F PIC  X(0001).
  1563     05  FILLER REDEFINES ERRMSG1F.
  1564         10  ERRMSG1A PIC  X(0001).
  1565     05  ERRMSG1I PIC  X(0072).
  1566*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  34
* EL652.cbl
  1567     05  PFKEYL PIC S9(0004) COMP.
  1568     05  PFKEYF PIC  X(0001).
  1569     05  FILLER REDEFINES PFKEYF.
  1570         10  PFKEYA PIC  X(0001).
  1571     05  PFKEYI PIC  99.
  1572*    -------------------------------
  1573     05  PFK5L PIC S9(0004) COMP.
  1574     05  PFK5F PIC  X(0001).
  1575     05  FILLER REDEFINES PFK5F.
  1576         10  PFK5A PIC  X(0001).
  1577     05  PFK5I PIC  X(0011).
  1578*    -------------------------------
  1579     05  PFK7L PIC S9(0004) COMP.
  1580     05  PFK7F PIC  X(0001).
  1581     05  FILLER REDEFINES PFK7F.
  1582         10  PFK7A PIC  X(0001).
  1583     05  PFK7I PIC  X(0012).
  1584*    -------------------------------
  1585     05  PFK9L PIC S9(0004) COMP.
  1586     05  PFK9F PIC  X(0001).
  1587     05  FILLER REDEFINES PFK9F.
  1588         10  PFK9A PIC  X(0001).
  1589     05  PFK9I PIC  X(0012).
  1590*    -------------------------------
  1591     05  PFK13L PIC S9(0004) COMP.
  1592     05  PFK13F PIC  X(0001).
  1593     05  FILLER REDEFINES PFK13F.
  1594         10  PFK13A PIC  X(0001).
  1595     05  PFK13I PIC  X(0011).
  1596*    -------------------------------
  1597     05  PFK4L PIC S9(0004) COMP.
  1598     05  PFK4F PIC  X(0001).
  1599     05  FILLER REDEFINES PFK4F.
  1600         10  PFK4A PIC  X(0001).
  1601     05  PFK4I PIC  X(0012).
  1602*    -------------------------------
  1603     05  PFK6L PIC S9(0004) COMP.
  1604     05  PFK6F PIC  X(0001).
  1605     05  FILLER REDEFINES PFK6F.
  1606         10  PFK6A PIC  X(0001).
  1607     05  PFK6I PIC  X(0011).
  1608*    -------------------------------
  1609     05  PFK10L PIC S9(0004) COMP.
  1610     05  PFK10F PIC  X(0001).
  1611     05  FILLER REDEFINES PFK10F.
  1612         10  PFK10A PIC  X(0001).
  1613     05  PFK10I PIC  X(0014).
  1614 01  EL652AO REDEFINES EL652AI.
  1615     05  FILLER            PIC  X(0012).
  1616*    -------------------------------
  1617     05  FILLER            PIC  X(0003).
  1618     05  RUNDATEO PIC  X(0008).
  1619*    -------------------------------
  1620     05  FILLER            PIC  X(0003).
  1621     05  RUNTIMEO PIC  99.99.
  1622*    -------------------------------
  1623     05  FILLER            PIC  X(0003).
  1624     05  CMPNYIDO PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  35
* EL652.cbl
  1625*    -------------------------------
  1626     05  FILLER            PIC  X(0003).
  1627     05  USERIDO PIC  X(0004).
  1628*    -------------------------------
  1629     05  FILLER            PIC  X(0003).
  1630     05  MAINTYPO PIC  X(0001).
  1631*    -------------------------------
  1632     05  FILLER            PIC  X(0003).
  1633     05  SCDESCO PIC  X(0008).
  1634*    -------------------------------
  1635     05  FILLER            PIC  X(0003).
  1636     05  FLITYPEO PIC  X(0004).
  1637*    -------------------------------
  1638     05  FILLER            PIC  X(0003).
  1639     05  CARRIERO PIC  X(0001).
  1640*    -------------------------------
  1641     05  FILLER            PIC  X(0003).
  1642     05  GROUPO PIC  X(0006).
  1643*    -------------------------------
  1644     05  FILLER            PIC  X(0003).
  1645     05  TYPEO PIC  X(0001).
  1646*    -------------------------------
  1647     05  FILLER            PIC  X(0003).
  1648     05  FINRESPO PIC  X(0010).
  1649*    -------------------------------
  1650     05  FILLER            PIC  X(0003).
  1651     05  ACCTNOO PIC  X(0010).
  1652*    -------------------------------
  1653     05  FILLER            PIC  X(0003).
  1654     05  SUMMNOO PIC  X(0006).
  1655*    -------------------------------
  1656     05  FILLER            PIC  X(0003).
  1657     05  LSTMDTO PIC  X(0008).
  1658*    -------------------------------
  1659     05  FILLER            PIC  X(0003).
  1660     05  FLITYPO PIC  X(0001).
  1661*    -------------------------------
  1662     05  FILLER            PIC  X(0003).
  1663     05  PCONTO PIC  X(0030).
  1664*    -------------------------------
  1665     05  FILLER            PIC  X(0003).
  1666     05  PNT1099O PIC  X(0001).
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  MAILNAMO PIC  X(0030).
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  SSNO PIC  X(0013).
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  ACCTNAMO PIC  X(0030).
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  PHONEO PIC  X(0012).
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  ADDR1O PIC  X(0030).
  1682*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  36
* EL652.cbl
  1683     05  FILLER            PIC  X(0003).
  1684     05  FAXDESCO PIC  X(0016).
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  FAXNOO PIC  X(0012).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  ADDR2O PIC  X(0030).
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  CARBALO PIC  X(0001).
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  CITYO PIC  X(0028).
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  STATEO PIC  X(0002).
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  REFEHO PIC  X(0013).
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  REFEO PIC  X(0001).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  ZIPCODEO PIC  X(0010).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  NGDESCO PIC  X(0012).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  NETGRSO PIC  X(0001).
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  BALDESCO PIC  X(0016).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  ARBALO PIC  X(0001).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  CSRO PIC  X(0004).
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  RPTCDDO PIC  X(0010).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  RPTCD2O PIC  X(0010).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  CKDESCO PIC  X(0016).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  CKPULLO PIC  X(0001).
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  BILLPRTO PIC  X(0001).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  37
* EL652.cbl
  1741     05  LETDESCO PIC  X(0011).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  LETRCDO PIC  X(0001).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  BALPRTO PIC  X(0011).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  BALCDO PIC  X(0001).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  SPPDDHO PIC  X(0012).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  SPPDDO PIC  X(0001).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  MFLABLO PIC  X(0016).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  MAXFEEO PIC  Z99.99.
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  CSLABLO PIC  X(0012).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  CLPSTO PIC  X(0002).
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  LFLABLO PIC  X(0016).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  MAXLFO PIC  Z99.99.
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  BALFWDO PIC  Z,ZZZ,ZZZ.99-.
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  CURCOMO PIC  Z,ZZZ,ZZZ.99-.
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
  1783     05  CURCHGO PIC  Z,ZZZ,ZZZ.99-.
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  CURPMTO PIC  Z,ZZZ,ZZZ.99-.
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
  1789     05  ENDBALO PIC  Z,ZZZ,ZZZ.99-.
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  CURRENTO PIC  Z,ZZZ,ZZZ.99-.
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  OVER30O PIC  Z,ZZZ,ZZZ.99-.
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  OVER60O PIC  Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  38
* EL652.cbl
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  OVER90O PIC  Z,ZZZ,ZZZ.99-.
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  YTDCOMO PIC  Z,ZZZ,ZZZ.99-.
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  LSTDTEO PIC  X(0008).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  LSTTIMEO PIC  99.99.
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  LSTUSRO PIC  X(0004).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  ERRMSG1O PIC  X(0072).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  PFKEYO PIC  X(0002).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  PFK5O PIC  X(0011).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  PFK7O PIC  X(0012).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  PFK9O PIC  X(0012).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  PFK13O PIC  X(0011).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  PFK4O PIC  X(0012).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  PFK6O PIC  X(0011).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  PFK10O PIC  X(0014).
  1841*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  39
* EL652.cbl
  1843****************************************************************
  1844*
  1845* Copyright (c) 2007 by Clerity Solutions, Inc.
  1846* All rights reserved.
  1847*
  1848****************************************************************
  1849 01  DFHEIV.
  1850   02  DFHEIV0               PIC X(35).
  1851   02  DFHEIV1               PIC X(08).
  1852   02  DFHEIV2               PIC X(08).
  1853   02  DFHEIV3               PIC X(08).
  1854   02  DFHEIV4               PIC X(06).
  1855   02  DFHEIV5               PIC X(04).
  1856   02  DFHEIV6               PIC X(04).
  1857   02  DFHEIV7               PIC X(02).
  1858   02  DFHEIV8               PIC X(02).
  1859   02  DFHEIV9               PIC X(01).
  1860   02  DFHEIV10              PIC S9(7) COMP-3.
  1861   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1862   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1863   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1864   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1865   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1866   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1867   02  DFHEIV17              PIC X(04).
  1868   02  DFHEIV18              PIC X(04).
  1869   02  DFHEIV19              PIC X(04).
  1870   02  DFHEIV20              USAGE IS POINTER.
  1871   02  DFHEIV21              USAGE IS POINTER.
  1872   02  DFHEIV22              USAGE IS POINTER.
  1873   02  DFHEIV23              USAGE IS POINTER.
  1874   02  DFHEIV24              USAGE IS POINTER.
  1875   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1876   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1877   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1878   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1879   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1880   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1881   02  FILLER                PIC X(02).
  1882   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1883   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1884   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1885   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1886   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1887 LINKAGE  SECTION.
  1888*****************************************************************
  1889*                                                               *
  1890* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1891* All rights reserved.                                          *
  1892*                                                               *
  1893*****************************************************************
  1894 01  dfheiblk.
  1895     02  eibtime          pic s9(7) comp-3.
  1896     02  eibdate          pic s9(7) comp-3.
  1897     02  eibtrnid         pic x(4).
  1898     02  eibtaskn         pic s9(7) comp-3.
  1899     02  eibtrmid         pic x(4).
  1900     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  40
* EL652.cbl
  1901     02  eibcposn         pic s9(4) comp.
  1902     02  eibcalen         pic s9(4) comp.
  1903     02  eibaid           pic x(1).
  1904     02  eibfiller1       pic x(1).
  1905     02  eibfn            pic x(2).
  1906     02  eibfiller2       pic x(2).
  1907     02  eibrcode         pic x(6).
  1908     02  eibfiller3       pic x(2).
  1909     02  eibds            pic x(8).
  1910     02  eibreqid         pic x(8).
  1911     02  eibrsrce         pic x(8).
  1912     02  eibsync          pic x(1).
  1913     02  eibfree          pic x(1).
  1914     02  eibrecv          pic x(1).
  1915     02  eibsend          pic x(1).
  1916     02  eibatt           pic x(1).
  1917     02  eibeoc           pic x(1).
  1918     02  eibfmh           pic x(1).
  1919     02  eibcompl         pic x(1).
  1920     02  eibsig           pic x(1).
  1921     02  eibconf          pic x(1).
  1922     02  eiberr           pic x(1).
  1923     02  eibrldbk         pic x(1).
  1924     02  eiberrcd         pic x(4).
  1925     02  eibsynrb         pic x(1).
  1926     02  eibnodat         pic x(1).
  1927     02  eibfiller5       pic x(2).
  1928     02  eibresp          pic 9(09) comp.
  1929     02  eibresp2         pic 9(09) comp.
  1930     02  dfheigdj         pic s9(4) comp.
  1931     02  dfheigdk         pic s9(4) comp.
  1932
  1933 01  DFHCOMMAREA             PIC  X(1024).
  1934
  1935*01 PARMLIST .
  1936*    12  FILLER              PIC S9(8)                  COMP.
  1937*    12  ERCOMP-POINTER      PIC S9(8)                  COMP.
  1938*    12  ERNAME-POINTER      PIC S9(8)                  COMP.
  1939*    12  ELCNTL-POINTER      PIC S9(8)                  COMP.
  1940*    12  ERSUMM-POINTER      PIC S9(8)                  COMP.
  1941*    12  ERRQST-POINTER      PIC S9(8)                  COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  41
* EL652.cbl
  1943*                            COPY ERCCOMP.
  1944******************************************************************
  1945*                                                                *
  1946*                                                                *
  1947*                            ERCCOMP                             *
  1948*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1949*                            VMOD=2.019                          *
  1950*                                                                *
  1951*   ONLINE CREDIT SYSTEM                                         *
  1952*                                                                *
  1953*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1954*                                                                *
  1955*   FILE TYPE = VSAM,KSDS                                        *
  1956*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1957*                                                                *
  1958*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1959*       ALTERNATE PATH = NONE                                    *
  1960*                                                                *
  1961*   LOG = NO                                                     *
  1962*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1963*                                                                *
  1964******************************************************************
  1965*                   C H A N G E   L O G
  1966*
  1967* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1968*-----------------------------------------------------------------
  1969*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1970* EFFECTIVE    NUMBER
  1971*-----------------------------------------------------------------
  1972* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1973* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1974* 092205    2005050300006  PEMA  ADD LEASE FEE
  1975* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1976* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1977* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1978* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1979* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1980******************************************************************
  1981
  1982 01  COMPENSATION-MASTER.
  1983     12  CO-RECORD-ID                          PIC XX.
  1984         88  VALID-CO-ID                          VALUE 'CO'.
  1985
  1986     12  CO-CONTROL-PRIMARY.
  1987         16  CO-COMPANY-CD                     PIC X.
  1988         16  CO-CONTROL.
  1989             20  CO-CTL-1.
  1990                 24  CO-CARR-GROUP.
  1991                     28  CO-CARRIER            PIC X.
  1992                     28  CO-GROUPING.
  1993                         32  CO-GROUP-PREFIX   PIC XXX.
  1994                         32  CO-GROUP-PRIME    PIC XXX.
  1995                 24  CO-RESP-NO.
  1996                     28  CO-RESP-PREFIX        PIC X(4).
  1997                     28  CO-RESP-PRIME         PIC X(6).
  1998             20  CO-CTL-2.
  1999                 24  CO-ACCOUNT.
  2000                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  42
* EL652.cbl
  2001                     28  CO-ACCT-PRIME         PIC X(6).
  2002         16  CO-TYPE                           PIC X.
  2003             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2004             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2005             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2006
  2007     12  CO-MAINT-INFORMATION.
  2008         16  CO-LAST-MAINT-DT                  PIC XX.
  2009         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2010         16  CO-LAST-MAINT-USER                PIC X(4).
  2011     12  FILLER                                PIC XX.
  2012     12  CO-STMT-TYPE                          PIC XXX.
  2013     12  CO-COMP-TYPE                          PIC X.
  2014         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2015     12  CO-STMT-OWNER                         PIC X(4).
  2016     12  CO-BALANCE-CONTROL                    PIC X.
  2017         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2018         88  CO-NO-BALANCE                        VALUE 'N'.
  2019
  2020     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2021         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2022         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2023         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2024
  2025     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2026         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2027         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2028
  2029     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2030     12  CO-GA-DIRECT-DEP                      PIC X.
  2031     12  CO-FUTURE-SPACE                       PIC X.
  2032         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2033
  2034     12  CO-ACCT-NAME                          PIC X(30).
  2035     12  CO-MAIL-NAME                          PIC X(30).
  2036     12  CO-ADDR-1                             PIC X(30).
  2037     12  CO-ADDR-2                             PIC X(30).
  2038     12  CO-ADDR-3.
  2039         16  CO-ADDR-CITY                      PIC X(27).
  2040         16  CO-ADDR-STATE                     PIC XX.
  2041     12  CO-CSO-1099                           PIC X.
  2042     12  CO-ZIP.
  2043         16  CO-ZIP-PRIME.
  2044             20  CO-ZIP-PRI-1ST                PIC X.
  2045                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2046             20  FILLER                        PIC X(4).
  2047         16  CO-ZIP-PLUS4                      PIC X(4).
  2048     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2049         16  CO-CAN-POSTAL-1                   PIC XXX.
  2050         16  CO-CAN-POSTAL-2                   PIC XXX.
  2051         16  FILLER                            PIC XXX.
  2052     12  CO-SOC-SEC                            PIC X(13).
  2053     12  CO-TELEPHONE.
  2054         16  CO-AREA-CODE                      PIC XXX.
  2055         16  CO-PREFIX                         PIC XXX.
  2056         16  CO-PHONE                          PIC X(4).
  2057
  2058     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  43
* EL652.cbl
  2059
  2060     12  CO-AR-BAL-LEVEL                       PIC X.
  2061         88  CO-AR-REF-LVL                        VALUE '1'.
  2062         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2063         88  CO-AR-BILL-LVL                       VALUE '2'.
  2064         88  CO-AR-AGT-LVL                        VALUE '3'.
  2065         88  CO-AR-FR-LVL                         VALUE '4'.
  2066
  2067     12  CO-AR-NORMAL-PRINT                    PIC X.
  2068         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2069         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2070
  2071     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2072
  2073     12  CO-AR-REPORTING                       PIC X.
  2074         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2075         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2076
  2077     12  CO-AR-PULL-CHECK                      PIC X.
  2078         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2079         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2080
  2081     12  CO-AR-BALANCE-PRINT                   PIC X.
  2082         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2083
  2084     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2085         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2086         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2087         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2088
  2089     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2090
  2091     12  CO-USER-CODE                          PIC X.
  2092     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2093
  2094******************************************************************
  2095*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2096*    THE LAST MONTH END RUN.
  2097******************************************************************
  2098
  2099     12  CO-LAST-ACTIVITY-DATE.
  2100         16  CO-ACT-YEAR                       PIC 99.
  2101         16  CO-ACT-MONTH                      PIC 99.
  2102         16  CO-ACT-DAY                        PIC 99.
  2103
  2104     12  CO-LAST-STMT-DT.
  2105         16  CO-LAST-STMT-YEAR                 PIC 99.
  2106         16  CO-LAST-STMT-MONTH                PIC 99.
  2107         16  CO-LAST-STMT-DAY                  PIC 99.
  2108
  2109     12  CO-MO-END-TOTALS.
  2110         16  CO-MONTHLY-TOTALS.
  2111             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2112             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2113             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2114             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2115             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  2116
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  44
* EL652.cbl
  2117         16  CO-AGING-TOTALS.
  2118             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2119             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2120             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2121             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2122
  2123         16  CO-YTD-TOTALS.
  2124             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2125             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2126
  2127         16  CO-OVER-UNDER-TOTALS.
  2128             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2129             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2130
  2131     12  CO-MISCELLANEOUS-TOTALS.
  2132         16  CO-FICA-TOTALS.
  2133             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2134             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2135
  2136         16  CO-CLAIM-TOTALS.
  2137             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2138             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2139
  2140******************************************************************
  2141*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2142*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2143******************************************************************
  2144
  2145     12  CO-CURRENT-TOTALS.
  2146         16  CO-CURRENT-LAST-STMT-DT.
  2147             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2148             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2149             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2150
  2151         16  CO-CURRENT-MONTHLY-TOTALS.
  2152             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2153             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2154             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2155             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2156             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2157
  2158         16  CO-CURRENT-AGING-TOTALS.
  2159             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2160             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2161             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2162             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2163
  2164         16  CO-CURRENT-YTD-TOTALS.
  2165             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2166             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2167
  2168     12  CO-PAID-COMM-TOTALS.
  2169         16  CO-YTD-PAID-COMMS.
  2170             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2171             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2172
  2173     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  2174         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  45
* EL652.cbl
  2175         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2176
  2177     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2178         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2179         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2180         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2181         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2182         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2183         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2184         88  CO-FINAL-LETTER                  VALUE 'F'.
  2185         88  CO-RECONCILING                   VALUE 'R'.
  2186         88  CO-PHONE-CALL                    VALUE 'P'.
  2187         88  CO-LEGAL                         VALUE 'L'.
  2188         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2189         88  CO-WRITE-OFF                     VALUE 'W'.
  2190         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2191
  2192     12  CO-CSR-CODE                       PIC X(4).
  2193
  2194     12  CO-GA-STATUS-INFO.
  2195         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2196         16  CO-GA-TERMINATION-DT          PIC XX.
  2197         16  CO-GA-STATUS-CODE             PIC X.
  2198             88  CO-GA-ACTIVE                 VALUE 'A'.
  2199             88  CO-GA-INACTIVE               VALUE 'I'.
  2200             88  CO-GA-PENDING                VALUE 'P'.
  2201         16  CO-GA-COMMENTS.
  2202             20  CO-GA-COMMENT-1           PIC X(40).
  2203             20  CO-GA-COMMENT-2           PIC X(40).
  2204             20  CO-GA-COMMENT-3           PIC X(40).
  2205             20  CO-GA-COMMENT-4           PIC X(40).
  2206
  2207     12  CO-RPTCD2                         PIC X(10).
  2208
  2209     12  CO-TYPE-AGENT                     PIC X(01).
  2210         88  CO-CORPORATION                   VALUE 'C'.
  2211         88  CO-PARTNERSHIP                   VALUE 'P'.
  2212         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2213         88  CO-TRUST                         VALUE 'T'.
  2214         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2215
  2216     12  CO-FAXNO.
  2217         16  CO-FAX-AREA-CODE                  PIC XXX.
  2218         16  CO-FAX-PREFIX                     PIC XXX.
  2219         16  CO-FAX-PHONE                      PIC X(4).
  2220
  2221     12  CO-BANK-INFORMATION.
  2222         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2223         16  CO-BANK-TRANSIT-NON REDEFINES
  2224             CO-BANK-TRANSIT-NO                PIC 9(8).
  2225
  2226         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2227     12  CO-MISC-DEDUCT-INFO REDEFINES
  2228                  CO-BANK-INFORMATION.
  2229         16  CO-MD-GL-ACCT                     PIC X(10).
  2230         16  CO-MD-DIV                         PIC XX.
  2231         16  CO-MD-CENTER                      PIC X(4).
  2232         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  46
* EL652.cbl
  2233         16  CO-CREATE-AP-CHECK                PIC X.
  2234         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2235         16  FILLER                            PIC XXX.
  2236     12  CO-ACH-STATUS                         PIC X.
  2237         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2238         88  CO-ACH-PENDING                        VALUE 'P'.
  2239
  2240     12  CO-BILL-SW                            PIC X.
  2241     12  CO-CONTROL-NAME                       PIC X(30).
  2242     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2243     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2244     12  CO-CLP-STATE                          PIC XX.
  2245     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2246     12  CO-SPP-REFUND-EDIT                    PIC X.
  2247
  2248******************************************************************
  2249*                            COPY ERCAGTC.
  2250******************************************************************
  2251*                                                                *
  2252*                                                                *
  2253*                            ERCAGTC                             *
  2254*                            VMOD=2.001                          *
  2255*                                                                *
  2256*   ONLINE CREDIT SYSTEM                                         *
  2257*                                                                *
  2258*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2259*                                                                *
  2260*   FILE TYPE = VSAM,KSDS                                        *
  2261*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2262*                                                                *
  2263*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2264*       ALTERNATE PATH = NONE                                    *
  2265*                                                                *
  2266*   LOG = NO                                                     *
  2267*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2268*                                                                *
  2269******************************************************************
  2270*                   C H A N G E   L O G
  2271*
  2272* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2273*-----------------------------------------------------------------
  2274*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2275* EFFECTIVE    NUMBER
  2276*-----------------------------------------------------------------
  2277* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2278* 111004                         NEW FILE AND COPYBOOK
  2279* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2280******************************************************************
  2281 01  AGENT-COMMISSIONS.
  2282     12  AG-RECORD-ID                          PIC XX.
  2283         88  VALID-CO-ID                          VALUE 'AG'.
  2284     12  AG-CONTROL-PRIMARY.
  2285         16  AG-COMPANY-CD                     PIC X.
  2286         16  AG-CONTROL.
  2287             20  AG-CTL-1.
  2288                 24  AG-CARR-GROUP.
  2289                     28  AG-CARRIER            PIC X.
  2290                     28  AG-GROUPING           PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  47
* EL652.cbl
  2291                 24  AG-BANK                   PIC X(10).
  2292             20  AG-CTL-2.
  2293                 24  AG-EXP-DT                 PIC XX.
  2294         16  AG-TYPE                           PIC X.
  2295             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2296             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2297     12  AG-MAINT-INFORMATION.
  2298         16  AG-LAST-MAINT-DT                  PIC XX.
  2299         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2300         16  AG-LAST-MAINT-USER                PIC X(4).
  2301         16  FILLER                            PIC X(10).
  2302     12  AG-EFF-DT                             PIC XX.
  2303     12  AG-COMM-STRUCTURE.
  2304         16  AG-AGT-COMMS OCCURS 10.
  2305             20  AG-AGT                PIC X(10).
  2306             20  AG-COM-TYP            PIC X.
  2307             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2308             20  AG-RECALC-LV-INDIC    PIC X.
  2309             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2310             20  AG-LRCALC-LV-INDIC    PIC X.
  2311             20  FILLER                PIC X(05).
  2312     12  FILLER                  PIC X(145).
  2313******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  48
* EL652.cbl
  2315*                            COPY ERCNAME.
  2316******************************************************************
  2317*                                                                *
  2318*                                                                *
  2319*                            ERCNAME                             *
  2320*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2321*                            VMOD=2.003                          *
  2322*                                                                *
  2323*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  2324*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  2325*                                                                *
  2326*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  2327*                                                                *
  2328*   FILE TYPE = VSAM,KSDS                                        *
  2329*   RECORD SIZE = 160   RECFORM = FIX                            *
  2330*                                                                *
  2331*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  2332*                                                                *
  2333*   LOG = NO                                                     *
  2334*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2335*                                                                *
  2336*                                                                *
  2337******************************************************************
  2338
  2339 01  NAME-LOOKUP-MASTER.
  2340     12  NL-RECORD-ID                PIC  X(02).
  2341         88  VALID-NL-ID                         VALUE 'NL'.
  2342
  2343     12  NL-RECORD-KEY.
  2344         16  NL-CONTROL-PRIMARY.
  2345             20  NL-COMPANY-CD       PIC  X(01).
  2346             20  NL-NAME             PIC  X(30).
  2347             20  NL-RECORD-TYPE      PIC  X(01).
  2348                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  2349                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  2350                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  2351
  2352         16  NL-ACCOUNT-MASTER.
  2353             20  NL-AM-COMPANY-CD    PIC  X(01).
  2354             20  NL-AM-CARRIER       PIC  X(01).
  2355             20  NL-AM-GROUPING      PIC  X(06).
  2356             20  NL-AM-STATE         PIC  X(02).
  2357             20  NL-AM-ACCOUNT       PIC  X(10).
  2358             20  FILLER              PIC  X(09).
  2359
  2360         16  NL-COMPENSATION-MASTER
  2361                                 REDEFINES  NL-ACCOUNT-MASTER.
  2362             20  NL-CO-COMPANY-CD    PIC  X(01).
  2363             20  NL-CO-CARRIER       PIC  X(01).
  2364             20  NL-CO-GROUPING      PIC  X(06).
  2365             20  NL-CO-RESP-NO       PIC  X(10).
  2366             20  NL-CO-ACCOUNT       PIC  X(10).
  2367             20  NL-CO-TYPE          PIC  X(01).
  2368
  2369         16  NL-REINSURANCE-RECORD
  2370                                 REDEFINES  NL-ACCOUNT-MASTER.
  2371             20  NL-RE-COMPANY-CD    PIC  X(01).
  2372             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  49
* EL652.cbl
  2373             20  NL-RE-COMPANY.
  2374                 24  NL-RE-COMP      PIC  X(03).
  2375                 24  NL-RE-CO-SUB    PIC  X(03).
  2376             20  NL-RE-TABLE         PIC  X(03).
  2377             20  FILLER              PIC  X(18).
  2378
  2379     12  NL-MAINT-INFORMATION.
  2380         16  NL-LAST-MAINT-DT        PIC  X(02).
  2381         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  2382         16  NL-LAST-MAINT-USER      PIC  X(04).
  2383         16  FILLER                  PIC  X(10).
  2384
  2385     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  2386         16  NL-RE-LEVEL             PIC  9(02).
  2387
  2388     12  NL-CITY                     PIC  X(15).
  2389     12  NL-ST                       PIC  XX.
  2390
  2391******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  50
* EL652.cbl
  2393*                            COPY ELCCNTL.
  2394******************************************************************
  2395*                                                                *
  2396*                                                                *
  2397*                            ELCCNTL.                            *
  2398*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2399*                            VMOD=2.059                          *
  2400*                                                                *
  2401*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2402*                                                                *
  2403*   FILE TYPE = VSAM,KSDS                                        *
  2404*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2405*                                                                *
  2406*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2407*       ALTERNATE INDEX = NONE                                   *
  2408*                                                                *
  2409*   LOG = YES                                                    *
  2410*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2411******************************************************************
  2412*                   C H A N G E   L O G
  2413*
  2414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2415*-----------------------------------------------------------------
  2416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2417* EFFECTIVE    NUMBER
  2418*-----------------------------------------------------------------
  2419* 082503                   PEMA  ADD BENEFIT GROUP
  2420* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2421* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2422* 092705    2005050300006  PEMA  ADD SPP LEASES
  2423* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2424* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2425* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2426* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2427* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2428******************************************************************
  2429*
  2430 01  CONTROL-FILE.
  2431     12  CF-RECORD-ID                       PIC XX.
  2432         88  VALID-CF-ID                        VALUE 'CF'.
  2433
  2434     12  CF-CONTROL-PRIMARY.
  2435         16  CF-COMPANY-ID                  PIC XXX.
  2436         16  CF-RECORD-TYPE                 PIC X.
  2437             88  CF-COMPANY-MASTER              VALUE '1'.
  2438             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2439             88  CF-STATE-MASTER                VALUE '3'.
  2440             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2441             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2442             88  CF-CARRIER-MASTER              VALUE '6'.
  2443             88  CF-MORTALITY-MASTER            VALUE '7'.
  2444             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2445             88  CF-TERMINAL-MASTER             VALUE '9'.
  2446             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2447             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2448             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2449             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2450             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  51
* EL652.cbl
  2451             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2452             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2453             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2454             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2455         16  CF-ACCESS-CD-GENL              PIC X(4).
  2456         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2457             20  CF-PROCESSOR               PIC X(4).
  2458         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2459             20  CF-STATE-CODE              PIC XX.
  2460             20  FILLER                     PIC XX.
  2461         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2462             20  FILLER                     PIC XX.
  2463             20  CF-HI-BEN-IN-REC           PIC XX.
  2464         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2465             20  FILLER                     PIC XXX.
  2466             20  CF-CARRIER-CNTL            PIC X.
  2467         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2468             20  FILLER                     PIC XX.
  2469             20  CF-HI-TYPE-IN-REC          PIC 99.
  2470         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2471             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2472                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2473             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2474             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2475         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2476             20  FILLER                     PIC X.
  2477             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2478         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2479             20  FILLER                     PIC XX.
  2480             20  CF-MORTGAGE-PLAN           PIC XX.
  2481         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2482
  2483     12  CF-LAST-MAINT-DT                   PIC XX.
  2484     12  CF-LAST-MAINT-BY                   PIC X(4).
  2485     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2486
  2487     12  CF-RECORD-BODY                     PIC X(728).
  2488
  2489
  2490****************************************************************
  2491*             COMPANY MASTER RECORD                            *
  2492****************************************************************
  2493
  2494     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2495         16  CF-COMPANY-ADDRESS.
  2496             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2497             20  CF-CL-IN-CARE-OF           PIC X(30).
  2498             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2499             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2500             20  CF-CL-CITY-STATE           PIC X(30).
  2501             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2502             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2503         16  CF-COMPANY-CD                  PIC X.
  2504         16  CF-COMPANY-PASSWORD            PIC X(8).
  2505         16  CF-SECURITY-OPTION             PIC X.
  2506             88  ALL-SECURITY                   VALUE '1'.
  2507             88  COMPANY-VERIFY                 VALUE '2'.
  2508             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  52
* EL652.cbl
  2509             88  NO-SECURITY                    VALUE '4'.
  2510             88  ALL-BUT-TERM                   VALUE '5'.
  2511         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2512             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2513         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2514             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2515         16  CF-INFORCE-LOCATION            PIC X.
  2516             88  CERTS-ARE-ONLINE               VALUE '1'.
  2517             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2518             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2519         16  CF-LOWER-CASE-LETTERS          PIC X.
  2520         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2521             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2522             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2523             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2524             88  CF-ACCNT-CNTL                  VALUE '3'.
  2525             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2526
  2527         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2528         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2529
  2530         16  CF-LGX-CREDIT-USER             PIC X.
  2531             88  CO-IS-NOT-USER                 VALUE 'N'.
  2532             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2533
  2534         16 CF-CREDIT-CALC-CODES.
  2535             20  CF-CR-REM-TERM-CALC PIC X.
  2536               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2537               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2538               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2539               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2540               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2541               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2542               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2543             20  CF-CR-R78-METHOD           PIC X.
  2544               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2545               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2546
  2547         16  CF-CLAIM-CONTROL-COUNTS.
  2548             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2549                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2550
  2551             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2552                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2553
  2554             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2555                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2556
  2557             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2558                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2559
  2560         16  CF-CURRENT-MONTH-END           PIC XX.
  2561
  2562         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2563             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2564             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2565             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2566             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  53
* EL652.cbl
  2567                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2568                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2569             20  CF-CO-PREM-REJECT-SW       PIC X.
  2570                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2571                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2572             20  CF-CO-REF-REJECT-SW        PIC X.
  2573                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2574                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2575
  2576         16  CF-CO-REPORTING-DT             PIC XX.
  2577         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2578         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2579           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2580           88  CF-CO-MONTH-END                  VALUE '1'.
  2581
  2582         16  CF-LGX-CLAIM-USER              PIC X.
  2583             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2584             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2585
  2586         16  CF-CREDIT-EDIT-CONTROLS.
  2587             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2588             20  CF-MIN-AGE                 PIC 99.
  2589             20  CF-DEFAULT-AGE             PIC 99.
  2590             20  CF-MIN-TERM                PIC S999      COMP-3.
  2591             20  CF-MAX-TERM                PIC S999      COMP-3.
  2592             20  CF-DEFAULT-SEX             PIC X.
  2593             20  CF-JOINT-AGE-INPUT         PIC X.
  2594                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2595             20  CF-BIRTH-DATE-INPUT        PIC X.
  2596                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2597             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2598                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2599                 88  CF-ZERO-CARRIER            VALUE '1'.
  2600                 88  CF-ZERO-GROUPING           VALUE '2'.
  2601                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2602             20  CF-EDIT-SW                 PIC X.
  2603                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2604             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2605             20  CF-CR-PR-METHOD            PIC X.
  2606               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2607               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2608             20  FILLER                     PIC X.
  2609
  2610         16  CF-CREDIT-MISC-CONTROLS.
  2611             20  CF-REIN-TABLE-SW           PIC X.
  2612                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2613             20  CF-COMP-TABLE-SW           PIC X.
  2614                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2615             20  CF-EXPERIENCE-RETENTION-AGE
  2616                                            PIC S9        COMP-3.
  2617             20  CF-CONVERSION-DT           PIC XX.
  2618             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2619             20  CF-RUN-FREQUENCY-SW        PIC X.
  2620                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2621                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2622
  2623             20  CF-CR-CHECK-NO-CONTROL.
  2624                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  54
* EL652.cbl
  2625                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2626                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2627                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2628                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2629                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2630
  2631                 24  CF-CR-CHECK-COUNT       REDEFINES
  2632                     CF-CR-CHECK-COUNTER      PIC X(4).
  2633
  2634                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2635                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2636
  2637                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2638                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2639                 24  CF-MAIL-PROCESSING       PIC X.
  2640                     88  MAIL-PROCESSING          VALUE 'Y'.
  2641
  2642         16  CF-MISC-SYSTEM-CONTROL.
  2643             20  CF-SYSTEM-C                 PIC X.
  2644                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2645             20  CF-SYSTEM-D                 PIC X.
  2646                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2647             20  CF-SOC-SEC-NO-SW            PIC X.
  2648                 88  SOC-SEC-NO-USED             VALUE '1'.
  2649             20  CF-MEMBER-NO-SW             PIC X.
  2650                 88  MEMBER-NO-USED              VALUE '1'.
  2651             20  CF-TAX-ID-NUMBER            PIC X(11).
  2652             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2653             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2654                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2655                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2656                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2657                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2658             20  CF-SYSTEM-E                 PIC X.
  2659                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2660
  2661         16  CF-LGX-LIFE-USER               PIC X.
  2662             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2663             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2664
  2665         16  CF-CR-MONTH-END-DT             PIC XX.
  2666
  2667         16  CF-FILE-MAINT-DATES.
  2668             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2669                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2670             20  CF-LAST-BATCH       REDEFINES
  2671                 CF-LAST-BATCH-NO               PIC X(4).
  2672             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2673             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2674             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2675             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2676             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2677             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2678             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2679             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2680             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2681             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2682
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  55
* EL652.cbl
  2683         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2684         16  FILLER                         PIC X.
  2685
  2686         16  CF-ALT-MORT-CODE               PIC X(4).
  2687         16  CF-MEMBER-CAPTION              PIC X(10).
  2688
  2689         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2690             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2691             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2692             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2693             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2694             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2695
  2696         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2697
  2698         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2699         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2700         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2701         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2702
  2703         16  CF-AH-OVERRIDE-L1              PIC X.
  2704         16  CF-AH-OVERRIDE-L2              PIC XX.
  2705         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2706         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2707
  2708         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2709         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2710
  2711         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2712         16  CF-AR-LAST-EL860-DT            PIC XX.
  2713         16  CF-MP-MONTH-END-DT             PIC XX.
  2714
  2715         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2716         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2717             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2718
  2719         16  CF-AR-MONTH-END-DT             PIC XX.
  2720
  2721         16  CF-CRDTCRD-USER                PIC X.
  2722             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2723             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2724
  2725         16  CF-CC-MONTH-END-DT             PIC XX.
  2726
  2727         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2728
  2729         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2730             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2731             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2732             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2733         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2734         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2735         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2736         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2737             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2738             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2739         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2740         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  56
* EL652.cbl
  2741         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2742             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2743         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2744
  2745         16  CF-CL-ZIP-CODE.
  2746             20  CF-CL-ZIP-PRIME.
  2747                 24  CF-CL-ZIP-1ST          PIC X.
  2748                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2749                 24  FILLER                 PIC X(4).
  2750             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2751         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2752             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2753             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2754             20  FILLER                     PIC XXX.
  2755
  2756         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2757         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2758         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2759         16  CF-CO-OPTION-START-DATE        PIC XX.
  2760         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2761           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2762                                                      '3' '4'.
  2763           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2764           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2765           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2766           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2767           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2768           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2769
  2770         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2771
  2772         16  CF-PAYMENT-APPROVAL-LEVELS.
  2773             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2774             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2775             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2776             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2777             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2778             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2779
  2780         16  CF-END-USER-REPORTING-USER     PIC X.
  2781             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2782             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2783
  2784         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2785             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2786             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2787
  2788         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2789
  2790         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2791         16  FILLER                         PIC X.
  2792
  2793         16  CF-CREDIT-ARCHIVE-CNTL.
  2794             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2795             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2796             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2797
  2798         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  57
* EL652.cbl
  2799
  2800         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2801             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2802             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2803
  2804         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2805             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2806             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2807
  2808         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2809
  2810         16  CF-CO-ACH-ID-CODE              PIC  X.
  2811             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2812             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2813             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2814         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2815         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2816         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2817         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2818         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2819         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2820         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2821         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2822         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2823                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2824         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2825                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2826
  2827         16  CF-CO-OVER-SHORT.
  2828             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2829             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2830
  2831*         16  FILLER                         PIC X(102).
  2832         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2833             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2834             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2835
  2836         16  CF-AH-APPROVAL-DAYS.
  2837             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2838             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2839             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2840             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2841
  2842         16  FILLER                         PIC X(82).
  2843****************************************************************
  2844*             PROCESSOR/USER RECORD                            *
  2845****************************************************************
  2846
  2847     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2848         16  CF-PROCESSOR-NAME              PIC X(30).
  2849         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2850         16  CF-PROCESSOR-TITLE             PIC X(26).
  2851         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2852                 88  MESSAGE-YES                VALUE 'Y'.
  2853                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2854
  2855*****************************************************
  2856****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  58
* EL652.cbl
  2857****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2858****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2859****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2860*****************************************************
  2861
  2862         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2863             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2864             20  CF-APPLICATION-FORCE       PIC X.
  2865             20  CF-INDIVIDUAL-APP.
  2866                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2867                     28  CF-BROWSE-APP      PIC X.
  2868                     28  CF-UPDATE-APP      PIC X.
  2869
  2870         16  CF-CURRENT-TERM-ON             PIC X(4).
  2871         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2872             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2873             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2874             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2875             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2876             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2877             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2878             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2879         16  CF-PROCESSOR-CARRIER           PIC X.
  2880             88  NO-CARRIER-SECURITY            VALUE ' '.
  2881         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2882             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2883         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2884             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2885         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2886             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2887
  2888         16  CF-PROC-SYS-ACCESS-SW.
  2889             20  CF-PROC-CREDIT-CLAIMS-SW.
  2890                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2891                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2892                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2893                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2894             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2895                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2896                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2897             20  CF-PROC-LIFE-GNRLDGR-SW.
  2898                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2899                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2900                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2901                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2902             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2903                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2904                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2905         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2906             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2907             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2908         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2909
  2910         16  CF-APPROVAL-LEVEL                  PIC X.
  2911             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2912             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2913             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2914             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  59
* EL652.cbl
  2915
  2916         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2917
  2918         16  CF-LANGUAGE-TYPE                   PIC X.
  2919             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2920             88  CF-LANG-IS-FR                      VALUE 'F'.
  2921         16  FILLER                             PIC  X(240).
  2922
  2923****************************************************************
  2924*             PROCESSOR/REMINDERS RECORD                       *
  2925****************************************************************
  2926
  2927     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2928         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2929             20  CF-START-REMIND-DT         PIC XX.
  2930             20  CF-END-REMIND-DT           PIC XX.
  2931             20  CF-REMINDER-TEXT           PIC X(50).
  2932         16  FILLER                         PIC X(296).
  2933
  2934
  2935****************************************************************
  2936*             STATE MASTER RECORD                              *
  2937****************************************************************
  2938
  2939     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2940         16  CF-STATE-ABBREVIATION          PIC XX.
  2941         16  CF-STATE-NAME                  PIC X(25).
  2942         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2943         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2944             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2945             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2946             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2947             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2948                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2949                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2950             20  CF-ST-PREM-REJECT-SW       PIC X.
  2951                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2952                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2953             20  CF-ST-REF-REJECT-SW        PIC X.
  2954                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2955                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2956         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2957         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2958         16  CF-ST-REFUND-RULES.
  2959             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2960             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2961             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2962         16  CF-ST-FST-PMT-EXTENSION.
  2963             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2964             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2965                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2966                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2967                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2968                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2969         16  CF-ST-STATE-CALL.
  2970             20  CF-ST-CALL-UNEARNED        PIC X.
  2971             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2972             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  60
* EL652.cbl
  2973         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2974             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2975             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2976         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2977         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2978         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2979         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2980         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2981         16  FILLER                         PIC X.
  2982         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2983             20  CF-ST-BENEFIT-CD           PIC XX.
  2984             20  CF-ST-BENEFIT-KIND         PIC X.
  2985                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2986                 88  CF-ST-AH-KIND              VALUE 'A'.
  2987             20  CF-ST-REM-TERM-CALC        PIC X.
  2988                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2989                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2990                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2991                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2992                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2993                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2994                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2995                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2996
  2997             20  CF-ST-REFUND-CALC          PIC X.
  2998                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2999                 88  ST-REFD-BY-R78             VALUE '1'.
  3000                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3001                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3002                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3003                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3004                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3005                 88  ST-REFD-UTAH               VALUE '7'.
  3006                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3007                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3008                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3009
  3010             20  CF-ST-EARNING-CALC         PIC X.
  3011                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3012                 88  ST-EARN-BY-R78             VALUE '1'.
  3013                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3014                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3015                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3016                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3017                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3018                 88  ST-EARN-MEAN               VALUE '8'.
  3019                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3020
  3021             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3022                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3023                 88  ST-OVRD-BY-R78             VALUE '1'.
  3024                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3025                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3026                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3027                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3028                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3029                 88  ST-OVRD-MEAN               VALUE '8'.
  3030                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  61
* EL652.cbl
  3031             20  FILLER                     PIC X.
  3032
  3033         16  CF-ST-COMMISSION-CAPS.
  3034             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3035             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3036             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3037             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3038         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3039                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3040
  3041         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3042
  3043         16  CF-ST-STATUTORY-INTEREST.
  3044             20  CF-ST-STAT-DATE-FROM       PIC X.
  3045                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3046                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3047             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3048             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3049             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3050             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3051             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3052
  3053         16  CF-ST-OVER-SHORT.
  3054             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3055             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3056
  3057         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3058
  3059         16  CF-ST-RT-CALC                  PIC X.
  3060
  3061         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3062         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3063         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3064         16  CF-ST-RF-LR-CALC               PIC X.
  3065         16  CF-ST-RF-LL-CALC               PIC X.
  3066         16  CF-ST-RF-LN-CALC               PIC X.
  3067         16  CF-ST-RF-AH-CALC               PIC X.
  3068         16  CF-ST-RF-CP-CALC               PIC X.
  3069*        16  FILLER                         PIC X(206).
  3070*CIDMOD         16  FILLER                         PIC X(192).
  3071         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3072             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3073         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3074         16  CF-ST-VFY-2ND-BENE             PIC X.
  3075         16  FILLER                         PIC X(186).
  3076
  3077****************************************************************
  3078*             BENEFIT MASTER RECORD                            *
  3079****************************************************************
  3080
  3081     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3082         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3083             20  CF-BENEFIT-CODE            PIC XX.
  3084             20  CF-BENEFIT-NUMERIC  REDEFINES
  3085                 CF-BENEFIT-CODE            PIC XX.
  3086             20  CF-BENEFIT-ALPHA           PIC XXX.
  3087             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3088             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  62
* EL652.cbl
  3089
  3090             20  CF-LF-COVERAGE-TYPE        PIC X.
  3091                 88  CF-REDUCING                VALUE 'R'.
  3092                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3093
  3094             20  CF-SPECIAL-CALC-CD         PIC X.
  3095                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3096                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3097                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3098                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3099                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3100                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3101                 88  CF-FARM-PLAN               VALUE 'F'.
  3102                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3103                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3104                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3105                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3106                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3107                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3108                 88  CF-PRUDENTIAL              VALUE 'P'.
  3109                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3110                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3111                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3112                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3113                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3114                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3115
  3116             20  CF-JOINT-INDICATOR         PIC X.
  3117                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3118
  3119*            20  FILLER                     PIC X(12).
  3120             20  FILLER                     PIC X(11).
  3121             20  CF-BENEFIT-CATEGORY        PIC X.
  3122             20  CF-LOAN-TYPE               PIC X(8).
  3123
  3124             20  CF-CO-REM-TERM-CALC        PIC X.
  3125                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3126                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3127                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3128                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3129                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3130
  3131             20  CF-CO-EARNINGS-CALC        PIC X.
  3132                 88  CO-EARN-BY-R78             VALUE '1'.
  3133                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3134                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3135                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3136                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3137                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3138                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3139                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3140
  3141             20  CF-CO-REFUND-CALC          PIC X.
  3142                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3143                 88  CO-REFD-BY-R78             VALUE '1'.
  3144                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3145                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3146                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  63
* EL652.cbl
  3147                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3148                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3149                 88  CO-REFD-MEAN               VALUE '8'.
  3150                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3151                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3152                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3153
  3154             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3155                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3156                 88  CO-OVRD-BY-R78             VALUE '1'.
  3157                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3158                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3159                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3160                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3161                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3162                 88  CO-OVRD-MEAN               VALUE '8'.
  3163                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3164
  3165             20  CF-CO-BEN-I-G-CD           PIC X.
  3166                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3167                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3168                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3169
  3170         16  FILLER                         PIC X(304).
  3171
  3172
  3173****************************************************************
  3174*             CARRIER MASTER RECORD                            *
  3175****************************************************************
  3176
  3177     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3178         16  CF-ADDRESS-DATA.
  3179             20  CF-MAIL-TO-NAME            PIC X(30).
  3180             20  CF-IN-CARE-OF              PIC X(30).
  3181             20  CF-ADDRESS-LINE-1          PIC X(30).
  3182             20  CF-ADDRESS-LINE-2          PIC X(30).
  3183             20  CF-CITY-STATE              PIC X(30).
  3184             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3185             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3186
  3187         16  CF-CLAIM-NO-CONTROL.
  3188             20  CF-CLAIM-NO-METHOD         PIC X.
  3189                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3190                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3191                 88  CLAIM-NO-SEQ               VALUE '3'.
  3192                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3193             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3194                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3195                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3196                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3197
  3198         16  CF-CHECK-NO-CONTROL.
  3199             20  CF-CHECK-NO-METHOD         PIC X.
  3200                 88  CHECK-NO-MANUAL            VALUE '1'.
  3201                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3202                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3203                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3204             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  64
* EL652.cbl
  3205                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3206
  3207         16  CF-DOMICILE-STATE              PIC XX.
  3208
  3209         16  CF-EXPENSE-CONTROLS.
  3210             20  CF-EXPENSE-METHOD          PIC X.
  3211                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3212                 88  DOLLARS-PER-PMT            VALUE '2'.
  3213                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3214                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3215             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3216             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3217
  3218         16  CF-CORRESPONDENCE-CONTROL.
  3219             20  CF-LETTER-RESEND-OPT       PIC X.
  3220                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3221                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3222             20  FILLER                     PIC X(4).
  3223
  3224         16  CF-RESERVE-CONTROLS.
  3225             20  CF-MANUAL-SW               PIC X.
  3226                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3227             20  CF-FUTURE-SW               PIC X.
  3228                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3229             20  CF-PTC-SW                  PIC X.
  3230                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3231             20  CF-IBNR-SW                 PIC X.
  3232                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3233             20  CF-PTC-LF-SW               PIC X.
  3234                 88  CF-LF-PTC-USED             VALUE '1'.
  3235             20  CF-CDT-ACCESS-METHOD       PIC X.
  3236                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3237                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3238                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3239             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3240
  3241         16  CF-CLAIM-CALC-METHOD           PIC X.
  3242             88  360-PLUS-MONTHS                VALUE '1'.
  3243             88  365-PLUS-MONTHS                VALUE '2'.
  3244             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3245             88  360-DAILY                      VALUE '4'.
  3246             88  365-DAILY                      VALUE '5'.
  3247
  3248         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3249         16  FILLER                         PIC X(11).
  3250
  3251         16  CF-LIMIT-AMOUNTS.
  3252             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3253             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3254             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3255             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3256             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3257             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3258             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3259             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3260             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3261             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3262
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  65
* EL652.cbl
  3263         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3264         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3265         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3266
  3267         16  CF-ZIP-CODE.
  3268             20  CF-ZIP-PRIME.
  3269                 24  CF-ZIP-1ST             PIC X.
  3270                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3271                 24  FILLER                 PIC X(4).
  3272             20  CF-ZIP-PLUS4               PIC X(4).
  3273         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3274             20  CF-CAN-POSTAL-1            PIC XXX.
  3275             20  CF-CAN-POSTAL-2            PIC XXX.
  3276             20  FILLER                     PIC XXX.
  3277
  3278         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3279         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3280         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3281
  3282         16  CF-RATING-SWITCH               PIC X.
  3283             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3284             88  CF-NO-RATING                   VALUE 'N'.
  3285
  3286         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3287
  3288         16  CF-CARRIER-OVER-SHORT.
  3289             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3290             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3291
  3292         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3293         16  CF-SECPAY-SWITCH               PIC X.
  3294             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3295             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3296         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3297         16  FILLER                         PIC X(448).
  3298*        16  FILLER                         PIC X(452).
  3299
  3300
  3301****************************************************************
  3302*             MORTALITY MASTER RECORD                          *
  3303****************************************************************
  3304
  3305     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3306         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3307                                INDEXED BY CF-MORT-NDX.
  3308             20  CF-MORT-TABLE              PIC X(5).
  3309             20  CF-MORT-TABLE-TYPE         PIC X.
  3310                 88  CF-MORT-JOINT              VALUE 'J'.
  3311                 88  CF-MORT-SINGLE             VALUE 'S'.
  3312                 88  CF-MORT-COMBINED           VALUE 'C'.
  3313                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3314                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3315             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3316             20  CF-MORT-AGE-METHOD         PIC XX.
  3317                 88  CF-AGE-LAST                VALUE 'AL'.
  3318                 88  CF-AGE-NEAR                VALUE 'AN'.
  3319             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3320             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  66
* EL652.cbl
  3321                                            PIC X.
  3322                 88  CF-MINUS                   VALUE '-'.
  3323                 88  CF-PLUS                    VALUE '+'.
  3324             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3325             20  CF-MORT-JOINT-CODE         PIC X.
  3326                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3327             20  CF-MORT-PC-Q               PIC X.
  3328                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3329             20  CF-MORT-TABLE-CODE         PIC X(4).
  3330             20  CF-MORT-COMMENTS           PIC X(15).
  3331             20  FILLER                     PIC X(14).
  3332
  3333         16  FILLER                         PIC X(251).
  3334
  3335
  3336****************************************************************
  3337*             BUSSINESS TYPE MASTER RECORD                     *
  3338****************************************************************
  3339
  3340     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3341* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3342* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3343* AND RECORD 05 IS TYPES 81-99
  3344         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3345             20  CF-BUSINESS-TITLE          PIC  X(19).
  3346             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3347                                            PIC S9V9(4) COMP-3.
  3348             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3349             20  FILLER                     PIC  X.
  3350         16  FILLER                         PIC  X(248).
  3351
  3352
  3353****************************************************************
  3354*             TERMINAL MASTER RECORD                           *
  3355****************************************************************
  3356
  3357     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3358
  3359         16  CF-COMPANY-TERMINALS.
  3360             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3361                                  PIC X(4).
  3362         16  FILLER               PIC X(248).
  3363
  3364
  3365****************************************************************
  3366*             LIFE EDIT MASTER RECORD                          *
  3367****************************************************************
  3368
  3369     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3370         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3371             20  CF-LIFE-CODE-IN            PIC XX.
  3372             20  CF-LIFE-CODE-OUT           PIC XX.
  3373         16  FILLER                         PIC X(248).
  3374
  3375
  3376****************************************************************
  3377*             AH EDIT MASTER RECORD                            *
  3378****************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  67
* EL652.cbl
  3379
  3380     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3381         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3382             20  CF-AH-CODE-IN              PIC XXX.
  3383             20  CF-AH-CODE-OUT             PIC XX.
  3384         16  FILLER                         PIC X(248).
  3385
  3386
  3387****************************************************************
  3388*             CREDIBILITY TABLES                               *
  3389****************************************************************
  3390
  3391     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3392         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3393                             INDEXED BY CF-CRDB-NDX.
  3394             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3395             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3396             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3397         16  FILLER                         PIC  X(332).
  3398
  3399
  3400****************************************************************
  3401*             REPORT CUSTOMIZATION RECORD                      *
  3402****************************************************************
  3403
  3404     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3405         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3406             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3407             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3408             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3409**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3410****       A T-TRANSFER.                                   ****
  3411             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3412
  3413         16  FILLER                         PIC XX.
  3414
  3415         16  CF-CARRIER-CNTL-OPT.
  3416             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3417                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3418                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3419             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3420                                            PIC X.
  3421         16  CF-GROUP-CNTL-OPT.
  3422             20  CF-GROUP-OPT-SEQ           PIC 9.
  3423                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3424                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3425             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3426                                            PIC X(6).
  3427         16  CF-STATE-CNTL-OPT.
  3428             20  CF-STATE-OPT-SEQ           PIC 9.
  3429                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3430                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3431             20  CF-STATE-SELECT OCCURS 3 TIMES
  3432                                            PIC XX.
  3433         16  CF-ACCOUNT-CNTL-OPT.
  3434             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3435                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3436                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  68
* EL652.cbl
  3437             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3438                                            PIC X(10).
  3439         16  CF-BUS-TYP-CNTL-OPT.
  3440             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3441                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3442                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3443             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3444                                            PIC XX.
  3445         16  CF-LF-TYP-CNTL-OPT.
  3446             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3447                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3448                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3449             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3450                                            PIC XX.
  3451         16  CF-AH-TYP-CNTL-OPT.
  3452             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3453                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3454                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3455             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3456                                            PIC XX.
  3457         16  CF-REPTCD1-CNTL-OPT.
  3458             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3459                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3460                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3461             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3462                                            PIC X(10).
  3463         16  CF-REPTCD2-CNTL-OPT.
  3464             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3465                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3466                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3467             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3468                                            PIC X(10).
  3469         16  CF-USER1-CNTL-OPT.
  3470             20  CF-USER1-OPT-SEQ           PIC 9.
  3471                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3472                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3473             20  CF-USER1-SELECT OCCURS 3 TIMES
  3474                                            PIC X(10).
  3475         16  CF-USER2-CNTL-OPT.
  3476             20  CF-USER2-OPT-SEQ           PIC 9.
  3477                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3478                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3479             20  CF-USER2-SELECT OCCURS 3 TIMES
  3480                                            PIC X(10).
  3481         16  CF-USER3-CNTL-OPT.
  3482             20  CF-USER3-OPT-SEQ           PIC 9.
  3483                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3484                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3485             20  CF-USER3-SELECT OCCURS 3 TIMES
  3486                                            PIC X(10).
  3487         16  CF-USER4-CNTL-OPT.
  3488             20  CF-USER4-OPT-SEQ           PIC 9.
  3489                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3490                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3491             20  CF-USER4-SELECT OCCURS 3 TIMES
  3492                                            PIC X(10).
  3493         16  CF-USER5-CNTL-OPT.
  3494             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  69
* EL652.cbl
  3495                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3496                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3497             20  CF-USER5-SELECT OCCURS 3 TIMES
  3498                                            PIC X(10).
  3499         16  CF-REINS-CNTL-OPT.
  3500             20  CF-REINS-OPT-SEQ           PIC 9.
  3501                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3502                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3503             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3504                 24  CF-REINS-PRIME         PIC XXX.
  3505                 24  CF-REINS-SUB           PIC XXX.
  3506
  3507         16  CF-AGENT-CNTL-OPT.
  3508             20  CF-AGENT-OPT-SEQ           PIC 9.
  3509                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3510                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3511             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3512                                            PIC X(10).
  3513
  3514         16  FILLER                         PIC X(43).
  3515
  3516         16  CF-LOSS-RATIO-SELECT.
  3517             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3518             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3519         16  CF-ENTRY-DATE-SELECT.
  3520             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3521             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3522         16  CF-EFFECTIVE-DATE-SELECT.
  3523             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3524             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3525
  3526         16  CF-EXCEPTION-LIST-IND          PIC X.
  3527             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3528
  3529         16  FILLER                         PIC X(318).
  3530
  3531****************************************************************
  3532*                  EXCEPTION REPORTING RECORD                  *
  3533****************************************************************
  3534
  3535     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3536         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3537             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3538
  3539         16  CF-COMBINED-LIFE-AH-OPT.
  3540             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3541             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3542             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3543             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3544
  3545         16  CF-LIFE-OPT.
  3546             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3547             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3548             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3549             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3550             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3551             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3552             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  70
* EL652.cbl
  3553             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3554             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3555             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3556
  3557         16  CF-AH-OPT.
  3558             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3559             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3560             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3561             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3562             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3563             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3564             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3565             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3566             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3567             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3568
  3569         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3570             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3571             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3572             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3573
  3574         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3575
  3576         16  FILLER                         PIC X(673).
  3577
  3578
  3579****************************************************************
  3580*             MORTGAGE SYSTEM PLAN RECORD                      *
  3581****************************************************************
  3582
  3583     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3584         16  CF-PLAN-TYPE                   PIC X.
  3585             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3586             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3587             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3588         16  CF-PLAN-ABBREV                 PIC XXX.
  3589         16  CF-PLAN-DESCRIPT               PIC X(10).
  3590         16  CF-PLAN-NOTES                  PIC X(20).
  3591         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3592         16  CF-PLAN-UNDERWRITING.
  3593             20  CF-PLAN-TERM-DATA.
  3594                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3595                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3596             20  CF-PLAN-AGE-DATA.
  3597                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3598                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3599                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3600             20  CF-PLAN-BENEFIT-DATA.
  3601                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3602                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3603                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3604                                            PIC S9(7)V99  COMP-3.
  3605         16  CF-PLAN-POLICY-FORMS.
  3606             20  CF-POLICY-FORM             PIC X(12).
  3607             20  CF-MASTER-APPLICATION      PIC X(12).
  3608             20  CF-MASTER-POLICY           PIC X(12).
  3609         16  CF-PLAN-RATING.
  3610             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  71
* EL652.cbl
  3611             20  CF-SEX-RATING              PIC X.
  3612                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3613                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3614             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3615             20  CF-SUB-STD-TYPE            PIC X.
  3616                 88  CF-PCT-OF-PREM            VALUE '1'.
  3617                 88  CF-PCT-OF-BENE            VALUE '2'.
  3618         16  CF-PLAN-PREM-TOLERANCES.
  3619             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3620             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3621         16  CF-PLAN-PYMT-TOLERANCES.
  3622             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3623             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3624         16  CF-PLAN-MISC-DATA.
  3625             20  FILLER                     PIC X.
  3626             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3627             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3628         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3629         16  CF-PLAN-IND-GRP                PIC X.
  3630             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3631                                                     '1'.
  3632             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3633                                                     '2'.
  3634         16  CF-MIB-SEARCH-SW               PIC X.
  3635             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3636             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3637             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3638             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3639         16  CF-ALPHA-SEARCH-SW             PIC X.
  3640             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3641             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3642             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3643             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3644             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3645             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3646             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3647             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3648             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3649             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3650                                                     'A' 'B' 'C'
  3651                                                     'X' 'Y' 'Z'.
  3652         16  CF-EFF-DT-RULE-SW              PIC X.
  3653             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3654             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3655             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3656             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3657             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3658         16  FILLER                         PIC X(4).
  3659         16  CF-HEALTH-QUESTIONS            PIC X.
  3660             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3661         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3662         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3663         16  CF-PLAN-SNGL-JNT               PIC X.
  3664             88  CF-COMBINED-PLAN              VALUE 'C'.
  3665             88  CF-JNT-PLAN                   VALUE 'J'.
  3666             88  CF-SNGL-PLAN                  VALUE 'S'.
  3667         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3668         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  72
* EL652.cbl
  3669         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3670         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3671         16  CF-RERATE-CNTL                 PIC  X.
  3672             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3673             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3674             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3675             88  CF-AUTO-RECALC                 VALUE '4'.
  3676         16  CF-BENEFIT-TYPE                PIC  X.
  3677             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3678             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3679         16  CF-POLICY-FEE                  PIC S999V99
  3680                                                    COMP-3.
  3681         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3682         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3683         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3684         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3685         16  FILLER                         PIC  X(32).
  3686         16  CF-TERMINATION-FORM            PIC  X(04).
  3687         16  FILLER                         PIC  X(08).
  3688         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3689                                                       COMP-3.
  3690         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3691         16  CF-ISSUE-LETTER                PIC  X(4).
  3692         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3693         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3694             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3695             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3696         16  CF-MP-REFUND-CALC              PIC X.
  3697             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3698             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3699             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3700             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3701             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3702             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3703             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3704             88  CF-MP-REFD-MEAN                VALUE '8'.
  3705         16  CF-ALT-RATE-CODE               PIC  X(5).
  3706
  3707
  3708         16  FILLER                         PIC X(498).
  3709****************************************************************
  3710*             MORTGAGE COMPANY MASTER RECORD                   *
  3711****************************************************************
  3712
  3713     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3714         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3715         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3716             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3717             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3718             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3719             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3720             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3721
  3722         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3723         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3724         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3725         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3726         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  73
* EL652.cbl
  3727
  3728         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3729             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3730         16  CF-MP-RECON-USE-IND            PIC X(1).
  3731             88  CF-MP-USE-RECON             VALUE 'Y'.
  3732         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3733             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3734         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3735             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3736             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3737         16  FILLER                         PIC X(1).
  3738         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3739             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3740         16  CF-MORTG-MIB-VERSION           PIC X.
  3741             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3742             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3743             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3744         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3745             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3746                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3747             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3748                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3749             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3750                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3751             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3752                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3753             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3754                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3755             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3756                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3757         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3758         16  FILLER                         PIC X(7).
  3759         16  CF-MORTG-DESTINATION-SYMBOL.
  3760             20  CF-MORTG-MIB-COMM          PIC X(5).
  3761             20  CF-MORTG-MIB-TERM          PIC X(5).
  3762         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3763             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3764         16  FILLER                         PIC X(03).
  3765         16  CF-MP-CHECK-NO-CONTROL.
  3766             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3767                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3768                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3769                                                ' ' LOW-VALUES.
  3770                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3771                                               VALUE '3'.
  3772         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3773         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3774         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3775             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3776                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3777             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3778                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3779             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3780                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3781             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3782                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3783             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3784                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  74
* EL652.cbl
  3785             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3786                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3787         16  CF-MORTG-BILLING-AREA.
  3788             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3789                                            PIC X.
  3790         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3791         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3792         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3793         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3794             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3795             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3796         16  FILLER                         PIC X.
  3797         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3798             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3799             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3800         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3801         16  FILLER                         PIC X(8).
  3802         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3803         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3804         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3805         16  CF-ACH-COMPANY-ID.
  3806             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3807                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3808                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3809                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3810             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3811         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3812             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3813         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3814             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3815             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3816         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3817         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3818         16  FILLER                         PIC X(536).
  3819
  3820****************************************************************
  3821*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3822****************************************************************
  3823
  3824     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3825         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3826             20  CF-FEMALE-HEIGHT.
  3827                 24  CF-FEMALE-FT           PIC 99.
  3828                 24  CF-FEMALE-IN           PIC 99.
  3829             20  CF-FEMALE-MIN-WT           PIC 999.
  3830             20  CF-FEMALE-MAX-WT           PIC 999.
  3831         16  FILLER                         PIC X(428).
  3832
  3833     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3834         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3835             20  CF-MALE-HEIGHT.
  3836                 24  CF-MALE-FT             PIC 99.
  3837                 24  CF-MALE-IN             PIC 99.
  3838             20  CF-MALE-MIN-WT             PIC 999.
  3839             20  CF-MALE-MAX-WT             PIC 999.
  3840         16  FILLER                         PIC X(428).
  3841******************************************************************
  3842*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  75
* EL652.cbl
  3843******************************************************************
  3844     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3845         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3846             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3847             20  CF-SYS-LETTER-ID           PIC X(04).
  3848             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3849             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3850             20  CF-SYS-RESET-SW            PIC X(01).
  3851             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3852             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3853
  3854         16  FILLER                         PIC X(50).
  3855
  3856         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3857             20  CF-USER-ACTIVE-SW          PIC X(01).
  3858             20  CF-USER-LETTER-ID          PIC X(04).
  3859             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3860             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3861             20  CF-USER-RESET-SW           PIC X(01).
  3862             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3863             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3864             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3865
  3866         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  76
* EL652.cbl
  3868*                            COPY ERCSUMM.
  3869******************************************************************
  3870*                                                                *
  3871*                                                                *
  3872*                            ERCSUMM                             *
  3873*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3874*                            VMOD=2.002                          *
  3875*                                                                *
  3876*   ONLINE CREDIT SYSTEM                                         *
  3877*                                                                *
  3878*   FILE DESCRIPTION = AR SUMMARY CROSS REFERENCE                *
  3879*                                                                *
  3880*   FILE TYPE = VSAM,KSDS                                        *
  3881*   RECORD SIZE = 150           RECFORM = FIXED                  *
  3882*                                                                *
  3883*   BASE CLUSTER NAME = ERSUMM                   RKP=2,LEN=34    *
  3884*                                                                *
  3885*       ALTERNATE PATH1 = ERSUMM2  (BY CO SUMMARY CARR           *
  3886*                                      GROUP F.R. AGENT)         *
  3887*                                                 RKP=36 ,LEN=34 *
  3888*                                                                *
  3889*   LOG = NO                                                     *
  3890*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3891*                                                                *
  3892******************************************************************
  3893
  3894 01  SUMM-CROSS-REFERENCE.
  3895     12  SX-RECORD-ID                PIC XX.
  3896         88  VALID-SX-ID             VALUE 'SX'.
  3897
  3898     12  SX-CONTROL-PRIMARY.
  3899         16  SX-COMPANY-CD           PIC X.
  3900         16  SX-SUMMARY              PIC X(6).
  3901         16  SX-CARRIER              PIC X.
  3902         16  SX-GROUP                PIC X(6).
  3903         16  SX-FIN-RESP             PIC X(10).
  3904         16  SX-ACCT-AGENT           PIC X(10).
  3905
  3906     12  SX-CONTROL-A1.
  3907         16  SX-COMPANY-A1           PIC X.
  3908         16  SX-ACCT-AGENT-A1        PIC X(10).
  3909         16  SX-SUMMARY-A1           PIC X(6).
  3910         16  SX-CARR-A1              PIC X.
  3911         16  SX-GROUP-A1             PIC X(6).
  3912         16  SX-FIN-RESP-A1          PIC X(10).
  3913
  3914     12  SX-MAINT-INFORMATION.
  3915         16  SX-LAST-MAINT-DT        PIC XX.
  3916         16  SX-LAST-MAINT-BY        PIC X(4).
  3917         16  SX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  3918
  3919     12  SX-SUMM-OR-AGT-NAME         PIC X(30).
  3920
  3921     12  FILLER                      PIC X(40).
  3922
  3923******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  77
* EL652.cbl
  3925*                            COPY ERCRQST.
  3926******************************************************************
  3927*                                                                *
  3928*                                                                *
  3929*                            ERCRQST.                            *
  3930*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3931*                            VMOD=2.002                          *
  3932*                                                                *
  3933*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  3934*                                                                *
  3935*   FILE TYPE = VSAM,KSDS                                        *
  3936*   RECORD SIZE = 200  RECFORM = FIXED                           *
  3937*                                                                *
  3938*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  3939*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  3940*                                   ACCOUNT, REF, BATCH)         *
  3941*                                                RKP=9, LEN=38   *
  3942*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  3943*                                   ACCOUNT, REF, BATCH)         *
  3944*                                                RKP=47, LEN=46  *
  3945*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  3946*                                   BATCH)                       *
  3947*                                                RKP=93, LEN=24  *
  3948*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  3949*                                   REF, BATCH)                  *
  3950*                                                RKP=117, LEN=35 *
  3951*   LOG = NO                                                     *
  3952*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3953******************************************************************
  3954
  3955 01  AR-REQUEST-RECORD.
  3956     12  RQ-RECORD-ID                     PIC XX.
  3957         88  VALID-RQ-ID                        VALUE 'RQ'.
  3958
  3959     12  RQ-CONTROL-PRIMARY.
  3960         16  RQ-COMPANY-CD                PIC X.
  3961         16  RQ-ENTRY-BATCH               PIC X(6).
  3962
  3963     12  RQ-CONTROL-BY-ACCT-REF.
  3964         16  RQ-COMPANY-CD-A1             PIC X.
  3965         16  RQ-CARRIER-A1                PIC X.
  3966         16  RQ-GROUPING-A1               PIC X(6).
  3967         16  RQ-STATE-A1                  PIC XX.
  3968         16  RQ-ACCOUNT-A1                PIC X(10).
  3969         16  RQ-REFERENCE-A1              PIC X(12).
  3970         16  RQ-BATCH-A1                  PIC X(6).
  3971
  3972     12  RQ-CONTROL-BY-FIN-RESP.
  3973         16  RQ-COMPANY-CD-A2             PIC X.
  3974         16  RQ-CARRIER-A2                PIC X.
  3975         16  RQ-GROUPING-A2               PIC X(6).
  3976         16  RQ-FIN-RESP-A2               PIC X(10).
  3977         16  RQ-ACCT-AGENT-A2             PIC X(10).
  3978         16  RQ-REFERENCE-A2              PIC X(12).
  3979         16  RQ-BATCH-A2                  PIC X(6).
  3980
  3981     12  RQ-CONTROL-BY-ACCT-AGENT.
  3982         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  78
* EL652.cbl
  3983         16  RQ-CARRIER-A3                PIC X.
  3984         16  RQ-GROUPING-A3               PIC X(6).
  3985         16  RQ-ACCT-AGENT-A3             PIC X(10).
  3986         16  RQ-BATCH-A3                  PIC X(6).
  3987
  3988     12  RQ-CONTROL-BY-SUMMARY.
  3989         16  RQ-COMPANY-CD-A4             PIC X.
  3990         16  RQ-SUMMARY-CODE              PIC X(6).
  3991         16  RQ-ACCOUNT-A4                PIC X(10).
  3992         16  RQ-REFERENCE-A4              PIC X(12).
  3993         16  RQ-BATCH-A4                  PIC X(6).
  3994
  3995     12  RQ-REQUEST-METHOD                PIC X.
  3996         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  3997         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  3998         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  3999         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  4000     12  FILLER                           PIC X.
  4001     12  RQ-STATUS                        PIC X.
  4002         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  4003         88  RQ-RESUBMIT                      VALUE 'R'.
  4004     12  RQ-PROCESSOR-ID                  PIC X(4).
  4005     12  RQ-ENTRY-DT                      PIC XX.
  4006     12  RQ-MO-END-DT                     PIC XX.
  4007     12  RQ-REQUEST-DT                    PIC XX.
  4008     12  RQ-STMT-DT                       PIC XX.
  4009     12  RQ-REVERSAL-DT                   PIC XX.
  4010     12  RQ-CREDIT-SELECT-DT              PIC XX.
  4011     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  4012
  4013     12  FILLER                           PIC X(27).
  4014
  4015******************************************************************
  4016
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  79
* EL652.cbl
  4018 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  4019                          COMPENSATION-MASTER AGENT-COMMISSIONS
  4020                          NAME-LOOKUP-MASTER CONTROL-FILE
  4021                          SUMM-CROSS-REFERENCE
  4022                          AR-REQUEST-RECORD.
  4023 0000-DFHEXIT SECTION.
  4024     MOVE '9#                    $   ' TO DFHEIV0.
  4025     MOVE 'EL652' TO DFHEIV1.
  4026     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4027
  4028     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4029     MOVE '5'                    TO  DC-OPTION-CODE.
  4030     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  4031     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4032     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4033
  4034     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  4035     MOVE EIBTRMID               TO  QID-TERM.
  4036
  4037 1000-START.
  4038     IF EIBCALEN = ZERO
  4039         GO TO 8800-UNAUTHORIZED-ACCESS.
  4040
  4041     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  4042         MOVE PI-CALLING-PROGRAM        TO  RETURNED-FROM.
  4043
  4044     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  4045         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  4046             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  4047             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  4048             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  4049             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  4050             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  4051             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  4052             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  4053             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  4054             PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  4055         ELSE
  4056             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  4057             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  4058             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  4059             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  4060             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  4061             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  4062             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  4063             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  4064
  4065     IF  RETURNED-FROM = XCTL-633
  4066             OR
  4067         RETURNED-FROM = XCTL-633DMD
  4068             OR
  4069         RETURNED-FROM = XCTL-635
  4070             OR
  4071         RETURNED-FROM = XCTL-6521
  4072             OR
  4073         RETURNED-FROM = XCTL-6522
  4074             OR
  4075         RETURNED-FROM = XCTL-6523
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  80
* EL652.cbl
  4076             OR
  4077         RETURNED-FROM = XCTL-6524
  4078             OR
  4079         RETURNED-FROM = XCTL-689
  4080             OR
  4081         RETURNED-FROM = XCTL-690
  4082             OR
  4083         RETURNED-FROM = XCTL-650
  4084         GO TO 3475-RECOVER-TEMP-STOR-PI.
  4085
  4086
  4087* EXEC CICS HANDLE CONDITION
  4088*        NOTOPEN   (9990-ABEND)
  4089*        NOTFND    (8880-NOT-FOUND)
  4090*        PGMIDERR  (9600-PGMID-ERROR)
  4091*        ERROR     (9990-ABEND)
  4092*    END-EXEC.
  4093*    MOVE '"$JIL.                ! " #00004082' TO DFHEIV0
  4094     MOVE X'22244A494C2E202020202020' TO DFHEIV0(1:12)
  4095     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4096     MOVE X'2220233030303034303832' TO DFHEIV0(25:11)
  4097     CALL 'kxdfhei1' USING DFHEIV0
  4098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4099
  4100
  4101     IF  EIBTRNID NOT = TRANS-ID
  4102         MOVE LOW-VALUES         TO  EL652AI
  4103         IF  EIBTRNID = EM6508-TRANS-ID
  4104             MOVE DFHENTER       TO  EIBAID
  4105             MOVE 'S'            TO  MAINTYPI
  4106             MOVE PI-CARRIER     TO  CARRIERI
  4107             MOVE PI-GROUPING    TO  GROUPI
  4108             MOVE 'A'            TO  TYPEI
  4109             MOVE PI-CR-FIN-RESP TO  FINRESPI
  4110             MOVE PI-CR-ACCOUNT  TO  ACCTNOI
  4111             MOVE 1              TO  CARRIERL TYPEL MAINTYPL
  4112             MOVE 6              TO  GROUPL
  4113             MOVE 10             TO  FINRESPL  ACCTNOL
  4114             GO TO 4000-EDIT-MAINT
  4115         ELSE
  4116             IF  (EIBTRNID NOT = EL640-TRANS-ID AND
  4117                                 EL633-TRANS-ID AND
  4118                                 EL633DMD-TRANS-ID AND
  4119                                 EL635-TRANS-ID AND
  4120                                 EL642-TRANS-ID AND
  4121                                 EL6501-TRANS-ID AND
  4122                                 EL6592-TRANS-ID AND
  4123                                 EL856-TRANS-ID)
  4124                 OR PI-CR-FIN-RESP = SPACES
  4125                 GO TO 8100-SEND-INITIAL-MAP
  4126             ELSE
  4127                 MOVE DFHENTER   TO  EIBAID
  4128                 MOVE 'S'        TO  MAINTYPI
  4129                 MOVE PI-CR-CARRIER  TO  CARRIERI
  4130                 MOVE PI-CR-GROUPING TO  GROUPI
  4131                 MOVE PI-CR-TYPE     TO  TYPEI
  4132                 MOVE PI-CR-FIN-RESP TO  FINRESPI
  4133                 MOVE PI-CR-ACCOUNT  TO  ACCTNOI
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  81
* EL652.cbl
  4134                 MOVE 1              TO  CARRIERL
  4135                                         TYPEL
  4136                                         MAINTYPL
  4137                 MOVE 6              TO  GROUPL
  4138                 MOVE 10             TO  FINRESPL
  4139                                         ACCTNOL
  4140                 GO TO 4000-EDIT-MAINT.
  4141
  4142     IF  EIBAID = DFHCLEAR
  4143             OR
  4144         NOT DISPLAY-CAP
  4145         GO TO 9400-CLEAR.
  4146
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  82
* EL652.cbl
  4148 2000-RECEIVE.
  4149     MOVE LOW-VALUES             TO  EL652AI.
  4150
  4151     IF EIBAID = DFHPA1 OR  DFHPA2  OR  DFHPA3
  4152         MOVE ER-0008            TO  EMI-ERROR
  4153         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4154         MOVE -1                 TO  MAINTYPL
  4155         GO TO 8200-SEND-DATAONLY.
  4156
  4157
  4158* EXEC CICS RECEIVE
  4159*        MAP     (MAP-NAME)
  4160*        MAPSET  (MAPSET-NAME)
  4161*        INTO    (EL652AI)
  4162*    END-EXEC.
  4163     MOVE LENGTH OF
  4164      EL652AI
  4165       TO DFHEIV11
  4166*    MOVE '8"T I  L              ''   #00004145' TO DFHEIV0
  4167     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4168     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4169     MOVE X'2020233030303034313435' TO DFHEIV0(25:11)
  4170     CALL 'kxdfhei1' USING DFHEIV0,
  4171           MAP-NAME,
  4172           EL652AI,
  4173           DFHEIV11,
  4174           MAPSET-NAME,
  4175           DFHEIV99,
  4176           DFHEIV99
  4177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4178
  4179
  4180     IF PFKEYL = ZERO
  4181         GO TO 3000-CHECK-PFKEYS.
  4182
  4183     IF EIBAID NOT = DFHENTER
  4184         MOVE ER-0004            TO EMI-ERROR
  4185         GO TO 3100-INPUT-ERROR.
  4186
  4187     IF (PFKEYI NUMERIC) AND (PFKEYI > 0 AND < 25)
  4188         MOVE PF-VALUES (PFKEYI)  TO  EIBAID
  4189     ELSE
  4190         MOVE ER-0029             TO  EMI-ERROR
  4191         GO TO 3100-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  83
* EL652.cbl
  4193 3000-CHECK-PFKEYS.
  4194     IF EIBAID = DFHPF23
  4195         GO TO 8810-PF23.
  4196
  4197     IF EIBAID = DFHPF24
  4198         GO TO 9200-RETURN-MAIN-MENU.
  4199
  4200     IF EIBAID = DFHPF12
  4201         GO TO 9500-PF12.
  4202
  4203     if (maintypl not = zeros)
  4204        and (maintypi not = 'D')
  4205        move spaces              to pi-el652-del-sw
  4206     end-if
  4207     IF EIBAID = DFHPF1
  4208         IF PI-CHECK-MAINT-TYPE = 'C' OR 'D'
  4209             MOVE 'S'            TO  MAINTYPO
  4210             MOVE AL-UANON       TO  MAINTYPA
  4211             MOVE 1              TO  MAINTYPL
  4212             GO TO 7250-PAGE-FORWARD
  4213         ELSE
  4214             GO TO 7250-PAGE-FORWARD.
  4215
  4216     IF EIBAID = DFHPF2
  4217         IF PI-CHECK-MAINT-TYPE = 'C' OR 'D'
  4218             MOVE 'S'            TO  MAINTYPO
  4219             MOVE AL-UANON       TO  MAINTYPA
  4220             MOVE 1              TO  MAINTYPL
  4221             GO TO 7300-PAGE-BACKWARD
  4222         ELSE
  4223             GO TO 7300-PAGE-BACKWARD.
  4224
  4225     IF EIBAID = DFHPF3
  4226        IF PI-AR-PROCESSING
  4227            IF PI-ERCOMP-KEY  NOT =       SPACES
  4228                MOVE PI-ERC-CARRIER TO  PI-CR-CARRIER
  4229                MOVE PI-ERC-GROUP   TO  PI-CR-GROUPING
  4230                MOVE PI-ERC-RESP    TO  PI-CR-FIN-RESP
  4231                MOVE PI-ERC-ACCT    TO  PI-CR-ACCOUNT
  4232                MOVE PI-ERC-TYPE    TO  PI-CR-TYPE
  4233                IF PI-CR-ACCOUNT =  LOW-VALUES
  4234                   MOVE 'G'         TO  PI-CR-TYPE
  4235                                        PI-ERC-TYPE
  4236                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4237                   MOVE XCTL-635    TO PGM-NAME
  4238                   GO TO 9300-XCTL
  4239                ELSE
  4240                   MOVE 'A'         TO  PI-CR-TYPE
  4241                                        PI-ERC-TYPE
  4242                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4243                   MOVE XCTL-635    TO PGM-NAME
  4244                   GO TO 9300-XCTL
  4245            ELSE
  4246                MOVE ER-3021        TO  EMI-ERROR
  4247                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4248                GO TO 8100-SEND-INITIAL-MAP
  4249        ELSE
  4250            IF PI-ERCOMP-KEY NOT = SPACES AND LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  84
* EL652.cbl
  4251                MOVE PI-ERC-CARRIER TO  PI-CR-CARRIER
  4252                MOVE PI-ERC-GROUP   TO  PI-CR-GROUPING
  4253                MOVE PI-ERC-RESP    TO  PI-CR-FIN-RESP
  4254                MOVE PI-ERC-ACCT    TO  PI-CR-ACCOUNT
  4255                MOVE PI-ERC-TYPE    TO  PI-CR-TYPE
  4256                IF PI-CR-ACCOUNT =  LOW-VALUES
  4257*                  MOVE 'G'         TO  PI-CR-TYPE
  4258*                                       PI-ERC-TYPE
  4259                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4260                   IF PI-COMPANY-ID = 'DMD'
  4261                      MOVE XCTL-633DMD TO PGM-NAME
  4262                      GO TO 9300-XCTL
  4263                   ELSE
  4264                      MOVE XCTL-633    TO PGM-NAME
  4265                      GO TO 9300-XCTL
  4266                ELSE
  4267                   MOVE 'A'         TO  PI-CR-TYPE
  4268                                        PI-ERC-TYPE
  4269                   PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4270                   IF PI-COMPANY-ID = 'DMD'
  4271                      MOVE XCTL-633DMD TO PGM-NAME
  4272                      GO TO 9300-XCTL
  4273                   ELSE
  4274                      MOVE XCTL-633    TO PGM-NAME
  4275                      GO TO 9300-XCTL
  4276            ELSE
  4277                MOVE ER-3021        TO  EMI-ERROR
  4278                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4279                GO TO 8100-SEND-INITIAL-MAP.
  4280
  4281     IF EIBAID = DFHPF4
  4282         IF PI-ERC-TYPE = 'G' OR 'A' OR 'B'
  4283             PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4284             MOVE XCTL-6521      TO PGM-NAME
  4285             GO TO 9300-XCTL
  4286         ELSE
  4287             MOVE ER-2872        TO  EMI-ERROR
  4288             GO TO 3100-INPUT-ERROR.
  4289
  4290     IF  EIBAID = DFHPF5
  4291         MOVE XCTL-689           TO PGM-NAME
  4292         IF  PI-ERCOMP-KEY NOT = SPACES
  4293             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4294             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4295             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
  4296             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4297             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4298
  4299             IF  PI-CR-ACCOUNT =  LOW-VALUES
  4300*                MOVE 'G'        TO PI-CR-TYPE, PI-ERC-TYPE
  4301                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4302                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
  4303                 GO TO 9300-XCTL
  4304
  4305             ELSE
  4306                 MOVE 'A'        TO PI-CR-TYPE, PI-ERC-TYPE
  4307                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4308                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  85
* EL652.cbl
  4309                 GO TO 9300-XCTL
  4310
  4311         ELSE
  4312             PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4313             MOVE LOW-VALUES     TO PI-PROGRAM-WORK-AREA
  4314             GO TO 9300-XCTL.
  4315
  4316     IF  EIBAID = DFHPF6
  4317
  4318         MOVE XCTL-690           TO PGM-NAME
  4319
  4320         IF  PI-ERCOMP-KEY NOT = SPACES
  4321             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4322             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4323             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
  4324             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4325             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4326
  4327             IF  PI-CR-ACCOUNT =  LOW-VALUES
  4328*                MOVE 'G'        TO PI-CR-TYPE, PI-ERC-TYPE
  4329                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4330                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
  4331                 GO TO 9300-XCTL
  4332
  4333             ELSE
  4334                 MOVE 'A'        TO PI-CR-TYPE, PI-ERC-TYPE
  4335                 PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4336                 MOVE LOW-VALUES TO PI-PROGRAM-WORK-AREA
  4337                 GO TO 9300-XCTL
  4338
  4339         ELSE
  4340             PERFORM 3400-CREATE-TS-PI THRU 3400-EXIT
  4341             MOVE LOW-VALUES     TO PI-PROGRAM-WORK-AREA
  4342             GO TO 9300-XCTL.
  4343
  4344     IF EIBAID = DFHPF7
  4345         IF PI-ERC-TYPE = 'A'
  4346            MOVE PI-ERC-CARRIER  TO PI-CR-CARRIER
  4347            MOVE PI-ERC-GROUP    TO PI-CR-GROUPING
  4348            MOVE PI-ERC-ACCT     TO PI-CR-ACCOUNT
  4349*           PERFORM 3200-FIND-STATE
  4350*                                THRU 3200-EXIT
  4351            MOVE PI-SAVE-STATE   TO PI-CR-STATE
  4352            PERFORM 3400-CREATE-TS-PI
  4353                                 THRU 3400-EXIT
  4354            MOVE XCTL-650        TO PGM-NAME
  4355            GO TO 9300-XCTL
  4356         ELSE
  4357            MOVE ER-0035         TO EMI-ERROR
  4358            GO TO 3100-INPUT-ERROR
  4359         END-IF
  4360     END-IF.
  4361
  4362     IF EIBAID = DFHPF8
  4363         IF PI-ERCOMP-KEY NOT = SPACES
  4364             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4365             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4366             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  86
* EL652.cbl
  4367             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4368             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4369             PERFORM 3400-CREATE-TS-PI  THRU 3400-EXIT
  4370             MOVE XCTL-6522             TO PGM-NAME
  4371             GO TO 9300-XCTL
  4372         ELSE
  4373            MOVE ER-0187                TO EMI-ERROR
  4374            GO TO 3100-INPUT-ERROR
  4375         END-IF
  4376     END-IF.
  4377
  4378*****************************************************************
  4379*  SPECIAL CODE - ENABLES DISPLAY OF PRIOR MONTH-END TOTALS*
  4380*  PF9 AVAILABLE TO A/R USERS                                   *
  4381*****************************************************************
  4382
  4383     IF PI-AR-PROCESSING OR PI-PROCESSOR-ID = 'LGXX'
  4384         IF EIBAID = DFHPF9
  4385             MOVE 'Y'            TO  WS-SHOW-SAVE-TOTALS
  4386             GO TO 4000-EDIT-MAINT.
  4387
  4388     IF EIBAID = DFHPF10
  4389        IF PI-ERC-TYPE = 'B'
  4390         IF PI-ERCOMP-KEY NOT = SPACES
  4391             MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4392             MOVE PI-ERC-GROUP   TO PI-CR-GROUPING
  4393             MOVE PI-ERC-RESP    TO PI-CR-FIN-RESP
  4394             MOVE PI-ERC-ACCT    TO PI-CR-ACCOUNT
  4395             MOVE PI-ERC-TYPE    TO PI-CR-TYPE
  4396             PERFORM 3400-CREATE-TS-PI  THRU 3400-EXIT
  4397             MOVE XCTL-6523             TO PGM-NAME
  4398             GO TO 9300-XCTL
  4399         ELSE
  4400            MOVE ER-0187                TO EMI-ERROR
  4401            GO TO 3100-INPUT-ERROR
  4402         END-IF
  4403        ELSE
  4404           MOVE ER-0035          TO EMI-ERROR
  4405           GO TO 3100-INPUT-ERROR
  4406        END-IF
  4407     END-IF
  4408     IF EIBAID = DFHPF13
  4409        IF PI-ERC-TYPE = 'B'
  4410           IF PI-ERCOMP-KEY NOT = SPACES
  4411              MOVE PI-ERC-CARRIER TO PI-CR-CARRIER
  4412              MOVE PI-ERC-GROUP  TO PI-CR-GROUPING
  4413              MOVE PI-ERC-RESP   TO PI-CR-FIN-RESP
  4414              MOVE PI-ERC-ACCT   TO PI-CR-ACCOUNT
  4415              MOVE PI-ERC-TYPE   TO PI-CR-TYPE
  4416              PERFORM 3400-CREATE-TS-PI
  4417                                 THRU 3400-EXIT
  4418              MOVE XCTL-6524     TO PGM-NAME
  4419              GO TO 9300-XCTL
  4420           ELSE
  4421              MOVE ER-0187       TO EMI-ERROR
  4422              GO TO 3100-INPUT-ERROR
  4423           END-IF
  4424        ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  87
* EL652.cbl
  4425           MOVE ER-0035          TO EMI-ERROR
  4426           GO TO 3100-INPUT-ERROR
  4427        END-IF
  4428     END-IF
  4429     IF EIBAID = DFHENTER
  4430         GO TO 4000-EDIT-MAINT.
  4431
  4432     MOVE ER-0029                TO  EMI-ERROR.
  4433
  4434 3100-INPUT-ERROR.
  4435     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4436
  4437     MOVE AL-UNBON               TO  PFKEYA.
  4438     MOVE -1                     TO  PFKEYL.
  4439
  4440     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  88
* EL652.cbl
  4442 3200-FIND-STATE.
  4443
  4444     IF PI-SAVE-CITYST NOT = SPACES
  4445        MOVE PI-SAVE-CITYST       TO WS-SRCH-STATE
  4446     ELSE
  4447        IF PI-SAVE-ADDR2 NOT = SPACES
  4448           MOVE PI-SAVE-ADDR2     TO WS-SRCH-STATE
  4449        END-IF
  4450     END-IF
  4451
  4452     PERFORM VARYING STNDX FROM +29 BY -1 UNTIL
  4453          (STNDX < +1) OR
  4454          ((WS-SRCH-STATE (STNDX:2) ALPHABETIC) AND
  4455          (WS-SRCH-STATE (STNDX:2) NOT = SPACES AND LOW-VALUES)
  4456          AND
  4457          (WS-SRCH-STATE (STNDX + 1:1) NOT = ' ' AND ',' AND
  4458                   '.' AND LOW-VALUES) AND
  4459          (WS-SRCH-STATE (STNDX:1) NOT = ' ' AND ',' AND
  4460                   '.' AND LOW-VALUES))
  4461     END-PERFORM
  4462
  4463     IF STNDX NOT < +1
  4464        MOVE WS-SRCH-STATE (STNDX:2)
  4465                                 TO PI-SAVE-STATE
  4466     ELSE
  4467        MOVE SPACES              TO PI-SAVE-STATE
  4468     END-IF
  4469
  4470     .
  4471 3200-EXIT.
  4472     EXIT.
  4473 3400-CREATE-TS-PI.
  4474
  4475     PERFORM 3450-DELETE-TEMP-STOR-PI THRU 3450-EXIT.
  4476
  4477
  4478* EXEC CICS HANDLE CONDITION
  4479*        QIDERR  (3400-EXIT)
  4480*    END-EXEC.
  4481*    MOVE '"$N                   ! # #00004448' TO DFHEIV0
  4482     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4484     MOVE X'2320233030303034343438' TO DFHEIV0(25:11)
  4485     CALL 'kxdfhei1' USING DFHEIV0
  4486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4487
  4488
  4489
  4490* EXEC CICS WRITEQ TS
  4491*        QUEUE   (QID-PI)
  4492*        FROM    (PROGRAM-INTERFACE-BLOCK)
  4493*        LENGTH  (PI-COMM-LENGTH)
  4494*        ITEM    (QID-ITEM)
  4495*    END-EXEC.
  4496*    MOVE '*" I                  ''   #00004452' TO DFHEIV0
  4497     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  4498     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4499     MOVE X'2020233030303034343532' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  89
* EL652.cbl
  4500     CALL 'kxdfhei1' USING DFHEIV0,
  4501           QID-PI,
  4502           PROGRAM-INTERFACE-BLOCK,
  4503           PI-COMM-LENGTH,
  4504           QID-ITEM,
  4505           DFHEIV99,
  4506           DFHEIV99
  4507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4508
  4509
  4510 3400-EXIT.
  4511      EXIT.
  4512
  4513 3450-DELETE-TEMP-STOR-PI.
  4514
  4515
  4516* EXEC CICS HANDLE CONDITION
  4517*        QIDERR  (3450-EXIT)
  4518*    END-EXEC.
  4519*    MOVE '"$N                   ! $ #00004464' TO DFHEIV0
  4520     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4522     MOVE X'2420233030303034343634' TO DFHEIV0(25:11)
  4523     CALL 'kxdfhei1' USING DFHEIV0
  4524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4525
  4526
  4527
  4528* EXEC CICS DELETEQ TS
  4529*        QUEUE  (QID-PI)
  4530*    END-EXEC.
  4531*    MOVE '*&                    #   #00004468' TO DFHEIV0
  4532     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  4533     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4534     MOVE X'2020233030303034343638' TO DFHEIV0(25:11)
  4535     CALL 'kxdfhei1' USING DFHEIV0,
  4536           QID-PI,
  4537           DFHEIV99
  4538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4539
  4540
  4541
  4542* EXEC CICS SYNCPOINT
  4543*    END-EXEC.
  4544*    MOVE '6"                    !   #00004472' TO DFHEIV0
  4545     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  4546     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4547     MOVE X'2020233030303034343732' TO DFHEIV0(25:11)
  4548     CALL 'kxdfhei1' USING DFHEIV0
  4549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4550
  4551
  4552 3450-EXIT.
  4553      EXIT.
  4554
  4555 3475-RECOVER-TEMP-STOR-PI.
  4556
  4557     MOVE LOW-VALUES            TO  EL652AI.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  90
* EL652.cbl
  4558
  4559
  4560* EXEC CICS HANDLE CONDITION
  4561*        NOTOPEN   (9990-ABEND)
  4562*        NOTFND    (8880-NOT-FOUND)
  4563*        PGMIDERR  (9600-PGMID-ERROR)
  4564*        ERROR     (9990-ABEND)
  4565*    END-EXEC.
  4566*    MOVE '"$JIL.                ! % #00004482' TO DFHEIV0
  4567     MOVE X'22244A494C2E202020202020' TO DFHEIV0(1:12)
  4568     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4569     MOVE X'2520233030303034343832' TO DFHEIV0(25:11)
  4570     CALL 'kxdfhei1' USING DFHEIV0
  4571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4572
  4573
  4574
  4575* EXEC CICS HANDLE CONDITION
  4576*        QIDERR  (3475-EXIT)
  4577*    END-EXEC.
  4578*    MOVE '"$N                   ! & #00004489' TO DFHEIV0
  4579     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4580     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4581     MOVE X'2620233030303034343839' TO DFHEIV0(25:11)
  4582     CALL 'kxdfhei1' USING DFHEIV0
  4583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4584
  4585
  4586
  4587* EXEC CICS READQ TS
  4588*        QUEUE   (QID-PI)
  4589*        ITEM    (1)
  4590*        INTO    (PROGRAM-INTERFACE-BLOCK)
  4591*        LENGTH  (PI-COMM-LENGTH)
  4592*    END-EXEC.
  4593     MOVE 1
  4594       TO DFHEIV11
  4595*    MOVE '*$II   L              ''   #00004493' TO DFHEIV0
  4596     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4597     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4598     MOVE X'2020233030303034343933' TO DFHEIV0(25:11)
  4599     CALL 'kxdfhei1' USING DFHEIV0,
  4600           QID-PI,
  4601           PROGRAM-INTERFACE-BLOCK,
  4602           PI-COMM-LENGTH,
  4603           DFHEIV11,
  4604           DFHEIV99,
  4605           DFHEIV99
  4606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4607
  4608
  4609     PERFORM 3450-DELETE-TEMP-STOR-PI THRU 3450-EXIT.
  4610
  4611     IF  PI-ERCOMP-KEY = SPACES OR LOW-VALUES
  4612         GO TO 8100-SEND-INITIAL-MAP.
  4613
  4614     IF  PI-ERC-CARRIER > LOW-VALUES
  4615         MOVE +1                 TO CARRIERL
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  91
* EL652.cbl
  4616         MOVE PI-ERC-CARRIER     TO CARRIERI.
  4617
  4618     IF  PI-ERC-GROUP > LOW-VALUES
  4619         MOVE +6                 TO GROUPL
  4620         MOVE PI-ERC-GROUP       TO GROUPI.
  4621
  4622     IF  PI-ERC-RESP > LOW-VALUES
  4623         MOVE +10                TO FINRESPL
  4624         MOVE PI-ERC-RESP        TO FINRESPI.
  4625
  4626     IF  PI-ERC-ACCT > LOW-VALUES
  4627         MOVE +1                 TO ACCTNOL
  4628         MOVE PI-ERC-ACCT        TO ACCTNOI.
  4629
  4630     IF  PI-ERC-TYPE > LOW-VALUES
  4631         MOVE +1                 TO TYPEL
  4632         MOVE PI-ERC-TYPE        TO TYPEI.
  4633
  4634     MOVE 'S'                    TO MAINTYPI.
  4635     MOVE 1                      TO MAINTYPL.
  4636     GO TO 4000-EDIT-MAINT.
  4637
  4638 3475-EXIT.
  4639      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  92
* EL652.cbl
  4641 4000-EDIT-MAINT.
  4642     IF MAINTYPL > ZERO
  4643         MOVE MAINTYPI           TO  PI-CHECK-MAINT-TYPE
  4644         IF VALID-MAINT-TYPE
  4645             MOVE AL-UANON       TO  MAINTYPA
  4646             IF MAINTYPI NOT = 'S'
  4647                 MOVE SPACES     TO  WS-ACCESS
  4648                 MOVE '1'        TO  CNTL-REC-TYPE
  4649                 PERFORM 7400-READ-CONTROL-FILE  THRU  7499-EXIT
  4650             ELSE
  4651                 NEXT SENTENCE
  4652         ELSE
  4653             MOVE -1             TO  MAINTYPL
  4654             MOVE AL-UABON       TO  MAINTYPA
  4655             MOVE ER-2039        TO  EMI-ERROR
  4656             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4657     ELSE
  4658         MOVE -1                 TO  MAINTYPL
  4659         MOVE AL-UABON           TO  MAINTYPA
  4660         MOVE ER-2039            TO  EMI-ERROR
  4661         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4662
  4663     IF  NOT MODIFY-CAP
  4664             AND
  4665         NOT SHOW-FUNCTION
  4666         MOVE 'UPDATE'           TO SM-READ
  4667         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  4668         IF  MORTGAGE-SESSION
  4669             MOVE ER-9096        TO  EMI-ERROR
  4670             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4671             GO TO 8100-SEND-INITIAL-MAP
  4672         ELSE
  4673             MOVE ER-0070        TO  EMI-ERROR
  4674             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4675             GO TO 8100-SEND-INITIAL-MAP.
  4676
  4677     IF CARRIERL > ZERO
  4678         IF PI-CARRIER-SECURITY > SPACES
  4679             IF CARRIERI = PI-CARRIER-SECURITY
  4680                 NEXT SENTENCE
  4681             ELSE
  4682                 MOVE -1            TO  CARRIERL
  4683                 MOVE ER-2370       TO  EMI-ERROR
  4684                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4685                 MOVE AL-UABON      TO  CARRIERA
  4686                 GO TO 8200-SEND-DATAONLY.
  4687
  4688     IF CARRIERL > ZERO
  4689         IF ADD-FUNCTION
  4690             IF PI-ZERO-CARRIER
  4691               OR PI-ZERO-CAR-GROUP
  4692                 MOVE ZEROS      TO  PI-ERC-CARRIER
  4693                                     CARRIERI
  4694                 MOVE AL-UANON   TO  CARRIERA
  4695             ELSE
  4696                 MOVE CARRIERI   TO  WS-CARRIER
  4697                 MOVE '6'        TO  CNTL-REC-TYPE
  4698                 PERFORM 7400-READ-CONTROL-FILE  THRU  7499-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  93
* EL652.cbl
  4699         ELSE
  4700             IF PI-ZERO-CARRIER
  4701               OR PI-ZERO-CAR-GROUP
  4702                 MOVE ZEROS      TO  PI-ERC-CARRIER
  4703                                     CARRIERI
  4704                 MOVE AL-UANON   TO  CARRIERA
  4705             ELSE
  4706                 MOVE AL-UANON   TO  CARRIERA
  4707                 MOVE CARRIERI   TO  PI-ERC-CARRIER
  4708     ELSE
  4709         IF ADD-FUNCTION
  4710             IF PI-ZERO-CARRIER
  4711               OR PI-ZERO-CAR-GROUP
  4712                 MOVE ZEROS      TO  PI-ERC-CARRIER
  4713                                     CARRIERI
  4714                 MOVE AL-UANON   TO  CARRIERA
  4715             ELSE
  4716                 MOVE -1         TO  CARRIERL
  4717                 MOVE AL-UABON   TO  CARRIERA
  4718                 MOVE ER-0193    TO  EMI-ERROR
  4719                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4720         ELSE
  4721             MOVE -1             TO  CARRIERL
  4722             MOVE AL-UABON       TO  CARRIERA
  4723             MOVE ER-0193        TO  EMI-ERROR
  4724             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4725
  4726     IF GROUPL > ZERO
  4727         IF PI-ZERO-GROUPING
  4728           OR PI-ZERO-CAR-GROUP
  4729             MOVE ZEROS          TO  PI-ERC-GROUP
  4730                                     GROUPI
  4731             MOVE AL-UANON       TO  GROUPA
  4732         ELSE
  4733             MOVE AL-UANON       TO  GROUPA
  4734             MOVE GROUPI         TO  PI-ERC-GROUP
  4735     ELSE
  4736         IF ADD-FUNCTION
  4737             IF PI-ZERO-GROUPING
  4738               OR PI-ZERO-CAR-GROUP
  4739                 MOVE ZEROS      TO  PI-ERC-GROUP
  4740                                     GROUPI
  4741                 MOVE AL-UANON   TO  GROUPA
  4742             ELSE
  4743                 MOVE LOW-VALUES  TO  PI-ERC-GROUP
  4744         ELSE
  4745             MOVE LOW-VALUES     TO  PI-ERC-GROUP.
  4746
  4747     IF TYPEL > ZERO
  4748         MOVE TYPEI              TO  PI-CHECK-TYPE
  4749         IF VALID-TYPE
  4750             MOVE AL-UANON       TO  TYPEA
  4751             MOVE TYPEI          TO  PI-ERC-TYPE
  4752         ELSE
  4753             MOVE -1             TO  TYPEL
  4754             MOVE AL-UABON       TO  TYPEA
  4755             MOVE ER-2042        TO  EMI-ERROR
  4756             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  94
* EL652.cbl
  4757     ELSE
  4758         MOVE -1                 TO  TYPEL
  4759         MOVE AL-UABON           TO  TYPEA
  4760         MOVE ER-2042            TO  EMI-ERROR
  4761         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4762
  4763     IF FINRESPL >        ZERO
  4764         MOVE AL-UANON           TO  FINRESPA
  4765         IF FINRESPI = SPACES
  4766             MOVE LOW-VALUES     TO  PI-ERC-RESP
  4767         ELSE
  4768             MOVE FINRESPI       TO  PI-ERC-RESP
  4769     ELSE
  4770         MOVE LOW-VALUES         TO  PI-ERC-RESP.
  4771
  4772     IF ACCTNOL > ZERO
  4773         MOVE AL-UANON           TO  ACCTNOA
  4774         IF ACCTNOI = SPACES
  4775             MOVE LOW-VALUES     TO  PI-ERC-ACCT
  4776         ELSE
  4777             MOVE ACCTNOI        TO  PI-ERC-ACCT
  4778     ELSE
  4779         MOVE LOW-VALUES         TO  PI-ERC-ACCT.
  4780
  4781     IF ADDR2L > ZERO
  4782        MOVE AL-UANON            TO ADDR2A
  4783        IF ADDR2I = SPACES
  4784           MOVE LOW-VALUES       TO PI-SAVE-ADDR2
  4785        ELSE
  4786           MOVE ADDR2I           TO PI-SAVE-ADDR2
  4787        END-IF
  4788     ELSE
  4789        MOVE LOW-VALUES          TO PI-SAVE-ADDR2
  4790     END-IF
  4791
  4792     IF CITYL > ZERO
  4793        MOVE AL-UANON            TO CITYA
  4794        IF CITYI = SPACES
  4795           MOVE LOW-VALUES       TO PI-SAVE-CITY
  4796        ELSE
  4797           MOVE CITYI            TO PI-SAVE-CITY
  4798        END-IF
  4799     ELSE
  4800        MOVE LOW-VALUES          TO PI-SAVE-CITY
  4801     END-IF
  4802
  4803     IF STATEL > ZERO
  4804        MOVE AL-UANON            TO STATEA
  4805        IF STATEI = SPACES
  4806           MOVE LOW-VALUES       TO PI-SAVE-STATE
  4807        ELSE
  4808           MOVE STATEI           TO PI-SAVE-STATE
  4809        END-IF
  4810     ELSE
  4811        MOVE LOW-VALUES          TO PI-SAVE-STATE
  4812     END-IF
  4813
  4814     IF NOT MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  95
* EL652.cbl
  4815         IF SHOW-FUNCTION
  4816             GO TO 5000-BUILD-INITIAL-SCREEN
  4817         ELSE
  4818             MOVE 'UPDATE'       TO SM-READ
  4819             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  4820             MOVE ER-0070        TO  EMI-ERROR
  4821             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4822             GO TO 8100-SEND-INITIAL-MAP.
  4823
  4824     IF EMI-NO-ERRORS
  4825         NEXT SENTENCE
  4826     ELSE
  4827        IF EIBTRNID NOT = TRANS-ID
  4828            GO TO 8100-SEND-INITIAL-MAP
  4829         ELSE
  4830            GO TO 8200-SEND-DATAONLY.
  4831
  4832     IF CHANGE-FUNCTION
  4833         GO TO 4400-CHANGE.
  4834
  4835     IF DELETE-FUNCTION
  4836         GO TO 4600-DELETE.
  4837
  4838     IF SHOW-FUNCTION
  4839         GO TO 5000-BUILD-INITIAL-SCREEN.
  4840
  4841     IF TYPEI = 'C'
  4842         IF FINRESPI NOT = LOW-VALUES OR
  4843            ACCTNOI  NOT = LOW-VALUES
  4844               MOVE -1           TO  FINRESPL
  4845               MOVE AL-UABON     TO  FINRESPA
  4846                                     ACCTNOA
  4847               MOVE ER-2088      TO  EMI-ERROR
  4848               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4849
  4850     IF TYPEI = 'A'
  4851         IF FINRESPI = LOW-VALUES OR
  4852             ACCTNOI = LOW-VALUES
  4853               MOVE -1           TO  FINRESPL
  4854               MOVE AL-UABON     TO  FINRESPA
  4855                                     ACCTNOA
  4856               MOVE ER-2089      TO  EMI-ERROR
  4857               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4858
  4859     IF TYPEI = 'G' OR 'B'
  4860         IF ACCTNOI NOT = LOW-VALUES
  4861             MOVE -1             TO  ACCTNOL
  4862             MOVE AL-UABON       TO  ACCTNOA
  4863             MOVE ER-2091        TO  EMI-ERROR
  4864             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4865         ELSE
  4866             IF FINRESPI = LOW-VALUES
  4867                 MOVE -1         TO  FINRESPL
  4868                 MOVE AL-UABON   TO  FINRESPA
  4869                 MOVE ER-2097    TO  EMI-ERROR
  4870                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4871
  4872     IF TYPEI = 'G' OR 'B'
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  96
* EL652.cbl
  4873         IF SUMMNOI NOT = LOW-VALUES
  4874             MOVE -1             TO  SUMMNOL
  4875             MOVE AL-UABON       TO  SUMMNOA
  4876             MOVE ER-3153        TO  EMI-ERROR
  4877             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4878
  4879     IF TYPEI = 'G' OR 'B'
  4880         IF NETGRSI NOT = LOW-VALUES
  4881             MOVE -1             TO  NETGRSL
  4882             MOVE AL-UABON       TO  NETGRSA
  4883             MOVE ER-3154        TO  EMI-ERROR
  4884             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4885
  4886     IF EMI-NO-ERRORS
  4887         NEXT SENTENCE
  4888     ELSE
  4889         GO TO 8200-SEND-DATAONLY.
  4890
  4891     IF ADD-FUNCTION
  4892         GO TO 4200-ADD.
  4893
  4894     MOVE -1                     TO  MAINTYPL.
  4895     MOVE ER-2056                TO  EMI-ERROR.
  4896     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4897
  4898     GO TO 8200-SEND-DATAONLY.
  4899
  4900 4000-EXIT.
  4901     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  97
* EL652.cbl
  4903 4200-ADD.
  4904     IF PI-ERCOMP-KEY = PI-SAVE-ERCOMP-KEY
  4905         MOVE ER-2057            TO  EMI-ERROR
  4906         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4907         MOVE -1                 TO  MAINTYPL
  4908         GO TO 8200-SEND-DATAONLY.
  4909
  4910     PERFORM 7000-EDIT  THRU  7000-EXIT.
  4911
  4912     IF EMI-NO-ERRORS
  4913         NEXT SENTENCE
  4914     ELSE
  4915         GO TO 8200-SEND-DATAONLY.
  4916
  4917
  4918* EXEC CICS HANDLE CONDITION
  4919*        NOTOPEN  (9990-ABEND)
  4920*        NOTFND   (4250-CONT)
  4921*    END-EXEC.
  4922*    MOVE '"$JI                  ! '' #00004808' TO DFHEIV0
  4923     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  4924     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4925     MOVE X'2720233030303034383038' TO DFHEIV0(25:11)
  4926     CALL 'kxdfhei1' USING DFHEIV0
  4927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4928
  4929
  4930     PERFORM 7050-READ-ERCOMP  THRU  7050-EXIT.
  4931
  4932     MOVE ER-2057                TO  EMI-ERROR.
  4933     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4934
  4935     MOVE LOW-VALUES             TO  PI-SAVE-ERCOMP-KEY.
  4936
  4937     MOVE -1                     TO  MAINTYPL.
  4938
  4939     GO TO 8200-SEND-DATAONLY.
  4940
  4941 4250-CONT.
  4942     PERFORM 7150-ERCOMP-GETMAIN  THRU  7150-EXIT.
  4943
  4944     MOVE SPACES                 TO  COMPENSATION-MASTER.
  4945     MOVE ZEROS                  TO  CO-LF-CLM-AMT
  4946                                     CO-AH-CLM-AMT
  4947                                     CO-CUR-FICA
  4948                                     CO-YTD-FICA
  4949                                     CO-CUR-OVR-UNDR
  4950                                     CO-YTD-OVR-UNDR
  4951                                     CO-MAX-BANK-FEE-LEASE
  4952                                     CO-MAX-BANK-FEE
  4953                                     CO-BAL-FWD
  4954                                     CO-CUR-COM
  4955                                     CO-CUR-CHG
  4956                                     CO-CUR-PMT
  4957                                     CO-END-BAL
  4958                                     CO-CUR
  4959                                     CO-OV30
  4960                                     CO-OV60
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  98
* EL652.cbl
  4961                                     CO-OV90
  4962                                     CO-YTD-COM
  4963                                     CO-YTD-OV
  4964                                     CO-YTD-PAID-COM
  4965                                     CO-YTD-PAID-OV
  4966                                     CO-CURRENT-BAL-FWD
  4967                                     CO-CURRENT-CUR-COM
  4968                                     CO-CURRENT-CUR-CHG
  4969                                     CO-CURRENT-CUR-PMT
  4970                                     CO-CURRENT-END-BAL
  4971                                     CO-CURRENT-CUR
  4972                                     CO-CURRENT-OV30
  4973                                     CO-CURRENT-OV60
  4974                                     CO-CURRENT-OV90
  4975                                     CO-CURRENT-YTD-COM
  4976                                     CO-CURRENT-YTD-OV
  4977                                     CO-ACT-YEAR
  4978                                     CO-ACT-MONTH
  4979                                     CO-ACT-DAY.
  4980     MOVE LOW-VALUES             TO  CO-LAST-ACTIVITY-DATE
  4981                                     CO-LAST-STMT-DT
  4982                                     CO-CURRENT-LAST-STMT-DT
  4983                                     CO-GA-EFFECTIVE-DT
  4984                                     CO-GA-TERMINATION-DT.
  4985     MOVE LOW-VALUES             TO  CO-FIRST-WRITTEN-DT.
  4986
  4987     MOVE 'N'                    TO  CO-INTERNAL-CONTROL-1
  4988                                     CO-INTERNAL-CONTROL-2.
  4989
  4990     PERFORM 6000-CHECK-FOR-UPDATE  THRU  6099-EXIT.
  4991
  4992     MOVE PI-PROCESSOR-ID        TO  CO-LAST-MAINT-USER.
  4993     MOVE EIBTIME                TO  CO-LAST-MAINT-HHMMSS.
  4994     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4995     MOVE '5'                    TO  DC-OPTION-CODE.
  4996     MOVE LINK-ELDATCV           TO  PGM-NAME.
  4997
  4998
  4999* EXEC CICS LINK
  5000*        PROGRAM   (PGM-NAME)
  5001*        COMMAREA  (DATE-CONVERSION-DATA)
  5002*        LENGTH    (DC-COMM-LENGTH)
  5003*    END-EXEC.
  5004*    MOVE '."C                   ''   #00004881' TO DFHEIV0
  5005     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5006     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5007     MOVE X'2020233030303034383831' TO DFHEIV0(25:11)
  5008     CALL 'kxdfhei1' USING DFHEIV0,
  5009           PGM-NAME,
  5010           DATE-CONVERSION-DATA,
  5011           DC-COMM-LENGTH,
  5012           DFHEIV99,
  5013           DFHEIV99,
  5014           DFHEIV99
  5015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5016
  5017
  5018     MOVE DC-BIN-DATE-1          TO  CO-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page  99
* EL652.cbl
  5019                                     BIN-CURRENT-SAVE.
  5020     MOVE PI-CR-MONTH-END-DT     TO  CO-ROLADEX-PRINT-DT.
  5021     MOVE PI-CR-MONTH-END-DT     TO  DC-BIN-DATE-1
  5022     MOVE SPACE                  TO  DC-OPTION-CODE.
  5023
  5024
  5025* EXEC CICS LINK
  5026*        PROGRAM   (PGM-NAME)
  5027*        COMMAREA  (DATE-CONVERSION-DATA)
  5028*        LENGTH    (DC-COMM-LENGTH)
  5029*    END-EXEC.
  5030*    MOVE '."C                   ''   #00004893' TO DFHEIV0
  5031     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5032     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5033     MOVE X'2020233030303034383933' TO DFHEIV0(25:11)
  5034     CALL 'kxdfhei1' USING DFHEIV0,
  5035           PGM-NAME,
  5036           DATE-CONVERSION-DATA,
  5037           DC-COMM-LENGTH,
  5038           DFHEIV99,
  5039           DFHEIV99,
  5040           DFHEIV99
  5041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5042
  5043
  5044     MOVE PI-COMPANY-CD          TO  CO-COMPANY-CD.
  5045     MOVE 'CO'                   TO  CO-RECORD-ID.
  5046     MOVE 'A'                    TO  JP-RECORD-TYPE.
  5047     MOVE COMP-FILE-ID           TO  FILE-ID.
  5048     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5049
  5050     PERFORM 4300-ADD-COMPENSATION-NAME  THRU  4300-EXIT.
  5051
  5052
  5053* EXEC CICS WRITE
  5054*        DATASET  (COMP-FILE-ID)
  5055*        FROM     (COMPENSATION-MASTER)
  5056*        RIDFLD   (CO-CONTROL-PRIMARY)
  5057*    END-EXEC.
  5058     MOVE LENGTH OF
  5059      COMPENSATION-MASTER
  5060       TO DFHEIV11
  5061*    MOVE '&$ L                  ''   #00004907' TO DFHEIV0
  5062     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5063     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5064     MOVE X'2020233030303034393037' TO DFHEIV0(25:11)
  5065     CALL 'kxdfhei1' USING DFHEIV0,
  5066           COMP-FILE-ID,
  5067           COMPENSATION-MASTER,
  5068           DFHEIV11,
  5069           CO-CONTROL-PRIMARY,
  5070           DFHEIV99,
  5071           DFHEIV99
  5072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5073
  5074
  5075     PERFORM 8400-LOG-JOURNAL-RECORD.
  5076
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 100
* EL652.cbl
  5077     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT.
  5078
  5079     IF PI-AR-PROCESSING
  5080         IF SUMMNOL > ZERO
  5081             MOVE SUMMNOI        TO PI-AR-SUMMARY-CODE
  5082             PERFORM 7500-UPDATE-SUMM  THRU  7599-EXIT
  5083             MOVE PI-AR-SUMMARY-CODE
  5084                                 TO  WS-SUMM-FOR-RQST
  5085             PERFORM 6500-UPDATE-RQST  THRU  6599-EXIT.
  5086
  5087     MOVE ER-0000                TO  EMI-ERROR.
  5088     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5089
  5090     MOVE LOW-VALUES             TO  EL652AO.
  5091     MOVE PI-ERC-CARRIER         TO  CARRIERO.
  5092     MOVE PI-ERC-TYPE            TO  TYPEO.
  5093     MOVE AL-UANON               TO  CARRIERA
  5094                                     TYPEA.
  5095
  5096     IF PI-ERC-GROUP NOT = SPACES
  5097         MOVE PI-ERC-GROUP       TO  GROUPO
  5098         MOVE AL-UANON           TO  GROUPA.
  5099
  5100     IF PI-ERC-RESP NOT = SPACES
  5101         MOVE PI-ERC-RESP        TO  FINRESPO
  5102         MOVE AL-UANON           TO  FINRESPA.
  5103
  5104     IF PI-ERC-ACCT NOT = SPACES
  5105         MOVE PI-ERC-ACCT        TO  ACCTNOO
  5106         MOVE AL-UANON           TO  ACCTNOA.
  5107
  5108     GO TO 5000-BUILD-INITIAL-SCREEN.
  5109
  5110 4200-EXIT.
  5111     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 101
* EL652.cbl
  5113 4300-ADD-COMPENSATION-NAME.
  5114
  5115* EXEC CICS HANDLE CONDITION
  5116*         DUPREC   (4300-EXIT)
  5117*    END-EXEC.
  5118*    MOVE '"$%                   ! ( #00004952' TO DFHEIV0
  5119     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  5120     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5121     MOVE X'2820233030303034393532' TO DFHEIV0(25:11)
  5122     CALL 'kxdfhei1' USING DFHEIV0
  5123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5124
  5125
  5126
  5127* EXEC CICS GETMAIN
  5128*         LENGTH   (ERNAME-LENGTH)
  5129*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  5130*         INITIMG  (GETMAIN-SPACE)
  5131*    END-EXEC.
  5132*    MOVE ',"IL                  $   #00004956' TO DFHEIV0
  5133     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5134     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5135     MOVE X'2020233030303034393536' TO DFHEIV0(25:11)
  5136     CALL 'kxdfhei1' USING DFHEIV0,
  5137           DFHEIV20,
  5138           ERNAME-LENGTH,
  5139           GETMAIN-SPACE
  5140     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  5141         DFHEIV20
  5142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5143
  5144
  5145     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  5146     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  5147     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  5148     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  5149     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  5150     MOVE CO-ACCT-NAME           TO  NL-NAME.
  5151     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  5152        MOVE NL-NAME (5:26)      TO NL-NAME
  5153     END-IF
  5154     MOVE CO-ADDR-CITY           TO  NL-CITY.
  5155     MOVE CO-ADDR-STATE          TO  NL-ST
  5156     MOVE 'C'                    TO  NL-RECORD-TYPE.
  5157     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  5158     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  5159     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  5160     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  5161     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  5162     MOVE CO-TYPE                TO  NL-CO-TYPE.
  5163
  5164
  5165* EXEC CICS WRITE
  5166*        FROM      (NAME-LOOKUP-MASTER)
  5167*        RIDFLD    (NL-CONTROL-PRIMARY)
  5168*        DATASET   (NAME-FILE-ID)
  5169*    END-EXEC.
  5170     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 102
* EL652.cbl
  5171      NAME-LOOKUP-MASTER
  5172       TO DFHEIV11
  5173*    MOVE '&$ L                  ''   #00004981' TO DFHEIV0
  5174     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5175     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5176     MOVE X'2020233030303034393831' TO DFHEIV0(25:11)
  5177     CALL 'kxdfhei1' USING DFHEIV0,
  5178           NAME-FILE-ID,
  5179           NAME-LOOKUP-MASTER,
  5180           DFHEIV11,
  5181           NL-CONTROL-PRIMARY,
  5182           DFHEIV99,
  5183           DFHEIV99
  5184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5185
  5186
  5187 4300-EXIT.
  5188     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 103
* EL652.cbl
  5190 4400-CHANGE.
  5191     IF PI-ERCOMP-KEY = PI-SAVE-ERCOMP-KEY
  5192         NEXT SENTENCE
  5193     ELSE
  5194**** MUST SHOW RECORD FIRST
  5195         MOVE ER-2056            TO  EMI-ERROR
  5196         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5197         MOVE -1                 TO  MAINTYPL
  5198         GO TO 8200-SEND-DATAONLY.
  5199
  5200     PERFORM 7000-EDIT  THRU  7000-EXIT.
  5201
  5202     IF EMI-NO-ERRORS
  5203         NEXT SENTENCE
  5204     ELSE
  5205         GO TO 8200-SEND-DATAONLY.
  5206
  5207     PERFORM 7200-READ-ERCOMP-UPDATE  THRU  7200-EXIT.
  5208
  5209     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5210     MOVE CO-AR-SUMMARY-CODE     TO  WS-SAVE-SUMM.
  5211
  5212     PERFORM 6000-CHECK-FOR-UPDATE  THRU  6099-EXIT.
  5213
  5214     IF (CO-LAST-MAINT-USER   = PI-UPDATE-BY)
  5215        OR (CO-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS)
  5216        CONTINUE
  5217     ELSE
  5218
  5219* EXEC CICS UNLOCK
  5220*            DATASET  (COMP-FILE-ID)
  5221*       END-EXEC
  5222*    MOVE '&*                    #   #00005018' TO DFHEIV0
  5223     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5224     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5225     MOVE X'2020233030303035303138' TO DFHEIV0(25:11)
  5226     CALL 'kxdfhei1' USING DFHEIV0,
  5227           COMP-FILE-ID,
  5228           DFHEIV99
  5229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5230        MOVE ER-0068             TO EMI-ERROR
  5231        PERFORM 9900-ERROR-FORMAT
  5232                                 THRU 9900-EXIT
  5233        GO TO 8200-SEND-DATAONLY
  5234     END-IF
  5235
  5236     MOVE PI-PROCESSOR-ID        TO  CO-LAST-MAINT-USER.
  5237     MOVE EIBTIME                TO  CO-LAST-MAINT-HHMMSS.
  5238     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5239     MOVE '5'                    TO  DC-OPTION-CODE.
  5240     MOVE LINK-ELDATCV           TO  PGM-NAME.
  5241
  5242
  5243* EXEC CICS LINK
  5244*        PROGRAM   (PGM-NAME)
  5245*        COMMAREA  (DATE-CONVERSION-DATA)
  5246*        LENGTH    (DC-COMM-LENGTH)
  5247*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 104
* EL652.cbl
  5248*    MOVE '."C                   ''   #00005033' TO DFHEIV0
  5249     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5250     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5251     MOVE X'2020233030303035303333' TO DFHEIV0(25:11)
  5252     CALL 'kxdfhei1' USING DFHEIV0,
  5253           PGM-NAME,
  5254           DATE-CONVERSION-DATA,
  5255           DC-COMM-LENGTH,
  5256           DFHEIV99,
  5257           DFHEIV99,
  5258           DFHEIV99
  5259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5260
  5261
  5262     MOVE DC-BIN-DATE-1          TO  CO-LAST-MAINT-DT
  5263                                     BIN-CURRENT-SAVE.
  5264     MOVE SPACE                  TO  DC-OPTION-CODE.
  5265     MOVE PI-CR-MONTH-END-DT     TO  CO-ROLADEX-PRINT-DT.
  5266     MOVE PI-CR-MONTH-END-DT     TO  DC-BIN-DATE-1
  5267
  5268
  5269* EXEC CICS LINK
  5270*        PROGRAM   (PGM-NAME)
  5271*        COMMAREA  (DATE-CONVERSION-DATA)
  5272*        LENGTH    (DC-COMM-LENGTH)
  5273*    END-EXEC.
  5274*    MOVE '."C                   ''   #00005045' TO DFHEIV0
  5275     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5276     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5277     MOVE X'2020233030303035303435' TO DFHEIV0(25:11)
  5278     CALL 'kxdfhei1' USING DFHEIV0,
  5279           PGM-NAME,
  5280           DATE-CONVERSION-DATA,
  5281           DC-COMM-LENGTH,
  5282           DFHEIV99,
  5283           DFHEIV99,
  5284           DFHEIV99
  5285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5286
  5287
  5288     MOVE 'N'                    TO  CO-INTERNAL-CONTROL-1.
  5289     MOVE 'B'                    TO  JP-RECORD-TYPE.
  5290     MOVE COMP-FILE-ID           TO  FILE-ID.
  5291
  5292     PERFORM 8400-LOG-JOURNAL-RECORD.
  5293
  5294     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5295
  5296     PERFORM 4300-ADD-COMPENSATION-NAME  THRU  4300-EXIT.
  5297
  5298
  5299* EXEC CICS REWRITE
  5300*        DATASET  (COMP-FILE-ID)
  5301*        FROM     (COMPENSATION-MASTER)
  5302*    END-EXEC.
  5303     MOVE LENGTH OF
  5304      COMPENSATION-MASTER
  5305       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 105
* EL652.cbl
  5306*    MOVE '&& L                  %   #00005061' TO DFHEIV0
  5307     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5308     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5309     MOVE X'2020233030303035303631' TO DFHEIV0(25:11)
  5310     CALL 'kxdfhei1' USING DFHEIV0,
  5311           COMP-FILE-ID,
  5312           COMPENSATION-MASTER,
  5313           DFHEIV11,
  5314           DFHEIV99
  5315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5316
  5317
  5318     MOVE 'C'                    TO  JP-RECORD-TYPE.
  5319
  5320     PERFORM 8400-LOG-JOURNAL-RECORD.
  5321
  5322     IF NOT PI-AR-PROCESSING
  5323         GO TO 4400-CONT.
  5324
  5325     IF SUMMNOL NOT > ZERO
  5326         GO TO 4400-CONT.
  5327
  5328     IF SUMMNOI  = WS-SAVE-SUMM
  5329         GO TO 4400-CONT
  5330     ELSE
  5331         PERFORM 7600-DELETE-SUMM  THRU  7699-EXIT.
  5332
  5333     MOVE SUMMNOI                 TO WS-SUMM-FOR-RQST.
  5334     PERFORM 6500-UPDATE-RQST  THRU  6599-EXIT.
  5335
  5336     IF SUMMNOI = SPACES
  5337         GO TO 4400-CONT.
  5338
  5339     MOVE SUMMNOI                 TO PI-AR-SUMMARY-CODE.
  5340     PERFORM 7500-UPDATE-SUMM  THRU  7599-EXIT.
  5341
  5342 4400-CONT.
  5343     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT.
  5344
  5345     MOVE ER-0000                TO  EMI-ERROR.
  5346     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5347
  5348     MOVE LOW-VALUES             TO  EL652AO.
  5349     MOVE PI-ERC-CARRIER         TO  CARRIERO.
  5350     MOVE PI-ERC-TYPE            TO  TYPEO.
  5351     MOVE AL-UANON               TO  CARRIERA
  5352                                     TYPEA.
  5353
  5354     IF PI-ERC-GROUP NOT = SPACES
  5355         MOVE PI-ERC-GROUP       TO  GROUPO
  5356         MOVE AL-UANON           TO  GROUPA.
  5357
  5358     IF PI-ERC-RESP NOT = SPACES
  5359         MOVE PI-ERC-RESP        TO  FINRESPO
  5360         MOVE AL-UANON           TO  FINRESPA.
  5361
  5362     IF PI-ERC-ACCT NOT = SPACES
  5363         MOVE PI-ERC-ACCT        TO  ACCTNOO
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 106
* EL652.cbl
  5364         MOVE AL-UANON           TO  ACCTNOA.
  5365
  5366     GO TO 5000-BUILD-INITIAL-SCREEN.
  5367
  5368 4400-EXIT.
  5369     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 107
* EL652.cbl
  5371 4600-DELETE.
  5372     IF PI-ERCOMP-KEY = PI-SAVE-ERCOMP-KEY
  5373         NEXT SENTENCE
  5374     ELSE
  5375         MOVE ER-2056            TO  EMI-ERROR
  5376         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5377         MOVE -1                 TO  MAINTYPL
  5378         GO TO 8200-SEND-DATAONLY.
  5379
  5380     PERFORM 7200-READ-ERCOMP-UPDATE  THRU  7200-EXIT.
  5381
  5382     MOVE CO-AR-SUMMARY-CODE     TO  WS-SAVE-SUMM.
  5383
  5384     IF (CO-YTD-COM NOT = ZERO) OR
  5385        (CO-END-BAL NOT = ZERO)
  5386
  5387* EXEC CICS UNLOCK
  5388*            DATASET  (COMP-FILE-ID)
  5389*        END-EXEC
  5390*    MOVE '&*                    #   #00005134' TO DFHEIV0
  5391     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5392     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5393     MOVE X'2020233030303035313334' TO DFHEIV0(25:11)
  5394     CALL 'kxdfhei1' USING DFHEIV0,
  5395           COMP-FILE-ID,
  5396           DFHEIV99
  5397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5398         MOVE ER-2092            TO  EMI-ERROR
  5399         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5400         MOVE -1                 TO  MAINTYPL
  5401         GO TO 8200-SEND-DATAONLY.
  5402
  5403     MOVE 'D'                    TO  JP-RECORD-TYPE.
  5404     MOVE COMPENSATION-MASTER    TO  JP-RECORD-AREA.
  5405     MOVE COMP-FILE-ID           TO  FILE-ID.
  5406
  5407     IF CO-LAST-MAINT-USER   = PI-UPDATE-BY OR
  5408        CO-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS
  5409         continue
  5410     ELSE
  5411
  5412* EXEC CICS UNLOCK
  5413*            DATASET  (COMP-FILE-ID)
  5414*        END-EXEC
  5415*    MOVE '&*                    #   #00005150' TO DFHEIV0
  5416     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  5417     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5418     MOVE X'2020233030303035313530' TO DFHEIV0(25:11)
  5419     CALL 'kxdfhei1' USING DFHEIV0,
  5420           COMP-FILE-ID,
  5421           DFHEIV99
  5422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5423         MOVE ER-0068            TO  EMI-ERROR
  5424         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5425         GO TO 8200-SEND-DATAONLY
  5426     end-if
  5427     if pi-el652-del-sw = 'Y'
  5428        continue
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 108
* EL652.cbl
  5429     else
  5430        move 'Y'                 to pi-el652-del-sw
  5431        move er-1299             to emi-error
  5432        perform 9900-error-format thru 9900-exit
  5433        move spaces              to maintypo
  5434        MOVE -1                  TO MAINTypL
  5435        GO TO 8200-send-dataonly
  5436     end-if
  5437
  5438* EXEC CICS DELETE
  5439*        DATASET  (COMP-FILE-ID)
  5440*    END-EXEC
  5441*    MOVE '&(                    &   #00005167' TO DFHEIV0
  5442     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5443     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5444     MOVE X'2020233030303035313637' TO DFHEIV0(25:11)
  5445     CALL 'kxdfhei1' USING DFHEIV0,
  5446           COMP-FILE-ID,
  5447           DFHEIV99,
  5448           DFHEIV99,
  5449           DFHEIV99,
  5450           DFHEIV99
  5451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5452
  5453     PERFORM 8400-LOG-JOURNAL-RECORD
  5454     MOVE EIBDATE                TO  DC-JULIAN-YYDDD
  5455     MOVE '5'                    TO  DC-OPTION-CODE
  5456     MOVE LINK-ELDATCV           TO  PGM-NAME
  5457
  5458
  5459* EXEC CICS LINK
  5460*        PROGRAM   (PGM-NAME)
  5461*        COMMAREA  (DATE-CONVERSION-DATA)
  5462*        LENGTH    (DC-COMM-LENGTH)
  5463*    END-EXEC
  5464*    MOVE '."C                   ''   #00005176' TO DFHEIV0
  5465     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5466     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5467     MOVE X'2020233030303035313736' TO DFHEIV0(25:11)
  5468     CALL 'kxdfhei1' USING DFHEIV0,
  5469           PGM-NAME,
  5470           DATE-CONVERSION-DATA,
  5471           DC-COMM-LENGTH,
  5472           DFHEIV99,
  5473           DFHEIV99,
  5474           DFHEIV99
  5475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5476
  5477     MOVE DC-BIN-DATE-1          TO  BIN-CURRENT-SAVE
  5478
  5479     PERFORM 8000-UPDATE-MAINT-DATE  THRU  8000-EXIT
  5480
  5481     MOVE ER-0000                TO  EMI-ERROR
  5482     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5483
  5484     IF PI-AR-PROCESSING
  5485         IF WS-SAVE-SUMM NOT = SPACES
  5486             PERFORM 7600-DELETE-SUMM  THRU  7699-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 109
* EL652.cbl
  5487             MOVE SPACES         TO  WS-SUMM-FOR-RQST
  5488             PERFORM  6500-UPDATE-RQST  THRU  6599-EXIT
  5489         end-if
  5490     end-if
  5491
  5492     MOVE LOW-VALUES             TO  EL652AO
  5493     MOVE PI-ERC-CARRIER         TO  CARRIERO
  5494     MOVE PI-ERC-TYPE            TO  TYPEO
  5495     MOVE AL-UANON               TO  CARRIERA
  5496                                     TYPEA
  5497
  5498     IF PI-ERC-GROUP NOT = SPACES
  5499         MOVE PI-ERC-GROUP       TO  GROUPO
  5500         MOVE AL-UANON           TO  GROUPA
  5501     end-if
  5502
  5503     IF PI-ERC-RESP NOT = SPACES
  5504         MOVE PI-ERC-RESP        TO  FINRESPO
  5505         MOVE AL-UANON           TO  FINRESPA
  5506     end-if
  5507
  5508     IF PI-ERC-ACCT NOT = SPACES
  5509         MOVE PI-ERC-ACCT        TO  ACCTNOO
  5510         MOVE AL-UANON           TO  ACCTNOA
  5511     end-if
  5512
  5513     MOVE LOW-VALUES             TO  PI-SAVE-ERCOMP-KEY
  5514
  5515     GO TO 8100-SEND-INITIAL-MAP
  5516     .
  5517 4600-EXIT.
  5518     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 110
* EL652.cbl
  5520
  5521 4700-CHECK-STATE.
  5522     IF CLPSTI =  SPACES
  5523         GO TO 4799-EXIT
  5524     END-IF.
  5525
  5526     MOVE SPACES                 TO  ELCNTL-KEY2.
  5527     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID-2.
  5528     MOVE '3'                    TO  CNTL-REC-TYPE-2.
  5529     MOVE CLPSTI                 TO  CNTL-STATE-2.
  5530     MOVE +0                     TO  CNTL-SEQ-NO-2.
  5531
  5532
  5533* EXEC CICS  HANDLE CONDITION
  5534*        NOTFND  (4750-NO-STATE)
  5535*    END-EXEC.
  5536*    MOVE '"$I                   ! ) #00005237' TO DFHEIV0
  5537     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5538     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5539     MOVE X'2920233030303035323337' TO DFHEIV0(25:11)
  5540     CALL 'kxdfhei1' USING DFHEIV0
  5541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5542
  5543
  5544
  5545* EXEC CICS  READ
  5546*        DATASET  (CNTL-FILE-ID)
  5547*        SET      (ADDRESS OF CONTROL-FILE)
  5548*        RIDFLD   (ELCNTL-KEY2)
  5549*    END-EXEC.
  5550*    MOVE '&"S        E          (   #00005241' TO DFHEIV0
  5551     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5552     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5553     MOVE X'2020233030303035323431' TO DFHEIV0(25:11)
  5554     CALL 'kxdfhei1' USING DFHEIV0,
  5555           CNTL-FILE-ID,
  5556           DFHEIV20,
  5557           DFHEIV99,
  5558           ELCNTL-KEY2,
  5559           DFHEIV99,
  5560           DFHEIV99,
  5561           DFHEIV99
  5562     SET ADDRESS OF CONTROL-FILE TO
  5563         DFHEIV20
  5564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5565
  5566
  5567     GO TO 4799-EXIT.
  5568
  5569 4750-NO-STATE.
  5570     MOVE ER-0144                TO  EMI-ERROR.
  5571     MOVE -1                     TO  CLPSTL.
  5572     MOVE AL-UABON               TO  CLPSTA.
  5573
  5574     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5575
  5576 4799-EXIT.
  5577     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 111
* EL652.cbl
  5578
  5579 5000-BUILD-INITIAL-SCREEN.
  5580     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  5581
  5582     PERFORM 7050-READ-ERCOMP  THRU  7050-EXIT.
  5583
  5584     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  5585     MOVE CO-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  5586
  5587     IF CO-LAST-MAINT-HHMMSS NUMERIC
  5588        MOVE CO-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS
  5589        ELSE
  5590        MOVE ZEROS                  TO  PI-UPDATE-HHMMSS.
  5591
  5592 5050-SET-UP-SCREEN.
  5593     MOVE CO-CONTROL-NAME        TO  PCONTO.
  5594     MOVE CO-MAIL-NAME           TO  MAILNAMO.
  5595     MOVE CO-ACCT-NAME           TO  ACCTNAMO.
  5596     MOVE CO-ACCT-NAME           TO  PI-SAVE-ACCT-NAME.
  5597     MOVE CO-ADDR-1              TO  ADDR1O.
  5598     MOVE CO-ADDR-2              TO  ADDR2O
  5599                                     PI-SAVE-ADDR2
  5600     MOVE CO-ADDR-CITY           TO  CITYO
  5601                                     PI-SAVE-CITY
  5602     MOVE CO-ADDR-STATE          TO  STATEO
  5603                                     PI-SAVE-STATE
  5604     MOVE SPACES                 TO  WS-ZIP-CODE.
  5605
  5606     IF CO-CANADIAN-POST-CODE
  5607         MOVE CO-CAN-POSTAL-1    TO  WS-ZIP-CAN-2-POST1
  5608         MOVE CO-CAN-POSTAL-2    TO  WS-ZIP-CAN-2-POST2
  5609     ELSE
  5610         MOVE CO-ZIP-PRIME       TO  WS-ZIP-AM-2-CODE
  5611         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  5612             MOVE '-'            TO  WS-ZIP-AM-2-DASH
  5613             MOVE CO-ZIP-PLUS4   TO  WS-ZIP-AM-2-PLUS4.
  5614
  5615     MOVE WS-ZIP-CODE            TO  ZIPCODEO.
  5616
  5617     IF CO-BILL-SW = ' ' OR 'B' OR 'R' OR 'T' OR 'S'
  5618        OR 'O' OR 'E' OR 'C'
  5619         MOVE AL-UANON           TO  BILLPRTA
  5620         MOVE CO-BILL-SW         TO  BILLPRTO
  5621     END-IF.
  5622
  5623     MOVE CO-CSO-1099            TO  PNT1099O.
  5624
  5625     MOVE CO-CSR-CODE            TO  CSRO.
  5626
  5627     IF (PI-COMPANY-ID = 'DCC')
  5628        AND (CO-TYPE = 'A')
  5629        IF CO-COMP-TYPE = '1'
  5630           MOVE 'Y'              TO SPPDDO
  5631        ELSE
  5632           MOVE 'N'              TO SPPDDO
  5633        END-IF
  5634     END-IF
  5635     MOVE CO-SOC-SEC             TO  SSNO.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 112
* EL652.cbl
  5636
  5637     MOVE CO-BALANCE-CONTROL     TO  CARBALO.
  5638
  5639     IF PI-AR-PROCESSING
  5640         IF CO-AR-SUMMARY-CODE > SPACES
  5641             MOVE AL-UANON       TO  SUMMNOA
  5642             MOVE CO-AR-SUMMARY-CODE
  5643                                 TO  SUMMNOO
  5644         ELSE
  5645             MOVE LOW-VALUES     TO  SUMMNOO.
  5646
  5647     IF PI-AR-PROCESSING
  5648        IF NOT CO-ACCOUNT-TYPE
  5649           MOVE AL-SADOF         TO SCDESCA
  5650           MOVE AL-SANOF         TO SUMMNOA
  5651        ELSE
  5652           MOVE AL-UANOF         TO SUMMNOA.
  5653
  5654     IF PI-AR-PROCESSING
  5655         MOVE CO-AR-BAL-LEVEL    TO  ARBALO
  5656         MOVE CO-AR-PULL-CHECK   TO  CKPULLO.
  5657
  5658     IF PI-AR-PROCESSING
  5659         IF CO-ACCOUNT-TYPE
  5660             MOVE CO-AR-REPORTING
  5661                                 TO  NETGRSO
  5662         ELSE
  5663             MOVE SPACES         TO  NETGRSO.
  5664
  5665     MOVE SPACES                 TO  FLITYPO.
  5666
  5667     IF CO-COMPANY-TYPE
  5668         MOVE SPACES             TO  RPTCD2O
  5669         MOVE AL-SADOF           TO  RPTCDDA.
  5670
  5671     MOVE SPACES                 TO  LETRCDO.
  5672     MOVE AL-SADOF               TO  LETDESCA.
  5673     MOVE SPACES                 TO  BALCDO.
  5674     MOVE AL-SADOF               TO  BALPRTA.
  5675     MOVE CO-CLP-STATE           TO  CLPSTO.
  5676     MOVE CO-MAX-BANK-FEE        TO  MAXFEEO
  5677     MOVE CO-SPP-REFUND-EDIT     TO  REFEO
  5678     IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  5679        MOVE +0                  TO CO-MAX-BANK-FEE-LEASE
  5680     END-IF
  5681     MOVE CO-MAX-BANK-FEE-LEASE  TO  MAXLFO
  5682     .
  5683 5060-BUILD-TOTALS.
  5684     IF SHOW-SAVE-TOTALS
  5685         NEXT SENTENCE
  5686     ELSE
  5687         GO TO 5070-BUILD-CURRENT-TOTALS.
  5688
  5689     IF CO-LAST-STMT-DT = SPACES
  5690         MOVE SPACES             TO  LSTMDTO
  5691         GO TO 5060-LST-STMT-OK.
  5692
  5693     MOVE CO-LAST-STMT-MONTH     TO  WS-YMD-MM.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 113
* EL652.cbl
  5694     MOVE CO-LAST-STMT-DAY       TO  WS-YMD-DD.
  5695     MOVE CO-LAST-STMT-YEAR      TO  WS-YMD-YY.
  5696
  5697     IF WS-YMD-DATE-NUM NUMERIC
  5698         NEXT SENTENCE
  5699     ELSE
  5700         MOVE SPACES             TO  LSTMDTO
  5701         GO TO 5060-LST-STMT-OK.
  5702
  5703     MOVE WS-YMD-DATE            TO  DC-GREG-DATE-1-YMD.
  5704     MOVE '3'                    TO  DC-OPTION-CODE.
  5705
  5706     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  5707
  5708     IF NO-CONVERSION-ERROR
  5709         NEXT SENTENCE
  5710     ELSE
  5711         MOVE SPACES             TO  LSTMDTO
  5712         GO TO 5060-LST-STMT-OK.
  5713
  5714     MOVE CO-LAST-STMT-MONTH     TO  WS-DMDY8-MM.
  5715     MOVE CO-LAST-STMT-DAY       TO  WS-DMDY8-DD.
  5716     MOVE CO-LAST-STMT-YEAR      TO  WS-DMDY8-YY.
  5717     MOVE '/'                    TO  WS-DMDY8-SL1
  5718                                     WS-DMDY8-SL2.
  5719     MOVE WS-DATE-MDY-8          TO  LSTMDTO.
  5720
  5721 5060-LST-STMT-OK.
  5722     MOVE CO-BAL-FWD             TO  BALFWDO.
  5723     MOVE CO-CUR-COM             TO  CURCOMO.
  5724     MOVE CO-CUR-PMT             TO  CURPMTO.
  5725     MOVE CO-CUR-CHG             TO  CURCHGO.
  5726     MOVE CO-END-BAL             TO  ENDBALO.
  5727     MOVE CO-CUR                 TO  CURRENTO.
  5728     MOVE CO-OV30                TO  OVER30O.
  5729     MOVE CO-OV60                TO  OVER60O.
  5730     MOVE CO-OV90                TO  OVER90O.
  5731
  5732     IF CO-ACCOUNT-TYPE
  5733        MOVE CO-YTD-COM          TO YTDCOMO
  5734     ELSE
  5735        MOVE CO-YTD-OV           TO YTDCOMO
  5736     END-IF
  5737
  5738     MOVE AL-SADOF               TO  PFK9A.
  5739     MOVE 'PREV. END-OF-MONTH TOTALS DISPLAYED'
  5740                                 TO  EMI-MESSAGE-AREA (1).
  5741
  5742     GO TO 5090-CONTD.
  5743
  5744 5070-BUILD-CURRENT-TOTALS.
  5745     IF CO-CURRENT-LAST-STMT-DT = SPACES
  5746         MOVE SPACES             TO  LSTMDTO
  5747         GO TO 5070-LST-STMT-OK.
  5748
  5749     MOVE CO-CURRENT-LAST-STMT-MONTH
  5750                                 TO WS-YMD-MM.
  5751     MOVE CO-CURRENT-LAST-STMT-DAY
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 114
* EL652.cbl
  5752                                 TO  WS-YMD-DD.
  5753     MOVE CO-CURRENT-LAST-STMT-YEAR
  5754                                 TO  WS-YMD-YY.
  5755
  5756     IF WS-YMD-DATE-NUM NUMERIC
  5757         NEXT SENTENCE
  5758     ELSE
  5759         MOVE SPACES             TO  LSTMDTO
  5760         GO TO 5070-LST-STMT-OK.
  5761
  5762     MOVE WS-YMD-DATE            TO  DC-GREG-DATE-1-YMD.
  5763     MOVE '3'                    TO  DC-OPTION-CODE.
  5764
  5765     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  5766
  5767     IF NO-CONVERSION-ERROR
  5768         NEXT SENTENCE
  5769     ELSE
  5770         MOVE SPACES             TO  LSTMDTO
  5771         GO TO 5070-LST-STMT-OK.
  5772
  5773     MOVE CO-CURRENT-LAST-STMT-MONTH
  5774                                 TO  WS-DMDY8-MM.
  5775     MOVE CO-CURRENT-LAST-STMT-DAY
  5776                                 TO  WS-DMDY8-DD.
  5777     MOVE CO-CURRENT-LAST-STMT-YEAR
  5778                                 TO  WS-DMDY8-YY.
  5779     MOVE '/'                    TO  WS-DMDY8-SL1
  5780                                     WS-DMDY8-SL2.
  5781     MOVE WS-DATE-MDY-8          TO  LSTMDTO.
  5782
  5783 5070-LST-STMT-OK.
  5784     MOVE CO-CURRENT-BAL-FWD     TO  BALFWDO.
  5785     MOVE CO-CURRENT-CUR-COM     TO  CURCOMO.
  5786     MOVE CO-CURRENT-CUR-PMT     TO  CURPMTO.
  5787     MOVE CO-CURRENT-CUR-CHG     TO  CURCHGO.
  5788     MOVE CO-CURRENT-END-BAL     TO  ENDBALO
  5789                                     PI-ERC-END-BAL.
  5790     MOVE CO-CURRENT-CUR         TO  CURRENTO.
  5791     MOVE CO-CURRENT-OV30        TO  OVER30O.
  5792     MOVE CO-CURRENT-OV60        TO  OVER60O.
  5793     MOVE CO-CURRENT-OV90        TO  OVER90O.
  5794
  5795     IF CO-ACCOUNT-TYPE
  5796        MOVE CO-CURRENT-YTD-COM  TO YTDCOMO
  5797     ELSE
  5798        MOVE CO-CURRENT-YTD-OV   TO YTDCOMO
  5799     END-IF
  5800     .
  5801 5090-CONTD.
  5802
  5803     MOVE CO-LAST-MAINT-USER     TO LSTUSRO.
  5804
  5805     MOVE ' '              TO DC-OPTION-CODE.
  5806     MOVE CO-LAST-MAINT-DT TO DC-BIN-DATE-1.
  5807
  5808     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  5809
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 115
* EL652.cbl
  5810     MOVE DC-GREG-DATE-1-EDIT    TO LSTDTEO.
  5811
  5812     IF CO-LAST-MAINT-HHMMSS NUMERIC
  5813         MOVE CO-LAST-MAINT-HHMMSS
  5814                                 TO TIME-IN
  5815         MOVE TIME-OUT           TO LSTTIMEO
  5816     ELSE
  5817         MOVE ZEROS              TO TIME-IN
  5818         MOVE TIME-OUT           TO LSTTIMEO.
  5819
  5820     IF PI-COMPANY-ID =  'FLI'  OR  'FLU'  OR  'UCL'
  5821         MOVE AL-SANOF           TO  FLITYPEA
  5822         MOVE AL-UANON           TO  FLITYPA
  5823     ELSE
  5824         MOVE AL-SANON           TO  FLITYPA.
  5825
  5826     IF PI-COMPANY-ID = 'NCL'
  5827         IF CO-ACCOUNT-TYPE
  5828             MOVE AL-SANOF       TO  RPTCD2A
  5829         ELSE
  5830             IF CO-COMPANY-TYPE
  5831                MOVE AL-SANOF    TO  RPTCD2A
  5832                MOVE AL-SADOF    TO  RPTCDDA.
  5833
  5834     IF PI-COMPANY-ID = 'NCL'
  5835         IF CO-GEN-AGENT-TYPE
  5836            MOVE AL-UANON       TO  RPTCD2A.
  5837
  5838     IF PI-COMPANY-ID = 'NCL'
  5839         MOVE AL-UANON           TO  LETRCDA
  5840     ELSE
  5841         MOVE AL-SANOF           TO  LETRCDA
  5842         MOVE AL-SADOF           TO  LETDESCA.
  5843
  5844     IF PI-COMPANY-ID  NOT =  'DDB' AND 'ANT' AND 'ASL' AND
  5845                              'AN1' AND 'TFS'
  5846         MOVE AL-SANOF           TO  BALCDA
  5847         MOVE AL-SADOF           TO  BALPRTA.
  5848
  5849     IF PI-AR-PROCESSING
  5850         IF CO-ACCOUNT-TYPE
  5851             MOVE AL-SANOF       TO  SCDESCA
  5852             MOVE AL-SANOF       TO  NGDESCA
  5853             MOVE AL-UANON       TO  NETGRSA
  5854             IF PI-COMPANY-ID  =  'DDB' OR 'ANT' OR 'ASL' OR
  5855                                  'AN1' OR 'TFS'
  5856                 MOVE AL-SANOF   TO  BALPRTA
  5857                 MOVE AL-UANON   TO  BALCDA.
  5858
  5859     IF PI-AR-PROCESSING
  5860             MOVE AL-SANOF       TO  BALDESCA
  5861                                     CKDESCA
  5862             MOVE AL-UANON       TO  ARBALA
  5863                                     CKPULLA.
  5864
  5865
  5866     MOVE AL-UANON               TO  MAILNAMA
  5867                                     ACCTNAMA
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 116
* EL652.cbl
  5868                                     ADDR1A
  5869                                     ADDR2A
  5870                                     CITYA
  5871                                     STATEA
  5872                                     SSNA
  5873                                     ZIPCODEA
  5874                                     BILLPRTA
  5875                                     PNT1099A
  5876                                     CARBALA.
  5877
  5878     IF NOT SHOW-SAVE-TOTALS
  5879         IF PI-PROCESSOR-ID = 'LGXX'
  5880             GO TO 5100-CONTD.
  5881
  5882     MOVE AL-SANOF               TO  BALFWDA
  5883                                     CURCOMA
  5884                                     CURPMTA
  5885                                     CURCHGA
  5886                                     ENDBALA.
  5887
  5888 5100-CONTD.
  5889     IF CO-TELEPHONE NUMERIC
  5890         MOVE CO-TELEPHONE       TO  WS-PHONE-IN
  5891                                     PI-SAVE-PHONE
  5892         MOVE WSPI-AREA          TO  WSPO-AREA
  5893         MOVE WSPI-PFX           TO  WSPO-PFX
  5894         MOVE WSPI-SFX           TO  WSPO-SFX
  5895         MOVE WS-PHONE-OUT       TO  PHONEO
  5896         MOVE AL-UNNON           TO  PHONEA
  5897     ELSE
  5898         MOVE SPACES             TO  PHONEO.
  5899
  5900     IF CO-FAXNO NUMERIC
  5901         MOVE CO-FAXNO           TO  WS-PHONE-IN
  5902                                     PI-SAVE-FAXNO
  5903         MOVE WSPI-AREA          TO  WSPO-AREA
  5904         MOVE WSPI-PFX           TO  WSPO-PFX
  5905         MOVE WSPI-SFX           TO  WSPO-SFX
  5906         MOVE WS-PHONE-OUT       TO  FAXNOO
  5907         MOVE AL-UNNON           TO  FAXNOA
  5908     ELSE
  5909         MOVE SPACES             TO  FAXNOO.
  5910
  5911     MOVE 'S'                    TO  MAINTYPO
  5912                                     PI-CHECK-MAINT-TYPE.
  5913     MOVE AL-UANON               TO  MAINTYPA.
  5914     MOVE -1                     TO  MAINTYPL.
  5915
  5916     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 117
* EL652.cbl
  5918 6000-CHECK-FOR-UPDATE.
  5919     IF CHANGE-FUNCTION
  5920         GO TO 6010-CONT.
  5921
  5922     IF CARRIERL > ZERO
  5923         MOVE CARRIERI           TO  CO-CARRIER.
  5924
  5925     IF GROUPL > ZERO
  5926         MOVE GROUPI             TO  CO-GROUPING
  5927     ELSE
  5928         MOVE LOW-VALUES         TO  CO-GROUPING.
  5929
  5930     IF FINRESPL > ZERO
  5931         MOVE FINRESPI           TO  CO-RESP-NO
  5932     ELSE
  5933         MOVE LOW-VALUES         TO  CO-RESP-NO.
  5934
  5935     IF ACCTNOL > ZERO
  5936         MOVE ACCTNOI            TO  CO-ACCOUNT
  5937     ELSE
  5938         MOVE LOW-VALUES         TO  CO-ACCOUNT.
  5939
  5940     IF TYPEL > ZERO
  5941         MOVE TYPEI              TO  CO-TYPE.
  5942
  5943 6010-CONT.
  5944     IF PI-PROCESSOR-ID = 'LGXX'
  5945         IF LSTMDTL > ZERO
  5946             MOVE WS-YMD-YY      TO  CO-CURRENT-LAST-STMT-YEAR
  5947                                     WS-DMDY8-YY
  5948             MOVE WS-YMD-MM      TO  CO-CURRENT-LAST-STMT-MONTH
  5949                                     WS-DMDY8-MM
  5950             MOVE WS-YMD-DD      TO  CO-CURRENT-LAST-STMT-DAY
  5951                                     WS-DMDY8-DD
  5952             MOVE '/'            TO  WS-DMDY8-SL1  WS-DMDY8-SL2
  5953             MOVE WS-DATE-MDY-8  TO  LSTMDTO.
  5954
  5955     IF PI-AR-PROCESSING
  5956         IF TYPEI = 'A'
  5957             IF SUMMNOL > ZERO
  5958                 MOVE SUMMNOI   TO  CO-AR-SUMMARY-CODE
  5959                                    WS-SAVE-SUMMARY.
  5960
  5961     IF PI-AR-PROCESSING
  5962         IF TYPEI = 'A'
  5963             IF NETGRSL > ZERO
  5964                 MOVE NETGRSI   TO  CO-AR-REPORTING
  5965             ELSE
  5966                 IF ADD-FUNCTION
  5967                     MOVE 'G'   TO  CO-AR-REPORTING.
  5968
  5969     IF PI-AR-PROCESSING
  5970         IF ARBALL > ZERO
  5971             MOVE ARBALI        TO  CO-AR-BAL-LEVEL
  5972         ELSE
  5973             IF ADD-FUNCTION
  5974                 MOVE '1'       TO  CO-AR-BAL-LEVEL.
  5975
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 118
* EL652.cbl
  5976     IF PI-AR-PROCESSING
  5977         IF CKPULLL > ZERO
  5978             MOVE CKPULLI       TO  CO-AR-PULL-CHECK
  5979         ELSE
  5980             IF ADD-FUNCTION
  5981                 MOVE 'Y'       TO  CO-AR-PULL-CHECK.
  5982
  5983     IF MAILNAML > ZERO
  5984         MOVE MAILNAMI           TO  CO-MAIL-NAME
  5985                                     WS-SAVE-NAME.
  5986
  5987     IF ACCTNAML > ZERO
  5988         MOVE ACCTNAMI           TO  CO-ACCT-NAME.
  5989
  5990     IF ADDR1L > ZERO
  5991         MOVE ADDR1I             TO  CO-ADDR-1.
  5992
  5993     IF ADDR2L > ZERO
  5994         MOVE ADDR2I             TO  CO-ADDR-2.
  5995
  5996     IF CITYL > ZERO
  5997         MOVE CITYI              TO  CO-ADDR-CITY.
  5998     IF STATEL > ZERO
  5999         MOVE STATEI             TO  CO-ADDR-STATE.
  6000
  6001     IF ZIPCODEL NOT > ZERO
  6002         GO TO 6015-CONT.
  6003
  6004     MOVE ZIPCODEI               TO  WS-ZIP-CODE.
  6005
  6006     IF WS-CANADIAN-ZIP
  6007         IF WS-ZIP-4 = SPACE  OR  '-'
  6008             MOVE WS-ZIP-CAN-2-POST1     TO  CO-CAN-POSTAL-1
  6009             MOVE WS-ZIP-CAN-2-POST2     TO  CO-CAN-POSTAL-2
  6010         ELSE
  6011             MOVE WS-ZIP-CAN-1-POST1     TO  CO-CAN-POSTAL-1
  6012             MOVE WS-ZIP-CAN-1-POST2     TO  CO-CAN-POSTAL-2
  6013     ELSE
  6014         IF WS-ZIP-6 = SPACE  OR  '-'
  6015             MOVE WS-ZIP-AM-2-CODE       TO  CO-ZIP-PRIME
  6016             MOVE WS-ZIP-AM-2-PLUS4      TO  CO-ZIP-PLUS4
  6017         ELSE
  6018             MOVE WS-ZIP-AM-1-CODE       TO  CO-ZIP-PRIME
  6019             MOVE WS-ZIP-AM-1-PLUS4      TO  CO-ZIP-PLUS4.
  6020
  6021 6015-CONT.
  6022     IF BILLPRTL > ZERO
  6023         IF BILLPRTI = ' ' OR 'B' OR 'R' OR 'T' OR 'S'
  6024            OR 'O' OR 'E' OR 'C'
  6025             MOVE  BILLPRTI          TO  CO-BILL-SW
  6026         ELSE
  6027             MOVE SPACES         TO  CO-BILL-SW
  6028                                     BILLPRTO
  6029         END-IF
  6030     END-IF.
  6031     IF SPPDDL > ZERO
  6032        IF SPPDDI = 'Y'
  6033           MOVE '1'              TO CO-COMP-TYPE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 119
* EL652.cbl
  6034        ELSE
  6035           MOVE ' '              TO CO-COMP-TYPE
  6036        END-IF
  6037     END-IF
  6038     IF PNT1099L > ZERO
  6039         IF PNT1099I = 'N' OR 'Y'
  6040             MOVE  PNT1099I      TO  CO-CSO-1099
  6041         ELSE
  6042             MOVE 'N'            TO  CO-CSO-1099
  6043                                     PNT1099O
  6044         END-IF
  6045     END-IF.
  6046
  6047     IF CSRL > ZERO
  6048         MOVE CSRI               TO  CO-CSR-CODE.
  6049
  6050     IF SSNL > ZERO
  6051         MOVE SSNI               TO  CO-SOC-SEC.
  6052
  6053     IF PHONEL > ZERO
  6054         MOVE PI-SAVE-PHONE      TO  CO-TELEPHONE
  6055         MOVE ZEROS              TO  PI-SAVE-PHONE.
  6056
  6057     IF FAXNOL > ZERO
  6058         MOVE PI-SAVE-FAXNO      TO  CO-FAXNO
  6059         MOVE ZEROS              TO  PI-SAVE-FAXNO.
  6060
  6061     IF PCONTL > ZEROS
  6062        MOVE PCONTI              TO CO-CONTROL-NAME
  6063     END-IF
  6064     IF CLPSTL > ZERO
  6065         MOVE CLPSTI             TO  CO-CLP-STATE
  6066     END-IF
  6067     IF REFEL > ZERO
  6068        MOVE REFEI               TO CO-SPP-REFUND-EDIT
  6069     END-IF
  6070     IF MAXFEEL > ZERO
  6071         MOVE MAXFEEI            TO  CO-MAX-BANK-FEE
  6072*        IF ADD-FUNCTION
  6073*           MOVE CO-MAX-BANK-FEE TO  CO-BANK-FEE
  6074*        ELSE
  6075*           IF CHANGE-FUNCTION
  6076*              PERFORM 6100-EDIT-ERAGTC
  6077*                                THRU 6100-EXIT
  6078*              IF WS-TOT-FEES > CO-MAX-BANK-FEE
  6079*                 MOVE ER-2717   TO EMI-ERROR
  6080*                 MOVE -1        TO MAXFEEL
  6081*                 MOVE AL-UABON  TO MAXFEEA
  6082*                 PERFORM 9900-ERROR-FORMAT
  6083*                                THRU 9900-EXIT
  6084*              ELSE
  6085*                 COMPUTE CO-BANK-FEE = CO-MAX-BANK-FEE
  6086*                    - WS-TOT-FEES
  6087*              END-IF
  6088*           END-IF
  6089*        END-IF
  6090     END-IF
  6091
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 120
* EL652.cbl
  6092     IF MAXLFL > ZERO
  6093         MOVE MAXLFI             TO CO-MAX-BANK-FEE-LEASE
  6094     END-IF
  6095     IF CARBALL > ZERO
  6096         MOVE CARBALI            TO  CO-BALANCE-CONTROL
  6097         GO TO 6020-CONT.
  6098
  6099     IF NOT PI-AR-PROCESSING
  6100         GO TO 6020-CONT.
  6101
  6102     IF ADD-FUNCTION
  6103        AND (TYPEI = 'G' OR 'B')
  6104         MOVE 'Y'                TO  CO-BALANCE-CONTROL
  6105         GO TO 6020-CONT.
  6106
  6107     IF ADD-FUNCTION
  6108         IF TYPEI = 'A'
  6109             IF FINRESPI = ACCTNOI
  6110                 MOVE 'Y'        TO  CO-BALANCE-CONTROL
  6111             ELSE
  6112                 MOVE 'N'        TO  CO-BALANCE-CONTROL.
  6113
  6114     IF ADD-FUNCTION AND TYPEI = 'C'
  6115         MOVE 'N'                TO  CO-BALANCE-CONTROL.
  6116
  6117 6020-CONT.
  6118     IF BALFWDL > ZERO
  6119         MOVE WS-SAVE-BALFWD     TO  CO-CURRENT-BAL-FWD.
  6120
  6121     IF CURCOML > ZERO
  6122         MOVE WS-SAVE-CURCOM     TO  CO-CURRENT-CUR-COM.
  6123
  6124     IF CURCHGL > ZERO
  6125         MOVE WS-SAVE-CURCHG     TO  CO-CURRENT-CUR-CHG.
  6126
  6127     IF CURPMTL > ZERO
  6128         MOVE WS-SAVE-CURPMT     TO  CO-CURRENT-CUR-PMT.
  6129
  6130     IF ENDBALL > ZERO
  6131         MOVE WS-SAVE-ENDBAL     TO  CO-CURRENT-END-BAL.
  6132
  6133*    IF YTDCOML > ZERO
  6134*       IF CO-ACCOUNT-TYPE
  6135*          MOVE WS-SAVE-YTDCOM   TO CO-CURRENT-YTD-COM
  6136*       ELSE
  6137*          MOVE WS-SAVE-YTDCOM   TO CO-CURRENT-YTD-OV
  6138*       END-IF
  6139*    END-IF
  6140     .
  6141 6099-EXIT.
  6142     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 121
* EL652.cbl
  6144 6100-EDIT-ERAGTC.
  6145
  6146* EXEC CICS READ
  6147*         SET     (ADDRESS OF AGENT-COMMISSIONS)
  6148*         DATASET ('ERAGTC')
  6149*         RIDFLD  (PI-ERCOMP-KEY)
  6150*         RESP    (WS-RESPONSE)
  6151*    END-EXEC
  6152     MOVE 'ERAGTC' TO DFHEIV1
  6153*    MOVE '&"S        E          (  N#00005825' TO DFHEIV0
  6154     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6155     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6156     MOVE X'204E233030303035383235' TO DFHEIV0(25:11)
  6157     CALL 'kxdfhei1' USING DFHEIV0,
  6158           DFHEIV1,
  6159           DFHEIV20,
  6160           DFHEIV99,
  6161           PI-ERCOMP-KEY,
  6162           DFHEIV99,
  6163           DFHEIV99,
  6164           DFHEIV99
  6165     SET ADDRESS OF AGENT-COMMISSIONS TO
  6166         DFHEIV20
  6167     MOVE EIBRESP  TO WS-RESPONSE
  6168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6169     MOVE +0                     TO WS-TOT-FEES
  6170     IF RESP-NORMAL
  6171        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6172           (S1 > +10)
  6173           COMPUTE WS-TOT-FEES = WS-TOT-FEES
  6174              + AG-SPP-FEES (S1)
  6175        END-PERFORM
  6176     END-IF
  6177     .
  6178 6100-EXIT.
  6179     EXIT.
  6180 6500-UPDATE-RQST.
  6181
  6182     MOVE LOW-VALUES             TO  ERRQST-KEY-3.
  6183     MOVE PI-ERC-COMPANY-CD      TO  RQST-COMP-ID.
  6184     MOVE PI-ERC-CARRIER         TO  RQST-CARRIER.
  6185     MOVE PI-ERC-GROUP           TO  RQST-GROUP.
  6186     MOVE PI-ERC-RESP            TO  RQST-FIN-RESP.
  6187     MOVE PI-ERC-ACCT            TO  RQST-ACCT-AGENT.
  6188
  6189
  6190* EXEC CICS HANDLE CONDITION
  6191*        ENDFILE  (6550-END-BROWSE)
  6192*        NOTFND   (6550-END-BROWSE)
  6193*    END-EXEC.
  6194*    MOVE '"$''I                  ! * #00005851' TO DFHEIV0
  6195     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6197     MOVE X'2A20233030303035383531' TO DFHEIV0(25:11)
  6198     CALL 'kxdfhei1' USING DFHEIV0
  6199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6200
  6201
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 122
* EL652.cbl
  6202
  6203* EXEC CICS STARTBR
  6204*        DATASET  (RQST-FILE-ID-3)
  6205*        RIDFLD   (ERRQST-KEY-3)
  6206*    END-EXEC.
  6207     MOVE 0
  6208       TO DFHEIV11
  6209*    MOVE '&,         G          &   #00005856' TO DFHEIV0
  6210     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6211     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6212     MOVE X'2020233030303035383536' TO DFHEIV0(25:11)
  6213     CALL 'kxdfhei1' USING DFHEIV0,
  6214           RQST-FILE-ID-3,
  6215           ERRQST-KEY-3,
  6216           DFHEIV99,
  6217           DFHEIV11,
  6218           DFHEIV99
  6219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6220
  6221
  6222 6525-READ-LOOP.
  6223
  6224* EXEC CICS HANDLE CONDITION
  6225*        ENDFILE  (6550-END-BROWSE)
  6226*        NOTFND   (6550-END-BROWSE)
  6227*    END-EXEC.
  6228*    MOVE '"$''I                  ! + #00005862' TO DFHEIV0
  6229     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6230     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6231     MOVE X'2B20233030303035383632' TO DFHEIV0(25:11)
  6232     CALL 'kxdfhei1' USING DFHEIV0
  6233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6234
  6235
  6236
  6237* EXEC CICS READNEXT
  6238*        DATASET  (RQST-FILE-ID-3)
  6239*        SET      (ADDRESS OF AR-REQUEST-RECORD)
  6240*        RIDFLD   (ERRQST-KEY-3)
  6241*    END-EXEC.
  6242     MOVE 0
  6243       TO DFHEIV11
  6244*    MOVE '&.S                   )   #00005867' TO DFHEIV0
  6245     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6246     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6247     MOVE X'2020233030303035383637' TO DFHEIV0(25:11)
  6248     CALL 'kxdfhei1' USING DFHEIV0,
  6249           RQST-FILE-ID-3,
  6250           DFHEIV20,
  6251           DFHEIV99,
  6252           ERRQST-KEY-3,
  6253           DFHEIV99,
  6254           DFHEIV11,
  6255           DFHEIV99,
  6256           DFHEIV99
  6257     SET ADDRESS OF AR-REQUEST-RECORD TO
  6258         DFHEIV20
  6259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 123
* EL652.cbl
  6260
  6261
  6262     IF RQ-CONTROL-BY-FIN-RESP = WS-SAVE-RQST
  6263         GO TO 6525-READ-LOOP.
  6264
  6265     IF RQ-COMPANY-CD-A2 =  PI-ERC-COMPANY-CD AND
  6266        RQ-CARRIER-A2    =  PI-ERC-CARRIER    AND
  6267        RQ-GROUPING-A2   =  PI-ERC-GROUP      AND
  6268        RQ-FIN-RESP-A2   =  PI-ERC-RESP       AND
  6269        RQ-ACCT-AGENT-A2 =  PI-ERC-ACCT
  6270         NEXT SENTENCE
  6271     ELSE
  6272         GO TO 6550-END-BROWSE.
  6273
  6274     IF WS-SUMM-FOR-RQST = RQ-SUMMARY-CODE
  6275         GO TO 6525-READ-LOOP.
  6276
  6277     MOVE RQ-CONTROL-BY-FIN-RESP TO  WS-SAVE-RQST.
  6278     MOVE RQ-CONTROL-PRIMARY     TO  ERRQST-KEY.
  6279
  6280
  6281* EXEC CICS ENDBR
  6282*        DATASET  (RQST-FILE-ID-3)
  6283*    END-EXEC.
  6284     MOVE 0
  6285       TO DFHEIV11
  6286*    MOVE '&2                    $   #00005891' TO DFHEIV0
  6287     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6288     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6289     MOVE X'2020233030303035383931' TO DFHEIV0(25:11)
  6290     CALL 'kxdfhei1' USING DFHEIV0,
  6291           RQST-FILE-ID-3,
  6292           DFHEIV11,
  6293           DFHEIV99
  6294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6295
  6296
  6297
  6298* EXEC CICS HANDLE CONDITION
  6299*        ENDFILE  (6599-EXIT)
  6300*        NOTFND   (6599-EXIT)
  6301*    END-EXEC.
  6302*    MOVE '"$''I                  ! , #00005895' TO DFHEIV0
  6303     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6304     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6305     MOVE X'2C20233030303035383935' TO DFHEIV0(25:11)
  6306     CALL 'kxdfhei1' USING DFHEIV0
  6307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6308
  6309
  6310
  6311* EXEC CICS READ
  6312*        DATASET  (RQST-FILE-ID)
  6313*        SET      (ADDRESS OF AR-REQUEST-RECORD)
  6314*        RIDFLD   (ERRQST-KEY)
  6315*        UPDATE
  6316*    END-EXEC.
  6317*    MOVE '&"S        EU         (   #00005900' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 124
* EL652.cbl
  6318     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6319     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6320     MOVE X'2020233030303035393030' TO DFHEIV0(25:11)
  6321     CALL 'kxdfhei1' USING DFHEIV0,
  6322           RQST-FILE-ID,
  6323           DFHEIV20,
  6324           DFHEIV99,
  6325           ERRQST-KEY,
  6326           DFHEIV99,
  6327           DFHEIV99,
  6328           DFHEIV99
  6329     SET ADDRESS OF AR-REQUEST-RECORD TO
  6330         DFHEIV20
  6331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6332
  6333
  6334     MOVE WS-SUMM-FOR-RQST       TO  RQ-SUMMARY-CODE.
  6335
  6336
  6337* EXEC CICS REWRITE
  6338*        DATASET  (RQST-FILE-ID)
  6339*        FROM     (AR-REQUEST-RECORD)
  6340*    END-EXEC.
  6341     MOVE LENGTH OF
  6342      AR-REQUEST-RECORD
  6343       TO DFHEIV11
  6344*    MOVE '&& L                  %   #00005909' TO DFHEIV0
  6345     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6346     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6347     MOVE X'2020233030303035393039' TO DFHEIV0(25:11)
  6348     CALL 'kxdfhei1' USING DFHEIV0,
  6349           RQST-FILE-ID,
  6350           AR-REQUEST-RECORD,
  6351           DFHEIV11,
  6352           DFHEIV99
  6353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6354
  6355
  6356     GO TO 6500-UPDATE-RQST.
  6357
  6358 6550-END-BROWSE.
  6359
  6360
  6361* EXEC CICS ENDBR
  6362*        DATASET  (RQST-FILE-ID-3)
  6363*    END-EXEC.
  6364     MOVE 0
  6365       TO DFHEIV11
  6366*    MOVE '&2                    $   #00005918' TO DFHEIV0
  6367     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6368     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6369     MOVE X'2020233030303035393138' TO DFHEIV0(25:11)
  6370     CALL 'kxdfhei1' USING DFHEIV0,
  6371           RQST-FILE-ID-3,
  6372           DFHEIV11,
  6373           DFHEIV99
  6374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6375
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 125
* EL652.cbl
  6376
  6377 6599-EXIT.
  6378     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 126
* EL652.cbl
  6380
  6381 7000-EDIT.
  6382     MOVE LSTMDTI                TO  WS-DATE-MDY-8.
  6383
  6384     IF LSTMDTL > ZERO
  6385         NEXT SENTENCE
  6386     ELSE
  6387         GO TO 7100-EDIT-CONTD.
  6388
  6389     IF LSTMDTI = SPACES
  6390         GO TO 7100-EDIT-CONTD.
  6391
  6392     IF WS-DMDY8-SL1 = '/'  AND
  6393        WS-DMDY8-SL2 = '/'
  6394         MOVE WS-DMDY8-MM        TO  WS-YMD-MM
  6395         MOVE WS-DMDY8-DD        TO  WS-YMD-DD
  6396         MOVE WS-DMDY8-YY        TO  WS-YMD-YY
  6397     ELSE
  6398         MOVE WS-DMDY6-MM        TO  WS-YMD-MM
  6399         MOVE WS-DMDY6-DD        TO  WS-YMD-DD
  6400         MOVE WS-DMDY6-YY        TO  WS-YMD-YY.
  6401
  6402     MOVE WS-YMD-DATE            TO  DC-GREG-DATE-1-YMD.
  6403     MOVE '3'                    TO  DC-OPTION-CODE.
  6404
  6405     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  6406
  6407     IF NO-CONVERSION-ERROR
  6408         NEXT SENTENCE
  6409     ELSE
  6410         GO TO 7090-DATE-ERROR.
  6411
  6412     IF DC-BIN-DATE-1 > PI-CR-MONTH-END-DT
  6413         NEXT SENTENCE
  6414     ELSE
  6415         GO TO 7100-EDIT-CONTD.
  6416
  6417 7090-DATE-ERROR.
  6418     MOVE -1                     TO  LSTMDTL.
  6419     MOVE AL-UABON               TO  LSTMDTA.
  6420     MOVE ER-0314                TO  EMI-ERROR.
  6421
  6422     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6423
  6424 7100-EDIT-CONTD.
  6425
  6426     IF CSRL > ZEROS
  6427         MOVE AL-UANON           TO  CSRA
  6428     END-IF
  6429
  6430     IF MAILNAML > ZERO
  6431         MOVE AL-UANON           TO  MAILNAMA.
  6432
  6433     IF SSNL > ZERO
  6434         MOVE AL-UANON           TO  SSNA.
  6435
  6436     IF ACCTNAML > ZERO
  6437         MOVE AL-UANON           TO  ACCTNAMA
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 127
* EL652.cbl
  6438     ELSE
  6439         IF ADD-FUNCTION
  6440             MOVE -1             TO  ACCTNAML
  6441             MOVE AL-UABON       TO  ACCTNAMA
  6442             MOVE ER-2045        TO  EMI-ERROR
  6443             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6444
  6445     IF PHONEL > ZERO
  6446         MOVE PHONEI               TO  DEEDIT-FIELD
  6447         PERFORM 7100-DEEDIT  THRU  7100-EXIT
  6448         IF DEEDIT-FIELD-V0 = ZEROS
  6449             MOVE SPACES               TO  PHONEO
  6450                                           PI-SAVE-PHONE
  6451         ELSE
  6452             IF (DEEDIT-FIELD-V0 > 9999999999
  6453               OR < 2000000000)
  6454                 MOVE -1               TO  PHONEL
  6455                 MOVE AL-UNBON         TO  PHONEA
  6456                 MOVE ER-2046          TO  EMI-ERROR
  6457                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6458             ELSE
  6459                 MOVE DEEDIT-FIELD-V0  TO  WS-PHONE-IN
  6460                                           PI-SAVE-PHONE-RED
  6461                 MOVE WSPI-AREA        TO  WSPO-AREA
  6462                 MOVE WSPI-PFX         TO  WSPO-PFX
  6463                 MOVE WSPI-SFX         TO  WSPO-SFX
  6464                 MOVE WS-PHONE-OUT     TO  PHONEO
  6465                 MOVE AL-UNNON         TO  PHONEA.
  6466
  6467     IF FAXNOL > ZERO
  6468         MOVE FAXNOI               TO  DEEDIT-FIELD
  6469         PERFORM 7100-DEEDIT  THRU  7100-EXIT
  6470         IF DEEDIT-FIELD-V0 = ZEROS
  6471             MOVE SPACES               TO  FAXNOO
  6472                                           PI-SAVE-FAXNO
  6473         ELSE
  6474             IF (DEEDIT-FIELD-V0 > 9999999999
  6475               OR < 2000000000)
  6476                 MOVE -1               TO  FAXNOL
  6477                 MOVE AL-UNBON         TO  FAXNOA
  6478                 MOVE ER-3055          TO  EMI-ERROR
  6479                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6480             ELSE
  6481                 MOVE DEEDIT-FIELD-V0  TO  WS-PHONE-IN
  6482                                           PI-SAVE-FAXNO-RED
  6483                 MOVE WSPI-AREA        TO  WSPO-AREA
  6484                 MOVE WSPI-PFX         TO  WSPO-PFX
  6485                 MOVE WSPI-SFX         TO  WSPO-SFX
  6486                 MOVE WS-PHONE-OUT     TO  FAXNOO
  6487                 MOVE AL-UNNON         TO  FAXNOA.
  6488
  6489     IF ADDR1L > ZERO
  6490         MOVE AL-UANON           TO  ADDR1A
  6491     ELSE
  6492         IF ADD-FUNCTION
  6493             MOVE -1             TO  ADDR1L
  6494             MOVE AL-UABON       TO  ADDR1A
  6495             MOVE ER-2047        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 128
* EL652.cbl
  6496             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6497
  6498     IF ADDR2L > ZERO
  6499         MOVE AL-UANON           TO  ADDR2A.
  6500
  6501     IF CARBALL > ZERO OR CHANGE-FUNCTION
  6502         MOVE CARBALI            TO  PI-CHECK-CARRY-BAL
  6503         IF VALID-CARRY-BAL
  6504             PERFORM 7010-EDIT-CARBAL  THRU  7010-EXIT
  6505         ELSE
  6506             MOVE -1             TO  CARBALL
  6507             MOVE AL-UABON       TO  CARBALA
  6508             MOVE ER-2048        TO  EMI-ERROR
  6509             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6510     ELSE
  6511         IF ADD-FUNCTION AND NOT PI-AR-PROCESSING
  6512             MOVE -1             TO  CARBALL
  6513             MOVE AL-UABON       TO  CARBALA
  6514             MOVE ER-2048        TO  EMI-ERROR
  6515             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6516
  6517     IF PI-AR-PROCESSING
  6518         IF TYPEI = 'A'
  6519            IF NETGRSL > ZERO OR CHANGE-FUNCTION
  6520                 IF NETGRSI = 'N' OR 'G'
  6521                    MOVE AL-UANON    TO  NETGRSA
  6522                 ELSE
  6523                     MOVE -1         TO  NETGRSL
  6524                     MOVE AL-UABON   TO  NETGRSA
  6525                     MOVE ER-3151    TO  EMI-ERROR
  6526                     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6527
  6528     IF CITYL > ZERO
  6529         MOVE AL-UANON           TO  CITYA
  6530     ELSE
  6531         IF ADD-FUNCTION
  6532             MOVE -1             TO  CITYL
  6533             MOVE AL-UABON       TO  CITYA
  6534             MOVE ER-2049        TO  EMI-ERROR
  6535             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6536
  6537     IF STATEL   > ZERO
  6538        MOVE AL-UANON            TO STATEA
  6539        MOVE SPACES              TO ELCNTL-KEY
  6540        MOVE PI-COMPANY-ID       TO CNTL-COMP-ID
  6541        MOVE '3'                 TO CNTL-REC-TYPE
  6542        MOVE STATEI              TO CNTL-ACCESS
  6543        MOVE +0                  TO CNTL-SEQ-NO
  6544
  6545* EXEC CICS READ
  6546*          DATASET   (CNTL-FILE-ID)
  6547*          SET       (ADDRESS OF CONTROL-FILE)
  6548*          RIDFLD    (ELCNTL-KEY)
  6549*          RESP      (WS-RESPONSE)
  6550*       END-EXEC
  6551*    MOVE '&"S        E          (  N#00006089' TO DFHEIV0
  6552     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6553     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 129
* EL652.cbl
  6554     MOVE X'204E233030303036303839' TO DFHEIV0(25:11)
  6555     CALL 'kxdfhei1' USING DFHEIV0,
  6556           CNTL-FILE-ID,
  6557           DFHEIV20,
  6558           DFHEIV99,
  6559           ELCNTL-KEY,
  6560           DFHEIV99,
  6561           DFHEIV99,
  6562           DFHEIV99
  6563     SET ADDRESS OF CONTROL-FILE TO
  6564         DFHEIV20
  6565     MOVE EIBRESP  TO WS-RESPONSE
  6566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6567        IF RESP-NORMAL
  6568           CONTINUE
  6569        ELSE
  6570           MOVE ER-2209          TO EMI-ERROR
  6571           MOVE -1               TO STATEL
  6572           MOVE AL-UABON         TO STATEA
  6573           PERFORM 9900-ERROR-FORMAT
  6574                                 THRU 9900-EXIT
  6575        END-IF
  6576     ELSE
  6577         IF ADD-FUNCTION
  6578             MOVE -1             TO  STATEL
  6579             MOVE AL-UABON       TO  STATEA
  6580             MOVE ER-2049        TO  EMI-ERROR
  6581             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6582
  6583     IF PI-AR-PROCESSING
  6584         IF ARBALL > ZERO OR CHANGE-FUNCTION
  6585             IF ARBALI = '1' OR '2' OR '3' OR '4'
  6586                 MOVE AL-UANON   TO  ARBALA
  6587             ELSE
  6588                 MOVE -1         TO  ARBALL
  6589                 MOVE AL-UABON   TO  ARBALA
  6590                 MOVE ER-3150    TO  EMI-ERROR
  6591                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6592
  6593     IF PI-AR-PROCESSING
  6594         IF CKPULLL > ZERO OR CHANGE-FUNCTION
  6595             IF CKPULLI = 'Y' OR 'N'
  6596                 MOVE AL-UANON   TO  CKPULLA
  6597             ELSE
  6598                 MOVE -1         TO  CKPULLL
  6599                 MOVE AL-UABON   TO  CKPULLA
  6600                 MOVE ER-3170    TO  EMI-ERROR
  6601                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6602
  6603     IF ZIPCODEL > ZERO
  6604         MOVE AL-UANON           TO  ZIPCODEA.
  6605
  6606     IF PI-COMPANY-ID = 'CID' OR 'AHL'
  6607        CONTINUE
  6608     ELSE
  6609        IF PI-ERC-TYPE = 'B'
  6610           IF CLPSTL > ZERO
  6611              PERFORM 4700-CHECK-STATE       THRU 4799-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 130
* EL652.cbl
  6612              IF CLPSTI = SPACES
  6613                 MOVE -1         TO  CLPSTL
  6614                 MOVE AL-UABON   TO  CLPSTA
  6615                 MOVE ER-0144    TO  EMI-ERROR
  6616                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6617              ELSE
  6618                 MOVE AL-UANON   TO  CLPSTA
  6619              END-IF
  6620           ELSE
  6621              IF ADD-FUNCTION
  6622                 MOVE -1         TO  CLPSTL
  6623                 MOVE AL-UABON   TO  CLPSTA
  6624                 MOVE ER-0144    TO  EMI-ERROR
  6625                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6626              END-IF
  6627           END-IF
  6628
  6629           IF MAXFEEL  > ZERO
  6630
  6631* EXEC CICS BIF
  6632*                  DEEDIT
  6633*                  FIELD   (MAXFEEI)
  6634*                  LENGTH  (6)
  6635*             END-EXEC
  6636     MOVE 6
  6637       TO DFHEIV11
  6638*    MOVE '@"L                   #   #00006158' TO DFHEIV0
  6639     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6640     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6641     MOVE X'2020233030303036313538' TO DFHEIV0(25:11)
  6642     CALL 'kxdfhei1' USING DFHEIV0,
  6643           MAXFEEI,
  6644           DFHEIV11
  6645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6646              IF MAXFEEI NUMERIC
  6647                 MOVE AL-UNNON   TO  MAXFEEA
  6648              ELSE
  6649                 MOVE -1         TO  MAXFEEL
  6650                 MOVE AL-UABON   TO  MAXFEEA
  6651                 MOVE ER-3261    TO  EMI-ERROR
  6652                 PERFORM 9900-ERROR-FORMAT
  6653                                 THRU  9900-EXIT
  6654              END-IF
  6655           ELSE
  6656              IF ADD-FUNCTION
  6657                 MOVE -1         TO  MAXFEEL
  6658                 MOVE AL-UABON   TO  MAXFEEA
  6659                 MOVE ER-3261    TO  EMI-ERROR
  6660                 PERFORM 9900-ERROR-FORMAT
  6661                                 THRU  9900-EXIT
  6662              END-IF
  6663           END-IF
  6664           IF MAXLFL  > ZERO
  6665
  6666* EXEC CICS BIF
  6667*                  DEEDIT
  6668*                  FIELD   (MAXLFI)
  6669*                  LENGTH  (6)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 131
* EL652.cbl
  6670*             END-EXEC
  6671     MOVE 6
  6672       TO DFHEIV11
  6673*    MOVE '@"L                   #   #00006182' TO DFHEIV0
  6674     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6675     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6676     MOVE X'2020233030303036313832' TO DFHEIV0(25:11)
  6677     CALL 'kxdfhei1' USING DFHEIV0,
  6678           MAXLFI,
  6679           DFHEIV11
  6680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6681              IF MAXLFI NUMERIC
  6682                 MOVE AL-UNNON   TO  MAXLFA
  6683              ELSE
  6684                 MOVE -1         TO  MAXLFL
  6685                 MOVE AL-UABON   TO  MAXLFA
  6686                 MOVE ER-3261    TO  EMI-ERROR
  6687                 PERFORM 9900-ERROR-FORMAT
  6688                                 THRU  9900-EXIT
  6689              END-IF
  6690           ELSE
  6691              IF ADD-FUNCTION
  6692                 MOVE -1         TO  MAXLFL
  6693                 MOVE AL-UABON   TO  MAXLFA
  6694                 MOVE ER-3261    TO  EMI-ERROR
  6695                 PERFORM 9900-ERROR-FORMAT
  6696                                 THRU  9900-EXIT
  6697              END-IF
  6698           END-IF
  6699           IF REFEL > ZERO
  6700              IF REFEI = ' ' OR 'R' OR 'N' OR 'B'
  6701                 MOVE AL-UANON   TO REFEA
  6702              ELSE
  6703                 MOVE -1         TO REFEL
  6704                 MOVE AL-UABON   TO REFEA
  6705                 MOVE ER-2790    TO EMI-ERROR
  6706                 PERFORM 9900-ERROR-FORMAT
  6707                                 THRU  9900-EXIT
  6708              END-IF
  6709           END-IF
  6710        END-IF
  6711     END-IF
  6712
  6713     IF BALFWDL > ZERO
  6714
  6715* EXEC CICS BIF
  6716*            DEEDIT
  6717*            FIELD   (BALFWDI)
  6718*            LENGTH  (13)
  6719*        END-EXEC
  6720     MOVE 13
  6721       TO DFHEIV11
  6722*    MOVE '@"L                   #   #00006220' TO DFHEIV0
  6723     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6724     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6725     MOVE X'2020233030303036323230' TO DFHEIV0(25:11)
  6726     CALL 'kxdfhei1' USING DFHEIV0,
  6727           BALFWDI,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 132
* EL652.cbl
  6728           DFHEIV11
  6729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6730         MOVE AL-UNNON           TO  BALFWDA
  6731         MOVE BALFWDI            TO  WS-SAVE-BALFWD.
  6732
  6733     IF CURCOML >        ZERO
  6734
  6735* EXEC CICS BIF
  6736*            DEEDIT
  6737*            FIELD   (CURCOMI)
  6738*            LENGTH  (13)
  6739*        END-EXEC
  6740     MOVE 13
  6741       TO DFHEIV11
  6742*    MOVE '@"L                   #   #00006229' TO DFHEIV0
  6743     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6744     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6745     MOVE X'2020233030303036323239' TO DFHEIV0(25:11)
  6746     CALL 'kxdfhei1' USING DFHEIV0,
  6747           CURCOMI,
  6748           DFHEIV11
  6749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6750         MOVE AL-UNNON           TO  CURCOMA
  6751         MOVE CURCOMI            TO  WS-SAVE-CURCOM.
  6752
  6753     IF CURCHGL > ZERO
  6754
  6755* EXEC CICS BIF
  6756*            DEEDIT
  6757*            FIELD   (CURCHGI)
  6758*            LENGTH  (13)
  6759*        END-EXEC
  6760     MOVE 13
  6761       TO DFHEIV11
  6762*    MOVE '@"L                   #   #00006238' TO DFHEIV0
  6763     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6764     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6765     MOVE X'2020233030303036323338' TO DFHEIV0(25:11)
  6766     CALL 'kxdfhei1' USING DFHEIV0,
  6767           CURCHGI,
  6768           DFHEIV11
  6769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6770         MOVE AL-UNNON           TO  CURCHGA
  6771         MOVE CURCHGI            TO  WS-SAVE-CURCHG.
  6772
  6773     IF CURPMTL > ZERO
  6774
  6775* EXEC CICS BIF
  6776*            DEEDIT
  6777*            FIELD   (CURPMTI)
  6778*            LENGTH  (13)
  6779*        END-EXEC
  6780     MOVE 13
  6781       TO DFHEIV11
  6782*    MOVE '@"L                   #   #00006247' TO DFHEIV0
  6783     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6784     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6785     MOVE X'2020233030303036323437' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 133
* EL652.cbl
  6786     CALL 'kxdfhei1' USING DFHEIV0,
  6787           CURPMTI,
  6788           DFHEIV11
  6789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6790         MOVE AL-UNNON           TO  CURPMTA
  6791         MOVE CURPMTI            TO  WS-SAVE-CURPMT.
  6792
  6793     IF ENDBALL > ZERO
  6794
  6795* EXEC CICS BIF
  6796*            DEEDIT
  6797*            FIELD   (ENDBALI)
  6798*            LENGTH  (13)
  6799*        END-EXEC
  6800     MOVE 13
  6801       TO DFHEIV11
  6802*    MOVE '@"L                   #   #00006256' TO DFHEIV0
  6803     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6804     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6805     MOVE X'2020233030303036323536' TO DFHEIV0(25:11)
  6806     CALL 'kxdfhei1' USING DFHEIV0,
  6807           ENDBALI,
  6808           DFHEIV11
  6809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6810         MOVE AL-UNNON           TO  ENDBALA
  6811         MOVE ENDBALI            TO  WS-SAVE-ENDBAL.
  6812
  6813*    IF YTDCOML > ZERO
  6814*       EXEC CICS BIF
  6815*            DEEDIT
  6816*            FIELD   (YTDCOMI)
  6817*            LENGTH  (13)
  6818*       END-EXEC
  6819*       MOVE AL-UNNON            TO YTDCOMA
  6820*       MOVE YTDCOMI             TO WS-SAVE-YTDCOM
  6821*    END-IF
  6822     .
  6823 7000-EXIT.
  6824     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 134
* EL652.cbl
  6826 7010-EDIT-CARBAL.
  6827     IF TYPEI = 'G' OR 'B'
  6828         IF CARBALI NOT = 'Y'
  6829             MOVE -1             TO  CARBALL
  6830             MOVE AL-UABON       TO  CARBALA
  6831             MOVE ER-2093        TO  EMI-ERROR
  6832             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6833             GO TO 7010-EXIT.
  6834
  6835     IF TYPEI = 'A'
  6836         IF FINRESPI = ACCTNOI
  6837             IF CARBALI NOT = 'Y'
  6838                 MOVE -1         TO  CARBALL
  6839                 MOVE AL-UABON   TO  CARBALA
  6840                 MOVE ER-2094    TO  EMI-ERROR
  6841                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6842                 GO TO 7010-EXIT.
  6843
  6844     IF PI-PROCESSOR-ID = 'E864'
  6845         NEXT SENTENCE
  6846     ELSE
  6847        IF TYPEI = 'A'
  6848           IF PI-AR-PROCESSING
  6849               IF FINRESPI NOT = ACCTNOI
  6850                    IF CARBALI = 'Y'
  6851                       MOVE -1             TO  CARBALL
  6852                       MOVE AL-UABON       TO  CARBALA
  6853                       MOVE ER-3174        TO  EMI-ERROR
  6854                       PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6855
  6856     IF TYPEI = 'C'
  6857         IF CARBALI NOT = 'N'
  6858             MOVE -1             TO  CARBALL
  6859             MOVE AL-UABON       TO  CARBALA
  6860             MOVE ER-2096        TO  EMI-ERROR
  6861             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6862             GO TO 7010-EXIT.
  6863
  6864     IF PI-PROCESSOR-ID = 'E864'
  6865         NEXT SENTENCE
  6866     ELSE
  6867        IF CHANGE-FUNCTION
  6868            IF PI-ERC-END-BAL NOT = ZERO
  6869                IF CARBALI = 'N'
  6870                    MOVE -1         TO  CARBALL
  6871                    MOVE AL-UABON   TO  CARBALA
  6872                    MOVE ER-2095    TO  EMI-ERROR
  6873                    PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6874                    GO TO 7010-EXIT.
  6875
  6876     MOVE AL-UANON               TO  CARBALA.
  6877
  6878 7010-EXIT.
  6879     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 135
* EL652.cbl
  6881 7050-READ-ERCOMP.
  6882     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  6883
  6884
  6885* EXEC CICS READ
  6886*        DATASET  (COMP-FILE-ID)
  6887*        SET      (ADDRESS OF COMPENSATION-MASTER)
  6888*        RIDFLD   (PI-ERCOMP-KEY)
  6889*    END-EXEC.
  6890*    MOVE '&"S        E          (   #00006335' TO DFHEIV0
  6891     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6892     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6893     MOVE X'2020233030303036333335' TO DFHEIV0(25:11)
  6894     CALL 'kxdfhei1' USING DFHEIV0,
  6895           COMP-FILE-ID,
  6896           DFHEIV20,
  6897           DFHEIV99,
  6898           PI-ERCOMP-KEY,
  6899           DFHEIV99,
  6900           DFHEIV99,
  6901           DFHEIV99
  6902     SET ADDRESS OF COMPENSATION-MASTER TO
  6903         DFHEIV20
  6904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6905
  6906
  6907     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  6908
  6909 7050-EXIT.
  6910     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 136
* EL652.cbl
  6912 7100-DEEDIT.
  6913
  6914* EXEC CICS BIF
  6915*        DEEDIT
  6916*        FIELD   (DEEDIT-FIELD)
  6917*        LENGTH  (15)
  6918*    END-EXEC.
  6919     MOVE 15
  6920       TO DFHEIV11
  6921*    MOVE '@"L                   #   #00006347' TO DFHEIV0
  6922     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6923     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6924     MOVE X'2020233030303036333437' TO DFHEIV0(25:11)
  6925     CALL 'kxdfhei1' USING DFHEIV0,
  6926           DEEDIT-FIELD,
  6927           DFHEIV11
  6928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6929
  6930
  6931 7100-EXIT.
  6932     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 137
* EL652.cbl
  6934 7150-ERCOMP-GETMAIN.
  6935
  6936* EXEC CICS GETMAIN
  6937*        SET      (ADDRESS OF COMPENSATION-MASTER)
  6938*        LENGTH   (ERCOMP-LENGTH)
  6939*        INITIMG  (GETMAIN-SPACE)
  6940*    END-EXEC.
  6941*    MOVE ',"IL                  $   #00006357' TO DFHEIV0
  6942     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6943     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6944     MOVE X'2020233030303036333537' TO DFHEIV0(25:11)
  6945     CALL 'kxdfhei1' USING DFHEIV0,
  6946           DFHEIV20,
  6947           ERCOMP-LENGTH,
  6948           GETMAIN-SPACE
  6949     SET ADDRESS OF COMPENSATION-MASTER TO
  6950         DFHEIV20
  6951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6952
  6953
  6954 7150-EXIT.
  6955     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 138
* EL652.cbl
  6957 7200-READ-ERCOMP-UPDATE.
  6958     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  6959
  6960
  6961* EXEC CICS READ
  6962*        DATASET  (COMP-FILE-ID)
  6963*        SET      (ADDRESS OF COMPENSATION-MASTER)
  6964*        RIDFLD   (PI-ERCOMP-KEY)
  6965*        UPDATE
  6966*    END-EXEC.
  6967*    MOVE '&"S        EU         (   #00006369' TO DFHEIV0
  6968     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6969     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6970     MOVE X'2020233030303036333639' TO DFHEIV0(25:11)
  6971     CALL 'kxdfhei1' USING DFHEIV0,
  6972           COMP-FILE-ID,
  6973           DFHEIV20,
  6974           DFHEIV99,
  6975           PI-ERCOMP-KEY,
  6976           DFHEIV99,
  6977           DFHEIV99,
  6978           DFHEIV99
  6979     SET ADDRESS OF COMPENSATION-MASTER TO
  6980         DFHEIV20
  6981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6982
  6983
  6984 7200-EXIT.
  6985     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 139
* EL652.cbl
  6987 7250-PAGE-FORWARD.
  6988     MOVE SPACES                 TO  PI-ERCOMP-EOF-SW.
  6989
  6990     IF MAINTYPL > ZERO
  6991         MOVE GROUPI             TO  PI-ERC-GROUP
  6992         MOVE CARRIERI           TO  PI-ERC-CARRIER
  6993         MOVE FINRESPI           TO  PI-ERC-RESP
  6994         MOVE ACCTNOI            TO  PI-ERC-ACCT
  6995         MOVE TYPEI              TO  PI-ERC-TYPE
  6996     ELSE
  6997         MOVE LOW-VALUES         TO  PI-ERCOMP-KEY
  6998         MOVE 'Y'                TO  PI-FIRST-TIME-SW.
  6999
  7000     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  7001     MOVE PI-ERCOMP-KEY          TO  WS-SAVE-KEY.
  7002
  7003
  7004* EXEC CICS HANDLE CONDITION
  7005*        ENDFILE  (7250-ENDFILE)
  7006*        NOTFND   (7250-ENDFILE)
  7007*        ERROR    (9990-ABEND)
  7008*    END-EXEC.
  7009*    MOVE '"$''I.                 ! - #00006395' TO DFHEIV0
  7010     MOVE X'222427492E20202020202020' TO DFHEIV0(1:12)
  7011     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7012     MOVE X'2D20233030303036333935' TO DFHEIV0(25:11)
  7013     CALL 'kxdfhei1' USING DFHEIV0
  7014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7015
  7016
  7017     PERFORM 7850-START-BROWSE  THRU  7850-EXIT.
  7018
  7019 7250-READ-NEXT.
  7020
  7021* EXEC CICS HANDLE CONDITION
  7022*        ENDFILE  (7250-ENDFILE)
  7023*        NOTFND   (7275-NOTFOUND)
  7024*    END-EXEC.
  7025*    MOVE '"$''I                  ! . #00006404' TO DFHEIV0
  7026     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7027     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7028     MOVE X'2E20233030303036343034' TO DFHEIV0(25:11)
  7029     CALL 'kxdfhei1' USING DFHEIV0
  7030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7031
  7032
  7033     PERFORM 7900-READNEXT  THRU  7900-EXIT.
  7034
  7035     IF PI-CARRIER-SECURITY > SPACES
  7036         IF PI-ERC-CARRIER = PI-CARRIER-SECURITY
  7037             NEXT SENTENCE
  7038         ELSE
  7039             GO TO 7250-READ-NEXT.
  7040
  7041     IF ERCOMP-EOF
  7042         IF FIRST-TIME
  7043             MOVE LOW-VALUES     TO  EL652AO
  7044             MOVE ER-0584        TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 140
* EL652.cbl
  7045             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7046             GO TO 8100-SEND-INITIAL-MAP
  7047         ELSE
  7048             MOVE LOW-VALUES     TO  EL652AO
  7049             MOVE ER-2067        TO  EMI-ERROR
  7050             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7051             PERFORM 7950-END-BROWSE  THRU  7950-EXIT
  7052             GO TO 7250-PAGE-FORWARD.
  7053
  7054     IF PI-ERCOMP-KEY = WS-SAVE-KEY
  7055         GO TO 7250-READ-NEXT.
  7056
  7057     MOVE CO-LAST-MAINT-USER     TO  PI-UPDATE-BY.
  7058     MOVE CO-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  7059     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  7060     MOVE LOW-VALUES             TO  EL652AO.
  7061     MOVE CO-CARRIER             TO  CARRIERO.
  7062     MOVE CO-GROUPING            TO  GROUPO.
  7063     MOVE CO-RESP-NO             TO  FINRESPO.
  7064     MOVE CO-ACCOUNT             TO  ACCTNOO.
  7065     MOVE CO-TYPE                TO  TYPEO.
  7066     MOVE AL-UANON               TO  CARRIERA
  7067                                     GROUPA
  7068                                     TYPEA
  7069                                     FINRESPA
  7070                                     ACCTNOA
  7071                                     MAINTYPA.
  7072     MOVE 'S'                    TO  MAINTYPO
  7073                                     PI-CHECK-MAINT-TYPE.
  7074
  7075     GO TO 5050-SET-UP-SCREEN.
  7076
  7077 7250-ENDFILE.
  7078     IF FIRST-TIME
  7079         MOVE LOW-VALUES         TO  EL652AO
  7080         MOVE ER-0584            TO  EMI-ERROR
  7081         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7082         GO TO 8100-SEND-INITIAL-MAP.
  7083
  7084     IF BROWSE-STARTED
  7085         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  7086
  7087     MOVE ER-2067                TO  EMI-ERROR.
  7088     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7089
  7090     MOVE LOW-VALUES             TO  EL652AO.
  7091
  7092     GO TO 7250-PAGE-FORWARD.
  7093
  7094 7275-NOTFOUND.
  7095     IF BROWSE-STARTED
  7096         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  7097
  7098     GO TO 8880-NOT-FOUND.
  7099
  7100 7299-EXIT.
  7101     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 141
* EL652.cbl
  7103 7300-PAGE-BACKWARD.
  7104     MOVE SPACES                 TO  PI-ERCOMP-EOF-SW.
  7105
  7106     IF MAINTYPL > ZERO
  7107         MOVE GROUPI             TO  PI-ERC-GROUP
  7108         MOVE CARRIERI           TO  PI-ERC-CARRIER
  7109         MOVE FINRESPI           TO  PI-ERC-RESP
  7110         MOVE ACCTNOI            TO  PI-ERC-ACCT
  7111         MOVE TYPEI              TO  PI-ERC-TYPE
  7112     ELSE
  7113         MOVE LOW-VALUES         TO  PI-ERCOMP-KEY.
  7114
  7115     MOVE PI-COMPANY-CD          TO  PI-ERC-COMPANY-CD.
  7116
  7117
  7118* EXEC CICS HANDLE CONDITION
  7119*        ENDFILE  (7375-ENDFILE)
  7120*        NOTFND   (7375-ENDFILE)
  7121*        ERROR    (9990-ABEND)
  7122*    END-EXEC.
  7123*    MOVE '"$''I.                 ! / #00006493' TO DFHEIV0
  7124     MOVE X'222427492E20202020202020' TO DFHEIV0(1:12)
  7125     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7126     MOVE X'2F20233030303036343933' TO DFHEIV0(25:11)
  7127     CALL 'kxdfhei1' USING DFHEIV0
  7128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7129
  7130
  7131     PERFORM 7850-START-BROWSE  THRU  7850-EXIT.
  7132
  7133     PERFORM 8050-READPREV  THRU  8050-EXIT.
  7134
  7135 7350-READ-PREV.
  7136
  7137* EXEC CICS HANDLE CONDITION
  7138*        ENDFILE  (7375-ENDFILE)
  7139*        NOTFND   (7275-NOTFOUND)
  7140*    END-EXEC.
  7141*    MOVE '"$''I                  ! 0 #00006504' TO DFHEIV0
  7142     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7144     MOVE X'3020233030303036353034' TO DFHEIV0(25:11)
  7145     CALL 'kxdfhei1' USING DFHEIV0
  7146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7147
  7148
  7149     PERFORM 8050-READPREV  THRU  8050-EXIT.
  7150
  7151     IF PI-CARRIER-SECURITY > SPACES
  7152         IF PI-ERC-CARRIER = PI-CARRIER-SECURITY
  7153             NEXT SENTENCE
  7154         ELSE
  7155             GO TO 7350-READ-PREV.
  7156
  7157     IF PI-COMPANY-CD NOT = CO-COMPANY-CD
  7158         GO TO 7375-ENDFILE.
  7159
  7160     MOVE CO-LAST-MAINT-USER     TO  PI-UPDATE-BY.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 142
* EL652.cbl
  7161     MOVE CO-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.
  7162     MOVE PI-ERCOMP-KEY          TO  PI-SAVE-ERCOMP-KEY.
  7163     MOVE LOW-VALUES             TO  EL652AO.
  7164     MOVE CO-CARRIER             TO  CARRIERO.
  7165     MOVE CO-GROUPING            TO  GROUPO.
  7166     MOVE CO-RESP-NO             TO  FINRESPO.
  7167     MOVE CO-ACCOUNT             TO  ACCTNOO.
  7168     MOVE CO-TYPE                TO  TYPEO.
  7169     MOVE AL-UANON               TO  CARRIERA
  7170                                     GROUPA
  7171                                     TYPEA
  7172                                     FINRESPA
  7173                                     ACCTNOA
  7174                                     MAINTYPA.
  7175     MOVE 'S'                    TO  MAINTYPO
  7176                                     PI-CHECK-MAINT-TYPE.
  7177
  7178     GO TO 5050-SET-UP-SCREEN.
  7179
  7180 7375-ENDFILE.
  7181     IF BROWSE-STARTED
  7182         PERFORM 7950-END-BROWSE  THRU  7950-EXIT.
  7183
  7184     MOVE ER-2238                TO  EMI-ERROR.
  7185     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7186
  7187     MOVE -1                     TO  MAINTYPL.
  7188
  7189     GO TO 8200-SEND-DATAONLY.
  7190
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 143
* EL652.cbl
  7192 7400-READ-CONTROL-FILE.
  7193     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7194     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  7195
  7196
  7197* EXEC CICS HANDLE CONDITION
  7198*        NOTFND  (7490-NOT-FOUND)
  7199*        ERROR   (9990-ABEND)
  7200*    END-EXEC.
  7201*    MOVE '"$I.                  ! 1 #00006556' TO DFHEIV0
  7202     MOVE X'2224492E2020202020202020' TO DFHEIV0(1:12)
  7203     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7204     MOVE X'3120233030303036353536' TO DFHEIV0(25:11)
  7205     CALL 'kxdfhei1' USING DFHEIV0
  7206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7207
  7208
  7209
  7210* EXEC CICS READ
  7211*        DATASET  (CNTL-FILE-ID)
  7212*        SET      (ADDRESS OF CONTROL-FILE)
  7213*        RIDFLD   (ELCNTL-KEY)
  7214*    END-EXEC.
  7215*    MOVE '&"S        E          (   #00006561' TO DFHEIV0
  7216     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7217     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7218     MOVE X'2020233030303036353631' TO DFHEIV0(25:11)
  7219     CALL 'kxdfhei1' USING DFHEIV0,
  7220           CNTL-FILE-ID,
  7221           DFHEIV20,
  7222           DFHEIV99,
  7223           ELCNTL-KEY,
  7224           DFHEIV99,
  7225           DFHEIV99,
  7226           DFHEIV99
  7227     SET ADDRESS OF CONTROL-FILE TO
  7228         DFHEIV20
  7229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7230
  7231
  7232     IF CNTL-REC-TYPE = '6'
  7233         MOVE AL-UANON           TO  CARRIERA
  7234         MOVE CARRIERI           TO  PI-ERC-CARRIER
  7235         GO TO 7499-EXIT.
  7236
  7237     IF CF-COMPENSATION-MSTR-MAINT-DT NOT = LOW-VALUES
  7238         GO TO 7499-EXIT
  7239     ELSE
  7240         MOVE -1                 TO  MAINTYPL
  7241         MOVE ER-2572            TO  EMI-ERROR
  7242         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7243         GO TO 7499-EXIT.
  7244
  7245 7490-NOT-FOUND.
  7246     IF CNTL-REC-TYPE = '6'
  7247         MOVE -1                 TO  CARRIERL
  7248         MOVE AL-UABON           TO  CARRIERA
  7249         MOVE ER-0193            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 144
* EL652.cbl
  7250     ELSE
  7251         IF CNTL-REC-TYPE = '2'
  7252             MOVE -1                TO  CSRL
  7253             MOVE AL-UABON          TO  CSRA
  7254             MOVE ER-1883           TO  EMI-ERROR
  7255         ELSE
  7256            MOVE ER-0002            TO  EMI-ERROR
  7257            MOVE -1                 TO  PFKEYL.
  7258
  7259     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7260
  7261 7499-EXIT.
  7262     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 145
* EL652.cbl
  7264
  7265 7500-UPDATE-SUMM.
  7266
  7267     PERFORM 7700-ERSUMM-GETMAIN  THRU  7700-EXIT.
  7268
  7269     MOVE 'SX'                   TO SX-RECORD-ID.
  7270     MOVE PI-COMPANY-CD          TO SX-COMPANY-CD.
  7271     MOVE PI-AR-SUMMARY-CODE     TO SX-SUMMARY.
  7272     MOVE PI-ERC-CARRIER         TO SX-CARRIER.
  7273     MOVE PI-ERC-GROUP           TO SX-GROUP.
  7274     MOVE PI-ERC-RESP            TO SX-FIN-RESP.
  7275     MOVE PI-ERC-ACCT            TO SX-ACCT-AGENT.
  7276     MOVE WS-SAVE-NAME           TO SX-SUMM-OR-AGT-NAME.
  7277     MOVE PI-PROCESSOR-ID        TO SX-LAST-MAINT-BY.
  7278     MOVE EIBTIME                TO SX-LAST-MAINT-HHMMSS.
  7279     MOVE BIN-CURRENT-SAVE       TO SX-LAST-MAINT-DT.
  7280     MOVE PI-COMPANY-CD          TO SX-COMPANY-A1.
  7281     MOVE PI-ERC-ACCT            TO SX-ACCT-AGENT-A1.
  7282     MOVE PI-AR-SUMMARY-CODE     TO SX-SUMMARY-A1.
  7283     MOVE PI-ERC-CARRIER         TO SX-CARR-A1.
  7284     MOVE PI-ERC-GROUP           TO SX-GROUP-A1.
  7285     MOVE PI-ERC-RESP            TO SX-FIN-RESP-A1.
  7286
  7287
  7288* EXEC CICS HANDLE CONDITION
  7289*        DUPREC  (7550-DUP)
  7290*    END-EXEC.
  7291*    MOVE '"$%                   ! 2 #00006622' TO DFHEIV0
  7292     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7293     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7294     MOVE X'3220233030303036363232' TO DFHEIV0(25:11)
  7295     CALL 'kxdfhei1' USING DFHEIV0
  7296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7297
  7298
  7299
  7300* EXEC CICS WRITE
  7301*        DATASET  (SUMM-FILE-ID)
  7302*        FROM     (SUMM-CROSS-REFERENCE)
  7303*        RIDFLD   (SX-CONTROL-PRIMARY)
  7304*    END-EXEC.
  7305     MOVE LENGTH OF
  7306      SUMM-CROSS-REFERENCE
  7307       TO DFHEIV11
  7308*    MOVE '&$ L                  ''   #00006626' TO DFHEIV0
  7309     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7310     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7311     MOVE X'2020233030303036363236' TO DFHEIV0(25:11)
  7312     CALL 'kxdfhei1' USING DFHEIV0,
  7313           SUMM-FILE-ID,
  7314           SUMM-CROSS-REFERENCE,
  7315           DFHEIV11,
  7316           SX-CONTROL-PRIMARY,
  7317           DFHEIV99,
  7318           DFHEIV99
  7319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7320
  7321
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 146
* EL652.cbl
  7322     MOVE LOW-VALUES             TO ERSUMM-KEY.
  7323     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7324     MOVE PI-AR-SUMMARY-CODE     TO SUMM-SUMMARY.
  7325
  7326
  7327* EXEC CICS HANDLE CONDITION
  7328*        NOTFND  (7540-WRITE)
  7329*    END-EXEC.
  7330*    MOVE '"$I                   ! 3 #00006636' TO DFHEIV0
  7331     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7332     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7333     MOVE X'3320233030303036363336' TO DFHEIV0(25:11)
  7334     CALL 'kxdfhei1' USING DFHEIV0
  7335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7336
  7337
  7338
  7339* EXEC CICS READ
  7340*        DATASET  (SUMM-FILE-ID)
  7341*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7342*        RIDFLD   (ERSUMM-KEY)
  7343*    END-EXEC.
  7344*    MOVE '&"S        E          (   #00006640' TO DFHEIV0
  7345     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7346     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7347     MOVE X'2020233030303036363430' TO DFHEIV0(25:11)
  7348     CALL 'kxdfhei1' USING DFHEIV0,
  7349           SUMM-FILE-ID,
  7350           DFHEIV20,
  7351           DFHEIV99,
  7352           ERSUMM-KEY,
  7353           DFHEIV99,
  7354           DFHEIV99,
  7355           DFHEIV99
  7356     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7357         DFHEIV20
  7358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7359
  7360     GO TO 7599-EXIT.
  7361
  7362 7540-WRITE.
  7363
  7364     MOVE ERSUMM-KEY             TO SX-CONTROL-PRIMARY.
  7365     MOVE LOW-VALUES             TO SX-CONTROL-A1.
  7366     MOVE PI-COMPANY-CD          TO SX-COMPANY-A1.
  7367     MOVE PI-AR-SUMMARY-CODE     TO SX-SUMMARY-A1.
  7368     MOVE SPACES                 TO SX-SUMM-OR-AGT-NAME.
  7369     MOVE 'LGXX'                 TO SX-LAST-MAINT-BY.
  7370
  7371
  7372* EXEC CICS WRITE
  7373*        DATASET  (SUMM-FILE-ID)
  7374*        FROM     (SUMM-CROSS-REFERENCE)
  7375*        RIDFLD   (SX-CONTROL-PRIMARY)
  7376*    END-EXEC.
  7377     MOVE LENGTH OF
  7378      SUMM-CROSS-REFERENCE
  7379       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 147
* EL652.cbl
  7380*    MOVE '&$ L                  ''   #00006656' TO DFHEIV0
  7381     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7382     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7383     MOVE X'2020233030303036363536' TO DFHEIV0(25:11)
  7384     CALL 'kxdfhei1' USING DFHEIV0,
  7385           SUMM-FILE-ID,
  7386           SUMM-CROSS-REFERENCE,
  7387           DFHEIV11,
  7388           SX-CONTROL-PRIMARY,
  7389           DFHEIV99,
  7390           DFHEIV99
  7391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7392
  7393
  7394     MOVE PI-ERC-CARRIER         TO PI-CR-CARRIER.
  7395     MOVE PI-ERC-GROUP           TO PI-CR-GROUPING.
  7396     MOVE PI-ERC-TYPE            TO PI-CR-TYPE.
  7397     MOVE PI-ERC-RESP            TO PI-CR-FIN-RESP.
  7398     MOVE PI-ERC-ACCT            TO PI-CR-ACCOUNT.
  7399
  7400     MOVE XCTL-856               TO PGM-NAME.
  7401     GO TO 9300-XCTL.
  7402
  7403 7550-DUP.
  7404
  7405     MOVE ER-3152                TO EMI-ERROR.
  7406     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7407
  7408     MOVE -1                     TO MAINTYPL.
  7409
  7410     GO TO 8200-SEND-DATAONLY.
  7411
  7412 7599-EXIT.
  7413     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 148
* EL652.cbl
  7415
  7416 7600-DELETE-SUMM.
  7417
  7418     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7419     MOVE WS-SAVE-SUMM           TO SUMM-SUMMARY.
  7420     MOVE PI-ERC-CARRIER         TO SUMM-CARRIER.
  7421     MOVE PI-ERC-GROUP           TO SUMM-GROUP.
  7422     MOVE PI-ERC-RESP            TO SUMM-FIN-RESP.
  7423     MOVE PI-ERC-ACCT            TO SUMM-ACCT-AGENT.
  7424
  7425 7620-READ-ERSUMM.
  7426
  7427* EXEC CICS HANDLE CONDITION
  7428*        NOTFND  (7699-EXIT)
  7429*    END-EXEC.
  7430*    MOVE '"$I                   ! 4 #00006694' TO DFHEIV0
  7431     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7432     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7433     MOVE X'3420233030303036363934' TO DFHEIV0(25:11)
  7434     CALL 'kxdfhei1' USING DFHEIV0
  7435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7436
  7437
  7438
  7439* EXEC CICS READ
  7440*        DATASET  (SUMM-FILE-ID)
  7441*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7442*        RIDFLD   (ERSUMM-KEY)
  7443*        UPDATE
  7444*    END-EXEC.
  7445*    MOVE '&"S        EU         (   #00006698' TO DFHEIV0
  7446     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7447     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7448     MOVE X'2020233030303036363938' TO DFHEIV0(25:11)
  7449     CALL 'kxdfhei1' USING DFHEIV0,
  7450           SUMM-FILE-ID,
  7451           DFHEIV20,
  7452           DFHEIV99,
  7453           ERSUMM-KEY,
  7454           DFHEIV99,
  7455           DFHEIV99,
  7456           DFHEIV99
  7457     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7458         DFHEIV20
  7459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7460
  7461
  7462
  7463* EXEC CICS DELETE
  7464*        DATASET  (SUMM-FILE-ID)
  7465*    END-EXEC.
  7466*    MOVE '&(                    &   #00006705' TO DFHEIV0
  7467     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7468     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7469     MOVE X'2020233030303036373035' TO DFHEIV0(25:11)
  7470     CALL 'kxdfhei1' USING DFHEIV0,
  7471           SUMM-FILE-ID,
  7472           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 149
* EL652.cbl
  7473           DFHEIV99,
  7474           DFHEIV99,
  7475           DFHEIV99
  7476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7477
  7478
  7479     MOVE LOW-VALUES             TO ERSUMM-KEY.
  7480     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7481     MOVE WS-SAVE-SUMM           TO SUMM-SUMMARY.
  7482
  7483
  7484* EXEC CICS STARTBR
  7485*        DATASET  (SUMM-FILE-ID)
  7486*        RIDFLD   (ERSUMM-KEY)
  7487*    END-EXEC.
  7488     MOVE 0
  7489       TO DFHEIV11
  7490*    MOVE '&,         G          &   #00006713' TO DFHEIV0
  7491     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7492     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7493     MOVE X'2020233030303036373133' TO DFHEIV0(25:11)
  7494     CALL 'kxdfhei1' USING DFHEIV0,
  7495           SUMM-FILE-ID,
  7496           ERSUMM-KEY,
  7497           DFHEIV99,
  7498           DFHEIV11,
  7499           DFHEIV99
  7500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7501
  7502
  7503
  7504* EXEC CICS READNEXT
  7505*        DATASET  (SUMM-FILE-ID)
  7506*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7507*        RIDFLD   (ERSUMM-KEY)
  7508*    END-EXEC.
  7509     MOVE 0
  7510       TO DFHEIV11
  7511*    MOVE '&.S                   )   #00006718' TO DFHEIV0
  7512     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7513     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7514     MOVE X'2020233030303036373138' TO DFHEIV0(25:11)
  7515     CALL 'kxdfhei1' USING DFHEIV0,
  7516           SUMM-FILE-ID,
  7517           DFHEIV20,
  7518           DFHEIV99,
  7519           ERSUMM-KEY,
  7520           DFHEIV99,
  7521           DFHEIV11,
  7522           DFHEIV99,
  7523           DFHEIV99
  7524     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7525         DFHEIV20
  7526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7527
  7528
  7529     IF SX-CARRIER = LOW-VALUES
  7530         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 150
* EL652.cbl
  7531     ELSE
  7532         GO TO 7640-END-BROWSE.
  7533
  7534
  7535* EXEC CICS HANDLE CONDITION
  7536*        ENDFILE  (7630-DELETE)
  7537*    END-EXEC.
  7538*    MOVE '"$''                   ! 5 #00006729' TO DFHEIV0
  7539     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7540     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7541     MOVE X'3520233030303036373239' TO DFHEIV0(25:11)
  7542     CALL 'kxdfhei1' USING DFHEIV0
  7543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7544
  7545
  7546
  7547* EXEC CICS READNEXT
  7548*        DATASET  (SUMM-FILE-ID)
  7549*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7550*        RIDFLD   (ERSUMM-KEY)
  7551*    END-EXEC.
  7552     MOVE 0
  7553       TO DFHEIV11
  7554*    MOVE '&.S                   )   #00006733' TO DFHEIV0
  7555     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7556     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7557     MOVE X'2020233030303036373333' TO DFHEIV0(25:11)
  7558     CALL 'kxdfhei1' USING DFHEIV0,
  7559           SUMM-FILE-ID,
  7560           DFHEIV20,
  7561           DFHEIV99,
  7562           ERSUMM-KEY,
  7563           DFHEIV99,
  7564           DFHEIV11,
  7565           DFHEIV99,
  7566           DFHEIV99
  7567     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7568         DFHEIV20
  7569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7570
  7571
  7572     IF SX-SUMMARY = WS-SAVE-SUMM
  7573         GO TO 7640-END-BROWSE.
  7574
  7575 7630-DELETE.
  7576
  7577* EXEC CICS ENDBR
  7578*        DATASET  (SUMM-FILE-ID)
  7579*    END-EXEC.
  7580     MOVE 0
  7581       TO DFHEIV11
  7582*    MOVE '&2                    $   #00006743' TO DFHEIV0
  7583     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7584     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7585     MOVE X'2020233030303036373433' TO DFHEIV0(25:11)
  7586     CALL 'kxdfhei1' USING DFHEIV0,
  7587           SUMM-FILE-ID,
  7588           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 151
* EL652.cbl
  7589           DFHEIV99
  7590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7591
  7592
  7593     MOVE LOW-VALUES             TO ERSUMM-KEY.
  7594     MOVE PI-COMPANY-CD          TO SUMM-COMP-ID.
  7595     MOVE WS-SAVE-SUMM           TO SUMM-SUMMARY.
  7596
  7597
  7598* EXEC CICS READ
  7599*        DATASET  (SUMM-FILE-ID)
  7600*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7601*        RIDFLD   (ERSUMM-KEY)
  7602*        UPDATE
  7603*    END-EXEC.
  7604*    MOVE '&"S        EU         (   #00006751' TO DFHEIV0
  7605     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7606     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7607     MOVE X'2020233030303036373531' TO DFHEIV0(25:11)
  7608     CALL 'kxdfhei1' USING DFHEIV0,
  7609           SUMM-FILE-ID,
  7610           DFHEIV20,
  7611           DFHEIV99,
  7612           ERSUMM-KEY,
  7613           DFHEIV99,
  7614           DFHEIV99,
  7615           DFHEIV99
  7616     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7617         DFHEIV20
  7618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7619
  7620
  7621
  7622* EXEC CICS DELETE
  7623*        DATASET  (SUMM-FILE-ID)
  7624*    END-EXEC.
  7625*    MOVE '&(                    &   #00006758' TO DFHEIV0
  7626     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  7627     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7628     MOVE X'2020233030303036373538' TO DFHEIV0(25:11)
  7629     CALL 'kxdfhei1' USING DFHEIV0,
  7630           SUMM-FILE-ID,
  7631           DFHEIV99,
  7632           DFHEIV99,
  7633           DFHEIV99,
  7634           DFHEIV99
  7635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7636
  7637
  7638     GO TO 7699-EXIT.
  7639
  7640 7640-END-BROWSE.
  7641
  7642* EXEC CICS ENDBR
  7643*        DATASET  (SUMM-FILE-ID)
  7644*    END-EXEC.
  7645     MOVE 0
  7646       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 152
* EL652.cbl
  7647*    MOVE '&2                    $   #00006765' TO DFHEIV0
  7648     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7649     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7650     MOVE X'2020233030303036373635' TO DFHEIV0(25:11)
  7651     CALL 'kxdfhei1' USING DFHEIV0,
  7652           SUMM-FILE-ID,
  7653           DFHEIV11,
  7654           DFHEIV99
  7655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7656
  7657
  7658 7699-EXIT.
  7659     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 153
* EL652.cbl
  7661
  7662 7700-ERSUMM-GETMAIN.
  7663
  7664* EXEC CICS GETMAIN
  7665*        SET      (ADDRESS OF SUMM-CROSS-REFERENCE)
  7666*        LENGTH   (ERSUMM-LENGTH)
  7667*        INITIMG  (GETMAIN-SPACE)
  7668*    END-EXEC.
  7669*    MOVE ',"IL                  $   #00006774' TO DFHEIV0
  7670     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7671     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7672     MOVE X'2020233030303036373734' TO DFHEIV0(25:11)
  7673     CALL 'kxdfhei1' USING DFHEIV0,
  7674           DFHEIV20,
  7675           ERSUMM-LENGTH,
  7676           GETMAIN-SPACE
  7677     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  7678         DFHEIV20
  7679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7680
  7681
  7682 7700-EXIT.
  7683     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 154
* EL652.cbl
  7685
  7686 7850-START-BROWSE.
  7687
  7688* EXEC CICS STARTBR
  7689*        DATASET  (COMP-FILE-ID)
  7690*        RIDFLD   (PI-ERCOMP-KEY)
  7691*    END-EXEC.
  7692     MOVE 0
  7693       TO DFHEIV11
  7694*    MOVE '&,         G          &   #00006785' TO DFHEIV0
  7695     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7696     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7697     MOVE X'2020233030303036373835' TO DFHEIV0(25:11)
  7698     CALL 'kxdfhei1' USING DFHEIV0,
  7699           COMP-FILE-ID,
  7700           PI-ERCOMP-KEY,
  7701           DFHEIV99,
  7702           DFHEIV11,
  7703           DFHEIV99
  7704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7705
  7706
  7707     MOVE 'Y'                    TO  WS-BROWSE-SW.
  7708
  7709 7850-EXIT.
  7710     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 155
* EL652.cbl
  7712 7900-READNEXT.
  7713
  7714* EXEC CICS READNEXT
  7715*        DATASET  (COMP-FILE-ID)
  7716*        SET      (ADDRESS OF COMPENSATION-MASTER)
  7717*        RIDFLD   (PI-ERCOMP-KEY)
  7718*    END-EXEC.
  7719     MOVE 0
  7720       TO DFHEIV11
  7721*    MOVE '&.S                   )   #00006796' TO DFHEIV0
  7722     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7723     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7724     MOVE X'2020233030303036373936' TO DFHEIV0(25:11)
  7725     CALL 'kxdfhei1' USING DFHEIV0,
  7726           COMP-FILE-ID,
  7727           DFHEIV20,
  7728           DFHEIV99,
  7729           PI-ERCOMP-KEY,
  7730           DFHEIV99,
  7731           DFHEIV11,
  7732           DFHEIV99,
  7733           DFHEIV99
  7734     SET ADDRESS OF COMPENSATION-MASTER TO
  7735         DFHEIV20
  7736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7737
  7738
  7739     IF PI-COMPANY-CD NOT = CO-COMPANY-CD
  7740         MOVE 'Y'                TO  PI-ERCOMP-EOF-SW
  7741     ELSE
  7742         MOVE SPACE              TO  PI-FIRST-TIME-SW.
  7743
  7744 7900-EXIT.
  7745     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 156
* EL652.cbl
  7747 7950-END-BROWSE.
  7748
  7749* EXEC CICS ENDBR
  7750*        DATASET  (COMP-FILE-ID)
  7751*    END-EXEC.
  7752     MOVE 0
  7753       TO DFHEIV11
  7754*    MOVE '&2                    $   #00006811' TO DFHEIV0
  7755     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7756     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7757     MOVE X'2020233030303036383131' TO DFHEIV0(25:11)
  7758     CALL 'kxdfhei1' USING DFHEIV0,
  7759           COMP-FILE-ID,
  7760           DFHEIV11,
  7761           DFHEIV99
  7762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7763
  7764
  7765     MOVE 'N'                    TO  WS-BROWSE-SW.
  7766
  7767 7950-EXIT.
  7768     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 157
* EL652.cbl
  7770 8000-UPDATE-MAINT-DATE.
  7771     MOVE SPACES                 TO  ELCNTL-KEY.
  7772     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7773     MOVE '1'                    TO  CNTL-REC-TYPE.
  7774     MOVE +0                     TO  CNTL-SEQ-NO.
  7775
  7776
  7777* EXEC CICS HANDLE CONDITION
  7778*        NOTFND  (8000-EXIT)
  7779*    END-EXEC.
  7780*    MOVE '"$I                   ! 6 #00006826' TO DFHEIV0
  7781     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7782     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7783     MOVE X'3620233030303036383236' TO DFHEIV0(25:11)
  7784     CALL 'kxdfhei1' USING DFHEIV0
  7785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7786
  7787
  7788
  7789* EXEC CICS READ
  7790*        UPDATE
  7791*        DATASET  (CNTL-FILE-ID)
  7792*        SET      (ADDRESS OF CONTROL-FILE)
  7793*        RIDFLD   (ELCNTL-KEY)
  7794*    END-EXEC.
  7795*    MOVE '&"S        EU         (   #00006830' TO DFHEIV0
  7796     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7797     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7798     MOVE X'2020233030303036383330' TO DFHEIV0(25:11)
  7799     CALL 'kxdfhei1' USING DFHEIV0,
  7800           CNTL-FILE-ID,
  7801           DFHEIV20,
  7802           DFHEIV99,
  7803           ELCNTL-KEY,
  7804           DFHEIV99,
  7805           DFHEIV99,
  7806           DFHEIV99
  7807     SET ADDRESS OF CONTROL-FILE TO
  7808         DFHEIV20
  7809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7810
  7811
  7812     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  7813     MOVE 'B'                    TO  JP-RECORD-TYPE.
  7814     MOVE CNTL-FILE-ID           TO  FILE-ID.
  7815
  7816     PERFORM 8400-LOG-JOURNAL-RECORD.
  7817
  7818     MOVE BIN-CURRENT-SAVE  TO  CF-COMPENSATION-MSTR-MAINT-DT.
  7819     MOVE CONTROL-FILE      TO  JP-RECORD-AREA.
  7820     MOVE 'C'               TO  JP-RECORD-TYPE.
  7821     MOVE CNTL-FILE-ID      TO  FILE-ID.
  7822
  7823
  7824* EXEC CICS REWRITE
  7825*        DATASET  (CNTL-FILE-ID)
  7826*        FROM     (CONTROL-FILE)
  7827*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 158
* EL652.cbl
  7828     MOVE LENGTH OF
  7829      CONTROL-FILE
  7830       TO DFHEIV11
  7831*    MOVE '&& L                  %   #00006848' TO DFHEIV0
  7832     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7833     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7834     MOVE X'2020233030303036383438' TO DFHEIV0(25:11)
  7835     CALL 'kxdfhei1' USING DFHEIV0,
  7836           CNTL-FILE-ID,
  7837           CONTROL-FILE,
  7838           DFHEIV11,
  7839           DFHEIV99
  7840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7841
  7842
  7843     PERFORM 8400-LOG-JOURNAL-RECORD.
  7844
  7845 8000-EXIT.
  7846      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 159
* EL652.cbl
  7848 8050-READPREV.
  7849
  7850* EXEC CICS READPREV
  7851*        DATASET  (COMP-FILE-ID)
  7852*        SET      (ADDRESS OF COMPENSATION-MASTER)
  7853*        RIDFLD   (PI-ERCOMP-KEY)
  7854*    END-EXEC.
  7855     MOVE 0
  7856       TO DFHEIV11
  7857*    MOVE '&0S                   )   #00006859' TO DFHEIV0
  7858     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  7859     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7860     MOVE X'2020233030303036383539' TO DFHEIV0(25:11)
  7861     CALL 'kxdfhei1' USING DFHEIV0,
  7862           COMP-FILE-ID,
  7863           DFHEIV20,
  7864           DFHEIV99,
  7865           PI-ERCOMP-KEY,
  7866           DFHEIV99,
  7867           DFHEIV11,
  7868           DFHEIV99,
  7869           DFHEIV99
  7870     SET ADDRESS OF COMPENSATION-MASTER TO
  7871         DFHEIV20
  7872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7873
  7874
  7875 8050-EXIT.
  7876     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 160
* EL652.cbl
  7878 8100-SEND-INITIAL-MAP.
  7879
  7880     IF  NOT CREDIT-SESSION
  7881         MOVE AL-SADOF           TO PFK5A
  7882                                    PFK6A.
  7883
  7884     IF PI-COMPANY-ID NOT = 'NCL'
  7885         MOVE AL-SANOF           TO  LETRCDA
  7886         MOVE AL-SADOF           TO  LETDESCA.
  7887
  7888     IF PI-COMPANY-ID  NOT = 'DDB' AND 'ANT' AND 'ASL' AND
  7889                             'AN1' AND 'TFS'
  7890         MOVE AL-SANOF           TO  BALCDA
  7891         MOVE AL-SADOF           TO  BALPRTA.
  7892
  7893     IF PI-COMPANY-ID   = 'NCL'
  7894        IF TYPEI =  'G' OR 'B'
  7895           MOVE AL-UNNOF         TO  RPTCD2A
  7896           MOVE AL-SANOF         TO  RPTCDDA.
  7897
  7898     IF PI-COMPANY-ID = 'DCC'
  7899        IF TYPEI = 'A'
  7900           MOVE AL-SANOF         TO SPPDDHA
  7901           MOVE AL-UANON         TO SPPDDA
  7902        END-IF
  7903     END-IF
  7904     MOVE AL-SANON               TO  FLITYPA.
  7905
  7906     IF EIBTRNID NOT = TRANS-ID
  7907        IF PI-AR-PROCESSING
  7908             MOVE AL-SANOF       TO  SCDESCA
  7909                                     NGDESCA
  7910                                     BALDESCA
  7911                                     CKDESCA
  7912             MOVE AL-UANON       TO  SUMMNOA
  7913                                     NETGRSA
  7914                                     ARBALA
  7915                                     CKPULLA.
  7916
  7917     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  7918         MOVE AL-UANOF           TO  LSTMDTA
  7919         MOVE AL-SANOF           TO  PFK9A
  7920     ELSE
  7921         IF PI-AR-PROCESSING
  7922             MOVE AL-SANOF       TO  PFK9A
  7923         ELSE
  7924             MOVE AL-SANOF       TO  LSTMDTA
  7925             MOVE AL-SADOF       TO  PFK9A.
  7926
  7927*    IF (PI-ERC-TYPE NOT = 'G' AND SPACE)
  7928*       OR (PI-COMPANY-ID NOT = 'DCC')
  7929     IF PI-ERC-TYPE = 'A'
  7930        MOVE AL-SANOF            TO PCONTA
  7931     END-IF
  7932     IF PI-ERC-TYPE NOT = 'B' AND SPACE
  7933         MOVE AL-SADOF           TO  PFK10A
  7934                                     PFK13A
  7935         MOVE AL-SADOF           TO  CSLABLA
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 161
* EL652.cbl
  7936         MOVE AL-SADOF           TO  CLPSTA
  7937         MOVE AL-SADOF           TO  MFLABLA
  7938         MOVE AL-SADOF           TO  MAXFEEA
  7939         MOVE AL-SADOF           TO  LFLABLA
  7940         MOVE AL-SADOF           TO  MAXLFA
  7941         MOVE AL-SADOF           TO  REFEHA
  7942                                     REFEA
  7943     END-IF
  7944     MOVE SAVE-DATE              TO  RUNDATEO.
  7945     MOVE EIBTIME                TO  TIME-IN.
  7946     MOVE TIME-OUT               TO  RUNTIMEO.
  7947     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  7948     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  7949     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  7950     MOVE -1                     TO  MAINTYPL.
  7951
  7952
  7953* EXEC CICS SEND
  7954*        MAP     (MAP-NAME)
  7955*        MAPSET  (MAPSET-NAME)
  7956*        FROM    (EL652AO)
  7957*        ERASE
  7958*        CURSOR
  7959*    END-EXEC.
  7960     MOVE LENGTH OF
  7961      EL652AO
  7962       TO DFHEIV12
  7963     MOVE -1
  7964       TO DFHEIV11
  7965*    MOVE '8$     CT  E    H L F ,   #00006942' TO DFHEIV0
  7966     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  7967     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  7968     MOVE X'2020233030303036393432' TO DFHEIV0(25:11)
  7969     CALL 'kxdfhei1' USING DFHEIV0,
  7970           MAP-NAME,
  7971           EL652AO,
  7972           DFHEIV12,
  7973           MAPSET-NAME,
  7974           DFHEIV99,
  7975           DFHEIV99,
  7976           DFHEIV99,
  7977           DFHEIV11,
  7978           DFHEIV99,
  7979           DFHEIV99,
  7980           DFHEIV99
  7981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7982
  7983
  7984     GO TO 9100-RETURN-TRAN.
  7985
  7986 8200-SEND-DATAONLY.
  7987
  7988     IF  NOT CREDIT-SESSION
  7989         MOVE AL-SADOF           TO PFK5A
  7990                                    PFK6A.
  7991
  7992     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  7993         MOVE AL-UANOF           TO  LSTMDTA
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 162
* EL652.cbl
  7994         MOVE AL-SANOF           TO  PFK9A
  7995     ELSE
  7996         IF PI-AR-PROCESSING
  7997             MOVE AL-SANOF       TO  PFK9A
  7998         ELSE
  7999             MOVE AL-SANOF       TO  LSTMDTA
  8000             MOVE AL-SADOF       TO  PFK9A.
  8001     IF PI-ERC-TYPE = 'A'
  8002        MOVE AL-SANOF            TO PCONTA
  8003     END-IF
  8004
  8005     IF PI-COMPANY-ID = 'DCC'
  8006        IF TYPEI = 'A'
  8007           MOVE AL-SANOF         TO SPPDDHA
  8008           MOVE AL-UANON         TO SPPDDA
  8009        END-IF
  8010     END-IF
  8011*    IF (PI-ERC-TYPE NOT = 'G')
  8012*       OR (PI-COMPANY-ID NOT = 'DCC')
  8013     IF PI-ERC-TYPE NOT = 'B'
  8014         MOVE AL-SADOF           TO  PFK10A
  8015                                     PFK13A
  8016         MOVE AL-SADOF           TO  CSLABLA
  8017         MOVE AL-SADOF           TO  CLPSTA
  8018         MOVE AL-SADOF           TO  MFLABLA
  8019         MOVE AL-SADOF           TO  MAXFEEA
  8020         MOVE AL-SADOF           TO  LFLABLA
  8021         MOVE AL-SADOF           TO  MAXLFA
  8022     END-IF.
  8023
  8024     MOVE SAVE-DATE              TO  RUNDATEO.
  8025     MOVE EIBTIME                TO  TIME-IN.
  8026     MOVE TIME-OUT               TO  RUNTIMEO.
  8027     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  8028     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  8029     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  8030
  8031
  8032* EXEC CICS SEND
  8033*        MAP     (MAP-NAME)
  8034*        MAPSET  (MAPSET-NAME)
  8035*        FROM    (EL652AO)
  8036*        DATAONLY
  8037*        CURSOR
  8038*    END-EXEC.
  8039     MOVE LENGTH OF
  8040      EL652AO
  8041       TO DFHEIV12
  8042     MOVE -1
  8043       TO DFHEIV11
  8044*    MOVE '8$D    CT       H L F ,   #00006997' TO DFHEIV0
  8045     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  8046     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8047     MOVE X'2020233030303036393937' TO DFHEIV0(25:11)
  8048     CALL 'kxdfhei1' USING DFHEIV0,
  8049           MAP-NAME,
  8050           EL652AO,
  8051           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 163
* EL652.cbl
  8052           MAPSET-NAME,
  8053           DFHEIV99,
  8054           DFHEIV99,
  8055           DFHEIV99,
  8056           DFHEIV11,
  8057           DFHEIV99,
  8058           DFHEIV99,
  8059           DFHEIV99
  8060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8061
  8062
  8063     GO TO 9100-RETURN-TRAN.
  8064
  8065 8300-SEND-TEXT.
  8066
  8067* EXEC CICS SEND TEXT
  8068*        FROM    (LOGOFF-TEXT)
  8069*        LENGTH  (LOGOFF-LENGTH)
  8070*        ERASE
  8071*        FREEKB
  8072*    END-EXEC.
  8073*    MOVE '8&      T  E F  H   F -   #00007008' TO DFHEIV0
  8074     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8075     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8076     MOVE X'2020233030303037303038' TO DFHEIV0(25:11)
  8077     CALL 'kxdfhei1' USING DFHEIV0,
  8078           LOGOFF-TEXT,
  8079           LOGOFF-LENGTH,
  8080           DFHEIV99,
  8081           DFHEIV99,
  8082           DFHEIV99,
  8083           DFHEIV99,
  8084           DFHEIV99,
  8085           DFHEIV99,
  8086           DFHEIV99,
  8087           DFHEIV99,
  8088           DFHEIV99,
  8089           DFHEIV99
  8090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8091
  8092
  8093
  8094* EXEC CICS RETURN
  8095*    END-EXEC.
  8096*    MOVE '.(                    &   #00007015' TO DFHEIV0
  8097     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8098     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8099     MOVE X'2020233030303037303135' TO DFHEIV0(25:11)
  8100     CALL 'kxdfhei1' USING DFHEIV0,
  8101           DFHEIV99,
  8102           DFHEIV99,
  8103           DFHEIV99,
  8104           DFHEIV99,
  8105           DFHEIV99
  8106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8107
  8108
  8109 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 164
* EL652.cbl
  8110     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  8111     MOVE FILE-ID                TO  JP-FILE-ID.
  8112     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  8113
  8114*    EXEC CICS JOURNAL
  8115*        JFILEID  (PI-JOURNAL-FILE-ID)
  8116*        JTYPEID  ('EL')
  8117*        FROM     (JOURNAL-RECORD)
  8118*        LENGTH   (473)
  8119*    END-EXEC.
  8120
  8121 8800-UNAUTHORIZED-ACCESS.
  8122     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  8123
  8124     GO TO 8300-SEND-TEXT.
  8125
  8126 8810-PF23.
  8127     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  8128     MOVE XCTL-005               TO  PGM-NAME.
  8129
  8130     GO TO 9300-XCTL.
  8131
  8132 8880-NOT-FOUND.
  8133     MOVE ER-0142                TO  EMI-ERROR.
  8134     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8135
  8136     MOVE SPACE                  TO  PI-ERC-TYPE.
  8137     MOVE -1                     TO  MAINTYPL.
  8138
  8139     IF EIBTRNID NOT = TRANS-ID
  8140         GO TO 8100-SEND-INITIAL-MAP.
  8141
  8142     GO TO 8200-SEND-DATAONLY.
  8143
  8144 9100-RETURN-TRAN.
  8145     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  8146     MOVE '652A'                 TO  PI-CURRENT-SCREEN-NO.
  8147
  8148
  8149* EXEC CICS RETURN
  8150*        TRANSID   (TRANS-ID)
  8151*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8152*        LENGTH    (PI-COMM-LENGTH)
  8153*    END-EXEC.
  8154*    MOVE '.(CT                  &   #00007057' TO DFHEIV0
  8155     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8156     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8157     MOVE X'2020233030303037303537' TO DFHEIV0(25:11)
  8158     CALL 'kxdfhei1' USING DFHEIV0,
  8159           TRANS-ID,
  8160           PROGRAM-INTERFACE-BLOCK,
  8161           PI-COMM-LENGTH,
  8162           DFHEIV99,
  8163           DFHEIV99
  8164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8165
  8166
  8167 9200-RETURN-MAIN-MENU.
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 165
* EL652.cbl
  8168
  8169     IF  MORTGAGE-SESSION
  8170         MOVE XCTL-EM626         TO PGM-NAME
  8171     ELSE
  8172         IF  CREDIT-SESSION
  8173             MOVE XCTL-626       TO PGM-NAME
  8174         ELSE
  8175             MOVE XCTL-126       TO PGM-NAME.
  8176
  8177     GO TO 9300-XCTL.
  8178
  8179 9300-XCTL.
  8180
  8181* EXEC CICS XCTL
  8182*        PROGRAM   (PGM-NAME)
  8183*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8184*        LENGTH    (PI-COMM-LENGTH)
  8185*    END-EXEC.
  8186*    MOVE '.$C                   $   #00007076' TO DFHEIV0
  8187     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8188     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8189     MOVE X'2020233030303037303736' TO DFHEIV0(25:11)
  8190     CALL 'kxdfhei1' USING DFHEIV0,
  8191           PGM-NAME,
  8192           PROGRAM-INTERFACE-BLOCK,
  8193           PI-COMM-LENGTH
  8194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8195
  8196
  8197 9400-CLEAR.
  8198     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  8199
  8200     GO TO 9300-XCTL.
  8201
  8202 9500-PF12.
  8203     MOVE XCTL-010               TO  PGM-NAME.
  8204
  8205     GO TO 9300-XCTL.
  8206
  8207 9600-PGMID-ERROR.
  8208
  8209* EXEC CICS HANDLE CONDITION
  8210*        PGMIDERR  (8300-SEND-TEXT)
  8211*    END-EXEC.
  8212*    MOVE '"$L                   ! 7 #00007093' TO DFHEIV0
  8213     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8214     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8215     MOVE X'3720233030303037303933' TO DFHEIV0(25:11)
  8216     CALL 'kxdfhei1' USING DFHEIV0
  8217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8218
  8219
  8220     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  8221     MOVE ' '                    TO  PI-ENTRY-CD-1.
  8222     MOVE XCTL-005               TO  PGM-NAME.
  8223     MOVE PGM-NAME               TO  LOGOFF-PGM.
  8224     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  8225
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 166
* EL652.cbl
  8226     GO TO 9300-XCTL.
  8227
  8228 9700-LINK-DATE-CONVERT.
  8229
  8230* EXEC CICS LINK
  8231*        PROGRAM   ('ELDATCV')
  8232*        COMMAREA  (DATE-CONVERSION-DATA)
  8233*        LENGTH    (DC-COMM-LENGTH)
  8234*    END-EXEC.
  8235     MOVE 'ELDATCV' TO DFHEIV1
  8236*    MOVE '."C                   ''   #00007106' TO DFHEIV0
  8237     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8238     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8239     MOVE X'2020233030303037313036' TO DFHEIV0(25:11)
  8240     CALL 'kxdfhei1' USING DFHEIV0,
  8241           DFHEIV1,
  8242           DATE-CONVERSION-DATA,
  8243           DC-COMM-LENGTH,
  8244           DFHEIV99,
  8245           DFHEIV99,
  8246           DFHEIV99
  8247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8248
  8249
  8250 9700-EXIT.
  8251     EXIT.
  8252
  8253 9900-ERROR-FORMAT.
  8254     IF NOT EMI-ERRORS-COMPLETE
  8255         MOVE LINK-001           TO  PGM-NAME
  8256
  8257* EXEC CICS LINK
  8258*            PROGRAM   (PGM-NAME)
  8259*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  8260*            LENGTH    (EMI-COMM-LENGTH)
  8261*        END-EXEC.
  8262*    MOVE '."C                   ''   #00007118' TO DFHEIV0
  8263     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8264     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8265     MOVE X'2020233030303037313138' TO DFHEIV0(25:11)
  8266     CALL 'kxdfhei1' USING DFHEIV0,
  8267           PGM-NAME,
  8268           ERROR-MESSAGE-INTERFACE-BLOCK,
  8269           EMI-COMM-LENGTH,
  8270           DFHEIV99,
  8271           DFHEIV99,
  8272           DFHEIV99
  8273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8274
  8275
  8276 9900-EXIT.
  8277     EXIT.
  8278
  8279 9910-INITIALIZE-SECURITY.
  8280******************************************************************
  8281*                                                                *
  8282*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  8283*       USER SECURITY RECORD SET UP BY EL125.  THIS PROGRAM      *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 167
* EL652.cbl
  8284*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  8285*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  8286*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  8287*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  8288*                                                                *
  8289******************************************************************
  8290
  8291     IF  PI-PROCESSOR-ID NOT = 'LGXX'
  8292
  8293         IF  MORTGAGE-SESSION
  8294             MOVE '125E'             TO SC-QUID-SYSTEM
  8295             MOVE EIBTRMID           TO SC-QUID-TERMINAL
  8296
  8297
  8298* EXEC CICS READQ TS
  8299*                QUEUE  (SC-QUID-KEY)
  8300*                INTO   (SECURITY-CONTROL-E)
  8301*                LENGTH (SC-COMM-LENGTH-E)
  8302*                ITEM   (SC-ITEM)
  8303*            END-EXEC
  8304*    MOVE '*$II   L              ''   #00007145' TO DFHEIV0
  8305     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8306     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8307     MOVE X'2020233030303037313435' TO DFHEIV0(25:11)
  8308     CALL 'kxdfhei1' USING DFHEIV0,
  8309           SC-QUID-KEY,
  8310           SECURITY-CONTROL-E,
  8311           SC-COMM-LENGTH-E,
  8312           SC-ITEM,
  8313           DFHEIV99,
  8314           DFHEIV99
  8315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8316
  8317             MOVE SC-MP-DISPLAY (W-APPL-SCRTY-NDX)
  8318                                     TO PI-DISPLAY-CAP
  8319             MOVE SC-MP-UPDATE (W-APPL-SCRTY-NDX)
  8320                                     TO PI-MODIFY-CAP
  8321
  8322             IF  NOT DISPLAY-CAP
  8323                 MOVE 'READ'         TO SM-READ
  8324                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8325                 MOVE ER-9097        TO EMI-ERROR
  8326                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8327                 GO TO 8100-SEND-INITIAL-MAP
  8328             ELSE
  8329                 GO TO 9910-EXIT
  8330         ELSE
  8331
  8332* EXEC CICS  READQ TS
  8333*                QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8334*                INTO    (SECURITY-CONTROL)
  8335*                LENGTH  (SC-COMM-LENGTH)
  8336*                ITEM    (SC-ITEM-CL-CR)
  8337*                END-EXEC
  8338*    MOVE '*$II   L              ''   #00007166' TO DFHEIV0
  8339     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8340     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8341     MOVE X'2020233030303037313636' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 168
* EL652.cbl
  8342     CALL 'kxdfhei1' USING DFHEIV0,
  8343           PI-SECURITY-TEMP-STORE-ID,
  8344           SECURITY-CONTROL,
  8345           SC-COMM-LENGTH,
  8346           SC-ITEM-CL-CR,
  8347           DFHEIV99,
  8348           DFHEIV99
  8349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8350
  8351             MOVE SC-CREDIT-DISPLAY (05)
  8352                                 TO PI-DISPLAY-CAP
  8353             MOVE SC-CREDIT-UPDATE  (05)
  8354                                 TO PI-MODIFY-CAP
  8355
  8356             IF  NOT DISPLAY-CAP
  8357                 MOVE 'READ'     TO SM-READ
  8358                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8359                 MOVE ER-0070    TO  EMI-ERROR
  8360                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8361                 GO TO 8100-SEND-INITIAL-MAP.
  8362
  8363 9910-EXIT.
  8364     EXIT.
  8365
  8366 9990-ABEND.
  8367     MOVE LINK-004               TO  PGM-NAME.
  8368     MOVE DFHEIBLK               TO  EMI-LINE1.
  8369
  8370
  8371* EXEC CICS LINK
  8372*        PROGRAM   (PGM-NAME)
  8373*        COMMAREA  (EMI-LINE1)
  8374*        LENGTH    (72)
  8375*    END-EXEC.
  8376     MOVE 72
  8377       TO DFHEIV11
  8378*    MOVE '."C                   ''   #00007192' TO DFHEIV0
  8379     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8380     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8381     MOVE X'2020233030303037313932' TO DFHEIV0(25:11)
  8382     CALL 'kxdfhei1' USING DFHEIV0,
  8383           PGM-NAME,
  8384           EMI-LINE1,
  8385           DFHEIV11,
  8386           DFHEIV99,
  8387           DFHEIV99,
  8388           DFHEIV99
  8389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8390
  8391
  8392     GO TO 8200-SEND-DATAONLY.
  8393
  8394 9995-SECURITY-VIOLATION.
  8395*           COPY ELCSCTP.
  8396******************************************************************
  8397*                                                                *
  8398*                            ELCSCTP                             *
  8399*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 169
* EL652.cbl
  8400*                                                                *
  8401*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8402******************************************************************
  8403
  8404
  8405     MOVE EIBDATE          TO SM-JUL-DATE.
  8406     MOVE EIBTRMID         TO SM-TERMID.
  8407     MOVE THIS-PGM         TO SM-PGM.
  8408     MOVE EIBTIME          TO TIME-IN.
  8409     MOVE TIME-OUT         TO SM-TIME.
  8410     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8411
  8412
  8413* EXEC CICS LINK
  8414*         PROGRAM  ('EL003')
  8415*         COMMAREA (SECURITY-MESSAGE)
  8416*         LENGTH   (80)
  8417*    END-EXEC.
  8418     MOVE 'EL003' TO DFHEIV1
  8419     MOVE 80
  8420       TO DFHEIV11
  8421*    MOVE '."C                   ''   #00007218' TO DFHEIV0
  8422     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8423     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8424     MOVE X'2020233030303037323138' TO DFHEIV0(25:11)
  8425     CALL 'kxdfhei1' USING DFHEIV0,
  8426           DFHEIV1,
  8427           SECURITY-MESSAGE,
  8428           DFHEIV11,
  8429           DFHEIV99,
  8430           DFHEIV99,
  8431           DFHEIV99
  8432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8433
  8434
  8435******************************************************************
  8436
  8437 9995-EXIT.
  8438      EXIT.
  8439
  8440 9999-DFHBACK SECTION.
  8441     MOVE '9%                    "   ' TO DFHEIV0
  8442     MOVE 'EL652' TO DFHEIV1
  8443     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8444     GOBACK.
  8445 9999-DFHEXIT.
  8446     IF DFHEIGDJ EQUAL 0001
  8447         NEXT SENTENCE
  8448     ELSE IF DFHEIGDJ EQUAL 2
  8449         GO TO 9990-ABEND,
  8450               8880-NOT-FOUND,
  8451               9600-PGMID-ERROR,
  8452               9990-ABEND
  8453         DEPENDING ON DFHEIGDI
  8454     ELSE IF DFHEIGDJ EQUAL 3
  8455         GO TO 3400-EXIT
  8456         DEPENDING ON DFHEIGDI
  8457     ELSE IF DFHEIGDJ EQUAL 4
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 170
* EL652.cbl
  8458         GO TO 3450-EXIT
  8459         DEPENDING ON DFHEIGDI
  8460     ELSE IF DFHEIGDJ EQUAL 5
  8461         GO TO 9990-ABEND,
  8462               8880-NOT-FOUND,
  8463               9600-PGMID-ERROR,
  8464               9990-ABEND
  8465         DEPENDING ON DFHEIGDI
  8466     ELSE IF DFHEIGDJ EQUAL 6
  8467         GO TO 3475-EXIT
  8468         DEPENDING ON DFHEIGDI
  8469     ELSE IF DFHEIGDJ EQUAL 7
  8470         GO TO 9990-ABEND,
  8471               4250-CONT
  8472         DEPENDING ON DFHEIGDI
  8473     ELSE IF DFHEIGDJ EQUAL 8
  8474         GO TO 4300-EXIT
  8475         DEPENDING ON DFHEIGDI
  8476     ELSE IF DFHEIGDJ EQUAL 9
  8477         GO TO 4750-NO-STATE
  8478         DEPENDING ON DFHEIGDI
  8479     ELSE IF DFHEIGDJ EQUAL 10
  8480         GO TO 6550-END-BROWSE,
  8481               6550-END-BROWSE
  8482         DEPENDING ON DFHEIGDI
  8483     ELSE IF DFHEIGDJ EQUAL 11
  8484         GO TO 6550-END-BROWSE,
  8485               6550-END-BROWSE
  8486         DEPENDING ON DFHEIGDI
  8487     ELSE IF DFHEIGDJ EQUAL 12
  8488         GO TO 6599-EXIT,
  8489               6599-EXIT
  8490         DEPENDING ON DFHEIGDI
  8491     ELSE IF DFHEIGDJ EQUAL 13
  8492         GO TO 7250-ENDFILE,
  8493               7250-ENDFILE,
  8494               9990-ABEND
  8495         DEPENDING ON DFHEIGDI
  8496     ELSE IF DFHEIGDJ EQUAL 14
  8497         GO TO 7250-ENDFILE,
  8498               7275-NOTFOUND
  8499         DEPENDING ON DFHEIGDI
  8500     ELSE IF DFHEIGDJ EQUAL 15
  8501         GO TO 7375-ENDFILE,
  8502               7375-ENDFILE,
  8503               9990-ABEND
  8504         DEPENDING ON DFHEIGDI
  8505     ELSE IF DFHEIGDJ EQUAL 16
  8506         GO TO 7375-ENDFILE,
  8507               7275-NOTFOUND
  8508         DEPENDING ON DFHEIGDI
  8509     ELSE IF DFHEIGDJ EQUAL 17
  8510         GO TO 7490-NOT-FOUND,
  8511               9990-ABEND
  8512         DEPENDING ON DFHEIGDI
  8513     ELSE IF DFHEIGDJ EQUAL 18
  8514         GO TO 7550-DUP
  8515         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 29-Mar-12 15:20 Page 171
* EL652.cbl
  8516     ELSE IF DFHEIGDJ EQUAL 19
  8517         GO TO 7540-WRITE
  8518         DEPENDING ON DFHEIGDI
  8519     ELSE IF DFHEIGDJ EQUAL 20
  8520         GO TO 7699-EXIT
  8521         DEPENDING ON DFHEIGDI
  8522     ELSE IF DFHEIGDJ EQUAL 21
  8523         GO TO 7630-DELETE
  8524         DEPENDING ON DFHEIGDI
  8525     ELSE IF DFHEIGDJ EQUAL 22
  8526         GO TO 8000-EXIT
  8527         DEPENDING ON DFHEIGDI
  8528     ELSE IF DFHEIGDJ EQUAL 23
  8529         GO TO 8300-SEND-TEXT
  8530         DEPENDING ON DFHEIGDI.
  8531     MOVE '9%                    "   ' TO DFHEIV0
  8532     MOVE 'EL652' TO DFHEIV1
  8533     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8534     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        6260     Code:       26398
