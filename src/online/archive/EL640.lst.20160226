* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   1
* EL640.cbl
* Options: int("EL640.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL640.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL640.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL640.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL640.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 15:38:12.
     7*                            VMOD=2.040
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   2
* EL640.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22*
    23*REMARKS.    TRANSACTION - EXC1 - ACCOUNT BILLING.
    24*
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    34*                              ADJUSTED REDEFINES EL640AO FILLER
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 083104    2004083000002  PEMA PREVENT ONLINE BILLING
    37* 072105    2004120100002  PEMA FIX ONLINE BILLING FOR DCC SPP
    38* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    39* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    40* 032113  CR2012110800003  PEMA  CORRECT SPP AH REF COMMISSION
    41* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    42******************************************************************
    43 ENVIRONMENT DIVISION.
    44
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   3
* EL640.cbl
    46 DATA DIVISION.
    47 WORKING-STORAGE SECTION.
    48 01  DFH-START PIC X(04).
    49 77  FILLER  PIC X(32)  VALUE '********************************'.
    50 77  FILLER  PIC X(32)  VALUE '*    EL640 WORKING STORAGE     *'.
    51 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.040 ************'.
    52 77  CNC-FACT                    PIC S999V9(7) COMP-3 VALUE +0.
    53 77  S1                          PIC S999 COMP-3 VALUE +0.
    54*    COPY ELCSCTM.
    55******************************************************************
    56*                                                                *
    57*                                                                *
    58*                            ELCSCTM                             *
    59*                            VMOD=2.001                          *
    60*                                                                *
    61*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    62*                                                                *
    63******************************************************************
    64 01  SECURITY-MESSAGE.
    65     12  FILLER                          PIC X(30)
    66            VALUE '** LOGIC SECURITY VIOLATION -'.
    67     12  SM-READ                         PIC X(6).
    68     12  FILLER                          PIC X(5)
    69            VALUE ' PGM='.
    70     12  SM-PGM                          PIC X(6).
    71     12  FILLER                          PIC X(5)
    72            VALUE ' OPR='.
    73     12  SM-PROCESSOR-ID                 PIC X(4).
    74     12  FILLER                          PIC X(6)
    75            VALUE ' TERM='.
    76     12  SM-TERMID                       PIC X(4).
    77     12  FILLER                          PIC XX   VALUE SPACE.
    78     12  SM-JUL-DATE                     PIC 9(5).
    79     12  FILLER                          PIC X    VALUE SPACE.
    80     12  SM-TIME                         PIC 99.99.
    81
    82*    COPY ELCSCRTY.
    83******************************************************************
    84*                                                                *
    85*                                                                *
    86*                            ELCSCRTY                            *
    87*                            VMOD=2.001                          *
    88*                                                                *
    89*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    90*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    91*        SAVED IN PI-SECURITY-ADDRESS.                           *
    92*                                                                *
    93******************************************************************
    94 01  SECURITY-CONTROL.
    95     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    96     12  FILLER                       PIC XX    VALUE 'SC'.
    97     12  SC-CREDIT-CODES.
    98         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    99             20  SC-CREDIT-DISPLAY    PIC X.
   100             20  SC-CREDIT-UPDATE     PIC X.
   101     12  SC-CLAIMS-CODES.
   102         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   103             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   4
* EL640.cbl
   104             20  SC-CLAIMS-UPDATE     PIC X.
   105     12  WS-RESPONSE             PIC S9(8)       COMP.
   106         88  WS-RESP-NORMAL                      VALUE +00.
   107         88  WS-RESP-NOTFND                      VALUE +13.
   108         88  WS-RESP-DUPREC                      VALUE +14.
   109         88  WS-RESP-DUPKEY                      VALUE +15.
   110         88  WS-RESP-NOTOPEN                     VALUE +19.
   111         88  WS-RESP-ENDFILE                     VALUE +20.
   112 01  STANDARD-AREAS.
   113     12  WS-AH-CATEGORY              PIC X       VALUE ' '.
   114     12  CLAS-LOOK                   PIC XX      VALUE '  '.
   115     12  SC-ITEM             PIC S9(4) COMP VALUE +1.
   116
   117     12  W-TRANSFER-CONTROL.
   118         16  WT-CR-CARRIER           PIC X     VALUE SPACES.
   119         16  WT-CR-GROUPING          PIC X(6)  VALUE SPACES.
   120         16  WT-CR-STATE             PIC XX    VALUE SPACES.
   121         16  WT-CR-ACCOUNT           PIC X(10) VALUE SPACES.
   122         16  WT-CR-FIN-RESP          PIC X(10) VALUE SPACES.
   123         16  WT-CR-TYPE              PIC X     VALUE SPACES.
   124
   125     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   126     12  MAP-NAME            PIC X(8)    VALUE 'EL640A'.
   127     12  MAPSET-NAME         PIC X(8)    VALUE 'EL640S'.
   128     12  SCREEN-NUMBER       PIC X(4)    VALUE '640A'.
   129     12  TRANS-ID            PIC X(4)    VALUE 'EXC1'.
   130     12  EL6311-TRANS-ID     PIC X(4)    VALUE 'EXB1'.
   131     12  EL633-TRANS-ID      PIC X(4)    VALUE 'EXB7'.
   132     12  EL633DMD-TRANS-ID   PIC X(4)    VALUE 'EX1F'.
   133     12  EL635-TRANS-ID      PIC X(4)    VALUE 'EXJ4'.
   134     12  EL650-TRANS-ID      PIC X(4)    VALUE 'EXC4'.
   135     12  EL652-TRANS-ID      PIC X(4)    VALUE 'EXD4'.
   136     12  EL658-TRANS-ID      PIC X(4)    VALUE 'EXJ3'.
   137     12  THIS-PGM            PIC X(8)    VALUE 'EL640'.
   138     12  EL640A              PIC X(8)    VALUE 'EL640A'.
   139     12  EL640B              PIC X(8)    VALUE 'EL640B'.
   140     12  PGM-NAME            PIC X(8).
   141     12  TIME-IN             PIC S9(7).
   142     12  TIME-OUT-R  REDEFINES TIME-IN.
   143         16  FILLER          PIC X.
   144         16  TIME-OUT        PIC 99V99.
   145         16  FILLER          PIC XX.
   146
   147     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   148     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   149     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   150     12  XCTL-633            PIC X(8)    VALUE 'EL633'.
   151     12  XCTL-633DMD         PIC X(8)    VALUE 'EL633DMD'.
   152     12  XCTL-635            PIC X(8)    VALUE 'EL635'.
   153     12  XCTL-PYAJ           PIC X(8)    VALUE 'EL633'.
   154     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   155     12  XCTL-652            PIC X(8)    VALUE 'EL652'.
   156     12  XCTL-658            PIC X(8)    VALUE 'EL658'.
   157     12  XCTL-6401           PIC X(8)    VALUE 'EL6401'.
   158     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   159     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   160     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   161     12  ERPNDB-ALT-FILE-ID  PIC X(8)    VALUE 'ERPNDB2'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   5
* EL640.cbl
   162     12  ERPNDB-FILE-ID      PIC X(8)    VALUE 'ERPNDB'.
   163     12  ELCNTL-FILE-ID      PIC X(8)    VALUE 'ELCNTL'.
   164     12  ELLETR-FILE-ID      PIC X(8)    VALUE 'ELLETR'.
   165     12  ERCOMP-FILE-ID      PIC X(8)    VALUE 'ERCOMP'.
   166     12  ERPYAJ-FILE-ID      PIC X(8)    VALUE 'ERPYAJ'.
   167     12  ERACCT-ALT-FILE-ID  PIC X(8)    VALUE 'ERACCT2'.
   168     12  ERACCT-FILE-ID      PIC X(8)    VALUE 'ERACCT'.
   169     12  ERBILL-FILE-ID      PIC X(8)    VALUE 'ERBILL'.
   170     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   171     12  QID.
   172         16  QID-TERM        PIC X(4).
   173         16  FILLER          PIC X(4)    VALUE '640A'.
   174     12  CLIENT-ITY          PIC XXX     VALUE 'ITY'.
   175
   176 01  WORK-AREA.
   177     12  W-LETTER-IND            PIC X     VALUE SPACE.
   178         88  W-LETTER-NOT-FOUND    VALUE 'Y'.
   179     12  FIRST-TIME-SW           PIC X     VALUE 'Y'.
   180         88  FIRST-TIME            VALUE 'Y'.
   181     12  C-RECORD-FOUND-SW       PIC X     VALUE 'Y'.
   182         88  C-RECORD-FOUND        VALUE 'Y'.
   183     12  ACCOUNT-FIN-RESP-SW     PIC X     VALUE ' '.
   184         88  ACCOUNT-FIN-RESP      VALUE 'Y'.
   185         88  ACCOUNT-NOT-FIN-RESP  VALUE 'N'.
   186     12  VALID-BILL-TYPE-VALUES  PIC X     VALUE SPACE.
   187         88  VALID-BILL-TYPE       VALUE  '1' '2'.
   188*        88  VALID-BILL-TYPE       VALUE  '1' '2' '3' '4' '5'.
   189     12  BILL-BATCH-TRAILER-SW   PIC X     VALUE SPACE.
   190         88  BILL-BATCH-TRAILER    VALUE 'Y'.
   191     12  PNDB-EOF-SW             PIC X     VALUE SPACE.
   192         88  PNDB-EOF              VALUE 'Y'.
   193     12  PYAJ-EOF-SW             PIC X     VALUE SPACE.
   194         88  PYAJ-EOF              VALUE 'Y'.
   195     12  COMP-UPDATE-SW          PIC X     VALUE SPACE.
   196         88  UPDATE-COMP-TOTALS    VALUE 'Y'.
   197     12  LIMIT-BILLING-SW        PIC X     VALUE SPACE.
   198         88  LIMIT-BILLING         VALUE 'Y'.
   199     12  WS-PROCESS-SW           PIC X     VALUE SPACE.
   200         88  DO-NOT-BILL-THIS-ACCT VALUE 'Y'.
   201     12  WS-CHARGEBACK-LF-SW     PIC X     VALUE SPACE.
   202         88  CHARGEBACK-CAN-LF     VALUE 'Y'.
   203         88  NO-CHARGEBACK-LF      VALUE 'N'.
   204     12  WS-CHARGEBACK-AH-SW     PIC X     VALUE SPACE.
   205         88  CHARGEBACK-CAN-AH     VALUE 'Y'.
   206         88  NO-CHARGEBACK-AH      VALUE 'N'.
   207     12  NO-BILL-REC-SW          PIC X     VALUE SPACE.
   208         88  NO-BILL-RECS          VALUE 'Y'.
   209     12  DATA-VOIDED-SW          PIC X     VALUE SPACE.
   210         88  DATA-VOIDED           VALUE 'Y'.
   211     12  BATCHES-PROCESSED-SW    PIC X     VALUE SPACE.
   212         88  MORE-THAN-6-BATCHES   VALUE 'Y'.
   213     12  BILLING-DETAIL-TYPE     PIC XX    VALUE SPACES.
   214         88  TOTAL-STATEMENT       VALUE 'TS'.
   215         88  BILLING-DETAIL        VALUE 'BD'.
   216         88  CARRIER-ADDRESS       VALUE 'CA'.
   217         88  GEN-AGT-ADDRESS       VALUE 'GA'.
   218     12  ELCNTL-UPDATE-SW        PIC X     VALUE SPACE.
   219         88  ELCNTL-UPDATE         VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   6
* EL640.cbl
   220     12  WS-ENTERED-FROM-MAP     PIC X     VALUE 'A'.
   221         88  WS-ENTERED-FROM-A     VALUE 'A'.
   222
   223     12  ACCOM-SUB               PIC 99    VALUE ZEROS.
   224     12  SUB                     PIC S999  COMP-3  VALUE ZEROS.
   225
   226     12  WORK-ZIP                PIC 9(9)  VALUE ZEROS.
   227     12  WORK-ZIPR1 REDEFINES WORK-ZIP.
   228         16  WORK-ZIPR1-4        PIC 9(4).
   229         16  WORK-ZIPR1-5        PIC 9(5).
   230     12  WORK-ZIPR2 REDEFINES WORK-ZIP.
   231         16  WORK-ZIPR2-5        PIC 9(5).
   232         16  WORK-ZIPR2-4        PIC 9(4).
   233     12  WS-AM-ZIP.
   234         16  WS-AM-ZIP-PRIME     PIC X(5).
   235         16  WS-AM-ZIP-DASH      PIC X.
   236         16  WS-AM-ZIP-PLUS4     PIC X(4).
   237     12  WS-AM-CANADIAN-ZIP  REDEFINES  WS-AM-ZIP.
   238         16  WS-AM-CAN-POST-1    PIC XXX.
   239         16  FILLER              PIC X.
   240         16  WS-AM-CAN-POST-2    PIC XXX.
   241         16  FILLER              PIC XXX.
   242     12  WS-CF-ZIP.
   243         16  WS-CF-ZIP-PRIME     PIC X(5) VALUE SPACES.
   244         16  WS-CF-ZIP-DASH      PIC X    VALUE SPACES.
   245         16  WS-CF-ZIP-PLUS4     PIC X(4) VALUE SPACES.
   246     12  WS-CF-CANADIAN-ZIP  REDEFINES  WS-CF-ZIP.
   247         16  WS-CF-CAN-POST-1    PIC XXX.
   248         16  FILLER              PIC X.
   249         16  WS-CF-CAN-POST-2    PIC XXX.
   250         16  FILLER              PIC XXX.
   251     12  WS-CO-ZIP.
   252         16  WS-CO-ZIP-PRIME     PIC X(5) VALUE SPACES.
   253         16  WS-CO-ZIP-DASH      PIC X    VALUE SPACES.
   254         16  WS-CO-ZIP-PLUS4     PIC X(4) VALUE SPACES.
   255     12  WS-CO-CANADIAN-ZIP  REDEFINES  WS-CO-ZIP.
   256         16  WS-CO-CAN-POST-1    PIC XXX.
   257         16  FILLER              PIC X.
   258         16  WS-CO-CAN-POST-2    PIC XXX.
   259         16  FILLER              PIC XXX.
   260
   261     12  WORK-SEQ-NO             PIC S9(9)   COMP-3 VALUE +0.
   262     12  WS-ERROR-MSG.
   263         16  WS-ERROR-TEXT       PIC X(35) VALUE SPACES.
   264         16  WS-ERROR-BATCH      PIC X(6)  VALUE SPACES.
   265         16  FILLER              PIC X(24) VALUE SPACES.
   266     12  WS-WORK-DATE.
   267         16  WS-MONTH            PIC 99    VALUE ZEROS.
   268         16  WS-DAY              PIC 99    VALUE ZEROS.
   269         16  WS-YEAR             PIC 99    VALUE ZEROS.
   270     12  WS-MONTH-END-DATE.
   271         16  WS-ME-YEAR          PIC 99    VALUE ZEROS.
   272         16  WS-ME-MONTH         PIC 99    VALUE ZEROS.
   273         16  WS-ME-DAY           PIC 99    VALUE ZEROS.
   274     12  WS-CURRENT-DATE         PIC XX    VALUE SPACES.
   275     12  WS-CURRENT-DATE-MDY     PIC X(6)  VALUE SPACES.
   276     12  WS-CURRENT-DATE-EDIT    PIC X(8)  VALUE SPACES.
   277     12  WS-PREV-BILL-DATE       PIC XX    VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   7
* EL640.cbl
   278     12  WS-BEGIN-DATE.
   279         16  FILLER              PIC X(3)  VALUE SPACES.
   280         16  WS-BEGIN-DAY        PIC XX    VALUE SPACES.
   281         16  FILLER              PIC X(3)  VALUE SPACES.
   282     12  PRINT-CONTROL.
   283         16  SINGLE-SPACE        PIC X     VALUE SPACE.
   284         16  DOUBLE-SPACE        PIC X     VALUE ZERO.
   285         16  TRIPLE-SPACE        PIC X     VALUE '-'.
   286         16  SUPPRESS-SPACE      PIC X     VALUE '+'.
   287         16  TOP-OF-PAGE         PIC X     VALUE '1'.
   288     12  WS-EXP-DATE.
   289         16  WS-SAV-EXP-DT     OCCURS 10 TIMES
   290                               INDEXED BY DTNDX  PIC XX.
   291     12  WS-REMIT-TO.
   292         16  WS-SAV-REMIT-TO   OCCURS 10 TIMES
   293                               INDEXED BY RTNDX  PIC X(10).
   294     12  WORK-REMIT-TO           PIC X(10) VALUE SPACES.
   295     12  WS-REMITTED             PIC S9(6)V99 VALUE ZEROS.
   296     12  WS-LINECTR              PIC 99    VALUE ZEROS.
   297     12  WS-PGECTR               PIC 999   VALUE 1.
   298     12  WS-LINE-SEQ-NO          PIC S9(4) COMP VALUE +1.
   299     12  WS-CARR-COMP.
   300         16  WS-CARRIER          PIC X     VALUE SPACE.
   301         16  WS-COMP             PIC X(6)  VALUE SPACES.
   302
   303     12  REPORT-TOTALS.
   304         16  TOT-REPT-LF-PREM    PIC S9(7)V99   VALUE ZEROS.
   305         16  TOT-REPT-LF-REF     PIC S9(7)V99   VALUE ZEROS.
   306         16  TOT-REPT-LF-COMP    PIC S9(7)V99   VALUE ZEROS.
   307         16  TOT-REPT-LF-COMP-R  PIC S9(7)V99   VALUE ZEROS.
   308         16  TOT-REPT-AH-PREM    PIC S9(7)V99   VALUE ZEROS.
   309         16  TOT-REPT-AH-REF     PIC S9(7)V99   VALUE ZEROS.
   310         16  TOT-REPT-AH-COMP    PIC S9(7)V99   VALUE ZEROS.
   311         16  TOT-REPT-AH-COMP-R  PIC S9(7)V99   VALUE ZEROS.
   312         16  TOT-LF-REPT-FACE-AMT   PIC S9(7)V99   VALUE ZEROS.
   313         16  TOT-AH-REPT-FACE-AMT   PIC S9(7)V99   VALUE ZEROS.
   314         16  TOT-REPT-PREM       PIC S9(7)V99   VALUE ZEROS.
   315         16  TOT-REPT-CANCEL-FEE PIC S9(7)V99   VALUE ZEROS.
   316     12  WORK-AMT                PIC S9(7)V99   VALUE ZEROS.
   317     12  WORK-CHECK-AMT          PIC S9(7)V99   VALUE ZEROS.
   318     12  WORK-CANCEL-FEE         PIC S9(7)V99   VALUE ZEROS.
   319     12  WS-I-LF-PREMIUM-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   320     12  WS-I-LF-BENEFIT-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   321     12  WS-I-AH-PREMIUM-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   322     12  WS-I-AH-BENEFIT-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   323     12  WS-C-LF-CANCEL-AMT      PIC S9(5)V99   COMP-3 VALUE +0.
   324     12  WS-C-AH-CANCEL-AMT      PIC S9(5)V99   COMP-3 VALUE +0.
   325     12  WS-C-CANCEL-FEE         PIC S9(5)V99   COMP-3 VALUE +0.
   326     12  WS-LF-CAN-COMP          PIC S9(6)V99   COMP-3 VALUE +0.
   327     12  WS-AH-CAN-COMP          PIC S9(6)V99   COMP-3 VALUE +0.
   328     12  WS-PAY-ADJ              PIC S9(6)V99   COMP-3 VALUE +0.
   329     12  WS-CI-LIFE-BENEFIT      PIC S9(7)V99   COMP-3 VALUE +0.
   330     12  LF-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   331     12  JT-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   332     12  AH-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   333     12  AGENT-OWES              PIC X(18)
   334                         VALUE 'AGENT OWES       ='.
   335     12  OWED-TO-AGENT           PIC X(18)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   8
* EL640.cbl
   336                         VALUE 'OWED TO AGENT    ='.
   337     12  WS-PY-ENTRY-COMMENT.
   338         16  WS-PY-CURRENT-DATE      PIC X(6) VALUE SPACES.
   339         16  FILLER                  PIC X(14) VALUE
   340             ' CHK TO AGENT'.
   341
   342     12  WS-ITY-COMMENT.
   343         16  WS-PY-BEGIN-DT          PIC X(8) VALUE SPACES.
   344         16  FILLER                  PIC X(06) VALUE
   345             ' THRU '.
   346         16  WS-PY-END-DT            PIC X(8) VALUE SPACES.
   347
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   9
* EL640.cbl
   349     12  WS-ACCT-ADDR-AREA.
   350         16  WS-ACCT-LINES OCCURS 6 TIMES INDEXED BY A-INDX.
   351           18  WS-ACCT-ZIP           PIC X(10) VALUE SPACES.
   352           18  FILLER                PIC X(10) VALUE SPACES.
   353           18  WS-A-LAST-ZIP         PIC X(10) VALUE SPACES.
   354
   355     12  WS-REMIT-ADDR-AREA.
   356         16  WS-REMIT-ACCT           PIC X(10) VALUE SPACES.
   357         16  WS-REMIT-LINES OCCURS 6 TIMES INDEXED BY R-INDX.
   358           18  WS-REMIT-ZIP          PIC X(10) VALUE SPACES.
   359           18  FILLER                PIC X(10) VALUE SPACES.
   360           18  WS-R-LAST-ZIP         PIC X(10) VALUE SPACES.
   361
   362     12  WS-EFFECT-DATE.
   363         16  WS-EFFECT-YR            PIC 99 VALUE ZEROS.
   364         16  WS-EFFECT-MO            PIC 99 VALUE ZEROS.
   365         16  WS-EFFECT-DA            PIC 99 VALUE ZEROS.
   366
   367     12  WS-LIFE-CANCEL-DT.
   368         16  WS-LF-CANCEL-YR         PIC 99 VALUE ZEROS.
   369         16  WS-LF-CANCEL-MO         PIC 99 VALUE ZEROS.
   370         16  WS-LF-CANCEL-DA         PIC 99 VALUE ZEROS.
   371
   372     12  WS-AH-CANCEL-DT.
   373         16  WS-AH-CANCEL-YR         PIC 99 VALUE ZEROS.
   374         16  WS-AH-CANCEL-MO         PIC 99 VALUE ZEROS.
   375         16  WS-AH-CANCEL-DA         PIC 99 VALUE ZEROS.
   376
   377     12  MONTHS-DIFF-LF            PIC S9(05)  VALUE ZEROS.
   378     12  MONTHS-DIFF-AH            PIC S9(05)  VALUE ZEROS.
   379
   380     12  WS-BENEFIT.
   381         16  FILLER                PIC X   VALUE SPACES.
   382         16  WS-BENE-CD            PIC XX  VALUE SPACES.
   383
   384     12  WS-DESC.
   385         16 WS-BATCH-DESC        PIC X(10) VALUE SPACES.
   386         16 WS-BATCH-NBR         PIC X(6)  VALUE SPACES.
   387         16 FILLER               PIC X(4)  VALUE SPACES.
   388     12  WS-NON-PREM             PIC S9(7)V99   COMP-3.
   389     12  WS-NON-COMM             PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  10
* EL640.cbl
   391 01  ACCESS-KEYS.
   392     12  ERPNDB-PRIME-KEY.
   393         16  ERPNDB-CO-CD        PIC X     VALUE SPACES.
   394         16  ERPNDB-BATCH        PIC X(6)  VALUE SPACES.
   395         16  ERPNDB-SEQ-NO       PIC S9(4) COMP VALUE +0.
   396         16  ERPNDB-CHG-SEQ-NO   PIC S9(4) COMP VALUE +0.
   397
   398     12  ERPNDB-LENGTH           PIC S9(4) COMP VALUE +585.
   399
   400     12  ERPNDB-ALT-KEY.
   401         16  ERPNDB-CO-CD-A1     PIC X     VALUE SPACES.
   402         16  ERPNDB-CARR         PIC X     VALUE SPACES.
   403         16  ERPNDB-GROUP        PIC X(6)  VALUE SPACES.
   404         16  ERPNDB-STATE        PIC XX    VALUE SPACES.
   405         16  ERPNDB-ACCT         PIC X(10) VALUE SPACES.
   406         16  ERPNDB-EFF-DT       PIC XX    VALUE SPACES.
   407         16  ERPNDB-CERT.
   408             20  ERPNDB-CERT-PRM PIC X(10) VALUE SPACES.
   409             20  ERPNDB-CERTSFX  PIC X     VALUE SPACES.
   410         16  ERPNDB-ACHG-SEQ-NO  PIC S9(4) COMP.
   411         16  ERPNDB-REC-TYPE     PIC X     VALUE SPACES.
   412
   413     12  ELCNTL-KEY.
   414         16  ELCNTL-COMPANY-ID   PIC XXX   VALUE SPACES.
   415         16  ELCNTL-REC-TYPE     PIC X     VALUE SPACES.
   416         16  ELCNTL-ACCESS.
   417             20  ELCNTL-FILLER   PIC X(3)  VALUE SPACES.
   418             20  ELCNTL-CARRIER  PIC X     VALUE SPACES.
   419         16  ELCNTL-SEQ-NO       PIC S9(4) COMP VALUE ZEROS.
   420
   421     12  ELCNTL-LENGTH           PIC S9(4) COMP VALUE +504.
   422
   423     12  ERCOMP-KEY.
   424         16  ERCOMP-COMP-CD      PIC X     VALUE SPACE.
   425         16  ERCOMP-CARRIER      PIC X     VALUE SPACES.
   426         16  ERCOMP-GROUPING     PIC X(6)  VALUE SPACES.
   427         16  ERCOMP-FIN-RESP     PIC X(10) VALUE SPACES.
   428         16  ERCOMP-ACCT         PIC X(10) VALUE SPACES.
   429         16  ERCOMP-RECORD-TYPE  PIC X     VALUE SPACES.
   430
   431     12  ERPYAJ-BROWSE-COMP-KEY.
   432         16  ERPYAJ-BR-COMP-CD   PIC X     VALUE SPACE.
   433         16  ERPYAJ-BR-CARRIER   PIC X     VALUE SPACES.
   434         16  ERPYAJ-BR-GROUPING  PIC X(6)  VALUE SPACES.
   435         16  ERPYAJ-BR-FIN-RESP  PIC X(10) VALUE SPACES.
   436         16  ERPYAJ-BR-ACCOUNT   PIC X(10) VALUE SPACES.
   437
   438     12  ERCOMP-LENGTH           PIC S9(4) COMP VALUE +700.
   439
   440     12  ERPYAJ-KEY.
   441         16  ERPYAJ-COMP-CD      PIC X     VALUE SPACE.
   442         16  ERPYAJ-CARRIER      PIC X     VALUE SPACES.
   443         16  ERPYAJ-GROUPING     PIC X(6)  VALUE SPACES.
   444         16  ERPYAJ-FIN-RESP     PIC X(10) VALUE SPACES.
   445         16  ERPYAJ-ACCOUNT      PIC X(10) VALUE SPACES.
   446         16  ERPYAJ-FILE-SEQ-NO  PIC S9(8) VALUE +0 COMP.
   447         16  ERPYAJ-RECORD-TYPE  PIC X     VALUE SPACES.
   448
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  11
* EL640.cbl
   449     12  ERPYAJ-LENGTH           PIC S9(4) COMP VALUE +200.
   450
   451     12  ERACCT-PRIME-KEY.
   452         16  ERACCT-P-CO-CD      PIC X     VALUE SPACES.
   453         16  ERACCT-P-CARRIER    PIC X     VALUE SPACES.
   454         16  ERACCT-P-GROUPING   PIC X(6)  VALUE SPACES.
   455         16  ERACCT-P-STATE      PIC XX    VALUE SPACES.
   456         16  ERACCT-P-ACCOUNT    PIC X(10) VALUE SPACES.
   457         16  ERACCT-P-EXP-DATE   PIC XX    VALUE SPACES.
   458         16  FILLER              PIC X(4)  VALUE SPACES.
   459
   460     12  ERACCT-LENGTH           PIC S9(4) COMP VALUE +2000.
   461
   462     12  ERACCT-ALT-KEY.
   463         16  ERACCT-A-CO-CD      PIC X     VALUE SPACES.
   464         16  ERACCT-A-CARRIER    PIC X     VALUE SPACES.
   465         16  ERACCT-A-GROUPING   PIC X(6)  VALUE SPACES.
   466         16  ERACCT-A-STATE      PIC XX    VALUE SPACES.
   467         16  ERACCT-A-ACCOUNT    PIC X(10) VALUE SPACES.
   468         16  ERACCT-A-EXP-DATE   PIC XX    VALUE SPACES.
   469         16  FILLER              PIC X(4)  VALUE SPACES.
   470
   471     12  ERBILL-KEY.
   472         16  ERBILL-CO-CD        PIC X.
   473         16  ERBILL-CARRIER      PIC X.
   474         16  ERBILL-GROUP        PIC X(6).
   475         16  ERBILL-ACCT         PIC X(10).
   476         16  ERBILL-FIN-RESP     PIC X(10).
   477         16  ERBILL-REC-TYPE     PIC X.
   478         16  ERBILL-LINE-SEQ-NO  PIC S9(4) COMP.
   479
   480     12  ERBILL-LENGTH           PIC S9(4) COMP VALUE +210.
   481
   482     12  ELLETR-KEY.
   483         16  ELLETR-COMPANY-CD   PIC  X      VALUE SPACE.
   484         16  ELLETR-FORM-NO      PIC  X(12)  VALUE SPACES.
   485         16  ELLETR-LINE-SEQ     PIC S9(04)  VALUE +0 COMP.
   486
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  12
* EL640.cbl
   488
   489 01  ERROR-NUMBERS.
   490     12  ER-0004                 PIC X(4)  VALUE '0004'.
   491     12  ER-0008                 PIC X(4)  VALUE '0008'.
   492     12  ER-0013                 PIC X(4)  VALUE '0013'.
   493     12  ER-0022                 PIC X(4)  VALUE '0022'.
   494     12  ER-0029                 PIC X(4)  VALUE '0029'.
   495     12  ER-0070                 PIC X(4)  VALUE '0070'.
   496     12  ER-0194                 PIC X(4)  VALUE '0194'.
   497     12  ER-0195                 PIC X(4)  VALUE '0195'.
   498     12  ER-0196                 PIC X(4)  VALUE '0196'.
   499     12  ER-0197                 PIC X(4)  VALUE '0197'.
   500     12  ER-2208                 PIC X(4)  VALUE '2208'.
   501     12  ER-2210                 PIC X(4)  VALUE '2210'.
   502     12  ER-2212                 PIC X(4)  VALUE '2212'.
   503     12  ER-2215                 PIC X(4)  VALUE '2215'.
   504     12  ER-2230                 PIC X(4)  VALUE '2230'.
   505     12  ER-2233                 PIC X(4)  VALUE '2233'.
   506     12  ER-2249                 PIC X(4)  VALUE '2249'.
   507     12  ER-2250                 PIC X(4)  VALUE '2250'.
   508     12  ER-2370                 PIC X(4)  VALUE '2370'.
   509     12  ER-2371                 PIC X(4)  VALUE '2371'.
   510     12  ER-2383                 PIC X(4)  VALUE '2383'.
   511     12  ER-2385                 PIC X(4)  VALUE '2385'.
   512     12  ER-2401                 PIC X(4)  VALUE '2401'.
   513     12  ER-2403                 PIC X(4)  VALUE '2403'.
   514     12  ER-2404                 PIC X(4)  VALUE '2404'.
   515     12  ER-2405                 PIC X(4)  VALUE '2405'.
   516     12  ER-2406                 PIC X(4)  VALUE '2406'.
   517     12  ER-2407                 PIC X(4)  VALUE '2407'.
   518     12  ER-2408                 PIC X(4)  VALUE '2408'.
   519     12  ER-2409                 PIC X(4)  VALUE '2409'.
   520     12  ER-2411                 PIC X(4)  VALUE '2411'.
   521     12  ER-2421                 PIC X(4)  VALUE '2421'.
   522     12  ER-2434                 PIC X(4)  VALUE '2434'.
   523     12  ER-2435                 PIC X(4)  VALUE '2435'.
   524     12  ER-2436                 PIC X(4)  VALUE '2436'.
   525     12  ER-2438                 PIC X(4)  VALUE '2438'.
   526     12  ER-2439                 PIC X(4)  VALUE '2439'.
   527     12  ER-2443                 PIC X(4)  VALUE '2443'.
   528     12  ER-2472                 PIC X(4)  VALUE '2472'.
   529     12  ER-2539                 PIC X(4)  VALUE '2539'.
   530     12  ER-2564                 PIC X(4)  VALUE '2564'.
   531     12  ER-2570                 PIC X(4)  VALUE '2570'.
   532     12  ER-2571                 PIC X(4)  VALUE '2571'.
   533     12  ER-2597                 PIC X(4)  VALUE '2597'.
   534     12  ER-3145                 PIC X(4)  VALUE '3145'.
   535     12  ER-3165                 PIC X(4)  VALUE '3165'.
   536     12  ER-3188                 PIC X(4)  VALUE '3188'.
   537     12  ER-7389                 PIC X(4)  VALUE '7389'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  13
* EL640.cbl
   539 01  BI-REPORT-HEADINGS.
   540     12  BI-PREVIEW-HD.
   541         16  FILLER          PIC X(42)           VALUE SPACES.
   542         16  FILLER          PIC X(47)           VALUE
   543                '**** STATEMENT IS FOR REVIEW PURPOSES ONLY ****'.
   544         16  FILLER          PIC X(43)           VALUE SPACES.
   545
   546     12  BI-HD1.
   547         16  FILLER          PIC X(44)           VALUE SPACES.
   548         16  FILLER          PIC X(44)           VALUE
   549                 '  CREDIT LIFE, ACCIDENT & HEALTH STATEMENT  '.
   550         16  FILLER          PIC X(36)           VALUE SPACES.
   551         16  FILLER          PIC X(8)            VALUE ' EL640 '.
   552
   553     12  BI-HD2.
   554         16  FILLER          PIC X(51)           VALUE SPACES.
   555         16  BI-HD-CO        PIC X(30).
   556         16  FILLER          PIC X(43)           VALUE SPACES.
   557         16  BI-HD-RUN-DT    PIC X(8)            VALUE SPACES.
   558
   559     12  BI-HD3.
   560         16  FILLER          PIC X(57)           VALUE SPACES.
   561         16  BI-HD-BILL-DT   PIC X(18).
   562         16  FILLER          PIC X(37)           VALUE SPACES.
   563         16  FILLER          PIC X(5)            VALUE 'PAGE'.
   564         16  BI-HD-PG        PIC ZZ,ZZ9.
   565
   566     12  BI-HD4.
   567         16  FILLER          PIC  X(44)      VALUE
   568             '                               CERTIFICATE  '.
   569         16  FILLER          PIC  X(44)      VALUE
   570             'EFFECTIVE   CANCEL       BEN.      WRITTEN  '.
   571         12  FILLER          PIC  X(44)      VALUE
   572             '    COMP.                    FACE AMOUNT /  '.
   573
   574     12  BI-HD5.
   575         16  FILLER          PIC  X(44)      VALUE
   576             '       NAME OF INSURED            NUMBER    '.
   577         16  FILLER          PIC  X(44)      VALUE
   578             '  DATE       DATE   TERM TYPE      PREMIUM  '.
   579         16  FILLER          PIC  X(44)      VALUE
   580             '     PCT.    COMPENSATION        BENEFIT    '.
   581
   582     12  BI-HD6.
   583         16  FILLER          PIC  X(44)      VALUE SPACES.
   584         16  FILLER          PIC  X(37)      VALUE SPACES.
   585         16  FILLER          PIC  X(45)      VALUE
   586             '     PROCESSED                  NON-PROCESSED'.
   587         16  FILLER          PIC  X(07)      VALUE SPACES.
   588     12  BI-HD7.
   589         16  FILLER          PIC  X(44)      VALUE SPACES.
   590         16  FILLER          PIC  X(35)      VALUE SPACES.
   591         16  FILLER          PIC  X(45)      VALUE
   592             ' PREMIUM     COMMISSION        PREMIUM     CO'.
   593         16  FILLER          PIC  X(09)      VALUE
   594             'MMISSION'.
   595
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  14
* EL640.cbl
   597
   598*                            COPY ELCDATE.
   599******************************************************************
   600*                                                                *
   601*                                                                *
   602*                            ELCDATE.                            *
   603*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   604*                            VMOD=2.003
   605*                                                                *
   606*                                                                *
   607*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   608*                 LENGTH = 200                                   *
   609******************************************************************
   610
   611 01  DATE-CONVERSION-DATA.
   612     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   613     12  DC-OPTION-CODE                PIC X.
   614         88  BIN-TO-GREG                VALUE ' '.
   615         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   616         88  EDIT-GREG-TO-BIN           VALUE '2'.
   617         88  YMD-GREG-TO-BIN            VALUE '3'.
   618         88  MDY-GREG-TO-BIN            VALUE '4'.
   619         88  JULIAN-TO-BIN              VALUE '5'.
   620         88  BIN-PLUS-ELAPSED           VALUE '6'.
   621         88  FIND-CENTURY               VALUE '7'.
   622         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   623         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   624         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   625         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   626         88  JULIAN-TO-BIN-3            VALUE 'C'.
   627         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   628         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   629         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   630         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   631         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   632         88  CHECK-LEAP-YEAR            VALUE 'H'.
   633         88  BIN-3-TO-GREG              VALUE 'I'.
   634         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   635         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   636         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   637         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   638         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   639         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   640         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   641         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   642         88  THREE-CHARACTER-BIN
   643                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   644         88  GREGORIAN-TO-BIN
   645                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   646         88  BIN-TO-GREGORIAN
   647                  VALUES ' ' '1' 'I' '8' 'G'.
   648         88  JULIAN-TO-BINARY
   649                  VALUES '5' 'C' 'E' 'F'.
   650     12  DC-ERROR-CODE                 PIC X.
   651         88  NO-CONVERSION-ERROR        VALUE ' '.
   652         88  DATE-CONVERSION-ERROR
   653                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   654         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  15
* EL640.cbl
   655         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   656         88  DATE-IS-INVALID            VALUE '3'.
   657         88  DATE1-GREATER-DATE2        VALUE '4'.
   658         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   659         88  DATE-INVALID-OPTION        VALUE '9'.
   660         88  INVALID-CENTURY            VALUE 'A'.
   661         88  ONLY-CENTURY               VALUE 'B'.
   662         88  ONLY-LEAP-YEAR             VALUE 'C'.
   663         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   664     12  DC-END-OF-MONTH               PIC X.
   665         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   666     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   667         88  USE-NORMAL-PROCESS         VALUE ' '.
   668         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   669         88  ADJUST-UP-100-YRS          VALUE '2'.
   670     12  FILLER                        PIC X.
   671     12  DC-CONVERSION-DATES.
   672         16  DC-BIN-DATE-1             PIC XX.
   673         16  DC-BIN-DATE-2             PIC XX.
   674         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   675         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   676                       DC-GREG-DATE-1-EDIT.
   677             20  DC-EDIT1-MONTH        PIC 99.
   678             20  SLASH1-1              PIC X.
   679             20  DC-EDIT1-DAY          PIC 99.
   680             20  SLASH1-2              PIC X.
   681             20  DC-EDIT1-YEAR         PIC 99.
   682         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   683         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   684                     DC-GREG-DATE-2-EDIT.
   685             20  DC-EDIT2-MONTH        PIC 99.
   686             20  SLASH2-1              PIC X.
   687             20  DC-EDIT2-DAY          PIC 99.
   688             20  SLASH2-2              PIC X.
   689             20  DC-EDIT2-YEAR         PIC 99.
   690         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   691         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   692                     DC-GREG-DATE-1-YMD.
   693             20  DC-YMD-YEAR           PIC 99.
   694             20  DC-YMD-MONTH          PIC 99.
   695             20  DC-YMD-DAY            PIC 99.
   696         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   697         16  DC-GREG-DATE-1-MDY-R REDEFINES
   698                      DC-GREG-DATE-1-MDY.
   699             20  DC-MDY-MONTH          PIC 99.
   700             20  DC-MDY-DAY            PIC 99.
   701             20  DC-MDY-YEAR           PIC 99.
   702         16  DC-GREG-DATE-1-ALPHA.
   703             20  DC-ALPHA-MONTH        PIC X(10).
   704             20  DC-ALPHA-DAY          PIC 99.
   705             20  FILLER                PIC XX.
   706             20  DC-ALPHA-CENTURY.
   707                 24 DC-ALPHA-CEN-N     PIC 99.
   708             20  DC-ALPHA-YEAR         PIC 99.
   709         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   710         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   711         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   712         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  16
* EL640.cbl
   713         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   714                                       PIC 9(05).
   715         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   716             20  DC-JULIAN-YEAR        PIC 99.
   717             20  DC-JULIAN-DAYS        PIC 999.
   718         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   719         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   720         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   721     12  DATE-CONVERSION-VARIBLES.
   722         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   723         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   724             20  FILLER                PIC 9(3).
   725             20  HOLD-CEN-1-CCYY.
   726                 24  HOLD-CEN-1-CC     PIC 99.
   727                 24  HOLD-CEN-1-YY     PIC 99.
   728             20  HOLD-CEN-1-MO         PIC 99.
   729             20  HOLD-CEN-1-DA         PIC 99.
   730         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   731             20  HOLD-CEN-1-R-MO       PIC 99.
   732             20  HOLD-CEN-1-R-DA       PIC 99.
   733             20  HOLD-CEN-1-R-CCYY.
   734                 24  HOLD-CEN-1-R-CC   PIC 99.
   735                 24  HOLD-CEN-1-R-YY   PIC 99.
   736             20  FILLER                PIC 9(3).
   737         16  HOLD-CENTURY-1-X.
   738             20  FILLER                PIC X(3)  VALUE SPACES.
   739             20  HOLD-CEN-1-X-CCYY.
   740                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   741                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   742             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   743             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   744         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   745             20  HOLD-CEN-1-R-X-MO     PIC XX.
   746             20  HOLD-CEN-1-R-X-DA     PIC XX.
   747             20  HOLD-CEN-1-R-X-CCYY.
   748                 24  HOLD-CEN-1-R-X-CC PIC XX.
   749                 24  HOLD-CEN-1-R-X-YY PIC XX.
   750             20  FILLER                PIC XXX.
   751         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   752         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   753         16  DC-JULIAN-DATE-1          PIC 9(07).
   754         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   755             20  DC-JULIAN-1-CCYY.
   756                 24  DC-JULIAN-1-CC    PIC 99.
   757                 24  DC-JULIAN-1-YR    PIC 99.
   758             20  DC-JULIAN-DA-1        PIC 999.
   759         16  DC-JULIAN-DATE-2          PIC 9(07).
   760         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   761             20  DC-JULIAN-2-CCYY.
   762                 24  DC-JULIAN-2-CC    PIC 99.
   763                 24  DC-JULIAN-2-YR    PIC 99.
   764             20  DC-JULIAN-DA-2        PIC 999.
   765         16  DC-GREG-DATE-A-EDIT.
   766             20  DC-EDITA-MONTH        PIC 99.
   767             20  SLASHA-1              PIC X VALUE '/'.
   768             20  DC-EDITA-DAY          PIC 99.
   769             20  SLASHA-2              PIC X VALUE '/'.
   770             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  17
* EL640.cbl
   771                 24  DC-EDITA-CENT     PIC 99.
   772                 24  DC-EDITA-YEAR     PIC 99.
   773         16  DC-GREG-DATE-B-EDIT.
   774             20  DC-EDITB-MONTH        PIC 99.
   775             20  SLASHB-1              PIC X VALUE '/'.
   776             20  DC-EDITB-DAY          PIC 99.
   777             20  SLASHB-2              PIC X VALUE '/'.
   778             20  DC-EDITB-CCYY.
   779                 24  DC-EDITB-CENT     PIC 99.
   780                 24  DC-EDITB-YEAR     PIC 99.
   781         16  DC-GREG-DATE-CYMD         PIC 9(08).
   782         16  DC-GREG-DATE-CYMD-R REDEFINES
   783                              DC-GREG-DATE-CYMD.
   784             20  DC-CYMD-CEN           PIC 99.
   785             20  DC-CYMD-YEAR          PIC 99.
   786             20  DC-CYMD-MONTH         PIC 99.
   787             20  DC-CYMD-DAY           PIC 99.
   788         16  DC-GREG-DATE-MDCY         PIC 9(08).
   789         16  DC-GREG-DATE-MDCY-R REDEFINES
   790                              DC-GREG-DATE-MDCY.
   791             20  DC-MDCY-MONTH         PIC 99.
   792             20  DC-MDCY-DAY           PIC 99.
   793             20  DC-MDCY-CEN           PIC 99.
   794             20  DC-MDCY-YEAR          PIC 99.
   795    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   796        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   797    12  DC-EL310-DATE                  PIC X(21).
   798    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  18
* EL640.cbl
   800*                            COPY ELCLOGOF.
   801******************************************************************
   802*                                                                *
   803*                                                                *
   804*                            ELCLOGOF.                           *
   805*                            VMOD=2.001                          *
   806*                                                                *
   807*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   808*                                                                *
   809******************************************************************
   810 01  CLASIC-LOGOFF.
   811     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   812     12  LOGOFF-TEXT.
   813         16  FILLER          PIC X(5)    VALUE SPACES.
   814         16  LOGOFF-MSG.
   815             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   816             20  FILLER      PIC X       VALUE SPACES.
   817             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   818         16  FILLER          PIC X(80)
   819           VALUE '* YOU ARE NOW LOGGED OFF'.
   820         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   821         16  FILLER          PIC X       VALUE QUOTE.
   822         16  LOGOFF-SYS-MSG  PIC X(17)
   823           VALUE 'S CLAS-IC SYSTEM '.
   824     12  TEXT-MESSAGES.
   825         16  UNACCESS-MSG    PIC X(29)
   826             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   827         16  PGMIDERR-MSG    PIC X(17)
   828             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  19
* EL640.cbl
   830*                            COPY ELCATTR.
   831******************************************************************
   832*                                                                *
   833*                            ELCATTR.                            *
   834*                            VMOD=2.001                          *
   835*                                                                *
   836*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   837*                                                                *
   838*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   839*                                                                *
   840*                   POS 1   P=PROTECTED                          *
   841*                           U=UNPROTECTED                        *
   842*                           S=ASKIP                              *
   843*                   POS 2   A=ALPHA/NUMERIC                      *
   844*                           N=NUMERIC                            *
   845*                   POS 3   N=NORMAL                             *
   846*                           B=BRIGHT                             *
   847*                           D=DARK                               *
   848*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   849*                           OF=MODIFIED DATA TAG OFF             *
   850*                                                                *
   851*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   852******************************************************************
   853 01  ATTRIBUTE-LIST.
   854     12  AL-PABOF            PIC X       VALUE 'Y'.
   855     12  AL-PABON            PIC X       VALUE 'Z'.
   856     12  AL-PADOF            PIC X       VALUE '%'.
   857     12  AL-PADON            PIC X       VALUE '_'.
   858     12  AL-PANOF            PIC X       VALUE '-'.
   859     12  AL-PANON            PIC X       VALUE '/'.
   860     12  AL-SABOF            PIC X       VALUE '8'.
   861     12  AL-SABON            PIC X       VALUE '9'.
   862     12  AL-SADOF            PIC X       VALUE '@'.
   863     12  AL-SADON            PIC X       VALUE QUOTE.
   864     12  AL-SANOF            PIC X       VALUE '0'.
   865     12  AL-SANON            PIC X       VALUE '1'.
   866     12  AL-UABOF            PIC X       VALUE 'H'.
   867     12  AL-UABON            PIC X       VALUE 'I'.
   868     12  AL-UADOF            PIC X       VALUE '<'.
   869     12  AL-UADON            PIC X       VALUE '('.
   870     12  AL-UANOF            PIC X       VALUE ' '.
   871     12  AL-UANON            PIC X       VALUE 'A'.
   872     12  AL-UNBOF            PIC X       VALUE 'Q'.
   873     12  AL-UNBON            PIC X       VALUE 'R'.
   874     12  AL-UNDOF            PIC X       VALUE '*'.
   875     12  AL-UNDON            PIC X       VALUE ')'.
   876     12  AL-UNNOF            PIC X       VALUE '&'.
   877     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  20
* EL640.cbl
   879*                            COPY ELCEMIB.
   880******************************************************************
   881*                                                                *
   882*                                                                *
   883*                            ELCEMIB.                            *
   884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   885*                            VMOD=2.005                          *
   886*                                                                *
   887*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   888*                                                                *
   889******************************************************************
   890 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   891     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   892     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   893     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   894     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   895     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   896     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   897     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   898     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   899     12  EMI-SWITCH1             PIC X        VALUE '1'.
   900         88  EMI-NO-ERRORS                    VALUE '1'.
   901         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   902         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   903     12  EMI-SWITCH2             PIC X        VALUE '1'.
   904         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   905     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   906         88  EMI-AREA1-EMPTY                  VALUE '1'.
   907         88  EMI-AREA1-FULL                   VALUE '2'.
   908     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   909         88  EMI-AREA2-EMPTY                  VALUE '1'.
   910         88  EMI-AREA2-FULL                   VALUE '2'.
   911     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   912         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   913         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   914         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   915         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   916         88  EMI-BYPASS-FATALS                VALUE 'X'.
   917     12  EMI-ERROR-LINES.
   918         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   919         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   920         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   921         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   922             20  EMI-ERR-CODES OCCURS 10 TIMES.
   923                 24  EMI-ERR-NUM         PIC X(4).
   924                 24  EMI-FILLER          PIC X.
   925                 24  EMI-SEV             PIC X.
   926                 24  FILLER              PIC X.
   927             20  FILLER                  PIC X(02).
   928     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   929         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   930             20  EMI-ERROR-NUMBER    PIC X(4).
   931             20  EMI-FILL            PIC X.
   932             20  EMI-SEVERITY        PIC X.
   933             20  FILLER              PIC X.
   934             20  EMI-ERROR-TEXT.
   935                 24  EMI-TEXT-VARIABLE   PIC X(10).
   936                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  21
* EL640.cbl
   937     12  EMI-SEVERITY-SAVE           PIC X.
   938         88  EMI-NOTE                    VALUE 'N'.
   939         88  EMI-WARNING                 VALUE 'W'.
   940         88  EMI-FORCABLE                VALUE 'F'.
   941         88  EMI-FATAL                   VALUE 'X'.
   942     12  EMI-MESSAGE-FLAG            PIC X.
   943         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   944         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   945     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   946     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   947         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   948         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   949         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   950     12  emi-claim-no                pic x(7).
   951     12  emi-claim-type              pic x(6).
   952     12  FILLER                      PIC X(124)  VALUE SPACES.
   953     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   954     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   955     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   956     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  22
* EL640.cbl
   958*                            COPY ELCINTF.
   959******************************************************************
   960*                                                                *
   961*                                                                *
   962*                            ELCINTF.                            *
   963*                            VMOD=2.017                          *
   964*                                                                *
   965*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   966*                                                                *
   967*       LENGTH = 1024                                            *
   968*                                                                *
   969******************************************************************
   970*                   C H A N G E   L O G
   971*
   972* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   973*-----------------------------------------------------------------
   974*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   975* EFFECTIVE    NUMBER
   976*-----------------------------------------------------------------
   977* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   978******************************************************************
   979 01  PROGRAM-INTERFACE-BLOCK.
   980     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   981     12  PI-CALLING-PROGRAM              PIC X(8).
   982     12  PI-SAVED-PROGRAM-1              PIC X(8).
   983     12  PI-SAVED-PROGRAM-2              PIC X(8).
   984     12  PI-SAVED-PROGRAM-3              PIC X(8).
   985     12  PI-SAVED-PROGRAM-4              PIC X(8).
   986     12  PI-SAVED-PROGRAM-5              PIC X(8).
   987     12  PI-SAVED-PROGRAM-6              PIC X(8).
   988     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   989     12  PI-COMPANY-ID                   PIC XXX.
   990     12  PI-COMPANY-CD                   PIC X.
   991
   992     12  PI-COMPANY-PASSWORD             PIC X(8).
   993
   994     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   995
   996     12  PI-CONTROL-IN-PROGRESS.
   997         16  PI-CARRIER                  PIC X.
   998         16  PI-GROUPING                 PIC X(6).
   999         16  PI-STATE                    PIC XX.
  1000         16  PI-ACCOUNT                  PIC X(10).
  1001         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1002                                         PIC X(10).
  1003         16  PI-CLAIM-CERT-GRP.
  1004             20  PI-CLAIM-NO             PIC X(7).
  1005             20  PI-CERT-NO.
  1006                 25  PI-CERT-PRIME       PIC X(10).
  1007                 25  PI-CERT-SFX         PIC X.
  1008             20  PI-CERT-EFF-DT          PIC XX.
  1009         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1010             20  PI-PLAN-CODE            PIC X(2).
  1011             20  PI-REVISION-NUMBER      PIC X(3).
  1012             20  PI-PLAN-EFF-DT          PIC X(2).
  1013             20  PI-PLAN-EXP-DT          PIC X(2).
  1014             20  FILLER                  PIC X(11).
  1015         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  23
* EL640.cbl
  1016             20  PI-OE-REFERENCE-1.
  1017                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1018                 25  PI-OE-REF-1-SUFF    PIC XX.
  1019
  1020     12  PI-SESSION-IN-PROGRESS          PIC X.
  1021         88  CLAIM-SESSION                   VALUE '1'.
  1022         88  CREDIT-SESSION                  VALUE '2'.
  1023         88  WARRANTY-SESSION                VALUE '3'.
  1024         88  MORTGAGE-SESSION                VALUE '4'.
  1025         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1026
  1027
  1028*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1029
  1030     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1031     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1032
  1033     12  PI-CREDIT-USER                  PIC X.
  1034         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1035         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1036
  1037     12  PI-CLAIM-USER                   PIC X.
  1038         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1039         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1040
  1041     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1042         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1043         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1044         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1045         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1046         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1047
  1048     12  PI-PROCESSOR-ID                 PIC X(4).
  1049
  1050     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1051
  1052     12  PI-MEMBER-CAPTION               PIC X(10).
  1053
  1054     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1055         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1056
  1057     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1058     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1059     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1060     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1061
  1062     12  PI-AH-OVERRIDE-L1               PIC X.
  1063     12  PI-AH-OVERRIDE-L2               PIC XX.
  1064     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1065     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1066
  1067     12  PI-NEW-SYSTEM                   PIC X(2).
  1068
  1069     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1070     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1071         88  PI-USES-PAID-TO                 VALUE '1'.
  1072     12  PI-CRDTCRD-SYSTEM.
  1073         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  24
* EL640.cbl
  1074             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1075             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1076         16  PI-CC-MONTH-END-DT          PIC XX.
  1077     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1078
  1079     12  PI-OE-REFERENCE-2.
  1080         16  PI-OE-REF-2-PRIME           PIC X(10).
  1081         16  PI-OE-REF-2-SUFF            PIC X.
  1082
  1083     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1084
  1085     12  PI-LANGUAGE-TYPE                PIC X.
  1086             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1087             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1088             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1089
  1090     12  PI-POLICY-LINKAGE-IND           PIC X.
  1091         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1092         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1093                                                   LOW-VALUES.
  1094
  1095     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1096     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1097         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1098         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1099
  1100     12  PI-PROCESSOR-CSR-IND            PIC X.
  1101         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1102         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1103
  1104     12  FILLER                          PIC X(3).
  1105
  1106     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1107
  1108     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1109         PI-SYSTEM-LEVEL.
  1110
  1111         16  PI-ENTRY-CODES.
  1112             20  PI-ENTRY-CD-1           PIC X.
  1113             20  PI-ENTRY-CD-2           PIC X.
  1114
  1115         16  PI-RETURN-CODES.
  1116             20  PI-RETURN-CD-1          PIC X.
  1117             20  PI-RETURN-CD-2          PIC X.
  1118
  1119         16  PI-UPDATE-STATUS-SAVE.
  1120             20  PI-UPDATE-BY            PIC X(4).
  1121             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1122
  1123         16  PI-LOWER-CASE-LETTERS       PIC X.
  1124             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1125
  1126*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1127*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1128*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1129
  1130         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1131             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  25
* EL640.cbl
  1132             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1133             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1134             88  ACCNT-CNTL                  VALUE '3'.
  1135             88  CARR-ACCNT-CNTL             VALUE '4'.
  1136
  1137         16  PI-PROCESSOR-CAP-LIST.
  1138             20  PI-SYSTEM-CONTROLS.
  1139                24 PI-SYSTEM-DISPLAY     PIC X.
  1140                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1141                24 PI-SYSTEM-MODIFY      PIC X.
  1142                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1143             20  FILLER                  PIC XX.
  1144             20  PI-DISPLAY-CAP          PIC X.
  1145                 88  DISPLAY-CAP             VALUE 'Y'.
  1146             20  PI-MODIFY-CAP           PIC X.
  1147                 88  MODIFY-CAP              VALUE 'Y'.
  1148             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1149                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1150             20  PI-FORCE-CAP            PIC X.
  1151                 88  FORCE-CAP               VALUE 'Y'.
  1152
  1153         16  PI-PROGRAM-CONTROLS.
  1154             20  PI-PGM-PRINT-OPT        PIC X.
  1155             20  PI-PGM-FORMAT-OPT       PIC X.
  1156             20  PI-PGM-PROCESS-OPT      PIC X.
  1157             20  PI-PGM-TOTALS-OPT       PIC X.
  1158
  1159         16  PI-HELP-INTERFACE.
  1160             20  PI-LAST-ERROR-NO        PIC X(4).
  1161             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1162
  1163         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1164             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1165
  1166         16  PI-CR-CONTROL-IN-PROGRESS.
  1167             20  PI-CR-CARRIER           PIC X.
  1168             20  PI-CR-GROUPING          PIC X(6).
  1169             20  PI-CR-STATE             PIC XX.
  1170             20  PI-CR-ACCOUNT           PIC X(10).
  1171             20  PI-CR-FIN-RESP          PIC X(10).
  1172             20  PI-CR-TYPE              PIC X.
  1173
  1174         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1175
  1176         16  PI-CR-MONTH-END-DT          PIC XX.
  1177
  1178         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1179             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1180             88  PI-ZERO-CARRIER             VALUE '1'.
  1181             88  PI-ZERO-GROUPING            VALUE '2'.
  1182             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1183
  1184         16  PI-CARRIER-SECURITY         PIC X.
  1185             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1186
  1187         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1188             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1189             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  26
* EL640.cbl
  1190
  1191         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1192             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1193                                         INDEXED BY PI-ACCESS-NDX
  1194                                         PIC X.
  1195
  1196         16  PI-GA-BILLING-CONTROL       PIC X.
  1197             88  PI-GA-BILLING               VALUE '1'.
  1198
  1199         16  PI-MAIL-PROCESSING          PIC X.
  1200             88  PI-MAIL-YES                 VALUE 'Y'.
  1201
  1202         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1203
  1204         16  PI-AR-SYSTEM.
  1205             20  PI-AR-PROCESSING-CNTL   PIC X.
  1206                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1207             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1208             20  PI-AR-MONTH-END-DT      PIC XX.
  1209
  1210         16  PI-MP-SYSTEM.
  1211             20  PI-MORTGAGE-USER            PIC X.
  1212                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1213                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1214             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1215                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1216                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1217                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1218                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1219                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1220             20  PI-MP-MONTH-END-DT          PIC XX.
  1221             20  PI-MP-REFERENCE-NO.
  1222                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1223                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1224
  1225         16  PI-LABEL-CONTROL            PIC X(01).
  1226             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1227             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1228
  1229         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1230             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1231
  1232         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1233             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1234             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1235
  1236         16  FILLER                      PIC X(14).
  1237
  1238     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1239******************************************************************
  1240     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1241         16  PI-MAP-NAME         PIC X(8).
  1242         16  PI-ACCT-NAME        PIC X(30).
  1243         16  PI-SAV-REMIT-TO     PIC X(10).
  1244         16  PI-SAV-ACCT         PIC X(10).
  1245         16  PI-SAV-CARR         PIC X.
  1246         16  PI-SAV-GROUP        PIC X(6).
  1247         16  PI-SAV-STATE        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  27
* EL640.cbl
  1248         16  PI-SAV-EXP-DT       PIC XX.
  1249         16  PI-BAL-FRWD-GA      PIC S9(7)V99   COMP-3.
  1250         16  PI-BAL-FRWD         PIC S9(7)V99   COMP-3.
  1251         16  PI-PREMIUM          PIC S9(7)V99   COMP-3.
  1252         16  PI-REMITTED         PIC S9(7)V99   COMP-3.
  1253         16  PI-TOT-ISS-COMP     PIC S9(7)V99   COMP-3.
  1254         16  PI-TOT-CAN-COMP     PIC S9(7)V99   COMP-3.
  1255         16  PI-ADJUSTMENTS      PIC S9(7)V99   COMP-3.
  1256         16  PI-DISBURSED        PIC S9(7)V99   COMP-3.
  1257         16  PI-END-BAL          PIC S9(7)V99   COMP-3.
  1258         16  PI-LF-ISS-COMP      PIC S9(7)V99   COMP-3.
  1259         16  PI-AH-ISS-COMP      PIC S9(7)V99   COMP-3.
  1260         16  PI-LF-CAN-COMP      PIC S9(7)V99   COMP-3.
  1261         16  PI-AH-CAN-COMP      PIC S9(7)V99   COMP-3.
  1262         16  PI-LIMIT-BILLING-BTCHS.
  1263             20  PI-BILLING-BATCHES   OCCURS 3 TIMES
  1264                                 PIC X(6).
  1265         16  PI-BILL-TYPE        PIC X.
  1266             88  PI-PREV-BILL        VALUE '1'.
  1267             88  PI-PREV-REBILL      VALUE '2'.
  1268             88  PI-PREVIEW          VALUE '1' '2'.
  1269             88  PI-BILL             VALUE '3'.
  1270             88  PI-REBILLING        VALUE '4'.
  1271             88  PI-VOID-BILL        VALUE '5'.
  1272             88  PI-TOT-REBILL       VALUE '2' '4'.
  1273             88  PI-UPDATE-FILES     VALUE '3' '4' '5'.
  1274             88  PI-BILLING-FUNCTION VALUE '1' '2' '3' '4'.
  1275         16  PI-BILL-ERRS        PIC X.
  1276         16  PI-CHECK-SW         PIC X.
  1277             88  PI-CHECK-PRODUCED   VALUE 'Y'.
  1278         16  PI-DATA-BILLED-SW   PIC X.
  1279             88  PI-DATA-BILLED      VALUE 'Y'.
  1280         16  PI-MONTH-END-DATE.
  1281             20  PI-ME-MONTH     PIC 99.
  1282             20  FILLER          PIC X.
  1283             20  PI-ME-DAY       PIC 99.
  1284             20  FILLER          PIC X.
  1285             20  PI-ME-YEAR      PIC 99.
  1286         16  PI-BILLING-COUNTS.
  1287             20  FILLER OCCURS 6 TIMES INDEXED BY PINDX.
  1288                 24  PI-BATCH    PIC X(6).
  1289                 24  PI-BILLED   PIC 9(6)  COMP-3.
  1290                 24  PI-PREV     PIC 9(6)  COMP-3.
  1291                 24  PI-NOBILL   PIC 9(6)  COMP-3.
  1292                 24  PI-PREM     PIC S9(7)V99   COMP-3.
  1293                 24  PI-COMM     PIC S9(7)V99   COMP-3.
  1294                 24  PI-NON-PREM PIC S9(7)V99   COMP-3.
  1295                 24  PI-NON-COMM PIC S9(7)V99   COMP-3.
  1296         16  PI-COMP-CONTROL.
  1297             20  PI-COMP-CARRIER     PIC X.
  1298             20  PI-COMP-GROUPING    PIC X(6).
  1299             20  PI-COMP-FIN-RESP    PIC X(10).
  1300         16  PI-SCRN-CONTROL.
  1301             20  PI-SCR-CARRIER      PIC X.
  1302             20  PI-SCR-GROUPING     PIC X(6).
  1303             20  PI-SCR-STATE        PIC X(02).
  1304             20  PI-SCR-ACCOUNT      PIC X(10).
  1305             20  PI-SCR-FIN-RESP     PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  28
* EL640.cbl
  1306             20  PI-SCR-TYPE         PIC X.
  1307         16  PI-TRANSFER-SW          PIC X.
  1308             88  PI-TRANSFER-BEFORE-ACT   VALUE 'Y'.
  1309         16  FILLER                  PIC X(200).
  1310
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  29
* EL640.cbl
  1312*                            COPY ELCJPFX.
  1313******************************************************************
  1314*                                                                *
  1315*                                                                *
  1316*                            ELCJPFX.                            *
  1317*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1318*                            VMOD=2.002                          *
  1319*                                                                *
  1320*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1321*                                                                *
  1322*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1323*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1324*        ELCNTL - CONTROL FILE                                   *
  1325*        ELMSTR - CLAIM MASTERS                                  *
  1326*        ELTRLR - ACTIVITY TRAILERS                              *
  1327*        ELCHKQ - CHECK QUE                                      *
  1328******************************************************************
  1329 01  JOURNAL-RECORD.
  1330     12  jp-date                     pic s9(5) comp-3.
  1331     12  jp-time                     pic s9(7) comp-3.
  1332     12  JP-USER-ID                  PIC X(4).
  1333     12  JP-FILE-ID                  PIC X(8).
  1334     12  JP-PROGRAM-ID               PIC X(8).
  1335     12  JP-RECORD-TYPE              PIC X.
  1336         88 JP-ADD              VALUE 'A'.
  1337         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1338         88 JP-AFTER-CHANGE     VALUE 'C'.
  1339         88 JP-DELETE           VALUE 'D'.
  1340         88 JP-GENERIC-DELETE   VALUE 'G'.
  1341         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1342         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1343     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1344     12  JP-RECORD-AREA
  1345
  1346
  1347                             PIC X(1464).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  30
* EL640.cbl
  1349*                            COPY ELCAID.
  1350******************************************************************
  1351*                                                                *
  1352*                            ELCAID.                             *
  1353*                            VMOD=2.001                          *
  1354*                                                                *
  1355*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1356*                                                                *
  1357*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1358*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1359******************************************************************
  1360
  1361 01  DFHAID.
  1362   02  DFHNULL   PIC  X  VALUE  ' '.
  1363   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1364   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1365   02  DFHPEN    PIC  X  VALUE  '='.
  1366   02  DFHOPID   PIC  X  VALUE  'W'.
  1367   02  DFHPA1    PIC  X  VALUE  '%'.
  1368   02  DFHPA2    PIC  X  VALUE  '>'.
  1369   02  DFHPA3    PIC  X  VALUE  ','.
  1370   02  DFHPF1    PIC  X  VALUE  '1'.
  1371   02  DFHPF2    PIC  X  VALUE  '2'.
  1372   02  DFHPF3    PIC  X  VALUE  '3'.
  1373   02  DFHPF4    PIC  X  VALUE  '4'.
  1374   02  DFHPF5    PIC  X  VALUE  '5'.
  1375   02  DFHPF6    PIC  X  VALUE  '6'.
  1376   02  DFHPF7    PIC  X  VALUE  '7'.
  1377   02  DFHPF8    PIC  X  VALUE  '8'.
  1378   02  DFHPF9    PIC  X  VALUE  '9'.
  1379   02  DFHPF10   PIC  X  VALUE  ':'.
  1380   02  DFHPF11   PIC  X  VALUE  '#'.
  1381   02  DFHPF12   PIC  X  VALUE  '@'.
  1382   02  DFHPF13   PIC  X  VALUE  'A'.
  1383   02  DFHPF14   PIC  X  VALUE  'B'.
  1384   02  DFHPF15   PIC  X  VALUE  'C'.
  1385   02  DFHPF16   PIC  X  VALUE  'D'.
  1386   02  DFHPF17   PIC  X  VALUE  'E'.
  1387   02  DFHPF18   PIC  X  VALUE  'F'.
  1388   02  DFHPF19   PIC  X  VALUE  'G'.
  1389   02  DFHPF20   PIC  X  VALUE  'H'.
  1390   02  DFHPF21   PIC  X  VALUE  'I'.
  1391*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1392   02  DFHPF22   PIC  X  VALUE  '['.
  1393   02  DFHPF23   PIC  X  VALUE  '.'.
  1394   02  DFHPF24   PIC  X  VALUE  '<'.
  1395   02  DFHMSRE   PIC  X  VALUE  'X'.
  1396   02  DFHSTRF   PIC  X  VALUE  'h'.
  1397   02  DFHTRIG   PIC  X  VALUE  '"'.
  1398 01  FILLER    REDEFINES DFHAID.
  1399     12  FILLER              PIC X(8).
  1400     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  31
* EL640.cbl
  1402*                                         COPY EL640S.
  1403 01  EL640AI.
  1404     05  FILLER            PIC  X(0012).
  1405*    -------------------------------
  1406     05  ADATEL PIC S9(0004) COMP.
  1407     05  ADATEF PIC  X(0001).
  1408     05  FILLER REDEFINES ADATEF.
  1409         10  ADATEA PIC  X(0001).
  1410     05  ADATEI PIC  X(0008).
  1411*    -------------------------------
  1412     05  ATIMEL PIC S9(0004) COMP.
  1413     05  ATIMEF PIC  X(0001).
  1414     05  FILLER REDEFINES ATIMEF.
  1415         10  ATIMEA PIC  X(0001).
  1416     05  ATIMEI PIC  X(0005).
  1417*    -------------------------------
  1418     05  CMPNYIDL PIC S9(0004) COMP.
  1419     05  CMPNYIDF PIC  X(0001).
  1420     05  FILLER REDEFINES CMPNYIDF.
  1421         10  CMPNYIDA PIC  X(0001).
  1422     05  CMPNYIDI PIC  X(0003).
  1423*    -------------------------------
  1424     05  USERIDL PIC S9(0004) COMP.
  1425     05  USERIDF PIC  X(0001).
  1426     05  FILLER REDEFINES USERIDF.
  1427         10  USERIDA PIC  X(0001).
  1428     05  USERIDI PIC  X(0004).
  1429*    -------------------------------
  1430     05  AACTNAML PIC S9(0004) COMP.
  1431     05  AACTNAMF PIC  X(0001).
  1432     05  FILLER REDEFINES AACTNAMF.
  1433         10  AACTNAMA PIC  X(0001).
  1434     05  AACTNAMI PIC  X(0030).
  1435*    -------------------------------
  1436     05  ACARHDGL PIC S9(0004) COMP.
  1437     05  ACARHDGF PIC  X(0001).
  1438     05  FILLER REDEFINES ACARHDGF.
  1439         10  ACARHDGA PIC  X(0001).
  1440     05  ACARHDGI PIC  X(0007).
  1441*    -------------------------------
  1442     05  AGRPHDGL PIC S9(0004) COMP.
  1443     05  AGRPHDGF PIC  X(0001).
  1444     05  FILLER REDEFINES AGRPHDGF.
  1445         10  AGRPHDGA PIC  X(0001).
  1446     05  AGRPHDGI PIC  X(0005).
  1447*    -------------------------------
  1448     05  ASTHDGL PIC S9(0004) COMP.
  1449     05  ASTHDGF PIC  X(0001).
  1450     05  FILLER REDEFINES ASTHDGF.
  1451         10  ASTHDGA PIC  X(0001).
  1452     05  ASTHDGI PIC  X(0005).
  1453*    -------------------------------
  1454     05  AACCTL PIC S9(0004) COMP.
  1455     05  AACCTF PIC  X(0001).
  1456     05  FILLER REDEFINES AACCTF.
  1457         10  AACCTA PIC  X(0001).
  1458     05  AACCTI PIC  X(0010).
  1459*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  32
* EL640.cbl
  1460     05  ACARIERL PIC S9(0004) COMP.
  1461     05  ACARIERF PIC  X(0001).
  1462     05  FILLER REDEFINES ACARIERF.
  1463         10  ACARIERA PIC  X(0001).
  1464     05  ACARIERI PIC  X(0001).
  1465*    -------------------------------
  1466     05  AGROUPL PIC S9(0004) COMP.
  1467     05  AGROUPF PIC  X(0001).
  1468     05  FILLER REDEFINES AGROUPF.
  1469         10  AGROUPA PIC  X(0001).
  1470     05  AGROUPI PIC  X(0006).
  1471*    -------------------------------
  1472     05  ASTATEL PIC S9(0004) COMP.
  1473     05  ASTATEF PIC  X(0001).
  1474     05  FILLER REDEFINES ASTATEF.
  1475         10  ASTATEA PIC  X(0001).
  1476     05  ASTATEI PIC  X(0002).
  1477*    -------------------------------
  1478     05  ABALFWDL PIC S9(0004) COMP.
  1479     05  ABALFWDF PIC  X(0001).
  1480     05  FILLER REDEFINES ABALFWDF.
  1481         10  ABALFWDA PIC  X(0001).
  1482     05  ABALFWDI PIC  X(0011).
  1483*    -------------------------------
  1484     05  APREMUML PIC S9(0004) COMP.
  1485     05  APREMUMF PIC  X(0001).
  1486     05  FILLER REDEFINES APREMUMF.
  1487         10  APREMUMA PIC  X(0001).
  1488     05  APREMUMI PIC  X(0011).
  1489*    -------------------------------
  1490     05  AHD1L PIC S9(0004) COMP.
  1491     05  AHD1F PIC  X(0001).
  1492     05  FILLER REDEFINES AHD1F.
  1493         10  AHD1A PIC  X(0001).
  1494     05  AHD1I PIC  X(0018).
  1495*    -------------------------------
  1496     05  AREMITL PIC S9(0004) COMP.
  1497     05  AREMITF PIC  X(0001).
  1498     05  FILLER REDEFINES AREMITF.
  1499         10  AREMITA PIC  X(0001).
  1500     05  AREMITI PIC  X(0011).
  1501*    -------------------------------
  1502     05  ABATCH1L PIC S9(0004) COMP.
  1503     05  ABATCH1F PIC  X(0001).
  1504     05  FILLER REDEFINES ABATCH1F.
  1505         10  ABATCH1A PIC  X(0001).
  1506     05  ABATCH1I PIC  X(0006).
  1507*    -------------------------------
  1508     05  ABILL1L PIC S9(0004) COMP.
  1509     05  ABILL1F PIC  X(0001).
  1510     05  FILLER REDEFINES ABILL1F.
  1511         10  ABILL1A PIC  X(0001).
  1512     05  ABILL1I PIC  X(0006).
  1513*    -------------------------------
  1514     05  APREV1L PIC S9(0004) COMP.
  1515     05  APREV1F PIC  X(0001).
  1516     05  FILLER REDEFINES APREV1F.
  1517         10  APREV1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  33
* EL640.cbl
  1518     05  APREV1I PIC  X(0006).
  1519*    -------------------------------
  1520     05  ANOBIL1L PIC S9(0004) COMP.
  1521     05  ANOBIL1F PIC  X(0001).
  1522     05  FILLER REDEFINES ANOBIL1F.
  1523         10  ANOBIL1A PIC  X(0001).
  1524     05  ANOBIL1I PIC  X(0006).
  1525*    -------------------------------
  1526     05  AHD2L PIC S9(0004) COMP.
  1527     05  AHD2F PIC  X(0001).
  1528     05  FILLER REDEFINES AHD2F.
  1529         10  AHD2A PIC  X(0001).
  1530     05  AHD2I PIC  X(0018).
  1531*    -------------------------------
  1532     05  ACOMPISL PIC S9(0004) COMP.
  1533     05  ACOMPISF PIC  X(0001).
  1534     05  FILLER REDEFINES ACOMPISF.
  1535         10  ACOMPISA PIC  X(0001).
  1536     05  ACOMPISI PIC  X(0011).
  1537*    -------------------------------
  1538     05  ABATCH2L PIC S9(0004) COMP.
  1539     05  ABATCH2F PIC  X(0001).
  1540     05  FILLER REDEFINES ABATCH2F.
  1541         10  ABATCH2A PIC  X(0001).
  1542     05  ABATCH2I PIC  X(0006).
  1543*    -------------------------------
  1544     05  ABILL2L PIC S9(0004) COMP.
  1545     05  ABILL2F PIC  X(0001).
  1546     05  FILLER REDEFINES ABILL2F.
  1547         10  ABILL2A PIC  X(0001).
  1548     05  ABILL2I PIC  X(0006).
  1549*    -------------------------------
  1550     05  APREV2L PIC S9(0004) COMP.
  1551     05  APREV2F PIC  X(0001).
  1552     05  FILLER REDEFINES APREV2F.
  1553         10  APREV2A PIC  X(0001).
  1554     05  APREV2I PIC  X(0006).
  1555*    -------------------------------
  1556     05  ANOBIL2L PIC S9(0004) COMP.
  1557     05  ANOBIL2F PIC  X(0001).
  1558     05  FILLER REDEFINES ANOBIL2F.
  1559         10  ANOBIL2A PIC  X(0001).
  1560     05  ANOBIL2I PIC  X(0006).
  1561*    -------------------------------
  1562     05  AHD3L PIC S9(0004) COMP.
  1563     05  AHD3F PIC  X(0001).
  1564     05  FILLER REDEFINES AHD3F.
  1565         10  AHD3A PIC  X(0001).
  1566     05  AHD3I PIC  X(0018).
  1567*    -------------------------------
  1568     05  ACOMCANL PIC S9(0004) COMP.
  1569     05  ACOMCANF PIC  X(0001).
  1570     05  FILLER REDEFINES ACOMCANF.
  1571         10  ACOMCANA PIC  X(0001).
  1572     05  ACOMCANI PIC  X(0011).
  1573*    -------------------------------
  1574     05  ABATCH3L PIC S9(0004) COMP.
  1575     05  ABATCH3F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  34
* EL640.cbl
  1576     05  FILLER REDEFINES ABATCH3F.
  1577         10  ABATCH3A PIC  X(0001).
  1578     05  ABATCH3I PIC  X(0006).
  1579*    -------------------------------
  1580     05  ABILL3L PIC S9(0004) COMP.
  1581     05  ABILL3F PIC  X(0001).
  1582     05  FILLER REDEFINES ABILL3F.
  1583         10  ABILL3A PIC  X(0001).
  1584     05  ABILL3I PIC  X(0006).
  1585*    -------------------------------
  1586     05  APREV3L PIC S9(0004) COMP.
  1587     05  APREV3F PIC  X(0001).
  1588     05  FILLER REDEFINES APREV3F.
  1589         10  APREV3A PIC  X(0001).
  1590     05  APREV3I PIC  X(0006).
  1591*    -------------------------------
  1592     05  ANOBIL3L PIC S9(0004) COMP.
  1593     05  ANOBIL3F PIC  X(0001).
  1594     05  FILLER REDEFINES ANOBIL3F.
  1595         10  ANOBIL3A PIC  X(0001).
  1596     05  ANOBIL3I PIC  X(0006).
  1597*    -------------------------------
  1598     05  AHD4L PIC S9(0004) COMP.
  1599     05  AHD4F PIC  X(0001).
  1600     05  FILLER REDEFINES AHD4F.
  1601         10  AHD4A PIC  X(0001).
  1602     05  AHD4I PIC  X(0018).
  1603*    -------------------------------
  1604     05  AADJUSTL PIC S9(0004) COMP.
  1605     05  AADJUSTF PIC  X(0001).
  1606     05  FILLER REDEFINES AADJUSTF.
  1607         10  AADJUSTA PIC  X(0001).
  1608     05  AADJUSTI PIC  X(0011).
  1609*    -------------------------------
  1610     05  ABATCH4L PIC S9(0004) COMP.
  1611     05  ABATCH4F PIC  X(0001).
  1612     05  FILLER REDEFINES ABATCH4F.
  1613         10  ABATCH4A PIC  X(0001).
  1614     05  ABATCH4I PIC  X(0006).
  1615*    -------------------------------
  1616     05  ABILL4L PIC S9(0004) COMP.
  1617     05  ABILL4F PIC  X(0001).
  1618     05  FILLER REDEFINES ABILL4F.
  1619         10  ABILL4A PIC  X(0001).
  1620     05  ABILL4I PIC  X(0006).
  1621*    -------------------------------
  1622     05  APREV4L PIC S9(0004) COMP.
  1623     05  APREV4F PIC  X(0001).
  1624     05  FILLER REDEFINES APREV4F.
  1625         10  APREV4A PIC  X(0001).
  1626     05  APREV4I PIC  X(0006).
  1627*    -------------------------------
  1628     05  ANOBIL4L PIC S9(0004) COMP.
  1629     05  ANOBIL4F PIC  X(0001).
  1630     05  FILLER REDEFINES ANOBIL4F.
  1631         10  ANOBIL4A PIC  X(0001).
  1632     05  ANOBIL4I PIC  X(0006).
  1633*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  35
* EL640.cbl
  1634     05  AHD5L PIC S9(0004) COMP.
  1635     05  AHD5F PIC  X(0001).
  1636     05  FILLER REDEFINES AHD5F.
  1637         10  AHD5A PIC  X(0001).
  1638     05  AHD5I PIC  X(0018).
  1639*    -------------------------------
  1640     05  ADISBURL PIC S9(0004) COMP.
  1641     05  ADISBURF PIC  X(0001).
  1642     05  FILLER REDEFINES ADISBURF.
  1643         10  ADISBURA PIC  X(0001).
  1644     05  ADISBURI PIC  X(0011).
  1645*    -------------------------------
  1646     05  ABATCH5L PIC S9(0004) COMP.
  1647     05  ABATCH5F PIC  X(0001).
  1648     05  FILLER REDEFINES ABATCH5F.
  1649         10  ABATCH5A PIC  X(0001).
  1650     05  ABATCH5I PIC  X(0006).
  1651*    -------------------------------
  1652     05  ABILL5L PIC S9(0004) COMP.
  1653     05  ABILL5F PIC  X(0001).
  1654     05  FILLER REDEFINES ABILL5F.
  1655         10  ABILL5A PIC  X(0001).
  1656     05  ABILL5I PIC  X(0006).
  1657*    -------------------------------
  1658     05  APREV5L PIC S9(0004) COMP.
  1659     05  APREV5F PIC  X(0001).
  1660     05  FILLER REDEFINES APREV5F.
  1661         10  APREV5A PIC  X(0001).
  1662     05  APREV5I PIC  X(0006).
  1663*    -------------------------------
  1664     05  ANOBIL5L PIC S9(0004) COMP.
  1665     05  ANOBIL5F PIC  X(0001).
  1666     05  FILLER REDEFINES ANOBIL5F.
  1667         10  ANOBIL5A PIC  X(0001).
  1668     05  ANOBIL5I PIC  X(0006).
  1669*    -------------------------------
  1670     05  AENDHDGL PIC S9(0004) COMP.
  1671     05  AENDHDGF PIC  X(0001).
  1672     05  FILLER REDEFINES AENDHDGF.
  1673         10  AENDHDGA PIC  X(0001).
  1674     05  AENDHDGI PIC  X(0018).
  1675*    -------------------------------
  1676     05  ANETDUEL PIC S9(0004) COMP.
  1677     05  ANETDUEF PIC  X(0001).
  1678     05  FILLER REDEFINES ANETDUEF.
  1679         10  ANETDUEA PIC  X(0001).
  1680     05  ANETDUEI PIC  X(0011).
  1681*    -------------------------------
  1682     05  ABATCH6L PIC S9(0004) COMP.
  1683     05  ABATCH6F PIC  X(0001).
  1684     05  FILLER REDEFINES ABATCH6F.
  1685         10  ABATCH6A PIC  X(0001).
  1686     05  ABATCH6I PIC  X(0006).
  1687*    -------------------------------
  1688     05  ABILL6L PIC S9(0004) COMP.
  1689     05  ABILL6F PIC  X(0001).
  1690     05  FILLER REDEFINES ABILL6F.
  1691         10  ABILL6A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  36
* EL640.cbl
  1692     05  ABILL6I PIC  X(0006).
  1693*    -------------------------------
  1694     05  APREV6L PIC S9(0004) COMP.
  1695     05  APREV6F PIC  X(0001).
  1696     05  FILLER REDEFINES APREV6F.
  1697         10  APREV6A PIC  X(0001).
  1698     05  APREV6I PIC  X(0006).
  1699*    -------------------------------
  1700     05  ANOBIL6L PIC S9(0004) COMP.
  1701     05  ANOBIL6F PIC  X(0001).
  1702     05  FILLER REDEFINES ANOBIL6F.
  1703         10  ANOBIL6A PIC  X(0001).
  1704     05  ANOBIL6I PIC  X(0006).
  1705*    -------------------------------
  1706     05  ABILTYPL PIC S9(0004) COMP.
  1707     05  ABILTYPF PIC  X(0001).
  1708     05  FILLER REDEFINES ABILTYPF.
  1709         10  ABILTYPA PIC  X(0001).
  1710     05  ABILTYPI PIC  X(0001).
  1711*    -------------------------------
  1712     05  APRODSWL PIC S9(0004) COMP.
  1713     05  APRODSWF PIC  X(0001).
  1714     05  FILLER REDEFINES APRODSWF.
  1715         10  APRODSWA PIC  X(0001).
  1716     05  APRODSWI PIC  X(0001).
  1717*    -------------------------------
  1718     05  ABILERRL PIC S9(0004) COMP.
  1719     05  ABILERRF PIC  X(0001).
  1720     05  FILLER REDEFINES ABILERRF.
  1721         10  ABILERRA PIC  X(0001).
  1722     05  ABILERRI PIC  X(0001).
  1723*    -------------------------------
  1724     05  ABTCH1L PIC S9(0004) COMP.
  1725     05  ABTCH1F PIC  X(0001).
  1726     05  FILLER REDEFINES ABTCH1F.
  1727         10  ABTCH1A PIC  X(0001).
  1728     05  ABTCH1I PIC  X(0006).
  1729*    -------------------------------
  1730     05  ABTCH2L PIC S9(0004) COMP.
  1731     05  ABTCH2F PIC  X(0001).
  1732     05  FILLER REDEFINES ABTCH2F.
  1733         10  ABTCH2A PIC  X(0001).
  1734     05  ABTCH2I PIC  X(0006).
  1735*    -------------------------------
  1736     05  ABTCH3L PIC S9(0004) COMP.
  1737     05  ABTCH3F PIC  X(0001).
  1738     05  FILLER REDEFINES ABTCH3F.
  1739         10  ABTCH3A PIC  X(0001).
  1740     05  ABTCH3I PIC  X(0006).
  1741*    -------------------------------
  1742     05  AERMSG1L PIC S9(0004) COMP.
  1743     05  AERMSG1F PIC  X(0001).
  1744     05  FILLER REDEFINES AERMSG1F.
  1745         10  AERMSG1A PIC  X(0001).
  1746     05  AERMSG1I PIC  X(0076).
  1747*    -------------------------------
  1748     05  AERMSG2L PIC S9(0004) COMP.
  1749     05  AERMSG2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  37
* EL640.cbl
  1750     05  FILLER REDEFINES AERMSG2F.
  1751         10  AERMSG2A PIC  X(0001).
  1752     05  AERMSG2I PIC  X(0076).
  1753*    -------------------------------
  1754     05  APFNTERL PIC S9(0004) COMP.
  1755     05  APFNTERF PIC  X(0001).
  1756     05  FILLER REDEFINES APFNTERF.
  1757         10  APFNTERA PIC  X(0001).
  1758     05  APFNTERI PIC  9(2).
  1759*    -------------------------------
  1760     05  APF5HDGL PIC S9(0004) COMP.
  1761     05  APF5HDGF PIC  X(0001).
  1762     05  FILLER REDEFINES APF5HDGF.
  1763         10  APF5HDGA PIC  X(0001).
  1764     05  APF5HDGI PIC  X(0020).
  1765*    -------------------------------
  1766     05  AGAHDGL PIC S9(0004) COMP.
  1767     05  AGAHDGF PIC  X(0001).
  1768     05  FILLER REDEFINES AGAHDGF.
  1769         10  AGAHDGA PIC  X(0001).
  1770     05  AGAHDGI PIC  X(0025).
  1771 01  EL640AO REDEFINES EL640AI.
  1772     05  FILLER            PIC  X(0012).
  1773*    -------------------------------
  1774     05  FILLER            PIC  X(0003).
  1775     05  ADATEO PIC  X(0008).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  ATIMEO PIC  99.99.
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
  1781     05  CMPNYIDO PIC  X(0003).
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
  1784     05  USERIDO PIC  X(0004).
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
  1787     05  AACTNAMO PIC  X(0030).
  1788*    -------------------------------
  1789     05  FILLER            PIC  X(0003).
  1790     05  ACARHDGO PIC  X(0007).
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  AGRPHDGO PIC  X(0005).
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  ASTHDGO PIC  X(0005).
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  AACCTO PIC  X(0010).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  ACARIERO PIC  X(0001).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  AGROUPO PIC  X(0006).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  38
* EL640.cbl
  1808     05  ASTATEO PIC  X(0002).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  ABALFWDO PIC  ZZZZZZ9.99-.
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  APREMUMO PIC  ZZZZZZ9.99-.
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  AHD1O PIC  X(0018).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  AREMITO PIC  ZZZZZZ9.99-.
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  ABATCH1O PIC  X(0006).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  ABILL1O PIC  Z(5)9.
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  APREV1O PIC  Z(5)9.
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  ANOBIL1O PIC  Z(5)9.
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  AHD2O PIC  X(0018).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  ACOMPISO PIC  ZZZZZZ9.99-.
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  ABATCH2O PIC  X(0006).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  ABILL2O PIC  Z(5)9.
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  APREV2O PIC  Z(5)9.
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  ANOBIL2O PIC  Z(5)9.
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  AHD3O PIC  X(0018).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  ACOMCANO PIC  ZZZZZZ9.99-.
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  ABATCH3O PIC  X(0006).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  ABILL3O PIC  Z(5)9.
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  APREV3O PIC  Z(5)9.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  39
* EL640.cbl
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  ANOBIL3O PIC  Z(5)9.
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  AHD4O PIC  X(0018).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  AADJUSTO PIC  ZZZZZZ9.99-.
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  ABATCH4O PIC  X(0006).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  ABILL4O PIC  Z(5)9.
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  APREV4O PIC  Z(5)9.
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  ANOBIL4O PIC  Z(5)9.
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  AHD5O PIC  X(0018).
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  ADISBURO PIC  ZZZZZZ9.99-.
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
  1895     05  ABATCH5O PIC  X(0006).
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  ABILL5O PIC  Z(5)9.
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  APREV5O PIC  Z(5)9.
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  ANOBIL5O PIC  Z(5)9.
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  AENDHDGO PIC  X(0018).
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  ANETDUEO PIC  ZZZZZZ9.99-.
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  ABATCH6O PIC  X(0006).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  ABILL6O PIC  Z(5)9.
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  APREV6O PIC  Z(5)9.
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  ANOBIL6O PIC  Z(5)9.
  1923*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  40
* EL640.cbl
  1924     05  FILLER            PIC  X(0003).
  1925     05  ABILTYPO PIC  X(0001).
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
  1928     05  APRODSWO PIC  X(0001).
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  ABILERRO PIC  X(0001).
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  ABTCH1O PIC  X(0006).
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  ABTCH2O PIC  X(0006).
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
  1940     05  ABTCH3O PIC  X(0006).
  1941*    -------------------------------
  1942     05  FILLER            PIC  X(0003).
  1943     05  AERMSG1O PIC  X(0076).
  1944*    -------------------------------
  1945     05  FILLER            PIC  X(0003).
  1946     05  AERMSG2O PIC  X(0076).
  1947*    -------------------------------
  1948     05  FILLER            PIC  X(0003).
  1949     05  APFNTERO PIC  99.
  1950*    -------------------------------
  1951     05  FILLER            PIC  X(0003).
  1952     05  APF5HDGO PIC  X(0020).
  1953*    -------------------------------
  1954     05  FILLER            PIC  X(0003).
  1955     05  AGAHDGO PIC  X(0025).
  1956*    -------------------------------
  1957 01  EL640BI REDEFINES EL640AI.
  1958     05  FILLER            PIC  X(0012).
  1959*    -------------------------------
  1960     05  BDATEL PIC S9(0004) COMP.
  1961     05  BDATEF PIC  X(0001).
  1962     05  FILLER REDEFINES BDATEF.
  1963         10  BDATEA PIC  X(0001).
  1964     05  BDATEI PIC  X(0008).
  1965*    -------------------------------
  1966     05  BTIMEL PIC S9(0004) COMP.
  1967     05  BTIMEF PIC  X(0001).
  1968     05  FILLER REDEFINES BTIMEF.
  1969         10  BTIMEA PIC  X(0001).
  1970     05  BTIMEI PIC  X(0005).
  1971*    -------------------------------
  1972     05  BCMPNYL PIC S9(0004) COMP.
  1973     05  BCMPNYF PIC  X(0001).
  1974     05  FILLER REDEFINES BCMPNYF.
  1975         10  BCMPNYA PIC  X(0001).
  1976     05  BCMPNYI PIC  X(0003).
  1977*    -------------------------------
  1978     05  BUSERIDL PIC S9(0004) COMP.
  1979     05  BUSERIDF PIC  X(0001).
  1980     05  FILLER REDEFINES BUSERIDF.
  1981         10  BUSERIDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  41
* EL640.cbl
  1982     05  BUSERIDI PIC  X(0004).
  1983*    -------------------------------
  1984     05  BCHKNOL PIC S9(0004) COMP.
  1985     05  BCHKNOF PIC  X(0001).
  1986     05  FILLER REDEFINES BCHKNOF.
  1987         10  BCHKNOA PIC  X(0001).
  1988     05  BCHKNOI PIC  9(6).
  1989*    -------------------------------
  1990     05  BNAMEL PIC S9(0004) COMP.
  1991     05  BNAMEF PIC  X(0001).
  1992     05  FILLER REDEFINES BNAMEF.
  1993         10  BNAMEA PIC  X(0001).
  1994     05  BNAMEI PIC  X(0029).
  1995*    -------------------------------
  1996     05  BCHKAMTL PIC S9(0004) COMP.
  1997     05  BCHKAMTF PIC  X(0001).
  1998     05  FILLER REDEFINES BCHKAMTF.
  1999         10  BCHKAMTA PIC  X(0001).
  2000     05  BCHKAMTI PIC  S9(9)V99.
  2001*    -------------------------------
  2002     05  BADDR1L PIC S9(0004) COMP.
  2003     05  BADDR1F PIC  X(0001).
  2004     05  FILLER REDEFINES BADDR1F.
  2005         10  BADDR1A PIC  X(0001).
  2006     05  BADDR1I PIC  X(0029).
  2007*    -------------------------------
  2008     05  BADDR2L PIC S9(0004) COMP.
  2009     05  BADDR2F PIC  X(0001).
  2010     05  FILLER REDEFINES BADDR2F.
  2011         10  BADDR2A PIC  X(0001).
  2012     05  BADDR2I PIC  X(0029).
  2013*    -------------------------------
  2014     05  BPAYDT1L PIC S9(0004) COMP.
  2015     05  BPAYDT1F PIC  X(0001).
  2016     05  FILLER REDEFINES BPAYDT1F.
  2017         10  BPAYDT1A PIC  X(0001).
  2018     05  BPAYDT1I PIC  X(0008).
  2019*    -------------------------------
  2020     05  BCITYSTL PIC S9(0004) COMP.
  2021     05  BCITYSTF PIC  X(0001).
  2022     05  FILLER REDEFINES BCITYSTF.
  2023         10  BCITYSTA PIC  X(0001).
  2024     05  BCITYSTI PIC  X(0029).
  2025*    -------------------------------
  2026     05  BPAYDT2L PIC S9(0004) COMP.
  2027     05  BPAYDT2F PIC  X(0001).
  2028     05  FILLER REDEFINES BPAYDT2F.
  2029         10  BPAYDT2A PIC  X(0001).
  2030     05  BPAYDT2I PIC  X(0008).
  2031*    -------------------------------
  2032     05  BZIPL PIC S9(0004) COMP.
  2033     05  BZIPF PIC  X(0001).
  2034     05  FILLER REDEFINES BZIPF.
  2035         10  BZIPA PIC  X(0001).
  2036     05  BZIPI PIC  X(0010).
  2037*    -------------------------------
  2038     05  BACCNAML PIC S9(0004) COMP.
  2039     05  BACCNAMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  42
* EL640.cbl
  2040     05  FILLER REDEFINES BACCNAMF.
  2041         10  BACCNAMA PIC  X(0001).
  2042     05  BACCNAMI PIC  X(0030).
  2043*    -------------------------------
  2044     05  BACCTL PIC S9(0004) COMP.
  2045     05  BACCTF PIC  X(0001).
  2046     05  FILLER REDEFINES BACCTF.
  2047         10  BACCTA PIC  X(0001).
  2048     05  BACCTI PIC  X(0010).
  2049*    -------------------------------
  2050     05  BCARIERL PIC S9(0004) COMP.
  2051     05  BCARIERF PIC  X(0001).
  2052     05  FILLER REDEFINES BCARIERF.
  2053         10  BCARIERA PIC  X(0001).
  2054     05  BCARIERI PIC  X(0001).
  2055*    -------------------------------
  2056     05  BGROUPL PIC S9(0004) COMP.
  2057     05  BGROUPF PIC  X(0001).
  2058     05  FILLER REDEFINES BGROUPF.
  2059         10  BGROUPA PIC  X(0001).
  2060     05  BGROUPI PIC  X(0006).
  2061*    -------------------------------
  2062     05  BSTATEL PIC S9(0004) COMP.
  2063     05  BSTATEF PIC  X(0001).
  2064     05  FILLER REDEFINES BSTATEF.
  2065         10  BSTATEA PIC  X(0001).
  2066     05  BSTATEI PIC  X(0002).
  2067*    -------------------------------
  2068     05  BFORM1L PIC S9(0004) COMP.
  2069     05  BFORM1F PIC  X(0001).
  2070     05  FILLER REDEFINES BFORM1F.
  2071         10  BFORM1A PIC  X(0001).
  2072     05  BFORM1I PIC  X(0004).
  2073*    -------------------------------
  2074     05  BFORM2L PIC S9(0004) COMP.
  2075     05  BFORM2F PIC  X(0001).
  2076     05  FILLER REDEFINES BFORM2F.
  2077         10  BFORM2A PIC  X(0001).
  2078     05  BFORM2I PIC  X(0004).
  2079*    -------------------------------
  2080     05  BFORM3L PIC S9(0004) COMP.
  2081     05  BFORM3F PIC  X(0001).
  2082     05  FILLER REDEFINES BFORM3F.
  2083         10  BFORM3A PIC  X(0001).
  2084     05  BFORM3I PIC  X(0004).
  2085*    -------------------------------
  2086     05  BALAMTL PIC S9(0004) COMP.
  2087     05  BALAMTF PIC  X(0001).
  2088     05  FILLER REDEFINES BALAMTF.
  2089         10  BALAMTA PIC  X(0001).
  2090     05  BALAMTI PIC  X(0011).
  2091*    -------------------------------
  2092     05  BERMSGL PIC S9(0004) COMP.
  2093     05  BERMSGF PIC  X(0001).
  2094     05  FILLER REDEFINES BERMSGF.
  2095         10  BERMSGA PIC  X(0001).
  2096     05  BERMSGI PIC  X(0078).
  2097*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  43
* EL640.cbl
  2098     05  BPFNTERL PIC S9(0004) COMP.
  2099     05  BPFNTERF PIC  X(0001).
  2100     05  FILLER REDEFINES BPFNTERF.
  2101         10  BPFNTERA PIC  X(0001).
  2102     05  BPFNTERI PIC  9(2).
  2103 01  EL640BO REDEFINES EL640AI.
  2104     05  FILLER            PIC  X(0012).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  BDATEO PIC  X(0008).
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  BTIMEO PIC  99.99.
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  BCMPNYO PIC  X(0003).
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  BUSERIDO PIC  X(0004).
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  BCHKNOO PIC  X(0006).
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  BNAMEO PIC  X(0029).
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  BCHKAMTO PIC  Z(7).ZZ-.
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  BADDR1O PIC  X(0029).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  BADDR2O PIC  X(0029).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  BPAYDT1O PIC  X(0008).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  BCITYSTO PIC  X(0029).
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  BPAYDT2O PIC  X(0008).
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  BZIPO PIC  X(0010).
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  BACCNAMO PIC  X(0030).
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  BACCTO PIC  X(0010).
  2150*    -------------------------------
  2151     05  FILLER            PIC  X(0003).
  2152     05  BCARIERO PIC  X(0001).
  2153*    -------------------------------
  2154     05  FILLER            PIC  X(0003).
  2155     05  BGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  44
* EL640.cbl
  2156*    -------------------------------
  2157     05  FILLER            PIC  X(0003).
  2158     05  BSTATEO PIC  X(0002).
  2159*    -------------------------------
  2160     05  FILLER            PIC  X(0003).
  2161     05  BFORM1O PIC  X(0004).
  2162*    -------------------------------
  2163     05  FILLER            PIC  X(0003).
  2164     05  BFORM2O PIC  X(0004).
  2165*    -------------------------------
  2166     05  FILLER            PIC  X(0003).
  2167     05  BFORM3O PIC  X(0004).
  2168*    -------------------------------
  2169     05  FILLER            PIC  X(0003).
  2170     05  BALAMTO PIC  Z(7).99-.
  2171*    -------------------------------
  2172     05  FILLER            PIC  X(0003).
  2173     05  BERMSGO PIC  X(0078).
  2174*    -------------------------------
  2175     05  FILLER            PIC  X(0003).
  2176     05  BPFNTERO PIC  9(2).
  2177*    -------------------------------
  2178 01  MAP-A REDEFINES EL640AO.
  2179     12  FILLER                  PIC X(162).
  2180     12  FILLER OCCURS 6 TIMES INDEXED BY ANDX.
  2181         16  FILLER              PIC X(35).
  2182         16  BATCH-LEN           PIC S9(4)   COMP.
  2183         16  BATCH-ATTRB         PIC X.
  2184         16  BATCH               PIC X(6).
  2185         16  BILL-LEN            PIC S9(4)   COMP.
  2186         16  BILL-ATTRB          PIC X.
  2187         16  BILL                PIC Z(6).
  2188         16  PREV-LEN            PIC S9(4)   COMP.
  2189         16  PREV-ATTRB          PIC X.
  2190         16  PREV                PIC Z(6).
  2191         16  NOBILL-LEN          PIC S9(4)   COMP.
  2192         16  NOBILL-ATTRB        PIC X.
  2193         16  NOBILL              PIC Z(6).
  2194****************************************************************
  2195*
  2196* Copyright (c) 2007 by Clerity Solutions, Inc.
  2197* All rights reserved.
  2198*
  2199****************************************************************
  2200 01  DFHEIV.
  2201   02  DFHEIV0               PIC X(35).
  2202   02  DFHEIV1               PIC X(08).
  2203   02  DFHEIV2               PIC X(08).
  2204   02  DFHEIV3               PIC X(08).
  2205   02  DFHEIV4               PIC X(06).
  2206   02  DFHEIV5               PIC X(04).
  2207   02  DFHEIV6               PIC X(04).
  2208   02  DFHEIV7               PIC X(02).
  2209   02  DFHEIV8               PIC X(02).
  2210   02  DFHEIV9               PIC X(01).
  2211   02  DFHEIV10              PIC S9(7) COMP-3.
  2212   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2213   02  DFHEIV12              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  45
* EL640.cbl
  2214   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2215   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2216   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2217   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2218   02  DFHEIV17              PIC X(04).
  2219   02  DFHEIV18              PIC X(04).
  2220   02  DFHEIV19              PIC X(04).
  2221   02  DFHEIV20              USAGE IS POINTER.
  2222   02  DFHEIV21              USAGE IS POINTER.
  2223   02  DFHEIV22              USAGE IS POINTER.
  2224   02  DFHEIV23              USAGE IS POINTER.
  2225   02  DFHEIV24              USAGE IS POINTER.
  2226   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2227   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2228   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2229   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2230   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2231   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2232   02  FILLER                PIC X(02).
  2233   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2234   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2235   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2236   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2237   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2238 LINKAGE  SECTION.
  2239*****************************************************************
  2240*                                                               *
  2241* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2242* All rights reserved.                                          *
  2243*                                                               *
  2244*****************************************************************
  2245 01  dfheiblk.
  2246     02  eibtime          pic s9(7) comp-3.
  2247     02  eibdate          pic s9(7) comp-3.
  2248     02  eibtrnid         pic x(4).
  2249     02  eibtaskn         pic s9(7) comp-3.
  2250     02  eibtrmid         pic x(4).
  2251     02  dfheigdi         pic s9(4) comp.
  2252     02  eibcposn         pic s9(4) comp.
  2253     02  eibcalen         pic s9(4) comp.
  2254     02  eibaid           pic x(1).
  2255     02  eibfiller1       pic x(1).
  2256     02  eibfn            pic x(2).
  2257     02  eibfiller2       pic x(2).
  2258     02  eibrcode         pic x(6).
  2259     02  eibfiller3       pic x(2).
  2260     02  eibds            pic x(8).
  2261     02  eibreqid         pic x(8).
  2262     02  eibrsrce         pic x(8).
  2263     02  eibsync          pic x(1).
  2264     02  eibfree          pic x(1).
  2265     02  eibrecv          pic x(1).
  2266     02  eibsend          pic x(1).
  2267     02  eibatt           pic x(1).
  2268     02  eibeoc           pic x(1).
  2269     02  eibfmh           pic x(1).
  2270     02  eibcompl         pic x(1).
  2271     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  46
* EL640.cbl
  2272     02  eibconf          pic x(1).
  2273     02  eiberr           pic x(1).
  2274     02  eibrldbk         pic x(1).
  2275     02  eiberrcd         pic x(4).
  2276     02  eibsynrb         pic x(1).
  2277     02  eibnodat         pic x(1).
  2278     02  eibfiller5       pic x(2).
  2279     02  eibresp          pic 9(09) comp.
  2280     02  eibresp2         pic 9(09) comp.
  2281     02  dfheigdj         pic s9(4) comp.
  2282     02  dfheigdk         pic s9(4) comp.
  2283 01  DFHCOMMAREA             PIC X(1024).
  2284
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  47
* EL640.cbl
  2287*                            COPY ERCPNDB.
  2288******************************************************************
  2289*                                                                *
  2290*                                                                *
  2291*                            ERCPNDB.                            *
  2292*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2293*                            VMOD=2.025                          *
  2294*                                                                *
  2295*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2296*                                                                *
  2297******************************************************************
  2298*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2299*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2300******************************************************************
  2301*                                                                *
  2302*                                                                *
  2303*   FILE TYPE = VSAM,KSDS                                        *
  2304*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2305*                                                                *
  2306*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2307*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2308*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2309*                                                 RKP=13,LEN=36  *
  2310*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2311*                                      AND CHG-SEQ.)             *
  2312*                                                RKP=49,LEN=11   *
  2313*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2314*                                      AND CHG-SEQ.)             *
  2315*                                                RKP=60,LEN=15   *
  2316*                                                                *
  2317*   LOG = NO                                                     *
  2318*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2319******************************************************************
  2320******************************************************************
  2321*                   C H A N G E   L O G
  2322*
  2323* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2324*-----------------------------------------------------------------
  2325*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2326* EFFECTIVE    NUMBER
  2327*-----------------------------------------------------------------
  2328* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2329* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2330* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2331* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2332* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  2333* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2334* 032306                   PEMA  ADD BOW LOAN NUMBER
  2335* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  2336* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  2337* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2338* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2339* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  2340* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  2341* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2342* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2343* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  2344******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  48
* EL640.cbl
  2345
  2346 01  PENDING-BUSINESS.
  2347     12  PB-RECORD-ID                     PIC XX.
  2348         88  VALID-PB-ID                        VALUE 'PB'.
  2349
  2350     12  PB-CONTROL-PRIMARY.
  2351         16  PB-COMPANY-CD                PIC X.
  2352         16  PB-ENTRY-BATCH               PIC X(6).
  2353         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  2354         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  2355
  2356     12  PB-CONTROL-BY-ACCOUNT.
  2357         16  PB-COMPANY-CD-A1             PIC X.
  2358         16  PB-CARRIER                   PIC X.
  2359         16  PB-GROUPING.
  2360             20  PB-GROUPING-PREFIX       PIC XXX.
  2361             20  PB-GROUPING-PRIME        PIC XXX.
  2362         16  PB-STATE                     PIC XX.
  2363         16  PB-ACCOUNT.
  2364             20  PB-ACCOUNT-PREFIX        PIC X(4).
  2365             20  PB-ACCOUNT-PRIME         PIC X(6).
  2366         16  PB-CERT-EFF-DT               PIC XX.
  2367         16  PB-CERT-NO.
  2368             20  PB-CERT-PRIME            PIC X(10).
  2369             20  PB-CERT-SFX              PIC X.
  2370         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  2371
  2372         16  PB-RECORD-TYPE               PIC X.
  2373             88  PB-MAILING-DATA                VALUE '0'.
  2374             88  PB-ISSUE                       VALUE '1'.
  2375             88  PB-CANCELLATION                VALUE '2'.
  2376             88  PB-BATCH-TRAILER               VALUE '9'.
  2377
  2378     12  PB-CONTROL-BY-ORIG-BATCH.
  2379         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  2380         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  2381         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  2382         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  2383
  2384     12  PB-CONTROL-BY-CSR.
  2385         16  PB-CSR-COMPANY-CD            PIC X.
  2386         16  PB-CSR-ID                    PIC X(4).
  2387         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  2388         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  2389         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  2390******************************************************************
  2391*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  2392******************************************************************
  2393
  2394     12  PB-LAST-MAINT-DT                 PIC XX.
  2395     12  PB-LAST-MAINT-BY                 PIC X(4).
  2396     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2397
  2398     12  PB-RECORD-BODY                   PIC X(375).
  2399
  2400     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  2401         16  PB-CERT-ORIGIN               PIC X.
  2402             88  CLASIC-CREATED-CERT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  49
* EL640.cbl
  2403         16  PB-I-NAME.
  2404             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  2405             20  PB-I-INSURED-FIRST-NAME.
  2406                 24  PB-I-INSURED-1ST-INIT PIC X.
  2407                 24  FILLER                PIC X(9).
  2408             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  2409         16  PB-I-AGE                     PIC S99   COMP-3.
  2410         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  2411         16  PB-I-BIRTHDAY                PIC XX.
  2412         16  PB-I-INSURED-SEX             PIC X.
  2413             88  PB-SEX-MALE     VALUE 'M'.
  2414             88  PB-SEX-FEMALE   VALUE 'F'.
  2415
  2416         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  2417         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  2418         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  2419         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  2420         16  PB-I-SKIP-CODE               PIC X.
  2421             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  2422             88  PB-SKIP-JULY              VALUE '1'.
  2423             88  PB-SKIP-AUGUST            VALUE '2'.
  2424             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  2425             88  PB-SKIP-JULY-AUG          VALUE '4'.
  2426             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  2427             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  2428             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  2429             88  PB-SKIP-JUNE              VALUE '8'.
  2430             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  2431             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  2432             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  2433         16  PB-I-TERM-TYPE               PIC X.
  2434             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  2435             88  PB-PAID-WEEKLY            VALUE 'W'.
  2436             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  2437             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  2438             88  PB-PAID-13-YEARLY         VALUE 'T'.
  2439         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  2440         16  PB-I-POLICY-FORM-NO          PIC X(12).
  2441         16  PB-I-DATA-ENTRY-SW           PIC X.
  2442             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  2443             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  2444             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  2445             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  2446         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  2447         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  2448*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  2449         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  2450         16  FILLER                       PIC X.
  2451
  2452         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  2453             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  2454             88  PB-INVALID-LIFE             VALUE '  ' '00'
  2455                                                   '90' THRU '99'.
  2456         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  2457                                          PIC XX.
  2458         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2459         16  PB-I-AMOUNT-FINANCED REDEFINES
  2460                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  50
* EL640.cbl
  2461         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  2462         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  2463                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  2464         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2465         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  2466         16  PB-I-CLP-AMOUNT REDEFINES
  2467                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  2468         16  PB-I-LF-CALC-FLAG            PIC X.
  2469             88 PB-COMP-LF-PREM               VALUE '?'.
  2470         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2471         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2472         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2473         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2474         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2475         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2476         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2477         16  PB-I-LF-ABBR                 PIC XXX.
  2478         16  PB-I-LF-INPUT-CD             PIC XX.
  2479
  2480         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2481             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2482             88  PB-INVALID-AH               VALUE '  ' '00'
  2483                                                   '90' THRU '99'.
  2484         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2485         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2486         16  PB-I-AH-CALC-FLAG            PIC X.
  2487             88 PB-COMP-AH-PREM                  VALUE '?'.
  2488         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2489         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2490         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2491         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2492         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2493         16  PB-I-AH-ABBR                 PIC XXX.
  2494         16  PB-I-AH-INPUT-CD             PIC XXX.
  2495
  2496         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2497         16  PB-I-REIN-TABLE              PIC XXX.
  2498         16  PB-I-BUSINESS-TYPE           PIC 99.
  2499         16  PB-I-INDV-GRP-CD             PIC X.
  2500         16  PB-I-MORT-CODE.
  2501             20  PB-I-TABLE               PIC X.
  2502             20  PB-I-INTEREST            PIC XX.
  2503             20  PB-I-MORT-TYP            PIC X.
  2504         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2505         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2506         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2507         16  PB-I-INDV-GRP-OVRD           PIC X.
  2508         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2509         16  PB-I-SIG-SW                  PIC X.
  2510             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2511         16  PB-I-RATE-CLASS              PIC XX.
  2512         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2513         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2514         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2515         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2516         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2517         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2518         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  51
* EL640.cbl
  2519         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2520         16  PB-I-OB-FLAG                 PIC X.
  2521             88  PB-I-OB                      VALUE 'B'.
  2522             88  PB-I-SUMMARY                 VALUE 'Z'.
  2523         16  PB-I-ENTRY-STATUS            PIC X.
  2524             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2525                                              'M' '5' '9' '2'.
  2526             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2527             88  PB-I-POLICY-PENDING          VALUE '2'.
  2528             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2529             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2530             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  2531             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2532             88  PB-I-REIN-ONLY               VALUE '9'.
  2533             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2534             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2535             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2536             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2537         16  PB-I-INT-CODE                PIC X.
  2538             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2539             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2540         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2541         16  PB-I-SOC-SEC-NO              PIC X(11).
  2542         16  PB-I-MEMBER-NO               PIC X(12).
  2543         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2544*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2545         16  PB-I-OLD-LOF                 PIC XXX.
  2546         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2547         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2548         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2549         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2550         16  PB-I-LIFE-INDICATOR          PIC X.
  2551             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2552         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2553         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2554                                          PIC S9(5)V99    COMP-3.
  2555         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2556             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2557             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2558         16  PB-I-1ST-PMT-DT              PIC XX.
  2559         16  PB-I-JOINT-INSURED.
  2560             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2561             20 PB-I-JOINT-FIRST-NAME.
  2562                24  PB-I-JOINT-FIRST-INIT PIC X.
  2563                24  FILLER                PIC X(9).
  2564             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2565*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2566         16  PB-I-BENEFICIARY-NAME.
  2567             20  PB-I-BANK-NUMBER         PIC X(10).
  2568             20  FILLER                   PIC X(15).
  2569         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2570         16  PB-I-REFERENCE               PIC X(12).
  2571         16  FILLER REDEFINES PB-I-REFERENCE.
  2572             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2573             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2574             20  PB-I-CLP-STATE           PIC XX.
  2575         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2576             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  52
* EL640.cbl
  2577             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  2578             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2579         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2580         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2581         16  PB-I-RESIDENT-STATE          PIC XX.
  2582         16  PB-I-RATE-CODE               PIC X(4).
  2583         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2584         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2585         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2586         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2587         16  PB-I-BANK-NOCHRGB            PIC 99.
  2588         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2589         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2590
  2591     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2592         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2593             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2594         16  PB-C-CANCEL-ORIGIN           PIC X.
  2595             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2596         16  PB-C-LF-CANCEL-DT            PIC XX.
  2597         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2598         16  PB-C-LF-CALC-REQ             PIC X.
  2599             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2600         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2601         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2602         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2603             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2604         16  PB-C-AH-CANCEL-DT            PIC XX.
  2605         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2606         16  PB-C-AH-CALC-REQ             PIC X.
  2607             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2608         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2609         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2610         16  PB-C-LAST-NAME               PIC X(15).
  2611         16  PB-C-REFUND-SW               PIC X.
  2612             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2613             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2614         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2615         16  PB-C-PAYEE-CODE              PIC X(6).
  2616         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2617         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2618         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2619         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2620         16  PB-C-REFERENCE               PIC X(12).
  2621         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2622         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2623         16  PB-C-POST-CARD-IND           PIC X.
  2624         16  PB-C-CANCEL-REASON           PIC X.
  2625         16  PB-C-REF-INTERFACE-SW        PIC X.
  2626         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2627         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2628         16  FILLER                       PIC X(01).
  2629*        16  FILLER                       PIC X(18).
  2630         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2631*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2632         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2633         16  PB-CANCELED-CERT-DATA.
  2634             20  PB-CI-INSURED-NAME.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  53
* EL640.cbl
  2635                 24  PB-CI-LAST-NAME      PIC X(15).
  2636                 24  PB-CI-INITIALS       PIC XX.
  2637             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2638             20  PB-CI-INSURED-SEX        PIC X.
  2639             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2640             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2641             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2642             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2643             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2644             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2645             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2646             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2647             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2648             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2649             20  PB-CI-RATE-CLASS         PIC XX.
  2650             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2651             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2652             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2653             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2654             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2655             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2656             20  PB-CI-LF-ABBR            PIC X(3).
  2657             20  PB-CI-AH-ABBR            PIC X(3).
  2658             20  PB-CI-OB-FLAG            PIC X.
  2659                 88  PB-CI-OB                VALUE 'B'.
  2660             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2661                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2662                                           'M' '4' '5' '9' '2'.
  2663                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2664                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2665                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2666                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2667                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2668                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  2669                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2670                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2671                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2672                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2673                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2674                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2675                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2676             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2677                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2678                                           'M' '4' '5' '9' '2'.
  2679                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2680                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2681                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2682                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2683                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2684                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  2685                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2686                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2687                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2688                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2689                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2690                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2691                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2692             20  PB-CI-PAY-FREQUENCY      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  54
* EL640.cbl
  2693             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2694             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2695             20  PB-CI-MEMBER-NO          PIC X(12).
  2696             20  PB-CI-INT-CODE           PIC X.
  2697                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2698                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2699             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2700             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2701             20  PB-CI-COMP-EXCP-SW       PIC X.
  2702                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2703                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2704             20  PB-CI-ENTRY-STATUS       PIC X.
  2705             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2706             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2707             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2708             20  PB-CI-DEATH-DT           PIC XX.
  2709             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2710             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2711             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2712             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2713             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2714             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2715             20  PB-CI-ENTRY-DT              PIC XX.
  2716             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2717             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2718             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2719             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2720             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2721             20  PB-CI-OLD-LOF               PIC XXX.
  2722*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2723             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2724             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2725             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2726             20  PB-CI-INDV-GRP-CD           PIC X.
  2727             20  PB-CI-BENEFICIARY-NAME.
  2728                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2729                 24  FILLER                  PIC X(15).
  2730             20  PB-CI-NOTE-SW               PIC X.
  2731             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2732             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2733             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2734             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2735             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2736             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2737             20  PB-CI-FIRST-NAME            PIC X(10).
  2738             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2739
  2740         16  FILLER                       PIC X(13).
  2741*032306  16  FILLER                       PIC X(27).
  2742*        16  FILLER                       PIC X(46).
  2743
  2744     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2745         16  FILLER                       PIC X(10).
  2746         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2747         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2748         16  PB-M-INSURED-MID-INIT        PIC X.
  2749         16  PB-M-INSURED-AGE             PIC 99.
  2750         16  PB-M-INSURED-BIRTHDAY        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  55
* EL640.cbl
  2751         16  PB-M-INSURED-SEX             PIC X.
  2752         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2753         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  2754         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2755         16  PB-M-INSURED-CITY-STATE.
  2756             20  PB-M-INSURED-CITY        PIC X(28).
  2757             20  PB-M-INSURED-STATE       PIC XX.
  2758         16  PB-M-INSURED-ZIP-CODE.
  2759             20  PB-M-INSURED-ZIP-PRIME.
  2760                 24  PB-M-INSURED-ZIP-1   PIC X.
  2761                     88  PB-M-CANADIAN-POST-CODE
  2762                                             VALUE 'A' THRU 'Z'.
  2763                 24  FILLER               PIC X(4).
  2764             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2765         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2766                                        PB-M-INSURED-ZIP-CODE.
  2767             20  PM-M-INS-CAN-POST1       PIC XXX.
  2768             20  PM-M-INS-CAN-POST2       PIC XXX.
  2769             20  FILLER                   PIC XXX.
  2770         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2771         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2772         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2773         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2774         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2775         16  PB-M-CRED-BENE-CITYST.
  2776             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2777             20  PB-M-CRED-BENE-STATE     PIC XX.
  2778         16  FILLER                       PIC X(92).
  2779
  2780     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2781         16  FILLER                       PIC X(10).
  2782         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2783         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2784         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2785         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2786         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2787         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2788         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2789         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2790         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2791         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2792         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2793         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2794         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2795         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2796         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2797         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2798         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2799         16  PB-ACCOUNT-NAME              PIC X(30).
  2800         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2801         16  PB-REFERENCE                 PIC X(12).
  2802         16  PB-B-RECEIVED-DT             PIC XX.
  2803         16  FILLER                       PIC X(234).
  2804
  2805     12  PB-RECORD-STATUS.
  2806         16  PB-CREDIT-SELECT-DT          PIC XX.
  2807         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2808         16  PB-BILLED-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  56
* EL640.cbl
  2809         16  PB-BILLING-STATUS            PIC X.
  2810             88  PB-ENTRY-REVERSED            VALUE 'R'.
  2811             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2812             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2813         16  PB-RECORD-BILL               PIC X.
  2814             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2815             88  PB-RECORD-RETURNED           VALUE 'R'.
  2816             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2817             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2818             88  PB-OVERRIDE-AH               VALUE 'A'.
  2819             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2820         16  PB-BATCH-ENTRY               PIC X.
  2821             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2822             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2823             88  PB-REISSUED-CERT             VALUE 'E'.
  2824             88  PB-CASH-CERT                 VALUE 'C'.
  2825             88  PB-MONTHLY-CERT              VALUE 'M'.
  2826             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2827             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2828             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2829         16  PB-FORCE-CODE                PIC X.
  2830             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2831             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2832             88  PB-CANCEL-FORCE              VALUE '8'.
  2833             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2834             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2835             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2836             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2837             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2838             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2839             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2840         16  PB-FATAL-FLAG                PIC X.
  2841             88  PB-FATAL-ERRORS              VALUE 'X'.
  2842         16  PB-FORCE-ER-CD               PIC X.
  2843             88  PB-FORCE-ERRORS              VALUE 'F'.
  2844             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2845         16  PB-WARN-ER-CD                PIC X.
  2846             88  PB-WARNING-ERRORS            VALUE 'W'.
  2847         16  FILLER                       PIC X.
  2848         16  PB-OUT-BAL-CD                PIC X.
  2849             88  PB-OUT-OF-BAL                VALUE 'O'.
  2850         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2851         16  PB-AH-OVERRIDE-L1            PIC X.
  2852         16  PB-INPUT-DT                  PIC XX.
  2853         16  PB-INPUT-BY                  PIC X(4).
  2854         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2855         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2856         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2857         16  PB-LF-EARNING-METHOD         PIC X.
  2858         16  PB-AH-EARNING-METHOD         PIC X.
  2859         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2860         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2861         16  PB-REIN-CD                   PIC XXX.
  2862         16  PB-LF-REFUND-TYPE            PIC X.
  2863         16  PB-AH-REFUND-TYPE            PIC X.
  2864         16  PB-ACCT-EFF-DT               PIC XX.
  2865         16  PB-ACCT-EXP-DT               PIC XX.
  2866         16  PB-COMPANY-ID                PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  57
* EL640.cbl
  2867         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2868         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2869         16  PB-SV-CARRIER                PIC X.
  2870         16  PB-SV-GROUPING               PIC X(6).
  2871         16  PB-SV-STATE                  PIC XX.
  2872         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2873         16  PB-GA-BILLING-INFO.
  2874             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2875                                          PIC XX.
  2876         16  PB-SV-REMIT-TO  REDEFINES
  2877             PB-GA-BILLING-INFO           PIC X(10).
  2878         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2879         16  PB-I-LOAN-OFFICER            PIC X(5).
  2880         16  PB-I-VIN                     PIC X(17).
  2881
  2882         16  FILLER                       PIC X(04).
  2883         16  IMNET-BYPASS-SW              PIC X.
  2884
  2885******************************************************************
  2886*                COMMON EDIT ERRORS                              *
  2887******************************************************************
  2888
  2889     12  PB-COMMON-ERRORS.
  2890         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2891                                           PIC S9(4)     COMP.
  2892
  2893******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  58
* EL640.cbl
  2895*                            COPY ELCCNTL.
  2896******************************************************************
  2897*                                                                *
  2898*                                                                *
  2899*                            ELCCNTL.                            *
  2900*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2901*                            VMOD=2.059                          *
  2902*                                                                *
  2903*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2904*                                                                *
  2905*   FILE TYPE = VSAM,KSDS                                        *
  2906*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2907*                                                                *
  2908*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2909*       ALTERNATE INDEX = NONE                                   *
  2910*                                                                *
  2911*   LOG = YES                                                    *
  2912*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2913******************************************************************
  2914*                   C H A N G E   L O G
  2915*
  2916* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2917*-----------------------------------------------------------------
  2918*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2919* EFFECTIVE    NUMBER
  2920*-----------------------------------------------------------------
  2921* 082503                   PEMA  ADD BENEFIT GROUP
  2922* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2923* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2924* 092705    2005050300006  PEMA  ADD SPP LEASES
  2925* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2926* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2927* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2928* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2929* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2930* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2931* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2932* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2933* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2934* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2935******************************************************************
  2936*
  2937 01  CONTROL-FILE.
  2938     12  CF-RECORD-ID                       PIC XX.
  2939         88  VALID-CF-ID                        VALUE 'CF'.
  2940
  2941     12  CF-CONTROL-PRIMARY.
  2942         16  CF-COMPANY-ID                  PIC XXX.
  2943         16  CF-RECORD-TYPE                 PIC X.
  2944             88  CF-COMPANY-MASTER              VALUE '1'.
  2945             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2946             88  CF-STATE-MASTER                VALUE '3'.
  2947             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2948             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2949             88  CF-CARRIER-MASTER              VALUE '6'.
  2950             88  CF-MORTALITY-MASTER            VALUE '7'.
  2951             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2952             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  59
* EL640.cbl
  2953             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2954             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2955             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2956             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2957             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2958             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2959             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2960             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2961             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2962         16  CF-ACCESS-CD-GENL              PIC X(4).
  2963         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2964             20  CF-PROCESSOR               PIC X(4).
  2965         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2966             20  CF-STATE-CODE              PIC XX.
  2967             20  FILLER                     PIC XX.
  2968         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2969             20  FILLER                     PIC XX.
  2970             20  CF-HI-BEN-IN-REC           PIC XX.
  2971         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2972             20  FILLER                     PIC XXX.
  2973             20  CF-CARRIER-CNTL            PIC X.
  2974         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2975             20  FILLER                     PIC XX.
  2976             20  CF-HI-TYPE-IN-REC          PIC 99.
  2977         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2978             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2979                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2980             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2981             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2982         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2983             20  FILLER                     PIC X.
  2984             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2985         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2986             20  FILLER                     PIC XX.
  2987             20  CF-MORTGAGE-PLAN           PIC XX.
  2988         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2989
  2990     12  CF-LAST-MAINT-DT                   PIC XX.
  2991     12  CF-LAST-MAINT-BY                   PIC X(4).
  2992     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2993
  2994     12  CF-RECORD-BODY                     PIC X(728).
  2995
  2996
  2997****************************************************************
  2998*             COMPANY MASTER RECORD                            *
  2999****************************************************************
  3000
  3001     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3002         16  CF-COMPANY-ADDRESS.
  3003             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3004             20  CF-CL-IN-CARE-OF           PIC X(30).
  3005             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3006             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3007             20  CF-CL-CITY-STATE           PIC X(30).
  3008             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3009             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3010         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  60
* EL640.cbl
  3011         16  CF-COMPANY-PASSWORD            PIC X(8).
  3012         16  CF-SECURITY-OPTION             PIC X.
  3013             88  ALL-SECURITY                   VALUE '1'.
  3014             88  COMPANY-VERIFY                 VALUE '2'.
  3015             88  PROCESSOR-VERIFY               VALUE '3'.
  3016             88  NO-SECURITY                    VALUE '4'.
  3017             88  ALL-BUT-TERM                   VALUE '5'.
  3018         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3019             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3020         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3021             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3022         16  CF-INFORCE-LOCATION            PIC X.
  3023             88  CERTS-ARE-ONLINE               VALUE '1'.
  3024             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3025             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3026         16  CF-LOWER-CASE-LETTERS          PIC X.
  3027         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3028             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3029             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3030             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3031             88  CF-ACCNT-CNTL                  VALUE '3'.
  3032             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3033
  3034         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3035         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3036
  3037         16  CF-LGX-CREDIT-USER             PIC X.
  3038             88  CO-IS-NOT-USER                 VALUE 'N'.
  3039             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3040
  3041         16 CF-CREDIT-CALC-CODES.
  3042             20  CF-CR-REM-TERM-CALC PIC X.
  3043               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3044               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3045               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3046               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3047               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3048               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3049               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3050             20  CF-CR-R78-METHOD           PIC X.
  3051               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3052               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3053
  3054         16  CF-CLAIM-CONTROL-COUNTS.
  3055             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3056                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3057
  3058             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3059                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3060
  3061             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3062                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3063
  3064             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3065                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3066
  3067         16  CF-CURRENT-MONTH-END           PIC XX.
  3068
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  61
* EL640.cbl
  3069         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3070             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3071             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3072             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3073             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3074                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3075                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3076             20  CF-CO-PREM-REJECT-SW       PIC X.
  3077                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3078                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3079             20  CF-CO-REF-REJECT-SW        PIC X.
  3080                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3081                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3082
  3083         16  CF-CO-REPORTING-DT             PIC XX.
  3084         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3085         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3086           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3087           88  CF-CO-MONTH-END                  VALUE '1'.
  3088
  3089         16  CF-LGX-CLAIM-USER              PIC X.
  3090             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3091             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3092
  3093         16  CF-CREDIT-EDIT-CONTROLS.
  3094             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3095             20  CF-MIN-AGE                 PIC 99.
  3096             20  CF-DEFAULT-AGE             PIC 99.
  3097             20  CF-MIN-TERM                PIC S999      COMP-3.
  3098             20  CF-MAX-TERM                PIC S999      COMP-3.
  3099             20  CF-DEFAULT-SEX             PIC X.
  3100             20  CF-JOINT-AGE-INPUT         PIC X.
  3101                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3102             20  CF-BIRTH-DATE-INPUT        PIC X.
  3103                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3104             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3105                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3106                 88  CF-ZERO-CARRIER            VALUE '1'.
  3107                 88  CF-ZERO-GROUPING           VALUE '2'.
  3108                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3109             20  CF-EDIT-SW                 PIC X.
  3110                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3111             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3112             20  CF-CR-PR-METHOD            PIC X.
  3113               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3114               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3115             20  FILLER                     PIC X.
  3116
  3117         16  CF-CREDIT-MISC-CONTROLS.
  3118             20  CF-REIN-TABLE-SW           PIC X.
  3119                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3120             20  CF-COMP-TABLE-SW           PIC X.
  3121                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3122             20  CF-EXPERIENCE-RETENTION-AGE
  3123                                            PIC S9        COMP-3.
  3124             20  CF-CONVERSION-DT           PIC XX.
  3125             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3126             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  62
* EL640.cbl
  3127                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3128                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3129
  3130             20  CF-CR-CHECK-NO-CONTROL.
  3131                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3132                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3133                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3134                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3135                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3136                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3137
  3138                 24  CF-CR-CHECK-COUNT       REDEFINES
  3139                     CF-CR-CHECK-COUNTER      PIC X(4).
  3140
  3141                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3142                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3143
  3144                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3145                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3146                 24  CF-MAIL-PROCESSING       PIC X.
  3147                     88  MAIL-PROCESSING          VALUE 'Y'.
  3148
  3149         16  CF-MISC-SYSTEM-CONTROL.
  3150             20  CF-SYSTEM-C                 PIC X.
  3151                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3152             20  CF-SYSTEM-D                 PIC X.
  3153                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3154             20  CF-SOC-SEC-NO-SW            PIC X.
  3155                 88  SOC-SEC-NO-USED             VALUE '1'.
  3156             20  CF-MEMBER-NO-SW             PIC X.
  3157                 88  MEMBER-NO-USED              VALUE '1'.
  3158             20  CF-TAX-ID-NUMBER            PIC X(11).
  3159             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3160             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3161                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3162                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3163                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3164                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3165             20  CF-SYSTEM-E                 PIC X.
  3166                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3167
  3168         16  CF-LGX-LIFE-USER               PIC X.
  3169             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3170             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3171
  3172         16  CF-CR-MONTH-END-DT             PIC XX.
  3173
  3174         16  CF-FILE-MAINT-DATES.
  3175             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3176                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3177             20  CF-LAST-BATCH       REDEFINES
  3178                 CF-LAST-BATCH-NO               PIC X(4).
  3179             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3180             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3181             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3182             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3183             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3184             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  63
* EL640.cbl
  3185             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3186             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3187             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3188             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3189
  3190         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3191         16  FILLER                         PIC X.
  3192
  3193         16  CF-ALT-MORT-CODE               PIC X(4).
  3194         16  CF-MEMBER-CAPTION              PIC X(10).
  3195
  3196         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3197             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3198             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3199             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3200             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3201             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3202
  3203         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3204
  3205         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3206         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3207         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3208         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3209
  3210         16  CF-AH-OVERRIDE-L1              PIC X.
  3211         16  CF-AH-OVERRIDE-L2              PIC XX.
  3212         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3213         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3214
  3215         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3216         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3217
  3218         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3219         16  CF-AR-LAST-EL860-DT            PIC XX.
  3220         16  CF-MP-MONTH-END-DT             PIC XX.
  3221
  3222         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3223         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3224             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3225
  3226         16  CF-AR-MONTH-END-DT             PIC XX.
  3227
  3228         16  CF-CRDTCRD-USER                PIC X.
  3229             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3230             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3231
  3232         16  CF-CC-MONTH-END-DT             PIC XX.
  3233
  3234         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3235
  3236         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3237             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3238             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3239             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3240         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3241         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3242         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  64
* EL640.cbl
  3243         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3244             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3245             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3246         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3247         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3248         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3249             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3250         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3251
  3252         16  CF-CL-ZIP-CODE.
  3253             20  CF-CL-ZIP-PRIME.
  3254                 24  CF-CL-ZIP-1ST          PIC X.
  3255                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3256                 24  FILLER                 PIC X(4).
  3257             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3258         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3259             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3260             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3261             20  FILLER                     PIC XXX.
  3262
  3263         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3264         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3265         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3266         16  CF-CO-OPTION-START-DATE        PIC XX.
  3267         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3268           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3269                                                      '3' '4'.
  3270           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3271           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3272           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3273           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3274           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3275           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3276
  3277         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3278
  3279         16  CF-PAYMENT-APPROVAL-LEVELS.
  3280             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3281             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3282             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3283             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3284             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3285             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3286
  3287         16  CF-END-USER-REPORTING-USER     PIC X.
  3288             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3289             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3290
  3291         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3292             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3293             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3294
  3295         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3296
  3297         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3298         16  FILLER                         PIC X.
  3299
  3300         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  65
* EL640.cbl
  3301             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3302             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3303             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3304
  3305         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3306
  3307         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3308             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3309             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3310
  3311         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3312             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3313             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3314
  3315         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3316
  3317         16  CF-CO-ACH-ID-CODE              PIC  X.
  3318             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3319             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3320             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3321         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3322         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3323         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3324         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3325         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3326         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3327         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3328         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3329         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3330                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3331         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3332                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3333
  3334         16  CF-CO-OVER-SHORT.
  3335             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3336             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3337
  3338*         16  FILLER                         PIC X(102).
  3339         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3340             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3341             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3342
  3343         16  CF-AH-APPROVAL-DAYS.
  3344             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3345             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3346             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3347             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3348
  3349         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3350
  3351         16  CF-APPROV-LEV-5.
  3352             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3353             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3354             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3355
  3356         16  FILLER                         PIC X(68).
  3357****************************************************************
  3358*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  66
* EL640.cbl
  3359****************************************************************
  3360
  3361     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3362         16  CF-PROCESSOR-NAME              PIC X(30).
  3363         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3364         16  CF-PROCESSOR-TITLE             PIC X(26).
  3365         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3366                 88  MESSAGE-YES                VALUE 'Y'.
  3367                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3368
  3369*****************************************************
  3370****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3371****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3372****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3373****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3374*****************************************************
  3375
  3376         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3377             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3378             20  CF-APPLICATION-FORCE       PIC X.
  3379             20  CF-INDIVIDUAL-APP.
  3380                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3381                     28  CF-BROWSE-APP      PIC X.
  3382                     28  CF-UPDATE-APP      PIC X.
  3383
  3384         16  CF-CURRENT-TERM-ON             PIC X(4).
  3385         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3386             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3387             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3388             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3389             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3390             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3391             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3392             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3393         16  CF-PROCESSOR-CARRIER           PIC X.
  3394             88  NO-CARRIER-SECURITY            VALUE ' '.
  3395         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3396             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3397         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3398             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3399         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3400             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3401
  3402         16  CF-PROC-SYS-ACCESS-SW.
  3403             20  CF-PROC-CREDIT-CLAIMS-SW.
  3404                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3405                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3406                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3407                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3408             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3409                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3410                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3411             20  CF-PROC-LIFE-GNRLDGR-SW.
  3412                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3413                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3414                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3415                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3416             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  67
* EL640.cbl
  3417                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3418                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3419         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3420             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3421             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3422         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3423
  3424         16  CF-APPROVAL-LEVEL                  PIC X.
  3425             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3426             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3427             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3428             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3429             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3430
  3431         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3432
  3433         16  CF-LANGUAGE-TYPE                   PIC X.
  3434             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3435             88  CF-LANG-IS-FR                      VALUE 'F'.
  3436
  3437         16  CF-CSR-IND                         PIC X.
  3438         16  FILLER                             PIC X(239).
  3439
  3440****************************************************************
  3441*             PROCESSOR/REMINDERS RECORD                       *
  3442****************************************************************
  3443
  3444     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3445         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3446             20  CF-START-REMIND-DT         PIC XX.
  3447             20  CF-END-REMIND-DT           PIC XX.
  3448             20  CF-REMINDER-TEXT           PIC X(50).
  3449         16  FILLER                         PIC X(296).
  3450
  3451
  3452****************************************************************
  3453*             STATE MASTER RECORD                              *
  3454****************************************************************
  3455
  3456     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3457         16  CF-STATE-ABBREVIATION          PIC XX.
  3458         16  CF-STATE-NAME                  PIC X(25).
  3459         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3460         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3461             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3462             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3463             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3464             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3465                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3466                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3467             20  CF-ST-PREM-REJECT-SW       PIC X.
  3468                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3469                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3470             20  CF-ST-REF-REJECT-SW        PIC X.
  3471                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3472                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3473         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3474         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  68
* EL640.cbl
  3475         16  CF-ST-REFUND-RULES.
  3476             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3477             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3478             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3479         16  CF-ST-FST-PMT-EXTENSION.
  3480             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3481             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3482                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3483                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3484                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3485                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3486         16  CF-ST-STATE-CALL.
  3487             20  CF-ST-CALL-UNEARNED        PIC X.
  3488             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3489             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3490         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3491             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3492             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3493         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3494         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3495         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3496         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3497         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3498         16  FILLER                         PIC X.
  3499         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3500             20  CF-ST-BENEFIT-CD           PIC XX.
  3501             20  CF-ST-BENEFIT-KIND         PIC X.
  3502                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3503                 88  CF-ST-AH-KIND              VALUE 'A'.
  3504             20  CF-ST-REM-TERM-CALC        PIC X.
  3505                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3506                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3507                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3508                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3509                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3510                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3511                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3512                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3513
  3514             20  CF-ST-REFUND-CALC          PIC X.
  3515                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3516                 88  ST-REFD-BY-R78             VALUE '1'.
  3517                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3518                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3519                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3520                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3521                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3522                 88  ST-REFD-UTAH               VALUE '7'.
  3523                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3524                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3525                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3526
  3527             20  CF-ST-EARNING-CALC         PIC X.
  3528                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3529                 88  ST-EARN-BY-R78             VALUE '1'.
  3530                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3531                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3532                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  69
* EL640.cbl
  3533                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3534                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3535                 88  ST-EARN-MEAN               VALUE '8'.
  3536                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3537
  3538             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3539                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3540                 88  ST-OVRD-BY-R78             VALUE '1'.
  3541                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3542                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3543                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3544                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3545                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3546                 88  ST-OVRD-MEAN               VALUE '8'.
  3547                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3548             20  FILLER                     PIC X.
  3549
  3550         16  CF-ST-COMMISSION-CAPS.
  3551             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3552             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3553             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3554             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3555         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3556                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3557
  3558         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3559
  3560         16  CF-ST-STATUTORY-INTEREST.
  3561             20  CF-ST-STAT-DATE-FROM       PIC X.
  3562                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3563                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3564             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3565             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3566             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3567             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3568             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3569
  3570         16  CF-ST-OVER-SHORT.
  3571             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3572             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3573
  3574         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3575
  3576         16  CF-ST-RT-CALC                  PIC X.
  3577
  3578         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3579         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3580         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3581         16  CF-ST-RF-LR-CALC               PIC X.
  3582         16  CF-ST-RF-LL-CALC               PIC X.
  3583         16  CF-ST-RF-LN-CALC               PIC X.
  3584         16  CF-ST-RF-AH-CALC               PIC X.
  3585         16  CF-ST-RF-CP-CALC               PIC X.
  3586*        16  FILLER                         PIC X(206).
  3587*CIDMOD         16  FILLER                         PIC X(192).
  3588         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3589             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3590         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  70
* EL640.cbl
  3591         16  CF-ST-VFY-2ND-BENE             PIC X.
  3592         16  CF-ST-CAUSAL-STATE             PIC X.
  3593         16  FILLER                         PIC X(185).
  3594
  3595****************************************************************
  3596*             BENEFIT MASTER RECORD                            *
  3597****************************************************************
  3598
  3599     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3600         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3601             20  CF-BENEFIT-CODE            PIC XX.
  3602             20  CF-BENEFIT-NUMERIC  REDEFINES
  3603                 CF-BENEFIT-CODE            PIC XX.
  3604             20  CF-BENEFIT-ALPHA           PIC XXX.
  3605             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3606             20  CF-BENEFIT-COMMENT         PIC X(10).
  3607
  3608             20  CF-LF-COVERAGE-TYPE        PIC X.
  3609                 88  CF-REDUCING                VALUE 'R'.
  3610                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3611
  3612             20  CF-SPECIAL-CALC-CD         PIC X.
  3613                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3614                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3615                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3616                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3617                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3618                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3619                 88  CF-FARM-PLAN               VALUE 'F'.
  3620                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3621                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3622                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3623                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3624                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3625                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3626                 88  CF-PRUDENTIAL              VALUE 'P'.
  3627                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3628                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3629                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3630                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3631                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3632                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3633
  3634             20  CF-JOINT-INDICATOR         PIC X.
  3635                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3636
  3637*            20  FILLER                     PIC X(12).
  3638             20  cf-maximum-benefits        pic s999 comp-3.
  3639             20  FILLER                     PIC X(09).
  3640             20  CF-BENEFIT-CATEGORY        PIC X.
  3641             20  CF-LOAN-TYPE               PIC X(8).
  3642
  3643             20  CF-CO-REM-TERM-CALC        PIC X.
  3644                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3645                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3646                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3647                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3648                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  71
* EL640.cbl
  3649
  3650             20  CF-CO-EARNINGS-CALC        PIC X.
  3651                 88  CO-EARN-BY-R78             VALUE '1'.
  3652                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3653                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3654                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3655                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3656                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3657                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3658                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3659
  3660             20  CF-CO-REFUND-CALC          PIC X.
  3661                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3662                 88  CO-REFD-BY-R78             VALUE '1'.
  3663                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3664                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3665                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3666                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3667                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3668                 88  CO-REFD-MEAN               VALUE '8'.
  3669                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3670                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3671                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3672
  3673             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3674                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3675                 88  CO-OVRD-BY-R78             VALUE '1'.
  3676                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3677                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3678                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3679                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3680                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3681                 88  CO-OVRD-MEAN               VALUE '8'.
  3682                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3683
  3684             20  CF-CO-BEN-I-G-CD           PIC X.
  3685                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3686                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3687                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3688
  3689         16  FILLER                         PIC X(304).
  3690
  3691
  3692****************************************************************
  3693*             CARRIER MASTER RECORD                            *
  3694****************************************************************
  3695
  3696     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3697         16  CF-ADDRESS-DATA.
  3698             20  CF-MAIL-TO-NAME            PIC X(30).
  3699             20  CF-IN-CARE-OF              PIC X(30).
  3700             20  CF-ADDRESS-LINE-1          PIC X(30).
  3701             20  CF-ADDRESS-LINE-2          PIC X(30).
  3702             20  CF-CITY-STATE              PIC X(30).
  3703             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3704             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3705
  3706         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  72
* EL640.cbl
  3707             20  CF-CLAIM-NO-METHOD         PIC X.
  3708                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3709                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3710                 88  CLAIM-NO-SEQ               VALUE '3'.
  3711                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3712             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3713                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3714                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3715                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3716
  3717         16  CF-CHECK-NO-CONTROL.
  3718             20  CF-CHECK-NO-METHOD         PIC X.
  3719                 88  CHECK-NO-MANUAL            VALUE '1'.
  3720                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3721                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3722                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3723             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3724                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3725
  3726         16  CF-DOMICILE-STATE              PIC XX.
  3727
  3728         16  CF-EXPENSE-CONTROLS.
  3729             20  CF-EXPENSE-METHOD          PIC X.
  3730                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3731                 88  DOLLARS-PER-PMT            VALUE '2'.
  3732                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3733                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3734             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3735             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3736
  3737         16  CF-CORRESPONDENCE-CONTROL.
  3738             20  CF-LETTER-RESEND-OPT       PIC X.
  3739                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3740                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3741             20  FILLER                     PIC X(4).
  3742
  3743         16  CF-RESERVE-CONTROLS.
  3744             20  CF-MANUAL-SW               PIC X.
  3745                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3746             20  CF-FUTURE-SW               PIC X.
  3747                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3748             20  CF-PTC-SW                  PIC X.
  3749                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3750             20  CF-IBNR-SW                 PIC X.
  3751                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3752             20  CF-PTC-LF-SW               PIC X.
  3753                 88  CF-LF-PTC-USED             VALUE '1'.
  3754             20  CF-CDT-ACCESS-METHOD       PIC X.
  3755                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3756                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3757                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3758             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3759
  3760         16  CF-CLAIM-CALC-METHOD           PIC X.
  3761             88  360-PLUS-MONTHS                VALUE '1'.
  3762             88  365-PLUS-MONTHS                VALUE '2'.
  3763             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3764             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  73
* EL640.cbl
  3765             88  365-DAILY                      VALUE '5'.
  3766
  3767         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3768         16  FILLER                         PIC X(11).
  3769
  3770         16  CF-LIMIT-AMOUNTS.
  3771             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3772             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3773             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3774             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3775             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3776             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3777             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3778             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3779             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3780             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3781
  3782         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3783         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3784         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3785
  3786         16  CF-ZIP-CODE.
  3787             20  CF-ZIP-PRIME.
  3788                 24  CF-ZIP-1ST             PIC X.
  3789                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3790                 24  FILLER                 PIC X(4).
  3791             20  CF-ZIP-PLUS4               PIC X(4).
  3792         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3793             20  CF-CAN-POSTAL-1            PIC XXX.
  3794             20  CF-CAN-POSTAL-2            PIC XXX.
  3795             20  FILLER                     PIC XXX.
  3796
  3797         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3798         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3799         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3800
  3801         16  CF-RATING-SWITCH               PIC X.
  3802             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3803             88  CF-NO-RATING                   VALUE 'N'.
  3804
  3805         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3806
  3807         16  CF-CARRIER-OVER-SHORT.
  3808             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3809             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3810
  3811         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3812         16  CF-SECPAY-SWITCH               PIC X.
  3813             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3814             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3815         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3816         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3817         16  FILLER                         PIC X(444).
  3818*        16  FILLER                         PIC X(452).
  3819
  3820
  3821****************************************************************
  3822*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  74
* EL640.cbl
  3823****************************************************************
  3824
  3825     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3826         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3827                                INDEXED BY CF-MORT-NDX.
  3828             20  CF-MORT-TABLE              PIC X(5).
  3829             20  CF-MORT-TABLE-TYPE         PIC X.
  3830                 88  CF-MORT-JOINT              VALUE 'J'.
  3831                 88  CF-MORT-SINGLE             VALUE 'S'.
  3832                 88  CF-MORT-COMBINED           VALUE 'C'.
  3833                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3834                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3835             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3836             20  CF-MORT-AGE-METHOD         PIC XX.
  3837                 88  CF-AGE-LAST                VALUE 'AL'.
  3838                 88  CF-AGE-NEAR                VALUE 'AN'.
  3839             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3840             20  CF-MORT-ADJUSTMENT-DIRECTION
  3841                                            PIC X.
  3842                 88  CF-MINUS                   VALUE '-'.
  3843                 88  CF-PLUS                    VALUE '+'.
  3844             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3845             20  CF-MORT-JOINT-CODE         PIC X.
  3846                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3847             20  CF-MORT-PC-Q               PIC X.
  3848                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3849             20  CF-MORT-TABLE-CODE         PIC X(4).
  3850             20  CF-MORT-COMMENTS           PIC X(15).
  3851             20  FILLER                     PIC X(14).
  3852
  3853         16  FILLER                         PIC X(251).
  3854
  3855
  3856****************************************************************
  3857*             BUSSINESS TYPE MASTER RECORD                     *
  3858****************************************************************
  3859
  3860     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3861* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3862* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3863* AND RECORD 05 IS TYPES 81-99
  3864         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3865             20  CF-BUSINESS-TITLE          PIC  X(19).
  3866             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3867                                            PIC S9V9(4) COMP-3.
  3868             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3869             20  FILLER                     PIC  X.
  3870         16  FILLER                         PIC  X(248).
  3871
  3872
  3873****************************************************************
  3874*             TERMINAL MASTER RECORD                           *
  3875****************************************************************
  3876
  3877     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3878
  3879         16  CF-COMPANY-TERMINALS.
  3880             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  75
* EL640.cbl
  3881                                  PIC X(4).
  3882         16  FILLER               PIC X(248).
  3883
  3884
  3885****************************************************************
  3886*             LIFE EDIT MASTER RECORD                          *
  3887****************************************************************
  3888
  3889     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3890         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3891             20  CF-LIFE-CODE-IN            PIC XX.
  3892             20  CF-LIFE-CODE-OUT           PIC XX.
  3893         16  FILLER                         PIC X(248).
  3894
  3895
  3896****************************************************************
  3897*             AH EDIT MASTER RECORD                            *
  3898****************************************************************
  3899
  3900     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3901         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3902             20  CF-AH-CODE-IN              PIC XXX.
  3903             20  CF-AH-CODE-OUT             PIC XX.
  3904         16  FILLER                         PIC X(248).
  3905
  3906
  3907****************************************************************
  3908*             CREDIBILITY TABLES                               *
  3909****************************************************************
  3910
  3911     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3912         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3913                             INDEXED BY CF-CRDB-NDX.
  3914             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3915             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3916             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3917         16  FILLER                         PIC  X(332).
  3918
  3919
  3920****************************************************************
  3921*             REPORT CUSTOMIZATION RECORD                      *
  3922****************************************************************
  3923
  3924     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3925         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3926             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3927             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3928             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3929**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3930****       A T-TRANSFER.                                   ****
  3931             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3932
  3933         16  FILLER                         PIC XX.
  3934
  3935         16  CF-CARRIER-CNTL-OPT.
  3936             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3937                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3938                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  76
* EL640.cbl
  3939             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3940                                            PIC X.
  3941         16  CF-GROUP-CNTL-OPT.
  3942             20  CF-GROUP-OPT-SEQ           PIC 9.
  3943                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3944                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3945             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3946                                            PIC X(6).
  3947         16  CF-STATE-CNTL-OPT.
  3948             20  CF-STATE-OPT-SEQ           PIC 9.
  3949                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3950                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3951             20  CF-STATE-SELECT OCCURS 3 TIMES
  3952                                            PIC XX.
  3953         16  CF-ACCOUNT-CNTL-OPT.
  3954             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3955                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3956                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3957             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3958                                            PIC X(10).
  3959         16  CF-BUS-TYP-CNTL-OPT.
  3960             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3961                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3962                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3963             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3964                                            PIC XX.
  3965         16  CF-LF-TYP-CNTL-OPT.
  3966             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3967                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3968                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3969             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3970                                            PIC XX.
  3971         16  CF-AH-TYP-CNTL-OPT.
  3972             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3973                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3974                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3975             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3976                                            PIC XX.
  3977         16  CF-REPTCD1-CNTL-OPT.
  3978             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3979                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3980                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3981             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3982                                            PIC X(10).
  3983         16  CF-REPTCD2-CNTL-OPT.
  3984             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3985                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3986                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3987             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3988                                            PIC X(10).
  3989         16  CF-USER1-CNTL-OPT.
  3990             20  CF-USER1-OPT-SEQ           PIC 9.
  3991                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3992                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3993             20  CF-USER1-SELECT OCCURS 3 TIMES
  3994                                            PIC X(10).
  3995         16  CF-USER2-CNTL-OPT.
  3996             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  77
* EL640.cbl
  3997                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3998                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3999             20  CF-USER2-SELECT OCCURS 3 TIMES
  4000                                            PIC X(10).
  4001         16  CF-USER3-CNTL-OPT.
  4002             20  CF-USER3-OPT-SEQ           PIC 9.
  4003                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4004                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4005             20  CF-USER3-SELECT OCCURS 3 TIMES
  4006                                            PIC X(10).
  4007         16  CF-USER4-CNTL-OPT.
  4008             20  CF-USER4-OPT-SEQ           PIC 9.
  4009                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4010                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4011             20  CF-USER4-SELECT OCCURS 3 TIMES
  4012                                            PIC X(10).
  4013         16  CF-USER5-CNTL-OPT.
  4014             20  CF-USER5-OPT-SEQ           PIC 9.
  4015                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4016                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4017             20  CF-USER5-SELECT OCCURS 3 TIMES
  4018                                            PIC X(10).
  4019         16  CF-REINS-CNTL-OPT.
  4020             20  CF-REINS-OPT-SEQ           PIC 9.
  4021                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4022                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4023             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4024                 24  CF-REINS-PRIME         PIC XXX.
  4025                 24  CF-REINS-SUB           PIC XXX.
  4026
  4027         16  CF-AGENT-CNTL-OPT.
  4028             20  CF-AGENT-OPT-SEQ           PIC 9.
  4029                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4030                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4031             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4032                                            PIC X(10).
  4033
  4034         16  FILLER                         PIC X(43).
  4035
  4036         16  CF-LOSS-RATIO-SELECT.
  4037             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4038             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4039         16  CF-ENTRY-DATE-SELECT.
  4040             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4041             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4042         16  CF-EFFECTIVE-DATE-SELECT.
  4043             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4044             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4045
  4046         16  CF-EXCEPTION-LIST-IND          PIC X.
  4047             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4048
  4049         16  FILLER                         PIC X(318).
  4050
  4051****************************************************************
  4052*                  EXCEPTION REPORTING RECORD                  *
  4053****************************************************************
  4054
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  78
* EL640.cbl
  4055     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4056         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4057             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4058
  4059         16  CF-COMBINED-LIFE-AH-OPT.
  4060             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4061             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4062             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4063             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4064
  4065         16  CF-LIFE-OPT.
  4066             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4067             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4068             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4069             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4070             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4071             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4072             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4073             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4074             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4075             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4076
  4077         16  CF-AH-OPT.
  4078             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4079             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4080             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4081             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4082             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4083             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4084             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4085             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4086             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4087             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4088
  4089         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4090             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4091             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4092             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4093
  4094         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4095
  4096         16  FILLER                         PIC X(673).
  4097
  4098
  4099****************************************************************
  4100*             MORTGAGE SYSTEM PLAN RECORD                      *
  4101****************************************************************
  4102
  4103     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4104         16  CF-PLAN-TYPE                   PIC X.
  4105             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4106             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4107             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4108         16  CF-PLAN-ABBREV                 PIC XXX.
  4109         16  CF-PLAN-DESCRIPT               PIC X(10).
  4110         16  CF-PLAN-NOTES                  PIC X(20).
  4111         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4112         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  79
* EL640.cbl
  4113             20  CF-PLAN-TERM-DATA.
  4114                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4115                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4116             20  CF-PLAN-AGE-DATA.
  4117                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4118                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4119                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4120             20  CF-PLAN-BENEFIT-DATA.
  4121                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4122                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4123                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4124                                            PIC S9(7)V99  COMP-3.
  4125         16  CF-PLAN-POLICY-FORMS.
  4126             20  CF-POLICY-FORM             PIC X(12).
  4127             20  CF-MASTER-APPLICATION      PIC X(12).
  4128             20  CF-MASTER-POLICY           PIC X(12).
  4129         16  CF-PLAN-RATING.
  4130             20  CF-RATE-CODE               PIC X(5).
  4131             20  CF-SEX-RATING              PIC X.
  4132                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4133                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4134             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4135             20  CF-SUB-STD-TYPE            PIC X.
  4136                 88  CF-PCT-OF-PREM            VALUE '1'.
  4137                 88  CF-PCT-OF-BENE            VALUE '2'.
  4138         16  CF-PLAN-PREM-TOLERANCES.
  4139             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4140             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4141         16  CF-PLAN-PYMT-TOLERANCES.
  4142             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4143             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4144         16  CF-PLAN-MISC-DATA.
  4145             20  FILLER                     PIC X.
  4146             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4147             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4148         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4149         16  CF-PLAN-IND-GRP                PIC X.
  4150             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4151                                                     '1'.
  4152             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4153                                                     '2'.
  4154         16  CF-MIB-SEARCH-SW               PIC X.
  4155             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4156             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4157             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4158             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4159         16  CF-ALPHA-SEARCH-SW             PIC X.
  4160             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4161             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4162             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4163             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4164             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4165             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4166             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4167             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4168             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4169             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4170                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  80
* EL640.cbl
  4171                                                     'X' 'Y' 'Z'.
  4172         16  CF-EFF-DT-RULE-SW              PIC X.
  4173             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4174             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4175             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4176             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4177             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4178         16  FILLER                         PIC X(4).
  4179         16  CF-HEALTH-QUESTIONS            PIC X.
  4180             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4181         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4182         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4183         16  CF-PLAN-SNGL-JNT               PIC X.
  4184             88  CF-COMBINED-PLAN              VALUE 'C'.
  4185             88  CF-JNT-PLAN                   VALUE 'J'.
  4186             88  CF-SNGL-PLAN                  VALUE 'S'.
  4187         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4188         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4189         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4190         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4191         16  CF-RERATE-CNTL                 PIC  X.
  4192             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4193             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4194             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4195             88  CF-AUTO-RECALC                 VALUE '4'.
  4196         16  CF-BENEFIT-TYPE                PIC  X.
  4197             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4198             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4199         16  CF-POLICY-FEE                  PIC S999V99
  4200                                                    COMP-3.
  4201         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4202         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4203         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4204         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4205         16  FILLER                         PIC  X(32).
  4206         16  CF-TERMINATION-FORM            PIC  X(04).
  4207         16  FILLER                         PIC  X(08).
  4208         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4209                                                       COMP-3.
  4210         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4211         16  CF-ISSUE-LETTER                PIC  X(4).
  4212         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4213         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4214             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4215             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4216         16  CF-MP-REFUND-CALC              PIC X.
  4217             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4218             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4219             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4220             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4221             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4222             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4223             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4224             88  CF-MP-REFD-MEAN                VALUE '8'.
  4225         16  CF-ALT-RATE-CODE               PIC  X(5).
  4226
  4227
  4228         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  81
* EL640.cbl
  4229****************************************************************
  4230*             MORTGAGE COMPANY MASTER RECORD                   *
  4231****************************************************************
  4232
  4233     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4234         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4235         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4236             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4237             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4238             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4239             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4240             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4241
  4242         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4243         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4244         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4245         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4246         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4247
  4248         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4249             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4250         16  CF-MP-RECON-USE-IND            PIC X(1).
  4251             88  CF-MP-USE-RECON             VALUE 'Y'.
  4252         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4253             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4254         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4255             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4256             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4257         16  FILLER                         PIC X(1).
  4258         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4259             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4260         16  CF-MORTG-MIB-VERSION           PIC X.
  4261             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4262             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4263             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4264         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4265             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4266                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4267             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4268                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4269             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4270                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4271             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4272                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4273             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4274                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4275             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4276                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4277         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4278         16  FILLER                         PIC X(7).
  4279         16  CF-MORTG-DESTINATION-SYMBOL.
  4280             20  CF-MORTG-MIB-COMM          PIC X(5).
  4281             20  CF-MORTG-MIB-TERM          PIC X(5).
  4282         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4283             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4284         16  FILLER                         PIC X(03).
  4285         16  CF-MP-CHECK-NO-CONTROL.
  4286             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  82
* EL640.cbl
  4287                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4288                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4289                                                ' ' LOW-VALUES.
  4290                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4291                                               VALUE '3'.
  4292         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4293         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4294         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4295             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4296                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4297             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4298                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4299             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4300                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4301             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4302                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4303             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4304                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4305             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4306                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4307         16  CF-MORTG-BILLING-AREA.
  4308             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4309                                            PIC X.
  4310         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4311         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4312         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4313         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4314             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4315             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4316         16  FILLER                         PIC X.
  4317         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4318             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4319             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4320         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4321         16  FILLER                         PIC X(8).
  4322         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4323         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4324         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4325         16  CF-ACH-COMPANY-ID.
  4326             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4327                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4328                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4329                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4330             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4331         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4332             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4333         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4334             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4335             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4336         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4337         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4338         16  FILLER                         PIC X(536).
  4339
  4340****************************************************************
  4341*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4342****************************************************************
  4343
  4344     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  83
* EL640.cbl
  4345         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4346             20  CF-FEMALE-HEIGHT.
  4347                 24  CF-FEMALE-FT           PIC 99.
  4348                 24  CF-FEMALE-IN           PIC 99.
  4349             20  CF-FEMALE-MIN-WT           PIC 999.
  4350             20  CF-FEMALE-MAX-WT           PIC 999.
  4351         16  FILLER                         PIC X(428).
  4352
  4353     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4354         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4355             20  CF-MALE-HEIGHT.
  4356                 24  CF-MALE-FT             PIC 99.
  4357                 24  CF-MALE-IN             PIC 99.
  4358             20  CF-MALE-MIN-WT             PIC 999.
  4359             20  CF-MALE-MAX-WT             PIC 999.
  4360         16  FILLER                         PIC X(428).
  4361******************************************************************
  4362*             AUTOMATIC ACTIVITY RECORD                          *
  4363******************************************************************
  4364     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4365         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4366             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4367             20  CF-SYS-LETTER-ID           PIC X(04).
  4368             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4369             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4370             20  CF-SYS-RESET-SW            PIC X(01).
  4371             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4372             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4373
  4374         16  FILLER                         PIC X(50).
  4375
  4376         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4377             20  CF-USER-ACTIVE-SW          PIC X(01).
  4378             20  CF-USER-LETTER-ID          PIC X(04).
  4379             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4380             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4381             20  CF-USER-RESET-SW           PIC X(01).
  4382             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4383             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4384             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4385
  4386         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  84
* EL640.cbl
  4388*                            COPY ERCCOMP.
  4389******************************************************************
  4390*                                                                *
  4391*                                                                *
  4392*                            ERCCOMP                             *
  4393*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4394*                            VMOD=2.019                          *
  4395*                                                                *
  4396*   ONLINE CREDIT SYSTEM                                         *
  4397*                                                                *
  4398*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4399*                                                                *
  4400*   FILE TYPE = VSAM,KSDS                                        *
  4401*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4402*                                                                *
  4403*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4404*       ALTERNATE PATH = NONE                                    *
  4405*                                                                *
  4406*   LOG = NO                                                     *
  4407*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4408*                                                                *
  4409******************************************************************
  4410*                   C H A N G E   L O G
  4411*
  4412* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4413*-----------------------------------------------------------------
  4414*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4415* EFFECTIVE    NUMBER
  4416*-----------------------------------------------------------------
  4417* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4418* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4419* 092205    2005050300006  PEMA  ADD LEASE FEE
  4420* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4421* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4422* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4423* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4424* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4425* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4426******************************************************************
  4427
  4428 01  COMPENSATION-MASTER.
  4429     12  CO-RECORD-ID                          PIC XX.
  4430         88  VALID-CO-ID                          VALUE 'CO'.
  4431
  4432     12  CO-CONTROL-PRIMARY.
  4433         16  CO-COMPANY-CD                     PIC X.
  4434         16  CO-CONTROL.
  4435             20  CO-CTL-1.
  4436                 24  CO-CARR-GROUP.
  4437                     28  CO-CARRIER            PIC X.
  4438                     28  CO-GROUPING.
  4439                         32  CO-GROUP-PREFIX   PIC XXX.
  4440                         32  CO-GROUP-PRIME    PIC XXX.
  4441                 24  CO-RESP-NO.
  4442                     28  CO-RESP-PREFIX        PIC X(4).
  4443                     28  CO-RESP-PRIME         PIC X(6).
  4444             20  CO-CTL-2.
  4445                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  85
* EL640.cbl
  4446                     28  CO-ACCT-PREFIX        PIC X(4).
  4447                     28  CO-ACCT-PRIME         PIC X(6).
  4448         16  CO-TYPE                           PIC X.
  4449             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4450             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4451             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4452
  4453     12  CO-MAINT-INFORMATION.
  4454         16  CO-LAST-MAINT-DT                  PIC XX.
  4455         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4456         16  CO-LAST-MAINT-USER                PIC X(4).
  4457     12  FILLER                                PIC XX.
  4458     12  CO-STMT-TYPE                          PIC XXX.
  4459     12  CO-COMP-TYPE                          PIC X.
  4460         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4461     12  CO-STMT-OWNER                         PIC X(4).
  4462     12  CO-BALANCE-CONTROL                    PIC X.
  4463         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4464         88  CO-NO-BALANCE                        VALUE 'N'.
  4465
  4466     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4467         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4468         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4469         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4470
  4471     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4472         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4473         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4474
  4475     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4476     12  CO-GA-DIRECT-DEP                      PIC X.
  4477     12  CO-FUTURE-SPACE                       PIC X.
  4478         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4479
  4480     12  CO-ACCT-NAME                          PIC X(30).
  4481     12  CO-MAIL-NAME                          PIC X(30).
  4482     12  CO-ADDR-1                             PIC X(30).
  4483     12  CO-ADDR-2                             PIC X(30).
  4484     12  CO-ADDR-3.
  4485         16  CO-ADDR-CITY                      PIC X(27).
  4486         16  CO-ADDR-STATE                     PIC XX.
  4487     12  CO-CSO-1099                           PIC X.
  4488     12  CO-ZIP.
  4489         16  CO-ZIP-PRIME.
  4490             20  CO-ZIP-PRI-1ST                PIC X.
  4491                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4492             20  FILLER                        PIC X(4).
  4493         16  CO-ZIP-PLUS4                      PIC X(4).
  4494     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4495         16  CO-CAN-POSTAL-1                   PIC XXX.
  4496         16  CO-CAN-POSTAL-2                   PIC XXX.
  4497         16  FILLER                            PIC XXX.
  4498     12  CO-SOC-SEC                            PIC X(13).
  4499     12  CO-TELEPHONE.
  4500         16  CO-AREA-CODE                      PIC XXX.
  4501         16  CO-PREFIX                         PIC XXX.
  4502         16  CO-PHONE                          PIC X(4).
  4503
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  86
* EL640.cbl
  4504     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4505
  4506     12  CO-AR-BAL-LEVEL                       PIC X.
  4507         88  CO-AR-REF-LVL                        VALUE '1'.
  4508         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4509         88  CO-AR-BILL-LVL                       VALUE '2'.
  4510         88  CO-AR-AGT-LVL                        VALUE '3'.
  4511         88  CO-AR-FR-LVL                         VALUE '4'.
  4512
  4513     12  CO-AR-NORMAL-PRINT                    PIC X.
  4514         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4515         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4516
  4517     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4518
  4519     12  CO-AR-REPORTING                       PIC X.
  4520         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4521         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4522
  4523     12  CO-AR-PULL-CHECK                      PIC X.
  4524         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4525         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4526
  4527     12  CO-AR-BALANCE-PRINT                   PIC X.
  4528         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4529
  4530     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4531         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4532         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4533         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4534
  4535     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4536
  4537     12  CO-USER-CODE                          PIC X.
  4538     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4539
  4540******************************************************************
  4541*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4542*    THE LAST MONTH END RUN.
  4543******************************************************************
  4544
  4545     12  CO-LAST-ACTIVITY-DATE.
  4546         16  CO-ACT-YEAR                       PIC 99.
  4547         16  CO-ACT-MONTH                      PIC 99.
  4548         16  CO-ACT-DAY                        PIC 99.
  4549
  4550     12  CO-LAST-STMT-DT.
  4551         16  CO-LAST-STMT-YEAR                 PIC 99.
  4552         16  CO-LAST-STMT-MONTH                PIC 99.
  4553         16  CO-LAST-STMT-DAY                  PIC 99.
  4554
  4555     12  CO-MO-END-TOTALS.
  4556         16  CO-MONTHLY-TOTALS.
  4557             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4558             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4559             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4560             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4561             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  87
* EL640.cbl
  4562
  4563         16  CO-AGING-TOTALS.
  4564             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4565             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4566             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4567             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4568
  4569         16  CO-YTD-TOTALS.
  4570             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4571             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4572
  4573         16  CO-OVER-UNDER-TOTALS.
  4574             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4575             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4576
  4577     12  CO-MISCELLANEOUS-TOTALS.
  4578         16  CO-FICA-TOTALS.
  4579             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4580             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4581
  4582         16  CO-CLAIM-TOTALS.
  4583             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4584             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4585
  4586******************************************************************
  4587*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4588*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4589******************************************************************
  4590
  4591     12  CO-CURRENT-TOTALS.
  4592         16  CO-CURRENT-LAST-STMT-DT.
  4593             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4594             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4595             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4596
  4597         16  CO-CURRENT-MONTHLY-TOTALS.
  4598             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4599             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4600             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4601             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4602             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4603
  4604         16  CO-CURRENT-AGING-TOTALS.
  4605             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4606             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4607             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4608             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4609
  4610         16  CO-CURRENT-YTD-TOTALS.
  4611             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4612             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4613
  4614     12  CO-PAID-COMM-TOTALS.
  4615         16  CO-YTD-PAID-COMMS.
  4616             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4617             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4618
  4619     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  88
* EL640.cbl
  4620         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4621         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4622
  4623     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4624         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4625         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4626         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4627         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4628         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4629         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4630         88  CO-FINAL-LETTER                  VALUE 'F'.
  4631         88  CO-RECONCILING                   VALUE 'R'.
  4632         88  CO-PHONE-CALL                    VALUE 'P'.
  4633         88  CO-LEGAL                         VALUE 'L'.
  4634         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4635         88  CO-WRITE-OFF                     VALUE 'W'.
  4636         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4637
  4638     12  CO-CSR-CODE                       PIC X(4).
  4639
  4640     12  CO-GA-STATUS-INFO.
  4641         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4642         16  CO-GA-TERMINATION-DT          PIC XX.
  4643         16  CO-GA-STATUS-CODE             PIC X.
  4644             88  CO-GA-ACTIVE                 VALUE 'A'.
  4645             88  CO-GA-INACTIVE               VALUE 'I'.
  4646             88  CO-GA-PENDING                VALUE 'P'.
  4647         16  CO-GA-COMMENTS.
  4648             20  CO-GA-COMMENT-1           PIC X(40).
  4649             20  CO-GA-COMMENT-2           PIC X(40).
  4650             20  CO-GA-COMMENT-3           PIC X(40).
  4651             20  CO-GA-COMMENT-4           PIC X(40).
  4652
  4653     12  CO-RPTCD2                         PIC X(10).
  4654     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4655         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4656         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4657
  4658     12  CO-TYPE-AGENT                     PIC X(01).
  4659         88  CO-CORPORATION                   VALUE 'C'.
  4660         88  CO-PARTNERSHIP                   VALUE 'P'.
  4661         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4662         88  CO-TRUST                         VALUE 'T'.
  4663         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4664
  4665     12  CO-FAXNO.
  4666         16  CO-FAX-AREA-CODE                  PIC XXX.
  4667         16  CO-FAX-PREFIX                     PIC XXX.
  4668         16  CO-FAX-PHONE                      PIC X(4).
  4669
  4670     12  CO-BANK-INFORMATION.
  4671         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4672         16  CO-BANK-TRANSIT-NON REDEFINES
  4673             CO-BANK-TRANSIT-NO                PIC 9(8).
  4674
  4675         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4676     12  CO-MISC-DEDUCT-INFO REDEFINES
  4677                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  89
* EL640.cbl
  4678         16  CO-MD-GL-ACCT                     PIC X(10).
  4679         16  CO-MD-DIV                         PIC XX.
  4680         16  CO-MD-CENTER                      PIC X(4).
  4681         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4682         16  CO-CREATE-AP-CHECK                PIC X.
  4683         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4684         16  FILLER                            PIC XXX.
  4685     12  CO-ACH-STATUS                         PIC X.
  4686         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4687         88  CO-ACH-PENDING                        VALUE 'P'.
  4688
  4689     12  CO-BILL-SW                            PIC X.
  4690     12  CO-CONTROL-NAME                       PIC X(30).
  4691     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4692     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4693     12  CO-CLP-STATE                          PIC XX.
  4694     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4695     12  CO-SPP-REFUND-EDIT                    PIC X.
  4696
  4697******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  90
* EL640.cbl
  4699*                            COPY ERCPYAJ.
  4700******************************************************************
  4701*                                                                *
  4702*                            ERCPYAJ                             *
  4703*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4704*                            VMOD=2.015                          *
  4705*                                                                *
  4706*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  4707*                                                                *
  4708*                                                                *
  4709*   FILE TYPE = VSAM,KSDS                                        *
  4710*   RECORD SIZE = 200  RECFORM = FIXED                           *
  4711*                                                                *
  4712*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  4713*       ALTERNATE PATHS = NONE                                   *
  4714*                                                                *
  4715*   LOG = YES                                                    *
  4716*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4717******************************************************************
  4718******************************************************************
  4719*                   C H A N G E   L O G
  4720*
  4721* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4722*-----------------------------------------------------------------
  4723*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4724* EFFECTIVE    NUMBER
  4725*-----------------------------------------------------------------
  4726* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  4727* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  4728******************************************************************
  4729
  4730 01  PENDING-PAY-ADJ.
  4731     12  PY-RECORD-ID                     PIC XX.
  4732         88  VALID-PY-ID                        VALUE 'PY'.
  4733
  4734     12  PY-CONTROL-PRIMARY.
  4735         16  PY-COMPANY-CD                PIC X.
  4736         16  PY-CARRIER                   PIC X.
  4737         16  PY-GROUPING                  PIC X(6).
  4738         16  PY-FIN-RESP                  PIC X(10).
  4739         16  PY-ACCOUNT                   PIC X(10).
  4740         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  4741                                          PIC X(10).
  4742         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  4743         16  PY-RECORD-TYPE               PIC X.
  4744             88  PY-REMIT-RECEIVED            VALUE 'R'.
  4745             88  PY-DEPOSIT                   VALUE 'D'.
  4746             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  4747             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  4748             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  4749             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  4750             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  4751             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  4752             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  4753             88  PY-FICA-ENTRY                VALUE 'F'.
  4754             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  4755             88  PY-POLICY-FEE                VALUE 'W'.
  4756             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  91
* EL640.cbl
  4757
  4758     12  PY-PYMT-TYPE                     PIC X.
  4759             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  4760             88  PY-REINS-PYMT                VALUE 'R'.
  4761             88  PY-EXP-PYMT                  VALUE 'E'.
  4762
  4763     12  PY-BIL-INV                       PIC X(6).
  4764     12  PY-REF-NO                        PIC X(12).
  4765
  4766     12  PY-LAST-MAINT-DT                 PIC XX.
  4767     12  PY-LAST-MAINT-BY                 PIC X(4).
  4768     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4769
  4770     12  PY-PYADJ-RECORD.
  4771         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  4772         16  PY-ENTRY-COMMENT             PIC X(30).
  4773         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  4774             20  PY-GL-ACCOUNT            PIC X(10).
  4775             20  PY-GL-STATE              PIC X(02).
  4776             20  PY-GL-CANC-SW            PIC X(01).
  4777                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  4778                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  4779             20  PY-GL-COMMENT            PIC X(10).
  4780             20  FILLER      REDEFINES PY-GL-COMMENT.
  4781                 24  PY-GL-CHECK-NO       PIC 9(06).
  4782                 24  FILLER               PIC X(04).
  4783             20  FILLER                   PIC X(07).
  4784         16  PY-SAVE-ACCOUNT              PIC X(10).
  4785         16  PY-SAVE-TYPE                 PIC X(01).
  4786
  4787         16  PY-LETTERS.
  4788             20  PY-LETTER OCCURS 3 TIMES
  4789                           INDEXED BY PY-LET-NDX
  4790                                          PIC X(04).
  4791
  4792         16  PY-ERCOMP-TYPE               PIC X.
  4793             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  4794             88  PY-GA-TYPE                   VALUE 'G'.
  4795             88  PY-BANK-TYPE                 VALUE 'B'.
  4796         16  FILLER                       PIC X(05).
  4797
  4798     12  PY-RECORD-STATUS.
  4799         16  PY-CREDIT-SELECT-DT          PIC XX.
  4800         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  4801         16  PY-BILLED-DATE               PIC XX.
  4802         16  PY-REPORTED-DT               PIC XX.
  4803         16  PY-PMT-APPLIED               PIC X.
  4804             88  PY-ACCOUNT-PMT               VALUE 'A'.
  4805             88  PY-GA-PMT                    VALUE 'G'.
  4806             88  PY-OVWRITE-PMT               VALUE 'O'.
  4807             88  PY-NON-AR-PMT                VALUE 'N'.
  4808         16  FILLER                       PIC X(5).
  4809         16  PY-INPUT-DT                  PIC XX.
  4810         16  PY-CHECK-NUMBER              PIC X(6).
  4811         16  PY-VOID-SW                   PIC X.
  4812             88  PY-CHECK-VOIDED              VALUE 'V'.
  4813         16  PY-CHECK-ORIGIN-SW           PIC X.
  4814             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  92
* EL640.cbl
  4815             88  PY-REFUND-CHECK              VALUE 'R'.
  4816             88  PY-GA-CHECK                  VALUE 'G'.
  4817             88  PY-CHECK-WRITTEN             VALUE 'W'.
  4818             88  PY-CHECK-REVERSAL            VALUE 'V'.
  4819         16  PY-CHECK-WRITTEN-DT          PIC XX.
  4820         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  4821         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  4822         16  PY-BILL-FLAG                 PIC X.
  4823             88  PY-BILLED                    VALUE 'B'.
  4824         16  PY-AR-FLAG                   PIC X.
  4825             88  PY-AR-CYCLE                  VALUE 'C'.
  4826             88  PY-AR-MONTH-END              VALUE 'M'.
  4827         16  PY-AR-DATE                   PIC XX.
  4828
  4829     12  PY-GL-CODES.
  4830         16  PY-GL-DB                     PIC X(14).
  4831         16  PY-GL-CR                     PIC X(14).
  4832         16  PY-GL-FLAG                   PIC X.
  4833         16  PY-GL-DATE                   PIC XX.
  4834
  4835     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  4836     12  FILLER                           PIC X(3).
  4837******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  93
* EL640.cbl
  4839*                            COPY ERCACCT.
  4840******************************************************************
  4841*                                                                *
  4842*                                                                *
  4843*                            ERCACCT                             *
  4844*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4845*                            VMOD=2.031                          *
  4846*                                                                *
  4847*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4848*                                                                *
  4849*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4850*   VSAM ACCOUNT MASTER FILES.                                   *
  4851*                                                                *
  4852*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4853*                                                                *
  4854*   FILE TYPE = VSAM,KSDS                                        *
  4855*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4856*                                                                *
  4857*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4858*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4859*                                                                *
  4860*   LOG = NO                                                     *
  4861*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4862*                                                                *
  4863*                                                                *
  4864******************************************************************
  4865*                   C H A N G E   L O G
  4866*
  4867* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4868*-----------------------------------------------------------------
  4869*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4870* EFFECTIVE    NUMBER
  4871*-----------------------------------------------------------------
  4872* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4873* 092705    2005050300006  PEMA  ADD SPP LEASES
  4874* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4875* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4876* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4877* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4878* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4879******************************************************************
  4880
  4881 01  ACCOUNT-MASTER.
  4882     12  AM-RECORD-ID                      PIC XX.
  4883         88  VALID-AM-ID                      VALUE 'AM'.
  4884
  4885     12  AM-CONTROL-PRIMARY.
  4886         16  AM-COMPANY-CD                 PIC X.
  4887         16  AM-MSTR-CNTRL.
  4888             20  AM-CONTROL-A.
  4889                 24  AM-CARRIER            PIC X.
  4890                 24  AM-GROUPING.
  4891                     28 AM-GROUPING-PREFIX PIC XXX.
  4892                     28 AM-GROUPING-PRIME  PIC XXX.
  4893                 24  AM-STATE              PIC XX.
  4894                 24  AM-ACCOUNT.
  4895                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4896                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  94
* EL640.cbl
  4897             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4898                                           PIC X(19).
  4899             20  AM-CNTRL-B.
  4900                 24  AM-EXPIRATION-DT      PIC XX.
  4901                 24  FILLER                PIC X(4).
  4902             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4903                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4904
  4905     12  AM-CONTROL-BY-VAR-GRP.
  4906         16  AM-COMPANY-CD-A1              PIC X.
  4907         16  AM-VG-CARRIER                 PIC X.
  4908         16  AM-VG-GROUPING                PIC X(6).
  4909         16  AM-VG-STATE                   PIC XX.
  4910         16  AM-VG-ACCOUNT                 PIC X(10).
  4911         16  AM-VG-DATE.
  4912             20  AM-VG-EXPIRATION-DT       PIC XX.
  4913             20  FILLER                    PIC X(4).
  4914         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4915                                           PIC 9(11)      COMP-3.
  4916     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4917         16  FILLER                        PIC X(10).
  4918         16  AM-VG-KEY3.
  4919             20  AM-VG3-ACCOUNT            PIC X(10).
  4920             20  AM-VG3-EXP-DT             PIC XX.
  4921         16  FILLER                        PIC X(4).
  4922     12  AM-MAINT-INFORMATION.
  4923         16  AM-LAST-MAINT-DT              PIC XX.
  4924         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4925         16  AM-LAST-MAINT-USER            PIC X(4).
  4926         16  FILLER                        PIC XX.
  4927
  4928     12  AM-EFFECTIVE-DT                   PIC XX.
  4929     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4930
  4931     12  AM-PREV-DATES  COMP-3.
  4932         16  AM-PREV-EXP-DT                PIC 9(11).
  4933         16  AM-PREV-EFF-DT                PIC 9(11).
  4934
  4935     12  AM-REPORT-CODE-1                  PIC X(10).
  4936     12  AM-REPORT-CODE-2                  PIC X(10).
  4937
  4938     12  AM-CITY-CODE                      PIC X(4).
  4939     12  AM-COUNTY-PARISH                  PIC X(6).
  4940
  4941     12  AM-NAME                           PIC X(30).
  4942     12  AM-PERSON                         PIC X(30).
  4943     12  AM-ADDRS                          PIC X(30).
  4944     12  AM-CITY.
  4945         16  AM-ADDR-CITY                  PIC X(28).
  4946         16  AM-ADDR-STATE                 PIC XX.
  4947     12  AM-ZIP.
  4948         16  AM-ZIP-PRIME.
  4949             20  AM-ZIP-PRI-1ST            PIC X.
  4950                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4951             20  FILLER                    PIC X(4).
  4952         16  AM-ZIP-PLUS4                  PIC X(4).
  4953     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4954         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  95
* EL640.cbl
  4955         16  AM-CAN-POSTAL-2               PIC XXX.
  4956         16  FILLER                        PIC XXX.
  4957     12  AM-TEL-NO.
  4958         16  AM-AREA-CODE                  PIC 999.
  4959         16  AM-TEL-PRE                    PIC 999.
  4960         16  AM-TEL-NBR                    PIC 9(4).
  4961     12  AM-TEL-LOC                        PIC X.
  4962         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4963         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4964
  4965     12  AM-COMM-STRUCTURE.
  4966         16  AM-DEFN-1.
  4967             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4968                 24  AM-AGT.
  4969                     28  AM-AGT-PREFIX     PIC X(4).
  4970                     28  AM-AGT-PRIME      PIC X(6).
  4971                 24  AM-COM-TYP            PIC X.
  4972                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4973                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4974                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4975                 24  AM-RECALC-LV-INDIC    PIC X.
  4976                 24  AM-RETRO-LV-INDIC     PIC X.
  4977                 24  AM-GL-CODES           PIC X.
  4978                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4979                 24  FILLER                PIC X(01).
  4980         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4981             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4982                 24  FILLER                PIC X(11).
  4983                 24  AM-L-COMA             PIC XXX.
  4984                 24  AM-J-COMA             PIC XXX.
  4985                 24  AM-A-COMA             PIC XXX.
  4986                 24  FILLER                PIC X(6).
  4987
  4988     12  AM-COMM-CHANGE-STATUS             PIC X.
  4989         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4990
  4991     12  AM-CSR-CODE                       PIC X(4).
  4992
  4993     12  AM-BILLING-STATUS                 PIC X.
  4994         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4995         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4996     12  AM-AUTO-REFUND-SW                 PIC X.
  4997         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4998         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4999     12  AM-GPCD                           PIC 99.
  5000     12  AM-IG                             PIC X.
  5001         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5002         88  AM-HAS-GROUP                     VALUE '2'.
  5003     12  AM-STATUS                         PIC X.
  5004         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5005         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5006         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5007         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5008         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5009         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5010     12  AM-REMIT-TO                       PIC 99.
  5011     12  AM-ID-NO                          PIC X(11).
  5012
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  96
* EL640.cbl
  5013     12  AM-CAL-TABLE                      PIC XX.
  5014     12  AM-LF-DEVIATION                   PIC XXX.
  5015     12  AM-AH-DEVIATION                   PIC XXX.
  5016     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5017     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5018     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5019     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5020     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5021     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5022
  5023     12  AM-USER-FIELDS.
  5024         16  AM-FLD-1                      PIC XX.
  5025         16  AM-FLD-2                      PIC XX.
  5026         16  AM-FLD-3                      PIC XX.
  5027         16  AM-FLD-4                      PIC XX.
  5028         16  AM-FLD-5                      PIC XX.
  5029
  5030     12  AM-1ST-PROD-DATE.
  5031         16  AM-1ST-PROD-YR                PIC XX.
  5032         16  AM-1ST-PROD-MO                PIC XX.
  5033         16  AM-1ST-PROD-DA                PIC XX.
  5034     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5035     12  AM-CERTS-PURGED-DATE.
  5036         16  AM-PUR-YR                     PIC XX.
  5037         16  AM-PUR-MO                     PIC XX.
  5038         16  AM-PUR-DA                     PIC XX.
  5039     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5040     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5041     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5042     12  AM-INACTIVE-DATE.
  5043         16  AM-INA-MO                     PIC 99.
  5044         16  AM-INA-DA                     PIC 99.
  5045         16  AM-INA-YR                     PIC 99.
  5046     12  AM-AR-HI-CERT-DATE                PIC XX.
  5047
  5048     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5049     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5050
  5051     12  AM-OB-PAYMENT-MODE                PIC X.
  5052         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5053         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5054         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5055         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5056
  5057     12  AM-AH-ONLY-INDICATOR              PIC X.
  5058         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5059         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5060
  5061     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5062
  5063     12  AM-OVER-SHORT.
  5064         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5065         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5066
  5067     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5068     12  AM-DCC-CLP-STATE                  PIC XX.
  5069
  5070     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  97
* EL640.cbl
  5071     12  AM-RECALC-REIN                    PIC X.
  5072
  5073     12  AM-REI-TABLE                      PIC XXX.
  5074     12  AM-REI-ET-LF                      PIC X.
  5075     12  AM-REI-ET-AH                      PIC X.
  5076     12  AM-REI-PE-LF                      PIC X.
  5077     12  AM-REI-PE-AH                      PIC X.
  5078     12  AM-REI-PRT-ST                     PIC X.
  5079     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5080     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5081     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5082     12  AM-REI-GROUP-A                    PIC X(6).
  5083     12  AM-REI-MORT                       PIC X(4).
  5084     12  AM-REI-PRT-OW                     PIC X.
  5085     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5086     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5087     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5088     12  AM-REI-GROUP-B                    PIC X(6).
  5089
  5090     12  AM-TRUST-TYPE                     PIC X(2).
  5091
  5092     12  AM-EMPLOYER-STMT-USED             PIC X.
  5093     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5094
  5095     12  AM-STD-AH-TYPE                    PIC XX.
  5096     12  AM-EARN-METHODS.
  5097         16  AM-EARN-METHOD-R              PIC X.
  5098             88 AM-REF-RL-R78                 VALUE 'R'.
  5099             88 AM-REF-RL-PR                  VALUE 'P'.
  5100             88 AM-REF-RL-MEAN                VALUE 'M'.
  5101             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5102         16  AM-EARN-METHOD-L              PIC X.
  5103             88 AM-REF-LL-R78                 VALUE 'R'.
  5104             88 AM-REF-LL-PR                  VALUE 'P'.
  5105             88 AM-REF-LL-MEAN                VALUE 'M'.
  5106             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5107         16  AM-EARN-METHOD-A              PIC X.
  5108             88 AM-REF-AH-R78                 VALUE 'R'.
  5109             88 AM-REF-AH-PR                  VALUE 'P'.
  5110             88 AM-REF-AH-MEAN                VALUE 'M'.
  5111             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5112             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5113             88 AM-REF-AH-NET                 VALUE 'N'.
  5114
  5115     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5116     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5117     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5118
  5119     12  AM-RET-Y-N                        PIC X.
  5120     12  AM-RET-P-E                        PIC X.
  5121     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5122     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5123     12  AM-RET-GRP                        PIC X(6).
  5124     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5125         16  AM-POOL-PRIME                 PIC XXX.
  5126         16  AM-POOL-SUB                   PIC XXX.
  5127     12  AM-RETRO-EARNINGS.
  5128         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  98
* EL640.cbl
  5129         16  AM-RET-EARN-L                 PIC X.
  5130         16  AM-RET-EARN-A                 PIC X.
  5131     12  AM-RET-ST-TAX-USE                 PIC X.
  5132         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5133         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5134     12  AM-RETRO-BEG-EARNINGS.
  5135         16  AM-RET-BEG-EARN-R             PIC X.
  5136         16  AM-RET-BEG-EARN-L             PIC X.
  5137         16  AM-RET-BEG-EARN-A             PIC X.
  5138     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5139     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5140
  5141     12  AM-USER-SELECT-OPTIONS.
  5142         16  AM-USER-SELECT-1              PIC X(10).
  5143         16  AM-USER-SELECT-2              PIC X(10).
  5144         16  AM-USER-SELECT-3              PIC X(10).
  5145         16  AM-USER-SELECT-4              PIC X(10).
  5146         16  AM-USER-SELECT-5              PIC X(10).
  5147
  5148     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5149
  5150     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5151
  5152     12  AM-RPT045A-SWITCH                 PIC X.
  5153         88  RPT045A-OFF                   VALUE 'N'.
  5154
  5155     12  AM-INSURANCE-LIMITS.
  5156         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5157         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5158
  5159     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5160         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5161
  5162     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5163         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5164         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5165
  5166     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5167
  5168     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5169     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5170     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5171     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5172     12  AM-DCC-UEF-STATE                  PIC XX.
  5173     12  FILLER                            PIC XXX.
  5174     12  AM-REPORT-CODE-3                  PIC X(10).
  5175*    12  FILLER                            PIC X(22).
  5176
  5177     12  AM-RESERVE-DATE.
  5178         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5179         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5180         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5181
  5182     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5183     12  AM-NOTIFICATION-TYPES.
  5184         16  AM-NOTIF-OF-LETTERS           PIC X.
  5185         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5186         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  99
* EL640.cbl
  5187         16  AM-NOTIF-OF-STATUS            PIC X.
  5188
  5189     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5190         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5191         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5192         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5193         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5194
  5195     12  AM-BENEFIT-CONTROLS.
  5196         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5197             20  AM-BENEFIT-CODE           PIC XX.
  5198             20  AM-BENEFIT-TYPE           PIC X.
  5199             20  AM-BENEFIT-REVISION       PIC XXX.
  5200             20  AM-BENEFIT-REM-TERM       PIC X.
  5201             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5202             20  FILLER                    PIC XX.
  5203         16  FILLER                        PIC X(80).
  5204
  5205     12  AM-TRANSFER-DATA.
  5206         16  AM-TRANSFERRED-FROM.
  5207             20  AM-TRNFROM-CARRIER        PIC X.
  5208             20  AM-TRNFROM-GROUPING.
  5209                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5210                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5211             20  AM-TRNFROM-STATE          PIC XX.
  5212             20  AM-TRNFROM-ACCOUNT.
  5213                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5214                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5215             20  AM-TRNFROM-DTE            PIC XX.
  5216         16  AM-TRANSFERRED-TO.
  5217             20  AM-TRNTO-CARRIER          PIC X.
  5218             20  AM-TRNTO-GROUPING.
  5219                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5220                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5221             20  AM-TRNTO-STATE            PIC XX.
  5222             20  AM-TRNTO-ACCOUNT.
  5223                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5224                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5225             20  AM-TRNTO-DTE              PIC XX.
  5226         16  FILLER                        PIC X(10).
  5227
  5228     12  AM-SAVED-REMIT-TO                 PIC 99.
  5229
  5230     12  AM-COMM-STRUCTURE-SAVED.
  5231         16  AM-DEFN-1-SAVED.
  5232             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5233                 24  AM-AGT-SV             PIC X(10).
  5234                 24  AM-COM-TYP-SV         PIC X.
  5235                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5236                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5237                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5238                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5239                 24  FILLER                PIC X.
  5240                 24  AM-GL-CODES-SV        PIC X.
  5241                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5242                 24  FILLER                PIC X.
  5243         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5244             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 100
* EL640.cbl
  5245                 24  FILLER                PIC X(11).
  5246                 24  AM-L-COMA-SV          PIC XXX.
  5247                 24  AM-J-COMA-SV          PIC XXX.
  5248                 24  AM-A-COMA-SV          PIC XXX.
  5249                 24  FILLER                PIC X(6).
  5250
  5251     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5252         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5253            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5254            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5255            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5256
  5257     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5258     12  FILLER                            PIC X(120).
  5259
  5260     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5261         16  AM-CONTROL-NAME               PIC X(30).
  5262         16  AM-EXECUTIVE-ONE.
  5263             20  AM-EXEC1-NAME             PIC X(15).
  5264             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5265                                                          COMP-3.
  5266             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5267                                                          COMP-3.
  5268         16  AM-EXECUTIVE-TWO.
  5269             20  AM-EXEC2-NAME             PIC X(15).
  5270             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5271                                                          COMP-3.
  5272             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5273                                                          COMP-3.
  5274
  5275     12  AM-RETRO-ADDITIONAL-DATA.
  5276         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5277         16  AM-RETRO-PREM-P-E             PIC X.
  5278         16  AM-RETRO-CLMS-P-I             PIC X.
  5279         16  AM-RETRO-RET-BRACKET-LF.
  5280             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5281                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5282                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5283             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5284                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5285                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5286             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5287                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5288                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5289         16  AM-RETRO-RET-BRACKET-AH.
  5290             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5291                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5292                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5293                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5294             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5295                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5296                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5297             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5298                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5299                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5300
  5301     12  AM-COMMENTS.
  5302         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 101
* EL640.cbl
  5303
  5304     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5305         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5306         16  AM-FLI-BILLING-CODE           PIC X.
  5307         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5308         16  AM-FLI-UNITED-IDENT           PIC X.
  5309         16  AM-FLI-INTEREST-LOST-DATA.
  5310             20  AM-FLI-BANK-NO            PIC X(5).
  5311             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5312             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5313             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5314         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5315             20  AM-FLI-AGT                PIC X(9).
  5316             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5317             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5318         16  FILLER                        PIC X(102).
  5319
  5320     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5321         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5322             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5323             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5324             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5325             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5326             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5327         16  FILLER                          PIC X(10).
  5328******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 102
* EL640.cbl
  5330*                            COPY ERCBILL.
  5331******************************************************************
  5332*                                                                *
  5333*                                                                *
  5334*                            ERCBILL                             *
  5335*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5336*                            VMOD=2.007                          *
  5337*                                                                *
  5338*   FILE DESCRIPTION = BILLING STATEMENTS FOR PRINTING           *
  5339*                                                                *
  5340*   FILE TYPE = VSAM,KSDS                                        *
  5341*   RECORD SIZE = 210  RECFORM = FIXED                           *
  5342*                                                                *
  5343*   BASE CLUSTER = ERBILL                        RKP=2,LEN=31    *
  5344*                                                                *
  5345*   LOG = NO                                                     *
  5346*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5347******************************************************************
  5348 01  BILLING-STATEMENT.
  5349     02 BILLING-STATEMENT-FILE.
  5350     12  BI-RECORD-ID                PIC XX.
  5351         88  VALID-BI-ID                VALUE 'BI'.
  5352
  5353     12  BI-CONTROL-PRIMARY.
  5354         16  BI-COMPANY-CD           PIC X.
  5355         16  BI-CARRIER              PIC X.
  5356         16  BI-GROUPING             PIC X(6).
  5357         16  BI-ACCOUNT              PIC X(10).
  5358         16  BI-FIN-RESP             PIC X(10).
  5359         16  BI-RECORD-TYPE          PIC X.
  5360             88  BI-HEADER-DATA         VALUE '1'.
  5361             88  BI-ADDRESS-DATA        VALUE '2'.
  5362             88  BI-TEXT-DATA           VALUE '3'.
  5363         16  BI-LINE-SEQ-NO          PIC S9(4)     COMP.
  5364
  5365     12  BI-TEXT-RECORD.
  5366         16  BI-SKIP-CONTROL         PIC X.
  5367         16  BI-TEXT-LINE            PIC X(157).
  5368         16  BI-TEXT-LINE-1 REDEFINES BI-TEXT-LINE.
  5369             20  BI-ADDR-LIT         PIC X(14).
  5370             20  BI-CO               PIC X(7).
  5371             20  BI-DASH             PIC X.
  5372             20  BI-ACCT             PIC X(10).
  5373             20  FILLER              PIC XX.
  5374             20  BI-ACCT-ADDR        PIC X(30).
  5375             20  FILLER              PIC X.
  5376             20  BI-REMIT-LIT        PIC X(11).
  5377             20  FILLER              PIC XX.
  5378             20  BI-REMIT-ADDR       PIC X(30).
  5379             20  FILLER              PIC X(49).
  5380         16  BI-TEXT-LINE-2 REDEFINES BI-TEXT-LINE.
  5381             20  BI-INS-LAST-NAME    PIC X(15).
  5382             20  FILLER              PIC X.
  5383             20  BI-INS-1ST-NAME     PIC X(10).
  5384             20  FILLER REDEFINES BI-INS-1ST-NAME.
  5385                 24  BI-INS-INITS    PIC XX.
  5386                 24  FILLER          PIC X(8).
  5387             20  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 103
* EL640.cbl
  5388             20  BI-UNDRWRTR.
  5389                 24  BI-INS-INIT     PIC X.
  5390                 24  FILLER          PIC XXX.
  5391             20  BI-CERT             PIC X(11).
  5392             20  FILLER              PIC XX.
  5393             20  BI-EFF-DT           PIC X(8).
  5394             20  FILLER              PIC XX.
  5395             20  BI-CAN-DT           PIC X(8).
  5396             20  FILLER              PIC XX.
  5397             20  BI-ED-TERM          PIC ZZZ.
  5398             20  FILLER              PIC XX.
  5399             20  BI-TYPE             PIC XXXX.
  5400             20  FILLER              PIC X.
  5401             20  BI-PREM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5402             20  FILLER              PIC X(3).
  5403             20  BI-ED-RATE          PIC ZZZ.ZZZ.
  5404             20  FILLER              PIC XX.
  5405             20  BI-COMM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5406             20  FILLER              PIC XX.
  5407             20  BI-FACE-AMT         PIC ZZZ,ZZZ,ZZZ.ZZ-.
  5408             20  FILLER              PIC X(26).
  5409         16  BI-TEXT-LINE-3 REDEFINES BI-TEXT-LINE.
  5410             20  FILLER              PIC X(42).
  5411             20  BI-TOT-DESC         PIC X(20).
  5412             20  FILLER REDEFINES BI-TOT-DESC.
  5413                 24  BI-TOT-LIT      PIC X(6).
  5414                 24  BI-OVERRIDE-L6  PIC X(14).
  5415             20  FILLER              PIC X(11).
  5416             20  BI-TOT-PREM         PIC ZZZ,ZZZ,ZZZ.99-.
  5417             20  BI-TOT-DASH REDEFINES
  5418                 BI-TOT-PREM         PIC X(15).
  5419             20  FILLER              PIC X(11).
  5420             20  BI-COM-TOT          PIC ZZZ,ZZZ,ZZZ.99-.
  5421             20  FILLER              PIC XX.
  5422             20  BI-FACE-TOT         PIC ZZZ,ZZZ,ZZZ.99-.
  5423             20  FILLER              PIC X(26).
  5424         16  BI-TEXT-LINE-4 REDEFINES BI-TEXT-LINE.
  5425             20  BI-ENTRY-DESC       PIC X(30).
  5426             20  FILLER              PIC X(11).
  5427             20  BI-ENTRY-AMT        PIC ZZZZ,ZZZ,ZZZ.99-.
  5428             20  FILLER              PIC X(31).
  5429             20  BI-ACCTG-COMMENT    PIC X(30).
  5430             20  FILLER              PIC X(39).
  5431         16  BI-TEXT-LINE-5 REDEFINES BI-TEXT-LINE.
  5432             20  FILLER              PIC X(42).
  5433             20  BI-TOT-DESC5        PIC X(20).
  5434             20  FILLER              PIC X(11).
  5435             20  BI-TOT-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5436             20  BI-COM-TOT5         PIC ZZZ,ZZZ,ZZZ.99-.
  5437             20  BI-NON-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5438             20  BI-NON-COMM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5439             20  FILLER              PIC X(24).
  5440         16  BI-TEXT-FIRST REDEFINES BI-TEXT-LINE.
  5441             20  BI-TEXT-2-81        PIC X(80).
  5442             20  FILLER              PIC X(77).
  5443         16  BI-TEXT-LAST REDEFINES BI-TEXT-LINE.
  5444             20  FILLER              PIC X(53).
  5445             20  BI-TEXT-55-133      PIC X(79).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 104
* EL640.cbl
  5446             20  FILLER              PIC X(25).
  5447         16  BI-TEXT-TYPE            PIC X.
  5448             88 DETAIL-LINE              VALUE 'D'.
  5449         16  BI-TERM                 PIC S999.
  5450         16  BI-BENEFIT-AMT          PIC S9(9)V99 COMP-3.
  5451         16  BI-PREMIUM-AMT          PIC S9(7)V99 COMP-3.
  5452         16  BI-RATE                 PIC S99V9(5) COMP-3.
  5453
  5454     12  BI-ADDRESS-RECORD  REDEFINES  BI-TEXT-RECORD.
  5455         16  FILLER                  PIC X.
  5456         16  BI-ACCT-ADDRESS-LINE    PIC X(30).
  5457         16  FILLER                  PIC X(10).
  5458         16  BI-REMIT-ADDRESS-LINE   PIC X(30).
  5459         16  FILLER                  PIC X(106).
  5460
  5461     12  BI-HEADER-RECORD  REDEFINES  BI-TEXT-RECORD.
  5462         16  BI-PROCESSOR-CD         PIC X(4).
  5463         16  BI-STATEMENT-TYPE       PIC X.
  5464             88  BI-PREVIEW-ONLY         VALUE 'P'.
  5465         16  BI-NO-OF-COPIES         PIC S9.
  5466         16  BI-CREATION-DT          PIC XX.
  5467         16  BI-INITIAL-PRINT-DATE   PIC XX.
  5468         16  BI-ACCOUNT-TOTALS.
  5469             20  BI-BAL-FRWD         PIC S9(9)V99     COMP-3.
  5470             20  BI-PREMIUM          PIC S9(9)V99     COMP-3.
  5471             20  BI-REMITTED         PIC S9(9)V99     COMP-3.
  5472             20  BI-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5473             20  BI-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5474             20  BI-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5475             20  BI-DISBURSED        PIC S9(9)V99     COMP-3.
  5476             20  BI-END-BAL          PIC S9(9)V99     COMP-3.
  5477         16  BI-FIN-RESP-ACCT        PIC X(10).
  5478         16  BI-FIN-RESP-NAME        PIC X(30).
  5479         16  FILLER                  PIC X(79).
  5480
  5481
  5482     02 GA-BILLING-STATEMENT REDEFINES BILLING-STATEMENT-FILE.
  5483     12  FILLER                      PIC XX.
  5484
  5485     12  GA-CONTROL-PRIMARY.
  5486         16  FILLER                  PIC X(31).
  5487
  5488     12  GA-TEXT-RECORD.
  5489         16  GA-SKIP-CONTROL         PIC X.
  5490         16  GA-TEXT-LINE            PIC X(132).
  5491         16  GA-TEXT-LINE-1 REDEFINES GA-TEXT-LINE.
  5492             20  FILLER              PIC X.
  5493             20  GA-CARRIER          PIC X.
  5494             20  GA-GROUPING         PIC X(6).
  5495             20  GA-DASH             PIC X.
  5496             20  GA-AGENT            PIC X(10).
  5497             20  FILLER              PIC X.
  5498             20  GA-AGENT-ADDR       PIC X(30).
  5499             20  FILLER              PIC X(82).
  5500         16  GA-TEXT-LINE-2 REDEFINES GA-TEXT-LINE.
  5501             20  GA-ACCT             PIC X(10).
  5502             20  FILLER              PIC X.
  5503             20  GA-ACCT-NAME        PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 105
* EL640.cbl
  5504             20  GA-BEG-BAL          PIC ZZZZ,ZZZ.99-.
  5505             20  GA-NET-PREM         PIC ZZZZ,ZZZ.ZZ-.
  5506             20  GA-ACCT-COMP        PIC ZZZZ,ZZZ.ZZ-.
  5507             20  GA-PMTS-ADJS        PIC ZZZZ,ZZZ.ZZ-.
  5508             20  GA-UNPAID-NET-PREM  PIC ZZZZ,ZZZ.ZZ-.
  5509             20  GA-BEN-OVERRIDE-L6  PIC X(6).
  5510             20  FILLER              PIC X.
  5511             20  GA-OVERWRITE        PIC ZZZZ,ZZZ.ZZ-.
  5512             20  GA-AMT-DUE          PIC ZZZ,ZZZ.99-.
  5513             20  FILLER              PIC X.
  5514         16  GA-TEXT-LINE-3 REDEFINES GA-TEXT-LINE.
  5515             20  FILLER              PIC X(11).
  5516             20  GA-ENTRY-DESC       PIC X(30).
  5517             20  FILLER              PIC X(60).
  5518             20  GA-ENTRY-COMMENT    PIC X(30).
  5519             20  FILLER              PIC X.
  5520         16  FILLER.
  5521             20  GA-BENEFIT-CD       PIC XX.
  5522             20  GA-BEG-BAL-AMT      PIC S9(7)V99 COMP-3.
  5523             20  GA-END-BAL-AMT      PIC S9(7)V99 COMP-3.
  5524             20  GA-NET-PREM-AMT     PIC S9(7)V99 COMP-3.
  5525             20  GA-ACCT-COMP-AMT    PIC S9(7)V99 COMP-3.
  5526             20  GA-PMTS-ADJS-AMT    PIC S9(7)V99 COMP-3.
  5527             20  GA-UNPAID-NET-AMT   PIC S9(7)V99 COMP-3.
  5528             20  GA-OVERWRITE-AMT    PIC S9(7)V99 COMP-3.
  5529             20  GA-AMT-DUE-AMT      PIC S9(7)V99 COMP-3.
  5530
  5531     12  GA-ADDRESS-RECORD  REDEFINES  GA-TEXT-RECORD.
  5532         16  FILLER                  PIC X.
  5533         16  GA-ACCT-ADDRESS-LINE    PIC X(30).
  5534         16  FILLER                  PIC X(144).
  5535
  5536     12  GA-HEADER-RECORD  REDEFINES  GA-TEXT-RECORD.
  5537         16  GA-PROCESSOR-CD         PIC X(4).
  5538         16  GA-STATEMENT-TYPE       PIC X.
  5539             88  GA-PREVIEW-ONLY         VALUE 'P'.
  5540         16  GA-NO-OF-COPIES         PIC S9.
  5541         16  GA-CREATION-DT          PIC XX.
  5542         16  GA-INITIAL-PRINT-DATE   PIC XX.
  5543         16  GA-AGENT-TOTALS.
  5544             20  GA-NET-UNPD         PIC S9(9)V99     COMP-3.
  5545             20  GA-COMP-UNPD-PREM   PIC S9(9)V99     COMP-3.
  5546             20  GA-PREMIUM          PIC S9(9)V99     COMP-3.
  5547             20  GA-REMITTED         PIC S9(9)V99     COMP-3.
  5548             20  GA-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5549             20  GA-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5550             20  GA-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5551             20  GA-DISBURSED        PIC S9(9)V99     COMP-3.
  5552             20  GA-END-BALANCE      PIC S9(9)V99     COMP-3.
  5553         16  GA-AGENTS-NAME          PIC X(30).
  5554         16  FILLER                  PIC X(81).
  5555     12  FILLER                      PIC XX.
  5556
  5557
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 106
* EL640.cbl
  5559*                            COPY ELCTEXT.
  5560******************************************************************
  5561*                                                                *
  5562*                                                                *
  5563*                            ELCTEXT.                            *
  5564*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5565*                            VMOD=2.008                          *
  5566*                                                                *
  5567*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  5568*                                     FORM LETTERS,              *
  5569*                                     CERT FORM DISPLAY.
  5570*                                                                *
  5571*   FILE TYPE = VSAM,KSDS                                        *
  5572*   RECORD SIZE = 100   RECFORM = FIXED                          *
  5573*                                                                *
  5574*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  5575*       ALTERNATE INDEX = NONE                                   *
  5576*                                                                *
  5577*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  5578*       ALTERNATE INDEX = NONE                                   *
  5579*                                                                *
  5580*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  5581*       ALTERNATE INDEX = NONE                                   *
  5582*                                                                *
  5583*   LOG = NO                                                     *
  5584*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5585******************************************************************
  5586 01  TEXT-FILES.
  5587     12  TEXT-FILE-ID                PIC XX.
  5588         88  FORMS-FILE-TEXT            VALUE 'TF'.
  5589         88  LETTER-FILE-TEXT           VALUE 'TL'.
  5590         88  HELP-FILE-TEXT             VALUE 'TH'.
  5591
  5592     12  TX-CONTROL-PRIMARY.
  5593         16  TX-COMPANY-CD           PIC X.
  5594             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  5595         16  TX-ACCESS-CD-GENL       PIC X(12).
  5596
  5597         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5598             20  TX-LETTER-NO        PIC X(4).
  5599             20  FILLER              PIC X(8).
  5600
  5601         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5602             20  TX-FORM-NO          PIC X(12).
  5603
  5604         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5605             20  TX-HELP-TYPE        PIC X.
  5606                 88  HELP-FOR-GENERAL   VALUE ' '.
  5607                 88  HELP-BY-SCREEN     VALUE 'S'.
  5608                 88  HELP-BY-ERROR      VALUE 'E'.
  5609             20  TX-SCREEN-OR-ERROR  PIC X(4).
  5610                 88  GENERAL-INFO-HELP  VALUE '0000'.
  5611             20  TX-HELP-FOR-COMPANY  PIC XXX.
  5612                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  5613             20  FILLER              PIC X(4).
  5614
  5615         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  5616
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 107
* EL640.cbl
  5617     12  TX-PROCESS-CONTROL          PIC XX.
  5618         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  5619
  5620     12  TX-TEXT-LINE                PIC X(70).
  5621
  5622     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  5623         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  5624         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  5625         88  TX-VALID-FORM-SQUEEZE-VALUE
  5626                                        VALUE 'Y' ' '.
  5627
  5628     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  5629         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  5630         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  5631         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  5632         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  5633         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  5634         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  5635         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  5636                                              'K' 'N' ' '
  5637                                              'Z'.
  5638
  5639     12  TX-ARCHIVE-SW               PIC X.
  5640         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  5641         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  5642         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  5643
  5644     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  5645     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  5646
  5647     12  TX-BSR-CODE                 PIC X.
  5648         88  TX-BSR-LETTER              VALUE 'B'.
  5649         88  TX-NON-BSR-LETTER          VALUE ' '.
  5650
  5651     12  FILLER                      PIC X.
  5652*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 108
* EL640.cbl
  5654
  5655 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  5656                          CONTROL-FILE COMPENSATION-MASTER
  5657                          PENDING-PAY-ADJ ACCOUNT-MASTER
  5658                          BILLING-STATEMENT TEXT-FILES.
  5659 0000-DFHEXIT SECTION.
  5660     MOVE '9#                    $   ' TO DFHEIV0.
  5661     MOVE 'EL640' TO DFHEIV1.
  5662     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5663
  5664     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5665     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  5666     MOVE EIBTRMID               TO QID-TERM.
  5667     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  5668     MOVE '5'                    TO DC-OPTION-CODE.
  5669     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  5670     MOVE DC-BIN-DATE-1          TO WS-CURRENT-DATE.
  5671     MOVE DC-GREG-DATE-1-MDY     TO WS-CURRENT-DATE-MDY.
  5672     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DATE-EDIT.
  5673
  5674     IF EIBCALEN = 0
  5675         GO TO 8800-UNAUTHORIZED-ACCESS.
  5676
  5677     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5678         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  5679
  5680     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5681         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5682             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5683             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5684             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5685             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5686             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5687             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5688             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5689             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5690             MOVE PI-CR-CONTROL-IN-PROGRESS TO W-TRANSFER-CONTROL
  5691             MOVE SPACES          TO PI-CR-CONTROL-IN-PROGRESS
  5692         ELSE
  5693             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  5694             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  5695             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  5696             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  5697             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  5698             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  5699             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  5700             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  5701
  5702     MOVE LOW-VALUES             TO EL640AI.
  5703
  5704     IF PI-AR-PROCESSING
  5705        MOVE XCTL-635            TO XCTL-PYAJ.
  5706
  5707     IF PI-COMPANY-ID = 'DMD'
  5708        MOVE XCTL-633DMD         TO XCTL-PYAJ.
  5709
  5710     IF RETURNED-FROM NOT = SPACES
  5711         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 109
* EL640.cbl
  5712         IF RETURNED-FROM = XCTL-PYAJ AND NOT PI-VOID-BILL
  5713             MOVE ZEROS          TO PI-ADJUSTMENTS
  5714                                    PI-DISBURSED
  5715                                    PI-REMITTED
  5716             GO TO 1100-PYAJ-BILLING-PROCESS
  5717         ELSE
  5718             MOVE -1             TO APFNTERL
  5719             PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT
  5720             GO TO 8100-SEND-INITIAL-MAP.
  5721
  5722     IF EIBTRNID NOT = TRANS-ID
  5723         PERFORM 0400-CLEAR-PI  THRU  0499-EXIT
  5724         MOVE EL640A             TO PI-MAP-NAME
  5725         MOVE -1                 TO APFNTERL
  5726         GO TO 8100-SEND-INITIAL-MAP.
  5727
  5728
  5729* EXEC CICS HANDLE CONDITION
  5730*        PGMIDERR  (9600-PGMID-ERROR)
  5731*        ERROR     (9990-ABEND)
  5732*    END-EXEC.
  5733*    MOVE '"$L.                  ! " #00005724' TO DFHEIV0
  5734     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5735     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5736     MOVE X'2220233030303035373234' TO DFHEIV0(25:11)
  5737     CALL 'kxdfhei1' USING DFHEIV0
  5738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5739
  5740
  5741     IF EIBAID = DFHCLEAR
  5742         IF PI-MAP-NAME = EL640B
  5743             PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT
  5744             MOVE EL640A         TO PI-MAP-NAME
  5745             MOVE -1             TO APFNTERL
  5746             GO TO 8100-SEND-INITIAL-MAP
  5747         ELSE
  5748             GO TO 9400-CLEAR.
  5749
  5750     IF PI-PROCESSOR-ID = 'LGXX'
  5751         GO TO 0200-RECEIVE.
  5752
  5753
  5754* EXEC CICS READQ TS
  5755*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5756*        INTO   (SECURITY-CONTROL)
  5757*        LENGTH (SC-COMM-LENGTH)
  5758*        ITEM   (SC-ITEM)
  5759*    END-EXEC.
  5760*    MOVE '*$II   L              ''   #00005741' TO DFHEIV0
  5761     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5762     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5763     MOVE X'2020233030303035373431' TO DFHEIV0(25:11)
  5764     CALL 'kxdfhei1' USING DFHEIV0,
  5765           PI-SECURITY-TEMP-STORE-ID,
  5766           SECURITY-CONTROL,
  5767           SC-COMM-LENGTH,
  5768           SC-ITEM,
  5769           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 110
* EL640.cbl
  5770           DFHEIV99
  5771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5772
  5773
  5774     MOVE SC-CREDIT-DISPLAY (18)  TO PI-DISPLAY-CAP.
  5775     MOVE SC-CREDIT-UPDATE  (18)  TO PI-MODIFY-CAP.
  5776
  5777     IF NOT DISPLAY-CAP
  5778         MOVE 'READ'          TO SM-READ
  5779         PERFORM 9995-SECURITY-VIOLATION
  5780         MOVE ER-0070         TO  EMI-ERROR
  5781         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5782         GO TO 8100-SEND-INITIAL-MAP.
  5783
  5784 0200-RECEIVE.
  5785     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5786         MOVE ER-0008            TO EMI-ERROR
  5787         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5788         IF PI-MAP-NAME = EL640A
  5789             MOVE -1             TO APFNTERL
  5790             GO TO 8200-SEND-DATAONLY
  5791         ELSE
  5792             MOVE -1             TO BPFNTERL
  5793             GO TO 8200-SEND-DATAONLY.
  5794
  5795
  5796* EXEC CICS RECEIVE
  5797*        MAP      (PI-MAP-NAME)
  5798*        MAPSET   (MAPSET-NAME)
  5799*        INTO     (EL640AI)
  5800*    END-EXEC.
  5801     MOVE LENGTH OF
  5802      EL640AI
  5803       TO DFHEIV11
  5804*    MOVE '8"T I  L              ''   #00005769' TO DFHEIV0
  5805     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5806     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5807     MOVE X'2020233030303035373639' TO DFHEIV0(25:11)
  5808     CALL 'kxdfhei1' USING DFHEIV0,
  5809           PI-MAP-NAME,
  5810           EL640AI,
  5811           DFHEIV11,
  5812           MAPSET-NAME,
  5813           DFHEIV99,
  5814           DFHEIV99
  5815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5816
  5817
  5818     IF PI-END-BAL NOT NUMERIC
  5819         MOVE ZEROS              TO PI-END-BAL.
  5820
  5821     IF PI-MAP-NAME = EL640A
  5822         IF APFNTERL > ZERO
  5823             IF EIBAID NOT = DFHENTER
  5824                 MOVE ER-0004    TO EMI-ERROR
  5825                 MOVE AL-UNBOF   TO APFNTERA
  5826                 MOVE -1         TO APFNTERL
  5827                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 111
* EL640.cbl
  5828                 GO TO 8200-SEND-DATAONLY
  5829             ELSE
  5830                 IF APFNTERI NUMERIC AND
  5831                   (APFNTERI > 0 AND < 25)
  5832                     MOVE PF-VALUES (APFNTERI) TO EIBAID
  5833                 ELSE
  5834                     MOVE ER-0029  TO EMI-ERROR
  5835                     MOVE AL-UNBOF TO APFNTERA
  5836                     MOVE -1       TO APFNTERL
  5837                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5838                     GO TO 8200-SEND-DATAONLY
  5839         ELSE
  5840             NEXT SENTENCE
  5841     ELSE
  5842     IF PI-MAP-NAME = EL640B
  5843         IF BPFNTERL > ZERO
  5844             IF EIBAID NOT = DFHENTER
  5845                 MOVE ER-0004    TO EMI-ERROR
  5846                 MOVE AL-UNBOF   TO BPFNTERA
  5847                 MOVE -1         TO BPFNTERL
  5848                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5849                 GO TO 8200-SEND-DATAONLY
  5850             ELSE
  5851                 IF BPFNTERI NUMERIC AND
  5852                   (BPFNTERI > 0 AND < 25)
  5853                     MOVE PF-VALUES (BPFNTERI) TO EIBAID
  5854                 ELSE
  5855                     MOVE ER-0029  TO EMI-ERROR
  5856                     MOVE AL-UNBOF TO BPFNTERA
  5857                     MOVE -1       TO BPFNTERL
  5858                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5859                     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 112
* EL640.cbl
  5861 0300-CHECK-PFKEYS.
  5862     IF EIBAID = DFHPF23
  5863         GO TO 8810-PF23.
  5864
  5865     IF EIBAID = DFHPF24
  5866         GO TO 9200-RETURN-MAIN-MENU.
  5867
  5868     IF EIBAID = DFHPF12
  5869         GO TO 9500-PF12.
  5870
  5871******************************************************************
  5872*       IF CARRIER OR ACCOUNT SECURITY ALLOW ONLY                *
  5873*            BILLING TYPE OPTION ONE OR TWO.                     *
  5874*                        04/27/84                                *
  5875******************************************************************
  5876
  5877     IF PI-NO-CARRIER-SECURITY OR
  5878        PI-NO-ACCOUNT-SECURITY
  5879          GO TO 0305-CHECK-PFKEYS.
  5880
  5881     IF EIBAID = DFHENTER OR DFHPF6
  5882        NEXT SENTENCE
  5883       ELSE
  5884        GO TO 0320-INPUT-ERROR.
  5885
  5886 0305-CHECK-PFKEYS.
  5887     IF EIBAID = DFHPF3
  5888       AND PI-MAP-NAME = EL640A
  5889         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5890         MOVE PI-CARRIER         TO PI-CR-CARRIER
  5891         MOVE PI-GROUPING        TO PI-CR-GROUPING
  5892         MOVE PI-STATE           TO PI-CR-STATE
  5893         MOVE PI-ACCOUNT         TO PI-CR-ACCOUNT
  5894         MOVE XCTL-650           TO PGM-NAME
  5895         GO TO 9300-XCTL.
  5896
  5897     IF EIBAID = DFHPF4
  5898       AND PI-MAP-NAME = EL640A
  5899        NEXT SENTENCE
  5900     ELSE
  5901        GO TO 0320-CONT-PFKEYS.
  5902
  5903     IF PI-CR-FIN-RESP NOT = SPACES
  5904         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5905         MOVE PI-COMP-CARRIER    TO PI-CR-CARRIER
  5906         MOVE PI-COMP-GROUPING   TO PI-CR-GROUPING
  5907         MOVE PI-COMP-FIN-RESP   TO PI-CR-FIN-RESP
  5908         MOVE XCTL-652           TO PGM-NAME
  5909         GO TO 9300-XCTL.
  5910
  5911     IF PI-SCR-FIN-RESP = SPACES OR LOW-VALUES
  5912         GO TO 0315-PF4-ERROR.
  5913
  5914     PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT.
  5915
  5916     MOVE PI-SCR-CARRIER    TO PI-CR-CARRIER.
  5917     MOVE PI-SCR-GROUPING   TO PI-CR-GROUPING.
  5918     MOVE PI-SCR-FIN-RESP   TO PI-CR-FIN-RESP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 113
* EL640.cbl
  5919     MOVE PI-SCR-ACCOUNT    TO PI-CR-ACCOUNT.
  5920     MOVE PI-SCR-TYPE       TO PI-CR-TYPE.
  5921     MOVE 'Y'               TO PI-TRANSFER-SW.
  5922
  5923     IF PI-ZERO-CARRIER  OR
  5924        PI-ZERO-CAR-GROUP
  5925         MOVE ZEROS              TO PI-CR-CARRIER.
  5926
  5927     IF PI-ZERO-GROUPING  OR
  5928        PI-ZERO-CAR-GROUP
  5929         MOVE ZEROS              TO PI-CR-GROUPING.
  5930
  5931     MOVE XCTL-652               TO PGM-NAME.
  5932
  5933     GO TO 9300-XCTL.
  5934
  5935 0315-PF4-ERROR.
  5936
  5937     MOVE ER-2407                TO EMI-ERROR.
  5938     MOVE -1                     TO APFNTERL.
  5939     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5940     GO TO 8200-SEND-DATAONLY.
  5941
  5942 0320-CONT-PFKEYS.
  5943     IF EIBAID = DFHPF6
  5944       AND PI-MAP-NAME = EL640A
  5945         MOVE LOW-VALUES         TO EL640AO
  5946         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5947         MOVE XCTL-6401          TO PGM-NAME
  5948         GO TO 9300-XCTL.
  5949
  5950     IF EIBAID = DFHPF7
  5951       AND PI-MAP-NAME = EL640A
  5952         IF PI-CR-FIN-RESP NOT = SPACES
  5953             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5954             MOVE PI-COMP-CARRIER    TO PI-CR-CARRIER
  5955             MOVE PI-COMP-GROUPING   TO PI-CR-GROUPING
  5956             MOVE PI-COMP-FIN-RESP   TO PI-CR-FIN-RESP
  5957             MOVE XCTL-PYAJ          TO PGM-NAME
  5958             GO TO 9300-XCTL
  5959         ELSE
  5960             IF PI-RETURN-TO-PROGRAM = XCTL-633 OR XCTL-635 OR
  5961                                       XCTL-633DMD
  5962                 GO TO 9400-CLEAR
  5963             ELSE
  5964                 MOVE ER-2411        TO EMI-ERROR
  5965                 MOVE -1             TO APFNTERL
  5966                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5967                 GO TO 8200-SEND-DATAONLY.
  5968
  5969     IF EIBAID = DFHPF8
  5970       AND PI-MAP-NAME = EL640A
  5971           PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5972           MOVE SPACES         TO PI-CR-CONTROL-IN-PROGRESS
  5973           MOVE XCTL-658       TO PGM-NAME
  5974           GO TO 9300-XCTL.
  5975
  5976     IF EIBAID = DFHPF1
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 114
* EL640.cbl
  5977       AND PI-MAP-NAME = EL640B
  5978         GO TO 7500-PRODUCE-CHECK.
  5979
  5980     IF EIBAID = DFHPF5
  5981       AND PI-AR-PROCESSING
  5982         MOVE ER-3188            TO EMI-ERROR
  5983         MOVE -1                 TO APFNTERL
  5984         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5985         GO TO 8200-SEND-DATAONLY.
  5986
  5987     IF PI-COMPANY-ID = 'DMD'
  5988       IF EIBAID = DFHPF5
  5989         GO TO 0320-INPUT-ERROR.
  5990
  5991     IF EIBAID = DFHPF5
  5992       AND PI-MAP-NAME = EL640A
  5993            MOVE EL640B     TO PI-MAP-NAME
  5994            GO TO 7000-PROCESS-CHECK.
  5995
  5996     IF PI-MAP-NAME = EL640A
  5997         IF EIBAID = DFHENTER OR DFHPF3
  5998             GO TO 0330-EDIT-DATA
  5999         ELSE
  6000             GO TO 0320-INPUT-ERROR
  6001     ELSE
  6002         IF PI-MAP-NAME = EL640B
  6003             IF EIBAID = DFHENTER
  6004
  6005* EXEC CICS BIF DEEDIT
  6006*                    FIELD  (BCHKAMTI)
  6007*                    LENGTH (11)
  6008*                END-EXEC
  6009     MOVE 11
  6010       TO DFHEIV11
  6011*    MOVE '@"L                   #   #00005961' TO DFHEIV0
  6012     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6013     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6014     MOVE X'2020233030303035393631' TO DFHEIV0(25:11)
  6015     CALL 'kxdfhei1' USING DFHEIV0,
  6016           BCHKAMTI,
  6017           DFHEIV11
  6018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6019                 MOVE BCHKAMTI   TO  WORK-CHECK-AMT
  6020                 MOVE 'B'        TO  WS-ENTERED-FROM-MAP
  6021                 GO TO 7000-PROCESS-CHECK.
  6022
  6023 0320-INPUT-ERROR.
  6024     MOVE ER-0029                TO EMI-ERROR.
  6025     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6026
  6027     IF PI-MAP-NAME = EL640A
  6028         MOVE AL-UNBON           TO APFNTERA
  6029         MOVE -1                 TO APFNTERL
  6030     ELSE
  6031         MOVE AL-UNBON           TO BPFNTERA
  6032         MOVE -1                 TO BPFNTERL.
  6033
  6034     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 115
* EL640.cbl
  6035
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 116
* EL640.cbl
  6037 0330-EDIT-DATA.
  6038     MOVE ABILTYPI               TO VALID-BILL-TYPE-VALUES.
  6039
  6040     IF VALID-BILL-TYPE
  6041        IF NOT MODIFY-CAP
  6042           IF ABILTYPI = '1' OR '2'
  6043              NEXT SENTENCE
  6044           ELSE
  6045              MOVE 'UPDATE'         TO SM-READ
  6046              PERFORM 9995-SECURITY-VIOLATION
  6047              MOVE ER-0070          TO EMI-ERROR
  6048              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6049              GO TO 8100-SEND-INITIAL-MAP.
  6050
  6051     MOVE SPACES                 TO PI-BILLING-COUNTS
  6052                                    PI-LIMIT-BILLING-BTCHS.
  6053
  6054******************************************************************
  6055*         SECURITY CHECK FOR CARRIER AND ACCOUNT.                *
  6056*                     04/12/84                                   *
  6057******************************************************************
  6058
  6059     IF PI-CARRIER-SECURITY > SPACES
  6060        IF ACARIERL > ZEROS
  6061            IF PI-CARRIER-SECURITY = ACARIERI
  6062                MOVE AL-UANON    TO ACARIERA
  6063            ELSE
  6064                MOVE -1          TO ACARIERL
  6065                MOVE AL-UABON    TO ACARIERA
  6066                MOVE ER-2370     TO EMI-ERROR
  6067                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6068
  6069 350-ERROR-CHECK.
  6070     IF EMI-ERROR = ZEROS
  6071         NEXT SENTENCE
  6072     ELSE
  6073         GO TO 8200-SEND-DATAONLY.
  6074
  6075     IF AACCTL > ZEROS
  6076         MOVE AL-UANON           TO AACCTA
  6077         MOVE AACCTI             TO PI-SAV-ACCT
  6078                                    PI-CR-ACCOUNT
  6079     ELSE
  6080         MOVE -1                 TO AACCTL
  6081         MOVE AL-UABON           TO AACCTA
  6082         MOVE ER-0197            TO EMI-ERROR
  6083         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6084
  6085     IF ACARIERL > ZEROS
  6086         MOVE AL-UANON           TO ACARIERA
  6087         MOVE ACARIERI           TO PI-SAV-CARR
  6088                                    WS-CARRIER
  6089     ELSE
  6090         IF NOT ST-ACCNT-CNTL AND NOT ACCNT-CNTL
  6091             MOVE -1             TO ACARIERL
  6092             MOVE AL-UABON       TO ACARIERA
  6093             MOVE ER-0194        TO EMI-ERROR
  6094             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 117
* EL640.cbl
  6095
  6096     IF AGROUPL > ZEROS
  6097         MOVE AL-UANON           TO AGROUPA
  6098         MOVE AGROUPI            TO PI-SAV-GROUP
  6099                                    WS-COMP
  6100     ELSE
  6101         IF CARR-GROUP-ST-ACCNT-CNTL
  6102             MOVE -1             TO AGROUPL
  6103             MOVE AL-UABON       TO AGROUPA
  6104             MOVE ER-0195        TO EMI-ERROR
  6105             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6106
  6107     IF ASTATEL > ZEROS
  6108         MOVE AL-UANON           TO ASTATEA
  6109         MOVE ASTATEI            TO PI-SAV-STATE
  6110     ELSE
  6111         IF NOT ACCNT-CNTL AND NOT CARR-ACCNT-CNTL
  6112             MOVE -1             TO ASTATEL
  6113             MOVE AL-UABON       TO ASTATEA
  6114             MOVE ER-0196        TO EMI-ERROR
  6115             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6116
  6117     MOVE ABILTYPI               TO VALID-BILL-TYPE-VALUES.
  6118
  6119     IF VALID-BILL-TYPE
  6120         MOVE AL-UANON           TO ABILTYPA
  6121         MOVE ABILTYPI           TO PI-BILL-TYPE
  6122     ELSE
  6123         MOVE -1                 TO ABILTYPL
  6124         MOVE ER-2249            TO EMI-ERROR
  6125         MOVE AL-UABON           TO ABILTYPA
  6126         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6127
  6128     IF PI-AR-PROCESSING
  6129        IF PI-PREVIEW
  6130           NEXT SENTENCE
  6131        ELSE
  6132           MOVE -1               TO ABILTYPL
  6133           MOVE ER-3145          TO EMI-ERROR
  6134           MOVE AL-UABON         TO ABILTYPA
  6135           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6136
  6137     IF APRODSWL NOT = ZEROS
  6138         IF PI-PREVIEW
  6139             IF APRODSWI = 'Y' OR 'N'
  6140                 MOVE AL-UANON   TO APRODSWA
  6141             ELSE
  6142                 MOVE -1         TO APRODSWL
  6143                 MOVE ER-2436    TO EMI-ERROR
  6144                 MOVE AL-UABON   TO APRODSWA
  6145                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6146         ELSE
  6147             MOVE -1             TO APRODSWL
  6148             MOVE ER-2434        TO EMI-ERROR
  6149             MOVE AL-UABON       TO APRODSWA
  6150             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6151     ELSE
  6152         IF PI-PREVIEW
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 118
* EL640.cbl
  6153             MOVE -1             TO APRODSWL
  6154             MOVE ER-2435        TO EMI-ERROR
  6155             MOVE AL-UABON       TO APRODSWA
  6156             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6157
  6158     IF ABILERRI = 'Y' OR 'N'
  6159         MOVE ABILERRI           TO PI-BILL-ERRS
  6160         MOVE AL-UANON           TO ABILERRA
  6161     ELSE
  6162         IF NOT PI-VOID-BILL
  6163             MOVE -1             TO ABILERRL
  6164             MOVE ER-2250        TO EMI-ERROR
  6165             MOVE AL-UABON       TO ABILERRA
  6166             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6167
  6168     IF ABTCH1L NOT = ZEROS
  6169         MOVE AL-UANON           TO ABTCH1A
  6170         MOVE 'Y'                TO LIMIT-BILLING-SW
  6171         MOVE ABTCH1I            TO PI-BILLING-BATCHES (1).
  6172
  6173     IF ABTCH2L NOT = ZEROS
  6174         MOVE AL-UANON           TO ABTCH2A
  6175         MOVE 'Y'                TO LIMIT-BILLING-SW
  6176         MOVE ABTCH2I            TO PI-BILLING-BATCHES (2).
  6177
  6178     IF ABTCH3L NOT = ZEROS
  6179         MOVE AL-UANON           TO ABTCH3A
  6180         MOVE 'Y'                TO LIMIT-BILLING-SW
  6181         MOVE ABTCH3I            TO PI-BILLING-BATCHES (3).
  6182
  6183     IF EMI-ERROR = ZEROS
  6184         GO TO 1000-BILLING-PROCESS.
  6185
  6186     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 119
* EL640.cbl
  6188 0400-CLEAR-PI.
  6189     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  6190
  6191     MOVE ZEROS                  TO PI-BAL-FRWD-GA  PI-BAL-FRWD
  6192                                    PI-PREMIUM      PI-REMITTED
  6193                                    PI-TOT-ISS-COMP
  6194                                    PI-TOT-CAN-COMP
  6195                                    PI-ADJUSTMENTS  PI-DISBURSED
  6196                                    PI-END-BAL      PI-LF-ISS-COMP
  6197                                    PI-AH-ISS-COMP  PI-LF-CAN-COMP
  6198                                    PI-AH-CAN-COMP.
  6199
  6200     MOVE SPACES                 TO PI-BATCH (1)
  6201                                    PI-BATCH (2)
  6202                                    PI-BATCH (3)
  6203                                    PI-BATCH (4)
  6204                                    PI-BATCH (5)
  6205                                    PI-BATCH (6).
  6206
  6207     MOVE SPACES                 TO PI-BILLING-BATCHES (1)
  6208                                    PI-BILLING-BATCHES (2)
  6209                                    PI-BILLING-BATCHES (3).
  6210
  6211     MOVE ZEROS                  TO PI-BILLED (1) PI-PREV (1)
  6212                                    PI-NOBILL (1)
  6213                                    PI-PREM (1)   PI-COMM (1)
  6214                                    PI-NON-PREM (1)
  6215                                    PI-NON-COMM (1)
  6216                                    PI-BILLED (2) PI-PREV (2)
  6217                                    PI-NOBILL (2)
  6218                                    PI-PREM (2)   PI-COMM (2)
  6219                                    PI-NON-PREM (2)
  6220                                    PI-NON-COMM (2)
  6221                                    PI-BILLED (3) PI-PREV (3)
  6222                                    PI-NOBILL (3)
  6223                                    PI-PREM (3)   PI-COMM (3)
  6224                                    PI-NON-PREM (3)
  6225                                    PI-NON-COMM (3)
  6226                                    PI-BILLED (4) PI-PREV (4)
  6227                                    PI-NOBILL (4)
  6228                                    PI-PREM (4)   PI-COMM (4)
  6229                                    PI-NON-PREM (4)
  6230                                    PI-NON-COMM (4)
  6231                                    PI-BILLED (5) PI-PREV (5)
  6232                                    PI-NOBILL (5)
  6233                                    PI-PREM (5)   PI-COMM (5)
  6234                                    PI-NON-PREM (5)
  6235                                    PI-NON-COMM (5)
  6236                                    PI-BILLED (6) PI-PREV (6)
  6237                                    PI-NOBILL (6)
  6238                                    PI-PREM (6)   PI-COMM (6)
  6239                                    PI-NON-PREM (6)
  6240                                    PI-NON-COMM (6).
  6241
  6242 0499-EXIT.
  6243      EXIT.
  6244
  6245 0500-CREATE-TEMP-STORAGE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 120
* EL640.cbl
  6246
  6247     IF PI-BAL-FRWD NOT NUMERIC
  6248         MOVE ZEROS              TO PI-BAL-FRWD
  6249                                    PI-PREMIUM
  6250                                    PI-REMITTED
  6251                                    PI-TOT-ISS-COMP
  6252                                    PI-TOT-CAN-COMP
  6253                                    PI-ADJUSTMENTS
  6254                                    PI-DISBURSED
  6255                                    PI-END-BAL.
  6256
  6257
  6258* EXEC CICS WRITEQ TS
  6259*        QUEUE  (QID)
  6260*        FROM   (PROGRAM-INTERFACE-BLOCK)
  6261*        LENGTH (PI-COMM-LENGTH)
  6262*    END-EXEC.
  6263*    MOVE '*"                    ''   #00006203' TO DFHEIV0
  6264     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  6265     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6266     MOVE X'2020233030303036323033' TO DFHEIV0(25:11)
  6267     CALL 'kxdfhei1' USING DFHEIV0,
  6268           QID,
  6269           PROGRAM-INTERFACE-BLOCK,
  6270           PI-COMM-LENGTH,
  6271           DFHEIV99,
  6272           DFHEIV99,
  6273           DFHEIV99
  6274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6275
  6276
  6277 0590-EXIT.
  6278      EXIT.
  6279
  6280 0600-RECOVER-TEMP-STORAGE.
  6281
  6282* EXEC CICS READQ TS
  6283*        QUEUE  (QID)
  6284*        INTO   (PROGRAM-INTERFACE-BLOCK)
  6285*        LENGTH (PI-COMM-LENGTH)
  6286*    END-EXEC.
  6287*    MOVE '*$I    L              ''   #00006213' TO DFHEIV0
  6288     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  6289     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6290     MOVE X'2020233030303036323133' TO DFHEIV0(25:11)
  6291     CALL 'kxdfhei1' USING DFHEIV0,
  6292           QID,
  6293           PROGRAM-INTERFACE-BLOCK,
  6294           PI-COMM-LENGTH,
  6295           DFHEIV99,
  6296           DFHEIV99,
  6297           DFHEIV99
  6298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6299
  6300
  6301     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  6302
  6303     MOVE PI-CR-CARRIER    TO PI-SCR-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 121
* EL640.cbl
  6304     MOVE PI-CR-GROUPING   TO PI-SCR-GROUPING.
  6305     MOVE PI-CR-FIN-RESP   TO PI-SCR-FIN-RESP.
  6306     MOVE PI-CR-ACCOUNT    TO PI-SCR-ACCOUNT.
  6307     MOVE PI-CR-TYPE       TO PI-SCR-TYPE.
  6308
  6309     MOVE PI-SCRN-CONTROL TO W-TRANSFER-CONTROL.
  6310
  6311 0690-EXIT.
  6312      EXIT.
  6313
  6314 0800-DELETE-TS.
  6315
  6316* EXEC CICS HANDLE CONDITION
  6317*        QIDERR (0890-EXIT)
  6318*    END-EXEC.
  6319*    MOVE '"$N                   ! # #00006233' TO DFHEIV0
  6320     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  6321     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6322     MOVE X'2320233030303036323333' TO DFHEIV0(25:11)
  6323     CALL 'kxdfhei1' USING DFHEIV0
  6324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6325
  6326
  6327
  6328* EXEC CICS DELETEQ TS
  6329*        QUEUE  (QID)
  6330*    END-EXEC.
  6331*    MOVE '*&                    #   #00006237' TO DFHEIV0
  6332     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  6333     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6334     MOVE X'2020233030303036323337' TO DFHEIV0(25:11)
  6335     CALL 'kxdfhei1' USING DFHEIV0,
  6336           QID,
  6337           DFHEIV99
  6338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6339
  6340
  6341 0890-EXIT.
  6342      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 122
* EL640.cbl
  6344 1000-BILLING-PROCESS.
  6345*                *******************************************
  6346*                *  THIS SECTION PROCESSES THE PENDING     *
  6347*                *  BUSINESS AND PAYMNTS/ADJMNTS FILES.    *
  6348*                *  THE PREMIUM AMT WRITTEN IS EXTRACTED   *
  6349*                *  FROM THE PENDING BUSINESS FILE.        *
  6350*                *******************************************
  6351
  6352     MOVE PI-COMPANY-CD          TO ERPNDB-CO-CD
  6353                                    ERPNDB-CO-CD-A1
  6354                                    ERCOMP-COMP-CD
  6355                                    ERPYAJ-COMP-CD
  6356                                    ERACCT-P-CO-CD
  6357                                    ERACCT-A-CO-CD.
  6358
  6359     MOVE WS-CURRENT-DATE-EDIT   TO BI-HD-RUN-DT.
  6360
  6361     MOVE ZEROS                  TO PI-BAL-FRWD
  6362                                    PI-PREMIUM
  6363                                    PI-REMITTED
  6364                                    PI-TOT-ISS-COMP
  6365                                    PI-TOT-CAN-COMP
  6366                                    PI-ADJUSTMENTS
  6367                                    PI-DISBURSED
  6368                                    PI-END-BAL.
  6369
  6370     IF PI-VOID-BILL
  6371         GO TO 2000-VOID-BILLING.
  6372
  6373     MOVE SPACES                 TO ELCNTL-KEY.
  6374     MOVE '1'                    TO ELCNTL-REC-TYPE.
  6375     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
  6376
  6377     IF EMI-ERROR NOT = ZEROS
  6378         GO TO 8200-SEND-DATAONLY.
  6379
  6380     IF CF-ACCOUNT-MSTR-MAINT-DT      = LOW-VALUES  OR
  6381        CF-COMPENSATION-MSTR-MAINT-DT = LOW-VALUES
  6382         MOVE ER-2571            TO EMI-ERROR
  6383         MOVE -1                 TO APFNTERL
  6384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6385         GO TO 8200-SEND-DATAONLY.
  6386
  6387     IF CF-FORMS-PRINTER-ID = SPACES
  6388        IF ABILTYPI = '3' OR '4'
  6389          MOVE 2590               TO EMI-ERROR
  6390          MOVE -1                 TO ABILTYPL
  6391          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6392          GO TO 8200-SEND-DATAONLY.
  6393
  6394     MOVE CF-CL-MAIL-TO-NAME     TO BI-HD-CO.
  6395     MOVE CF-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  6396     MOVE SPACE                  TO DC-OPTION-CODE.
  6397     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6398     MOVE DC-GREG-DATE-1-EDIT    TO PI-MONTH-END-DATE.
  6399     MOVE DC-GREG-DATE-1-ALPHA   TO BI-HD-BILL-DT.
  6400     MOVE SPACE                  TO PI-DATA-BILLED-SW.
  6401
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 123
* EL640.cbl
  6402     PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT.
  6403
  6404     IF PNDB-EOF
  6405         GO TO 1100-PYAJ-BILLING-PROCESS.
  6406
  6407 1010-PNDB-BILLING-PROCESS-LOOP.
  6408     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  6409
  6410     IF PNDB-EOF
  6411         PERFORM 3500-TOTAL-OUT-DETAIL THRU 3599-EXIT
  6412         GO TO 1100-PYAJ-BILLING-PROCESS.
  6413
  6414     IF PB-COMPANY-CD-A1 = PI-COMPANY-CD  AND
  6415        PB-CARRIER       = PI-SAV-CARR    AND
  6416        PB-GROUPING      = PI-SAV-GROUP   AND
  6417        PB-STATE         = PI-SAV-STATE   AND
  6418        PB-ACCOUNT       = PI-SAV-ACCT
  6419         NEXT SENTENCE
  6420     ELSE
  6421         PERFORM 3500-TOTAL-OUT-DETAIL THRU 3599-EXIT
  6422         GO TO 1100-PYAJ-BILLING-PROCESS.
  6423
  6424     IF (PB-ISSUE) AND
  6425        (PB-I-POLICY-IS-REISSUE OR PB-I-REIN-ONLY OR
  6426         PB-I-POLICY-IS-MONTHLY OR
  6427         PB-I-POLICY-IS-DECLINED OR PB-I-POLICY-IS-VOIDED OR
  6428         PB-I-UNDERWRITE-POLICY)
  6429          GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6430     ELSE
  6431        IF (PB-CANCELLATION)
  6432           AND  (PB-CI-LF-POLICY-IS-REISSUE
  6433             OR  PB-CI-AH-POLICY-IS-REISSUE
  6434             OR  PB-CI-LF-POLICY-IS-MONTHLY
  6435             OR  PB-CI-AH-POLICY-IS-MONTHLY
  6436             OR  PB-CI-LF-POLICY-IS-DECLINED
  6437             OR  PB-CI-AH-POLICY-IS-VOID
  6438             OR  PB-CI-LF-REIN-ONLY
  6439             OR  PB-CI-AH-REIN-ONLY)
  6440             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6441
  6442     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  6443         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6444
  6445     IF PB-RECORD-ON-HOLD OR
  6446        PB-RECORD-RETURNED
  6447         PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6448         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6449
  6450     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  6451         IF PB-ENTRY-REVERSED
  6452             GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6453         ELSE
  6454             IF PI-REBILLING
  6455                 PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT
  6456                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6457
  6458     IF PB-BILLED-DT = LOW-VALUES
  6459       OR PI-TOT-REBILL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 124
* EL640.cbl
  6460       OR PB-ALT-CHG-SEQ-NO NOT = ZEROS
  6461         NEXT SENTENCE
  6462     ELSE
  6463         IF NOT PB-BATCH-TRAILER
  6464             PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6465             GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6466         ELSE
  6467             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6468
  6469     IF LIMIT-BILLING
  6470         IF PB-ENTRY-BATCH = ABTCH1I OR
  6471                             ABTCH2I OR
  6472                             ABTCH3I
  6473             NEXT SENTENCE
  6474         ELSE
  6475             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6476
  6477     IF PB-FATAL-ERRORS  OR
  6478        PB-UNFORCED-ERRORS
  6479         IF ABILERRI = 'N'
  6480             PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6481             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  6482             MOVE ER-2570        TO EMI-ERROR
  6483             MOVE -1             TO ABILERRL
  6484             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6485             SET EMI-INDX TO 1
  6486             IF EMI-ERROR-NUMBER (EMI-INDX) = ER-2570
  6487                 MOVE EMI-ERROR-TEXT (EMI-INDX) TO WS-ERROR-TEXT
  6488                 MOVE PB-ENTRY-BATCH            TO WS-ERROR-BATCH
  6489                 MOVE WS-ERROR-MSG TO EMI-ERROR-TEXT (EMI-INDX)
  6490                 GO TO 8200-SEND-DATAONLY
  6491             ELSE
  6492                 SET EMI-INDX    TO 2
  6493                 MOVE EMI-ERROR-TEXT (EMI-INDX) TO WS-ERROR-TEXT
  6494                 MOVE PB-ENTRY-BATCH            TO WS-ERROR-BATCH
  6495                 MOVE WS-ERROR-MSG TO EMI-ERROR-TEXT (EMI-INDX)
  6496                 GO TO 8200-SEND-DATAONLY
  6497         ELSE
  6498             PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6499             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6500
  6501     IF PB-BATCH-TRAILER
  6502         IF PI-UPDATE-FILES
  6503             PERFORM 1050-BILL-BATCH-TRAILER-CHK THRU 1059-EXIT
  6504             IF BILL-BATCH-TRAILER
  6505                 MOVE SPACE           TO BILL-BATCH-TRAILER-SW
  6506                 MOVE WS-CURRENT-DATE TO PB-BILLED-DT
  6507                 PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT
  6508                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6509             ELSE
  6510                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6511         ELSE
  6512             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6513
  6514     MOVE 'Y'                    TO PI-DATA-BILLED-SW.
  6515
  6516     PERFORM 1300-CHECK-OVERRIDE-PREM THRU 1399-EXIT.
  6517
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 125
* EL640.cbl
  6518     IF PB-CERT-EFF-DT > ERACCT-A-EXP-DATE
  6519         MOVE SPACE              TO WS-PROCESS-SW
  6520         MOVE PB-CERT-EFF-DT     TO PI-SAV-EXP-DT
  6521         PERFORM 4300-READ-ACCOUNT-MASTER  THRU 4390-EXIT
  6522         PERFORM 1020-CHK-IF-AGENT-IS-SAME THRU 1029-EXIT
  6523         IF EMI-ERROR NOT = ZEROS
  6524             IF PI-UPDATE-FILES
  6525               OR (PI-PREVIEW AND APRODSWI = 'Y')
  6526                 PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6527                 IF EMI-ERROR NOT = '2403'
  6528                     PERFORM 3940-BILL-GENERIC-DELETE
  6529                             THRU 3940-EXIT
  6530                     GO TO 8200-SEND-DATAONLY
  6531                 ELSE
  6532                     GO TO 8200-SEND-DATAONLY
  6533             ELSE
  6534                 GO TO 8200-SEND-DATAONLY.
  6535
  6536     PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT.
  6537
  6538     IF DO-NOT-BILL-THIS-ACCT
  6539         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6540
  6541     PERFORM 1030-COMPUTE-COMMISSION-TOTALS THRU 1039-EXIT.
  6542
  6543     IF EMI-ERROR NOT = ZEROS
  6544         IF PI-UPDATE-FILES
  6545           OR (PI-PREVIEW AND APRODSWI = 'Y')
  6546             PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6547             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  6548             GO TO 8200-SEND-DATAONLY
  6549         ELSE
  6550             GO TO 8200-SEND-DATAONLY.
  6551
  6552     IF PI-UPDATE-FILES
  6553       OR (PI-PREVIEW AND APRODSWI = 'Y')
  6554         MOVE 'BD'               TO BILLING-DETAIL-TYPE
  6555         PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  6556
  6557     IF PI-BILL OR PI-REBILLING
  6558         PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT.
  6559
  6560     GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 126
* EL640.cbl
  6562 1020-CHK-IF-AGENT-IS-SAME.
  6563     MOVE +1 TO ACCOM-SUB.
  6564
  6565 1025-FIND-AGENT-LOOP.
  6566     IF AM-COM-TYP (ACCOM-SUB) = 'C' OR 'D' OR 'F'
  6567         NEXT SENTENCE
  6568     ELSE
  6569         ADD +1 TO ACCOM-SUB
  6570         IF ACCOM-SUB > 10
  6571             MOVE -1             TO AACCTL
  6572             MOVE ER-2404        TO EMI-ERROR
  6573             MOVE AL-UABON       TO AACCTA
  6574             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6575         ELSE
  6576             GO TO 1025-FIND-AGENT-LOOP.
  6577
  6578     IF AM-AGT (ACCOM-SUB) NOT = PI-SAV-ACCT
  6579         IF FIRST-TIME
  6580             MOVE -1             TO AACCTL
  6581             MOVE ER-2405        TO EMI-ERROR
  6582             MOVE AL-UABON       TO AACCTA
  6583             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6584             GO TO 1029-EXIT
  6585         ELSE
  6586             MOVE 'Y'            TO WS-PROCESS-SW
  6587             GO TO 1029-EXIT.
  6588
  6589     IF FIRST-TIME
  6590         MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO
  6591                                      PI-CR-FIN-RESP
  6592         MOVE 'A'                  TO PI-CR-TYPE
  6593         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  6594         MOVE SPACE                TO FIRST-TIME-SW
  6595         IF EMI-ERROR NOT = ZEROS
  6596             GO TO 1029-EXIT.
  6597
  6598     IF AM-AGT (AM-REMIT-TO) = PI-SAV-REMIT-TO
  6599         NEXT SENTENCE
  6600     ELSE
  6601         MOVE 'Y'                TO WS-PROCESS-SW
  6602         MOVE ER-2408            TO EMI-ERROR
  6603         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6604         PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6605         PERFORM 3940-BILL-GENERIC-DELETE  THRU  3940-EXIT
  6606         MOVE -1                 TO AACCTL
  6607         GO TO 8200-SEND-DATAONLY.
  6608
  6609     MOVE AM-NAME                TO PI-ACCT-NAME.
  6610
  6611     IF PI-BILL OR PI-REBILLING
  6612         PERFORM 4400-ERACCT-REWRITE THRU 4490-EXIT.
  6613
  6614 1029-EXIT.
  6615     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 127
* EL640.cbl
  6617 1030-COMPUTE-COMMISSION-TOTALS.
  6618     IF PB-CANCELLATION
  6619         GO TO 1035-COMPUTE-CANCEL-COMM.
  6620
  6621     MOVE SPACES                 TO WS-AH-CATEGORY
  6622     IF (PI-COMPANY-ID = 'DCC')
  6623        AND (NOT PB-INVALID-AH)
  6624        MOVE SPACES              TO ELCNTL-KEY
  6625        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6626        MOVE '5'                 TO ELCNTL-REC-TYPE
  6627        MOVE PB-I-AH-BENEFIT-CD  TO ELCNTL-ACCESS (3:2)
  6628                                    CLAS-LOOK
  6629        MOVE +0                  TO ELCNTL-SEQ-NO
  6630        PERFORM 6130-FIND-BENEFIT-CD
  6631                                 THRU 6140-EXIT
  6632     END-IF
  6633     if (pi-company-id = 'DCC')
  6634        and (ws-ah-category = 'G' or 'L')
  6635        compute pi-premium = ws-i-ah-premium-amt + pi-premium
  6636        move zeros               to ws-i-lf-premium-amt
  6637     else
  6638        COMPUTE PI-PREMIUM = (WS-I-LF-PREMIUM-AMT +
  6639           WS-I-AH-PREMIUM-AMT) + PI-PREMIUM
  6640     end-if
  6641     COMPUTE PI-LF-ISS-COMP ROUNDED =
  6642         (WS-I-LF-PREMIUM-AMT * PB-I-LIFE-COMMISSION).
  6643     IF WS-AH-CATEGORY = 'G' OR 'L'
  6644        COMPUTE PI-AH-ISS-COMP ROUNDED =
  6645           WS-I-AH-PREMIUM-AMT - PB-I-LF-ALT-PREMIUM-AMT
  6646              - PB-I-ADDL-CLP
  6647     ELSE
  6648        COMPUTE PI-AH-ISS-COMP ROUNDED =
  6649            (WS-I-AH-PREMIUM-AMT * PB-I-AH-COMMISSION)
  6650     END-IF
  6651     COMPUTE PI-TOT-ISS-COMP = PI-TOT-ISS-COMP +
  6652                               PI-LF-ISS-COMP +
  6653                               PI-AH-ISS-COMP.
  6654     GO TO 1039-EXIT.
  6655
  6656 1035-COMPUTE-CANCEL-COMM.
  6657
  6658     MOVE SPACES                 TO WS-AH-CATEGORY
  6659     IF (PI-COMPANY-ID = 'DCC')
  6660        AND (PB-CI-AH-BENEFIT-CD NOT = SPACES AND ZEROS)
  6661        MOVE SPACES              TO ELCNTL-KEY
  6662        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6663        MOVE '5'                 TO ELCNTL-REC-TYPE
  6664        MOVE PB-CI-AH-BENEFIT-CD TO ELCNTL-ACCESS (3:2)
  6665                                    CLAS-LOOK
  6666        MOVE +0                  TO ELCNTL-SEQ-NO
  6667        PERFORM 6130-FIND-BENEFIT-CD
  6668                                 THRU 6140-EXIT
  6669     END-IF
  6670     IF WS-AH-CATEGORY = 'G' OR 'L'
  6671        COMPUTE PI-PREMIUM = PI-PREMIUM -
  6672          WS-C-AH-CANCEL-AMT
  6673     ELSE
  6674        COMPUTE PI-PREMIUM = PI-PREMIUM -
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 128
* EL640.cbl
  6675         (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT)
  6676     END-IF
  6677
  6678     COMPUTE PI-LF-CAN-COMP   ROUNDED =
  6679         (WS-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION) * -1.
  6680     IF WS-AH-CATEGORY = 'G' OR 'L'
  6681        IF AM-DCC-PRODUCT-CODE = 'DDF'
  6682           COMPUTE CNC-FACT = PB-C-AH-RFND-CLP /
  6683              pb-ci-lf-alt-premium-amt
  6684        else
  6685           COMPUTE CNC-FACT = PB-C-AH-CANCEL-AMT /
  6686              PB-CI-AH-PREMIUM-AMT
  6687        end-if
  6688        COMPUTE PI-AH-CAN-COMP ROUNDED =
  6689           (CNC-FACT * (PB-CI-AH-PREMIUM-AMT -
  6690           PB-CI-LF-ALT-PREMIUM-AMT - PB-CI-ADDL-CLP))
  6691     ELSE
  6692        COMPUTE PI-AH-CAN-COMP   ROUNDED =
  6693         (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION) * -1
  6694     END-IF
  6695     MOVE PB-CERT-EFF-DT           TO  DC-BIN-DATE-1.
  6696     MOVE PB-C-LF-CANCEL-DT        TO  DC-BIN-DATE-2.
  6697     MOVE '1'                      TO  DC-OPTION-CODE.
  6698     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6699     MOVE DC-ELAPSED-MONTHS        TO  MONTHS-DIFF-LF.
  6700
  6701     IF DC-ODD-DAYS-OVER > ZEROS
  6702         ADD +1 TO MONTHS-DIFF-LF.
  6703
  6704     MOVE PB-CERT-EFF-DT           TO  DC-BIN-DATE-1.
  6705     MOVE PB-C-AH-CANCEL-DT        TO  DC-BIN-DATE-2.
  6706     MOVE '1'                      TO  DC-OPTION-CODE.
  6707     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6708     MOVE DC-ELAPSED-MONTHS        TO  MONTHS-DIFF-AH.
  6709
  6710     IF DC-ODD-DAYS-OVER > ZEROS
  6711         ADD +1 TO MONTHS-DIFF-AH.
  6712
  6713     PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT.
  6714
  6715     MOVE  +0                       TO  SUB.
  6716     MOVE  'Y'                      TO  WS-CHARGEBACK-LF-SW
  6717                                        WS-CHARGEBACK-AH-SW.
  6718
  6719     MOVE ZEROS                     TO  WS-LF-CAN-COMP
  6720                                        WS-AH-CAN-COMP.
  6721 1035-ACCT-COMM-LOOP.
  6722
  6723     ADD +1 TO SUB.
  6724
  6725     IF SUB > +10
  6726         GO TO 1035-COMPUTE-TOT-CAN.
  6727
  6728     IF AM-COM-TYP (SUB) NOT = 'C' AND 'D' AND 'F'
  6729         GO TO 1035-ACCT-COMM-LOOP.
  6730
  6731     IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  6732         MOVE  ZEROS            TO  AM-COMM-CHARGEBACK (SUB).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 129
* EL640.cbl
  6733
  6734     IF AM-COMM-CHARGEBACK (SUB) = '99'
  6735         MOVE  'N'               TO  WS-CHARGEBACK-LF-SW
  6736         GO TO 1035-CHECK-AH-CHARGEBACK.
  6737
  6738     IF (MONTHS-DIFF-LF > AM-COMM-CHARGEBACK (SUB))
  6739                            AND
  6740        (AM-COMM-CHARGEBACK (SUB) NOT = ZEROS)
  6741         MOVE  'N'               TO  WS-CHARGEBACK-LF-SW
  6742     ELSE
  6743         COMPUTE WS-LF-CAN-COMP   ROUNDED =  WS-LF-CAN-COMP +
  6744            (WS-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION).
  6745
  6746 1035-CHECK-AH-CHARGEBACK.
  6747
  6748     IF AM-COMM-CHARGEBACK (SUB) = '99'
  6749         MOVE  'N'                TO  WS-CHARGEBACK-AH-SW
  6750         GO TO  1035-ACCT-COMM-LOOP.
  6751
  6752     IF (MONTHS-DIFF-AH > AM-COMM-CHARGEBACK (SUB))
  6753                            AND
  6754        (AM-COMM-CHARGEBACK (SUB) NOT = ZEROS)
  6755         MOVE  'N'                TO  WS-CHARGEBACK-AH-SW
  6756     ELSE
  6757        IF WS-AH-CATEGORY = 'G' OR 'L'
  6758           MOVE PI-AH-CAN-COMP   TO WS-AH-CAN-COMP
  6759        ELSE
  6760         COMPUTE WS-AH-CAN-COMP ROUNDED = WS-AH-CAN-COMP +
  6761            (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION)
  6762        END-IF
  6763     END-IF
  6764
  6765     GO TO 1035-ACCT-COMM-LOOP.
  6766
  6767 1035-COMPUTE-TOT-CAN.
  6768
  6769     COMPUTE PI-TOT-CAN-COMP = PI-TOT-CAN-COMP +
  6770                               WS-LF-CAN-COMP +
  6771                               WS-AH-CAN-COMP.
  6772
  6773 1039-EXIT.
  6774     EXIT.
  6775
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 130
* EL640.cbl
  6777 1040-UPDATE-BILLING-STATISTICS.
  6778     SET PINDX                   TO 1.
  6779
  6780 1041-SEARCH-LOOP.
  6781     IF PI-NON-PREM (PINDX) NOT NUMERIC
  6782        MOVE ZEROS               TO PI-NON-PREM (PINDX).
  6783     IF WS-NON-PREM  NOT NUMERIC
  6784        MOVE ZEROS               TO WS-NON-PREM.
  6785     IF PI-NON-COMM (PINDX) NOT NUMERIC
  6786        MOVE ZEROS               TO PI-NON-COMM (PINDX).
  6787     IF WS-NON-COMM  NOT NUMERIC
  6788        MOVE ZEROS               TO WS-NON-COMM.
  6789
  6790     IF PI-BATCH (PINDX) NOT = SPACES
  6791         GO TO 1042-CHECK-FOR-MATCH.
  6792
  6793     MOVE PB-ENTRY-BATCH         TO PI-BATCH (PINDX).
  6794
  6795     IF PI-COMPANY-ID = 'DMD'
  6796         PERFORM 1060-DMD-ERROR-ROUTINE THRU 1060-EXIT.
  6797
  6798     IF DO-NOT-BILL-THIS-ACCT OR
  6799        PB-FATAL-ERRORS       OR
  6800        PB-UNFORCED-ERRORS    OR
  6801        PB-RECORD-ON-HOLD     OR
  6802        PB-RECORD-RETURNED    OR
  6803        PI-VOID-BILL
  6804         MOVE +1                 TO PI-NOBILL (PINDX)
  6805         MOVE ZEROS              TO PI-BILLED (PINDX)
  6806                                    PI-PREV   (PINDX)
  6807     ELSE
  6808         IF PB-BILLED-DT = LOW-VALUES
  6809           OR PI-TOT-REBILL
  6810             MOVE +1             TO PI-BILLED (PINDX)
  6811             MOVE ZEROS          TO PI-NOBILL (PINDX)
  6812                                    PI-PREV   (PINDX)
  6813         ELSE
  6814             MOVE +1             TO PI-PREV   (PINDX)
  6815             MOVE ZEROS          TO PI-BILLED (PINDX)
  6816                                    PI-NOBILL (PINDX).
  6817
  6818     GO TO 1049-EXIT.
  6819
  6820 1042-CHECK-FOR-MATCH.
  6821     IF PI-BATCH (PINDX) = PB-ENTRY-BATCH
  6822         NEXT SENTENCE
  6823     ELSE
  6824         GO TO 1043-SET-INDEX-UP.
  6825
  6826     IF PI-COMPANY-ID = 'DMD'
  6827         PERFORM 1060-DMD-ERROR-ROUTINE THRU 1060-EXIT.
  6828
  6829     IF DO-NOT-BILL-THIS-ACCT OR
  6830        PB-FATAL-ERRORS       OR
  6831        PB-UNFORCED-ERRORS    OR
  6832        PB-RECORD-ON-HOLD     OR
  6833        PB-RECORD-RETURNED    OR
  6834        PI-VOID-BILL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 131
* EL640.cbl
  6835         ADD +1 TO PI-NOBILL (PINDX)
  6836     ELSE
  6837         IF PB-BILLED-DT = LOW-VALUES
  6838           OR PI-TOT-REBILL
  6839             ADD +1          TO PI-BILLED (PINDX)
  6840         ELSE
  6841             ADD +1          TO PI-PREV   (PINDX).
  6842
  6843     GO TO 1049-EXIT.
  6844
  6845 1043-SET-INDEX-UP.
  6846     SET PINDX UP BY 1.
  6847
  6848     IF PINDX > +6
  6849         MOVE 'Y'                TO BATCHES-PROCESSED-SW
  6850         GO TO 1049-EXIT
  6851     ELSE
  6852         GO TO 1041-SEARCH-LOOP.
  6853
  6854 1049-EXIT.
  6855     EXIT.
  6856
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 132
* EL640.cbl
  6858 1050-BILL-BATCH-TRAILER-CHK.
  6859     SET PINDX                   TO 1.
  6860
  6861 1052-LOOP.
  6862     IF PI-BATCH (PINDX) = SPACES
  6863         GO TO 1059-EXIT.
  6864
  6865     IF PB-ENTRY-BATCH = PI-BATCH (PINDX)
  6866       AND PI-BILLED (PINDX) NOT = ZEROS
  6867         MOVE 'Y'                TO BILL-BATCH-TRAILER-SW
  6868         GO TO 1059-EXIT.
  6869
  6870     SET PINDX UP BY 1.
  6871     IF PINDX NOT > 6
  6872         GO TO 1052-LOOP.
  6873
  6874 1059-EXIT.
  6875     EXIT.
  6876
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 133
* EL640.cbl
  6878 1060-DMD-ERROR-ROUTINE.
  6879     IF PB-FATAL-ERRORS OR PB-UNFORCED-ERRORS
  6880        IF ABILERRI = 'Y'
  6881           IF PB-ISSUE
  6882              COMPUTE WS-NON-PREM = PB-I-LF-PREMIUM-AMT
  6883                 + PB-I-LF-ALT-PREMIUM-AMT
  6884                 + PB-I-AH-PREMIUM-AMT
  6885              ADD WS-NON-PREM TO PI-NON-PREM (PINDX)
  6886              COMPUTE WS-NON-COMM ROUNDED =
  6887              ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
  6888                                    * PB-I-LIFE-COMMISSION)
  6889                                    +
  6890               (PB-I-AH-PREMIUM-AMT * PB-I-AH-COMMISSION)
  6891              ADD WS-NON-COMM TO PI-NON-COMM (PINDX)
  6892           ELSE
  6893           IF PB-CANCELLATION
  6894              COMPUTE WS-NON-PREM =
  6895              (PB-C-LF-CANCEL-AMT +  PB-C-AH-CANCEL-AMT) * -1
  6896              ADD WS-NON-PREM TO PI-NON-PREM (PINDX)
  6897              COMPUTE WS-NON-COMM ROUNDED =
  6898              ((PB-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION)
  6899                                   +
  6900               (PB-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION))
  6901                                   * -1
  6902              ADD WS-NON-COMM TO PI-NON-COMM (PINDX).
  6903
  6904 1060-EXIT.
  6905     EXIT.
  6906
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 134
* EL640.cbl
  6908 1100-PYAJ-BILLING-PROCESS.
  6909*                *******************************************
  6910*                *  PROCESS THE PAYMENTS/ADJUSTMENTS FILE    *
  6911*                *******************************************
  6912
  6913     IF LIMIT-BILLING AND NOT PI-DATA-BILLED
  6914         MOVE ER-2443            TO EMI-ERROR
  6915         MOVE -1                 TO ABTCH1L
  6916         MOVE AL-UABON           TO ABTCH1A
  6917         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6918         GO TO 8200-SEND-DATAONLY.
  6919
  6920     IF NOT PI-DATA-BILLED
  6921         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  6922         IF EMI-ERROR = ZEROS
  6923             MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO
  6924                                          PI-CR-FIN-RESP
  6925             MOVE AM-REMIT-TO            TO ACCOM-SUB
  6926             MOVE 'A'                    TO PI-CR-TYPE
  6927             PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  6928             IF EMI-ERROR NOT = ZEROS
  6929                 GO TO 8200-SEND-DATAONLY
  6930             ELSE
  6931                 NEXT SENTENCE
  6932         ELSE
  6933             GO TO 8200-SEND-DATAONLY.
  6934
  6935 1105-PYAJ-BILLING-STARTBR-LOOP.
  6936     PERFORM 4500-PYAJ-START-BROWSE THRU 4590-EXIT.
  6937
  6938     IF PYAJ-EOF
  6939         GO TO 1200-PYAJ-BILLING-COMPLETE.
  6940
  6941 1110-PYAJ-BILLING-READ-LOOP.
  6942     PERFORM 4600-PYAJ-READ-NEXT THRU 4690-EXIT.
  6943
  6944     IF PYAJ-EOF
  6945         GO TO 1200-PYAJ-BILLING-COMPLETE.
  6946
  6947     IF PY-COMPANY-CD = PI-COMPANY-CD      AND
  6948        PY-CARRIER    = ERPYAJ-BR-CARRIER  AND
  6949        PY-GROUPING   = ERPYAJ-BR-GROUPING AND
  6950        PY-FIN-RESP   = PI-SAV-REMIT-TO    AND
  6951        PY-ACCOUNT    = PI-SAV-ACCT
  6952         NEXT SENTENCE
  6953     ELSE
  6954         GO TO 1200-PYAJ-BILLING-COMPLETE.
  6955
  6956     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  6957         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6958
  6959     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'C' OR 'S' OR 'T' OR 'U'
  6960                         OR 'Z'
  6961         NEXT SENTENCE
  6962     ELSE
  6963         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6964
  6965     IF PY-VOID-SW NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 135
* EL640.cbl
  6966         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6967
  6968     IF PI-AR-PROCESSING
  6969        IF PY-AR-DATE = LOW-VALUES
  6970           OR PI-TOT-REBILL
  6971           OR RETURNED-FROM = XCTL-PYAJ
  6972           NEXT SENTENCE
  6973        ELSE
  6974           GO TO 1110-PYAJ-BILLING-READ-LOOP
  6975     ELSE
  6976        IF (PY-BILLED-DATE = LOW-VALUES AND
  6977            PY-AR-DATE = LOW-VALUES)
  6978           OR PI-TOT-REBILL
  6979           OR RETURNED-FROM = XCTL-PYAJ
  6980           NEXT SENTENCE
  6981        ELSE
  6982           GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6983
  6984     MOVE 'Y'                    TO PI-DATA-BILLED-SW.
  6985
  6986     IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  6987         PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  6988         PY-ADD-TO-BALANCE
  6989         ADD PY-ENTRY-AMT  TO  PI-REMITTED
  6990     ELSE
  6991         IF (PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT)
  6992            AND PY-BILLING-CHECK
  6993             ADD PY-ENTRY-AMT TO PI-DISBURSED
  6994         ELSE
  6995             ADD PY-ENTRY-AMT TO PI-ADJUSTMENTS.
  6996
  6997     IF RETURNED-FROM = SPACES
  6998         IF PI-UPDATE-FILES
  6999           OR (PI-PREVIEW AND APRODSWI = 'Y')
  7000             MOVE 'BP'           TO BILLING-DETAIL-TYPE
  7001             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  7002
  7003     IF RETURNED-FROM = SPACES
  7004       AND (PI-BILL OR PI-REBILLING)
  7005         PERFORM 4800-PYAJ-END-BROWSE
  7006         PERFORM 4700-PYAJ-REWRITE THRU 4790-EXIT
  7007         ADD +1 TO ERPYAJ-FILE-SEQ-NO
  7008         GO TO 1105-PYAJ-BILLING-STARTBR-LOOP.
  7009
  7010     GO TO 1110-PYAJ-BILLING-READ-LOOP.
  7011
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 136
* EL640.cbl
  7013 1200-PYAJ-BILLING-COMPLETE.
  7014     IF PI-DATA-BILLED
  7015       IF RETURNED-FROM = SPACES
  7016         IF PI-UPDATE-FILES
  7017            OR (PI-PREVIEW AND APRODSWI = 'Y')
  7018               MOVE 'TS'           TO BILLING-DETAIL-TYPE
  7019               PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  7020
  7021     PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT.
  7022
  7023     GO TO 8100-SEND-INITIAL-MAP.
  7024
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 137
* EL640.cbl
  7026 1300-CHECK-OVERRIDE-PREM.
  7027     IF PB-CANCELLATION
  7028        IF PB-CI-CANCEL-FEE NOT NUMERIC
  7029           MOVE ZEROS  TO  PB-CI-CANCEL-FEE
  7030        END-IF
  7031     END-IF
  7032
  7033     MOVE ZEROS                  TO WS-I-LF-PREMIUM-AMT
  7034                                    WS-I-LF-BENEFIT-AMT
  7035     IF PB-OVERRIDE-LIFE  OR
  7036        PB-OVERRIDE-BOTH
  7037         GO TO 1310-LIFE-OVERRIDE.
  7038
  7039     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7040         IF PB-ISSUE
  7041           IF NOT PB-INVALID-LIFE
  7042            COMPUTE  WS-I-LF-PREMIUM-AMT =
  7043                    (PB-I-LF-PREMIUM-AMT +
  7044                     PB-I-LF-ALT-PREMIUM-AMT) * -1
  7045            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7046                    (PB-I-LF-BENEFIT-AMT +
  7047                     PB-I-LF-ALT-BENEFIT-AMT) * -1
  7048           END-IF
  7049         ELSE
  7050             MULTIPLY PB-C-LF-CANCEL-AMT BY -1
  7051                            GIVING WS-C-LF-CANCEL-AMT
  7052             MULTIPLY PB-CI-LF-BENEFIT-AMT BY -1
  7053                            GIVING WS-CI-LIFE-BENEFIT
  7054         END-IF
  7055     ELSE
  7056         IF PB-ISSUE
  7057           IF NOT PB-INVALID-LIFE
  7058            ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
  7059                GIVING WS-I-LF-PREMIUM-AMT
  7060            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7061                     PB-I-LF-BENEFIT-AMT +
  7062                     PB-I-LF-ALT-BENEFIT-AMT
  7063           END-IF
  7064         ELSE
  7065            MOVE PB-C-LF-CANCEL-AMT   TO WS-C-LF-CANCEL-AMT
  7066            MOVE PB-CI-LF-BENEFIT-AMT TO WS-CI-LIFE-BENEFIT
  7067         END-IF
  7068     END-IF
  7069
  7070     GO TO 1320-CHECK-AH
  7071
  7072     .
  7073 1310-LIFE-OVERRIDE.
  7074     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7075         IF PB-ISSUE
  7076           IF NOT PB-INVALID-LIFE
  7077            COMPUTE WS-I-LF-PREMIUM-AMT =
  7078                   (PB-I-LF-PREM-CALC +
  7079                      PB-I-LF-ALT-PREM-CALC) * -1
  7080            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7081                     (PB-I-LF-BENEFIT-AMT +
  7082                      PB-I-LF-ALT-BENEFIT-AMT) * -1
  7083           END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 138
* EL640.cbl
  7084         ELSE
  7085             MULTIPLY PB-C-LF-REF-CALC BY -1
  7086                            GIVING WS-C-LF-CANCEL-AMT
  7087             MULTIPLY PB-CI-LF-BENEFIT-AMT BY -1
  7088                            GIVING WS-CI-LIFE-BENEFIT
  7089         END-IF
  7090     ELSE
  7091         IF PB-ISSUE
  7092           IF NOT PB-INVALID-LIFE
  7093            ADD PB-I-LF-PREM-CALC   PB-I-LF-ALT-PREM-CALC
  7094                GIVING WS-I-LF-PREMIUM-AMT
  7095            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7096                     PB-I-LF-BENEFIT-AMT +
  7097                     PB-I-LF-ALT-BENEFIT-AMT
  7098           END-IF
  7099         ELSE
  7100            MOVE PB-C-LF-REF-CALC     TO WS-C-LF-CANCEL-AMT
  7101            MOVE PB-CI-LF-BENEFIT-AMT TO WS-CI-LIFE-BENEFIT
  7102         END-IF
  7103     END-IF
  7104     .
  7105 1320-CHECK-AH.
  7106     IF PB-OVERRIDE-AH  OR
  7107        PB-OVERRIDE-BOTH
  7108         GO TO 1330-AH-OVERRIDE.
  7109
  7110     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7111         IF PB-ISSUE
  7112            MULTIPLY PB-I-AH-BENEFIT-AMT BY -1
  7113                            GIVING WS-I-AH-BENEFIT-AMT
  7114            MULTIPLY PB-I-AH-PREMIUM-AMT BY -1
  7115                            GIVING WS-I-AH-PREMIUM-AMT
  7116         ELSE
  7117             MULTIPLY PB-C-AH-CANCEL-AMT BY -1
  7118                            GIVING WS-C-AH-CANCEL-AMT
  7119     ELSE
  7120         IF PB-ISSUE
  7121            MOVE PB-I-AH-BENEFIT-AMT TO WS-I-AH-BENEFIT-AMT
  7122            MOVE PB-I-AH-PREMIUM-AMT TO WS-I-AH-PREMIUM-AMT
  7123         ELSE
  7124            MOVE PB-C-AH-CANCEL-AMT TO WS-C-AH-CANCEL-AMT
  7125            IF  PB-CI-CANCEL-FEE > ZEROS
  7126                MOVE PB-CI-CANCEL-FEE     TO WS-C-CANCEL-FEE
  7127                MULTIPLY WS-C-CANCEL-FEE BY -1
  7128                                          GIVING WORK-CANCEL-FEE
  7129                ADD WORK-CANCEL-FEE       TO TOT-REPT-CANCEL-FEE.
  7130
  7131     GO TO 1399-EXIT.
  7132
  7133 1330-AH-OVERRIDE.
  7134     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7135         IF PB-ISSUE
  7136            MULTIPLY PB-I-AH-BENEFIT-AMT BY -1
  7137                            GIVING WS-I-AH-BENEFIT-AMT
  7138            MULTIPLY PB-I-AH-PREM-CALC BY -1
  7139                            GIVING WS-I-AH-PREMIUM-AMT
  7140         ELSE
  7141             MULTIPLY PB-C-AH-REF-CALC BY -1
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 139
* EL640.cbl
  7142                            GIVING WS-C-AH-CANCEL-AMT
  7143     ELSE
  7144         IF PB-ISSUE
  7145            MOVE PB-I-AH-BENEFIT-AMT TO WS-I-AH-BENEFIT-AMT
  7146            MOVE PB-I-AH-PREM-CALC   TO WS-I-AH-PREMIUM-AMT
  7147         ELSE
  7148            MOVE PB-C-AH-REF-CALC    TO WS-C-AH-CANCEL-AMT
  7149            IF PB-CI-CANCEL-FEE > ZEROS
  7150                MOVE PB-CI-CANCEL-FEE     TO WS-C-CANCEL-FEE
  7151                MULTIPLY WS-C-CANCEL-FEE BY -1
  7152                                          GIVING WORK-CANCEL-FEE
  7153                ADD WORK-CANCEL-FEE       TO TOT-REPT-CANCEL-FEE.
  7154
  7155 1399-EXIT.
  7156     EXIT.
  7157
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 140
* EL640.cbl
  7159 2000-VOID-BILLING.
  7160
  7161*                *******************************************
  7162*                *  PROCESS VOID BILLING.  THIS SECTION    *
  7163*                *  WILL RESET THE FILES TO THE STATUS     *
  7164*                *  THEY WERE IN PRIOR TO THE LAST BILLING *
  7165*                *******************************************
  7166
  7167     MOVE SPACES                 TO WS-EXP-DATE
  7168                                    WS-REMIT-TO.
  7169     SET DTNDX  RTNDX            TO 1.
  7170     MOVE SPACES                 TO ELCNTL-KEY.
  7171     MOVE '1'                    TO ELCNTL-REC-TYPE.
  7172
  7173     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
  7174
  7175     IF EMI-ERROR NOT = ZEROS
  7176         GO TO 8200-SEND-DATAONLY.
  7177
  7178     MOVE CF-CURRENT-MONTH-END   TO DC-BIN-DATE-1.
  7179     MOVE SPACE                  TO DC-OPTION-CODE.
  7180     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7181     MOVE DC-GREG-DATE-1-EDIT    TO PI-MONTH-END-DATE.
  7182
  7183     PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT.
  7184
  7185     IF PNDB-EOF
  7186         GO TO 2100-VOID-PNDB-COMPLETE.
  7187
  7188 2010-VOID-PNDB-LOOP.
  7189     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  7190
  7191     IF PNDB-EOF
  7192         GO TO 2100-VOID-PNDB-COMPLETE.
  7193
  7194     IF PB-COMPANY-CD-A1 = PI-COMPANY-CD  AND
  7195        PB-CARRIER       = PI-SAV-CARR    AND
  7196        PB-GROUPING      = PI-SAV-GROUP   AND
  7197        PB-STATE         = PI-SAV-STATE   AND
  7198        PB-ACCOUNT       = PI-SAV-ACCT
  7199         NEXT SENTENCE
  7200     ELSE
  7201         GO TO 2100-VOID-PNDB-COMPLETE.
  7202
  7203     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  7204         GO TO 2010-VOID-PNDB-LOOP.
  7205
  7206     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7207         MOVE PB-CONTROL-PRIMARY TO ERPNDB-PRIME-KEY
  7208
  7209* EXEC CICS ENDBR
  7210*             DATASET (ERPNDB-ALT-FILE-ID)
  7211*        END-EXEC
  7212     MOVE 0
  7213       TO DFHEIV11
  7214*    MOVE '&2                    $   #00007108' TO DFHEIV0
  7215     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7216     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 141
* EL640.cbl
  7217     MOVE X'2020233030303037313038' TO DFHEIV0(25:11)
  7218     CALL 'kxdfhei1' USING DFHEIV0,
  7219           ERPNDB-ALT-FILE-ID,
  7220           DFHEIV11,
  7221           DFHEIV99
  7222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7223
  7224* EXEC CICS DELETE
  7225*            DATASET (ERPNDB-FILE-ID)
  7226*            RIDFLD  (ERPNDB-PRIME-KEY)
  7227*        END-EXEC
  7228*    MOVE '&(  R                 &   #00007111' TO DFHEIV0
  7229     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7230     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7231     MOVE X'2020233030303037313131' TO DFHEIV0(25:11)
  7232     CALL 'kxdfhei1' USING DFHEIV0,
  7233           ERPNDB-FILE-ID,
  7234           ERPNDB-PRIME-KEY,
  7235           DFHEIV99,
  7236           DFHEIV99,
  7237           DFHEIV99
  7238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7239         PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT
  7240         IF PNDB-EOF
  7241            GO TO 2100-VOID-PNDB-COMPLETE
  7242         ELSE
  7243            GO TO 2010-VOID-PNDB-LOOP.
  7244
  7245     IF PB-BILLED-DT = LOW-VALUES  AND
  7246        PB-CHG-COUNT = ZEROS
  7247         GO TO 2010-VOID-PNDB-LOOP.
  7248
  7249     IF PB-BATCH-TRAILER
  7250         GO TO 2115-CONT.
  7251
  7252     IF PB-CERT-EFF-DT > ERACCT-A-EXP-DATE
  7253         MOVE PB-CERT-EFF-DT     TO PI-SAV-EXP-DT
  7254         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  7255         IF AM-AGT (AM-REMIT-TO) NOT = WORK-REMIT-TO
  7256             MOVE AM-AGT (AM-REMIT-TO) TO WORK-REMIT-TO
  7257                                          WS-SAV-REMIT-TO (RTNDX)
  7258             IF RTNDX < 10
  7259                 SET RTNDX UP BY 1.
  7260
  7261 2115-CONT.
  7262     IF NOT PB-BATCH-TRAILER
  7263         PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  7264         PERFORM 1300-CHECK-OVERRIDE-PREM       THRU 1399-EXIT
  7265         PERFORM 1030-COMPUTE-COMMISSION-TOTALS THRU 1039-EXIT.
  7266
  7267     PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT.
  7268
  7269     MOVE 'Y'                    TO DATA-VOIDED-SW.
  7270     GO TO 2010-VOID-PNDB-LOOP.
  7271
  7272 2100-VOID-PNDB-COMPLETE.
  7273     SET RTNDX                   TO 1.
  7274
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 142
* EL640.cbl
  7275     IF NOT DATA-VOIDED
  7276         SET DTNDX TO RTNDX
  7277         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  7278         MOVE AM-AGT (AM-REMIT-TO) TO WS-SAV-REMIT-TO (RTNDX).
  7279
  7280 2105-PYAJ-LOOP.
  7281     IF RTNDX > 10
  7282       OR WS-SAV-REMIT-TO (RTNDX) = SPACES
  7283         GO TO 2105-VOID-CONTINUE.
  7284
  7285     MOVE WS-SAV-REMIT-TO (RTNDX) TO PI-SAV-REMIT-TO.
  7286     PERFORM 2200-VOID-PYAJ THRU 2290-EXIT.
  7287
  7288     SET RTNDX UP BY 1.
  7289     GO TO 2105-PYAJ-LOOP.
  7290
  7291 2105-VOID-CONTINUE.
  7292     IF DATA-VOIDED
  7293         NEXT SENTENCE
  7294     ELSE
  7295         MOVE -1                 TO APFNTERL
  7296         MOVE ER-2401            TO EMI-ERROR
  7297         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7298         GO TO 8100-SEND-INITIAL-MAP.
  7299
  7300     SET DTNDX                   TO 1.
  7301
  7302 2105-VOID-MASTERS-LOOP.
  7303     IF WS-SAV-EXP-DT (DTNDX) = SPACES
  7304       OR DTNDX > 10
  7305         GO TO 2105-VOID-COMPLETE.
  7306
  7307     MOVE WS-SAV-EXP-DT (DTNDX) TO PI-SAV-EXP-DT.
  7308
  7309     PERFORM 4400-ERACCT-REWRITE THRU 4490-EXIT.
  7310
  7311     IF PI-SAV-REMIT-TO NOT = ERCOMP-FIN-RESP
  7312         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  7313         PERFORM 3930-BILL-READ        THRU 3930-EXIT
  7314         IF NOT NO-BILL-RECS
  7315             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT.
  7316
  7317     SET DTNDX UP BY 1.
  7318
  7319     GO TO 2105-VOID-MASTERS-LOOP.
  7320
  7321 2105-VOID-COMPLETE.
  7322     MOVE 0000                   TO EMI-ERROR.
  7323     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7324     SET PINDX ANDX TO 1.
  7325
  7326 2110-FORMAT-LOOP.
  7327     IF PI-BATCH (PINDX) NOT = SPACES
  7328         MOVE PI-BATCH  (PINDX)  TO BATCH  (ANDX)
  7329         MOVE PI-NOBILL (PINDX)  TO NOBILL (ANDX)
  7330         MOVE PI-BILLED (PINDX)  TO BILL   (ANDX)
  7331         SET ANDX PINDX UP BY 1
  7332         IF PINDX > 6
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 143
* EL640.cbl
  7333             NEXT SENTENCE
  7334         ELSE
  7335             GO TO 2110-FORMAT-LOOP.
  7336
  7337     MOVE -1                     TO AACCTL.
  7338
  7339     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 144
* EL640.cbl
  7341 2200-VOID-PYAJ.
  7342     PERFORM 4500-PYAJ-START-BROWSE THRU 4590-EXIT.
  7343
  7344     IF PYAJ-EOF
  7345         GO TO 2290-EXIT.
  7346
  7347 2210-VOID-PYAJ-LOOP.
  7348     PERFORM 4600-PYAJ-READ-NEXT THRU 4690-EXIT.
  7349
  7350     IF PYAJ-EOF
  7351         PERFORM 4800-PYAJ-END-BROWSE
  7352         GO TO 2290-EXIT.
  7353
  7354     IF PY-COMPANY-CD = PI-COMPANY-CD      AND
  7355        PY-CARRIER    = ERPYAJ-BR-CARRIER  AND
  7356        PY-GROUPING   = ERPYAJ-BR-GROUPING AND
  7357        PY-FIN-RESP   = PI-SAV-REMIT-TO    AND
  7358        PY-ACCOUNT    = PI-SAV-ACCT
  7359         NEXT SENTENCE
  7360     ELSE
  7361         PERFORM 4800-PYAJ-END-BROWSE
  7362         GO TO 2290-EXIT.
  7363
  7364     IF (PY-BILLED-DATE = LOW-VALUES AND
  7365            PY-AR-DATE = LOW-VALUES)
  7366       OR PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  7367         GO TO 2210-VOID-PYAJ-LOOP.
  7368
  7369     PERFORM 4800-PYAJ-END-BROWSE.
  7370
  7371     PERFORM 4700-PYAJ-REWRITE THRU 4790-EXIT.
  7372
  7373     MOVE 'Y'                    TO DATA-VOIDED-SW.
  7374     ADD +1 TO ERPYAJ-FILE-SEQ-NO.
  7375
  7376     GO TO 2200-VOID-PYAJ.
  7377
  7378 2290-EXIT.
  7379     EXIT.
  7380
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 145
* EL640.cbl
  7382
  7383 3000-WRITE-BILLING-DETAIL.
  7384
  7385*                *******************************************
  7386*                *  FORMATS THE BILLING DETAIL RECORDS.    *
  7387*                *  THESE RECORDS ARE CREATED IN THE       *
  7388*                *  SAME FORMAT THAT THEY WILL APPEAR      *
  7389*                *  WHEN PRINTED.                          *
  7390*                *******************************************
  7391
  7392     IF CARRIER-ADDRESS  OR
  7393        GEN-AGT-ADDRESS
  7394          PERFORM 3930-BILL-READ THRU 3930-EXIT
  7395         IF NO-BILL-RECS
  7396             GO TO 3200-FORMAT-HDR-ADDR-RECS
  7397         ELSE
  7398             IF BI-PREVIEW-ONLY
  7399               OR BI-INITIAL-PRINT-DATE NOT = LOW-VALUES
  7400               OR PI-TOT-REBILL
  7401                 PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  7402                 GO TO 3200-FORMAT-HDR-ADDR-RECS
  7403             ELSE
  7404                 MOVE ER-2403    TO EMI-ERROR
  7405                 MOVE -1         TO ABILTYPL
  7406                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7407                 GO TO 3990-EXIT.
  7408
  7409     IF TOTAL-STATEMENT
  7410         GO TO 3400-FORMAT-TOTAL-LINES.
  7411
  7412 3100-FORMAT-DETAIL-LINES.
  7413     IF PI-PREM (PINDX) NOT NUMERIC
  7414        MOVE ZEROS               TO PI-PREM (PINDX).
  7415     IF PI-COMM (PINDX) NOT NUMERIC
  7416        MOVE ZEROS               TO PI-COMM (PINDX).
  7417
  7418     IF WS-LINECTR > 23
  7419         MOVE ZEROS              TO WS-LINECTR
  7420         MOVE '3'                TO BI-RECORD-TYPE
  7421         MOVE TRIPLE-SPACE       TO BI-SKIP-CONTROL
  7422         MOVE '          CONTINUED ON NEXT PAGE'
  7423                                 TO BI-TEXT-LINE
  7424         PERFORM 3920-BILL-WRITE
  7425         PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7426
  7427     IF WS-LINECTR = ZEROS
  7428         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7429     ELSE
  7430         MOVE SINGLE-SPACE       TO BI-SKIP-CONTROL
  7431     END-IF.
  7432
  7433     MOVE '3'                    TO BI-RECORD-TYPE.
  7434
  7435     IF BILLING-DETAIL-TYPE = 'BP'
  7436        IF PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT
  7437             MOVE PY-ENTRY-COMMENT   TO BI-TEXT-LINE
  7438             MULTIPLY PY-ENTRY-AMT   BY -1
  7439                              GIVING BI-TOT-PREM
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 146
* EL640.cbl
  7440             MOVE '* ACCOUNTING ENTRY *'  TO BI-TOT-DESC
  7441             ADD +1 TO WS-LINECTR
  7442             PERFORM 3920-BILL-WRITE
  7443             GO TO 3990-EXIT.
  7444
  7445     IF BILLING-DETAIL-TYPE = 'BP'
  7446         MOVE PY-ENTRY-COMMENT   TO BI-TEXT-LINE
  7447         MOVE PY-ENTRY-AMT       TO BI-TOT-PREM
  7448         MOVE '* ACCOUNTING ENTRY *'  TO BI-TOT-DESC
  7449         ADD +1 TO WS-LINECTR
  7450         PERFORM 3920-BILL-WRITE
  7451         GO TO 3990-EXIT.
  7452
  7453     MOVE SPACES                 TO BI-TEXT-LINE.
  7454
  7455     IF PB-ISSUE
  7456        NEXT SENTENCE
  7457     ELSE
  7458        GO TO 3110-FORMAT-DETAIL-CANCEL.
  7459
  7460     MOVE PB-I-INSURED-FIRST-NAME    TO BI-INS-1ST-NAME.
  7461     MOVE PB-I-INSURED-MIDDLE-INIT   TO BI-INS-INIT.
  7462
  7463     IF PI-COMPANY-ID = 'DMD' AND
  7464        PB-ISSUE
  7465        MOVE PB-SV-STATE             TO BI-UNDRWRTR.
  7466
  7467     MOVE PB-I-INSURED-LAST-NAME     TO BI-INS-LAST-NAME.
  7468     MOVE PB-CERT-NO                 TO BI-CERT.
  7469     MOVE PB-I-LF-TERM               TO BI-ED-TERM  BI-TERM.
  7470     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
  7471     MOVE SPACE                      TO DC-OPTION-CODE.
  7472     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7473     MOVE DC-GREG-DATE-1-EDIT        TO BI-EFF-DT.
  7474
  7475     IF PI-COMPANY-ID = 'DMD' AND
  7476        PB-ISSUE  AND
  7477        NOT PB-INVALID-LIFE
  7478          MOVE PB-I-LF-BENEFIT-CD    TO WS-BENE-CD
  7479          MOVE WS-BENEFIT            TO PB-I-LF-ABBR.
  7480
  7481     IF NOT PB-INVALID-LIFE
  7482        MOVE PB-I-LF-ABBR            TO BI-TYPE
  7483        MOVE WS-I-LF-PREMIUM-AMT     TO BI-PREM
  7484                                        BI-PREMIUM-AMT
  7485        ADD WS-I-LF-PREMIUM-AMT      TO TOT-REPT-LF-PREM
  7486        MULTIPLY PB-I-LIFE-COMMISSION BY 100 GIVING BI-ED-RATE
  7487        MOVE PB-I-LIFE-COMMISSION    TO BI-RATE
  7488        MOVE PI-LF-ISS-COMP          TO BI-COMM
  7489        ADD  PI-LF-ISS-COMP          TO TOT-REPT-LF-COMP
  7490        MOVE WS-I-LF-BENEFIT-AMT     TO BI-FACE-AMT
  7491                                        BI-BENEFIT-AMT
  7492        ADD WS-I-LF-BENEFIT-AMT      TO TOT-LF-REPT-FACE-AMT
  7493        ADD WS-I-LF-PREMIUM-AMT      TO  PI-PREM (PINDX)
  7494        ADD PI-LF-ISS-COMP           TO  PI-COMM (PINDX)
  7495        PERFORM 3920-BILL-WRITE
  7496        ADD +1 TO WS-LINECTR
  7497        MOVE SINGLE-SPACE            TO BI-SKIP-CONTROL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 147
* EL640.cbl
  7498        MOVE SPACES                  TO BI-TEXT-LINE.
  7499
  7500     IF PI-COMPANY-ID = 'DMD' AND
  7501        PB-ISSUE  AND
  7502        NOT PB-INVALID-AH
  7503          MOVE PB-I-AH-BENEFIT-CD    TO WS-BENE-CD
  7504          MOVE WS-BENEFIT            TO PB-I-AH-ABBR.
  7505
  7506     IF NOT PB-INVALID-AH
  7507        MOVE PB-I-AH-ABBR            TO BI-TYPE
  7508        MOVE WS-I-AH-PREMIUM-AMT     TO BI-PREM
  7509                                        BI-PREMIUM-AMT
  7510        ADD WS-I-AH-PREMIUM-AMT      TO TOT-REPT-AH-PREM
  7511        MULTIPLY PB-I-AH-COMMISSION BY 100 GIVING BI-ED-RATE
  7512        MOVE PB-I-AH-COMMISSION      TO BI-RATE
  7513        MOVE PI-AH-ISS-COMP          TO BI-COMM
  7514        ADD PI-AH-ISS-COMP           TO TOT-REPT-AH-COMP
  7515        MOVE WS-I-AH-BENEFIT-AMT     TO BI-FACE-AMT
  7516        ADD WS-I-AH-BENEFIT-AMT      TO TOT-AH-REPT-FACE-AMT
  7517        ADD WS-I-AH-PREMIUM-AMT      TO  PI-PREM (PINDX)
  7518        ADD PI-AH-ISS-COMP           TO  PI-COMM (PINDX)
  7519        PERFORM 3920-BILL-WRITE
  7520        MOVE SINGLE-SPACE            TO BI-SKIP-CONTROL
  7521        ADD +1                       TO WS-LINECTR.
  7522
  7523     GO TO 3990-EXIT.
  7524
  7525 3110-FORMAT-DETAIL-CANCEL.
  7526     MOVE PB-CI-LAST-NAME            TO BI-INS-LAST-NAME.
  7527     MOVE PB-CI-INITIALS             TO BI-INS-INITS.
  7528
  7529     IF PI-COMPANY-ID = 'DMD' AND
  7530        PB-CANCELLATION
  7531        MOVE PB-SV-STATE             TO BI-UNDRWRTR.
  7532
  7533     MOVE PB-CERT-NO                 TO BI-CERT.
  7534     MOVE PB-CI-LF-TERM              TO BI-ED-TERM
  7535                                        BI-TERM.
  7536     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
  7537     MOVE SPACE                      TO DC-OPTION-CODE.
  7538     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7539     MOVE DC-GREG-DATE-1-EDIT        TO BI-EFF-DT.
  7540
  7541     IF PI-COMPANY-ID = 'DMD' AND
  7542        PB-CANCELLATION AND
  7543        PB-CI-LF-ABBR > SPACES
  7544          MOVE PB-CI-LF-BENEFIT-CD   TO WS-BENE-CD
  7545          MOVE WS-BENEFIT            TO PB-CI-LF-ABBR.
  7546
  7547     IF PB-CI-LF-ABBR > SPACES
  7548         MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
  7549         MOVE SPACE                  TO DC-OPTION-CODE
  7550         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7551         MOVE DC-GREG-DATE-1-EDIT    TO BI-CAN-DT
  7552         MOVE PB-CI-LF-ABBR          TO BI-TYPE
  7553         MOVE WS-C-LF-CANCEL-AMT     TO BI-PREMIUM-AMT
  7554         MULTIPLY WS-C-LF-CANCEL-AMT BY -1 GIVING WORK-AMT
  7555         MOVE WORK-AMT               TO BI-PREM
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 148
* EL640.cbl
  7556         ADD WS-C-LF-CANCEL-AMT      TO TOT-REPT-LF-REF
  7557         ADD WORK-AMT                TO TOT-REPT-LF-PREM
  7558                                        PI-PREM (PINDX)
  7559         MULTIPLY PB-CI-LIFE-COMMISSION
  7560                                     BY 100 GIVING BI-ED-RATE
  7561         MOVE PB-CI-LIFE-COMMISSION  TO BI-RATE
  7562         IF WS-CHARGEBACK-LF-SW = 'N'
  7563             MOVE  ZEROS                 TO PI-LF-CAN-COMP
  7564             MOVE PI-LF-CAN-COMP         TO BI-COMM
  7565             ADD PI-LF-CAN-COMP          TO TOT-REPT-LF-COMP
  7566                                            PI-COMM (PINDX)
  7567             COMPUTE TOT-REPT-LF-COMP-R =
  7568               TOT-REPT-LF-COMP-R + (PI-LF-CAN-COMP * -1)
  7569             MOVE WS-CI-LIFE-BENEFIT     TO BI-BENEFIT-AMT
  7570             ADD +1                      TO WS-LINECTR
  7571             PERFORM 3920-BILL-WRITE
  7572             MOVE SPACES                 TO BI-TEXT-LINE
  7573         ELSE
  7574             MOVE PI-LF-CAN-COMP         TO BI-COMM
  7575             ADD PI-LF-CAN-COMP          TO TOT-REPT-LF-COMP
  7576                                            PI-COMM (PINDX)
  7577             COMPUTE TOT-REPT-LF-COMP-R =
  7578               TOT-REPT-LF-COMP-R + (PI-LF-CAN-COMP * -1)
  7579             MOVE  ZEROS                 TO PI-LF-CAN-COMP
  7580             MOVE WS-CI-LIFE-BENEFIT     TO BI-BENEFIT-AMT
  7581             ADD +1                      TO WS-LINECTR
  7582             PERFORM 3920-BILL-WRITE
  7583             MOVE SPACES                 TO BI-TEXT-LINE.
  7584
  7585     IF PI-COMPANY-ID = 'DMD' AND
  7586        PB-CANCELLATION AND
  7587        PB-CI-AH-ABBR > SPACES
  7588          MOVE PB-CI-AH-BENEFIT-CD   TO WS-BENE-CD
  7589          MOVE WS-BENEFIT            TO PB-CI-AH-ABBR.
  7590
  7591     IF PB-CI-AH-ABBR > SPACES
  7592         MOVE PB-C-AH-CANCEL-DT      TO DC-BIN-DATE-1
  7593         MOVE SPACE                  TO DC-OPTION-CODE
  7594         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7595         MOVE DC-GREG-DATE-1-EDIT    TO BI-CAN-DT
  7596         MOVE PB-CI-AH-ABBR          TO BI-TYPE
  7597         MOVE WS-C-AH-CANCEL-AMT     TO BI-PREMIUM-AMT
  7598         MULTIPLY WS-C-AH-CANCEL-AMT BY -1 GIVING WORK-AMT
  7599         MOVE WORK-AMT               TO BI-PREM
  7600         ADD WS-C-AH-CANCEL-AMT      TO TOT-REPT-AH-REF
  7601         ADD WORK-AMT                TO TOT-REPT-AH-PREM
  7602                                        PI-PREM (PINDX)
  7603         MULTIPLY PB-CI-AH-COMMISSION BY 100 GIVING BI-ED-RATE
  7604         MOVE PB-CI-AH-COMMISSION    TO BI-RATE
  7605         IF WS-CHARGEBACK-AH-SW = 'N'
  7606             MOVE  ZEROS                 TO PI-AH-CAN-COMP
  7607             MOVE PI-AH-CAN-COMP         TO BI-COMM
  7608             ADD PI-AH-CAN-COMP          TO TOT-REPT-AH-COMP
  7609                                            PI-COMM (PINDX)
  7610             COMPUTE TOT-REPT-AH-COMP-R =
  7611               TOT-REPT-AH-COMP-R + (PI-AH-CAN-COMP * -1)
  7612             ADD +1                      TO WS-LINECTR
  7613             PERFORM 3920-BILL-WRITE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 149
* EL640.cbl
  7614         ELSE
  7615             MOVE PI-AH-CAN-COMP         TO BI-COMM
  7616             ADD PI-AH-CAN-COMP          TO TOT-REPT-AH-COMP
  7617                                            PI-COMM (PINDX)
  7618             COMPUTE TOT-REPT-AH-COMP-R =
  7619               TOT-REPT-AH-COMP-R + (PI-AH-CAN-COMP * -1)
  7620             MOVE  ZEROS                 TO PI-AH-CAN-COMP
  7621             ADD +1                      TO WS-LINECTR
  7622             PERFORM 3920-BILL-WRITE.
  7623
  7624     IF PB-CI-CANCEL-FEE NOT NUMERIC
  7625         MOVE ZEROS                      TO PB-CI-CANCEL-FEE.
  7626
  7627     IF PB-CI-CANCEL-FEE > ZEROS
  7628         MOVE SPACES                 TO BI-INS-LAST-NAME
  7629                                        BI-INS-INITS
  7630                                        BI-EFF-DT
  7631                                        BI-CAN-DT
  7632                                        BI-TYPE
  7633         MOVE 'CANCEL FEE'           TO BI-CERT
  7634         MOVE WORK-CANCEL-FEE        TO BI-PREM
  7635                                        BI-COMM
  7636         MOVE ZEROS                  TO BI-PREMIUM-AMT
  7637                                        BI-RATE
  7638                                        BI-ED-RATE
  7639                                        BI-ED-TERM
  7640                                        BI-TERM
  7641         ADD +1                      TO WS-LINECTR
  7642         PERFORM 3920-BILL-WRITE.
  7643
  7644     GO TO 3990-EXIT.
  7645
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 150
* EL640.cbl
  7647
  7648 3200-FORMAT-HDR-ADDR-RECS.
  7649     PERFORM 3910-BILL-GETMAIN.
  7650
  7651     MOVE ZEROS                  TO WS-LINE-SEQ-NO.
  7652     SET A-INDX  R-INDX          TO 1.
  7653     PERFORM 3210-FORMAT-ADDR-RECS  THRU 3210-EXIT 6 TIMES.
  7654     MOVE ZEROS                  TO WS-LINE-SEQ-NO.
  7655     PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7656     GO TO 3990-EXIT.
  7657
  7658 3210-FORMAT-ADDR-RECS.
  7659     MOVE '2'                     TO BI-RECORD-TYPE.
  7660     MOVE WS-ACCT-LINES (A-INDX)  TO BI-ACCT-ADDRESS-LINE.
  7661     MOVE WS-REMIT-LINES (R-INDX) TO BI-REMIT-ADDRESS-LINE.
  7662     PERFORM 3920-BILL-WRITE.
  7663     SET A-INDX  R-INDX         UP BY 1.
  7664
  7665 3210-EXIT.
  7666     EXIT.
  7667
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 151
* EL640.cbl
  7669 3300-FORMAT-HEADINGS.
  7670     MOVE WS-PGECTR              TO BI-HD-PG.
  7671     ADD +1                      TO WS-PGECTR.
  7672     MOVE '3'                    TO BI-RECORD-TYPE.
  7673     MOVE TOP-OF-PAGE            TO BI-SKIP-CONTROL.
  7674
  7675     IF NOT PI-PREVIEW
  7676         MOVE BI-HD1             TO BI-TEXT-LINE
  7677     ELSE
  7678         MOVE BI-PREVIEW-HD      TO BI-TEXT-LINE
  7679         PERFORM 3920-BILL-WRITE
  7680         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7681         MOVE BI-HD1             TO BI-TEXT-LINE.
  7682
  7683     PERFORM 3920-BILL-WRITE.
  7684     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7685     MOVE BI-HD2                 TO BI-TEXT-LINE.
  7686     PERFORM 3920-BILL-WRITE.
  7687     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7688     MOVE BI-HD3                 TO BI-TEXT-LINE.
  7689     PERFORM 3920-BILL-WRITE.
  7690     SET A-INDX  R-INDX          TO 1.
  7691     PERFORM 3390-FORMAT-ADDR-TEXT-LINES THRU 3390-EXIT 5 TIMES.
  7692     MOVE '3'                    TO BI-RECORD-TYPE.
  7693     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7694     MOVE BI-HD4                 TO BI-TEXT-LINE.
  7695     PERFORM 3920-BILL-WRITE.
  7696     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7697     MOVE BI-HD5                 TO BI-TEXT-LINE.
  7698     PERFORM 3920-BILL-WRITE.
  7699
  7700 3380-EXIT.
  7701     EXIT.
  7702
  7703 3390-FORMAT-ADDR-TEXT-LINES.
  7704     MOVE '3'                    TO BI-RECORD-TYPE.
  7705     MOVE SPACES                 TO BI-TEXT-LINE.
  7706
  7707     IF A-INDX = 1
  7708         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7709         MOVE 'ACCOUNT NO. - '   TO BI-ADDR-LIT
  7710         MOVE WS-CARR-COMP       TO BI-CO
  7711         MOVE '-'                TO BI-DASH
  7712         MOVE PI-SAV-ACCT        TO BI-ACCT
  7713         MOVE 'REMIT TO - '      TO BI-REMIT-LIT
  7714     ELSE
  7715         MOVE SINGLE-SPACE       TO BI-SKIP-CONTROL.
  7716
  7717     MOVE WS-ACCT-LINES (A-INDX)  TO BI-ACCT-ADDR.
  7718     MOVE WS-REMIT-LINES (R-INDX) TO BI-REMIT-ADDR.
  7719     PERFORM 3920-BILL-WRITE.
  7720     SET A-INDX  R-INDX  UP BY 1.
  7721
  7722 3390-EXIT.
  7723     EXIT.
  7724
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 152
* EL640.cbl
  7726 3400-FORMAT-TOTAL-LINES.
  7727     COMPUTE PI-END-BAL = PI-BAL-FRWD +
  7728                          PI-PREMIUM +
  7729                          TOT-REPT-CANCEL-FEE -
  7730                          PI-REMITTED -
  7731                          PI-TOT-ISS-COMP +
  7732                          PI-TOT-CAN-COMP +
  7733                          PI-ADJUSTMENTS +
  7734                          PI-DISBURSED.
  7735
  7736     MOVE SPACES                 TO BI-TEXT-LINE.
  7737
  7738     MOVE '1'                    TO BI-RECORD-TYPE.
  7739     MOVE PI-PROCESSOR-ID        TO BI-PROCESSOR-CD.
  7740
  7741     IF PI-PREV-BILL OR PI-PREV-REBILL
  7742         MOVE 'P'                TO BI-STATEMENT-TYPE.
  7743
  7744     MOVE +1                     TO BI-NO-OF-COPIES.
  7745     MOVE WS-CURRENT-DATE        TO BI-CREATION-DT.
  7746     MOVE LOW-VALUES             TO BI-INITIAL-PRINT-DATE.
  7747     MOVE PI-BAL-FRWD            TO BI-BAL-FRWD.
  7748     MOVE PI-PREMIUM             TO BI-PREMIUM.
  7749     MOVE PI-REMITTED            TO BI-REMITTED.
  7750     MOVE PI-TOT-ISS-COMP        TO BI-TOT-ISS-COMP.
  7751     MOVE PI-TOT-CAN-COMP        TO BI-TOT-CAN-COMP.
  7752     MOVE PI-ADJUSTMENTS         TO BI-ADJUSTMNTS.
  7753     MOVE PI-DISBURSED           TO BI-DISBURSED.
  7754     MOVE PI-END-BAL             TO BI-END-BAL.
  7755
  7756     IF PI-SAV-ACCT = PI-SAV-REMIT-TO
  7757         MOVE WS-ACCT-LINES (1)  TO BI-FIN-RESP-NAME
  7758     ELSE
  7759         MOVE WS-REMIT-LINES (1) TO BI-FIN-RESP-NAME.
  7760
  7761     PERFORM 3920-BILL-WRITE.
  7762
  7763     IF WS-LINECTR > 16
  7764         MOVE ZEROS              TO WS-LINECTR
  7765         MOVE '3'                TO BI-RECORD-TYPE
  7766         MOVE TRIPLE-SPACE       TO BI-SKIP-CONTROL
  7767         MOVE '          CONTINUED ON NEXT PAGE'
  7768                                 TO BI-TEXT-LINE
  7769         PERFORM 3920-BILL-WRITE
  7770         PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7771
  7772     IF PI-BAL-FRWD NOT = ZERO
  7773         MOVE SPACES             TO BI-TEXT-LINE
  7774         MOVE '3'                TO BI-RECORD-TYPE
  7775         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7776         MOVE 'BALANCE FORWARD'  TO BI-TOT-DESC
  7777         MOVE PI-BAL-FRWD        TO BI-TOT-PREM
  7778         PERFORM 3920-BILL-WRITE.
  7779
  7780     IF PI-PREMIUM NOT = ZERO
  7781         MOVE SPACES             TO BI-TEXT-LINE
  7782         MOVE '3'                TO BI-RECORD-TYPE
  7783         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 153
* EL640.cbl
  7784         MOVE 'THIS MONTHS PREMIUM'  TO BI-TOT-DESC
  7785         COMPUTE WORK-AMT  =  TOT-REPT-CANCEL-FEE + PI-PREMIUM
  7786         MOVE WORK-AMT           TO BI-TOT-PREM
  7787         PERFORM 3920-BILL-WRITE.
  7788
  7789     IF PI-TOT-ISS-COMP NOT = ZEROS  OR
  7790        PI-TOT-CAN-COMP NOT = ZEROS
  7791         MOVE SPACES             TO BI-TEXT-LINE
  7792         MOVE '3'                TO BI-RECORD-TYPE
  7793         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7794         MOVE 'LESS COMPENSATION' TO BI-TOT-DESC
  7795         SUBTRACT PI-TOT-CAN-COMP FROM PI-TOT-ISS-COMP
  7796                          GIVING BI-TOT-PREM
  7797         PERFORM 3920-BILL-WRITE.
  7798
  7799     IF PI-REMITTED  NOT = ZEROS  OR
  7800        PI-DISBURSED NOT = ZEROS
  7801         MOVE SPACES             TO BI-TEXT-LINE
  7802         MOVE '3'                TO BI-RECORD-TYPE
  7803         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7804         MOVE 'LESS PAYMENTS'    TO BI-TOT-DESC
  7805         IF PI-COMPANY-ID = 'UCL'
  7806             SUBTRACT PI-DISBURSED FROM PI-REMITTED
  7807                      GIVING BI-TOT-PREM
  7808             PERFORM 3920-BILL-WRITE
  7809           ELSE
  7810             MOVE PI-REMITTED        TO BI-TOT-PREM
  7811             PERFORM 3920-BILL-WRITE.
  7812
  7813     IF PI-ADJUSTMENTS NOT = ZERO
  7814         MOVE SPACES             TO BI-TEXT-LINE
  7815         MOVE '3'                TO BI-RECORD-TYPE
  7816         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7817         MOVE 'ADJUSTMENT'       TO BI-TOT-DESC
  7818         ADD PI-ADJUSTMENTS, PI-DISBURSED GIVING BI-TOT-PREM
  7819         PERFORM 3920-BILL-WRITE.
  7820
  7821     MOVE SPACES                 TO BI-TEXT-LINE.
  7822     MOVE '3'                    TO BI-RECORD-TYPE.
  7823     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7824     MOVE ALL '-'                TO BI-TOT-DASH.
  7825     PERFORM 3920-BILL-WRITE.
  7826
  7827     MOVE SPACES                 TO BI-TEXT-LINE.
  7828     MOVE '3'                    TO BI-RECORD-TYPE.
  7829     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7830
  7831     IF PI-END-BAL < +1.00 AND > -1.00
  7832         NEXT SENTENCE
  7833     ELSE
  7834         IF PI-END-BAL < +0
  7835             MOVE 'WE WILL REFUND' TO BI-TOT-DESC
  7836         ELSE
  7837             MOVE 'PLEASE REMIT' TO BI-TOT-DESC.
  7838
  7839     MOVE PI-END-BAL             TO BI-TOT-PREM.
  7840
  7841     PERFORM 3920-BILL-WRITE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 154
* EL640.cbl
  7842
  7843     IF CO-CARRY-BALANCE
  7844         IF PI-END-BAL > +1.00
  7845             MOVE SPACES         TO BI-TEXT-LINE
  7846             MOVE '3'            TO BI-RECORD-TYPE
  7847             MOVE DOUBLE-SPACE   TO BI-SKIP-CONTROL
  7848             MOVE 'PLEASE RETURN ONE COPY WITH REMITTANCE'
  7849                                 TO BI-TEXT-LINE
  7850             PERFORM 3920-BILL-WRITE.
  7851
  7852     IF PI-COMPANY-ID = 'DMD'
  7853        MOVE SPACES                 TO BI-TEXT-LINE
  7854        MOVE '3'                    TO BI-RECORD-TYPE
  7855        MOVE '0'                    TO BI-SKIP-CONTROL
  7856        MOVE BI-HD6                 TO BI-TEXT-LINE
  7857        PERFORM 3920-BILL-WRITE
  7858        MOVE SPACES                 TO BI-TEXT-LINE
  7859        MOVE ' '                    TO BI-SKIP-CONTROL
  7860        MOVE BI-HD7                 TO BI-TEXT-LINE
  7861        PERFORM 3920-BILL-WRITE
  7862
  7863        PERFORM 3600-FIND-BATCH-NUMBER THRU 3699-EXIT
  7864          VARYING PINDX FROM 1 BY 1
  7865            UNTIL PINDX > +6.
  7866
  7867     MOVE ZEROS                  TO PI-PREM     (PINDX)
  7868                                    PI-COMM     (PINDX)
  7869                                    PI-NON-PREM (PINDX)
  7870                                    PI-NON-COMM (PINDX).
  7871
  7872     GO TO 3990-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 155
* EL640.cbl
  7874
  7875 3500-TOTAL-OUT-DETAIL.
  7876     IF PI-DATA-BILLED AND
  7877        RETURNED-FROM = SPACES
  7878           NEXT SENTENCE
  7879       ELSE
  7880           GO TO 3599-EXIT.
  7881
  7882     IF PI-UPDATE-FILES  OR
  7883        (PI-PREVIEW AND APRODSWI = 'Y')
  7884           NEXT SENTENCE
  7885        ELSE
  7886           GO TO 3599-EXIT.
  7887
  7888     MOVE SPACES                 TO BI-TEXT-LINE.
  7889*    MOVE '3'                    TO BI-RECORD-TYPE.
  7890*    MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7891*    MOVE 'TOTAL'                TO BI-TOT-LIT.
  7892*    MOVE PI-LIFE-OVERRIDE-L6    TO BI-OVERRIDE-L6.
  7893*    MOVE TOT-REPT-LF-PREM       TO BI-TOT-PREM.
  7894*    MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT.
  7895*    MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  7896*    PERFORM 3920-BILL-WRITE.
  7897*
  7898*    MOVE SPACES                 TO BI-TEXT-LINE.
  7899*    MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7900*    MOVE 'TOTAL'                TO BI-TOT-LIT.
  7901*    MOVE PI-AH-OVERRIDE-L6      TO BI-OVERRIDE-L6.
  7902*    MOVE TOT-REPT-AH-PREM       TO BI-TOT-PREM
  7903*    MOVE TOT-REPT-AH-COMP       TO BI-COM-TOT.
  7904*    MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  7905*    PERFORM 3920-BILL-WRITE.
  7906
  7907     MOVE SPACES                 TO BI-TEXT-LINE.
  7908     MOVE '3'                    TO BI-RECORD-TYPE.
  7909     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7910     MOVE 'TOTAL PREM '          TO BI-TOT-DESC
  7911     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  7912     ADD TOT-REPT-LF-REF TOT-REPT-LF-PREM
  7913          GIVING BI-TOT-PREM
  7914     ADD TOT-REPT-LF-COMP TOT-REPT-LF-COMP-R
  7915          GIVING BI-COM-TOT
  7916*    MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT.
  7917*    MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  7918     PERFORM 3920-BILL-WRITE.
  7919
  7920     MOVE SPACES                 TO BI-TEXT-LINE.
  7921     MOVE '3'                    TO BI-RECORD-TYPE.
  7922     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7923     MOVE 'TOTAL REF  '          TO BI-TOT-DESC
  7924     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  7925     MOVE TOT-REPT-LF-REF        TO BI-TOT-PREM.
  7926     MOVE TOT-REPT-LF-COMP-R     TO BI-COM-TOT
  7927     PERFORM 3920-BILL-WRITE.
  7928
  7929     MOVE SPACES                 TO BI-TEXT-LINE.
  7930     MOVE '3'                    TO BI-RECORD-TYPE.
  7931     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 156
* EL640.cbl
  7932     MOVE 'TOTAL NET  '          TO BI-TOT-DESC
  7933     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  7934     MOVE TOT-REPT-LF-PREM       TO BI-TOT-PREM
  7935     MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT
  7936     MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  7937     PERFORM 3920-BILL-WRITE.
  7938
  7939     MOVE SPACES                 TO BI-TEXT-LINE.
  7940     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7941     MOVE 'TOTAL PREM '          TO BI-TOT-DESC
  7942     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  7943     ADD TOT-REPT-AH-REF TOT-REPT-AH-PREM
  7944          GIVING BI-TOT-PREM
  7945     ADD TOT-REPT-AH-COMP TOT-REPT-AH-COMP-R
  7946          GIVING BI-COM-TOT
  7947*    MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  7948     PERFORM 3920-BILL-WRITE.
  7949
  7950     MOVE SPACES                 TO BI-TEXT-LINE.
  7951     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7952     MOVE 'TOTAL REF  '          TO BI-TOT-DESC
  7953     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  7954     MOVE TOT-REPT-AH-REF        TO BI-TOT-PREM
  7955     MOVE TOT-REPT-AH-COMP-R     TO BI-COM-TOT.
  7956     PERFORM 3920-BILL-WRITE.
  7957
  7958     MOVE SPACES                 TO BI-TEXT-LINE.
  7959     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7960     MOVE 'TOTAL NET  '          TO BI-TOT-DESC
  7961     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  7962     MOVE TOT-REPT-AH-PREM       TO BI-TOT-PREM
  7963     MOVE TOT-REPT-AH-COMP       TO BI-COM-TOT.
  7964     MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  7965     PERFORM 3920-BILL-WRITE.
  7966
  7967     IF PB-CI-CANCEL-FEE NOT NUMERIC
  7968         MOVE ZEROS  TO  PB-CI-CANCEL-FEE.
  7969
  7970     IF PB-CI-CANCEL-FEE > ZEROS
  7971         MOVE SPACES                 TO BI-TEXT-LINE
  7972         MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL
  7973         MOVE 'TOTAL'                TO BI-TOT-LIT
  7974         MOVE 'CAN-FE'               TO BI-OVERRIDE-L6
  7975         MOVE TOT-REPT-CANCEL-FEE    TO BI-TOT-PREM
  7976                                        BI-COM-TOT
  7977         MOVE ZEROS                  TO BI-FACE-TOT
  7978         PERFORM 3920-BILL-WRITE.
  7979
  7980     MOVE SPACES                 TO BI-TEXT-LINE.
  7981     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7982     PERFORM 3920-BILL-WRITE.
  7983
  7984 3599-EXIT.
  7985     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 157
* EL640.cbl
  7987
  7988 3600-FIND-BATCH-NUMBER.
  7989     IF PI-PREM (PINDX) NOT NUMERIC
  7990        MOVE ZEROS               TO PI-PREM (PINDX).
  7991     IF PI-COMM (PINDX) NOT NUMERIC
  7992        MOVE ZEROS               TO PI-COMM (PINDX).
  7993     IF PI-NON-PREM (PINDX) NOT NUMERIC
  7994        MOVE ZEROS               TO PI-NON-PREM (PINDX).
  7995     IF PI-NON-COMM (PINDX) NOT NUMERIC
  7996        MOVE ZEROS               TO PI-NON-COMM (PINDX).
  7997
  7998     IF PI-PREM (PINDX)     = ZEROS   AND
  7999        PI-COMM (PINDX)     = ZEROS   AND
  8000        PI-NON-PREM (PINDX) = ZEROS   AND
  8001        PI-NON-COMM (PINDX) = ZEROS
  8002          GO TO 3699-EXIT.
  8003
  8004     MOVE SPACES                 TO BI-TEXT-LINE.
  8005     MOVE '3'                    TO BI-RECORD-TYPE.
  8006     MOVE ' '                    TO BI-SKIP-CONTROL.
  8007     MOVE 'BATCH NO. '           TO WS-BATCH-DESC.
  8008     MOVE PI-BATCH (PINDX)       TO WS-BATCH-NBR.
  8009     MOVE WS-DESC                TO BI-TOT-DESC5.
  8010     MOVE PI-PREM (PINDX)        TO BI-TOT-PREM5.
  8011     MOVE PI-COMM (PINDX)        TO BI-COM-TOT5.
  8012     MOVE PI-NON-PREM (PINDX)    TO BI-NON-PREM5.
  8013     MOVE PI-NON-COMM (PINDX)    TO BI-NON-COMM5.
  8014     PERFORM 3920-BILL-WRITE.
  8015
  8016 3699-EXIT.
  8017     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 158
* EL640.cbl
  8019
  8020 3910-BILL-GETMAIN.
  8021
  8022* EXEC CICS GETMAIN
  8023*        SET     (ADDRESS OF BILLING-STATEMENT)
  8024*        LENGTH  (210)
  8025*        INITIMG (GETMAIN-SPACE)
  8026*    END-EXEC.
  8027     MOVE 210
  8028       TO DFHEIV11
  8029*    MOVE ',"IL                  $   #00007897' TO DFHEIV0
  8030     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8031     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8032     MOVE X'2020233030303037383937' TO DFHEIV0(25:11)
  8033     CALL 'kxdfhei1' USING DFHEIV0,
  8034           DFHEIV20,
  8035           DFHEIV11,
  8036           GETMAIN-SPACE
  8037     SET ADDRESS OF BILLING-STATEMENT TO
  8038         DFHEIV20
  8039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8040
  8041
  8042 3920-BILL-WRITE.
  8043     MOVE PI-COMPANY-CD          TO BI-COMPANY-CD.
  8044     MOVE PI-CR-CARRIER          TO BI-CARRIER.
  8045     MOVE PI-CR-GROUPING         TO BI-GROUPING
  8046     MOVE PI-SAV-ACCT            TO BI-ACCOUNT.
  8047     MOVE PI-SAV-REMIT-TO        TO BI-FIN-RESP.
  8048
  8049     MOVE 'BI'                   TO BI-RECORD-ID.
  8050     ADD +1                      TO WS-LINE-SEQ-NO.
  8051
  8052     IF BI-RECORD-TYPE = '1'
  8053         MOVE ZEROS              TO BI-LINE-SEQ-NO
  8054     ELSE
  8055         MOVE WS-LINE-SEQ-NO     TO BI-LINE-SEQ-NO.
  8056
  8057
  8058* EXEC CICS WRITE
  8059*        DATASET (ERBILL-FILE-ID)
  8060*        FROM    (BILLING-STATEMENT)
  8061*        RIDFLD  (BI-CONTROL-PRIMARY)
  8062*    END-EXEC.
  8063     MOVE LENGTH OF
  8064      BILLING-STATEMENT
  8065       TO DFHEIV11
  8066*    MOVE '&$ L                  ''   #00007918' TO DFHEIV0
  8067     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8068     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8069     MOVE X'2020233030303037393138' TO DFHEIV0(25:11)
  8070     CALL 'kxdfhei1' USING DFHEIV0,
  8071           ERBILL-FILE-ID,
  8072           BILLING-STATEMENT,
  8073           DFHEIV11,
  8074           BI-CONTROL-PRIMARY,
  8075           DFHEIV99,
  8076           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 159
* EL640.cbl
  8077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8078
  8079
  8080 3930-BILL-READ.
  8081     MOVE PI-COMPANY-CD          TO ERBILL-CO-CD.
  8082     MOVE PI-CR-CARRIER          TO ERBILL-CARRIER.
  8083     MOVE PI-CR-GROUPING         TO ERBILL-GROUP.
  8084     MOVE PI-SAV-ACCT            TO ERBILL-ACCT.
  8085     MOVE PI-SAV-REMIT-TO        TO ERBILL-FIN-RESP.
  8086     MOVE '1'                    TO ERBILL-REC-TYPE.
  8087     MOVE ZEROS                  TO ERBILL-LINE-SEQ-NO.
  8088
  8089
  8090* EXEC CICS HANDLE CONDITION
  8091*        NOTFND  (3930-BILL-NOTFND)
  8092*        NOTOPEN (3930-BILL-NOTOPEN)
  8093*    END-EXEC.
  8094*    MOVE '"$IJ                  ! $ #00007933' TO DFHEIV0
  8095     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8096     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8097     MOVE X'2420233030303037393333' TO DFHEIV0(25:11)
  8098     CALL 'kxdfhei1' USING DFHEIV0
  8099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8100
  8101
  8102
  8103* EXEC CICS READ
  8104*        SET     (ADDRESS OF BILLING-STATEMENT)
  8105*        DATASET (ERBILL-FILE-ID)
  8106*        RIDFLD  (ERBILL-KEY)
  8107*        GTEQ
  8108*    END-EXEC.
  8109*    MOVE '&"S        G          (   #00007938' TO DFHEIV0
  8110     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8111     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8112     MOVE X'2020233030303037393338' TO DFHEIV0(25:11)
  8113     CALL 'kxdfhei1' USING DFHEIV0,
  8114           ERBILL-FILE-ID,
  8115           DFHEIV20,
  8116           DFHEIV99,
  8117           ERBILL-KEY,
  8118           DFHEIV99,
  8119           DFHEIV99,
  8120           DFHEIV99
  8121     SET ADDRESS OF BILLING-STATEMENT TO
  8122         DFHEIV20
  8123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8124
  8125
  8126     IF BI-COMPANY-CD = PI-COMPANY-CD  AND
  8127        BI-CARRIER    = ERBILL-CARRIER AND
  8128        BI-GROUPING   = ERBILL-GROUP   AND
  8129        BI-ACCOUNT    = ERBILL-ACCT    AND
  8130        BI-FIN-RESP   = ERBILL-FIN-RESP
  8131          MOVE SPACE              TO NO-BILL-REC-SW
  8132          GO TO 3930-EXIT
  8133      ELSE
  8134          GO TO 3930-BILL-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 160
* EL640.cbl
  8135
  8136 3930-BILL-NOTOPEN.
  8137     MOVE ER-2564                TO EMI-ERROR.
  8138     MOVE -1 TO APFNTERL.
  8139     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8140     GO TO 8200-SEND-DATAONLY.
  8141
  8142 3930-BILL-NOTFND.
  8143     MOVE 'Y'                    TO NO-BILL-REC-SW.
  8144
  8145 3930-EXIT.
  8146     EXIT.
  8147
  8148 3940-BILL-GENERIC-DELETE.
  8149
  8150* EXEC CICS HANDLE CONDITION
  8151*        NOTFND (3940-EXIT)
  8152*    END-EXEC.
  8153*    MOVE '"$I                   ! % #00007968' TO DFHEIV0
  8154     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8155     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8156     MOVE X'2520233030303037393638' TO DFHEIV0(25:11)
  8157     CALL 'kxdfhei1' USING DFHEIV0
  8158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8159
  8160
  8161     MOVE PI-COMPANY-CD          TO ERBILL-CO-CD.
  8162     MOVE PI-CR-CARRIER          TO ERBILL-CARRIER.
  8163     MOVE PI-CR-GROUPING         TO ERBILL-GROUP.
  8164     MOVE PI-SAV-ACCT            TO ERBILL-ACCT.
  8165
  8166     IF ST-ACCNT-CNTL OR ACCNT-CNTL
  8167        MOVE ZEROS               TO ERBILL-CARRIER
  8168                                    ERBILL-GROUP.
  8169
  8170     IF CARR-ST-ACCNT-CNTL OR CARR-ACCNT-CNTL
  8171        MOVE ZEROS               TO ERBILL-GROUP.
  8172
  8173
  8174* EXEC CICS DELETE
  8175*        DATASET   (ERBILL-FILE-ID)
  8176*        RIDFLD    (ERBILL-KEY)
  8177*        KEYLENGTH (18)
  8178*        GENERIC
  8179*    END-EXEC.
  8180     MOVE 18
  8181       TO DFHEIV11
  8182*    MOVE '&(  RKG               &   #00007984' TO DFHEIV0
  8183     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  8184     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8185     MOVE X'2020233030303037393834' TO DFHEIV0(25:11)
  8186     CALL 'kxdfhei1' USING DFHEIV0,
  8187           ERBILL-FILE-ID,
  8188           ERBILL-KEY,
  8189           DFHEIV11,
  8190           DFHEIV99,
  8191           DFHEIV99
  8192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 161
* EL640.cbl
  8193
  8194
  8195 3940-EXIT.
  8196     EXIT.
  8197
  8198 3990-EXIT.
  8199     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 162
* EL640.cbl
  8201******************************************************************
  8202*                                                                *
  8203*   ALL I/O FOR THE VARIOUS FILES OTHER THAN THE COMPENSATION    *
  8204*   MASTER IS DONE IN THE FOLLOWING SECTIONS BEGINNING WITH 4XXX *
  8205*   WERE THE XXX INDICATES NUMERIC VALUES.                       *
  8206*                                                                *
  8207******************************************************************
  8208 4000-PNDB-START-BROWSE.
  8209     MOVE PI-COMPANY-CD          TO ERPNDB-CO-CD-A1.
  8210     MOVE PI-SAV-CARR            TO ERPNDB-CARR
  8211     MOVE PI-SAV-GROUP           TO ERPNDB-GROUP.
  8212     MOVE PI-SAV-STATE           TO ERPNDB-STATE.
  8213     MOVE PI-SAV-ACCT            TO ERPNDB-ACCT.
  8214     MOVE LOW-VALUES             TO ERPNDB-CERT.
  8215
  8216
  8217* EXEC CICS HANDLE CONDITION
  8218*        NOTFND (4010-REC-NOT-FND)
  8219*    END-EXEC.
  8220*    MOVE '"$I                   ! & #00008012' TO DFHEIV0
  8221     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8222     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8223     MOVE X'2620233030303038303132' TO DFHEIV0(25:11)
  8224     CALL 'kxdfhei1' USING DFHEIV0
  8225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8226
  8227
  8228
  8229* EXEC CICS STARTBR
  8230*        DATASET(ERPNDB-ALT-FILE-ID)
  8231*        RIDFLD (ERPNDB-ALT-KEY)
  8232*        GTEQ
  8233*    END-EXEC.
  8234     MOVE 0
  8235       TO DFHEIV11
  8236*    MOVE '&,         G          &   #00008016' TO DFHEIV0
  8237     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8238     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8239     MOVE X'2020233030303038303136' TO DFHEIV0(25:11)
  8240     CALL 'kxdfhei1' USING DFHEIV0,
  8241           ERPNDB-ALT-FILE-ID,
  8242           ERPNDB-ALT-KEY,
  8243           DFHEIV99,
  8244           DFHEIV11,
  8245           DFHEIV99
  8246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8247
  8248
  8249     GO TO 4090-EXIT.
  8250
  8251 4010-REC-NOT-FND.
  8252     MOVE 'Y'                    TO PNDB-EOF-SW.
  8253
  8254 4090-EXIT.
  8255     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 163
* EL640.cbl
  8257 4100-PNDB-READ-NEXT.
  8258
  8259* EXEC CICS HANDLE CONDITION
  8260*        ENDFILE (4110-END-OF-FILE)
  8261*    END-EXEC.
  8262*    MOVE '"$''                   ! '' #00008031' TO DFHEIV0
  8263     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8264     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8265     MOVE X'2720233030303038303331' TO DFHEIV0(25:11)
  8266     CALL 'kxdfhei1' USING DFHEIV0
  8267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8268
  8269
  8270
  8271* EXEC CICS READNEXT
  8272*        SET     (ADDRESS OF PENDING-BUSINESS)
  8273*        DATASET (ERPNDB-ALT-FILE-ID)
  8274*        RIDFLD  (ERPNDB-ALT-KEY)
  8275*    END-EXEC.
  8276     MOVE 0
  8277       TO DFHEIV11
  8278*    MOVE '&.S                   )   #00008035' TO DFHEIV0
  8279     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8280     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8281     MOVE X'2020233030303038303335' TO DFHEIV0(25:11)
  8282     CALL 'kxdfhei1' USING DFHEIV0,
  8283           ERPNDB-ALT-FILE-ID,
  8284           DFHEIV20,
  8285           DFHEIV99,
  8286           ERPNDB-ALT-KEY,
  8287           DFHEIV99,
  8288           DFHEIV11,
  8289           DFHEIV99,
  8290           DFHEIV99
  8291     SET ADDRESS OF PENDING-BUSINESS TO
  8292         DFHEIV20
  8293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8294
  8295
  8296     GO TO 4190-EXIT.
  8297
  8298 4110-END-OF-FILE.
  8299     MOVE 'Y'                    TO PNDB-EOF-SW.
  8300
  8301 4190-EXIT.
  8302     EXIT.
  8303
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 164
* EL640.cbl
  8305 4200-PNDB-REWRITE.
  8306     MOVE PB-COMPANY-CD          TO ERPNDB-CO-CD.
  8307     MOVE PB-ENTRY-BATCH         TO ERPNDB-BATCH.
  8308     MOVE PB-BATCH-SEQ-NO        TO ERPNDB-SEQ-NO.
  8309     MOVE PB-BATCH-CHG-SEQ-NO    TO ERPNDB-CHG-SEQ-NO.
  8310
  8311
  8312* EXEC CICS ENDBR
  8313*        DATASET (ERPNDB-ALT-FILE-ID)
  8314*    END-EXEC.
  8315     MOVE 0
  8316       TO DFHEIV11
  8317*    MOVE '&2                    $   #00008056' TO DFHEIV0
  8318     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8319     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8320     MOVE X'2020233030303038303536' TO DFHEIV0(25:11)
  8321     CALL 'kxdfhei1' USING DFHEIV0,
  8322           ERPNDB-ALT-FILE-ID,
  8323           DFHEIV11,
  8324           DFHEIV99
  8325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8326
  8327
  8328
  8329* EXEC CICS HANDLE CONDITION
  8330*        NOTFND   (4270-PNDB-NOTFIND)
  8331*        NOTOPEN  (4280-PNDB-FILE-NOTOPEN)
  8332*    END-EXEC.
  8333*    MOVE '"$IJ                  ! ( #00008060' TO DFHEIV0
  8334     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8335     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8336     MOVE X'2820233030303038303630' TO DFHEIV0(25:11)
  8337     CALL 'kxdfhei1' USING DFHEIV0
  8338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8339
  8340
  8341
  8342* EXEC CICS READ
  8343*        SET     (ADDRESS OF PENDING-BUSINESS)
  8344*        DATASET (ERPNDB-FILE-ID)
  8345*        RIDFLD  (ERPNDB-PRIME-KEY)
  8346*        UPDATE
  8347*    END-EXEC.
  8348*    MOVE '&"S        EU         (   #00008065' TO DFHEIV0
  8349     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8350     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8351     MOVE X'2020233030303038303635' TO DFHEIV0(25:11)
  8352     CALL 'kxdfhei1' USING DFHEIV0,
  8353           ERPNDB-FILE-ID,
  8354           DFHEIV20,
  8355           DFHEIV99,
  8356           ERPNDB-PRIME-KEY,
  8357           DFHEIV99,
  8358           DFHEIV99,
  8359           DFHEIV99
  8360     SET ADDRESS OF PENDING-BUSINESS TO
  8361         DFHEIV20
  8362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 165
* EL640.cbl
  8363
  8364
  8365     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  8366         MOVE 'R'                TO PB-BILLING-STATUS.
  8367
  8368     IF PI-VOID-BILL
  8369         MOVE LOW-VALUES         TO PB-BILLED-DT
  8370         MOVE ZEROS              TO PB-CHG-COUNT
  8371     ELSE
  8372         MOVE WS-CURRENT-DATE    TO PB-BILLED-DT.
  8373
  8374     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
  8375     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  8376     MOVE WS-CURRENT-DATE        TO PB-LAST-MAINT-DT.
  8377
  8378
  8379* EXEC CICS REWRITE
  8380*        DATASET (ERPNDB-FILE-ID)
  8381*        FROM    (PENDING-BUSINESS)
  8382*    END-EXEC.
  8383     MOVE LENGTH OF
  8384      PENDING-BUSINESS
  8385       TO DFHEIV11
  8386*    MOVE '&& L                  %   #00008085' TO DFHEIV0
  8387     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8388     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8389     MOVE X'2020233030303038303835' TO DFHEIV0(25:11)
  8390     CALL 'kxdfhei1' USING DFHEIV0,
  8391           ERPNDB-FILE-ID,
  8392           PENDING-BUSINESS,
  8393           DFHEIV11,
  8394           DFHEIV99
  8395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8396
  8397
  8398
  8399* EXEC CICS STARTBR
  8400*        DATASET (ERPNDB-ALT-FILE-ID)
  8401*        RIDFLD  (ERPNDB-ALT-KEY)
  8402*        GTEQ
  8403*    END-EXEC.
  8404     MOVE 0
  8405       TO DFHEIV11
  8406*    MOVE '&,         G          &   #00008090' TO DFHEIV0
  8407     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8408     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8409     MOVE X'2020233030303038303930' TO DFHEIV0(25:11)
  8410     CALL 'kxdfhei1' USING DFHEIV0,
  8411           ERPNDB-ALT-FILE-ID,
  8412           ERPNDB-ALT-KEY,
  8413           DFHEIV99,
  8414           DFHEIV11,
  8415           DFHEIV99
  8416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8417
  8418
  8419     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  8420
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 166
* EL640.cbl
  8421     GO TO 4290-EXIT.
  8422
  8423 4270-PNDB-NOTFIND.
  8424     MOVE ER-2212                TO EMI-ERROR.
  8425     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8426     GO TO 4290-EXIT.
  8427
  8428 4280-PNDB-FILE-NOTOPEN.
  8429     MOVE -1                     TO ACARIERL.
  8430     MOVE ER-2210                TO EMI-ERROR.
  8431     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8432
  8433 4290-EXIT.
  8434     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 167
* EL640.cbl
  8436 4300-READ-ACCOUNT-MASTER.
  8437     MOVE PI-COMPANY-CD          TO ERACCT-A-CO-CD.
  8438     MOVE PI-SAV-CARR            TO ERACCT-A-CARRIER.
  8439     MOVE PI-SAV-GROUP           TO ERACCT-A-GROUPING.
  8440     MOVE PI-SAV-STATE           TO ERACCT-A-STATE.
  8441     MOVE PI-SAV-ACCT            TO ERACCT-A-ACCOUNT.
  8442     MOVE PI-SAV-EXP-DT          TO ERACCT-A-EXP-DATE.
  8443
  8444     MOVE SPACES                 TO WS-AM-ZIP.
  8445
  8446
  8447* EXEC CICS HANDLE CONDITION
  8448*        NOTFND   (4370-ACCOUNT-INVALID)
  8449*        NOTOPEN  (4380-ACCT-FILE-NOTOPEN)
  8450*    END-EXEC.
  8451*    MOVE '"$IJ                  ! ) #00008123' TO DFHEIV0
  8452     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8453     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8454     MOVE X'2920233030303038313233' TO DFHEIV0(25:11)
  8455     CALL 'kxdfhei1' USING DFHEIV0
  8456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8457
  8458
  8459
  8460* EXEC CICS READ
  8461*        DATASET   (ERACCT-ALT-FILE-ID)
  8462*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8463*        RIDFLD    (ERACCT-ALT-KEY)
  8464*        GTEQ
  8465*    END-EXEC.
  8466*    MOVE '&"S        G          (   #00008128' TO DFHEIV0
  8467     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8468     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8469     MOVE X'2020233030303038313238' TO DFHEIV0(25:11)
  8470     CALL 'kxdfhei1' USING DFHEIV0,
  8471           ERACCT-ALT-FILE-ID,
  8472           DFHEIV20,
  8473           DFHEIV99,
  8474           ERACCT-ALT-KEY,
  8475           DFHEIV99,
  8476           DFHEIV99,
  8477           DFHEIV99
  8478     SET ADDRESS OF ACCOUNT-MASTER TO
  8479         DFHEIV20
  8480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8481
  8482
  8483     IF AM-CANADIAN-POST-CODE
  8484         MOVE AM-CAN-POSTAL-1    TO WS-AM-CAN-POST-1
  8485         MOVE AM-CAN-POSTAL-2    TO WS-AM-CAN-POST-2
  8486     ELSE
  8487         MOVE AM-ZIP-PRIME       TO WS-AM-ZIP-PRIME
  8488         IF AM-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  8489             MOVE '-'            TO WS-AM-ZIP-DASH
  8490             MOVE AM-ZIP-PLUS4   TO WS-AM-ZIP-PLUS4.
  8491
  8492     IF AM-REMIT-TO NOT NUMERIC
  8493         MOVE +00 TO AM-REMIT-TO.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 168
* EL640.cbl
  8494
  8495     IF AM-REMIT-TO = ZEROS
  8496         MOVE ER-2385            TO EMI-ERROR
  8497         MOVE -1                 TO AACCTL
  8498         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8499
  8500     MOVE AM-CARRIER             TO PI-CARRIER.
  8501     MOVE AM-GROUPING            TO PI-GROUPING.
  8502     MOVE AM-STATE               TO PI-STATE.
  8503     MOVE AM-ACCOUNT             TO PI-ACCOUNT.
  8504
  8505     MOVE AM-AGT (AM-REMIT-TO)   TO PI-COMP-FIN-RESP.
  8506
  8507     IF PI-ZERO-CARRIER  OR
  8508        PI-ZERO-CAR-GROUP
  8509         MOVE ZEROS              TO PI-COMP-CARRIER
  8510     ELSE
  8511         MOVE AM-CARRIER         TO PI-COMP-CARRIER.
  8512
  8513     IF PI-ZERO-GROUPING  OR
  8514        PI-ZERO-CAR-GROUP
  8515         MOVE ZEROS              TO PI-COMP-GROUPING
  8516     ELSE
  8517         MOVE AM-GROUPING        TO PI-COMP-GROUPING.
  8518
  8519     IF CARR-GROUP-ST-ACCNT-CNTL
  8520         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8521         MOVE AM-GROUPING        TO PI-CR-GROUPING
  8522         MOVE AM-STATE           TO PI-CR-STATE.
  8523
  8524     IF ST-ACCNT-CNTL
  8525         MOVE ZEROS              TO PI-CR-CARRIER
  8526                                    PI-CR-GROUPING
  8527         MOVE AM-STATE           TO PI-CR-STATE.
  8528
  8529     IF CARR-ST-ACCNT-CNTL
  8530         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8531         MOVE ZEROS              TO PI-CR-GROUPING
  8532         MOVE AM-STATE           TO PI-CR-STATE.
  8533
  8534     IF ACCNT-CNTL
  8535         MOVE ZEROS              TO PI-CR-CARRIER
  8536                                    PI-CR-GROUPING
  8537                                    PI-CR-STATE.
  8538
  8539     IF CARR-ACCNT-CNTL
  8540         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8541         MOVE ZEROS              TO PI-CR-GROUPING
  8542                                    PI-CR-STATE.
  8543
  8544     MOVE AM-EXPIRATION-DT       TO ERACCT-A-EXP-DATE.
  8545
  8546     IF AM-AGT (AM-REMIT-TO) = PI-SAV-ACCT
  8547         MOVE 'Y'                TO ACCOUNT-FIN-RESP-SW
  8548     ELSE
  8549         MOVE 'N'                TO ACCOUNT-FIN-RESP-SW.
  8550
  8551     IF PI-VOID-BILL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 169
* EL640.cbl
  8552         MOVE AM-EXPIRATION-DT   TO WS-SAV-EXP-DT (DTNDX)
  8553         IF DTNDX < 10
  8554             SET DTNDX UP BY 1
  8555             GO TO 4390-EXIT
  8556         ELSE
  8557             GO TO 4390-EXIT.
  8558
  8559     IF PI-COMPANY-CD = AM-COMPANY-CD-A1 AND
  8560        PI-SAV-CARR   = AM-VG-CARRIER    AND
  8561        PI-SAV-GROUP  = AM-VG-GROUPING   AND
  8562        PI-SAV-STATE  = AM-VG-STATE      AND
  8563        PI-SAV-ACCT   = AM-VG-ACCOUNT
  8564          NEXT SENTENCE
  8565     ELSE
  8566          GO TO 4370-ACCOUNT-INVALID.
  8567
  8568     IF PI-GA-BILLING
  8569         NEXT SENTENCE
  8570     ELSE
  8571         GO TO 4390-EXIT.
  8572
  8573     IF AM-AGT (AM-REMIT-TO) = PI-SAV-ACCT
  8574         MOVE 'Y'                TO ACCOUNT-FIN-RESP-SW
  8575     ELSE
  8576         MOVE 'N'                TO ACCOUNT-FIN-RESP-SW.
  8577
  8578     GO TO 4390-EXIT.
  8579
  8580 4370-ACCOUNT-INVALID.
  8581     MOVE -1                     TO AACCTL.
  8582
  8583     MOVE SPACES                 TO PI-CARRIER
  8584                                    PI-GROUPING
  8585                                    PI-STATE
  8586                                    PI-ACCOUNT.
  8587
  8588     IF CARR-GROUP-ST-ACCNT-CNTL
  8589         MOVE AL-UABON           TO ACARIERA
  8590                                    AGROUPA
  8591                                    ASTATEA
  8592                                    AACCTA
  8593     ELSE
  8594         IF ST-ACCNT-CNTL
  8595             MOVE AL-UABON       TO ASTATEA
  8596                                    AACCTA
  8597         ELSE
  8598             IF CARR-ST-ACCNT-CNTL
  8599                 MOVE AL-UABON   TO ACARIERA
  8600                                    ASTATEA
  8601                                    AACCTA
  8602             ELSE
  8603                 IF ACCNT-CNTL
  8604                     MOVE AL-UABON
  8605                                 TO AACCTA
  8606                 ELSE
  8607                     MOVE AL-UABON
  8608                                 TO ACARIERA
  8609                                    AACCTA.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 170
* EL640.cbl
  8610
  8611     MOVE ER-2210                TO EMI-ERROR.
  8612     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8613     GO TO 4390-EXIT.
  8614
  8615 4380-ACCT-FILE-NOTOPEN.
  8616     MOVE -1                     TO ACARIERL.
  8617     MOVE ER-2215                TO EMI-ERROR.
  8618     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8619
  8620 4390-EXIT.
  8621     EXIT.
  8622
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 171
* EL640.cbl
  8624 4400-ERACCT-REWRITE.
  8625     IF NOT PI-VOID-BILL
  8626         MOVE LOW-VALUES         TO ERACCT-PRIME-KEY
  8627         MOVE AM-COMPANY-CD      TO ERACCT-P-CO-CD
  8628         MOVE AM-CARRIER         TO ERACCT-P-CARRIER
  8629         MOVE AM-GROUPING        TO ERACCT-P-GROUPING
  8630         MOVE AM-STATE           TO ERACCT-P-STATE
  8631         MOVE AM-ACCOUNT         TO ERACCT-P-ACCOUNT
  8632         MOVE AM-EXPIRATION-DT   TO ERACCT-P-EXP-DATE
  8633     ELSE
  8634         MOVE LOW-VALUES         TO ERACCT-PRIME-KEY
  8635         MOVE PI-COMPANY-CD      TO ERACCT-P-CO-CD
  8636         MOVE PI-CARRIER         TO ERACCT-P-CARRIER
  8637         MOVE PI-GROUPING        TO ERACCT-P-GROUPING
  8638         MOVE PI-STATE           TO ERACCT-P-STATE
  8639         MOVE PI-SAV-ACCT        TO ERACCT-P-ACCOUNT
  8640         MOVE PI-SAV-EXP-DT      TO ERACCT-P-EXP-DATE.
  8641
  8642
  8643* EXEC CICS HANDLE CONDITION
  8644*        NOTFND   (4470-ACCOUNT-INVALID)
  8645*        NOTOPEN  (4480-ACCT-FILE-NOTOPEN)
  8646*    END-EXEC.
  8647*    MOVE '"$IJ                  ! * #00008294' TO DFHEIV0
  8648     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8649     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8650     MOVE X'2A20233030303038323934' TO DFHEIV0(25:11)
  8651     CALL 'kxdfhei1' USING DFHEIV0
  8652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8653
  8654
  8655
  8656* EXEC CICS READ
  8657*        DATASET   (ERACCT-FILE-ID)
  8658*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8659*        RIDFLD    (ERACCT-PRIME-KEY)
  8660*        UPDATE
  8661*    END-EXEC.
  8662*    MOVE '&"S        EU         (   #00008299' TO DFHEIV0
  8663     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8664     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8665     MOVE X'2020233030303038323939' TO DFHEIV0(25:11)
  8666     CALL 'kxdfhei1' USING DFHEIV0,
  8667           ERACCT-FILE-ID,
  8668           DFHEIV20,
  8669           DFHEIV99,
  8670           ERACCT-PRIME-KEY,
  8671           DFHEIV99,
  8672           DFHEIV99,
  8673           DFHEIV99
  8674     SET ADDRESS OF ACCOUNT-MASTER TO
  8675         DFHEIV20
  8676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8677
  8678
  8679     IF PI-VOID-BILL
  8680         MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO.
  8681
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 172
* EL640.cbl
  8682     IF PI-VOID-BILL
  8683         MOVE SPACE              TO AM-BILLING-STATUS
  8684     ELSE
  8685         MOVE 'B'                TO AM-BILLING-STATUS.
  8686
  8687     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  8688     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  8689     MOVE WS-CURRENT-DATE        TO AM-LAST-MAINT-DT.
  8690
  8691
  8692* EXEC CICS REWRITE
  8693*        DATASET (ERACCT-FILE-ID)
  8694*        FROM    (ACCOUNT-MASTER)
  8695*    END-EXEC.
  8696     MOVE LENGTH OF
  8697      ACCOUNT-MASTER
  8698       TO DFHEIV11
  8699*    MOVE '&& L                  %   #00008318' TO DFHEIV0
  8700     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8701     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8702     MOVE X'2020233030303038333138' TO DFHEIV0(25:11)
  8703     CALL 'kxdfhei1' USING DFHEIV0,
  8704           ERACCT-FILE-ID,
  8705           ACCOUNT-MASTER,
  8706           DFHEIV11,
  8707           DFHEIV99
  8708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8709
  8710
  8711     GO TO 4490-EXIT.
  8712
  8713 4470-ACCOUNT-INVALID.
  8714     MOVE -1                     TO AACCTL.
  8715
  8716     MOVE SPACES                 TO PI-CARRIER
  8717                                    PI-GROUPING
  8718                                    PI-STATE
  8719                                    PI-ACCOUNT.
  8720
  8721     IF CARR-GROUP-ST-ACCNT-CNTL
  8722         MOVE AL-UABON           TO ACARIERA
  8723                                    AGROUPA
  8724                                    ASTATEA
  8725                                    AACCTA
  8726     ELSE
  8727         IF ST-ACCNT-CNTL
  8728             MOVE AL-UABON       TO ASTATEA
  8729                                    AACCTA
  8730         ELSE
  8731             IF CARR-ST-ACCNT-CNTL
  8732                 MOVE AL-UABON   TO ACARIERA
  8733                                    ASTATEA
  8734                                    AACCTA
  8735             ELSE
  8736                 IF ACCNT-CNTL
  8737                     MOVE AL-UABON
  8738                                 TO AACCTA
  8739                 ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 173
* EL640.cbl
  8740                     MOVE AL-UABON
  8741                                 TO ACARIERA
  8742                                    AACCTA.
  8743
  8744     MOVE ER-2210                TO EMI-ERROR.
  8745     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8746     GO TO 4490-EXIT.
  8747
  8748 4480-ACCT-FILE-NOTOPEN.
  8749     MOVE -1                     TO ACARIERL.
  8750     MOVE ER-2215                TO EMI-ERROR.
  8751     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8752
  8753 4490-EXIT.
  8754     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 174
* EL640.cbl
  8756
  8757 4500-PYAJ-START-BROWSE.
  8758     MOVE PI-COMPANY-CD          TO ERPYAJ-COMP-CD.
  8759
  8760     IF NOT PI-ZERO-CARRIER  AND
  8761        NOT PI-ZERO-CAR-GROUP
  8762         MOVE PI-COMP-CARRIER    TO ERPYAJ-CARRIER
  8763     ELSE
  8764         MOVE ZEROS              TO ERPYAJ-CARRIER.
  8765
  8766     IF NOT PI-ZERO-GROUPING  AND
  8767        NOT PI-ZERO-CAR-GROUP
  8768         MOVE PI-COMP-GROUPING   TO ERPYAJ-GROUPING
  8769     ELSE
  8770         MOVE ZEROS              TO ERPYAJ-GROUPING.
  8771
  8772     MOVE PI-SAV-REMIT-TO        TO ERPYAJ-FIN-RESP.
  8773     MOVE PI-SAV-ACCT            TO ERPYAJ-ACCOUNT.
  8774
  8775     IF PI-SAV-REMIT-TO = SPACES
  8776         MOVE PI-SAV-ACCT        TO PI-SAV-REMIT-TO
  8777                                    ERPYAJ-FIN-RESP.
  8778
  8779     MOVE LOW-VALUES             TO ERPYAJ-RECORD-TYPE.
  8780     MOVE ERPYAJ-KEY             TO ERPYAJ-BROWSE-COMP-KEY.
  8781
  8782
  8783* EXEC CICS HANDLE CONDITION
  8784*        NOTFND (4510-REC-NOT-FND)
  8785*    END-EXEC.
  8786*    MOVE '"$I                   ! + #00008394' TO DFHEIV0
  8787     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8788     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8789     MOVE X'2B20233030303038333934' TO DFHEIV0(25:11)
  8790     CALL 'kxdfhei1' USING DFHEIV0
  8791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8792
  8793
  8794
  8795* EXEC CICS STARTBR
  8796*        DATASET(ERPYAJ-FILE-ID)
  8797*        RIDFLD (ERPYAJ-KEY)
  8798*        GTEQ
  8799*    END-EXEC.
  8800     MOVE 0
  8801       TO DFHEIV11
  8802*    MOVE '&,         G          &   #00008398' TO DFHEIV0
  8803     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8804     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8805     MOVE X'2020233030303038333938' TO DFHEIV0(25:11)
  8806     CALL 'kxdfhei1' USING DFHEIV0,
  8807           ERPYAJ-FILE-ID,
  8808           ERPYAJ-KEY,
  8809           DFHEIV99,
  8810           DFHEIV11,
  8811           DFHEIV99
  8812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8813
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 175
* EL640.cbl
  8814
  8815     GO TO 4590-EXIT.
  8816
  8817 4510-REC-NOT-FND.
  8818     MOVE 'Y'                    TO PYAJ-EOF-SW.
  8819
  8820 4590-EXIT.
  8821     EXIT.
  8822
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 176
* EL640.cbl
  8824 4600-PYAJ-READ-NEXT.
  8825
  8826* EXEC CICS HANDLE CONDITION
  8827*        ENDFILE (4610-END-OF-FILE)
  8828*    END-EXEC.
  8829*    MOVE '"$''                   ! , #00008414' TO DFHEIV0
  8830     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8831     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8832     MOVE X'2C20233030303038343134' TO DFHEIV0(25:11)
  8833     CALL 'kxdfhei1' USING DFHEIV0
  8834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8835
  8836
  8837
  8838* EXEC CICS READNEXT
  8839*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  8840*        DATASET (ERPYAJ-FILE-ID)
  8841*        RIDFLD  (ERPYAJ-KEY)
  8842*    END-EXEC.
  8843     MOVE 0
  8844       TO DFHEIV11
  8845*    MOVE '&.S                   )   #00008418' TO DFHEIV0
  8846     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8847     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8848     MOVE X'2020233030303038343138' TO DFHEIV0(25:11)
  8849     CALL 'kxdfhei1' USING DFHEIV0,
  8850           ERPYAJ-FILE-ID,
  8851           DFHEIV20,
  8852           DFHEIV99,
  8853           ERPYAJ-KEY,
  8854           DFHEIV99,
  8855           DFHEIV11,
  8856           DFHEIV99,
  8857           DFHEIV99
  8858     SET ADDRESS OF PENDING-PAY-ADJ TO
  8859         DFHEIV20
  8860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8861
  8862
  8863     GO TO 4690-EXIT.
  8864
  8865 4610-END-OF-FILE.
  8866     MOVE 'Y'                    TO PYAJ-EOF-SW.
  8867
  8868 4690-EXIT.
  8869     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 177
* EL640.cbl
  8871 4700-PYAJ-REWRITE.
  8872
  8873* EXEC CICS READ
  8874*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  8875*        DATASET (ERPYAJ-FILE-ID)
  8876*        RIDFLD  (ERPYAJ-KEY)
  8877*        UPDATE
  8878*    END-EXEC.
  8879*    MOVE '&"S        EU         (   #00008433' TO DFHEIV0
  8880     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8881     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8882     MOVE X'2020233030303038343333' TO DFHEIV0(25:11)
  8883     CALL 'kxdfhei1' USING DFHEIV0,
  8884           ERPYAJ-FILE-ID,
  8885           DFHEIV20,
  8886           DFHEIV99,
  8887           ERPYAJ-KEY,
  8888           DFHEIV99,
  8889           DFHEIV99,
  8890           DFHEIV99
  8891     SET ADDRESS OF PENDING-PAY-ADJ TO
  8892         DFHEIV20
  8893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8894
  8895
  8896     IF PI-VOID-BILL
  8897         MOVE LOW-VALUES         TO PY-BILLED-DATE
  8898                                    PY-AR-DATE
  8899         IF ACCOUNT-NOT-FIN-RESP
  8900             IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  8901                 PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  8902                 PY-ADD-TO-BALANCE
  8903                 ADD PY-ENTRY-AMT  TO  PI-REMITTED
  8904             ELSE
  8905                 IF (PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT)
  8906                    AND PY-BILLING-CHECK
  8907                    ADD PY-ENTRY-AMT TO PI-DISBURSED
  8908                 ELSE
  8909                     ADD PY-ENTRY-AMT TO PI-ADJUSTMENTS
  8910         ELSE
  8911             NEXT SENTENCE
  8912     ELSE
  8913         MOVE WS-CURRENT-DATE    TO PY-BILLED-DATE.
  8914
  8915     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  8916     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  8917     MOVE WS-CURRENT-DATE        TO PY-LAST-MAINT-DT.
  8918
  8919
  8920* EXEC CICS REWRITE
  8921*        DATASET (ERPYAJ-FILE-ID)
  8922*        FROM    (PENDING-PAY-ADJ)
  8923*    END-EXEC.
  8924     MOVE LENGTH OF
  8925      PENDING-PAY-ADJ
  8926       TO DFHEIV11
  8927*    MOVE '&& L                  %   #00008463' TO DFHEIV0
  8928     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 178
* EL640.cbl
  8929     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8930     MOVE X'2020233030303038343633' TO DFHEIV0(25:11)
  8931     CALL 'kxdfhei1' USING DFHEIV0,
  8932           ERPYAJ-FILE-ID,
  8933           PENDING-PAY-ADJ,
  8934           DFHEIV11,
  8935           DFHEIV99
  8936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8937
  8938
  8939 4790-EXIT.
  8940     EXIT.
  8941
  8942 4800-PYAJ-END-BROWSE.
  8943
  8944* EXEC CICS ENDBR
  8945*        DATASET (ERPYAJ-FILE-ID)
  8946*    END-EXEC.
  8947     MOVE 0
  8948       TO DFHEIV11
  8949*    MOVE '&2                    $   #00008472' TO DFHEIV0
  8950     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8951     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8952     MOVE X'2020233030303038343732' TO DFHEIV0(25:11)
  8953     CALL 'kxdfhei1' USING DFHEIV0,
  8954           ERPYAJ-FILE-ID,
  8955           DFHEIV11,
  8956           DFHEIV99
  8957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8958
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 179
* EL640.cbl
  8960 5000-FORMAT-SCREEN.
  8961*                **********************************************
  8962*                *  FORMAT THE BILLING TOTALS SCREEN (EL640A) *
  8963*                **********************************************
  8964     MOVE LOW-VALUES             TO EL640AO.
  8965
  8966     IF PI-SAV-ACCT > SPACES
  8967        MOVE PI-SAV-ACCT         TO AACCTO
  8968        MOVE PI-SAV-CARR         TO ACARIERO
  8969        MOVE PI-SAV-GROUP        TO AGROUPO
  8970        MOVE PI-SAV-STATE        TO ASTATEO.
  8971
  8972     MOVE PI-BILL-TYPE           TO ABILTYPI.
  8973     MOVE PI-BILL-ERRS           TO ABILERRI.
  8974     MOVE AL-UANON               TO AACCTA
  8975                                    ACARIERA
  8976                                    AGROUPA
  8977                                    ASTATEA
  8978                                    ABILTYPA
  8979                                    ABILERRA.
  8980
  8981     IF ACCOUNT-NOT-FIN-RESP
  8982         MOVE ER-2539            TO EMI-ERROR
  8983         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8984
  8985     IF PI-BILLING-BATCHES (1) NOT = SPACES
  8986         MOVE PI-BILLING-BATCHES (1) TO ABTCH1I
  8987         MOVE AL-UANON               TO ABTCH1A.
  8988
  8989     IF PI-BILLING-BATCHES (2) NOT = SPACES
  8990         MOVE PI-BILLING-BATCHES (2) TO ABTCH2I
  8991         MOVE AL-UANON               TO ABTCH2A.
  8992
  8993     IF PI-BILLING-BATCHES (3) NOT = SPACES
  8994         MOVE PI-BILLING-BATCHES (3) TO ABTCH3I
  8995         MOVE AL-UANON               TO ABTCH3A.
  8996
  8997     SET ANDX  PINDX            TO 1.
  8998
  8999 5005-FORMAT-LOOP.
  9000     IF PI-BATCH (PINDX) NOT = SPACES
  9001         MOVE PI-BATCH  (PINDX)  TO BATCH  (ANDX)
  9002         MOVE PI-NOBILL (PINDX)  TO NOBILL (ANDX)
  9003         MOVE PI-BILLED (PINDX)  TO BILL   (ANDX)
  9004         MOVE PI-PREV   (PINDX)  TO PREV   (ANDX)
  9005         SET ANDX PINDX UP BY 1
  9006         IF ANDX > 6
  9007             NEXT SENTENCE
  9008         ELSE
  9009             GO TO 5005-FORMAT-LOOP.
  9010
  9011     IF MORE-THAN-6-BATCHES
  9012         MOVE ER-2472            TO EMI-ERROR
  9013         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9014         MOVE ZEROS              TO EMI-ERROR.
  9015
  9016     IF NOT PI-DATA-BILLED
  9017         IF RETURNED-FROM NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 180
* EL640.cbl
  9018             GO TO 5080-CONT
  9019         ELSE
  9020             MOVE ER-2409        TO EMI-ERROR
  9021             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9022             GO TO 5090-EXIT.
  9023
  9024     MOVE PI-BAL-FRWD            TO ABALFWDO.
  9025     MOVE PI-PREMIUM             TO APREMUMO.
  9026     MOVE PI-REMITTED            TO AREMITO.
  9027     MOVE PI-TOT-ISS-COMP        TO ACOMPISO.
  9028     MOVE PI-TOT-CAN-COMP        TO ACOMCANO.
  9029     COMPUTE PI-ADJUSTMENTS  =   PI-ADJUSTMENTS  +
  9030                                 TOT-REPT-CANCEL-FEE.
  9031     MOVE PI-ADJUSTMENTS         TO AADJUSTO.
  9032     MOVE PI-DISBURSED           TO ADISBURO.
  9033
  9034     COMPUTE PI-END-BAL = PI-BAL-FRWD +
  9035                          PI-PREMIUM -
  9036                          PI-REMITTED -
  9037                          PI-TOT-ISS-COMP +
  9038                          PI-TOT-CAN-COMP +
  9039                          PI-ADJUSTMENTS +
  9040                          PI-DISBURSED.
  9041
  9042     MOVE PI-END-BAL             TO ANETDUEO.
  9043
  9044     IF PI-END-BAL NEGATIVE
  9045         MOVE OWED-TO-AGENT      TO AENDHDGO
  9046     ELSE
  9047         IF PI-END-BAL > ZERO
  9048             MOVE AGENT-OWES     TO AENDHDGO
  9049         ELSE
  9050             MOVE 'BALANCE          =' TO AENDHDGO.
  9051
  9052 5080-CONT.
  9053     IF RETURNED-FROM NOT = SPACES
  9054         IF (RETURNED-FROM NOT = XCTL-6401)  AND
  9055             (PI-CR-FIN-RESP NOT = SPACES)
  9056               MOVE ER-2421        TO EMI-ERROR
  9057               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9058               MOVE ZEROS          TO EMI-ERROR
  9059         ELSE
  9060             NEXT SENTENCE
  9061     ELSE
  9062         IF PI-BILL OR PI-REBILLING
  9063             MOVE 'Y'            TO COMP-UPDATE-SW
  9064             PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  9065             MOVE 'Y'            TO ELCNTL-UPDATE-SW
  9066             MOVE SPACES         TO ELCNTL-KEY
  9067             MOVE '1'            TO ELCNTL-REC-TYPE
  9068             PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT
  9069             MOVE WS-CURRENT-DATE TO CF-ACCOUNT-MSTR-MAINT-DT
  9070                                     CF-COMPENSATION-MSTR-MAINT-DT
  9071             PERFORM 6200-REWRITE-CONTROL-FILE THRU 6290-EXIT.
  9072
  9073 5090-EXIT.
  9074     EXIT.
  9075
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 181
* EL640.cbl
  9077 6000-READ-COMP-MASTER.
  9078
  9079* EXEC CICS HANDLE CONDITION
  9080*        NOTFND   (6070-NO-COMP-MSTR)
  9081*        NOTOPEN  (6080-COMP-FILE-NOTOPEN)
  9082*    END-EXEC.
  9083*    MOVE '"$IJ                  ! - #00008594' TO DFHEIV0
  9084     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9085     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9086     MOVE X'2D20233030303038353934' TO DFHEIV0(25:11)
  9087     CALL 'kxdfhei1' USING DFHEIV0
  9088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9089
  9090
  9091     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  9092     MOVE PI-COMP-CARRIER        TO ERCOMP-CARRIER
  9093     MOVE PI-COMP-GROUPING       TO ERCOMP-GROUPING
  9094     MOVE PI-COMP-FIN-RESP       TO ERCOMP-FIN-RESP.
  9095
  9096     MOVE SPACES                 TO WS-CO-ZIP.
  9097
  9098     IF EIBAID = DFHPF5
  9099         MOVE LOW-VALUES         TO ERCOMP-ACCT
  9100         MOVE 'G'                TO ERCOMP-RECORD-TYPE
  9101     ELSE
  9102         MOVE PI-SAV-ACCT        TO ERCOMP-ACCT
  9103         MOVE 'A'                TO ERCOMP-RECORD-TYPE.
  9104
  9105 6001-READ.
  9106     IF UPDATE-COMP-TOTALS OR PI-VOID-BILL
  9107
  9108* EXEC CICS READ
  9109*            DATASET   (ERCOMP-FILE-ID)
  9110*            SET       (ADDRESS OF COMPENSATION-MASTER)
  9111*            RIDFLD    (ERCOMP-KEY)
  9112*            UPDATE
  9113*        END-EXEC
  9114*    MOVE '&"S        EU         (   #00008615' TO DFHEIV0
  9115     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9116     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9117     MOVE X'2020233030303038363135' TO DFHEIV0(25:11)
  9118     CALL 'kxdfhei1' USING DFHEIV0,
  9119           ERCOMP-FILE-ID,
  9120           DFHEIV20,
  9121           DFHEIV99,
  9122           ERCOMP-KEY,
  9123           DFHEIV99,
  9124           DFHEIV99,
  9125           DFHEIV99
  9126     SET ADDRESS OF COMPENSATION-MASTER TO
  9127         DFHEIV20
  9128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9129     ELSE
  9130
  9131* EXEC CICS READ
  9132*            DATASET   (ERCOMP-FILE-ID)
  9133*            SET       (ADDRESS OF COMPENSATION-MASTER)
  9134*            RIDFLD    (ERCOMP-KEY)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 182
* EL640.cbl
  9135*        END-EXEC.
  9136*    MOVE '&"S        E          (   #00008622' TO DFHEIV0
  9137     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9138     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9139     MOVE X'2020233030303038363232' TO DFHEIV0(25:11)
  9140     CALL 'kxdfhei1' USING DFHEIV0,
  9141           ERCOMP-FILE-ID,
  9142           DFHEIV20,
  9143           DFHEIV99,
  9144           ERCOMP-KEY,
  9145           DFHEIV99,
  9146           DFHEIV99,
  9147           DFHEIV99
  9148     SET ADDRESS OF COMPENSATION-MASTER TO
  9149         DFHEIV20
  9150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9151
  9152
  9153     IF CO-CANADIAN-POST-CODE
  9154         MOVE CO-CAN-POSTAL-1    TO WS-CO-CAN-POST-1
  9155         MOVE CO-CAN-POSTAL-2    TO WS-CO-CAN-POST-2
  9156     ELSE
  9157         MOVE CO-ZIP-PRIME       TO WS-CO-ZIP-PRIME
  9158         IF CO-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9159             MOVE '-'            TO WS-CO-ZIP-DASH
  9160             MOVE CO-ZIP-PLUS4   TO WS-CO-ZIP-PLUS4.
  9161
  9162 6002-CONTINUE.
  9163     IF EIBAID = DFHPF5
  9164         GO TO 6090-EXIT.
  9165
  9166     IF FIRST-TIME
  9167        MOVE CO-MAIL-NAME        TO WS-ACCT-LINES (1)
  9168        MOVE CO-ACCT-NAME        TO WS-ACCT-LINES (2)
  9169        MOVE CO-ADDR-1           TO WS-ACCT-LINES (3)
  9170        MOVE CO-ADDR-2           TO WS-ACCT-LINES (4)
  9171        MOVE CO-ADDR-3           TO WS-ACCT-LINES (5)
  9172        MOVE WS-CO-ZIP           TO WS-ACCT-LINES (6)
  9173        PERFORM 6400-FORMAT-ACCOUNT-ADDRS THRU 6490-EXIT.
  9174
  9175     IF PI-VOID-BILL
  9176         MOVE  PI-ME-MONTH       TO WS-ME-MONTH
  9177         MOVE  PI-ME-DAY         TO WS-ME-DAY
  9178         MOVE  PI-ME-YEAR        TO WS-ME-YEAR
  9179         IF ACCOUNT-FIN-RESP
  9180             MOVE CO-MONTHLY-TOTALS TO CO-CURRENT-MONTHLY-TOTALS
  9181             MOVE CO-AGING-TOTALS   TO CO-CURRENT-AGING-TOTALS
  9182             MOVE CO-YTD-TOTALS     TO CO-CURRENT-YTD-TOTALS
  9183             MOVE CO-LAST-STMT-DT   TO CO-CURRENT-LAST-STMT-DT
  9184             PERFORM 6060-ERCOMP-REWRITE
  9185             GO TO 6090-EXIT
  9186         ELSE
  9187             MOVE CO-YTD-TOTALS     TO CO-CURRENT-YTD-TOTALS
  9188             MOVE CO-LAST-STMT-DT   TO CO-CURRENT-LAST-STMT-DT
  9189             PERFORM 6060-ERCOMP-REWRITE
  9190             MOVE LOW-VALUES        TO ERCOMP-ACCT
  9191             MOVE 'G'               TO ERCOMP-RECORD-TYPE
  9192             PERFORM 6001-READ
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 183
* EL640.cbl
  9193             COMPUTE CO-CURRENT-CUR-CHG =
  9194                     CO-CURRENT-CUR-CHG - PI-PREMIUM
  9195             COMPUTE CO-CURRENT-CUR-COM =
  9196                     CO-CURRENT-CUR-COM - PI-TOT-ISS-COMP -
  9197                     PI-TOT-CAN-COMP
  9198             COMPUTE CO-CURRENT-CUR-PMT =
  9199                     CO-CURRENT-CUR-PMT - PI-REMITTED +
  9200                     PI-DISBURSED + PI-ADJUSTMENTS
  9201             COMPUTE CO-CURRENT-END-BAL =
  9202                     CO-CURRENT-BAL-FWD + CO-CURRENT-CUR-CHG -
  9203                     CO-CURRENT-CUR-COM - CO-CURRENT-CUR-PMT
  9204             MOVE CO-AGING-TOTALS   TO  CO-CURRENT-AGING-TOTALS
  9205             PERFORM 6050-AGING  THRU  6059-AGING-EXIT
  9206             IF CO-CURRENT-CUR-CHG = ZEROS AND
  9207                CO-CURRENT-CUR-COM = ZEROS AND
  9208                CO-CURRENT-CUR-PMT = ZEROS
  9209                 MOVE CO-LAST-STMT-DT TO CO-CURRENT-LAST-STMT-DT
  9210                 PERFORM 6060-ERCOMP-REWRITE
  9211                 GO TO 6090-EXIT
  9212             ELSE
  9213                 PERFORM 6060-ERCOMP-REWRITE
  9214                 GO TO 6090-EXIT.
  9215
  9216     IF UPDATE-COMP-TOTALS
  9217         MOVE  PI-ME-MONTH       TO WS-ME-MONTH
  9218         MOVE  PI-ME-DAY         TO WS-ME-DAY
  9219         MOVE  PI-ME-YEAR        TO WS-ME-YEAR
  9220         IF ACCOUNT-FIN-RESP
  9221             IF NOT PI-CHECK-PRODUCED
  9222                 IF CO-CURRENT-LAST-STMT-DT = WS-MONTH-END-DATE
  9223                     MOVE CO-CURRENT-END-BAL
  9224                                 TO CO-CURRENT-BAL-FWD
  9225                     COMPUTE CO-CURRENT-CUR-COM =
  9226                             CO-CURRENT-CUR-COM +
  9227                             PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9228                     COMPUTE CO-CURRENT-YTD-COM =
  9229                             CO-CURRENT-YTD-COM +
  9230                             PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9231                     COMPUTE CO-CURRENT-CUR-CHG =
  9232                             CO-CURRENT-CUR-CHG + PI-PREMIUM
  9233                     COMPUTE CO-CURRENT-CUR-PMT =
  9234                             CO-CURRENT-CUR-PMT +
  9235                             PI-REMITTED - PI-DISBURSED -
  9236                             PI-ADJUSTMENTS
  9237                     COMPUTE CO-CURRENT-END-BAL =
  9238                             CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9239                             PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9240                             PI-REMITTED + PI-DISBURSED +
  9241                             PI-ADJUSTMENTS
  9242                     PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9243                     PERFORM 6060-ERCOMP-REWRITE
  9244                     GO TO 6090-EXIT
  9245                ELSE
  9246                    MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9247                    MOVE PI-END-BAL         TO CO-CURRENT-END-BAL
  9248                    COMPUTE CO-CURRENT-CUR-COM =
  9249                            PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9250                    ADD CO-CURRENT-CUR-COM TO CO-CURRENT-YTD-COM
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 184
* EL640.cbl
  9251                    MOVE PI-PREMIUM        TO CO-CURRENT-CUR-CHG
  9252                    COMPUTE CO-CURRENT-CUR-PMT =
  9253                             PI-REMITTED - PI-DISBURSED -
  9254                             PI-ADJUSTMENTS
  9255                    PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9256                    MOVE WS-MONTH-END-DATE
  9257                                 TO CO-CURRENT-LAST-STMT-DT
  9258                    PERFORM 6060-ERCOMP-REWRITE
  9259                    GO TO 6090-EXIT
  9260             ELSE
  9261                 MOVE SPACE      TO PI-CHECK-SW
  9262                 MOVE PI-END-BAL TO CO-CURRENT-END-BAL
  9263                 COMPUTE CO-CURRENT-CUR-CHG = PI-PREMIUM +
  9264                         (PI-ADJUSTMENTS - PI-DISBURSED)
  9265                 PERFORM 6060-ERCOMP-REWRITE
  9266                 GO TO 6090-EXIT
  9267         ELSE
  9268             COMPUTE CO-CURRENT-YTD-COM =
  9269                     CO-CURRENT-YTD-COM + PI-TOT-ISS-COMP
  9270                                        - PI-TOT-CAN-COMP
  9271             PERFORM 6060-ERCOMP-REWRITE
  9272             MOVE LOW-VALUES    TO ERCOMP-ACCT
  9273             MOVE 'G'           TO ERCOMP-RECORD-TYPE
  9274             PERFORM 6001-READ
  9275             IF CO-CURRENT-LAST-STMT-DT = WS-MONTH-END-DATE
  9276                 MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9277                 COMPUTE CO-CURRENT-CUR-COM =
  9278                         CO-CURRENT-CUR-COM +
  9279                         PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9280                 COMPUTE CO-CURRENT-CUR-CHG =
  9281                         CO-CURRENT-CUR-CHG + PI-PREMIUM
  9282                 COMPUTE CO-CURRENT-CUR-PMT =
  9283                         CO-CURRENT-CUR-PMT +
  9284                         PI-REMITTED - PI-DISBURSED -
  9285                         PI-ADJUSTMENTS
  9286                 COMPUTE CO-CURRENT-END-BAL =
  9287                         CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9288                         PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9289                         PI-REMITTED + PI-DISBURSED +
  9290                         PI-ADJUSTMENTS
  9291                 PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9292                 PERFORM 6060-ERCOMP-REWRITE
  9293                 GO TO 6090-EXIT
  9294             ELSE
  9295                 MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9296                 COMPUTE CO-CURRENT-CUR-COM =
  9297                         PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9298                 MOVE PI-PREMIUM         TO CO-CURRENT-CUR-CHG
  9299                 COMPUTE CO-CURRENT-CUR-PMT =
  9300                         PI-REMITTED - PI-DISBURSED -
  9301                         PI-ADJUSTMENTS
  9302                 COMPUTE CO-CURRENT-END-BAL =
  9303                         CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9304                         PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9305                         PI-REMITTED + PI-DISBURSED +
  9306                         PI-ADJUSTMENTS
  9307                 PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9308                 MOVE WS-MONTH-END-DATE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 185
* EL640.cbl
  9309                                      TO CO-CURRENT-LAST-STMT-DT
  9310                 PERFORM 6060-ERCOMP-REWRITE
  9311                 GO TO 6090-EXIT.
  9312
  9313     IF PI-TOT-REBILL
  9314         MOVE CO-END-BAL           TO PI-BAL-FRWD
  9315     ELSE
  9316         MOVE CO-CURRENT-END-BAL   TO PI-BAL-FRWD.
  9317
  9318     IF PI-UPDATE-FILES
  9319       OR (PI-PREVIEW AND APRODSWI = 'Y')
  9320         NEXT SENTENCE
  9321     ELSE
  9322         GO TO 6090-EXIT.
  9323
  9324     IF AM-AGT (ACCOM-SUB) = PI-SAV-REMIT-TO
  9325         PERFORM 6040-READ-COMP-MASTER THRU 6049-EXIT
  9326         IF C-RECORD-FOUND
  9327             MOVE CO-ACCT-NAME   TO WS-REMIT-LINES (1)
  9328             MOVE CO-MAIL-NAME   TO WS-REMIT-LINES (2)
  9329             MOVE CO-ADDR-1      TO WS-REMIT-LINES (3)
  9330             MOVE CO-ADDR-2      TO WS-REMIT-LINES (4)
  9331             MOVE CO-ADDR-3      TO WS-REMIT-LINES (5)
  9332             MOVE WS-CO-ZIP      TO WS-REMIT-LINES (6)
  9333             PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9334             MOVE 'CA'           TO BILLING-DETAIL-TYPE
  9335             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT
  9336         ELSE
  9337             MOVE SPACES         TO ELCNTL-KEY
  9338             MOVE '6'            TO ELCNTL-REC-TYPE
  9339             MOVE PI-CARRIER     TO ELCNTL-CARRIER
  9340             PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT
  9341             MOVE CF-MAIL-TO-NAME   TO WS-REMIT-LINES (1)
  9342             MOVE CF-IN-CARE-OF     TO WS-REMIT-LINES (2)
  9343             MOVE CF-ADDRESS-LINE-1 TO WS-REMIT-LINES (3)
  9344             MOVE CF-ADDRESS-LINE-2 TO WS-REMIT-LINES (4)
  9345             MOVE CF-CITY-STATE     TO WS-REMIT-LINES (5)
  9346             MOVE WS-CF-ZIP         TO WS-REMIT-LINES (6)
  9347             PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9348             MOVE 'CA'              TO BILLING-DETAIL-TYPE
  9349             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT
  9350     ELSE
  9351         MOVE LOW-VALUES         TO ERCOMP-ACCT
  9352         MOVE 'G'                TO ERCOMP-RECORD-TYPE
  9353         PERFORM 6001-READ
  9354         MOVE CO-ACCT-NAME       TO WS-REMIT-LINES (1)
  9355         MOVE CO-MAIL-NAME       TO WS-REMIT-LINES (2)
  9356         MOVE CO-ADDR-1          TO WS-REMIT-LINES (3)
  9357         MOVE CO-ADDR-2          TO WS-REMIT-LINES (4)
  9358         MOVE CO-ADDR-3          TO WS-REMIT-LINES (5)
  9359         MOVE WS-CO-ZIP          TO WS-REMIT-LINES (6)
  9360         MOVE CO-CURRENT-END-BAL TO PI-BAL-FRWD-GA
  9361         PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9362         MOVE 'GA'               TO BILLING-DETAIL-TYPE
  9363         PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  9364
  9365     GO TO 6090-EXIT.
  9366
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 186
* EL640.cbl
  9367 6070-NO-COMP-MSTR.
  9368     MOVE ER-2230                TO EMI-ERROR.
  9369     MOVE -1                     TO AACCTL.
  9370     MOVE AL-UABON               TO ACARIERA
  9371                                    AGROUPA
  9372                                    AACCTA.
  9373     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9374     GO TO 6090-EXIT.
  9375
  9376 6080-COMP-FILE-NOTOPEN.
  9377     MOVE -1                     TO APFNTERL
  9378     MOVE ER-2233                TO EMI-ERROR.
  9379     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9380
  9381 6090-EXIT.
  9382     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 187
* EL640.cbl
  9384
  9385 6040-READ-COMP-MASTER.
  9386
  9387* EXEC CICS HANDLE CONDITION
  9388*        NOTFND   (6045-NO-COMP-MSTR)
  9389*        NOTOPEN  (6045-COMP-FILE-NOTOPEN)
  9390*    END-EXEC.
  9391*    MOVE '"$IJ                  ! . #00008861' TO DFHEIV0
  9392     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9393     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9394     MOVE X'2E20233030303038383631' TO DFHEIV0(25:11)
  9395     CALL 'kxdfhei1' USING DFHEIV0
  9396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9397
  9398
  9399     MOVE 'Y'                    TO C-RECORD-FOUND-SW.
  9400     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  9401     MOVE PI-COMP-CARRIER        TO ERCOMP-CARRIER
  9402     MOVE PI-COMP-GROUPING       TO ERCOMP-GROUPING
  9403     MOVE LOW-VALUES             TO ERCOMP-FIN-RESP
  9404                                    ERCOMP-ACCT.
  9405     MOVE 'C'                    TO ERCOMP-RECORD-TYPE.
  9406
  9407     MOVE SPACES                 TO WS-CO-ZIP.
  9408
  9409
  9410* EXEC CICS READ
  9411*        DATASET   (ERCOMP-FILE-ID)
  9412*        SET       (ADDRESS OF COMPENSATION-MASTER)
  9413*        RIDFLD    (ERCOMP-KEY)
  9414*    END-EXEC.
  9415*    MOVE '&"S        E          (   #00008876' TO DFHEIV0
  9416     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9417     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9418     MOVE X'2020233030303038383736' TO DFHEIV0(25:11)
  9419     CALL 'kxdfhei1' USING DFHEIV0,
  9420           ERCOMP-FILE-ID,
  9421           DFHEIV20,
  9422           DFHEIV99,
  9423           ERCOMP-KEY,
  9424           DFHEIV99,
  9425           DFHEIV99,
  9426           DFHEIV99
  9427     SET ADDRESS OF COMPENSATION-MASTER TO
  9428         DFHEIV20
  9429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9430
  9431
  9432     IF CO-CANADIAN-POST-CODE
  9433         MOVE CO-CAN-POSTAL-1    TO WS-CO-CAN-POST-1
  9434         MOVE CO-CAN-POSTAL-2    TO WS-CO-CAN-POST-2
  9435     ELSE
  9436         MOVE CO-ZIP-PRIME       TO WS-CO-ZIP-PRIME
  9437         IF CO-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9438             MOVE '-'            TO WS-CO-ZIP-DASH
  9439             MOVE CO-ZIP-PLUS4   TO WS-CO-ZIP-PLUS4.
  9440
  9441     GO TO 6049-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 188
* EL640.cbl
  9442
  9443 6045-COMP-FILE-NOTOPEN.
  9444     MOVE -1                     TO APFNTERL.
  9445     MOVE ER-2233                TO EMI-ERROR.
  9446     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9447
  9448     GO TO 6049-EXIT.
  9449
  9450 6045-NO-COMP-MSTR.
  9451     MOVE 'N'                    TO C-RECORD-FOUND-SW.
  9452
  9453 6049-EXIT.
  9454     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 189
* EL640.cbl
  9456
  9457 6050-AGING.
  9458
  9459     IF NOT PI-VOID-BILL
  9460        IF CO-CURRENT-LAST-STMT-DT NOT = WS-MONTH-END-DATE
  9461           if pi-company-id = 'AHL'
  9462              add co-current-ov90
  9463                                 to co-current-ov120
  9464              move co-current-ov60
  9465                                 to co-current-ov90
  9466              move co-current-ov30
  9467                                 to co-current-ov60
  9468              move co-current-cur
  9469                                 to co-current-ov30
  9470           else
  9471              ADD CO-CURRENT-OV60
  9472                                 TO CO-CURRENT-OV90
  9473              MOVE CO-CURRENT-OV30
  9474                                 TO CO-CURRENT-OV60
  9475              MOVE CO-CURRENT-CUR
  9476                                 TO CO-CURRENT-OV30
  9477           end-if
  9478        end-if
  9479     end-if
  9480
  9481     COMPUTE CO-CURRENT-CUR =
  9482             CO-CURRENT-CUR-CHG - CO-CURRENT-CUR-COM.
  9483
  9484     COMPUTE WS-PAY-ADJ =
  9485             PI-REMITTED - PI-DISBURSED - PI-ADJUSTMENTS.
  9486
  9487     IF WS-PAY-ADJ NEGATIVE
  9488         SUBTRACT WS-PAY-ADJ  FROM  CO-CURRENT-CUR
  9489     ELSE
  9490        if pi-company-id = 'AHL'
  9491           subtract ws-pay-adj from co-current-ov120
  9492        else
  9493           SUBTRACT WS-PAY-ADJ  FROM  CO-CURRENT-OV90
  9494        end-if
  9495     end-if
  9496
  9497     IF CO-CURRENT-CUR NEGATIVE
  9498        if pi-company-id = 'AHL'
  9499           add co-current-cur to co-current-ov120
  9500        else
  9501           ADD CO-CURRENT-CUR  TO  CO-CURRENT-OV90
  9502        end-if
  9503        MOVE ZEROS              TO  CO-CURRENT-CUR
  9504     end-if
  9505
  9506     if pi-company-id = 'AHL'
  9507        if co-current-ov120 negative
  9508           add co-current-ov120 to co-current-ov90
  9509           move zeros           to co-current-ov120
  9510        end-if
  9511     end-if
  9512     IF CO-CURRENT-OV90 NEGATIVE
  9513         ADD CO-CURRENT-OV90  TO  CO-CURRENT-OV60
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 190
* EL640.cbl
  9514         MOVE ZEROS              TO  CO-CURRENT-OV90.
  9515
  9516     IF CO-CURRENT-OV60 NEGATIVE
  9517         ADD CO-CURRENT-OV60  TO  CO-CURRENT-OV30
  9518         MOVE ZEROS              TO  CO-CURRENT-OV60.
  9519
  9520     IF CO-CURRENT-OV30 NEGATIVE
  9521         ADD CO-CURRENT-OV30  TO  CO-CURRENT-CUR
  9522         MOVE ZEROS              TO  CO-CURRENT-OV30.
  9523
  9524 6059-AGING-EXIT.
  9525     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 191
* EL640.cbl
  9527
  9528 6060-ERCOMP-REWRITE.
  9529
  9530
  9531* EXEC CICS REWRITE
  9532*        DATASET (ERCOMP-FILE-ID)
  9533*        FROM    (COMPENSATION-MASTER)
  9534*    END-EXEC.
  9535     MOVE LENGTH OF
  9536      COMPENSATION-MASTER
  9537       TO DFHEIV11
  9538*    MOVE '&& L                  %   #00008980' TO DFHEIV0
  9539     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9540     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9541     MOVE X'2020233030303038393830' TO DFHEIV0(25:11)
  9542     CALL 'kxdfhei1' USING DFHEIV0,
  9543           ERCOMP-FILE-ID,
  9544           COMPENSATION-MASTER,
  9545           DFHEIV11,
  9546           DFHEIV99
  9547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9548
  9549
  9550 6100-READ-CONTROL-FILE.
  9551     MOVE PI-COMPANY-ID          TO ELCNTL-COMPANY-ID.
  9552     MOVE +0                     TO ELCNTL-SEQ-NO.
  9553
  9554     MOVE SPACES                 TO WS-CF-ZIP.
  9555
  9556
  9557* EXEC CICS HANDLE CONDITION
  9558*        NOTFND   (6110-NO-RECORD)
  9559*    END-EXEC.
  9560*    MOVE '"$I                   ! / #00008991' TO DFHEIV0
  9561     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9562     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9563     MOVE X'2F20233030303038393931' TO DFHEIV0(25:11)
  9564     CALL 'kxdfhei1' USING DFHEIV0
  9565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9566
  9567
  9568     IF NOT ELCNTL-UPDATE
  9569
  9570* EXEC CICS READ
  9571*            DATASET (ELCNTL-FILE-ID)
  9572*            SET     (ADDRESS OF CONTROL-FILE)
  9573*            RIDFLD  (ELCNTL-KEY)
  9574*        END-EXEC
  9575*    MOVE '&"S        E          (   #00008996' TO DFHEIV0
  9576     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9577     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9578     MOVE X'2020233030303038393936' TO DFHEIV0(25:11)
  9579     CALL 'kxdfhei1' USING DFHEIV0,
  9580           ELCNTL-FILE-ID,
  9581           DFHEIV20,
  9582           DFHEIV99,
  9583           ELCNTL-KEY,
  9584           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 192
* EL640.cbl
  9585           DFHEIV99,
  9586           DFHEIV99
  9587     SET ADDRESS OF CONTROL-FILE TO
  9588         DFHEIV20
  9589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9590     ELSE
  9591         MOVE SPACE              TO ELCNTL-UPDATE-SW
  9592
  9593* EXEC CICS READ
  9594*            DATASET (ELCNTL-FILE-ID)
  9595*            SET     (ADDRESS OF CONTROL-FILE)
  9596*            RIDFLD  (ELCNTL-KEY)
  9597*            UPDATE
  9598*        END-EXEC.
  9599*    MOVE '&"S        EU         (   #00009003' TO DFHEIV0
  9600     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9601     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9602     MOVE X'2020233030303039303033' TO DFHEIV0(25:11)
  9603     CALL 'kxdfhei1' USING DFHEIV0,
  9604           ELCNTL-FILE-ID,
  9605           DFHEIV20,
  9606           DFHEIV99,
  9607           ELCNTL-KEY,
  9608           DFHEIV99,
  9609           DFHEIV99,
  9610           DFHEIV99
  9611     SET ADDRESS OF CONTROL-FILE TO
  9612         DFHEIV20
  9613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9614
  9615
  9616     IF CF-ZIP-CODE-NUM NOT NUMERIC
  9617         MOVE ZEROS              TO CF-ZIP-CODE-NUM.
  9618
  9619     IF CF-ZIP-CODE-NUM NOT = ZEROS
  9620         MOVE CF-ZIP-CODE-NUM    TO WORK-ZIP
  9621         IF WORK-ZIPR1-4 = ZEROS
  9622             MOVE WORK-ZIPR1-5   TO WORK-ZIPR2-5
  9623             MOVE ZEROS          TO WORK-ZIPR2-4
  9624             MOVE WORK-ZIP       TO CF-ZIP-CODE
  9625         ELSE
  9626             MOVE WORK-ZIP       TO CF-ZIP-CODE.
  9627
  9628     IF CF-CANADIAN-POST-CODE
  9629         MOVE CF-CAN-POSTAL-1    TO WS-CF-CAN-POST-1
  9630         MOVE CF-CAN-POSTAL-2    TO WS-CF-CAN-POST-2
  9631     ELSE
  9632         MOVE CF-ZIP-PRIME       TO WS-CF-ZIP-PRIME
  9633         IF CF-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9634             MOVE '-'            TO WS-CF-ZIP-DASH
  9635             MOVE CF-ZIP-PLUS4   TO WS-CF-ZIP-PLUS4.
  9636
  9637     GO TO 6120-EXIT.
  9638
  9639 6110-NO-RECORD.
  9640     IF ELCNTL-REC-TYPE = 1
  9641         MOVE ER-0022            TO EMI-ERROR
  9642     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 193
* EL640.cbl
  9643         MOVE ER-2208            TO EMI-ERROR
  9644         MOVE -1                 TO ACARIERL
  9645         MOVE AL-UABON           TO ACARIERA
  9646         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9647
  9648 6120-EXIT.
  9649     EXIT.
  9650 6130-FIND-BENEFIT-CD.
  9651
  9652* EXEC CICS READ
  9653*       DATASET (ELCNTL-FILE-ID)
  9654*       SET     (ADDRESS OF CONTROL-FILE)
  9655*       RIDFLD  (ELCNTL-KEY)
  9656*       GTEQ
  9657*       RESP    (WS-RESPONSE)
  9658*    END-EXEC
  9659*    MOVE '&"S        G          (  N#00009045' TO DFHEIV0
  9660     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9661     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9662     MOVE X'204E233030303039303435' TO DFHEIV0(25:11)
  9663     CALL 'kxdfhei1' USING DFHEIV0,
  9664           ELCNTL-FILE-ID,
  9665           DFHEIV20,
  9666           DFHEIV99,
  9667           ELCNTL-KEY,
  9668           DFHEIV99,
  9669           DFHEIV99,
  9670           DFHEIV99
  9671     SET ADDRESS OF CONTROL-FILE TO
  9672         DFHEIV20
  9673     MOVE EIBRESP  TO WS-RESPONSE
  9674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9675     IF ws-RESP-NORMAL
  9676        IF (CF-COMPANY-ID = PI-COMPANY-ID)
  9677           AND (CF-RECORD-TYPE = '5')
  9678           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  9679              (S1 > +8)
  9680              OR (CF-BENEFIT-CODE (S1) = CLAS-LOOK)
  9681           END-PERFORM
  9682           IF S1 NOT > +8
  9683              MOVE CF-BENEFIT-CATEGORY (S1)
  9684                                 TO WS-AH-CATEGORY
  9685              GO TO 6140-EXIT
  9686           END-IF
  9687        END-IF
  9688     END-IF
  9689     .
  9690 6140-NO-RECORD.
  9691     MOVE ER-2208                TO EMI-ERROR
  9692     MOVE -1                     TO ACARIERL
  9693     MOVE AL-UABON               TO ACARIERA
  9694     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  9695     .
  9696 6140-EXIT.
  9697     EXIT.
  9698 6200-REWRITE-CONTROL-FILE.
  9699
  9700
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 194
* EL640.cbl
  9701* EXEC CICS REWRITE
  9702*        DATASET (ELCNTL-FILE-ID)
  9703*        FROM    (CONTROL-FILE)
  9704*    END-EXEC.
  9705     MOVE LENGTH OF
  9706      CONTROL-FILE
  9707       TO DFHEIV11
  9708*    MOVE '&& L                  %   #00009077' TO DFHEIV0
  9709     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9710     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9711     MOVE X'2020233030303039303737' TO DFHEIV0(25:11)
  9712     CALL 'kxdfhei1' USING DFHEIV0,
  9713           ELCNTL-FILE-ID,
  9714           CONTROL-FILE,
  9715           DFHEIV11,
  9716           DFHEIV99
  9717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9718
  9719
  9720 6290-EXIT.
  9721     EXIT.
  9722
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 195
* EL640.cbl
  9724 6300-ELIMINATE-LINE-SPACES.
  9725     IF WS-REMIT-LINES (1) = SPACES
  9726         MOVE WS-REMIT-LINES (2)  TO WS-REMIT-LINES (1)
  9727         MOVE WS-REMIT-LINES (3)  TO WS-REMIT-LINES (2)
  9728         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9729         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9730         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9731         MOVE SPACES              TO WS-REMIT-LINES (6)
  9732         GO TO 6300-ELIMINATE-LINE-SPACES.
  9733
  9734     IF WS-REMIT-LINES (2) = SPACES AND
  9735        WS-REMIT-LINES (3) = SPACES AND
  9736        WS-REMIT-LINES (4) = SPACES AND
  9737        WS-REMIT-LINES (5) = SPACES AND
  9738        WS-REMIT-LINES (6) = SPACES
  9739          GO TO 6350-MOVE-ZIP.
  9740
  9741     IF WS-REMIT-LINES (2) = SPACES
  9742         MOVE WS-REMIT-LINES (3)  TO WS-REMIT-LINES (2)
  9743         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9744         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9745         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9746         MOVE SPACES              TO WS-REMIT-LINES (6)
  9747         GO TO 6300-ELIMINATE-LINE-SPACES.
  9748
  9749     IF WS-REMIT-LINES (3) = SPACES AND
  9750        WS-REMIT-LINES (4) = SPACES AND
  9751        WS-REMIT-LINES (5) = SPACES AND
  9752        WS-REMIT-LINES (6) = SPACES
  9753          GO TO 6350-MOVE-ZIP.
  9754
  9755     IF WS-REMIT-LINES (3) = SPACES
  9756         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9757         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9758         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9759         MOVE SPACES              TO WS-REMIT-LINES (6)
  9760         GO TO 6300-ELIMINATE-LINE-SPACES.
  9761
  9762     IF WS-REMIT-LINES (4) = SPACES AND
  9763        WS-REMIT-LINES (5) = SPACES AND
  9764        WS-REMIT-LINES (6) = SPACES
  9765          GO TO 6350-MOVE-ZIP.
  9766
  9767     IF WS-REMIT-LINES (4) = SPACES
  9768         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9769         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9770         MOVE SPACES              TO WS-REMIT-LINES (6)
  9771         GO TO 6300-ELIMINATE-LINE-SPACES.
  9772
  9773     IF WS-REMIT-LINES (5) = SPACES
  9774         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9775         MOVE SPACES              TO WS-REMIT-LINES (6).
  9776
  9777 6350-MOVE-ZIP.
  9778     IF WS-REMIT-LINES (6) NOT = SPACES
  9779         MOVE WS-REMIT-ZIP (6)        TO WS-R-LAST-ZIP (5)
  9780         MOVE SPACES                  TO WS-REMIT-LINES (6)
  9781     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 196
* EL640.cbl
  9782         IF WS-REMIT-LINES (5) NOT = SPACES
  9783             MOVE WS-REMIT-ZIP (5)     TO WS-R-LAST-ZIP (5)
  9784             MOVE SPACES               TO WS-REMIT-ZIP (5)
  9785         ELSE
  9786             IF WS-REMIT-LINES (4) NOT = SPACES
  9787                 MOVE WS-REMIT-ZIP (4) TO WS-R-LAST-ZIP (4)
  9788                 MOVE SPACES           TO WS-REMIT-ZIP (4).
  9789
  9790 6390-EXIT.
  9791     EXIT.
  9792
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 197
* EL640.cbl
  9794 6400-FORMAT-ACCOUNT-ADDRS.
  9795     IF WS-ACCT-ADDR-AREA = SPACES
  9796         GO TO 6490-EXIT.
  9797
  9798     IF WS-ACCT-LINES (1) = SPACES
  9799         MOVE WS-ACCT-LINES (2)  TO WS-ACCT-LINES (1)
  9800         MOVE WS-ACCT-LINES (3)  TO WS-ACCT-LINES (2)
  9801         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
  9802         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9803         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9804         MOVE SPACES              TO WS-ACCT-LINES (6)
  9805         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9806
  9807     IF WS-ACCT-LINES (2) = SPACES AND
  9808        WS-ACCT-LINES (3) = SPACES AND
  9809        WS-ACCT-LINES (4) = SPACES AND
  9810        WS-ACCT-LINES (5) = SPACES AND
  9811        WS-ACCT-LINES (6) = SPACES
  9812          GO TO 6450-MOVE-ZIP.
  9813
  9814     IF WS-ACCT-LINES (2) = SPACES
  9815         MOVE WS-ACCT-LINES (3)  TO WS-ACCT-LINES (2)
  9816         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
  9817         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9818         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9819         MOVE SPACES             TO WS-ACCT-LINES (6)
  9820         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9821
  9822     IF WS-ACCT-LINES (3) = SPACES AND
  9823        WS-ACCT-LINES (4) = SPACES AND
  9824        WS-ACCT-LINES (5) = SPACES AND
  9825        WS-ACCT-LINES (6) = SPACES
  9826          GO TO 6450-MOVE-ZIP.
  9827
  9828     IF WS-ACCT-LINES (3) = SPACES
  9829         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
  9830         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9831         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9832         MOVE SPACES             TO WS-ACCT-LINES (6)
  9833         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9834
  9835     IF WS-ACCT-LINES (4) = SPACES AND
  9836        WS-ACCT-LINES (5) = SPACES AND
  9837        WS-ACCT-LINES (6) = SPACES
  9838          GO TO 6450-MOVE-ZIP.
  9839
  9840     IF WS-ACCT-LINES (4) = SPACES
  9841         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9842         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9843         MOVE SPACES             TO WS-ACCT-LINES (6)
  9844         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9845
  9846     IF WS-ACCT-LINES (5) = SPACES
  9847         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9848         MOVE SPACES             TO WS-ACCT-LINES (6).
  9849
  9850 6450-MOVE-ZIP.
  9851     IF WS-ACCT-LINES (6) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 198
* EL640.cbl
  9852         MOVE WS-ACCT-ZIP (6)         TO WS-A-LAST-ZIP (5)
  9853         MOVE SPACES                  TO WS-ACCT-LINES (6)
  9854     ELSE
  9855         IF WS-ACCT-LINES (5) NOT = SPACES
  9856             MOVE WS-ACCT-ZIP (5)      TO WS-A-LAST-ZIP (5)
  9857             MOVE SPACES               TO WS-ACCT-ZIP (5)
  9858         ELSE
  9859             IF WS-ACCT-LINES (4) NOT = SPACES
  9860                 MOVE WS-ACCT-ZIP (4)  TO WS-A-LAST-ZIP (4)
  9861                 MOVE SPACES           TO WS-ACCT-ZIP (4).
  9862
  9863 6490-EXIT.
  9864     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 199
* EL640.cbl
  9866 7000-PROCESS-CHECK.
  9867*                *******************************************
  9868*                *    FORMAT THE CHECK SCREEN (EL640D)     *
  9869*                *******************************************
  9870     MOVE LOW-VALUES             TO EL640BO.
  9871
  9872     IF PI-SAV-ACCT = PI-SAV-REMIT-TO
  9873         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  9874         IF EMI-ERROR = ZEROS
  9875             MOVE AM-NAME        TO BNAMEO
  9876             MOVE AM-PERSON      TO BADDR1O
  9877             MOVE AM-ADDRS       TO BADDR2O
  9878*            MOVE AM-CITY        TO BCITYSTO
  9879             STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  9880                DELIMITED BY '  ' INTO BCITYSTO
  9881             END-STRING
  9882             MOVE WS-AM-ZIP      TO BZIPO
  9883         ELSE
  9884             MOVE EL640A         TO PI-MAP-NAME
  9885             MOVE -1             TO BPFNTERL
  9886             GO TO 8200-SEND-DATAONLY
  9887     ELSE
  9888         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  9889         IF EMI-ERROR = ZEROS
  9890             MOVE CO-ACCT-NAME   TO BNAMEO
  9891             MOVE CO-ADDR-1      TO BADDR1O
  9892             MOVE CO-ADDR-2      TO BADDR2O
  9893*            MOVE CO-ADDR-3      TO BCITYSTO
  9894             STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  9895                DELIMITED BY '  ' INTO BCITYSTO
  9896             END-STRING
  9897             MOVE WS-CO-ZIP      TO BZIPO
  9898         ELSE
  9899             MOVE EL640A         TO PI-MAP-NAME
  9900             MOVE -1             TO BPFNTERL
  9901             GO TO 8200-SEND-DATAONLY.
  9902
  9903     MOVE AL-UNNON               TO BCHKAMTA.
  9904     MOVE PI-ACCT-NAME           TO BACCNAMO.
  9905     MOVE PI-SAV-ACCT            TO BACCTO.
  9906     MOVE PI-COMP-CARRIER        TO BCARIERO.
  9907     MOVE PI-COMP-GROUPING       TO BGROUPO.
  9908     MOVE PI-SAV-STATE           TO BSTATEO.
  9909     MOVE PI-MONTH-END-DATE      TO BPAYDT2O
  9910                                    WS-BEGIN-DATE.
  9911     MOVE '01'                   TO WS-BEGIN-DAY.
  9912     MOVE WS-BEGIN-DATE          TO BPAYDT1O.
  9913     MOVE -1                     TO BCHKNOL
  9914
  9915     IF WS-ENTERED-FROM-A
  9916         COMPUTE WORK-CHECK-AMT = PI-END-BAL * -1
  9917         MOVE WORK-CHECK-AMT     TO BCHKAMTO
  9918     ELSE
  9919         MOVE WORK-CHECK-AMT     TO BCHKAMTO.
  9920
  9921     IF WORK-CHECK-AMT NOT > ZEROS
  9922         MOVE ER-3165    TO  EMI-ERROR
  9923         MOVE -1         TO  BCHKAMTL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 200
* EL640.cbl
  9924         MOVE AL-UNBON   TO  BCHKAMTA
  9925         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9926
  9927     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 201
* EL640.cbl
  9929
  9930 7500-PRODUCE-CHECK.
  9931*                *******************************************
  9932*                *   PRODUCES A CHECK FOR LATER PRINTING   *
  9933*                *******************************************
  9934     MOVE SPACES                 TO ELCNTL-KEY.
  9935     MOVE '1'                    TO ELCNTL-REC-TYPE.
  9936     MOVE 'Y'                    TO ELCNTL-UPDATE-SW.
  9937     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
  9938
  9939     IF EMI-ERROR NOT = ZEROS
  9940         GO TO 8200-SEND-DATAONLY.
  9941
  9942     IF CR-CHECK-NO-AUTO-SEQ
  9943         IF CR-CHECK-CNT-RESET-VALUE
  9944             MOVE CF-CR-CHECK-COUNTER TO BCHKNOI
  9945             MOVE +1             TO CF-CR-CHECK-COUNTER
  9946             MOVE 6              TO BCHKNOL
  9947         ELSE
  9948             MOVE CF-CR-CHECK-COUNTER TO BCHKNOI
  9949             MOVE 6              TO BCHKNOL
  9950             ADD +1              TO CF-CR-CHECK-COUNTER.
  9951
  9952     IF CR-CHECK-NO-MANUAL
  9953         IF BCHKNOL = ZEROS
  9954             MOVE ER-2438        TO EMI-ERROR
  9955             MOVE -1             TO BCHKNOL
  9956             MOVE AL-UNBON       TO BCHKNOA
  9957             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9958             GO TO 8200-SEND-DATAONLY
  9959         ELSE
  9960             IF BCHKNOI NOT NUMERIC
  9961                 MOVE ER-2439    TO EMI-ERROR
  9962                 MOVE -1         TO BCHKNOL
  9963                 MOVE AL-UNBON   TO BCHKNOA
  9964                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9965                 GO TO 8200-SEND-DATAONLY.
  9966
  9967     PERFORM 7600-CHECK-FORMS THRU 7600-EXIT.
  9968
  9969
  9970* EXEC CICS GETMAIN
  9971*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  9972*        LENGTH  (ERPYAJ-LENGTH)
  9973*        INITIMG (GETMAIN-SPACE)
  9974*    END-EXEC.
  9975*    MOVE ',"IL                  $   #00009331' TO DFHEIV0
  9976     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9977     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9978     MOVE X'2020233030303039333331' TO DFHEIV0(25:11)
  9979     CALL 'kxdfhei1' USING DFHEIV0,
  9980           DFHEIV20,
  9981           ERPYAJ-LENGTH,
  9982           GETMAIN-SPACE
  9983     SET ADDRESS OF PENDING-PAY-ADJ TO
  9984         DFHEIV20
  9985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9986
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 202
* EL640.cbl
  9987
  9988
  9989* EXEC CICS BIF DEEDIT
  9990*        FIELD  (BCHKAMTI)
  9991*        LENGTH (11)
  9992*    END-EXEC.
  9993     MOVE 11
  9994       TO DFHEIV11
  9995*    MOVE '@"L                   #   #00009337' TO DFHEIV0
  9996     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9997     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9998     MOVE X'2020233030303039333337' TO DFHEIV0(25:11)
  9999     CALL 'kxdfhei1' USING DFHEIV0,
 10000           BCHKAMTI,
 10001           DFHEIV11
 10002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10003
 10004
 10005     IF BCHKAMTI NOT > ZEROS
 10006         MOVE ER-3165    TO  EMI-ERROR
 10007         MOVE -1         TO  BCHKAMTL
 10008         MOVE AL-UNBON   TO  BCHKAMTA
 10009         MOVE BCHKAMTI   TO  BCHKAMTO
 10010         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10011         GO TO 8200-SEND-DATAONLY.
 10012
 10013     MOVE 'Y'                    TO PI-CHECK-SW.
 10014     MOVE 'PY'                   TO PY-RECORD-ID.
 10015     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
 10016     MOVE PI-COMP-CARRIER        TO PY-CARRIER.
 10017     MOVE PI-COMP-GROUPING       TO PY-GROUPING.
 10018     MOVE PI-SAV-REMIT-TO        TO PY-FIN-RESP.
 10019     MOVE PI-SAV-ACCT            TO PY-ACCOUNT.
 10020     MOVE 'C'                    TO PY-RECORD-TYPE.
 10021     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
 10022
 10023     IF PI-COMPANY-ID = CLIENT-ITY
 10024        MOVE PI-MONTH-END-DATE   TO WS-PY-END-DT
 10025                                    WS-BEGIN-DATE
 10026        MOVE '01'                TO WS-BEGIN-DAY
 10027        MOVE WS-BEGIN-DATE       TO WS-PY-BEGIN-DT
 10028        MOVE WS-ITY-COMMENT      TO PY-ENTRY-COMMENT
 10029     ELSE
 10030        MOVE WS-CURRENT-DATE-MDY TO WS-PY-CURRENT-DATE
 10031        MOVE WS-PY-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
 10032
 10033     MOVE BCHKAMTI               TO PY-ENTRY-AMT.
 10034     ADD BCHKAMTI TO PI-DISBURSED.
 10035     MOVE BFORM1I                TO PY-LETTER (1).
 10036     MOVE BFORM2I                TO PY-LETTER (2).
 10037     MOVE BFORM3I                TO PY-LETTER (3).
 10038
 10039     IF NOT CR-CHECK-NO-AT-PRINT
 10040         MOVE BCHKNOI            TO PY-CHECK-NUMBER.
 10041
 10042     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
 10043     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
 10044     MOVE WS-CURRENT-DATE        TO PY-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 203
* EL640.cbl
 10045                                    PY-INPUT-DT.
 10046     IF PI-BILL OR PI-REBILLING
 10047         MOVE DC-BIN-DATE-1      TO PY-BILLED-DATE
 10048     ELSE
 10049         MOVE LOW-VALUES         TO PY-BILLED-DATE
 10050                                    PY-AR-DATE.
 10051
 10052     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 10053                                    PY-CHECK-QUE-SEQUENCE.
 10054     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 10055                                    PY-REPORTED-DT
 10056                                    PY-CHECK-WRITTEN-DT.
 10057     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
 10058     MOVE 'B'                    TO PY-CHECK-ORIGIN-SW.
 10059
 10060
 10061* EXEC CICS WRITE
 10062*        DATASET (ERPYAJ-FILE-ID)
 10063*        FROM    (PENDING-PAY-ADJ)
 10064*        RIDFLD  (PY-CONTROL-PRIMARY)
 10065*    END-EXEC.
 10066     MOVE LENGTH OF
 10067      PENDING-PAY-ADJ
 10068       TO DFHEIV11
 10069*    MOVE '&$ L                  ''   #00009397' TO DFHEIV0
 10070     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10071     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10072     MOVE X'2020233030303039333937' TO DFHEIV0(25:11)
 10073     CALL 'kxdfhei1' USING DFHEIV0,
 10074           ERPYAJ-FILE-ID,
 10075           PENDING-PAY-ADJ,
 10076           DFHEIV11,
 10077           PY-CONTROL-PRIMARY,
 10078           DFHEIV99,
 10079           DFHEIV99
 10080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10081
 10082
 10083     IF CR-CHECK-NO-AUTO-SEQ
 10084         PERFORM 6200-REWRITE-CONTROL-FILE THRU 6290-EXIT
 10085     ELSE
 10086
 10087* EXEC CICS UNLOCK
 10088*            DATASET (ELCNTL-FILE-ID)
 10089*        END-EXEC.
 10090*    MOVE '&*                    #   #00009406' TO DFHEIV0
 10091     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10092     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10093     MOVE X'2020233030303039343036' TO DFHEIV0(25:11)
 10094     CALL 'kxdfhei1' USING DFHEIV0,
 10095           ELCNTL-FILE-ID,
 10096           DFHEIV99
 10097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10098
 10099
 10100     MOVE EL640A                 TO PI-MAP-NAME.
 10101     PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT.
 10102     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 204
* EL640.cbl
 10103
 10104 7600-CHECK-FORMS.
 10105
 10106     IF BFORM1L NOT = ZEROS
 10107             AND
 10108        BFORM1I NOT = SPACES
 10109         MOVE BFORM1I            TO ELLETR-FORM-NO
 10110         PERFORM 7620-CHECK-ON-LETTER THRU 7620-EXIT
 10111         IF W-LETTER-NOT-FOUND
 10112             MOVE ER-7389        TO EMI-ERROR
 10113             MOVE -1             TO BFORM1L
 10114             MOVE AL-UABON       TO BFORM1A
 10115             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10116             GO TO 8200-SEND-DATAONLY.
 10117
 10118     IF BFORM2L NOT = ZEROS
 10119             AND
 10120        BFORM2I NOT = SPACES
 10121         MOVE BFORM2I            TO ELLETR-FORM-NO
 10122         PERFORM 7620-CHECK-ON-LETTER THRU 7620-EXIT
 10123
 10124         IF W-LETTER-NOT-FOUND
 10125             MOVE ER-7389        TO EMI-ERROR
 10126             MOVE -1             TO BFORM2L
 10127             MOVE AL-UABON       TO BFORM2A
 10128             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10129             GO TO 8200-SEND-DATAONLY.
 10130
 10131     IF BFORM3L NOT = ZEROS
 10132             AND
 10133        BFORM3I NOT = SPACES
 10134         MOVE BFORM3I            TO ELLETR-FORM-NO
 10135         IF  W-LETTER-NOT-FOUND
 10136             MOVE ER-7389        TO EMI-ERROR
 10137             MOVE -1             TO BFORM3L
 10138             MOVE AL-UABON       TO BFORM3A
 10139             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10140             GO TO 8200-SEND-DATAONLY.
 10141
 10142     IF BFORM1L = ZEROS
 10143         IF BFORM2L NOT = ZEROS
 10144             MOVE BFORM2L        TO BFORM1L
 10145             MOVE BFORM3L        TO BFORM2L
 10146             MOVE BFORM2A        TO BFORM1A
 10147             MOVE BFORM3A        TO BFORM2A
 10148             MOVE BFORM2I        TO BFORM1I
 10149             MOVE BFORM3I        TO BFORM2I
 10150             MOVE LOW-VALUES     TO BFORM3I
 10151                                    BFORM3A
 10152             MOVE ZEROS          TO BFORM3L
 10153         ELSE
 10154             IF BFORM3L NOT = ZEROS
 10155                 MOVE BFORM3L    TO BFORM1L
 10156                 MOVE BFORM3I    TO BFORM1I
 10157                 MOVE BFORM3A    TO BFORM1A
 10158                 MOVE LOW-VALUES TO BFORM3I
 10159                                    BFORM3A
 10160                 MOVE ZEROS      TO BFORM3L
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 205
* EL640.cbl
 10161             ELSE
 10162                 NEXT SENTENCE
 10163     ELSE
 10164         IF BFORM2L = ZEROS
 10165             IF BFORM3L NOT = ZEROS
 10166                 MOVE BFORM3L    TO BFORM2L
 10167                 MOVE BFORM3I    TO BFORM2I
 10168                 MOVE BFORM3A    TO BFORM2A
 10169                 MOVE LOW-VALUES TO BFORM3I
 10170                                    BFORM3A
 10171                 MOVE ZEROS      TO BFORM3L.
 10172
 10173 7600-EXIT.
 10174      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 206
* EL640.cbl
 10176 7620-CHECK-ON-LETTER.
 10177
 10178     MOVE SPACES                 TO W-LETTER-IND.
 10179
 10180     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD.
 10181     MOVE +1                     TO ELLETR-LINE-SEQ.
 10182
 10183
 10184* EXEC CICS HANDLE CONDITION
 10185*        NOTFND   (7620-LETR-NOT-FOUND)
 10186*        ENDFILE  (7620-LETR-NOT-FOUND)
 10187*        NOTOPEN  (7620-LETR-NOT-OPEN)
 10188*    END-EXEC.
 10189*    MOVE '"$I''J                 ! 0 #00009493' TO DFHEIV0
 10190     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 10191     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10192     MOVE X'3020233030303039343933' TO DFHEIV0(25:11)
 10193     CALL 'kxdfhei1' USING DFHEIV0
 10194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10195
 10196
 10197
 10198* EXEC CICS READ
 10199*        SET     (ADDRESS OF TEXT-FILES)
 10200*        DATASET (ELLETR-FILE-ID)
 10201*        RIDFLD  (ELLETR-KEY)
 10202*    END-EXEC.
 10203*    MOVE '&"S        E          (   #00009499' TO DFHEIV0
 10204     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10205     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10206     MOVE X'2020233030303039343939' TO DFHEIV0(25:11)
 10207     CALL 'kxdfhei1' USING DFHEIV0,
 10208           ELLETR-FILE-ID,
 10209           DFHEIV20,
 10210           DFHEIV99,
 10211           ELLETR-KEY,
 10212           DFHEIV99,
 10213           DFHEIV99,
 10214           DFHEIV99
 10215     SET ADDRESS OF TEXT-FILES TO
 10216         DFHEIV20
 10217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10218
 10219
 10220     GO TO 7620-EXIT.
 10221
 10222 7620-LETR-NOT-FOUND.
 10223
 10224     MOVE 'Y'                    TO W-LETTER-IND.
 10225     GO TO 7620-EXIT.
 10226
 10227 7620-LETR-NOT-OPEN.
 10228
 10229     MOVE ER-0013                TO EMI-ERROR.
 10230     MOVE -1                     TO BFORM1L.
 10231     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10232     GO TO 8200-SEND-DATAONLY.
 10233
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 207
* EL640.cbl
 10234 7620-EXIT.
 10235      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 208
* EL640.cbl
 10237 8100-SEND-INITIAL-MAP.
 10238
 10239     MOVE SPACES TO PI-TRANSFER-SW.
 10240
 10241     IF PI-MAP-NAME = EL640A
 10242         NEXT SENTENCE
 10243     ELSE
 10244         GO TO 8110-SEND-INITIAL-CHECK-MAP.
 10245
 10246     IF PI-COMPANY-ID = 'DMD'
 10247        MOVE AL-SADOF            TO APF5HDGA.
 10248
 10249     IF NOT PI-GA-BILLING
 10250        MOVE AL-SADOF            TO AGAHDGA.
 10251
 10252     MOVE WS-CURRENT-DATE-EDIT   TO ADATEO.
 10253     MOVE EIBTIME                TO TIME-IN.
 10254     MOVE TIME-OUT               TO ATIMEO.
 10255     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10256     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10257
 10258     MOVE -1                     TO AACCTL.
 10259     MOVE EMI-MESSAGE-AREA (1)   TO AERMSG1O.
 10260     MOVE EMI-MESSAGE-AREA (2)   TO AERMSG2O.
 10261
 10262     IF CARR-GROUP-ST-ACCNT-CNTL
 10263         NEXT SENTENCE
 10264     ELSE
 10265         IF ST-ACCNT-CNTL
 10266             MOVE AL-SADOF       TO ACARHDGA
 10267                                    AGRPHDGA
 10268             MOVE AL-SANOF       TO ACARIERA
 10269                                    AGROUPA
 10270         ELSE
 10271             IF CARR-ST-ACCNT-CNTL
 10272                 MOVE AL-SADOF   TO AGRPHDGA
 10273                 MOVE AL-SANOF   TO AGROUPA
 10274             ELSE
 10275                 IF ACCNT-CNTL
 10276                     MOVE AL-SADOF TO ACARHDGA
 10277                                      AGRPHDGA
 10278                                      ASTHDGA
 10279                     MOVE AL-SANOF TO ACARIERA
 10280                                      AGROUPA
 10281                                      ASTATEA
 10282                 ELSE
 10283                     IF CARR-ACCNT-CNTL
 10284                         MOVE AL-SADOF TO AGRPHDGA
 10285                                          ASTHDGA
 10286                         MOVE AL-SANOF TO AGROUPA
 10287                                          ASTATEA.
 10288
 10289     IF (EIBTRNID = EL633-TRANS-ID  OR  EL635-TRANS-ID  OR
 10290                    EL633DMD-TRANS-ID  OR
 10291                    EL650-TRANS-ID  OR  EL652-TRANS-ID  OR
 10292                    EL658-TRANS-ID)  AND
 10293          (WT-CR-ACCOUNT NOT = SPACES AND LOW-VALUES)
 10294        MOVE WT-CR-CARRIER       TO PI-SCR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 209
* EL640.cbl
 10295        MOVE WT-CR-GROUPING      TO PI-SCR-GROUPING
 10296        MOVE WT-CR-STATE         TO PI-SCR-STATE
 10297        MOVE WT-CR-FIN-RESP      TO PI-SCR-FIN-RESP
 10298        MOVE WT-CR-TYPE          TO PI-SCR-TYPE
 10299        IF CARR-GROUP-ST-ACCNT-CNTL
 10300            MOVE AL-UANON        TO ACARIERA
 10301                                    AGROUPA
 10302                                    ASTATEA
 10303                                    AACCTA
 10304            MOVE WT-CR-CARRIER   TO ACARIERI
 10305                                    PI-SCR-CARRIER
 10306            MOVE WT-CR-GROUPING  TO AGROUPI
 10307                                    PI-SCR-GROUPING
 10308            MOVE WT-CR-ACCOUNT   TO AACCTI
 10309                                    PI-SCR-ACCOUNT
 10310            MOVE 1               TO ACARIERL
 10311            MOVE 6               TO AGROUPL
 10312            MOVE 10              TO AACCTL
 10313            MOVE -1              TO ASTATEL
 10314        ELSE
 10315         IF ST-ACCNT-CNTL
 10316            MOVE AL-UANON        TO ASTATEA
 10317                                    AACCTA
 10318            MOVE WT-CR-ACCOUNT   TO AACCTI
 10319                                    PI-SCR-ACCOUNT
 10320            MOVE 10              TO AACCTL
 10321            MOVE -1              TO ASTATEL
 10322         ELSE
 10323            IF CARR-ST-ACCNT-CNTL
 10324                MOVE AL-UANON       TO ACARIERA
 10325                                       ASTATEA
 10326                                       AACCTA
 10327                MOVE WT-CR-CARRIER TO ACARIERI
 10328                                      PI-SCR-CARRIER
 10329                MOVE WT-CR-ACCOUNT TO AACCTI
 10330                                      PI-SCR-ACCOUNT
 10331                MOVE 1              TO ACARIERL
 10332                MOVE 10             TO AACCTL
 10333                MOVE -1             TO ASTATEL
 10334            ELSE
 10335                IF ACCNT-CNTL
 10336                    MOVE AL-UANON       TO AACCTA
 10337                    MOVE WT-CR-ACCOUNT  TO AACCTI
 10338                                           PI-SCR-ACCOUNT
 10339                    MOVE 10             TO AACCTL
 10340                    MOVE -1             TO ABILTYPL
 10341                ELSE
 10342                    IF CARR-ACCNT-CNTL
 10343                        MOVE AL-UANON        TO ACARIERA
 10344                                                AACCTA
 10345                        MOVE WT-CR-CARRIER   TO ACARIERI
 10346                                                PI-SCR-CARRIER
 10347                        MOVE WT-CR-ACCOUNT   TO AACCTI
 10348                                                PI-SCR-ACCOUNT
 10349                        MOVE 1               TO ACARIERL
 10350                        MOVE 10              TO AACCTL
 10351                        MOVE -1              TO ABILTYPL.
 10352
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 210
* EL640.cbl
 10353     IF (EIBTRNID = EL6311-TRANS-ID) AND
 10354          (WT-CR-ACCOUNT NOT = SPACES AND LOW-VALUES)
 10355        MOVE WT-CR-CARRIER       TO PI-SCR-CARRIER
 10356        MOVE WT-CR-GROUPING      TO PI-SCR-GROUPING
 10357        MOVE WT-CR-STATE         TO PI-SCR-STATE
 10358        MOVE WT-CR-FIN-RESP      TO PI-SCR-FIN-RESP
 10359        MOVE WT-CR-TYPE          TO PI-SCR-TYPE
 10360        MOVE SPACES              TO PI-SAV-CARR
 10361                                    PI-SAV-GROUP
 10362                                    PI-SAV-STATE
 10363                                    PI-SAV-ACCT
 10364        MOVE LOW-VALUES          TO PI-SAV-EXP-DT
 10365        IF CARR-GROUP-ST-ACCNT-CNTL
 10366            MOVE AL-UANON        TO ACARIERA
 10367                                    AGROUPA
 10368                                    ASTATEA
 10369                                    AACCTA
 10370            MOVE WT-CR-CARRIER   TO ACARIERI
 10371                                    PI-SCR-CARRIER
 10372                                    PI-SAV-CARR
 10373            MOVE WT-CR-GROUPING  TO AGROUPI
 10374                                    PI-SCR-GROUPING
 10375                                    PI-SAV-GROUP
 10376            MOVE WT-CR-STATE     TO ASTATEI
 10377                                    PI-SCR-STATE
 10378            MOVE WT-CR-ACCOUNT   TO AACCTI
 10379                                    PI-SCR-ACCOUNT
 10380            MOVE 1               TO ACARIERL
 10381            MOVE 6               TO AGROUPL
 10382            MOVE 10              TO AACCTL
 10383            MOVE 2               TO ASTATEL
 10384            MOVE -1              TO ABILTYPL
 10385        ELSE
 10386         IF ST-ACCNT-CNTL
 10387            MOVE AL-UANON        TO ASTATEA
 10388                                    AACCTA
 10389            MOVE WT-CR-STATE     TO ASTATEI
 10390                                    PI-SCR-STATE
 10391                                    PI-SAV-STATE
 10392            MOVE WT-CR-ACCOUNT   TO AACCTI
 10393                                    PI-SCR-ACCOUNT
 10394                                    PI-SAV-ACCT
 10395            MOVE 10              TO AACCTL
 10396            MOVE -1              TO ASTATEL
 10397         ELSE
 10398            IF CARR-ST-ACCNT-CNTL
 10399                MOVE AL-UANON      TO ACARIERA
 10400                                      ASTATEA
 10401                                      AACCTA
 10402                MOVE WT-CR-CARRIER TO ACARIERI
 10403                                      PI-SCR-CARRIER
 10404                                      PI-SAV-CARR
 10405                MOVE WT-CR-STATE   TO ASTATEI
 10406                                      PI-SCR-STATE
 10407                                      PI-SAV-STATE
 10408                MOVE WT-CR-ACCOUNT TO AACCTI
 10409                                      PI-SCR-ACCOUNT
 10410                                      PI-SAV-ACCT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 211
* EL640.cbl
 10411                MOVE 1             TO ACARIERL
 10412                MOVE 10            TO AACCTL
 10413                MOVE 2             TO ASTATEL
 10414                MOVE -1            TO ABILTYPL
 10415            ELSE
 10416                IF ACCNT-CNTL
 10417                    MOVE AL-UANON       TO AACCTA
 10418                    MOVE WT-CR-ACCOUNT  TO AACCTI
 10419                                           PI-SCR-ACCOUNT
 10420                                           PI-SAV-ACCT
 10421                    MOVE 10             TO AACCTL
 10422                    MOVE -1             TO ABILTYPL
 10423                ELSE
 10424                    IF CARR-ACCNT-CNTL
 10425                        MOVE AL-UANON        TO ACARIERA
 10426                                                AACCTA
 10427                        MOVE WT-CR-CARRIER   TO ACARIERI
 10428                                                PI-SCR-CARRIER
 10429                                                PI-SAV-CARR
 10430                        MOVE WT-CR-ACCOUNT   TO AACCTI
 10431                                                PI-SCR-ACCOUNT
 10432                                                PI-SAV-ACCT
 10433                        MOVE 1               TO ACARIERL
 10434                        MOVE 10              TO AACCTL
 10435                        MOVE -1              TO ABILTYPL.
 10436
 10437
 10438* EXEC CICS SEND
 10439*        MAP      (PI-MAP-NAME)
 10440*        MAPSET   (MAPSET-NAME)
 10441*        FROM     (EL640AO)
 10442*        ERASE
 10443*        CURSOR
 10444*    END-EXEC.
 10445     MOVE LENGTH OF
 10446      EL640AO
 10447       TO DFHEIV12
 10448     MOVE -1
 10449       TO DFHEIV11
 10450*    MOVE '8$     CT  E    H L F ,   #00009722' TO DFHEIV0
 10451     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10452     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10453     MOVE X'2020233030303039373232' TO DFHEIV0(25:11)
 10454     CALL 'kxdfhei1' USING DFHEIV0,
 10455           PI-MAP-NAME,
 10456           EL640AO,
 10457           DFHEIV12,
 10458           MAPSET-NAME,
 10459           DFHEIV99,
 10460           DFHEIV99,
 10461           DFHEIV99,
 10462           DFHEIV11,
 10463           DFHEIV99,
 10464           DFHEIV99,
 10465           DFHEIV99
 10466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10467
 10468
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 212
* EL640.cbl
 10469     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 213
* EL640.cbl
 10471 8110-SEND-INITIAL-CHECK-MAP.
 10472     MOVE WS-CURRENT-DATE-EDIT   TO BDATEO.
 10473     MOVE EIBTIME                TO TIME-IN.
 10474     MOVE TIME-OUT               TO BTIMEO.
 10475     MOVE PI-COMPANY-ID          TO BCMPNYO.
 10476     MOVE PI-PROCESSOR-ID        TO BUSERIDO.
 10477     MOVE -1                     TO BPFNTERL.
 10478     MOVE EMI-MESSAGE-AREA (1)   TO BERMSGO.
 10479
 10480
 10481* EXEC CICS SEND
 10482*        MAP      (PI-MAP-NAME)
 10483*        MAPSET   (MAPSET-NAME)
 10484*        FROM     (EL640BO)
 10485*        ERASE
 10486*        CURSOR
 10487*    END-EXEC.
 10488     MOVE LENGTH OF
 10489      EL640BO
 10490       TO DFHEIV12
 10491     MOVE -1
 10492       TO DFHEIV11
 10493*    MOVE '8$     CT  E    H L F ,   #00009741' TO DFHEIV0
 10494     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10495     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10496     MOVE X'2020233030303039373431' TO DFHEIV0(25:11)
 10497     CALL 'kxdfhei1' USING DFHEIV0,
 10498           PI-MAP-NAME,
 10499           EL640BO,
 10500           DFHEIV12,
 10501           MAPSET-NAME,
 10502           DFHEIV99,
 10503           DFHEIV99,
 10504           DFHEIV99,
 10505           DFHEIV11,
 10506           DFHEIV99,
 10507           DFHEIV99,
 10508           DFHEIV99
 10509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10510
 10511
 10512     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 214
* EL640.cbl
 10514 8200-SEND-DATAONLY.
 10515     IF PI-MAP-NAME = EL640A
 10516         MOVE WS-CURRENT-DATE-EDIT   TO ADATEO
 10517         MOVE EIBTIME                TO TIME-IN
 10518         MOVE TIME-OUT               TO ATIMEO
 10519         MOVE PI-COMPANY-ID          TO CMPNYIDO
 10520         MOVE PI-PROCESSOR-ID        TO USERIDO
 10521         MOVE EMI-MESSAGE-AREA (1)   TO AERMSG1O
 10522         MOVE EMI-MESSAGE-AREA (2)   TO AERMSG2O
 10523
 10524* EXEC CICS SEND
 10525*            MAP      (PI-MAP-NAME)
 10526*            MAPSET   (MAPSET-NAME)
 10527*            FROM     (EL640AO)
 10528*            DATAONLY
 10529*            ERASEAUP
 10530*            CURSOR
 10531*        END-EXEC
 10532     MOVE LENGTH OF
 10533      EL640AO
 10534       TO DFHEIV12
 10535     MOVE -1
 10536       TO DFHEIV11
 10537*    MOVE '8$D    CT  A    H L F ,   #00009760' TO DFHEIV0
 10538     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 10539     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10540     MOVE X'2020233030303039373630' TO DFHEIV0(25:11)
 10541     CALL 'kxdfhei1' USING DFHEIV0,
 10542           PI-MAP-NAME,
 10543           EL640AO,
 10544           DFHEIV12,
 10545           MAPSET-NAME,
 10546           DFHEIV99,
 10547           DFHEIV99,
 10548           DFHEIV99,
 10549           DFHEIV11,
 10550           DFHEIV99,
 10551           DFHEIV99,
 10552           DFHEIV99
 10553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10554     ELSE
 10555         MOVE WS-CURRENT-DATE-EDIT   TO BDATEO
 10556         MOVE EIBTIME                TO TIME-IN
 10557         MOVE TIME-OUT               TO BTIMEO
 10558         MOVE PI-COMPANY-ID          TO BCMPNYO
 10559         MOVE PI-PROCESSOR-ID        TO BUSERIDO
 10560         MOVE EMI-MESSAGE-AREA (1)   TO BERMSGO
 10561
 10562* EXEC CICS SEND
 10563*            MAP      (PI-MAP-NAME)
 10564*            MAPSET   (MAPSET-NAME)
 10565*            FROM     (EL640BO)
 10566*            DATAONLY
 10567*            ERASEAUP
 10568*            CURSOR
 10569*        END-EXEC.
 10570     MOVE LENGTH OF
 10571      EL640BO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 215
* EL640.cbl
 10572       TO DFHEIV12
 10573     MOVE -1
 10574       TO DFHEIV11
 10575*    MOVE '8$D    CT  A    H L F ,   #00009775' TO DFHEIV0
 10576     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 10577     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10578     MOVE X'2020233030303039373735' TO DFHEIV0(25:11)
 10579     CALL 'kxdfhei1' USING DFHEIV0,
 10580           PI-MAP-NAME,
 10581           EL640BO,
 10582           DFHEIV12,
 10583           MAPSET-NAME,
 10584           DFHEIV99,
 10585           DFHEIV99,
 10586           DFHEIV99,
 10587           DFHEIV11,
 10588           DFHEIV99,
 10589           DFHEIV99,
 10590           DFHEIV99
 10591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10592
 10593
 10594     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 216
* EL640.cbl
 10596 8300-SEND-TEXT.
 10597
 10598* EXEC CICS SEND TEXT
 10599*        FROM     (LOGOFF-TEXT)
 10600*        LENGTH   (LOGOFF-LENGTH)
 10601*        ERASE
 10602*        FREEKB
 10603*    END-EXEC.
 10604*    MOVE '8&      T  E F  H   F -   #00009787' TO DFHEIV0
 10605     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10606     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10607     MOVE X'2020233030303039373837' TO DFHEIV0(25:11)
 10608     CALL 'kxdfhei1' USING DFHEIV0,
 10609           LOGOFF-TEXT,
 10610           LOGOFF-LENGTH,
 10611           DFHEIV99,
 10612           DFHEIV99,
 10613           DFHEIV99,
 10614           DFHEIV99,
 10615           DFHEIV99,
 10616           DFHEIV99,
 10617           DFHEIV99,
 10618           DFHEIV99,
 10619           DFHEIV99,
 10620           DFHEIV99
 10621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10622
 10623
 10624
 10625* EXEC CICS RETURN
 10626*    END-EXEC.
 10627*    MOVE '.(                    ''   #00009794' TO DFHEIV0
 10628     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10629     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10630     MOVE X'2020233030303039373934' TO DFHEIV0(25:11)
 10631     CALL 'kxdfhei1' USING DFHEIV0,
 10632           DFHEIV99,
 10633           DFHEIV99,
 10634           DFHEIV99,
 10635           DFHEIV99,
 10636           DFHEIV99,
 10637           DFHEIV99
 10638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10639
 10640
 10641 8500-DATE-CONVERT.
 10642
 10643* EXEC CICS LINK
 10644*        PROGRAM  (LINK-ELDATCV)
 10645*        COMMAREA (DATE-CONVERSION-DATA)
 10646*        LENGTH   (DC-COMM-LENGTH)
 10647*    END-EXEC.
 10648*    MOVE '."C                   (   #00009798' TO DFHEIV0
 10649     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10650     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10651     MOVE X'2020233030303039373938' TO DFHEIV0(25:11)
 10652     CALL 'kxdfhei1' USING DFHEIV0,
 10653           LINK-ELDATCV,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 217
* EL640.cbl
 10654           DATE-CONVERSION-DATA,
 10655           DC-COMM-LENGTH,
 10656           DFHEIV99,
 10657           DFHEIV99,
 10658           DFHEIV99,
 10659           DFHEIV99
 10660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10661
 10662
 10663 8500-EXIT.
 10664     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 218
* EL640.cbl
 10666 8800-UNAUTHORIZED-ACCESS.
 10667     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 10668     GO TO 8300-SEND-TEXT.
 10669
 10670 8810-PF23.
 10671     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 10672     MOVE XCTL-005               TO PGM-NAME.
 10673     GO TO 9300-XCTL.
 10674
 10675 8900-SYNCPOINT-ROLLBACK.
 10676
 10677* EXEC CICS SYNCPOINT
 10678*         ROLLBACK
 10679*    END-EXEC.
 10680*    MOVE '6"R                   !   #00009817' TO DFHEIV0
 10681     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10682     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10683     MOVE X'2020233030303039383137' TO DFHEIV0(25:11)
 10684     CALL 'kxdfhei1' USING DFHEIV0
 10685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10686
 10687
 10688 8900-EXIT.
 10689     EXIT.
 10690
 10691 9100-RETURN-TRAN.
 10692     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 10693     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 10694
 10695
 10696* EXEC CICS RETURN
 10697*        TRANSID    (TRANS-ID)
 10698*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10699*        LENGTH     (PI-COMM-LENGTH)
 10700*    END-EXEC.
 10701*    MOVE '.(CT                  ''   #00009828' TO DFHEIV0
 10702     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10703     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10704     MOVE X'2020233030303039383238' TO DFHEIV0(25:11)
 10705     CALL 'kxdfhei1' USING DFHEIV0,
 10706           TRANS-ID,
 10707           PROGRAM-INTERFACE-BLOCK,
 10708           PI-COMM-LENGTH,
 10709           DFHEIV99,
 10710           DFHEIV99,
 10711           DFHEIV99
 10712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10713
 10714
 10715 9200-RETURN-MAIN-MENU.
 10716     MOVE XCTL-626               TO PGM-NAME.
 10717     GO TO 9300-XCTL.
 10718
 10719 9300-XCTL.
 10720
 10721* EXEC CICS XCTL
 10722*        PROGRAM    (PGM-NAME)
 10723*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 219
* EL640.cbl
 10724*        LENGTH     (PI-COMM-LENGTH)
 10725*    END-EXEC.
 10726*    MOVE '.$C                   %   #00009839' TO DFHEIV0
 10727     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10728     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10729     MOVE X'2020233030303039383339' TO DFHEIV0(25:11)
 10730     CALL 'kxdfhei1' USING DFHEIV0,
 10731           PGM-NAME,
 10732           PROGRAM-INTERFACE-BLOCK,
 10733           PI-COMM-LENGTH,
 10734           DFHEIV99
 10735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10736
 10737
 10738 9400-CLEAR.
 10739     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME
 10740     GO TO 9300-XCTL.
 10741
 10742 9500-PF12.
 10743     MOVE XCTL-010               TO PGM-NAME.
 10744     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 220
* EL640.cbl
 10746 9600-PGMID-ERROR.
 10747
 10748* EXEC CICS HANDLE CONDITION
 10749*        PGMIDERR    (8300-SEND-TEXT)
 10750*    END-EXEC.
 10751*    MOVE '"$L                   ! 1 #00009854' TO DFHEIV0
 10752     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10753     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10754     MOVE X'3120233030303039383534' TO DFHEIV0(25:11)
 10755     CALL 'kxdfhei1' USING DFHEIV0
 10756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10757
 10758
 10759     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10760     MOVE ' '                    TO PI-ENTRY-CD-1.
 10761     MOVE XCTL-005               TO PGM-NAME.
 10762     MOVE PGM-NAME               TO LOGOFF-PGM.
 10763     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 10764     GO TO 9300-XCTL.
 10765
 10766 9900-ERROR-FORMAT.
 10767     IF NOT EMI-ERRORS-COMPLETE
 10768         MOVE LINK-001           TO PGM-NAME
 10769
 10770* EXEC CICS LINK
 10771*            PROGRAM    (PGM-NAME)
 10772*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10773*            LENGTH     (EMI-COMM-LENGTH)
 10774*        END-EXEC.
 10775*    MOVE '."C                   (   #00009868' TO DFHEIV0
 10776     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10777     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10778     MOVE X'2020233030303039383638' TO DFHEIV0(25:11)
 10779     CALL 'kxdfhei1' USING DFHEIV0,
 10780           PGM-NAME,
 10781           ERROR-MESSAGE-INTERFACE-BLOCK,
 10782           EMI-COMM-LENGTH,
 10783           DFHEIV99,
 10784           DFHEIV99,
 10785           DFHEIV99,
 10786           DFHEIV99
 10787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10788
 10789
 10790 9900-EXIT.
 10791     EXIT.
 10792
 10793 9990-ABEND.
 10794     MOVE LINK-004               TO PGM-NAME.
 10795     MOVE DFHEIBLK               TO EMI-LINE1.
 10796
 10797
 10798* EXEC CICS LINK
 10799*        PROGRAM   (PGM-NAME)
 10800*        COMMAREA  (EMI-LINE1)
 10801*        LENGTH    (72)
 10802*    END-EXEC.
 10803     MOVE 72
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 221
* EL640.cbl
 10804       TO DFHEIV11
 10805*    MOVE '."C                   (   #00009881' TO DFHEIV0
 10806     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10808     MOVE X'2020233030303039383831' TO DFHEIV0(25:11)
 10809     CALL 'kxdfhei1' USING DFHEIV0,
 10810           PGM-NAME,
 10811           EMI-LINE1,
 10812           DFHEIV11,
 10813           DFHEIV99,
 10814           DFHEIV99,
 10815           DFHEIV99,
 10816           DFHEIV99
 10817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10818
 10819
 10820     IF PI-MAP-NAME = EL640A
 10821         MOVE -1 TO APFNTERL
 10822     ELSE
 10823         MOVE -1 TO BPFNTERL.
 10824
 10825     GO TO 8200-SEND-DATAONLY.
 10826
 10827 9995-SECURITY-VIOLATION.
 10828*                            COPY ELCSCTP.
 10829******************************************************************
 10830*                                                                *
 10831*                            ELCSCTP                             *
 10832*                            VMOD=2.001                          *
 10833*                                                                *
 10834*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10835******************************************************************
 10836
 10837
 10838     MOVE EIBDATE          TO SM-JUL-DATE.
 10839     MOVE EIBTRMID         TO SM-TERMID.
 10840     MOVE THIS-PGM         TO SM-PGM.
 10841     MOVE EIBTIME          TO TIME-IN.
 10842     MOVE TIME-OUT         TO SM-TIME.
 10843     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10844
 10845
 10846* EXEC CICS LINK
 10847*         PROGRAM  ('EL003')
 10848*         COMMAREA (SECURITY-MESSAGE)
 10849*         LENGTH   (80)
 10850*    END-EXEC.
 10851     MOVE 'EL003' TO DFHEIV1
 10852     MOVE 80
 10853       TO DFHEIV11
 10854*    MOVE '."C                   (   #00009912' TO DFHEIV0
 10855     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10856     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10857     MOVE X'2020233030303039393132' TO DFHEIV0(25:11)
 10858     CALL 'kxdfhei1' USING DFHEIV0,
 10859           DFHEIV1,
 10860           SECURITY-MESSAGE,
 10861           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 222
* EL640.cbl
 10862           DFHEIV99,
 10863           DFHEIV99,
 10864           DFHEIV99,
 10865           DFHEIV99
 10866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10867
 10868
 10869******************************************************************
 10870
 10871
 10872
 10873 9999-DFHBACK SECTION.
 10874     MOVE '9%                    "   ' TO DFHEIV0
 10875     MOVE 'EL640' TO DFHEIV1
 10876     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10877     GOBACK.
 10878 9999-DFHEXIT.
 10879     IF DFHEIGDJ EQUAL 0001
 10880         NEXT SENTENCE
 10881     ELSE IF DFHEIGDJ EQUAL 2
 10882         GO TO 9600-PGMID-ERROR,
 10883               9990-ABEND
 10884         DEPENDING ON DFHEIGDI
 10885     ELSE IF DFHEIGDJ EQUAL 3
 10886         GO TO 0890-EXIT
 10887         DEPENDING ON DFHEIGDI
 10888     ELSE IF DFHEIGDJ EQUAL 4
 10889         GO TO 3930-BILL-NOTFND,
 10890               3930-BILL-NOTOPEN
 10891         DEPENDING ON DFHEIGDI
 10892     ELSE IF DFHEIGDJ EQUAL 5
 10893         GO TO 3940-EXIT
 10894         DEPENDING ON DFHEIGDI
 10895     ELSE IF DFHEIGDJ EQUAL 6
 10896         GO TO 4010-REC-NOT-FND
 10897         DEPENDING ON DFHEIGDI
 10898     ELSE IF DFHEIGDJ EQUAL 7
 10899         GO TO 4110-END-OF-FILE
 10900         DEPENDING ON DFHEIGDI
 10901     ELSE IF DFHEIGDJ EQUAL 8
 10902         GO TO 4270-PNDB-NOTFIND,
 10903               4280-PNDB-FILE-NOTOPEN
 10904         DEPENDING ON DFHEIGDI
 10905     ELSE IF DFHEIGDJ EQUAL 9
 10906         GO TO 4370-ACCOUNT-INVALID,
 10907               4380-ACCT-FILE-NOTOPEN
 10908         DEPENDING ON DFHEIGDI
 10909     ELSE IF DFHEIGDJ EQUAL 10
 10910         GO TO 4470-ACCOUNT-INVALID,
 10911               4480-ACCT-FILE-NOTOPEN
 10912         DEPENDING ON DFHEIGDI
 10913     ELSE IF DFHEIGDJ EQUAL 11
 10914         GO TO 4510-REC-NOT-FND
 10915         DEPENDING ON DFHEIGDI
 10916     ELSE IF DFHEIGDJ EQUAL 12
 10917         GO TO 4610-END-OF-FILE
 10918         DEPENDING ON DFHEIGDI
 10919     ELSE IF DFHEIGDJ EQUAL 13
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 223
* EL640.cbl
 10920         GO TO 6070-NO-COMP-MSTR,
 10921               6080-COMP-FILE-NOTOPEN
 10922         DEPENDING ON DFHEIGDI
 10923     ELSE IF DFHEIGDJ EQUAL 14
 10924         GO TO 6045-NO-COMP-MSTR,
 10925               6045-COMP-FILE-NOTOPEN
 10926         DEPENDING ON DFHEIGDI
 10927     ELSE IF DFHEIGDJ EQUAL 15
 10928         GO TO 6110-NO-RECORD
 10929         DEPENDING ON DFHEIGDI
 10930     ELSE IF DFHEIGDJ EQUAL 16
 10931         GO TO 7620-LETR-NOT-FOUND,
 10932               7620-LETR-NOT-FOUND,
 10933               7620-LETR-NOT-OPEN
 10934         DEPENDING ON DFHEIGDI
 10935     ELSE IF DFHEIGDJ EQUAL 17
 10936         GO TO 8300-SEND-TEXT
 10937         DEPENDING ON DFHEIGDI.
 10938     MOVE '9%                    "   ' TO DFHEIV0
 10939     MOVE 'EL640' TO DFHEIV1
 10940     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10941     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8580     Code:       34585
