* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page   1
* EL050.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL050.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page   2
* EL050.cbl
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39******************************************************************
    40 ENVIRONMENT DIVISION.
    41
    42 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page   3
* EL050.cbl
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46
    47 77  FILLER   PIC X(32) VALUE '********************************'.
    48 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    49 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    50
    51 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    52 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    53                                   USAGE POINTER.
    54 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    55 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    56 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    57                                   USAGE IS POINTER.
    58 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    59 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    60                                   USAGE IS POINTER.
    61 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    62 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    63                                   USAGE IS POINTER.
    64
    65 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    66 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    67                                   USAGE IS POINTER.
    68
    69*    COPY ELC50WS.
    70*****************************************************************
    71*                                                               *
    72*                            ELC50WS.                           *
    73*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    74*                            VMOD=2.061.                        *
    75*                                                               *
    76*   THIS IS THE WORKING STORAGE FOR EL050                       *
    77*                                   EL517                       *
    78*****************************************************************
    79******************************************************************
    80*                   C H A N G E   L O G
    81*
    82* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    83*-----------------------------------------------------------------
    84*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    85* EFFECTIVE    NUMBER
    86*-----------------------------------------------------------------
    87* 123102                   PEMA  ADD DCC PROCESSING
    88* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    89* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    90* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    91* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    92* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    93* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
    94* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
    95* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
    96* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
    97* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    98* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
    99* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   100* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   101* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page   4
* EL050.cbl
   102* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   103* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   104* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   105* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   106* 030309  CR2009021700001  PEMA  ADD ER-2883
   107* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   108* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   109* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   110* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   111* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   112* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   113* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   114* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   115* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   116* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   117* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   118* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   119*-----------------------------------------------------------------
   120
   121 01  WORK-AREAS.
   122
   123*****************************************************************
   124*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   125*****************************************************************
   126
   127     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   128     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   129     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   130     12  WS-NAME-EDIT-WORK-AREA.
   131         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   132         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   133             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   134         16  WS-WORK-NAME.
   135             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   136             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   137             20  FILLER           PIC X(10)     VALUE SPACES.
   138         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   139             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   140
   141*****************************************************************
   142*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   143*****************************************************************
   144
   145     12  WS-ERRESC-KEY.
   146         16 WS-ERRESC-SEARCH-KEY.
   147             20  WS-ERRESC-COMPANY-CD PIC  X.
   148             20  WS-ERRESC-CARRIER    PIC  X.
   149             20  WS-ERRESC-GROUP      PIC X(6).
   150             20  WS-ERRESC-STATE      PIC XX.
   151             20  WS-ERRESC-ACCOUNT    PIC X(10).
   152         16 WS-ERRESC-RESIDUAL-KEY.
   153             20  WS-ERRESC-AGENT      PIC X(10).
   154             20  WS-ERRESC-RES-STATE  PIC XX.
   155             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   156*                                          YYYYMMDD
   157     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   158     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   159
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page   5
* EL050.cbl
   160*RESIDENT STATE TAX MASTER(ERRESS)
   161*
   162     12  WS-ERRESS-KEY.
   163         16  WS-ERRESS-COMPANY-CD      PIC  X.
   164         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   165         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   166         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   167*                                          YYYYMMDD
   168
   169     12  WS-CONTRACT-DATE              PIC 9(8).
   170*                                          YYYYMMDD
   171     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   172     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   173         16 WS-YEAR-YY                 PIC   9999.
   174         16 FILLER                     PIC 9(4).
   175*                                          YYYYMMDD
   176     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   177     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   178     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   179     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   180
   181     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   182         88  DPRB-1ST-TIME                      VALUE ' '.
   183
   184*****************************************************************
   185*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   186*****************************************************************
   187
   188     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   189     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   190     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   191     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   192     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   193     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   194     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   195     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   196     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   197     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   198         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   199         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   200     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   201         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   202         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   203     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   204
   205     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   206     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   207
   208     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   209     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   210     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   211     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   212     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   213     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   214     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   215     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   216     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   217     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page   6
* EL050.cbl
   218     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   219     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   220     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   221     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   222     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   223     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   224     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   225     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   228     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   229     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   230     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   231     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   232     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   233     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   239     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   240     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   241     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   242     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   244     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   245     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   246     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   247     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   248     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   249     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   250     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   251     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   252     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   253     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   254     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   255     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   256     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   257     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   258     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   259     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   260     12  WS-2671-SW               PIC X         VALUE SPACE.
   261     12  WS-2672-SW               PIC X         VALUE SPACE.
   262     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   263         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   264     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   265         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   266     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   267
   268     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   269         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   270         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   271         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   272         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   273
   274     12  WS-CREDIT-EDIT-CONTROLS.
   275         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page   7
* EL050.cbl
   276         16  WS-MIN-AGE           PIC 99                VALUE  0.
   277         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   278         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   279         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   280         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   281
   282     12  WS-SAVE-ALLOWABLE-BENEFIT.
   283         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   284         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   285         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   286         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   287         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   288         16  FILLER                      PIC XX.
   289
   290     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   291     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   292     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   293     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   294     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   295     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   296     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   297     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   298     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   299     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   300
   301     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   302     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   303     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   304     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   305     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   306     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   307     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   308     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   309         88  WS-REDUCING              VALUE 'R'.
   310         88  WS-LEVEL                 VALUE 'L' 'P'.
   311     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   312
   313     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   314     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   315     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   316     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   317     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   318     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   319     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   320     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   321     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   322
   323     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   324     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   325     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   326     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   327     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   328     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   329     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   330     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   331     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   332     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   333     12  WS-ACCT-SIG-SW.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page   8
* EL050.cbl
   334         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   335         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   336     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   337     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   338     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   339     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   340     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   341     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   342     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   343     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   344     12  WS-INITIALS.
   345         16  WS-INIT-1            PIC X         VALUE SPACES.
   346         16  WS-INIT-2            PIC X         VALUE SPACES.
   347
   348     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   349     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   350     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   351     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   352     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   353*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   354     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   355     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   356     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   357     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   358     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   359     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   360     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   361     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   362     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   363     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   364     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   365     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   366     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   367     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   368     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   369     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   370     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   371     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   372     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   373     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   374     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   375     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   376******** FLA
   377     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   378     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   379     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   380     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   381     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   382********
   383     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   384     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   385     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   386     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   387     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   388     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   389     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   390     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   391     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page   9
* EL050.cbl
   392     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   393
   394     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   395         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   396                                         '0' THRU '9'.
   397
   398     12  NUMBER-OF-MONTHS.
   399         16  SK-MO OCCURS 12 TIMES PIC X.
   400
   401     12  WS-WORK-DATE.
   402         16  WS-YEAR            PIC 99    VALUE 00.
   403         16  WS-MONTH           PIC 99    VALUE 00.
   404         16  WS-DAY             PIC 99    VALUE 00.
   405
   406     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   407     12  WS-WORK-CRIT-DEV       REDEFINES
   408         WS-WORK-LF-CRIT-PER    PIC X(03).
   409
   410     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   411     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   412
   413     12  WS-WORK-DATE-FROM.
   414         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   415         16  FILLER             PIC X  VALUE SPACE.
   416         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   417         16  FILLER             PIC X         VALUE SPACE.
   418         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   419
   420     12  WS-WORK-DATE-THRU.
   421         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   422         16  FILLER             PIC X         VALUE SPACE.
   423         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   424         16  FILLER             PIC X         VALUE SPACE.
   425         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   426
   427     12  WS-LF-INPUT-CD.
   428         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   429         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   430
   431     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   432     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   433         16  WS-AH-INPUT-CD-1   PIC X.
   434         16  WS-AH-INPUT-CD-2-3 PIC XX.
   435
   436     12  WS-SWITCHES.
   437         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   438         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   439             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   440         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   441             88  BANK-ACCT-FOUND          VALUE 'Y'.
   442         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   443             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   444         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   445             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   446         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   447             88  COMP-MASTER-FOUND        VALUE 'Y'.
   448         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   449             88  LOFC-MASTER-FOUND        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  10
* EL050.cbl
   450         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   451             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   452         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   453             88  STAT-MASTER-FOUND        VALUE 'Y'.
   454         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   455             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   456         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   457             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   458         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   459             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   460         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   461             88  FORM-MASTER-FOUND        VALUE 'Y'.
   462         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   463             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   464         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   465             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   466         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   467             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   468         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   469             88  NO-BENEFIT-FOUND         VALUE 'N'.
   470         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   471             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   472         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   473             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   474         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   475             88  AH-BENEFIT-FOUND         VALUE ' '.
   476             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   477         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   478             88  LF-BENEFIT-FOUND         VALUE ' '.
   479             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   480         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   481             88  NO-STATE-RECORD          VALUE '1'.
   482         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   483             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   484         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   485             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   486         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   487             88  CERT-WAS-FOUND           VALUE ' '.
   488             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   489         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   490             88  BROWSE-STARTED           VALUE 'Y'.
   491         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   492             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   493         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   494             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   495         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   496             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   497         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   498             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   499         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   500             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   501         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   502             88  APP-CERT-USED            VALUE 'Y' 'A'.
   503         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   504             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   505             88  FIRST-TIME-THROUGH       VALUE '1'.
   506             88  CTBL-NOT-FOUND           VALUE '2'.
   507
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  11
* EL050.cbl
   508         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   509             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   510
   511         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   512             88  DLO-ERROR-FOUND          VALUE 'Y'.
   513
   514********FLA
   515     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   516     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   517********
   518     12  RC-SW-1                  PIC X           VALUE '0'.
   519     12  RC-SW-2                  PIC X           VALUE '0'.
   520     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   521     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   522     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   523     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   524     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   525     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   526     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   527     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   528     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   529     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   530     12  LIT-SPACES               PIC X           VALUE SPACES.
   531     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   532     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   533     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   534     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   535     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   536     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   537     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   538         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   539         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   540     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   541         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   542
   543 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   544     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   545     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   546 01  WS-CRI-SSN-WORK-AREA.
   547     05  WS-CRI-SOC-SEC-NO.
   548         10  WS-SS-REPT-CD       PIC X(5).
   549         10  WS-SS-LAST-NAME     PIC X(5).
   550         10  WS-SS-INITIAL       PIC X.
   551
   552     05  WS-CRI-REPORT-CODE.
   553         10  FILLER              PIC X(5).
   554         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   555
   556     05  WS-CRI-LAST-NAME.
   557         10  WS-CRI-NAME-MOVE    PIC X(5).
   558         10  FILLER              PIC X(10).
   559
   560 01  WS-NUM-TABLE                PIC X(26)  VALUE
   561     '12345678012345070923456789'.
   562 01  FILLER REDEFINES WS-NUM-TABLE.
   563     05  WS-NUM OCCURS 26        PIC 9.
   564 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   565 01  V1                          PIC S999 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  12
* EL050.cbl
   566 01  V2                          PIC S999 COMP-3.
   567 01  V3                          PIC S999 COMP-3.
   568 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   569 01  FILLER REDEFINES WS-WORK-VIN.
   570     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   571 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   572 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   573 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   574 01  WS-HEX-WORK.
   575     05  FILLER                  PIC X  VALUE LOW-VALUES.
   576     05  WS-HEX-BYTE             PIC X.
   577 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   578 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   579 01  WS-WORK-HIN-ROW-B.
   580     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   581
   582 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   583 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   584     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   585 01  WS-ROW-D-TABLE.
   586     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   587
   588 01  WS-HIN-TABLE-B.
   589     05  F                       PIC XX VALUE 'A2'.
   590     05  F                       PIC XX VALUE 'B3'.
   591     05  F                       PIC XX VALUE 'C4'.
   592     05  F                       PIC XX VALUE 'D5'.
   593     05  F                       PIC XX VALUE 'E6'.
   594     05  F                       PIC XX VALUE 'F7'.
   595     05  F                       PIC XX VALUE 'G8'.
   596     05  F                       PIC XX VALUE 'H9'.
   597     05  F                       PIC XX VALUE 'I1'.
   598     05  F                       PIC XX VALUE 'J2'.
   599     05  F                       PIC XX VALUE 'K3'.
   600     05  F                       PIC XX VALUE 'L4'.
   601     05  F                       PIC XX VALUE 'M5'.
   602     05  F                       PIC XX VALUE 'N6'.
   603     05  F                       PIC XX VALUE 'O0'.
   604     05  F                       PIC XX VALUE 'P7'.
   605     05  F                       PIC XX VALUE 'Q0'.
   606     05  F                       PIC XX VALUE 'R8'.
   607     05  F                       PIC XX VALUE 'S9'.
   608     05  F                       PIC XX VALUE 'T2'.
   609     05  F                       PIC XX VALUE 'U3'.
   610     05  F                       PIC XX VALUE 'V4'.
   611     05  F                       PIC XX VALUE 'W5'.
   612     05  F                       PIC XX VALUE 'X6'.
   613     05  F                       PIC XX VALUE 'Y7'.
   614     05  F                       PIC XX VALUE 'Z8'.
   615 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   616     05  WS-VAL-IN               PIC X.
   617     05  WS-VAL-OUT              PIC 9.
   618 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   619 01  WS-COMPARE-BINARY-DATES.
   620     05  WS-971231                PIC XX VALUE X'92FF'.
   621     05  WS-931231                PIC XX VALUE X'8CFF'.
   622     05  WS-791231                PIC XX VALUE X'77FF'.
   623     05  WS-771001                PIC XX VALUE X'74A1'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  13
* EL050.cbl
   624     05  WS-820301                PIC XX VALUE X'7B41'.
   625     05  WS-831031                PIC XX VALUE X'7DBF'.
   626     05  WS-831231                PIC XX VALUE X'7DFF'.
   627     05  WS-810831                PIC XX VALUE X'7A7F'.
   628     05  WS-830901                PIC XX VALUE X'7D81'.
   629
   630 01  FILE-ACCESS-IDS.
   631     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   632     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   633     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   634     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   635     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   636     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   637     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   638     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   639     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   640     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   641     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   642     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   643     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   644     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   645     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   646     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   647     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   648 01  DD-IU-SW                    PIC X   VALUE ' '.
   649     88  DD-IU-PRESENT                 VALUE 'Y'.
   650
   651 01  ACCESS-KEYS.
   652     12  ELMSTR-KEY.
   653         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   654         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   655     12  W-CLAIM-KEY.
   656         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   657         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   658
   659     12  ELCNTL-KEY.
   660         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   661         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   662         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   663         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   664
   665     12  ELCERT-KEY.
   666         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   667         16  CERT-CARRIER         PIC X       VALUE SPACE.
   668         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   669         16  CERT-STATE           PIC XX      VALUE SPACES.
   670         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   671         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   672         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   673
   674     12  ELCERT2-KEY.
   675         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   676         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   677
   678     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   679
   680     12  ELCERT-SAVE.
   681         16  FILLER                      PIC XX    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  14
* EL050.cbl
   682
   683         16  WCS-CONTROL-PRIMARY.
   684             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   685             20  WCS-CARRIER             PIC X     VALUE SPACE.
   686             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   687             20  WCS-STATE               PIC XX    VALUE SPACES.
   688             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   689             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   690             20  WCS-CERT-NO.
   691                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   692                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   693
   694         16  CS-CONTROL-BY-NAME.
   695             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   696             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   697             20  CS-INSURED-INITIALS.
   698                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   699                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   700
   701         16  CS-CONTROL-BY-SSN.
   702             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   703             20  CS-SOC-SEC-NO.
   704                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   705                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   706                 24  CS-SSN-LN3.
   707                     28 CS-INSURED-INITIALS-A2   PIC XX
   708                                     VALUE SPACES.
   709                     28 CS-PART-LAST-NAME-A2     PIC X
   710                                     VALUE SPACE.
   711
   712         16  CS-CONTROL-BY-CERT-NO.
   713             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   714             20  CS-CERT-NO-A4           PIC X(11)
   715                                     VALUE SPACES.
   716
   717         16  CS-CONTROL-BY-MEMB.
   718             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   719             20  CS-MEMBER-NO.
   720                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   721                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   722                 24  CS-MEMB-LN4.
   723                     28 CS-INSURED-INITIALS-A5   PIC XX
   724                                      VALUE SPACES.
   725                     28 CS-PART-LAST-NAME-A5     PIC XX
   726                                      VALUE SPACES.
   727
   728         16  FILLER              PIC X(360) VALUE SPACES.
   729
   730     12  ERACCT-KEY.
   731         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   732         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   733         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   734         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   735         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   736         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   737
   738     12  ERCOMP-KEY.
   739         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  15
* EL050.cbl
   740         16  COMP-CARRIER         PIC X     VALUE SPACES.
   741         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   742         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   743         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   744         16  COMP-TYPE            PIC X     VALUE SPACES.
   745
   746     12  ERLOFC-KEY.
   747         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   748         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   749         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   750         16  LOFC-STATE           PIC XX    VALUE SPACES.
   751         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   752         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   753
   754     12  WS-ELCRTT-KEY.
   755         16  WS-ELCRTT-PRIMARY       PIC X(33).
   756         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   757
   758     12  ERBXRF-KEY.
   759         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   760         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   761         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   762         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   763
   764     12  ERAGTC-KEY.
   765         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   766         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   767         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   768         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   769         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   770         16  AGTC-TYPE            PIC X     VALUE SPACES.
   771
   772     12  ERPLAN-KEY.
   773         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   774         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   775         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   776         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   777         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   778         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   779         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   780         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   781
   782     12  ERFORM-KEY.
   783         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   784         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   785         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   786         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   787
   788     12  ERREIN-KEY.
   789         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   790         16  REIN-TYPE            PIC X     VALUE SPACES.
   791         16  REIN-TABLE-CO.
   792             20  REIN-CODE-1      PIC X     VALUE SPACE.
   793             20  REIN-CODE-2      PIC X     VALUE SPACE.
   794             20  REIN-CODE-3      PIC X     VALUE SPACE.
   795         16  FILLER               PIC X(3)  VALUE SPACES.
   796
   797     12  ERCTBL-KEY.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  16
* EL050.cbl
   798         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   799         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   800         16  CTBL-CNTRL-2.
   801             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   802             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   803
   804     12  WS-ACCESS.
   805         16  FILLER               PIC XX    VALUE SPACES.
   806         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   807
   808     12  WS-CARR-ACCESS.
   809         16  FILLER               PIC X(3)  VALUE SPACES.
   810         16  WS-CARR              PIC X     VALUE SPACE.
   811*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   812*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   813     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   814         88  WS-DMD-LF-RATING   VALUE 'Y'.
   815         88  WS-DMD-AH-RATING   VALUE 'Y'.
   816         88  WS-DMD-NO-RATING   VALUE 'N'.
   817
   818     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   819         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   820                                         'NJ' 'NL'
   821                                         'PJ' 'PL'
   822                                         'SJ' 'SL'.
   823     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   824         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   825                                         'NI' 'NJ' 'NL' 'NU'
   826                                         'PJ' 'PL' 'PI' 'PU'
   827                                         'SI' 'SJ' 'SL' 'SU'
   828                                         'MX' 'MY' 'MZ'.
   829 01  ERPDEF-KEY-SAVE             PIC X(18).
   830 01  ERPDEF-KEY.
   831     12  ERPDEF-COMPANY-CD       PIC X.
   832     12  ERPDEF-STATE            PIC XX.
   833     12  ERPDEF-PROD-CD          PIC XXX.
   834     12  F                       PIC X(7).
   835     12  ERPDEF-BEN-TYPE         PIC X.
   836     12  ERPDEF-BEN-CODE         PIC XX.
   837     12  ERPDEF-EXP-DT           PIC XX.
   838
   839 01  ELSTAT-KEY-SAVE             PIC X(20).
   840 01  ELSTAT-KEY.
   841     12  ELSTAT-COMPANY-ID       PIC XXX.
   842     12  ELSTAT-CARRIER          PIC X.
   843     12  ELSTAT-GROUP            PIC X(6).
   844     12  ELSTAT-STATE            PIC XX.
   845     12  ELSTAT-EXP-DT           PIC 9(8).
   846 01  WS-ERROR-VALUES.
   847     12  ER-1570                     PIC S9(4)   VALUE +1570.
   848     12  ER-1571                     PIC S9(4)   VALUE +1571.
   849     12  ER-1575                     PIC S9(4)   VALUE +1575.
   850     12  ER-1891                     PIC S9(4)   VALUE +1891.
   851     12  ER-1892                     PIC S9(4)   VALUE +1892.
   852     12  ER-1893                     PIC S9(4)   VALUE +1893.
   853     12  ER-1894                     PIC S9(4)   VALUE +1894.
   854     12  ER-1895                     PIC S9(4)   VALUE +1895.
   855     12  ER-1896                     PIC S9(4)   VALUE +1896.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  17
* EL050.cbl
   856     12  ER-1897                     PIC S9(4)   VALUE +1897.
   857     12  ER-1898                     PIC S9(4)   VALUE +1898.
   858     12  ER-1899                     PIC S9(4)   VALUE +1899.
   859     12  ER-1900                     PIC S9(4)   VALUE +1900.
   860     12  ER-1901                     PIC S9(4)   VALUE +1901.
   861     12  ER-1902                     PIC S9(4)   VALUE +1902.
   862     12  ER-1903                     PIC S9(4)   VALUE +1903.
   863     12  ER-1904                     PIC S9(4)   VALUE +1904.
   864     12  ER-1905                     PIC S9(4)   VALUE +1905.
   865     12  ER-1906                     PIC S9(4)   VALUE +1906.
   866     12  ER-1907                     PIC S9(4)   VALUE +1907.
   867     12  ER-1909                     PIC S9(4)   VALUE +1909.
   868     12  ER-1910                     PIC S9(4)   VALUE +1910.
   869     12  ER-1911                     PIC S9(4)   VALUE +1911.
   870     12  ER-1912                     PIC S9(4)   VALUE +1912.
   871     12  ER-1913                     PIC S9(4)   VALUE +1913.
   872     12  ER-1914                     PIC S9(4)   VALUE +1914.
   873     12  ER-1915                     PIC S9(4)   VALUE +1915.
   874     12  ER-1916                     PIC S9(4)   VALUE +1916.
   875     12  ER-1917                     PIC S9(4)   VALUE +1917.
   876     12  ER-1918                     PIC S9(4)   VALUE +1918.
   877     12  ER-1919                     PIC S9(4)   VALUE +1919.
   878     12  ER-1920                     PIC S9(4)   VALUE +1920.
   879     12  ER-1921                     PIC S9(4)   VALUE +1921.
   880     12  ER-1922                     PIC S9(4)   VALUE +1922.
   881     12  ER-1923                     PIC S9(4)   VALUE +1923.
   882     12  ER-1924                     PIC S9(4)   VALUE +1924.
   883     12  ER-1925                     PIC S9(4)   VALUE +1925.
   884     12  ER-1926                     PIC S9(4)   VALUE +1926.
   885     12  ER-1927                     PIC S9(4)   VALUE +1927.
   886     12  ER-2393                     PIC S9(4)   VALUE +2393.
   887     12  ER-2600                     PIC S9(4)   VALUE +2600.
   888     12  ER-2601                     PIC S9(4)   VALUE +2601.
   889     12  ER-2602                     PIC S9(4)   VALUE +2602.
   890     12  ER-2603                     PIC S9(4)   VALUE +2603.
   891     12  ER-2604                     PIC S9(4)   VALUE +2604.
   892     12  ER-2605                     PIC S9(4)   VALUE +2605.
   893     12  ER-2606                     PIC S9(4)   VALUE +2606.
   894     12  ER-2607                     PIC S9(4)   VALUE +2607.
   895     12  ER-2608                     PIC S9(4)   VALUE +2608.
   896     12  ER-2609                     PIC S9(4)   VALUE +2609.
   897     12  ER-2610                     PIC S9(4)   VALUE +2610.
   898     12  ER-2611                     PIC S9(4)   VALUE +2611.
   899     12  ER-2612                     PIC S9(4)   VALUE +2612.
   900     12  ER-2613                     PIC S9(4)   VALUE +2613.
   901     12  ER-2614                     PIC S9(4)   VALUE +2614.
   902     12  ER-2615                     PIC S9(4)   VALUE +2615.
   903     12  ER-2616                     PIC S9(4)   VALUE +2616.
   904     12  ER-2617                     PIC S9(4)   VALUE +2617.
   905     12  ER-2618                     PIC S9(4)   VALUE +2618.
   906     12  ER-2619                     PIC S9(4)   VALUE +2619.
   907     12  ER-2620                     PIC S9(4)   VALUE +2620.
   908     12  ER-2621                     PIC S9(4)   VALUE +2621.
   909     12  ER-2622                     PIC S9(4)   VALUE +2622.
   910     12  ER-2623                     PIC S9(4)   VALUE +2623.
   911     12  ER-2624                     PIC S9(4)   VALUE +2624.
   912     12  ER-2625                     PIC S9(4)   VALUE +2625.
   913     12  ER-2626                     PIC S9(4)   VALUE +2626.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  18
* EL050.cbl
   914     12  ER-2627                     PIC S9(4)   VALUE +2627.
   915     12  ER-2628                     PIC S9(4)   VALUE +2628.
   916     12  ER-2629                     PIC S9(4)   VALUE +2629.
   917     12  ER-2630                     PIC S9(4)   VALUE +2630.
   918     12  ER-2631                     PIC S9(4)   VALUE +2631.
   919     12  ER-2632                     PIC S9(4)   VALUE +2632.
   920     12  ER-2633                     PIC S9(4)   VALUE +2633.
   921     12  ER-2634                     PIC S9(4)   VALUE +2634.
   922     12  ER-2635                     PIC S9(4)   VALUE +2635.
   923     12  ER-2636                     PIC S9(4)   VALUE +2636.
   924     12  ER-2637                     PIC S9(4)   VALUE +2637.
   925     12  ER-2638                     PIC S9(4)   VALUE +2638.
   926     12  ER-2639                     PIC S9(4)   VALUE +2639.
   927     12  ER-2640                     PIC S9(4)   VALUE +2640.
   928     12  ER-2641                     PIC S9(4)   VALUE +2641.
   929     12  ER-2642                     PIC S9(4)   VALUE +2642.
   930     12  ER-2643                     PIC S9(4)   VALUE +2643.
   931     12  ER-2644                     PIC S9(4)   VALUE +2644.
   932     12  ER-2645                     PIC S9(4)   VALUE +2645.
   933     12  ER-2646                     PIC S9(4)   VALUE +2646.
   934     12  ER-2647                     PIC S9(4)   VALUE +2647.
   935     12  ER-2648                     PIC S9(4)   VALUE +2648.
   936     12  ER-2649                     PIC S9(4)   VALUE +2649.
   937     12  ER-2650                     PIC S9(4)   VALUE +2650.
   938     12  ER-2651                     PIC S9(4)   VALUE +2651.
   939     12  ER-2652                     PIC S9(4)   VALUE +2652.
   940     12  ER-2653                     PIC S9(4)   VALUE +2653.
   941     12  ER-2654                     PIC S9(4)   VALUE +2654.
   942     12  ER-2655                     PIC S9(4)   VALUE +2655.
   943     12  ER-2656                     PIC S9(4)   VALUE +2656.
   944     12  ER-2657                     PIC S9(4)   VALUE +2657.
   945     12  ER-2658                     PIC S9(4)   VALUE +2658.
   946     12  ER-2659                     PIC S9(4)   VALUE +2659.
   947     12  ER-2660                     PIC S9(4)   VALUE +2660.
   948     12  ER-2661                     PIC S9(4)   VALUE +2661.
   949     12  ER-2662                     PIC S9(4)   VALUE +2662.
   950     12  ER-2663                     PIC S9(4)   VALUE +2663.
   951     12  ER-2664                     PIC S9(4)   VALUE +2664.
   952     12  ER-2665                     PIC S9(4)   VALUE +2665.
   953     12  ER-2666                     PIC S9(4)   VALUE +2666.
   954     12  ER-2667                     PIC S9(4)   VALUE +2667.
   955     12  ER-2668                     PIC S9(4)   VALUE +2668.
   956     12  ER-2669                     PIC S9(4)   VALUE +2669.
   957     12  ER-2670                     PIC S9(4)   VALUE +2670.
   958     12  ER-2671                     PIC S9(4)   VALUE +2671.
   959     12  ER-2672                     PIC S9(4)   VALUE +2672.
   960     12  ER-2673                     PIC S9(4)   VALUE +2673.
   961     12  ER-2674                     PIC S9(4)   VALUE +2674.
   962     12  ER-2675                     PIC S9(4)   VALUE +2675.
   963     12  ER-2676                     PIC S9(4)   VALUE +2676.
   964     12  ER-2677                     PIC S9(4)   VALUE +2677.
   965     12  ER-2678                     PIC S9(4)   VALUE +2678.
   966     12  ER-2679                     PIC S9(4)   VALUE +2679.
   967     12  ER-2680                     PIC S9(4)   VALUE +2680.
   968     12  ER-2681                     PIC S9(4)   VALUE +2681.
   969     12  ER-2682                     PIC S9(4)   VALUE +2682.
   970     12  ER-2683                     PIC S9(4)   VALUE +2683.
   971     12  ER-2684                     PIC S9(4)   VALUE +2684.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  19
* EL050.cbl
   972     12  ER-2685                     PIC S9(4)   VALUE +2685.
   973     12  ER-2686                     PIC S9(4)   VALUE +2686.
   974     12  ER-2687                     PIC S9(4)   VALUE +2687.
   975     12  ER-2688                     PIC S9(4)   VALUE +2688.
   976     12  ER-2689                     PIC S9(4)   VALUE +2689.
   977     12  ER-2690                     PIC S9(4)   VALUE +2690.
   978     12  ER-2691                     PIC S9(4)   VALUE +2691.
   979     12  ER-2692                     PIC S9(4)   VALUE +2692.
   980     12  ER-2693                     PIC S9(4)   VALUE +2693.
   981     12  ER-2694                     PIC S9(4)   VALUE +2694.
   982     12  ER-2695                     PIC S9(4)   VALUE +2695.
   983     12  ER-2696                     PIC S9(4)   VALUE +2696.
   984     12  ER-2697                     PIC S9(4)   VALUE +2697.
   985     12  ER-2698                     PIC S9(4)   VALUE +2698.
   986     12  ER-2699                     PIC S9(4)   VALUE +2699.
   987     12  ER-2700                     PIC S9(4)   VALUE +2700.
   988     12  ER-2701                     PIC S9(4)   VALUE +2701.
   989     12  ER-2702                     PIC S9(4)   VALUE +2702.
   990     12  ER-2703                     PIC S9(4)   VALUE +2703.
   991     12  ER-2704                     PIC S9(4)   VALUE +2704.
   992     12  ER-2707                     PIC S9(4)   VALUE +2707.
   993     12  ER-2720                     PIC S9(4)   VALUE +2720.
   994     12  ER-2709                     PIC S9(4)   VALUE +2709.
   995     12  ER-2717                     PIC S9(4)   VALUE +2717.
   996     12  ER-2718                     PIC S9(4)   VALUE +2718.
   997     12  ER-2719                     PIC S9(4)   VALUE +2719.
   998     12  ER-2721                     PIC S9(4)   VALUE +2721.
   999     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1000     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1001     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1002     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1003     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1004     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1005     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1006     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1007     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1008     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1009     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1010     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1011     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1012     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1013     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1014     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1015     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1016     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1017     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1018     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1019     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1020     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1021     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1022     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1023     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1024     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1025     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1026     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1027     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1028     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1029     12  ER-2752                     PIC S9(4)   VALUE +2752.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  20
* EL050.cbl
  1030     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1031     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1032     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1033     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1034     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1035     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1036     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1037     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1038     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1039     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1040     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1041     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1042     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1043     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1044     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1045     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1046     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1047     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1048     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1049     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1050     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1051     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1052     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1053     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1054     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1055     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1056     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1057     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1058     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1059     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1060     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1061     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1062     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1063     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1064     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1065     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1066     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1067     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1068     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1069     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1070     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1071     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1072     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1073     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1074     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1075     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1076     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1077     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1078     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1079     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1080     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1081     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1082     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1083     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1084     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1085     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1086     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1087     12  ER-2964                     PIC S9(4)   VALUE +2964.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  21
* EL050.cbl
  1088     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1089     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1090     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1091     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1092     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1093     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1094     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1095     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1096     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1097     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1098     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1099     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1100     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1101     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1102     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1103     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1104     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1105     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1106     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1107     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1108     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1109     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1110     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1111     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1112     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1113     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1114     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1115     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1116     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1117     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1118     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1119     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1120     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1121     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1122     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1123     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1124     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1125     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1126     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1127     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1128     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1129     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1130     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1131     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1132     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1133     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1134     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1135     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1136     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1137     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1138     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1139     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1140     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1141     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1142     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1143     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1144     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1145     12  ER-8085                     PIC S9(4)   VALUE +8085.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  22
* EL050.cbl
  1146     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1147     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1148     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1149     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1150     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1151     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1152     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1153     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1154     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1155     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1156     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1157     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1158     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1159     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1160     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1161     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1162     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1163     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1164     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1165     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1166     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1167     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1168     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1169     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1170     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1171     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1172     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1173     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1174     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1175     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1176     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1177     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1178     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1179     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1180     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1181     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1182     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1183     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1184     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1185     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1186     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1187******************************************************************
  1188***************   END OF ELC50WS     ****************************
  1189******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  23
* EL050.cbl
  1192 01  WORKING-STORAGE-WORK-AREAS.
  1193     12  WS-RESPONSE             PIC S9(8)  COMP.
  1194         88  WS-RESP-NORMAL           VALUE +00.
  1195         88  WS-RESP-ERROR            VALUE +01.
  1196         88  WS-RESP-NOTFND           VALUE +13.
  1197         88  WS-RESP-DUPREC           VALUE +14.
  1198         88  WS-RESP-ENDFILE          VALUE +20.
  1199     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1200     12  WORK-AREAS.
  1201         16  WK-CONV-GREG.
  1202             24  WCG-CENT             PIC XX.
  1203             24  WCG-REST             PIC X(4).
  1204         16  WORK-GREGORIAN-DATE.
  1205             24  WK-GREG-CENT         PIC XX.
  1206             24  WK-GREG-DATE-YYMMDD.
  1207                 28  WK-GREG-YYMM     PIC X(4).
  1208                 28  WK-GREG-DD       PIC XX.
  1209
  1210         16  WORK-SELECT-DATE.
  1211             24  WK-SELECT-CENT            PIC XX.
  1212             24  WK-SELECT-DATE-YYMMDD.
  1213                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1214                 28  FILLER                PIC XX.
  1215
  1216         16  WK-FORM-NO.
  1217             24  WK-FORM-BANK-ID       PIC X(5).
  1218             24  WK-FORM-UNDRWRTR      PIC X(1).
  1219             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1220
  1221         16  WK-MEMBER-NO.
  1222             24  WK-MEMBER-1-6        PIC X(6).
  1223             24  WK-MEMBER-7-12       PIC X(6).
  1224
  1225         16  WK-FULL-CERT-NO.
  1226             24  WK-CERT-POS-1-2      PIC X(2).
  1227             24  WK-CERT-POS-3        PIC X(1).
  1228             24  WK-CERT-POS-4        PIC X(1).
  1229             24  WK-CERT-POS-5-6      PIC X(2).
  1230             24  WK-CERT-POS-7        PIC X(1).
  1231             24  WK-CERT-POS-8-11     PIC X(4).
  1232
  1233         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1234             88  VALID-RATE-CODE        VALUE 'Y'.
  1235             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1236
  1237         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1238         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1239         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1240         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1241         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1242         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1243         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1244         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1245         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1246         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1247
  1248* DLO001
  1249 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  24
* EL050.cbl
  1250     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1251     12  DMPF-RETURN-CODE          PIC XX.
  1252         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1253         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1254         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1255         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1256         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1257         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1258
  1259* DLO002
  1260 01  WS-DLO-INTERNAL-POLICY-FORM.
  1261     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1262     12  DIPF-RETURN-CODE          PIC XX.
  1263         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1264         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1265         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1266         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1267         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1268         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1269
  1270* DLO003
  1271 01  WS-DLO-VALID-BANK-ID.
  1272     12  DVBI-BANK-ID              PIC X(5).
  1273     12  DVBI-BANK-ID-TYPE         PIC X.
  1274         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1275         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1276         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1277         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1278         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1279     12  DVBI-RETURN-CODE          PIC XX.
  1280         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1281         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1282         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1283         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1284         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1285         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1286         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1287         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1288         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1289
  1290* DLO007
  1291 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1292     12  DCUA-RES-STATE            PIC XX.
  1293     12  DCUA-BEN-TYPE             PIC XX.
  1294     12  DCUA-SYS-IDENT            PIC X.
  1295         88  DCUA-CLAIM                        VALUE 'C'.
  1296         88  DCUA-PREMIUM                      VALUE 'P'.
  1297     12  DCUA-COVERAGE-RULE        PIC X.
  1298     12  DCUA-CLIENT-ID            PIC X(10).
  1299     12  DCUA-EFF-DATE             PIC X(8).
  1300     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1301     12  DCUA-RETURN-CODE          PIC XX.
  1302         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1303     12  DCUA-CERT-NUMBER          PIC X(11).
  1304     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1305     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1306
  1307* DLO011
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  25
* EL050.cbl
  1308 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1309     12  DPRB-RATE-CODE            PIC X(4).
  1310     12  DPRB-COVERAGE-CATEG       PIC X.
  1311     12  DPRB-RETURN-CODE          PIC XX.
  1312         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1313         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1314         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1315         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1316         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1317         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1318         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1319         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1320         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1321     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1322     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1323     12  DPRB-BEN-TYPE             PIC XX.
  1324
  1325* DLO017
  1326 01  WS-DLO-VALID-RATE-CODE.
  1327     12  DVRC-RATE-CODE            PIC X(4).
  1328     12  DVRC-RETURN-CODE          PIC XX.
  1329         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1330         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1331         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1332         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1333         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1334         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1335
  1336* DLO019
  1337 01  WS-DLO-ORIG-COV-CAT.
  1338     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1339     12  DOCC-RETURN-CODE          PIC XX.
  1340     12  DOCC-ORIG-COV-CAT         PIC X.
  1341     12  DOCC-UNDERWITER           PIC XX.
  1342     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1343     12  DOCC-FILLER               PIC X(6).
  1344
  1345* DLO021
  1346 01  WS-DLO-VALID-LOAN-OFFICER.
  1347     12  DVLO-LOAN-OFFICER.
  1348         16  DVLO-BILL-TYPE        PIC X.
  1349         16  DVLO-BILL-SOURCE      PIC X.
  1350         16  DVLO-BATCH-TYPE       PIC X.
  1351     12  DVLO-RETURN-CODE          PIC XX.
  1352         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1353         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1354         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1355         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1356         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1357         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1358
  1359* DLO022
  1360 01  WS-DLO-VALID-STATE-CODE.
  1361     12  DVSC-STATE-CODE           PIC XX.
  1362     12  DVSC-RETURN-CODE          PIC XX.
  1363         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1364
  1365* DLO023
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  26
* EL050.cbl
  1366 01  WS-DLO-VALID-CODE-VALUES.
  1367     12  DVCV-SYSTEM-ID            PIC XX.
  1368         88  DVCV-CLAIMS                       VALUE 'CL'.
  1369         88  DVCV-CREDIT                       VALUE 'CR'.
  1370     12  DVCV-RECORD-TYPE          PIC XX.
  1371         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1372         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1373         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1374         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1375         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1376         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1377         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1378         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1379     12  DVCV-RECORD-KEY           PIC X(6).
  1380     12  DVCV-RETURN-CODE          PIC XX.
  1381         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1382         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1383         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1384         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1385         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1386         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1387         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1388     12  DVCV-CODE-DESC            PIC X(60).
  1389     12  DVCV-GEN-DESC-1           PIC X(20).
  1390     12  DVCV-GEN-DESC-2           PIC X(20).
  1391     12  DVCV-GEN-DESC-3           PIC X(20).
  1392
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  27
* EL050.cbl
  1394*    COPY ERCBXRF.
  1395******************************************************************
  1396*                                                                *
  1397*                                                                *
  1398*                            ERCBXRF                             *
  1399*                                                                *
  1400*   ONLINE CREDIT SYSTEM                                         *
  1401*                                                                *
  1402*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1403*                                                                *
  1404*   FILE TYPE = VSAM,KSDS                                        *
  1405*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1406*                                                                *
  1407*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1408*       ALTERNATE PATH = NONE                                    *
  1409*                                                                *
  1410*   LOG = NO                                                     *
  1411*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1412*                                                                *
  1413******************************************************************
  1414
  1415 01  BANK-CROSS-REFERENCE.
  1416     12  BK-RECORD-ID                PIC XX.
  1417         88  VALID-BK-ID             VALUE 'BK'.
  1418
  1419     12  BK-CONTROL-PRIMARY.
  1420         16  BK-COMPANY-CD           PIC X.
  1421         16  BK-CARRIER              PIC X.
  1422         16  BK-GROUPING             PIC X(6).
  1423         16  BK-BANK-NO              PIC X(10).
  1424
  1425     12  BK-MAINT-INFORMATION.
  1426         16  BK-LAST-MAINT-DT        PIC XX.
  1427         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1428         16  BK-LAST-MAINT-USER      PIC X(4).
  1429         16  FILLER                  PIC X(9).
  1430
  1431     12  FILLER                      PIC X(37).
  1432
  1433     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1434
  1435     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1436                            DEPENDING ON BK-BANK-POINTER-CNT.
  1437         16  BK-AM-ACCOUNT           PIC X(10).
  1438         16  BK-AM-EXP-DT            PIC XX.
  1439         16  BK-AM-EFF-DT            PIC XX.
  1440         16  BK-AM-STATE             PIC XX.
  1441         16  FILLER                  PIC X(20).
  1442
  1443******************************************************************
  1444
  1445*    COPY ERCCOMP.
  1446******************************************************************
  1447*                                                                *
  1448*                                                                *
  1449*                            ERCCOMP                             *
  1450*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1451*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  28
* EL050.cbl
  1452*                                                                *
  1453*   ONLINE CREDIT SYSTEM                                         *
  1454*                                                                *
  1455*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1456*                                                                *
  1457*   FILE TYPE = VSAM,KSDS                                        *
  1458*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1459*                                                                *
  1460*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1461*       ALTERNATE PATH = NONE                                    *
  1462*                                                                *
  1463*   LOG = NO                                                     *
  1464*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1465*                                                                *
  1466******************************************************************
  1467*                   C H A N G E   L O G
  1468*
  1469* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1470*-----------------------------------------------------------------
  1471*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1472* EFFECTIVE    NUMBER
  1473*-----------------------------------------------------------------
  1474* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1475* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1476* 092205    2005050300006  PEMA  ADD LEASE FEE
  1477* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1478* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1479* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1480* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1481* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1482******************************************************************
  1483
  1484 01  COMPENSATION-MASTER.
  1485     12  CO-RECORD-ID                          PIC XX.
  1486         88  VALID-CO-ID                          VALUE 'CO'.
  1487
  1488     12  CO-CONTROL-PRIMARY.
  1489         16  CO-COMPANY-CD                     PIC X.
  1490         16  CO-CONTROL.
  1491             20  CO-CTL-1.
  1492                 24  CO-CARR-GROUP.
  1493                     28  CO-CARRIER            PIC X.
  1494                     28  CO-GROUPING.
  1495                         32  CO-GROUP-PREFIX   PIC XXX.
  1496                         32  CO-GROUP-PRIME    PIC XXX.
  1497                 24  CO-RESP-NO.
  1498                     28  CO-RESP-PREFIX        PIC X(4).
  1499                     28  CO-RESP-PRIME         PIC X(6).
  1500             20  CO-CTL-2.
  1501                 24  CO-ACCOUNT.
  1502                     28  CO-ACCT-PREFIX        PIC X(4).
  1503                     28  CO-ACCT-PRIME         PIC X(6).
  1504         16  CO-TYPE                           PIC X.
  1505             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1506             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1507             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1508
  1509     12  CO-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  29
* EL050.cbl
  1510         16  CO-LAST-MAINT-DT                  PIC XX.
  1511         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1512         16  CO-LAST-MAINT-USER                PIC X(4).
  1513     12  FILLER                                PIC XX.
  1514     12  CO-STMT-TYPE                          PIC XXX.
  1515     12  CO-COMP-TYPE                          PIC X.
  1516         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1517     12  CO-STMT-OWNER                         PIC X(4).
  1518     12  CO-BALANCE-CONTROL                    PIC X.
  1519         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1520         88  CO-NO-BALANCE                        VALUE 'N'.
  1521
  1522     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1523         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1524         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1525         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1526
  1527     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1528         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1529         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1530
  1531     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1532     12  CO-GA-DIRECT-DEP                      PIC X.
  1533     12  CO-FUTURE-SPACE                       PIC X.
  1534         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1535
  1536     12  CO-ACCT-NAME                          PIC X(30).
  1537     12  CO-MAIL-NAME                          PIC X(30).
  1538     12  CO-ADDR-1                             PIC X(30).
  1539     12  CO-ADDR-2                             PIC X(30).
  1540     12  CO-ADDR-3.
  1541         16  CO-ADDR-CITY                      PIC X(27).
  1542         16  CO-ADDR-STATE                     PIC XX.
  1543     12  CO-CSO-1099                           PIC X.
  1544     12  CO-ZIP.
  1545         16  CO-ZIP-PRIME.
  1546             20  CO-ZIP-PRI-1ST                PIC X.
  1547                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1548             20  FILLER                        PIC X(4).
  1549         16  CO-ZIP-PLUS4                      PIC X(4).
  1550     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1551         16  CO-CAN-POSTAL-1                   PIC XXX.
  1552         16  CO-CAN-POSTAL-2                   PIC XXX.
  1553         16  FILLER                            PIC XXX.
  1554     12  CO-SOC-SEC                            PIC X(13).
  1555     12  CO-TELEPHONE.
  1556         16  CO-AREA-CODE                      PIC XXX.
  1557         16  CO-PREFIX                         PIC XXX.
  1558         16  CO-PHONE                          PIC X(4).
  1559
  1560     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1561
  1562     12  CO-AR-BAL-LEVEL                       PIC X.
  1563         88  CO-AR-REF-LVL                        VALUE '1'.
  1564         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1565         88  CO-AR-BILL-LVL                       VALUE '2'.
  1566         88  CO-AR-AGT-LVL                        VALUE '3'.
  1567         88  CO-AR-FR-LVL                         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  30
* EL050.cbl
  1568
  1569     12  CO-AR-NORMAL-PRINT                    PIC X.
  1570         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1571         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1572
  1573     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1574
  1575     12  CO-AR-REPORTING                       PIC X.
  1576         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1577         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1578
  1579     12  CO-AR-PULL-CHECK                      PIC X.
  1580         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1581         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1582
  1583     12  CO-AR-BALANCE-PRINT                   PIC X.
  1584         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1585
  1586     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1587         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1588         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1589         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1590
  1591     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1592
  1593     12  CO-USER-CODE                          PIC X.
  1594     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1595
  1596******************************************************************
  1597*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1598*    THE LAST MONTH END RUN.
  1599******************************************************************
  1600
  1601     12  CO-LAST-ACTIVITY-DATE.
  1602         16  CO-ACT-YEAR                       PIC 99.
  1603         16  CO-ACT-MONTH                      PIC 99.
  1604         16  CO-ACT-DAY                        PIC 99.
  1605
  1606     12  CO-LAST-STMT-DT.
  1607         16  CO-LAST-STMT-YEAR                 PIC 99.
  1608         16  CO-LAST-STMT-MONTH                PIC 99.
  1609         16  CO-LAST-STMT-DAY                  PIC 99.
  1610
  1611     12  CO-MO-END-TOTALS.
  1612         16  CO-MONTHLY-TOTALS.
  1613             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1614             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1615             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1616             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1617             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1618
  1619         16  CO-AGING-TOTALS.
  1620             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1621             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1622             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1623             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1624
  1625         16  CO-YTD-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  31
* EL050.cbl
  1626             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1627             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1628
  1629         16  CO-OVER-UNDER-TOTALS.
  1630             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1631             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1632
  1633     12  CO-MISCELLANEOUS-TOTALS.
  1634         16  CO-FICA-TOTALS.
  1635             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1636             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1637
  1638         16  CO-CLAIM-TOTALS.
  1639             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1640             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1641
  1642******************************************************************
  1643*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1644*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1645******************************************************************
  1646
  1647     12  CO-CURRENT-TOTALS.
  1648         16  CO-CURRENT-LAST-STMT-DT.
  1649             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1650             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1651             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1652
  1653         16  CO-CURRENT-MONTHLY-TOTALS.
  1654             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1655             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1656             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1657             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1658             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1659
  1660         16  CO-CURRENT-AGING-TOTALS.
  1661             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1662             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1663             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1664             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1665
  1666         16  CO-CURRENT-YTD-TOTALS.
  1667             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1668             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1669
  1670     12  CO-PAID-COMM-TOTALS.
  1671         16  CO-YTD-PAID-COMMS.
  1672             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1673             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1674
  1675     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1676         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1677         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1678
  1679     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1680         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1681         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1682         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1683         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  32
* EL050.cbl
  1684         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1685         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1686         88  CO-FINAL-LETTER                  VALUE 'F'.
  1687         88  CO-RECONCILING                   VALUE 'R'.
  1688         88  CO-PHONE-CALL                    VALUE 'P'.
  1689         88  CO-LEGAL                         VALUE 'L'.
  1690         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1691         88  CO-WRITE-OFF                     VALUE 'W'.
  1692         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1693
  1694     12  CO-CSR-CODE                       PIC X(4).
  1695
  1696     12  CO-GA-STATUS-INFO.
  1697         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1698         16  CO-GA-TERMINATION-DT          PIC XX.
  1699         16  CO-GA-STATUS-CODE             PIC X.
  1700             88  CO-GA-ACTIVE                 VALUE 'A'.
  1701             88  CO-GA-INACTIVE               VALUE 'I'.
  1702             88  CO-GA-PENDING                VALUE 'P'.
  1703         16  CO-GA-COMMENTS.
  1704             20  CO-GA-COMMENT-1           PIC X(40).
  1705             20  CO-GA-COMMENT-2           PIC X(40).
  1706             20  CO-GA-COMMENT-3           PIC X(40).
  1707             20  CO-GA-COMMENT-4           PIC X(40).
  1708
  1709     12  CO-RPTCD2                         PIC X(10).
  1710
  1711     12  CO-TYPE-AGENT                     PIC X(01).
  1712         88  CO-CORPORATION                   VALUE 'C'.
  1713         88  CO-PARTNERSHIP                   VALUE 'P'.
  1714         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1715         88  CO-TRUST                         VALUE 'T'.
  1716         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1717
  1718     12  CO-FAXNO.
  1719         16  CO-FAX-AREA-CODE                  PIC XXX.
  1720         16  CO-FAX-PREFIX                     PIC XXX.
  1721         16  CO-FAX-PHONE                      PIC X(4).
  1722
  1723     12  CO-BANK-INFORMATION.
  1724         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1725         16  CO-BANK-TRANSIT-NON REDEFINES
  1726             CO-BANK-TRANSIT-NO                PIC 9(8).
  1727
  1728         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1729     12  CO-MISC-DEDUCT-INFO REDEFINES
  1730                  CO-BANK-INFORMATION.
  1731         16  CO-MD-GL-ACCT                     PIC X(10).
  1732         16  CO-MD-DIV                         PIC XX.
  1733         16  CO-MD-CENTER                      PIC X(4).
  1734         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1735         16  CO-CREATE-AP-CHECK                PIC X.
  1736         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1737         16  FILLER                            PIC XXX.
  1738     12  CO-ACH-STATUS                         PIC X.
  1739         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1740         88  CO-ACH-PENDING                        VALUE 'P'.
  1741
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  33
* EL050.cbl
  1742     12  CO-BILL-SW                            PIC X.
  1743     12  CO-CONTROL-NAME                       PIC X(30).
  1744     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1745     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1746     12  CO-CLP-STATE                          PIC XX.
  1747     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1748     12  CO-SPP-REFUND-EDIT                    PIC X.
  1749
  1750******************************************************************
  1751
  1752*    COPY ERCAGTC.
  1753******************************************************************
  1754*                                                                *
  1755*                                                                *
  1756*                            ERCAGTC                             *
  1757*                            VMOD=2.001                          *
  1758*                                                                *
  1759*   ONLINE CREDIT SYSTEM                                         *
  1760*                                                                *
  1761*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1762*                                                                *
  1763*   FILE TYPE = VSAM,KSDS                                        *
  1764*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1765*                                                                *
  1766*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1767*       ALTERNATE PATH = NONE                                    *
  1768*                                                                *
  1769*   LOG = NO                                                     *
  1770*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1771*                                                                *
  1772******************************************************************
  1773*                   C H A N G E   L O G
  1774*
  1775* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1776*-----------------------------------------------------------------
  1777*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1778* EFFECTIVE    NUMBER
  1779*-----------------------------------------------------------------
  1780* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1781* 111004                         NEW FILE AND COPYBOOK
  1782* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1783******************************************************************
  1784 01  AGENT-COMMISSIONS.
  1785     12  AG-RECORD-ID                          PIC XX.
  1786         88  VALID-CO-ID                          VALUE 'AG'.
  1787     12  AG-CONTROL-PRIMARY.
  1788         16  AG-COMPANY-CD                     PIC X.
  1789         16  AG-CONTROL.
  1790             20  AG-CTL-1.
  1791                 24  AG-CARR-GROUP.
  1792                     28  AG-CARRIER            PIC X.
  1793                     28  AG-GROUPING           PIC X(6).
  1794                 24  AG-BANK                   PIC X(10).
  1795             20  AG-CTL-2.
  1796                 24  AG-EXP-DT                 PIC XX.
  1797         16  AG-TYPE                           PIC X.
  1798             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1799             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  34
* EL050.cbl
  1800     12  AG-MAINT-INFORMATION.
  1801         16  AG-LAST-MAINT-DT                  PIC XX.
  1802         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1803         16  AG-LAST-MAINT-USER                PIC X(4).
  1804         16  FILLER                            PIC X(10).
  1805     12  AG-EFF-DT                             PIC XX.
  1806     12  AG-COMM-STRUCTURE.
  1807         16  AG-AGT-COMMS OCCURS 10.
  1808             20  AG-AGT                PIC X(10).
  1809             20  AG-COM-TYP            PIC X.
  1810             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1811             20  AG-RECALC-LV-INDIC    PIC X.
  1812             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1813             20  AG-LRCALC-LV-INDIC    PIC X.
  1814             20  FILLER                PIC X(05).
  1815     12  FILLER                  PIC X(145).
  1816******************************************************************
  1817*    COPY ERCRESS.
  1818******************************************************************
  1819*                                                                *
  1820*                            ERCRESS                             *
  1821*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1822*                            VMOD=2.002                          *
  1823*                                                                *
  1824*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1825*                                                                *
  1826*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1827*   VSAM RESIDENT STATE TAX MASTER                              *
  1828*                                                                *
  1829*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1830*                                                                *
  1831*   FILE TYPE = VSAM,KSDS                                        *
  1832*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1833*                                                                *
  1834*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1835*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1836*                                                                *
  1837*   LOG = NO                                                     *
  1838*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1839*                                                                *
  1840*                                                                *
  1841******************************************************************
  1842
  1843 01  RESIDENT-STATE-TAX-MASTER.
  1844
  1845     10  ERRESS-PRIMARY-KEY.
  1846         15  RES-COMPANY-CD        PIC X.
  1847         15  RES-RESIDENT-STATE    PIC XX.
  1848         15  RES-COVERAGE-CATEGORY PIC X.
  1849         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1850*                                      YYYYMMDD
  1851*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1852
  1853     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
  1854
  1855         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1856         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1857         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  35
* EL050.cbl
  1858         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1859
  1860     10 RES-RECALC-SW              PIC   X.
  1861         88 RECALC                VALUE 'Y'.
  1862         88 NO-RECALC             VALUE 'N'.
  1863     10  RES-MAINT-BY              PIC X(4).
  1864     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1865     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1866*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  36
* EL050.cbl
  1868*    COPY ERCRESC.
  1869******************************************************************
  1870*                                                                *
  1871*                            ERCRESC                             *
  1872*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1873*                            VMOD=2.003                          *
  1874*                                                                *
  1875*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1876*                                                                *
  1877*   FILE TYPE = VSAM,KSDS                                        *
  1878*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1879*                                                                *
  1880*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1881*       ALTERNATE PATH1 = NONE                                   *
  1882*                                                                *
  1883*   LOG = NO                                                     *
  1884*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1885*                                                                *
  1886******************************************************************
  1887
  1888 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1889
  1890     10  ERRESC-RECORD-KEY.
  1891         15  RESC-COMPANY-CD           PIC   X.
  1892         15  RESC-CARRIER              PIC   X.
  1893         15  RESC-GROUP                PIC   X(6).
  1894         15  RESC-STATE                PIC   XX.
  1895         15  RESC-ACCOUNT              PIC   X(10).
  1896         15  RESC-AGENT                PIC   X(10).
  1897         15  RESC-RESIDENT-STATE       PIC   XX.
  1898         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1899*                                           YYYYMMDD
  1900     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1901
  1902     10  RESC-COMM-RECORD-DATA.
  1903         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1904             20 RESC-COVERAGE-CAT      PIC    X.
  1905             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1906             20 RESC-COMMISSION-TAB REDEFINES
  1907                RESC-COMMISSION-PER    PIC  XXX.
  1908
  1909     10  RESC-MAINT-BY                 PIC X(4).
  1910     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1911     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1912*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  37
* EL050.cbl
  1914*    COPY ERCPLAN.
  1915******************************************************************
  1916*                                                                *
  1917*                                                                *
  1918*                            ERCPLAN                             *
  1919*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1920*                            VMOD=2.003                          *
  1921*                                                                *
  1922*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1923*                                                                *
  1924*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1925*   PLAN MASTER                                                  *
  1926*                                                                *
  1927*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1928*                                                                *
  1929*   FILE TYPE = VSAM,KSDS                                        *
  1930*   RECORD SIZE = 420   RECFORM = FIX                            *
  1931*                                                                *
  1932*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1933*       ALTERNATE PATH1 = N/A                                    *
  1934*                                                                *
  1935*   LOG = NO                                                     *
  1936*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1937*                                                                *
  1938*                                                                *
  1939******************************************************************
  1940
  1941 01  PLAN-MASTER.
  1942     12  PL-RECORD-ID                      PIC XX.
  1943         88  VALID-PL-ID                      VALUE 'PL'.
  1944
  1945     12  PL-CONTROL-PRIMARY.
  1946         16  PL-COMPANY-CD                 PIC X.
  1947         16  PL-MSTR-CNTRL.
  1948             20  PL-CONTROL-A.
  1949                 24  PL-CARRIER            PIC X.
  1950                 24  PL-GROUPING           PIC X(6).
  1951                 24  PL-STATE              PIC XX.
  1952                 24  PL-ACCOUNT            PIC X(10).
  1953             20  PL-BENEFIT-TYPE           PIC X.
  1954             20  PL-BENEFIT-CODE           PIC XX.
  1955             20  PL-REVISION-NO            PIC X(3).
  1956
  1957     12  PL-CONTROL-BY-VAR-GRP.
  1958         16  PL-COMPANY-CD-A1              PIC X.
  1959         16  PL-VG-CARRIER                 PIC X.
  1960         16  PL-VG-GROUPING                PIC X(6).
  1961         16  PL-VG-STATE                   PIC XX.
  1962         16  PL-VG-ACCOUNT                 PIC X(10).
  1963         16  PL-BENEFIT-TYPE-A1            PIC X.
  1964         16  PL-BENEFIT-CODE-A1            PIC XX.
  1965         16  PL-REVISION-NO-A1             PIC 999.
  1966
  1967     12  PL-MAINT-INFORMATION.
  1968         16  PL-LAST-MAINT-DT              PIC XX.
  1969         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1970         16  PL-LAST-MAINT-USER            PIC X(4).
  1971         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  38
* EL050.cbl
  1972
  1973     12  PL-LIABILITY-LIMITS.
  1974         16  PL-ATT-AGE                    PIC S99        COMP-3.
  1975         16  PL-L-LIMITS        OCCURS 8 TIMES.
  1976             20  PL-LM-AGE                 PIC S99        COMP-3.
  1977             20  PL-LM-DUR                 PIC S999       COMP-3.
  1978             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  1979             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  1980
  1981     12  FILLER                            PIC X(30).
  1982
  1983     12  PL-GL-ACCOUNT-NOS.
  1984         16  PL-PREMIUM-GL                 PIC X(8).
  1985         16  PL-COMM-GL                    PIC X(8).
  1986         16  PL-CLAIM-GL                   PIC X(8).
  1987     12  FILLER                            PIC X(24).
  1988     12  PL-TOLERANCES.
  1989         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  1990         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  1991         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  1992         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  1993         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  1994         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  1995     12  PL-OVER-SHORT.
  1996         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  1997         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  1998     12  FILLER                            PIC X(24).
  1999     12  PLAN-MISC.
  2000         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2001         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2002         16  PL-IG                         PIC X.
  2003         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2004         16  PL-POLICY-FORM                PIC X(12).
  2005         16  PL-EDIT-FOR-FORM              PIC X(01).
  2006         16  PL-DEV-CODE                   PIC XXX.
  2007         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2008         16  PL-CALC-METHOD                PIC X.
  2009         16  PL-BENEFIT-GROUP              PIC X(05).
  2010         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2011
  2012         16  FILLER                        PIC X(99).
  2013******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  39
* EL050.cbl
  2015*    COPY ELCCERT.
  2016******************************************************************
  2017*                                                                *
  2018*                            ELCCERT.                            *
  2019*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2020*                            VMOD=2.013                          *
  2021*                                                                *
  2022*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2023*                                                                *
  2024*   FILE TYPE = VSAM,KSDS                                        *
  2025*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2026*                                                                *
  2027*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2028*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2029*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2030*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2031*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2032*                                                                *
  2033*   LOG = YES                                                    *
  2034*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2035******************************************************************
  2036*                   C H A N G E   L O G
  2037*
  2038* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2039*-----------------------------------------------------------------
  2040*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2041* EFFECTIVE    NUMBER
  2042*-----------------------------------------------------------------
  2043* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2044* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2045* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2046* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2047* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2048* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2049* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2050******************************************************************
  2051
  2052 01  CERTIFICATE-MASTER.
  2053     12  CM-RECORD-ID                      PIC XX.
  2054         88  VALID-CM-ID                      VALUE 'CM'.
  2055
  2056     12  CM-CONTROL-PRIMARY.
  2057         16  CM-COMPANY-CD                 PIC X.
  2058         16  CM-CARRIER                    PIC X.
  2059         16  CM-GROUPING.
  2060             20  CM-GROUPING-PREFIX        PIC X(3).
  2061             20  CM-GROUPING-PRIME         PIC X(3).
  2062         16  CM-STATE                      PIC XX.
  2063         16  CM-ACCOUNT.
  2064             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2065             20  CM-ACCOUNT-PRIME          PIC X(6).
  2066         16  CM-CERT-EFF-DT                PIC XX.
  2067         16  CM-CERT-NO.
  2068             20  CM-CERT-PRIME             PIC X(10).
  2069             20  CM-CERT-SFX               PIC X.
  2070
  2071     12  CM-CONTROL-BY-NAME.
  2072         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  40
* EL050.cbl
  2073         16  CM-INSURED-LAST-NAME          PIC X(15).
  2074         16  CM-INSURED-INITIALS.
  2075             20  CM-INSURED-INITIAL1       PIC X.
  2076             20  CM-INSURED-INITIAL2       PIC X.
  2077
  2078     12  CM-CONTROL-BY-SSN.
  2079         16  CM-COMPANY-CD-A2              PIC X.
  2080         16  CM-SOC-SEC-NO.
  2081             20  CM-SSN-STATE              PIC XX.
  2082             20  CM-SSN-ACCOUNT            PIC X(6).
  2083             20  CM-SSN-LN3.
  2084                 25  CM-INSURED-INITIALS-A2.
  2085                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2086                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2087                 25 CM-PART-LAST-NAME-A2         PIC X.
  2088
  2089     12  CM-CONTROL-BY-CERT-NO.
  2090         16  CM-COMPANY-CD-A4              PIC X.
  2091         16  CM-CERT-NO-A4                 PIC X(11).
  2092
  2093     12  CM-CONTROL-BY-MEMB.
  2094         16  CM-COMPANY-CD-A5              PIC X.
  2095         16  CM-MEMBER-NO.
  2096             20  CM-MEMB-STATE             PIC XX.
  2097             20  CM-MEMB-ACCOUNT           PIC X(6).
  2098             20  CM-MEMB-LN4.
  2099                 25  CM-INSURED-INITIALS-A5.
  2100                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2101                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2102                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2103
  2104     12  CM-INSURED-PROFILE-DATA.
  2105         16  CM-INSURED-FIRST-NAME.
  2106             20  CM-INSURED-1ST-INIT       PIC X.
  2107             20  FILLER                    PIC X(9).
  2108         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2109         16  CM-INSURED-SEX                PIC X.
  2110             88  CM-SEX-MALE                  VALUE 'M'.
  2111             88  CM-SEX-FEMAL                 VALUE 'F'.
  2112         16  CM-INSURED-JOINT-AGE          PIC 99.
  2113         16  CM-JOINT-INSURED-NAME.
  2114             20  CM-JT-LAST-NAME           PIC X(15).
  2115             20  CM-JT-FIRST-NAME.
  2116                 24  CM-JT-1ST-INIT        PIC X.
  2117                 24  FILLER                PIC X(9).
  2118             20  CM-JT-INITIAL             PIC X.
  2119
  2120     12  CM-LIFE-DATA.
  2121         16  CM-LF-BENEFIT-CD              PIC XX.
  2122         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2123         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2124         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2125         16  CM-LF-DEV-CODE                PIC XXX.
  2126         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2127         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2128         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2129         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2130         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  41
* EL050.cbl
  2131         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2132         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2133         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2134         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2135         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2136         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2137         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2138         16  FILLER                        PIC XX.
  2139
  2140     12  CM-AH-DATA.
  2141         16  CM-AH-BENEFIT-CD              PIC XX.
  2142         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2143         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2144         16  CM-AH-DEV-CODE                PIC XXX.
  2145         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2146         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2147         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2148         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2149         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2150         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2151         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2152         16  CM-AH-PAID-THRU-DT            PIC XX.
  2153             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2154         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2155         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2156         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2157         16  FILLER                        PIC X.
  2158
  2159     12  CM-LOAN-INFORMATION.
  2160         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2161         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2162                                           PIC S9(5)V99  COMP-3.
  2163         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2164         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2165         16  CM-PAY-FREQUENCY              PIC S99.
  2166         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2167         16  CM-RATE-CLASS                 PIC XX.
  2168         16  CM-BENEFICIARY                PIC X(25).
  2169         16  CM-POLICY-FORM-NO             PIC X(12).
  2170         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2171         16  CM-LAST-ADD-ON-DT             PIC XX.
  2172         16  CM-DEDUCTIBLE-AMOUNTS.
  2173             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2174             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2175         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2176             20  CM-RESIDENT-STATE         PIC XX.
  2177             20  CM-RATE-CODE              PIC X(4).
  2178             20  FILLER                    PIC XX.
  2179         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2180             20  CM-LOAN-OFFICER           PIC X(5).
  2181             20  FILLER                    PIC XXX.
  2182         16  CM-CSR-CODE                   PIC XXX.
  2183         16  CM-UNDERWRITING-CODE          PIC X.
  2184             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2185         16  CM-POST-CARD-IND              PIC X.
  2186         16  CM-NH-INTERFACE-SW            PIC X.
  2187         16  CM-PREMIUM-TYPE               PIC X.
  2188             88  CM-SING-PRM                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  42
* EL050.cbl
  2189             88  CM-O-B-COVERAGE              VALUE '2'.
  2190             88  CM-OPEN-END                  VALUE '3'.
  2191         16  CM-IND-GRP-TYPE               PIC X.
  2192             88  CM-INDIVIDUAL                VALUE 'I'.
  2193             88  CM-GROUP                     VALUE 'G'.
  2194         16  CM-SKIP-CODE                  PIC X.
  2195             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2196             88  SKIP-JULY                    VALUE '1'.
  2197             88  SKIP-AUGUST                  VALUE '2'.
  2198             88  SKIP-SEPTEMBER               VALUE '3'.
  2199             88  SKIP-JULY-AUG                VALUE '4'.
  2200             88  SKIP-AUG-SEPT                VALUE '5'.
  2201             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2202             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2203             88  SKIP-JUNE                    VALUE '8'.
  2204             88  SKIP-JUNE-JULY               VALUE '9'.
  2205             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2206             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2207         16  CM-PAYMENT-MODE               PIC X.
  2208             88  PAY-MONTHLY                  VALUE SPACE.
  2209             88  PAY-WEEKLY                   VALUE '1'.
  2210             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2211             88  PAY-BI-WEEKLY                VALUE '3'.
  2212             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2213         16  CM-LOAN-NUMBER                PIC X(8).
  2214         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2215         16  CM-OLD-LOF                    PIC XXX.
  2216*        16  CM-LOAN-OFFICER               PIC XXX.
  2217         16  CM-REIN-TABLE                 PIC XXX.
  2218         16  CM-SPECIAL-REIN-CODE          PIC X.
  2219         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2220         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2221         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2222
  2223     12  CM-STATUS-DATA.
  2224         16  CM-ENTRY-STATUS               PIC X.
  2225         16  CM-ENTRY-DT                   PIC XX.
  2226
  2227         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2228         16  CM-LF-CANCEL-DT               PIC XX.
  2229         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2230
  2231         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2232         16  CM-LF-DEATH-DT                PIC XX.
  2233         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2234
  2235         16  CM-LF-CURRENT-STATUS          PIC X.
  2236             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2237                                                'M' '4' '5' '9'.
  2238             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2239             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2240             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2241             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2242             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2243             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2244             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2245             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2246             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  43
* EL050.cbl
  2247             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2248             88  CM-LF-DECLINED               VALUE 'D'.
  2249             88  CM-LF-VOIDED                 VALUE 'V'.
  2250
  2251         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2252         16  CM-AH-CANCEL-DT               PIC XX.
  2253         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2254
  2255         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2256         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2257         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2258
  2259         16  CM-AH-CURRENT-STATUS          PIC X.
  2260             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2261                                                'M' '4' '5' '9'.
  2262             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2263             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2264             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2265             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2266             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2267             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2268             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2269             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2270             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2271             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2272             88  CM-AH-DECLINED               VALUE 'D'.
  2273             88  CM-AH-VOIDED                 VALUE 'V'.
  2274
  2275         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2276             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2277             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2278             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2279         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2280
  2281         16  CM-ENTRY-BATCH                PIC X(6).
  2282         16  CM-LF-EXIT-BATCH              PIC X(6).
  2283         16  CM-AH-EXIT-BATCH              PIC X(6).
  2284         16  CM-LAST-MONTH-END             PIC XX.
  2285
  2286     12  CM-NOTE-SW                        PIC X.
  2287         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2288         88  CERT-NOTES-PRESENT               VALUE '1'.
  2289         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2290         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2291         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2292         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2293         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2294         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2295     12  CM-COMP-EXCP-SW                   PIC X.
  2296         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2297         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2298     12  CM-INSURED-ADDRESS-SW             PIC X.
  2299         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2300         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2301
  2302*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2303     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2304     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  44
* EL050.cbl
  2305
  2306*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2307     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2308     12  FILLER                            PIC X.
  2309*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2310     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2311
  2312     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2313         88  CERT-ADDED-BATCH                 VALUE ' '.
  2314         88  CERT-ADDED-ONLINE                VALUE '1'.
  2315         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2316         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2317         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2318     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2319         88  CERT-AS-LOADED                   VALUE ' '.
  2320         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2321         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2322         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2323         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2324         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2325         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2326         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2327
  2328     12  CM-ACCOUNT-COMM-PCTS.
  2329         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2330         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2331
  2332     12  CM-USER-FIELD                     PIC X.
  2333     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2334     12  CM-CLP-STATE                      PIC XX.
  2335     12  CM-USER-RESERVED                  PIC XXX.
  2336******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  45
* EL050.cbl
  2338*    COPY ERCMAIL.
  2339******************************************************************
  2340*                                                                *
  2341*                                                                *
  2342*                            ERCMAIL                             *
  2343*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2344*                            VMOD=2.003                          *
  2345*                                                                *
  2346*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2347*                                                                *
  2348*   FILE TYPE = VSAM,KSDS                                        *
  2349*   RECORD SIZE = 374   RECFORM = FIX                            *
  2350*                                                                *
  2351*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2352*   ALTERNATE PATH    = NOT USED                                 *
  2353*                                                                *
  2354*   LOG = YES                                                    *
  2355*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2356******************************************************************
  2357*                   C H A N G E   L O G
  2358*
  2359* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2360*-----------------------------------------------------------------
  2361*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2362* EFFECTIVE    NUMBER
  2363*-----------------------------------------------------------------
  2364* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2365* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2366* 111108                   PEMA  ADD CRED BENE ADDR2
  2367******************************************************************
  2368
  2369 01  MAILING-DATA.
  2370     12  MA-RECORD-ID                      PIC XX.
  2371         88  VALID-MA-ID                       VALUE 'MA'.
  2372
  2373     12  MA-CONTROL-PRIMARY.
  2374         16  MA-COMPANY-CD                 PIC X.
  2375         16  MA-CARRIER                    PIC X.
  2376         16  MA-GROUPING.
  2377             20  MA-GROUPING-PREFIX        PIC XXX.
  2378             20  MA-GROUPING-PRIME         PIC XXX.
  2379         16  MA-STATE                      PIC XX.
  2380         16  MA-ACCOUNT.
  2381             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2382             20  MA-ACCOUNT-PRIME          PIC X(6).
  2383         16  MA-CERT-EFF-DT                PIC XX.
  2384         16  MA-CERT-NO.
  2385             20  MA-CERT-PRIME             PIC X(10).
  2386             20  MA-CERT-SFX               PIC X.
  2387
  2388     12  FILLER                            PIC XX.
  2389
  2390     12  MA-ACCESS-CONTROL.
  2391         16  MA-SOURCE-SYSTEM              PIC XX.
  2392             88  MA-FROM-CREDIT                VALUE 'CR'.
  2393             88  MA-FROM-VSI                   VALUE 'VS'.
  2394             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2395             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  46
* EL050.cbl
  2396         16  MA-RECORD-ADD-DT              PIC XX.
  2397         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2398         16  MA-LAST-MAINT-DT              PIC XX.
  2399         16  MA-LAST-MAINT-BY              PIC XXXX.
  2400         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2401
  2402     12  MA-PROFILE-INFO.
  2403         16  MA-QUALIFY-CODE-1             PIC XX.
  2404         16  MA-QUALIFY-CODE-2             PIC XX.
  2405         16  MA-QUALIFY-CODE-3             PIC XX.
  2406         16  MA-QUALIFY-CODE-4             PIC XX.
  2407         16  MA-QUALIFY-CODE-5             PIC XX.
  2408
  2409         16  MA-INSURED-LAST-NAME          PIC X(15).
  2410         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2411         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2412         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2413         16  MA-INSURED-BIRTH-DT           PIC XX.
  2414         16  MA-INSURED-SEX                PIC X.
  2415             88  MA-SEX-MALE                   VALUE 'M'.
  2416             88  MA-SEX-FEMALE                 VALUE 'F'.
  2417         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2418
  2419         16  MA-ADDRESS-CORRECTED          PIC X.
  2420         16  MA-JOINT-BIRTH-DT             PIC XX.
  2421*        16  FILLER                        PIC X(12).
  2422
  2423         16  MA-ADDRESS-LINE-1             PIC X(30).
  2424         16  MA-ADDRESS-LINE-2             PIC X(30).
  2425         16  MA-CITY-STATE.
  2426             20  MA-CITY                   PIC X(28).
  2427             20  MA-ADDR-STATE             PIC XX.
  2428         16  MA-ZIP.
  2429             20  MA-ZIP-CODE.
  2430                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2431                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2432                 24  FILLER                PIC X(4).
  2433             20  MA-ZIP-PLUS4              PIC X(4).
  2434         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2435             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2436             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2437             20  FILLER                    PIC X(3).
  2438
  2439         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2440
  2441         16  FILLER                        PIC XXX.
  2442*        16  FILLER                        PIC X(10).
  2443
  2444     12  MA-CRED-BENE-INFO.
  2445         16  MA-CRED-BENE-NAME                 PIC X(25).
  2446         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2447         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2448         16  MA-CRED-BENE-CTYST.
  2449             20  MA-CRED-BENE-CITY             PIC X(28).
  2450             20  MA-CRED-BENE-STATE            PIC XX.
  2451         16  MA-CRED-BENE-ZIP.
  2452             20  MA-CB-ZIP-CODE.
  2453                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  47
* EL050.cbl
  2454                     88  MA-CB-CANADIAN-POST-CODE
  2455                                           VALUE 'A' THRU 'Z'.
  2456                 24  FILLER                    PIC X(4).
  2457             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2458         16  MA-CB-CANADIAN-POSTAL-CODE
  2459                            REDEFINES MA-CRED-BENE-ZIP.
  2460             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2461             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2462             20  FILLER                        PIC X(3).
  2463     12  MA-POST-CARD-MAIL-DATA.
  2464         16  MA-MAIL-DATA OCCURS 7.
  2465             20  MA-MAIL-TYPE              PIC X.
  2466                 88  MA-12MO-MAILING           VALUE '1'.
  2467                 88  MA-EXP-MAILING            VALUE '2'.
  2468             20  MA-MAIL-STATUS            PIC X.
  2469                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2470                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2471                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2472             20  MA-MAIL-DATE              PIC XX.
  2473     12  FILLER                            PIC XX.
  2474     12  FILLER                            PIC XX.
  2475*    12  FILLER                            PIC X(30).
  2476******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  48
* EL050.cbl
  2478*    COPY ERCPNDM.
  2479******************************************************************
  2480*                                                                *
  2481*                                                                *
  2482*                            ERCPNDM                             *
  2483*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2484*                            VMOD=2.003                          *
  2485*                                                                *
  2486*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2487*                                                                *
  2488*   FILE TYPE = VSAM,KSDS                                        *
  2489*   RECORD SIZE = 374   RECFORM = FIX                            *
  2490*                                                                *
  2491*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2492*   ALTERNATE PATH    = NOT USED                                 *
  2493*                                                                *
  2494*   LOG = YES                                                    *
  2495*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2496******************************************************************
  2497*                   C H A N G E   L O G
  2498*
  2499* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2500*-----------------------------------------------------------------
  2501*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2502* EFFECTIVE    NUMBER
  2503*-----------------------------------------------------------------
  2504* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2505* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2506* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2507******************************************************************
  2508
  2509 01  PENDING-MAILING-DATA.
  2510     12  PM-RECORD-ID                      PIC XX.
  2511         88  VALID-MA-ID                       VALUE 'PM'.
  2512
  2513     12  PM-CONTROL-PRIMARY.
  2514         16  PM-COMPANY-CD                 PIC X.
  2515         16  PM-ENTRY-BATCH                PIC X(6).
  2516         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2517         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2518
  2519     12  FILLER                            PIC X(14).
  2520
  2521     12  PM-ACCESS-CONTROL.
  2522         16  PM-SOURCE-SYSTEM              PIC XX.
  2523             88  PM-FROM-CREDIT                VALUE 'CR'.
  2524             88  PM-FROM-VSI                   VALUE 'VS'.
  2525             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2526             88  PM-FROM-OTHER                 VALUE 'OT'.
  2527         16  PM-RECORD-ADD-DT              PIC XX.
  2528         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2529         16  PM-LAST-MAINT-DT              PIC XX.
  2530         16  PM-LAST-MAINT-BY              PIC XXXX.
  2531         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2532
  2533     12  PM-PROFILE-INFO.
  2534         16  PM-QUALIFY-CODE-1             PIC XX.
  2535         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  49
* EL050.cbl
  2536         16  PM-QUALIFY-CODE-3             PIC XX.
  2537         16  PM-QUALIFY-CODE-4             PIC XX.
  2538         16  PM-QUALIFY-CODE-5             PIC XX.
  2539
  2540         16  PM-INSURED-LAST-NAME          PIC X(15).
  2541         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2542         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2543         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2544         16  PM-INSURED-BIRTH-DT           PIC XX.
  2545         16  PM-INSURED-SEX                PIC X.
  2546             88  PM-SEX-MALE                   VALUE 'M'.
  2547             88  PM-SEX-FEMALE                 VALUE 'F'.
  2548         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2549
  2550         16  PM-ADDRESS-CORRECTED          PIC X.
  2551         16  PM-JOINT-BIRTH-DT             PIC XX.
  2552*        16  FILLER                        PIC X(12).
  2553
  2554         16  PM-ADDRESS-LINE-1             PIC X(30).
  2555         16  PM-ADDRESS-LINE-2             PIC X(30).
  2556         16  PM-CITY-STATE.
  2557             20  PM-CITY                   PIC X(28).
  2558             20  PM-STATE                  PIC XX.
  2559         16  PM-ZIP.
  2560             20  PM-ZIP-CODE.
  2561                 24  PM-ZIP-1              PIC X.
  2562                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2563                 24  FILLER                PIC X(4).
  2564             20  PM-ZIP-PLUS4              PIC X(4).
  2565         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2566             20  PM-CAN-POST1              PIC XXX.
  2567             20  PM-CAN-POST2              PIC XXX.
  2568             20  FILLER                    PIC XXX.
  2569
  2570         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2571
  2572         16  FILLER                        PIC X(03).
  2573
  2574     12  PM-CRED-BENE-INFO.
  2575         16  PM-CRED-BENE-NAME             PIC X(25).
  2576         16  PM-CRED-BENE-ADDR             PIC X(30).
  2577         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2578         16  PM-CRED-BENE-CTYST.
  2579             20  PM-CRED-BENE-CITY         PIC X(28).
  2580             20  PM-CRED-BENE-STATE        PIC XX.
  2581         16  PM-CRED-BENE-ZIP.
  2582             20  PM-CB-ZIP-CODE.
  2583                 24  PM-CB-ZIP-1           PIC X.
  2584                     88  PM-CB-CANADIAN-POST-CODE
  2585                                  VALUE 'A' THRU 'Z'.
  2586                 24  FILLER                PIC X(4).
  2587             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2588         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2589             20  PM-CB-CAN-POST1           PIC XXX.
  2590             20  PM-CB-CAN-POST2           PIC XXX.
  2591             20  FILLER                    PIC XXX.
  2592     12  PM-POST-CARD-MAIL-DATA.
  2593         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  50
* EL050.cbl
  2594             20  PM-MAIL-TYPE              PIC X.
  2595                 88  PM-12MO-MAILING           VALUE '1'.
  2596                 88  PM-EXP-MAILING            VALUE '2'.
  2597             20  PM-MAIL-STATUS            PIC X.
  2598                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2599                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2600                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2601             20  PM-MAIL-DATE              PIC XX.
  2602     12  FILLER                            PIC XX.
  2603     12  FILLER                            PIC X(12).
  2604*    12  FILLER                            PIC X(30).
  2605
  2606******************************************************************
  2607*                                COPY ERCLOFC.
  2608******************************************************************
  2609*                                                                *
  2610*                                                                *
  2611*                            ERCLOFC                             *
  2612*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2613*                            VMOD=2.003                          *
  2614*                                                                *
  2615*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2616*                                                                *
  2617*   FILE TYPE = VSAM,KSDS                                        *
  2618*   RECORD SIZE = 670   RECFORM = FIX                            *
  2619*                                                                *
  2620*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2621*                                                                *
  2622*   LOG = YES                                                    *
  2623*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2624*                                                                *
  2625******************************************************************
  2626
  2627 01  LOAN-OFFICER-MASTER.
  2628     12  LO-RECORD-ID                PIC XX.
  2629         88  VALID-LO-ID                VALUE 'LO'.
  2630
  2631     12  LO-CONTROL-PRIMARY.
  2632         16  LO-COMPANY-CD           PIC X.
  2633         16  LO-CARRIER              PIC X.
  2634         16  LO-GROUPING.
  2635             20  LO-GROUPING-PREFIX  PIC XXX.
  2636             20  LO-GROUPING-PRIME   PIC XXX.
  2637         16  LO-STATE                PIC XX.
  2638         16  LO-ACCOUNT.
  2639             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2640             20  LO-ACCOUNT-PRIME    PIC X(6).
  2641         16  LO-OFFICER-CODE         PIC X(5).
  2642
  2643     12  LO-OFFICER-NAME             PIC X(30).
  2644
  2645     12  LO-LAST-MAINT-DT            PIC XX.
  2646     12  LO-LAST-USER                PIC X(4).
  2647     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2648
  2649     12  LO-COMP-CONTROL             PIC X.
  2650             88  LO-SHOW-COMP           VALUE 'Y'.
  2651             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  51
* EL050.cbl
  2652     12  LO-DETAIL-CONTROL           PIC X.
  2653             88  LO-PRINT-DETAIL        VALUE 'D'.
  2654             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2655
  2656     12  LO-SV-CARRIER               PIC X.
  2657     12  LO-SV-GROUPING              PIC X(6).
  2658     12  LO-SV-STATE                 PIC XX.
  2659
  2660     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2661     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2662
  2663     12  LO-OFFICER-INFO.
  2664         16  FILLER OCCURS 12 TIMES.
  2665             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2666             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2667             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2668             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2669             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2670             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2671             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2672             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2673     12  FILLER                      PIC X(198).
  2674******************************************************************
  2675*                                COPY ERCPDEF.
  2676******************************************************************
  2677*                                                                *
  2678*                                                                *
  2679*                            ERCPDEF.                            *
  2680*                                                                *
  2681*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2682*                                                                *
  2683*    FILE TYPE = VSAM,KSDS                                       *
  2684*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2685*                                                                *
  2686*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2687*                                                                *
  2688*    LOG = YES                                                   *
  2689*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2690******************************************************************
  2691 01  PRODUCT-MASTER.
  2692    12  PD-RECORD-ID                 PIC X(02).
  2693        88  VALID-PD-ID                  VALUE 'PD'.
  2694    12  PD-CONTROL-PRIMARY.
  2695        16  PD-COMPANY-CD            PIC X.
  2696        16  PD-STATE                 PIC XX.
  2697        16  PD-PRODUCT-CD            PIC XXX.
  2698        16  PD-FILLER                PIC X(7).
  2699        16  PD-BEN-TYPE              PIC X.
  2700        16  PD-BEN-CODE              PIC XX.
  2701        16  PD-PROD-EXP-DT           PIC XX.
  2702    12  FILLER                       PIC X(50).
  2703    12  PD-PRODUCT-DATA OCCURS 8.
  2704        16  PD-PROD-CODE             PIC X.
  2705            88  PD-PROD-LIFE           VALUE 'L'.
  2706            88  PD-PROD-PROP           VALUE 'P'.
  2707            88  PD-PROD-AH             VALUE 'A'.
  2708            88  PD-PROD-IU             VALUE 'I'.
  2709            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  52
* EL050.cbl
  2710        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2711        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2712        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2713        16  PD-MAX-TERM              PIC S999        COMP-3.
  2714        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2715        16  FILLER                   PIC X.
  2716        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2717        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2718        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2719        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2720        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2721        16  PD-REC-CRIT-PERIOD       PIC X.
  2722        16  PD-RTW-MOS               PIC 99.
  2723        16  FILLER                   PIC X(5).
  2724    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2725    12  PD-TERM-LIMITS OCCURS 15.
  2726        16  PD-LOW-TERM              PIC S999        COMP-3.
  2727        16  PD-HI-TERM               PIC S999        COMP-3.
  2728*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2729    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2730        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2731        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2732    12  PD-EARN-FACTORS.
  2733        16  FILLER OCCURS 15.
  2734            20  FILLER OCCURS 15.
  2735                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2736    12  PD-PRODUCT-DESC              PIC X(80).
  2737    12  PD-TRUNCATED                 PIC X.
  2738    12  FILLER                       PIC X(59).
  2739    12  PD-MAINT-INFORMATION.
  2740        16  PD-LAST-MAINT-DT         PIC X(02).
  2741        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2742        16  PD-LAST-MAINT-BY         PIC X(04).
  2743*                                COPY ELCSTATE.
  2744******************************************************************
  2745*                                                                *
  2746*                                                                *
  2747*                            ELCSTATE.                           *
  2748*                                                                *
  2749*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2750*                                                                *
  2751*   FILE TYPE = VSAM,KSDS                                        *
  2752*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2753*                                                                *
  2754*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2755*       ALTERNATE INDEX = NONE                                   *
  2756*                                                                *
  2757*   LOG = YES                                                    *
  2758*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2759******************************************************************
  2760*                   C H A N G E   L O G
  2761*
  2762* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2763*-----------------------------------------------------------------
  2764*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2765* EFFECTIVE    NUMBER
  2766*-----------------------------------------------------------------
  2767* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  53
* EL050.cbl
  2768******************************************************************
  2769*
  2770 01  STATE-FILE.
  2771     12  SF-RECORD-ID                       PIC XX.
  2772         88  VALID-CF-ID                        VALUE 'SF'.
  2773     12  SF-CONTROL-PRIMARY.
  2774         16  SF-COMPANY-ID                  PIC XXX.
  2775         16  SF-CARRIER-CODE                PIC X.
  2776         16  SF-GROUPING                    PIC X(6).
  2777         16  SF-STATE-CODE                  PIC XX.
  2778         16  SF-EXPIRE-DATE                 PIC 9(8).
  2779****************************************************************
  2780*             STATE CONTROLS
  2781****************************************************************
  2782     12  SF-LAST-MAINT-DT                   PIC XX.
  2783     12  SF-LAST-MAINT-BY                   PIC X(4).
  2784     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2785     12  SF-STATE-RT-CONTROLS.
  2786         16  SF-ST-RT-CALC                  PIC X.
  2787     12  SF-ST-TAX-CONTROLS.
  2788         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2789         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2790         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2791     12  SF-ST-REFUND-OPTIONS.
  2792         16  SF-ST-RF-LR-CALC               PIC X.
  2793         16  SF-ST-RF-LL-CALC               PIC X.
  2794         16  SF-ST-RF-LN-CALC               PIC X.
  2795         16  SF-ST-RF-AH-CALC               PIC X.
  2796         16  SF-ST-RF-CP-CALC               PIC X.
  2797     12  SF-ST-UNEARN-PREM-OPTIONS.
  2798         16  SF-ST-LUEP-R78                 PIC X.
  2799         16  SF-ST-LUEP-PRO                 PIC X.
  2800         16  SF-ST-LUEP-ST                  PIC X.
  2801         16  SF-ST-LUEP-DOM                 PIC X.
  2802         16  SF-ST-AUEP-R78                 PIC X.
  2803         16  SF-ST-AUEP-PRO                 PIC X.
  2804         16  SF-ST-AUEP-ST                  PIC X.
  2805         16  SF-ST-AUEP-DOM                 PIC X.
  2806         16  SF-ST-CUEP-R78                 PIC X.
  2807         16  SF-ST-CUEP-PRO                 PIC X.
  2808         16  SF-ST-CUEP-ST                  PIC X.
  2809         16  SF-ST-CUEP-DOM                 PIC X.
  2810     12  SF-ST-EARN-PREM-OPTIONS.
  2811         16  SF-ST-LEP-R78                  PIC X.
  2812         16  SF-ST-LEP-PRO                  PIC X.
  2813         16  SF-ST-LEP-ST                   PIC X.
  2814         16  SF-ST-LEP-DOM                  PIC X.
  2815         16  SF-ST-AEP-R78                  PIC X.
  2816         16  SF-ST-AEP-PRO                  PIC X.
  2817         16  SF-ST-AEP-ST                   PIC X.
  2818         16  SF-ST-AEP-DOM                  PIC X.
  2819         16  SF-ST-CEP-R78                  PIC X.
  2820         16  SF-ST-CEP-PRO                  PIC X.
  2821         16  SF-ST-CEP-ST                   PIC X.
  2822         16  SF-ST-CEP-DOM                  PIC X.
  2823     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  54
* EL050.cbl
  2825*    COPY ELCCRTT.
  2826******************************************************************
  2827*                                                                *
  2828*                            ELCCRTT.                            *
  2829*                                                                *
  2830*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2831*                                                                *
  2832*   FILE TYPE = VSAM,KSDS                                        *
  2833*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2834*                                                                *
  2835*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2836*                                                                *
  2837*   LOG = YES                                                    *
  2838*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2839******************************************************************
  2840*                   C H A N G E   L O G
  2841*
  2842* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2843*-----------------------------------------------------------------
  2844*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2845* EFFECTIVE    NUMBER
  2846*-----------------------------------------------------------------
  2847* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2848* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2849* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2850******************************************************************
  2851
  2852 01  CERTIFICATE-TRAILERS.
  2853     12  CS-RECORD-ID                      PIC XX.
  2854         88  VALID-CS-ID                      VALUE 'CS'.
  2855
  2856     12  CS-CONTROL-PRIMARY.
  2857         16  CS-COMPANY-CD                 PIC X.
  2858         16  CS-CARRIER                    PIC X.
  2859         16  CS-GROUPING                   PIC X(6).
  2860         16  CS-STATE                      PIC XX.
  2861         16  CS-ACCOUNT                    PIC X(10).
  2862         16  CS-CERT-EFF-DT                PIC XX.
  2863         16  CS-CERT-NO.
  2864             20  CS-CERT-PRIME             PIC X(10).
  2865             20  CS-CERT-SFX               PIC X.
  2866         16  CS-TRAILER-TYPE               PIC X.
  2867             88  COMM-TRLR           VALUE 'A'.
  2868             88  FUTURE-TRLR         VALUE 'B'.
  2869             88  CERT-DATA-TRLR      VALUE 'C'.
  2870
  2871     12  CS-DATA-AREA                      PIC X(516).
  2872
  2873     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2874         16  CS-BANK-COMMISSION-AREA.
  2875             20  CS-BANK-COMMS       OCCURS 10.
  2876                 24  CS-AGT                PIC X(10).
  2877                 24  CS-COM-TYP            PIC X.
  2878                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2879                 24  CS-RECALC-LV-INDIC    PIC X.
  2880                 24  FILLER                PIC X(10).
  2881         16  FILLER                        PIC X(256).
  2882
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  55
* EL050.cbl
  2883     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2884         16  CS-VIN-NUMBER                 PIC X(17).
  2885         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2886         16  FILLER                        PIC X(498).
  2887******************************************************************
  2888
  2889*    COPY ELCDATE.
  2890******************************************************************
  2891*                                                                *
  2892*                                                                *
  2893*                            ELCDATE.                            *
  2894*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2895*                            VMOD=2.003
  2896*                                                                *
  2897*                                                                *
  2898*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2899*                 LENGTH = 200                                   *
  2900******************************************************************
  2901
  2902 01  DATE-CONVERSION-DATA.
  2903     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2904     12  DC-OPTION-CODE                PIC X.
  2905         88  BIN-TO-GREG                VALUE ' '.
  2906         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2907         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2908         88  YMD-GREG-TO-BIN            VALUE '3'.
  2909         88  MDY-GREG-TO-BIN            VALUE '4'.
  2910         88  JULIAN-TO-BIN              VALUE '5'.
  2911         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2912         88  FIND-CENTURY               VALUE '7'.
  2913         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2914         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2915         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2916         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2917         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2918         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2919         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2920         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2921         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2922         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2923         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2924         88  BIN-3-TO-GREG              VALUE 'I'.
  2925         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2926         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2927         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2928         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2929         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2930         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2931         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2932         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2933         88  THREE-CHARACTER-BIN
  2934                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2935         88  GREGORIAN-TO-BIN
  2936                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2937         88  BIN-TO-GREGORIAN
  2938                  VALUES ' ' '1' 'I' '8' 'G'.
  2939         88  JULIAN-TO-BINARY
  2940                  VALUES '5' 'C' 'E' 'F'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  56
* EL050.cbl
  2941     12  DC-ERROR-CODE                 PIC X.
  2942         88  NO-CONVERSION-ERROR        VALUE ' '.
  2943         88  DATE-CONVERSION-ERROR
  2944                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2945         88  DATE-IS-ZERO               VALUE '1'.
  2946         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2947         88  DATE-IS-INVALID            VALUE '3'.
  2948         88  DATE1-GREATER-DATE2        VALUE '4'.
  2949         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2950         88  DATE-INVALID-OPTION        VALUE '9'.
  2951         88  INVALID-CENTURY            VALUE 'A'.
  2952         88  ONLY-CENTURY               VALUE 'B'.
  2953         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2954         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2955     12  DC-END-OF-MONTH               PIC X.
  2956         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2957     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2958         88  USE-NORMAL-PROCESS         VALUE ' '.
  2959         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2960         88  ADJUST-UP-100-YRS          VALUE '2'.
  2961     12  FILLER                        PIC X.
  2962     12  DC-CONVERSION-DATES.
  2963         16  DC-BIN-DATE-1             PIC XX.
  2964         16  DC-BIN-DATE-2             PIC XX.
  2965         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2966         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2967                       DC-GREG-DATE-1-EDIT.
  2968             20  DC-EDIT1-MONTH        PIC 99.
  2969             20  SLASH1-1              PIC X.
  2970             20  DC-EDIT1-DAY          PIC 99.
  2971             20  SLASH1-2              PIC X.
  2972             20  DC-EDIT1-YEAR         PIC 99.
  2973         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2974         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2975                     DC-GREG-DATE-2-EDIT.
  2976             20  DC-EDIT2-MONTH        PIC 99.
  2977             20  SLASH2-1              PIC X.
  2978             20  DC-EDIT2-DAY          PIC 99.
  2979             20  SLASH2-2              PIC X.
  2980             20  DC-EDIT2-YEAR         PIC 99.
  2981         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2982         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2983                     DC-GREG-DATE-1-YMD.
  2984             20  DC-YMD-YEAR           PIC 99.
  2985             20  DC-YMD-MONTH          PIC 99.
  2986             20  DC-YMD-DAY            PIC 99.
  2987         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2988         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2989                      DC-GREG-DATE-1-MDY.
  2990             20  DC-MDY-MONTH          PIC 99.
  2991             20  DC-MDY-DAY            PIC 99.
  2992             20  DC-MDY-YEAR           PIC 99.
  2993         16  DC-GREG-DATE-1-ALPHA.
  2994             20  DC-ALPHA-MONTH        PIC X(10).
  2995             20  DC-ALPHA-DAY          PIC 99.
  2996             20  FILLER                PIC XX.
  2997             20  DC-ALPHA-CENTURY.
  2998                 24 DC-ALPHA-CEN-N     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  57
* EL050.cbl
  2999             20  DC-ALPHA-YEAR         PIC 99.
  3000         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3001         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3002         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3003         16  DC-JULIAN-DATE            PIC 9(05).
  3004         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3005                                       PIC 9(05).
  3006         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3007             20  DC-JULIAN-YEAR        PIC 99.
  3008             20  DC-JULIAN-DAYS        PIC 999.
  3009         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3010         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3011         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3012     12  DATE-CONVERSION-VARIBLES.
  3013         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3014         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3015             20  FILLER                PIC 9(3).
  3016             20  HOLD-CEN-1-CCYY.
  3017                 24  HOLD-CEN-1-CC     PIC 99.
  3018                 24  HOLD-CEN-1-YY     PIC 99.
  3019             20  HOLD-CEN-1-MO         PIC 99.
  3020             20  HOLD-CEN-1-DA         PIC 99.
  3021         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3022             20  HOLD-CEN-1-R-MO       PIC 99.
  3023             20  HOLD-CEN-1-R-DA       PIC 99.
  3024             20  HOLD-CEN-1-R-CCYY.
  3025                 24  HOLD-CEN-1-R-CC   PIC 99.
  3026                 24  HOLD-CEN-1-R-YY   PIC 99.
  3027             20  FILLER                PIC 9(3).
  3028         16  HOLD-CENTURY-1-X.
  3029             20  FILLER                PIC X(3)  VALUE SPACES.
  3030             20  HOLD-CEN-1-X-CCYY.
  3031                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3032                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3033             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3034             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3035         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3036             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3037             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3038             20  HOLD-CEN-1-R-X-CCYY.
  3039                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3040                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3041             20  FILLER                PIC XXX.
  3042         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3043         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3044         16  DC-JULIAN-DATE-1          PIC 9(07).
  3045         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3046             20  DC-JULIAN-1-CCYY.
  3047                 24  DC-JULIAN-1-CC    PIC 99.
  3048                 24  DC-JULIAN-1-YR    PIC 99.
  3049             20  DC-JULIAN-DA-1        PIC 999.
  3050         16  DC-JULIAN-DATE-2          PIC 9(07).
  3051         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3052             20  DC-JULIAN-2-CCYY.
  3053                 24  DC-JULIAN-2-CC    PIC 99.
  3054                 24  DC-JULIAN-2-YR    PIC 99.
  3055             20  DC-JULIAN-DA-2        PIC 999.
  3056         16  DC-GREG-DATE-A-EDIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  58
* EL050.cbl
  3057             20  DC-EDITA-MONTH        PIC 99.
  3058             20  SLASHA-1              PIC X VALUE '/'.
  3059             20  DC-EDITA-DAY          PIC 99.
  3060             20  SLASHA-2              PIC X VALUE '/'.
  3061             20  DC-EDITA-CCYY.
  3062                 24  DC-EDITA-CENT     PIC 99.
  3063                 24  DC-EDITA-YEAR     PIC 99.
  3064         16  DC-GREG-DATE-B-EDIT.
  3065             20  DC-EDITB-MONTH        PIC 99.
  3066             20  SLASHB-1              PIC X VALUE '/'.
  3067             20  DC-EDITB-DAY          PIC 99.
  3068             20  SLASHB-2              PIC X VALUE '/'.
  3069             20  DC-EDITB-CCYY.
  3070                 24  DC-EDITB-CENT     PIC 99.
  3071                 24  DC-EDITB-YEAR     PIC 99.
  3072         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3073         16  DC-GREG-DATE-CYMD-R REDEFINES
  3074                              DC-GREG-DATE-CYMD.
  3075             20  DC-CYMD-CEN           PIC 99.
  3076             20  DC-CYMD-YEAR          PIC 99.
  3077             20  DC-CYMD-MONTH         PIC 99.
  3078             20  DC-CYMD-DAY           PIC 99.
  3079         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3080         16  DC-GREG-DATE-MDCY-R REDEFINES
  3081                              DC-GREG-DATE-MDCY.
  3082             20  DC-MDCY-MONTH         PIC 99.
  3083             20  DC-MDCY-DAY           PIC 99.
  3084             20  DC-MDCY-CEN           PIC 99.
  3085             20  DC-MDCY-YEAR          PIC 99.
  3086    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3087        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3088    12  DC-EL310-DATE                  PIC X(21).
  3089    12  FILLER                         PIC X(28).
  3090
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  59
* EL050.cbl
  3092*    COPY ELCCALC.
  3093******************************************************************
  3094*                                                                *
  3095*                           ELCCALC.                            *
  3096*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3097*                            VMOD=2.025                          *
  3098*                                                                *
  3099*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3100*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3101*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3102*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3103*                                                                *
  3104*  PASSED TO ELRTRM                                              *
  3105*  -----------------                                             *
  3106*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3107*  ORIGINAL TERM                                                 *
  3108*  BEGINNING DATE                                                *
  3109*  ENDING DATE                                                   *
  3110*  COMPANY I.D.                                                  *
  3111*  ACCOUNT MASTER USER FIELD                                     *
  3112*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3113*  FREE LOOK DAYS                                                *
  3114*                                                                *
  3115*  RETURNED FROM ELRTRM                                          *
  3116*  ---------------------                                         *
  3117*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3118*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3119*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3120*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3121*----------------------------------------------------------------*
  3122*  PASSED TO ELRAMT                                              *
  3123*  ----------------                                              *
  3124*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3125*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3126*  ORIGINAL AMOUNT                                               *
  3127*  ALTERNATE BENEFIT (BALLON)                                    *
  3128*  A.P.R. - NET PAY ONLY                                         *
  3129*  METHOD
  3130*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3131*  COMPANY I.D.                                                  *
  3132*  BENEFIT TYPE                                                  *
  3133*                                                                *
  3134*  RETURNED FROM ELRAMT                                          *
  3135*  --------------------                                          *
  3136*  REMAINING AMOUNT 1 - CURRENT                                  *
  3137*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3138*  REMAINING AMOUNT FACTOR
  3139*----------------------------------------------------------------*
  3140*  PASSED TO ELRESV                                              *
  3141*  -----------------                                             *
  3142*  CERTIFICATE EFFECTIVE DATE                                    *
  3143*  VALUATION DATE                                                *
  3144*  PAID THRU DATE                                                *
  3145*  BENEFIT                                                       *
  3146*  INCURRED DATE                                                 *
  3147*  REPORTED DATE                                                 *
  3148*  ISSUE AGE                                                     *
  3149*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  60
* EL050.cbl
  3150*  CDT PERCENT                                                   *
  3151*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3152* *CLAIM TYPE (LIFE, A/H)                                        *
  3153* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3154* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3155*                                                                *
  3156*  RETURNED FROM ELRESV                                          *
  3157*  --------------------                                          *
  3158*  CDT TABLE USED                                                *
  3159*  CDT FACTOR USED                                               *
  3160*  PAY TO CURRENT RESERVE                                        *
  3161*  I.B.N.R. - A/H ONLY                                           *
  3162*  FUTURE (ACCRUED) AH ONLY                                      *
  3163*----------------------------------------------------------------*
  3164*  PASSED TO ELRATE                                              *
  3165*  ----------------                                              *
  3166*  CERT ISSUE DATE                                               *
  3167*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3168*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3169*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3170*  STATE CODE (CLIENT DEFINED)                                   *
  3171*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3172*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3173*  DEVIATION CODE                                                *
  3174*  ISSUE AGE                                                     *
  3175*  ORIGINAL BENEFIT AMOUNT                                       *
  3176*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3177*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3178*  BENEFIT KIND (LIFE OR A/H)                                    *
  3179*  A.P.R.                                                        *
  3180*  METHOD
  3181*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3182*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3183*  COMPANY I.D. (3 CHARACTER)                                    *
  3184*  BENEFIT CODE                                                  *
  3185*  BENEFIT OVERRIDE CODE                                         *
  3186*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3187*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3188*  JOINT INDICATOR (CSL ONLY)                                    *
  3189*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3190*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3191*                                                                *
  3192*  RETURNED FROM ELRATE                                          *
  3193*  --------------------                                          *
  3194*  CALCULATED PREMIUM                                            *
  3195*  PREMIUM RATE                                                  *
  3196*  MORTALITY CODE                                                *
  3197*  MAX ATTAINED AGE                                              *
  3198*  MAX AGE                                                       *
  3199*  MAX TERM                                                      *
  3200*  MAX MONTHLY BENEFIT                                           *
  3201*  MAX TOTAL BENIFIT                                             *
  3202*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3203*----------------------------------------------------------------*
  3204*  PASSED TO ELRFND                                              *
  3205*  ----------------                                              *
  3206*  CERT ISSUE DATE                                               *
  3207*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  61
* EL050.cbl
  3208*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3209*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3210*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3211*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3212*  STATE CODE (CLIENT DEFINED)                                   *
  3213*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3214*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3215*  DEVIATION CODE                                                *
  3216*  ISSUE AGE                                                     *
  3217*  ORIGINAL BENEFIT AMOUNT                                       *
  3218*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3219*  PROCESS TYPE (CANCEL)                                         *
  3220*  BENEFIT KIND (LIFE OR A/H)                                    *
  3221*  A.P.R.                                                        *
  3222*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3223*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3224*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3225*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3226*  COMPANY I.D. (3 CHARACTER)                                    *
  3227*  BENEFIT CODE                                                  *
  3228*  BENEFIT OVERRIDE CODE                                         *
  3229*                                                                *
  3230*  RETURNED FROM ELRFND                                          *
  3231*  --------------------                                          *
  3232*  CALCULATED REFUND                                             *
  3233*----------------------------------------------------------------*
  3234*  PASSED TO ELEARN                                              *
  3235*  ----------------                                              *
  3236*  CERT ISSUE DATE                                               *
  3237*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3238*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3239*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3240*  STATE CODE (CLIENT DEFINED)                                   *
  3241*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3242*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3243*  DEVIATION CODE                                                *
  3244*  ISSUE AGE                                                     *
  3245*  ORIGINAL BENEFIT AMOUNT                                       *
  3246*  BENEFIT KIND (LIFE OR A/H)                                    *
  3247*  A.P.R.                                                        *
  3248*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3249*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3250*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3251*  COMPANY I.D. (3 CHARACTER)                                    *
  3252*  BENEFIT CODE                                                  *
  3253*  BENEFIT OVERRIDE CODE                                         *
  3254*                                                                *
  3255*  RETURNED FROM ELEARN                                          *
  3256*  --------------------                                          *
  3257*  INDICATED  EARNINGS                                           *
  3258*----------------------------------------------------------------*
  3259*                 LENGTH = 450                                   *
  3260*                                                                *
  3261******************************************************************
  3262******************************************************************
  3263*                   C H A N G E   L O G
  3264*
  3265* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  62
* EL050.cbl
  3266*-----------------------------------------------------------------
  3267*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3268* EFFECTIVE    NUMBER
  3269*-----------------------------------------------------------------
  3270* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3271* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3272* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3273* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3274* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3275* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3276* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3277* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3278* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3279******************************************************************
  3280
  3281 01  CALCULATION-PASS-AREA.
  3282     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3283                                     COMP.
  3284
  3285     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3286       88  NO-CP-ERROR                             VALUE ZERO.
  3287       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3288                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3289       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3290       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3291       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3292       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3293       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3294       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3295       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3296       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3297       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3298       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3299       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3300       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3301       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3302       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3303       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3304       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3305       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3306
  3307     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3308       88  NO-CP-ERROR-2                           VALUE ZERO.
  3309***********************  INPUT AREAS ****************************
  3310
  3311     12  CP-CALCULATION-AREA.
  3312         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3313         16  CP-CERT-EFF-DT        PIC XX.
  3314         16  CP-VALUATION-DT       PIC XX.
  3315         16  CP-PAID-THRU-DT       PIC XX.
  3316         16  CP-BENEFIT-TYPE       PIC X.
  3317           88  CP-AH                               VALUE 'A' 'D'
  3318                                                   'I' 'U'.
  3319           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3320           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3321         16  CP-INCURRED-DT        PIC XX.
  3322         16  CP-REPORTED-DT        PIC XX.
  3323         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  63
* EL050.cbl
  3324         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3325         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3326                                     COMP-3.
  3327         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3328                                     COMP-3.
  3329         16  CP-CDT-METHOD         PIC X.
  3330           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3331           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3332           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3333         16  CP-CLAIM-TYPE         PIC X.
  3334           88  CP-AH-CLAIM                         VALUE 'A'.
  3335           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3336         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3337                                     COMP-3.
  3338         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3339                                     COMP-3.
  3340         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3341                                     COMP-3.
  3342         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3343                                     COMP-3.
  3344         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3345                                     COMP-3.
  3346         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3347                                     COMP-3.
  3348         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3349                                     COMP-3.
  3350         16  CP-REM-TERM-METHOD    PIC X.
  3351           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3352           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3353           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3354           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3355           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3356           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3357           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3358         16  CP-EARNING-METHOD     PIC X.
  3359           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3360           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3361           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3362           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3363           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3364           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3365           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3366           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3367           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3368           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3369           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3370           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3371           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3372           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3373         16  CP-PROCESS-TYPE       PIC X.
  3374           88  CP-CLAIM                            VALUE '1'.
  3375           88  CP-CANCEL                           VALUE '2'.
  3376           88  CP-ISSUE                            VALUE '3'.
  3377         16  CP-SPECIAL-CALC-CD    PIC X.
  3378           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3379           88  CP-1-MTH-INTEREST               VALUE ' '.
  3380           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3381           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  64
* EL050.cbl
  3382           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3383           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3384           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3385           88  CP-FARM-PLAN                    VALUE 'F'.
  3386           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3387           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3388           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3389           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3390           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3391           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3392           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3393           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3394           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3395           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3396                                                     'W' 'X'.
  3397           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3398           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3399           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3400           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3401           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3402           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3403           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3404           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3405           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3406           88  CP-CSL-METH-1                   VALUE '5'.
  3407           88  CP-CSL-METH-2                   VALUE '6'.
  3408           88  CP-CSL-METH-3                   VALUE '7'.
  3409           88  CP-CSL-METH-4                   VALUE '8'.
  3410
  3411         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3412                                     COMP-3.
  3413         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3414         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3415         16  CP-STATE              PIC XX          VALUE SPACE.
  3416         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3417         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3418           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3419               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3420         16  CP-R78-OPTION         PIC X.
  3421           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3422           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3423
  3424         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3425         16  CP-IBNR-RESERVE-SW    PIC X.
  3426         16  CP-CLAIM-STATUS       PIC X.
  3427         16  CP-RATE-FILE          PIC X.
  3428         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3429                                     COMP-3.
  3430
  3431         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3432         16  CP-AH-OVERRIDE-CODE   PIC X.
  3433
  3434         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3435                                     COMP-3.
  3436         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3437                                   PIC S9(5)V99 COMP-3.
  3438         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3439                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  65
* EL050.cbl
  3440         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3441                                     COMP-3.
  3442         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3443                                     COMP-3.
  3444         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3445                                  PIC S9(7)V99 COMP-3.
  3446
  3447         16  CP-PAID-FROM-DATE     PIC X(02).
  3448         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3449         16  CP-EXT-DAYS-CALC      PIC X.
  3450           88  CP-EXT-NO-CHG                   VALUE ' '.
  3451           88  CP-EXT-CHG-LF                   VALUE '1'.
  3452           88  CP-EXT-CHG-AH                   VALUE '2'.
  3453           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3454         16  CP-DOMICILE-STATE     PIC XX.
  3455         16  CP-CARRIER            PIC X.
  3456         16  CP-REIN-FLAG          PIC X.
  3457         16  CP-REM-TRM-CALC-OPTION PIC X.
  3458           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3459                      '2' '3' '4' '5'.
  3460           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3461           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3462           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3463           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3464           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3465           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3466           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3467           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3468         16  CP-SIG-SWITCH         PIC X.
  3469         16  CP-RATING-METHOD      PIC X.
  3470           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3471           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3472           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3473           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3474           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3475           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3476           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3477           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3478           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3479         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3480                                     COMP-3.
  3481         16  CP-BEN-CATEGORY       PIC X.
  3482         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3483         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3484                                   PIC S99V9(5) COMP-3.
  3485         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3486         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3487                                   PIC S99V9(5) COMP-3.
  3488         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3489         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3490         16  CP-EXPIRE-DT          PIC XX.
  3491         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3492         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3493         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3494         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3495         16  CP-DDF-SPEC-CALC      PIC X.
  3496             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3497             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  66
* EL050.cbl
  3498         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3499         16  CP-CANCEL-REASON      PIC X.
  3500         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3501         16  CP-PMT-MODE           PIC X.
  3502         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3503         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3504         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3505         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3506         16  FILLER                PIC X.
  3507
  3508***************    OUTPUT FROM ELRESV   ************************
  3509
  3510         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3511
  3512         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3513                                     COMP-3.
  3514         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3515                                     COMP-3.
  3516         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3517                                     COMP-3.
  3518         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3519                                     COMP-3.
  3520         16  FILLER                PIC X(09).
  3521***************    OUTPUT FROM ELRTRM   *************************
  3522
  3523         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3524                                     COMP-3.
  3525         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3526                                     COMP-3.
  3527         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3528                                     COMP-3.
  3529         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3530                                     COMP-3.
  3531         16  FILLER                PIC X(12).
  3532
  3533***************    OUTPUT FROM ELRAMT   *************************
  3534
  3535         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3536                                     COMP-3.
  3537         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3538                                     COMP-3.
  3539         16  FILLER                PIC X(12).
  3540
  3541***************    OUTPUT FROM ELRATE   *************************
  3542
  3543         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3544                                     COMP-3.
  3545         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3546                                     COMP-3.
  3547         16  CP-MORTALITY-CODE     PIC X(4).
  3548         16  CP-RATE-EDIT-FLAG     PIC X.
  3549             88  CP-RATES-NEED-APR                  VALUE '1'.
  3550         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3551                                     COMP-3.
  3552         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3553         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3554         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3555                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  67
* EL050.cbl
  3556         16  FILLER                PIC X(07).
  3557
  3558***************    OUTPUT FROM ELRFND   *************************
  3559
  3560         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3561                                     COMP-3.
  3562         16  CP-REFUND-TYPE-USED   PIC X.
  3563           88  CP-R-AS-R78                         VALUE '1'.
  3564           88  CP-R-AS-PRORATA                     VALUE '2'.
  3565           88  CP-R-AS-CALIF                       VALUE '3'.
  3566           88  CP-R-AS-TEXAS                       VALUE '4'.
  3567           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3568           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3569           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3570           88  CP-R-AS-MEAN                        VALUE '8'.
  3571           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3572           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3573           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3574           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3575           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3576           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3577         16  FILLER                PIC X(12).
  3578
  3579***************    OUTPUT FROM ELEARN   *************************
  3580
  3581         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3582                                     COMP-3.
  3583         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3584                                     COMP-3.
  3585         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3586                                     COMP-3.
  3587         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3588                                     COMP-3.
  3589         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3590                                     COMP-3.
  3591         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3592                                     COMP-3.
  3593         16  CP-EARNING-TYPE-USED  PIC X.
  3594           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3595           88  CP-E-AS-R78                         VALUE '1'.
  3596           88  CP-E-AS-PRORATA                     VALUE '2'.
  3597           88  CP-E-AS-TEXAS                       VALUE '4'.
  3598           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3599           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3600           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3601           88  CP-E-AS-MEAN                        VALUE '8'.
  3602           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3603         16  FILLER                PIC X(12).
  3604
  3605***************    OUTPUT FROM ELPMNT   *************************
  3606
  3607         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3608                                     COMP-3.
  3609         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3610                                     COMP-3.
  3611         16  FILLER                PIC X(12).
  3612
  3613***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  68
* EL050.cbl
  3614         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3615                                     COMP-3.
  3616         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3617                                     COMP-3.
  3618         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3619                                     COMP-3.
  3620         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3621                                     COMP-3.
  3622         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3623                                     COMP-3.
  3624         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3625                                     COMP-3.
  3626         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3627             88  OPEN-RATE-FILE                   VALUE 'O'.
  3628             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3629             88  IO-ERROR                         VALUE 'E'.
  3630
  3631         16  CP-FIRST-PAY-DATE     PIC XX.
  3632
  3633         16  CP-JOINT-INDICATOR    PIC X.
  3634
  3635         16  CP-RESERVE-REMAINING-TERM
  3636                                   PIC S9(4)V9    VALUE ZERO
  3637                                     COMP-3.
  3638
  3639         16  CP-INSURED-BIRTH-DT   PIC XX.
  3640
  3641         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3642                                     COMP-3.
  3643
  3644         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3645                                     COMP-3.
  3646
  3647         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3648                                     COMP-3.
  3649
  3650         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3651                                     COMP-3.
  3652
  3653         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3654                                     COMP-3.
  3655
  3656         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3657                                     COMP-3.
  3658
  3659         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3660                                     COMP-3.
  3661
  3662         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3663             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3664
  3665         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3666                                     COMP-3.
  3667         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3668                                     COMP-3.
  3669         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3670         16  FILLER                PIC X(15).
  3671******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  69
* EL050.cbl
  3673******************************************************************
  3674*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3675*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3676*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3677*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3678*** MODIFICATION.                                              ***
  3679*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3680*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3681******************************************************************
  3682*    COPY ERCPNDB.
  3683******************************************************************
  3684*                                                                *
  3685*                                                                *
  3686*                            ERCPNDB.                            *
  3687*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3688*                            VMOD=2.025                          *
  3689*                                                                *
  3690*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3691*                                                                *
  3692******************************************************************
  3693*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3694*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3695******************************************************************
  3696*                                                                *
  3697*                                                                *
  3698*   FILE TYPE = VSAM,KSDS                                        *
  3699*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3700*                                                                *
  3701*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3702*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3703*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3704*                                                 RKP=13,LEN=36  *
  3705*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3706*                                      AND CHG-SEQ.)             *
  3707*                                                RKP=49,LEN=11   *
  3708*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3709*                                      AND CHG-SEQ.)             *
  3710*                                                RKP=60,LEN=15   *
  3711*                                                                *
  3712*   LOG = NO                                                     *
  3713*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3714******************************************************************
  3715******************************************************************
  3716*                   C H A N G E   L O G
  3717*
  3718* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3719*-----------------------------------------------------------------
  3720*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3721* EFFECTIVE    NUMBER
  3722*-----------------------------------------------------------------
  3723* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3724* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3725* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3726* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3727* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3728* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3729* 032306                   PEMA  ADD BOW LOAN NUMBER
  3730* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  70
* EL050.cbl
  3731* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3732* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3733* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3734* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3735* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3736* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3737* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3738******************************************************************
  3739
  3740 01  PENDING-BUSINESS.
  3741     12  PB-RECORD-ID                     PIC XX.
  3742         88  VALID-PB-ID                        VALUE 'PB'.
  3743
  3744     12  PB-CONTROL-PRIMARY.
  3745         16  PB-COMPANY-CD                PIC X.
  3746         16  PB-ENTRY-BATCH               PIC X(6).
  3747         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3748         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3749
  3750     12  PB-CONTROL-BY-ACCOUNT.
  3751         16  PB-COMPANY-CD-A1             PIC X.
  3752         16  PB-CARRIER                   PIC X.
  3753         16  PB-GROUPING.
  3754             20  PB-GROUPING-PREFIX       PIC XXX.
  3755             20  PB-GROUPING-PRIME        PIC XXX.
  3756         16  PB-STATE                     PIC XX.
  3757         16  PB-ACCOUNT.
  3758             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3759             20  PB-ACCOUNT-PRIME         PIC X(6).
  3760         16  PB-CERT-EFF-DT               PIC XX.
  3761         16  PB-CERT-NO.
  3762             20  PB-CERT-PRIME            PIC X(10).
  3763             20  PB-CERT-SFX              PIC X.
  3764         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3765
  3766         16  PB-RECORD-TYPE               PIC X.
  3767             88  PB-MAILING-DATA                VALUE '0'.
  3768             88  PB-ISSUE                       VALUE '1'.
  3769             88  PB-CANCELLATION                VALUE '2'.
  3770             88  PB-BATCH-TRAILER               VALUE '9'.
  3771
  3772     12  PB-CONTROL-BY-ORIG-BATCH.
  3773         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3774         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3775         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3776         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3777
  3778     12  PB-CONTROL-BY-CSR.
  3779         16  PB-CSR-COMPANY-CD            PIC X.
  3780         16  PB-CSR-ID                    PIC X(4).
  3781         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3782         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3783         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3784******************************************************************
  3785*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3786******************************************************************
  3787
  3788     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  71
* EL050.cbl
  3789     12  PB-LAST-MAINT-BY                 PIC X(4).
  3790     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3791
  3792     12  PB-RECORD-BODY                   PIC X(375).
  3793
  3794     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3795         16  PB-CERT-ORIGIN               PIC X.
  3796             88  CLASIC-CREATED-CERT         VALUE '1'.
  3797         16  PB-I-NAME.
  3798             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3799             20  PB-I-INSURED-FIRST-NAME.
  3800                 24  PB-I-INSURED-1ST-INIT PIC X.
  3801                 24  FILLER                PIC X(9).
  3802             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3803         16  PB-I-AGE                     PIC S99   COMP-3.
  3804         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3805         16  PB-I-BIRTHDAY                PIC XX.
  3806         16  PB-I-INSURED-SEX             PIC X.
  3807             88  PB-SEX-MALE     VALUE 'M'.
  3808             88  PB-SEX-FEMALE   VALUE 'F'.
  3809
  3810         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3811         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3812         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3813         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3814         16  PB-I-SKIP-CODE               PIC X.
  3815             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3816             88  PB-SKIP-JULY              VALUE '1'.
  3817             88  PB-SKIP-AUGUST            VALUE '2'.
  3818             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3819             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3820             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3821             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3822             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3823             88  PB-SKIP-JUNE              VALUE '8'.
  3824             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3825             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3826             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3827         16  PB-I-TERM-TYPE               PIC X.
  3828             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3829             88  PB-PAID-WEEKLY            VALUE 'W'.
  3830             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3831             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3832             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3833         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3834         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3835         16  PB-I-DATA-ENTRY-SW           PIC X.
  3836             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3837             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3838             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3839             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3840         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3841         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3842*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3843         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3844         16  FILLER                       PIC X.
  3845
  3846         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  72
* EL050.cbl
  3847             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3848             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3849                                                   '90' THRU '99'.
  3850         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3851                                          PIC XX.
  3852         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3853         16  PB-I-AMOUNT-FINANCED REDEFINES
  3854                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3855         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3856         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3857                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3858         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3859         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3860         16  PB-I-CLP-AMOUNT REDEFINES
  3861                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3862         16  PB-I-LF-CALC-FLAG            PIC X.
  3863             88 PB-COMP-LF-PREM               VALUE '?'.
  3864         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3865         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3866         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3867         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3868         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3869         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3870         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3871         16  PB-I-LF-ABBR                 PIC XXX.
  3872         16  PB-I-LF-INPUT-CD             PIC XX.
  3873
  3874         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3875             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3876             88  PB-INVALID-AH               VALUE '  ' '00'
  3877                                                   '90' THRU '99'.
  3878         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3879         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3880         16  PB-I-AH-CALC-FLAG            PIC X.
  3881             88 PB-COMP-AH-PREM                  VALUE '?'.
  3882         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3883         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3884         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3885         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3886         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3887         16  PB-I-AH-ABBR                 PIC XXX.
  3888         16  PB-I-AH-INPUT-CD             PIC XXX.
  3889
  3890         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  3891         16  PB-I-REIN-TABLE              PIC XXX.
  3892         16  PB-I-BUSINESS-TYPE           PIC 99.
  3893         16  PB-I-INDV-GRP-CD             PIC X.
  3894         16  PB-I-MORT-CODE.
  3895             20  PB-I-TABLE               PIC X.
  3896             20  PB-I-INTEREST            PIC XX.
  3897             20  PB-I-MORT-TYP            PIC X.
  3898         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  3899         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  3900         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  3901         16  PB-I-INDV-GRP-OVRD           PIC X.
  3902         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  3903         16  PB-I-SIG-SW                  PIC X.
  3904             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  73
* EL050.cbl
  3905         16  PB-I-RATE-CLASS              PIC XX.
  3906         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  3907         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  3908         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  3909         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  3910         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  3911         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  3912         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  3913         16  PB-I-BENEFIT-TYPE            PIC XXX.
  3914         16  PB-I-OB-FLAG                 PIC X.
  3915             88  PB-I-OB                      VALUE 'B'.
  3916             88  PB-I-SUMMARY                 VALUE 'Z'.
  3917         16  PB-I-ENTRY-STATUS            PIC X.
  3918             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  3919                                              'M' '5' '9' '2'.
  3920             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  3921             88  PB-I-POLICY-PENDING          VALUE '2'.
  3922             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  3923             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  3924             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  3925             88  PB-I-REIN-ONLY               VALUE '9'.
  3926             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  3927             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  3928             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  3929             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  3930         16  PB-I-INT-CODE                PIC X.
  3931             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  3932             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  3933         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  3934         16  PB-I-SOC-SEC-NO              PIC X(11).
  3935         16  PB-I-MEMBER-NO               PIC X(12).
  3936         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  3937*        16  PB-I-LOAN-OFFICER            PIC XXX.
  3938         16  PB-I-OLD-LOF                 PIC XXX.
  3939         16  PB-I-LF-EXPIRE-DT            PIC XX.
  3940         16  PB-I-AH-EXPIRE-DT            PIC XX.
  3941         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  3942         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  3943         16  PB-I-LIFE-INDICATOR          PIC X.
  3944             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  3945         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  3946         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  3947                                          PIC S9(5)V99    COMP-3.
  3948         16  PB-I-MAIL-ADDRS-SW           PIC X.
  3949             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  3950             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  3951         16  PB-I-1ST-PMT-DT              PIC XX.
  3952         16  PB-I-JOINT-INSURED.
  3953             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  3954             20 PB-I-JOINT-FIRST-NAME.
  3955                24  PB-I-JOINT-FIRST-INIT PIC X.
  3956                24  FILLER                PIC X(9).
  3957             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  3958*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  3959         16  PB-I-BENEFICIARY-NAME.
  3960             20  PB-I-BANK-NUMBER         PIC X(10).
  3961             20  FILLER                   PIC X(15).
  3962         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  74
* EL050.cbl
  3963         16  PB-I-REFERENCE               PIC X(12).
  3964         16  FILLER REDEFINES PB-I-REFERENCE.
  3965             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  3966             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  3967             20  PB-I-CLP-STATE           PIC XX.
  3968         16  PB-I-UNDERWRITING-STATUS     PIC X.
  3969             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  3970             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  3971             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  3972         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  3973         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  3974         16  PB-I-RESIDENT-STATE          PIC XX.
  3975         16  PB-I-RATE-CODE               PIC X(4).
  3976         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  3977         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3978         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3979         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  3980         16  PB-I-BANK-NOCHRGB            PIC 99.
  3981         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  3982         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  3983
  3984     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  3985         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  3986             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  3987         16  PB-C-CANCEL-ORIGIN           PIC X.
  3988             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  3989         16  PB-C-LF-CANCEL-DT            PIC XX.
  3990         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3991         16  PB-C-LF-CALC-REQ             PIC X.
  3992             88 PB-COMP-LF-CANCEL            VALUE '?'.
  3993         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  3994         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  3995         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  3996             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  3997         16  PB-C-AH-CANCEL-DT            PIC XX.
  3998         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3999         16  PB-C-AH-CALC-REQ             PIC X.
  4000             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4001         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4002         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4003         16  PB-C-LAST-NAME               PIC X(15).
  4004         16  PB-C-REFUND-SW               PIC X.
  4005             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4006             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4007         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4008         16  PB-C-PAYEE-CODE              PIC X(6).
  4009         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4010         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4011         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4012         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4013         16  PB-C-REFERENCE               PIC X(12).
  4014         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4015         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4016         16  PB-C-POST-CARD-IND           PIC X.
  4017         16  PB-C-CANCEL-REASON           PIC X.
  4018         16  PB-C-REF-INTERFACE-SW        PIC X.
  4019         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4020         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  75
* EL050.cbl
  4021         16  FILLER                       PIC X(01).
  4022*        16  FILLER                       PIC X(18).
  4023         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4024*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4025         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4026         16  PB-CANCELED-CERT-DATA.
  4027             20  PB-CI-INSURED-NAME.
  4028                 24  PB-CI-LAST-NAME      PIC X(15).
  4029                 24  PB-CI-INITIALS       PIC XX.
  4030             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4031             20  PB-CI-INSURED-SEX        PIC X.
  4032             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4033             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4034             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4035             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4036             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4037             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4038             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4039             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4040             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4041             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4042             20  PB-CI-RATE-CLASS         PIC XX.
  4043             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4044             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4045             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4046             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4047             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4048             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4049             20  PB-CI-LF-ABBR            PIC X(3).
  4050             20  PB-CI-AH-ABBR            PIC X(3).
  4051             20  PB-CI-OB-FLAG            PIC X.
  4052                 88  PB-CI-OB                VALUE 'B'.
  4053             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4054                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4055                                           'M' '4' '5' '9' '2'.
  4056                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4057                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4058                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4059                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4060                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4061                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4062                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4063                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4064                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4065                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4066                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4067                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4068             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4069                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4070                                           'M' '4' '5' '9' '2'.
  4071                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4072                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4073                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4074                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4075                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4076                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4077                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4078                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  76
* EL050.cbl
  4079                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4080                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4081                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4082                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4083             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4084             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4085             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4086             20  PB-CI-MEMBER-NO          PIC X(12).
  4087             20  PB-CI-INT-CODE           PIC X.
  4088                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4089                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4090             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4091             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4092             20  PB-CI-COMP-EXCP-SW       PIC X.
  4093                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4094                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4095             20  PB-CI-ENTRY-STATUS       PIC X.
  4096             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4097             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4098             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4099             20  PB-CI-DEATH-DT           PIC XX.
  4100             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4101             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4102             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4103             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4104             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4105             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4106             20  PB-CI-ENTRY-DT              PIC XX.
  4107             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4108             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4109             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4110             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4111             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4112             20  PB-CI-OLD-LOF               PIC XXX.
  4113*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4114             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4115             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4116             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4117             20  PB-CI-INDV-GRP-CD           PIC X.
  4118             20  PB-CI-BENEFICIARY-NAME.
  4119                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4120                 24  FILLER                  PIC X(15).
  4121             20  PB-CI-NOTE-SW               PIC X.
  4122             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4123             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4124             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4125             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4126             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4127             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4128             20  PB-CI-FIRST-NAME            PIC X(10).
  4129             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4130
  4131         16  FILLER                       PIC X(13).
  4132*032306  16  FILLER                       PIC X(27).
  4133*        16  FILLER                       PIC X(46).
  4134
  4135     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4136         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  77
* EL050.cbl
  4137         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4138         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4139         16  PB-M-INSURED-MID-INIT        PIC X.
  4140         16  PB-M-INSURED-AGE             PIC 99.
  4141         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4142         16  PB-M-INSURED-SEX             PIC X.
  4143         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4144         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4145         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4146         16  PB-M-INSURED-CITY-STATE.
  4147             20  PB-M-INSURED-CITY        PIC X(28).
  4148             20  PB-M-INSURED-STATE       PIC XX.
  4149         16  PB-M-INSURED-ZIP-CODE.
  4150             20  PB-M-INSURED-ZIP-PRIME.
  4151                 24  PB-M-INSURED-ZIP-1   PIC X.
  4152                     88  PB-M-CANADIAN-POST-CODE
  4153                                             VALUE 'A' THRU 'Z'.
  4154                 24  FILLER               PIC X(4).
  4155             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4156         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4157                                        PB-M-INSURED-ZIP-CODE.
  4158             20  PM-M-INS-CAN-POST1       PIC XXX.
  4159             20  PM-M-INS-CAN-POST2       PIC XXX.
  4160             20  FILLER                   PIC XXX.
  4161         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4162         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4163         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4164         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4165         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4166         16  PB-M-CRED-BENE-CITYST.
  4167             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4168             20  PB-M-CRED-BENE-STATE     PIC XX.
  4169         16  FILLER                       PIC X(92).
  4170
  4171     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4172         16  FILLER                       PIC X(10).
  4173         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4174         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4175         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4176         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4177         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4178         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4179         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4180         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4181         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4182         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4183         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4184         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4185         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4186         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4187         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4188         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4189         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4190         16  PB-ACCOUNT-NAME              PIC X(30).
  4191         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4192         16  PB-REFERENCE                 PIC X(12).
  4193         16  PB-B-RECEIVED-DT             PIC XX.
  4194         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  78
* EL050.cbl
  4195
  4196     12  PB-RECORD-STATUS.
  4197         16  PB-CREDIT-SELECT-DT          PIC XX.
  4198         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4199         16  PB-BILLED-DT                 PIC XX.
  4200         16  PB-BILLING-STATUS            PIC X.
  4201             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4202             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4203             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4204         16  PB-RECORD-BILL               PIC X.
  4205             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4206             88  PB-RECORD-RETURNED           VALUE 'R'.
  4207             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4208             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4209             88  PB-OVERRIDE-AH               VALUE 'A'.
  4210             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4211         16  PB-BATCH-ENTRY               PIC X.
  4212             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4213             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4214             88  PB-REISSUED-CERT             VALUE 'E'.
  4215             88  PB-MONTHLY-CERT              VALUE 'M'.
  4216             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4217             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4218             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4219         16  PB-FORCE-CODE                PIC X.
  4220             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4221             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4222             88  PB-CANCEL-FORCE              VALUE '8'.
  4223             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4224             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4225             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4226             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4227             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4228             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4229             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4230         16  PB-FATAL-FLAG                PIC X.
  4231             88  PB-FATAL-ERRORS              VALUE 'X'.
  4232         16  PB-FORCE-ER-CD               PIC X.
  4233             88  PB-FORCE-ERRORS              VALUE 'F'.
  4234             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4235         16  PB-WARN-ER-CD                PIC X.
  4236             88  PB-WARNING-ERRORS            VALUE 'W'.
  4237         16  FILLER                       PIC X.
  4238         16  PB-OUT-BAL-CD                PIC X.
  4239             88  PB-OUT-OF-BAL                VALUE 'O'.
  4240         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4241         16  PB-AH-OVERRIDE-L1            PIC X.
  4242         16  PB-INPUT-DT                  PIC XX.
  4243         16  PB-INPUT-BY                  PIC X(4).
  4244         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4245         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4246         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4247         16  PB-LF-EARNING-METHOD         PIC X.
  4248         16  PB-AH-EARNING-METHOD         PIC X.
  4249         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4250         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4251         16  PB-REIN-CD                   PIC XXX.
  4252         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  79
* EL050.cbl
  4253         16  PB-AH-REFUND-TYPE            PIC X.
  4254         16  PB-ACCT-EFF-DT               PIC XX.
  4255         16  PB-ACCT-EXP-DT               PIC XX.
  4256         16  PB-COMPANY-ID                PIC X(3).
  4257         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4258         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4259         16  PB-SV-CARRIER                PIC X.
  4260         16  PB-SV-GROUPING               PIC X(6).
  4261         16  PB-SV-STATE                  PIC XX.
  4262         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4263         16  PB-GA-BILLING-INFO.
  4264             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4265                                          PIC XX.
  4266         16  PB-SV-REMIT-TO  REDEFINES
  4267             PB-GA-BILLING-INFO           PIC X(10).
  4268         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4269         16  PB-I-LOAN-OFFICER            PIC X(5).
  4270         16  PB-I-VIN                     PIC X(17).
  4271
  4272         16  FILLER                       PIC X(04).
  4273         16  IMNET-BYPASS-SW              PIC X.
  4274
  4275******************************************************************
  4276*                COMMON EDIT ERRORS                              *
  4277******************************************************************
  4278
  4279     12  PB-COMMON-ERRORS.
  4280         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4281                                           PIC S9(4)     COMP.
  4282
  4283******************************************************************
  4284
  4285* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4286*    COPY ELC50W1.
  4287******************************************************************
  4288*                                                                *
  4289*                                                                *
  4290*                             ELC50W1                            *
  4291*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4292*                            VMOD=2.004                          *
  4293*                                                                *
  4294*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4295*                                                                *
  4296*                                                                *
  4297******************************************************************
  4298
  4299     12  WK-WORK-AREA.
  4300         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4301         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4302         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4303         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4304         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4305         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4306         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4307         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4308         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4309         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4310         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  80
* EL050.cbl
  4311         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4312         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4313         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4314         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4315         16  WK-CREDIT-EDIT-CONTROLS.
  4316             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4317             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4318             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4319             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4320             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4321             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4322         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4323         16  WK-SAVE-REIN-DATA.
  4324             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4325             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4326             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4327         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4328             88  ENTRY-FROM-EL6311       VALUE '6'.
  4329         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4330         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4331     12  WK-RECORD-ADDRESSES.
  4332         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4333         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4334         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4335         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4336         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4337         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4338         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4339         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4340     12  WK-OVER-SHORT-AREA.
  4341         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4342         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4343         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4344             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4345         16  FILLER                   PIC X(5) VALUE SPACES.
  4346
  4347*    COPY ELCEDITC.
  4348******************************************************************
  4349*                                                                *
  4350*                                                                *
  4351*                            ELCEDITC                            *
  4352*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4353*                            VMOD=2.012                          *
  4354*                                                                *
  4355*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4356*                     EL6313, EL050 AND EL517.                   *
  4357*                                                                *
  4358******************************************************************
  4359******************************************************************
  4360*                   C H A N G E   L O G
  4361*
  4362* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4363*-----------------------------------------------------------------
  4364*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4365* EFFECTIVE    NUMBER
  4366*-----------------------------------------------------------------
  4367* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4368******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  81
* EL050.cbl
  4369
  4370     12  EDIT-CRITERIA-DATA.
  4371         16  EC-CO-MONTH-END-DT       PIC XX.
  4372         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4373         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4374         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4375         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4376         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4377         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4378         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4379         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4380         16  EC-CO-REM-TERM-CALC      PIC X.
  4381               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4382               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4383               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4384               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4385
  4386         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4387               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4388               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4389               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4390               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4391               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4392               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4393               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4394               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4395               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4396               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4397
  4398         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4399               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4400               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4401               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4402               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4403               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4404               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4405               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4406               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4407
  4408         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4409                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4410                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4411
  4412         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4413                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4414                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4415                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4416                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4417                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4418                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4419                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4420                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4421
  4422         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4423               88  EC-BR-REDUCING                   VALUE 'R'.
  4424               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4425
  4426         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  82
* EL050.cbl
  4427         16  EC-BR-LF-DESC             PIC X(10).
  4428         16  EC-BR-AH-DESC             PIC X(10).
  4429         16  EC-BR-LF-COMMENT          PIC X(10).
  4430         16  EC-BR-AH-COMMENT          PIC X(10).
  4431
  4432         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4433               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4434               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4435               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4436               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4437
  4438         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4439               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4440               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4441               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4442               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4443
  4444         16  EC-BR-LF-REFUND-CALC      PIC X.
  4445                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4446                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4447                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4448                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4449                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4450                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4451                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4452
  4453         16  EC-BR-AH-REFUND-CALC      PIC X.
  4454                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4455                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4456                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4457                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4458                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4459                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4460                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4461                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4462
  4463         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4464                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4465                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4466                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4467
  4468         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4469                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4470                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4471                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4472
  4473         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4474         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4475         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4476         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4477
  4478         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4479         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4480                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4481                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4482                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4483                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4484
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  83
* EL050.cbl
  4485         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4486               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4487               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4488               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4489               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4490               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4491
  4492         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4493               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4494               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4495               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4496               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4497               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4498
  4499         16  EC-ST-LF-REFUND-CALC      PIC X.
  4500                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4501                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4502                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4503                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4504                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4505                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4506                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4507                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4508
  4509         16  EC-ST-AH-REFUND-CALC      PIC X.
  4510                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4511                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4512                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4513                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4514                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4515                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4516                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4517                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4518
  4519         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4520         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4521         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4522         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4523         16  EC-AM-EXPIRATION-DT       PIC XX.
  4524         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4525         16  EC-AM-CLASS-CD            PIC XX.
  4526         16  EC-AM-LF-DEVIATION        PIC XXX.
  4527         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4528         16  EC-AM-AH-DEVIATION        PIC XXX.
  4529         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4530         16  EC-AM-PHONE-NO            PIC X(10).
  4531
  4532         16  EC-AM-LF-REFUND-CALC      PIC X.
  4533                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4534                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4535                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4536                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4537                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4538                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4539                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4540
  4541         16  EC-AM-AH-REFUND-CALC      PIC X.
  4542                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  84
* EL050.cbl
  4543                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4544                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4545                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4546                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4547                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4548                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4549
  4550         16  EC-AM-BEN-I-G-CD          PIC X.
  4551                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4552                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4553                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4554
  4555         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4556         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4557         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4558         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4559         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4560         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4561         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4562         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4563         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4564
  4565         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4566         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4567         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4568         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4569         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4570         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4571         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4572         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4573         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4574         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4575         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4576         16  EC-RT-LF-NSP-ST           PIC XX.
  4577         16  EC-RT-AH-NSP-ST           PIC XX.
  4578         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4579         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4580
  4581         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4582             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4583                                             'M' '5' '9' '2'.
  4584             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4585             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4586             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4587             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4588             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4589             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4590             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4591             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4592             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4593             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4594
  4595         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4596             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4597                                             'M' '5' '9' '2'.
  4598             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4599             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4600             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  85
* EL050.cbl
  4601             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4602             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4603             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4604             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4605             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4606             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4607             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4608
  4609         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4610         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4611         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4612         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4613         16  EC-CM-DEATH-DT            PIC XX.
  4614
  4615*DMD CUSTOM CODING FIELDS BELOW
  4616*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4617         16  EC-BR-DMD-RATING-SW       PIC X.
  4618                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4619                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4620                 88  NO-DMD-RATING               VALUE 'N'.
  4621
  4622         16  EC-NEW-CERT               PIC X(11).
  4623         16  EC-NEW-STATE              PIC XX.
  4624         16  FILLER                    PIC X.
  4625*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4626         16  OVER-SHORT-EDIT-FIELDS.
  4627             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4628             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4629             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4630             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4631             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4632             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4633             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4634             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4635             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4636         16  FILLER                    PIC X(71).
  4637******************************************************************
  4638
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  86
* EL050.cbl
  4640*    COPY ELCDIFRD.
  4641******************************************************************
  4642*                                                                *
  4643*                                                                *
  4644*                            ELCDIFRD.                           *
  4645*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4646*                            VMOD=2.004                          *
  4647*                                                                *
  4648*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4649*                                                                *
  4650******************************************************************
  4651*
  4652  01  WS-DIFFERENCE-CALCULATION.
  4653        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4654        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4655        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4656        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4657        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4658        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4659        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4660        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4661        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4662        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4663        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4664
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  87
* EL050.cbl
  4666****************************************************************
  4667*
  4668* Copyright (c) 2007 by Clerity Solutions, Inc.
  4669* All rights reserved.
  4670*
  4671****************************************************************
  4672 01  DFHEIV.
  4673   02  DFHEIV0               PIC X(35).
  4674   02  DFHEIV1               PIC X(08).
  4675   02  DFHEIV2               PIC X(08).
  4676   02  DFHEIV3               PIC X(08).
  4677   02  DFHEIV4               PIC X(06).
  4678   02  DFHEIV5               PIC X(04).
  4679   02  DFHEIV6               PIC X(04).
  4680   02  DFHEIV7               PIC X(02).
  4681   02  DFHEIV8               PIC X(02).
  4682   02  DFHEIV9               PIC X(01).
  4683   02  DFHEIV10              PIC S9(7) COMP-3.
  4684   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4685   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4686   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4687   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4688   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4689   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4690   02  DFHEIV17              PIC X(04).
  4691   02  DFHEIV18              PIC X(04).
  4692   02  DFHEIV19              PIC X(04).
  4693   02  DFHEIV20              USAGE IS POINTER.
  4694   02  DFHEIV21              USAGE IS POINTER.
  4695   02  DFHEIV22              USAGE IS POINTER.
  4696   02  DFHEIV23              USAGE IS POINTER.
  4697   02  DFHEIV24              USAGE IS POINTER.
  4698   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4699   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4700   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4701   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4702   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4703   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4704   02  FILLER                PIC X(02).
  4705   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4706   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4707   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4708   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4709   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4710 LINKAGE  SECTION.
  4711*****************************************************************
  4712*                                                               *
  4713* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4714* All rights reserved.                                          *
  4715*                                                               *
  4716*****************************************************************
  4717 01  dfheiblk.
  4718     02  eibtime          pic s9(7) comp-3.
  4719     02  eibdate          pic s9(7) comp-3.
  4720     02  eibtrnid         pic x(4).
  4721     02  eibtaskn         pic s9(7) comp-3.
  4722     02  eibtrmid         pic x(4).
  4723     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  88
* EL050.cbl
  4724     02  eibcposn         pic s9(4) comp.
  4725     02  eibcalen         pic s9(4) comp.
  4726     02  eibaid           pic x(1).
  4727     02  eibfiller1       pic x(1).
  4728     02  eibfn            pic x(2).
  4729     02  eibfiller2       pic x(2).
  4730     02  eibrcode         pic x(6).
  4731     02  eibfiller3       pic x(2).
  4732     02  eibds            pic x(8).
  4733     02  eibreqid         pic x(8).
  4734     02  eibrsrce         pic x(8).
  4735     02  eibsync          pic x(1).
  4736     02  eibfree          pic x(1).
  4737     02  eibrecv          pic x(1).
  4738     02  eibsend          pic x(1).
  4739     02  eibatt           pic x(1).
  4740     02  eibeoc           pic x(1).
  4741     02  eibfmh           pic x(1).
  4742     02  eibcompl         pic x(1).
  4743     02  eibsig           pic x(1).
  4744     02  eibconf          pic x(1).
  4745     02  eiberr           pic x(1).
  4746     02  eibrldbk         pic x(1).
  4747     02  eiberrcd         pic x(4).
  4748     02  eibsynrb         pic x(1).
  4749     02  eibnodat         pic x(1).
  4750     02  eibfiller5       pic x(2).
  4751     02  eibresp          pic 9(09) comp.
  4752     02  eibresp2         pic 9(09) comp.
  4753     02  dfheigdj         pic s9(4) comp.
  4754     02  dfheigdk         pic s9(4) comp.
  4755
  4756 01  DFHCOMMAREA                   PIC X(1036).
  4757
  4758*01 PARMLIST .
  4759*    02  FILLER                    PIC S9(8)   COMP.
  4760*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4761*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4762*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4763*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4764*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4765*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4766*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4767
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  89
* EL050.cbl
  4769*    COPY ELCCNTL.
  4770******************************************************************
  4771*                                                                *
  4772*                                                                *
  4773*                            ELCCNTL.                            *
  4774*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4775*                            VMOD=2.059                          *
  4776*                                                                *
  4777*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4778*                                                                *
  4779*   FILE TYPE = VSAM,KSDS                                        *
  4780*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4781*                                                                *
  4782*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4783*       ALTERNATE INDEX = NONE                                   *
  4784*                                                                *
  4785*   LOG = YES                                                    *
  4786*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4787******************************************************************
  4788*                   C H A N G E   L O G
  4789*
  4790* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4791*-----------------------------------------------------------------
  4792*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4793* EFFECTIVE    NUMBER
  4794*-----------------------------------------------------------------
  4795* 082503                   PEMA  ADD BENEFIT GROUP
  4796* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4797* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4798* 092705    2005050300006  PEMA  ADD SPP LEASES
  4799* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4800* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4801* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4802* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4803* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4804******************************************************************
  4805*
  4806 01  CONTROL-FILE.
  4807     12  CF-RECORD-ID                       PIC XX.
  4808         88  VALID-CF-ID                        VALUE 'CF'.
  4809
  4810     12  CF-CONTROL-PRIMARY.
  4811         16  CF-COMPANY-ID                  PIC XXX.
  4812         16  CF-RECORD-TYPE                 PIC X.
  4813             88  CF-COMPANY-MASTER              VALUE '1'.
  4814             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4815             88  CF-STATE-MASTER                VALUE '3'.
  4816             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4817             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4818             88  CF-CARRIER-MASTER              VALUE '6'.
  4819             88  CF-MORTALITY-MASTER            VALUE '7'.
  4820             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4821             88  CF-TERMINAL-MASTER             VALUE '9'.
  4822             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4823             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4824             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4825             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4826             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  90
* EL050.cbl
  4827             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4828             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4829             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4830             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4831         16  CF-ACCESS-CD-GENL              PIC X(4).
  4832         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4833             20  CF-PROCESSOR               PIC X(4).
  4834         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4835             20  CF-STATE-CODE              PIC XX.
  4836             20  FILLER                     PIC XX.
  4837         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4838             20  FILLER                     PIC XX.
  4839             20  CF-HI-BEN-IN-REC           PIC XX.
  4840         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4841             20  FILLER                     PIC XXX.
  4842             20  CF-CARRIER-CNTL            PIC X.
  4843         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4844             20  FILLER                     PIC XX.
  4845             20  CF-HI-TYPE-IN-REC          PIC 99.
  4846         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4847             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4848                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4849             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4850             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4851         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4852             20  FILLER                     PIC X.
  4853             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4854         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4855             20  FILLER                     PIC XX.
  4856             20  CF-MORTGAGE-PLAN           PIC XX.
  4857         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4858
  4859     12  CF-LAST-MAINT-DT                   PIC XX.
  4860     12  CF-LAST-MAINT-BY                   PIC X(4).
  4861     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4862
  4863     12  CF-RECORD-BODY                     PIC X(728).
  4864
  4865
  4866****************************************************************
  4867*             COMPANY MASTER RECORD                            *
  4868****************************************************************
  4869
  4870     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4871         16  CF-COMPANY-ADDRESS.
  4872             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4873             20  CF-CL-IN-CARE-OF           PIC X(30).
  4874             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4875             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4876             20  CF-CL-CITY-STATE           PIC X(30).
  4877             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4878             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4879         16  CF-COMPANY-CD                  PIC X.
  4880         16  CF-COMPANY-PASSWORD            PIC X(8).
  4881         16  CF-SECURITY-OPTION             PIC X.
  4882             88  ALL-SECURITY                   VALUE '1'.
  4883             88  COMPANY-VERIFY                 VALUE '2'.
  4884             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  91
* EL050.cbl
  4885             88  NO-SECURITY                    VALUE '4'.
  4886             88  ALL-BUT-TERM                   VALUE '5'.
  4887         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4888             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4889         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4890             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4891         16  CF-INFORCE-LOCATION            PIC X.
  4892             88  CERTS-ARE-ONLINE               VALUE '1'.
  4893             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4894             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4895         16  CF-LOWER-CASE-LETTERS          PIC X.
  4896         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4897             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4898             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4899             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4900             88  CF-ACCNT-CNTL                  VALUE '3'.
  4901             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4902
  4903         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4904         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4905
  4906         16  CF-LGX-CREDIT-USER             PIC X.
  4907             88  CO-IS-NOT-USER                 VALUE 'N'.
  4908             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4909
  4910         16 CF-CREDIT-CALC-CODES.
  4911             20  CF-CR-REM-TERM-CALC PIC X.
  4912               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4913               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4914               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4915               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4916               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4917               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4918               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4919             20  CF-CR-R78-METHOD           PIC X.
  4920               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4921               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4922
  4923         16  CF-CLAIM-CONTROL-COUNTS.
  4924             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4925                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4926
  4927             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4928                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4929
  4930             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4931                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4932
  4933             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4934                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4935
  4936         16  CF-CURRENT-MONTH-END           PIC XX.
  4937
  4938         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4939             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4940             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4941             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4942             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  92
* EL050.cbl
  4943                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4944                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4945             20  CF-CO-PREM-REJECT-SW       PIC X.
  4946                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4947                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4948             20  CF-CO-REF-REJECT-SW        PIC X.
  4949                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4950                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4951
  4952         16  CF-CO-REPORTING-DT             PIC XX.
  4953         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4954         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4955           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4956           88  CF-CO-MONTH-END                  VALUE '1'.
  4957
  4958         16  CF-LGX-CLAIM-USER              PIC X.
  4959             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4960             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4961
  4962         16  CF-CREDIT-EDIT-CONTROLS.
  4963             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4964             20  CF-MIN-AGE                 PIC 99.
  4965             20  CF-DEFAULT-AGE             PIC 99.
  4966             20  CF-MIN-TERM                PIC S999      COMP-3.
  4967             20  CF-MAX-TERM                PIC S999      COMP-3.
  4968             20  CF-DEFAULT-SEX             PIC X.
  4969             20  CF-JOINT-AGE-INPUT         PIC X.
  4970                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4971             20  CF-BIRTH-DATE-INPUT        PIC X.
  4972                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4973             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4974                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4975                 88  CF-ZERO-CARRIER            VALUE '1'.
  4976                 88  CF-ZERO-GROUPING           VALUE '2'.
  4977                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4978             20  CF-EDIT-SW                 PIC X.
  4979                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4980             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4981             20  CF-CR-PR-METHOD            PIC X.
  4982               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4983               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4984             20  FILLER                     PIC X.
  4985
  4986         16  CF-CREDIT-MISC-CONTROLS.
  4987             20  CF-REIN-TABLE-SW           PIC X.
  4988                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4989             20  CF-COMP-TABLE-SW           PIC X.
  4990                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4991             20  CF-EXPERIENCE-RETENTION-AGE
  4992                                            PIC S9        COMP-3.
  4993             20  CF-CONVERSION-DT           PIC XX.
  4994             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4995             20  CF-RUN-FREQUENCY-SW        PIC X.
  4996                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4997                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4998
  4999             20  CF-CR-CHECK-NO-CONTROL.
  5000                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  93
* EL050.cbl
  5001                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5002                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5003                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5004                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5005                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5006
  5007                 24  CF-CR-CHECK-COUNT       REDEFINES
  5008                     CF-CR-CHECK-COUNTER      PIC X(4).
  5009
  5010                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5011                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5012
  5013                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5014                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5015                 24  CF-MAIL-PROCESSING       PIC X.
  5016                     88  MAIL-PROCESSING          VALUE 'Y'.
  5017
  5018         16  CF-MISC-SYSTEM-CONTROL.
  5019             20  CF-SYSTEM-C                 PIC X.
  5020                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5021             20  CF-SYSTEM-D                 PIC X.
  5022                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5023             20  CF-SOC-SEC-NO-SW            PIC X.
  5024                 88  SOC-SEC-NO-USED             VALUE '1'.
  5025             20  CF-MEMBER-NO-SW             PIC X.
  5026                 88  MEMBER-NO-USED              VALUE '1'.
  5027             20  CF-TAX-ID-NUMBER            PIC X(11).
  5028             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5029             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5030                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5031                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5032                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5033                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5034             20  CF-SYSTEM-E                 PIC X.
  5035                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5036
  5037         16  CF-LGX-LIFE-USER               PIC X.
  5038             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5039             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5040
  5041         16  CF-CR-MONTH-END-DT             PIC XX.
  5042
  5043         16  CF-FILE-MAINT-DATES.
  5044             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5045                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5046             20  CF-LAST-BATCH       REDEFINES
  5047                 CF-LAST-BATCH-NO               PIC X(4).
  5048             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5049             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5050             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5051             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5052             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5053             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5054             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5055             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5056             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5057             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5058
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  94
* EL050.cbl
  5059         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5060         16  FILLER                         PIC X.
  5061
  5062         16  CF-ALT-MORT-CODE               PIC X(4).
  5063         16  CF-MEMBER-CAPTION              PIC X(10).
  5064
  5065         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5066             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5067             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5068             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5069             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5070             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5071
  5072         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5073
  5074         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5075         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5076         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5077         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5078
  5079         16  CF-AH-OVERRIDE-L1              PIC X.
  5080         16  CF-AH-OVERRIDE-L2              PIC XX.
  5081         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5082         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5083
  5084         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5085         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5086
  5087         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5088         16  CF-AR-LAST-EL860-DT            PIC XX.
  5089         16  CF-MP-MONTH-END-DT             PIC XX.
  5090
  5091         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5092         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5093             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5094
  5095         16  CF-AR-MONTH-END-DT             PIC XX.
  5096
  5097         16  CF-CRDTCRD-USER                PIC X.
  5098             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5099             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5100
  5101         16  CF-CC-MONTH-END-DT             PIC XX.
  5102
  5103         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5104
  5105         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5106             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5107             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5108             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5109         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5110         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5111         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5112         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5113             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5114             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5115         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5116         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  95
* EL050.cbl
  5117         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5118             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5119         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5120
  5121         16  CF-CL-ZIP-CODE.
  5122             20  CF-CL-ZIP-PRIME.
  5123                 24  CF-CL-ZIP-1ST          PIC X.
  5124                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5125                 24  FILLER                 PIC X(4).
  5126             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5127         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5128             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5129             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5130             20  FILLER                     PIC XXX.
  5131
  5132         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5133         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5134         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5135         16  CF-CO-OPTION-START-DATE        PIC XX.
  5136         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5137           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5138                                                      '3' '4'.
  5139           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5140           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5141           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5142           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5143           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5144           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5145
  5146         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5147
  5148         16  CF-PAYMENT-APPROVAL-LEVELS.
  5149             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5150             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5151             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5152             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5153             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5154             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5155
  5156         16  CF-END-USER-REPORTING-USER     PIC X.
  5157             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5158             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5159
  5160         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5161             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5162             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5163
  5164         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5165
  5166         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5167         16  FILLER                         PIC X.
  5168
  5169         16  CF-CREDIT-ARCHIVE-CNTL.
  5170             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5171             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5172             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5173
  5174         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  96
* EL050.cbl
  5175
  5176         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5177             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5178             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5179
  5180         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5181             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5182             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5183
  5184         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5185
  5186         16  CF-CO-ACH-ID-CODE              PIC  X.
  5187             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5188             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5189             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5190         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5191         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5192         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5193         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5194         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5195         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5196         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5197         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5198         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5199                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5200         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5201                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5202
  5203         16  CF-CO-OVER-SHORT.
  5204             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5205             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5206
  5207*         16  FILLER                         PIC X(102).
  5208         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5209             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5210             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5211
  5212         16  CF-AH-APPROVAL-DAYS.
  5213             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5214             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5215             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5216             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5217
  5218         16  FILLER                         PIC X(82).
  5219****************************************************************
  5220*             PROCESSOR/USER RECORD                            *
  5221****************************************************************
  5222
  5223     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5224         16  CF-PROCESSOR-NAME              PIC X(30).
  5225         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5226         16  CF-PROCESSOR-TITLE             PIC X(26).
  5227         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5228                 88  MESSAGE-YES                VALUE 'Y'.
  5229                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5230
  5231*****************************************************
  5232****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  97
* EL050.cbl
  5233****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5234****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5235****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5236*****************************************************
  5237
  5238         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5239             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5240             20  CF-APPLICATION-FORCE       PIC X.
  5241             20  CF-INDIVIDUAL-APP.
  5242                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5243                     28  CF-BROWSE-APP      PIC X.
  5244                     28  CF-UPDATE-APP      PIC X.
  5245
  5246         16  CF-CURRENT-TERM-ON             PIC X(4).
  5247         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5248             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5249             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5250             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5251             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5252             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5253             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5254             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5255         16  CF-PROCESSOR-CARRIER           PIC X.
  5256             88  NO-CARRIER-SECURITY            VALUE ' '.
  5257         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5258             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5259         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5260             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5261         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5262             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5263
  5264         16  CF-PROC-SYS-ACCESS-SW.
  5265             20  CF-PROC-CREDIT-CLAIMS-SW.
  5266                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5267                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5268                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5269                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5270             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5271                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5272                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5273             20  CF-PROC-LIFE-GNRLDGR-SW.
  5274                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5275                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5276                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5277                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5278             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5279                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5280                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5281         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5282             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5283             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5284         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5285
  5286         16  CF-APPROVAL-LEVEL                  PIC X.
  5287             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5288             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5289             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5290             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  98
* EL050.cbl
  5291
  5292         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5293
  5294         16  CF-LANGUAGE-TYPE                   PIC X.
  5295             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5296             88  CF-LANG-IS-FR                      VALUE 'F'.
  5297         16  FILLER                             PIC  X(240).
  5298
  5299****************************************************************
  5300*             PROCESSOR/REMINDERS RECORD                       *
  5301****************************************************************
  5302
  5303     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5304         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5305             20  CF-START-REMIND-DT         PIC XX.
  5306             20  CF-END-REMIND-DT           PIC XX.
  5307             20  CF-REMINDER-TEXT           PIC X(50).
  5308         16  FILLER                         PIC X(296).
  5309
  5310
  5311****************************************************************
  5312*             STATE MASTER RECORD                              *
  5313****************************************************************
  5314
  5315     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5316         16  CF-STATE-ABBREVIATION          PIC XX.
  5317         16  CF-STATE-NAME                  PIC X(25).
  5318         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5319         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5320             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5321             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5322             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5323             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5324                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5325                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5326             20  CF-ST-PREM-REJECT-SW       PIC X.
  5327                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5328                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5329             20  CF-ST-REF-REJECT-SW        PIC X.
  5330                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5331                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5332         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5333         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5334         16  CF-ST-REFUND-RULES.
  5335             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5336             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5337             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5338         16  CF-ST-FST-PMT-EXTENSION.
  5339             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5340             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5341                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5342                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5343                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5344                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5345         16  CF-ST-STATE-CALL.
  5346             20  CF-ST-CALL-UNEARNED        PIC X.
  5347             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5348             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page  99
* EL050.cbl
  5349         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5350             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5351             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5352         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5353         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5354         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5355         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5356         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5357         16  FILLER                         PIC X.
  5358         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5359             20  CF-ST-BENEFIT-CD           PIC XX.
  5360             20  CF-ST-BENEFIT-KIND         PIC X.
  5361                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5362                 88  CF-ST-AH-KIND              VALUE 'A'.
  5363             20  CF-ST-REM-TERM-CALC        PIC X.
  5364                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5365                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5366                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5367                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5368                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5369                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5370                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5371                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5372
  5373             20  CF-ST-REFUND-CALC          PIC X.
  5374                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5375                 88  ST-REFD-BY-R78             VALUE '1'.
  5376                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5377                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5378                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5379                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5380                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5381                 88  ST-REFD-UTAH               VALUE '7'.
  5382                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5383                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5384                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5385
  5386             20  CF-ST-EARNING-CALC         PIC X.
  5387                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5388                 88  ST-EARN-BY-R78             VALUE '1'.
  5389                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5390                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5391                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5392                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5393                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5394                 88  ST-EARN-MEAN               VALUE '8'.
  5395                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5396
  5397             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5398                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5399                 88  ST-OVRD-BY-R78             VALUE '1'.
  5400                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5401                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5402                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5403                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5404                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5405                 88  ST-OVRD-MEAN               VALUE '8'.
  5406                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 100
* EL050.cbl
  5407             20  FILLER                     PIC X.
  5408
  5409         16  CF-ST-COMMISSION-CAPS.
  5410             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5411             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5412             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5413             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5414         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5415                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5416
  5417         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5418
  5419         16  CF-ST-STATUTORY-INTEREST.
  5420             20  CF-ST-STAT-DATE-FROM       PIC X.
  5421                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5422                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5423             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5424             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5425             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5426             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5427             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5428
  5429         16  CF-ST-OVER-SHORT.
  5430             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5431             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5432
  5433         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5434
  5435         16  CF-ST-RT-CALC                  PIC X.
  5436
  5437         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5438         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5439         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5440         16  CF-ST-RF-LR-CALC               PIC X.
  5441         16  CF-ST-RF-LL-CALC               PIC X.
  5442         16  CF-ST-RF-LN-CALC               PIC X.
  5443         16  CF-ST-RF-AH-CALC               PIC X.
  5444         16  CF-ST-RF-CP-CALC               PIC X.
  5445*        16  FILLER                         PIC X(206).
  5446*CIDMOD         16  FILLER                         PIC X(192).
  5447         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5448             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5449         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5450         16  CF-ST-VFY-2ND-BENE             PIC X.
  5451         16  FILLER                         PIC X(186).
  5452
  5453****************************************************************
  5454*             BENEFIT MASTER RECORD                            *
  5455****************************************************************
  5456
  5457     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5458         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5459             20  CF-BENEFIT-CODE            PIC XX.
  5460             20  CF-BENEFIT-NUMERIC  REDEFINES
  5461                 CF-BENEFIT-CODE            PIC XX.
  5462             20  CF-BENEFIT-ALPHA           PIC XXX.
  5463             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5464             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 101
* EL050.cbl
  5465
  5466             20  CF-LF-COVERAGE-TYPE        PIC X.
  5467                 88  CF-REDUCING                VALUE 'R'.
  5468                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5469
  5470             20  CF-SPECIAL-CALC-CD         PIC X.
  5471                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5472                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5473                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5474                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5475                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5476                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5477                 88  CF-FARM-PLAN               VALUE 'F'.
  5478                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5479                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5480                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5481                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5482                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5483                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5484                 88  CF-PRUDENTIAL              VALUE 'P'.
  5485                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5486                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5487                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5488                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5489                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5490                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5491
  5492             20  CF-JOINT-INDICATOR         PIC X.
  5493                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5494
  5495*            20  FILLER                     PIC X(12).
  5496             20  FILLER                     PIC X(11).
  5497             20  CF-BENEFIT-CATEGORY        PIC X.
  5498             20  CF-LOAN-TYPE               PIC X(8).
  5499
  5500             20  CF-CO-REM-TERM-CALC        PIC X.
  5501                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5502                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5503                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5504                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5505                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5506
  5507             20  CF-CO-EARNINGS-CALC        PIC X.
  5508                 88  CO-EARN-BY-R78             VALUE '1'.
  5509                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5510                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5511                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5512                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5513                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5514                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5515                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5516
  5517             20  CF-CO-REFUND-CALC          PIC X.
  5518                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5519                 88  CO-REFD-BY-R78             VALUE '1'.
  5520                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5521                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5522                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 102
* EL050.cbl
  5523                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5524                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5525                 88  CO-REFD-MEAN               VALUE '8'.
  5526                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5527                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5528                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5529
  5530             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5531                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5532                 88  CO-OVRD-BY-R78             VALUE '1'.
  5533                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5534                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5535                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5536                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5537                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5538                 88  CO-OVRD-MEAN               VALUE '8'.
  5539                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5540
  5541             20  CF-CO-BEN-I-G-CD           PIC X.
  5542                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5543                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5544                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5545
  5546         16  FILLER                         PIC X(304).
  5547
  5548
  5549****************************************************************
  5550*             CARRIER MASTER RECORD                            *
  5551****************************************************************
  5552
  5553     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5554         16  CF-ADDRESS-DATA.
  5555             20  CF-MAIL-TO-NAME            PIC X(30).
  5556             20  CF-IN-CARE-OF              PIC X(30).
  5557             20  CF-ADDRESS-LINE-1          PIC X(30).
  5558             20  CF-ADDRESS-LINE-2          PIC X(30).
  5559             20  CF-CITY-STATE              PIC X(30).
  5560             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5561             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5562
  5563         16  CF-CLAIM-NO-CONTROL.
  5564             20  CF-CLAIM-NO-METHOD         PIC X.
  5565                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5566                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5567                 88  CLAIM-NO-SEQ               VALUE '3'.
  5568                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5569             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5570                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5571                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5572                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5573
  5574         16  CF-CHECK-NO-CONTROL.
  5575             20  CF-CHECK-NO-METHOD         PIC X.
  5576                 88  CHECK-NO-MANUAL            VALUE '1'.
  5577                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5578                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5579                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5580             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 103
* EL050.cbl
  5581                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5582
  5583         16  CF-DOMICILE-STATE              PIC XX.
  5584
  5585         16  CF-EXPENSE-CONTROLS.
  5586             20  CF-EXPENSE-METHOD          PIC X.
  5587                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5588                 88  DOLLARS-PER-PMT            VALUE '2'.
  5589                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5590                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5591             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5592             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5593
  5594         16  CF-CORRESPONDENCE-CONTROL.
  5595             20  CF-LETTER-RESEND-OPT       PIC X.
  5596                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5597                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5598             20  FILLER                     PIC X(4).
  5599
  5600         16  CF-RESERVE-CONTROLS.
  5601             20  CF-MANUAL-SW               PIC X.
  5602                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5603             20  CF-FUTURE-SW               PIC X.
  5604                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5605             20  CF-PTC-SW                  PIC X.
  5606                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5607             20  CF-IBNR-SW                 PIC X.
  5608                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5609             20  CF-PTC-LF-SW               PIC X.
  5610                 88  CF-LF-PTC-USED             VALUE '1'.
  5611             20  CF-CDT-ACCESS-METHOD       PIC X.
  5612                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5613                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5614                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5615             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5616
  5617         16  CF-CLAIM-CALC-METHOD           PIC X.
  5618             88  360-PLUS-MONTHS                VALUE '1'.
  5619             88  365-PLUS-MONTHS                VALUE '2'.
  5620             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5621             88  360-DAILY                      VALUE '4'.
  5622             88  365-DAILY                      VALUE '5'.
  5623
  5624         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5625         16  FILLER                         PIC X(11).
  5626
  5627         16  CF-LIMIT-AMOUNTS.
  5628             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5629             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5630             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5631             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5632             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5633             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5634             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5635             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5636             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5637             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5638
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 104
* EL050.cbl
  5639         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5640         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5641         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5642
  5643         16  CF-ZIP-CODE.
  5644             20  CF-ZIP-PRIME.
  5645                 24  CF-ZIP-1ST             PIC X.
  5646                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5647                 24  FILLER                 PIC X(4).
  5648             20  CF-ZIP-PLUS4               PIC X(4).
  5649         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5650             20  CF-CAN-POSTAL-1            PIC XXX.
  5651             20  CF-CAN-POSTAL-2            PIC XXX.
  5652             20  FILLER                     PIC XXX.
  5653
  5654         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5655         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5656         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5657
  5658         16  CF-RATING-SWITCH               PIC X.
  5659             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5660             88  CF-NO-RATING                   VALUE 'N'.
  5661
  5662         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5663
  5664         16  CF-CARRIER-OVER-SHORT.
  5665             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5666             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5667
  5668         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5669         16  CF-SECPAY-SWITCH               PIC X.
  5670             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5671             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5672         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5673         16  FILLER                         PIC X(448).
  5674*        16  FILLER                         PIC X(452).
  5675
  5676
  5677****************************************************************
  5678*             MORTALITY MASTER RECORD                          *
  5679****************************************************************
  5680
  5681     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5682         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5683                                INDEXED BY CF-MORT-NDX.
  5684             20  CF-MORT-TABLE              PIC X(5).
  5685             20  CF-MORT-TABLE-TYPE         PIC X.
  5686                 88  CF-MORT-JOINT              VALUE 'J'.
  5687                 88  CF-MORT-SINGLE             VALUE 'S'.
  5688                 88  CF-MORT-COMBINED           VALUE 'C'.
  5689                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5690                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5691             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5692             20  CF-MORT-AGE-METHOD         PIC XX.
  5693                 88  CF-AGE-LAST                VALUE 'AL'.
  5694                 88  CF-AGE-NEAR                VALUE 'AN'.
  5695             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5696             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 105
* EL050.cbl
  5697                                            PIC X.
  5698                 88  CF-MINUS                   VALUE '-'.
  5699                 88  CF-PLUS                    VALUE '+'.
  5700             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5701             20  CF-MORT-JOINT-CODE         PIC X.
  5702                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5703             20  CF-MORT-PC-Q               PIC X.
  5704                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5705             20  CF-MORT-TABLE-CODE         PIC X(4).
  5706             20  CF-MORT-COMMENTS           PIC X(15).
  5707             20  FILLER                     PIC X(14).
  5708
  5709         16  FILLER                         PIC X(251).
  5710
  5711
  5712****************************************************************
  5713*             BUSSINESS TYPE MASTER RECORD                     *
  5714****************************************************************
  5715
  5716     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5717* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5718* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5719* AND RECORD 05 IS TYPES 81-99
  5720         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5721             20  CF-BUSINESS-TITLE          PIC  X(19).
  5722             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5723                                            PIC S9V9(4) COMP-3.
  5724             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5725             20  FILLER                     PIC  X.
  5726         16  FILLER                         PIC  X(248).
  5727
  5728
  5729****************************************************************
  5730*             TERMINAL MASTER RECORD                           *
  5731****************************************************************
  5732
  5733     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5734
  5735         16  CF-COMPANY-TERMINALS.
  5736             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5737                                  PIC X(4).
  5738         16  FILLER               PIC X(248).
  5739
  5740
  5741****************************************************************
  5742*             LIFE EDIT MASTER RECORD                          *
  5743****************************************************************
  5744
  5745     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5746         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5747             20  CF-LIFE-CODE-IN            PIC XX.
  5748             20  CF-LIFE-CODE-OUT           PIC XX.
  5749         16  FILLER                         PIC X(248).
  5750
  5751
  5752****************************************************************
  5753*             AH EDIT MASTER RECORD                            *
  5754****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 106
* EL050.cbl
  5755
  5756     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5757         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5758             20  CF-AH-CODE-IN              PIC XXX.
  5759             20  CF-AH-CODE-OUT             PIC XX.
  5760         16  FILLER                         PIC X(248).
  5761
  5762
  5763****************************************************************
  5764*             CREDIBILITY TABLES                               *
  5765****************************************************************
  5766
  5767     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5768         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5769                             INDEXED BY CF-CRDB-NDX.
  5770             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5771             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5772             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5773         16  FILLER                         PIC  X(332).
  5774
  5775
  5776****************************************************************
  5777*             REPORT CUSTOMIZATION RECORD                      *
  5778****************************************************************
  5779
  5780     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5781         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5782             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5783             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5784             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5785**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5786****       A T-TRANSFER.                                   ****
  5787             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5788
  5789         16  FILLER                         PIC XX.
  5790
  5791         16  CF-CARRIER-CNTL-OPT.
  5792             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5793                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5794                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5795             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5796                                            PIC X.
  5797         16  CF-GROUP-CNTL-OPT.
  5798             20  CF-GROUP-OPT-SEQ           PIC 9.
  5799                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5800                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5801             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5802                                            PIC X(6).
  5803         16  CF-STATE-CNTL-OPT.
  5804             20  CF-STATE-OPT-SEQ           PIC 9.
  5805                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5806                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5807             20  CF-STATE-SELECT OCCURS 3 TIMES
  5808                                            PIC XX.
  5809         16  CF-ACCOUNT-CNTL-OPT.
  5810             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5811                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5812                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 107
* EL050.cbl
  5813             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5814                                            PIC X(10).
  5815         16  CF-BUS-TYP-CNTL-OPT.
  5816             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5817                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5818                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5819             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5820                                            PIC XX.
  5821         16  CF-LF-TYP-CNTL-OPT.
  5822             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5823                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5824                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5825             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5826                                            PIC XX.
  5827         16  CF-AH-TYP-CNTL-OPT.
  5828             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5829                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5830                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5831             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5832                                            PIC XX.
  5833         16  CF-REPTCD1-CNTL-OPT.
  5834             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5835                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5836                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5837             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5838                                            PIC X(10).
  5839         16  CF-REPTCD2-CNTL-OPT.
  5840             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5841                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5842                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5843             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5844                                            PIC X(10).
  5845         16  CF-USER1-CNTL-OPT.
  5846             20  CF-USER1-OPT-SEQ           PIC 9.
  5847                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5848                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5849             20  CF-USER1-SELECT OCCURS 3 TIMES
  5850                                            PIC X(10).
  5851         16  CF-USER2-CNTL-OPT.
  5852             20  CF-USER2-OPT-SEQ           PIC 9.
  5853                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5854                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5855             20  CF-USER2-SELECT OCCURS 3 TIMES
  5856                                            PIC X(10).
  5857         16  CF-USER3-CNTL-OPT.
  5858             20  CF-USER3-OPT-SEQ           PIC 9.
  5859                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5860                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5861             20  CF-USER3-SELECT OCCURS 3 TIMES
  5862                                            PIC X(10).
  5863         16  CF-USER4-CNTL-OPT.
  5864             20  CF-USER4-OPT-SEQ           PIC 9.
  5865                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5866                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5867             20  CF-USER4-SELECT OCCURS 3 TIMES
  5868                                            PIC X(10).
  5869         16  CF-USER5-CNTL-OPT.
  5870             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 108
* EL050.cbl
  5871                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5872                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5873             20  CF-USER5-SELECT OCCURS 3 TIMES
  5874                                            PIC X(10).
  5875         16  CF-REINS-CNTL-OPT.
  5876             20  CF-REINS-OPT-SEQ           PIC 9.
  5877                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5878                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5879             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5880                 24  CF-REINS-PRIME         PIC XXX.
  5881                 24  CF-REINS-SUB           PIC XXX.
  5882
  5883         16  CF-AGENT-CNTL-OPT.
  5884             20  CF-AGENT-OPT-SEQ           PIC 9.
  5885                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5886                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5887             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5888                                            PIC X(10).
  5889
  5890         16  FILLER                         PIC X(43).
  5891
  5892         16  CF-LOSS-RATIO-SELECT.
  5893             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5894             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5895         16  CF-ENTRY-DATE-SELECT.
  5896             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5897             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5898         16  CF-EFFECTIVE-DATE-SELECT.
  5899             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5900             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5901
  5902         16  CF-EXCEPTION-LIST-IND          PIC X.
  5903             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5904
  5905         16  FILLER                         PIC X(318).
  5906
  5907****************************************************************
  5908*                  EXCEPTION REPORTING RECORD                  *
  5909****************************************************************
  5910
  5911     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5912         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5913             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5914
  5915         16  CF-COMBINED-LIFE-AH-OPT.
  5916             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5917             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5918             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5919             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5920
  5921         16  CF-LIFE-OPT.
  5922             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5923             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5924             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5925             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5926             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5927             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5928             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 109
* EL050.cbl
  5929             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5930             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5931             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5932
  5933         16  CF-AH-OPT.
  5934             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5935             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5936             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5937             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5938             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5939             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5940             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5941             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5942             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5943             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5944
  5945         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5946             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5947             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5948             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5949
  5950         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5951
  5952         16  FILLER                         PIC X(673).
  5953
  5954
  5955****************************************************************
  5956*             MORTGAGE SYSTEM PLAN RECORD                      *
  5957****************************************************************
  5958
  5959     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5960         16  CF-PLAN-TYPE                   PIC X.
  5961             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5962             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5963             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5964         16  CF-PLAN-ABBREV                 PIC XXX.
  5965         16  CF-PLAN-DESCRIPT               PIC X(10).
  5966         16  CF-PLAN-NOTES                  PIC X(20).
  5967         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5968         16  CF-PLAN-UNDERWRITING.
  5969             20  CF-PLAN-TERM-DATA.
  5970                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5971                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5972             20  CF-PLAN-AGE-DATA.
  5973                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5974                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5975                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5976             20  CF-PLAN-BENEFIT-DATA.
  5977                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5978                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5979                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5980                                            PIC S9(7)V99  COMP-3.
  5981         16  CF-PLAN-POLICY-FORMS.
  5982             20  CF-POLICY-FORM             PIC X(12).
  5983             20  CF-MASTER-APPLICATION      PIC X(12).
  5984             20  CF-MASTER-POLICY           PIC X(12).
  5985         16  CF-PLAN-RATING.
  5986             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 110
* EL050.cbl
  5987             20  CF-SEX-RATING              PIC X.
  5988                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5989                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5990             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5991             20  CF-SUB-STD-TYPE            PIC X.
  5992                 88  CF-PCT-OF-PREM            VALUE '1'.
  5993                 88  CF-PCT-OF-BENE            VALUE '2'.
  5994         16  CF-PLAN-PREM-TOLERANCES.
  5995             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5996             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5997         16  CF-PLAN-PYMT-TOLERANCES.
  5998             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5999             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6000         16  CF-PLAN-MISC-DATA.
  6001             20  FILLER                     PIC X.
  6002             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6003             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6004         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6005         16  CF-PLAN-IND-GRP                PIC X.
  6006             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6007                                                     '1'.
  6008             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6009                                                     '2'.
  6010         16  CF-MIB-SEARCH-SW               PIC X.
  6011             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6012             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6013             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6014             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6015         16  CF-ALPHA-SEARCH-SW             PIC X.
  6016             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6017             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6018             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6019             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6020             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6021             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6022             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6023             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6024             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6025             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6026                                                     'A' 'B' 'C'
  6027                                                     'X' 'Y' 'Z'.
  6028         16  CF-EFF-DT-RULE-SW              PIC X.
  6029             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6030             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6031             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6032             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6033             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6034         16  FILLER                         PIC X(4).
  6035         16  CF-HEALTH-QUESTIONS            PIC X.
  6036             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6037         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6038         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6039         16  CF-PLAN-SNGL-JNT               PIC X.
  6040             88  CF-COMBINED-PLAN              VALUE 'C'.
  6041             88  CF-JNT-PLAN                   VALUE 'J'.
  6042             88  CF-SNGL-PLAN                  VALUE 'S'.
  6043         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6044         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 111
* EL050.cbl
  6045         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6046         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6047         16  CF-RERATE-CNTL                 PIC  X.
  6048             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6049             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6050             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6051             88  CF-AUTO-RECALC                 VALUE '4'.
  6052         16  CF-BENEFIT-TYPE                PIC  X.
  6053             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6054             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6055         16  CF-POLICY-FEE                  PIC S999V99
  6056                                                    COMP-3.
  6057         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6058         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6059         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6060         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6061         16  FILLER                         PIC  X(32).
  6062         16  CF-TERMINATION-FORM            PIC  X(04).
  6063         16  FILLER                         PIC  X(08).
  6064         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6065                                                       COMP-3.
  6066         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6067         16  CF-ISSUE-LETTER                PIC  X(4).
  6068         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6069         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6070             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6071             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6072         16  CF-MP-REFUND-CALC              PIC X.
  6073             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6074             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6075             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6076             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6077             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6078             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6079             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6080             88  CF-MP-REFD-MEAN                VALUE '8'.
  6081         16  CF-ALT-RATE-CODE               PIC  X(5).
  6082
  6083
  6084         16  FILLER                         PIC X(498).
  6085****************************************************************
  6086*             MORTGAGE COMPANY MASTER RECORD                   *
  6087****************************************************************
  6088
  6089     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6090         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6091         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6092             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6093             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6094             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6095             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6096             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6097
  6098         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6099         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6100         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6101         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6102         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 112
* EL050.cbl
  6103
  6104         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6105             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6106         16  CF-MP-RECON-USE-IND            PIC X(1).
  6107             88  CF-MP-USE-RECON             VALUE 'Y'.
  6108         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6109             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6110         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6111             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6112             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6113         16  FILLER                         PIC X(1).
  6114         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6115             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6116         16  CF-MORTG-MIB-VERSION           PIC X.
  6117             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6118             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6119             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6120         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6121             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6122                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6123             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6124                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6125             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6126                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6127             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6128                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6129             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6130                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6131             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6132                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6133         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6134         16  FILLER                         PIC X(7).
  6135         16  CF-MORTG-DESTINATION-SYMBOL.
  6136             20  CF-MORTG-MIB-COMM          PIC X(5).
  6137             20  CF-MORTG-MIB-TERM          PIC X(5).
  6138         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6139             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6140         16  FILLER                         PIC X(03).
  6141         16  CF-MP-CHECK-NO-CONTROL.
  6142             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6143                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6144                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6145                                                ' ' LOW-VALUES.
  6146                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6147                                               VALUE '3'.
  6148         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6149         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6150         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6151             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6152                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6153             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6154                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6155             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6156                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6157             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6158                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6159             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6160                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 113
* EL050.cbl
  6161             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6162                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6163         16  CF-MORTG-BILLING-AREA.
  6164             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6165                                            PIC X.
  6166         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6167         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6168         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6169         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6170             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6171             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6172         16  FILLER                         PIC X.
  6173         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6174             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6175             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6176         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6177         16  FILLER                         PIC X(8).
  6178         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6179         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6180         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6181         16  CF-ACH-COMPANY-ID.
  6182             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6183                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6184                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6185                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6186             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6187         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6188             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6189         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6190             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6191             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6192         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6193         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6194         16  FILLER                         PIC X(536).
  6195
  6196****************************************************************
  6197*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6198****************************************************************
  6199
  6200     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6201         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6202             20  CF-FEMALE-HEIGHT.
  6203                 24  CF-FEMALE-FT           PIC 99.
  6204                 24  CF-FEMALE-IN           PIC 99.
  6205             20  CF-FEMALE-MIN-WT           PIC 999.
  6206             20  CF-FEMALE-MAX-WT           PIC 999.
  6207         16  FILLER                         PIC X(428).
  6208
  6209     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6210         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6211             20  CF-MALE-HEIGHT.
  6212                 24  CF-MALE-FT             PIC 99.
  6213                 24  CF-MALE-IN             PIC 99.
  6214             20  CF-MALE-MIN-WT             PIC 999.
  6215             20  CF-MALE-MAX-WT             PIC 999.
  6216         16  FILLER                         PIC X(428).
  6217******************************************************************
  6218*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 114
* EL050.cbl
  6219******************************************************************
  6220     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6221         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6222             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6223             20  CF-SYS-LETTER-ID           PIC X(04).
  6224             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6225             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6226             20  CF-SYS-RESET-SW            PIC X(01).
  6227             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6228             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6229
  6230         16  FILLER                         PIC X(50).
  6231
  6232         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6233             20  CF-USER-ACTIVE-SW          PIC X(01).
  6234             20  CF-USER-LETTER-ID          PIC X(04).
  6235             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6236             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6237             20  CF-USER-RESET-SW           PIC X(01).
  6238             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6239             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6240             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6241
  6242         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 115
* EL050.cbl
  6244*    COPY ERCACCT.
  6245******************************************************************
  6246*                                                                *
  6247*                                                                *
  6248*                            ERCACCT                             *
  6249*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6250*                            VMOD=2.031                          *
  6251*                                                                *
  6252*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6253*                                                                *
  6254*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6255*   VSAM ACCOUNT MASTER FILES.                                   *
  6256*                                                                *
  6257*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6258*                                                                *
  6259*   FILE TYPE = VSAM,KSDS                                        *
  6260*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6261*                                                                *
  6262*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6263*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6264*                                                                *
  6265*   LOG = NO                                                     *
  6266*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6267*                                                                *
  6268*                                                                *
  6269******************************************************************
  6270*                   C H A N G E   L O G
  6271*
  6272* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6273*-----------------------------------------------------------------
  6274*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6275* EFFECTIVE    NUMBER
  6276*-----------------------------------------------------------------
  6277* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6278* 092705    2005050300006  PEMA  ADD SPP LEASES
  6279* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6280* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6281* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6282* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6283* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6284******************************************************************
  6285
  6286 01  ACCOUNT-MASTER.
  6287     12  AM-RECORD-ID                      PIC XX.
  6288         88  VALID-AM-ID                      VALUE 'AM'.
  6289
  6290     12  AM-CONTROL-PRIMARY.
  6291         16  AM-COMPANY-CD                 PIC X.
  6292         16  AM-MSTR-CNTRL.
  6293             20  AM-CONTROL-A.
  6294                 24  AM-CARRIER            PIC X.
  6295                 24  AM-GROUPING.
  6296                     28 AM-GROUPING-PREFIX PIC XXX.
  6297                     28 AM-GROUPING-PRIME  PIC XXX.
  6298                 24  AM-STATE              PIC XX.
  6299                 24  AM-ACCOUNT.
  6300                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6301                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 116
* EL050.cbl
  6302             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6303                                           PIC X(19).
  6304             20  AM-CNTRL-B.
  6305                 24  AM-EXPIRATION-DT      PIC XX.
  6306                 24  FILLER                PIC X(4).
  6307             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6308                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6309
  6310     12  AM-CONTROL-BY-VAR-GRP.
  6311         16  AM-COMPANY-CD-A1              PIC X.
  6312         16  AM-VG-CARRIER                 PIC X.
  6313         16  AM-VG-GROUPING                PIC X(6).
  6314         16  AM-VG-STATE                   PIC XX.
  6315         16  AM-VG-ACCOUNT                 PIC X(10).
  6316         16  AM-VG-DATE.
  6317             20  AM-VG-EXPIRATION-DT       PIC XX.
  6318             20  FILLER                    PIC X(4).
  6319         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6320                                           PIC 9(11)      COMP-3.
  6321     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6322         16  FILLER                        PIC X(10).
  6323         16  AM-VG-KEY3.
  6324             20  AM-VG3-ACCOUNT            PIC X(10).
  6325             20  AM-VG3-EXP-DT             PIC XX.
  6326         16  FILLER                        PIC X(4).
  6327     12  AM-MAINT-INFORMATION.
  6328         16  AM-LAST-MAINT-DT              PIC XX.
  6329         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6330         16  AM-LAST-MAINT-USER            PIC X(4).
  6331         16  FILLER                        PIC XX.
  6332
  6333     12  AM-EFFECTIVE-DT                   PIC XX.
  6334     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6335
  6336     12  AM-PREV-DATES  COMP-3.
  6337         16  AM-PREV-EXP-DT                PIC 9(11).
  6338         16  AM-PREV-EFF-DT                PIC 9(11).
  6339
  6340     12  AM-REPORT-CODE-1                  PIC X(10).
  6341     12  AM-REPORT-CODE-2                  PIC X(10).
  6342
  6343     12  AM-CITY-CODE                      PIC X(4).
  6344     12  AM-COUNTY-PARISH                  PIC X(6).
  6345
  6346     12  AM-NAME                           PIC X(30).
  6347     12  AM-PERSON                         PIC X(30).
  6348     12  AM-ADDRS                          PIC X(30).
  6349     12  AM-CITY.
  6350         16  AM-ADDR-CITY                  PIC X(28).
  6351         16  AM-ADDR-STATE                 PIC XX.
  6352     12  AM-ZIP.
  6353         16  AM-ZIP-PRIME.
  6354             20  AM-ZIP-PRI-1ST            PIC X.
  6355                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6356             20  FILLER                    PIC X(4).
  6357         16  AM-ZIP-PLUS4                  PIC X(4).
  6358     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6359         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 117
* EL050.cbl
  6360         16  AM-CAN-POSTAL-2               PIC XXX.
  6361         16  FILLER                        PIC XXX.
  6362     12  AM-TEL-NO.
  6363         16  AM-AREA-CODE                  PIC 999.
  6364         16  AM-TEL-PRE                    PIC 999.
  6365         16  AM-TEL-NBR                    PIC 9(4).
  6366     12  AM-TEL-LOC                        PIC X.
  6367         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6368         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6369
  6370     12  AM-COMM-STRUCTURE.
  6371         16  AM-DEFN-1.
  6372             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6373                 24  AM-AGT.
  6374                     28  AM-AGT-PREFIX     PIC X(4).
  6375                     28  AM-AGT-PRIME      PIC X(6).
  6376                 24  AM-COM-TYP            PIC X.
  6377                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6378                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6379                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6380                 24  AM-RECALC-LV-INDIC    PIC X.
  6381                 24  AM-RETRO-LV-INDIC     PIC X.
  6382                 24  AM-GL-CODES           PIC X.
  6383                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6384                 24  FILLER                PIC X(01).
  6385         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6386             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6387                 24  FILLER                PIC X(11).
  6388                 24  AM-L-COMA             PIC XXX.
  6389                 24  AM-J-COMA             PIC XXX.
  6390                 24  AM-A-COMA             PIC XXX.
  6391                 24  FILLER                PIC X(6).
  6392
  6393     12  AM-COMM-CHANGE-STATUS             PIC X.
  6394         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6395
  6396     12  AM-CSR-CODE                       PIC X(4).
  6397
  6398     12  AM-BILLING-STATUS                 PIC X.
  6399         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6400         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6401     12  AM-AUTO-REFUND-SW                 PIC X.
  6402         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6403         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6404     12  AM-GPCD                           PIC 99.
  6405     12  AM-IG                             PIC X.
  6406         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6407         88  AM-HAS-GROUP                     VALUE '2'.
  6408     12  AM-STATUS                         PIC X.
  6409         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6410         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6411         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6412         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6413         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6414         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6415     12  AM-REMIT-TO                       PIC 99.
  6416     12  AM-ID-NO                          PIC X(11).
  6417
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 118
* EL050.cbl
  6418     12  AM-CAL-TABLE                      PIC XX.
  6419     12  AM-LF-DEVIATION                   PIC XXX.
  6420     12  AM-AH-DEVIATION                   PIC XXX.
  6421     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6422     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6423     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6424     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6425     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6426     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6427
  6428     12  AM-USER-FIELDS.
  6429         16  AM-FLD-1                      PIC XX.
  6430         16  AM-FLD-2                      PIC XX.
  6431         16  AM-FLD-3                      PIC XX.
  6432         16  AM-FLD-4                      PIC XX.
  6433         16  AM-FLD-5                      PIC XX.
  6434
  6435     12  AM-1ST-PROD-DATE.
  6436         16  AM-1ST-PROD-YR                PIC XX.
  6437         16  AM-1ST-PROD-MO                PIC XX.
  6438         16  AM-1ST-PROD-DA                PIC XX.
  6439     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6440     12  AM-CERTS-PURGED-DATE.
  6441         16  AM-PUR-YR                     PIC XX.
  6442         16  AM-PUR-MO                     PIC XX.
  6443         16  AM-PUR-DA                     PIC XX.
  6444     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6445     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6446     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6447     12  AM-INACTIVE-DATE.
  6448         16  AM-INA-MO                     PIC 99.
  6449         16  AM-INA-DA                     PIC 99.
  6450         16  AM-INA-YR                     PIC 99.
  6451     12  AM-AR-HI-CERT-DATE                PIC XX.
  6452
  6453     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6454     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6455
  6456     12  AM-OB-PAYMENT-MODE                PIC X.
  6457         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6458         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6459         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6460         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6461
  6462     12  AM-AH-ONLY-INDICATOR              PIC X.
  6463         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6464         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6465
  6466     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6467
  6468     12  AM-OVER-SHORT.
  6469         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6470         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6471
  6472     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6473     12  AM-DCC-CLP-STATE                  PIC XX.
  6474
  6475     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 119
* EL050.cbl
  6476     12  AM-RECALC-REIN                    PIC X.
  6477
  6478     12  AM-REI-TABLE                      PIC XXX.
  6479     12  AM-REI-ET-LF                      PIC X.
  6480     12  AM-REI-ET-AH                      PIC X.
  6481     12  AM-REI-PE-LF                      PIC X.
  6482     12  AM-REI-PE-AH                      PIC X.
  6483     12  AM-REI-PRT-ST                     PIC X.
  6484     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6485     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6486     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6487     12  AM-REI-GROUP-A                    PIC X(6).
  6488     12  AM-REI-MORT                       PIC X(4).
  6489     12  AM-REI-PRT-OW                     PIC X.
  6490     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6491     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6492     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6493     12  AM-REI-GROUP-B                    PIC X(6).
  6494
  6495     12  AM-TRUST-TYPE                     PIC X(2).
  6496
  6497     12  AM-EMPLOYER-STMT-USED             PIC X.
  6498     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6499
  6500     12  AM-STD-AH-TYPE                    PIC XX.
  6501     12  AM-EARN-METHODS.
  6502         16  AM-EARN-METHOD-R              PIC X.
  6503             88 AM-REF-RL-R78                 VALUE 'R'.
  6504             88 AM-REF-RL-PR                  VALUE 'P'.
  6505             88 AM-REF-RL-MEAN                VALUE 'M'.
  6506             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6507         16  AM-EARN-METHOD-L              PIC X.
  6508             88 AM-REF-LL-R78                 VALUE 'R'.
  6509             88 AM-REF-LL-PR                  VALUE 'P'.
  6510             88 AM-REF-LL-MEAN                VALUE 'M'.
  6511             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6512         16  AM-EARN-METHOD-A              PIC X.
  6513             88 AM-REF-AH-R78                 VALUE 'R'.
  6514             88 AM-REF-AH-PR                  VALUE 'P'.
  6515             88 AM-REF-AH-MEAN                VALUE 'M'.
  6516             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6517             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6518             88 AM-REF-AH-NET                 VALUE 'N'.
  6519
  6520     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6521     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6522     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6523
  6524     12  AM-RET-Y-N                        PIC X.
  6525     12  AM-RET-P-E                        PIC X.
  6526     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6527     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6528     12  AM-RET-GRP                        PIC X(6).
  6529     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6530         16  AM-POOL-PRIME                 PIC XXX.
  6531         16  AM-POOL-SUB                   PIC XXX.
  6532     12  AM-RETRO-EARNINGS.
  6533         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 120
* EL050.cbl
  6534         16  AM-RET-EARN-L                 PIC X.
  6535         16  AM-RET-EARN-A                 PIC X.
  6536     12  AM-RET-ST-TAX-USE                 PIC X.
  6537         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6538         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6539     12  AM-RETRO-BEG-EARNINGS.
  6540         16  AM-RET-BEG-EARN-R             PIC X.
  6541         16  AM-RET-BEG-EARN-L             PIC X.
  6542         16  AM-RET-BEG-EARN-A             PIC X.
  6543     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6544     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6545
  6546     12  AM-USER-SELECT-OPTIONS.
  6547         16  AM-USER-SELECT-1              PIC X(10).
  6548         16  AM-USER-SELECT-2              PIC X(10).
  6549         16  AM-USER-SELECT-3              PIC X(10).
  6550         16  AM-USER-SELECT-4              PIC X(10).
  6551         16  AM-USER-SELECT-5              PIC X(10).
  6552
  6553     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6554
  6555     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6556
  6557     12  AM-RPT045A-SWITCH                 PIC X.
  6558         88  RPT045A-OFF                   VALUE 'N'.
  6559
  6560     12  AM-INSURANCE-LIMITS.
  6561         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6562         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6563
  6564     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6565         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6566
  6567     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6568         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6569         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6570
  6571     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6572
  6573     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6574     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6575     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6576     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6577     12  AM-DCC-UEF-STATE                  PIC XX.
  6578     12  FILLER                            PIC XXX.
  6579     12  AM-REPORT-CODE-3                  PIC X(10).
  6580*    12  FILLER                            PIC X(22).
  6581
  6582     12  AM-RESERVE-DATE.
  6583         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6584         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6585         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6586
  6587     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6588     12  AM-NOTIFICATION-TYPES.
  6589         16  AM-NOTIF-OF-LETTERS           PIC X.
  6590         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6591         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 121
* EL050.cbl
  6592         16  AM-NOTIF-OF-STATUS            PIC X.
  6593
  6594     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6595         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6596         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6597         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6598         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6599
  6600     12  AM-BENEFIT-CONTROLS.
  6601         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6602             20  AM-BENEFIT-CODE           PIC XX.
  6603             20  AM-BENEFIT-TYPE           PIC X.
  6604             20  AM-BENEFIT-REVISION       PIC XXX.
  6605             20  AM-BENEFIT-REM-TERM       PIC X.
  6606             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6607             20  FILLER                    PIC XX.
  6608         16  FILLER                        PIC X(80).
  6609
  6610     12  AM-TRANSFER-DATA.
  6611         16  AM-TRANSFERRED-FROM.
  6612             20  AM-TRNFROM-CARRIER        PIC X.
  6613             20  AM-TRNFROM-GROUPING.
  6614                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6615                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6616             20  AM-TRNFROM-STATE          PIC XX.
  6617             20  AM-TRNFROM-ACCOUNT.
  6618                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6619                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6620             20  AM-TRNFROM-DTE            PIC XX.
  6621         16  AM-TRANSFERRED-TO.
  6622             20  AM-TRNTO-CARRIER          PIC X.
  6623             20  AM-TRNTO-GROUPING.
  6624                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6625                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6626             20  AM-TRNTO-STATE            PIC XX.
  6627             20  AM-TRNTO-ACCOUNT.
  6628                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6629                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6630             20  AM-TRNTO-DTE              PIC XX.
  6631         16  FILLER                        PIC X(10).
  6632
  6633     12  AM-SAVED-REMIT-TO                 PIC 99.
  6634
  6635     12  AM-COMM-STRUCTURE-SAVED.
  6636         16  AM-DEFN-1-SAVED.
  6637             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6638                 24  AM-AGT-SV             PIC X(10).
  6639                 24  AM-COM-TYP-SV         PIC X.
  6640                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6641                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6642                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6643                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6644                 24  FILLER                PIC X.
  6645                 24  AM-GL-CODES-SV        PIC X.
  6646                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6647                 24  FILLER                PIC X.
  6648         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6649             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 122
* EL050.cbl
  6650                 24  FILLER                PIC X(11).
  6651                 24  AM-L-COMA-SV          PIC XXX.
  6652                 24  AM-J-COMA-SV          PIC XXX.
  6653                 24  AM-A-COMA-SV          PIC XXX.
  6654                 24  FILLER                PIC X(6).
  6655
  6656     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6657         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6658            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6659            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6660            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6661
  6662     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6663     12  FILLER                            PIC X(120).
  6664
  6665     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6666         16  AM-CONTROL-NAME               PIC X(30).
  6667         16  AM-EXECUTIVE-ONE.
  6668             20  AM-EXEC1-NAME             PIC X(15).
  6669             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6670                                                          COMP-3.
  6671             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6672                                                          COMP-3.
  6673         16  AM-EXECUTIVE-TWO.
  6674             20  AM-EXEC2-NAME             PIC X(15).
  6675             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6676                                                          COMP-3.
  6677             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6678                                                          COMP-3.
  6679
  6680     12  AM-RETRO-ADDITIONAL-DATA.
  6681         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6682         16  AM-RETRO-PREM-P-E             PIC X.
  6683         16  AM-RETRO-CLMS-P-I             PIC X.
  6684         16  AM-RETRO-RET-BRACKET-LF.
  6685             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6686                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6687                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6688             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6689                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6690                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6691             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6692                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6693                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6694         16  AM-RETRO-RET-BRACKET-AH.
  6695             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6696                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6697                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6698                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6699             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6700                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6701                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6702             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6703                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6704                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6705
  6706     12  AM-COMMENTS.
  6707         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 123
* EL050.cbl
  6708
  6709     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6710         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6711         16  AM-FLI-BILLING-CODE           PIC X.
  6712         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6713         16  AM-FLI-UNITED-IDENT           PIC X.
  6714         16  AM-FLI-INTEREST-LOST-DATA.
  6715             20  AM-FLI-BANK-NO            PIC X(5).
  6716             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6717             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6718             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6719         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6720             20  AM-FLI-AGT                PIC X(9).
  6721             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6722             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6723         16  FILLER                        PIC X(102).
  6724
  6725     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6726         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6727             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6728             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6729             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6730             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6731             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6732         16  FILLER                          PIC X(10).
  6733******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 124
* EL050.cbl
  6735*    COPY ERCREIN.
  6736******************************************************************
  6737*                                                                *
  6738*                            ERCREIN                             *
  6739*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6740*                            VMOD=2.010                          *
  6741*                                                                *
  6742*   ONLINE CREDIT SYSTEM                                         *
  6743*                                                                *
  6744*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6745*                                                                *
  6746*   FILE TYPE = VSAM,KSDS                                        *
  6747*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6748*                                                                *
  6749*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6750*       ALTERNATE PATH = NONE                                    *
  6751*                                                                *
  6752*   LOG = NO                                                     *
  6753*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6754*                                                                *
  6755******************************************************************
  6756*                   C H A N G E   L O G
  6757*
  6758* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6759*-----------------------------------------------------------------
  6760*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6761* EFFECTIVE    NUMBER
  6762*-----------------------------------------------------------------
  6763* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6764* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6765******************************************************************
  6766 01  REINSURANCE-RECORD.
  6767     12  RE-RECORD-ID                      PIC XX.
  6768         88  VALID-RE-ID                      VALUE 'RE'.
  6769
  6770     12  RE-CONTROL-PRIMARY.
  6771         16  RE-COMPANY-CD                 PIC X.
  6772         16  RE-KEY.
  6773             20  RE-CODE                   PIC X.
  6774                 88  RE-TABLE-RECORD          VALUE 'A'.
  6775                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6776             20  RE-TABLE                  PIC XXX.
  6777             20  FILLER                    PIC XXX.
  6778         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6779             20  FILLER                    PIC X.
  6780             20  RE-COMPANY.
  6781                 24  RE-COMP-PRIME         PIC XXX.
  6782                 24  RE-COMP-SUB           PIC XXX.
  6783
  6784     12  RE-MAINT-INFORMATION.
  6785         16  RE-LAST-MAINT-DT              PIC XX.
  6786         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6787         16  RE-LAST-MAINT-USER            PIC X(4).
  6788         16  FILLER                        PIC X(10).
  6789
  6790     12  RE-TABLE-DATA.
  6791         16  RE-100-COMP                   PIC 99.
  6792
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 125
* EL050.cbl
  6793         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6794             20  RE-REI-COMP-NO.
  6795                 24  RE-REI-COMP           PIC XXX.
  6796                 24  RE-REI-COMP-SUB       PIC XXX.
  6797             20  RE-LF-QC                  PIC X.
  6798             20  RE-AH-QC                  PIC X.
  6799             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6800             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6801             20  RE-LFAGE-LO               PIC 99.
  6802             20  RE-LFAGE-HI               PIC 99.
  6803             20  RE-AHAGE-LO               PIC 99.
  6804             20  RE-AHAGE-HI               PIC 99.
  6805             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6806             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6807             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6808             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6809             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6810             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6811             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6812             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6813             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6814             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6815             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6816             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6817             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6818             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6819             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6820             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6821             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6822             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6823             20  RE-LF-BEN-CODE            PIC X.
  6824             20  RE-AH-BEN-CODE            PIC X.
  6825             20  RE-INTERACTIVE            PIC X.
  6826             20  RE-REMAINING              PIC X.
  6827             20  RE-LF-RUNOFF-SW           PIC X.
  6828             20  RE-AH-RUNOFF-SW           PIC X.
  6829             20  FILLER                    PIC X(19).
  6830
  6831         16  RE-COMP-INFO-END              PIC X(6).
  6832         16  RE-NSP-ST-CD-LF               PIC XX.
  6833         16  RE-NSP-ST-CD-AH               PIC XX.
  6834         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6835             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6836
  6837         16  FILLER                        PIC X(27).
  6838
  6839     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6840         16  RE-NAME                       PIC X(30).
  6841         16  RE-LF-PE                      PIC X.
  6842         16  RE-AH-PE                      PIC X.
  6843         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6844         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6845         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6846         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6847         16  RE-PRT-ST                     PIC X.
  6848         16  RE-PRT-OW                     PIC X.
  6849         16  RE-MORT-CODE                  PIC X(4).
  6850         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 126
* EL050.cbl
  6851         16  RE-ZERO-LF-FEE                PIC X.
  6852         16  RE-ZERO-AH-FEE                PIC X.
  6853         16  RE-CEDE-NAME                  PIC X(30).
  6854         16  RE-LF-COMM                    PIC X.
  6855         16  RE-AH-COMM                    PIC X.
  6856         16  RE-LF-TAX                     PIC X.
  6857         16  RE-AH-TAX                     PIC X.
  6858         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6859         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6860         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6861
  6862         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6863             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6864
  6865         16  RE-LF-CEDING-FEE-BRACKETS.
  6866             20  RE-LF-FEE-METHOD          PIC X.
  6867                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6868                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6869                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6870                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6871             20  RE-LF-FEE-BASIS           PIC X.
  6872                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6873                 88  RE-LF-NET-CEDED               VALUE '2'.
  6874                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6875                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6876                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6877                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6878                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6879                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6880             20  FILLER                    PIC XXX.
  6881             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6882                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6883                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6884
  6885         16  RE-AH-CEDING-FEE-BRACKETS.
  6886             20  RE-AH-FEE-METHOD          PIC X.
  6887                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6888                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6889                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6890                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6891             20  RE-AH-FEE-BASIS           PIC X.
  6892                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6893                 88  RE-AH-NET-CEDED               VALUE '2'.
  6894                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6895                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6896                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6897                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6898                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6899                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6900             20  FILLER                    PIC XXX.
  6901             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6902                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6903                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6904
  6905         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6906
  6907         16  RE-OLD-CEDING-STMT            PIC X.
  6908
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 127
* EL050.cbl
  6909         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6910         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6911         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6912         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6913         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6914         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6915         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6916         16  RE-MORT-SW                    PIC X.
  6917         16  RE-CEDING-TYPE-FLAG           PIC X.
  6918             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6919             88  RE-CEDED                          VALUE 'C'.
  6920             88  RE-ASSUMED                        VALUE 'A'.
  6921             88  RE-PHANTOM                        VALUE 'P'.
  6922
  6923         16  RE-CEDING-STMT-OPT-A          PIC X.
  6924             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6925         16  RE-CEDING-STMT-OPT-B          PIC X.
  6926             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6927         16  RE-CEDING-STMT-OPT-C          PIC X.
  6928             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6929         16  RE-CEDING-STMT-OPT-D          PIC X.
  6930             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6931         16  RE-CEDING-STMT-OPT-E          PIC X.
  6932             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6933
  6934         16  RE-PRT-CRSV                   PIC X.
  6935
  6936         16  RE-GL-CENTER                  PIC X(4).
  6937
  6938         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6939
  6940         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6941
  6942         16  RE-EARN-STOP-CODE             PIC X.
  6943             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6944             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6945
  6946         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6947             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6948
  6949         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6950         16  FILLER                        PIC X(2281).
  6951
  6952         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6953
  6954******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 128
* EL050.cbl
  6956*    COPY ERCCTBL.
  6957******************************************************************
  6958*                                                                *
  6959*                                                                *
  6960*                            ERCCTBL                             *
  6961*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6962*                            VMOD=2.003
  6963*                                                                *
  6964*   ONLINE CREDIT SYSTEM                                         *
  6965*                                                                *
  6966*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  6967*                                                                *
  6968*   FILE TYPE = VSAM,KSDS                                        *
  6969*   RECORD SIZE = 200   RECFORM = FIXED                          *
  6970*                                                                *
  6971*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  6972*       ALTERNATE PATH = NONE                                    *
  6973*                                                                *
  6974*   LOG = NO                                                     *
  6975*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6976*                                                                *
  6977*                                                                *
  6978******************************************************************
  6979
  6980 01  COMM-TABLE-RECORD.
  6981     12  CT-RECORD-ID                      PIC XX.
  6982         88  VALID-CT-ID                      VALUE 'CT'.
  6983
  6984     12  CT-CONTROL-PRIMARY.
  6985         16  CT-COMPANY-CD                 PIC X.
  6986         16  CT-TABLE                      PIC XXX.
  6987         16  CT-CNTRL-2.
  6988             20  CT-BEN-TYPE               PIC X.
  6989             20  CT-BEN-CODE               PIC XX.
  6990
  6991     12  CT-MAINT-INFORMATION.
  6992         16  CT-LAST-MAINT-DT              PIC XX.
  6993         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6994         16  CT-LAST-MAINT-USER            PIC X(4).
  6995         16  FILLER                        PIC X(31).
  6996
  6997     12  CT-LIMITS.
  6998         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  6999
  7000         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7001
  7002         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7003
  7004     12  CT-RATES.
  7005         16  CT-RTX          OCCURS 27 TIMES.
  7006             20  CT-RT                     PIC SV9(5)     COMP-3.
  7007             20  CT-RT-R   REDEFINES
  7008                 CT-RT                     PIC XXX.
  7009
  7010     12  FILLER                            PIC  X(42).
  7011
  7012******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 129
* EL050.cbl
  7014*    COPY ERCFORM.
  7015******************************************************************
  7016*                                                                *
  7017*                                                                *
  7018*                            ERCFORM.                            *
  7019*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7020*                            VMOD=2.003                          *
  7021*                                                                *
  7022*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7023*                                                                *
  7024*    FILE TYPE = VSAM,KSDS                                       *
  7025*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7026*                                                                *
  7027*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7028*                                                                *
  7029*    LOG = YES                                                   *
  7030*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7031******************************************************************
  7032 01  FORM-MASTER.
  7033    12  FO-RECORD-ID                 PIC X(02).
  7034        88  VALID-FO-ID                  VALUE 'FO'.
  7035
  7036    12  FO-CONTROL-PRIMARY.
  7037        16  FO-COMPANY-CD            PIC X(01).
  7038        16  FO-STATE                 PIC X(02).
  7039        16  FO-FORM-ID               PIC X(12).
  7040        16  FO-FORM-EXP-DT           PIC X(02).
  7041
  7042    12  FO-POLICY-FORM-DATA.
  7043        16  FO-IND-GRP-CD            PIC X(01).
  7044        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7045        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7046        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7047        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7048        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7049        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7050        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7051        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7052        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7053        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7054        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7055        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7056        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7057        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7058        16  FO-APP-CERT-USE-CD       PIC X(01).
  7059
  7060    12  FILLER                       PIC X(29).
  7061
  7062    12  FO-FORM-PLAN-TABLE.
  7063        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7064            20  FO-PLAN-TYPE         PIC X(01).
  7065            20  FO-PLAN-ID           PIC X(02).
  7066            20  FO-PLAN-TERM         PIC 9(03).
  7067            20  FO-PLAN-REFUND-METHOD
  7068                                     PIC X.
  7069
  7070    12  FILLER                       PIC X(30).
  7071
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 130
* EL050.cbl
  7072    12  FO-COMMENTS-AREA.
  7073        16  FO-COMMENT-LINE-1        PIC X(78).
  7074
  7075    12  FILLER                       PIC X(20).
  7076
  7077    12  FO-MAINT-INFORMATION.
  7078        16  FO-LAST-MAINT-DT         PIC X(02).
  7079        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7080        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 131
* EL050.cbl
  7082*    COPY ELCMSTR.
  7083******************************************************************
  7084*                                                                *
  7085*                            ELCMSTR.                            *
  7086*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7087*                            VMOD=2.012                          *
  7088*                                                                *
  7089*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7090*                                                                *
  7091*   FILE TYPE = VSAM,KSDS                                        *
  7092*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7093*                                                                *
  7094*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7095*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7096*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7097*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7098*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7099*                                                 RKP=75,LEN=21  *
  7100*                                                                *
  7101*   **** NOTE ****                                               *
  7102*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7103*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7104*                                                                *
  7105*   LOG = YES                                                    *
  7106*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7107******************************************************************
  7108*                   C H A N G E   L O G
  7109*
  7110* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7111*-----------------------------------------------------------------
  7112*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7113* EFFECTIVE    NUMBER
  7114*-----------------------------------------------------------------
  7115* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7116* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7117******************************************************************
  7118 01  CLAIM-MASTER.
  7119     12  CL-RECORD-ID                PIC XX.
  7120         88  VALID-CL-ID         VALUE 'CL'.
  7121
  7122     12  CL-CONTROL-PRIMARY.
  7123         16  CL-COMPANY-CD           PIC X.
  7124         16  CL-CARRIER              PIC X.
  7125         16  CL-CLAIM-NO             PIC X(7).
  7126         16  CL-CERT-NO.
  7127             20  CL-CERT-PRIME       PIC X(10).
  7128             20  CL-CERT-SFX         PIC X.
  7129
  7130     12  CL-CONTROL-BY-NAME.
  7131         16  CL-COMPANY-CD-A1        PIC X.
  7132         16  CL-INSURED-LAST-NAME    PIC X(15).
  7133         16  CL-INSURED-NAME.
  7134             20  CL-INSURED-1ST-NAME PIC X(12).
  7135             20  CL-INSURED-MID-INIT PIC X.
  7136
  7137     12  CL-CONTROL-BY-SSN.
  7138         16  CL-COMPANY-CD-A2        PIC X.
  7139         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 132
* EL050.cbl
  7140             20  CL-SSN-STATE        PIC XX.
  7141             20  CL-SSN-ACCOUNT      PIC X(6).
  7142             20  CL-SSN-LN3          PIC X(3).
  7143
  7144     12  CL-CONTROL-BY-CERT-NO.
  7145         16  CL-COMPANY-CD-A4        PIC X.
  7146         16  CL-CERT-NO-A4.
  7147             20  CL-CERT-A4-PRIME    PIC X(10).
  7148             20  CL-CERT-A4-SFX      PIC X.
  7149
  7150     12  CL-CONTROL-BY-CCN.
  7151         16  CL-COMPANY-CD-A5        PIC X.
  7152         16  CL-CCN-A5.
  7153             20  CL-CCN.
  7154                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7155                 24  CL-CCN-PRIME-A5 PIC X(12).
  7156             20  CL-CCN-FILLER-A5    PIC X(4).
  7157
  7158     12  CL-INSURED-PROFILE-DATA.
  7159         16  CL-INSURED-BIRTH-DT     PIC XX.
  7160         16  CL-INSURED-SEX-CD       PIC X.
  7161             88  INSURED-IS-MALE        VALUE 'M'.
  7162             88  INSURED-IS-FEMALE      VALUE 'F'.
  7163             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7164         16  CL-INSURED-OCC-CD       PIC X(6).
  7165         16  FILLER                  PIC X(5).
  7166
  7167     12  CL-PROCESSING-INFO.
  7168         16  CL-PROCESSOR-ID         PIC X(4).
  7169         16  CL-CLAIM-STATUS         PIC X.
  7170             88  CLAIM-IS-OPEN          VALUE 'O'.
  7171             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7172         16  CL-CLAIM-TYPE           PIC X.
  7173*            88  AH-CLAIM               VALUE 'A'.
  7174*            88  LIFE-CLAIM             VALUE 'L'.
  7175*            88  PROPERTY-CLAIM         VALUE 'P'.
  7176*            88  IUI-CLAIM              VALUE 'I'.
  7177*            88  GAP-CLAIM              VALUE 'G'.
  7178         16  CL-CLAIM-PREM-TYPE      PIC X.
  7179             88  SINGLE-PREMIUM         VALUE '1'.
  7180             88  O-B-COVERAGE           VALUE '2'.
  7181             88  OPEN-END-COVERAGE      VALUE '3'.
  7182         16  CL-INCURRED-DT          PIC XX.
  7183         16  CL-REPORTED-DT          PIC XX.
  7184         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7185         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7186         16  CL-LAST-PMT-DT          PIC XX.
  7187         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7188         16  CL-PAID-THRU-DT         PIC XX.
  7189         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7190         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7191         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7192         16  CL-PMT-CALC-METHOD      PIC X.
  7193             88  CL-360-DAY-YR          VALUE '1'.
  7194             88  CL-365-DAY-YR          VALUE '2'.
  7195             88  CL-FULL-MONTHS         VALUE '3'.
  7196         16  CL-CAUSE-CD             PIC X(6).
  7197
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 133
* EL050.cbl
  7198         16  CL-PRIME-CERT-NO.
  7199             20  CL-PRIME-CERT-PRIME PIC X(10).
  7200             20  CL-PRIME-CERT-SFX   PIC X.
  7201
  7202         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7203             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7204             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7205
  7206         16  CL-MICROFILM-NO         PIC X(10).
  7207         16  CL-PROG-FORM-TYPE       PIC X.
  7208         16  CL-LAST-ADD-ON-DT       PIC XX.
  7209
  7210         16  CL-LAST-REOPEN-DT       PIC XX.
  7211         16  CL-LAST-CLOSE-DT        PIC XX.
  7212         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7213             88  FINAL-PAID             VALUE '1'.
  7214             88  CLAIM-DENIED           VALUE '2'.
  7215             88  AUTO-CLOSE             VALUE '3'.
  7216             88  MANUAL-CLOSE           VALUE '4'.
  7217             88  BENEFITS-CHANGED       VALUE 'C'.
  7218             88  SETUP-ERRORS           VALUE 'E'.
  7219         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7220         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7221         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7222             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7223         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7224         16  FILLER                  PIC X.
  7225
  7226     12  CL-CERTIFICATE-DATA.
  7227         16  CL-CERT-ORIGIN          PIC X.
  7228             88  CERT-WAS-ONLINE        VALUE '1'.
  7229             88  CERT-WAS-CREATED       VALUE '2'.
  7230             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7231         16  CL-CERT-KEY-DATA.
  7232             20  CL-CERT-CARRIER     PIC X.
  7233             20  CL-CERT-GROUPING    PIC X(6).
  7234             20  CL-CERT-STATE       PIC XX.
  7235             20  CL-CERT-ACCOUNT.
  7236                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7237                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7238             20  CL-CERT-EFF-DT      PIC XX.
  7239
  7240     12  CL-STATUS-CONTROLS.
  7241         16  CL-PRIORITY-CD          PIC X.
  7242             88  CONFIDENTIAL-DATA      VALUE '8'.
  7243             88  HIGHEST-PRIORITY       VALUE '9'.
  7244         16  CL-SUPV-ATTN-CD         PIC X.
  7245             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7246             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7247         16  CL-PURGED-DT            PIC XX.
  7248         16  CL-RESTORED-DT          PIC XX.
  7249         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7250         16  CL-NEXT-RESEND-DT       PIC XX.
  7251         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7252         16  FILLER                  PIC XX.
  7253         16  CL-LAST-MAINT-DT        PIC XX.
  7254         16  CL-LAST-MAINT-USER      PIC X(4).
  7255         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 134
* EL050.cbl
  7256         16  CL-LAST-MAINT-TYPE      PIC X.
  7257             88  CLAIM-SET-UP           VALUE ' '.
  7258             88  PAYMENT-MADE           VALUE '1'.
  7259             88  LETTER-SENT            VALUE '2'.
  7260             88  MASTER-WAS-ALTERED     VALUE '3'.
  7261             88  MASTER-WAS-RESTORED    VALUE '4'.
  7262             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7263             88  FILE-CONVERTED         VALUE '6'.
  7264             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7265             88  ERROR-CORRECTION       VALUE 'E'.
  7266         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7267         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7268         16  CL-BENEFICIARY          PIC X(10).
  7269         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7270         16  CL-DENIAL-TYPE          PIC X.
  7271             88  CL-TYPE-DENIAL          VALUE '1'.
  7272             88  CL-TYPE-RESCISSION      VALUE '2'.
  7273             88  CL-TYPE-REFORMATION     VALUE '3'.
  7274             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7275             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7276         16  FILLER                  PIC X(5).
  7277
  7278     12  CL-TRAILER-CONTROLS.
  7279         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7280             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7281             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7282             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7283         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7284         16  FILLER                  PIC XX.
  7285         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7286         16  CL-ADDRESS-TRAILER-CNT.
  7287             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7288                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7289             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7290                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7291             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7292                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7293             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7294                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7295             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7296                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7297             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7298                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7299             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7300                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7301
  7302     12  CL-CV-REFERENCE-NO.
  7303         16  CL-CV-REFNO-PRIME       PIC X(18).
  7304         16  CL-CV-REFNO-SFX         PIC XX.
  7305
  7306     12  CL-FILE-LOCATION            PIC X(4).
  7307
  7308     12  CL-PROCESS-ERRORS.
  7309         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7310             88  NO-FATAL-ERRORS        VALUE ZERO.
  7311         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7312             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7313
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 135
* EL050.cbl
  7314     12  CL-PRODUCT-CD               PIC X.
  7315
  7316     12  CL-CURRENT-KEY-DATA.
  7317         16  CL-CURRENT-CARRIER      PIC X.
  7318         16  CL-CURRENT-GROUPING     PIC X(6).
  7319         16  CL-CURRENT-STATE        PIC XX.
  7320         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7321
  7322     12  CL-ASSOCIATES               PIC X.
  7323         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7324         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7325         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7326         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7327
  7328     12  CL-ACTIVITY-CODE            PIC 99.
  7329     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7330     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7331
  7332     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7333     12  CL-LAG-REPORT-CODE          PIC 9.
  7334     12  CL-LOAN-TYPE                PIC XX.
  7335     12  CL-LEGAL-STATE              PIC XX.
  7336
  7337*    12  FILLER                      PIC X(5).
  7338     12  CL-YESNOSW                  PIC X.
  7339     12  FILLER                      PIC X(4).
  7340
  7341 01  PLAN-RECORDS.
  7342     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7343     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7344
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 136
* EL050.cbl
  7346 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7347                          ACCOUNT-MASTER REINSURANCE-RECORD
  7348                          COMM-TABLE-RECORD FORM-MASTER
  7349                          CLAIM-MASTER PLAN-RECORDS.
  7350 0000-DFHEXIT SECTION.
  7351     MOVE '9#                    $   ' TO DFHEIV0.
  7352     MOVE 'EL050' TO DFHEIV1.
  7353     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7354
  7355     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7356
  7357
  7358* EXEC CICS  HANDLE CONDITION
  7359*           ERROR    (9300-ABEND)
  7360*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7361*    END-EXEC.
  7362*    MOVE '"$.J                  ! " #00007353' TO DFHEIV0
  7363     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7364     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7365     MOVE X'2220233030303037333533' TO DFHEIV0(25:11)
  7366     CALL 'kxdfhei1' USING DFHEIV0
  7367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7368
  7369
  7370 0000-COPY-PROCEDURE-DIV.
  7371*                          COPY ELC50PD.
  7372******************************************************************
  7373*                                                                *
  7374*                            ELC50PD                             *
  7375*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7376*                            VMOD=2.188                          *
  7377*                                                                *
  7378******************************************************************
  7379*                   C H A N G E   L O G
  7380*
  7381* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7382*-----------------------------------------------------------------
  7383*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7384* EFFECTIVE    NUMBER
  7385*-----------------------------------------------------------------
  7386* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7387* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7388* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7389*                             2709 AND 2718
  7390* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7391* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7392* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7393* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7394* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7395*                                IS OPEN OR CNC DT < PD THRU
  7396* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7397* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7398* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7399* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7400* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7401* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7402* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7403* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 137
* EL050.cbl
  7404* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7405* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7406* 020906                   PEMA  EXPAND LOAN OFFICER
  7407* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7408* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7409* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7410* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7411* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7412* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7413* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7414* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7415* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7416* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7417* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7418* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7419* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7420* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7421* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7422* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7423* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7424* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7425* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7426* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7427* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7428* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7429* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7430* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7431* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7432*                                UPDATE VIN ON CERT TRAILER
  7433* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7434* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7435* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7436* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7437* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7438* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7439* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7440* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7441* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7442* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7443* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7444* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7445* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7446* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7447* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7448* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7449* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7450* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7451* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7452* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7453* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7454* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7455* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7456* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7457* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7458* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7459* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7460* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7461* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 138
* EL050.cbl
  7462* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7463* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7464******************************************************************
  7465************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7466******************************************************************
  7467
  7468     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7469
  7470     MOVE SPACES                 TO PB-FATAL-FLAG
  7471                                    PB-FORCE-ER-CD
  7472                                    PB-WARN-ER-CD
  7473                                    PB-OUT-BAL-CD.
  7474
  7475     MOVE SPACE                  TO WS-IG-OVRD-AH
  7476                                    WS-IG-OVRD-LF
  7477                                    WS-IG-OVRD-AM
  7478                                    WS-IG-OVRD
  7479                                    WS-IG-OVRD-AH-PL
  7480                                    WS-IG-OVRD-LF-PL
  7481                                    WS-IG-OVRD-AH-BEN
  7482                                    WS-IG-OVRD-LF-BEN.
  7483
  7484******************************************************************
  7485*************       INITIALIZE COMMON ERRORS       ***************
  7486******************************************************************
  7487
  7488     MOVE +0                     TO PB-NO-OF-ERRORS.
  7489     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7490
  7491******************************************************************
  7492
  7493     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7494     SET JULIAN-TO-BIN           TO TRUE.
  7495*    MOVE 5                      TO DC-OPTION-CODE.
  7496     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7497     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7498
  7499     MOVE ZERO                   TO  SUB4.
  7500
  7501 0040-INITIALIZE-GA-BILL-DT.
  7502
  7503     ADD +1                      TO  SUB4.
  7504
  7505     IF  SUB4 GREATER THAN +5
  7506         GO TO 0050-CHECK-CNTL-FOUND.
  7507
  7508     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7509         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7510
  7511     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7512
  7513 0050-CHECK-CNTL-FOUND.
  7514
  7515     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7516        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7517                                         WS-AH-REM-TERM-CALC
  7518                                         EC-CO-REM-TERM-CALC
  7519        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 139
* EL050.cbl
  7520        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7521        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7522                                         WS-TOL-AH-CLAIM
  7523        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7524                                         WS-TOL-AH-PREM
  7525                                         EC-CO-TOL-PREM
  7526        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7527                                         WS-TOL-AH-REFUND
  7528                                         EC-CO-TOL-REFUND
  7529        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7530                                         WS-AH-REFUND-OVS-AMT
  7531                                         EC-CO-OVR-SHT-AMT
  7532        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7533                                         WS-TOL-AH-PREM-PCT
  7534                                         EC-CO-TOL-PREM-PCT
  7535        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7536                                         WS-TOL-AH-REFUND-PCT
  7537                                         EC-CO-TOL-REFUND-PCT
  7538        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7539                                         WS-AH-REFUND-OVS-PCT
  7540                                         EC-CO-OVR-SHT-PCT
  7541        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7542        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7543        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7544        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7545        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7546        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7547        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7548        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7549        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7550        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7551        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7552        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7553                                         EC-CO-MONTH-END-DT
  7554        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7555          GO TO 0100-READ-ACCT.
  7556
  7557     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7558     MOVE SPACES                 TO CNTL-ACCESS.
  7559     MOVE '1'                    TO CNTL-REC-TYPE.
  7560     MOVE +0                     TO CNTL-SEQ-NO.
  7561
  7562     MOVE '1' TO RC-SW-1.
  7563     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7564     IF NOT CF-COMPANY-MASTER
  7565         MOVE ZEROS             TO WK-CO-TOL-PREM
  7566                                   WK-CO-TOL-CLAIM
  7567                                   WK-CO-TOL-REFUND
  7568                                   WK-REFUND-OVS-AMT
  7569                                   WK-REFUND-OVS-PCT
  7570                                   WK-CO-TOL-PREM-PCT
  7571                                   WK-CO-TOL-REFUND-PCT
  7572                                   WK-DEFAULT-APR
  7573                                   WK-CO-MAX-CAP
  7574        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7575                                   WK-CR-R78-METHOD
  7576                                   WK-CO-REF-REJECT-SW
  7577                                   WK-CO-PREM-REJECT-SW
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 140
* EL050.cbl
  7578                                   WK-REM-TRM-CALC-OPTION
  7579                                   WK-BIRTH-DATE-INPUT
  7580                                   WK-JOINT-AGE-INPUT
  7581        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7582        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7583        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7584        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7585          GO TO 0099-COMPANY-NOT-FOUND.
  7586
  7587     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7588        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7589     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7590        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7591     IF CF-CO-TOL-CAP NOT NUMERIC
  7592        MOVE +0                    TO CF-CO-TOL-CAP.
  7593     IF CF-DEFAULT-APR NOT NUMERIC
  7594        MOVE +0                    TO CF-DEFAULT-APR.
  7595
  7596     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7597     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7598     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7599     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7600     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7601     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7602     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7603     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7604     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7605     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7606     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7607     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7608
  7609     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7610          CF-CO-OVR-SHT-AMT > +0
  7611        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7612
  7613     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7614          CF-CO-OVR-SHT-PCT > +0
  7615        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7616
  7617     IF CF-VALID-REM-TRM-OPTION
  7618         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7619     ELSE
  7620         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7621
  7622     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7623     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7624     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7625     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7626
  7627     GO TO 0050-CHECK-CNTL-FOUND.
  7628
  7629 0099-COMPANY-NOT-FOUND.
  7630
  7631     MOVE ER-2616                TO WS-ERROR.
  7632     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7633
  7634 0100-READ-ACCT.
  7635
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 141
* EL050.cbl
  7636     MOVE SPACES                 TO DATE-RANGE-SW.
  7637
  7638     IF WK-ACCT-ADDR = ZEROS
  7639        GO TO 0102-ACCT-GETMAIN.
  7640
  7641     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7642     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7643     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7644
  7645     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7646        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7647        GO TO 0105-READ-ACCT
  7648     END-IF
  7649
  7650     IF PB-CARRIER NOT = SPACES
  7651        IF PB-CARRIER NOT = AM-VG-CARRIER
  7652           GO TO 0105-READ-ACCT.
  7653
  7654     IF PB-STATE NOT = SPACES
  7655        IF PB-STATE NOT = AM-VG-STATE
  7656           GO TO 0105-READ-ACCT.
  7657
  7658     IF PB-GROUPING NOT = SPACES
  7659        IF PB-GROUPING NOT = AM-VG-GROUPING
  7660           GO TO 0105-READ-ACCT.
  7661
  7662     MOVE 'X'                 TO DATE-RANGE-SW.
  7663
  7664     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7665        MOVE 'X'                 TO DATE-RANGE-SW
  7666        GO TO 0105-READ-ACCT.
  7667
  7668     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7669        GO TO 0105-READ-ACCT.
  7670
  7671     GO TO 0180-ACCOUNT-FOUND.
  7672
  7673 0102-ACCT-GETMAIN.
  7674     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7675     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7676
  7677 0105-READ-ACCT.
  7678     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7679     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7680     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7681     MOVE PB-STATE               TO ACCT-STATE.
  7682     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7683     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7684
  7685     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7686
  7687     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7688
  7689 0110-FIND-ACCT-TOLERANCES-LOOP.
  7690     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7691
  7692     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7693        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 142
* EL050.cbl
  7694        GO TO 0199-ACCT-NOT-FOUND
  7695     END-IF
  7696     IF PB-CARRIER NOT = SPACES
  7697        IF PB-CARRIER NOT = AM-VG-CARRIER
  7698           GO TO 0199-ACCT-NOT-FOUND.
  7699
  7700     IF PB-STATE NOT = SPACES
  7701        IF PB-STATE NOT = AM-VG-STATE
  7702           GO TO 0199-ACCT-NOT-FOUND.
  7703
  7704     IF PB-GROUPING NOT = SPACES
  7705        IF PB-GROUPING NOT = AM-VG-GROUPING
  7706           GO TO 0199-ACCT-NOT-FOUND.
  7707
  7708     MOVE 'X'                    TO DATE-RANGE-SW.
  7709
  7710     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7711        MOVE 'X'                 TO DATE-RANGE-SW
  7712        GO TO 0199-ACCT-NOT-FOUND.
  7713
  7714     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7715        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7716
  7717 0180-ACCOUNT-FOUND.
  7718     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7719     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7720     MOVE AM-STATE               TO PB-SV-STATE.
  7721     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7722
  7723     IF AM-CANCEL-FEE  NOT NUMERIC
  7724        MOVE ZEROS TO AM-CANCEL-FEE.
  7725
  7726     IF AM-MAX-MON-BEN NOT NUMERIC
  7727        MOVE ZEROS TO AM-MAX-MON-BEN.
  7728
  7729     IF AM-MAX-TOT-BEN NOT NUMERIC
  7730        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7731
  7732     IF AM-CLP-TOL-PCT NOT NUMERIC
  7733        MOVE +0                  TO AM-CLP-TOL-PCT
  7734     END-IF
  7735     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7736        MOVE +0                  TO AM-SPP-LEASE-COMM
  7737     END-IF
  7738     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7739        MOVE ER-2611             TO   WS-ERROR
  7740        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7741
  7742     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7743        MOVE ER-2621             TO   WS-ERROR
  7744        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7745
  7746     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7747        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7748        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7749        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7750         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7751
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 143
* EL050.cbl
  7752     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7753     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7754     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7755     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7756     IF AM-CLP-TOL-PCT NOT = ZEROS
  7757        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7758     END-IF
  7759     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7760        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7761     END-IF
  7762*    IF PB-COMPANY-ID = 'DCC'
  7763*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7764*                                   WS-ADMIN-FEES
  7765*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7766*          (SUB5 > +10)
  7767*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7768*             AND (AM-A-COM (SUB5) NUMERIC)
  7769*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7770*                + (AM-A-COM (SUB5) * 1000)
  7771*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7772*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7773*                + (AM-A-COM (SUB5) * 1000)
  7774*             END-IF
  7775*             IF AM-COM-TYP (SUB5) = 'N'
  7776*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7777*                + (AM-A-COM (SUB5) * 1000)
  7778*             END-IF
  7779*          END-IF
  7780*       END-PERFORM
  7781*    END-IF
  7782     IF (PB-COMPANY-ID = 'DCC')
  7783        AND (PB-ISSUE)
  7784        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7785        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7786           (SUB5 > +10)
  7787           MOVE +0 TO WS-WK-RATE
  7788           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7789              IF (AM-A-COM (SUB5) NUMERIC)
  7790                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7791                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7792              ELSE
  7793                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7794                 IF PB-ISSUE
  7795                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7796                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7797                 ELSE
  7798                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7799                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7800                 END-IF
  7801                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7802                 MOVE ZEROS             TO WS-SUB1
  7803                                           WS-COMMISSION
  7804                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7805                 MOVE '0530'               TO CTBL-SW
  7806                 MOVE ' '                  TO WS-CTBL-READ-SW
  7807                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7808                 IF FIRST-TIME-THROUGH
  7809                    MOVE 'AA'              TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 144
* EL050.cbl
  7810                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7811                 END-IF
  7812                 IF CTBL-TABLE-FOUND
  7813                    IF PB-ISSUE
  7814                       COMPUTE WS-COMM-CK-AMT =
  7815                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7816                    ELSE
  7817                       COMPUTE WS-COMM-CK-AMT =
  7818                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7819                    END-IF
  7820                    PERFORM 8800-GET-COMP-RATE
  7821                              THRU 8800-EXIT
  7822                 END-IF
  7823              END-IF
  7824              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7825                + (WS-WK-RATE * 1000)
  7826           END-IF
  7827        END-PERFORM
  7828     END-IF
  7829     IF PB-COMPANY-ID EQUAL 'CRI'
  7830         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7831
  7832     IF PB-COMPANY-ID EQUAL 'NCL'
  7833         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7834     END-IF
  7835
  7836     GO TO 0200-READ-CERT.
  7837
  7838 0199-ACCT-NOT-FOUND.
  7839
  7840     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7841
  7842     IF DATE-RANGE-SW NOT = SPACES
  7843        MOVE ER-2601             TO WS-ERROR
  7844        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7845     ELSE
  7846        MOVE ER-2619             TO WS-ERROR
  7847        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7848
  7849     GO TO 9990-RETURN.
  7850
  7851 0200-READ-CERT.
  7852
  7853     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  7854     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7855     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7856     MOVE PB-SV-STATE            TO CERT-STATE.
  7857     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  7858     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  7859     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  7860
  7861     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  7862
  7863     IF CERT-WAS-NOT-FOUND
  7864        GO TO 0299-CERT-NOT-FOUND.
  7865
  7866     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  7867        MOVE ER-2759             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 145
* EL050.cbl
  7868        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7869        GO TO 0298-UNLOCK-RETURN.
  7870
  7871     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  7872         MOVE ER-2758            TO WS-ERROR
  7873         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7874         GO TO 0298-UNLOCK-RETURN.
  7875
  7876     IF PB-ISSUE
  7877        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  7878           IF CERT-WAS-CREATED-FOR-CLAIM
  7879              NEXT SENTENCE
  7880            ELSE
  7881              MOVE ER-2626       TO WS-ERROR
  7882              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7883              GO TO 0298-UNLOCK-RETURN.
  7884
  7885     IF NOT PB-CANCELLATION
  7886        GO TO 0300-CONTINUE-EDIT.
  7887
  7888     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  7889     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  7890     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  7891     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  7892     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  7893     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  7894
  7895     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  7896     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  7897     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  7898     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  7899     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  7900     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  7901     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  7902     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  7903     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  7904
  7905     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  7906     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  7907     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  7908     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  7909     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  7910     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  7911     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  7912
  7913     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  7914     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  7915
  7916     MOVE CM-CREDIT-INTERFACE-SW-1
  7917                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  7918     MOVE CM-CREDIT-INTERFACE-SW-2
  7919                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  7920
  7921     IF CM-O-B-COVERAGE
  7922         MOVE 'B'                 TO PB-CI-OB-FLAG.
  7923
  7924     IF CM-LIVES NOT NUMERIC
  7925         MOVE ZERO                TO CM-LIVES.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 146
* EL050.cbl
  7926
  7927     IF CM-BILLED NOT NUMERIC
  7928         MOVE ZERO                TO CM-BILLED.
  7929
  7930     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  7931         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  7932         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  7933         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  7934         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  7935         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  7936         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  7937         MOVE CM-LIVES             TO PB-CI-LIVES
  7938*The next line causes a problem with my change  I dont think it is
  7939*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  7940
  7941     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  7942     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  7943     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  7944     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  7945     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  7946     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  7947
  7948     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  7949     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  7950     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  7951     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  7952
  7953     IF CM-LIFE-COMM-PCT NUMERIC
  7954         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  7955     ELSE
  7956         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  7957
  7958     IF CM-AH-COMM-PCT NUMERIC
  7959         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  7960     ELSE
  7961         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  7962
  7963     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  7964
  7965     IF CM-LOAN-APR       NOT NUMERIC
  7966           MOVE ZERO               TO CM-LOAN-APR.
  7967
  7968     IF CM-PAY-FREQUENCY  NOT NUMERIC
  7969           MOVE ZERO               TO CM-PAY-FREQUENCY.
  7970
  7971     IF CM-LOAN-TERM      NOT NUMERIC
  7972           MOVE ZERO               TO CM-LOAN-TERM.
  7973
  7974     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  7975           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  7976
  7977     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  7978           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  7979
  7980     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  7981     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  7982     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  7983     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 147
* EL050.cbl
  7984     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  7985     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  7986     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  7987     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  7988     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  7989     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  7990     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  7991     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  7992
  7993     IF CM-STATE = CM-SSN-STATE
  7994         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  7995
  7996     IF CM-STATE NOT = CM-MEMB-STATE
  7997         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  7998
  7999     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8000
  8001     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8002        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8003        IF CM-ADDL-CLP NOT NUMERIC
  8004           MOVE +0               TO CM-ADDL-CLP
  8005        END-IF
  8006        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8007        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8008           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8009        END-IF
  8010     END-IF
  8011     IF PB-COMPANY-ID = 'DCC'
  8012        MOVE +0                  TO WS-ADMIN-FEES
  8013                                    WS-CSO-ADMIN-FEE
  8014                                    WS-COMM-AND-MFEE
  8015                                    WS-1ST-YR-ALLOW
  8016        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8017           (SUB5 > +10)
  8018           MOVE +0 TO WS-WK-RATE
  8019           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8020              IF (AM-A-COM (SUB5) NUMERIC)
  8021                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8022                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8023              ELSE
  8024                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8025                 IF PB-ISSUE
  8026                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8027                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8028                 ELSE
  8029                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8030                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8031                 END-IF
  8032                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8033                 MOVE ZEROS             TO WS-SUB1
  8034                                           WS-COMMISSION
  8035                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8036                 MOVE '0530'               TO CTBL-SW
  8037                 MOVE ' '                  TO WS-CTBL-READ-SW
  8038                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8039                 IF FIRST-TIME-THROUGH
  8040                    MOVE 'AA'              TO CTBL-BEN-CODE
  8041                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 148
* EL050.cbl
  8042                 END-IF
  8043                 IF CTBL-TABLE-FOUND
  8044                    IF PB-ISSUE
  8045                       COMPUTE WS-COMM-CK-AMT =
  8046                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8047                    ELSE
  8048                       COMPUTE WS-COMM-CK-AMT =
  8049                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8050                    END-IF
  8051                    PERFORM 8800-GET-COMP-RATE
  8052                              THRU 8800-EXIT
  8053                 END-IF
  8054              END-IF
  8055              IF AM-COM-TYP (SUB5) = 'I'
  8056                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8057                   + (WS-WK-RATE * 1000)
  8058              END-IF
  8059              IF AM-COM-TYP (SUB5) = 'N'
  8060                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8061                   + (WS-WK-RATE * 1000)
  8062              END-IF
  8063              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8064                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8065                   + (WS-WK-RATE * 1000)
  8066              END-IF
  8067              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8068                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8069                   + (WS-WK-RATE * 1000)
  8070              END-IF
  8071           END-IF
  8072        END-PERFORM
  8073     END-IF
  8074     GO TO 0300-CONTINUE-EDIT.
  8075
  8076 0298-UNLOCK-RETURN.
  8077      PERFORM 9250-UNLOCK-RETURN
  8078      GO TO 9990-RETURN.
  8079
  8080 0299-CERT-NOT-FOUND.
  8081
  8082     MOVE '1'                     TO CERT-STATUS-SW.
  8083
  8084     IF PB-COMPANY-ID = 'UCL'
  8085         IF WS-ERROR = ER-2799
  8086             GO TO 3000-CONTINUE-EDIT.
  8087
  8088     IF NOT PB-CANCELLATION
  8089         GO TO 0300-CONTINUE-EDIT.
  8090
  8091     MOVE ER-2726                  TO  WS-ERROR.
  8092     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8093     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8094     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8095                                    PB-CI-LF-TERM
  8096                                    PB-C-LF-REM-TERM
  8097                                    PB-CI-AH-TERM
  8098                                    PB-C-AH-REM-TERM
  8099                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 149
* EL050.cbl
  8100                                    PB-CI-LF-BENEFIT-AMT
  8101                                    PB-CI-LF-ALT-BENEFIT-AMT
  8102                                    PB-CI-LF-PREMIUM-AMT
  8103                                    PB-CI-LF-ALT-PREMIUM-AMT
  8104                                    PB-CI-AH-BENEFIT-CD
  8105                                    PB-CI-AH-BENEFIT-AMT
  8106                                    PB-CI-AH-PREMIUM-AMT
  8107                                    PB-CI-PAY-FREQUENCY
  8108                                    PB-CI-LOAN-APR
  8109                                    PB-CI-LOAN-TERM
  8110                                    PB-CI-LIFE-COMMISSION
  8111                                    PB-CI-AH-COMMISSION
  8112                                    PB-CI-CURR-SEQ
  8113                                    PB-CI-AH-CANCEL-AMT
  8114                                    PB-CI-LF-CANCEL-AMT
  8115                                    PB-CI-RATE-DEV-PCT-LF
  8116                                    PB-CI-RATE-DEV-PCT-AH
  8117                                    PB-CI-EXTENTION-DAYS
  8118                                    PB-CI-TERM-IN-DAYS
  8119                                    PB-CI-LIVES
  8120                                    PB-CI-LF-CRIT-PER
  8121                                    PB-CI-AH-CRIT-PER
  8122                                    PB-CI-ADDL-CLP
  8123                                    PB-CI-DDF-IU-RATE-UP.
  8124
  8125     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8126                                    PB-CI-AH-SETTLEMENT-DT
  8127                                    PB-CI-DEATH-DT
  8128                                    PB-CI-LF-PRIOR-CANCEL-DT
  8129                                    PB-CI-AH-PRIOR-CANCEL-DT
  8130                                    PB-CI-ENTRY-DT
  8131                                    PB-CI-LF-EXPIRE-DT
  8132                                    PB-CI-AH-EXPIRE-DT
  8133                                    PB-CI-LOAN-1ST-PMT-DT.
  8134
  8135     IF ACCOUNT-MAST-FOUND
  8136        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8137        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8138
  8139     GO TO 3000-CONTINUE-EDIT.
  8140
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 150
* EL050.cbl
  8142
  8143 0300-CONTINUE-EDIT.
  8144
  8145     IF PB-ISSUE
  8146        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8147            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8148
  8149     IF PB-ISSUE
  8150        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8151            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8152
  8153     IF PB-ISSUE
  8154       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8155          (AM-NO-AH-ONLY)
  8156           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8157               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8158                   MOVE ER-2679 TO WS-ERROR
  8159                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8160
  8161     IF PB-ISSUE
  8162        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8163        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8164        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8165     ELSE
  8166        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8167        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8168        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8169
  8170     MOVE 'N'                    TO PLAN-MASTER-SW
  8171                                    PLAN-MASTER-LIFE-SW
  8172                                    FORM-MASTER-SW
  8173                                    WS-APP-CERT-SW.
  8174
  8175     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8176                                    WS-PL-TOL-LF-REFUND
  8177                                    WS-PL-REF-OVS-AMT
  8178                                    WS-PL-TOL-LF-PREM-PCT
  8179                                    WS-PL-TOL-LF-REFUND-PCT
  8180                                    WS-PL-REF-OVS-PCT
  8181                                    WS-PL-TOL-LF-CLAIM.
  8182
  8183     IF PB-COMPANY-ID = 'NCL'
  8184       IF PB-ISSUE
  8185         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8186             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8187             IF FORM-MASTER-FOUND
  8188                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8189
  8190     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8191        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8192
  8193********************** MON CODE **********************
  8194     IF PB-COMPANY-ID = 'MON'
  8195     IF PB-ISSUE
  8196     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8197        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8198             PB-I-LOAN-APR = ZERO)
  8199               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 151
* EL050.cbl
  8200******************************************************
  8201
  8202     IF PB-COMPANY-ID = 'NCL'
  8203       IF PB-ISSUE
  8204           IF FORM-MASTER-FOUND
  8205             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8206                AM-DISMBR-COVERAGE
  8207                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8208                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8209                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8210                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8211                                           PB-I-LIFE-BENEFIT-CD.
  8212
  8213     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8214
  8215     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8216         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8217         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8218         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8219         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8220         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8221           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8222             GO TO 0301-LIFE-BENEFIT-SEARCH
  8223         ELSE
  8224             NEXT SENTENCE
  8225     ELSE
  8226         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8227
  8228     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8229     MOVE '4'                    TO CNTL-REC-TYPE.
  8230     MOVE +0                     TO CNTL-SEQ-NO.
  8231     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8232
  8233     MOVE '1' TO RC-SW-2.
  8234     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8235
  8236     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8237        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8238         GO TO 0305-BENEFIT-NOT-FOUND.
  8239
  8240     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8241
  8242 0301-LIFE-BENEFIT-SEARCH.
  8243
  8244     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8245
  8246     IF NO-BENEFIT-FOUND
  8247        GO TO 0305-BENEFIT-NOT-FOUND.
  8248
  8249     IF WS-BEN-CD = '99'
  8250        GO TO 0305-BENEFIT-NOT-FOUND.
  8251
  8252     IF PB-COMPANY-ID = 'NCL'
  8253         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8254             GO TO 0304-LIFE-BENEFIT-FOUND.
  8255
  8256     MOVE +1                     TO SUB5.
  8257     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 152
* EL050.cbl
  8258
  8259* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8260* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8261     IF PB-COMPANY-ID = 'DMD'
  8262         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8263
  8264 0302-EDIT-ACCT-LF-BENEFITS.
  8265
  8266     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8267        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8268           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8269                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8270           GO TO 03XX-GET-LIFE-ERPLAN.
  8271
  8272     IF SUB5 LESS THAN +20
  8273        ADD +1                   TO SUB5
  8274        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8275
  8276     MOVE +1                     TO SUB5.
  8277
  8278     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8279        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8280
  8281 0303-EDIT-DMD-EXTRA-BENEFITS.
  8282
  8283     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8284        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8285           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8286                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8287           GO TO 03XX-GET-LIFE-ERPLAN.
  8288
  8289     IF SUB5 LESS THAN +30
  8290        ADD +1                   TO SUB5
  8291        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8292
  8293     MOVE +1                     TO SUB5.
  8294
  8295 03XX-EDIT-FOR-NINETY-LF.
  8296
  8297***************************************************************
  8298*                                                             *
  8299*    NINETY BENEFIT PLAN TYPES:                               *
  8300*                                                             *
  8301*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8302*      92 = ALL GROUP REDUCING BENEFITS                       *
  8303*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8304*      94 = ALL GROUP LEVEL BENEFITS                          *
  8305*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8306*           BENEFIT CONTROLS.                                 *
  8307*      99 = ALL BENEFITS                                      *
  8308*                                                             *
  8309***************************************************************
  8310
  8311     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8312                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8313
  8314     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8315       AND
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 153
* EL050.cbl
  8316        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8317        GO TO 03XX-GET-LIFE-ERPLAN.
  8318
  8319     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8320       AND
  8321        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8322        IF CF-REDUCING (SUB3)
  8323           IF (PB-I-INDV-GRP-OVRD = 'I')
  8324              OR
  8325           ((AM-IG = '1') AND
  8326           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8327              OR
  8328           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8329           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8330           (AM-IG NOT = '2'))
  8331              GO TO 03XX-GET-LIFE-ERPLAN.
  8332
  8333     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8334       AND
  8335        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8336        IF CF-REDUCING (SUB3)
  8337           IF (PB-I-INDV-GRP-OVRD = 'G')
  8338              OR
  8339           ((AM-IG = '2') AND
  8340           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8341              OR
  8342           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8343           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8344           (AM-IG NOT = '1'))
  8345              GO TO 03XX-GET-LIFE-ERPLAN.
  8346
  8347     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8348       AND
  8349        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8350        IF CF-LEVEL    (SUB3)
  8351           IF (PB-I-INDV-GRP-OVRD = 'I')
  8352              OR
  8353           ((AM-IG = '1') AND
  8354           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8355              OR
  8356           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8357           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8358            (AM-IG NOT = '2'))
  8359              GO TO 03XX-GET-LIFE-ERPLAN.
  8360
  8361     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8362       AND
  8363        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8364        IF CF-LEVEL    (SUB3)
  8365           IF (PB-I-INDV-GRP-OVRD = 'G')
  8366              OR
  8367           ((AM-IG = '2') AND
  8368           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8369              OR
  8370           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8371           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8372           (AM-IG NOT = '1'))
  8373              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 154
* EL050.cbl
  8374
  8375     IF SUB5 LESS THAN +20
  8376        ADD +1                   TO SUB5
  8377        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8378
  8379     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8380
  8381     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8382        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8383
  8384     MOVE +1                     TO SUB5.
  8385
  8386 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8387
  8388     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8389                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8390
  8391     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8392       AND
  8393        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8394        GO TO 03XX-GET-LIFE-ERPLAN.
  8395
  8396     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8397       AND
  8398        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8399        IF CF-REDUCING (SUB3)
  8400           IF (PB-I-INDV-GRP-OVRD = 'I')
  8401              OR
  8402           ((AM-IG = '1') AND
  8403           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8404              OR
  8405           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8406           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8407           (AM-IG NOT = '2'))
  8408              GO TO 03XX-GET-LIFE-ERPLAN.
  8409
  8410     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8411       AND
  8412        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8413        IF CF-REDUCING (SUB3)
  8414           IF (PB-I-INDV-GRP-OVRD = 'G')
  8415              OR
  8416           ((AM-IG = '2') AND
  8417           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8418              OR
  8419           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8420           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8421           (AM-IG NOT = '1'))
  8422              GO TO 03XX-GET-LIFE-ERPLAN.
  8423
  8424     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8425       AND
  8426        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8427        IF CF-LEVEL    (SUB3)
  8428           IF (PB-I-INDV-GRP-OVRD = 'I')
  8429              OR
  8430           ((AM-IG = '1') AND
  8431           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 155
* EL050.cbl
  8432              OR
  8433           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8434           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8435            (AM-IG NOT = '2'))
  8436              GO TO 03XX-GET-LIFE-ERPLAN.
  8437
  8438     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8439       AND
  8440        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8441        IF CF-LEVEL    (SUB3)
  8442           IF (PB-I-INDV-GRP-OVRD = 'G')
  8443              OR
  8444           ((AM-IG = '2') AND
  8445           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8446              OR
  8447           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8448           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8449           (AM-IG NOT = '1'))
  8450              GO TO 03XX-GET-LIFE-ERPLAN.
  8451
  8452     IF SUB5 LESS THAN +30
  8453        ADD +1                   TO SUB5
  8454        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8455
  8456     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8457
  8458 03XX-EDIT-FOR-NINETY-LF-CONT.
  8459
  8460     MOVE +99                    TO SUB5.
  8461
  8462     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8463        IF PB-ISSUE
  8464           MOVE ER-1924          TO  WS-ERROR
  8465           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8466
  8467     GO TO 0304-LIFE-BENEFIT-FOUND.
  8468
  8469 03XX-GET-LIFE-ERPLAN.
  8470
  8471     IF WK-PLAN-ADDR EQUAL +0
  8472        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8473
  8474     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8475     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8476     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8477     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8478     MOVE 'Y'                    TO PLAN-MASTER-SW
  8479                                    PLAN-MASTER-LIFE-SW.
  8480     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8481
  8482 03XX-ERPLAN-LIFE-GETMAIN.
  8483
  8484     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8485     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8486
  8487 03XX-ERPLAN-LIFE-READ.
  8488
  8489     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 156
* EL050.cbl
  8490     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8491     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8492     MOVE PB-SV-STATE            TO PLAN-STATE.
  8493     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8494     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8495     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8496     MOVE WS-SAVE-BENEFIT-REVISION
  8497                                 TO PLAN-REVISION-NO.
  8498
  8499     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8500     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8501
  8502     IF PB-COMPANY-ID = 'NCL'
  8503       IF NOT LF-PLAN-MASTER-FOUND
  8504         IF NOT PB-POLICY-IS-DECLINED  AND
  8505            NOT PB-POLICY-IS-VOIDED
  8506             MOVE  ER-1921         TO  WS-ERROR
  8507             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8508             GO TO 0304-LIFE-BENEFIT-FOUND.
  8509
  8510     IF NOT LF-PLAN-MASTER-FOUND
  8511        GO TO 0304-LIFE-BENEFIT-FOUND.
  8512
  8513 XXXX-CHECK-LF-PLAN-KEY.
  8514
  8515     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8516        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8517        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8518        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8519        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8520        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8521        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8522        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8523        MOVE 'N'                 TO PLAN-MASTER-SW
  8524          GO TO 03XX-ERPLAN-LIFE-READ.
  8525
  8526     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8527
  8528     IF  PB-CANCELLATION
  8529         GO TO  0303-LF-ACCT-BEN-FOUND.
  8530
  8531     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8532        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8533           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8534           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8535              MOVE ER-2644             TO WS-ERROR
  8536              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8537           ELSE
  8538              NEXT SENTENCE
  8539        ELSE
  8540           IF PB-COMPANY-ID NOT = 'NCL'
  8541              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8542                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8543
  8544 0303-LF-ACCT-BEN-FOUND.
  8545
  8546     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8547
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 157
* EL050.cbl
  8548     IF PL-DEV-CODE NOT = SPACES
  8549        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8550
  8551     IF PL-DEV-PCT NUMERIC AND
  8552        PL-DEV-PCT NOT = ZEROS
  8553        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8554
  8555     IF PL-TOL-PREM-AMT GREATER THAN +0
  8556        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8557
  8558     IF PL-TOL-REF-AMT GREATER THAN +0
  8559        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8560
  8561     IF PL-TOL-PREM-PCT GREATER THAN +0
  8562        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8563
  8564     IF PL-TOL-REF-PCT GREATER THAN +0
  8565        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8566
  8567     IF PL-TOL-CLM-AMT GREATER THAN +0
  8568        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8569
  8570     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8571                          PL-OVER-SHORT-AMT > +0
  8572        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8573
  8574     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8575                          PL-OVER-SHORT-PCT > +0
  8576        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8577
  8578     IF PL-SALES-TAX NUMERIC AND
  8579                          PL-SALES-TAX > +0
  8580         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8581
  8582     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8583        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8584                                    WS-IG-OVRD-AM.
  8585
  8586 0304-LIFE-BENEFIT-FOUND.
  8587
  8588     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8589
  8590     IF PB-ISSUE
  8591        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8592     ELSE
  8593        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8594
  8595     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8596     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8597     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8598     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8599     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8600                                         WS-LF-REFUND-CALC.
  8601
  8602     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8603        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8604
  8605     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 158
* EL050.cbl
  8606        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8607     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8608
  8609     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8610     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8611     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8612     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8613     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8614     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8615
  8616     IF PB-COMPANY-ID = 'NCL'  AND
  8617        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8618         NEXT SENTENCE
  8619     ELSE
  8620         IF SUB5 NOT GREATER THAN +20
  8621            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8622               MOVE WS-SAVE-BENEFIT-REM-TERM
  8623                                      TO WS-AM-LF-BENE-REM-TERM
  8624                                         EC-BR-LF-REM-TERM-CALC.
  8625
  8626     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8627     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8628
  8629     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8630
  8631 0305-BENEFIT-NOT-FOUND.
  8632
  8633     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8634     MOVE ER-2604                TO WS-ERROR.
  8635     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8636
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 159
* EL050.cbl
  8638
  8639 0310-FIND-AH-BENEFIT-RECORD.
  8640
  8641     MOVE 'N'                    TO PLAN-MASTER-SW
  8642                                    PLAN-MASTER-AH-SW.
  8643
  8644     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8645                                    WS-PL-TOL-AH-REFUND
  8646                                    WS-AH-PL-REF-OVS-AMT
  8647                                    WS-PL-TOL-AH-PREM-PCT
  8648                                    WS-PL-TOL-AH-REFUND-PCT
  8649                                    WS-AH-PL-REF-OVS-PCT
  8650                                    WS-PL-TOL-AH-CLAIM.
  8651     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8652
  8653
  8654     if pb-issue
  8655        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8656           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8657        end-if
  8658        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8659           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8660           GO TO 0399-BENEFIT-NOT-FOUND
  8661        end-if
  8662     end-if
  8663
  8664     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8665        GO TO 0400-FIND-CARRIER.
  8666
  8667     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8668
  8669     IF WK-AH-BEN-ADDR NOT = ZEROS
  8670         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8671         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8672         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8673         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8674           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8675             GO TO 0311-AH-BENEFIT-SEARCH
  8676         ELSE
  8677             NEXT SENTENCE
  8678     ELSE
  8679         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8680
  8681     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8682     MOVE '5'                    TO CNTL-REC-TYPE.
  8683     MOVE +0                     TO CNTL-SEQ-NO.
  8684     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8685
  8686     MOVE '2' TO RC-SW-2.
  8687     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8688
  8689     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8690        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8691          GO TO 0399-BENEFIT-NOT-FOUND.
  8692
  8693     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8694
  8695 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 160
* EL050.cbl
  8696
  8697     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8698
  8699     IF NO-BENEFIT-FOUND
  8700         GO TO 0399-BENEFIT-NOT-FOUND.
  8701
  8702     IF WS-BEN-CD = '99'
  8703        GO TO 0399-BENEFIT-NOT-FOUND.
  8704
  8705     IF PB-COMPANY-ID  =  'NCL'
  8706         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8707             GO TO 0314-A-H-BENEFIT-FOUND.
  8708
  8709     MOVE +1                     TO SUB5.
  8710     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8711
  8712* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8713* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8714     IF PB-COMPANY-ID = 'DMD'
  8715         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8716
  8717 0312-EDIT-ACCT-AH-BENEFITS.
  8718
  8719     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8720        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8721           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8722                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8723           GO TO 03XX-GET-AH-ERPLAN.
  8724
  8725     IF SUB5 LESS THAN +20
  8726        ADD +1                   TO SUB5
  8727        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8728
  8729     MOVE +1                     TO SUB5.
  8730
  8731     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8732        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8733
  8734 0313-EDIT-DMD-EXTRA-BENEFITS.
  8735
  8736     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8737        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8738           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8739                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8740           GO TO 03XX-GET-AH-ERPLAN.
  8741
  8742     IF SUB5 LESS THAN +30
  8743        ADD +1                   TO SUB5
  8744        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8745
  8746     MOVE +1                     TO SUB5.
  8747
  8748 03XX-EDIT-FOR-NINETY-AH.
  8749
  8750***************************************************************
  8751*                                                             *
  8752*    NINETY BENEFIT PLAN TYPES:                               *
  8753*                                                             *
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 161
* EL050.cbl
  8754*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8755*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8756*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8757*           BENEFIT CONTROLS.                                 *
  8758*      99 = ALL BENEFITS.                                     *
  8759*                                                             *
  8760***************************************************************
  8761
  8762     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8763                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8764
  8765     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8766       AND
  8767        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8768        GO TO 03XX-GET-AH-ERPLAN.
  8769
  8770     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8771       AND
  8772        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8773           IF (PB-I-INDV-GRP-OVRD = 'I')
  8774              OR
  8775           ((AM-IG = '1') AND
  8776           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8777              OR
  8778           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8779           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8780           (AM-IG NOT = '2'))
  8781              GO TO 03XX-GET-AH-ERPLAN.
  8782
  8783     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8784       AND
  8785        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8786           IF (PB-I-INDV-GRP-OVRD = 'G')
  8787              OR
  8788           ((AM-IG = '2') AND
  8789           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8790              OR
  8791           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8792           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8793           (AM-IG NOT = '1'))
  8794              GO TO 03XX-GET-AH-ERPLAN.
  8795
  8796     IF SUB5 LESS THAN +20
  8797        ADD +1                   TO SUB5
  8798        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8799
  8800     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8801        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8802
  8803     MOVE +1                    TO SUB5.
  8804
  8805 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8806
  8807     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8808                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8809
  8810     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8811       AND
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 162
* EL050.cbl
  8812        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8813        GO TO 03XX-GET-AH-ERPLAN.
  8814
  8815     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  8816       AND
  8817        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8818           IF (PB-I-INDV-GRP-OVRD = 'I')
  8819              OR
  8820           ((AM-IG = '1') AND
  8821           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8822              OR
  8823           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8824           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8825           (AM-IG NOT = '2'))
  8826              GO TO 03XX-GET-AH-ERPLAN.
  8827
  8828     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8829       AND
  8830        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8831           IF (PB-I-INDV-GRP-OVRD = 'G')
  8832              OR
  8833           ((AM-IG = '2') AND
  8834           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8835              OR
  8836           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8837           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8838           (AM-IG NOT = '1'))
  8839              GO TO 03XX-GET-AH-ERPLAN.
  8840
  8841     IF SUB5 LESS THAN +30
  8842        ADD +1                   TO SUB5
  8843        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8844
  8845 03XX-EDIT-FOR-NINETY-AH-CONT.
  8846
  8847     MOVE +99                    TO SUB5.
  8848
  8849     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8850
  8851     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8852        IF PB-ISSUE
  8853           MOVE ER-1925          TO  WS-ERROR
  8854           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8855
  8856     GO TO 0314-A-H-BENEFIT-FOUND.
  8857
  8858 03XX-GET-AH-ERPLAN.
  8859
  8860     IF WK-PLAN-ADDR EQUAL +0
  8861         GO TO 03XX-ERPLAN-AH-GETMAIN.
  8862
  8863     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8864     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8865     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8866     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  8867     MOVE 'Y'                    TO PLAN-MASTER-SW
  8868                                    PLAN-MASTER-AH-SW.
  8869*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 163
* EL050.cbl
  8870     GO TO 03XX-ERPLAN-AH-READ.
  8871
  8872 03XX-ERPLAN-AH-GETMAIN.
  8873
  8874     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8875     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8876
  8877 03XX-ERPLAN-AH-READ.
  8878
  8879     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8880     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8881     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8882     MOVE PB-SV-STATE            TO PLAN-STATE.
  8883     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8884     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  8885     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8886     MOVE WS-SAVE-BENEFIT-REVISION
  8887                                 TO PLAN-REVISION-NO.
  8888
  8889     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8890     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  8891
  8892     IF PB-COMPANY-ID = 'NCL'
  8893       IF NOT AH-PLAN-MASTER-FOUND
  8894         IF NOT PB-POLICY-IS-DECLINED  AND
  8895            NOT PB-POLICY-IS-VOIDED
  8896             MOVE  ER-1922         TO  WS-ERROR
  8897             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8898             GO TO 0314-A-H-BENEFIT-FOUND.
  8899
  8900     IF NOT AH-PLAN-MASTER-FOUND
  8901        GO TO 0314-A-H-BENEFIT-FOUND.
  8902
  8903 XXXX-CHECK-AH-PLAN-KEY.
  8904
  8905     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8906        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8907        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8908        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8909        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8910        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8911        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8912        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8913        MOVE 'N'                 TO PLAN-MASTER-SW
  8914          GO TO 03XX-ERPLAN-AH-READ.
  8915
  8916     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  8917
  8918     IF  PB-CANCELLATION
  8919         GO TO  0313-AH-ACCT-BEN-FOUND.
  8920
  8921     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8922       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8923          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8924          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8925             MOVE ER-2644             TO WS-ERROR
  8926             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8927          ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 164
* EL050.cbl
  8928             NEXT SENTENCE
  8929       ELSE
  8930          IF PB-COMPANY-ID NOT = 'NCL'
  8931             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8932                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8933
  8934 0313-AH-ACCT-BEN-FOUND.
  8935
  8936     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  8937
  8938     IF PL-DEV-CODE NOT = SPACES
  8939        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  8940
  8941     IF PL-DEV-PCT NUMERIC AND
  8942        PL-DEV-PCT NOT = ZEROS
  8943        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  8944
  8945     IF PL-TOL-PREM-AMT NOT EQUAL +0
  8946        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  8947
  8948     IF PL-TOL-REF-AMT NOT EQUAL +0
  8949        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  8950
  8951     IF PL-TOL-PREM-PCT GREATER THAN +0
  8952        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  8953
  8954     IF PL-TOL-REF-PCT GREATER THAN +0
  8955        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  8956
  8957     IF PL-TOL-CLM-AMT NOT EQUAL +0
  8958        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  8959
  8960     IF PL-OVER-SHORT-AMT NUMERIC AND
  8961                          PL-OVER-SHORT-AMT > +0
  8962        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  8963
  8964     IF PL-OVER-SHORT-PCT NUMERIC AND
  8965                          PL-OVER-SHORT-PCT > +0
  8966        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  8967
  8968     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8969        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  8970        IF WS-IG-OVRD-AM EQUAL SPACES
  8971            MOVE PL-IG           TO WS-IG-OVRD-AM.
  8972
  8973 0314-A-H-BENEFIT-FOUND.
  8974
  8975     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  8976
  8977     IF PB-ISSUE
  8978        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  8979       ELSE
  8980        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  8981
  8982     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  8983     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  8984     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  8985     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 165
* EL050.cbl
  8986                                         WS-AH-REFUND-CALC.
  8987
  8988     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8989        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  8990
  8991     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8992        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  8993     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  8994
  8995     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  8996     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  8997     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  8998     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  8999     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9000     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9001
  9002     IF PB-COMPANY-ID = 'NCL'  AND
  9003        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9004         NEXT SENTENCE
  9005     ELSE
  9006         IF SUB5 NOT GREATER THAN +20
  9007            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9008                MOVE WS-SAVE-BENEFIT-REM-TERM
  9009                                      TO WS-AM-AH-BENE-REM-TERM
  9010                                         EC-BR-AH-REM-TERM-CALC.
  9011
  9012     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9013     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9014
  9015     GO TO 0400-FIND-CARRIER.
  9016
  9017 0399-BENEFIT-NOT-FOUND.
  9018
  9019     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9020     MOVE ER-2605                TO WS-ERROR.
  9021     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9022
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 166
* EL050.cbl
  9024
  9025 0400-FIND-CARRIER.
  9026
  9027     MOVE PB-SV-CARRIER          TO WS-CARR.
  9028
  9029     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9030     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9031     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9032     MOVE '6'                    TO CNTL-REC-TYPE.
  9033
  9034*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9035     MOVE SPACE                  TO WS-DMD-RATING-SW
  9036                                    EC-BR-DMD-RATING-SW.
  9037
  9038     MOVE '2'                    TO RC-SW-1.
  9039     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9040
  9041     IF NOT CF-CARRIER-MASTER
  9042        GO TO 0400-CARRIER-NOT-FOUND.
  9043
  9044 0400-BUILD-CARR-TOL.
  9045
  9046     IF CF-CR-TOL-PREM NUMERIC AND
  9047        CF-CR-TOL-PREM GREATER THAN +0
  9048        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9049                                    WS-TOL-AH-PREM.
  9050
  9051     IF CF-CR-TOL-REFUND NUMERIC AND
  9052        CF-CR-TOL-REFUND GREATER THAN +0
  9053        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9054                                    WS-TOL-AH-REFUND.
  9055
  9056     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9057        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9058        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9059                                    WS-AH-REFUND-OVS-AMT.
  9060
  9061     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9062        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9063        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9064                                    WS-AH-REFUND-OVS-PCT.
  9065
  9066     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9067        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9068        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9069                                    WS-TOL-AH-PREM-PCT.
  9070
  9071     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9072        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9073        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9074                                     WS-TOL-AH-REFUND-PCT.
  9075
  9076     IF CF-COMPANY-ID EQUAL 'DMD'
  9077         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9078                                    EC-BR-DMD-RATING-SW.
  9079
  9080     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9081     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 167
* EL050.cbl
  9082        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9083     END-IF
  9084     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9085        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9086     END-IF
  9087     IF WS-TOL-CLP-PCT = ZEROS
  9088        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9089     END-IF
  9090
  9091     IF WS-SPP-LEASE-COMM = ZEROS
  9092        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9093     END-IF
  9094     GO TO 0400-FIND-ERPDEF.
  9095
  9096 0400-CARRIER-NOT-FOUND.
  9097
  9098     MOVE ER-2602                TO WS-ERROR.
  9099     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9100
  9101 0400-FIND-ERPDEF.
  9102     IF PB-COMPANY-ID = 'DCC'
  9103        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9104        CONTINUE
  9105     ELSE
  9106        GO TO 0400-FIND-ERCOMP
  9107     END-IF
  9108     MOVE ' '                    TO PDEF-MASTER-SW
  9109     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9110     MOVE PB-STATE               TO ERPDEF-STATE
  9111     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9112     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9113     IF PB-ISSUE
  9114        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9115     ELSE
  9116        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9117     END-IF
  9118     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9119     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9120     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9121     IF PDEF-MASTER-FOUND
  9122        MOVE 'N'                 TO PDEF-MASTER-SW
  9123        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9124        IF PDEF-MASTER-FOUND
  9125           IF (ERPDEF-KEY-SAVE (1:16) =
  9126                        PD-CONTROL-PRIMARY (1:16))
  9127              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9128              CONTINUE
  9129           ELSE
  9130              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9131              IF (ERPDEF-KEY-SAVE (1:16) =
  9132                        PD-CONTROL-PRIMARY (1:16))
  9133                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9134                 CONTINUE
  9135              ELSE
  9136                 MOVE 'N'        TO PDEF-MASTER-SW
  9137              END-IF
  9138           END-IF
  9139        END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 168
* EL050.cbl
  9140        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9141     END-IF
  9142     IF PDEF-MASTER-FOUND
  9143        IF PD-TRUNCATED = 'Y'
  9144           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9145        END-IF
  9146     END-IF
  9147     .
  9148 0400-FIND-ERCOMP.
  9149     IF PB-COMPANY-ID = 'DCC'
  9150        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9151           (WS-SUB1 > +10)
  9152           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9153                 OR 'A' OR 'N'
  9154              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9155              MOVE PB-CARRIER    TO COMP-CARRIER
  9156              MOVE PB-GROUPING   TO COMP-GROUPING
  9157              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9158              MOVE AM-AGT (WS-SUB1)
  9159                                 TO COMP-FIN-RESP
  9160              MOVE 'G'           TO COMP-TYPE
  9161              PERFORM 8582-READ-COMPENSATION-MASTER
  9162                                 THRU 8582-EXIT
  9163              IF COMP-MASTER-FOUND
  9164                 IF CO-GA-INACTIVE
  9165                    MOVE ER-2763 TO WS-ERROR
  9166                    PERFORM 9900-ERROR-FORMAT
  9167                                 THRU 9900-EXIT
  9168                    MOVE +11     TO WS-SUB1
  9169                 END-IF
  9170                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9171                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9172                    MOVE ER-2788 TO WS-ERROR
  9173                    PERFORM 9900-ERROR-FORMAT
  9174                                 THRU 9900-EXIT
  9175                    MOVE +11     TO WS-SUB1
  9176                 END-IF
  9177              END-IF
  9178           END-IF
  9179        END-PERFORM
  9180     END-IF
  9181     IF (PB-COMPANY-ID = 'DCC')
  9182               AND
  9183        ((WS-LF-BEN-CATEGORY = 'D')
  9184        OR (WS-AH-BEN-CATEGORY = 'D')
  9185        OR (AM-DCC-PRODUCT-CODE = 'DDF'))
  9186        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9187           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9188                                    WS-CLP-STATE
  9189        ELSE
  9190           MOVE SPACES           TO PB-I-CLP-STATE
  9191                                    WS-CLP-STATE
  9192        END-IF
  9193     END-IF
  9194
  9195     IF (PB-COMPANY-ID = 'DCC')
  9196        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9197        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 169
* EL050.cbl
  9198        CONTINUE
  9199     ELSE
  9200        GO TO 0400-FIND-STATE-RECORD
  9201     END-IF
  9202     MOVE SPACES                 TO WS-CLP-STATE
  9203     MOVE +0                     TO WS-BANK-FEE
  9204                                    WS-BANK-LFEE
  9205                                    WS-BANK-NOCHRGB
  9206
  9207     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9208     IF (PB-ISSUE)
  9209        AND (PB-I-BANK-NUMBER NOT =
  9210            SPACES AND ZEROS AND LOW-VALUES)
  9211        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9212     ELSE
  9213        IF (PB-CANCELLATION)
  9214           AND (PB-CI-BANK-NUMBER NOT =
  9215                SPACES AND ZEROS AND LOW-VALUES)
  9216           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9217        END-IF
  9218     END-IF
  9219     IF COMP-FIN-RESP NOT = LOW-VALUES
  9220        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9221        MOVE PB-CARRIER          TO COMP-CARRIER
  9222        MOVE PB-GROUPING         TO COMP-GROUPING
  9223        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9224        MOVE 'B'                 TO COMP-TYPE
  9225        PERFORM 8582-READ-COMPENSATION-MASTER
  9226                                 THRU 8582-EXIT
  9227        IF COMP-MASTER-FOUND
  9228           IF CO-MAX-BANK-FEE NOT NUMERIC
  9229              MOVE +0            TO CO-MAX-BANK-FEE
  9230           END-IF
  9231           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9232              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9233           END-IF
  9234           IF CO-GA-INACTIVE
  9235              MOVE ER-2763       TO WS-ERROR
  9236              PERFORM 9900-ERROR-FORMAT
  9237                                 THRU 9900-EXIT
  9238           END-IF
  9239           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9240              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9241              MOVE ER-2788 TO WS-ERROR
  9242              PERFORM 9900-ERROR-FORMAT
  9243                                 THRU 9900-EXIT
  9244              MOVE +11     TO WS-SUB1
  9245           END-IF
  9246           IF WS-AH-BEN-CATEGORY = 'G'
  9247              MOVE CO-MAX-BANK-FEE
  9248                                 TO WS-BANK-FEE
  9249                                    PB-I-BANK-FEE
  9250           ELSE
  9251              MOVE CO-MAX-BANK-FEE-LEASE
  9252                                 TO WS-BANK-LFEE
  9253                                    PB-I-BANK-FEE
  9254           END-IF
  9255           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 170
* EL050.cbl
  9256              AND (WS-AH-REFUND-CALC = 'G'))
  9257                        OR
  9258              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9259              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9260              CONTINUE
  9261           ELSE
  9262              MOVE ER-2789 TO WS-ERROR
  9263              PERFORM 9900-ERROR-FORMAT
  9264                                 THRU 9900-EXIT
  9265           END-IF
  9266           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9267                                    PB-I-CLP-STATE
  9268           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9269           MOVE CO-CARRIER       TO BXRF-CARRIER
  9270           MOVE CO-GROUPING      TO BXRF-GROUPING
  9271           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9272           MOVE BXRF-MAX-REC-LENGTH
  9273                                 TO BXRF-REC-LENGTH
  9274           PERFORM 8584-READ-BANK-CROSS-REF
  9275                                 THRU 8584-EXIT
  9276           IF BXRF-MASTER-FOUND
  9277              MOVE ' '           TO BANK-ACCT-SW
  9278              MOVE BK-BANK-POINTER-CNT
  9279                                 TO BK-BANK-POINTER-CNT
  9280              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9281                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9282                 OR (BANK-ACCT-FOUND)
  9283                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9284                    AND (BK-AM-EXP-DT (WS-SUB1)
  9285                                 > PB-CERT-EFF-DT)
  9286                    AND (BK-AM-EFF-DT (WS-SUB1)
  9287                                 NOT > PB-CERT-EFF-DT)
  9288                    SET BANK-ACCT-FOUND TO TRUE
  9289                 END-IF
  9290              END-PERFORM
  9291              IF NOT BANK-ACCT-FOUND
  9292                 MOVE ZEROS      TO WS-BANK-FEE
  9293                                    WS-BANK-LFEE
  9294                 MOVE ER-2869    TO WS-ERROR
  9295                 PERFORM 9900-ERROR-FORMAT
  9296                                 THRU 9900-EXIT
  9297              ELSE
  9298                 PERFORM 5000-PROCESS-REPS
  9299                                 THRU 5000-EXIT
  9300                 IF AGENT-MASTER-FOUND
  9301                    MOVE +0      TO WS-BANK-FEE
  9302                                    WS-BANK-LFEE
  9303*                   MOVE AG-SPP-FEES (1)
  9304*                                TO PB-I-BANK-FEE
  9305*                                   WS-BANK-FEE
  9306                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9307                       (WS-SUB1 > +10)
  9308                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9309                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9310                       END-IF
  9311                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9312                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9313                       END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 171
* EL050.cbl
  9314                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9315                          AG-SPP-FEES (WS-SUB1)
  9316                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9317                          AG-SPP-LFEES (WS-SUB1)
  9318                    END-PERFORM
  9319                    IF WS-AH-BEN-CATEGORY = 'G'
  9320                       MOVE WS-BANK-FEE
  9321                                 TO PB-I-BANK-FEE
  9322                    ELSE
  9323                       MOVE WS-BANK-LFEE
  9324                                 TO PB-I-BANK-FEE
  9325                    END-IF
  9326                 END-IF
  9327              END-IF
  9328           END-IF
  9329        ELSE
  9330           MOVE ER-2879          TO WS-ERROR
  9331           PERFORM 9900-ERROR-FORMAT
  9332                                 THRU 9900-EXIT
  9333        END-IF
  9334     ELSE
  9335        MOVE ER-2879             TO WS-ERROR
  9336        PERFORM 9900-ERROR-FORMAT
  9337                                 THRU 9900-EXIT
  9338     END-IF
  9339     IF WS-AH-BEN-CATEGORY = 'G'
  9340        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9341        + WS-BANK-FEE
  9342     ELSE
  9343        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9344        + WS-BANK-LFEE
  9345     END-IF
  9346     .
  9347 0400-FIND-STATE-RECORD.
  9348
  9349     IF WK-STATE-ADDR NOT = ZEROS
  9350         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9351         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9352         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9353         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9354         IF PB-SV-STATE = CF-STATE-CODE
  9355             GO TO 0405-CONTINUE-EDIT
  9356         ELSE
  9357             NEXT SENTENCE
  9358     ELSE
  9359         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9360
  9361     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9362     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9363     MOVE '3'                    TO CNTL-REC-TYPE.
  9364     MOVE +0                     TO CNTL-SEQ-NO.
  9365
  9366     MOVE '3'                    TO RC-SW-2.
  9367     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9368
  9369     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9370        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9371        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 172
* EL050.cbl
  9372        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9373                                    WS-TOL-AH-CLAIM
  9374                                    WS-MINIMUM-REFUND
  9375                                    WS-TOL-LF-PREM
  9376                                    WS-TOL-AH-PREM
  9377                                    WS-TOL-LF-REFUND
  9378                                    WS-TOL-AH-REFUND
  9379                                    EC-ST-TOL-PREM-PCT
  9380                                    WS-TOL-LF-PREM-PCT
  9381                                    WS-TOL-AH-PREM-PCT
  9382                                    EC-ST-TOL-REFUND-PCT
  9383                                    WS-TOL-LF-REFUND-PCT
  9384                                    WS-TOL-AH-REFUND-PCT
  9385                                    EC-ST-TOL-PREM
  9386                                    EC-ST-TOL-REFUND
  9387                                    EC-ST-FST-PMT-DAYS-MAX
  9388                                    WS-FREE-LOOK-PERIOD
  9389                                    WS-ST-LF-PREM-TAX
  9390                                    WS-ST-AH-PREM-TAX-I
  9391                                    WS-ST-AH-PREM-TAX-G
  9392                                    WS-BANK-FEE
  9393                                    WS-BANK-LFEE
  9394                                    WS-TOL-CLP-PCT
  9395                                    WS-SPP-LEASE-COMM
  9396        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9397                                    EC-ST-FST-PMT-DAYS-CHG
  9398                                    WS-LF-REM-TERM-CALC
  9399                                    WS-LF-REFUND-CALC
  9400                                    EC-ST-LF-REM-TERM-CALC
  9401                                    EC-ST-LF-REFUND-CALC
  9402                                    WS-AH-REM-TERM-CALC
  9403                                    WS-AH-REFUND-CALC
  9404                                    WS-LF-BEN-CATEGORY
  9405                                    WS-AH-BEN-CATEGORY
  9406                                    WS-CLP-STATE
  9407                                    WS-ST-REFUND-CLAIM-FLAG
  9408                                    EC-ST-AH-REM-TERM-CALC
  9409                                    EC-ST-AH-REFUND-CALC
  9410          GO TO 0499-STATE-NOT-FOUND.
  9411
  9412     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9413
  9414 0405-CONTINUE-EDIT.
  9415
  9416     IF PB-CERT-PRIME NOT NUMERIC
  9417        MOVE ER-2722             TO WS-ERROR
  9418        PERFORM 9900-ERROR-FORMAT
  9419                                 THRU 9900-EXIT
  9420     END-IF
  9421*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9422*       MOVE +0                  TO SUB3
  9423*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9424*       IF SUB3 > +0
  9425*          MOVE ER-2722          TO WS-ERROR
  9426*          PERFORM 9900-ERROR-FORMAT
  9427*                                THRU 9900-EXIT
  9428*       END-IF
  9429*    END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 173
* EL050.cbl
  9430*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9431*       IF PB-CERT-PRIME NOT NUMERIC
  9432*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9433*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9434*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9435*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9436*
  9437*          MOVE ER-2722          TO WS-ERROR
  9438*          PERFORM 9900-ERROR-FORMAT
  9439*                                THRU 9900-EXIT
  9440*       END-IF
  9441*    END-IF
  9442
  9443     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9444
  9445     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9446        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9447                                    WS-TOL-AH-CLAIM.
  9448
  9449     IF CF-ST-REFUND-MIN NOT NUMERIC
  9450        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9451
  9452     IF CF-ST-REFUND-MIN NOT = ZEROS
  9453        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9454
  9455     IF CF-ST-TOL-PREM  NOT = ZEROS
  9456        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9457                                    WS-TOL-AH-PREM
  9458        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9459
  9460     IF CF-ST-TOL-REFUND NOT = ZEROS
  9461        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9462                                    WS-TOL-AH-REFUND
  9463        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9464
  9465     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9466        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9467        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9468                                    WS-AH-REFUND-OVS-AMT
  9469                                    EC-ST-OVR-SHT-AMT.
  9470
  9471     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9472        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9473        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9474                                    WS-TOL-LF-PREM-PCT
  9475                                    WS-TOL-AH-PREM-PCT.
  9476
  9477     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9478        CF-ST-TOL-REF-PCT GREATER THAN +0
  9479        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9480                                    WS-TOL-LF-REFUND-PCT
  9481                                    WS-TOL-AH-REFUND-PCT.
  9482
  9483     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9484        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9485        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9486                                    WS-AH-REFUND-OVS-PCT
  9487                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 174
* EL050.cbl
  9488
  9489     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9490     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9491
  9492     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9493          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9494
  9495     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9496     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9497     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9498
  9499     IF CF-ST-LF-PREM-TAX NUMERIC
  9500        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9501     END-IF
  9502     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9503        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9504     END-IF
  9505     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9506        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9507     END-IF
  9508
  9509     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9510         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9511     END-IF.
  9512
  9513     IF WS-LF-BENEFIT-CD = ZEROS
  9514        GO TO 0410-CHECK-AH.
  9515
  9516     IF CF-ST-RT-CALC NOT = SPACES
  9517        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9518                                    EC-ST-LF-REM-TERM-CALC
  9519     END-IF
  9520
  9521     IF WS-LF-COVERAGE-TYPE = 'R'
  9522        IF WS-LF-EARNINGS-CALC = '5'
  9523           IF CF-ST-RF-LN-CALC > '0'
  9524              MOVE CF-ST-RF-LN-CALC
  9525                                 TO WS-LF-REFUND-CALC
  9526                                    EC-ST-LF-REFUND-CALC
  9527           END-IF
  9528        ELSE
  9529           IF CF-ST-RF-LR-CALC > '0'
  9530              MOVE CF-ST-RF-LR-CALC
  9531                                 TO WS-LF-REFUND-CALC
  9532                                    EC-ST-LF-REFUND-CALC
  9533           END-IF
  9534        END-IF
  9535     ELSE
  9536        IF CF-ST-RF-LL-CALC > '0'
  9537           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9538                                    EC-ST-LF-REFUND-CALC
  9539        END-IF
  9540     END-IF
  9541
  9542     IF CF-ST-RT-CALC NOT = SPACES
  9543        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9544                                    EC-ST-LF-REM-TERM-CALC
  9545     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 175
* EL050.cbl
  9546
  9547     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9548     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9549
  9550     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9551
  9552     IF NO-BENEFIT-FOUND
  9553        GO TO 0410-CHECK-AH.
  9554
  9555     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9556        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9557                                 TO EC-ST-LF-REM-TERM-CALC
  9558                                    WS-LF-REM-TERM-CALC
  9559     END-IF
  9560
  9561     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9562        MOVE CF-ST-REFUND-CALC (SUB3)
  9563                                 TO WS-LF-REFUND-CALC
  9564                                    EC-ST-LF-REFUND-CALC
  9565     END-IF
  9566*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9567
  9568     .
  9569 0410-CHECK-AH.
  9570
  9571     IF WS-AH-BENEFIT-CD = ZEROS
  9572        GO TO 0500-SET-ACCOUNT.
  9573
  9574     IF CF-ST-RT-CALC NOT = SPACES
  9575        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9576                                    EC-ST-AH-REM-TERM-CALC
  9577     END-IF
  9578
  9579     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9580        IF CF-ST-RF-CP-CALC > '0'
  9581           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9582                                    EC-ST-AH-REFUND-CALC
  9583        END-IF
  9584     ELSE
  9585        IF CF-ST-RF-AH-CALC > '0'
  9586           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9587                                    EC-ST-AH-REFUND-CALC
  9588        END-IF
  9589     END-IF
  9590     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9591     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9592
  9593     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9594
  9595     IF NO-BENEFIT-FOUND
  9596        GO TO 0500-SET-ACCOUNT.
  9597
  9598     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9599        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9600                                 TO WS-AH-REM-TERM-CALC
  9601                                    EC-ST-AH-REM-TERM-CALC
  9602     END-IF
  9603
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 176
* EL050.cbl
  9604     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9605        MOVE CF-ST-REFUND-CALC (SUB3)
  9606                                 TO WS-AH-REFUND-CALC
  9607                                    EC-ST-AH-REFUND-CALC
  9608     END-IF
  9609
  9610*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9611
  9612     GO TO 0500-SET-ACCOUNT.
  9613
  9614 0499-STATE-NOT-FOUND.
  9615
  9616     MOVE ER-2603                TO WS-ERROR.
  9617     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9618
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 177
* EL050.cbl
  9620
  9621 0500-SET-ACCOUNT.
  9622*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9623     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9624        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9625        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9626        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9627        MOVE '3'                 TO CNTL-REC-TYPE
  9628        MOVE +0                  TO CNTL-SEQ-NO
  9629
  9630        MOVE '3'                 TO RC-SW-2
  9631        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9632
  9633        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9634           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9635           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9636           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9637                                    WS-ST-AH-PREM-TAX-I
  9638                                    WS-ST-AH-PREM-TAX-G
  9639        ELSE
  9640           IF CF-ST-LF-PREM-TAX NUMERIC
  9641              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9642           END-IF
  9643           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9644              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9645           END-IF
  9646           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9647              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9648           END-IF
  9649        END-IF
  9650        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9651     END-IF
  9652*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9653*  FOR DCC ONLY
  9654     IF PB-COMPANY-ID = 'DCC'
  9655
  9656     MOVE ' '                    TO STAT-MASTER-SW
  9657     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9658     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9659     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9660     MOVE PB-STATE               TO ELSTAT-STATE
  9661     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9662        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9663     END-IF
  9664
  9665     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9666     SET BIN-TO-GREG             TO TRUE
  9667     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9668     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9669     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9670
  9671     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9672     IF STAT-MASTER-FOUND
  9673        MOVE 'N'                 TO STAT-MASTER-SW
  9674        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9675        IF STAT-MASTER-FOUND
  9676           IF (ELSTAT-KEY-SAVE (1:12) =
  9677                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 178
* EL050.cbl
  9678              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9679                 MOVE 'F'        TO STAT-MASTER-SW
  9680              ELSE
  9681                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9682                 IF (STAT-MASTER-FOUND)
  9683                    AND (ELSTAT-KEY-SAVE (1:12) =
  9684                        SF-CONTROL-PRIMARY (1:12))
  9685                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9686                    MOVE 'F'     TO STAT-MASTER-SW
  9687                 END-IF
  9688              END-IF
  9689           END-IF
  9690        END-IF
  9691     END-IF
  9692
  9693     IF STAT-MASTER-SW = 'F'
  9694        IF SF-ST-LF-PREM-TAX NUMERIC
  9695           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9696        END-IF
  9697        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9698           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9699        END-IF
  9700        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9701           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9702        END-IF
  9703     END-IF
  9704
  9705     END-IF
  9706     IF (PB-COMPANY-ID = 'DCC')
  9707        AND (PB-ISSUE)
  9708        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9709        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9710        AND (AM-GPCD = 06)
  9711        MOVE 'Y'                 TO WS-GOOD-HIN
  9712        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9713           MOVE PB-I-VIN         TO WS-WORK-VIN
  9714           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9715              (V1 > 16)
  9716              IF WS-WORK-VIN (V1:1) NUMERIC
  9717                 MOVE WS-WORK-VIN-N (V1)
  9718                                 TO WS-ROW-B-VAL (V1)
  9719              ELSE
  9720                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9721                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9722                    OR (V2 > 26)
  9723                 END-PERFORM
  9724                 IF V2 < 27
  9725                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9726                 ELSE
  9727                    MOVE 'N'     TO WS-GOOD-HIN
  9728                 END-IF
  9729              END-IF
  9730              COMPUTE WS-ROW-D-VAL (V1) =
  9731                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9732              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9733                 WS-ROW-D-VAL (V1)
  9734           END-PERFORM
  9735           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 179
* EL050.cbl
  9736           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9737             REMAINDER WS-VIN-REMAINDER
  9738           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9739              CONTINUE
  9740           ELSE
  9741              MOVE 'N'           TO WS-GOOD-HIN
  9742           END-IF
  9743        ELSE
  9744           MOVE 'N'              TO WS-GOOD-HIN
  9745        END-IF
  9746        IF WS-GOOD-HIN NOT = 'Y'
  9747           MOVE ER-3826           TO WS-ERROR
  9748           PERFORM 9900-ERROR-FORMAT
  9749                                 THRU 9900-EXIT
  9750        END-IF
  9751     END-IF
  9752     IF (PB-COMPANY-ID = 'DCC')
  9753        AND (PB-ISSUE)
  9754        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9755        AND (AM-GPCD NOT = 06)
  9756        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9757          MOVE PB-I-VIN          TO WS-WORK-VIN
  9758          MOVE +8                TO V2
  9759          MOVE ZEROS             TO WS-VIN-TOTAL
  9760          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9761           (V1 > 17)
  9762             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9763                MOVE ER-3825     TO WS-ERROR
  9764                PERFORM 9900-ERROR-FORMAT
  9765                                 THRU 9900-EXIT
  9766             ELSE
  9767                IF V1 = 8
  9768                   MOVE 10       TO V2
  9769                END-IF
  9770                IF V1 = 9
  9771                   MOVE 0        TO V2
  9772                END-IF
  9773                IF V1 = 10
  9774                   MOVE 9        TO V2
  9775                END-IF
  9776                IF WS-WORK-VIN (V1:1) NUMERIC
  9777                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9778                    + (WS-WORK-VIN-N (V1) * V2)
  9779                ELSE
  9780                   MOVE WS-WORK-VIN (V1:1)
  9781                                 TO WS-HEX-BYTE
  9782                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9783                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9784                    + (WS-NUM (V3) * V2)
  9785                END-IF
  9786                COMPUTE V2 = V2 - 1
  9787             END-IF
  9788          END-PERFORM
  9789          MOVE ZEROS TO WS-VIN-REMAINDER
  9790          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9791             REMAINDER WS-VIN-REMAINDER
  9792          IF ((WS-WORK-VIN (9:1) = 'X')
  9793             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 180
* EL050.cbl
  9794                     OR
  9795             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9796             CONTINUE
  9797          ELSE
  9798             MOVE ER-3826        TO WS-ERROR
  9799             PERFORM 9900-ERROR-FORMAT
  9800                                 THRU 9900-EXIT
  9801          END-IF
  9802        ELSE
  9803          MOVE ER-3826           TO WS-ERROR
  9804          PERFORM 9900-ERROR-FORMAT
  9805                                 THRU 9900-EXIT
  9806        END-IF
  9807     END-IF
  9808******************************************************************
  9809******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9810******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9811******* METHODS.
  9812******************************************************************
  9813     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9814        IF PB-CANCELLATION
  9815           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9816              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9817                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9818                IF FORM-MASTER-FOUND
  9819                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9820******************************************************************
  9821
  9822     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9823     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9824
  9825     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9826     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9827     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9828     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9829
  9830
  9831     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9832     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9833     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9834
  9835     IF AM-LF-OB-RATE NOT NUMERIC
  9836         MOVE ZERO               TO AM-LF-OB-RATE.
  9837
  9838     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9839         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9840
  9841     IF AM-AH-OB-RATE NOT NUMERIC
  9842         MOVE ZERO               TO AM-AH-OB-RATE.
  9843
  9844     IF WS-LF-JOINT-INDICATOR = 'J'
  9845         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9846     ELSE
  9847         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9848
  9849     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
  9850
  9851     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 181
* EL050.cbl
  9852         MOVE AM-IG              TO WS-IG-OVRD-AM.
  9853
  9854     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
  9855         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
  9856                                       WS-IG-OVRD
  9857     ELSE
  9858         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
  9859             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
  9860                                       WS-IG-OVRD
  9861         ELSE
  9862             MOVE AM-IG             TO WS-IG-OVRD-AH
  9863                                       WS-IG-OVRD.
  9864
  9865     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
  9866         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
  9867                                       WS-IG-OVRD
  9868     ELSE
  9869         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
  9870             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
  9871                                       WS-IG-OVRD
  9872         ELSE
  9873             MOVE AM-IG             TO WS-IG-OVRD-LF
  9874                                       WS-IG-OVRD.
  9875
  9876     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
  9877     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
  9878     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
  9879     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
  9880     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
  9881
  9882     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
  9883     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
  9884     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
  9885     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
  9886
  9887     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
  9888     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
  9889     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
  9890     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
  9891     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
  9892     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
  9893     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
  9894
  9895     IF WS-ACCT-AH-DEV-PCT > +0
  9896        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
  9897     ELSE
  9898        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
  9899
  9900     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
  9901        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
  9902     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
  9903        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
  9904
  9905        IF AM-EARN-METHOD-L = 'S'
  9906            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9907                                        WS-LF-REFUND-CALC.
  9908
  9909        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 182
* EL050.cbl
  9910            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9911                                        WS-LF-REFUND-CALC.
  9912
  9913     IF WS-LF-COVERAGE-TYPE = 'R'
  9914         IF AM-EARN-METHOD-R = 'R'
  9915            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9916                                    WS-LF-REFUND-CALC.
  9917     IF WS-LF-COVERAGE-TYPE = 'R'
  9918         IF AM-EARN-METHOD-R = 'P'
  9919            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9920                                    WS-LF-REFUND-CALC.
  9921     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9922         IF AM-EARN-METHOD-L = 'R'
  9923            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9924                                    WS-LF-REFUND-CALC.
  9925     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9926         IF AM-EARN-METHOD-L = 'P'
  9927            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9928                                    WS-LF-REFUND-CALC.
  9929     IF WS-LF-COVERAGE-TYPE = 'R'
  9930         IF AM-EARN-METHOD-R = 'A'
  9931            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9932                                    WS-LF-REFUND-CALC.
  9933     IF WS-LF-COVERAGE-TYPE = 'R'
  9934         IF AM-EARN-METHOD-R = 'M'
  9935            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9936                                    WS-LF-REFUND-CALC.
  9937     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9938         IF AM-EARN-METHOD-L = 'A'
  9939            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9940                                    WS-LF-REFUND-CALC.
  9941     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9942         IF AM-EARN-METHOD-L = 'M'
  9943            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9944                                    WS-LF-REFUND-CALC.
  9945
  9946     IF AM-EARN-METHOD-A = 'R'
  9947        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
  9948                                    WS-AH-REFUND-CALC.
  9949     IF AM-EARN-METHOD-A = 'P'
  9950        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
  9951                                    WS-AH-REFUND-CALC.
  9952     IF AM-EARN-METHOD-A = 'C'
  9953        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
  9954                                    WS-AH-REFUND-CALC.
  9955     IF AM-EARN-METHOD-A = 'A'
  9956        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
  9957                                    WS-AH-REFUND-CALC.
  9958     IF AM-EARN-METHOD-A = 'M'
  9959        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
  9960                                    WS-AH-REFUND-CALC.
  9961     IF AM-EARN-METHOD-A = 'N'
  9962        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
  9963                                    WS-AH-REFUND-CALC.
  9964     IF AM-EARN-METHOD-A = 'S'
  9965        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
  9966                                    WS-AH-REFUND-CALC.
  9967
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 183
* EL050.cbl
  9968     IF AM-TOL-PREM NOT = ZEROS
  9969        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
  9970                                    WS-TOL-AH-PREM.
  9971
  9972     IF AM-OVR-SHT-AMT NUMERIC AND
  9973                  AM-OVR-SHT-AMT > 0
  9974        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
  9975                                    EC-AM-LF-OVR-SHT-AMT
  9976                                    WS-AH-REFUND-OVS-AMT
  9977                                    EC-AM-AH-OVR-SHT-AMT.
  9978
  9979     IF AM-OVR-SHT-PCT NUMERIC AND
  9980                    AM-OVR-SHT-PCT > 0
  9981        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
  9982                                    EC-AM-LF-OVR-SHT-PCT
  9983                                    WS-AH-REFUND-OVS-PCT
  9984                                    EC-AM-AH-OVR-SHT-PCT.
  9985
  9986     IF AM-TOL-REF-PCT NUMERIC AND
  9987                  AM-TOL-REF-PCT > 0
  9988        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
  9989                                    WS-TOL-AH-REFUND-PCT.
  9990
  9991     IF AM-TOL-REF  NOT = ZEROS  AND
  9992                  AM-TOL-REF NUMERIC
  9993        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
  9994                                    EC-AM-LF-TOL-REFUND
  9995                                    WS-TOL-AH-REFUND
  9996                                    EC-AM-AH-TOL-REFUND.
  9997
  9998     IF AM-TOL-CLM  NOT = ZEROS
  9999        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10000                                    WS-TOL-AH-CLAIM.
 10001
 10002     IF AM-CLP-TOL-PCT NOT NUMERIC
 10003        MOVE +0                  TO AM-CLP-TOL-PCT
 10004     END-IF
 10005
 10006     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10007        MOVE +0                  TO AM-SPP-LEASE-COMM
 10008     END-IF
 10009     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10010        MOVE WS-PL-TOL-LF-PREM-PCT
 10011                                 TO WS-TOL-LF-PREM-PCT.
 10012
 10013     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10014        MOVE WS-PL-TOL-AH-PREM-PCT
 10015                                 TO WS-TOL-AH-PREM-PCT.
 10016
 10017     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10018        MOVE WS-PL-TOL-LF-REFUND-PCT
 10019                                 TO WS-TOL-LF-REFUND-PCT.
 10020
 10021     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10022        MOVE WS-PL-TOL-AH-REFUND-PCT
 10023                                 TO WS-TOL-AH-REFUND-PCT.
 10024
 10025     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 184
* EL050.cbl
 10026        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10027
 10028     IF WS-PL-REF-OVS-PCT > +0
 10029        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10030
 10031     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10032        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10033     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10034        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10035     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10036        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10037     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10038        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10039     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10040        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10041     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10042        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10043
 10044     IF WS-AH-PL-REF-OVS-AMT > +0
 10045        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10046
 10047     IF WS-AH-PL-REF-OVS-PCT > +0
 10048        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10049
 10050     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10051     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10052
 10053     IF PB-CANCELLATION
 10054        GO TO 3000-CONTINUE-EDIT.
 10055
 10056     MOVE +1 TO SUB1.
 10057     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10058     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10059
 10060     IF CF-COMPANY-ID = 'DMD'
 10061       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10062         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10063        ELSE
 10064         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10065
 10066  0525-FIND-ACCT-COMM.
 10067     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10068        NEXT SENTENCE
 10069      ELSE
 10070         ADD +1 TO SUB1
 10071         IF SUB1 LESS +11
 10072            GO TO 0525-FIND-ACCT-COMM
 10073          ELSE
 10074             GO TO 0560-EDIT-CONTINUE.
 10075
 10076     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10077     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10078                                    PB-I-LIFE-COMMISSION.
 10079***  IF PB-COMPANY-ID = 'CRI'
 10080     IF PB-PREM-ACCTNG-ONLY
 10081         GO TO 0560-EDIT-CONTINUE.
 10082
 10083     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 185
* EL050.cbl
 10084     MOVE ' '    TO WS-CTBL-READ-SW.
 10085
 10086
 10087 0530-GET-AH-COMP.
 10088     IF NO-AH-COVERAGE  OR
 10089        NO-AH-BENEFIT-MATCH
 10090           GO TO 0540-NEXT-READ-STEP.
 10091
 10092     IF AM-A-COM (SUB1) NUMERIC
 10093        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10094         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10095         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10096         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10097         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10098     ELSE
 10099          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10100          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10101          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10102          MOVE ZEROS             TO WS-SUB1
 10103                                    WS-COMMISSION
 10104          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10105          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10106          IF WS-COMMISSION > ZEROS
 10107             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10108             GO TO 0540-NEXT-READ-STEP
 10109          END-IF
 10110          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10111          IF CTBL-TABLE-FOUND
 10112             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10113                                        PB-I-AH-TERM
 10114             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10115             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10116             GO TO 0540-NEXT-READ-STEP
 10117          ELSE
 10118             IF FIRST-TIME-THROUGH
 10119                 GO TO 0530-GET-AH-COMP
 10120             ELSE
 10121                 MOVE ER-2609                TO WS-ERROR
 10122                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10123
 10124 0540-NEXT-READ-STEP.
 10125     MOVE '0540' TO CTBL-SW.
 10126     MOVE ' '    TO WS-CTBL-READ-SW.
 10127
 10128 0540-GET-LF-COMP.
 10129     IF NO-LIFE-COVERAGE  OR
 10130        NO-LF-BENEFIT-MATCH
 10131           GO TO 0560-EDIT-CONTINUE.
 10132
 10133     IF WS-LF-JOINT-INDICATOR = 'J'
 10134        IF AM-J-COM (SUB1) NUMERIC
 10135           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10136           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10137           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10138           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10139           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10140        ELSE
 10141           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 186
* EL050.cbl
 10142           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10143           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10144           MOVE ZEROS                TO WS-SUB1
 10145                                        WS-COMMISSION
 10146           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10147           IF WS-COMMISSION > ZEROS
 10148              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10149              GO TO 0560-EDIT-CONTINUE
 10150           END-IF
 10151           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10152           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10153           IF CTBL-TABLE-FOUND
 10154              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10155              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10156              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10157              GO TO 0560-EDIT-CONTINUE
 10158           ELSE
 10159              IF FIRST-TIME-THROUGH
 10160                  GO TO 0540-GET-LF-COMP
 10161              ELSE
 10162                  MOVE ER-2609                TO WS-ERROR
 10163                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10164                  GO TO 0560-EDIT-CONTINUE.
 10165
 10166     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10167        IF AM-L-COM (SUB1) NUMERIC
 10168           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10169           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10170           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10171           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10172           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10173        ELSE
 10174           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10175           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10176           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10177           MOVE ZEROS                TO WS-SUB1
 10178                                        WS-COMMISSION
 10179           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10180           IF WS-COMMISSION IS GREATER THAN ZEROS
 10181              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10182              GO TO 0560-EDIT-CONTINUE
 10183           END-IF
 10184           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10185           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10186           IF CTBL-TABLE-FOUND
 10187              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10188              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10189              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10190              GO TO 0560-EDIT-CONTINUE
 10191           ELSE
 10192              IF FIRST-TIME-THROUGH
 10193                  GO TO 0540-GET-LF-COMP
 10194              ELSE
 10195                  MOVE ER-2609                TO WS-ERROR
 10196                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10197
 10198*    GO TO 0560-EDIT-CONTINUE.
 10199
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 187
* EL050.cbl
 10200 0560-EDIT-CONTINUE.
 10201     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10202                                    WS-AH-PMF-COMM
 10203*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10204*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10205     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10206        (SUB1 > +10)
 10207        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10208           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10209           MOVE '0530'           TO CTBL-SW
 10210           MOVE ' '              TO WS-CTBL-READ-SW
 10211           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10212           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10213           MOVE '0540'           TO CTBL-SW
 10214           MOVE ' '              TO WS-CTBL-READ-SW
 10215           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10216        END-IF
 10217     END-PERFORM
 10218     GO TO 0564-EDIT-CONTINUE
 10219     .
 10220 0561-CHECK-AH.
 10221     IF (NO-AH-COVERAGE)
 10222        OR (NO-AH-BENEFIT-MATCH)
 10223        CONTINUE
 10224     ELSE
 10225        IF (AM-A-COM (SUB1) NUMERIC)
 10226           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10227           IF (AM-COM-TYP (SUB1) = 'A')
 10228              AND (WS-AH-PMF-COMM = ZEROS)
 10229              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10230           END-IF
 10231           CONTINUE
 10232        ELSE
 10233           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10234           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10235           MOVE PB-AH-OVERRIDE-L1
 10236                                 TO CTBL-BEN-TYPE
 10237           MOVE ZEROS            TO WS-SUB1
 10238                                    WS-COMMISSION
 10239           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10240           PERFORM 8300-READ-CTBL-TABLE
 10241                                 THRU 8300-EXIT
 10242           IF CTBL-TABLE-FOUND
 10243              IF (AM-COM-TYP (SUB1) = 'A')
 10244                 AND (WS-AH-PMF-COMM = ZEROS)
 10245                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10246                                        PB-I-AH-TERM
 10247                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10248                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10249              END-IF
 10250              CONTINUE
 10251           ELSE
 10252              IF FIRST-TIME-THROUGH
 10253                 GO TO 0561-CHECK-AH
 10254              ELSE
 10255                 MOVE ER-2609    TO WS-ERROR
 10256                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10257              END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 188
* EL050.cbl
 10258           END-IF
 10259        END-IF
 10260     END-IF
 10261     .
 10262 0561-EXIT.
 10263     EXIT.
 10264 0563-CHECK-LF.
 10265     IF (NO-LIFE-COVERAGE)
 10266        OR (NO-LF-BENEFIT-MATCH)
 10267        CONTINUE
 10268     ELSE
 10269        IF WS-LF-JOINT-INDICATOR = 'J'
 10270           IF AM-J-COM (SUB1) NUMERIC
 10271              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10272              IF (AM-COM-TYP (SUB1) = 'A')
 10273                 AND (WS-LF-PMF-COMM = ZEROS)
 10274                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10275              END-IF
 10276              CONTINUE
 10277           ELSE
 10278              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10279              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10280              MOVE PB-LIFE-OVERRIDE-L1
 10281                                 TO CTBL-BEN-TYPE
 10282              MOVE ZEROS         TO WS-SUB1
 10283                                    WS-COMMISSION
 10284              MOVE AM-J-COMA (SUB1)
 10285                                 TO CTBL-TABLE
 10286              PERFORM 8300-READ-CTBL-TABLE
 10287                                 THRU 8300-EXIT
 10288              IF CTBL-TABLE-FOUND
 10289                 IF (AM-COM-TYP (SUB1) = 'A')
 10290                    AND (WS-LF-PMF-COMM = ZEROS)
 10291                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10292                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10293                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10294                 END-IF
 10295                 CONTINUE
 10296              ELSE
 10297                 IF FIRST-TIME-THROUGH
 10298                    GO TO 0563-CHECK-LF
 10299                 ELSE
 10300                    MOVE ER-2609 TO WS-ERROR
 10301                    PERFORM 9900-ERROR-FORMAT
 10302                                 THRU 9900-EXIT
 10303*                   GO TO 0560-EDIT-CONTINUE
 10304                 END-IF
 10305              END-IF
 10306           END-IF
 10307        ELSE
 10308           IF AM-L-COM (SUB1) NUMERIC
 10309              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10310              IF (AM-COM-TYP (SUB1) = 'A')
 10311                 AND (WS-LF-PMF-COMM = ZEROS)
 10312                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10313              END-IF
 10314              CONTINUE
 10315           ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 189
* EL050.cbl
 10316              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10317              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10318              MOVE PB-LIFE-OVERRIDE-L1
 10319                                 TO CTBL-BEN-TYPE
 10320              MOVE ZEROS         TO WS-SUB1
 10321                                    WS-COMMISSION
 10322              MOVE AM-L-COMA (SUB1)
 10323                                 TO CTBL-TABLE
 10324              PERFORM 8300-READ-CTBL-TABLE
 10325                                 THRU 8300-EXIT
 10326              IF CTBL-TABLE-FOUND
 10327                 CONTINUE
 10328              ELSE
 10329                 IF FIRST-TIME-THROUGH
 10330                    GO TO 0563-CHECK-LF
 10331                 ELSE
 10332                    MOVE ER-2609 TO WS-ERROR
 10333                    PERFORM 9900-ERROR-FORMAT
 10334                                 THRU 9900-EXIT
 10335                 END-IF
 10336              END-IF
 10337           END-IF
 10338        END-IF
 10339     END-IF
 10340     .
 10341 0563-EXIT.
 10342     EXIT.
 10343 0564-EDIT-CONTINUE.
 10344
 10345     IF  PB-COMPANY-ID EQUAL 'DMD'
 10346         IF PB-I-NUM-BILLED EQUAL ZEROS
 10347            MOVE ER-8148       TO WS-ERROR
 10348            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10349
 10350*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10351*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10352*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10353*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10354*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10355*         IF NO-CONVERSION-ERROR
 10356*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10357*         ELSE
 10358*             IF PB-COMPANY-ID EQUAL 'HAN'
 10359*                 MOVE ZEROS     TO PB-I-AGE.
 10360     IF PB-I-BIRTHDAY > LOW-VALUES
 10361        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10362        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10363        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10364        PERFORM 8500-DATE-CONVERT
 10365                                 THRU 8500-EXIT
 10366        IF NO-CONVERSION-ERROR
 10367           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10368           IF PB-I-AGE > ZEROS
 10369              IF WS-WORK-AGE NOT = PB-I-AGE
 10370                 MOVE ER-9501    TO WS-ERROR
 10371                 PERFORM 9900-ERROR-FORMAT
 10372                                 THRU 9900-EXIT
 10373              END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 190
* EL050.cbl
 10374           ELSE
 10375              MOVE WS-WORK-AGE   TO PB-I-AGE
 10376           END-IF
 10377        END-IF
 10378     END-IF
 10379     IF PB-I-AGE = ZEROS
 10380        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10381           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10382
 10383     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10384                                   WS-AH-EDIT-AGE.
 10385
 10386     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10387        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10388        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10389        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10390        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10391        IF NO-CONVERSION-ERROR
 10392           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10393           IF PB-I-JOINT-AGE > 0
 10394              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10395                 MOVE ER-9503    TO WS-ERROR
 10396                 PERFORM 9900-ERROR-FORMAT
 10397                                 THRU 9900-EXIT
 10398              END-IF
 10399           ELSE
 10400              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10401           END-IF
 10402        ELSE
 10403           MOVE ZEROS            TO PB-I-JOINT-AGE
 10404        END-IF
 10405     END-IF
 10406     IF PB-I-JOINT-AGE NOT NUMERIC
 10407        MOVE ZERO               TO PB-I-JOINT-AGE.
 10408
 10409     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC'
 10410        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10411           (WS-AH-JOINT-INDICATOR = 'J')
 10412           IF PB-I-JOINT-AGE = ZEROS
 10413               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10414           END-IF
 10415        END-IF
 10416     END-IF
 10417
 10418     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10419     IF WS-LF-JOINT-INDICATOR = 'J'
 10420        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10421        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10422            IF  PB-I-JOINT-AGE = ZERO
 10423                MOVE ER-2686       TO WS-ERROR
 10424                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10425            ELSE
 10426                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10427                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10428                    IF PB-COMPANY-ID NOT = 'LBL'
 10429                        MOVE ER-2685    TO WS-ERROR
 10430                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10431
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 191
* EL050.cbl
 10432     IF WS-AH-JOINT-INDICATOR = 'J'
 10433        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10434            IF  PB-I-JOINT-AGE = ZERO
 10435                MOVE ER-2686       TO WS-ERROR
 10436                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10437            ELSE
 10438                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10439                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10440                                           WS-EDIT-AGE
 10441                    IF PB-COMPANY-ID NOT = 'LBL'
 10442                        MOVE ER-2685    TO WS-ERROR
 10443                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10444
 10445******************************************************************
 10446*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10447******************************************************************
 10448
 10449     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10450        (WS-AH-SPECIAL-CALC-CD = 'O')
 10451        NEXT SENTENCE
 10452     ELSE
 10453        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10454          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10455           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10456            WS-AH-JOINT-INDICATOR = 'J')  AND
 10457           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10458            MOVE ER-2627             TO WS-ERROR
 10459            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10460
 10461     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10462        (WS-AH-SPECIAL-CALC-CD = 'O')
 10463         NEXT SENTENCE
 10464     ELSE
 10465         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10466            WS-AH-JOINT-INDICATOR = 'J'
 10467             IF PB-I-JOINT-INSURED = SPACES
 10468                 IF PB-COMPANY-ID NOT = 'JAL'
 10469                     MOVE ER-2696    TO WS-ERROR
 10470                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10471
 10472     IF PB-COMPANY-ID NOT = 'BOA'
 10473        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10474           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10475           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10476               PB-I-JOINT-INSURED NOT = SPACES)
 10477                MOVE ER-2691         TO WS-ERROR
 10478                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10479
 10480     IF PB-COMPANY-ID = 'BOA'
 10481        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10482           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10483            IF PB-I-JOINT-AGE NOT = ZEROS
 10484                MOVE ER-2691         TO WS-ERROR
 10485                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10486
 10487     IF PB-COMPANY-ID = 'CRI'
 10488        IF PB-I-SIG-SW = 'J'
 10489           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 192
* EL050.cbl
 10490              WS-AH-JOINT-INDICATOR NOT = 'J'
 10491              MOVE ER-2675       TO WS-ERROR
 10492              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10493
 10494     IF PB-COMPANY-ID = 'CRI'
 10495        IF PB-I-SIG-SW = 'S'
 10496           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10497              WS-AH-JOINT-INDICATOR = 'J'
 10498              MOVE ER-2676       TO WS-ERROR
 10499              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10500
 10501     IF PB-COMPANY-ID = 'CVL'
 10502         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10503            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10504              MOVE ER-2783           TO WS-ERROR
 10505              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10506     IF (WS-LF-JOINT-INDICATOR = 'J')
 10507        AND (WS-AH-JOINT-INDICATOR = 'J')
 10508        AND (PB-I-LF-TERM > 120)
 10509        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10510        MOVE ER-2783             TO WS-ERROR
 10511        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10512     END-IF
 10513     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10514
 10515     IF PB-I-INDV-GRP-OVRD = 'I'
 10516        MOVE ER-2666             TO WS-ERROR
 10517        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10518        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10519
 10520     IF PB-I-INDV-GRP-OVRD = 'G'
 10521        MOVE ER-2666             TO WS-ERROR
 10522        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10523        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10524
 10525     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10526        NEXT SENTENCE
 10527     ELSE
 10528        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10529
 10530     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10531        IF WS-ERROR = ER-2666
 10532           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10533           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10534
 10535     IF PB-COMPANY-ID = 'CID'
 10536        IF PB-STATE = 'UT' OR 'MO'
 10537           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10538                 OR '76' OR '77')
 10539                      OR
 10540               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10541                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10542                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10543                   OR '2K' OR '2L'))
 10544              AND PB-I-INDV-GRP-CD = 'I'
 10545              MOVE ER-2721             TO WS-ERROR
 10546              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10547           END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 193
* EL050.cbl
 10548        END-IF
 10549     END-IF
 10550
 10551     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10552     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10553        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10554     ELSE
 10555        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10556     END-IF
 10557
 10558*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10559*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10560     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10561                                    ACCOUNT-AH-CK-SW.
 10562
 10563     IF PB-REISSUED-CERT       OR
 10564        PB-REIN-ONLY-CERT      OR
 10565        PB-POLICY-IS-DECLINED  OR
 10566        PB-POLICY-IS-VOIDED
 10567*       OR PB-MONTHLY-CERT
 10568         GO TO 3000-CONTINUE-EDIT.
 10569
 10570     IF PB-COMPANY-ID = 'CID'
 10571        IF WS-EDIT-AGE           > +65
 10572           MOVE ER-2709          TO WS-ERROR
 10573           PERFORM 9900-ERROR-FORMAT
 10574                                 THRU 9900-EXIT
 10575        ELSE
 10576           IF WS-EDIT-AGE        > +55
 10577              MOVE ER-2718       TO WS-ERROR
 10578              PERFORM 9900-ERROR-FORMAT
 10579                                 THRU 9900-EXIT
 10580           END-IF
 10581        END-IF
 10582     IF PB-COMPANY-ID = 'DCC'
 10583        IF WS-EDIT-AGE           > +65
 10584           MOVE ER-2709          TO WS-ERROR
 10585           PERFORM 9900-ERROR-FORMAT
 10586                                 THRU 9900-EXIT
 10587        END-IF
 10588     END-IF
 10589     .
 10590
 10591 0565-LIFE-PLAN-LIMIT-EDITS.
 10592
 10593     IF NOT LF-PLAN-MASTER-FOUND
 10594        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10595                                    EC-AM-LF-MAX-TOT-BEN
 10596        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10597
 10598     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10599
 10600     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10601         IF PL-LM-AGE (1) = ZEROS
 10602             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10603
 10604     IF NO-LF-BENEFIT-MATCH          OR
 10605        WS-LF-BENEFIT-CD = ZEROS     OR
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 194
* EL050.cbl
 10606        WS-LF-SPECIAL-CALC-CD = 'M'
 10607        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10608
 10609     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10610     MOVE +1                     TO SUB2.
 10611
 10612     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10613        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10614           MOVE +5   TO SUB2
 10615           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10616              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10617              (PL-LM-AGE (SUB2) EQUAL +0)
 10618              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10619              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10620
 10621     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10622
 10623     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10624                               + PB-I-LF-ALT-BENEFIT-AMT.
 10625
 10626 0568-CHECK-LIFE-ATT-AGE.
 10627
 10628     IF PL-ATT-AGE NUMERIC AND
 10629        PL-ATT-AGE > +0
 10630        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10631     END-IF
 10632*    IF PL-ATT-AGE NUMERIC AND
 10633*       PL-ATT-AGE > +0
 10634*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10635*       IF PB-I-BIRTHDAY > LOW-VALUES
 10636*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10637*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10638*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10639*          SET BIN-PLUS-ELAPSED  TO TRUE
 10640*          PERFORM 8500-DATE-CONVERT
 10641*                                THRU 8500-EXIT
 10642*          IF NO-CONVERSION-ERROR
 10643*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10644*             MOVE ER-2669       TO WS-ERROR
 10645*             PERFORM 9900-ERROR-FORMAT
 10646*                                THRU 9900-EXIT
 10647*          END-IF
 10648*       ELSE
 10649*          IF WS-ATT-AGE >= PL-ATT-AGE
 10650*             MOVE ER-2669       TO WS-ERROR
 10651*             PERFORM 9900-ERROR-FORMAT
 10652*                                THRU 9900-EXIT
 10653*          END-IF
 10654*       END-IF
 10655*    END-IF
 10656     .
 10657 0570-CHECK-LIFE-LIMITS.
 10658
 10659     IF PB-COMPANY-ID EQUAL 'CRI'
 10660        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10661           IF SUB2 GREATER THAN +4
 10662              MOVE ER-2637 TO WS-ERROR
 10663              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 195
* EL050.cbl
 10664              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10665
 10666     IF PB-COMPANY-ID  =  'NCL'
 10667        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10668            SUB2 GREATER THAN +8
 10669             MOVE 'U'         TO PB-BATCH-ENTRY
 10670             MOVE ER-2637     TO WS-ERROR
 10671             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10672             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10673
 10674     IF SUB2 > +8
 10675        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10676           AND (PB-I-SIG-SW = 'Y')
 10677           CONTINUE
 10678        ELSE
 10679           MOVE ER-2637          TO WS-ERROR
 10680           PERFORM 9900-ERROR-FORMAT
 10681                                 THRU 9900-EXIT
 10682        END-IF
 10683        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10684     END-IF
 10685     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10686     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10687     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10688
 10689     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10690        ADD +1  TO SUB2
 10691        GO TO 0570-CHECK-LIFE-LIMITS.
 10692
 10693     IF PB-COMPANY-ID = 'NCL'
 10694         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10695
 10696     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10697        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10698        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10699           AND (PB-I-SIG-SW = 'Y')
 10700           CONTINUE
 10701        ELSE
 10702           MOVE ER-2637          TO WS-ERROR
 10703           PERFORM 9900-ERROR-FORMAT
 10704                                 THRU 9900-EXIT
 10705        END-IF
 10706     END-IF
 10707     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10708
 10709
 10710 0570-CHECK-NCL-LIFE-LIMITS.
 10711
 10712     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10713        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 10714         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10715
 10716     IF APP-CERT-USED
 10717         IF SUB2  LESS THAN  +5
 10718             MOVE +5          TO SUB2
 10719             GO TO 0570-CHECK-LIFE-LIMITS.
 10720
 10721     MOVE ER-2637             TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 196
* EL050.cbl
 10722     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10723
 10724     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10725
 10726 0575-CHECK-NCL-SIG-SWITCH.
 10727
 10728     IF NOT APP-CERT-USED
 10729         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10730
 10731     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10732        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10733        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10734        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10735         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10736
 10737     IF SUB2 GREATER THAN +4
 10738         IF PL-LM-AGE (5) = ZEROS  AND
 10739            PL-LM-AGE (6) = ZEROS  AND
 10740            PL-LM-AGE (7) = ZEROS  AND
 10741            PL-LM-AGE (8) = ZEROS
 10742             MOVE  ER-1927        TO WS-ERROR
 10743             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10744             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10745         ELSE
 10746             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10747                 MOVE  ER-1920    TO WS-ERROR
 10748                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10749
 10750     IF PB-I-SIG-SW  = 'Y'
 10751       IF NOT PB-I-POLICY-ACCEPTED  AND
 10752          NOT PB-I-POLICY-DECLINED
 10753           MOVE 'U'               TO PB-BATCH-ENTRY
 10754           MOVE  ER-1926          TO WS-ERROR
 10755           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10756
 10757
 10758 0580-AH-PLAN-LIMIT-EDITS.
 10759
 10760     IF PB-COMPANY-ID = 'CID'
 10761        IF PB-I-AH-BENEFIT-AMT > +1250
 10762           MOVE ER-2702          TO WS-ERROR
 10763           PERFORM 9900-ERROR-FORMAT
 10764                                 THRU 9900-EXIT
 10765        END-IF
 10766     END-IF
 10767
 10768     IF (PB-COMPANY-ID = 'DCC')
 10769        AND (PB-MONTHLY-CERT)
 10770        IF PB-I-AH-BENEFIT-AMT > +1000
 10771           MOVE ER-2881          TO WS-ERROR
 10772           PERFORM 9900-ERROR-FORMAT
 10773                                 THRU 9900-EXIT
 10774        END-IF
 10775     END-IF
 10776     IF NOT AH-PLAN-MASTER-FOUND
 10777        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10778        GO TO 3000-CONTINUE-EDIT.
 10779
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 197
* EL050.cbl
 10780     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10781
 10782     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10783         IF PL-LM-AGE (1) = ZEROS
 10784             GO TO 3000-CONTINUE-EDIT.
 10785
 10786     IF NO-AH-BENEFIT-MATCH          OR
 10787        WS-AH-BENEFIT-CD = ZEROS     OR
 10788        WS-AH-SPECIAL-CALC-CD = 'M'
 10789        GO TO 3000-CONTINUE-EDIT.
 10790
 10791     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10792     MOVE +1                     TO SUB2.
 10793
 10794     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10795        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10796           MOVE +5 TO SUB2
 10797           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10798              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10799              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10800              (PL-LM-AGE (SUB2) EQUAL +0)
 10801              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10802              GO TO 3000-CONTINUE-EDIT.
 10803
 10804     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10805
 10806 0590-CHECK-AH-ATT-AGE.
 10807
 10808     IF PL-ATT-AGE NUMERIC AND
 10809        PL-ATT-AGE GREATER THAN +0
 10810        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10811     END-IF
 10812*       IF WS-ATT-AGE >= PL-ATT-AGE
 10813*          MOVE ER-3054          TO WS-ERROR
 10814*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10815     .
 10816 0597-CHECK-AH-LIMITS.
 10817
 10818     IF PB-COMPANY-ID EQUAL 'CRI'
 10819        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10820           IF SUB2 GREATER THAN +4
 10821              MOVE ER-2638       TO WS-ERROR
 10822              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10823              GO TO 3000-CONTINUE-EDIT.
 10824
 10825     IF PB-COMPANY-ID  =  'NCL'
 10826        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10827            SUB2 GREATER THAN +8
 10828             MOVE 'U'            TO PB-BATCH-ENTRY
 10829             MOVE ER-2638        TO WS-ERROR
 10830             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10831             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10832
 10833     IF SUB2 > +8
 10834        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10835           AND (PB-I-SIG-SW = 'Y')
 10836           CONTINUE
 10837        ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 198
* EL050.cbl
 10838           MOVE ER-2638          TO WS-ERROR
 10839           PERFORM 9900-ERROR-FORMAT
 10840                                 THRU 9900-EXIT
 10841        END-IF
 10842        GO TO 3000-CONTINUE-EDIT
 10843     END-IF
 10844
 10845     IF PB-COMPANY-ID = 'CRI'
 10846        IF WS-ERROR = ER-2638
 10847           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 10848
 10849     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 10850     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 10851     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 10852     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 10853
 10854     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10855        ADD +1                   TO SUB2
 10856        GO TO 0597-CHECK-AH-LIMITS.
 10857
 10858     IF PB-COMPANY-ID = 'NCL'
 10859         GO TO 0597-CHECK-NCL-AH-LIMITS.
 10860
 10861     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 10862        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 10863        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10864                                 > PL-LM-AMT (SUB2))
 10865        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10866           AND (PB-I-SIG-SW = 'Y')
 10867           CONTINUE
 10868        ELSE
 10869           MOVE ER-2638          TO WS-ERROR
 10870           PERFORM 9900-ERROR-FORMAT
 10871                                 THRU 9900-EXIT
 10872        END-IF
 10873     END-IF
 10874
 10875     IF  PB-COMPANY-ID   EQUAL    'CRI'
 10876         IF  WS-ERROR    EQUAL    ER-2638
 10877             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 10878                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 10879                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10880                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 10881                MOVE  ER-1910    TO  WS-ERROR
 10882                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 10883
 10884     IF PB-COMPANY-ID = 'CRI'
 10885        IF WS-ERROR = ER-2638
 10886            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10887            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 10888            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 10889
 10890     GO TO 3000-CONTINUE-EDIT.
 10891
 10892 0597-CHECK-NCL-AH-LIMITS.
 10893
 10894     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 10895        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 199
* EL050.cbl
 10896        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10897                            NOT GREATER THAN PL-LM-AMT (SUB2))
 10898         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10899
 10900     IF APP-CERT-USED
 10901         IF SUB2  LESS THAN  +5
 10902             MOVE +5             TO SUB2
 10903             GO TO 0597-CHECK-AH-LIMITS.
 10904
 10905     MOVE ER-2638                TO WS-ERROR.
 10906     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10907
 10908     MOVE 'U'                    TO PB-BATCH-ENTRY.
 10909
 10910 0599-CHECK-NCL-SIG-SWITCH.
 10911
 10912     IF NOT APP-CERT-USED
 10913         GO TO 3000-CONTINUE-EDIT.
 10914
 10915     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10916        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10917        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10918        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10919         GO TO 3000-CONTINUE-EDIT.
 10920
 10921     IF SUB2 GREATER THAN +4
 10922         IF PL-LM-AGE (5) = ZEROS  AND
 10923            PL-LM-AGE (6) = ZEROS  AND
 10924            PL-LM-AGE (7) = ZEROS  AND
 10925            PL-LM-AGE (8) = ZEROS
 10926             MOVE  ER-1927        TO WS-ERROR
 10927             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10928             GO TO 3000-CONTINUE-EDIT
 10929         ELSE
 10930             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10931                 MOVE  ER-1920    TO WS-ERROR
 10932                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10933
 10934     IF PB-I-SIG-SW  = 'Y'
 10935       IF NOT PB-I-POLICY-ACCEPTED  AND
 10936          NOT PB-I-POLICY-DECLINED
 10937           MOVE 'U'               TO PB-BATCH-ENTRY
 10938           MOVE  ER-1926          TO WS-ERROR
 10939           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10940
 10941******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 200
* EL050.cbl
 10943
 10944 3000-CONTINUE-EDIT.
 10945
 10946     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10947     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 10948     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10949     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10950     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10951
 10952     IF BROWSE-STARTED
 10953        PERFORM 9990-RETURN THRU 9990-EXIT
 10954        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 10955
 10956     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 10957        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 10958        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10959        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10960*       MOVE 1                   TO DC-OPTION-CODE
 10961        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10962        IF DATE-CONVERSION-ERROR
 10963           MOVE ER-2622          TO WS-ERROR
 10964           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10965        ELSE
 10966           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 10967              MOVE ER-2623       TO WS-ERROR
 10968              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10969           ELSE
 10970              MOVE ER-2622       TO WS-ERROR
 10971              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10972
 10973     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 10974     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 10975     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 10976*    MOVE 1                      TO DC-OPTION-CODE.
 10977     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10978     IF DATE-CONVERSION-ERROR
 10979        GO TO 3005-EDIT-CONTINUE
 10980     ELSE
 10981        IF DC-ELAPSED-DAYS GREATER +180
 10982           MOVE ER-2613          TO WS-ERROR
 10983           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10984        ELSE
 10985           IF DC-ELAPSED-DAYS GREATER +90
 10986              MOVE ER-2612       TO WS-ERROR
 10987              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10988           ELSE
 10989             IF DC-ELAPSED-DAYS GREATER +60
 10990                MOVE ER-2614     TO WS-ERROR
 10991                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10992
 10993 3005-EDIT-CONTINUE.
 10994
 10995     IF PB-CANCELLATION
 10996         GO TO 3700-EDIT-CANCEL.
 10997
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 201
* EL050.cbl
 10999******************************************************************
 11000*                  E D I T   I S S U E                           *
 11001******************************************************************
 11002
 11003 3020-EDIT-ISSUE.
 11004
 11005      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11006      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11007      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11008      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11009      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11010
 11011     IF PB-ISSUE-FORCE
 11012        OR PB-ISSUE-DATE-FORCED
 11013        OR PB-FORCE-OFF
 11014        OR PB-OVERCHARGE-FORCE
 11015        CONTINUE
 11016     ELSE
 11017        MOVE ER-2670             TO WS-ERROR
 11018        PERFORM 9900-ERROR-FORMAT
 11019                                 THRU 9900-EXIT
 11020     END-IF
 11021     .
 11022 3022-SET-POLICY-STATUS.
 11023
 11024     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11025
 11026     IF (PB-REISSUED-CERT)
 11027             OR
 11028        ((PB-COMPANY-ID NOT = 'DCC')
 11029         AND (PB-MONTHLY-CERT))
 11030         MOVE '5'                TO PB-I-ENTRY-STATUS
 11031         MOVE 'E'                TO PB-BATCH-ENTRY
 11032     END-IF
 11033
 11034     IF PB-COMPANY-ID = 'DCC'
 11035        IF PB-MONTHLY-CERT
 11036           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11037        END-IF
 11038     END-IF
 11039     IF PB-POLICY-IS-DECLINED
 11040         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11041     IF PB-POLICY-IS-VOIDED
 11042         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11043     IF PB-NEEDS-UNDERWRITING
 11044         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11045     IF PB-REIN-ONLY-CERT
 11046         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11047     IF PB-PREM-ACCTNG-ONLY
 11048         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11049
 11050     MOVE SPACE                  TO PB-I-OB-FLAG.
 11051
 11052     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11053         MOVE ER-2665            TO WS-ERROR
 11054         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11055         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11056
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 202
* EL050.cbl
 11057     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11058        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11059           MOVE 'Z'             TO PB-I-OB-FLAG.
 11060
 11061     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11062        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11063           MOVE 'Z'             TO PB-I-OB-FLAG.
 11064
 11065     IF ACCOUNT-MAST-FOUND
 11066         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11067         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11068         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11069         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11070         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11071         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11072         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11073     END-IF
 11074
 11075     IF ACCOUNT-MAST-FOUND
 11076        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11077         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11078
 11079     IF (ACCOUNT-MAST-FOUND)
 11080        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11081        IF PB-REISSUED-CERT
 11082           CONTINUE
 11083        ELSE
 11084           MOVE ER-2608          TO WS-ERROR
 11085           PERFORM 9900-ERROR-FORMAT
 11086                                 THRU 9900-EXIT
 11087         END-IF
 11088     END-IF
 11089
 11090     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11091        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11092        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11093
 11094**********   DMD CUSTOM CODE FOLLOWS  **********
 11095 3024-EDIT-DMD-FIELDS.
 11096     IF PB-COMPANY-ID NOT = 'DMD'
 11097        GO TO 3025-EDIT-REINSURANCE.
 11098
 11099*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11100*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11101*** ERROR IF THEY ARE NOT EQUAL.
 11102
 11103     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11104     SET BIN-TO-GREG               TO TRUE.
 11105     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11106     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11107**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11108
 11109     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11110     SET BIN-TO-GREG               TO TRUE.
 11111     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11112     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11113**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11114
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 203
* EL050.cbl
 11115     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11116        MOVE ER-8116               TO WS-ERROR
 11117        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11118
 11119     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11120
 11121     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11122                                      WK-FULL-CERT-NO.
 11123     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11124
 11125     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11126
 11127     IF PB-VALID-LIFE
 11128        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11129     ELSE
 11130        IF PB-VALID-AH
 11131          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11132
 11133
 11134     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11135     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11136     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11137                                      DCUA-UNDRWRTR-CODE
 11138                                      DCUA-UNDRWRTR-GROUP-CODE
 11139                                      DCUA-RETURN-CODE.
 11140
 11141****************************************************************
 11142*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11143***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11144***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11145***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11146***   TO THIS RECORD.                                        ***
 11147****************************************************************
 11148     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11149     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11150     IF DCUA-SUCCESSFUL-PROCESS
 11151        GO TO 3024-EDIT-DL7-CONT.
 11152
 11153     IF DCUA-RETURN-CODE EQUAL '01'
 11154        MOVE ER-8110               TO WS-ERROR
 11155        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11156        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11157        GO TO 3024-EDIT-DL7-CONT.
 11158
 11159     IF DCUA-RETURN-CODE EQUAL '02'
 11160        MOVE ER-8111               TO WS-ERROR
 11161        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11162        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11163        GO TO 3024-EDIT-DL7-CONT.
 11164
 11165     IF DCUA-RETURN-CODE EQUAL '03'
 11166        MOVE ER-8074               TO WS-ERROR
 11167        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11168        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11169        GO TO 3024-EDIT-DL7-CONT.
 11170
 11171     IF DCUA-RETURN-CODE EQUAL '04'
 11172        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 204
* EL050.cbl
 11173        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11174        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11175        GO TO 3024-EDIT-DL7-CONT.
 11176
 11177     IF DCUA-RETURN-CODE EQUAL '05'
 11178        MOVE ER-8076               TO WS-ERROR
 11179        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11180        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11181        GO TO 3024-EDIT-DL7-CONT.
 11182
 11183     IF DCUA-RETURN-CODE EQUAL '06'
 11184        MOVE ER-8077               TO WS-ERROR
 11185        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11186        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11187        GO TO 3024-EDIT-DL7-CONT.
 11188
 11189     IF DCUA-RETURN-CODE EQUAL '07'
 11190        MOVE ER-8078               TO WS-ERROR
 11191        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11192        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11193        GO TO 3024-EDIT-DL7-CONT.
 11194
 11195     IF DCUA-RETURN-CODE EQUAL 'E1'
 11196        MOVE ER-8079               TO WS-ERROR
 11197        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11198        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11199        GO TO 3024-EDIT-DL7-CONT.
 11200
 11201     IF DCUA-RETURN-CODE EQUAL 'E2'
 11202        MOVE ER-8080               TO WS-ERROR
 11203        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11204        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11205        GO TO 3024-EDIT-DL7-CONT.
 11206
 11207     IF DCUA-RETURN-CODE EQUAL 'E3'
 11208        MOVE ER-8098               TO WS-ERROR
 11209        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11210        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11211        GO TO 3024-EDIT-DL7-CONT.
 11212
 11213     IF DCUA-RETURN-CODE EQUAL 'C1'
 11214        MOVE ER-8099               TO WS-ERROR
 11215        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11216        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11217        GO TO 3024-EDIT-DL7-CONT.
 11218
 11219     IF DCUA-RETURN-CODE EQUAL 'U1'
 11220        MOVE ER-8109               TO WS-ERROR
 11221        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11222        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11223        GO TO 3024-EDIT-DL7-CONT.
 11224
 11225     IF DCUA-RETURN-CODE EQUAL 'N1'
 11226        MOVE ER-8112               TO WS-ERROR
 11227        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11228        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11229        GO TO 3024-EDIT-DL7-CONT.
 11230
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 205
* EL050.cbl
 11231     IF DCUA-RETURN-CODE EQUAL 'N2'
 11232        MOVE ER-8113               TO WS-ERROR
 11233        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11234        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11235        GO TO 3024-EDIT-DL7-CONT.
 11236
 11237     IF DCUA-RETURN-CODE EQUAL 'N3'
 11238        MOVE ER-8114               TO WS-ERROR
 11239        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11240        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11241        GO TO 3024-EDIT-DL7-CONT.
 11242
 11243     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11244     MOVE ER-8097                  TO WS-ERROR.
 11245     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11246     GO TO 3024-EDIT-DL7-CONT.
 11247
 11248 3024-EDIT-DL7-CONT.
 11249
 11250     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11251     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11252     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11253        NEXT SENTENCE
 11254     ELSE
 11255        MOVE ER-9263               TO WS-ERROR
 11256        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11257
 11258******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11259******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11260     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11261        NEXT SENTENCE
 11262     ELSE
 11263        MOVE ER-8039               TO WS-ERROR
 11264        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11265
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 206
* EL050.cbl
 11267****************************************************************
 11268*** VALIDATE STATE  : DLO022                                 ***
 11269****************************************************************
 11270     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11271     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11272
 11273     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11274     IF DVSC-SUCCESSFUL-EDIT
 11275        GO TO 3024-EDIT-DL22-CONT.
 11276
 11277     IF DVSC-RETURN-CODE EQUAL '01'
 11278        MOVE ER-8300               TO WS-ERROR
 11279        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11280        GO TO 3024-EDIT-DL22-CONT.
 11281
 11282     IF DVSC-RETURN-CODE EQUAL '02'
 11283        MOVE ER-8301               TO WS-ERROR
 11284        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11285        GO TO 3024-EDIT-DL22-CONT.
 11286
 11287     IF DVSC-RETURN-CODE EQUAL '03'
 11288        MOVE ER-8302               TO WS-ERROR
 11289        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11290        GO TO 3024-EDIT-DL22-CONT.
 11291
 11292     IF DVSC-RETURN-CODE EQUAL 'N1'
 11293        MOVE ER-8304               TO WS-ERROR
 11294        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11295        GO TO 3024-EDIT-DL22-CONT.
 11296
 11297     MOVE ER-8303                  TO WS-ERROR
 11298     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11299
 11300 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 207
* EL050.cbl
 11302****************************************************************
 11303*** VALIDATE LOAN OFFICER : DLO021                           ***
 11304****************************************************************
 11305
 11306     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11307     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11308     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11309     IF DVLO-SUCCESSFUL-EDIT
 11310        GO TO 3024-EDIT-DL21-CONT.
 11311
 11312     IF DVLO-RETURN-CODE EQUAL '01'
 11313        MOVE ER-8081               TO WS-ERROR
 11314        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11315        GO TO 3024-EDIT-DL21-CONT.
 11316
 11317     IF DVLO-RETURN-CODE EQUAL '02'
 11318        MOVE ER-8082               TO WS-ERROR
 11319        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11320        GO TO 3024-EDIT-DL21-CONT.
 11321
 11322     IF DVLO-RETURN-CODE EQUAL '03'
 11323        MOVE ER-8083               TO WS-ERROR
 11324        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11325        GO TO 3024-EDIT-DL21-CONT.
 11326
 11327     IF DVLO-RETURN-CODE EQUAL '04'
 11328        MOVE ER-8084               TO WS-ERROR
 11329        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11330        GO TO 3024-EDIT-DL21-CONT.
 11331
 11332     IF DVLO-RETURN-CODE EQUAL '05'
 11333        MOVE ER-8085               TO WS-ERROR
 11334        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11335        GO TO 3024-EDIT-DL21-CONT.
 11336
 11337     MOVE ER-7825                  TO WS-ERROR
 11338     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11339     GO TO 3024-EDIT-DL21-CONT.
 11340
 11341 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 208
* EL050.cbl
 11343
 11344****************************************************************
 11345*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11346****************************************************************
 11347
 11348     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11349     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11350     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11351     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11352     IF DIPF-SUCCESSFUL-EDIT
 11353        GO TO 3024-EDIT-DL02-CONT.
 11354
 11355     IF DIPF-RETURN-CODE EQUAL '01'
 11356        MOVE ER-8086               TO WS-ERROR
 11357        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11358        GO TO 3024-EDIT-DL02-CONT.
 11359
 11360     IF DIPF-RETURN-CODE EQUAL '02'
 11361        MOVE ER-8087               TO WS-ERROR
 11362        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11363        GO TO 3024-EDIT-DL02-CONT.
 11364
 11365     IF DIPF-RETURN-CODE EQUAL '03'
 11366        MOVE ER-8088               TO WS-ERROR
 11367        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11368        GO TO 3024-EDIT-DL02-CONT.
 11369
 11370     MOVE ER-8095                  TO WS-ERROR
 11371     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11372     GO TO 3024-EDIT-DL02-CONT.
 11373
 11374 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 209
* EL050.cbl
 11376
 11377****************************************************************
 11378*** VALIDATE BANK ID : DLO003                                ***
 11379****************************************************************
 11380
 11381     MOVE WK-GREG-CENT           TO WCG-CENT.
 11382     MOVE WK-GREG-YYMM           TO WCG-REST.
 11383     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11384        MOVE ER-8040               TO WS-ERROR
 11385        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11386
 11387     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11388     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11389     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11390     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11391     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11392     IF DVBI-SUCCESSFUL-EDIT
 11393        GO TO 3024-EDIT-DL03-CONT.
 11394
 11395     IF DVBI-RETURN-CODE EQUAL '01'
 11396        MOVE ER-8089               TO WS-ERROR
 11397        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11398        GO TO 3024-EDIT-DL03-CONT.
 11399
 11400     IF DVBI-RETURN-CODE EQUAL '02'
 11401        MOVE ER-8090               TO WS-ERROR
 11402        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11403        GO TO 3024-EDIT-DL03-CONT.
 11404
 11405     IF DVBI-RETURN-CODE EQUAL '03'
 11406        MOVE ER-8091               TO WS-ERROR
 11407        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11408        GO TO 3024-EDIT-DL03-CONT.
 11409
 11410     IF DVBI-RETURN-CODE EQUAL '04'
 11411        MOVE ER-8092               TO WS-ERROR
 11412        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11413        GO TO 3024-EDIT-DL03-CONT.
 11414
 11415     IF DVBI-RETURN-CODE EQUAL '05'
 11416        MOVE ER-8093               TO WS-ERROR
 11417        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11418        GO TO 3024-EDIT-DL03-CONT.
 11419
 11420     IF DVBI-RETURN-CODE EQUAL '06'
 11421        MOVE ER-8094               TO WS-ERROR
 11422        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11423        GO TO 3024-EDIT-DL03-CONT.
 11424
 11425     MOVE ER-8096                  TO WS-ERROR
 11426     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11427     GO TO 3024-EDIT-DL03-CONT.
 11428
 11429 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 210
* EL050.cbl
 11431
 11432     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11433        NEXT SENTENCE
 11434     ELSE
 11435        MOVE ER-8042               TO WS-ERROR
 11436        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11437
 11438     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11439     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11440     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11441
 11442     IF DMPF-RETURN-CODE = '01'
 11443        MOVE ER-8067               TO WS-ERROR
 11444        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11445        GO TO 3024-EDIT-DL01-CONT.
 11446
 11447     IF DMPF-RETURN-CODE = '02'
 11448        MOVE ER-8068               TO WS-ERROR
 11449        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11450        GO TO 3024-EDIT-DL01-CONT.
 11451
 11452     IF DMPF-RETURN-CODE = '03'
 11453        MOVE ER-8069               TO WS-ERROR
 11454        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11455        GO TO 3024-EDIT-DL01-CONT.
 11456
 11457     IF DMPF-RETURN-CODE = 'E1'
 11458        MOVE ER-8070               TO WS-ERROR
 11459        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11460        GO TO 3024-EDIT-DL01-CONT.
 11461
 11462     IF DMPF-RETURN-CODE = 'N1'
 11463        MOVE ER-8071               TO WS-ERROR
 11464        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11465        GO TO 3024-EDIT-DL01-CONT.
 11466
 11467     IF DMPF-RETURN-CODE NOT = 'OK'
 11468        MOVE ER-8072               TO WS-ERROR
 11469        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11470
 11471 3024-EDIT-DL01-CONT.
 11472******************************************************************
 11473***  VALIDATES RATE CODES : DLO017                             ***
 11474******************************************************************
 11475
 11476      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11477      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11478      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11479      IF DVRC-SUCCESSFUL-EDIT
 11480        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11481        GO TO 3024-CHECK-VALID-RATE.
 11482
 11483      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11484
 11485      IF DVRC-RETURN-CODE EQUAL '01'
 11486         MOVE ER-7817                   TO WS-ERROR
 11487         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11488         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 211
* EL050.cbl
 11489
 11490      IF DVRC-RETURN-CODE EQUAL '02'
 11491         MOVE ER-7818                   TO WS-ERROR
 11492         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11493         GO TO 3025-EDIT-REINSURANCE.
 11494
 11495      IF DVRC-RETURN-CODE EQUAL '03'
 11496         MOVE ER-7819                   TO WS-ERROR
 11497         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11498         GO TO 3025-EDIT-REINSURANCE.
 11499
 11500       MOVE ER-7820                     TO WS-ERROR.
 11501       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11502       GO TO 3025-EDIT-REINSURANCE.
 11503
 11504******************************************************************
 11505***  GET PREMIUM RATES : DLO011                                ***
 11506******************************************************************
 11507
 11508 3024-CHECK-VALID-RATE.
 11509
 11510     IF VALID-RATE-CODE
 11511        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11512        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11513        MOVE SPACES                TO DPRB-RETURN-CODE
 11514        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11515     ELSE
 11516         GO TO 3025-EDIT-REINSURANCE.
 11517
 11518      IF DPRB-SUCCESSFUL-PROCESS
 11519         IF PB-VALID-LIFE
 11520             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11521             GO TO 3025-EDIT-REINSURANCE
 11522         ELSE
 11523             IF PB-VALID-AH
 11524                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11525                 GO TO 3025-EDIT-REINSURANCE.
 11526
 11527      IF DPRB-RETURN-CODE EQUAL '01'
 11528         MOVE ER-7812                   TO WS-ERROR
 11529         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11530         GO TO 3025-EDIT-REINSURANCE.
 11531
 11532      IF DPRB-RETURN-CODE EQUAL '02'
 11533         MOVE ER-7813                   TO WS-ERROR
 11534         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11535         GO TO 3025-EDIT-REINSURANCE.
 11536
 11537      IF DPRB-RETURN-CODE EQUAL '03'
 11538         MOVE ER-7814                   TO WS-ERROR
 11539         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11540         GO TO 3025-EDIT-REINSURANCE.
 11541
 11542      IF DPRB-RETURN-CODE EQUAL '04'
 11543         IF NOT DPRB-1ST-TIME
 11544            MOVE ER-7815                   TO WS-ERROR
 11545            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11546            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 212
* EL050.cbl
 11547          ELSE
 11548         IF PB-VALID-LIFE
 11549            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11550          ELSE
 11551            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11552         END-IF
 11553         MOVE SPACES                TO DOCC-RETURN-CODE
 11554         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11555         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11556         IF DOCC-RETURN-CODE = 'OK'
 11557             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11558             GO TO 3024-CHECK-VALID-RATE
 11559           ELSE
 11560             MOVE ER-7823               TO WS-ERROR
 11561             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11562             GO TO 3025-EDIT-REINSURANCE.
 11563
 11564       MOVE ER-7816                     TO WS-ERROR.
 11565       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11566       GO TO 3025-EDIT-REINSURANCE.
 11567
 11568**********   DMD CUSTOM CODE ABOVE    **********
 11569
 11570 3025-EDIT-REINSURANCE.
 11571     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11572         GO TO 3027-EDIT-CONTINUE.
 11573
 11574     MOVE LOW-VALUES               TO ERREIN-KEY.
 11575     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11576     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11577                                      REIN-CODE-2
 11578                                      REIN-CODE-3.
 11579     MOVE 'A'                      TO REIN-TYPE.
 11580
 11581     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11582
 11583     MOVE '3026' TO REIN-SW.
 11584     MOVE ' '                   TO WS-REIN-READ-SW.
 11585
 11586     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11587     IF REIN-TABLE-NOT-FOUND
 11588         GO TO 3026-NO-SPEC-TABLE.
 11589
 11590     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11591     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11592                                   WS-NSP-ST-CD-LF.
 11593     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11594                                   WS-NSP-ST-CD-AH.
 11595
 11596     GO TO 3040-EDIT-CONTINUE.
 11597
 11598 3026-NO-SPEC-TABLE.
 11599
 11600     MOVE ER-2664                TO WS-ERROR.
 11601     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11602     GO TO 3040-EDIT-CONTINUE.
 11603
 11604 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 213
* EL050.cbl
 11605
 11606     IF PB-I-REIN-TABLE = SPACES
 11607       GO TO 3040-EDIT-CONTINUE.
 11608
 11609     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11610          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11611          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11612           GO TO 3040-EDIT-CONTINUE.
 11613
 11614     MOVE LOW-VALUES            TO ERREIN-KEY.
 11615     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11616     MOVE 'A'                   TO REIN-TYPE.
 11617     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11618
 11619     MOVE '3028'                TO REIN-SW.
 11620     MOVE ' '                   TO WS-REIN-READ-SW.
 11621
 11622     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11623     IF REIN-TABLE-NOT-FOUND
 11624         GO TO 3028-NO-REIN-TABLE.
 11625
 11626     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11627     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11628                                   WS-NSP-ST-CD-LF.
 11629     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11630                                   WS-NSP-ST-CD-AH.
 11631
 11632     GO TO 3040-EDIT-CONTINUE.
 11633
 11634 3028-NO-REIN-TABLE.
 11635
 11636     MOVE ER-2615                TO WS-ERROR.
 11637     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11638     GO TO 3040-EDIT-CONTINUE.
 11639
 11640 3040-EDIT-CONTINUE.
 11641
 11642     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11643         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11644
 11645     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11646         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11647
 11648     IF (NOT PB-REISSUED-CERT)
 11649        AND (NOT PB-MONTHLY-CERT)
 11650        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11651            MOVE '001'           TO PB-I-LF-TERM
 11652            MOVE 'M'             TO PB-I-INSURED-SEX.
 11653
 11654     IF (NOT PB-REISSUED-CERT)
 11655        AND (NOT PB-MONTHLY-CERT)
 11656        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11657            MOVE '001'           TO PB-I-AH-TERM
 11658            MOVE 'M'             TO PB-I-INSURED-SEX.
 11659
 11660 3040-EDIT-1ST-PMT-DT.
 11661     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11662     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 214
* EL050.cbl
 11663         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11664
 11665******************************************************************
 11666*                                                                *
 11667*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11668*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11669*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11670*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11671*                                                                *
 11672******************************************************************
 11673
 11674     IF PB-EFF-DT-PROCESSING
 11675        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11676                                    PB-I-LF-EXPIRE-DT
 11677                                    PB-I-AH-EXPIRE-DT
 11678        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11679        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11680        MOVE ZERO                TO DC-ELAPSED-DAYS
 11681        MOVE +1                  TO DC-ELAPSED-MONTHS
 11682        SET BIN-PLUS-ELAPSED     TO TRUE
 11683*       MOVE 6                   TO DC-OPTION-CODE
 11684        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11685        IF NO-CONVERSION-ERROR
 11686           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11687
 11688******************************************************************
 11689*                                                                *
 11690*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11691*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11692*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11693*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11694*                                                                *
 11695******************************************************************
 11696
 11697     IF PB-EXT-DAYS-PROCESSING
 11698          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11699                                         PB-I-LF-EXPIRE-DT
 11700                                         PB-I-AH-EXPIRE-DT
 11701          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11702          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11703          MOVE +1                     TO DC-ELAPSED-MONTHS
 11704          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11705          SET BIN-PLUS-ELAPSED        TO TRUE
 11706*         MOVE 6                      TO DC-OPTION-CODE
 11707          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11708          IF NO-CONVERSION-ERROR
 11709             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11710
 11711******************************************************************
 11712*                                                                *
 11713*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11714*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11715*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11716*        (EXPIRE DATE - (TERM -1))  *  -1.
 11717*                                                                *
 11718******************************************************************
 11719
 11720     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 215
* EL050.cbl
 11721        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11722           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11723              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11724              MOVE PB-I-AH-TERM      TO WS-TERM
 11725           ELSE
 11726              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11727              MOVE PB-I-LF-TERM      TO WS-TERM
 11728        ELSE
 11729           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11730              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11731              MOVE PB-I-LF-TERM      TO WS-TERM
 11732           ELSE
 11733              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11734              MOVE PB-I-AH-TERM      TO WS-TERM.
 11735
 11736     IF PB-EXPIRE-DT-PROCESSING
 11737        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11738        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11739        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11740        MOVE ZERO                TO DC-ELAPSED-DAYS
 11741                                    DC-ODD-DAYS-OVER
 11742          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11743          SET BIN-PLUS-ELAPSED    TO TRUE
 11744*         MOVE 6                  TO DC-OPTION-CODE
 11745          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11746          IF NO-CONVERSION-ERROR
 11747             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11748
 11749******************************************************************
 11750*                                                                *
 11751*            1ST PAYMENT DATE PROCESSING                         *
 11752*                                                                *
 11753******************************************************************
 11754
 11755     IF PB-1ST-PMT-DT-PROCESSING
 11756        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11757                                    PB-I-AH-EXPIRE-DT
 11758        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11759
 11760     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11761         NEXT SENTENCE
 11762     ELSE
 11763         MOVE ER-2680                 TO WS-ERROR
 11764         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11765         GO TO 3060-ORIG-TERM-CHECK.
 11766
 11767     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11768     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11769     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11770*    MOVE 1                      TO DC-OPTION-CODE.
 11771     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11772                                    DC-ELAPSED-DAYS
 11773                                    DC-ODD-DAYS-OVER.
 11774
 11775     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11776
 11777     IF DATE-CONVERSION-ERROR
 11778        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 216
* EL050.cbl
 11779
 11780     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11781     IF (PB-COMPANY-ID = 'CID')
 11782        AND (WS-LF-COVERAGE-TYPE = 'L')
 11783        IF (DC-ELAPSED-MONTHS > 1)
 11784                      OR
 11785           ((DC-ELAPSED-MONTHS = 1)
 11786           AND (DC-ODD-DAYS-OVER > 0))
 11787           MOVE ER-2882          TO WS-ERROR
 11788           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11789        END-IF
 11790     END-IF
 11791     IF PB-EXT-DAYS-PROCESSING
 11792        CONTINUE
 11793     ELSE
 11794        IF DC-ELAPSED-MONTHS = +0
 11795           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11796        ELSE
 11797           IF (WS-LF-EARNINGS-CALC = '4')
 11798              AND (DC-ELAPSED-MONTHS > ZERO)
 11799              AND (DC-ELAPSED-DAYS > ZERO)
 11800              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11801           ELSE
 11802              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11803                                 THRU 6499-EXIT
 11804              MOVE WS-ODD-DAYS-OVER
 11805                                 TO PB-I-EXTENTION-DAYS
 11806           END-IF
 11807        END-IF
 11808     END-IF
 11809******************************************************************
 11810*                                                                *
 11811*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11812*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11813*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11814*            AND ANY ODD DAYS.                                   *
 11815*                                                                *
 11816******************************************************************
 11817
 11818     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11819                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11820     IF WS-LF-EARNINGS-CALC NOT = '4'
 11821        IF DC-ELAPSED-DAYS > ZEROS
 11822           MOVE ER-2681          TO WS-ERROR
 11823           PERFORM 9900-ERROR-FORMAT
 11824                                 THRU 9900-EXIT
 11825        END-IF
 11826     END-IF
 11827
 11828     IF WS-LF-EARNINGS-CALC NOT = '4'
 11829        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11830           MOVE ER-2681          TO WS-ERROR
 11831           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11832
 11833     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11834        (PB-I-LF-TERM NOT = ZERO) AND
 11835         NOT NO-LIFE-COVERAGE
 11836          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 217
* EL050.cbl
 11837          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 11838          IF WS-LF-EARNINGS-CALC = '4'
 11839             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 11840             PB-I-PAY-FREQUENCY
 11841          END-IF
 11842          MOVE ZERO              TO DC-ELAPSED-DAYS
 11843                                    DC-ODD-DAYS-OVER
 11844          MOVE 1                 TO DC-END-OF-MONTH
 11845          SET BIN-PLUS-ELAPSED        TO TRUE
 11846*         MOVE 6                 TO DC-OPTION-CODE
 11847          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11848          IF NO-CONVERSION-ERROR
 11849             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 11850             IF (WS-LF-EARNINGS-CALC = 'B') AND
 11851                (WS-LF-SPECIAL-CALC-CD = 'L')
 11852                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 11853                  MOVE ZERO           TO DC-ELAPSED-DAYS
 11854                  MOVE +1             TO DC-ELAPSED-MONTHS
 11855                  SET BIN-PLUS-ELAPSED  TO TRUE
 11856*                 MOVE 6              TO DC-OPTION-CODE
 11857                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11858                  IF NO-CONVERSION-ERROR
 11859                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 11860
 11861* okay, i had to move the new att age edit down here because the
 11862* expiration date could get recalculated and i need the exp date
 11863     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 11864        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 11865        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 11866        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11867           AND ZEROS
 11868           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11869           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11870           SET ELAPSED-BETWEEN-BIN TO TRUE
 11871           PERFORM 8500-DATE-CONVERT
 11872                                 THRU 8500-EXIT
 11873           IF NO-CONVERSION-ERROR
 11874              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11875                 MOVE ER-2669       TO WS-ERROR
 11876*                PERFORM 9900-ERROR-FORMAT
 11877*                                THRU 9900-EXIT
 11878              END-IF
 11879           END-IF
 11880        ELSE
 11881           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 11882           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11883              MOVE ER-2669       TO WS-ERROR
 11884*             PERFORM 9900-ERROR-FORMAT
 11885*                                THRU 9900-EXIT
 11886           ELSE
 11887              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11888                 MOVE ER-1570    TO WS-ERROR
 11889                 PERFORM 9900-ERROR-FORMAT
 11890                                 THRU 9900-EXIT
 11891              END-IF
 11892           END-IF
 11893        END-IF
 11894        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 218
* EL050.cbl
 11895           AND ZEROS
 11896           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11897           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11898           SET ELAPSED-BETWEEN-BIN TO TRUE
 11899           PERFORM 8500-DATE-CONVERT
 11900                                 THRU 8500-EXIT
 11901           IF NO-CONVERSION-ERROR
 11902              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11903                 MOVE ER-2669       TO WS-ERROR
 11904*                PERFORM 9900-ERROR-FORMAT
 11905*                                THRU 9900-EXIT
 11906              END-IF
 11907           END-IF
 11908        ELSE
 11909           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 11910             (PB-I-LF-TERM / 12)
 11911           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11912              MOVE ER-2669       TO WS-ERROR
 11913*             PERFORM 9900-ERROR-FORMAT
 11914*                                THRU 9900-EXIT
 11915           ELSE
 11916              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11917                 MOVE ER-1571    TO WS-ERROR
 11918                 PERFORM 9900-ERROR-FORMAT
 11919                                 THRU 9900-EXIT
 11920              END-IF
 11921           END-IF
 11922        END-IF
 11923        IF WS-ERROR = ER-2669
 11924           PERFORM 9900-ERROR-FORMAT
 11925                                 THRU 9900-EXIT
 11926        END-IF
 11927     END-IF
 11928     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 11929        (PB-I-AH-TERM NOT = ZERO) AND
 11930         NOT NO-AH-COVERAGE
 11931          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 11932             AND (PB-COMPANY-ID = 'DCC')
 11933             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11934             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 11935          ELSE
 11936             IF WS-LF-EARNINGS-CALC = '4'
 11937                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 11938                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 11939                PB-I-PAY-FREQUENCY
 11940             ELSE
 11941                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 11942                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 11943             END-IF
 11944          END-IF
 11945          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11946                                         DC-ODD-DAYS-OVER
 11947          MOVE 1                      TO DC-END-OF-MONTH
 11948          SET BIN-PLUS-ELAPSED        TO TRUE
 11949*         MOVE 6                      TO DC-OPTION-CODE
 11950          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11951          IF NO-CONVERSION-ERROR
 11952             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 219
* EL050.cbl
 11953     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 11954        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 11955        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 11956        IF PB-I-BIRTHDAY > LOW-VALUES
 11957           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11958           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11959           SET ELAPSED-BETWEEN-BIN TO TRUE
 11960           PERFORM 8500-DATE-CONVERT
 11961                                 THRU 8500-EXIT
 11962           IF NO-CONVERSION-ERROR
 11963              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 11964                 MOVE ER-3054       TO WS-ERROR
 11965*                PERFORM 9900-ERROR-FORMAT
 11966*                                THRU 9900-EXIT
 11967              END-IF
 11968           END-IF
 11969        ELSE
 11970           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 11971           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 11972              MOVE ER-3054       TO WS-ERROR
 11973*             PERFORM 9900-ERROR-FORMAT
 11974*                                THRU 9900-EXIT
 11975           END-IF
 11976        END-IF
 11977        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11978           AND ZEROS
 11979           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11980           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11981           SET ELAPSED-BETWEEN-BIN TO TRUE
 11982           PERFORM 8500-DATE-CONVERT
 11983                                 THRU 8500-EXIT
 11984           IF NO-CONVERSION-ERROR
 11985              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 11986                 MOVE ER-3054       TO WS-ERROR
 11987*                PERFORM 9900-ERROR-FORMAT
 11988*                                THRU 9900-EXIT
 11989              END-IF
 11990           END-IF
 11991        ELSE
 11992           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 11993             (PB-I-AH-TERM / 12)
 11994           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 11995              MOVE ER-3054       TO WS-ERROR
 11996*             PERFORM 9900-ERROR-FORMAT
 11997*                                THRU 9900-EXIT
 11998           END-IF
 11999        END-IF
 12000        IF WS-ERROR = ER-3054
 12001           PERFORM 9900-ERROR-FORMAT
 12002                                 THRU 9900-EXIT
 12003        END-IF
 12004     END-IF
 12005     MOVE SPACE                       TO DC-END-OF-MONTH.
 12006
 12007     IF PB-COMPANY-ID = 'NCB'
 12008        GO TO 3040-EDIT-EXTENSION-DAYS.
 12009
 12010     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 220
* EL050.cbl
 12011       AND
 12012        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12013        NEXT SENTENCE
 12014     ELSE
 12015        GO TO 3040-EDIT-EXTENSION-DAYS.
 12016
 12017     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12018        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12019        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12020     ELSE
 12021        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12022        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12023
 12024     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12025*    MOVE '1'      TO DC-OPTION-CODE
 12026     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12027     IF (NO-CONVERSION-ERROR)
 12028        AND (DC-ELAPSED-MONTHS > +1)
 12029        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12030        MOVE ER-2668   TO WS-ERROR
 12031        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12032
 12033 3040-EDIT-EXTENSION-DAYS.
 12034
 12035     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12036        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12037         GO TO 3050-EDIT-TERM-IN-DAYS
 12038     ELSE
 12039         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12040
 12041     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12042         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12043     ELSE
 12044        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12045           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12046           MOVE ER-2681         TO WS-ERROR
 12047           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12048
 12049     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12050        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12051        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12052         GO TO 3060-ORIG-TERM-CHECK.
 12053
 12054     GO TO 3060-ORIG-TERM-CHECK.
 12055
 12056 3050-EDIT-TERM-IN-DAYS.
 12057
 12058     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12059
 12060     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12061         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12062     ELSE
 12063         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12064            MOVE ER-2682         TO WS-ERROR
 12065            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12066
 12067     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12068                                       REMAINDER WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 221
* EL050.cbl
 12069     IF WS-WORK-TERM GREATER THAN ZERO
 12070         ADD +1 TO PB-I-LF-TERM.
 12071
 12072     IF NOT NO-AH-COVERAGE
 12073         MOVE ER-2684            TO WS-ERROR
 12074         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12075
 12076
 12077 3060-ORIG-TERM-CHECK.
 12078
 12079******************************************************************
 12080*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12081******************************************************************
 12082
 12083     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12084        NEXT SENTENCE
 12085     ELSE
 12086        IF NOT NO-LIFE-COVERAGE
 12087           IF PB-I-LF-TERM NUMERIC
 12088              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12089              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12090              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12091                  NEXT SENTENCE
 12092           ELSE
 12093              MOVE ER-2647       TO WS-ERROR
 12094              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12095
 12096     IF NOT NO-AH-COVERAGE
 12097         IF PB-I-AH-TERM NUMERIC
 12098            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12099            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12100            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12101             NEXT SENTENCE
 12102          ELSE
 12103              MOVE ER-2658       TO WS-ERROR
 12104              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12105
 12106     IF PB-COMPANY-ID = 'NCB'
 12107        GO TO 3070-LOAN-TERM-CHECK.
 12108
 12109     IF POLICY-HAS-AH
 12110       AND
 12111        POLICY-HAS-LIFE
 12112       AND
 12113        PB-I-LF-TERM NUMERIC
 12114       AND
 12115        PB-I-AH-TERM NUMERIC
 12116        NEXT SENTENCE
 12117     ELSE
 12118        GO TO 3070-LOAN-TERM-CHECK.
 12119
 12120     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12121     IF WS-TEX-FACT-2 LESS THAN +0
 12122        MULTIPLY +1 BY WS-TEX-FACT-2.
 12123
 12124     IF WS-TEX-FACT-2 GREATER THAN +1
 12125        MOVE ER-2668             TO WS-ERROR
 12126        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 222
* EL050.cbl
 12127
 12128 3070-LOAN-TERM-CHECK.
 12129
 12130     IF (WS-LF-BENEFIT-CD = ZERO)
 12131         OR (NO-LF-BENEFIT-MATCH)
 12132            GO TO 3125-EDIT-PMT-FREQ.
 12133*    IF PB-COMPANY-ID NOT = 'DCC'
 12134*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12135*          AND 'V' AND 'W' AND 'X'
 12136*          GO TO 3125-EDIT-PMT-FREQ
 12137*       END-IF
 12138*    ELSE
 12139*       IF WS-AH-DCC-TRUNC = 'T'
 12140*          CONTINUE
 12141*       ELSE
 12142*          GO TO 3125-EDIT-PMT-FREQ
 12143*       END-IF
 12144*    END-IF
 12145     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12146                    OR
 12147        ((PB-COMPANY-ID = 'DCC')
 12148        AND (WS-AH-DCC-TRUNC = 'T'))
 12149        CONTINUE
 12150     ELSE
 12151        GO TO 3125-EDIT-PMT-FREQ
 12152     END-IF
 12153     IF PB-I-LOAN-TERM NOT NUMERIC
 12154         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12155
 12156     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12157        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12158        PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12159        PB-I-LOAN-TERM NOT GREATER THAN +360
 12160         NEXT SENTENCE
 12161     ELSE
 12162         MOVE ER-2648            TO WS-ERROR
 12163         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12164
 12165     IF WS-STATE-ABBREVIATION = 'NC'
 12166        IF PB-I-LOAN-TERM > +59
 12167           CONTINUE
 12168        ELSE
 12169           MOVE ER-2792          TO WS-ERROR
 12170           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12171        END-IF
 12172     END-IF
 12173
 12174     .
 12175 3125-EDIT-PMT-FREQ.
 12176     IF (WS-LF-BENEFIT-CD = ZERO)
 12177         OR (NO-LF-BENEFIT-MATCH)
 12178            GO TO 3127-EDIT-LOAN-OFFICER.
 12179     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12180                    OR
 12181        ((PB-COMPANY-ID = 'DCC')
 12182        AND (WS-AH-DCC-TRUNC = 'T'))
 12183        CONTINUE
 12184     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 223
* EL050.cbl
 12185        IF (PB-I-LOAN-TERM > ZEROS)
 12186           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12187           MOVE ER-1575          TO WS-ERROR
 12188           PERFORM 9900-ERROR-FORMAT
 12189                                 THRU 9900-EXIT
 12190        END-IF
 12191     END-IF
 12192     IF WS-LF-EARNINGS-CALC NOT = '4'
 12193         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12194            MOVE ER-2653         TO WS-ERROR
 12195            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12196            GO TO 3127-EDIT-LOAN-OFFICER
 12197         ELSE
 12198            GO TO 3127-EDIT-LOAN-OFFICER.
 12199
 12200     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12201         MOVE ER-2655            TO WS-ERROR
 12202         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12203         GO TO 3127-EDIT-LOAN-OFFICER.
 12204
 12205     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12206         MOVE ER-2654            TO WS-ERROR
 12207         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12208         GO TO 3127-EDIT-LOAN-OFFICER.
 12209
 12210     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12211         GIVING WS-TEX-FACT-2
 12212             REMAINDER WS-TEX-FACT-3.
 12213
 12214*    IF WS-TEX-FACT-3 NOT = ZERO
 12215*       MOVE ER-2654             TO WS-ERROR
 12216*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12217
 12218
 12219 3127-EDIT-LOAN-OFFICER.
 12220
 12221     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12222        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12223           MOVE ER-2690          TO WS-ERROR
 12224           PERFORM 9900-ERROR-FORMAT
 12225                                 THRU 9900-EXIT
 12226        ELSE
 12227           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12228           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12229           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12230           MOVE PB-SV-STATE      TO LOFC-STATE
 12231           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 12232           MOVE PB-I-LOAN-OFFICER
 12233                                 TO LOFC-CODE
 12234           PERFORM 8586-READ-LOAN-OFFICER
 12235                                 THRU 8586-EXIT
 12236           IF (NOT LOFC-MASTER-FOUND)
 12237              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12238              MOVE ER-3006       TO WS-ERROR
 12239              PERFORM 9900-ERROR-FORMAT
 12240                                 THRU 9900-EXIT
 12241           END-IF
 12242        END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 224
* EL050.cbl
 12243     END-IF
 12244     .
 12245 3129-EDIT-APR.
 12246
 12247     IF (WS-LF-BENEFIT-CD = ZERO)
 12248        OR (NO-LF-BENEFIT-MATCH)
 12249        IF PB-COMPANY-ID NOT = 'DCC'
 12250           GO TO 3130-EDIT-AGE
 12251*       ELSE
 12252*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12253*             GO TO 3130-EDIT-AGE
 12254*          END-IF
 12255        END-IF
 12256     END-IF
 12257
 12258     IF (WS-STATE-ABBREVIATION = 'OH')
 12259         AND (PB-I-RATE-CLASS NOT = 'L ')
 12260         AND (PB-I-LF-TERM GREATER THAN 60)
 12261         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12262         GO TO 3129-APR-CONT.
 12263
 12264     IF (WS-STATE-ABBREVIATION = 'RI')
 12265         AND (PB-I-LF-TERM GREATER THAN 60)
 12266         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12267         GO TO 3129-APR-CONT.
 12268
 12269     IF (WS-STATE-ABBREVIATION = 'UT')
 12270         AND (PB-I-LF-TERM GREATER THAN 62)
 12271         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12272         AND (PB-CERT-EFF-DT LESS WS-830901)
 12273         GO TO 3129-APR-CONT.
 12274
 12275     IF PB-COMPANY-ID = 'LAP'
 12276        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12277           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12278              MOVE ER-2656         TO WS-ERROR
 12279              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12280              GO TO 3130-EDIT-AGE.
 12281
 12282     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12283        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12284        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12285        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12286         GO TO 3130-EDIT-AGE.
 12287
 12288 3129-APR-CONT.
 12289     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12290         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12291         GO TO 3130-EDIT-AGE.
 12292
 12293     IF (WS-LF-BENEFIT-CD (1:1) = 'S')
 12294        AND (PB-COMPANY-ID = 'DCC')
 12295        AND (PB-I-LOAN-APR = ZERO)
 12296        MOVE ER-2657             TO WS-ERROR
 12297        PERFORM 9900-ERROR-FORMAT
 12298                                 THRU 9900-EXIT
 12299        GO TO 3130-EDIT-AGE
 12300     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 225
* EL050.cbl
 12301     IF PB-I-LOAN-APR = ZERO
 12302        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12303     END-IF
 12304
 12305     IF PB-I-LOAN-APR = ZERO
 12306        MOVE ER-2656             TO WS-ERROR
 12307        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12308        GO TO 3130-EDIT-AGE.
 12309
 12310*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12311     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12312        MOVE ER-2657             TO WS-ERROR
 12313        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12314
 12315 3130-EDIT-AGE.
 12316
 12317******************************************************************
 12318*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12319******************************************************************
 12320
 12321     IF NOT NO-LIFE-COVERAGE
 12322        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12323           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12324               MOVE ER-2628             TO WS-ERROR
 12325               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12326
 12327     IF NOT NO-AH-COVERAGE
 12328        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12329           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12330               MOVE ER-2628         TO WS-ERROR
 12331               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12332
 12333 3133-SEX-CODE.
 12334     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12335         IF WS-DEFAULT-SEX = 'M'
 12336             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12337          ELSE
 12338             IF WS-DEFAULT-SEX = 'F'
 12339             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12340
 12341     IF PB-I-INSURED-SEX = '1'
 12342         MOVE 'M' TO PB-I-INSURED-SEX.
 12343
 12344     IF PB-I-INSURED-SEX = '2'
 12345         MOVE 'F' TO PB-I-INSURED-SEX.
 12346
 12347 3134-SIG-SW-EDIT.
 12348     IF PB-I-SIG-SW = SPACE
 12349         MOVE 'N'                TO  PB-I-SIG-SW.
 12350
 12351     IF PB-COMPANY-ID = 'NCL'
 12352         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12353             NEXT SENTENCE
 12354         ELSE
 12355             MOVE ER-1923        TO  WS-ERROR
 12356             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12357     ELSE
 12358     IF PB-COMPANY-ID = 'CRI'
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 226
* EL050.cbl
 12359         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12360             NEXT SENTENCE
 12361         ELSE
 12362             MOVE ER-2606        TO  WS-ERROR
 12363             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12364     ELSE
 12365     IF PB-COMPANY-ID = 'TMS'
 12366         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12367             NEXT SENTENCE
 12368         ELSE
 12369             MOVE ER-2689        TO  WS-ERROR
 12370             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12371     ELSE
 12372         IF PB-I-SIG-SW = 'Y' OR 'N'
 12373             NEXT SENTENCE
 12374         ELSE
 12375             MOVE ER-2651        TO  WS-ERROR
 12376             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12377
 12378     IF PB-COMPANY-ID = 'FLA'
 12379         IF (WS-EDIT-AGE GREATER 54  OR
 12380             WS-AH-EDIT-AGE GREATER 54)  AND
 12381            PB-I-SIG-SW = 'N'
 12382            MOVE ER-2651         TO  WS-ERROR
 12383            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12384
 12385 3135-NAME-EDIT.
 12386
 12387     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12388        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12389        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12390           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12391                                 TO PB-I-JOINT-FIRST-NAME
 12392        END-PERFORM
 12393     END-IF
 12394     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12395        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12396        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12397           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12398                                 TO PB-I-JOINT-LAST-NAME
 12399        END-PERFORM
 12400     END-IF
 12401     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12402        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12403        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12404           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12405                                 TO PB-I-INSURED-FIRST-NAME
 12406        END-PERFORM
 12407     END-IF
 12408     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12409        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12410        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12411           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12412                                 TO PB-I-INSURED-LAST-NAME
 12413        END-PERFORM
 12414     END-IF
 12415     IF PB-I-INSURED-LAST-NAME = SPACES
 12416       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 227
* EL050.cbl
 12417       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12418           MOVE ER-2660    TO WS-ERROR
 12419           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12420
 12421 3136-EDIT-SEX.
 12422
 12423******************************************************************
 12424*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12425******************************************************************
 12426
 12427     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12428        (WS-AH-SPECIAL-CALC-CD = 'O')
 12429        NEXT SENTENCE
 12430     ELSE
 12431        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12432           NEXT SENTENCE
 12433        ELSE
 12434           MOVE ER-2629            TO WS-ERROR
 12435           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12436
 12437 3137-EDIT-EFF-DATE.
 12438
 12439     IF PB-REISSUED-CERT       OR
 12440        PB-POLICY-IS-DECLINED  OR
 12441        PB-POLICY-IS-VOIDED
 12442         GO TO 3139-EDIT-COVERAGE-CODES.
 12443
 12444     MOVE SPACE                  TO WS-2671-SW
 12445                                    WS-2672-SW.
 12446
 12447     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12448         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12449             MOVE ER-2703        TO WS-ERROR
 12450             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12451             GO TO 3139-EDIT-COVERAGE-CODES.
 12452
 12453     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12454         GO TO 3139-EDIT-COVERAGE-CODES.
 12455
 12456     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12457     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12458*    MOVE '1'                    TO DC-OPTION-CODE.
 12459     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12460     MOVE +0                     TO DC-ELAPSED-MONTHS
 12461                                    DC-ELAPSED-DAYS.
 12462     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12463
 12464     IF DATE-CONVERSION-ERROR
 12465         GO TO 3139-EDIT-COVERAGE-CODES.
 12466
 12467     IF DC-ELAPSED-DAYS GREATER +180
 12468         MOVE ER-2672            TO WS-ERROR
 12469         MOVE 'Y'                TO WS-2672-SW
 12470         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12471     END-IF
 12472
 12473     IF WS-ERROR = ER-2671  AND
 12474        PB-COMPANY-ID  = 'LBL'
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 228
* EL050.cbl
 12475        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12476        MOVE SPACE               TO WS-2671-SW
 12477        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12478
 12479     IF PB-ISSUE-DATE-FORCED  AND
 12480      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12481         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12482         MOVE ER-2673            TO WS-ERROR
 12483         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12484         MOVE SPACE              TO WS-2671-SW
 12485                                    WS-2672-SW.
 12486
 12487     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12488         IF PB-ISSUE-DATE-FORCED
 12489             MOVE ER-2600          TO  WS-ERROR
 12490             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12491         ELSE
 12492             MOVE ER-2692          TO  WS-ERROR
 12493             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12494
 12495
 12496 3139-EDIT-COVERAGE-CODES.
 12497
 12498     IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12499        PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12500        MOVE ER-2787             TO WS-ERROR
 12501        PERFORM 9900-ERROR-FORMAT
 12502                                 THRU 9900-EXIT
 12503     END-IF
 12504     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12505        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12506                                 > 250000.00
 12507           MOVE ER-2719          TO WS-ERROR
 12508           PERFORM 9900-ERROR-FORMAT
 12509                                 THRU 9900-EXIT
 12510        END-IF
 12511     END-IF
 12512
 12513     IF PB-POLICY-IS-DECLINED  OR
 12514        PB-POLICY-IS-VOIDED
 12515         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12516
 12517     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12518        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12519         MOVE ER-2630                TO WS-ERROR
 12520         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12521
 12522     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12523        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12524        PB-I-LF-PREMIUM-AMT = ZERO
 12525         GO TO 3140-CHECK-AH-FOR-ZERO.
 12526
 12527     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12528        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12529        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12530         GO TO 3140-CHECK-AH-FOR-ZERO.
 12531
 12532     IF (PB-I-LF-BENEFIT-CD = ZERO)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 229
* EL050.cbl
 12533        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12534        MOVE ER-2631             TO WS-ERROR
 12535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12536     END-IF
 12537
 12538
 12539******************************************************************
 12540*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12541******************************************************************
 12542
 12543     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12544        NEXT SENTENCE
 12545     ELSE
 12546        IF PB-I-LF-BENEFIT-AMT = ZERO
 12547           MOVE ER-2632             TO WS-ERROR
 12548           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12549
 12550
 12551******************************************************************
 12552*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12553******************************************************************
 12554
 12555     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12556        CONTINUE
 12557     ELSE
 12558        IF PB-I-LF-PREMIUM-AMT = ZERO
 12559           IF (NOT PB-COMP-LF-PREM)
 12560              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12561              MOVE ER-2633       TO WS-ERROR
 12562              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12563           END-IF
 12564        END-IF
 12565     END-IF
 12566     .
 12567 3140-CHECK-AH-FOR-ZERO.
 12568
 12569     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12570        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12571        PB-I-AH-PREMIUM-AMT = ZERO
 12572         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12573
 12574     IF PB-COMPANY-ID = 'CSL'  AND
 12575        PB-I-AH-BENEFIT-CD = ZERO  AND
 12576        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12577        PB-I-AH-PREMIUM-AMT = ZERO
 12578         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12579
 12580     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12581        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12582        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12583         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12584
 12585     IF PB-I-AH-BENEFIT-CD = ZERO
 12586         MOVE ER-2634            TO WS-ERROR
 12587         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12588
 12589******************************************************************
 12590*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 230
* EL050.cbl
 12591******************************************************************
 12592
 12593     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12594        NEXT SENTENCE
 12595     ELSE
 12596        IF PB-I-AH-BENEFIT-AMT = ZERO
 12597           MOVE ER-2635             TO WS-ERROR
 12598           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12599
 12600******************************************************************
 12601*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12602******************************************************************
 12603
 12604     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12605        NEXT SENTENCE
 12606     ELSE
 12607        IF PB-I-AH-PREMIUM-AMT = ZERO
 12608            IF NOT PB-COMP-AH-PREM
 12609                MOVE ER-2636    TO WS-ERROR
 12610                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12611
 12612
 12613 3140-EDIT-MAX-AMT-SIZES.
 12614* CUSTOM CODE FOR CLIENT    'DMD'
 12615     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12616                                     WS-RES-MUNI-TAX
 12617                                     PB-I-STATE-TAX
 12618                                     PB-I-MUNI-TAX.
 12619
 12620     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12621
 12622     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12623        GO TO 3150-RATE-OUTSTAND-BAL.
 12624
 12625     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12626        GO TO 3150-RATE-OUTSTAND-BAL.
 12627
 12628     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12629        GO TO 3150-RATE-OUTSTAND-BAL.
 12630
 12631     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12632                             OR 'RIC')
 12633        GO TO 3150-RATE-OUTSTAND-BAL.
 12634
 12635     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12636        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12637            GO TO 3150-RATE-OUTSTAND-BAL
 12638        ELSE
 12639           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12640               GO TO 3150-RATE-OUTSTAND-BAL.
 12641
 12642     IF NOT PB-NO-MONTHS-SKIPPED
 12643        GO TO 3150-RATE-OUTSTAND-BAL.
 12644
 12645     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12646        GO TO 3150-RATE-OUTSTAND-BAL.
 12647
 12648     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 231
* EL050.cbl
 12649        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12650           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12651             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12652           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12653           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12654              MOVE ER-2693     TO WS-ERROR
 12655              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12656              GO TO 3150-RATE-OUTSTAND-BAL
 12657           ELSE
 12658              GO TO 3150-RATE-OUTSTAND-BAL.
 12659
 12660 3150-RATE-OUTSTAND-BAL.
 12661
 12662* DMD RATING TEST
 12663     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12664         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12665         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12666         MOVE ER-2687                 TO WS-ERROR
 12667         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12668         MOVE 'B'                     TO PB-I-OB-FLAG
 12669         GO TO 3260-EDIT-CONTINUE.
 12670
 12671     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12672         IF  WS-ERROR    EQUAL    ER-2693
 12673             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12674                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12675                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12676                 MOVE  +0            TO  WS-ERROR.
 12677
 12678     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12679         IF  WS-ERROR    EQUAL    ER-2693
 12680             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12681                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12682                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12683                 MOVE  +0            TO  WS-ERROR.
 12684
 12685     IF PLAN-MASTER-AH-SW = 'Y'
 12686        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12687            IF  WS-ERROR    EQUAL    ER-2693
 12688              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12689                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12690                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12691                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12692                 MOVE  ER-1910           TO  WS-ERROR
 12693                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12694
 12695     IF PLAN-MASTER-AH-SW = 'Y'
 12696        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12697            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12698               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12699               MOVE  ER-1910           TO  WS-ERROR
 12700               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12701
 12702     IF PLAN-MASTER-AH-SW = 'Y'
 12703        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12704            IF  WS-ERROR    EQUAL    ER-2693
 12705                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12706                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 232
* EL050.cbl
 12707                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12708                 MOVE  +0       TO  WS-ERROR.
 12709
 12710     IF WS-ERROR = ER-2693
 12711        IF PB-COMPANY-ID = 'JAL' AND
 12712           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12713           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12714           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12715
 12716     IF WS-ERROR = ER-2693
 12717        IF PB-COMPANY-ID = 'NCL'  AND
 12718           PB-I-AH-BENEFIT-CD = 'OA'
 12719           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12720           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12721
 12722     IF WS-ERROR = ER-2693
 12723        IF PB-COMPANY-ID = 'CNL' AND
 12724           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12725           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12726           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12727
 12728     IF WS-ERROR = ER-2693
 12729        IF PB-COMPANY-ID = 'HER'
 12730           IF WS-LEVEL
 12731              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12732              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12733
 12734     IF ((LF-BENEFIT-FOUND) AND
 12735         (NOT NO-LIFE-COVERAGE)  AND
 12736         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12737       OR   ((AH-BENEFIT-FOUND) AND
 12738             (NOT NO-AH-COVERAGE)    AND
 12739             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12740         NEXT SENTENCE
 12741     ELSE
 12742         GO TO 3215-EDIT-RATES.
 12743
 12744     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12745        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12746           MOVE ER-2674          TO WS-ERROR
 12747           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12748           GO TO 3215-EDIT-RATES.
 12749
 12750     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12751        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12752           MOVE ER-2674          TO WS-ERROR
 12753           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12754           GO TO 3215-EDIT-RATES.
 12755
 12756     MOVE 'B'                    TO PB-I-OB-FLAG.
 12757
 12758     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12759         NEXT SENTENCE
 12760     ELSE
 12761         IF NOT NO-LIFE-COVERAGE
 12762             IF WS-ACCT-LF-OB-RT = ZERO
 12763                MOVE ER-2641    TO WS-ERROR
 12764                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 233
* EL050.cbl
 12765
 12766     IF PB-COMPANY-ID = 'CRI'
 12767       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12768         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12769         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12770         IF WS-ERROR = ER-2675
 12771            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12772            MOVE ER-2687              TO WS-ERROR
 12773            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12774         ELSE
 12775            MOVE ER-2687              TO WS-ERROR
 12776            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12777
 12778
 12779     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12780         NEXT SENTENCE
 12781     ELSE
 12782         IF NOT NO-AH-COVERAGE
 12783             IF WS-ACCT-AH-OB-RT = ZERO
 12784                MOVE ER-2642    TO WS-ERROR
 12785                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12786
 12787     IF PB-COMPANY-ID = 'CRI'
 12788       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12789         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12790         IF WS-ERROR = ER-2676
 12791            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12792            MOVE ER-2687              TO WS-ERROR
 12793            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12794         ELSE
 12795            MOVE ER-2687              TO WS-ERROR
 12796            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12797
 12798     IF PB-COMPANY-ID NOT = 'GIC'
 12799         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12800            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12801     ELSE
 12802         IF PB-I-LF-PREM-CALC = ZEROS
 12803             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12804                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12805
 12806     IF PB-COMPANY-ID NOT = 'GIC'
 12807         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12808            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12809     ELSE
 12810         IF PB-I-AH-PREM-CALC = ZEROS
 12811             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12812                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 12813
 12814     MOVE ZEROS TO PB-I-MORT-CODE.
 12815
 12816     GO TO 3260-EDIT-CONTINUE.
 12817
 12818
 12819 3215-EDIT-RATES.
 12820     IF ACCOUNT-MAST-FOUND
 12821         NEXT SENTENCE
 12822     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 234
* EL050.cbl
 12823         GO TO 3999-END-EDIT.
 12824
 12825 3220-CHECK-LF-RATES.
 12826
 12827     IF PB-COMPANY-ID = 'DCC'
 12828        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 12829        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 12830        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12831           AND (NOT WS-LF-CASH))
 12832                           OR
 12833           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12834           AND (NOT WS-AH-CASH)))
 12835                       AND
 12836           (PB-I-ENTRY-STATUS NOT = '5')
 12837           MOVE 'M'              TO PB-BATCH-ENTRY
 12838                                    PB-I-ENTRY-STATUS
 12839        END-IF
 12840     END-IF
 12841     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 12842                                    PB-I-AH-PREM-CALC
 12843                                    PB-I-LF-ALT-PREM-CALC
 12844                                    PB-I-LF-ALT-RATE
 12845                                    PB-I-LF-REI-RATE
 12846                                    PB-I-LF-ALT-REI-RATE
 12847                                    PB-I-AH-REI-RATE
 12848                                    PB-I-TOT-FEES-CALC.
 12849
 12850     IF PB-COMPANY-ID EQUAL 'DMD'
 12851        NEXT SENTENCE
 12852     ELSE
 12853        MOVE ZEROS               TO PB-I-LF-RATE
 12854                                    PB-I-AH-RATE.
 12855
 12856     IF PB-I-TOT-FEES NOT NUMERIC
 12857        MOVE ZEROS               TO PB-I-TOT-FEES
 12858     END-IF
 12859     IF PB-I-LIVES NOT NUMERIC
 12860         MOVE ZERO               TO PB-I-LIVES.
 12861
 12862     IF PB-I-NUM-BILLED NOT NUMERIC
 12863         MOVE ZERO               TO PB-I-NUM-BILLED.
 12864
 12865     IF PB-I-LF-PREM-TAX NOT NUMERIC
 12866        MOVE +0                  TO PB-I-LF-PREM-TAX
 12867     END-IF
 12868
 12869     IF PB-I-AH-PREM-TAX NOT NUMERIC
 12870        MOVE +0                  TO PB-I-AH-PREM-TAX
 12871     END-IF
 12872
 12873     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 12874        PB-I-PAY-FREQUENCY = ZEROS
 12875            MOVE 12 TO CP-PAY-FREQUENCY
 12876     ELSE
 12877            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 12878
 12879     IF PB-I-STATE-TAX NOT NUMERIC
 12880         MOVE ZEROS               TO PB-I-STATE-TAX.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 235
* EL050.cbl
 12881
 12882     IF PB-I-MUNI-TAX NOT NUMERIC
 12883         MOVE ZEROS               TO PB-I-MUNI-TAX.
 12884
 12885     MOVE SPACES                 TO CP-BEN-CATEGORY
 12886     IF PB-COMPANY-ID  = 'CSL'  AND
 12887        PB-I-LF-TERM NOT = ZERO
 12888        COMPUTE WS-PAYMENT-AMT =
 12889             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 12890        COMPUTE WS-CSL-AMT1 =
 12891             PB-I-LF-TERM * AM-MAX-MON-BEN
 12892        COMPUTE WS-CSL-AMT2 =
 12893             WS-PAYMENT-AMT * PB-I-LF-TERM
 12894        IF CP-PAY-FREQUENCY NOT = 12
 12895           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 12896           MOVE '8' TO WS-CSL-CALC-CD
 12897        ELSE
 12898           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 12899              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 12900               AM-MAX-TOT-BEN
 12901               MOVE '6' TO WS-CSL-CALC-CD
 12902           ELSE
 12903              IF (WS-CSL-AMT1  GREATER THAN
 12904                 AM-MAX-TOT-BEN) AND
 12905                 (WS-CSL-AMT2  GREATER THAN
 12906                 AM-MAX-TOT-BEN)
 12907                 MOVE '7' TO WS-CSL-CALC-CD
 12908              ELSE
 12909                 MOVE '5' TO WS-CSL-CALC-CD.
 12910
 12911     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 12912         NEXT SENTENCE
 12913     ELSE
 12914         GO TO 3300-CHECK-AH-RATES.
 12915
 12916*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 12917
 12918     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12919        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 12920              OR
 12921           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 12922           MOVE ER-2618          TO WS-ERROR
 12923           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12924           GO TO 3300-CHECK-AH-RATES.
 12925
 12926     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12927           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 12928                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 12929
 12930     IF WS-LF-SPECIAL-CALC-CD = 'M'
 12931         MOVE ER-2687             TO WS-ERROR
 12932         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12933         MOVE 'Z000'              TO PB-I-MORT-CODE
 12934         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 12935         GO TO 3300-CHECK-AH-RATES.
 12936
 12937     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 12938        IF PB-I-LIVES = ZERO
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 236
* EL050.cbl
 12939           MOVE ER-2688          TO WS-ERROR
 12940           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12941
 12942     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 12943
 12944     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 12945     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 12946     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 12947     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 12948     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 12949     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 12950     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12951     MOVE '3'                    TO CP-PROCESS-TYPE.
 12952     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 12953     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 12954
 12955******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 12956     IF PB-COMPANY-ID EQUAL 'CDL'
 12957         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 12958            CP-EARN-AS-NET-PAY)
 12959             IF PB-CERT-EFF-DT GREATER  WS-931231
 12960                 MOVE '1'        TO CP-EARNING-METHOD.
 12961*******
 12962
 12963     MOVE PB-SV-STATE            TO CP-STATE.
 12964     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 12965     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 12966     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 12967     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 12968     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 12969                                    CP-RATING-BENEFIT-AMT.
 12970     IF CP-STATE-STD-ABBRV = 'OR'
 12971         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 12972                                         PB-I-LF-ALT-BENEFIT-AMT.
 12973     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 12974     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 12975     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 12976     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12977     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 12978     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 12979     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 12980     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 12981     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 12982                                    CP-REMAINING-TERM
 12983                                    CP-LOAN-TERM.
 12984
 12985     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 12986         NEXT SENTENCE
 12987     ELSE
 12988         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 12989             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 12990                                           PB-I-LF-PREMIUM-AMT.
 12991
 12992     IF PB-COMPANY-ID EQUAL 'CSL'
 12993        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 12994           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 12995                                         PB-I-LF-PREMIUM-AMT.
 12996
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 237
* EL050.cbl
 12997     IF PB-COMPANY-ID EQUAL 'NCB'
 12998         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 12999            CP-EARN-AS-NET-PAY
 13000             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13001                 PB-I-LF-PREMIUM-AMT.
 13002
 13003     IF CP-TRUNCATED-LIFE
 13004        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13005
 13006     IF PB-COMPANY-ID EQUAL 'CRI'
 13007        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13008
 13009     IF CP-TERM-IS-DAYS
 13010         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13011     ELSE
 13012         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13013     IF PB-COMPANY-ID = 'DCC'
 13014        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13015        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13016        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13017        IF WS-LF-BEN-CATEGORY = 'D'
 13018           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13019           MOVE PB-I-LIFE-COMMISSION
 13020                                 TO CP-DCC-ACT-COMM
 13021           MOVE WS-LF-BEN-CATEGORY
 13022                                 TO CP-BEN-CATEGORY
 13023        END-IF
 13024        IF (CP-BENEFIT-CD (1:1) = 'P')
 13025           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13026           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13027        END-IF
 13028     END-IF
 13029     IF PB-COMPANY-ID = 'CSL'
 13030         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13031         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13032         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13033
 13034     IF PB-COMPANY-ID = 'CSL'
 13035        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13036
 13037     IF (CP-SPECIAL-CALC-CD = 'H')
 13038        OR (PB-COMPANY-ID = 'DCC')
 13039         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13040                                    TO CP-ALTERNATE-BENEFIT
 13041         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13042
 13043     IF (PB-COMPANY-ID = 'CID')
 13044        AND (WS-LF-EARNINGS-CALC = 'B')
 13045        AND (CP-STATE-STD-ABBRV = 'MN')
 13046        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13047                                 TO CP-ALTERNATE-BENEFIT
 13048        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13049     END-IF
 13050     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13051     MOVE 'R'                   TO CP-RATE-FILE.
 13052     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13053
 13054     IF CP-ERROR-RATE-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 238
* EL050.cbl
 13055        MOVE ER-2641            TO WS-ERROR
 13056        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13057        GO TO 3300-CHECK-AH-RATES.
 13058
 13059     IF PB-COMPANY-ID EQUAL 'CRI'
 13060        IF CP-ERROR-NO-LIMITS-CRI
 13061           IF NOT ACCOUNT-LIFE-CHECKED
 13062              MOVE ER-2607      TO WS-ERROR
 13063              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13064
 13065******************************************************************
 13066*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13067*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13068******************************************************************
 13069
 13070* CALC LIFE AGE AT EXPIRATION.
 13071
 13072     COMPUTE WS-AGE-AT-EXPIRE =
 13073          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13074
 13075*    IF PB-STATE = 'CO' OR 'UT'
 13076*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13077*        MOVE 'F'            TO PB-FATAL-FLAG
 13078*        MOVE ER-2709        TO WS-ERROR
 13079*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13080*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13081
 13082*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13083*        MOVE 'X'            TO PB-FATAL-FLAG
 13084*        MOVE ER-2718        TO WS-ERROR
 13085*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13086*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13087
 13088* CALC A & H AGE AT EXPIRATION.
 13089
 13090     COMPUTE WS-AGE-AT-EXPIRE =
 13091          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13092
 13093*    IF PB-STATE = 'CO' OR 'UT'
 13094*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13095*        MOVE 'F'            TO PB-FATAL-FLAG
 13096*        MOVE ER-2709        TO WS-ERROR
 13097*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13098*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13099
 13100*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13101*        MOVE 'X'            TO PB-FATAL-FLAG
 13102*        MOVE ER-2718        TO WS-ERROR
 13103*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13104*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13105
 13106     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13107        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13108
 13109     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13110        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13111
 13112     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 239
* EL050.cbl
 13113        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13114
 13115     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13116         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13117         MOVE ER-2639        TO WS-ERROR
 13118         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13119
 13120
 13121******************************************************************
 13122*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13123******************************************************************
 13124
 13125 PREMIUM-EDITING-IS-BYPASSED.
 13126     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13127        AND (CP-R-MAX-ATT-AGE > +0)
 13128        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13129        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13130           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13131           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13132           MOVE '1'              TO DC-OPTION-CODE
 13133           PERFORM 8500-DATE-CONVERT
 13134                                 THRU 8500-EXIT
 13135           IF NO-CONVERSION-ERROR
 13136              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13137                 MOVE ER-2661       TO WS-ERROR
 13138*                PERFORM 9900-ERROR-FORMAT
 13139*                                THRU 9900-EXIT
 13140              END-IF
 13141           END-IF
 13142        ELSE
 13143           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13144           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13145              MOVE ER-2661       TO WS-ERROR
 13146*             PERFORM 9900-ERROR-FORMAT
 13147*                                THRU 9900-EXIT
 13148           ELSE
 13149              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13150                 MOVE ER-1570    TO WS-ERROR
 13151                 PERFORM 9900-ERROR-FORMAT
 13152                                 THRU 9900-EXIT
 13153              END-IF
 13154           END-IF
 13155        END-IF
 13156        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13157           MOVE PB-I-JOINT-BIRTHDAY
 13158                                 TO DC-BIN-DATE-1
 13159           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13160           MOVE '1'              TO DC-OPTION-CODE
 13161           PERFORM 8500-DATE-CONVERT
 13162                                 THRU 8500-EXIT
 13163           IF NO-CONVERSION-ERROR
 13164              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13165                 MOVE ER-2661       TO WS-ERROR
 13166*                PERFORM 9900-ERROR-FORMAT
 13167*                                THRU 9900-EXIT
 13168              END-IF
 13169           ELSE
 13170              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 240
* EL050.cbl
 13171           END-IF
 13172        ELSE
 13173           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13174             (PB-I-LF-TERM / 12)
 13175           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13176              MOVE ER-2661       TO WS-ERROR
 13177*             PERFORM 9900-ERROR-FORMAT
 13178*                                THRU 9900-EXIT
 13179           ELSE
 13180              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13181                 MOVE ER-1571    TO WS-ERROR
 13182                 PERFORM 9900-ERROR-FORMAT
 13183                                 THRU 9900-EXIT
 13184              END-IF
 13185           END-IF
 13186        END-IF
 13187        IF WS-ERROR = ER-2661
 13188           PERFORM 9900-ERROR-FORMAT
 13189                                 THRU 9900-EXIT
 13190        END-IF
 13191     END-IF
 13192*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13193*       MOVE ER-2661             TO WS-ERROR
 13194*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13195
 13196     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13197        MOVE ER-2662             TO WS-ERROR
 13198        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13199
 13200     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13201        MOVE ER-2677             TO WS-ERROR
 13202        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13203
 13204     IF CP-ERROR-LOAN-TERM
 13205        MOVE ER-2648             TO WS-ERROR
 13206        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13207
 13208 3221-CHECK-ERROR-RATE-OPEN.
 13209
 13210     IF CP-ERROR-RATE-FILE-NOTOPEN
 13211         GO TO 3990-FILES-NOT-OPEN.
 13212
 13213     IF PB-COMPANY-ID NOT = 'DMD'
 13214        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13215     END-IF
 13216     .
 13217 3221-CONTINUE.
 13218     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13219                                    WS-DCC-AH-RATE
 13220     IF PB-COMPANY-ID = 'DCC'
 13221        IF WS-LF-BEN-CATEGORY = 'D'
 13222           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13223              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13224        END-IF
 13225     END-IF
 13226     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13227*   X'A4FF' = 12/31/2009
 13228     IF (PB-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 241
* EL050.cbl
 13229        AND (WS-LF-EARNINGS-CALC = 'B')
 13230        AND (CP-STATE-STD-ABBRV = 'MN')
 13231        AND (PB-CERT-EFF-DT > X'A4FF')
 13232        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13233     END-IF
 13234     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13235
 13236     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13237     IF (PB-COMPANY-ID = 'DCC')
 13238        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13239        AND (PB-I-POLICY-IS-MONTHLY)
 13240        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13241        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13242     END-IF
 13243     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13244     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13245     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13246     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13247     IF (PB-COMPANY-ID = 'DCC')
 13248        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13249        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13250        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13251        MOVE ER-2786             TO WS-ERROR
 13252        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13253     END-IF
 13254
 13255     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13256
 13257******************************************************************
 13258*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13259******************************************************************
 13260     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13261        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13262
 13263     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13264        GO TO 3225-CHECK-ALT-LIFE-RATE
 13265     ELSE
 13266       IF PB-I-LF-RATE = ZERO
 13267          MOVE ER-2641          TO WS-ERROR
 13268          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13269
 13270 3225-CHECK-ALT-LIFE-RATE.
 13271
 13272     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13273        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13274        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13275         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13276
 13277     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13278         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13279             AND PB-COMPANY-ID NOT = 'DCC')
 13280                   OR
 13281              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13282              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13283              AND PB-COMPANY-ID NOT = 'DCC')
 13284             MOVE ER-2720        TO  WS-ERROR
 13285             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13286             GO TO 3225-RATING-CONT
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 242
* EL050.cbl
 13287         ELSE
 13288             GO TO 3225-RATING-CONT.
 13289     IF (PB-COMPANY-ID = 'CID')
 13290        AND (AM-GPCD = 01 OR 06 OR 15)
 13291        MOVE ER-2798             TO WS-ERROR
 13292        PERFORM 9900-ERROR-FORMAT
 13293                                 THRU 9900-EXIT
 13294*       GO TO 3225-RATING-CONT
 13295     END-IF
 13296     IF (PB-COMPANY-ID = 'CID')
 13297        AND (WS-LF-EARNINGS-CALC = 'B')
 13298        AND (CP-STATE-STD-ABBRV = 'MN')
 13299        AND (PB-CERT-EFF-DT > X'A4FF')
 13300        GO TO 3225-RATING-CONT
 13301     END-IF
 13302     IF PB-COMPANY-ID = 'DCC'
 13303        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13304           AND (PB-I-POLICY-IS-MONTHLY)
 13305           GO TO 3225-RATING-CONT
 13306        END-IF
 13307     END-IF
 13308
 13309     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13310        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13311        CP-EARN-AS-REG-BALLOON
 13312        NEXT SENTENCE
 13313     ELSE
 13314        MOVE '2'                 TO CP-EARNING-METHOD.
 13315
 13316 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13317
 13318     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13319
 13320     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13321        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13322        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13323         NEXT SENTENCE
 13324     ELSE
 13325         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13326
 13327     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13328     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13329     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13330                                     CP-RATING-BENEFIT-AMT.
 13331     IF CP-STATE-STD-ABBRV = 'OR'
 13332         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13333                                         PB-I-LF-ALT-BENEFIT-AMT.
 13334     IF PB-COMPANY-ID = 'DCC'
 13335        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13336     END-IF
 13337     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13338     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13339     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13340                                    CP-REMAINING-TERM
 13341                                    CP-LOAN-TERM.
 13342     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13343        ADD +1                   TO CP-ORIGINAL-TERM
 13344                                    CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 243
* EL050.cbl
 13345                                    CP-LOAN-TERM.
 13346
 13347     MOVE 'R'                   TO CP-RATE-FILE.
 13348     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13349
 13350     IF CP-ERROR-RATE-NOT-FOUND
 13351         MOVE ER-2641            TO WS-ERROR
 13352         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13353         GO TO 3300-CHECK-AH-RATES.
 13354
 13355     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13356     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13357
 13358     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13359         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13360
 13361     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13362                               + PB-I-LF-ALT-BENEFIT-AMT.
 13363
 13364     IF ACCOUNT-LIFE-CHECKED  OR
 13365        PB-POLICY-IS-VOIDED   OR
 13366        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13367        GO TO 3225-CONTINUE.
 13368
 13369     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13370        GO TO 3225-CONTINUE.
 13371
 13372     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13373                             EC-RT-LF-MAX-TOT-BEN
 13374        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13375        MOVE ER-2639       TO WS-ERROR
 13376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13377
 13378 3225-CONTINUE.
 13379     IF PB-I-LF-ALT-RATE = ZERO
 13380         MOVE ER-2659            TO WS-ERROR
 13381         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13382
 13383     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13384        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13385        MOVE ER-2698             TO WS-ERROR
 13386        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13387
 13388 3225-RATING-CONT.
 13389
 13390     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13391         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13392         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13393         MOVE ER-2687             TO WS-ERROR
 13394         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13395         GO TO 3290-EDIT-LF-REIN-RATE.
 13396
 13397* DMD RATING TEST
 13398     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13399         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13400         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13401         MOVE ER-2687                 TO WS-ERROR
 13402         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 244
* EL050.cbl
 13403         GO TO 3290-EDIT-LF-REIN-RATE.
 13404
 13405 3230-CLIENT-MORT-CD-SPECIALS.
 13406
 13407     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13408     SET BIN-TO-GREG          TO TRUE.
 13409*    MOVE ' '                 TO DC-OPTION-CODE.
 13410     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13411     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13412
 13413 C-POS-3230-MORT-CD.
 13414     IF PB-COMPANY-ID = 'POS' AND
 13415        PB-SV-CARRIER = '2'
 13416         NEXT SENTENCE
 13417     ELSE
 13418         GO TO C-POS-3240-MORT-CD.
 13419
 13420     IF PB-SV-GROUPING = '030'
 13421        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13422         MOVE '2350' TO PB-I-MORT-CODE
 13423      ELSE
 13424         MOVE '3300' TO PB-I-MORT-CODE.
 13425
 13426
 13427 C-POS-3240-MORT-CD.
 13428     IF PB-COMPANY-ID = 'POS' AND
 13429        PB-SV-CARRIER = '1'
 13430         NEXT SENTENCE
 13431     ELSE
 13432         GO TO 3230-CONTINUE.
 13433
 13434     IF PB-SV-STATE = '45' OR '47'
 13435        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13436         MOVE '5200' TO PB-I-MORT-CODE
 13437     ELSE
 13438         MOVE '8300' TO PB-I-MORT-CODE.
 13439
 13440 3230-CONTINUE.
 13441
 13442     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13443        GO TO 3240-CONTINUE
 13444     END-IF
 13445
 13446     IF PB-CERT-EFF-DT > WS-971231
 13447        GO TO 3240-CONTINUE
 13448     END-IF
 13449
 13450     IF LF-BENEFIT-FOUND AND
 13451        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13452         MOVE 'F250'       TO PB-I-MORT-CODE
 13453     ELSE
 13454         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13455             MOVE '7250'   TO PB-I-MORT-CODE
 13456         ELSE
 13457             MOVE '4251'   TO PB-I-MORT-CODE
 13458         END-IF
 13459     END-IF
 13460
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 245
* EL050.cbl
 13461     .
 13462 3240-CONTINUE.
 13463
 13464     IF PB-COMPANY-ID NOT = 'GNL'
 13465         GO TO 3256-CONTINUE.
 13466
 13467     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13468         MOVE 'A300' TO PB-I-MORT-CODE
 13469     ELSE
 13470         MOVE '8350' TO PB-I-MORT-CODE.
 13471
 13472 3256-CONTINUE.
 13473     IF PB-COMPANY-ID NOT = 'ABL'
 13474         GO TO 3260-EDIT-CONTINUE.
 13475
 13476     IF PB-I-LF-TERM GREATER THAN 59
 13477         MOVE 'F550' TO PB-I-MORT-CODE
 13478     ELSE
 13479         MOVE 'E550' TO PB-I-MORT-CODE.
 13480
 13481 3260-EDIT-CONTINUE.
 13482     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13483
 13484 3290-EDIT-LF-REIN-RATE.
 13485     IF LF-REIN-NSP-NOT-USED
 13486         GO TO 3290-RATING-CONT.
 13487
 13488     IF PB-COMPANY-ID = 'DCC'
 13489        GO TO 3290-RATING-CONT.
 13490     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13491     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13492     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13493     MOVE '3'                   TO CP-PROCESS-TYPE.
 13494     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13495
 13496******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13497     IF PB-COMPANY-ID EQUAL 'CDL'
 13498         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13499            CP-EARN-AS-NET-PAY)
 13500             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13501*            MOVE SPACE          TO DC-OPTION-CODE
 13502             SET BIN-TO-GREG     TO TRUE
 13503             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13504***  Y2K PROJ 7744
 13505             IF DC-GREG-DATE-CYMD GREATER 19931231
 13506                 MOVE '1'        TO CP-EARNING-METHOD.
 13507***  Y2K PROJ 7744
 13508*******
 13509
 13510     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13511     MOVE PB-SV-STATE           TO CP-STATE.
 13512     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13513     MOVE ZERO                  TO CP-DEVIATION-CODE
 13514                                   CP-RATE-DEV-PCT.
 13515     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13516     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13517                                   CP-RATING-BENEFIT-AMT.
 13518
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 246
* EL050.cbl
 13519************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13520     IF PB-COMPANY-ID EQUAL 'NCB'
 13521         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13522            CP-EARN-AS-NET-PAY
 13523             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13524                 PB-I-LF-PREMIUM-AMT.
 13525************
 13526
 13527     IF CP-STATE-STD-ABBRV = 'OR'
 13528         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13529                                         PB-I-LF-ALT-BENEFIT-AMT.
 13530     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13531     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13532     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13533     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13534     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13535     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13536     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13537     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13538                                   CP-REMAINING-TERM
 13539                                   CP-LOAN-TERM.
 13540     IF CP-TRUNCATED-LIFE
 13541        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13542
 13543     IF CP-TERM-IS-DAYS
 13544         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13545     ELSE
 13546         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13547
 13548     IF PB-COMPANY-ID = 'DCC'
 13549        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13550     END-IF
 13551     IF PB-COMPANY-ID NOT = 'TIC'
 13552          MOVE ZERO          TO CP-CLASS-CODE.
 13553
 13554     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13555
 13556     MOVE 'R'                   TO CP-RATE-FILE.
 13557     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13558
 13559     IF CP-ERROR-RATE-NOT-FOUND
 13560        IF PB-I-OB
 13561           MOVE ER-2625      TO WS-ERROR
 13562           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13563           GO TO 3299-EDIT-CONTINUE
 13564        ELSE
 13565           MOVE ER-2643      TO WS-ERROR
 13566           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13567           GO TO 3299-EDIT-CONTINUE.
 13568
 13569     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13570
 13571     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13572     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13573
 13574     IF PB-I-LF-REI-RATE = ZERO
 13575         MOVE ER-2643        TO WS-ERROR
 13576         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 247
* EL050.cbl
 13577
 13578 3290-CHECK-ALT-REIN-RATE.
 13579
 13580     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13581        GO TO 3290-RATING-CONT.
 13582
 13583     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13584     MOVE '2'                    TO CP-EARNING-METHOD.
 13585     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13586     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13587     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13588     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13589                                     CP-RATING-BENEFIT-AMT.
 13590     IF CP-STATE-STD-ABBRV = 'OR'
 13591         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13592                                         PB-I-LF-ALT-BENEFIT-AMT.
 13593     IF PB-COMPANY-ID = 'DCC'
 13594        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13595     END-IF
 13596     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13597     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13598     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13599                                    CP-REMAINING-TERM
 13600                                    CP-LOAN-TERM.
 13601     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13602        ADD +1                   TO CP-ORIGINAL-TERM
 13603                                    CP-REMAINING-TERM
 13604                                    CP-LOAN-TERM.
 13605
 13606     MOVE 'R'                   TO CP-RATE-FILE.
 13607     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13608
 13609     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13610
 13611     IF PB-I-LF-ALT-REI-RATE = ZERO
 13612         MOVE ER-2643            TO WS-ERROR
 13613         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13614
 13615 3290-RATING-CONT.
 13616
 13617     IF PB-I-OB
 13618*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13619        GO TO 3300-CHECK-AH-RATES.
 13620
 13621 3299-EDIT-CONTINUE.
 13622
 13623     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13624         NEXT SENTENCE
 13625     ELSE
 13626         MOVE ER-2620           TO WS-ERROR
 13627         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13628
 13629 3300-CHECK-AH-RATES.
 13630     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13631         NEXT SENTENCE
 13632     ELSE
 13633         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13634
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 248
* EL050.cbl
 13635     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13636        ((CF-COMPANY-ID = 'DMD') AND
 13637                (NO-DMD-RATING))
 13638         MOVE ER-2687             TO WS-ERROR
 13639         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13640         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13641         GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13642
 13643     IF PB-I-OB
 13644        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13645
 13646     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13647         MOVE ER-2687             TO WS-ERROR
 13648         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13649         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13650         GO TO 3999-END-EDIT.
 13651
 13652*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13653
 13654     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13655        IF PB-I-AH-CRIT-PER = ZERO
 13656           IF PB-COMPANY-ID = 'DCC'
 13657              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13658              CONTINUE
 13659           ELSE
 13660              MOVE ER-2618       TO WS-ERROR
 13661              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13662              GO TO 3999-END-EDIT
 13663           END-IF
 13664        END-IF
 13665     END-IF
 13666     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13667     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13668     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13669     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13670     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13671     MOVE PB-SV-STATE            TO CP-STATE.
 13672     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13673     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13674     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13675*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13676     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13677     MOVE '3'                    TO CP-PROCESS-TYPE.
 13678     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13679     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13680                                    CP-RATING-BENEFIT-AMT.
 13681     IF PB-COMPANY-ID = 'CID'
 13682               OR
 13683        CP-STATE-STD-ABBRV = 'OR'
 13684         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13685                                         PB-I-AH-TERM.
 13686     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13687        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13688           AND (PB-I-POLICY-IS-MONTHLY)
 13689           MOVE PB-I-LF-BENEFIT-AMT
 13690                                 TO CP-NET-BENEFIT-AMT
 13691           move pb-i-ah-premium-amt to cp-original-premium
 13692        END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 249
* EL050.cbl
 13693     END-IF
 13694     MOVE SPACES                 TO CP-BEN-CATEGORY
 13695     IF PB-COMPANY-ID = 'DCC'
 13696        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13697        EVALUATE TRUE
 13698           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13699              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13700              MOVE PB-I-LF-BENEFIT-AMT
 13701                                 TO CP-RATING-BENEFIT-AMT
 13702              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13703           WHEN WS-AH-BEN-CATEGORY = 'G'
 13704              MOVE PB-I-UNPAID-CASH-PRICE
 13705                                 TO CP-RATING-BENEFIT-AMT
 13706           WHEN WS-AH-BEN-CATEGORY = 'D'
 13707              MOVE WS-AH-PMF-COMM
 13708                                 TO CP-DCC-PMF-COMM
 13709              MOVE PB-I-AH-COMMISSION
 13710                                 TO CP-DCC-ACT-COMM
 13711        END-EVALUATE
 13712     END-IF
 13713     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13714     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13715     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13716     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13717     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13718     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13719     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13720                                    CP-REMAINING-TERM
 13721                                    WS-WORK-TERM.
 13722     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13723
 13724     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13725     SET BIN-TO-GREG             TO TRUE.
 13726*    MOVE ' '                    TO DC-OPTION-CODE.
 13727     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13728     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13729
 13730     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13731     IF NOT VALID-SKIP-CODE
 13732         MOVE ER-2683            TO WS-ERROR
 13733         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13734         GO TO 3320-RATE-CONTINUE.
 13735
 13736     IF PB-NO-MONTHS-SKIPPED
 13737         GO TO 3320-RATE-CONTINUE.
 13738
 13739     MOVE SPACE TO NUMBER-OF-MONTHS.
 13740
 13741     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13742         MOVE 'S'                TO SK-MO (6).
 13743     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13744         MOVE 'S'                TO SK-MO (7).
 13745     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13746         MOVE 'S'                TO SK-MO (8).
 13747     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13748         MOVE 'S'                TO SK-MO (9).
 13749     IF PB-I-SKIP-CODE = 'A'
 13750         MOVE 'S'                TO SK-MO (10).
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 250
* EL050.cbl
 13751
 13752     MOVE 1                      TO SUB2.
 13753     MOVE PB-I-AH-TERM           TO SUB3.
 13754     MOVE WS-MONTH               TO SUB1.
 13755     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13756     GO TO 3320-RATE-CONTINUE.
 13757
 13758 3310-GET-SKIP-MO.
 13759     IF SUB1 = 13
 13760         MOVE 1                  TO SUB1.
 13761
 13762     IF SK-MO (SUB1) = 'S'
 13763         SUBTRACT 1 FROM WS-WORK-TERM.
 13764
 13765     ADD 1 TO SUB2
 13766              SUB1.
 13767
 13768 3320-RATE-CONTINUE.
 13769
 13770     IF WS-WORK-TERM = ZERO
 13771         MOVE 1                  TO WS-WORK-TERM.
 13772
 13773     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13774                                    CP-LOAN-TERM.
 13775
 13776     IF PB-COMPANY-ID EQUAL 'DMD'
 13777         NEXT SENTENCE
 13778     ELSE
 13779         MOVE ZERO               TO PB-I-AH-RATE
 13780                                    PB-I-AH-REI-RATE.
 13781
 13782
 13783     IF PB-COMPANY-ID EQUAL 'CRI'
 13784        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13785
 13786     IF PB-COMPANY-ID = 'CSL'
 13787         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13788         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13789         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13790         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13791
 13792     IF PB-COMPANY-ID = 'DCC'
 13793        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13794           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13795              PB-I-RATE-DEV-PCT-LF
 13796        END-IF
 13797        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13798                                 TO CP-ALTERNATE-BENEFIT
 13799        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13800        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13801        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13802     END-IF
 13803     IF (PB-COMPANY-ID = 'CID')
 13804        AND (WS-LF-EARNINGS-CALC = 'B')
 13805        AND (CP-STATE-STD-ABBRV = 'MN')
 13806        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 13807     ELSE
 13808        MOVE ' '                 TO CP-AH-BALLOON-SW
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 251
* EL050.cbl
 13809     END-IF
 13810     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 13811     MOVE 'R'                   TO CP-RATE-FILE.
 13812     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13813
 13814     IF CP-ERROR-RATE-NOT-FOUND
 13815        IF PB-I-OB
 13816           MOVE ER-2624          TO WS-ERROR
 13817           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13818           GO TO 3340-CALCULATE-PREMIUM-AMT
 13819        ELSE
 13820           MOVE ER-2642          TO WS-ERROR
 13821           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13822           GO TO 3340-CALCULATE-PREMIUM-AMT.
 13823
 13824     IF PB-COMPANY-ID EQUAL 'CSL' AND
 13825        CP-ERROR-DIV-BY-ZERO
 13826           MOVE ER-3782          TO WS-ERROR
 13827           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13828
 13829     IF PB-COMPANY-ID EQUAL 'CRI'
 13830        IF CP-ERROR-NO-LIMITS-CRI
 13831           IF NOT ACCOUNT-AH-CHECKED
 13832              MOVE ER-2607          TO WS-ERROR
 13833              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13834
 13835     IF ACCOUNT-AH-CHECKED
 13836        NEXT SENTENCE
 13837     ELSE
 13838       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13839          MOVE ER-2640           TO WS-ERROR
 13840          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13841
 13842     IF PB-COMPANY-ID = 'CRI'
 13843         IF WS-ERROR = ER-2640
 13844             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13845     IF ACCOUNT-AH-CHECKED
 13846        CONTINUE
 13847     ELSE
 13848        IF (CP-R-MAX-ATT-AGE NUMERIC)
 13849           AND (CP-R-MAX-ATT-AGE > +0)
 13850           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 13851           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 13852              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 13853              MOVE PB-I-AH-EXPIRE-DT
 13854                                 TO DC-BIN-DATE-2
 13855              MOVE '1'           TO DC-OPTION-CODE
 13856              PERFORM 8500-DATE-CONVERT
 13857                                 THRU 8500-EXIT
 13858              IF NO-CONVERSION-ERROR
 13859                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13860                    MOVE ER-2661       TO WS-ERROR
 13861*                   PERFORM 9900-ERROR-FORMAT
 13862*                                THRU 9900-EXIT
 13863                 END-IF
 13864              END-IF
 13865           ELSE
 13866              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 252
* EL050.cbl
 13867              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13868                 MOVE ER-2661    TO WS-ERROR
 13869*                PERFORM 9900-ERROR-FORMAT
 13870*                                THRU 9900-EXIT
 13871              ELSE
 13872                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13873                    MOVE ER-1570 TO WS-ERROR
 13874                    PERFORM 9900-ERROR-FORMAT
 13875                                 THRU 9900-EXIT
 13876                 END-IF
 13877              END-IF
 13878           END-IF
 13879           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13880              MOVE PB-I-JOINT-BIRTHDAY
 13881                                    TO DC-BIN-DATE-1
 13882              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 13883              MOVE '1'              TO DC-OPTION-CODE
 13884              PERFORM 8500-DATE-CONVERT
 13885                                    THRU 8500-EXIT
 13886              IF NO-CONVERSION-ERROR
 13887                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13888                    MOVE ER-2661       TO WS-ERROR
 13889*                   PERFORM 9900-ERROR-FORMAT
 13890*                                   THRU 9900-EXIT
 13891                 END-IF
 13892              END-IF
 13893           ELSE
 13894              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13895                (PB-I-AH-TERM / 12)
 13896              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13897                 MOVE ER-2661       TO WS-ERROR
 13898*                PERFORM 9900-ERROR-FORMAT
 13899*                                   THRU 9900-EXIT
 13900              ELSE
 13901                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13902                    MOVE ER-1571 TO WS-ERROR
 13903                    PERFORM 9900-ERROR-FORMAT
 13904                                 THRU 9900-EXIT
 13905                 END-IF
 13906              END-IF
 13907           END-IF
 13908           IF WS-ERROR = ER-2661
 13909              PERFORM 9900-ERROR-FORMAT
 13910                                    THRU 9900-EXIT
 13911           END-IF
 13912        END-IF
 13913     END-IF
 13914*    IF ACCOUNT-AH-CHECKED
 13915*       NEXT SENTENCE
 13916*    ELSE
 13917*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13918*          MOVE ER-2661          TO WS-ERROR
 13919*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13920
 13921     IF ACCOUNT-AH-CHECKED
 13922        NEXT SENTENCE
 13923     ELSE
 13924        IF CP-ERROR-AGE-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 253
* EL050.cbl
 13925           MOVE ER-2663          TO WS-ERROR
 13926           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13927
 13928     IF ACCOUNT-AH-CHECKED OR
 13929        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 13930         PB-POLICY-IS-VOIDED
 13931        NEXT SENTENCE
 13932     ELSE
 13933        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 13934           MOVE ER-2667            TO WS-ERROR
 13935           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13936
 13937     IF PB-COMPANY-ID = 'CRI'
 13938         IF WS-ERROR = ER-2667
 13939             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13940
 13941     IF ACCOUNT-AH-CHECKED
 13942        NEXT SENTENCE
 13943     ELSE
 13944        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13945           MOVE ER-2678            TO WS-ERROR
 13946           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13947
 13948     IF CP-ERROR-RATE-FILE-NOTOPEN
 13949         GO TO 3990-FILES-NOT-OPEN.
 13950
 13951 3321-CONTINUE.
 13952     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 13953     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 13954     IF (PB-COMPANY-ID = 'DCC')
 13955        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 13956        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 13957                                    PB-I-LF-ALT-PREM-CALC
 13958        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13959        IF WS-AH-BEN-CATEGORY = 'G'
 13960           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13961           + PB-I-ADDL-CLP)
 13962           * (1 + WS-TOL-CLP-PCT)
 13963*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 13964        ELSE
 13965           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13966           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 13967*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 13968        END-IF
 13969        MOVE WS-TOL-LF-HIGH-PREM-AMT
 13970                                 TO PB-I-AH-PREM-CALC
 13971        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 13972           MOVE ER-8152          TO WS-ERROR
 13973           PERFORM 9900-ERROR-FORMAT
 13974                                 THRU 9900-EXIT
 13975        ELSE
 13976           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 13977                 PB-I-ADDL-CLP)
 13978              MOVE ER-8148       TO WS-ERROR
 13979              PERFORM 9900-ERROR-FORMAT
 13980                                 THRU 9900-EXIT
 13981           END-IF
 13982        END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 254
* EL050.cbl
 13983     END-IF
 13984     IF (PB-COMPANY-ID = 'DCC')
 13985        AND (PB-I-POLICY-IS-MONTHLY)
 13986        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 13987        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 13988        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 13989           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 13990        END-IF
 13991     END-IF
 13992     IF (PB-COMPANY-ID = 'DCC')
 13993        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 13994        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13995        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 13996        MOVE ER-2786             TO WS-ERROR
 13997        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13998     END-IF
 13999     MOVE +0                     TO PB-I-AH-CLP
 14000     IF PB-COMPANY-ID = 'DCC'
 14001        IF WS-AH-BEN-CATEGORY = 'D'
 14002           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14003              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14004        ELSE
 14005           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14006              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14007           END-IF
 14008        END-IF
 14009     END-IF
 14010     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14011
 14012     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14013         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14014
 14015     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14016         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14017
 14018     IF PB-COMPANY-ID = 'CRI'
 14019         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14020            PB-I-PAYMENT-AMOUNT = ZERO
 14021             NEXT SENTENCE
 14022         ELSE
 14023             COMPUTE PB-I-AH-PREM-CALC =
 14024                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14025                 (CP-PREMIUM-RATE / 100)
 14026             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14027                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14028                                             PB-I-RATE-DEV-PCT-AH.
 14029
 14030     IF PB-I-AH-RATE  = ZERO
 14031         MOVE ER-2642            TO WS-ERROR
 14032         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14033
 14034     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14035     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14036     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14037     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14038     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14039     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14040
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 255
* EL050.cbl
 14041     IF (PB-COMPANY-ID = 'DCC')
 14042        AND (WS-AH-BEN-CATEGORY = 'G')
 14043        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14044        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14045        IF CP-DEVIATION-CODE NOT = '000'
 14046           MOVE '000'            TO CP-DEVIATION-CODE
 14047           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14048           IF NO-CP-ERROR
 14049              COMPUTE PB-I-DDF-IU-RATE-UP =
 14050              PB-I-AH-CLP - CP-CALC-PREMIUM
 14051           ELSE
 14052              MOVE ER-3057        TO WS-ERROR
 14053              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14054           END-IF
 14055        END-IF
 14056     END-IF
 14057     .
 14058 3335-EDIT-AH-REIN-NSP-RATE.
 14059     IF AH-REIN-NSP-NOT-USED
 14060         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14061
 14062     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14063     IF PB-COMPANY-ID = 'DCC'
 14064         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14065     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14066     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14067     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14068     MOVE PB-SV-STATE            TO CP-STATE.
 14069     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14070     MOVE ZERO                   TO CP-DEVIATION-CODE
 14071                                    CP-RATE-DEV-PCT.
 14072*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14073     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14074     MOVE '3'                    TO CP-PROCESS-TYPE.
 14075     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14076     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14077                                    CP-RATING-BENEFIT-AMT.
 14078     IF CP-STATE-STD-ABBRV = 'OR'
 14079         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14080                                         PB-I-AH-TERM.
 14081     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14082     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14083     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14084     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14085     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14086     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14087                                    CP-REMAINING-TERM
 14088                                    WS-WORK-TERM.
 14089     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14090     IF PB-COMPANY-ID = 'DCC'
 14091        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14092     END-IF
 14093     IF  PB-COMPANY-ID = 'TIC'
 14094         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14095            MOVE ZERO TO CP-CLASS-CODE.
 14096
 14097     IF PB-COMPANY-ID NOT = 'TIC'
 14098          MOVE ZERO          TO CP-CLASS-CODE.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 256
* EL050.cbl
 14099
 14100     MOVE ZERO               TO CP-DEVIATION-CODE.
 14101
 14102     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14103
 14104     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14105
 14106     MOVE 'R'                   TO CP-RATE-FILE.
 14107     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14108
 14109     IF CP-ERROR-RATE-NOT-FOUND
 14110         MOVE ER-2645        TO WS-ERROR
 14111         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14112         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14113
 14114     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14115
 14116     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14117     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14118
 14119     IF PB-I-AH-REI-RATE = ZERO
 14120         MOVE ER-2645        TO WS-ERROR
 14121         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14122
 14123
 14124 3340-CALCULATE-PREMIUM-AMT.
 14125
 14126     IF PB-COMPANY-ID = 'NCL'
 14127         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14128             WS-AH-SPECIAL-CALC-CD = 'O')
 14129             GO TO 3999-END-EDIT.
 14130
 14131     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14132                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14133                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14134         NEXT SENTENCE
 14135     ELSE
 14136         IF WS-STATE-ABBREVIATION = 'CT'
 14137             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14138                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14139                 COMPUTE PB-I-LF-PREM-CALC =
 14140                                     PB-I-LF-PREM-CALC * .90
 14141                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14142                                     PB-I-LF-ALT-PREM-CALC * .90
 14143                 COMPUTE PB-I-AH-PREM-CALC =
 14144                                     PB-I-AH-PREM-CALC * .90.
 14145
 14146     IF PB-COMP-LF-PREM
 14147        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14148        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14149
 14150     IF PB-COMP-AH-PREM
 14151        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14152
 14153 3340-CHECK-DCC-TOT-FEES.
 14154     IF (PB-COMPANY-ID = 'DCC')
 14155        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14156        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 257
* EL050.cbl
 14157        AND (PB-I-POLICY-IS-MONTHLY)
 14158        CONTINUE
 14159     ELSE
 14160        GO TO 3340-EDIT-LF-AH-TOL
 14161     END-IF
 14162     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14163     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14164     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14165        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14166           PB-I-RATE-DEV-PCT-LF
 14167     END-IF
 14168     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14169        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14170           PB-I-RATE-DEV-PCT-AH
 14171     END-IF
 14172     MOVE 'N'                    TO CP-BEN-CATEGORY
 14173     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14174
 14175     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14176     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14177     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14178     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14179     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14180     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14181     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14182     MOVE '3'                    TO CP-PROCESS-TYPE.
 14183     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14184     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14185
 14186     MOVE PB-SV-STATE            TO CP-STATE.
 14187     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14188     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14189     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14190     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14191     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14192                                    CP-RATING-BENEFIT-AMT.
 14193     IF CP-STATE-STD-ABBRV = 'OR'
 14194         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14195                                         PB-I-LF-ALT-BENEFIT-AMT.
 14196     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14197     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14198     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14199     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14200     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14201     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14202     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14203     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14204     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14205                                    CP-REMAINING-TERM
 14206                                    CP-LOAN-TERM.
 14207
 14208     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14209         NEXT SENTENCE
 14210     ELSE
 14211         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14212             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14213                                           PB-I-LF-PREMIUM-AMT.
 14214
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 258
* EL050.cbl
 14215     IF CP-TRUNCATED-LIFE
 14216        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14217
 14218     IF CP-TERM-IS-DAYS
 14219         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14220     ELSE
 14221         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14222
 14223     IF PB-COMPANY-ID = 'DCC'
 14224        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14225     END-IF
 14226     IF CP-SPECIAL-CALC-CD = 'H'
 14227         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14228                                    TO CP-ALTERNATE-BENEFIT
 14229         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14230     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14231     MOVE 'R'                    TO CP-RATE-FILE
 14232     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14233     IF NOT CP-ERROR-RATE-NOT-FOUND
 14234        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14235        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14236           AND (CP-BENEFIT-CD (1:1) = 'S')
 14237           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14238                                    PB-I-LF-PREMIUM-AMT
 14239        END-IF
 14240     ELSE
 14241        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14242     END-IF
 14243     .
 14244 3340-EDIT-LF-AH-TOL.
 14245
 14246***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14247***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14248***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14249***
 14250     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14251         PB-I-AH-PREMIUM-AMT
 14252          GIVING WS-CALC-WORK.
 14253
 14254     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14255        AND WS-CALC-WORK NOT = ZERO
 14256         MOVE ER-2649            TO WS-ERROR
 14257         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14258
 14259     SUBTRACT PB-I-LF-PREM-CALC
 14260             FROM PB-I-LF-PREMIUM-AMT
 14261                 GIVING WS-UNSIGN-WRK1.
 14262
 14263     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14264             FROM PB-I-LF-ALT-PREMIUM-AMT
 14265                 GIVING WS-UNSIGN-WRK4.
 14266
 14267     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14268                                + WS-UNSIGN-WRK4.
 14269
 14270     SUBTRACT PB-I-AH-PREM-CALC
 14271             FROM PB-I-AH-PREMIUM-AMT
 14272                 GIVING WS-UNSIGN-WRK2.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 259
* EL050.cbl
 14273
 14274******************************************************************
 14275*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14276******************************************************************
 14277
 14278     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14279         MOVE ZERO TO WS-UNSIGN-WRK1.
 14280
 14281     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14282         MOVE ZERO TO WS-UNSIGN-WRK2.
 14283
 14284     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14285             GIVING WS-UNSIGN-WRK3.
 14286
 14287 3342-CONTINUE.
 14288
 14289     IF (PB-I-LF-RATE = ZERO  AND
 14290         PB-I-AH-RATE = ZERO)
 14291         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14292            WS-AH-SPECIAL-CALC-CD = 'O'
 14293              NEXT SENTENCE
 14294         ELSE
 14295             GO TO 3345-EDIT-CONTINUE.
 14296
 14297     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14298         NEXT SENTENCE
 14299     ELSE
 14300     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14301        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14302           IF (PB-REISSUED-CERT         OR
 14303               PB-POLICY-IS-DECLINED    OR
 14304               PB-POLICY-IS-VOIDED)
 14305              NEXT SENTENCE
 14306           ELSE
 14307              IF WS-PREM-REJECT-SW = SPACE
 14308                 MOVE ER-2652    TO WS-ERROR
 14309                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14310                 GO TO 3344-CHECK-AH
 14311              ELSE
 14312                 MOVE ER-2650    TO WS-ERROR
 14313                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14314                 GO TO 3344-CHECK-AH.
 14315
 14316***
 14317***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14318***
 14319
 14320     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14321         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14322            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14323             (1 + WS-TOL-LF-PREM-PCT)
 14324         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14325            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14326             (1 - WS-TOL-LF-PREM-PCT)
 14327     ELSE
 14328         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
 14329         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 14330
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 260
* EL050.cbl
 14331***
 14332***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14333***
 14334
 14335     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14336         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14337          WS-TOL-LF-PREM.
 14338
 14339     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14340         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14341          WS-TOL-LF-PREM.
 14342
 14343     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14344        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14345
 14346     IF (PB-REISSUED-CERT        OR
 14347         PB-POLICY-IS-DECLINED   OR
 14348         PB-POLICY-IS-VOIDED)
 14349        NEXT SENTENCE
 14350     ELSE
 14351     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14352           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)
 14353       OR
 14354        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14355           LESS THAN WS-TOL-LF-LOW-PREM-AMT))
 14356       AND
 14357        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14358           GREATER WS-TOL-LF-HIGH-PREM-PCT)
 14359         OR
 14360          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14361           LESS WS-TOL-LF-LOW-PREM-PCT))
 14362              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14363                  MOVE ER-2652   TO  WS-ERROR
 14364                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14365              ELSE
 14366                  MOVE ER-2650   TO  WS-ERROR
 14367                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14368
 14369*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14370*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14371*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14372*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14373
 14374     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14375        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14376                      OR
 14377           ((PB-COMPANY-ID = 'DCC')
 14378           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 14379           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14380           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14381        END-IF
 14382     END-IF
 14383
 14384     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14385        IF WS-COMP-MAX-CAP GREATER THAN +0
 14386           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14387              IF (PB-REISSUED-CERT         OR
 14388                  PB-POLICY-IS-DECLINED    OR
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 261
* EL050.cbl
 14389                  PB-POLICY-IS-VOIDED)
 14390                 NEXT SENTENCE
 14391              ELSE
 14392                  MOVE ER-2646   TO  WS-ERROR
 14393                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14394
 14395 3344-CVL-TOLERANCE-CHECK.
 14396
 14397      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14398          GO TO 3344-CHECK-AH.
 14399
 14400      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14401          GO TO 3344-CHECK-AH.
 14402
 14403      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14404                                     WS-UNSIGN-WRK6.
 14405
 14406      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14407          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14408                                 + PB-I-LF-PREMIUM-AMT
 14409                                 - PB-I-LF-PREM-CALC.
 14410
 14411      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14412          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14413                                 + PB-I-LF-ALT-PREMIUM-AMT
 14414                                 - PB-I-LF-ALT-PREM-CALC.
 14415
 14416      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14417          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14418              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14419                 MOVE ER-2652    TO  WS-ERROR
 14420                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14421              ELSE
 14422                 MOVE ER-2650    TO  WS-ERROR
 14423                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14424
 14425      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14426          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14427              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14428                 MOVE ER-2652    TO  WS-ERROR
 14429                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14430              ELSE
 14431                 MOVE ER-2650    TO  WS-ERROR
 14432                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14433
 14434 3344-CHECK-AH.
 14435
 14436****************************************************************
 14437***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14438***
 14439
 14440     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14441         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14442             (1 + WS-TOL-AH-PREM-PCT)
 14443         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14444             (1 - WS-TOL-AH-PREM-PCT)
 14445     ELSE
 14446         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 262
* EL050.cbl
 14447         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 14448
 14449***
 14450***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14451***
 14452
 14453     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14454         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14455
 14456     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14457         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14458
 14459     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14460        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14461
 14462     IF (PB-REISSUED-CERT)
 14463        OR (PB-POLICY-IS-DECLINED)
 14464        OR (PB-POLICY-IS-VOIDED)
 14465        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14466        CONTINUE
 14467     ELSE
 14468        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14469            OR
 14470           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14471           AND
 14472           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14473           OR
 14474           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14475           IF WS-PREM-REJECT-SW = SPACE
 14476              MOVE ER-3052       TO WS-ERROR
 14477              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14478           ELSE
 14479              MOVE ER-3050       TO WS-ERROR
 14480              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14481           END-IF
 14482        END-IF
 14483     END-IF
 14484
 14485     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14486         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14487             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14488             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14489
 14490     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14491        IF WS-COMP-MAX-CAP GREATER THAN +0
 14492           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14493              IF (PB-REISSUED-CERT         OR
 14494                  PB-POLICY-IS-DECLINED    OR
 14495                  PB-POLICY-IS-VOIDED)
 14496                 NEXT SENTENCE
 14497              ELSE
 14498                  MOVE ER-2646   TO  WS-ERROR
 14499                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14500
 14501     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14502        (WS-COMP-MAX-CAP EQUAL +0)
 14503           GO TO 3345-EDIT-CONTINUE.
 14504
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 263
* EL050.cbl
 14505     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14506        GREATER THAN WS-COMP-MAX-CAP
 14507           MOVE ER-2646          TO  WS-ERROR
 14508           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14509
 14510 3345-EDIT-CONTINUE.
 14511
 14512*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14513*       IF PB-ENTRY-BATCH   NUMERIC
 14514*          IF PB-ISSUE
 14515*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14516*          ELSE
 14517*              IF PB-CANCELLATION
 14518*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14519
 14520*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14521*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14522*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14523*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14524*        ELSE
 14525*            MOVE  ER-1909            TO  WS-ERROR
 14526*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14527
 14528     IF PB-I-POLICY-ACCEPTED
 14529        IF PB-POLICY-IS-DECLINED  OR
 14530           PB-REISSUED-CERT  OR
 14531           PB-REIN-ONLY-CERT  OR
 14532           PB-POLICY-IS-VOIDED
 14533            MOVE  ER-1891         TO  WS-ERROR
 14534            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14535        ELSE
 14536            MOVE SPACE            TO  PB-BATCH-ENTRY
 14537            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14538
 14539     IF PB-I-POLICY-DECLINED
 14540        IF PB-REISSUED-CERT  OR
 14541           PB-REIN-ONLY-CERT  OR
 14542           PB-POLICY-IS-VOIDED
 14543            MOVE  ER-1906         TO  WS-ERROR
 14544            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14545        ELSE
 14546            MOVE  'D'             TO  PB-BATCH-ENTRY
 14547                                      PB-I-ENTRY-STATUS.
 14548
 14549     IF PB-I-NEEDS-UNDERWRITING
 14550        IF PB-POLICY-IS-DECLINED OR
 14551           PB-REISSUED-CERT  OR
 14552           PB-REIN-ONLY-CERT  OR
 14553           PB-POLICY-IS-VOIDED
 14554            MOVE  ER-1907         TO  WS-ERROR
 14555            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14556        ELSE
 14557            MOVE 'U'              TO  PB-BATCH-ENTRY
 14558                                      PB-I-ENTRY-STATUS.
 14559
 14560     IF PB-NEEDS-UNDERWRITING
 14561        MOVE  ER-1901             TO  WS-ERROR
 14562        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 264
* EL050.cbl
 14563     IF PB-COMPANY-ID = 'DCC'
 14564        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14565        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14566        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14567           AND (NOT WS-LF-CASH))
 14568                           OR
 14569           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14570           AND (NOT WS-AH-CASH)))
 14571                       AND
 14572           (PB-I-ENTRY-STATUS NOT = '5')
 14573           MOVE 'M'              TO PB-BATCH-ENTRY
 14574                                    PB-I-ENTRY-STATUS
 14575        END-IF
 14576     END-IF
 14577     IF  PB-COMPANY-ID NOT = 'NCL'
 14578         GO TO 3999-END-EDIT.
 14579
 14580     IF PB-REISSUED-CERT  OR
 14581        PB-POLICY-IS-DECLINED  OR
 14582        PB-POLICY-IS-VOIDED  OR
 14583        PB-I-OB
 14584         GO TO 3999-END-EDIT.
 14585
 14586     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14587         MOVE  ER-2644            TO  WS-ERROR
 14588         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14589         GO TO 3999-END-EDIT.
 14590
 14591     MOVE 'N'                     TO  FORM-MASTER-SW.
 14592     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14593
 14594     IF NOT FORM-MASTER-FOUND
 14595         GO TO 3999-END-EDIT.
 14596
 14597     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14598                                      FORM-MASTER-AH-SW.
 14599
 14600     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14601         MOVE  +1                 TO SUB6
 14602         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14603
 14604     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14605         MOVE  +1                 TO SUB6
 14606         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14607
 14608     IF LF-FORM-MASTER-FOUND  OR
 14609        AH-FORM-MASTER-FOUND
 14610         GO TO 3360-CHECK-FORM-LIMITS
 14611     ELSE
 14612         GO TO 3999-END-EDIT.
 14613
 14614******************************************************************
 14615*                  3350-GET-ERFORM                               *
 14616*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14617*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14618******************************************************************
 14619
 14620 3350-GET-ERFORM.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 265
* EL050.cbl
 14621
 14622     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14623         GO TO  3350-ERFORM-GETMAIN.
 14624
 14625     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14626     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14627     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14628     MOVE 'Y'                     TO FORM-MASTER-SW.
 14629
 14630     IF PB-CANCELLATION
 14631         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14632            PB-SV-STATE          EQUAL   FO-STATE       AND
 14633            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14634              GO TO 3350-EXIT
 14635         ELSE
 14636             NEXT SENTENCE
 14637     ELSE
 14638         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14639            PB-SV-STATE          EQUAL   FO-STATE       AND
 14640            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14641              GO TO 3350-EXIT.
 14642
 14643 3350-ERFORM-GETMAIN.
 14644
 14645     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14646     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14647
 14648 3350-ERFORM-READ.
 14649
 14650     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14651     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14652     IF PB-CANCELLATION
 14653         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14654     ELSE
 14655         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14656     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14657
 14658     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14659
 14660     IF FORM-MASTER-FOUND
 14661       IF PB-CANCELLATION
 14662          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14663             PB-SV-STATE          EQUAL   FO-STATE       AND
 14664             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14665              GO  TO 3350-EXIT
 14666          ELSE
 14667              NEXT SENTENCE
 14668       ELSE
 14669          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14670             PB-SV-STATE          EQUAL   FO-STATE       AND
 14671             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14672              GO  TO 3350-EXIT.
 14673
 14674     MOVE  'N'                    TO  FORM-MASTER-SW.
 14675     MOVE  ER-1895                TO  WS-ERROR.
 14676     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14677
 14678 3350-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 266
* EL050.cbl
 14679      EXIT.
 14680
 14681******************************************************************
 14682*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14683*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14684*   VALID FOR THE POLICY FORM USED.                              *
 14685******************************************************************
 14686
 14687 3355-EDIT-FORM-LF-BENEFITS.
 14688
 14689     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14690        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14691         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14692         GO TO   3355-EXIT.
 14693
 14694     IF  SUB6    LESS THAN   +40
 14695         ADD  +1      TO  SUB6
 14696         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14697
 14698     MOVE  ER-1896         TO  WS-ERROR.
 14699     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14700
 14701 3355-EXIT.
 14702      EXIT.
 14703
 14704******************************************************************
 14705*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14706*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14707*   VALID FOR THE POLICY FORM USED.                              *
 14708******************************************************************
 14709
 14710 3356-EDIT-FORM-AH-BENEFITS.
 14711
 14712     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14713        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14714         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14715         GO TO  3356-EXIT.
 14716
 14717      IF  SUB6    LESS THAN     +40
 14718          ADD  +1      TO  SUB6
 14719          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14720
 14721     MOVE  ER-1897         TO  WS-ERROR.
 14722     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14723
 14724 3356-EXIT.
 14725      EXIT.
 14726
 14727******************************************************************
 14728*                  3357-BENEFIT-SEARCH                           *
 14729*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14730*   CANCELLATIONS ONLY.                                          *
 14731******************************************************************
 14732 3357-BENEFIT-SEARCH.
 14733     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14734         MOVE +1                          TO SUB6
 14735         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14736
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 267
* EL050.cbl
 14737     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14738         MOVE +1                          TO SUB6
 14739         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14740
 14741 3357-EXIT.
 14742     EXIT.
 14743
 14744******************************************************************
 14745*                  3358-BENEFIT-LIFE-SEARCH                      *
 14746*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14747*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14748*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14749******************************************************************
 14750 3358-BENEFIT-LIFE-SEARCH.
 14751     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14752       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14753         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14754           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14755              IF FO-PLAN-REFUND-METHOD (SUB6)
 14756                     IS GREATER THAN SPACES
 14757                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14758                                          WS-LF-REFUND-CALC
 14759                 GO TO 3358-EXIT.
 14760
 14761     IF SUB6 LESS THAN +40
 14762         ADD +1                 TO SUB6
 14763         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14764
 14765 3358-EXIT.
 14766     EXIT.
 14767******************************************************************
 14768*                  3359-BENEFIT-AH-SEARCH                        *
 14769*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 14770*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14771*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14772******************************************************************
 14773 3359-BENEFIT-AH-SEARCH.
 14774     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 14775       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 14776         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14777           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14778              IF FO-PLAN-REFUND-METHOD (SUB6)
 14779                      IS GREATER THAN SPACES
 14780                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14781                                          WS-AH-REFUND-CALC
 14782                 GO TO 3359-EXIT.
 14783
 14784     IF SUB6 LESS THAN +40
 14785         ADD +1                 TO SUB6
 14786         GO TO 3359-BENEFIT-AH-SEARCH.
 14787
 14788 3359-EXIT.
 14789     EXIT.
 14790
 14791******************************************************************
 14792*                  3360-CHECK-FORM-LIMITS                        *
 14793*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14794*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 268
* EL050.cbl
 14795******************************************************************
 14796
 14797 3360-CHECK-FORM-LIMITS.
 14798
 14799     IF FO-IND-GRP-CD = 'I'  OR  'G'
 14800         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 14801
 14802     IF NOT LF-FORM-MASTER-FOUND
 14803         GO TO 3360-CHECK-FORM-AH-LIMITS.
 14804
 14805 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 14806
 14807     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 14808       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 14809        WS-LF-JOINT-INDICATOR = 'J'  AND
 14810        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14811         IF PB-COMPANY-ID = 'NCL'
 14812            MOVE  ER-1911          TO  WS-ERROR
 14813            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14814         ELSE
 14815            MOVE  ER-1892          TO  WS-ERROR
 14816            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14817
 14818 3360-CHECK-FORM-LF-ATT-AGE.
 14819
 14820     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 14821
 14822     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 14823         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14824         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 14825            IF PB-COMPANY-ID = 'NCL'
 14826                MOVE  ER-1913      TO  WS-ERROR
 14827                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14828            ELSE
 14829                MOVE  ER-1894      TO  WS-ERROR
 14830                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14831
 14832 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 14833
 14834     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 14835         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 14836         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 14837            IF PB-COMPANY-ID = 'NCL'
 14838                MOVE  ER-1914      TO  WS-ERROR
 14839                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14840            ELSE
 14841                MOVE  ER-1899      TO  WS-ERROR
 14842                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14843
 14844 3360-CHECK-FORM-LF-TERM-BAMT.
 14845
 14846     IF  FO-LF-MAX-TERM   NUMERIC   AND
 14847         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 14848         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 14849           IF  PB-COMPANY-ID = 'NCL'
 14850               MOVE  ER-1916       TO  WS-ERROR
 14851               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14852           ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 269
* EL050.cbl
 14853               MOVE  ER-1902       TO  WS-ERROR
 14854               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14855
 14856     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 14857                                    PB-I-LF-ALT-BENEFIT-AMT.
 14858
 14859     IF  FO-MAX-LF-AMT   NUMERIC   AND
 14860         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 14861         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 14862             IF  PB-COMPANY-ID = 'NCL'
 14863                 MOVE  ER-1918     TO  WS-ERROR
 14864                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14865             ELSE
 14866                 MOVE  ER-1904     TO  WS-ERROR
 14867                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14868
 14869******************************************************************
 14870*                  3360-CHECK-FORM-AH-LIMITS                     *
 14871*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14872*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14873******************************************************************
 14874
 14875 3360-CHECK-FORM-AH-LIMITS.
 14876
 14877     IF NOT AH-FORM-MASTER-FOUND
 14878         GO TO 3999-END-EDIT.
 14879
 14880 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 14881
 14882     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 14883       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 14884        WS-AH-JOINT-INDICATOR = 'J'  AND
 14885        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14886         IF PB-COMPANY-ID = 'NCL'
 14887            MOVE  ER-1912          TO  WS-ERROR
 14888            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14889         ELSE
 14890            MOVE  ER-1893          TO  WS-ERROR
 14891            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14892
 14893 3360-CHECK-FORM-AH-ATT-AGE.
 14894
 14895     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 14896
 14897     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 14898         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14899         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 14900            IF PB-COMPANY-ID = 'NCL'
 14901                MOVE  ER-1913      TO  WS-ERROR
 14902                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14903            ELSE
 14904                MOVE  ER-1894      TO  WS-ERROR
 14905                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14906
 14907 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 14908
 14909     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 14910         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 270
* EL050.cbl
 14911         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 14912            IF PB-COMPANY-ID = 'NCL'
 14913                MOVE  ER-1915      TO  WS-ERROR
 14914                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14915            ELSE
 14916                MOVE  ER-1900      TO  WS-ERROR
 14917                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14918
 14919 3360-CHECK-FORM-AH-TERM-BAMT.
 14920
 14921     IF  FO-AH-MAX-TERM    NUMERIC   AND
 14922         FO-AH-MAX-TERM    GREATER THAN  +0
 14923         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 14924             IF  PB-COMPANY-ID = 'NCL'
 14925                 MOVE  ER-1917     TO  WS-ERROR
 14926                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14927             ELSE
 14928                  MOVE  ER-1903    TO  WS-ERROR
 14929                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14930
 14931     IF  FO-MAX-AH-AMT    NUMERIC   AND
 14932         FO-MAX-AH-AMT    GREATER THAN  +0
 14933         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 14934             IF  PB-COMPANY-ID = 'NCL'
 14935                 MOVE  ER-1919     TO  WS-ERROR
 14936                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14937             ELSE
 14938                 MOVE  ER-1905     TO  WS-ERROR
 14939                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14940
 14941     GO TO 3999-END-EDIT.
 14942
 14943******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 271
* EL050.cbl
 14945******************************************************************
 14946*                  E D I T   C A N C E L                         *
 14947******************************************************************
 14948
 14949 3700-EDIT-CANCEL.
 14950     IF PB-COMPANY-ID = 'DMD'
 14951         MOVE ZEROS                   TO WS-RES-STATE-TAX
 14952                                         WS-RES-MUNI-TAX
 14953                                         PB-CI-STATE-TAX
 14954                                         PB-CI-MUNI-TAX
 14955         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 14956
 14957*    IF PB-COMPANY-ID  EQUAL  'NCL'
 14958*       IF PB-ENTRY-BATCH  NUMERIC
 14959*          IF PB-CANCELLATION
 14960*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 14961*          ELSE
 14962*             IF PB-ISSUE
 14963*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 14964
 14965     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 14966        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 14967     END-IF
 14968*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 14969*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 14970
 14971     IF CM-ENTRY-STATUS = 'V'
 14972        MOVE ER-2780             TO WS-ERROR
 14973        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14974        GO TO 3999-END-EDIT.
 14975
 14976     IF CM-ENTRY-STATUS = 'D'
 14977        MOVE ER-2781             TO WS-ERROR
 14978        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14979        GO TO 3999-END-EDIT.
 14980
 14981     IF CM-ENTRY-STATUS = 'U'
 14982        MOVE ER-2782             TO WS-ERROR
 14983        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14984
 14985***************************************************************
 14986*                                                             *
 14987*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 14988*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 14989*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 14990*   OF ANOTHER COVERAGE.                                      *
 14991*                                                             *
 14992***************************************************************
 14993
 14994     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 14995                                    PB-C-AH-CANCEL-VOID-SW.
 14996
 14997     IF PB-C-LF-CANCEL-AMT = ZERO
 14998        NEXT SENTENCE
 14999     ELSE
 15000        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15001           AND
 15002           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 272
* EL050.cbl
 15003               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15004               MOVE ER-2745           TO WS-ERROR
 15005               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15006
 15007     IF PB-C-AH-CANCEL-AMT = ZERO
 15008        NEXT SENTENCE
 15009     ELSE
 15010        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15011           AND
 15012           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15013               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15014               MOVE ER-2745           TO WS-ERROR
 15015               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15016
 15017     IF WS-LF-EARNINGS-CALC = '4'
 15018        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15019
 15020     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15021     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15022     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15023     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15024     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15025     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15026
 15027     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15028                                      PB-C-AH-REF-CALC.
 15029     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15030
 15031******************************************************************
 15032*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15033*             TO VALIDATE COVERAGE.                              *
 15034******************************************************************
 15035
 15036     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15037        PB-C-LF-CANCEL-AMT = ZEROS
 15038          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15039      ELSE
 15040          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15041
 15042     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15043        PB-C-AH-CANCEL-AMT = ZEROS
 15044          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15045      ELSE
 15046          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15047
 15048     EVALUATE TRUE
 15049         WHEN PB-CANCEL-FORCE             OR
 15050              PB-CANCEL-DATE-FORCED       OR
 15051              PB-FORCE-OFF
 15052                  IF PB-COMPANY-ID = 'ACE'
 15053                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15054                  END-IF
 15055         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15056               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15057              (PB-COMPANY-ID = 'ACE' )
 15058                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15059         WHEN OTHER
 15060              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 273
* EL050.cbl
 15061                 MOVE ER-2794              TO WS-ERROR
 15062              ELSE
 15063                 MOVE ER-2749              TO WS-ERROR
 15064              END-IF
 15065              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15066     END-EVALUATE.
 15067
 15068
 15069*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15070*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15071*            MOVE  ER-1909            TO  WS-ERROR
 15072*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15073*        ELSE
 15074*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15075
 15076     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15077     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15078        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15079     ELSE
 15080        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15081     END-IF
 15082     .
 15083 3705-EDIT-CANCEL-DT.
 15084
 15085     IF LF-COVERAGE-CANCELLED
 15086        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15087         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15088         MOVE WS-CURRENT-MONTH-END
 15089                                 TO DC-BIN-DATE-2
 15090         SET ELAPSED-BETWEEN-BIN TO TRUE
 15091*        MOVE 1                  TO DC-OPTION-CODE
 15092         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15093         IF DATE-CONVERSION-ERROR
 15094            NEXT SENTENCE
 15095          ELSE
 15096             IF DC-ELAPSED-DAYS GREATER +180
 15097                IF PB-CANCEL-DATE-FORCED  OR
 15098                   PB-CANCEL-DATE-FORCED-NO-FEE
 15099                      MOVE ER-2751  TO WS-ERROR
 15100                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15101                 ELSE
 15102                   MOVE ER-2752  TO WS-ERROR
 15103                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15104
 15105     IF AH-COVERAGE-CANCELLED
 15106        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15107         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15108         MOVE WS-CURRENT-MONTH-END
 15109                                 TO DC-BIN-DATE-2
 15110         SET ELAPSED-BETWEEN-BIN TO TRUE
 15111*        MOVE 1                  TO DC-OPTION-CODE
 15112         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15113         IF DATE-CONVERSION-ERROR
 15114            NEXT SENTENCE
 15115          ELSE
 15116             IF DC-ELAPSED-DAYS GREATER +180
 15117                IF PB-CANCEL-DATE-FORCED OR
 15118                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 274
* EL050.cbl
 15119                      MOVE ER-2751  TO WS-ERROR
 15120                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15121                 ELSE
 15122                   MOVE ER-2752  TO WS-ERROR
 15123                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15124
 15125     IF WS-ERROR = ER-2752
 15126        AND (PB-COMPANY-ID = 'ABL'
 15127         OR  PB-COMPANY-ID = 'FGL'
 15128         OR  PB-COMPANY-ID = 'IST'
 15129         OR  PB-COMPANY-ID = 'JHL'
 15130         OR  PB-COMPANY-ID = 'LAP'
 15131         OR  PB-COMPANY-ID = 'LBL'
 15132         OR  PB-COMPANY-ID = 'NCB'
 15133         OR  PB-COMPANY-ID = 'NLI'
 15134         OR  PB-COMPANY-ID = 'OFI'
 15135         OR  PB-COMPANY-ID = 'PLI'
 15136         OR  PB-COMPANY-ID = 'TAO'
 15137         OR  PB-COMPANY-ID = 'TIC'
 15138         OR  PB-COMPANY-ID = 'HER'
 15139         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15140         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15141            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15142            MOVE ER-2762     TO WS-ERROR
 15143            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15144
 15145     IF LF-COVERAGE-CANCELLED
 15146        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15147        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15148             MOVE ER-2733         TO WS-ERROR
 15149             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15150
 15151     IF AH-COVERAGE-CANCELLED
 15152        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15153        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15154              MOVE ER-2733        TO WS-ERROR
 15155              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15156
 15157     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15158        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15159        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15160           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15161            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15162              IF PB-COMPANY-ID NOT = 'LAP'
 15163               MOVE ER-2704            TO WS-ERROR
 15164               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15165
 15166     IF CERT-WAS-NOT-FOUND
 15167         GO TO 3999-END-EDIT.
 15168
 15169     IF PB-COMPANY-ID EQUAL 'CDC'
 15170        IF LF-COVERAGE-CANCELLED
 15171           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15172            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15173            MOVE PB-C-LF-CANCEL-DT
 15174                                 TO DC-BIN-DATE-2
 15175            SET ELAPSED-BETWEEN-BIN TO TRUE
 15176*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 275
* EL050.cbl
 15177            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15178            IF DATE-CONVERSION-ERROR
 15179               NEXT SENTENCE
 15180             ELSE
 15181                IF DC-ELAPSED-DAYS GREATER +60
 15182                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15183
 15184     IF PB-COMPANY-ID EQUAL 'CDC'
 15185        IF AH-COVERAGE-CANCELLED
 15186           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15187            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15188            MOVE PB-C-AH-CANCEL-DT
 15189                                 TO DC-BIN-DATE-2
 15190            MOVE +0              TO DC-ELAPSED-DAYS
 15191                                    DC-ELAPSED-MONTHS
 15192            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15193*           MOVE 1               TO DC-OPTION-CODE
 15194            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15195            IF DATE-CONVERSION-ERROR
 15196               NEXT SENTENCE
 15197             ELSE
 15198                IF DC-ELAPSED-DAYS GREATER +60
 15199                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15200
 15201     MOVE +0                     TO DC-ELAPSED-DAYS
 15202                                    DC-ELAPSED-MONTHS.
 15203
 15204     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15205        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15206          MOVE 'Z'                TO PB-CI-OB-FLAG
 15207          MOVE ER-2767            TO WS-ERROR
 15208          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15209          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15210          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15211          GO TO 3775-OVER-REF-CHK
 15212        ELSE
 15213          MOVE ZEROS              TO PB-CI-LIVES
 15214                                     PB-C-LIVES
 15215          IF PB-CI-OB-FLAG NOT = 'B'
 15216             MOVE SPACE           TO PB-CI-OB-FLAG.
 15217
 15218     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15219         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15220     ELSE
 15221         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15222
 15223     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15224        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15225            MOVE ER-2760         TO WS-ERROR
 15226            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15227
 15228     IF LF-COVERAGE-CANCELLED
 15229        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15230         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15231            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15232               MOVE ER-2774       TO WS-ERROR
 15233               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15234
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 276
* EL050.cbl
 15235     IF AH-COVERAGE-CANCELLED
 15236        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15237         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15238            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15239               MOVE ER-2775       TO WS-ERROR
 15240               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15241
 15242     IF LF-COVERAGE-CANCELLED
 15243        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15244         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15245            MOVE ER-2776         TO WS-ERROR
 15246            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15247
 15248     IF AH-COVERAGE-CANCELLED
 15249        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15250         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15251            MOVE ER-2777         TO WS-ERROR
 15252            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15253
 15254     IF LF-COVERAGE-CANCELLED
 15255        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15256         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15257         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15258         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15259*        MOVE 6                    TO DC-OPTION-CODE
 15260         SET BIN-PLUS-ELAPSED      TO TRUE
 15261         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15262         IF DATE-CONVERSION-ERROR
 15263            NEXT SENTENCE
 15264          ELSE
 15265            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15266              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15267                             OR  'FIA'
 15268                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15269               ELSE
 15270                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15271                MOVE ER-2731       TO WS-ERROR
 15272                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15273
 15274 3705-EDIT-AH-CANCEL-DT.
 15275
 15276     IF AH-COVERAGE-CANCELLED
 15277        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15278         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15279         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15280         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15281*        MOVE 6                    TO DC-OPTION-CODE
 15282         SET BIN-PLUS-ELAPSED      TO TRUE
 15283         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15284         IF DATE-CONVERSION-ERROR
 15285            NEXT SENTENCE
 15286          ELSE
 15287            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15288              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15289                              OR 'FIA'
 15290                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15291              ELSE
 15292               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 277
* EL050.cbl
 15293               MOVE ER-2771       TO WS-ERROR
 15294               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15295
 15296 3705-EDIT-CONTINUED.
 15297
 15298*    IF LF-COVERAGE-CANCELLED
 15299*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15300*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15301*            MOVE ER-2727         TO WS-ERROR
 15302*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15303*
 15304*    IF AH-COVERAGE-CANCELLED
 15305*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15306*        IF PB-COMPANY-ID = 'ACE'
 15307*           MOVE ER-2727        TO WS-ERROR
 15308*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15309*        ELSE
 15310*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15311*              MOVE ER-2727     TO WS-ERROR
 15312*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15313
 15314     IF PB-COMPANY-ID = 'ACE'
 15315       IF AH-COVERAGE-CANCELLED
 15316         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15317           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15318              MOVE ER-2732      TO WS-ERROR
 15319              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15320
 15321     IF PB-COMPANY-ID      EQUAL   'HER'
 15322        IF WS-ERROR        EQUAL   ER-2727
 15323            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15324            MOVE  ER-2725          TO  WS-ERROR
 15325            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15326
 15327     IF PB-C-CLAIM-CREATED-CANCEL
 15328            MOVE ER-2748         TO WS-ERROR
 15329            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15330
 15331     IF PB-C-LAST-NAME NOT = SPACES
 15332         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15333            MOVE ER-2747         TO WS-ERROR
 15334            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15335
 15336 3710-EDIT-LUMP-SUM-PRIOR.
 15337
 15338     IF AH-COVERAGE-CANCELLED
 15339         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15340             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15341                MOVE ER-2735    TO WS-ERROR
 15342                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15343
 15344     IF LF-COVERAGE-CANCELLED
 15345         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15346             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15347                MOVE ER-2735    TO WS-ERROR
 15348                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15349
 15350 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 278
* EL050.cbl
 15351
 15352*    IF LF-COVERAGE-CANCELLED
 15353*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15354*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15355*           (NOT PB-CI-OB)
 15356*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15357*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15358*                   MOVE ER-2732  TO WS-ERROR
 15359*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15360*
 15361*    IF AH-COVERAGE-CANCELLED
 15362*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15363*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15364*           (NOT PB-CI-OB)
 15365*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15366*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15367*                   MOVE ER-2732  TO WS-ERROR
 15368*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15369
 15370     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15371         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15372            (NOT PB-COMP-LF-CANCEL)
 15373             NEXT SENTENCE
 15374         ELSE
 15375           IF PB-C-LF-CANCEL-VOIDED
 15376              NEXT SENTENCE
 15377           ELSE
 15378              MOVE ER-2753      TO WS-ERROR
 15379              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15380
 15381     IF CANCEL-FUTURE-DT
 15382         GO TO 3999-END-EDIT.
 15383
 15384 3715-GET-REMAIN-TERM-LF.
 15385
 15386     IF NO-LF-BENEFIT-MATCH  OR
 15387        WS-LF-BENEFIT-CD = ZEROS
 15388        GO TO 3730-GET-AH-REMAIN-TERM.
 15389
 15390     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15391     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15392     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15393     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15394     MOVE PB-SV-STATE            TO CP-STATE.
 15395     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15396     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15397     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15398     MOVE '2'                    TO CP-PROCESS-TYPE.
 15399     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15400     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15401     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15402     IF (PB-COMPANY-ID = 'CID')
 15403        AND (CP-STATE-STD-ABBRV = 'WI')
 15404        MOVE '7'                 TO CP-REM-TERM-METHOD
 15405        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15406     ELSE
 15407        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15408        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 279
* EL050.cbl
 15409                                 TO CP-REM-TRM-CALC-OPTION
 15410     END-IF
 15411**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15412     IF (PB-COMPANY-ID = 'CID')
 15413        AND (CP-STATE-STD-ABBRV = 'MO')
 15414        AND (PB-CERT-EFF-DT >= X'9B41')
 15415        AND (PB-CERT-EFF-DT <= X'A2FB')
 15416        MOVE '7'                 TO CP-REM-TERM-METHOD
 15417        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15418     END-IF
 15419     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15420                                    CP-LOAN-TERM.
 15421     IF CP-TRUNCATED-LIFE
 15422        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15423
 15424     IF CP-TERM-IS-DAYS
 15425         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15426     ELSE
 15427         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15428
 15429     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15430
 15431     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15432
 15433     IF LF-COVERAGE-CANCELLED
 15434        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15435        NEXT SENTENCE
 15436      ELSE
 15437          GO TO 3730-GET-AH-REMAIN-TERM.
 15438
 15439 3720-GET-LF-REFUND.
 15440
 15441     IF PB-C-LF-CANCEL-VOIDED OR
 15442        PB-C-AH-CANCEL-VOIDED
 15443        GO TO 3780-UPDATE-CANCEL-CERT.
 15444
 15445     IF PB-COMPANY-ID EQUAL 'BOA'
 15446         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15447         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15448         GO TO 3730-GET-AH-REMAIN-TERM.
 15449
 15450     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15451        (WS-AH-SPECIAL-CALC-CD = 'M')
 15452         MOVE ER-2767            TO WS-ERROR
 15453         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15454         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15455         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15456         GO TO 3780-UPDATE-CANCEL-CERT.
 15457
 15458     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15459
 15460     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15461     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15462     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15463     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15464     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15465     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15466     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 280
* EL050.cbl
 15467        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15468        IF PDEF-MASTER-FOUND
 15469           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15470              (V1 > +8)
 15471              OR (PD-PROD-CODE (V1) = 'L')
 15472           END-PERFORM
 15473           IF V1 < +9
 15474              MOVE PD-MAX-AMT (V1)
 15475                           TO CP-R-MAX-TOT-BEN
 15476                              EC-AM-LF-MAX-TOT-BEN
 15477           END-IF
 15478        ELSE
 15479        MOVE ' '                 TO PDEF-MASTER-SW
 15480        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15481        MOVE PB-STATE            TO ERPDEF-STATE
 15482        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15483        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15484        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15485        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15486        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15487        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15488        IF PDEF-MASTER-FOUND
 15489           MOVE 'N'              TO PDEF-MASTER-SW
 15490           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15491           IF PDEF-MASTER-FOUND
 15492              IF (ERPDEF-KEY-SAVE (1:16) =
 15493                           PD-CONTROL-PRIMARY (1:16))
 15494                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15495                 CONTINUE
 15496              ELSE
 15497                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15498                 IF (ERPDEF-KEY-SAVE (1:16) =
 15499                           PD-CONTROL-PRIMARY (1:16))
 15500                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15501                    CONTINUE
 15502                 ELSE
 15503                    MOVE 'N'     TO PDEF-MASTER-SW
 15504                 END-IF
 15505              END-IF
 15506              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15507
 15508              IF PDEF-MASTER-FOUND
 15509                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15510                    (V1 > +8)
 15511                    OR (PD-PROD-CODE (V1) = 'L')
 15512                 END-PERFORM
 15513                 IF V1 < +9
 15514                    MOVE PD-MAX-AMT (V1)
 15515                                 TO CP-R-MAX-TOT-BEN
 15516                                    EC-AM-LF-MAX-TOT-BEN
 15517                 END-IF
 15518              END-IF
 15519           END-IF
 15520           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15521        END-IF
 15522        END-IF
 15523     END-IF
 15524     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 281
* EL050.cbl
 15525
 15526     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15527
 15528     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15529                                    PB-C-LF-REM-TERM.
 15530
 15531     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15532     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15533
 15534     IF PB-COMPANY-ID EQUAL 'FLC'
 15535        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15536           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15537           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15538                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15539                    - CM-LF-ITD-DEATH-AMT
 15540           IF PB-C-LF-REF-CALC LESS THAN +0
 15541              MOVE +0            TO PB-C-LF-REF-CALC
 15542              GO TO 3730-GET-AH-REMAIN-TERM
 15543           ELSE
 15544              GO TO 3730-GET-AH-REMAIN-TERM.
 15545
 15546     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15547                            OR '4' OR '5' OR '6' OR '8'
 15548                            OR '9' OR 'G'
 15549        MOVE PB-C-LF-REFUND-OVERRIDE
 15550                                 TO CP-EARNING-METHOD.
 15551
 15552     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15553     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15554     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15555                                    CP-RATING-BENEFIT-AMT.
 15556     IF CP-STATE-STD-ABBRV = 'OR'
 15557         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15558                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15559     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15560     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15561     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15562     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15563     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15564     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15565     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15566     IF WS-DEFAULT-APR NOT NUMERIC
 15567         MOVE ZEROS TO WS-DEFAULT-APR.
 15568****   N O T E   ****
 15569*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15570*      THE OH HARD CODING IN ELCRFNDP
 15571
 15572     IF PB-COMPANY-ID = 'CID'
 15573        IF CP-STATE-STD-ABBRV = 'OH'
 15574           MOVE WS-LF-EARNINGS-CALC
 15575                                 TO CP-EARNING-METHOD
 15576        END-IF
 15577     END-IF
 15578
 15579****   N O T E   ****
 15580
 15581     IF CP-EARN-AS-NET-PAY
 15582         IF CP-LOAN-APR NOT GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 282
* EL050.cbl
 15583            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15584                MOVE WS-DEFAULT-APR
 15585                                 TO  CP-LOAN-APR
 15586                MOVE ER-3780     TO  WS-ERROR
 15587                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15588            ELSE
 15589                MOVE ER-3781     TO  WS-ERROR
 15590                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15591     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15592     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15593
 15594     IF CP-REFUND-TYPE-USED NOT = SPACE
 15595         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15596
 15597     IF CP-ERROR-RATE-IS-ZERO OR
 15598        CP-ERROR-RATE-NOT-FOUND
 15599        MOVE ER-2740             TO WS-ERROR
 15600        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15601
 15602     IF CP-ERROR-RATE-FILE-NOTOPEN
 15603        MOVE ER-2617             TO WS-ERROR
 15604        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15605
 15606     IF PB-COMPANY-ID = 'DCC'
 15607        AND PB-CI-ENTRY-STATUS = 'M'
 15608        MOVE +0                  TO PB-C-LF-REF-CALC
 15609     ELSE
 15610        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15611     END-IF
 15612
 15613     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15614         GO TO 3730-GET-AH-REMAIN-TERM.
 15615
 15616*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15617*       ADD +1                   TO PB-C-LF-REM-TERM
 15618*                                   CP-REMAINING-TERM
 15619*                                   CP-ORIGINAL-TERM.
 15620
 15621     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15622     MOVE '2'                    TO CP-EARNING-METHOD
 15623                                    CP-RATING-METHOD.
 15624     IF PB-COMPANY-ID = 'CID'
 15625        IF (CP-STATE-STD-ABBRV = 'MN')
 15626           AND (PB-CERT-EFF-DT > X'A4FF')
 15627           AND (WS-LF-EARNINGS-CALC = 'B')
 15628           MOVE '5'              TO CP-EARNING-METHOD
 15629           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15630        END-IF
 15631     END-IF
 15632     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15633                                        CP-REMAINING-BENEFIT
 15634                                        CP-RATING-BENEFIT-AMT.
 15635     IF CP-STATE-STD-ABBRV = 'OR'
 15636         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15637                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15638     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15639     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15640
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 283
* EL050.cbl
 15641     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15642
 15643     IF CP-ERROR-RATE-IS-ZERO OR
 15644        CP-ERROR-RATE-NOT-FOUND
 15645        MOVE ER-2740             TO WS-ERROR
 15646        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15647
 15648     IF CP-ERROR-RATE-FILE-NOTOPEN
 15649        MOVE ER-2617             TO WS-ERROR
 15650        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15651
 15652     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15653
 15654******************************************************************
 15655
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 284
* EL050.cbl
 15657 3730-GET-AH-REMAIN-TERM.
 15658     IF NO-AH-BENEFIT-MATCH  OR
 15659        WS-AH-BENEFIT-CD = ZEROS
 15660         GO TO 3770-CHECK-REFUNDS.
 15661
 15662     IF PB-CI-AH-LUMP-SUM-DISAB
 15663         IF  PB-C-AH-CANCEL-AMT = ZERO
 15664            IF NOT PB-COMP-AH-CANCEL
 15665             GO TO 3770-CHECK-REFUNDS.
 15666
 15667     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15668     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15669     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15670     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15671     MOVE PB-SV-STATE            TO CP-STATE.
 15672     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15673     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15674     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15675     MOVE '2'                    TO CP-PROCESS-TYPE.
 15676     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15677     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15678     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15679     IF (PB-COMPANY-ID = 'CID')
 15680        AND (CP-STATE-STD-ABBRV = 'WI')
 15681        MOVE '7'                 TO CP-REM-TERM-METHOD
 15682        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15683     ELSE
 15684        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15685        MOVE WS-REM-TRM-CALC-OPTION
 15686                                 TO CP-REM-TRM-CALC-OPTION
 15687     END-IF
 15688     IF (PB-COMPANY-ID = 'CID')
 15689        AND (CP-STATE-STD-ABBRV = 'MO')
 15690        AND (PB-CERT-EFF-DT >= X'9B41')
 15691        AND (PB-CERT-EFF-DT <= X'A2FB')
 15692        MOVE '7'                 TO CP-REM-TERM-METHOD
 15693        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15694     END-IF
 15695     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15696                                    CP-LOAN-TERM.
 15697     IF NOT CP-TERM-IS-DAYS
 15698         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15699
 15700     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15701
 15702     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15703
 15704     IF AH-COVERAGE-CANCELLED
 15705        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15706        NEXT SENTENCE
 15707      ELSE
 15708         GO TO 3770-CHECK-REFUNDS.
 15709
 15710 3740-GET-AH-REFUND.
 15711
 15712     IF PB-C-LF-CANCEL-VOIDED OR
 15713        PB-C-AH-CANCEL-VOIDED
 15714        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 285
* EL050.cbl
 15715
 15716     IF PB-COMPANY-ID = 'BOA'
 15717         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15718         GO TO 3770-CHECK-REFUNDS.
 15719
 15720     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15721*    MOVE ' '                    TO DC-OPTION-CODE
 15722     SET BIN-TO-GREG             TO TRUE
 15723     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15724     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15725                                    PB-C-AH-REM-TERM.
 15726     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15727     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15728
 15729     IF PB-COMPANY-ID EQUAL 'FLC'
 15730        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15731           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15732           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15733                    - CM-AH-ITD-AH-PMT)
 15734           IF PB-C-AH-REF-CALC LESS THAN +0
 15735              MOVE +0            TO PB-C-AH-REF-CALC
 15736              GO TO 3770-CHECK-REFUNDS
 15737           ELSE
 15738              GO TO 3770-CHECK-REFUNDS.
 15739
 15740     IF PB-COMPANY-ID = 'DCC'
 15741        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15742            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15743           MOVE 'S'              TO CP-EARNING-METHOD
 15744        END-IF
 15745     END-IF
 15746     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15747                            OR '4' OR '5' OR '6' OR '8'
 15748                            OR '9' OR 'G' OR 'S'
 15749        MOVE PB-C-AH-REFUND-OVERRIDE
 15750                                 TO CP-EARNING-METHOD.
 15751
 15752     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15753     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 15754     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15755                                    CP-RATING-BENEFIT-AMT.
 15756     IF CP-STATE-STD-ABBRV = 'OR'
 15757         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 15758                                         PB-CI-AH-TERM.
 15759     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15760     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15761     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15762     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 15763     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 15764     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15765
 15766     IF CP-STATE-STD-ABBRV = 'OH'
 15767        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 15768                                AND 'CID' AND 'DCC')
 15769           IF (CP-ORIGINAL-TERM GREATER 60) AND
 15770              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 15771              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15772              MOVE '6' TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 286
* EL050.cbl
 15773           END-IF
 15774        END-IF
 15775        IF PB-COMPANY-ID = 'CID'
 15776           IF NO-LIFE-COVERAGE
 15777              IF CP-CRITICAL-PERIOD
 15778                 MOVE '2'       TO CP-EARNING-METHOD
 15779              ELSE
 15780                 MOVE '6'       TO CP-EARNING-METHOD
 15781              END-IF
 15782           ELSE
 15783              IF WS-LF-COVERAGE-TYPE = 'L'
 15784                 MOVE '2'       TO CP-EARNING-METHOD
 15785              ELSE
 15786                 IF (PB-CI-LF-TERM > +60) OR
 15787                    (WS-LF-EARNINGS-CALC = '5')
 15788                    IF CP-CRITICAL-PERIOD
 15789                       MOVE '2'  TO CP-EARNING-METHOD
 15790                    ELSE
 15791                       MOVE '6'  TO CP-EARNING-METHOD
 15792                    END-IF
 15793                 ELSE
 15794                    MOVE '1'     TO CP-EARNING-METHOD
 15795                 END-IF
 15796              END-IF
 15797           END-IF
 15798        END-IF
 15799     END-IF
 15800
 15801*    IF CP-STATE-STD-ABBRV = 'VA'
 15802*       IF DC-GREG-DATE-CYMD GREATER 19921231
 15803*          IF CP-ORIGINAL-TERM GREATER 61
 15804*             MOVE '6' TO CP-EARNING-METHOD
 15805*          ELSE
 15806*             MOVE '1' TO CP-EARNING-METHOD.
 15807
 15808     IF WS-DEFAULT-APR NOT NUMERIC
 15809         MOVE ZEROS TO WS-DEFAULT-APR.
 15810     IF CP-EARN-AS-NET-PAY
 15811         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15812            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15813                MOVE WS-DEFAULT-APR
 15814                                 TO  CP-LOAN-APR
 15815                MOVE ER-3780     TO  WS-ERROR
 15816                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15817            ELSE
 15818                MOVE ER-3781     TO  WS-ERROR
 15819                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15820     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15821     IF PB-COMPANY-ID = 'DCC'
 15822        AND CP-CANCEL-REASON = 'R'
 15823        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15824        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 15825     END-IF
 15826     IF PB-COMPANY-ID = 'DCC'
 15827        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15828        AND (CP-EARNING-METHOD = 'D')
 15829        AND (CP-CANCEL-REASON NOT = 'R')
 15830        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 287
* EL050.cbl
 15831     ELSE
 15832        GO TO 3750-CONTINUE
 15833     END-IF
 15834     MOVE ' '                    TO DD-IU-SW
 15835     IF NOT PDEF-MASTER-FOUND
 15836        MOVE ' '                 TO PDEF-MASTER-SW
 15837        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15838        MOVE PB-STATE            TO ERPDEF-STATE
 15839        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15840        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15841        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15842        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15843        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15844        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15845        IF PDEF-MASTER-FOUND
 15846           MOVE 'N'              TO PDEF-MASTER-SW
 15847           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15848           IF PDEF-MASTER-FOUND
 15849              IF (ERPDEF-KEY-SAVE (1:16) =
 15850                           PD-CONTROL-PRIMARY (1:16))
 15851                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15852                 CONTINUE
 15853              ELSE
 15854                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15855                 IF (ERPDEF-KEY-SAVE (1:16) =
 15856                           PD-CONTROL-PRIMARY (1:16))
 15857                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15858                    CONTINUE
 15859                 ELSE
 15860                    MOVE ER-2740 TO WS-ERROR
 15861                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15862                    GO TO 3770-CHECK-REFUNDS
 15863                 END-IF
 15864              END-IF
 15865           END-IF
 15866           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15867        END-IF
 15868     END-IF
 15869     IF PDEF-MASTER-FOUND
 15870        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15871           (V1 > +8)
 15872           OR (PD-PROD-CODE (V1) = 'I')
 15873        END-PERFORM
 15874        IF V1 < +9
 15875           SET DD-IU-PRESENT        TO TRUE
 15876        END-IF
 15877        IF WS-AH-DCC-TRUNC = 'T'
 15878           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 15879        ELSE
 15880           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 15881        END-IF
 15882        EVALUATE TRUE
 15883           WHEN WS-TERM > +168
 15884              MOVE 15               TO V1
 15885           WHEN WS-TERM > +156
 15886              MOVE 14               TO V1
 15887           WHEN WS-TERM > +144
 15888              MOVE 13               TO V1
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 288
* EL050.cbl
 15889           WHEN WS-TERM > +132
 15890              MOVE 12               TO V1
 15891           WHEN WS-TERM > +120
 15892              MOVE 11               TO V1
 15893           WHEN WS-TERM > +108
 15894              MOVE 10               TO V1
 15895           WHEN WS-TERM > +96
 15896              MOVE 9                TO V1
 15897           WHEN WS-TERM > +84
 15898              MOVE 8                TO V1
 15899           WHEN WS-TERM > +72
 15900              MOVE 7                TO V1
 15901           WHEN WS-TERM > +60
 15902              MOVE 6                TO V1
 15903           WHEN WS-TERM > +48
 15904              MOVE 5                TO V1
 15905           WHEN WS-TERM > +36
 15906              MOVE 4                TO V1
 15907           WHEN WS-TERM > +24
 15908              MOVE 3                TO V1
 15909           WHEN WS-TERM > +12
 15910              MOVE 2                TO V1
 15911           WHEN OTHER
 15912              MOVE 1                TO V1
 15913        END-EVALUATE
 15914
 15915        EVALUATE TRUE
 15916*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 15917*             < +13)
 15918*             AND (DD-IU-PRESENT)
 15919*             MOVE 2                TO V2
 15920*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 15921*             MOVE 1                TO V2
 15922           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 15923              MOVE 2                TO V2
 15924           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 15925              MOVE 3                TO V2
 15926           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 15927              MOVE 4                TO V2
 15928           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 15929              MOVE 5                TO V2
 15930           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 15931              MOVE 6                TO V2
 15932           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 15933              MOVE 7                TO V2
 15934           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 15935              MOVE 8                TO V2
 15936           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 15937              MOVE 9                TO V2
 15938           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 15939              MOVE 10               TO V2
 15940           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 15941              MOVE 11               TO V2
 15942           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 15943              MOVE 12               TO V2
 15944           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 15945              MOVE 13               TO V2
 15946           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 289
* EL050.cbl
 15947              MOVE 14               TO V2
 15948           WHEN OTHER
 15949              MOVE 15               TO V2
 15950        END-EVALUATE
 15951
 15952        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 15953                                 TO CP-DDF-LO-FACT
 15954        MOVE PD-UEP-FACTOR (V1 V2)
 15955                                 TO CP-DDF-HI-FACT
 15956
 15957        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 15958        MOVE CM-AH-CLP     TO CP-DDF-CLP
 15959        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 15960           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 15961        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 15962        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 15963        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 15964           + PD-1ST-YR-ADMIN-ALLOW
 15965
 15966        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15967*       IF PI-CLP-YN = 'Y'
 15968*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 15969*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 15970*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 15971*       END-IF
 15972
 15973        IF DD-IU-PRESENT
 15974           MOVE 'I'              TO CP-EARNING-METHOD
 15975        END-IF
 15976        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 15977                                     CP-CLP-RATE-UP
 15978        IF CP-IU-RATE-UP NOT = ZEROS
 15979           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 15980              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 15981           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 15982              / (1 - WS-WORK-FACT)
 15983        END-IF
 15984     END-IF
 15985     .
 15986 3750-CONTINUE.
 15987     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15988
 15989     IF CP-REFUND-TYPE-USED NOT = SPACE
 15990         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 15991
 15992     IF CP-ERROR-RATE-IS-ZERO OR
 15993        CP-ERROR-RATE-NOT-FOUND
 15994        MOVE ER-2740             TO WS-ERROR
 15995        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15996
 15997     IF CP-ERROR-RATE-FILE-NOTOPEN
 15998        MOVE ER-2617             TO WS-ERROR
 15999        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16000     IF PB-COMPANY-ID = 'DCC'
 16001        AND PB-CI-ENTRY-STATUS = 'M'
 16002        MOVE +0                  TO PB-C-AH-REF-CALC
 16003     ELSE
 16004        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 290
* EL050.cbl
 16005     END-IF
 16006     IF PB-COMPANY-ID = 'DCC'
 16007        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16008        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16009        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16010        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16011        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16012        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16013        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16014        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16015        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16016     END-IF
 16017     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 291
* EL050.cbl
 16019
 16020 3770-CHECK-REFUNDS.
 16021
 16022     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16023        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16024           MOVE ER-2766          TO WS-ERROR
 16025           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16026           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16027           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16028              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16029
 16030     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16031        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16032           MOVE ER-2766          TO WS-ERROR
 16033           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16034           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16035           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16036              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16037
 16038     IF PB-COMP-LF-CANCEL
 16039        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16040        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16041           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16042              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16043
 16044     IF PB-COMP-AH-CANCEL
 16045        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16046        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16047           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16048              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16049
 16050     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16051             GIVING WS-UNSIGN-WRK1
 16052     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16053             GIVING WS-UNSIGN-WRK2.
 16054
 16055     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16056         MOVE ZERO TO WS-UNSIGN-WRK1.
 16057
 16058     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16059         MOVE ZERO TO WS-UNSIGN-WRK2.
 16060
 16061     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16062
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 292
* EL050.cbl
 16064
 16065 3772-CONTINUE.
 16066
 16067**********************************
 16068*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16069*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16070*** DOUBLES THE TOLERANCE AMOUNT.
 16071***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16072**********************************
 16073     IF PB-COMPANY-ID = 'MON'
 16074     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16075         IF WS-REF-REJECT-SW = SPACE
 16076             MOVE ER-2754        TO WS-ERROR
 16077             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16078           ELSE
 16079             MOVE ER-2736        TO WS-ERROR
 16080             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16081**********************************
 16082
 16083 3773-CONTINUE.
 16084
 16085     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16086        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16087           MOVE ER-2723          TO WS-ERROR
 16088           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16089
 16090     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16091        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16092           MOVE ER-2724          TO WS-ERROR
 16093           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16094
 16095     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16096         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16097             (1 + WS-LF-REFUND-OVS-PCT)
 16098     ELSE
 16099         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16100
 16101     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16102         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16103             (1 - WS-TOL-LF-REFUND-PCT)
 16104     ELSE
 16105         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16106
 16107     IF (PB-COMPANY-ID = 'DCC')
 16108        AND (PB-CI-ENTRY-STATUS = 'M')
 16109        AND (PB-C-LF-CANCEL-AMT > +0)
 16110        MOVE ER-3843             TO WS-ERROR
 16111        PERFORM 9900-ERROR-FORMAT
 16112                                 THRU 9900-EXIT
 16113     END-IF
 16114     EVALUATE TRUE
 16115        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16116           CONTINUE
 16117        WHEN PB-C-LF-CANCEL-AMT = +0
 16118                 AND PB-C-LF-REF-CALC > +0
 16119           CONTINUE
 16120        WHEN WS-LF-REFUND-OVS-AMT = 0
 16121                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 293
* EL050.cbl
 16122           CONTINUE
 16123        WHEN OTHER
 16124           IF WS-TOL-LF-REFUND  = +0
 16125              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16126           END-IF
 16127           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16128                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16129                          (PB-C-LF-CANCEL-AMT))
 16130              CONTINUE
 16131           ELSE
 16132              IF WS-LF-REFUND-OVS-AMT = +0
 16133                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16134              END-IF
 16135              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16136                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16137                                       PB-C-LF-CANCEL-AMT)
 16138                 CONTINUE
 16139              ELSE
 16140                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16141                   MOVE ER-2754   TO  WS-ERROR
 16142                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16143                 ELSE
 16144                    MOVE ER-2736   TO  WS-ERROR
 16145                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16146                 END-IF
 16147              END-IF
 16148           END-IF
 16149     END-EVALUATE.
 16150
 16151     EVALUATE TRUE
 16152        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16153           CONTINUE
 16154        WHEN PB-C-LF-CANCEL-AMT = +0
 16155                 AND PB-C-LF-REF-CALC > +0
 16156           CONTINUE
 16157        WHEN OTHER
 16158           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16159               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16160              CONTINUE
 16161           ELSE
 16162              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16163               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16164                CONTINUE
 16165              ELSE
 16166                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16167                     MOVE ER-2754   TO  WS-ERROR
 16168                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16169                 ELSE
 16170                     MOVE ER-2736   TO  WS-ERROR
 16171                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16172                 END-IF
 16173              END-IF
 16174           END-IF
 16175     END-EVALUATE.
 16176
 16177     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16178         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16179             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 294
* EL050.cbl
 16180     ELSE
 16181         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16182
 16183     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16184         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16185             (1 - WS-TOL-AH-REFUND-PCT)
 16186     ELSE
 16187         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16188
 16189     IF (PB-COMPANY-ID = 'DCC')
 16190        AND (PB-CI-ENTRY-STATUS = 'M')
 16191        AND (PB-C-AH-CANCEL-AMT > +0)
 16192        MOVE ER-3843             TO WS-ERROR
 16193        PERFORM 9900-ERROR-FORMAT
 16194                                 THRU 9900-EXIT
 16195     END-IF
 16196     EVALUATE TRUE
 16197        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16198           CONTINUE
 16199*       WHEN PB-C-AH-REF-CALC = +0 AND
 16200*                  PB-C-AH-CANCEL-AMT > +0
 16201        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16202                   PB-C-AH-REF-CALC > +0
 16203           CONTINUE
 16204        WHEN WS-AH-REFUND-OVS-AMT = +0
 16205                AND WS-TOL-AH-REFUND = +0
 16206           CONTINUE
 16207        WHEN OTHER
 16208           IF WS-TOL-AH-REFUND = +0
 16209              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16210           END-IF
 16211           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16212               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16213                                         PB-C-AH-CANCEL-AMT)
 16214              CONTINUE
 16215           ELSE
 16216              IF WS-AH-REFUND-OVS-AMT = +0
 16217                 MOVE +9999999.99 TO
 16218                         WS-AH-REFUND-OVS-AMT
 16219              END-IF
 16220              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16221                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16222                                         PB-C-AH-CANCEL-AMT)
 16223                 CONTINUE
 16224              ELSE
 16225                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16226                    MOVE ER-2754   TO  WS-ERROR
 16227                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16228                 ELSE
 16229                    MOVE ER-2736   TO  WS-ERROR
 16230                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16231                 END-IF
 16232              END-IF
 16233           END-IF
 16234     END-EVALUATE.
 16235
 16236     EVALUATE TRUE
 16237        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 295
* EL050.cbl
 16238           CONTINUE
 16239*       WHEN PB-C-AH-REF-CALC > +0 AND
 16240*                  PB-C-AH-CANCEL-AMT = +0
 16241        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16242                   PB-C-AH-REF-CALC = +0
 16243           CONTINUE
 16244        WHEN OTHER
 16245           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16246               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16247              CONTINUE
 16248           ELSE
 16249              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16250                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16251                 CONTINUE
 16252              ELSE
 16253                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16254                     MOVE ER-2754   TO  WS-ERROR
 16255                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16256                 ELSE
 16257                     MOVE ER-2736   TO  WS-ERROR
 16258                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16259                 END-IF
 16260              END-IF
 16261           END-IF
 16262     END-EVALUATE.
 16263
 16264     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16265        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16266        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16267           AND  PB-C-LF-REF-CALC < +1.00
 16268           AND  PB-C-AH-REF-CALC < +1.00
 16269           CONTINUE
 16270        ELSE
 16271           IF (PB-COMPANY-ID = 'DCC')
 16272              AND (PB-CI-ENTRY-STATUS = 'M')
 16273              CONTINUE
 16274           ELSE
 16275              MOVE ER-2741       TO WS-ERROR
 16276              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16277           END-IF
 16278        END-IF
 16279     END-IF
 16280
 16281     IF (PB-C-LF-CANCEL-AMT = ZERO
 16282        AND WS-LF-BENEFIT-CD NOT = ZERO
 16283        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16284        AND PB-C-LF-REF-CALC NOT = ZERO)
 16285        OR
 16286        (PB-C-LF-CANCEL-AMT = ZERO
 16287        AND WS-LF-BENEFIT-CD NOT = ZERO
 16288        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16289             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16290                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16291                NEXT SENTENCE
 16292             ELSE
 16293                MOVE ER-2739        TO WS-ERROR
 16294                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16295
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 296
* EL050.cbl
 16296     IF (PB-C-AH-CANCEL-AMT = ZERO
 16297        AND WS-AH-BENEFIT-CD NOT = ZERO
 16298        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16299        AND PB-C-AH-REF-CALC NOT = ZERO)
 16300        OR
 16301        (PB-C-AH-CANCEL-AMT = ZERO
 16302        AND WS-AH-BENEFIT-CD NOT = ZERO
 16303        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16304             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16305                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16306                NEXT SENTENCE
 16307             ELSE
 16308                MOVE ER-2738        TO WS-ERROR
 16309                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16310
 16311 3775-OVER-REF-CHK.
 16312
 16313     IF PB-CI-ENTRY-STATUS = '5'
 16314        GO TO 3780-UPDATE-CANCEL-CERT.
 16315
 16316     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16317                              PB-CI-LF-ALT-PREMIUM-AMT.
 16318
 16319     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16320        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16321                                 PB-C-LF-REF-CALC
 16322      ELSE
 16323        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16324                                 PB-C-LF-CANCEL-AMT.
 16325
 16326     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16327        MOVE ER-2755             TO WS-ERROR
 16328        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16329
 16330     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16331
 16332     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16333        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16334                                 PB-C-AH-REF-CALC
 16335      ELSE
 16336        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16337                                 PB-C-AH-CANCEL-AMT.
 16338
 16339     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16340        MOVE ER-2778             TO WS-ERROR
 16341        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16342
 16343     IF PB-CI-OB-FLAG NOT = 'Z'
 16344        NEXT SENTENCE
 16345       ELSE
 16346         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16347            MOVE ER-2757           TO WS-ERROR
 16348            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16349
 16350 3780-UPDATE-CANCEL-CERT.
 16351
 16352     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16353        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 297
* EL050.cbl
 16354        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16355
 16356     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16357         MOVE ER-2729              TO WS-ERROR
 16358         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16359
 16360     IF PB-CI-LF-BENEFIT-CD = ZERO
 16361         GO TO 3780-UPDATE-CONT-1.
 16362
 16363     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16364         GO TO 3780-UPDATE-CONT-1.
 16365
 16366     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16367       AND
 16368        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16369       AND
 16370        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16371       AND
 16372        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16373            NEXT SENTENCE
 16374       ELSE
 16375        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16376          AND
 16377***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16378***       AND
 16379           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16380            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16381               MOVE ER-2730      TO WS-ERROR
 16382               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16383               GO TO 3999-END-EDIT
 16384            ELSE
 16385               GO TO 3999-END-EDIT
 16386        ELSE
 16387            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16388               MOVE ER-2765           TO WS-ERROR
 16389               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16390               GO TO 3785-CHECK-NH.
 16391*              GO TO 3999-END-EDIT.
 16392
 16393 3780-UPDATE-CONT-1.
 16394     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16395
 16396     IF PB-CI-AH-BENEFIT-CD = ZERO
 16397         GO TO 3780-UPDATE-CONT-2.
 16398
 16399     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16400         GO TO 3780-UPDATE-CONT-2.
 16401
 16402     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16403
 16404     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16405       AND
 16406        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16407       AND
 16408        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16409       AND
 16410        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16411            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 298
* EL050.cbl
 16412       ELSE
 16413        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16414          AND
 16415***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16416***       AND
 16417           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16418           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16419            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16420               MOVE ER-2773      TO WS-ERROR
 16421               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16422               GO TO 3999-END-EDIT
 16423            ELSE
 16424               GO TO 3999-END-EDIT
 16425            END-IF
 16426           ELSE
 16427             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16428                MOVE ER-2890 TO WS-ERROR
 16429                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16430                GO TO 3999-END-EDIT
 16431             ELSE
 16432                GO TO 3785-CHECK-NH
 16433             END-IF
 16434           END-IF
 16435          ELSE
 16436            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16437              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16438                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16439                   MOVE ER-2890 TO WS-ERROR
 16440                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16441                   GO TO 3999-END-EDIT
 16442                ELSE
 16443                   MOVE ER-2765 TO WS-ERROR
 16444                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16445                   GO TO 3785-CHECK-NH
 16446                END-IF
 16447              ELSE
 16448               MOVE ER-2765      TO WS-ERROR
 16449               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16450               GO TO 3785-CHECK-NH.
 16451*              GO TO 3999-END-EDIT.
 16452
 16453 3780-UPDATE-CONT-2.
 16454
 16455     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16456        AND WS-LF-BENEFIT-CD = ZERO
 16457           MOVE ER-2743           TO WS-ERROR
 16458           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16459
 16460     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16461        AND WS-AH-BENEFIT-CD = ZERO
 16462           MOVE ER-2744           TO WS-ERROR
 16463           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16464
 16465     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16466        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16467        AND
 16468        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16469         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 299
* EL050.cbl
 16470           MOVE ER-2746           TO WS-ERROR
 16471           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16472
 16473     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16474       AND
 16475        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16476             MOVE ER-2737        TO WS-ERROR
 16477             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16478
 16479     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16480       AND
 16481        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16482             MOVE ER-2737        TO WS-ERROR
 16483             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16484
 16485     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16486         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16487             OR 'CID' OR 'DCC'
 16488             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16489         ELSE
 16490             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16491                 MOVE ER-2768    TO WS-ERROR
 16492                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16493             ELSE
 16494                 MOVE ER-2756    TO WS-ERROR
 16495                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16496
 16497     IF CERT-PEND-ISSUE-RETURNED
 16498        MOVE ER-2772             TO WS-ERROR
 16499        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16500 3785-CHECK-NH.
 16501     IF PB-STATE NOT = 'NH'
 16502        GO TO 3999-END-EDIT
 16503     END-IF
 16504
 16505     MOVE ER-2796                TO WS-ERROR
 16506     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16507     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16508        OR (CM-NH-INTERFACE-SW = 'Y')
 16509        MOVE ER-2793             TO WS-ERROR
 16510        PERFORM 9900-ERROR-FORMAT
 16511                                 THRU 9900-EXIT
 16512     END-IF
 16513     MOVE +0                     TO WS-PAYMENT-AMT
 16514     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16515        GO TO 3999-END-EDIT
 16516     END-IF
 16517     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16518        GO TO 3999-END-EDIT
 16519     END-IF
 16520     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16521     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16522     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16523        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16524     END-IF
 16525     MOVE '1'                    TO DC-OPTION-CODE
 16526     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16527     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 300
* EL050.cbl
 16528        IF DC-ELAPSED-DAYS < +16
 16529           GO TO 3999-END-EDIT
 16530        END-IF
 16531     END-IF
 16532     MOVE +0                     TO DC-ELAPSED-DAYS
 16533     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16534     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16535     MOVE '1'                    TO DC-OPTION-CODE
 16536     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16537     IF NO-CONVERSION-ERROR
 16538        IF DC-ELAPSED-DAYS > +30
 16539           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16540        ELSE
 16541           GO TO 3999-END-EDIT
 16542        END-IF
 16543     ELSE
 16544        GO TO 3999-END-EDIT
 16545     END-IF
 16546     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16547        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16548           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16549     IF WS-PAYMENT-AMT < 600.00
 16550        GO TO 3999-END-EDIT
 16551     END-IF
 16552     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16553
 16554     IF (ERMAIL-FOUND = ' ')
 16555         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16556         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16557        GO TO 3999-END-EDIT
 16558     END-IF
 16559     MOVE ER-2795                TO WS-ERROR
 16560     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16561
 16562     GO TO 3999-END-EDIT.
 16563******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 301
* EL050.cbl
 16565 3990-FILES-NOT-OPEN.
 16566
 16567     MOVE ER-2617                TO WS-ERROR.
 16568     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16569     GO TO 9990-RETURN.
 16570
 16571 3999-END-EDIT.
 16572
 16573     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16574
 16575     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16576         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16577         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16578             PERFORM 9250-UNLOCK-RETURN
 16579             GO TO 9990-RETURN
 16580          ELSE
 16581             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16582             GO TO 9990-RETURN.
 16583
 16584     IF PB-CANCELLATION
 16585          GO TO 9990-RETURN.
 16586
 16587     IF CERT-WAS-NOT-FOUND
 16588        MOVE SPACES              TO CERTIFICATE-MASTER.
 16589
 16590     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16591
 16592     IF CERT-WAS-FOUND
 16593         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16594             PERFORM 9250-UNLOCK-RETURN
 16595          ELSE
 16596            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16597      ELSE
 16598         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16599
 16600     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16601        IF PB-COMPANY-ID = 'DCC' AND
 16602           (PB-CARRIER = '2' OR '4' OR '6')
 16603              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16604        END-IF
 16605     END-IF.
 16606
 16607     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16608     IF ((PB-COMPANY-ID = 'DCC')
 16609        AND (WS-NO-SECURE-PAY))
 16610                  OR
 16611        (WS-LF-SPECIAL-CALC-CD = 'O'
 16612        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16613        SET SKIP-ADDR-EDIT       TO TRUE
 16614     END-IF
 16615     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16616        AND (NOT SKIP-ADDR-EDIT)
 16617        MOVE ER-2963             TO WS-ERROR
 16618        PERFORM 9900-ERROR-FORMAT
 16619                                 THRU 9900-EXIT
 16620        GO TO 9990-RETURN
 16621     END-IF
 16622     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 302
* EL050.cbl
 16623     IF ERPNDM-FOUND NOT = 'X'
 16624        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16625           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16626           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16627           AND (NOT SKIP-ADDR-EDIT)
 16628           MOVE ER-2694          TO WS-ERROR
 16629           PERFORM 9900-ERROR-FORMAT
 16630                                 THRU 9900-EXIT
 16631        END-IF
 16632        MOVE ' '                 TO STATE-RECORD-ERROR
 16633        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16634        MOVE PM-STATE            TO CNTL-ACCESS
 16635        MOVE '3'                 TO CNTL-REC-TYPE
 16636        MOVE +0                  TO CNTL-SEQ-NO
 16637        MOVE '0'                 TO RC-SW-2
 16638        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16639        IF (NO-STATE-RECORD)
 16640           OR (CF-RECORD-TYPE NOT = '3')
 16641           OR (PM-STATE NOT = CF-STATE-CODE)
 16642           IF (PM-STATE = SPACES)
 16643              AND (SKIP-ADDR-EDIT)
 16644              CONTINUE
 16645           ELSE
 16646              MOVE ER-2963       TO WS-ERROR
 16647              PERFORM 9900-ERROR-FORMAT
 16648                                 THRU 9900-EXIT
 16649           END-IF
 16650        END-IF
 16651        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16652           MOVE ER-2883          TO WS-ERROR
 16653           PERFORM 9900-ERROR-FORMAT
 16654                                 THRU 9900-EXIT
 16655        END-IF
 16656        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16657           MOVE ' '                 TO STATE-RECORD-ERROR
 16658           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16659           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16660           MOVE '3'                 TO CNTL-REC-TYPE
 16661           MOVE +0                  TO CNTL-SEQ-NO
 16662           MOVE '0'                 TO RC-SW-2
 16663           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16664           IF NO-STATE-RECORD
 16665              OR (CF-RECORD-TYPE NOT = '3')
 16666              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16667              MOVE ER-2964          TO WS-ERROR
 16668              PERFORM 9900-ERROR-FORMAT
 16669                                    THRU 9900-EXIT
 16670           END-IF
 16671        END-IF
 16672     ELSE
 16673        IF NOT SKIP-ADDR-EDIT
 16674           MOVE ER-2393          TO WS-ERROR
 16675           PERFORM 9900-ERROR-FORMAT
 16676                                 THRU 9900-EXIT
 16677        END-IF
 16678     END-IF
 16679
 16680     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 303
* EL050.cbl
 16681
 16682     IF (ERMAIL-FOUND = ' ' AND
 16683        ERPNDM-FOUND = ' ')
 16684        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16685           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16686           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16687          OR
 16688           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16689          OR
 16690           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16691           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16692           GO TO 3999-UNLOCK-ERMAIL.
 16693
 16694     IF ERPNDM-FOUND = 'X'
 16695        GO TO 3999-UNLOCK-ERMAIL.
 16696
 16697     IF PM-INSURED-LAST-NAME      = SPACES
 16698        AND PM-INSURED-FIRST-NAME = SPACES
 16699        AND PM-ADDRESS-LINE-1     = SPACES
 16700        AND PM-ADDRESS-LINE-2     = SPACES
 16701        AND PM-CITY-STATE         = SPACES
 16702        AND PM-CRED-BENE-NAME     = SPACES
 16703        AND PM-CRED-BENE-ADDR     = SPACES
 16704        AND PM-CRED-BENE-CTYST    = SPACES
 16705        GO TO 3999-UNLOCK-ERMAIL
 16706     END-IF
 16707
 16708     MOVE SPACES                 TO MAILING-DATA.
 16709
 16710     MOVE 'MA'                   TO MA-RECORD-ID.
 16711     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16712     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16713     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16714     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16715     MOVE PB-SV-STATE            TO MA-STATE.
 16716     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16717     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16718
 16719     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16720     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16721
 16722     IF ERMAIL-FOUND = ' '
 16723        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16724     ELSE
 16725        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16726        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16727        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16728
 16729     GO TO 9990-RETURN.
 16730
 16731 3999-UNLOCK-ERMAIL.
 16732     IF ERMAIL-FOUND = ' '
 16733        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16734
 16735     GO TO 9990-RETURN.
 16736******************************************************************
 16737
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 304
* EL050.cbl
 16739 4000-UPDATE-CANCELLED-CERT.
 16740     IF CERT-WAS-NOT-FOUND
 16741        GO TO 4299-EXIT.
 16742
 16743*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16744     IF PB-C-NH-INT-ON-REFS > ZEROS
 16745        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 16746     END-IF
 16747     IF PB-C-REF-INTERFACE-SW = 'Y'
 16748        MOVE PB-C-REF-INTERFACE-SW
 16749                                 TO CM-NH-INTERFACE-SW
 16750     END-IF
 16751     IF PB-C-POST-CARD-IND = 'Y'
 16752        MOVE +8                  TO SUB
 16753        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 16754        IF ERMAIL-FOUND = ' '
 16755           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 16756              (SUB > +7)
 16757              OR (MA-MAIL-STATUS (SUB) = '1')
 16758           END-PERFORM
 16759        END-IF
 16760        IF (SUB > +7)
 16761           OR (ERMAIL-FOUND = 'X')
 16762           MOVE ER-3789          TO WS-ERROR
 16763           PERFORM 9900-ERROR-FORMAT
 16764                                 THRU 9900-EXIT
 16765        END-IF
 16766     ELSE
 16767        MOVE 'N'                 TO PB-C-POST-CARD-IND
 16768     END-IF
 16769     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 16770
 16771     IF PB-CI-OB-FLAG = 'Z'
 16772        GO TO 4150-SUMMARY-CERT-CANCEL.
 16773
 16774     IF PB-C-LF-CANCEL-VOIDED
 16775         PERFORM 4200-REVERSE-LF-CANCEL.
 16776     IF PB-C-AH-CANCEL-VOIDED
 16777         PERFORM 4200-REVERSE-AH-CANCEL.
 16778
 16779 4100-APPLY-LF-CANCEL.
 16780
 16781     MOVE +0                     TO WS-SUB.
 16782
 16783 4100-CHECK-LF-ERRORS.
 16784
 16785     ADD +1                       TO WS-SUB.
 16786
 16787     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16788        IF LF-COVERAGE-CANCELLED
 16789           GO TO 4100-LF-CANCEL-CONT
 16790        ELSE
 16791           GO TO 4100-UPDATE-LF-COVERAGE.
 16792
 16793     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16794                                   ER-2729 OR
 16795                                   ER-2730 OR
 16796                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 305
* EL050.cbl
 16797                                   ER-2732 OR
 16798                                   ER-2737 OR
 16799                                   ER-2740 OR
 16800                                   ER-2743 OR
 16801                                   ER-2749 OR
 16802                                   ER-2750 OR
 16803                                   ER-2755 OR
 16804                                   ER-2757 OR
 16805                                   ER-2760 OR
 16806                                   ER-2772 OR
 16807                                   ER-2774 OR
 16808                                   ER-2776 OR
 16809                                   ER-2794
 16810        GO TO 4100-UPDATE-LF-COVERAGE.
 16811
 16812     GO TO 4100-CHECK-LF-ERRORS.
 16813
 16814 4100-UPDATE-LF-COVERAGE.
 16815
 16816     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 16817     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 16818     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 16819        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 16820     END-IF
 16821     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16822                                      TO CM-CREDIT-INTERFACE-SW-2.
 16823     IF CM-LF-CANCEL-DT = LOW-VALUE
 16824         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 16825
 16826     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 16827         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 16828                                         CM-LF-STATUS-AT-CANCEL.
 16829
 16830     GO TO 4100-APPLY-AH-CANCEL.
 16831
 16832 4100-LF-CANCEL-CONT.
 16833     IF PB-C-LF-CANCEL-VOIDED
 16834         GO TO 4100-APPLY-AH-CANCEL.
 16835
 16836     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16837         GO TO 4100-APPLY-AH-CANCEL.
 16838
 16839     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 16840        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16841           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 16842        ELSE
 16843           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 16844
 16845     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 16846     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 16847
 16848     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 16849         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 16850
 16851     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 16852        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 16853         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 16854         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 306
* EL050.cbl
 16855
 16856     IF PB-RECORD-RETURNED
 16857        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16858      ELSE
 16859        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 16860
 16861 4100-APPLY-AH-CANCEL.
 16862
 16863     MOVE +0                      TO WS-SUB.
 16864
 16865 4100-CHECK-AH-ERRORS.
 16866
 16867     ADD +1                       TO WS-SUB.
 16868
 16869     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16870        IF AH-COVERAGE-CANCELLED
 16871           GO TO 4100-AH-CANCEL-CONT
 16872        ELSE
 16873           GO TO 4100-UPDATE-AH-COVERAGE.
 16874
 16875     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16876                                   ER-2729 OR
 16877                                   ER-2732 OR
 16878                                   ER-2737 OR
 16879                                   ER-2740 OR
 16880                                   ER-2744 OR
 16881                                   ER-2749 OR
 16882                                   ER-2750 OR
 16883                                   ER-2755 OR
 16884                                   ER-2757 OR
 16885                                   ER-2760 OR
 16886                                   ER-2771 OR
 16887                                   ER-2772 OR
 16888                                   ER-2773 OR
 16889                                   ER-2775 OR
 16890                                   ER-2777 OR
 16891                                   ER-2794
 16892        GO TO 4100-UPDATE-AH-COVERAGE.
 16893
 16894     GO TO 4100-CHECK-AH-ERRORS.
 16895
 16896 4100-UPDATE-AH-COVERAGE.
 16897
 16898     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 16899     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 16900     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 16901     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16902                                      TO CM-CREDIT-INTERFACE-SW-2.
 16903     IF CM-AH-CANCEL-DT = LOW-VALUE
 16904         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 16905
 16906     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 16907         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 16908                                         CM-AH-STATUS-AT-CANCEL.
 16909
 16910     IF LF-COVERAGE-CANCELLED
 16911         IF PB-RECORD-RETURNED
 16912              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 307
* EL050.cbl
 16913          ELSE
 16914              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 16915
 16916     GO TO 4299-EXIT.
 16917
 16918 4100-AH-CANCEL-CONT.
 16919     IF PB-C-AH-CANCEL-VOIDED
 16920         GO TO 4299-EXIT.
 16921
 16922     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16923         GO TO 4299-EXIT.
 16924
 16925     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 16926        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16927           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 16928        ELSE
 16929           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 16930
 16931     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 16932     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 16933
 16934     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 16935         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 16936
 16937     IF CM-AH-STATUS-AT-CANCEL = SPACE
 16938         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 16939         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 16940
 16941     IF PB-RECORD-RETURNED
 16942        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 16943      ELSE
 16944        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 16945
 16946     GO TO 4299-EXIT.
 16947
 16948 4150-SUMMARY-CERT-CANCEL.
 16949     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 16950
 16951     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16952        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16953                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 16954     ELSE
 16955        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16956                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 16957
 16958     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16959        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16960                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 16961     ELSE
 16962        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16963                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 16964
 16965     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16966        NEXT SENTENCE
 16967     ELSE
 16968        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 16969
 16970     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 308
* EL050.cbl
 16971
 16972 4200-REVERSE-LF-CANCEL.
 16973     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 16974
 16975     IF CM-LF-CANCEL-APPLIED
 16976        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 16977        MOVE SPACES                TO CM-LF-EXIT-BATCH
 16978        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 16979
 16980     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 16981
 16982     IF PB-RECORD-RETURNED
 16983        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16984       ELSE
 16985        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 16986
 16987 4200-REVERSE-LF-EXIT.
 16988       EXIT.
 16989
 16990 4200-REVERSE-AH-CANCEL.
 16991     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 16992
 16993     IF CM-AH-CANCEL-APPLIED
 16994        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 16995        MOVE SPACES                TO CM-AH-EXIT-BATCH
 16996        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 16997
 16998     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 16999
 17000     IF PB-RECORD-RETURNED
 17001        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17002       ELSE
 17003        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17004
 17005 4200-REVERSE-AH-EXIT.
 17006       EXIT.
 17007
 17008 4299-EXIT.
 17009       EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 309
* EL050.cbl
 17011
 17012 4500-UPDATE-NEW-CERT.
 17013     IF CERT-WAS-FOUND
 17014         NEXT SENTENCE
 17015       ELSE
 17016         GO TO 4520-BUILD-NEW-KEY.
 17017
 17018     IF  CLASIC-CREATED-CERT
 17019         GO TO 4999-EXIT.
 17020
 17021     IF  CERT-WAS-CREATED-FOR-CLAIM
 17022         GO TO 4520-BUILD-NEW-KEY.
 17023
 17024     IF CERT-ADDED-BATCH
 17025        IF CM-RECORD-ID = 'CM'
 17026            GO TO 4999-EXIT.
 17027
 17028 4520-BUILD-NEW-KEY.
 17029* BUILD CONTROL PRIMARY
 17030
 17031     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17032                                       CM-COMPANY-CD-A1
 17033                                       CM-COMPANY-CD-A2
 17034                                       CM-COMPANY-CD-A4
 17035                                       CM-COMPANY-CD-A5.
 17036
 17037     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17038     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17039     MOVE PB-SV-STATE               TO CM-STATE.
 17040     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17041     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17042     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17043     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17044
 17045     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17046
 17047     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17048     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17049     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17050     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17051
 17052     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17053        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17054
 17055     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17056         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17057         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17058         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17059         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17060     ELSE
 17061         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17062
 17063     IF PB-COMPANY-ID   EQUAL  'CRI'
 17064         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17065         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17066         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17067         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17068         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 310
* EL050.cbl
 17069
 17070     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17071        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17072         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17073
 17074     IF PB-COMPANY-ID  = 'LBL'
 17075        IF PB-I-JOINT-COVERAGE
 17076            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17077                                           PB-I-MEMBER-NO
 17078            GO TO 4550-CONT-CERT-PROCESS.
 17079
 17080     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17081        NEXT SENTENCE
 17082     ELSE
 17083        GO TO 4540-BUILD-MEMBER-NO.
 17084
 17085******************************************************************
 17086*                                                                *
 17087*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17088*    FOR 'MON'.                                                  *
 17089*                                                                *
 17090******************************************************************
 17091
 17092     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17093     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17094     MOVE +1                     TO WS-SUB1
 17095                                    WS-SUB2.
 17096
 17097 4530-EDIT-MEMB-NAME.
 17098
 17099     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17100        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17101        ADD +1                       TO WS-SUB2.
 17102
 17103     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17104        ADD +1                       TO WS-SUB1
 17105        GO TO 4530-EDIT-MEMB-NAME.
 17106
 17107     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17108     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17109     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17110*    MOVE SPACE                      TO DC-OPTION-CODE.
 17111     SET  BIN-TO-GREG                TO TRUE.
 17112     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17113     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17114
 17115     GO TO 4550-CONT-CERT-PROCESS.
 17116
 17117******************************************************************
 17118*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17119******************************************************************
 17120
 17121 4540-BUILD-MEMBER-NO.
 17122
 17123     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17124         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17125         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17126         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 311
* EL050.cbl
 17127         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17128     ELSE
 17129         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17130
 17131     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17132        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17133         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17134
 17135 4550-CONT-CERT-PROCESS.
 17136
 17137*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17138*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17139*    ELSE
 17140*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17141
 17142     IF CERT-WAS-CREATED-FOR-CLAIM
 17143        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17144        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17145
 17146     IF CERT-AND-CLAIM-ONLINE
 17147        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17148        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17149
 17150     MOVE 'CM'                     TO CM-RECORD-ID.
 17151     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17152
 17153     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17154        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17155        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17156     ELSE
 17157        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17158        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17159
 17160     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17161     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17162     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17163     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17164     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17165     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17166     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17167                                      CM-LF-ITD-CANCEL-AMT
 17168                                      CM-LF-ITD-DEATH-AMT
 17169                                      CM-AH-ITD-AH-PMT
 17170                                      CM-AH-ITD-LUMP-PMT
 17171                                      CM-AH-ITD-CANCEL-AMT
 17172                                      CM-LF-NSP-PREMIUM-AMT
 17173                                      CM-AH-NSP-PREMIUM-AMT.
 17174*                                     CM-CLAIM-DEDUCT-WITHHELD
 17175*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17176     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17177     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17178     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17179     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17180     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17181     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17182     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17183     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17184     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 312
* EL050.cbl
 17185     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17186     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17187     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17188
 17189     IF PB-I-LIVES NOT NUMERIC
 17190         MOVE ZERO                 TO PB-I-LIVES.
 17191
 17192     IF PB-I-NUM-BILLED NOT NUMERIC
 17193         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17194
 17195     MOVE PB-I-LIVES               TO CM-LIVES.
 17196     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17197
 17198     IF PB-COMPANY-ID EQUAL  'DMD'
 17199         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17200         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17201
 17202     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17203     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17204     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17205     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17206     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17207     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17208
 17209     IF PB-I-LF-POLICY-FEE NUMERIC
 17210        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17211     ELSE
 17212        MOVE +0                    TO CM-LF-POLICY-FEE.
 17213
 17214     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17215        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17216        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17217     ELSE
 17218        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17219
 17220     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17221     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17222     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17223     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17224     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17225     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17226     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17227     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17228     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17229
 17230     IF PB-I-AH-POLICY-FEE NUMERIC
 17231        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17232     ELSE
 17233        MOVE +0                    TO CM-AH-POLICY-FEE.
 17234
 17235     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17236        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17237     ELSE
 17238        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17239
 17240     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17241     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17242
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 313
* EL050.cbl
 17243     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17244                                      CM-LF-DEATH-EXIT-DT
 17245                                      CM-AH-SETTLEMENT-EXIT-DT.
 17246
 17247*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17248*                       'TIH' OR 'OFL' OR 'FLA' OR
 17249*                       'TII' OR 'TMS' OR 'CRI' OR
 17250*                       'NCL'
 17251     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17252
 17253     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17254         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17255            MOVE '2'                TO CM-PREMIUM-TYPE.
 17256
 17257     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17258         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17259            MOVE '2'                TO CM-PREMIUM-TYPE.
 17260
 17261     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17262         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17263     ELSE
 17264         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17265         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17266
 17267     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17268     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17269     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17270     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17271     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17272     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17273     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17274     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17275
 17276     IF PB-NO-MONTHS-SKIPPED
 17277         MOVE SPACE                 TO CM-SKIP-CODE
 17278     ELSE
 17279         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17280
 17281     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17282     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17283                                       CM-LF-STATUS-AT-CANCEL.
 17284
 17285     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17286     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17287                                       CM-AH-STATUS-AT-CANCEL.
 17288
 17289     MOVE '1'                       TO CM-ENTRY-STATUS.
 17290
 17291     IF PB-REISSUED-CERT
 17292        MOVE '5'                    TO CM-ENTRY-STATUS.
 17293
 17294     IF PB-MONTHLY-CERT
 17295        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17296
 17297     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17298     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17299     IF PB-POLICY-IS-DECLINED
 17300        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 314
* EL050.cbl
 17301
 17302     IF PB-POLICY-IS-VOIDED
 17303        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17304
 17305     IF PB-NEEDS-UNDERWRITING
 17306        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17307
 17308     IF PB-REIN-ONLY-CERT
 17309        MOVE '9'                    TO CM-ENTRY-STATUS.
 17310
 17311     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17312         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17313     ELSE
 17314         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17315
 17316     IF PB-RECORD-RETURNED
 17317        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17318      ELSE
 17319        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17320
 17321     IF PB-I-MAIL-ADDRS-PRESENT
 17322        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17323
 17324     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17325                                       CM-ENTRY-DT.
 17326
 17327 4999-EXIT.
 17328     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 315
* EL050.cbl
 17330
 17331 5000-PROCESS-REPS.
 17332     MOVE ' '                    TO AGTC-MASTER-SW
 17333     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17334     MOVE CO-TYPE                TO AGTC-TYPE
 17335     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17336     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17337     IF (AGTC-MASTER-SW NOT = 'N')
 17338        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17339        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17340        PERFORM 8583-READ-ERAGTC-NEXT
 17341                                 THRU 8583-EXIT
 17342     END-IF
 17343     IF AGTC-MASTER-SW = 'N'
 17344        CONTINUE
 17345     ELSE
 17346        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17347           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17348              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17349              MOVE 'Y'           TO AGTC-MASTER-SW
 17350           END-IF
 17351        END-IF
 17352     END-IF
 17353     .
 17354 5000-EXIT.
 17355     EXIT.
 17356 6370-EDIT-INPUT-LF-CODE.
 17357     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17358        MOVE +1                  TO SUB
 17359        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17360        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17361        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17362        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17363        GO TO 6370-SEARCH-LOOP.
 17364
 17365     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17366
 17367     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17368     MOVE SPACES                 TO CNTL-ACCESS.
 17369*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17370     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17371     MOVE +0                     TO CNTL-SEQ-NO.
 17372     MOVE '4' TO RC-SW-2.
 17373     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17374
 17375     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17376        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17377        GO TO 6370-NO-LF-FOUND.
 17378
 17379     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17380     MOVE +1                     TO SUB.
 17381
 17382 6370-SEARCH-LOOP.
 17383     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17384         GO TO 6370-NO-LF-FOUND.
 17385
 17386     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17387         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 316
* EL050.cbl
 17388         GO TO 6370-HER-NET-PAY-CHECK.
 17389
 17390     ADD 1   TO SUB.
 17391*    IF SUB GREATER 120
 17392     IF SUB GREATER 200
 17393         GO TO 6370-NO-LF-FOUND.
 17394
 17395     GO TO 6370-SEARCH-LOOP.
 17396
 17397 6370-NO-LF-FOUND.
 17398
 17399     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17400
 17401 6370-HER-NET-PAY-CHECK.
 17402
 17403     IF PB-COMPANY-ID = 'CID'
 17404        IF PB-SV-STATE = 'CA' OR 'MN'
 17405           IF PB-I-LF-BENEFIT-CD = '02'
 17406              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17407           ELSE
 17408              IF PB-I-LF-BENEFIT-CD = '04'
 17409                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17410              END-IF
 17411           END-IF
 17412        END-IF
 17413     END-IF
 17414
 17415     IF PB-COMPANY-ID NOT = 'HER'
 17416         GO TO 6370-EXIT.
 17417
 17418     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17419         GO TO 6370-EXIT.
 17420
 17421     IF PB-I-LF-TERM NOT NUMERIC
 17422         MOVE ZEROS              TO PB-I-LF-TERM.
 17423
 17424     IF PB-I-LOAN-TERM NOT NUMERIC
 17425         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17426
 17427     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17428         GO TO 6370-EXIT.
 17429
 17430     IF PB-I-LF-BENEFIT-CD = '33'
 17431         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17432
 17433     IF PB-I-LF-BENEFIT-CD = '34'
 17434         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17435
 17436 6370-EXIT.
 17437     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 317
* EL050.cbl
 17439
 17440 6380-EDIT-INPUT-AH-CODE.
 17441     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17442        MOVE +1                  TO SUB
 17443        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17444        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17445        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17446        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17447        GO TO 6380-SEARCH-LOOP.
 17448
 17449     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17450
 17451     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17452     MOVE SPACES                 TO CNTL-ACCESS.
 17453     MOVE 'A'                    TO CNTL-REC-TYPE.
 17454*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17455     MOVE +0                     TO CNTL-SEQ-NO.
 17456     MOVE '5' TO RC-SW-2.
 17457     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17458
 17459     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17460        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17461        GO TO 6380-NO-AH-FOUND.
 17462
 17463     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17464     MOVE +1 TO SUB.
 17465
 17466 6380-SEARCH-LOOP.
 17467     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17468         GO TO 6380-NO-AH-FOUND.
 17469
 17470     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17471         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17472         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17473
 17474     ADD 1   TO SUB.
 17475     IF SUB GREATER THAN 96
 17476*    IF SUB GREATER THAN 300
 17477         GO TO 6380-NO-AH-FOUND.
 17478
 17479     GO TO 6380-SEARCH-LOOP.
 17480
 17481 6380-NO-AH-FOUND.
 17482
 17483     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17484
 17485     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17486         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17487     ELSE
 17488         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17489
 17490 6380-CSO-AH-ONLY-CHECKS.
 17491
 17492     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17493        NEXT SENTENCE
 17494      ELSE
 17495        GO TO 6380-EXIT.
 17496
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 318
* EL050.cbl
 17497     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17498         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17499
 17500
 17501     GO TO 6380-EXIT
 17502     .
 17503 6380-CSO-LIFE-WITH-AH-CHECKS.
 17504
 17505
 17506     .
 17507 6380-EXIT.
 17508     EXIT.
 17509
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 319
* EL050.cbl
 17511
 17512 6400-COMPUTE-EXTENSION-DAYS.
 17513
 17514******************************************************************
 17515*                                                                *
 17516*                   COMPUTE EXTENSION DAYS                       *
 17517*                                                                *
 17518*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17519*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17520*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17521*    THE EXTENSION DAYS.                                         *
 17522*                                                                *
 17523******************************************************************
 17524
 17525     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17526     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17527
 17528******************************************************************
 17529*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17530*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17531******************************************************************
 17532
 17533     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17534        COMPUTE WS-ODD-DAYS-OVER =
 17535               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17536     ELSE
 17537        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17538
 17539     IF WS-ODD-DAYS-OVER = ZEROS
 17540           GO TO 6499-EXIT
 17541     ELSE
 17542        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17543           IF WS-WDF-MONTH = 02
 17544              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17545              ADD 2       TO  WS-ODD-DAYS-OVER
 17546              GO TO 6499-EXIT
 17547           ELSE
 17548              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17549                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17550                 GO TO 6499-EXIT
 17551               ELSE
 17552                 GO TO 6499-EXIT
 17553        ELSE
 17554           GO TO 6499-EXIT.
 17555
 17556 6412-CHECK-TO-DAY.
 17557
 17558        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17559           IF WS-WDT-DAY = 28
 17560              ADD 2              TO WS-ODD-DAYS-OVER
 17561           ELSE
 17562              IF WS-WDT-DAY = 29
 17563                 ADD 1           TO WS-ODD-DAYS-OVER
 17564              ELSE
 17565                 NEXT SENTENCE
 17566        ELSE
 17567           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17568              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 320
* EL050.cbl
 17569
 17570     GO TO 6499-EXIT.
 17571
 17572
 17573 6415-CHECK-LEAP-YEAR.
 17574
 17575     IF DC-DAYS-IN-MONTH = 29
 17576        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17577
 17578 6415-EXIT.
 17579     EXIT.
 17580
 17581 6499-EXIT.
 17582      EXIT.
 17583
 17584 6500-END.
 17585     EXIT.
 17586
 17587
 17588******************************************************************
 17589************* PROCEDURE DIVISION FOR EL050 ***********************
 17590********************** ELC50PD END *******************************
 17591
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 321
* EL050.cbl
 17593
 17594**START***********************************************************
 17595*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17596*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17597******************************************************************
 17598*
 17599 6600-GET-STATE-MUNICIPAL-TAX.
 17600
 17601     IF PB-COMPANY-ID NOT = 'DMD'
 17602         GO TO 6640-EXIT.
 17603
 17604     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17605     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17606     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17607*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17608*
 17609***  Y2K PROJ 7744
 17610     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17611     SET BIN-TO-GREG          TO TRUE.
 17612     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17613
 17614     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17615
 17616     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17617     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17618
 17619
 17620* EXEC CICS HANDLE CONDITION
 17621*        INVREQ    (6610-START-BROWSE)
 17622*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17623*        NOTFND    (6630-END-OF-FILE)
 17624*    END-EXEC.
 17625*    MOVE '"$8JI                 ! # #00017607' TO DFHEIV0
 17626     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17627     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17628     MOVE X'2320233030303137363037' TO DFHEIV0(25:11)
 17629     CALL 'kxdfhei1' USING DFHEIV0
 17630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17631
 17632
 17633 6610-START-BROWSE.
 17634
 17635
 17636* EXEC CICS HANDLE CONDITION
 17637*        NOTFND    (6630-END-OF-FILE)
 17638*        DISABLED  (6630-ERRESS-PROBLEM)
 17639*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17640*        ENDFILE   (6630-END-OF-FILE)
 17641*    END-EXEC.
 17642*    MOVE '"$IcJ''                ! $ #00017615' TO DFHEIV0
 17643     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17644     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17645     MOVE X'2420233030303137363135' TO DFHEIV0(25:11)
 17646     CALL 'kxdfhei1' USING DFHEIV0
 17647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17648
 17649
 17650
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 322
* EL050.cbl
 17651* EXEC CICS STARTBR
 17652*        DATASET (FILE-ID-ERRESS)
 17653*        RIDFLD  (WS-ERRESS-KEY)
 17654*        GTEQ
 17655*    END-EXEC.
 17656     MOVE 0
 17657       TO DFHEIV11
 17658*    MOVE '&,         G          &   #00017622' TO DFHEIV0
 17659     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17660     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17661     MOVE X'2020233030303137363232' TO DFHEIV0(25:11)
 17662     CALL 'kxdfhei1' USING DFHEIV0,
 17663           FILE-ID-ERRESS,
 17664           WS-ERRESS-KEY,
 17665           DFHEIV99,
 17666           DFHEIV11,
 17667           DFHEIV99
 17668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17669
 17670
 17671 6620-READ-NEXT-ERRESS-MASTER.
 17672
 17673
 17674* EXEC CICS HANDLE CONDITION
 17675*        NOTFND    (6630-END-OF-FILE)
 17676*        ENDFILE   (6630-END-OF-FILE)
 17677*        DISABLED  (6630-ERRESS-PROBLEM)
 17678*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17679*    END-EXEC.
 17680*    MOVE '"$I''cJ                ! % #00017630' TO DFHEIV0
 17681     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17682     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17683     MOVE X'2520233030303137363330' TO DFHEIV0(25:11)
 17684     CALL 'kxdfhei1' USING DFHEIV0
 17685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17686
 17687
 17688
 17689* EXEC CICS READNEXT
 17690*        DATASET (FILE-ID-ERRESS)
 17691*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17692*        RIDFLD  (WS-ERRESS-KEY)
 17693*    END-EXEC.
 17694     MOVE LENGTH OF
 17695      RESIDENT-STATE-TAX-MASTER
 17696       TO DFHEIV12
 17697     MOVE 0
 17698       TO DFHEIV11
 17699*    MOVE '&.IL                  )   #00017637' TO DFHEIV0
 17700     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17701     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17702     MOVE X'2020233030303137363337' TO DFHEIV0(25:11)
 17703     CALL 'kxdfhei1' USING DFHEIV0,
 17704           FILE-ID-ERRESS,
 17705           RESIDENT-STATE-TAX-MASTER,
 17706           DFHEIV12,
 17707           WS-ERRESS-KEY,
 17708           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 323
* EL050.cbl
 17709           DFHEIV11,
 17710           DFHEIV99,
 17711           DFHEIV99
 17712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17713
 17714
 17715     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17716
 17717* EXEC CICS ENDBR
 17718*            DATASET (FILE-ID-ERRESS)
 17719*       END-EXEC
 17720     MOVE 0
 17721       TO DFHEIV11
 17722*    MOVE '&2                    $   #00017644' TO DFHEIV0
 17723     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17724     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17725     MOVE X'2020233030303137363434' TO DFHEIV0(25:11)
 17726     CALL 'kxdfhei1' USING DFHEIV0,
 17727           FILE-ID-ERRESS,
 17728           DFHEIV11,
 17729           DFHEIV99
 17730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17731        GO TO 6630-END-OF-FILE.
 17732
 17733     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17734        NEXT SENTENCE
 17735      ELSE
 17736        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17737
 17738*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17739*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17740*
 17741     MOVE +2                     TO WS-SUB1.
 17742
 17743     IF PB-ISSUE
 17744     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17745        MOVE +1                  TO WS-SUB1.
 17746
 17747     IF PB-CANCELLATION
 17748     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 17749        MOVE +1                  TO WS-SUB1.
 17750*
 17751*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 17752*
 17753***  Y2K PROJ 7744
 17754     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 17755***  Y2K PROJ 7744
 17756
 17757*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 17758* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 17759* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 17760
 17761     ADD 1                    TO WS-YEAR-YY.
 17762
 17763     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 17764         MOVE RES-REN-STATE-TAX (WS-SUB1)
 17765                              TO WS-RES-STATE-TAX
 17766         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 324
* EL050.cbl
 17767                              TO WS-RES-MUNI-TAX
 17768     ELSE
 17769         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 17770                              TO WS-RES-STATE-TAX
 17771         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 17772                              TO WS-RES-MUNI-TAX.
 17773
 17774*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 17775
 17776     IF PB-CANCELLATION
 17777         GO TO 6640-CANCEL-TAX.
 17778
 17779     IF PB-I-LF-PREMIUM-AMT > ZEROS
 17780         COMPUTE PB-I-STATE-TAX ROUNDED =
 17781                                   PB-I-LF-PREMIUM-AMT
 17782                                 * WS-RES-STATE-TAX
 17783         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17784                                   PB-I-LF-PREMIUM-AMT
 17785                                 * WS-RES-MUNI-TAX
 17786     ELSE
 17787     IF PB-I-AH-PREMIUM-AMT > ZEROS
 17788         COMPUTE PB-I-STATE-TAX ROUNDED =
 17789                                   PB-I-AH-PREMIUM-AMT
 17790                                 * WS-RES-STATE-TAX
 17791         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17792                                   PB-I-AH-PREMIUM-AMT
 17793                                 * WS-RES-MUNI-TAX.
 17794
 17795
 17796* EXEC CICS ENDBR
 17797*         DATASET (FILE-ID-ERRESS)
 17798*    END-EXEC.
 17799     MOVE 0
 17800       TO DFHEIV11
 17801*    MOVE '&2                    $   #00017711' TO DFHEIV0
 17802     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17803     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17804     MOVE X'2020233030303137373131' TO DFHEIV0(25:11)
 17805     CALL 'kxdfhei1' USING DFHEIV0,
 17806           FILE-ID-ERRESS,
 17807           DFHEIV11,
 17808           DFHEIV99
 17809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17810
 17811
 17812     GO TO 6640-EXIT.
 17813
 17814 6640-CANCEL-TAX.
 17815     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 17816
 17817     IF PB-C-LF-CANCEL-AMT > ZEROS
 17818         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17819                                   PB-C-LF-CANCEL-AMT
 17820                                 * WS-RES-STATE-TAX
 17821         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17822                                   PB-C-LF-CANCEL-AMT
 17823                                *  WS-RES-MUNI-TAX
 17824     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 325
* EL050.cbl
 17825     IF PB-C-AH-CANCEL-AMT > ZEROS
 17826         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17827                                   PB-C-AH-CANCEL-AMT
 17828                                 * WS-RES-STATE-TAX
 17829         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17830                                   PB-C-AH-CANCEL-AMT
 17831                                *  WS-RES-MUNI-TAX.
 17832
 17833
 17834* EXEC CICS ENDBR
 17835*         DATASET (FILE-ID-ERRESS)
 17836*    END-EXEC.
 17837     MOVE 0
 17838       TO DFHEIV11
 17839*    MOVE '&2                    $   #00017736' TO DFHEIV0
 17840     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17841     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17842     MOVE X'2020233030303137373336' TO DFHEIV0(25:11)
 17843     CALL 'kxdfhei1' USING DFHEIV0,
 17844           FILE-ID-ERRESS,
 17845           DFHEIV11,
 17846           DFHEIV99
 17847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17848
 17849
 17850     GO TO 6640-EXIT.
 17851
 17852 6630-END-OF-FILE.
 17853     MOVE ER-8002              TO WS-ERROR.
 17854     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17855
 17856     GO TO 6640-EXIT.
 17857
 17858 6630-ERRESS-PROBLEM.
 17859     MOVE ER-8044              TO WS-ERROR.
 17860     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17861
 17862 6640-EXIT.
 17863     EXIT.
 17864
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 326
* EL050.cbl
 17866 6650-GET-RES-STATE-COMM.
 17867
 17868     IF PB-COMPANY-ID NOT = 'DMD'
 17869         GO TO 6700-COMM-EXIT.
 17870
 17871     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 17872     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 17873     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 17874     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 17875     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 17876     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 17877     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 17878
 17879*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 17880*
 17881***  Y2K PROJ 7744
 17882     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17883     SET BIN-TO-GREG          TO TRUE.
 17884     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17885
 17886     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17887***  Y2K PROJ 7744
 17888
 17889     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 17890
 17891
 17892* EXEC CICS HANDLE CONDITION
 17893*        INVREQ    (6660-START-BROWSE)
 17894*        DISABLED  (6690-ERRESC-PROBLEM)
 17895*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17896*        NOTFND    (6690-END-OF-FILE)
 17897*    END-EXEC.
 17898*    MOVE '"$8cJI                ! & #00017781' TO DFHEIV0
 17899     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 17900     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17901     MOVE X'2620233030303137373831' TO DFHEIV0(25:11)
 17902     CALL 'kxdfhei1' USING DFHEIV0
 17903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17904
 17905
 17906
 17907* EXEC CICS RESETBR
 17908*        DATASET (FILE-ID-ERRESC)
 17909*        RIDFLD  (WS-ERRESC-KEY)
 17910*    END-EXEC.
 17911     MOVE 0
 17912       TO DFHEIV11
 17913*    MOVE '&4         G          &   #00017788' TO DFHEIV0
 17914     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 17915     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17916     MOVE X'2020233030303137373838' TO DFHEIV0(25:11)
 17917     CALL 'kxdfhei1' USING DFHEIV0,
 17918           FILE-ID-ERRESC,
 17919           WS-ERRESC-KEY,
 17920           DFHEIV99,
 17921           DFHEIV11,
 17922           DFHEIV99
 17923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 327
* EL050.cbl
 17924
 17925
 17926 6660-START-BROWSE.
 17927
 17928
 17929* EXEC CICS HANDLE CONDITION
 17930*        NOTFND    (6690-END-OF-FILE)
 17931*        DISABLED  (6690-ERRESC-PROBLEM)
 17932*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17933*        ENDFILE   (6690-END-OF-FILE)
 17934*    END-EXEC.
 17935*    MOVE '"$IcJ''                ! '' #00017795' TO DFHEIV0
 17936     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17937     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17938     MOVE X'2720233030303137373935' TO DFHEIV0(25:11)
 17939     CALL 'kxdfhei1' USING DFHEIV0
 17940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17941
 17942
 17943
 17944* EXEC CICS STARTBR
 17945*        DATASET (FILE-ID-ERRESC)
 17946*        RIDFLD  (WS-ERRESC-KEY)
 17947*        GTEQ
 17948*    END-EXEC.
 17949     MOVE 0
 17950       TO DFHEIV11
 17951*    MOVE '&,         G          &   #00017802' TO DFHEIV0
 17952     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17953     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17954     MOVE X'2020233030303137383032' TO DFHEIV0(25:11)
 17955     CALL 'kxdfhei1' USING DFHEIV0,
 17956           FILE-ID-ERRESC,
 17957           WS-ERRESC-KEY,
 17958           DFHEIV99,
 17959           DFHEIV11,
 17960           DFHEIV99
 17961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17962
 17963
 17964     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 17965
 17966 6670-READ-NEXT-ERRESC-MASTER.
 17967
 17968
 17969* EXEC CICS HANDLE CONDITION
 17970*        NOTFND    (6690-END-OF-FILE)
 17971*        DISABLED  (6690-ERRESC-PROBLEM)
 17972*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17973*        ENDFILE   (6690-END-OF-FILE)
 17974*    END-EXEC.
 17975*    MOVE '"$IcJ''                ! ( #00017812' TO DFHEIV0
 17976     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17977     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17978     MOVE X'2820233030303137383132' TO DFHEIV0(25:11)
 17979     CALL 'kxdfhei1' USING DFHEIV0
 17980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17981
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 328
* EL050.cbl
 17982
 17983
 17984* EXEC CICS READNEXT
 17985*        DATASET (FILE-ID-ERRESC)
 17986*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 17987*        RIDFLD  (ERRESC-RECORD-KEY)
 17988*    END-EXEC.
 17989     MOVE LENGTH OF
 17990      ACCOUNT-RESIDENT-ST-COMMISSION
 17991       TO DFHEIV12
 17992     MOVE 0
 17993       TO DFHEIV11
 17994*    MOVE '&.IL                  )   #00017819' TO DFHEIV0
 17995     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17996     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17997     MOVE X'2020233030303137383139' TO DFHEIV0(25:11)
 17998     CALL 'kxdfhei1' USING DFHEIV0,
 17999           FILE-ID-ERRESC,
 18000           ACCOUNT-RESIDENT-ST-COMMISSION,
 18001           DFHEIV12,
 18002           ERRESC-RECORD-KEY,
 18003           DFHEIV99,
 18004           DFHEIV11,
 18005           DFHEIV99,
 18006           DFHEIV99
 18007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18008
 18009
 18010     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18011        NEXT SENTENCE
 18012     ELSE
 18013
 18014* EXEC CICS ENDBR
 18015*            DATASET (FILE-ID-ERRESC)
 18016*       END-EXEC
 18017     MOVE 0
 18018       TO DFHEIV11
 18019*    MOVE '&2                    $   #00017828' TO DFHEIV0
 18020     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18021     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18022     MOVE X'2020233030303137383238' TO DFHEIV0(25:11)
 18023     CALL 'kxdfhei1' USING DFHEIV0,
 18024           FILE-ID-ERRESC,
 18025           DFHEIV11,
 18026           DFHEIV99
 18027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18028        GO TO 6690-END-OF-FILE.
 18029
 18030     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18031
 18032* EXEC CICS ENDBR
 18033*            DATASET (FILE-ID-ERRESC)
 18034*       END-EXEC
 18035     MOVE 0
 18036       TO DFHEIV11
 18037*    MOVE '&2                    $   #00017834' TO DFHEIV0
 18038     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18039     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 329
* EL050.cbl
 18040     MOVE X'2020233030303137383334' TO DFHEIV0(25:11)
 18041     CALL 'kxdfhei1' USING DFHEIV0,
 18042           FILE-ID-ERRESC,
 18043           DFHEIV11,
 18044           DFHEIV99
 18045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18046        GO TO 6690-END-OF-FILE.
 18047
 18048     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18049        NEXT SENTENCE
 18050      ELSE
 18051        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18052
 18053* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18054*
 18055     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18056
 18057     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18058
 18059     IF WS-SUB1 > ZERO
 18060         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18061             PERFORM 6680-SET-COMMISSION
 18062         ELSE
 18063             PERFORM 6680-SET-TABLE-CODE.
 18064
 18065
 18066* EXEC CICS ENDBR
 18067*         DATASET (FILE-ID-ERRESC)
 18068*    END-EXEC.
 18069     MOVE 0
 18070       TO DFHEIV11
 18071*    MOVE '&2                    $   #00017856' TO DFHEIV0
 18072     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18073     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18074     MOVE X'2020233030303137383536' TO DFHEIV0(25:11)
 18075     CALL 'kxdfhei1' USING DFHEIV0,
 18076           FILE-ID-ERRESC,
 18077           DFHEIV11,
 18078           DFHEIV99
 18079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18080
 18081
 18082     GO TO 6700-COMM-EXIT.
 18083
 18084 6680-SET-TABLE-CODE.
 18085     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18086        MOVE ZEROS             TO WS-SUB1
 18087     ELSE
 18088* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18089* TO COMPUTE AH COMMISSION.
 18090        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18091        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18092        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18093        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18094        PERFORM 6680-READ-CTBL-TABLE
 18095        IF WS-CTBL-READ-SW NOT = 'Y'
 18096           MOVE ZEROS          TO WS-SUB1.
 18097
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 330
* EL050.cbl
 18098 6680-READ-CTBL-TABLE.
 18099*
 18100* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18101* TO COMPUTE LIFE COMMISSION
 18102
 18103     IF CTBL-SW = '0540'
 18104        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18105        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18106        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18107
 18108     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18109
 18110     IF CTBL-TABLE-FOUND
 18111        IF CTBL-SW = '0530'
 18112             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18113                                    * PB-I-AH-TERM
 18114             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18115             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18116        ELSE
 18117             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18118             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18119             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18120     ELSE
 18121        IF FIRST-TIME-THROUGH
 18122            GO TO 6680-READ-CTBL-TABLE
 18123        ELSE
 18124            MOVE ZEROS         TO WS-SUB1.
 18125
 18126 6680-SET-COMMISSION.
 18127     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18128           MOVE ZEROS          TO WS-SUB1
 18129       ELSE
 18130           MOVE RESC-COMMISSION-PER (WS-SUB)
 18131                               TO WS-COMMISSION
 18132           IF CTBL-SW = '0530'
 18133               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18134           ELSE
 18135               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18136
 18137 6680-SEARCH-CATEGORY.
 18138     ADD +1                   TO WS-SUB.
 18139     IF WS-SUB > +12
 18140         GO TO 6680-EXIT.
 18141
 18142     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18143          MOVE WS-SUB         TO WS-SUB1
 18144          GO TO 6680-EXIT.
 18145
 18146     GO TO 6680-SEARCH-CATEGORY.
 18147
 18148 6680-EXIT.
 18149     EXIT.
 18150
 18151 6690-END-OF-FILE.
 18152     GO TO 6700-COMM-EXIT.
 18153
 18154 6690-ERRESC-PROBLEM.
 18155      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 331
* EL050.cbl
 18156      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18157
 18158      GO TO 6700-COMM-EXIT.
 18159
 18160 6700-COMM-EXIT.
 18161     EXIT.
 18162
 18163 7000-GET-RATE.
 18164
 18165* EXEC CICS LINK
 18166*        PROGRAM    ('ELRATE')
 18167*        COMMAREA   (CALCULATION-PASS-AREA)
 18168*        LENGTH     (CP-COMM-LENGTH)
 18169*    END-EXEC.
 18170     MOVE 'ELRATE' TO DFHEIV1
 18171*    MOVE '."C                   ''   #00017942' TO DFHEIV0
 18172     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18173     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18174     MOVE X'2020233030303137393432' TO DFHEIV0(25:11)
 18175     CALL 'kxdfhei1' USING DFHEIV0,
 18176           DFHEIV1,
 18177           CALCULATION-PASS-AREA,
 18178           CP-COMM-LENGTH,
 18179           DFHEIV99,
 18180           DFHEIV99,
 18181           DFHEIV99
 18182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18183
 18184
 18185 7000-EXIT.
 18186     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 332
* EL050.cbl
 18188 7100-FIND-BENEFIT-IN-STATE.
 18189     MOVE 'N'                    TO BEN-SEARCH-SW.
 18190
 18191     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18192         VARYING SUB3 FROM 1 BY 1 UNTIL
 18193            ((SUB3 GREATER 50) OR
 18194              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18195               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18196
 18197     IF SUB3 NOT = 51
 18198         MOVE 'Y'                TO BEN-SEARCH-SW.
 18199
 18200     GO TO 7199-EXIT.
 18201
 18202 7100-BENEFIT-DUMMY.
 18203
 18204 7100-DUMMY-EXIT.
 18205     EXIT.
 18206
 18207 7199-EXIT.
 18208     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 333
* EL050.cbl
 18210 7200-FIND-BENEFIT.
 18211     MOVE 'N'                    TO BEN-SEARCH-SW.
 18212
 18213     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18214         VARYING SUB3 FROM 1 BY 1 UNTIL
 18215            ((SUB3 GREATER 8) OR
 18216            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18217
 18218     IF SUB3 NOT = 9
 18219         MOVE 'Y'                TO BEN-SEARCH-SW.
 18220
 18221     GO TO 7200-EXIT.
 18222
 18223 7200-BENEFIT-DUMMY.
 18224
 18225 7200-DUMMY-EXIT.
 18226     EXIT.
 18227
 18228 7200-EXIT.
 18229     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 334
* EL050.cbl
 18231 7250-LOOK-FOR-RESCINDED-CLAIM.
 18232     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18233                                    W-CL-COMP-CD.
 18234     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18235                                    W-CL-CERT-NO.
 18236
 18237
 18238* EXEC CICS HANDLE CONDITION
 18239*        NOTFND  (7250-CONTINUE)
 18240*        ENDFILE (7250-CONTINUE)
 18241*    END-EXEC.
 18242*    MOVE '"$I''                  ! ) #00018000' TO DFHEIV0
 18243     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18244     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18245     MOVE X'2920233030303138303030' TO DFHEIV0(25:11)
 18246     CALL 'kxdfhei1' USING DFHEIV0
 18247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18248
 18249
 18250
 18251* EXEC CICS IGNORE CONDITION
 18252*        DUPKEY
 18253*    END-EXEC.
 18254*    MOVE '"*$                   !   #00018005' TO DFHEIV0
 18255     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18256     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18257     MOVE X'2020233030303138303035' TO DFHEIV0(25:11)
 18258     CALL 'kxdfhei1' USING DFHEIV0
 18259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18260
 18261
 18262
 18263* EXEC CICS STARTBR
 18264*        DATASET   (CLMS-ID)
 18265*        RIDFLD    (ELMSTR-KEY)
 18266*        GENERIC   EQUAL
 18267*        KEYLENGTH (ELMSTR-LENGTH)
 18268*    END-EXEC.
 18269     MOVE 0
 18270       TO DFHEIV11
 18271*    MOVE '&,   KG    E          &   #00018009' TO DFHEIV0
 18272     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18273     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18274     MOVE X'2020233030303138303039' TO DFHEIV0(25:11)
 18275     CALL 'kxdfhei1' USING DFHEIV0,
 18276           CLMS-ID,
 18277           ELMSTR-KEY,
 18278           ELMSTR-LENGTH,
 18279           DFHEIV11,
 18280           DFHEIV99
 18281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18282
 18283
 18284     MOVE 'Y'                    TO W-BROWSE-SW.
 18285
 18286 7250-NEXT-CLAIM.
 18287
 18288
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 335
* EL050.cbl
 18289* EXEC CICS READNEXT
 18290*        DATASET   (CLMS-ID)
 18291*        RIDFLD    (ELMSTR-KEY)
 18292*        SET       (ADDRESS OF CLAIM-MASTER)
 18293*    END-EXEC.
 18294     MOVE 0
 18295       TO DFHEIV11
 18296*    MOVE '&.S                   )   #00018020' TO DFHEIV0
 18297     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18298     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18299     MOVE X'2020233030303138303230' TO DFHEIV0(25:11)
 18300     CALL 'kxdfhei1' USING DFHEIV0,
 18301           CLMS-ID,
 18302           DFHEIV20,
 18303           DFHEIV99,
 18304           ELMSTR-KEY,
 18305           DFHEIV99,
 18306           DFHEIV11,
 18307           DFHEIV99,
 18308           DFHEIV99
 18309     SET ADDRESS OF CLAIM-MASTER TO
 18310         DFHEIV20
 18311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18312
 18313
 18314     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18315        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18316         GO TO 7250-CONTINUE
 18317     END-IF.
 18318
 18319     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18320        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18321        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18322        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18323        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18324         GO TO 7250-NEXT-CLAIM
 18325     END-IF.
 18326
 18327     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18328        OR (CL-CLAIM-TYPE = 'I')
 18329        OR (CL-CLAIM-TYPE = 'G')
 18330          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18331              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18332              GO TO 7250-CONTINUE
 18333          END-IF
 18334     END-IF.
 18335
 18336     GO TO 7250-NEXT-CLAIM.
 18337
 18338 7250-CONTINUE.
 18339
 18340     IF W-BROWSE-SW = 'Y'
 18341
 18342* EXEC CICS ENDBR
 18343*            DATASET   (CLMS-ID)
 18344*        END-EXEC
 18345     MOVE 0
 18346       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 336
* EL050.cbl
 18347*    MOVE '&2                    $   #00018053' TO DFHEIV0
 18348     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18349     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18350     MOVE X'2020233030303138303533' TO DFHEIV0(25:11)
 18351     CALL 'kxdfhei1' USING DFHEIV0,
 18352           CLMS-ID,
 18353           DFHEIV11,
 18354           DFHEIV99
 18355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18356         MOVE 'N' TO W-BROWSE-SW
 18357     END-IF.
 18358
 18359 7250-EXIT.
 18360     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 337
* EL050.cbl
 18362 7300-CHECK-FOR-OPEN-CLMS.
 18363
 18364*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18365*    MOVE SPACES                 TO CNTL-ACCESS.
 18366*    MOVE '1'                    TO CNTL-REC-TYPE.
 18367*    MOVE +0                     TO CNTL-SEQ-NO.
 18368
 18369*    MOVE '3'                    TO RC-SW-1.
 18370*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18371
 18372*    IF NOT CF-COMPANY-MASTER
 18373*         PERFORM 0099-COMPANY-NOT-FOUND
 18374*         GO TO 7300-EXIT.
 18375
 18376     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18377                                    W-CL-COMP-CD.
 18378     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18379                                    W-CL-CERT-NO.
 18380
 18381
 18382* EXEC CICS HANDLE CONDITION
 18383*        NOTFND  (7300-CONTINUE)
 18384*        ENDFILE (7300-CONTINUE)
 18385*    END-EXEC.
 18386*    MOVE '"$I''                  ! * #00018081' TO DFHEIV0
 18387     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18388     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18389     MOVE X'2A20233030303138303831' TO DFHEIV0(25:11)
 18390     CALL 'kxdfhei1' USING DFHEIV0
 18391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18392
 18393
 18394
 18395* EXEC CICS IGNORE CONDITION
 18396*        DUPKEY
 18397*    END-EXEC.
 18398*    MOVE '"*$                   !   #00018086' TO DFHEIV0
 18399     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18401     MOVE X'2020233030303138303836' TO DFHEIV0(25:11)
 18402     CALL 'kxdfhei1' USING DFHEIV0
 18403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18404
 18405
 18406
 18407* EXEC CICS STARTBR
 18408*        DATASET   (CLMS-ID)
 18409*        RIDFLD    (ELMSTR-KEY)
 18410*        GENERIC   EQUAL
 18411*        KEYLENGTH (ELMSTR-LENGTH)
 18412*    END-EXEC.
 18413     MOVE 0
 18414       TO DFHEIV11
 18415*    MOVE '&,   KG    E          &   #00018090' TO DFHEIV0
 18416     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18417     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18418     MOVE X'2020233030303138303930' TO DFHEIV0(25:11)
 18419     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 338
* EL050.cbl
 18420           CLMS-ID,
 18421           ELMSTR-KEY,
 18422           ELMSTR-LENGTH,
 18423           DFHEIV11,
 18424           DFHEIV99
 18425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18426
 18427
 18428     MOVE 'Y'                    TO W-BROWSE-SW.
 18429
 18430 7300-NEXT-CLAIM.
 18431
 18432
 18433* EXEC CICS READNEXT
 18434*        DATASET   (CLMS-ID)
 18435*        RIDFLD    (ELMSTR-KEY)
 18436*        SET       (ADDRESS OF CLAIM-MASTER)
 18437*    END-EXEC.
 18438     MOVE 0
 18439       TO DFHEIV11
 18440*    MOVE '&.S                   )   #00018101' TO DFHEIV0
 18441     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18442     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18443     MOVE X'2020233030303138313031' TO DFHEIV0(25:11)
 18444     CALL 'kxdfhei1' USING DFHEIV0,
 18445           CLMS-ID,
 18446           DFHEIV20,
 18447           DFHEIV99,
 18448           ELMSTR-KEY,
 18449           DFHEIV99,
 18450           DFHEIV11,
 18451           DFHEIV99,
 18452           DFHEIV99
 18453     SET ADDRESS OF CLAIM-MASTER TO
 18454         DFHEIV20
 18455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18456
 18457
 18458     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18459        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18460         GO TO 7300-CONTINUE.
 18461
 18462     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18463        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18464        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18465        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18466        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18467         GO TO 7300-NEXT-CLAIM.
 18468
 18469*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18470     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18471        OR (CL-CLAIM-TYPE = 'I')
 18472        OR (CL-CLAIM-TYPE = 'G')
 18473        IF CLAIM-IS-OPEN
 18474           EVALUATE TRUE
 18475             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18476                 MOVE ER-2884      TO WS-ERROR
 18477             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 339
* EL050.cbl
 18478                 MOVE ER-2887      TO WS-ERROR
 18479             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18480                 MOVE ER-2886      TO WS-ERROR
 18481             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18482                 MOVE ER-2888      TO WS-ERROR
 18483             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18484                 MOVE ER-2885      TO WS-ERROR
 18485             WHEN OTHER
 18486                 MOVE ER-2768      TO WS-ERROR
 18487           END-EVALUATE
 18488           IF PB-C-AH-CANCEL-VOIDED OR
 18489              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18490                NOT AH-COVERAGE-CANCELLED)
 18491               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18492               MOVE ER-2768      TO WS-ERROR
 18493           END-IF
 18494           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18495           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18496              PB-FORCE-CODE NOT EQUAL '8'
 18497               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18498           END-IF
 18499           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18500           GO TO 7300-CONTINUE
 18501        ELSE
 18502           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18503*****THIS IS A RESCISSION OR REFORMATION
 18504              IF (AH-COVERAGE-CANCELLED AND
 18505                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18506                    MOVE ER-2890 TO WS-ERROR
 18507                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18508                    GO TO 7300-CONTINUE
 18509              END-IF
 18510           ELSE
 18511              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18512                 MOVE ER-2756        TO WS-ERROR
 18513                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18514                 GO TO 7300-CONTINUE
 18515              END-IF
 18516           END-IF
 18517        END-IF
 18518     ELSE
 18519*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18520        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18521           IF CLAIM-IS-OPEN
 18522              MOVE ER-2889      TO WS-ERROR
 18523              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18524              GO TO 7300-CONTINUE
 18525           ELSE
 18526              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18527*****THIS IS A RESCISSION OR REFORMATION
 18528                 IF (LF-COVERAGE-CANCELLED AND
 18529                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18530                       MOVE ER-2890 TO WS-ERROR
 18531                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18532                       GO TO 7300-CONTINUE
 18533                 END-IF
 18534              ELSE
 18535                 IF (AH-COVERAGE-CANCELLED AND
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 340
* EL050.cbl
 18536                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18537                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18538                    (LF-COVERAGE-CANCELLED AND
 18539                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18540                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18541                       MOVE ER-2965 TO WS-ERROR
 18542                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18543                       GO TO 7300-CONTINUE
 18544                 END-IF
 18545                 IF LF-COVERAGE-CANCELLED
 18546                  IF CL-TOTAL-PAID-AMT > 0
 18547                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18548                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18549                        MOVE ER-2891 TO WS-ERROR
 18550                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18551                        GO TO 7300-CONTINUE
 18552                      END-IF
 18553                    ELSE
 18554                      MOVE ER-2892 TO WS-ERROR
 18555                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18556                      GO TO 7300-CONTINUE
 18557                    END-IF
 18558                  END-IF
 18559                 END-IF
 18560              END-IF
 18561           END-IF
 18562        END-IF
 18563     END-IF
 18564
 18565     GO TO 7300-NEXT-CLAIM.
 18566
 18567 7300-CONTINUE.
 18568
 18569     IF W-BROWSE-SW = 'Y'
 18570
 18571* EXEC CICS ENDBR
 18572*            DATASET   (CLMS-ID)
 18573*        END-EXEC.
 18574     MOVE 0
 18575       TO DFHEIV11
 18576*    MOVE '&2                    $   #00018219' TO DFHEIV0
 18577     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18578     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18579     MOVE X'2020233030303138323139' TO DFHEIV0(25:11)
 18580     CALL 'kxdfhei1' USING DFHEIV0,
 18581           CLMS-ID,
 18582           DFHEIV11,
 18583           DFHEIV99
 18584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18585
 18586
 18587 7300-EXIT.
 18588     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 341
* EL050.cbl
 18590
 18591 7400-GET-REMAIN-TERM.
 18592
 18593* EXEC CICS LINK
 18594*        PROGRAM    ('ELRTRM')
 18595*        COMMAREA   (CALCULATION-PASS-AREA)
 18596*        LENGTH     (CP-COMM-LENGTH)
 18597*    END-EXEC.
 18598     MOVE 'ELRTRM' TO DFHEIV1
 18599*    MOVE '."C                   ''   #00018228' TO DFHEIV0
 18600     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18601     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18602     MOVE X'2020233030303138323238' TO DFHEIV0(25:11)
 18603     CALL 'kxdfhei1' USING DFHEIV0,
 18604           DFHEIV1,
 18605           CALCULATION-PASS-AREA,
 18606           CP-COMM-LENGTH,
 18607           DFHEIV99,
 18608           DFHEIV99,
 18609           DFHEIV99
 18610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18611
 18612
 18613 7400-EXIT.
 18614     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 342
* EL050.cbl
 18616
 18617 7500-GET-REMAIN-AMOUNT.
 18618
 18619* EXEC CICS LINK
 18620*        PROGRAM    ('ELRAMT')
 18621*        COMMAREA   (CALCULATION-PASS-AREA)
 18622*        LENGTH     (CP-COMM-LENGTH)
 18623*    END-EXEC.
 18624     MOVE 'ELRAMT' TO DFHEIV1
 18625*    MOVE '."C                   ''   #00018239' TO DFHEIV0
 18626     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18627     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18628     MOVE X'2020233030303138323339' TO DFHEIV0(25:11)
 18629     CALL 'kxdfhei1' USING DFHEIV0,
 18630           DFHEIV1,
 18631           CALCULATION-PASS-AREA,
 18632           CP-COMM-LENGTH,
 18633           DFHEIV99,
 18634           DFHEIV99,
 18635           DFHEIV99
 18636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18637
 18638
 18639 7500-EXIT.
 18640     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 343
* EL050.cbl
 18642
 18643 7600-GET-REFUND.
 18644
 18645* EXEC CICS LINK
 18646*        PROGRAM    ('ELRFND')
 18647*        COMMAREA   (CALCULATION-PASS-AREA)
 18648*        LENGTH     (CP-COMM-LENGTH)
 18649*    END-EXEC.
 18650     MOVE 'ELRFND' TO DFHEIV1
 18651*    MOVE '."C                   ''   #00018250' TO DFHEIV0
 18652     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18653     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18654     MOVE X'2020233030303138323530' TO DFHEIV0(25:11)
 18655     CALL 'kxdfhei1' USING DFHEIV0,
 18656           DFHEIV1,
 18657           CALCULATION-PASS-AREA,
 18658           CP-COMM-LENGTH,
 18659           DFHEIV99,
 18660           DFHEIV99,
 18661           DFHEIV99
 18662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18663
 18664
 18665 7600-EXIT.
 18666     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 344
* EL050.cbl
 18668 7700-CALL-DL1.
 18669
 18670* EXEC CICS LINK
 18671*        PROGRAM    ('DLO001')
 18672*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18673*        LENGTH     (DLO001-COMM-LENGTH)
 18674*    END-EXEC.
 18675     MOVE 'DLO001' TO DFHEIV1
 18676*    MOVE '."C                   ''   #00018260' TO DFHEIV0
 18677     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18678     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18679     MOVE X'2020233030303138323630' TO DFHEIV0(25:11)
 18680     CALL 'kxdfhei1' USING DFHEIV0,
 18681           DFHEIV1,
 18682           WS-DLO-MASTER-POLICY-FORM,
 18683           DLO001-COMM-LENGTH,
 18684           DFHEIV99,
 18685           DFHEIV99,
 18686           DFHEIV99
 18687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18688
 18689
 18690 7700-EXIT.
 18691     EXIT.
 18692
 18693 7710-CALL-DL2.
 18694
 18695* EXEC CICS LINK
 18696*        PROGRAM    ('DLO002')
 18697*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18698*        LENGTH     (DLO002-COMM-LENGTH)
 18699*    END-EXEC.
 18700     MOVE 'DLO002' TO DFHEIV1
 18701*    MOVE '."C                   ''   #00018270' TO DFHEIV0
 18702     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18703     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18704     MOVE X'2020233030303138323730' TO DFHEIV0(25:11)
 18705     CALL 'kxdfhei1' USING DFHEIV0,
 18706           DFHEIV1,
 18707           WS-DLO-INTERNAL-POLICY-FORM,
 18708           DLO002-COMM-LENGTH,
 18709           DFHEIV99,
 18710           DFHEIV99,
 18711           DFHEIV99
 18712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18713
 18714
 18715 7710-EXIT.
 18716     EXIT.
 18717
 18718 7720-CALL-DL3.
 18719
 18720* EXEC CICS LINK
 18721*        PROGRAM    ('DLO003')
 18722*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18723*        LENGTH     (DLO003-COMM-LENGTH)
 18724*    END-EXEC.
 18725     MOVE 'DLO003' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 345
* EL050.cbl
 18726*    MOVE '."C                   ''   #00018280' TO DFHEIV0
 18727     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18728     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18729     MOVE X'2020233030303138323830' TO DFHEIV0(25:11)
 18730     CALL 'kxdfhei1' USING DFHEIV0,
 18731           DFHEIV1,
 18732           WS-DLO-VALID-BANK-ID,
 18733           DLO003-COMM-LENGTH,
 18734           DFHEIV99,
 18735           DFHEIV99,
 18736           DFHEIV99
 18737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18738
 18739
 18740 7720-EXIT.
 18741     EXIT.
 18742
 18743 7730-CALL-DL7.
 18744
 18745* EXEC CICS LINK
 18746*        PROGRAM    ('DLO007')
 18747*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 18748*        LENGTH     (DLO007-COMM-LENGTH)
 18749*    END-EXEC.
 18750     MOVE 'DLO007' TO DFHEIV1
 18751*    MOVE '."C                   ''   #00018290' TO DFHEIV0
 18752     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18753     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18754     MOVE X'2020233030303138323930' TO DFHEIV0(25:11)
 18755     CALL 'kxdfhei1' USING DFHEIV0,
 18756           DFHEIV1,
 18757           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 18758           DLO007-COMM-LENGTH,
 18759           DFHEIV99,
 18760           DFHEIV99,
 18761           DFHEIV99
 18762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18763
 18764
 18765 7730-EXIT.
 18766     EXIT.
 18767
 18768 7740-CALL-DL11.
 18769
 18770* EXEC CICS LINK
 18771*        PROGRAM    ('DLO011')
 18772*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 18773*        LENGTH     (DLO011-COMM-LENGTH)
 18774*    END-EXEC.
 18775     MOVE 'DLO011' TO DFHEIV1
 18776*    MOVE '."C                   ''   #00018300' TO DFHEIV0
 18777     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18778     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18779     MOVE X'2020233030303138333030' TO DFHEIV0(25:11)
 18780     CALL 'kxdfhei1' USING DFHEIV0,
 18781           DFHEIV1,
 18782           WS-DLO-PREM-RATES-BEN-TYPE,
 18783           DLO011-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 346
* EL050.cbl
 18784           DFHEIV99,
 18785           DFHEIV99,
 18786           DFHEIV99
 18787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18788
 18789
 18790 7740-EXIT.
 18791     EXIT.
 18792
 18793 7750-CALL-DL17.
 18794
 18795* EXEC CICS LINK
 18796*        PROGRAM    ('DLO017')
 18797*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 18798*        LENGTH     (DLO017-COMM-LENGTH)
 18799*    END-EXEC.
 18800     MOVE 'DLO017' TO DFHEIV1
 18801*    MOVE '."C                   ''   #00018310' TO DFHEIV0
 18802     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18803     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18804     MOVE X'2020233030303138333130' TO DFHEIV0(25:11)
 18805     CALL 'kxdfhei1' USING DFHEIV0,
 18806           DFHEIV1,
 18807           WS-DLO-VALID-RATE-CODE,
 18808           DLO017-COMM-LENGTH,
 18809           DFHEIV99,
 18810           DFHEIV99,
 18811           DFHEIV99
 18812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18813
 18814
 18815 7750-EXIT.
 18816     EXIT.
 18817
 18818 7755-CALL-DL19.
 18819
 18820* EXEC CICS LINK
 18821*        PROGRAM    ('DLO019')
 18822*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 18823*        LENGTH     (DLO019-COMM-LENGTH)
 18824*    END-EXEC.
 18825     MOVE 'DLO019' TO DFHEIV1
 18826*    MOVE '."C                   ''   #00018320' TO DFHEIV0
 18827     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18828     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18829     MOVE X'2020233030303138333230' TO DFHEIV0(25:11)
 18830     CALL 'kxdfhei1' USING DFHEIV0,
 18831           DFHEIV1,
 18832           WS-DLO-ORIG-COV-CAT,
 18833           DLO019-COMM-LENGTH,
 18834           DFHEIV99,
 18835           DFHEIV99,
 18836           DFHEIV99
 18837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18838
 18839
 18840 7755-EXIT.
 18841     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 347
* EL050.cbl
 18842
 18843 7760-CALL-DL21.
 18844
 18845* EXEC CICS LINK
 18846*        PROGRAM    ('DLO021')
 18847*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 18848*        LENGTH     (DLO021-COMM-LENGTH)
 18849*    END-EXEC.
 18850     MOVE 'DLO021' TO DFHEIV1
 18851*    MOVE '."C                   ''   #00018330' TO DFHEIV0
 18852     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18853     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18854     MOVE X'2020233030303138333330' TO DFHEIV0(25:11)
 18855     CALL 'kxdfhei1' USING DFHEIV0,
 18856           DFHEIV1,
 18857           WS-DLO-VALID-LOAN-OFFICER,
 18858           DLO021-COMM-LENGTH,
 18859           DFHEIV99,
 18860           DFHEIV99,
 18861           DFHEIV99
 18862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18863
 18864
 18865 7760-EXIT.
 18866     EXIT.
 18867
 18868 7770-CALL-DL22.
 18869
 18870* EXEC CICS LINK
 18871*        PROGRAM    ('DLO022')
 18872*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 18873*        LENGTH     (DLO022-COMM-LENGTH)
 18874*    END-EXEC.
 18875     MOVE 'DLO022' TO DFHEIV1
 18876*    MOVE '."C                   ''   #00018340' TO DFHEIV0
 18877     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18878     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18879     MOVE X'2020233030303138333430' TO DFHEIV0(25:11)
 18880     CALL 'kxdfhei1' USING DFHEIV0,
 18881           DFHEIV1,
 18882           WS-DLO-VALID-STATE-CODE,
 18883           DLO022-COMM-LENGTH,
 18884           DFHEIV99,
 18885           DFHEIV99,
 18886           DFHEIV99
 18887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18888
 18889
 18890 7770-EXIT.
 18891     EXIT.
 18892
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 348
* EL050.cbl
 18894
 18895 7800-REWRITE-CERT.
 18896******************************************************************
 18897*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 18898*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 18899******************************************************************
 18900
 18901     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 18902        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 18903        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 18904        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 18905
 18906* EXEC CICS REWRITE
 18907*                  DATASET (CERT-ID)
 18908*                  FROM    (CERTIFICATE-MASTER)
 18909*              END-EXEC
 18910     MOVE LENGTH OF
 18911      CERTIFICATE-MASTER
 18912       TO DFHEIV11
 18913*    MOVE '&& L                  %   #00018361' TO DFHEIV0
 18914     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18915     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18916     MOVE X'2020233030303138333631' TO DFHEIV0(25:11)
 18917     CALL 'kxdfhei1' USING DFHEIV0,
 18918           CERT-ID,
 18919           CERTIFICATE-MASTER,
 18920           DFHEIV11,
 18921           DFHEIV99
 18922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18923        GO TO 7800-EXIT.
 18924
 18925       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 18926       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 18927
 18928 7800-EXIT.
 18929      EXIT.
 18930
 18931 7900-DELETE-CERT.
 18932
 18933* EXEC CICS DELETE
 18934*        DATASET (CERT-ID)
 18935*    END-EXEC.
 18936*    MOVE '&(                    &   #00018374' TO DFHEIV0
 18937     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 18938     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18939     MOVE X'2020233030303138333734' TO DFHEIV0(25:11)
 18940     CALL 'kxdfhei1' USING DFHEIV0,
 18941           CERT-ID,
 18942           DFHEIV99,
 18943           DFHEIV99,
 18944           DFHEIV99,
 18945           DFHEIV99
 18946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18947
 18948
 18949 7900-EXIT.
 18950     EXIT.
 18951
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 349
* EL050.cbl
 18952 8000-WRITE-CERT.
 18953
 18954* EXEC CICS HANDLE CONDITION
 18955*        DUPKEY    (8000-FREE-MAIN)
 18956*    END-EXEC.
 18957*    MOVE '"$$                   ! + #00018382' TO DFHEIV0
 18958     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 18959     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18960     MOVE X'2B20233030303138333832' TO DFHEIV0(25:11)
 18961     CALL 'kxdfhei1' USING DFHEIV0
 18962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18963
 18964
 18965
 18966* EXEC CICS WRITE
 18967*        DATASET     (CERT-ID)
 18968*        FROM        (CERTIFICATE-MASTER)
 18969*        RIDFLD      (ELCERT-KEY)
 18970*    END-EXEC.
 18971     MOVE LENGTH OF
 18972      CERTIFICATE-MASTER
 18973       TO DFHEIV11
 18974*    MOVE '&$ L                  ''   #00018386' TO DFHEIV0
 18975     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18976     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18977     MOVE X'2020233030303138333836' TO DFHEIV0(25:11)
 18978     CALL 'kxdfhei1' USING DFHEIV0,
 18979           CERT-ID,
 18980           CERTIFICATE-MASTER,
 18981           DFHEIV11,
 18982           ELCERT-KEY,
 18983           DFHEIV99,
 18984           DFHEIV99
 18985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18986
 18987
 18988 8000-FREE-MAIN.
 18989
 18990 8000-EXIT.
 18991      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 350
* EL050.cbl
 18993
 18994 8100-READ-ERPNDM.
 18995
 18996* EXEC CICS HANDLE CONDITION
 18997*         NOTFND     (8100-NOTFND)
 18998*         ENDFILE    (8100-NOTFND)
 18999*    END-EXEC.
 19000*    MOVE '"$I''                  ! , #00018399' TO DFHEIV0
 19001     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19002     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19003     MOVE X'2C20233030303138333939' TO DFHEIV0(25:11)
 19004     CALL 'kxdfhei1' USING DFHEIV0
 19005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19006
 19007
 19008     MOVE SPACES                 TO ERPNDM-FOUND.
 19009     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19010
 19011
 19012* EXEC CICS READ
 19013*         DATASET   (FILE-ERPNDM)
 19014*         RIDFLD    (PM-CONTROL-PRIMARY)
 19015*         INTO      (PENDING-MAILING-DATA)
 19016*    END-EXEC.
 19017     MOVE LENGTH OF
 19018      PENDING-MAILING-DATA
 19019       TO DFHEIV11
 19020*    MOVE '&"IL       E          (   #00018407' TO DFHEIV0
 19021     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19022     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19023     MOVE X'2020233030303138343037' TO DFHEIV0(25:11)
 19024     CALL 'kxdfhei1' USING DFHEIV0,
 19025           FILE-ERPNDM,
 19026           PENDING-MAILING-DATA,
 19027           DFHEIV11,
 19028           PM-CONTROL-PRIMARY,
 19029           DFHEIV99,
 19030           DFHEIV99,
 19031           DFHEIV99
 19032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19033
 19034
 19035     GO TO 8100-EXIT.
 19036
 19037 8100-NOTFND.
 19038
 19039     MOVE 'X'                    TO ERPNDM-FOUND.
 19040     MOVE ER-2694                TO WS-ERROR.
 19041     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19042     MOVE ER-2883                TO WS-ERROR
 19043     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19044     .
 19045 8100-EXIT.
 19046     EXIT.
 19047
 19048 8110-READ-ERMAIL.
 19049
 19050* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 351
* EL050.cbl
 19051*         NOTFND     (8110-NOTFND)
 19052*         ENDFILE    (8110-NOTFND)
 19053*    END-EXEC.
 19054*    MOVE '"$I''                  ! - #00018427' TO DFHEIV0
 19055     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19056     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19057     MOVE X'2D20233030303138343237' TO DFHEIV0(25:11)
 19058     CALL 'kxdfhei1' USING DFHEIV0
 19059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19060
 19061
 19062     MOVE SPACES                 TO ERMAIL-FOUND.
 19063     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19064     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19065     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19066     MOVE PB-SV-STATE            TO MA-STATE.
 19067
 19068
 19069* EXEC CICS READ
 19070*         UPDATE
 19071*         DATASET   (FILE-ERMAIL)
 19072*         RIDFLD    (MA-CONTROL-PRIMARY)
 19073*         INTO      (MAILING-DATA)
 19074*    END-EXEC.
 19075     MOVE LENGTH OF
 19076      MAILING-DATA
 19077       TO DFHEIV11
 19078*    MOVE '&"IL       EU         (   #00018438' TO DFHEIV0
 19079     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19080     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19081     MOVE X'2020233030303138343338' TO DFHEIV0(25:11)
 19082     CALL 'kxdfhei1' USING DFHEIV0,
 19083           FILE-ERMAIL,
 19084           MAILING-DATA,
 19085           DFHEIV11,
 19086           MA-CONTROL-PRIMARY,
 19087           DFHEIV99,
 19088           DFHEIV99,
 19089           DFHEIV99
 19090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19091
 19092
 19093     GO TO 8110-EXIT.
 19094
 19095 8110-NOTFND.
 19096     MOVE 'X'                    TO ERMAIL-FOUND.
 19097
 19098 8110-EXIT.
 19099     EXIT.
 19100
 19101 8120-REWRITE-ERMAIL.
 19102
 19103* EXEC CICS REWRITE
 19104*         DATASET    (FILE-ERMAIL)
 19105*         FROM       (MAILING-DATA)
 19106*    END-EXEC.
 19107     MOVE LENGTH OF
 19108      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 352
* EL050.cbl
 19109       TO DFHEIV11
 19110*    MOVE '&& L                  %   #00018454' TO DFHEIV0
 19111     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19112     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19113     MOVE X'2020233030303138343534' TO DFHEIV0(25:11)
 19114     CALL 'kxdfhei1' USING DFHEIV0,
 19115           FILE-ERMAIL,
 19116           MAILING-DATA,
 19117           DFHEIV11,
 19118           DFHEIV99
 19119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19120
 19121
 19122 8120-EXIT.
 19123     EXIT.
 19124
 19125 8130-WRITE-ERMAIL.
 19126
 19127* EXEC CICS HANDLE CONDITION
 19128*         DUPKEY   (8130-EXIT)
 19129*    END-EXEC.
 19130*    MOVE '"$$                   ! . #00018463' TO DFHEIV0
 19131     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19132     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19133     MOVE X'2E20233030303138343633' TO DFHEIV0(25:11)
 19134     CALL 'kxdfhei1' USING DFHEIV0
 19135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19136
 19137
 19138
 19139* EXEC CICS WRITE
 19140*         DATASET     (FILE-ERMAIL)
 19141*         RIDFLD      (MA-CONTROL-PRIMARY)
 19142*         FROM        (MAILING-DATA)
 19143*    END-EXEC.
 19144     MOVE LENGTH OF
 19145      MAILING-DATA
 19146       TO DFHEIV11
 19147*    MOVE '&$ L                  ''   #00018467' TO DFHEIV0
 19148     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19149     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19150     MOVE X'2020233030303138343637' TO DFHEIV0(25:11)
 19151     CALL 'kxdfhei1' USING DFHEIV0,
 19152           FILE-ERMAIL,
 19153           MAILING-DATA,
 19154           DFHEIV11,
 19155           MA-CONTROL-PRIMARY,
 19156           DFHEIV99,
 19157           DFHEIV99
 19158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19159
 19160
 19161 8130-EXIT.
 19162     EXIT.
 19163
 19164 8140-UNLOCK-ERMAIL.
 19165
 19166* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 353
* EL050.cbl
 19167*         DATASET   (FILE-ERMAIL)
 19168*    END-EXEC.
 19169*    MOVE '&*                    #   #00018477' TO DFHEIV0
 19170     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19171     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19172     MOVE X'2020233030303138343737' TO DFHEIV0(25:11)
 19173     CALL 'kxdfhei1' USING DFHEIV0,
 19174           FILE-ERMAIL,
 19175           DFHEIV99
 19176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19177
 19178
 19179 8140-EXIT.
 19180     EXIT.
 19181
 19182 8180-UPDATE-VIN-NUMBER.
 19183
 19184* EXEC CICS HANDLE CONDITION
 19185*        NOTFND   (8180-NOTFND)
 19186*    END-EXEC.
 19187*    MOVE '"$I                   ! / #00018485' TO DFHEIV0
 19188     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19189     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19190     MOVE X'2F20233030303138343835' TO DFHEIV0(25:11)
 19191     CALL 'kxdfhei1' USING DFHEIV0
 19192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19193
 19194
 19195     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19196     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19197
 19198
 19199* EXEC CICS READ
 19200*        UPDATE
 19201*        DATASET  (CRTT-ID)
 19202*        RIDFLD   (WS-ELCRTT-KEY)
 19203*        INTO     (CERTIFICATE-TRAILERS)
 19204*    END-EXEC.
 19205     MOVE LENGTH OF
 19206      CERTIFICATE-TRAILERS
 19207       TO DFHEIV11
 19208*    MOVE '&"IL       EU         (   #00018492' TO DFHEIV0
 19209     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19210     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19211     MOVE X'2020233030303138343932' TO DFHEIV0(25:11)
 19212     CALL 'kxdfhei1' USING DFHEIV0,
 19213           CRTT-ID,
 19214           CERTIFICATE-TRAILERS,
 19215           DFHEIV11,
 19216           WS-ELCRTT-KEY,
 19217           DFHEIV99,
 19218           DFHEIV99,
 19219           DFHEIV99
 19220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19221
 19222
 19223     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19224         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 354
* EL050.cbl
 19225
 19226* EXEC CICS REWRITE
 19227*           DATASET  (CRTT-ID)
 19228*           FROM     (CERTIFICATE-TRAILERS)
 19229*        END-EXEC
 19230     MOVE LENGTH OF
 19231      CERTIFICATE-TRAILERS
 19232       TO DFHEIV11
 19233*    MOVE '&& L                  %   #00018501' TO DFHEIV0
 19234     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19235     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19236     MOVE X'2020233030303138353031' TO DFHEIV0(25:11)
 19237     CALL 'kxdfhei1' USING DFHEIV0,
 19238           CRTT-ID,
 19239           CERTIFICATE-TRAILERS,
 19240           DFHEIV11,
 19241           DFHEIV99
 19242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19243     ELSE
 19244
 19245* EXEC CICS UNLOCK
 19246*          DATASET  (CRTT-ID)
 19247*       END-EXEC
 19248*    MOVE '&*                    #   #00018506' TO DFHEIV0
 19249     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19250     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19251     MOVE X'2020233030303138353036' TO DFHEIV0(25:11)
 19252     CALL 'kxdfhei1' USING DFHEIV0,
 19253           CRTT-ID,
 19254           DFHEIV99
 19255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19256     END-IF.
 19257
 19258     GO TO 8180-EXIT.
 19259
 19260 8180-NOTFND.
 19261
 19262     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19263     MOVE 'CS'         TO CS-RECORD-ID.
 19264     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19265     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19266     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19267     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19268
 19269* EXEC CICS WRITE
 19270*       DATASET  (CRTT-ID)
 19271*       RIDFLD   (WS-ELCRTT-KEY)
 19272*       FROM     (CERTIFICATE-TRAILERS)
 19273*    END-EXEC.
 19274     MOVE LENGTH OF
 19275      CERTIFICATE-TRAILERS
 19276       TO DFHEIV11
 19277*    MOVE '&$ L                  ''   #00018521' TO DFHEIV0
 19278     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19279     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19280     MOVE X'2020233030303138353231' TO DFHEIV0(25:11)
 19281     CALL 'kxdfhei1' USING DFHEIV0,
 19282           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 355
* EL050.cbl
 19283           CERTIFICATE-TRAILERS,
 19284           DFHEIV11,
 19285           WS-ELCRTT-KEY,
 19286           DFHEIV99,
 19287           DFHEIV99
 19288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19289
 19290
 19291 8180-EXIT.
 19292     EXIT.
 19293
 19294 8190-UPDATE-REFUND-CLAIM-FLAG.
 19295
 19296* EXEC CICS HANDLE CONDITION
 19297*        NOTFND   (8190-NOTFND)
 19298*    END-EXEC.
 19299*    MOVE '"$I                   ! 0 #00018531' TO DFHEIV0
 19300     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19301     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19302     MOVE X'3020233030303138353331' TO DFHEIV0(25:11)
 19303     CALL 'kxdfhei1' USING DFHEIV0
 19304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19305
 19306
 19307     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19308     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19309
 19310
 19311* EXEC CICS READ
 19312*        UPDATE
 19313*        DATASET  (CRTT-ID)
 19314*        RIDFLD   (WS-ELCRTT-KEY)
 19315*        INTO     (CERTIFICATE-TRAILERS)
 19316*    END-EXEC.
 19317     MOVE LENGTH OF
 19318      CERTIFICATE-TRAILERS
 19319       TO DFHEIV11
 19320*    MOVE '&"IL       EU         (   #00018538' TO DFHEIV0
 19321     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19322     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19323     MOVE X'2020233030303138353338' TO DFHEIV0(25:11)
 19324     CALL 'kxdfhei1' USING DFHEIV0,
 19325           CRTT-ID,
 19326           CERTIFICATE-TRAILERS,
 19327           DFHEIV11,
 19328           WS-ELCRTT-KEY,
 19329           DFHEIV99,
 19330           DFHEIV99,
 19331           DFHEIV99
 19332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19333
 19334
 19335     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19336
 19337* EXEC CICS REWRITE
 19338*       DATASET  (CRTT-ID)
 19339*       FROM     (CERTIFICATE-TRAILERS)
 19340*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 356
* EL050.cbl
 19341     MOVE LENGTH OF
 19342      CERTIFICATE-TRAILERS
 19343       TO DFHEIV11
 19344*    MOVE '&& L                  %   #00018546' TO DFHEIV0
 19345     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19346     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19347     MOVE X'2020233030303138353436' TO DFHEIV0(25:11)
 19348     CALL 'kxdfhei1' USING DFHEIV0,
 19349           CRTT-ID,
 19350           CERTIFICATE-TRAILERS,
 19351           DFHEIV11,
 19352           DFHEIV99
 19353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19354
 19355
 19356     GO TO 8190-EXIT.
 19357
 19358 8190-NOTFND.
 19359
 19360     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19361     MOVE 'CS'         TO CS-RECORD-ID.
 19362     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19363     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19364     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19365     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19366
 19367* EXEC CICS WRITE
 19368*       DATASET  (CRTT-ID)
 19369*       RIDFLD   (WS-ELCRTT-KEY)
 19370*       FROM     (CERTIFICATE-TRAILERS)
 19371*    END-EXEC.
 19372     MOVE LENGTH OF
 19373      CERTIFICATE-TRAILERS
 19374       TO DFHEIV11
 19375*    MOVE '&$ L                  ''   #00018561' TO DFHEIV0
 19376     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19377     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19378     MOVE X'2020233030303138353631' TO DFHEIV0(25:11)
 19379     CALL 'kxdfhei1' USING DFHEIV0,
 19380           CRTT-ID,
 19381           CERTIFICATE-TRAILERS,
 19382           DFHEIV11,
 19383           WS-ELCRTT-KEY,
 19384           DFHEIV99,
 19385           DFHEIV99
 19386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19387
 19388
 19389 8190-EXIT.
 19390     EXIT.
 19391
 19392 8200-READ-REIN-TABLE.
 19393
 19394* EXEC CICS HANDLE CONDITION
 19395*         NOTFND   (8200-NOTFND)
 19396*    END-EXEC.
 19397*    MOVE '"$I                   ! 1 #00018571' TO DFHEIV0
 19398     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 357
* EL050.cbl
 19399     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19400     MOVE X'3120233030303138353731' TO DFHEIV0(25:11)
 19401     CALL 'kxdfhei1' USING DFHEIV0
 19402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19403
 19404
 19405
 19406* EXEC CICS READ
 19407*        DATASET     (REIN-ID)
 19408*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19409*        RIDFLD      (ERREIN-KEY)
 19410*    END-EXEC.
 19411*    MOVE '&"S        E          (   #00018575' TO DFHEIV0
 19412     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19413     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19414     MOVE X'2020233030303138353735' TO DFHEIV0(25:11)
 19415     CALL 'kxdfhei1' USING DFHEIV0,
 19416           REIN-ID,
 19417           DFHEIV20,
 19418           DFHEIV99,
 19419           ERREIN-KEY,
 19420           DFHEIV99,
 19421           DFHEIV99,
 19422           DFHEIV99
 19423     SET ADDRESS OF REINSURANCE-RECORD TO
 19424         DFHEIV20
 19425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19426
 19427
 19428     GO TO 8200-EXIT.
 19429
 19430 8200-NOTFND.
 19431     MOVE 'N'             TO WS-REIN-READ-SW.
 19432
 19433 8200-EXIT.
 19434      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 358
* EL050.cbl
 19436
 19437 8300-READ-CTBL-TABLE.
 19438
 19439* EXEC CICS HANDLE CONDITION
 19440*        NOTFND    (8300-NOTFND)
 19441*        DISABLED  (8300-ERRESS-PROBLEM)
 19442*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19443*        ENDFILE   (8300-NOTFND)
 19444*    END-EXEC.
 19445*    MOVE '"$IcJ''                ! 2 #00018591' TO DFHEIV0
 19446     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19447     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19448     MOVE X'3220233030303138353931' TO DFHEIV0(25:11)
 19449     CALL 'kxdfhei1' USING DFHEIV0
 19450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19451
 19452
 19453
 19454* EXEC CICS READ
 19455*        DATASET     (CTBL-ID)
 19456*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19457*        RIDFLD      (ERCTBL-KEY)
 19458*    END-EXEC.
 19459*    MOVE '&"S        E          (   #00018598' TO DFHEIV0
 19460     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19461     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19462     MOVE X'2020233030303138353938' TO DFHEIV0(25:11)
 19463     CALL 'kxdfhei1' USING DFHEIV0,
 19464           CTBL-ID,
 19465           DFHEIV20,
 19466           DFHEIV99,
 19467           ERCTBL-KEY,
 19468           DFHEIV99,
 19469           DFHEIV99,
 19470           DFHEIV99
 19471     SET ADDRESS OF COMM-TABLE-RECORD TO
 19472         DFHEIV20
 19473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19474
 19475
 19476     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19477
 19478     GO TO 8300-EXIT.
 19479
 19480 8300-NOTFND.
 19481
 19482     IF CTBL-SW = '0530'
 19483         MOVE 'AA'                     TO WS-AH-COMP-CD
 19484         MOVE '0550'                   TO CTBL-SW
 19485         MOVE '1'                      TO WS-CTBL-READ-SW
 19486         GO TO 8300-EXIT.
 19487
 19488     IF CTBL-SW = '0540'
 19489         MOVE 'AA'                     TO WS-LF-COMP-CD
 19490         MOVE '0550'                   TO CTBL-SW
 19491         MOVE '1'                      TO WS-CTBL-READ-SW
 19492         GO TO 8300-EXIT.
 19493
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 359
* EL050.cbl
 19494     IF CTBL-SW = '0550'
 19495         MOVE '2'                      TO WS-CTBL-READ-SW
 19496         GO TO 8300-EXIT.
 19497
 19498     GO TO 8300-EXIT.
 19499
 19500 8300-ERRESS-PROBLEM.
 19501
 19502      MOVE ER-8050              TO WS-ERROR.
 19503      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19504
 19505     GO TO 8300-EXIT.
 19506
 19507 8300-EXIT.
 19508      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 360
* EL050.cbl
 19510
 19511
 19512 8400-GETMAIN-ERFORM.
 19513
 19514
 19515* EXEC CICS   GETMAIN
 19516*        LENGTH  (500)
 19517*        SET     (ADDRESS OF FORM-MASTER)
 19518*    END-EXEC.
 19519     MOVE 500
 19520       TO DFHEIV11
 19521*    MOVE '," L                  $   #00018642' TO DFHEIV0
 19522     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19523     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19524     MOVE X'2020233030303138363432' TO DFHEIV0(25:11)
 19525     CALL 'kxdfhei1' USING DFHEIV0,
 19526           DFHEIV20,
 19527           DFHEIV11,
 19528           DFHEIV99
 19529     SET ADDRESS OF FORM-MASTER TO
 19530         DFHEIV20
 19531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19532
 19533
 19534     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19535
 19536 8400-EXIT.
 19537      EXIT.
 19538
 19539 8450-READ-FORM-MASTER.
 19540
 19541
 19542* EXEC CICS  HANDLE CONDITION
 19543*        NOTFND   (8450-FORM-NOT-FOUND)
 19544*        ENDFILE  (8450-FORM-NOT-FOUND)
 19545*    END-EXEC.
 19546*    MOVE '"$I''                  ! 3 #00018654' TO DFHEIV0
 19547     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19548     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19549     MOVE X'3320233030303138363534' TO DFHEIV0(25:11)
 19550     CALL 'kxdfhei1' USING DFHEIV0
 19551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19552
 19553
 19554
 19555* EXEC CICS   READ
 19556*        DATASET   (FORM-ID)
 19557*        RIDFLD    (ERFORM-KEY)
 19558*        INTO      (FORM-MASTER)
 19559*        GTEQ
 19560*    END-EXEC.
 19561     MOVE LENGTH OF
 19562      FORM-MASTER
 19563       TO DFHEIV11
 19564*    MOVE '&"IL       G          (   #00018659' TO DFHEIV0
 19565     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19566     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19567     MOVE X'2020233030303138363539' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 361
* EL050.cbl
 19568     CALL 'kxdfhei1' USING DFHEIV0,
 19569           FORM-ID,
 19570           FORM-MASTER,
 19571           DFHEIV11,
 19572           ERFORM-KEY,
 19573           DFHEIV99,
 19574           DFHEIV99,
 19575           DFHEIV99
 19576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19577
 19578
 19579     MOVE  'Y'           TO  FORM-MASTER-SW.
 19580
 19581     GO TO  8450-EXIT.
 19582
 19583 8450-FORM-NOT-FOUND.
 19584
 19585     MOVE  'N'           TO  FORM-MASTER-SW.
 19586
 19587 8450-EXIT.
 19588      EXIT.
 19589
 19590 8500-DATE-CONVERT.
 19591
 19592* EXEC CICS LINK
 19593*        PROGRAM    ('ELDATCV')
 19594*        COMMAREA   (DATE-CONVERSION-DATA)
 19595*        LENGTH     (DC-COMM-LENGTH)
 19596*    END-EXEC.
 19597     MOVE 'ELDATCV' TO DFHEIV1
 19598*    MOVE '."C                   ''   #00018678' TO DFHEIV0
 19599     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19600     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19601     MOVE X'2020233030303138363738' TO DFHEIV0(25:11)
 19602     CALL 'kxdfhei1' USING DFHEIV0,
 19603           DFHEIV1,
 19604           DATE-CONVERSION-DATA,
 19605           DC-COMM-LENGTH,
 19606           DFHEIV99,
 19607           DFHEIV99,
 19608           DFHEIV99
 19609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19610
 19611
 19612 8500-EXIT.
 19613     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 362
* EL050.cbl
 19615
 19616 8555-RELOAD-CONTROL-FILE.
 19617     CONTINUE.
 19618
 19619 8555-EXIT.
 19620     EXIT.
 19621
 19622 8557-GETMAIN-ERPLAN.
 19623
 19624
 19625* EXEC CICS GETMAIN
 19626*        LENGTH    (840)
 19627*        SET       (ADDRESS OF PLAN-RECORDS)
 19628*    END-EXEC.
 19629     MOVE 840
 19630       TO DFHEIV11
 19631*    MOVE '," L                  $   #00018696' TO DFHEIV0
 19632     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19633     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19634     MOVE X'2020233030303138363936' TO DFHEIV0(25:11)
 19635     CALL 'kxdfhei1' USING DFHEIV0,
 19636           DFHEIV20,
 19637           DFHEIV11,
 19638           DFHEIV99
 19639     SET ADDRESS OF PLAN-RECORDS TO
 19640         DFHEIV20
 19641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19642
 19643
 19644     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 19645
 19646 8557-EXIT.
 19647     EXIT.
 19648
 19649 8560-GETMAIN.
 19650
 19651* EXEC CICS GETMAIN
 19652*        LENGTH    (2000)
 19653*        SET       (ADDRESS OF ACCOUNT-MASTER)
 19654*    END-EXEC.
 19655     MOVE 2000
 19656       TO DFHEIV11
 19657*    MOVE '," L                  $   #00018707' TO DFHEIV0
 19658     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19659     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19660     MOVE X'2020233030303138373037' TO DFHEIV0(25:11)
 19661     CALL 'kxdfhei1' USING DFHEIV0,
 19662           DFHEIV20,
 19663           DFHEIV11,
 19664           DFHEIV99
 19665     SET ADDRESS OF ACCOUNT-MASTER TO
 19666         DFHEIV20
 19667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19668
 19669
 19670     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 19671
 19672 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 363
* EL050.cbl
 19673     EXIT.
 19674
 19675 8570-START-ACCOUNT-MASTER.
 19676
 19677* EXEC CICS HANDLE CONDITION
 19678*        NOTFND    (0199-ACCT-NOT-FOUND)
 19679*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19680*    END-EXEC.
 19681*    MOVE '"$I''                  ! 4 #00018718' TO DFHEIV0
 19682     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19683     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19684     MOVE X'3420233030303138373138' TO DFHEIV0(25:11)
 19685     CALL 'kxdfhei1' USING DFHEIV0
 19686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19687
 19688
 19689
 19690* EXEC CICS STARTBR
 19691*        DATASET    (ACCT-ID)
 19692*        RIDFLD     (ERACCT-KEY)
 19693*        GTEQ
 19694*    END-EXEC.
 19695     MOVE 0
 19696       TO DFHEIV11
 19697*    MOVE '&,         G          &   #00018723' TO DFHEIV0
 19698     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19699     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19700     MOVE X'2020233030303138373233' TO DFHEIV0(25:11)
 19701     CALL 'kxdfhei1' USING DFHEIV0,
 19702           ACCT-ID,
 19703           ERACCT-KEY,
 19704           DFHEIV99,
 19705           DFHEIV11,
 19706           DFHEIV99
 19707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19708
 19709
 19710 8570-EXIT.
 19711     EXIT.
 19712
 19713 8580-READ-ACCOUNT-MASTER.
 19714
 19715* EXEC CICS HANDLE CONDITION
 19716*        NOTFND    (0199-ACCT-NOT-FOUND)
 19717*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19718*    END-EXEC.
 19719*    MOVE '"$I''                  ! 5 #00018733' TO DFHEIV0
 19720     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19721     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19722     MOVE X'3520233030303138373333' TO DFHEIV0(25:11)
 19723     CALL 'kxdfhei1' USING DFHEIV0
 19724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19725
 19726
 19727
 19728* EXEC CICS READNEXT
 19729*        DATASET     (ACCT-ID)
 19730*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 364
* EL050.cbl
 19731*        RIDFLD      (ERACCT-KEY)
 19732*    END-EXEC.
 19733     MOVE LENGTH OF
 19734      ACCOUNT-MASTER
 19735       TO DFHEIV12
 19736     MOVE 0
 19737       TO DFHEIV11
 19738*    MOVE '&.IL                  )   #00018738' TO DFHEIV0
 19739     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19740     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19741     MOVE X'2020233030303138373338' TO DFHEIV0(25:11)
 19742     CALL 'kxdfhei1' USING DFHEIV0,
 19743           ACCT-ID,
 19744           ACCOUNT-MASTER,
 19745           DFHEIV12,
 19746           ERACCT-KEY,
 19747           DFHEIV99,
 19748           DFHEIV11,
 19749           DFHEIV99,
 19750           DFHEIV99
 19751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19752
 19753
 19754 8580-EXIT.
 19755     EXIT.
 19756
 19757 8582-READ-COMPENSATION-MASTER.
 19758
 19759* EXEC CICS HANDLE CONDITION
 19760*        NOTFND    (8582-COMP-NOT-FOUND)
 19761*        ENDFILE   (8582-COMP-NOT-FOUND)
 19762*    END-EXEC.
 19763*    MOVE '"$I''                  ! 6 #00018748' TO DFHEIV0
 19764     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19765     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19766     MOVE X'3620233030303138373438' TO DFHEIV0(25:11)
 19767     CALL 'kxdfhei1' USING DFHEIV0
 19768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19769
 19770
 19771
 19772* EXEC CICS READ
 19773*        DATASET     (COMP-ID)
 19774*        INTO        (COMPENSATION-MASTER)
 19775*        RIDFLD      (ERCOMP-KEY)
 19776*    END-EXEC.
 19777     MOVE LENGTH OF
 19778      COMPENSATION-MASTER
 19779       TO DFHEIV11
 19780*    MOVE '&"IL       E          (   #00018753' TO DFHEIV0
 19781     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19782     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19783     MOVE X'2020233030303138373533' TO DFHEIV0(25:11)
 19784     CALL 'kxdfhei1' USING DFHEIV0,
 19785           COMP-ID,
 19786           COMPENSATION-MASTER,
 19787           DFHEIV11,
 19788           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 365
* EL050.cbl
 19789           DFHEIV99,
 19790           DFHEIV99,
 19791           DFHEIV99
 19792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19793
 19794
 19795     MOVE 'Y'                    TO COMP-MASTER-SW
 19796
 19797     GO TO 8582-EXIT
 19798     .
 19799 8582-COMP-NOT-FOUND.
 19800
 19801     MOVE 'N'                    TO COMP-MASTER-SW.
 19802
 19803 8582-EXIT.
 19804     EXIT.
 19805
 19806 8583-READ-ERAGTC.
 19807
 19808* EXEC CICS HANDLE CONDITION
 19809*        NOTFND    (8583-AGTC-NOT-FOUND)
 19810*        ENDFILE   (8583-AGTC-NOT-FOUND)
 19811*    END-EXEC.
 19812*    MOVE '"$I''                  ! 7 #00018771' TO DFHEIV0
 19813     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19814     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19815     MOVE X'3720233030303138373731' TO DFHEIV0(25:11)
 19816     CALL 'kxdfhei1' USING DFHEIV0
 19817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19818
 19819
 19820
 19821* EXEC CICS STARTBR
 19822*        DATASET    (AGTC-ID)
 19823*        RIDFLD     (ERAGTC-KEY)
 19824*        GTEQ
 19825*    END-EXEC.
 19826     MOVE 0
 19827       TO DFHEIV11
 19828*    MOVE '&,         G          &   #00018776' TO DFHEIV0
 19829     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19830     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19831     MOVE X'2020233030303138373736' TO DFHEIV0(25:11)
 19832     CALL 'kxdfhei1' USING DFHEIV0,
 19833           AGTC-ID,
 19834           ERAGTC-KEY,
 19835           DFHEIV99,
 19836           DFHEIV11,
 19837           DFHEIV99
 19838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19839
 19840
 19841 8583-READ-ERAGTC-NEXT.
 19842
 19843* EXEC CICS READNEXT
 19844*        DATASET     (AGTC-ID)
 19845*        INTO        (AGENT-COMMISSIONS)
 19846*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 366
* EL050.cbl
 19847*    END-EXEC.
 19848     MOVE LENGTH OF
 19849      AGENT-COMMISSIONS
 19850       TO DFHEIV12
 19851     MOVE 0
 19852       TO DFHEIV11
 19853*    MOVE '&.IL                  )   #00018783' TO DFHEIV0
 19854     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19855     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19856     MOVE X'2020233030303138373833' TO DFHEIV0(25:11)
 19857     CALL 'kxdfhei1' USING DFHEIV0,
 19858           AGTC-ID,
 19859           AGENT-COMMISSIONS,
 19860           DFHEIV12,
 19861           ERAGTC-KEY,
 19862           DFHEIV99,
 19863           DFHEIV11,
 19864           DFHEIV99,
 19865           DFHEIV99
 19866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19867
 19868
 19869*    MOVE 'Y'                    TO AGTC-MASTER-SW
 19870
 19871     GO TO 8583-EXIT
 19872     .
 19873 8583-AGTC-NOT-FOUND.
 19874
 19875     MOVE 'N'                    TO AGTC-MASTER-SW.
 19876
 19877 8583-EXIT.
 19878     EXIT.
 19879
 19880 8584-READ-BANK-CROSS-REF.
 19881
 19882* EXEC CICS HANDLE CONDITION
 19883*        NOTFND    (8584-BXRF-NOT-FOUND)
 19884*        ENDFILE   (8584-BXRF-NOT-FOUND)
 19885*    END-EXEC.
 19886*    MOVE '"$I''                  ! 8 #00018801' TO DFHEIV0
 19887     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19888     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19889     MOVE X'3820233030303138383031' TO DFHEIV0(25:11)
 19890     CALL 'kxdfhei1' USING DFHEIV0
 19891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19892
 19893
 19894
 19895* EXEC CICS READ
 19896*        DATASET     (BXRF-ID)
 19897*        INTO        (BANK-CROSS-REFERENCE)
 19898*        RIDFLD      (ERBXRF-KEY)
 19899*        LENGTH      (BXRF-REC-LENGTH)
 19900*    END-EXEC.
 19901*    MOVE '&"IL       E          (   #00018806' TO DFHEIV0
 19902     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19903     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19904     MOVE X'2020233030303138383036' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 367
* EL050.cbl
 19905     CALL 'kxdfhei1' USING DFHEIV0,
 19906           BXRF-ID,
 19907           BANK-CROSS-REFERENCE,
 19908           BXRF-REC-LENGTH,
 19909           ERBXRF-KEY,
 19910           DFHEIV99,
 19911           DFHEIV99,
 19912           DFHEIV99
 19913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19914
 19915
 19916     MOVE 'Y'                    TO BXRF-MASTER-SW
 19917
 19918     GO TO 8584-EXIT
 19919     .
 19920 8584-BXRF-NOT-FOUND.
 19921
 19922     MOVE 'N'                    TO BXRF-MASTER-SW.
 19923
 19924 8584-EXIT.
 19925     EXIT.
 19926
 19927 8585-READ-PLAN-MASTER.
 19928
 19929
 19930* EXEC CICS HANDLE CONDITION
 19931*        NOTFND    (8585-PLAN-NOT-FOUND)
 19932*        ENDFILE   (8585-PLAN-NOT-FOUND)
 19933*    END-EXEC.
 19934*    MOVE '"$I''                  ! 9 #00018826' TO DFHEIV0
 19935     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19936     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19937     MOVE X'3920233030303138383236' TO DFHEIV0(25:11)
 19938     CALL 'kxdfhei1' USING DFHEIV0
 19939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19940
 19941
 19942
 19943* EXEC CICS READ
 19944*        DATASET     (PLAN-ID)
 19945*        INTO        (PLAN-MASTER)
 19946*        RIDFLD      (ERPLAN-KEY)
 19947*    END-EXEC.
 19948     MOVE LENGTH OF
 19949      PLAN-MASTER
 19950       TO DFHEIV11
 19951*    MOVE '&"IL       E          (   #00018831' TO DFHEIV0
 19952     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19953     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19954     MOVE X'2020233030303138383331' TO DFHEIV0(25:11)
 19955     CALL 'kxdfhei1' USING DFHEIV0,
 19956           PLAN-ID,
 19957           PLAN-MASTER,
 19958           DFHEIV11,
 19959           ERPLAN-KEY,
 19960           DFHEIV99,
 19961           DFHEIV99,
 19962           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 368
* EL050.cbl
 19963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19964
 19965
 19966     MOVE 'Y'                    TO PLAN-MASTER-SW.
 19967
 19968     GO TO 8585-EXIT.
 19969
 19970 8585-PLAN-NOT-FOUND.
 19971
 19972     MOVE 'N'                    TO PLAN-MASTER-SW.
 19973
 19974 8585-EXIT.
 19975     EXIT.
 19976
 19977 8586-READ-LOAN-OFFICER.
 19978
 19979* EXEC CICS READ
 19980*        DATASET     (LOFC-ID)
 19981*        INTO        (LOAN-OFFICER-MASTER)
 19982*        RIDFLD      (ERLOFC-KEY)
 19983*        RESP        (WS-RESPONSE)
 19984*    END-EXEC
 19985     MOVE LENGTH OF
 19986      LOAN-OFFICER-MASTER
 19987       TO DFHEIV11
 19988*    MOVE '&"IL       E          (  N#00018849' TO DFHEIV0
 19989     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19990     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19991     MOVE X'204E233030303138383439' TO DFHEIV0(25:11)
 19992     CALL 'kxdfhei1' USING DFHEIV0,
 19993           LOFC-ID,
 19994           LOAN-OFFICER-MASTER,
 19995           DFHEIV11,
 19996           ERLOFC-KEY,
 19997           DFHEIV99,
 19998           DFHEIV99,
 19999           DFHEIV99
 20000     MOVE EIBRESP  TO WS-RESPONSE
 20001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20002
 20003     IF WS-RESP-NORMAL
 20004        MOVE 'Y'                 TO LOFC-MASTER-SW
 20005     ELSE
 20006        MOVE 'N'                 TO LOFC-MASTER-SW
 20007     END-IF
 20008     .
 20009 8586-EXIT.
 20010     EXIT.
 20011 8587-START-ERPDEF.
 20012
 20013* EXEC CICS STARTBR
 20014*       DATASET   (PDEF-ID)
 20015*       RIDFLD    (ERPDEF-KEY)
 20016*       GTEQ
 20017*       RESP      (WS-RESPONSE)
 20018*    END-EXEC
 20019     MOVE 0
 20020       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 369
* EL050.cbl
 20021*    MOVE '&,         G          &  N#00018865' TO DFHEIV0
 20022     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20023     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20024     MOVE X'204E233030303138383635' TO DFHEIV0(25:11)
 20025     CALL 'kxdfhei1' USING DFHEIV0,
 20026           PDEF-ID,
 20027           ERPDEF-KEY,
 20028           DFHEIV99,
 20029           DFHEIV11,
 20030           DFHEIV99
 20031     MOVE EIBRESP  TO WS-RESPONSE
 20032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20033     IF WS-RESP-NORMAL
 20034        MOVE 'Y'                 TO PDEF-MASTER-SW
 20035     ELSE
 20036        MOVE 'N'                 TO PDEF-MASTER-SW
 20037     END-IF
 20038     .
 20039 8587-EXIT.
 20040     EXIT.
 20041 8588-READ-ERPDEF.
 20042
 20043* EXEC CICS READNEXT
 20044*       DATASET   (PDEF-ID)
 20045*       RIDFLD    (ERPDEF-KEY)
 20046*       INTO      (PRODUCT-MASTER)
 20047*       RESP      (WS-RESPONSE)
 20048*    END-EXEC
 20049     MOVE LENGTH OF
 20050      PRODUCT-MASTER
 20051       TO DFHEIV12
 20052     MOVE 0
 20053       TO DFHEIV11
 20054*    MOVE '&.IL                  )  N#00018880' TO DFHEIV0
 20055     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20056     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20057     MOVE X'204E233030303138383830' TO DFHEIV0(25:11)
 20058     CALL 'kxdfhei1' USING DFHEIV0,
 20059           PDEF-ID,
 20060           PRODUCT-MASTER,
 20061           DFHEIV12,
 20062           ERPDEF-KEY,
 20063           DFHEIV99,
 20064           DFHEIV11,
 20065           DFHEIV99,
 20066           DFHEIV99
 20067     MOVE EIBRESP  TO WS-RESPONSE
 20068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20069     IF WS-RESP-NORMAL
 20070        MOVE 'Y'                 TO PDEF-MASTER-SW
 20071     ELSE
 20072        MOVE 'N'                 TO PDEF-MASTER-SW
 20073     END-IF
 20074     .
 20075 8588-EXIT.
 20076     EXIT.
 20077 8589-ENDBR-ERPDEF.
 20078
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 370
* EL050.cbl
 20079* EXEC CICS ENDBR
 20080*       DATASET   (PDEF-ID)
 20081*    END-EXEC
 20082     MOVE 0
 20083       TO DFHEIV11
 20084*    MOVE '&2                    $   #00018895' TO DFHEIV0
 20085     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20086     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20087     MOVE X'2020233030303138383935' TO DFHEIV0(25:11)
 20088     CALL 'kxdfhei1' USING DFHEIV0,
 20089           PDEF-ID,
 20090           DFHEIV11,
 20091           DFHEIV99
 20092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20093     .
 20094 8589-EXIT.
 20095     EXIT.
 20096 8590-READ-CERT-MASTER.
 20097     IF PB-COMPANY-ID = 'UCL'
 20098         GO TO 8690-READ-CERT-MASTER-UCL.
 20099
 20100
 20101* EXEC CICS HANDLE CONDITION
 20102*         NOTFND    (0299-CERT-NOT-FOUND)
 20103*    END-EXEC.
 20104*    MOVE '"$I                   ! : #00018905' TO DFHEIV0
 20105     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20107     MOVE X'3A20233030303138393035' TO DFHEIV0(25:11)
 20108     CALL 'kxdfhei1' USING DFHEIV0
 20109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20110
 20111
 20112
 20113* EXEC CICS READ
 20114*        DATASET     (CERT-ID)
 20115*        INTO        (CERTIFICATE-MASTER)
 20116*        RIDFLD      (ELCERT-KEY)
 20117*        UPDATE
 20118*    END-EXEC.
 20119     MOVE LENGTH OF
 20120      CERTIFICATE-MASTER
 20121       TO DFHEIV11
 20122*    MOVE '&"IL       EU         (   #00018909' TO DFHEIV0
 20123     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20124     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20125     MOVE X'2020233030303138393039' TO DFHEIV0(25:11)
 20126     CALL 'kxdfhei1' USING DFHEIV0,
 20127           CERT-ID,
 20128           CERTIFICATE-MASTER,
 20129           DFHEIV11,
 20130           ELCERT-KEY,
 20131           DFHEIV99,
 20132           DFHEIV99,
 20133           DFHEIV99
 20134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20135
 20136
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 371
* EL050.cbl
 20137 8590-EXIT.
 20138     EXIT.
 20139
 20140 8690-READ-CERT-MASTER-UCL.
 20141
 20142* EXEC CICS HANDLE CONDITION
 20143*         NOTFND    (8700-READ-CERT-MASTER)
 20144*    END-EXEC.
 20145*    MOVE '"$I                   ! ; #00018920' TO DFHEIV0
 20146     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20147     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20148     MOVE X'3B20233030303138393230' TO DFHEIV0(25:11)
 20149     CALL 'kxdfhei1' USING DFHEIV0
 20150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20151
 20152
 20153 8690-READ-CERT-CONT.
 20154
 20155* EXEC CICS READ
 20156*        DATASET     (CERT-ID)
 20157*        INTO        (CERTIFICATE-MASTER)
 20158*        RIDFLD      (ELCERT-KEY)
 20159*        UPDATE
 20160*    END-EXEC.
 20161     MOVE LENGTH OF
 20162      CERTIFICATE-MASTER
 20163       TO DFHEIV11
 20164*    MOVE '&"IL       EU         (   #00018925' TO DFHEIV0
 20165     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20166     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20167     MOVE X'2020233030303138393235' TO DFHEIV0(25:11)
 20168     CALL 'kxdfhei1' USING DFHEIV0,
 20169           CERT-ID,
 20170           CERTIFICATE-MASTER,
 20171           DFHEIV11,
 20172           ELCERT-KEY,
 20173           DFHEIV99,
 20174           DFHEIV99,
 20175           DFHEIV99
 20176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20177
 20178
 20179     GO TO 8590-EXIT.
 20180
 20181 8700-READ-CERT-MASTER.
 20182     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20183     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20184
 20185* EXEC CICS HANDLE CONDITION
 20186*         DUPKEY    (8720-COMP-ACCOUNTS)
 20187*         ENDFILE   (8730-END-BROWSE)
 20188*         NOTFND    (8740-NOT-FOUND)
 20189*    END-EXEC.
 20190*    MOVE '"$$''I                 ! < #00018937' TO DFHEIV0
 20191     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20192     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20193     MOVE X'3C20233030303138393337' TO DFHEIV0(25:11)
 20194     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 372
* EL050.cbl
 20195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20196
 20197
 20198
 20199* EXEC CICS STARTBR
 20200*        DATASET     ('ELCERT5')
 20201*        RIDFLD      (ELCERT2-KEY)
 20202*        EQUAL
 20203*    END-EXEC.
 20204     MOVE 'ELCERT5' TO DFHEIV1
 20205     MOVE 0
 20206       TO DFHEIV11
 20207*    MOVE '&,         E          &   #00018943' TO DFHEIV0
 20208     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20209     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20210     MOVE X'2020233030303138393433' TO DFHEIV0(25:11)
 20211     CALL 'kxdfhei1' USING DFHEIV0,
 20212           DFHEIV1,
 20213           ELCERT2-KEY,
 20214           DFHEIV99,
 20215           DFHEIV11,
 20216           DFHEIV99
 20217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20218
 20219
 20220 8710-READ-NEXT.
 20221
 20222* EXEC CICS READNEXT
 20223*        DATASET     ('ELCERT5')
 20224*        INTO        (CERTIFICATE-MASTER)
 20225*        RIDFLD      (ELCERT2-KEY)
 20226*    END-EXEC.
 20227     MOVE LENGTH OF
 20228      CERTIFICATE-MASTER
 20229       TO DFHEIV12
 20230     MOVE 'ELCERT5' TO DFHEIV1
 20231     MOVE 0
 20232       TO DFHEIV11
 20233*    MOVE '&.IL                  )   #00018950' TO DFHEIV0
 20234     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20235     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20236     MOVE X'2020233030303138393530' TO DFHEIV0(25:11)
 20237     CALL 'kxdfhei1' USING DFHEIV0,
 20238           DFHEIV1,
 20239           CERTIFICATE-MASTER,
 20240           DFHEIV12,
 20241           ELCERT2-KEY,
 20242           DFHEIV99,
 20243           DFHEIV11,
 20244           DFHEIV99,
 20245           DFHEIV99
 20246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20247
 20248
 20249 8720-COMP-ACCOUNTS.
 20250
 20251* EXEC CICS ENTER
 20252*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 373
* EL050.cbl
 20253*         FROM (PB-C-LAST-NAME)
 20254*    END-EXEC.
 20255     MOVE 001
 20256       TO DFHEIV11
 20257*    MOVE ':$F                   %   #00018957' TO DFHEIV0
 20258     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20259     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20260     MOVE X'2020233030303138393537' TO DFHEIV0(25:11)
 20261     CALL 'kxdfhei1' USING DFHEIV0,
 20262           DFHEIV11,
 20263           PB-C-LAST-NAME,
 20264           DFHEIV99,
 20265           DFHEIV99
 20266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20267
 20268
 20269
 20270* EXEC CICS ENTER
 20271*         TRACEID (002)
 20272*         FROM (CM-INSURED-LAST-NAME)
 20273*    END-EXEC.
 20274     MOVE 002
 20275       TO DFHEIV11
 20276*    MOVE ':$F                   %   #00018962' TO DFHEIV0
 20277     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20278     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20279     MOVE X'2020233030303138393632' TO DFHEIV0(25:11)
 20280     CALL 'kxdfhei1' USING DFHEIV0,
 20281           DFHEIV11,
 20282           CM-INSURED-LAST-NAME,
 20283           DFHEIV99,
 20284           DFHEIV99
 20285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20286
 20287
 20288     IF PB-CERT-NO NOT = CM-CERT-NO
 20289         GO TO 8730-END-BROWSE.
 20290
 20291     IF PB-ACCOUNT = CM-ACCOUNT
 20292         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20293             MOVE ER-2799        TO WS-ERROR
 20294             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20295             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20296             GO TO 8730-END-BROWSE.
 20297
 20298     GO TO 8710-READ-NEXT.
 20299
 20300 8730-END-BROWSE.
 20301
 20302* EXEC CICS ENDBR
 20303*         DATASET    ('ELCERT5')
 20304*    END-EXEC.
 20305     MOVE 'ELCERT5' TO DFHEIV1
 20306     MOVE 0
 20307       TO DFHEIV11
 20308*    MOVE '&2                    $   #00018980' TO DFHEIV0
 20309     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20310     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 374
* EL050.cbl
 20311     MOVE X'2020233030303138393830' TO DFHEIV0(25:11)
 20312     CALL 'kxdfhei1' USING DFHEIV0,
 20313           DFHEIV1,
 20314           DFHEIV11,
 20315           DFHEIV99
 20316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20317
 20318
 20319 8740-NOT-FOUND.
 20320     GO TO 0299-CERT-NOT-FOUND.
 20321
 20322 8750-START-ELSTAT.
 20323
 20324* EXEC CICS STARTBR
 20325*       DATASET   (STAT-ID)
 20326*       RIDFLD    (ELSTAT-KEY)
 20327*       GTEQ
 20328*       RESP      (WS-RESPONSE)
 20329*    END-EXEC
 20330     MOVE 0
 20331       TO DFHEIV11
 20332*    MOVE '&,         G          &  N#00018988' TO DFHEIV0
 20333     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20334     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20335     MOVE X'204E233030303138393838' TO DFHEIV0(25:11)
 20336     CALL 'kxdfhei1' USING DFHEIV0,
 20337           STAT-ID,
 20338           ELSTAT-KEY,
 20339           DFHEIV99,
 20340           DFHEIV11,
 20341           DFHEIV99
 20342     MOVE EIBRESP  TO WS-RESPONSE
 20343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20344     IF WS-RESP-NORMAL
 20345        MOVE 'Y'                 TO STAT-MASTER-SW
 20346     ELSE
 20347        MOVE 'N'                 TO STAT-MASTER-SW
 20348     END-IF
 20349     .
 20350 8750-EXIT.
 20351     EXIT.
 20352 8752-READ-ELSTAT.
 20353
 20354* EXEC CICS READNEXT
 20355*       DATASET   (STAT-ID)
 20356*       RIDFLD    (ELSTAT-KEY)
 20357*       INTO      (STATE-FILE)
 20358*       RESP      (WS-RESPONSE)
 20359*    END-EXEC
 20360     MOVE LENGTH OF
 20361      STATE-FILE
 20362       TO DFHEIV12
 20363     MOVE 0
 20364       TO DFHEIV11
 20365*    MOVE '&.IL                  )  N#00019003' TO DFHEIV0
 20366     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20367     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20368     MOVE X'204E233030303139303033' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 375
* EL050.cbl
 20369     CALL 'kxdfhei1' USING DFHEIV0,
 20370           STAT-ID,
 20371           STATE-FILE,
 20372           DFHEIV12,
 20373           ELSTAT-KEY,
 20374           DFHEIV99,
 20375           DFHEIV11,
 20376           DFHEIV99,
 20377           DFHEIV99
 20378     MOVE EIBRESP  TO WS-RESPONSE
 20379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20380     IF WS-RESP-NORMAL
 20381        MOVE 'Y'                 TO STAT-MASTER-SW
 20382     ELSE
 20383        MOVE 'N'                 TO STAT-MASTER-SW
 20384     END-IF
 20385     .
 20386 8752-EXIT.
 20387     EXIT.
 20388 8800-GET-COMP-RATE.
 20389     MOVE +1 TO IB.
 20390     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20391         ADD +9 TO IB
 20392         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20393             ADD +9 TO IB
 20394             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20395                MOVE ZEROS       TO WS-WK-RATE
 20396                GO TO 8800-EXIT.
 20397
 20398     IF PB-I-AGE GREATER CT-AGE (1)
 20399         ADD +3 TO IB
 20400         IF PB-I-AGE GREATER CT-AGE (2)
 20401             ADD +3 TO IB
 20402             IF PB-I-AGE GREATER CT-AGE (3)
 20403                MOVE ZEROS       TO WS-WK-RATE
 20404                GO TO 8800-EXIT.
 20405
 20406     IF WS-WORK-TERM GREATER CT-TRM (1)
 20407         ADD +1 TO IB
 20408         IF WS-WORK-TERM GREATER CT-TRM (2)
 20409             ADD +1 TO IB
 20410             IF WS-WORK-TERM GREATER CT-TRM (3)
 20411                MOVE ZEROS       TO WS-WK-RATE
 20412                GO TO 8800-EXIT.
 20413
 20414     IF CT-RT (IB) NOT NUMERIC
 20415         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20416         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20417         GO TO 8800-GET-COMP-RATE.
 20418
 20419     MOVE CT-RT (IB) TO WS-WK-RATE.
 20420
 20421 8800-EXIT.
 20422     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 376
* EL050.cbl
 20424 8900-ADDRESS-FILE.
 20425     IF ERACCT-FILE-ADDRESSED
 20426         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20427         GO TO 8900-ADDRESS-EXIT.
 20428
 20429     IF ELCNTL-FILE-ADDRESSED
 20430         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20431         GO TO 8900-ADDRESS-EXIT.
 20432
 20433     IF ERPLAN-FILE-ADDRESSED
 20434         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20435         GO TO 8900-ADDRESS-EXIT.
 20436
 20437     IF ERFORM-FILE-ADDRESSED
 20438         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20439         GO TO 8900-ADDRESS-EXIT.
 20440
 20441 8900-ADDRESS-EXIT.
 20442     EXIT.
 20443
 20444 9000-READ-CONTROL.
 20445
 20446* EXEC CICS HANDLE CONDITION
 20447*        NOTFND    (9000-NOTFND)
 20448*    END-EXEC.
 20449*    MOVE '"$I                   ! = #00019074' TO DFHEIV0
 20450     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20451     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20452     MOVE X'3D20233030303139303734' TO DFHEIV0(25:11)
 20453     CALL 'kxdfhei1' USING DFHEIV0
 20454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20455
 20456
 20457
 20458* EXEC CICS READ
 20459*        DATASET     (CNTL-ID)
 20460*        SET         (ADDRESS OF CONTROL-FILE)
 20461*        RIDFLD      (ELCNTL-KEY)
 20462*        GTEQ
 20463*    END-EXEC.
 20464*    MOVE '&"S        G          (   #00019078' TO DFHEIV0
 20465     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20466     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20467     MOVE X'2020233030303139303738' TO DFHEIV0(25:11)
 20468     CALL 'kxdfhei1' USING DFHEIV0,
 20469           CNTL-ID,
 20470           DFHEIV20,
 20471           DFHEIV99,
 20472           ELCNTL-KEY,
 20473           DFHEIV99,
 20474           DFHEIV99,
 20475           DFHEIV99
 20476     SET ADDRESS OF CONTROL-FILE TO
 20477         DFHEIV20
 20478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20479
 20480
 20481     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 377
* EL050.cbl
 20482
 20483 9000-NOTFND.
 20484     IF RC-SW-1 = '1'
 20485        MOVE ER-2616              TO WS-ERROR
 20486        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20487        GO TO 9000-EXIT.
 20488
 20489     IF RC-SW-1 = '2'
 20490        MOVE ER-2602              TO WS-ERROR
 20491        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20492
 20493 9000-EXIT.
 20494      EXIT.
 20495
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 378
* EL050.cbl
 20497 9100-READ-CONTROL.
 20498
 20499* EXEC CICS HANDLE CONDITION
 20500*        NOTFND  (9100-NOTFND)
 20501*        ENDFILE (9100-NOTFND)
 20502*    END-EXEC.
 20503*    MOVE '"$I''                  ! > #00019102' TO DFHEIV0
 20504     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20505     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20506     MOVE X'3E20233030303139313032' TO DFHEIV0(25:11)
 20507     CALL 'kxdfhei1' USING DFHEIV0
 20508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20509
 20510
 20511
 20512* EXEC CICS READ
 20513*        DATASET     (CNTL-ID)
 20514*        INTO        (CONTROL-FILE)
 20515*        RIDFLD      (ELCNTL-KEY)
 20516*        GTEQ
 20517*    END-EXEC.
 20518     MOVE LENGTH OF
 20519      CONTROL-FILE
 20520       TO DFHEIV11
 20521*    MOVE '&"IL       G          (   #00019107' TO DFHEIV0
 20522     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20523     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20524     MOVE X'2020233030303139313037' TO DFHEIV0(25:11)
 20525     CALL 'kxdfhei1' USING DFHEIV0,
 20526           CNTL-ID,
 20527           CONTROL-FILE,
 20528           DFHEIV11,
 20529           ELCNTL-KEY,
 20530           DFHEIV99,
 20531           DFHEIV99,
 20532           DFHEIV99
 20533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20534
 20535
 20536     GO TO 9100-EXIT.
 20537
 20538 9100-NOTFND.
 20539     IF RC-SW-2 = '0'
 20540        MOVE '1'                  TO STATE-RECORD-ERROR
 20541        GO TO 9100-EXIT
 20542     END-IF
 20543     IF RC-SW-2 = '1'
 20544        MOVE '1'                  TO LF-BENEFIT-ERROR
 20545        MOVE ER-2604              TO WS-ERROR
 20546        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20547        GO TO 9100-EXIT.
 20548
 20549     IF RC-SW-2 = '2'
 20550        MOVE '1'                  TO AH-BENEFIT-ERROR
 20551        MOVE ER-2605              TO WS-ERROR
 20552        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20553        GO TO 9100-EXIT.
 20554
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 379
* EL050.cbl
 20555     IF RC-SW-2 = '3'
 20556         MOVE ER-2603           TO WS-ERROR
 20557         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20558         GO TO 9100-EXIT.
 20559
 20560     IF RC-SW-2 = '4'
 20561         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20562         GO TO 9100-EXIT.
 20563
 20564     IF RC-SW-2 = '5'
 20565         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20566         IF WS-AH-INPUT-CD-1 = SPACE
 20567             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20568         ELSE
 20569             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20570
 20571 9100-EXIT.
 20572      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 380
* EL050.cbl
 20574 9200-CONTROL-GETMAIN.
 20575
 20576* EXEC CICS GETMAIN
 20577*         LENGTH   (750)
 20578*         SET      (ADDRESS OF CONTROL-FILE)
 20579*    END-EXEC.
 20580     MOVE 750
 20581       TO DFHEIV11
 20582*    MOVE '," L                  $   #00019153' TO DFHEIV0
 20583     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20584     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20585     MOVE X'2020233030303139313533' TO DFHEIV0(25:11)
 20586     CALL 'kxdfhei1' USING DFHEIV0,
 20587           DFHEIV20,
 20588           DFHEIV11,
 20589           DFHEIV99
 20590     SET ADDRESS OF CONTROL-FILE TO
 20591         DFHEIV20
 20592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20593
 20594
 20595     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20596
 20597 9200-EXIT.
 20598     EXIT.
 20599
 20600 9250-UNLOCK-RETURN.
 20601
 20602* EXEC CICS UNLOCK
 20603*        DATASET   (CERT-ID)
 20604*    END-EXEC.
 20605*    MOVE '&*                    #   #00019164' TO DFHEIV0
 20606     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20607     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20608     MOVE X'2020233030303139313634' TO DFHEIV0(25:11)
 20609     CALL 'kxdfhei1' USING DFHEIV0,
 20610           CERT-ID,
 20611           DFHEIV99
 20612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20613
 20614
 20615 9300-ABEND.
 20616     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20617
 20618
 20619* EXEC CICS LINK
 20620*        PROGRAM   ('EL004')
 20621*        COMMAREA  (WS-ERROR-LINE)
 20622*        LENGTH    (72)
 20623*    END-EXEC.
 20624     MOVE 'EL004' TO DFHEIV1
 20625     MOVE 72
 20626       TO DFHEIV11
 20627*    MOVE '."C                   ''   #00019171' TO DFHEIV0
 20628     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20629     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20630     MOVE X'2020233030303139313731' TO DFHEIV0(25:11)
 20631     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 381
* EL050.cbl
 20632           DFHEIV1,
 20633           WS-ERROR-LINE,
 20634           DFHEIV11,
 20635           DFHEIV99,
 20636           DFHEIV99,
 20637           DFHEIV99
 20638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20639
 20640
 20641     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 20642
 20643
 20644* EXEC CICS ABEND
 20645*        ABCODE ('EL50')
 20646*    END-EXEC.
 20647     MOVE 'EL50' TO DFHEIV5
 20648*    MOVE '.,A                   "   #00019179' TO DFHEIV0
 20649     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 20650     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 20651     MOVE X'2020233030303139313739' TO DFHEIV0(25:11)
 20652     CALL 'kxdfhei1' USING DFHEIV0,
 20653           DFHEIV5
 20654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20655
 20656
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 382
* EL050.cbl
 20658
 20659******************************************************************
 20660*                                                                *
 20661*            E R R O R   F O R M A T   R O U T I N E             *
 20662*                                                                *
 20663******************************************************************
 20664
 20665 9900-ERROR-FORMAT.
 20666
 20667     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 20668                    PB-COMMON-ERROR (2) OR
 20669                    PB-COMMON-ERROR (3) OR
 20670                    PB-COMMON-ERROR (4) OR
 20671                    PB-COMMON-ERROR (5) OR
 20672                    PB-COMMON-ERROR (6) OR
 20673                    PB-COMMON-ERROR (7) OR
 20674                    PB-COMMON-ERROR (8) OR
 20675                    PB-COMMON-ERROR (9) OR
 20676                    PB-COMMON-ERROR (10)
 20677        GO TO 9900-EXIT.
 20678
 20679     IF PB-NO-OF-ERRORS = +10
 20680        GO TO 9900-EXIT.
 20681
 20682     ADD +1  TO PB-NO-OF-ERRORS.
 20683     MOVE WS-ERROR               TO PB-COMMON-ERROR
 20684                                       (PB-NO-OF-ERRORS).
 20685 9900-EXIT.
 20686     EXIT.
 20687
 20688 9990-RETURN.
 20689     IF BROWSE-STARTED
 20690
 20691* EXEC CICS ENDBR
 20692*            DATASET  (ACCT-ID)
 20693*       END-EXEC.
 20694     MOVE 0
 20695       TO DFHEIV11
 20696*    MOVE '&2                    $   #00019216' TO DFHEIV0
 20697     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20698     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20699     MOVE X'2020233030303139323136' TO DFHEIV0(25:11)
 20700     CALL 'kxdfhei1' USING DFHEIV0,
 20701           ACCT-ID,
 20702           DFHEIV11,
 20703           DFHEIV99
 20704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20705
 20706
 20707 9990-EXIT.
 20708     EXIT.
 20709
 20710 9999-RETURN.
 20711     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 20712
 20713
 20714* EXEC CICS RETURN
 20715*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 383
* EL050.cbl
 20716*    MOVE '.(                    &   #00019226' TO DFHEIV0
 20717     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20718     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20719     MOVE X'2020233030303139323236' TO DFHEIV0(25:11)
 20720     CALL 'kxdfhei1' USING DFHEIV0,
 20721           DFHEIV99,
 20722           DFHEIV99,
 20723           DFHEIV99,
 20724           DFHEIV99,
 20725           DFHEIV99
 20726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20727
 20728
 20729
 20730* GOBACK.
 20731     MOVE '9%                    "   ' TO DFHEIV0
 20732     MOVE 'EL050' TO DFHEIV1
 20733     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20734     GOBACK.
 20735
 20736 9999-DFHBACK SECTION.
 20737     MOVE '9%                    "   ' TO DFHEIV0
 20738     MOVE 'EL050' TO DFHEIV1
 20739     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20740     GOBACK.
 20741 9999-DFHEXIT.
 20742     IF DFHEIGDJ EQUAL 0001
 20743         NEXT SENTENCE
 20744     ELSE IF DFHEIGDJ EQUAL 2
 20745         GO TO 9300-ABEND,
 20746               3990-FILES-NOT-OPEN
 20747         DEPENDING ON DFHEIGDI
 20748     ELSE IF DFHEIGDJ EQUAL 3
 20749         GO TO 6610-START-BROWSE,
 20750               6630-ERRESS-PROBLEM,
 20751               6630-END-OF-FILE
 20752         DEPENDING ON DFHEIGDI
 20753     ELSE IF DFHEIGDJ EQUAL 4
 20754         GO TO 6630-END-OF-FILE,
 20755               6630-ERRESS-PROBLEM,
 20756               6630-ERRESS-PROBLEM,
 20757               6630-END-OF-FILE
 20758         DEPENDING ON DFHEIGDI
 20759     ELSE IF DFHEIGDJ EQUAL 5
 20760         GO TO 6630-END-OF-FILE,
 20761               6630-END-OF-FILE,
 20762               6630-ERRESS-PROBLEM,
 20763               6630-ERRESS-PROBLEM
 20764         DEPENDING ON DFHEIGDI
 20765     ELSE IF DFHEIGDJ EQUAL 6
 20766         GO TO 6660-START-BROWSE,
 20767               6690-ERRESC-PROBLEM,
 20768               6690-ERRESC-PROBLEM,
 20769               6690-END-OF-FILE
 20770         DEPENDING ON DFHEIGDI
 20771     ELSE IF DFHEIGDJ EQUAL 7
 20772         GO TO 6690-END-OF-FILE,
 20773               6690-ERRESC-PROBLEM,
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 384
* EL050.cbl
 20774               6690-ERRESC-PROBLEM,
 20775               6690-END-OF-FILE
 20776         DEPENDING ON DFHEIGDI
 20777     ELSE IF DFHEIGDJ EQUAL 8
 20778         GO TO 6690-END-OF-FILE,
 20779               6690-ERRESC-PROBLEM,
 20780               6690-ERRESC-PROBLEM,
 20781               6690-END-OF-FILE
 20782         DEPENDING ON DFHEIGDI
 20783     ELSE IF DFHEIGDJ EQUAL 9
 20784         GO TO 7250-CONTINUE,
 20785               7250-CONTINUE
 20786         DEPENDING ON DFHEIGDI
 20787     ELSE IF DFHEIGDJ EQUAL 10
 20788         GO TO 7300-CONTINUE,
 20789               7300-CONTINUE
 20790         DEPENDING ON DFHEIGDI
 20791     ELSE IF DFHEIGDJ EQUAL 11
 20792         GO TO 8000-FREE-MAIN
 20793         DEPENDING ON DFHEIGDI
 20794     ELSE IF DFHEIGDJ EQUAL 12
 20795         GO TO 8100-NOTFND,
 20796               8100-NOTFND
 20797         DEPENDING ON DFHEIGDI
 20798     ELSE IF DFHEIGDJ EQUAL 13
 20799         GO TO 8110-NOTFND,
 20800               8110-NOTFND
 20801         DEPENDING ON DFHEIGDI
 20802     ELSE IF DFHEIGDJ EQUAL 14
 20803         GO TO 8130-EXIT
 20804         DEPENDING ON DFHEIGDI
 20805     ELSE IF DFHEIGDJ EQUAL 15
 20806         GO TO 8180-NOTFND
 20807         DEPENDING ON DFHEIGDI
 20808     ELSE IF DFHEIGDJ EQUAL 16
 20809         GO TO 8190-NOTFND
 20810         DEPENDING ON DFHEIGDI
 20811     ELSE IF DFHEIGDJ EQUAL 17
 20812         GO TO 8200-NOTFND
 20813         DEPENDING ON DFHEIGDI
 20814     ELSE IF DFHEIGDJ EQUAL 18
 20815         GO TO 8300-NOTFND,
 20816               8300-ERRESS-PROBLEM,
 20817               8300-ERRESS-PROBLEM,
 20818               8300-NOTFND
 20819         DEPENDING ON DFHEIGDI
 20820     ELSE IF DFHEIGDJ EQUAL 19
 20821         GO TO 8450-FORM-NOT-FOUND,
 20822               8450-FORM-NOT-FOUND
 20823         DEPENDING ON DFHEIGDI
 20824     ELSE IF DFHEIGDJ EQUAL 20
 20825         GO TO 0199-ACCT-NOT-FOUND,
 20826               0199-ACCT-NOT-FOUND
 20827         DEPENDING ON DFHEIGDI
 20828     ELSE IF DFHEIGDJ EQUAL 21
 20829         GO TO 0199-ACCT-NOT-FOUND,
 20830               0199-ACCT-NOT-FOUND
 20831         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 05-Dec-11 16:34 Page 385
* EL050.cbl
 20832     ELSE IF DFHEIGDJ EQUAL 22
 20833         GO TO 8582-COMP-NOT-FOUND,
 20834               8582-COMP-NOT-FOUND
 20835         DEPENDING ON DFHEIGDI
 20836     ELSE IF DFHEIGDJ EQUAL 23
 20837         GO TO 8583-AGTC-NOT-FOUND,
 20838               8583-AGTC-NOT-FOUND
 20839         DEPENDING ON DFHEIGDI
 20840     ELSE IF DFHEIGDJ EQUAL 24
 20841         GO TO 8584-BXRF-NOT-FOUND,
 20842               8584-BXRF-NOT-FOUND
 20843         DEPENDING ON DFHEIGDI
 20844     ELSE IF DFHEIGDJ EQUAL 25
 20845         GO TO 8585-PLAN-NOT-FOUND,
 20846               8585-PLAN-NOT-FOUND
 20847         DEPENDING ON DFHEIGDI
 20848     ELSE IF DFHEIGDJ EQUAL 26
 20849         GO TO 0299-CERT-NOT-FOUND
 20850         DEPENDING ON DFHEIGDI
 20851     ELSE IF DFHEIGDJ EQUAL 27
 20852         GO TO 8700-READ-CERT-MASTER
 20853         DEPENDING ON DFHEIGDI
 20854     ELSE IF DFHEIGDJ EQUAL 28
 20855         GO TO 8720-COMP-ACCOUNTS,
 20856               8730-END-BROWSE,
 20857               8740-NOT-FOUND
 20858         DEPENDING ON DFHEIGDI
 20859     ELSE IF DFHEIGDJ EQUAL 29
 20860         GO TO 9000-NOTFND
 20861         DEPENDING ON DFHEIGDI
 20862     ELSE IF DFHEIGDJ EQUAL 30
 20863         GO TO 9100-NOTFND,
 20864               9100-NOTFND
 20865         DEPENDING ON DFHEIGDI.
 20866     MOVE '9%                    "   ' TO DFHEIV0
 20867     MOVE 'EL050' TO DFHEIV1
 20868     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20869     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       39416     Code:       84298
