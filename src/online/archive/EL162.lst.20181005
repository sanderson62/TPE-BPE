* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page   1
* EL162.cbl
* Options: int("EL162.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL162.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL162.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL162.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL162 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/02/95 14:07:28.
     7*                            VMOD=2.015
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*REMARKS.    TRANSACTION - EX17 - RECORD MAIL RECEIVED
    13*            USED TO REVIEW PENDING MAIL AND TO RECORD
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page   2
* EL162.cbl
    14*            INCOMING MAIL.
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    24* 121406    2006081100001  PEMA  ADD RECEIVE DATE EDIT
    25* 051107    2006052500001  AJRA  POPULATE UBY WITH USER ID
    26* 100610    2009122800001  AJRA  BYPASS LETTER W/ RESEND PRINTED D
    27* 102610    2009122800001  AJRA    REPLACE VERIFY W/ STOP DATE
    28* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    29* 010416    2015072900002  TANA  ADD PF7 TO CLAIM MEMO SCREEN
    30* 062217    2017050300002  TANA  ADD AUTH RCVD FIELD
    31******************************************************************
    32
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page   3
* EL162.cbl
    34 ENVIRONMENT DIVISION.
    35 DATA DIVISION.
    36 WORKING-STORAGE SECTION.
    37 01  DFH-START PIC X(04).
    38 77  FILLER  PIC X(32)  VALUE '********************************'.
    39 77  FILLER  PIC X(32)  VALUE '*    EL162 WORKING STORAGE     *'.
    40 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.015 *********'.
    41
    42*                            COPY ELCSCTM.
    43******************************************************************
    44*                                                                *
    45*                                                                *
    46*                            ELCSCTM                             *
    47*                            VMOD=2.001                          *
    48*                                                                *
    49*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    50*                                                                *
    51******************************************************************
    52 01  SECURITY-MESSAGE.
    53     12  FILLER                          PIC X(30)
    54            VALUE '** LOGIC SECURITY VIOLATION -'.
    55     12  SM-READ                         PIC X(6).
    56     12  FILLER                          PIC X(5)
    57            VALUE ' PGM='.
    58     12  SM-PGM                          PIC X(6).
    59     12  FILLER                          PIC X(5)
    60            VALUE ' OPR='.
    61     12  SM-PROCESSOR-ID                 PIC X(4).
    62     12  FILLER                          PIC X(6)
    63            VALUE ' TERM='.
    64     12  SM-TERMID                       PIC X(4).
    65     12  FILLER                          PIC XX   VALUE SPACE.
    66     12  SM-JUL-DATE                     PIC 9(5).
    67     12  FILLER                          PIC X    VALUE SPACE.
    68     12  SM-TIME                         PIC 99.99.
    69
    70
    71*                            COPY ELCSCRTY.
    72******************************************************************
    73*                                                                *
    74*                                                                *
    75*                            ELCSCRTY                            *
    76*                            VMOD=2.001                          *
    77*                                                                *
    78*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    79*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    80*        SAVED IN PI-SECURITY-ADDRESS.                           *
    81*                                                                *
    82******************************************************************
    83 01  SECURITY-CONTROL.
    84     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    85     12  FILLER                       PIC XX    VALUE 'SC'.
    86     12  SC-CREDIT-CODES.
    87         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    88             20  SC-CREDIT-DISPLAY    PIC X.
    89             20  SC-CREDIT-UPDATE     PIC X.
    90     12  SC-CLAIMS-CODES.
    91         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page   4
* EL162.cbl
    92             20  SC-CLAIMS-DISPLAY    PIC X.
    93             20  SC-CLAIMS-UPDATE     PIC X.
    94
    95 01  WS-DATE-AREA.
    96     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    97     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
    98     05  CURRENT-MINUS1-SAVE PIC XX      VALUE SPACES.
    99
   100 01  STANDARD-AREAS.
   101     12  SC-ITEM                 PIC S9(4)   VALUE +1  COMP.
   102     12  MAP-NAME.
   103         16  MAP-PRE             PIC XX      VALUE 'EL'.
   104         16  MAP-NUMBER          PIC X(4)    VALUE '162A'.
   105         16  FILLER              PIC XX      VALUE SPACES.
   106     12  MAPSET-NAME             PIC X(8)    VALUE 'EL162S'.
   107     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   108     12  TRANS-ID                PIC X(4)    VALUE 'EX17'.
   109     12  PGM-NAME                PIC X(8).
   110     12  TIME-IN                 PIC S9(7).
   111     12  TIME-OUT-R  REDEFINES TIME-IN.
   112         16  FILLER              PIC X.
   113         16  TIME-OUT            PIC 99V99.
   114         16  FILLER              PIC XX.
   115     12  XCTL-005                PIC X(5)    VALUE 'EL005'.
   116     12  XCTL-010                PIC X(5)    VALUE 'EL010'.
   117     12  XCTL-126                PIC X(5)    VALUE 'EL126'.
   118     12  LINK-001                PIC X(5)    VALUE 'EL001'.
   119     12  LINK-004                PIC X(5)    VALUE 'EL004'.
   120     12  LINK-ELDATCV            PIC X(7)    VALUE 'ELDATCV'.
   121     12  THIS-PGM                PIC X(8)    VALUE 'EL162'.
   122     12  PGM-EL141               PIC X(8)    VALUE 'EL141'.
   123     12  PGM-EL132               PIC X(8)    VALUE 'EL132'.
   124     12  PGM-EL150               PIC X(8)    VALUE 'EL150'.
   125     12  PGM-EL1284              PIC X(8)    VALUE 'EL1284'.
   126     12  ELMSTR-FILE-ID          PIC X(8)    VALUE 'ELMSTR'.
   127     12  ELTRLR-FILE-ID          PIC X(8)    VALUE 'ELTRLR'.
   128     12  ERACCT-FILE-ID          PIC X(8)    VALUE 'ERACCT'.
   129     12  SUB                     PIC S999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page   5
* EL162.cbl
   131 01  ERROR-MESSAGES.
   132     12  ER-ZEROS                PIC X(4)    VALUE '0000'.
   133     12  ER-0004                 PIC X(4)    VALUE '0004'.
   134     12  ER-0008                 PIC X(4)    VALUE '0008'.
   135     12  ER-0029                 PIC X(4)    VALUE '0029'.
   136     12  ER-0050                 PIC X(4)    VALUE '0050'.
   137     12  ER-0021                 PIC X(4)    VALUE '0021'.
   138     12  ER-0042                 PIC X(4)    VALUE '0042'.
   139     12  ER-0066                 PIC X(4)    VALUE '0066'.
   140     12  ER-0067                 PIC X(4)    VALUE '0067'.
   141     12  ER-0070                 PIC X(4)    VALUE '0070'.
   142     12  ER-0133                 PIC X(4)    VALUE '0133'.
   143     12  ER-0168                 PIC X(4)    VALUE '0168'.
   144     12  ER-0172                 PIC X(4)    VALUE '0172'.
   145     12  ER-0179                 PIC X(4)    VALUE '0179'.
   146     12  ER-0287                 PIC X(4)    VALUE '0287'.
   147     12  ER-0318                 PIC X(4)    VALUE '0318'.
   148     12  ER-0319                 PIC X(4)    VALUE '0319'.
   149     12  ER-0320                 PIC X(4)    VALUE '0320'.
   150     12  ER-0321                 PIC X(4)    VALUE '0321'.
   151     12  ER-0322                 PIC X(4)    VALUE '0322'.
   152     12  ER-0514                 PIC X(4)    VALUE '0514'.
   153     12  ER-0539                 PIC X(4)    VALUE '0539'.
   154     12  ER-0895                 PIC X(4)    VALUE '0895'.
   155     12  ER-0896                 PIC X(4)    VALUE '0896'.
   156     12  ER-7839                 PIC X(4)    VALUE '7839'.
   157
   158     12  BIN-CURRENT-DATE        PIC XX.
   159     12  INDX-WORK               PIC 9(4).
   160     12  REC-DATA-SW             PIC X       VALUE ' '.
   161         88  REC-DATA                        VALUE '1'.
   162     12  VER-DATA-SW             PIC X       VALUE ' '.
   163         88  VER-DATA                        VALUE '1'.
   164     12  UNSOL-DATA-SW           PIC X       VALUE ' '.
   165         88  UNSOL-DATA                      VALUE '1'.
   166         88  FILE-DATA                       VALUE '2'.
   167     12  ADDR-TYPE               PIC X.
   168     12  ADDR-SEQ                PIC S9(4) COMP.
   169     12  ACTV-LENGTH             PIC S9(4) COMP VALUE +200.
   170     12  USENT-SAVE              PIC XX    VALUE LOW-VALUES.
   171     12  URECDTE-SAVE            PIC XX    VALUE LOW-VALUES.
   172     12  REC-DATE-SAVE OCCURS 4 TIMES INDEXED BY INDX     PIC XX.
   173     12  STOP-DATE-SAVE OCCURS 4 TIMES INDEXED BY INDX2   PIC XX.
   174     12  DEEDIT-FIELD            PIC X(15).
   175     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   176
   177     12  ACCT-KEY.
   178         16  ACCT-PARTIAL-KEY.
   179             20  ACCT-CO         PIC X.
   180             20  ACCT-CARRIER    PIC X.
   181             20  ACCT-GROUPING   PIC X(6).
   182             20  ACCT-STATE      PIC XX.
   183             20  ACCT-ACCOUNT    PIC X(10).
   184         16  ACCT-EXP-DATE       PIC XX.
   185     12  FILLER                  PIC S9(9)  VALUE +0 COMP.
   186     12  ACCT-SAVE-KEY           PIC X(20).
   187     12  WS-ZIP.
   188         16  WS-ZIP-CODE         PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page   6
* EL162.cbl
   189         16  WS-DASH             PIC X     VALUE '-'.
   190         16  WS-ZIP-PLUS4        PIC X(4).
   191     12  WS-CANADIAN-POSTAL-CODES REDEFINES WS-ZIP.
   192         16  WS-CAN-POSTAL-CD-1  PIC X(3).
   193         16  WS-DASH-CAN         PIC X.
   194         16  WS-CAN-POSTAL-CD-2  PIC X(3).
   195         16  WS-CAN-FILLER       PIC X(3).
   196     12  WS-WORK-PHONE           PIC X(10)  VALUE ZEROS.
   197     12  WS-NUMERIC-PHONE REDEFINES WS-WORK-PHONE
   198                                 PIC 9(10).
   199     12  WS-REASON               PIC X(70).
   200
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page   7
* EL162.cbl
   202*                            COPY ELCDATE.
   203******************************************************************
   204*                                                                *
   205*                                                                *
   206*                            ELCDATE.                            *
   207*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   208*                            VMOD=2.003
   209*                                                                *
   210*                                                                *
   211*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   212*                 LENGTH = 200                                   *
   213******************************************************************
   214
   215 01  DATE-CONVERSION-DATA.
   216     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   217     12  DC-OPTION-CODE                PIC X.
   218         88  BIN-TO-GREG                VALUE ' '.
   219         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   220         88  EDIT-GREG-TO-BIN           VALUE '2'.
   221         88  YMD-GREG-TO-BIN            VALUE '3'.
   222         88  MDY-GREG-TO-BIN            VALUE '4'.
   223         88  JULIAN-TO-BIN              VALUE '5'.
   224         88  BIN-PLUS-ELAPSED           VALUE '6'.
   225         88  FIND-CENTURY               VALUE '7'.
   226         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   227         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   228         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   229         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   230         88  JULIAN-TO-BIN-3            VALUE 'C'.
   231         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   232         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   233         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   234         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   235         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   236         88  CHECK-LEAP-YEAR            VALUE 'H'.
   237         88  BIN-3-TO-GREG              VALUE 'I'.
   238         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   239         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   240         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   241         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   242         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   243         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   244         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   245         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   246         88  THREE-CHARACTER-BIN
   247                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   248         88  GREGORIAN-TO-BIN
   249                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   250         88  BIN-TO-GREGORIAN
   251                  VALUES ' ' '1' 'I' '8' 'G'.
   252         88  JULIAN-TO-BINARY
   253                  VALUES '5' 'C' 'E' 'F'.
   254     12  DC-ERROR-CODE                 PIC X.
   255         88  NO-CONVERSION-ERROR        VALUE ' '.
   256         88  DATE-CONVERSION-ERROR
   257                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   258         88  DATE-IS-ZERO               VALUE '1'.
   259         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page   8
* EL162.cbl
   260         88  DATE-IS-INVALID            VALUE '3'.
   261         88  DATE1-GREATER-DATE2        VALUE '4'.
   262         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   263         88  DATE-INVALID-OPTION        VALUE '9'.
   264         88  INVALID-CENTURY            VALUE 'A'.
   265         88  ONLY-CENTURY               VALUE 'B'.
   266         88  ONLY-LEAP-YEAR             VALUE 'C'.
   267         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   268     12  DC-END-OF-MONTH               PIC X.
   269         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   270     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   271         88  USE-NORMAL-PROCESS         VALUE ' '.
   272         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   273         88  ADJUST-UP-100-YRS          VALUE '2'.
   274     12  FILLER                        PIC X.
   275     12  DC-CONVERSION-DATES.
   276         16  DC-BIN-DATE-1             PIC XX.
   277         16  DC-BIN-DATE-2             PIC XX.
   278         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   279         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   280                       DC-GREG-DATE-1-EDIT.
   281             20  DC-EDIT1-MONTH        PIC 99.
   282             20  SLASH1-1              PIC X.
   283             20  DC-EDIT1-DAY          PIC 99.
   284             20  SLASH1-2              PIC X.
   285             20  DC-EDIT1-YEAR         PIC 99.
   286         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   287         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   288                     DC-GREG-DATE-2-EDIT.
   289             20  DC-EDIT2-MONTH        PIC 99.
   290             20  SLASH2-1              PIC X.
   291             20  DC-EDIT2-DAY          PIC 99.
   292             20  SLASH2-2              PIC X.
   293             20  DC-EDIT2-YEAR         PIC 99.
   294         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   295         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   296                     DC-GREG-DATE-1-YMD.
   297             20  DC-YMD-YEAR           PIC 99.
   298             20  DC-YMD-MONTH          PIC 99.
   299             20  DC-YMD-DAY            PIC 99.
   300         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   301         16  DC-GREG-DATE-1-MDY-R REDEFINES
   302                      DC-GREG-DATE-1-MDY.
   303             20  DC-MDY-MONTH          PIC 99.
   304             20  DC-MDY-DAY            PIC 99.
   305             20  DC-MDY-YEAR           PIC 99.
   306         16  DC-GREG-DATE-1-ALPHA.
   307             20  DC-ALPHA-MONTH        PIC X(10).
   308             20  DC-ALPHA-DAY          PIC 99.
   309             20  FILLER                PIC XX.
   310             20  DC-ALPHA-CENTURY.
   311                 24 DC-ALPHA-CEN-N     PIC 99.
   312             20  DC-ALPHA-YEAR         PIC 99.
   313         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   314         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   315         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   316         16  DC-JULIAN-DATE            PIC 9(05).
   317         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page   9
* EL162.cbl
   318                                       PIC 9(05).
   319         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   320             20  DC-JULIAN-YEAR        PIC 99.
   321             20  DC-JULIAN-DAYS        PIC 999.
   322         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   323         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   324         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   325     12  DATE-CONVERSION-VARIBLES.
   326         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   327         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   328             20  FILLER                PIC 9(3).
   329             20  HOLD-CEN-1-CCYY.
   330                 24  HOLD-CEN-1-CC     PIC 99.
   331                 24  HOLD-CEN-1-YY     PIC 99.
   332             20  HOLD-CEN-1-MO         PIC 99.
   333             20  HOLD-CEN-1-DA         PIC 99.
   334         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   335             20  HOLD-CEN-1-R-MO       PIC 99.
   336             20  HOLD-CEN-1-R-DA       PIC 99.
   337             20  HOLD-CEN-1-R-CCYY.
   338                 24  HOLD-CEN-1-R-CC   PIC 99.
   339                 24  HOLD-CEN-1-R-YY   PIC 99.
   340             20  FILLER                PIC 9(3).
   341         16  HOLD-CENTURY-1-X.
   342             20  FILLER                PIC X(3)  VALUE SPACES.
   343             20  HOLD-CEN-1-X-CCYY.
   344                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   345                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   346             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   347             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   348         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   349             20  HOLD-CEN-1-R-X-MO     PIC XX.
   350             20  HOLD-CEN-1-R-X-DA     PIC XX.
   351             20  HOLD-CEN-1-R-X-CCYY.
   352                 24  HOLD-CEN-1-R-X-CC PIC XX.
   353                 24  HOLD-CEN-1-R-X-YY PIC XX.
   354             20  FILLER                PIC XXX.
   355         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   356         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   357         16  DC-JULIAN-DATE-1          PIC 9(07).
   358         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   359             20  DC-JULIAN-1-CCYY.
   360                 24  DC-JULIAN-1-CC    PIC 99.
   361                 24  DC-JULIAN-1-YR    PIC 99.
   362             20  DC-JULIAN-DA-1        PIC 999.
   363         16  DC-JULIAN-DATE-2          PIC 9(07).
   364         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   365             20  DC-JULIAN-2-CCYY.
   366                 24  DC-JULIAN-2-CC    PIC 99.
   367                 24  DC-JULIAN-2-YR    PIC 99.
   368             20  DC-JULIAN-DA-2        PIC 999.
   369         16  DC-GREG-DATE-A-EDIT.
   370             20  DC-EDITA-MONTH        PIC 99.
   371             20  SLASHA-1              PIC X VALUE '/'.
   372             20  DC-EDITA-DAY          PIC 99.
   373             20  SLASHA-2              PIC X VALUE '/'.
   374             20  DC-EDITA-CCYY.
   375                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  10
* EL162.cbl
   376                 24  DC-EDITA-YEAR     PIC 99.
   377         16  DC-GREG-DATE-B-EDIT.
   378             20  DC-EDITB-MONTH        PIC 99.
   379             20  SLASHB-1              PIC X VALUE '/'.
   380             20  DC-EDITB-DAY          PIC 99.
   381             20  SLASHB-2              PIC X VALUE '/'.
   382             20  DC-EDITB-CCYY.
   383                 24  DC-EDITB-CENT     PIC 99.
   384                 24  DC-EDITB-YEAR     PIC 99.
   385         16  DC-GREG-DATE-CYMD         PIC 9(08).
   386         16  DC-GREG-DATE-CYMD-R REDEFINES
   387                              DC-GREG-DATE-CYMD.
   388             20  DC-CYMD-CEN           PIC 99.
   389             20  DC-CYMD-YEAR          PIC 99.
   390             20  DC-CYMD-MONTH         PIC 99.
   391             20  DC-CYMD-DAY           PIC 99.
   392         16  DC-GREG-DATE-MDCY         PIC 9(08).
   393         16  DC-GREG-DATE-MDCY-R REDEFINES
   394                              DC-GREG-DATE-MDCY.
   395             20  DC-MDCY-MONTH         PIC 99.
   396             20  DC-MDCY-DAY           PIC 99.
   397             20  DC-MDCY-CEN           PIC 99.
   398             20  DC-MDCY-YEAR          PIC 99.
   399    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   400        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   401    12  DC-EL310-DATE                  PIC X(21).
   402    12  FILLER                         PIC X(28).
   403
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  11
* EL162.cbl
   405*                            COPY ELCLOGOF.
   406******************************************************************
   407*                                                                *
   408*                                                                *
   409*                            ELCLOGOF.                           *
   410*                            VMOD=2.001                          *
   411*                                                                *
   412*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   413*                                                                *
   414******************************************************************
   415 01  CLASIC-LOGOFF.
   416     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   417     12  LOGOFF-TEXT.
   418         16  FILLER          PIC X(5)    VALUE SPACES.
   419         16  LOGOFF-MSG.
   420             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   421             20  FILLER      PIC X       VALUE SPACES.
   422             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   423         16  FILLER          PIC X(80)
   424           VALUE '* YOU ARE NOW LOGGED OFF'.
   425         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   426         16  FILLER          PIC X       VALUE QUOTE.
   427         16  LOGOFF-SYS-MSG  PIC X(17)
   428           VALUE 'S CLAS-IC SYSTEM '.
   429     12  TEXT-MESSAGES.
   430         16  UNACCESS-MSG    PIC X(29)
   431             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   432         16  PGMIDERR-MSG    PIC X(17)
   433             VALUE 'PROGRAM NOT FOUND'.
   434
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  12
* EL162.cbl
   436*                            COPY ELCATTR.
   437******************************************************************
   438*                                                                *
   439*                            ELCATTR.                            *
   440*                            VMOD=2.001                          *
   441*                                                                *
   442*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   443*                                                                *
   444*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   445*                                                                *
   446*                   POS 1   P=PROTECTED                          *
   447*                           U=UNPROTECTED                        *
   448*                           S=ASKIP                              *
   449*                   POS 2   A=ALPHA/NUMERIC                      *
   450*                           N=NUMERIC                            *
   451*                   POS 3   N=NORMAL                             *
   452*                           B=BRIGHT                             *
   453*                           D=DARK                               *
   454*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   455*                           OF=MODIFIED DATA TAG OFF             *
   456*                                                                *
   457*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   458******************************************************************
   459 01  ATTRIBUTE-LIST.
   460     12  AL-PABOF            PIC X       VALUE 'Y'.
   461     12  AL-PABON            PIC X       VALUE 'Z'.
   462     12  AL-PADOF            PIC X       VALUE '%'.
   463     12  AL-PADON            PIC X       VALUE '_'.
   464     12  AL-PANOF            PIC X       VALUE '-'.
   465     12  AL-PANON            PIC X       VALUE '/'.
   466     12  AL-SABOF            PIC X       VALUE '8'.
   467     12  AL-SABON            PIC X       VALUE '9'.
   468     12  AL-SADOF            PIC X       VALUE '@'.
   469     12  AL-SADON            PIC X       VALUE QUOTE.
   470     12  AL-SANOF            PIC X       VALUE '0'.
   471     12  AL-SANON            PIC X       VALUE '1'.
   472     12  AL-UABOF            PIC X       VALUE 'H'.
   473     12  AL-UABON            PIC X       VALUE 'I'.
   474     12  AL-UADOF            PIC X       VALUE '<'.
   475     12  AL-UADON            PIC X       VALUE '('.
   476     12  AL-UANOF            PIC X       VALUE ' '.
   477     12  AL-UANON            PIC X       VALUE 'A'.
   478     12  AL-UNBOF            PIC X       VALUE 'Q'.
   479     12  AL-UNBON            PIC X       VALUE 'R'.
   480     12  AL-UNDOF            PIC X       VALUE '*'.
   481     12  AL-UNDON            PIC X       VALUE ')'.
   482     12  AL-UNNOF            PIC X       VALUE '&'.
   483     12  AL-UNNON            PIC X       VALUE 'J'.
   484
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  13
* EL162.cbl
   486*                            COPY ELCEMIB.
   487******************************************************************
   488*                                                                *
   489*                                                                *
   490*                            ELCEMIB.                            *
   491*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   492*                            VMOD=2.005                          *
   493*                                                                *
   494*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   495*                                                                *
   496******************************************************************
   497 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   498     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   499     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   500     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   501     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   502     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   503     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   504     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   505     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   506     12  EMI-SWITCH1             PIC X        VALUE '1'.
   507         88  EMI-NO-ERRORS                    VALUE '1'.
   508         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   509         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   510     12  EMI-SWITCH2             PIC X        VALUE '1'.
   511         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   512     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   513         88  EMI-AREA1-EMPTY                  VALUE '1'.
   514         88  EMI-AREA1-FULL                   VALUE '2'.
   515     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   516         88  EMI-AREA2-EMPTY                  VALUE '1'.
   517         88  EMI-AREA2-FULL                   VALUE '2'.
   518     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   519         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   520         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   521         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   522         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   523         88  EMI-BYPASS-FATALS                VALUE 'X'.
   524     12  EMI-ERROR-LINES.
   525         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   526         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   527         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   528         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   529             20  EMI-ERR-CODES OCCURS 10 TIMES.
   530                 24  EMI-ERR-NUM         PIC X(4).
   531                 24  EMI-FILLER          PIC X.
   532                 24  EMI-SEV             PIC X.
   533                 24  FILLER              PIC X.
   534             20  FILLER                  PIC X(02).
   535     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   536         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   537             20  EMI-ERROR-NUMBER    PIC X(4).
   538             20  EMI-FILL            PIC X.
   539             20  EMI-SEVERITY        PIC X.
   540             20  FILLER              PIC X.
   541             20  EMI-ERROR-TEXT.
   542                 24  EMI-TEXT-VARIABLE   PIC X(10).
   543                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  14
* EL162.cbl
   544     12  EMI-SEVERITY-SAVE           PIC X.
   545         88  EMI-NOTE                    VALUE 'N'.
   546         88  EMI-WARNING                 VALUE 'W'.
   547         88  EMI-FORCABLE                VALUE 'F'.
   548         88  EMI-FATAL                   VALUE 'X'.
   549     12  EMI-MESSAGE-FLAG            PIC X.
   550         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   551         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   552     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   553     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   554         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   555         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   556         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   557     12  emi-claim-no                pic x(7).
   558     12  emi-claim-type              pic x(6).
   559     12  FILLER                      PIC X(124)  VALUE SPACES.
   560     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   561     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   562     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   563     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  15
* EL162.cbl
   565*                            COPY ELCINTF.
   566******************************************************************
   567*                                                                *
   568*                                                                *
   569*                            ELCINTF.                            *
   570*                            VMOD=2.017                          *
   571*                                                                *
   572*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   573*                                                                *
   574*       LENGTH = 1024                                            *
   575*                                                                *
   576******************************************************************
   577*                   C H A N G E   L O G
   578*
   579* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   580*-----------------------------------------------------------------
   581*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   582* EFFECTIVE    NUMBER
   583*-----------------------------------------------------------------
   584* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   585******************************************************************
   586 01  PROGRAM-INTERFACE-BLOCK.
   587     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   588     12  PI-CALLING-PROGRAM              PIC X(8).
   589     12  PI-SAVED-PROGRAM-1              PIC X(8).
   590     12  PI-SAVED-PROGRAM-2              PIC X(8).
   591     12  PI-SAVED-PROGRAM-3              PIC X(8).
   592     12  PI-SAVED-PROGRAM-4              PIC X(8).
   593     12  PI-SAVED-PROGRAM-5              PIC X(8).
   594     12  PI-SAVED-PROGRAM-6              PIC X(8).
   595     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   596     12  PI-COMPANY-ID                   PIC XXX.
   597     12  PI-COMPANY-CD                   PIC X.
   598
   599     12  PI-COMPANY-PASSWORD             PIC X(8).
   600
   601     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   602
   603     12  PI-CONTROL-IN-PROGRESS.
   604         16  PI-CARRIER                  PIC X.
   605         16  PI-GROUPING                 PIC X(6).
   606         16  PI-STATE                    PIC XX.
   607         16  PI-ACCOUNT                  PIC X(10).
   608         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   609                                         PIC X(10).
   610         16  PI-CLAIM-CERT-GRP.
   611             20  PI-CLAIM-NO             PIC X(7).
   612             20  PI-CERT-NO.
   613                 25  PI-CERT-PRIME       PIC X(10).
   614                 25  PI-CERT-SFX         PIC X.
   615             20  PI-CERT-EFF-DT          PIC XX.
   616         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   617             20  PI-PLAN-CODE            PIC X(2).
   618             20  PI-REVISION-NUMBER      PIC X(3).
   619             20  PI-PLAN-EFF-DT          PIC X(2).
   620             20  PI-PLAN-EXP-DT          PIC X(2).
   621             20  FILLER                  PIC X(11).
   622         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  16
* EL162.cbl
   623             20  PI-OE-REFERENCE-1.
   624                 25  PI-OE-REF-1-PRIME   PIC X(18).
   625                 25  PI-OE-REF-1-SUFF    PIC XX.
   626
   627     12  PI-SESSION-IN-PROGRESS          PIC X.
   628         88  CLAIM-SESSION                   VALUE '1'.
   629         88  CREDIT-SESSION                  VALUE '2'.
   630         88  WARRANTY-SESSION                VALUE '3'.
   631         88  MORTGAGE-SESSION                VALUE '4'.
   632         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   633
   634
   635*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   636
   637     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   638     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   639
   640     12  PI-CREDIT-USER                  PIC X.
   641         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   642         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   643
   644     12  PI-CLAIM-USER                   PIC X.
   645         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   646         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   647
   648     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   649         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   650         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   651         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   652         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   653         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   654
   655     12  PI-PROCESSOR-ID                 PIC X(4).
   656
   657     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   658
   659     12  PI-MEMBER-CAPTION               PIC X(10).
   660
   661     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   662         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   663
   664     12  PI-LIFE-OVERRIDE-L1             PIC X.
   665     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   666     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   667     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   668
   669     12  PI-AH-OVERRIDE-L1               PIC X.
   670     12  PI-AH-OVERRIDE-L2               PIC XX.
   671     12  PI-AH-OVERRIDE-L6               PIC X(6).
   672     12  PI-AH-OVERRIDE-L12              PIC X(12).
   673
   674     12  PI-NEW-SYSTEM                   PIC X(2).
   675
   676     12  PI-PRIMARY-CERT-NO              PIC X(11).
   677     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   678         88  PI-USES-PAID-TO                 VALUE '1'.
   679     12  PI-CRDTCRD-SYSTEM.
   680         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  17
* EL162.cbl
   681             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   682             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   683         16  PI-CC-MONTH-END-DT          PIC XX.
   684     12  PI-PROCESSOR-PRINTER            PIC X(4).
   685
   686     12  PI-OE-REFERENCE-2.
   687         16  PI-OE-REF-2-PRIME           PIC X(10).
   688         16  PI-OE-REF-2-SUFF            PIC X.
   689
   690     12  PI-REM-TRM-CALC-OPTION          PIC X.
   691
   692     12  PI-LANGUAGE-TYPE                PIC X.
   693             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   694             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   695             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   696
   697     12  PI-POLICY-LINKAGE-IND           PIC X.
   698         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   699         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   700                                                   LOW-VALUES.
   701
   702     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   703     12  PI-CLAIM-PW-SESSION             PIC X(1).
   704         88  PI-CLAIM-CREDIT                 VALUE '1'.
   705         88  PI-CLAIM-CONVEN                 VALUE '2'.
   706
   707     12  PI-PROCESSOR-CSR-IND            PIC X.
   708         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   709         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   710
   711     12  FILLER                          PIC X(3).
   712
   713     12  PI-SYSTEM-LEVEL                 PIC X(145).
   714
   715     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   716         PI-SYSTEM-LEVEL.
   717
   718         16  PI-ENTRY-CODES.
   719             20  PI-ENTRY-CD-1           PIC X.
   720             20  PI-ENTRY-CD-2           PIC X.
   721
   722         16  PI-RETURN-CODES.
   723             20  PI-RETURN-CD-1          PIC X.
   724             20  PI-RETURN-CD-2          PIC X.
   725
   726         16  PI-UPDATE-STATUS-SAVE.
   727             20  PI-UPDATE-BY            PIC X(4).
   728             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   729
   730         16  PI-LOWER-CASE-LETTERS       PIC X.
   731             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   732
   733*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   734*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   735*            88  CARRIER-CLM-CNTL            VALUE '2'.
   736
   737         16  PI-CERT-ACCESS-CONTROL      PIC X.
   738             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  18
* EL162.cbl
   739             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   740             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   741             88  ACCNT-CNTL                  VALUE '3'.
   742             88  CARR-ACCNT-CNTL             VALUE '4'.
   743
   744         16  PI-PROCESSOR-CAP-LIST.
   745             20  PI-SYSTEM-CONTROLS.
   746                24 PI-SYSTEM-DISPLAY     PIC X.
   747                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   748                24 PI-SYSTEM-MODIFY      PIC X.
   749                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   750             20  FILLER                  PIC XX.
   751             20  PI-DISPLAY-CAP          PIC X.
   752                 88  DISPLAY-CAP             VALUE 'Y'.
   753             20  PI-MODIFY-CAP           PIC X.
   754                 88  MODIFY-CAP              VALUE 'Y'.
   755             20  PI-MSG-AT-LOGON-CAP     PIC X.
   756                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   757             20  PI-FORCE-CAP            PIC X.
   758                 88  FORCE-CAP               VALUE 'Y'.
   759
   760         16  PI-PROGRAM-CONTROLS.
   761             20  PI-PGM-PRINT-OPT        PIC X.
   762             20  PI-PGM-FORMAT-OPT       PIC X.
   763             20  PI-PGM-PROCESS-OPT      PIC X.
   764             20  PI-PGM-TOTALS-OPT       PIC X.
   765
   766         16  PI-HELP-INTERFACE.
   767             20  PI-LAST-ERROR-NO        PIC X(4).
   768             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   769
   770         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   771             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   772
   773         16  PI-CR-CONTROL-IN-PROGRESS.
   774             20  PI-CR-CARRIER           PIC X.
   775             20  PI-CR-GROUPING          PIC X(6).
   776             20  PI-CR-STATE             PIC XX.
   777             20  PI-CR-ACCOUNT           PIC X(10).
   778             20  PI-CR-FIN-RESP          PIC X(10).
   779             20  PI-CR-TYPE              PIC X.
   780
   781         16  PI-CR-BATCH-NUMBER          PIC X(6).
   782
   783         16  PI-CR-MONTH-END-DT          PIC XX.
   784
   785         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   786             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   787             88  PI-ZERO-CARRIER             VALUE '1'.
   788             88  PI-ZERO-GROUPING            VALUE '2'.
   789             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   790
   791         16  PI-CARRIER-SECURITY         PIC X.
   792             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   793
   794         16  PI-ACCOUNT-SECURITY         PIC X(10).
   795             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   796             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  19
* EL162.cbl
   797
   798         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   799             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   800                                         INDEXED BY PI-ACCESS-NDX
   801                                         PIC X.
   802
   803         16  PI-GA-BILLING-CONTROL       PIC X.
   804             88  PI-GA-BILLING               VALUE '1'.
   805
   806         16  PI-MAIL-PROCESSING          PIC X.
   807             88  PI-MAIL-YES                 VALUE 'Y'.
   808
   809         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   810
   811         16  PI-AR-SYSTEM.
   812             20  PI-AR-PROCESSING-CNTL   PIC X.
   813                 88  PI-AR-PROCESSING        VALUE 'Y'.
   814             20  PI-AR-SUMMARY-CODE      PIC X(6).
   815             20  PI-AR-MONTH-END-DT      PIC XX.
   816
   817         16  PI-MP-SYSTEM.
   818             20  PI-MORTGAGE-USER            PIC X.
   819                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   820                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   821             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   822                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   823                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   824                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   825                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   826                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   827             20  PI-MP-MONTH-END-DT          PIC XX.
   828             20  PI-MP-REFERENCE-NO.
   829                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   830                 24  PI-MP-REFERENCE-SFX     PIC XX.
   831
   832         16  PI-LABEL-CONTROL            PIC X(01).
   833             88  PI-CREATE-LABELS                    VALUE 'Y'.
   834             88  PI-BYPASS-LABELS                    VALUE 'N'.
   835
   836         16  PI-BILL-GROUPING-CODE       PIC X(01).
   837             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   838
   839         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   840             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   841             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   842
   843         16  FILLER                      PIC X(14).
   844
   845     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   846******************************************************************
   847     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   848         16  PI-NEXT-TRLR-SUB    PIC S999  COMP-3.
   849         16  PI-ACTV-SAVE        PIC X(20).
   850         16  PI-ACTV-SAVE-SEQ    PIC S9(04) COMP.
   851         16  PI-ACTV-KEY.
   852           18  PI-ACTV-PARTIAL.
   853             20  PI-ACTV-COMP-CD     PIC X.
   854             20  PI-ACTV-CARRIER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  20
* EL162.cbl
   855             20  PI-ACTV-CLAIM       PIC X(7).
   856             20  PI-ACTV-CERT-NO.
   857                 22  PI-ACTV-CERT-NO-PRIME PIC X(10).
   858                 22  PI-ACTV-CERT-NO-SUFX  PIC X.
   859           18  PI-ACTV-SEQ           PIC S9(4) COMP.
   860
   861         16  PI-DISPLAYED-TRAILER-CODES.
   862             18  PI-TRLRS OCCURS 50 TIMES    PIC S9(4) COMP.
   863         16  PI-CLAM-KEY.
   864             20  PI-CLAM-COMP-CD     PIC X.
   865             20  PI-CLAM-CARRIER     PIC X.
   866             20  PI-CLAM-CLAIM       PIC X(7).
   867             20  PI-CLAM-CERT-NO.
   868                 24  PI-CLAM-CERT-NO-PRIME  PIC X(10).
   869                 24  PI-CLAM-CERT-NO-SUFX   PIC X.
   870         16  PI-DMD-FORCE-ERROR      PIC X.
   871             88  PI-DMD-FORCED             VALUE 'X'.
   872         16  FILLER                  PIC X(473).
   873
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  21
* EL162.cbl
   875*                            COPY ELCAID.
   876******************************************************************
   877*                                                                *
   878*                            ELCAID.                             *
   879*                            VMOD=2.001                          *
   880*                                                                *
   881*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   882*                                                                *
   883*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   884*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   885******************************************************************
   886
   887 01  DFHAID.
   888   02  DFHNULL   PIC  X  VALUE  ' '.
   889   02  DFHENTER  PIC  X  VALUE  QUOTE.
   890   02  DFHCLEAR  PIC  X  VALUE  '_'.
   891   02  DFHPEN    PIC  X  VALUE  '='.
   892   02  DFHOPID   PIC  X  VALUE  'W'.
   893   02  DFHPA1    PIC  X  VALUE  '%'.
   894   02  DFHPA2    PIC  X  VALUE  '>'.
   895   02  DFHPA3    PIC  X  VALUE  ','.
   896   02  DFHPF1    PIC  X  VALUE  '1'.
   897   02  DFHPF2    PIC  X  VALUE  '2'.
   898   02  DFHPF3    PIC  X  VALUE  '3'.
   899   02  DFHPF4    PIC  X  VALUE  '4'.
   900   02  DFHPF5    PIC  X  VALUE  '5'.
   901   02  DFHPF6    PIC  X  VALUE  '6'.
   902   02  DFHPF7    PIC  X  VALUE  '7'.
   903   02  DFHPF8    PIC  X  VALUE  '8'.
   904   02  DFHPF9    PIC  X  VALUE  '9'.
   905   02  DFHPF10   PIC  X  VALUE  ':'.
   906   02  DFHPF11   PIC  X  VALUE  '#'.
   907   02  DFHPF12   PIC  X  VALUE  '@'.
   908   02  DFHPF13   PIC  X  VALUE  'A'.
   909   02  DFHPF14   PIC  X  VALUE  'B'.
   910   02  DFHPF15   PIC  X  VALUE  'C'.
   911   02  DFHPF16   PIC  X  VALUE  'D'.
   912   02  DFHPF17   PIC  X  VALUE  'E'.
   913   02  DFHPF18   PIC  X  VALUE  'F'.
   914   02  DFHPF19   PIC  X  VALUE  'G'.
   915   02  DFHPF20   PIC  X  VALUE  'H'.
   916   02  DFHPF21   PIC  X  VALUE  'I'.
   917*00039    02  DFHPF22   PIC  X  VALUE  ''.
   918   02  DFHPF22   PIC  X  VALUE  '['.
   919   02  DFHPF23   PIC  X  VALUE  '.'.
   920   02  DFHPF24   PIC  X  VALUE  '<'.
   921   02  DFHMSRE   PIC  X  VALUE  'X'.
   922   02  DFHSTRF   PIC  X  VALUE  'h'.
   923   02  DFHTRIG   PIC  X  VALUE  '"'.
   924 01  FILLER    REDEFINES DFHAID.
   925     12  FILLER              PIC X(8).
   926     12  PF-VALUES           PIC X       OCCURS 2.
   927
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  22
* EL162.cbl
   929*                            COPY EL162S.
   930 01  EL162AI.
   931     05  FILLER            PIC  X(0012).
   932*    -------------------------------
   933     05  RUNDTEL PIC S9(0004) COMP.
   934     05  RUNDTEF PIC  X(0001).
   935     05  FILLER REDEFINES RUNDTEF.
   936         10  RUNDTEA PIC  X(0001).
   937     05  RUNDTEI PIC  X(0008).
   938*    -------------------------------
   939     05  RUNTIMEL PIC S9(0004) COMP.
   940     05  RUNTIMEF PIC  X(0001).
   941     05  FILLER REDEFINES RUNTIMEF.
   942         10  RUNTIMEA PIC  X(0001).
   943     05  RUNTIMEI PIC  X(0005).
   944*    -------------------------------
   945     05  CLAIMNOL PIC S9(0004) COMP.
   946     05  CLAIMNOF PIC  X(0001).
   947     05  FILLER REDEFINES CLAIMNOF.
   948         10  CLAIMNOA PIC  X(0001).
   949     05  CLAIMNOI PIC  X(0007).
   950*    -------------------------------
   951     05  TYPEL PIC S9(0004) COMP.
   952     05  TYPEF PIC  X(0001).
   953     05  FILLER REDEFINES TYPEF.
   954         10  TYPEA PIC  X(0001).
   955     05  TYPEI PIC  X(0006).
   956*    -------------------------------
   957     05  CARRL PIC S9(0004) COMP.
   958     05  CARRF PIC  X(0001).
   959     05  FILLER REDEFINES CARRF.
   960         10  CARRA PIC  X(0001).
   961     05  CARRI PIC  X(0001).
   962*    -------------------------------
   963     05  CERTNOL PIC S9(0004) COMP.
   964     05  CERTNOF PIC  X(0001).
   965     05  FILLER REDEFINES CERTNOF.
   966         10  CERTNOA PIC  X(0001).
   967     05  CERTNOI PIC  X(0011).
   968*    -------------------------------
   969     05  LASTNMEL PIC S9(0004) COMP.
   970     05  LASTNMEF PIC  X(0001).
   971     05  FILLER REDEFINES LASTNMEF.
   972         10  LASTNMEA PIC  X(0001).
   973     05  LASTNMEI PIC  X(0015).
   974*    -------------------------------
   975     05  FILEL PIC S9(0004) COMP.
   976     05  FILEF PIC  X(0001).
   977     05  FILLER REDEFINES FILEF.
   978         10  FILEA PIC  X(0001).
   979     05  FILEI PIC  X(0004).
   980*    -------------------------------
   981     05  RECDTE1L PIC S9(0004) COMP.
   982     05  RECDTE1F PIC  X(0001).
   983     05  FILLER REDEFINES RECDTE1F.
   984         10  RECDTE1A PIC  X(0001).
   985     05  RECDTE1I PIC  X(0008).
   986*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  23
* EL162.cbl
   987     05  STOPDT1L PIC S9(0004) COMP.
   988     05  STOPDT1F PIC  X(0001).
   989     05  FILLER REDEFINES STOPDT1F.
   990         10  STOPDT1A PIC  X(0001).
   991     05  STOPDT1I PIC  X(0008).
   992*    -------------------------------
   993     05  SENT1L PIC S9(0004) COMP.
   994     05  SENT1F PIC  X(0001).
   995     05  FILLER REDEFINES SENT1F.
   996         10  SENT1A PIC  X(0001).
   997     05  SENT1I PIC  X(0008).
   998*    -------------------------------
   999     05  BY1L PIC S9(0004) COMP.
  1000     05  BY1F PIC  X(0001).
  1001     05  FILLER REDEFINES BY1F.
  1002         10  BY1A PIC  X(0001).
  1003     05  BY1I PIC  X(0004).
  1004*    -------------------------------
  1005     05  RESEND1L PIC S9(0004) COMP.
  1006     05  RESEND1F PIC  X(0001).
  1007     05  FILLER REDEFINES RESEND1F.
  1008         10  RESEND1A PIC  X(0001).
  1009     05  RESEND1I PIC  X(0008).
  1010*    -------------------------------
  1011     05  FOLLOW1L PIC S9(0004) COMP.
  1012     05  FOLLOW1F PIC  X(0001).
  1013     05  FILLER REDEFINES FOLLOW1F.
  1014         10  FOLLOW1A PIC  X(0001).
  1015     05  FOLLOW1I PIC  X(0008).
  1016*    -------------------------------
  1017     05  FORM1L PIC S9(0004) COMP.
  1018     05  FORM1F PIC  X(0001).
  1019     05  FILLER REDEFINES FORM1F.
  1020         10  FORM1A PIC  X(0001).
  1021     05  FORM1I PIC  X(0004).
  1022*    -------------------------------
  1023     05  TO1L PIC S9(0004) COMP.
  1024     05  TO1F PIC  X(0001).
  1025     05  FILLER REDEFINES TO1F.
  1026         10  TO1A PIC  X(0001).
  1027     05  TO1I PIC  X(0008).
  1028*    -------------------------------
  1029     05  ARCH1L PIC S9(0004) COMP.
  1030     05  ARCH1F PIC  X(0001).
  1031     05  FILLER REDEFINES ARCH1F.
  1032         10  ARCH1A PIC  X(0001).
  1033     05  ARCH1I PIC  X(0008).
  1034*    -------------------------------
  1035     05  TRLR1L PIC S9(0004) COMP.
  1036     05  TRLR1F PIC  X(0001).
  1037     05  FILLER REDEFINES TRLR1F.
  1038         10  TRLR1A PIC  X(0001).
  1039     05  TRLR1I PIC  X(0004).
  1040*    -------------------------------
  1041     05  TYPE1L PIC S9(0004) COMP.
  1042     05  TYPE1F PIC  X(0001).
  1043     05  FILLER REDEFINES TYPE1F.
  1044         10  TYPE1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  24
* EL162.cbl
  1045     05  TYPE1I PIC  X(0001).
  1046*    -------------------------------
  1047     05  RE1L PIC S9(0004) COMP.
  1048     05  RE1F PIC  X(0001).
  1049     05  FILLER REDEFINES RE1F.
  1050         10  RE1A PIC  X(0001).
  1051     05  RE1I PIC  X(0070).
  1052*    -------------------------------
  1053     05  RECDTE2L PIC S9(0004) COMP.
  1054     05  RECDTE2F PIC  X(0001).
  1055     05  FILLER REDEFINES RECDTE2F.
  1056         10  RECDTE2A PIC  X(0001).
  1057     05  RECDTE2I PIC  X(0008).
  1058*    -------------------------------
  1059     05  STOPDT2L PIC S9(0004) COMP.
  1060     05  STOPDT2F PIC  X(0001).
  1061     05  FILLER REDEFINES STOPDT2F.
  1062         10  STOPDT2A PIC  X(0001).
  1063     05  STOPDT2I PIC  X(0008).
  1064*    -------------------------------
  1065     05  SENT2L PIC S9(0004) COMP.
  1066     05  SENT2F PIC  X(0001).
  1067     05  FILLER REDEFINES SENT2F.
  1068         10  SENT2A PIC  X(0001).
  1069     05  SENT2I PIC  X(0008).
  1070*    -------------------------------
  1071     05  BY2L PIC S9(0004) COMP.
  1072     05  BY2F PIC  X(0001).
  1073     05  FILLER REDEFINES BY2F.
  1074         10  BY2A PIC  X(0001).
  1075     05  BY2I PIC  X(0004).
  1076*    -------------------------------
  1077     05  RESEND2L PIC S9(0004) COMP.
  1078     05  RESEND2F PIC  X(0001).
  1079     05  FILLER REDEFINES RESEND2F.
  1080         10  RESEND2A PIC  X(0001).
  1081     05  RESEND2I PIC  X(0008).
  1082*    -------------------------------
  1083     05  FOLLOW2L PIC S9(0004) COMP.
  1084     05  FOLLOW2F PIC  X(0001).
  1085     05  FILLER REDEFINES FOLLOW2F.
  1086         10  FOLLOW2A PIC  X(0001).
  1087     05  FOLLOW2I PIC  X(0008).
  1088*    -------------------------------
  1089     05  FORM2L PIC S9(0004) COMP.
  1090     05  FORM2F PIC  X(0001).
  1091     05  FILLER REDEFINES FORM2F.
  1092         10  FORM2A PIC  X(0001).
  1093     05  FORM2I PIC  X(0004).
  1094*    -------------------------------
  1095     05  TO2L PIC S9(0004) COMP.
  1096     05  TO2F PIC  X(0001).
  1097     05  FILLER REDEFINES TO2F.
  1098         10  TO2A PIC  X(0001).
  1099     05  TO2I PIC  X(0008).
  1100*    -------------------------------
  1101     05  ARCH2L PIC S9(0004) COMP.
  1102     05  ARCH2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  25
* EL162.cbl
  1103     05  FILLER REDEFINES ARCH2F.
  1104         10  ARCH2A PIC  X(0001).
  1105     05  ARCH2I PIC  X(0008).
  1106*    -------------------------------
  1107     05  TRLR2L PIC S9(0004) COMP.
  1108     05  TRLR2F PIC  X(0001).
  1109     05  FILLER REDEFINES TRLR2F.
  1110         10  TRLR2A PIC  X(0001).
  1111     05  TRLR2I PIC  X(0004).
  1112*    -------------------------------
  1113     05  TYPE2L PIC S9(0004) COMP.
  1114     05  TYPE2F PIC  X(0001).
  1115     05  FILLER REDEFINES TYPE2F.
  1116         10  TYPE2A PIC  X(0001).
  1117     05  TYPE2I PIC  X(0001).
  1118*    -------------------------------
  1119     05  RE2L PIC S9(0004) COMP.
  1120     05  RE2F PIC  X(0001).
  1121     05  FILLER REDEFINES RE2F.
  1122         10  RE2A PIC  X(0001).
  1123     05  RE2I PIC  X(0070).
  1124*    -------------------------------
  1125     05  RECDTE3L PIC S9(0004) COMP.
  1126     05  RECDTE3F PIC  X(0001).
  1127     05  FILLER REDEFINES RECDTE3F.
  1128         10  RECDTE3A PIC  X(0001).
  1129     05  RECDTE3I PIC  X(0008).
  1130*    -------------------------------
  1131     05  STOPDT3L PIC S9(0004) COMP.
  1132     05  STOPDT3F PIC  X(0001).
  1133     05  FILLER REDEFINES STOPDT3F.
  1134         10  STOPDT3A PIC  X(0001).
  1135     05  STOPDT3I PIC  X(0008).
  1136*    -------------------------------
  1137     05  SENT3L PIC S9(0004) COMP.
  1138     05  SENT3F PIC  X(0001).
  1139     05  FILLER REDEFINES SENT3F.
  1140         10  SENT3A PIC  X(0001).
  1141     05  SENT3I PIC  X(0008).
  1142*    -------------------------------
  1143     05  BY3L PIC S9(0004) COMP.
  1144     05  BY3F PIC  X(0001).
  1145     05  FILLER REDEFINES BY3F.
  1146         10  BY3A PIC  X(0001).
  1147     05  BY3I PIC  X(0004).
  1148*    -------------------------------
  1149     05  RESEND3L PIC S9(0004) COMP.
  1150     05  RESEND3F PIC  X(0001).
  1151     05  FILLER REDEFINES RESEND3F.
  1152         10  RESEND3A PIC  X(0001).
  1153     05  RESEND3I PIC  X(0008).
  1154*    -------------------------------
  1155     05  FOLLOW3L PIC S9(0004) COMP.
  1156     05  FOLLOW3F PIC  X(0001).
  1157     05  FILLER REDEFINES FOLLOW3F.
  1158         10  FOLLOW3A PIC  X(0001).
  1159     05  FOLLOW3I PIC  X(0008).
  1160*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  26
* EL162.cbl
  1161     05  FORM3L PIC S9(0004) COMP.
  1162     05  FORM3F PIC  X(0001).
  1163     05  FILLER REDEFINES FORM3F.
  1164         10  FORM3A PIC  X(0001).
  1165     05  FORM3I PIC  X(0004).
  1166*    -------------------------------
  1167     05  TO3L PIC S9(0004) COMP.
  1168     05  TO3F PIC  X(0001).
  1169     05  FILLER REDEFINES TO3F.
  1170         10  TO3A PIC  X(0001).
  1171     05  TO3I PIC  X(0008).
  1172*    -------------------------------
  1173     05  ARCH3L PIC S9(0004) COMP.
  1174     05  ARCH3F PIC  X(0001).
  1175     05  FILLER REDEFINES ARCH3F.
  1176         10  ARCH3A PIC  X(0001).
  1177     05  ARCH3I PIC  X(0008).
  1178*    -------------------------------
  1179     05  TRLR3L PIC S9(0004) COMP.
  1180     05  TRLR3F PIC  X(0001).
  1181     05  FILLER REDEFINES TRLR3F.
  1182         10  TRLR3A PIC  X(0001).
  1183     05  TRLR3I PIC  X(0004).
  1184*    -------------------------------
  1185     05  TYPE3L PIC S9(0004) COMP.
  1186     05  TYPE3F PIC  X(0001).
  1187     05  FILLER REDEFINES TYPE3F.
  1188         10  TYPE3A PIC  X(0001).
  1189     05  TYPE3I PIC  X(0001).
  1190*    -------------------------------
  1191     05  RE3L PIC S9(0004) COMP.
  1192     05  RE3F PIC  X(0001).
  1193     05  FILLER REDEFINES RE3F.
  1194         10  RE3A PIC  X(0001).
  1195     05  RE3I PIC  X(0070).
  1196*    -------------------------------
  1197     05  RECDTE4L PIC S9(0004) COMP.
  1198     05  RECDTE4F PIC  X(0001).
  1199     05  FILLER REDEFINES RECDTE4F.
  1200         10  RECDTE4A PIC  X(0001).
  1201     05  RECDTE4I PIC  X(0008).
  1202*    -------------------------------
  1203     05  STOPDT4L PIC S9(0004) COMP.
  1204     05  STOPDT4F PIC  X(0001).
  1205     05  FILLER REDEFINES STOPDT4F.
  1206         10  STOPDT4A PIC  X(0001).
  1207     05  STOPDT4I PIC  X(0008).
  1208*    -------------------------------
  1209     05  SENT4L PIC S9(0004) COMP.
  1210     05  SENT4F PIC  X(0001).
  1211     05  FILLER REDEFINES SENT4F.
  1212         10  SENT4A PIC  X(0001).
  1213     05  SENT4I PIC  X(0008).
  1214*    -------------------------------
  1215     05  BY4L PIC S9(0004) COMP.
  1216     05  BY4F PIC  X(0001).
  1217     05  FILLER REDEFINES BY4F.
  1218         10  BY4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  27
* EL162.cbl
  1219     05  BY4I PIC  X(0004).
  1220*    -------------------------------
  1221     05  RESEND4L PIC S9(0004) COMP.
  1222     05  RESEND4F PIC  X(0001).
  1223     05  FILLER REDEFINES RESEND4F.
  1224         10  RESEND4A PIC  X(0001).
  1225     05  RESEND4I PIC  X(0008).
  1226*    -------------------------------
  1227     05  FOLLOW4L PIC S9(0004) COMP.
  1228     05  FOLLOW4F PIC  X(0001).
  1229     05  FILLER REDEFINES FOLLOW4F.
  1230         10  FOLLOW4A PIC  X(0001).
  1231     05  FOLLOW4I PIC  X(0008).
  1232*    -------------------------------
  1233     05  FORM4L PIC S9(0004) COMP.
  1234     05  FORM4F PIC  X(0001).
  1235     05  FILLER REDEFINES FORM4F.
  1236         10  FORM4A PIC  X(0001).
  1237     05  FORM4I PIC  X(0004).
  1238*    -------------------------------
  1239     05  TO4L PIC S9(0004) COMP.
  1240     05  TO4F PIC  X(0001).
  1241     05  FILLER REDEFINES TO4F.
  1242         10  TO4A PIC  X(0001).
  1243     05  TO4I PIC  X(0008).
  1244*    -------------------------------
  1245     05  ARCH4L PIC S9(0004) COMP.
  1246     05  ARCH4F PIC  X(0001).
  1247     05  FILLER REDEFINES ARCH4F.
  1248         10  ARCH4A PIC  X(0001).
  1249     05  ARCH4I PIC  X(0008).
  1250*    -------------------------------
  1251     05  TRLR4L PIC S9(0004) COMP.
  1252     05  TRLR4F PIC  X(0001).
  1253     05  FILLER REDEFINES TRLR4F.
  1254         10  TRLR4A PIC  X(0001).
  1255     05  TRLR4I PIC  X(0004).
  1256*    -------------------------------
  1257     05  TYPE4L PIC S9(0004) COMP.
  1258     05  TYPE4F PIC  X(0001).
  1259     05  FILLER REDEFINES TYPE4F.
  1260         10  TYPE4A PIC  X(0001).
  1261     05  TYPE4I PIC  X(0001).
  1262*    -------------------------------
  1263     05  RE4L PIC S9(0004) COMP.
  1264     05  RE4F PIC  X(0001).
  1265     05  FILLER REDEFINES RE4F.
  1266         10  RE4A PIC  X(0001).
  1267     05  RE4I PIC  X(0070).
  1268*    -------------------------------
  1269     05  URECDTEL PIC S9(0004) COMP.
  1270     05  URECDTEF PIC  X(0001).
  1271     05  FILLER REDEFINES URECDTEF.
  1272         10  URECDTEA PIC  X(0001).
  1273     05  URECDTEI PIC  X(0008).
  1274*    -------------------------------
  1275     05  USENTL PIC S9(0004) COMP.
  1276     05  USENTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  28
* EL162.cbl
  1277     05  FILLER REDEFINES USENTF.
  1278         10  USENTA PIC  X(0001).
  1279     05  USENTI PIC  X(0008).
  1280*    -------------------------------
  1281     05  UBYL PIC S9(0004) COMP.
  1282     05  UBYF PIC  X(0001).
  1283     05  FILLER REDEFINES UBYF.
  1284         10  UBYA PIC  X(0001).
  1285     05  UBYI PIC  X(0004).
  1286*    -------------------------------
  1287     05  UFORML PIC S9(0004) COMP.
  1288     05  UFORMF PIC  X(0001).
  1289     05  FILLER REDEFINES UFORMF.
  1290         10  UFORMA PIC  X(0001).
  1291     05  UFORMI PIC  X(0004).
  1292*    -------------------------------
  1293     05  AUTHRCVL PIC S9(0004) COMP.
  1294     05  AUTHRCVF PIC  X(0001).
  1295     05  FILLER REDEFINES AUTHRCVF.
  1296         10  AUTHRCVA PIC  X(0001).
  1297     05  AUTHRCVI PIC  X(0001).
  1298*    -------------------------------
  1299     05  UREL PIC S9(0004) COMP.
  1300     05  UREF PIC  X(0001).
  1301     05  FILLER REDEFINES UREF.
  1302         10  UREA PIC  X(0001).
  1303     05  UREI PIC  X(0070).
  1304*    -------------------------------
  1305     05  ADDR1L PIC S9(0004) COMP.
  1306     05  ADDR1F PIC  X(0001).
  1307     05  FILLER REDEFINES ADDR1F.
  1308         10  ADDR1A PIC  X(0001).
  1309     05  ADDR1I PIC  X(0030).
  1310*    -------------------------------
  1311     05  ADDR2L PIC S9(0004) COMP.
  1312     05  ADDR2F PIC  X(0001).
  1313     05  FILLER REDEFINES ADDR2F.
  1314         10  ADDR2A PIC  X(0001).
  1315     05  ADDR2I PIC  X(0030).
  1316*    -------------------------------
  1317     05  ADDR3L PIC S9(0004) COMP.
  1318     05  ADDR3F PIC  X(0001).
  1319     05  FILLER REDEFINES ADDR3F.
  1320         10  ADDR3A PIC  X(0001).
  1321     05  ADDR3I PIC  X(0030).
  1322*    -------------------------------
  1323     05  ADDR4L PIC S9(0004) COMP.
  1324     05  ADDR4F PIC  X(0001).
  1325     05  FILLER REDEFINES ADDR4F.
  1326         10  ADDR4A PIC  X(0001).
  1327     05  ADDR4I PIC  X(0030).
  1328*    -------------------------------
  1329     05  ZIPL PIC S9(0004) COMP.
  1330     05  ZIPF PIC  X(0001).
  1331     05  FILLER REDEFINES ZIPF.
  1332         10  ZIPA PIC  X(0001).
  1333     05  ZIPI PIC  X(0010).
  1334*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  29
* EL162.cbl
  1335     05  PHONEL PIC S9(0004) COMP.
  1336     05  PHONEF PIC  X(0001).
  1337     05  FILLER REDEFINES PHONEF.
  1338         10  PHONEA PIC  X(0001).
  1339     05  PHONEI PIC  X(0012).
  1340*    -------------------------------
  1341     05  TRLRL PIC S9(0004) COMP.
  1342     05  TRLRF PIC  X(0001).
  1343     05  FILLER REDEFINES TRLRF.
  1344         10  TRLRA PIC  X(0001).
  1345     05  TRLRI PIC  X(0004).
  1346*    -------------------------------
  1347     05  ERRMSG1L PIC S9(0004) COMP.
  1348     05  ERRMSG1F PIC  X(0001).
  1349     05  FILLER REDEFINES ERRMSG1F.
  1350         10  ERRMSG1A PIC  X(0001).
  1351     05  ERRMSG1I PIC  X(0072).
  1352*    -------------------------------
  1353     05  ENTERPFL PIC S9(0004) COMP.
  1354     05  ENTERPFF PIC  X(0001).
  1355     05  FILLER REDEFINES ENTERPFF.
  1356         10  ENTERPFA PIC  X(0001).
  1357     05  ENTERPFI PIC  99.
  1358*    -------------------------------
  1359     05  PF4KEYL PIC S9(0004) COMP.
  1360     05  PF4KEYF PIC  X(0001).
  1361     05  FILLER REDEFINES PF4KEYF.
  1362         10  PF4KEYA PIC  X(0001).
  1363     05  PF4KEYI PIC  X(0015).
  1364*    -------------------------------
  1365     05  PF5KEYL PIC S9(0004) COMP.
  1366     05  PF5KEYF PIC  X(0001).
  1367     05  FILLER REDEFINES PF5KEYF.
  1368         10  PF5KEYA PIC  X(0001).
  1369     05  PF5KEYI PIC  X(0014).
  1370 01  EL162AO REDEFINES EL162AI.
  1371     05  FILLER            PIC  X(0012).
  1372*    -------------------------------
  1373     05  FILLER            PIC  X(0003).
  1374     05  RUNDTEO PIC  X(0008).
  1375*    -------------------------------
  1376     05  FILLER            PIC  X(0003).
  1377     05  RUNTIMEO PIC  99.99.
  1378*    -------------------------------
  1379     05  FILLER            PIC  X(0003).
  1380     05  CLAIMNOO PIC  X(0007).
  1381*    -------------------------------
  1382     05  FILLER            PIC  X(0003).
  1383     05  TYPEO PIC  X(0006).
  1384*    -------------------------------
  1385     05  FILLER            PIC  X(0003).
  1386     05  CARRO PIC  X(0001).
  1387*    -------------------------------
  1388     05  FILLER            PIC  X(0003).
  1389     05  CERTNOO PIC  X(0011).
  1390*    -------------------------------
  1391     05  FILLER            PIC  X(0003).
  1392     05  LASTNMEO PIC  X(0015).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  30
* EL162.cbl
  1393*    -------------------------------
  1394     05  FILLER            PIC  X(0003).
  1395     05  FILEO PIC  X(0004).
  1396*    -------------------------------
  1397     05  FILLER            PIC  X(0003).
  1398     05  RECDTE1O PIC  X(0008).
  1399*    -------------------------------
  1400     05  FILLER            PIC  X(0003).
  1401     05  STOPDT1O PIC  X(0008).
  1402*    -------------------------------
  1403     05  FILLER            PIC  X(0003).
  1404     05  SENT1O PIC  X(0008).
  1405*    -------------------------------
  1406     05  FILLER            PIC  X(0003).
  1407     05  BY1O PIC  X(0004).
  1408*    -------------------------------
  1409     05  FILLER            PIC  X(0003).
  1410     05  RESEND1O PIC  X(0008).
  1411*    -------------------------------
  1412     05  FILLER            PIC  X(0003).
  1413     05  FOLLOW1O PIC  X(0008).
  1414*    -------------------------------
  1415     05  FILLER            PIC  X(0003).
  1416     05  FORM1O PIC  X(0004).
  1417*    -------------------------------
  1418     05  FILLER            PIC  X(0003).
  1419     05  TO1O PIC  X(0008).
  1420*    -------------------------------
  1421     05  FILLER            PIC  X(0003).
  1422     05  ARCH1O PIC  X(0008).
  1423*    -------------------------------
  1424     05  FILLER            PIC  X(0003).
  1425     05  TRLR1O PIC  9999.
  1426*    -------------------------------
  1427     05  FILLER            PIC  X(0003).
  1428     05  TYPE1O PIC  X(0001).
  1429*    -------------------------------
  1430     05  FILLER            PIC  X(0003).
  1431     05  RE1O PIC  X(0070).
  1432*    -------------------------------
  1433     05  FILLER            PIC  X(0003).
  1434     05  RECDTE2O PIC  X(0008).
  1435*    -------------------------------
  1436     05  FILLER            PIC  X(0003).
  1437     05  STOPDT2O PIC  X(0008).
  1438*    -------------------------------
  1439     05  FILLER            PIC  X(0003).
  1440     05  SENT2O PIC  X(0008).
  1441*    -------------------------------
  1442     05  FILLER            PIC  X(0003).
  1443     05  BY2O PIC  X(0004).
  1444*    -------------------------------
  1445     05  FILLER            PIC  X(0003).
  1446     05  RESEND2O PIC  X(0008).
  1447*    -------------------------------
  1448     05  FILLER            PIC  X(0003).
  1449     05  FOLLOW2O PIC  X(0008).
  1450*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  31
* EL162.cbl
  1451     05  FILLER            PIC  X(0003).
  1452     05  FORM2O PIC  X(0004).
  1453*    -------------------------------
  1454     05  FILLER            PIC  X(0003).
  1455     05  TO2O PIC  X(0008).
  1456*    -------------------------------
  1457     05  FILLER            PIC  X(0003).
  1458     05  ARCH2O PIC  X(0008).
  1459*    -------------------------------
  1460     05  FILLER            PIC  X(0003).
  1461     05  TRLR2O PIC  9999.
  1462*    -------------------------------
  1463     05  FILLER            PIC  X(0003).
  1464     05  TYPE2O PIC  X(0001).
  1465*    -------------------------------
  1466     05  FILLER            PIC  X(0003).
  1467     05  RE2O PIC  X(0070).
  1468*    -------------------------------
  1469     05  FILLER            PIC  X(0003).
  1470     05  RECDTE3O PIC  X(0008).
  1471*    -------------------------------
  1472     05  FILLER            PIC  X(0003).
  1473     05  STOPDT3O PIC  X(0008).
  1474*    -------------------------------
  1475     05  FILLER            PIC  X(0003).
  1476     05  SENT3O PIC  X(0008).
  1477*    -------------------------------
  1478     05  FILLER            PIC  X(0003).
  1479     05  BY3O PIC  X(0004).
  1480*    -------------------------------
  1481     05  FILLER            PIC  X(0003).
  1482     05  RESEND3O PIC  X(0008).
  1483*    -------------------------------
  1484     05  FILLER            PIC  X(0003).
  1485     05  FOLLOW3O PIC  X(0008).
  1486*    -------------------------------
  1487     05  FILLER            PIC  X(0003).
  1488     05  FORM3O PIC  X(0004).
  1489*    -------------------------------
  1490     05  FILLER            PIC  X(0003).
  1491     05  TO3O PIC  X(0008).
  1492*    -------------------------------
  1493     05  FILLER            PIC  X(0003).
  1494     05  ARCH3O PIC  X(0008).
  1495*    -------------------------------
  1496     05  FILLER            PIC  X(0003).
  1497     05  TRLR3O PIC  9999.
  1498*    -------------------------------
  1499     05  FILLER            PIC  X(0003).
  1500     05  TYPE3O PIC  X(0001).
  1501*    -------------------------------
  1502     05  FILLER            PIC  X(0003).
  1503     05  RE3O PIC  X(0070).
  1504*    -------------------------------
  1505     05  FILLER            PIC  X(0003).
  1506     05  RECDTE4O PIC  X(0008).
  1507*    -------------------------------
  1508     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  32
* EL162.cbl
  1509     05  STOPDT4O PIC  X(0008).
  1510*    -------------------------------
  1511     05  FILLER            PIC  X(0003).
  1512     05  SENT4O PIC  X(0008).
  1513*    -------------------------------
  1514     05  FILLER            PIC  X(0003).
  1515     05  BY4O PIC  X(0004).
  1516*    -------------------------------
  1517     05  FILLER            PIC  X(0003).
  1518     05  RESEND4O PIC  X(0008).
  1519*    -------------------------------
  1520     05  FILLER            PIC  X(0003).
  1521     05  FOLLOW4O PIC  X(0008).
  1522*    -------------------------------
  1523     05  FILLER            PIC  X(0003).
  1524     05  FORM4O PIC  X(0004).
  1525*    -------------------------------
  1526     05  FILLER            PIC  X(0003).
  1527     05  TO4O PIC  X(0008).
  1528*    -------------------------------
  1529     05  FILLER            PIC  X(0003).
  1530     05  ARCH4O PIC  X(0008).
  1531*    -------------------------------
  1532     05  FILLER            PIC  X(0003).
  1533     05  TRLR4O PIC  9999.
  1534*    -------------------------------
  1535     05  FILLER            PIC  X(0003).
  1536     05  TYPE4O PIC  X(0001).
  1537*    -------------------------------
  1538     05  FILLER            PIC  X(0003).
  1539     05  RE4O PIC  X(0070).
  1540*    -------------------------------
  1541     05  FILLER            PIC  X(0003).
  1542     05  URECDTEO PIC  99B99B99.
  1543*    -------------------------------
  1544     05  FILLER            PIC  X(0003).
  1545     05  USENTO PIC  99B99B99.
  1546*    -------------------------------
  1547     05  FILLER            PIC  X(0003).
  1548     05  UBYO PIC  X(0004).
  1549*    -------------------------------
  1550     05  FILLER            PIC  X(0003).
  1551     05  UFORMO PIC  X(0004).
  1552*    -------------------------------
  1553     05  FILLER            PIC  X(0003).
  1554     05  AUTHRCVO PIC  X(0001).
  1555*    -------------------------------
  1556     05  FILLER            PIC  X(0003).
  1557     05  UREO PIC  X(0070).
  1558*    -------------------------------
  1559     05  FILLER            PIC  X(0003).
  1560     05  ADDR1O PIC  X(0030).
  1561*    -------------------------------
  1562     05  FILLER            PIC  X(0003).
  1563     05  ADDR2O PIC  X(0030).
  1564*    -------------------------------
  1565     05  FILLER            PIC  X(0003).
  1566     05  ADDR3O PIC  X(0030).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  33
* EL162.cbl
  1567*    -------------------------------
  1568     05  FILLER            PIC  X(0003).
  1569     05  ADDR4O PIC  X(0030).
  1570*    -------------------------------
  1571     05  FILLER            PIC  X(0003).
  1572     05  ZIPO PIC  X(0010).
  1573*    -------------------------------
  1574     05  FILLER            PIC  X(0003).
  1575     05  PHONEO PIC  999B999B9999.
  1576*    -------------------------------
  1577     05  FILLER            PIC  X(0003).
  1578     05  TRLRO PIC  9999.
  1579*    -------------------------------
  1580     05  FILLER            PIC  X(0003).
  1581     05  ERRMSG1O PIC  X(0072).
  1582*    -------------------------------
  1583     05  FILLER            PIC  X(0003).
  1584     05  ENTERPFO PIC  X(0002).
  1585*    -------------------------------
  1586     05  FILLER            PIC  X(0003).
  1587     05  PF4KEYO PIC  X(0015).
  1588*    -------------------------------
  1589     05  FILLER            PIC  X(0003).
  1590     05  PF5KEYO PIC  X(0014).
  1591*    -------------------------------
  1592
  1593 01  MAP-REDEF REDEFINES EL162AI.
  1594     12  FILLER              PIC X(93).
  1595     12  TRL-LINES.
  1596       14  TRAILER-LINES  OCCURS 4 TIMES INDEXED BY SC-INDX.
  1597         16  SC-RECL         PIC S9(4)  COMP.
  1598         16  SC-RECA         PIC X.
  1599         16  SC-REC          PIC X(8).
  1600         16  SC-REC-O REDEFINES SC-REC PIC 99B99B99.
  1601         16  SC-STOPL        PIC S9(4)  COMP.
  1602         16  SC-STOPA        PIC X.
  1603         16  SC-STOP         PIC X(8).
  1604         16  SC-STOP-O REDEFINES SC-STOP PIC 99B99B99.
  1605         16  FILLER          PIC X(3).
  1606         16  SC-SENT         PIC X(8).
  1607         16  FILLER          PIC X(3).
  1608         16  SC-BY           PIC X(4).
  1609         16  FILLER          PIC X(3).
  1610         16  SC-RESEND       PIC X(8).
  1611         16  FILLER          PIC X(3).
  1612         16  SC-FOLLOWUP     PIC X(8).
  1613         16  FILLER          PIC X(3).
  1614         16  SC-FORM         PIC X(4).
  1615         16  FILLER          PIC X(3).
  1616         16  SC-TO           PIC X(8).
  1617         16  FILLER          PIC X(3).
  1618         16  SC-ARCHIVE      PIC X(8).
  1619         16  FILLER          PIC X(3).
  1620         16  SC-TRLRNO       PIC 9(4).
  1621         16  FILLER          PIC X(3).
  1622         16  SC-TYPE         PIC X.
  1623         16  FILLER          PIC X(3).
  1624         16  SC-REASON       PIC X(70).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  34
* EL162.cbl
  1625
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  35
* EL162.cbl
  1627****************************************************************
  1628*
  1629* Copyright (c) 2007-2013 Dell Inc.
  1630* All rights reserved.
  1631*
  1632****************************************************************
  1633 01  DFHEIV.
  1634   02  DFHEIV0               PIC X(35).
  1635   02  DFHEIV1               PIC X(08).
  1636   02  DFHEIV2               PIC X(08).
  1637   02  DFHEIV3               PIC X(08).
  1638   02  DFHEIV4               PIC X(06).
  1639   02  DFHEIV5               PIC X(04).
  1640   02  DFHEIV6               PIC X(04).
  1641   02  DFHEIV7               PIC X(02).
  1642   02  DFHEIV8               PIC X(02).
  1643   02  DFHEIV9               PIC X(01).
  1644   02  DFHEIV10              PIC S9(7) COMP-3.
  1645   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1646   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1647   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1648   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1649   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1650   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1651   02  DFHEIV17              PIC X(04).
  1652   02  DFHEIV18              PIC X(04).
  1653   02  DFHEIV19              PIC X(04).
  1654   02  DFHEIV20              USAGE IS POINTER.
  1655   02  DFHEIV21              USAGE IS POINTER.
  1656   02  DFHEIV22              USAGE IS POINTER.
  1657   02  DFHEIV23              USAGE IS POINTER.
  1658   02  DFHEIV24              USAGE IS POINTER.
  1659   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1660   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1661   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1662   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1663   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1664   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1665   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1666   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1667   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1668   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1669   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1670   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1671   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1672   02  FILLER                PIC X(02).
  1673   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1674   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1675   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1676   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1677   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1678   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1679   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1680 LINKAGE  SECTION.
  1681*****************************************************************
  1682*                                                               *
  1683* Copyright (c) 2007-2013 Dell Inc.                             *
  1684* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  36
* EL162.cbl
  1685*                                                               *
  1686*****************************************************************
  1687 01  dfheiblk.
  1688     02  eibtime          pic s9(7) comp-3.
  1689     02  eibdate          pic s9(7) comp-3.
  1690     02  eibtrnid         pic x(4).
  1691     02  eibtaskn         pic s9(7) comp-3.
  1692     02  eibtrmid         pic x(4).
  1693     02  dfheigdi         pic s9(4) comp.
  1694     02  eibcposn         pic s9(4) comp.
  1695     02  eibcalen         pic s9(4) comp.
  1696     02  eibaid           pic x(1).
  1697     02  eibfiller1       pic x(1).
  1698     02  eibfn            pic x(2).
  1699     02  eibfiller2       pic x(2).
  1700     02  eibrcode         pic x(6).
  1701     02  eibfiller3       pic x(2).
  1702     02  eibds            pic x(8).
  1703     02  eibreqid         pic x(8).
  1704     02  eibrsrce         pic x(8).
  1705     02  eibsync          pic x(1).
  1706     02  eibfree          pic x(1).
  1707     02  eibrecv          pic x(1).
  1708     02  eibsend          pic x(1).
  1709     02  eibatt           pic x(1).
  1710     02  eibeoc           pic x(1).
  1711     02  eibfmh           pic x(1).
  1712     02  eibcompl         pic x(1).
  1713     02  eibsig           pic x(1).
  1714     02  eibconf          pic x(1).
  1715     02  eiberr           pic x(1).
  1716     02  eibrldbk         pic x(1).
  1717     02  eiberrcd         pic x(4).
  1718     02  eibsynrb         pic x(1).
  1719     02  eibnodat         pic x(1).
  1720     02  eibfiller5       pic x(2).
  1721     02  eibresp          pic s9(8) comp.
  1722     02  eibresp2         pic s9(8) comp.
  1723     02  dfheigdj         pic s9(4) comp.
  1724     02  dfheigdk         pic s9(4) comp.
  1725
  1726 01  DFHCOMMAREA             PIC X(1024).
  1727
  1728*01 PARMLIST .
  1729*    02  FILLER              PIC S9(8)   COMP.
  1730*    02  CLAM-POINTER        PIC S9(8)   COMP.
  1731*    02  ACTV-POINTER        PIC S9(8)   COMP.
  1732*    02  ACCT-POINTER        PIC S9(8)   COMP.
  1733
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  37
* EL162.cbl
  1735*                            COPY ELCMSTR.
  1736******************************************************************
  1737*                                                                *
  1738*                            ELCMSTR.                            *
  1739*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1740*                            VMOD=2.012                          *
  1741*                                                                *
  1742*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1743*                                                                *
  1744*   FILE TYPE = VSAM,KSDS                                        *
  1745*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1746*                                                                *
  1747*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1748*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1749*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1750*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1751*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1752*                                                 RKP=75,LEN=21  *
  1753*                                                                *
  1754*   **** NOTE ****                                               *
  1755*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1756*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1757*                                                                *
  1758*   LOG = YES                                                    *
  1759*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1760******************************************************************
  1761*                   C H A N G E   L O G
  1762*
  1763* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1764*-----------------------------------------------------------------
  1765*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1766* EFFECTIVE    NUMBER
  1767*-----------------------------------------------------------------
  1768* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1769* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1770* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  1771* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1772* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1773******************************************************************
  1774 01  CLAIM-MASTER.
  1775     12  CL-RECORD-ID                PIC XX.
  1776         88  VALID-CL-ID         VALUE 'CL'.
  1777
  1778     12  CL-CONTROL-PRIMARY.
  1779         16  CL-COMPANY-CD           PIC X.
  1780         16  CL-CARRIER              PIC X.
  1781         16  CL-CLAIM-NO             PIC X(7).
  1782         16  CL-CERT-NO.
  1783             20  CL-CERT-PRIME       PIC X(10).
  1784             20  CL-CERT-SFX         PIC X.
  1785
  1786     12  CL-CONTROL-BY-NAME.
  1787         16  CL-COMPANY-CD-A1        PIC X.
  1788         16  CL-INSURED-LAST-NAME    PIC X(15).
  1789         16  CL-INSURED-NAME.
  1790             20  CL-INSURED-1ST-NAME PIC X(12).
  1791             20  CL-INSURED-MID-INIT PIC X.
  1792
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  38
* EL162.cbl
  1793     12  CL-CONTROL-BY-SSN.
  1794         16  CL-COMPANY-CD-A2        PIC X.
  1795         16  CL-SOC-SEC-NO.
  1796             20  CL-SSN-STATE        PIC XX.
  1797             20  CL-SSN-ACCOUNT      PIC X(6).
  1798             20  CL-SSN-LN3          PIC X(3).
  1799
  1800     12  CL-CONTROL-BY-CERT-NO.
  1801         16  CL-COMPANY-CD-A4        PIC X.
  1802         16  CL-CERT-NO-A4.
  1803             20  CL-CERT-A4-PRIME    PIC X(10).
  1804             20  CL-CERT-A4-SFX      PIC X.
  1805
  1806     12  CL-CONTROL-BY-CCN.
  1807         16  CL-COMPANY-CD-A5        PIC X.
  1808         16  CL-CCN-A5.
  1809             20  CL-CCN.
  1810                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1811                 24  CL-CCN-PRIME-A5 PIC X(12).
  1812             20  CL-CCN-FILLER-A5    PIC X(4).
  1813
  1814     12  CL-INSURED-PROFILE-DATA.
  1815         16  CL-INSURED-BIRTH-DT     PIC XX.
  1816         16  CL-INSURED-SEX-CD       PIC X.
  1817             88  INSURED-IS-MALE        VALUE 'M'.
  1818             88  INSURED-IS-FEMALE      VALUE 'F'.
  1819             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1820         16  CL-INSURED-OCC-CD       PIC X(6).
  1821         16  FILLER                  PIC X(5).
  1822
  1823     12  CL-PROCESSING-INFO.
  1824         16  CL-PROCESSOR-ID         PIC X(4).
  1825         16  CL-CLAIM-STATUS         PIC X.
  1826             88  CLAIM-IS-OPEN          VALUE 'O'.
  1827             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1828         16  CL-CLAIM-TYPE           PIC X.
  1829*            88  AH-CLAIM               VALUE 'A'.
  1830*            88  LIFE-CLAIM             VALUE 'L'.
  1831*            88  PROPERTY-CLAIM         VALUE 'P'.
  1832*            88  IUI-CLAIM              VALUE 'I'.
  1833*            88  GAP-CLAIM              VALUE 'G'.
  1834*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  1835         16  CL-CLAIM-PREM-TYPE      PIC X.
  1836             88  SINGLE-PREMIUM         VALUE '1'.
  1837             88  O-B-COVERAGE           VALUE '2'.
  1838             88  OPEN-END-COVERAGE      VALUE '3'.
  1839         16  CL-INCURRED-DT          PIC XX.
  1840         16  CL-REPORTED-DT          PIC XX.
  1841         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1842         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1843         16  CL-LAST-PMT-DT          PIC XX.
  1844         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1845         16  CL-PAID-THRU-DT         PIC XX.
  1846         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1847         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  1848         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1849         16  CL-PMT-CALC-METHOD      PIC X.
  1850             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  39
* EL162.cbl
  1851             88  CL-365-DAY-YR          VALUE '2'.
  1852             88  CL-FULL-MONTHS         VALUE '3'.
  1853         16  CL-CAUSE-CD             PIC X(6).
  1854
  1855         16  CL-PRIME-CERT-NO.
  1856             20  CL-PRIME-CERT-PRIME PIC X(10).
  1857             20  CL-PRIME-CERT-SFX   PIC X.
  1858
  1859         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1860             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1861             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1862
  1863         16  CL-MICROFILM-NO         PIC X(10).
  1864         16  FILLER REDEFINES CL-MICROFILM-NO.
  1865             20  CL-BENEFIT-PERIOD   PIC 99.
  1866             20  FILLER              PIC X(8).
  1867         16  CL-PROG-FORM-TYPE       PIC X.
  1868         16  CL-LAST-ADD-ON-DT       PIC XX.
  1869
  1870         16  CL-LAST-REOPEN-DT       PIC XX.
  1871         16  CL-LAST-CLOSE-DT        PIC XX.
  1872         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1873             88  FINAL-PAID             VALUE '1'.
  1874             88  CLAIM-DENIED           VALUE '2'.
  1875             88  AUTO-CLOSE             VALUE '3'.
  1876             88  MANUAL-CLOSE           VALUE '4'.
  1877             88  BENEFITS-CHANGED       VALUE 'C'.
  1878             88  SETUP-ERRORS           VALUE 'E'.
  1879         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1880         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1881         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1882             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1883         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1884         16  FILLER                  PIC X.
  1885
  1886     12  CL-CERTIFICATE-DATA.
  1887         16  CL-CERT-ORIGIN          PIC X.
  1888             88  CERT-WAS-ONLINE        VALUE '1'.
  1889             88  CERT-WAS-CREATED       VALUE '2'.
  1890             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1891         16  CL-CERT-KEY-DATA.
  1892             20  CL-CERT-CARRIER     PIC X.
  1893             20  CL-CERT-GROUPING    PIC X(6).
  1894             20  CL-CERT-STATE       PIC XX.
  1895             20  CL-CERT-ACCOUNT.
  1896                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1897                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1898             20  CL-CERT-EFF-DT      PIC XX.
  1899
  1900     12  CL-STATUS-CONTROLS.
  1901         16  CL-PRIORITY-CD          PIC X.
  1902             88  CONFIDENTIAL-DATA      VALUE '8'.
  1903             88  HIGHEST-PRIORITY       VALUE '9'.
  1904         16  CL-SUPV-ATTN-CD         PIC X.
  1905             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  1906             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1907         16  CL-PURGED-DT            PIC XX.
  1908         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  40
* EL162.cbl
  1909         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1910         16  CL-NEXT-RESEND-DT       PIC XX.
  1911         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1912         16  CL-CRITICAL-PERIOD      PIC 99.
  1913*        16  FILLER                  PIC XX.
  1914         16  CL-LAST-MAINT-DT        PIC XX.
  1915         16  CL-LAST-MAINT-USER      PIC X(4).
  1916         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  1917         16  CL-LAST-MAINT-TYPE      PIC X.
  1918             88  CLAIM-SET-UP           VALUE ' '.
  1919             88  PAYMENT-MADE           VALUE '1'.
  1920             88  LETTER-SENT            VALUE '2'.
  1921             88  MASTER-WAS-ALTERED     VALUE '3'.
  1922             88  MASTER-WAS-RESTORED    VALUE '4'.
  1923             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1924             88  FILE-CONVERTED         VALUE '6'.
  1925             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1926             88  ERROR-CORRECTION       VALUE 'E'.
  1927         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1928         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1929         16  CL-BENEFICIARY          PIC X(10).
  1930         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1931         16  CL-DENIAL-TYPE          PIC X.
  1932             88  CL-TYPE-DENIAL          VALUE '1'.
  1933             88  CL-TYPE-RESCISSION      VALUE '2'.
  1934             88  CL-TYPE-REFORMATION     VALUE '3'.
  1935             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1936             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1937         16  filler                  pic x(5).
  1938*        16  CL-CRIT-PER-RECURRENT   PIC X.
  1939*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  1940*        16  CL-RTW-DT               PIC XX.
  1941
  1942     12  CL-TRAILER-CONTROLS.
  1943         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1944             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1945             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1946             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1947         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1948         16  FILLER                  PIC XX.
  1949         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1950         16  CL-ADDRESS-TRAILER-CNT.
  1951             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1952                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1953             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1954                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1955             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1956                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1957             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1958                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1959             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1960                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1961             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1962                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  1963             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1964                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1965
  1966     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  41
* EL162.cbl
  1967         16  CL-CV-REFNO-PRIME       PIC X(18).
  1968         16  CL-CV-REFNO-SFX         PIC XX.
  1969
  1970     12  CL-FILE-LOCATION            PIC X(4).
  1971
  1972     12  CL-PROCESS-ERRORS.
  1973         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1974             88  NO-FATAL-ERRORS        VALUE ZERO.
  1975         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1976             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1977
  1978     12  CL-PRODUCT-CD               PIC X.
  1979
  1980     12  CL-CURRENT-KEY-DATA.
  1981         16  CL-CURRENT-CARRIER      PIC X.
  1982         16  CL-CURRENT-GROUPING     PIC X(6).
  1983         16  CL-CURRENT-STATE        PIC XX.
  1984         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1985
  1986     12  CL-ASSOCIATES               PIC X.
  1987         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1988         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1989         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1990         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1991
  1992     12  CL-ACTIVITY-CODE            PIC 99.
  1993     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1994     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  1995
  1996     12  CL-LAPSE-REPORT-CODE        PIC 9.
  1997     12  CL-LAG-REPORT-CODE          PIC 9.
  1998     12  CL-LOAN-TYPE                PIC XX.
  1999     12  CL-LEGAL-STATE              PIC XX.
  2000
  2001     12  CL-YESNOSW                  PIC X.
  2002     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  2003         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  2004         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  2005         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  2006     12  cl-insured-type             pic x.
  2007         88  cl-claim-on-primary         value 'P'.
  2008         88  cl-claim-on-co-borrower     value 'C'.
  2009     12  cl-benefit-expiration-dt    PIC XX.
  2010
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  42
* EL162.cbl
  2012*                            COPY ELCTRLR.
  2013******************************************************************
  2014*                                                                *
  2015*                            ELCTRLR.                            *
  2016*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2017*                            VMOD=2.014                          *
  2018*                                                                *
  2019*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  2020*                                                                *
  2021*   FILE TYPE = VSAM,KSDS                                        *
  2022*   RECORD SIZE = 200    RECFORM = FIXED                         *
  2023*                                                                *
  2024*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  2025*       ALTERNATE INDEX = NONE                                   *
  2026*                                                                *
  2027*   LOG = YES                                                    *
  2028*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2029******************************************************************
  2030*                   C H A N G E   L O G
  2031*
  2032* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2033*-----------------------------------------------------------------
  2034*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2035* EFFECTIVE    NUMBER
  2036*-----------------------------------------------------------------
  2037* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  2038* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  2039* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  2040* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  2041* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  2042* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  2043* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  2044* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  2045* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  2046* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  2047* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  2048* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  2049* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  2050* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  2051* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  2052* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2053* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  2054* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  2055* 040814    2014030500002  AJRA  ADD ICD CODES
  2056* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2057* 013017  CR2016053100001  PEMA  ACH PROCESSING
  2058* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  2059******************************************************************
  2060 01  ACTIVITY-TRAILERS.
  2061     12  AT-RECORD-ID                    PIC XX.
  2062         88  VALID-AT-ID                       VALUE 'AT'.
  2063
  2064     12  AT-CONTROL-PRIMARY.
  2065         16  AT-COMPANY-CD               PIC X.
  2066         16  AT-CARRIER                  PIC X.
  2067         16  AT-CLAIM-NO                 PIC X(7).
  2068         16  AT-CERT-NO.
  2069             20  AT-CERT-PRIME           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  43
* EL162.cbl
  2070             20  AT-CERT-SFX             PIC X.
  2071         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  2072             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  2073             88  AT-LAST-TRL-AVAIL            VALUE +100.
  2074             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  2075             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  2076             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  2077             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  2078             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  2079             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  2080             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  2081             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  2082             88  AT-DIAGNOSIS-TRL             VALUE +90.
  2083             88  AT-BENEFICIARY-TRL           VALUE +91.
  2084             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  2085             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  2086             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  2087             88  AT-ERROR-MSGS-TRL            VALUE +95.
  2088
  2089     12  AT-TRAILER-TYPE                 PIC X.
  2090         88  RESERVE-EXPENSE-TR               VALUE '1'.
  2091         88  PAYMENT-TR                       VALUE '2'.
  2092         88  AUTO-PAY-TR                      VALUE '3'.
  2093         88  CORRESPONDENCE-TR                VALUE '4'.
  2094         88  ADDRESS-TR                       VALUE '5'.
  2095         88  GENERAL-INFO-TR                  VALUE '6'.
  2096         88  AUTO-PROMPT-TR                   VALUE '7'.
  2097         88  DENIAL-TR                        VALUE '8'.
  2098         88  INCURRED-CHG-TR                  VALUE '9'.
  2099         88  FORM-CONTROL-TR                  VALUE 'A'.
  2100
  2101     12  AT-RECORDED-DT                  PIC XX.
  2102     12  AT-RECORDED-BY                  PIC X(4).
  2103     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  2104
  2105     12  AT-TRAILER-BODY                 PIC X(165).
  2106
  2107     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  2108         16  AT-RESERVE-CONTROLS.
  2109             20  AT-MANUAL-SW            PIC X.
  2110                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  2111             20  AT-FUTURE-SW            PIC X.
  2112                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  2113             20  AT-PTC-SW               PIC X.
  2114                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  2115             20  AT-IBNR-SW              PIC X.
  2116                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  2117             20  AT-PTC-LF-SW            PIC X.
  2118                 88  AT-LF-PTC-USED          VALUE '1'.
  2119             20  AT-CDT-ACCESS-METHOD    PIC X.
  2120                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  2121                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  2122                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  2123             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  2124         16  AT-LAST-COMPUTED-DT         PIC XX.
  2125         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  2126         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  2127         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  44
* EL162.cbl
  2128         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  2129         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  2130         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  2131         16  AT-EXPENSE-CONTROLS.
  2132             20  AT-EXPENSE-METHOD       PIC X.
  2133                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  2134                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  2135                 88  PERCENT-OF-PMT           VALUE '3'.
  2136                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  2137             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  2138             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  2139         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  2140         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  2141
  2142         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  2143         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  2144
  2145*        16  FILLER                      PIC X(53).
  2146         16  FILLER                      PIC X(47).
  2147
  2148         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  2149         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  2150
  2151         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  2152             20  AT-OPEN-CLOSE-DATE      PIC XX.
  2153             20  AT-OPEN-CLOSE-TYPE      PIC X.
  2154*                    C = CLOSED
  2155*                    O = OPEN
  2156             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  2157*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  2158
  2159     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  2160         16  AT-PAYMENT-TYPE             PIC X.
  2161             88  PARTIAL-PAYMENT                VALUE '1'.
  2162             88  FINAL-PAYMENT                  VALUE '2'.
  2163             88  LUMP-SUM-PAYMENT               VALUE '3'.
  2164             88  ADDITIONAL-PAYMENT             VALUE '4'.
  2165             88  CHARGEABLE-EXPENSE             VALUE '5'.
  2166             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  2167             88  VOIDED-PAYMENT                 VALUE '9'.
  2168             88  TRANSFER                       VALUE 'T'.
  2169             88  LIFE-INTEREST                  VALUE 'I'.
  2170
  2171         16  AT-CLAIM-TYPE               PIC X.
  2172             88  PAID-FOR-AH                    VALUE 'A'.
  2173             88  PAID-FOR-LIFE                  VALUE 'L'.
  2174             88  PAID-FOR-IUI                   VALUE 'I'.
  2175             88  PAID-FOR-GAP                   VALUE 'G'.
  2176             88  PAID-FOR-FAM                   VALUE 'F'.
  2177         16  AT-CLAIM-PREM-TYPE          PIC X.
  2178             88  AT-SINGLE-PREMIUM              VALUE '1'.
  2179             88  AT-O-B-COVERAGE                VALUE '2'.
  2180             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  2181         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  2182         16  AT-CHECK-NO                 PIC X(7).
  2183         16  AT-PAID-FROM-DT             PIC XX.
  2184         16  AT-PAID-THRU-DT             PIC XX.
  2185         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  45
* EL162.cbl
  2186         16  AT-ACH-PAYMENT              PIC X.
  2187*        16  FILLER                      PIC X.
  2188         16  AT-PAYEES-NAME              PIC X(30).
  2189         16  AT-PAYMENT-ORIGIN           PIC X.
  2190             88  ONLINE-MANUAL-PMT              VALUE '1'.
  2191             88  ONLINE-AUTO-PMT                VALUE '2'.
  2192             88  OFFLINE-PMT                    VALUE '3'.
  2193         16  AT-CHECK-WRITTEN-DT         PIC XX.
  2194         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  2195         16  AT-VOID-DATA.
  2196             20  AT-VOID-DT              PIC XX.
  2197*00144       20  AT-VOID-REASON          PIC X(30).
  2198             20  AT-VOID-REASON          PIC X(26).
  2199         16  AT-PMT-APPROVED-BY          PIC X(04).
  2200         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  2201         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  2202         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  2203                                         PIC S99V9(5)  COMP-3.
  2204         16  AT-CREDIT-INTERFACE.
  2205             20  AT-PMT-SELECT-DT        PIC XX.
  2206                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  2207             20  AT-PMT-ACCEPT-DT        PIC XX.
  2208                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  2209             20  AT-VOID-SELECT-DT       PIC XX.
  2210                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  2211             20  AT-VOID-ACCEPT-DT       PIC XX.
  2212                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  2213
  2214         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  2215                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  2216                 88  CONVERSION-PAYMENT           VALUE +99999999.
  2217         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  2218
  2219         16  AT-FORCE-CONTROL            PIC X.
  2220             88  PAYMENT-WAS-FORCED           VALUE '1'.
  2221         16  AT-PREV-LAST-PMT-DT         PIC XX.
  2222         16  AT-PREV-PAID-THRU-DT        PIC XX.
  2223         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  2224         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  2225         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  2226         16  AT-BENEFIT-TYPE             PIC X.
  2227
  2228         16  AT-EXPENSE-TYPE             PIC X.
  2229         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  2230
  2231         16  AT-PAYEE-TYPE-CD.
  2232             20  AT-PAYEE-TYPE           PIC X.
  2233                 88  INSURED-PAID           VALUE 'I'.
  2234                 88  BENEFICIARY-PAID       VALUE 'B'.
  2235                 88  ACCOUNT-PAID           VALUE 'A'.
  2236                 88  OTHER-1-PAID           VALUE 'O'.
  2237                 88  OTHER-2-PAID           VALUE 'Q'.
  2238                 88  DOCTOR-PAID            VALUE 'P'.
  2239                 88  EMPLOYER-PAID          VALUE 'E'.
  2240             20  AT-PAYEE-SEQ            PIC X.
  2241
  2242         16  AT-CASH-PAYMENT             PIC X.
  2243         16  AT-GROUPED-PAYMENT          PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  46
* EL162.cbl
  2244         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  2245         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  2246         16  AT-APPROVED-LEVEL           PIC X.
  2247         16  AT-VOID-TYPE                PIC X.
  2248             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  2249             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  2250         16  AT-AIG-UNEMP-IND            PIC X.
  2251             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  2252         16  AT-ASSOCIATES               PIC X.
  2253             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  2254             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  2255
  2256         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  2257         16  AT-CV-PMT-CODE              PIC X.
  2258             88  FULL-DEATH-PAYMENT         VALUE '1'.
  2259             88  HALF-DEATH-PAYMENT         VALUE '2'.
  2260             88  FULL-ADD-PAYMENT           VALUE '3'.
  2261             88  HALF-ADD-PAYMENT           VALUE '4'.
  2262             88  FULL-RIDER-PAYMENT         VALUE '5'.
  2263             88  HALF-RIDER-PAYMENT         VALUE '6'.
  2264             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  2265             88  ADDL-PAYMENT               VALUE '8'.
  2266
  2267         16  AT-EOB-CODE1                PIC XXX.
  2268         16  AT-EOB-CODE2                PIC XXX.
  2269         16  AT-EOB-CODE3                PIC XXX.
  2270         16  FILLER REDEFINES AT-EOB-CODE3.
  2271             20  AT-PRINT-CLM-FORM       PIC X.
  2272             20  AT-PRINT-SURVEY         PIC X.
  2273             20  AT-SPECIAL-RELEASE      PIC X.
  2274         16  AT-EOB-CODE4                PIC XXX.
  2275         16  FILLER REDEFINES AT-EOB-CODE4.
  2276             20  AT-INT-PMT-SELECT-DT    PIC XX.
  2277             20  FILLER                  PIC X.
  2278         16  AT-EOB-CODE5                PIC XXX.
  2279         16  FILLER REDEFINES AT-EOB-CODE5.
  2280             20  AT-PMT-PROOF-DT         PIC XX.
  2281             20  FILLER                  PIC X.
  2282
  2283         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  2284             88  AT-PRINT-EOB            VALUE 'Y'.
  2285
  2286         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  2287         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  2288
  2289     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  2290         16  AT-SCHEDULE-START-DT        PIC XX.
  2291         16  AT-SCHEDULE-END-DT          PIC XX.
  2292         16  AT-TERMINATED-DT            PIC XX.
  2293         16  AT-LAST-PMT-TYPE            PIC X.
  2294             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  2295             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  2296         16  AT-FIRST-PMT-DATA.
  2297             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  2298             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  2299             20  AT-1ST-PAY-THRU-DT      PIC XX.
  2300         16  AT-REGULAR-PMT-DATA.
  2301             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  47
* EL162.cbl
  2302             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  2303             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  2304         16  AT-AUTO-PAYEE-CD.
  2305             20  AT-AUTO-PAYEE-TYPE      PIC X.
  2306                 88  INSURED-PAID-AUTO      VALUE 'I'.
  2307                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  2308                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  2309                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  2310                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  2311             20  AT-AUTO-PAYEE-SEQ       PIC X.
  2312         16  AT-AUTO-PAY-DAY             PIC 99.
  2313         16  AT-AUTO-CASH                PIC X.
  2314             88  AT-CASH                      VALUE 'Y'.
  2315             88  AT-NON-CASH                  VALUE 'N'.
  2316*        16  FILLER                      PIC X(129).
  2317         16  AT-AUTO-END-LETTER          PIC X(4).
  2318         16  FILLER                      PIC X(125).
  2319
  2320         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  2321         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  2322
  2323     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  2324         16  AT-LETTER-SENT-DT           PIC XX.
  2325         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  2326         16  AT-AUTO-RE-SEND-DT          PIC XX.
  2327         16  AT-LETTER-ANSWERED-DT       PIC XX.
  2328         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  2329         16  AT-LETTER-ORIGIN            PIC X.
  2330             88  ONLINE-CREATION              VALUE '1' '3'.
  2331             88  OFFLINE-CREATION             VALUE '2' '4'.
  2332             88  NAPER-ONLINE-CREATION        VALUE '3'.
  2333             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  2334         16  AT-STD-LETTER-FORM          PIC X(4).
  2335         16  AT-REASON-TEXT              PIC X(70).
  2336         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  2337         16  AT-ADDRESEE-TYPE            PIC X.
  2338              88  INSURED-ADDRESEE            VALUE 'I'.
  2339              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  2340              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  2341              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  2342              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  2343              88  OTHER-ADDRESEE-1            VALUE 'O'.
  2344              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  2345         16  AT-ADDRESSEE-NAME           PIC X(30).
  2346         16  AT-INITIAL-PRINT-DATE       PIC XX.
  2347         16  AT-RESEND-PRINT-DATE        PIC XX.
  2348         16  AT-CORR-SOL-UNSOL           PIC X.
  2349         16  AT-LETTER-PURGED-DT         PIC XX.
  2350*
  2351*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  2352*
  2353         16  AT-CSO-REDEFINITION.
  2354             20  AT-RESEND-LETTER-FORM   PIC X(4).
  2355             20  AT-AUTO-CLOSE-IND       PIC X(1).
  2356             20  AT-LETTER-TO-BENE       PIC X(1).
  2357             20  AT-STOP-LETTER-DT       PIC X(2).
  2358             20  AT-AUTH-RCVD            PIC X(1).
  2359             20  FILLER                  PIC X(18).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  48
* EL162.cbl
  2360*             20  FILLER                  PIC X(27).
  2361             20  AT-CSO-LETTER-STATUS    PIC X.
  2362                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  2363                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  2364                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  2365             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  2366             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  2367*
  2368*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  2369*
  2370*        16  FILLER                      PIC X(26).
  2371*
  2372*        16  AT-DMD-BSR-CODE             PIC X.
  2373*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  2374*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  2375*
  2376*        16  AT-DMD-LETTER-STATUS        PIC X.
  2377*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  2378*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  2379*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  2380*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  2381*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  2382
  2383         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  2384         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  2385
  2386     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  2387         16  AT-ADDRESS-TYPE             PIC X.
  2388             88  INSURED-ADDRESS               VALUE 'I'.
  2389             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  2390             88  ACCOUNT-ADDRESS               VALUE 'A'.
  2391             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  2392             88  EMPLOYER-ADDRESS              VALUE 'E'.
  2393             88  OTHER-ADDRESS-1               VALUE 'O'.
  2394             88  OTHER-ADDRESS-2               VALUE 'Q'.
  2395         16  AT-MAIL-TO-NAME             PIC X(30).
  2396         16  AT-ADDRESS-LINE-1           PIC X(30).
  2397         16  AT-ADDRESS-LINE-2           PIC X(30).
  2398         16  AT-CITY-STATE.
  2399             20  AT-CITY                 PIC X(28).
  2400             20  AT-STATE                PIC XX.
  2401         16  AT-ZIP.
  2402             20  AT-ZIP-CODE.
  2403                 24  AT-ZIP-1ST          PIC X.
  2404                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2405                 24  FILLER              PIC X(4).
  2406             20  AT-ZIP-PLUS4            PIC X(4).
  2407         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  2408             20  AT-CAN-POSTAL-1         PIC XXX.
  2409             20  AT-CAN-POSTAL-2         PIC XXX.
  2410             20  FILLER                  PIC XXX.
  2411         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  2412*         16  FILLER                      PIC X(23).
  2413         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  2414         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  2415         16  FILLER                      PIC X(13).
  2416         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  2417         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  49
* EL162.cbl
  2418
  2419     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  2420         16  AT-INFO-LINE-1              PIC X(60).
  2421         16  FILLER REDEFINES AT-INFO-LINE-1.
  2422             20  AT-NOTE-ERROR-NO OCCURS 15
  2423                                         PIC X(4).
  2424         16  AT-INFO-LINE-2              PIC X(60).
  2425         16  FILLER REDEFINES AT-INFO-LINE-2.
  2426             20  AT-ICD-CODE-1           PIC X(8).
  2427             20  AT-ICD-CODE-2           PIC X(8).
  2428             20  FILLER                  PIC X(44).
  2429         16  AT-INFO-TRAILER-TYPE        PIC X.
  2430             88  AT-ERRORS-NOTE          VALUE 'E'.
  2431             88  AT-PAYMENT-NOTE         VALUE 'P'.
  2432             88  AT-CALL-NOTE            VALUE 'C'.
  2433             88  AT-MAINT-NOTE           VALUE 'M'.
  2434             88  AT-CERT-CHANGE          VALUE 'X'.
  2435             88  AT-APPROVAL-NOTE        VALUE 'R'.
  2436             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  2437             88  AT-CERT-CANCELLED       VALUE 'T'.
  2438         16  AT-CALL-TYPE                PIC X.
  2439             88  AT-PHONE-CALL-IN        VALUE 'I'.
  2440             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  2441         16  AT-NOTE-CONTINUATION        PIC X.
  2442             88  AT-CONTINUED-NOTE       VALUE 'X'.
  2443         16  AT-EOB-CODES-EXIST          PIC X.
  2444             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  2445         16  FILLER                      PIC X(35).
  2446         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  2447         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  2448
  2449     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  2450         16  AT-PROMPT-LINE-1            PIC X(60).
  2451         16  AT-PROMPT-LINE-2            PIC X(60).
  2452         16  AT-PROMPT-START-DT          PIC XX.
  2453         16  AT-PROMPT-END-DT            PIC XX.
  2454         16  FILLER                      PIC X(35).
  2455         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  2456         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  2457
  2458     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  2459         16  AT-DENIAL-INFO-1            PIC X(60).
  2460         16  AT-DENIAL-INFO-2            PIC X(60).
  2461         16  AT-DENIAL-DT                PIC XX.
  2462         16  AT-RETRACTION-DT            PIC XX.
  2463         16  AT-DENIAL-REASON-CODE       PIC X(4).
  2464*         16  FILLER                      PIC X(31).
  2465         16  AT-DENIAL-PROOF-DT          PIC XX.
  2466         16  FILLER                      PIC X(29).
  2467         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  2468         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  2469
  2470     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  2471         16  AT-OLD-INCURRED-DT          PIC XX.
  2472         16  AT-OLD-REPORTED-DT          PIC XX.
  2473         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  2474         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  2475         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  50
* EL162.cbl
  2476         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  2477         16  AT-OLD-PAID-THRU-DT         PIC XX.
  2478         16  AT-LAST-PMT-MADE-DT         PIC XX.
  2479         16  FILLER                      PIC X(26).
  2480         16  AT-OLD-DIAG-CODE            PIC X(6).
  2481         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  2482         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  2483         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  2484         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  2485         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  2486         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  2487         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  2488         16  AT-OLD-ICD-CODE-1           PIC X(8).
  2489         16  AT-OLD-ICD-CODE-2           PIC X(8).
  2490         16  FILLER                      PIC X(9).
  2491         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  2492
  2493     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  2494         16  AT-FORM-SEND-ON-DT          PIC XX.
  2495         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  2496         16  AT-FORM-RE-SEND-DT          PIC XX.
  2497         16  AT-FORM-ANSWERED-DT         PIC XX.
  2498         16  AT-FORM-PRINTED-DT          PIC XX.
  2499         16  AT-FORM-REPRINT-DT          PIC XX.
  2500         16  AT-FORM-TYPE                PIC X.
  2501             88  INITIAL-FORM                  VALUE '1'.
  2502             88  PROGRESS-FORM                 VALUE '2'.
  2503         16  AT-INSTRUCT-LN-1            PIC X(28).
  2504         16  AT-INSTRUCT-LN-2            PIC X(28).
  2505         16  AT-INSTRUCT-LN-3            PIC X(28).
  2506         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  2507         16  AT-FORM-ADDRESS             PIC X.
  2508             88  FORM-TO-INSURED              VALUE 'I'.
  2509             88  FORM-TO-ACCOUNT              VALUE 'A'.
  2510             88  FORM-TO-OTHER-1              VALUE 'O'.
  2511             88  FORM-TO-OTHER-2              VALUE 'Q'.
  2512         16  AT-RELATED-1.
  2513             20 AT-REL-CARR-1            PIC X.
  2514             20 AT-REL-CLAIM-1           PIC X(7).
  2515             20 AT-REL-CERT-1            PIC X(11).
  2516         16  AT-RELATED-2.
  2517             20 AT-REL-CARR-2            PIC X.
  2518             20 AT-REL-CLAIM-2           PIC X(7).
  2519             20 AT-REL-CERT-2            PIC X(11).
  2520         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  2521         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  2522         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  2523         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  2524         16  AT-FORM-REM-PRINT-DT        PIC XX.
  2525         16  AT-STOP-FORM-DT             PIC X(2).
  2526
  2527         16  FILLER                      PIC X(09).
  2528         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  2529         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  2530******************************************************************
  2531
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  51
* EL162.cbl
  2533*                            COPY ERCACCT.
  2534******************************************************************
  2535*                                                                *
  2536*                                                                *
  2537*                            ERCACCT                             *
  2538*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2539*                            VMOD=2.031                          *
  2540*                                                                *
  2541*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2542*                                                                *
  2543*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2544*   VSAM ACCOUNT MASTER FILES.                                   *
  2545*                                                                *
  2546*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2547*                                                                *
  2548*   FILE TYPE = VSAM,KSDS                                        *
  2549*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2550*                                                                *
  2551*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2552*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2553*                                                                *
  2554*   LOG = NO                                                     *
  2555*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2556*                                                                *
  2557*                                                                *
  2558******************************************************************
  2559*                   C H A N G E   L O G
  2560*
  2561* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2562*-----------------------------------------------------------------
  2563*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2564* EFFECTIVE    NUMBER
  2565*-----------------------------------------------------------------
  2566* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2567* 092705    2005050300006  PEMA  ADD SPP LEASES
  2568* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2569* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2570* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2571* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2572* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2573* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2574******************************************************************
  2575
  2576 01  ACCOUNT-MASTER.
  2577     12  AM-RECORD-ID                      PIC XX.
  2578         88  VALID-AM-ID                      VALUE 'AM'.
  2579
  2580     12  AM-CONTROL-PRIMARY.
  2581         16  AM-COMPANY-CD                 PIC X.
  2582         16  AM-MSTR-CNTRL.
  2583             20  AM-CONTROL-A.
  2584                 24  AM-CARRIER            PIC X.
  2585                 24  AM-GROUPING.
  2586                     28 AM-GROUPING-PREFIX PIC XXX.
  2587                     28 AM-GROUPING-PRIME  PIC XXX.
  2588                 24  AM-STATE              PIC XX.
  2589                 24  AM-ACCOUNT.
  2590                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  52
* EL162.cbl
  2591                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2592             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2593                                           PIC X(19).
  2594             20  AM-CNTRL-B.
  2595                 24  AM-EXPIRATION-DT      PIC XX.
  2596                 24  FILLER                PIC X(4).
  2597             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2598                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2599
  2600     12  AM-CONTROL-BY-VAR-GRP.
  2601         16  AM-COMPANY-CD-A1              PIC X.
  2602         16  AM-VG-CARRIER                 PIC X.
  2603         16  AM-VG-GROUPING                PIC X(6).
  2604         16  AM-VG-STATE                   PIC XX.
  2605         16  AM-VG-ACCOUNT                 PIC X(10).
  2606         16  AM-VG-DATE.
  2607             20  AM-VG-EXPIRATION-DT       PIC XX.
  2608             20  FILLER                    PIC X(4).
  2609         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2610                                           PIC 9(11)      COMP-3.
  2611     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2612         16  FILLER                        PIC X(10).
  2613         16  AM-VG-KEY3.
  2614             20  AM-VG3-ACCOUNT            PIC X(10).
  2615             20  AM-VG3-EXP-DT             PIC XX.
  2616         16  FILLER                        PIC X(4).
  2617     12  AM-MAINT-INFORMATION.
  2618         16  AM-LAST-MAINT-DT              PIC XX.
  2619         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2620         16  AM-LAST-MAINT-USER            PIC X(4).
  2621         16  FILLER                        PIC XX.
  2622
  2623     12  AM-EFFECTIVE-DT                   PIC XX.
  2624     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2625
  2626     12  AM-PREV-DATES  COMP-3.
  2627         16  AM-PREV-EXP-DT                PIC 9(11).
  2628         16  AM-PREV-EFF-DT                PIC 9(11).
  2629
  2630     12  AM-REPORT-CODE-1                  PIC X(10).
  2631     12  AM-REPORT-CODE-2                  PIC X(10).
  2632
  2633     12  AM-CITY-CODE                      PIC X(4).
  2634     12  AM-COUNTY-PARISH                  PIC X(6).
  2635
  2636     12  AM-NAME                           PIC X(30).
  2637     12  AM-PERSON                         PIC X(30).
  2638     12  AM-ADDRS                          PIC X(30).
  2639     12  AM-CITY.
  2640         16  AM-ADDR-CITY                  PIC X(28).
  2641         16  AM-ADDR-STATE                 PIC XX.
  2642     12  AM-ZIP.
  2643         16  AM-ZIP-PRIME.
  2644             20  AM-ZIP-PRI-1ST            PIC X.
  2645                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2646             20  FILLER                    PIC X(4).
  2647         16  AM-ZIP-PLUS4                  PIC X(4).
  2648     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  53
* EL162.cbl
  2649         16  AM-CAN-POSTAL-1               PIC XXX.
  2650         16  AM-CAN-POSTAL-2               PIC XXX.
  2651         16  FILLER                        PIC XXX.
  2652     12  AM-TEL-NO.
  2653         16  AM-AREA-CODE                  PIC 999.
  2654         16  AM-TEL-PRE                    PIC 999.
  2655         16  AM-TEL-NBR                    PIC 9(4).
  2656     12  AM-TEL-LOC                        PIC X.
  2657         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2658         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2659
  2660     12  AM-COMM-STRUCTURE.
  2661         16  AM-DEFN-1.
  2662             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2663                 24  AM-AGT.
  2664                     28  AM-AGT-PREFIX     PIC X(4).
  2665                     28  AM-AGT-PRIME      PIC X(6).
  2666                 24  AM-COM-TYP            PIC X.
  2667                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2668                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2669                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2670                 24  AM-RECALC-LV-INDIC    PIC X.
  2671                 24  AM-RETRO-LV-INDIC     PIC X.
  2672                 24  AM-GL-CODES           PIC X.
  2673                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2674                 24  FILLER                PIC X(01).
  2675         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2676             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2677                 24  FILLER                PIC X(11).
  2678                 24  AM-L-COMA             PIC XXX.
  2679                 24  AM-J-COMA             PIC XXX.
  2680                 24  AM-A-COMA             PIC XXX.
  2681                 24  FILLER                PIC X(6).
  2682
  2683     12  AM-COMM-CHANGE-STATUS             PIC X.
  2684         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2685
  2686     12  AM-CSR-CODE                       PIC X(4).
  2687
  2688     12  AM-BILLING-STATUS                 PIC X.
  2689         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2690         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2691     12  AM-AUTO-REFUND-SW                 PIC X.
  2692         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2693         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2694     12  AM-GPCD                           PIC 99.
  2695     12  AM-IG                             PIC X.
  2696         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2697         88  AM-HAS-GROUP                     VALUE '2'.
  2698     12  AM-STATUS                         PIC X.
  2699         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2700         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2701         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2702         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2703         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2704         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2705         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2706         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  54
* EL162.cbl
  2707         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2708         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2709     12  AM-REMIT-TO                       PIC 99.
  2710     12  AM-ID-NO                          PIC X(11).
  2711
  2712     12  AM-CAL-TABLE                      PIC XX.
  2713     12  AM-LF-DEVIATION                   PIC XXX.
  2714     12  AM-AH-DEVIATION                   PIC XXX.
  2715     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2716     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2717     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2718     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2719     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2720     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2721
  2722     12  AM-USER-FIELDS.
  2723         16  AM-FLD-1                      PIC XX.
  2724         16  AM-FLD-2                      PIC XX.
  2725         16  AM-FLD-3                      PIC XX.
  2726         16  AM-FLD-4                      PIC XX.
  2727         16  AM-FLD-5                      PIC XX.
  2728
  2729     12  AM-1ST-PROD-DATE.
  2730         16  AM-1ST-PROD-YR                PIC XX.
  2731         16  AM-1ST-PROD-MO                PIC XX.
  2732         16  AM-1ST-PROD-DA                PIC XX.
  2733     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2734     12  AM-CERTS-PURGED-DATE.
  2735         16  AM-PUR-YR                     PIC XX.
  2736         16  AM-PUR-MO                     PIC XX.
  2737         16  AM-PUR-DA                     PIC XX.
  2738     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2739     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2740     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2741     12  AM-INACTIVE-DATE.
  2742         16  AM-INA-MO                     PIC 99.
  2743         16  AM-INA-DA                     PIC 99.
  2744         16  AM-INA-YR                     PIC 99.
  2745     12  AM-AR-HI-CERT-DATE                PIC XX.
  2746
  2747     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2748     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2749
  2750     12  AM-OB-PAYMENT-MODE                PIC X.
  2751         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2752         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2753         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2754         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2755
  2756     12  AM-AH-ONLY-INDICATOR              PIC X.
  2757         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2758         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2759
  2760     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2761
  2762     12  AM-OVER-SHORT.
  2763         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2764         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  55
* EL162.cbl
  2765
  2766     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2767     12  AM-DCC-CLP-STATE                  PIC XX.
  2768
  2769     12  AM-RECALC-COMM                    PIC X.
  2770     12  AM-RECALC-REIN                    PIC X.
  2771
  2772     12  AM-REI-TABLE                      PIC XXX.
  2773     12  AM-REI-ET-LF                      PIC X.
  2774     12  AM-REI-ET-AH                      PIC X.
  2775     12  AM-REI-PE-LF                      PIC X.
  2776     12  AM-REI-PE-AH                      PIC X.
  2777     12  AM-REI-PRT-ST                     PIC X.
  2778     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2779     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2780     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2781     12  AM-REI-GROUP-A                    PIC X(6).
  2782     12  AM-REI-MORT                       PIC X(4).
  2783     12  AM-REI-PRT-OW                     PIC X.
  2784     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2785     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2786     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2787     12  AM-REI-GROUP-B                    PIC X(6).
  2788
  2789     12  AM-TRUST-TYPE                     PIC X(2).
  2790
  2791     12  AM-EMPLOYER-STMT-USED             PIC X.
  2792     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2793
  2794     12  AM-STD-AH-TYPE                    PIC XX.
  2795     12  AM-EARN-METHODS.
  2796         16  AM-EARN-METHOD-R              PIC X.
  2797             88 AM-REF-RL-R78                 VALUE 'R'.
  2798             88 AM-REF-RL-PR                  VALUE 'P'.
  2799             88 AM-REF-RL-MEAN                VALUE 'M'.
  2800             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2801         16  AM-EARN-METHOD-L              PIC X.
  2802             88 AM-REF-LL-R78                 VALUE 'R'.
  2803             88 AM-REF-LL-PR                  VALUE 'P'.
  2804             88 AM-REF-LL-MEAN                VALUE 'M'.
  2805             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2806         16  AM-EARN-METHOD-A              PIC X.
  2807             88 AM-REF-AH-R78                 VALUE 'R'.
  2808             88 AM-REF-AH-PR                  VALUE 'P'.
  2809             88 AM-REF-AH-MEAN                VALUE 'M'.
  2810             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2811             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2812             88 AM-REF-AH-NET                 VALUE 'N'.
  2813
  2814     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2815     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2816     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2817
  2818     12  AM-RET-Y-N                        PIC X.
  2819     12  AM-RET-P-E                        PIC X.
  2820     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2821     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2822     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  56
* EL162.cbl
  2823     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2824         16  AM-POOL-PRIME                 PIC XXX.
  2825         16  AM-POOL-SUB                   PIC XXX.
  2826     12  AM-RETRO-EARNINGS.
  2827         16  AM-RET-EARN-R                 PIC X.
  2828         16  AM-RET-EARN-L                 PIC X.
  2829         16  AM-RET-EARN-A                 PIC X.
  2830     12  AM-RET-ST-TAX-USE                 PIC X.
  2831         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2832         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2833     12  AM-RETRO-BEG-EARNINGS.
  2834         16  AM-RET-BEG-EARN-R             PIC X.
  2835         16  AM-RET-BEG-EARN-L             PIC X.
  2836         16  AM-RET-BEG-EARN-A             PIC X.
  2837     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2838     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2839
  2840     12  AM-USER-SELECT-OPTIONS.
  2841         16  AM-USER-SELECT-1              PIC X(10).
  2842         16  AM-USER-SELECT-2              PIC X(10).
  2843         16  AM-USER-SELECT-3              PIC X(10).
  2844         16  AM-USER-SELECT-4              PIC X(10).
  2845         16  AM-USER-SELECT-5              PIC X(10).
  2846
  2847     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2848
  2849     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2850
  2851     12  AM-RPT045A-SWITCH                 PIC X.
  2852         88  RPT045A-OFF                   VALUE 'N'.
  2853
  2854     12  AM-INSURANCE-LIMITS.
  2855         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2856         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2857
  2858     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2859         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2860
  2861     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2862         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2863         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2864
  2865     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2866
  2867     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2868     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2869     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2870     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2871     12  AM-DCC-UEF-STATE                  PIC XX.
  2872     12  FILLER                            PIC XXX.
  2873     12  AM-REPORT-CODE-3                  PIC X(10).
  2874*    12  FILLER                            PIC X(22).
  2875
  2876     12  AM-RESERVE-DATE.
  2877         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2878         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2879         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2880
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  57
* EL162.cbl
  2881     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2882     12  AM-NOTIFICATION-TYPES.
  2883         16  AM-NOTIF-OF-LETTERS           PIC X.
  2884         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2885         16  AM-NOTIF-OF-REPORTS           PIC X.
  2886         16  AM-NOTIF-OF-STATUS            PIC X.
  2887
  2888     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2889         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2890         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2891         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2892         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2893
  2894     12  AM-BENEFIT-CONTROLS.
  2895         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2896             20  AM-BENEFIT-CODE           PIC XX.
  2897             20  AM-BENEFIT-TYPE           PIC X.
  2898             20  AM-BENEFIT-REVISION       PIC XXX.
  2899             20  AM-BENEFIT-REM-TERM       PIC X.
  2900             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2901             20  FILLER                    PIC XX.
  2902         16  FILLER                        PIC X(80).
  2903
  2904     12  AM-TRANSFER-DATA.
  2905         16  AM-TRANSFERRED-FROM.
  2906             20  AM-TRNFROM-CARRIER        PIC X.
  2907             20  AM-TRNFROM-GROUPING.
  2908                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2909                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2910             20  AM-TRNFROM-STATE          PIC XX.
  2911             20  AM-TRNFROM-ACCOUNT.
  2912                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2913                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2914             20  AM-TRNFROM-DTE            PIC XX.
  2915         16  AM-TRANSFERRED-TO.
  2916             20  AM-TRNTO-CARRIER          PIC X.
  2917             20  AM-TRNTO-GROUPING.
  2918                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2919                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2920             20  AM-TRNTO-STATE            PIC XX.
  2921             20  AM-TRNTO-ACCOUNT.
  2922                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2923                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2924             20  AM-TRNTO-DTE              PIC XX.
  2925         16  FILLER                        PIC X(10).
  2926
  2927     12  AM-SAVED-REMIT-TO                 PIC 99.
  2928
  2929     12  AM-COMM-STRUCTURE-SAVED.
  2930         16  AM-DEFN-1-SAVED.
  2931             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2932                 24  AM-AGT-SV             PIC X(10).
  2933                 24  AM-COM-TYP-SV         PIC X.
  2934                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2935                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2936                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2937                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2938                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  58
* EL162.cbl
  2939                 24  AM-GL-CODES-SV        PIC X.
  2940                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2941                 24  FILLER                PIC X.
  2942         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2943             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2944                 24  FILLER                PIC X(11).
  2945                 24  AM-L-COMA-SV          PIC XXX.
  2946                 24  AM-J-COMA-SV          PIC XXX.
  2947                 24  AM-A-COMA-SV          PIC XXX.
  2948                 24  FILLER                PIC X(6).
  2949
  2950     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2951         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2952            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2953            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2954            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2955
  2956     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2957     12  FILLER                            PIC X(120).
  2958
  2959     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2960         16  AM-CONTROL-NAME               PIC X(30).
  2961         16  AM-EXECUTIVE-ONE.
  2962             20  AM-EXEC1-NAME             PIC X(15).
  2963             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2964                                                          COMP-3.
  2965             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2966                                                          COMP-3.
  2967         16  AM-EXECUTIVE-TWO.
  2968             20  AM-EXEC2-NAME             PIC X(15).
  2969             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2970                                                          COMP-3.
  2971             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2972                                                          COMP-3.
  2973
  2974     12  AM-RETRO-ADDITIONAL-DATA.
  2975         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2976         16  AM-RETRO-PREM-P-E             PIC X.
  2977         16  AM-RETRO-CLMS-P-I             PIC X.
  2978         16  AM-RETRO-RET-BRACKET-LF.
  2979             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2980                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2981                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2982             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2983                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2984                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2985             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2986                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2987                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2988         16  AM-RETRO-RET-BRACKET-AH.
  2989             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2990                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2991                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2992                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2993             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2994                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2995                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2996             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  59
* EL162.cbl
  2997                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2998                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2999
  3000     12  AM-COMMENTS.
  3001         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3002
  3003     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3004         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3005         16  AM-FLI-BILLING-CODE           PIC X.
  3006         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3007         16  AM-FLI-UNITED-IDENT           PIC X.
  3008         16  AM-FLI-INTEREST-LOST-DATA.
  3009             20  AM-FLI-BANK-NO            PIC X(5).
  3010             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3011             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3012             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3013         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3014             20  AM-FLI-AGT                PIC X(9).
  3015             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3016             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3017         16  FILLER                        PIC X(102).
  3018
  3019     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3020         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3021             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3022             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3023             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3024             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3025             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3026         16  FILLER                          PIC X(10).
  3027******************************************************************
  3028
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  60
* EL162.cbl
  3030 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  3031                          ACTIVITY-TRAILERS ACCOUNT-MASTER.
  3032 0000-DFHEXIT SECTION.
  3033     MOVE '9#                    $   ' TO DFHEIV0.
  3034     MOVE 'EL162' TO DFHEIV1.
  3035     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3036
  3037     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  3038     MOVE '5'                   TO DC-OPTION-CODE.
  3039     PERFORM 9700-DATE-LINK.
  3040     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  3041     MOVE DC-BIN-DATE-1         TO  BIN-CURRENT-DATE.
  3042
  3043     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  3044
  3045     IF PI-COMPANY-ID = 'DMD'
  3046         MOVE -1                TO  DC-ELAPSED-MONTHS
  3047         MOVE +0                TO  DC-ELAPSED-DAYS
  3048         MOVE '6'               TO  DC-OPTION-CODE
  3049         PERFORM 9700-DATE-LINK
  3050         MOVE DC-BIN-DATE-2     TO  CURRENT-MINUS1-SAVE.
  3051
  3052     IF EIBCALEN NOT GREATER THAN ZERO
  3053         GO TO 8800-UNAUTHORIZED-ACCESS.
  3054
  3055     IF PI-CALLING-PROGRAM = PGM-EL150
  3056         MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3057         MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3058         MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3059         MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3060         MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3061         MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3062         MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3063         MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3064         MOVE +1                   TO SUB
  3065         PERFORM  2000-ZERO-PI-TRLR-TABLE THRU 2010-EXIT
  3066         MOVE LOW-VALUES           TO EL162AO
  3067                                      PI-DISPLAYED-TRAILER-CODES
  3068         MOVE 1                    TO PI-ACTV-SEQ
  3069                                      PI-NEXT-TRLR-SUB
  3070         GO TO 7000-BUILD-SCREEN.
  3071
  3072     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3073         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3074************ FIRST TIME IN FROM MENU, FORCE THE CLAIM
  3075************ TO BE DESIGNATED THRU EL132.
  3076             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3077             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3078             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3079             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3080             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3081             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3082             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3083             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3084             MOVE PGM-EL132            TO PGM-NAME
  3085             GO TO 9300-XCTL
  3086         ELSE
  3087             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  61
* EL162.cbl
  3088             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  3089             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  3090             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  3091             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  3092             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  3093             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  3094             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  3095             MOVE +1                   TO SUB
  3096             PERFORM  2000-ZERO-PI-TRLR-TABLE THRU 2010-EXIT
  3097             MOVE LOW-VALUES           TO EL162AO
  3098                                       PI-DISPLAYED-TRAILER-CODES
  3099             MOVE 1                    TO PI-ACTV-SEQ
  3100                                          PI-NEXT-TRLR-SUB
  3101             GO TO 7000-BUILD-SCREEN.
  3102
  3103     IF EIBAID = DFHCLEAR
  3104         GO TO 9400-CLEAR.
  3105
  3106
  3107* EXEC CICS HANDLE CONDITION
  3108*        PGMIDERR(9600-PGMID-ERROR)
  3109*        ERROR   (9990-ABEND)
  3110*    END-EXEC.
  3111*    MOVE '"$L.                  ! " #00003102' TO DFHEIV0
  3112     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3113     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3114     MOVE X'2220233030303033313032' TO DFHEIV0(25:11)
  3115     CALL 'kxdfhei1' USING DFHEIV0
  3116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3117
  3118
  3119     IF PI-PROCESSOR-ID = 'LGXX'
  3120         GO TO 0200-RECEIVE.
  3121
  3122
  3123* EXEC CICS READQ TS
  3124*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  3125*        INTO    (SECURITY-CONTROL)
  3126*        LENGTH  (SC-COMM-LENGTH)
  3127*        ITEM    (SC-ITEM)
  3128*    END-EXEC.
  3129*    MOVE '*$II   L              ''   #00003110' TO DFHEIV0
  3130     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3131     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3132     MOVE X'2020233030303033313130' TO DFHEIV0(25:11)
  3133     CALL 'kxdfhei1' USING DFHEIV0,
  3134           PI-SECURITY-TEMP-STORE-ID,
  3135           SECURITY-CONTROL,
  3136           SC-COMM-LENGTH,
  3137           SC-ITEM,
  3138           DFHEIV99,
  3139           DFHEIV99
  3140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3141
  3142
  3143     MOVE SC-CLAIMS-DISPLAY (2)    TO  PI-DISPLAY-CAP.
  3144     MOVE SC-CLAIMS-UPDATE  (2)    TO  PI-MODIFY-CAP.
  3145
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  62
* EL162.cbl
  3146     IF NOT MODIFY-CAP
  3147         MOVE 'UPDATE'             TO  SM-READ
  3148         PERFORM 9995-SECURITY-VIOLATION
  3149         MOVE ER-0070              TO  EMI-ERROR
  3150         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3151         GO TO 8100-SEND-INITIAL-MAP.
  3152
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  63
* EL162.cbl
  3154 0200-RECEIVE.
  3155
  3156     MOVE LOW-VALUES TO EL162AI.
  3157
  3158     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  3159         MOVE ER-0008            TO EMI-ERROR
  3160         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3161         GO TO 8200-SEND-DATAONLY.
  3162
  3163
  3164* EXEC CICS RECEIVE
  3165*        MAP   (MAP-NAME)
  3166*        MAPSET(MAPSET-NAME)
  3167*        INTO  (EL162AI)
  3168*    END-EXEC.
  3169     MOVE LENGTH OF
  3170      EL162AI
  3171       TO DFHEIV11
  3172*    MOVE '8"T I  L              ''   #00003137' TO DFHEIV0
  3173     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3174     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3175     MOVE X'2020233030303033313337' TO DFHEIV0(25:11)
  3176     CALL 'kxdfhei1' USING DFHEIV0,
  3177           MAP-NAME,
  3178           EL162AI,
  3179           DFHEIV11,
  3180           MAPSET-NAME,
  3181           DFHEIV99,
  3182           DFHEIV99
  3183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3184
  3185
  3186     IF ENTERPFL = ZERO
  3187         GO TO 0300-CHECK-PFKEYS.
  3188
  3189     IF EIBAID NOT = DFHENTER
  3190         MOVE ER-0004            TO EMI-ERROR
  3191         GO TO 0320-INPUT-ERROR.
  3192
  3193     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  3194         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  3195     ELSE
  3196         MOVE ER-0029            TO EMI-ERROR
  3197         GO TO 0320-INPUT-ERROR.
  3198
  3199 0300-CHECK-PFKEYS.
  3200     IF EIBAID = DFHPF23
  3201         GO TO 8810-PF23.
  3202
  3203     IF EIBAID = DFHPF24
  3204         GO TO 9200-RETURN-MAIN-MENU.
  3205
  3206     IF EIBAID = DFHPF12
  3207         GO TO 9500-PF12.
  3208
  3209     IF PI-COMPANY-ID = 'DMD'
  3210         MOVE SPACE              TO PI-DMD-FORCE-ERROR.
  3211
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  64
* EL162.cbl
  3212     IF EIBAID = DFHPF4
  3213         IF PI-COMPANY-ID NOT = 'DMD'
  3214             MOVE ER-0029        TO EMI-ERROR
  3215             GO TO 0320-INPUT-ERROR
  3216         ELSE
  3217             MOVE 'X'            TO PI-DMD-FORCE-ERROR
  3218             MOVE DFHENTER       TO EIBAID
  3219             GO TO 0330-EDIT-DATA.
  3220
  3221     IF EIBAID = DFHPF5
  3222         IF PI-RETURN-TO-PROGRAM = 'EL150'
  3223             MOVE ER-0029        TO EMI-ERROR
  3224             GO TO 0320-INPUT-ERROR
  3225         ELSE
  3226             MOVE LOW-VALUES     TO PI-PROGRAM-WORK-AREA
  3227             MOVE PGM-EL132      TO PGM-NAME
  3228             GO TO 9300-XCTL.
  3229
  3230     IF PI-CLAIM-NO = SPACES
  3231        MOVE ER-0319             TO EMI-ERROR
  3232        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3233        GO TO 8100-SEND-INITIAL-MAP.
  3234
  3235     IF SC-RECL (1) > 0 OR SC-STOPL (1) > 0 OR
  3236        SC-RECL (2) > 0 OR SC-STOPL (2) > 0 OR
  3237        SC-RECL (3) > 0 OR SC-STOPL (3) > 0 OR
  3238        SC-RECL (4) > 0 OR SC-STOPL (4) > 0 OR
  3239        UREL > 0  OR USENTL > 0  OR
  3240*00409         UBYL > 0  OR UFORML > 0  OR URECDTEL > 0
  3241        UFORML > 0  OR URECDTEL > 0
  3242          IF EIBAID NOT = DFHENTER
  3243             MOVE ER-0050            TO EMI-ERROR
  3244             GO TO 0320-INPUT-ERROR.
  3245
  3246     IF EIBAID = DFHPF1
  3247         GO TO 6000-BROWSE-FORWARD.
  3248
  3249     IF EIBAID = DFHPF2
  3250         GO TO 6100-BROWSE-BACKWARD.
  3251
  3252     IF EIBAID = DFHPF6
  3253         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  3254         MOVE PGM-EL141          TO PGM-NAME
  3255         GO TO 9300-XCTL.
  3256
  3257     IF EIBAID = DFHPF7
  3258         MOVE PGM-EL1284          TO PGM-NAME
  3259         GO TO 9300-XCTL.
  3260
  3261     IF EIBAID = DFHENTER
  3262         GO TO 0330-EDIT-DATA.
  3263
  3264     MOVE ER-0029                TO EMI-ERROR.
  3265
  3266 0320-INPUT-ERROR.
  3267     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3268
  3269     MOVE AL-UNBON        TO ENTERPFA.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  65
* EL162.cbl
  3270
  3271     IF ENTERPFL = 0
  3272         MOVE -1          TO URECDTEL
  3273     ELSE
  3274         MOVE -1          TO ENTERPFL.
  3275
  3276     GO TO 8200-SEND-DATAONLY.
  3277
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  66
* EL162.cbl
  3279 0330-EDIT-DATA.
  3280     SET SC-INDX  INDX           TO 1.
  3281     SET INDX2                   TO 1.
  3282
  3283 0331-LOOP.
  3284     IF SC-RECL (SC-INDX) > ZERO
  3285        MOVE SC-REC (SC-INDX)    TO DEEDIT-FIELD
  3286        PERFORM 8600-DEEDIT
  3287        MOVE '1'                 TO REC-DATA-SW
  3288        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3289        MOVE '4'                 TO DC-OPTION-CODE
  3290        PERFORM 9700-DATE-LINK
  3291        IF DATE-CONVERSION-ERROR
  3292           MOVE ER-0021          TO EMI-ERROR
  3293           MOVE -1               TO SC-RECL (SC-INDX)
  3294           MOVE AL-UABON         TO SC-RECA (SC-INDX)
  3295           PERFORM 9900-ERROR-FORMAT
  3296                                 THRU 9900-EXIT
  3297        ELSE
  3298           IF DC-BIN-DATE-1 > BIN-CURRENT-DATE
  3299              MOVE ER-0539       TO EMI-ERROR
  3300              MOVE -1            TO SC-RECL (SC-INDX)
  3301              MOVE AL-UABON      TO SC-RECA (SC-INDX)
  3302              PERFORM 9900-ERROR-FORMAT
  3303                                 THRU 9900-EXIT
  3304           ELSE
  3305              MOVE DC-BIN-DATE-1 TO REC-DATE-SAVE (INDX)
  3306              MOVE DEEDIT-FIELD-V0
  3307                                 TO SC-REC-O (SC-INDX)
  3308              INSPECT SC-REC (SC-INDX) CONVERTING ' ' TO '/'
  3309           END-IF
  3310        END-IF
  3311     ELSE
  3312        MOVE LOW-VALUES          TO REC-DATE-SAVE (INDX)
  3313     END-IF
  3314     IF PI-COMPANY-ID = 'DMD'
  3315       IF SC-RECL (SC-INDX) > 0
  3316         IF REC-DATE-SAVE (INDX) < CURRENT-MINUS1-SAVE
  3317         IF NOT PI-DMD-FORCED
  3318           MOVE ER-7839        TO EMI-ERROR
  3319           MOVE -1             TO SC-RECL (SC-INDX)
  3320           MOVE AL-UABON       TO SC-RECA (SC-INDX)
  3321           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3322         END-IF
  3323         ELSE
  3324         IF REC-DATE-SAVE (INDX) > BIN-CURRENT-DATE
  3325           MOVE ER-0539          TO EMI-ERROR
  3326           MOVE -1               TO SC-RECL (SC-INDX)
  3327           MOVE AL-UABON         TO SC-RECA (SC-INDX)
  3328           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3329
  3330     IF SC-STOPL (SC-INDX) > ZERO
  3331        MOVE SC-STOP (SC-INDX)    TO DEEDIT-FIELD
  3332        PERFORM 8600-DEEDIT
  3333        MOVE '1'                 TO REC-DATA-SW
  3334        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3335        MOVE '4'                 TO DC-OPTION-CODE
  3336        PERFORM 9700-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  67
* EL162.cbl
  3337        IF DATE-CONVERSION-ERROR
  3338           MOVE ER-0021          TO EMI-ERROR
  3339           MOVE -1               TO SC-STOPL (SC-INDX)
  3340           MOVE AL-UABON         TO SC-STOPA (SC-INDX)
  3341           PERFORM 9900-ERROR-FORMAT
  3342                                 THRU 9900-EXIT
  3343        ELSE
  3344           IF DC-BIN-DATE-1 > BIN-CURRENT-DATE
  3345              MOVE ER-0895       TO EMI-ERROR
  3346              MOVE -1            TO SC-STOPL (SC-INDX)
  3347              MOVE AL-UABON      TO SC-STOPA (SC-INDX)
  3348              PERFORM 9900-ERROR-FORMAT
  3349                                 THRU 9900-EXIT
  3350           ELSE
  3351              MOVE DC-BIN-DATE-1 TO STOP-DATE-SAVE (INDX2)
  3352              MOVE DEEDIT-FIELD-V0 TO SC-STOP-O (SC-INDX)
  3353              INSPECT SC-STOP (SC-INDX) CONVERTING ' ' TO '/'
  3354           END-IF
  3355        END-IF
  3356     ELSE
  3357        MOVE LOW-VALUES          TO STOP-DATE-SAVE (INDX2)
  3358     END-IF.
  3359
  3360     SET SC-INDX
  3361            INDX2
  3362            INDX UP BY 1.
  3363
  3364     IF SC-INDX NOT = 5
  3365        GO TO 0331-LOOP.
  3366
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  68
* EL162.cbl
  3368
  3369     IF URECDTEL > 0
  3370        MOVE URECDTEI            TO DEEDIT-FIELD
  3371        PERFORM 8600-DEEDIT
  3372        MOVE '1'                 TO UNSOL-DATA-SW
  3373        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3374        MOVE '4'                 TO DC-OPTION-CODE
  3375        PERFORM 9700-DATE-LINK
  3376        IF DATE-CONVERSION-ERROR
  3377           MOVE ER-0021          TO EMI-ERROR
  3378           MOVE -1               TO URECDTEL
  3379           MOVE AL-UABON         TO URECDTEA
  3380           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3381        ELSE
  3382           MOVE DC-BIN-DATE-1    TO URECDTE-SAVE
  3383           MOVE DEEDIT-FIELD-V0  TO URECDTEO
  3384           INSPECT URECDTEI CONVERTING ' ' TO '/'.
  3385
  3386     IF PI-COMPANY-ID = 'DMD'
  3387       IF URECDTEL > 0
  3388         IF URECDTE-SAVE < CURRENT-MINUS1-SAVE
  3389         IF NOT PI-DMD-FORCED
  3390           MOVE ER-7839        TO EMI-ERROR
  3391           MOVE -1             TO URECDTEL
  3392           MOVE AL-UABON       TO URECDTEA
  3393           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3394         END-IF
  3395         ELSE
  3396         IF URECDTE-SAVE > BIN-CURRENT-DATE
  3397           MOVE ER-0539          TO EMI-ERROR
  3398           MOVE -1               TO URECDTEL
  3399           MOVE AL-UABON         TO URECDTEA
  3400           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3401
  3402     IF USENTL > 0
  3403        MOVE USENTI              TO DEEDIT-FIELD
  3404        PERFORM 8600-DEEDIT
  3405        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3406        MOVE '4'                 TO DC-OPTION-CODE
  3407        PERFORM 9700-DATE-LINK
  3408        IF DATE-CONVERSION-ERROR
  3409           MOVE ER-0021          TO EMI-ERROR
  3410           MOVE -1               TO USENTL
  3411           MOVE AL-UABON         TO USENTA
  3412           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3413          ELSE
  3414           MOVE DC-BIN-DATE-1    TO USENT-SAVE
  3415           MOVE DEEDIT-FIELD-V0  TO USENTO
  3416           INSPECT USENTI CONVERTING ' ' TO '/'
  3417        ELSE
  3418           MOVE LOW-VALUES       TO USENT-SAVE.
  3419
  3420     IF USENT-SAVE   NOT = LOW-VALUES AND
  3421        URECDTE-SAVE NOT = LOW-VALUES
  3422          IF USENT-SAVE GREATER THAN URECDTE-SAVE
  3423             MOVE ER-0514        TO EMI-ERROR
  3424             MOVE -1             TO URECDTEL
  3425             MOVE AL-UABON       TO URECDTEA
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  69
* EL162.cbl
  3426             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3427
  3428     IF URECDTE-SAVE NOT = LOW-VALUES
  3429          IF URECDTE-SAVE GREATER THAN BIN-CURRENT-DATE
  3430             MOVE ER-0539        TO EMI-ERROR
  3431             MOVE -1             TO URECDTEL
  3432             MOVE AL-UABON       TO URECDTEA
  3433             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3434
  3435     IF URECDTEL = ZEROS
  3436        IF USENTL > ZEROS  OR
  3437*00570            UBYL   > ZEROS  OR
  3438           UFORML > ZEROS  OR
  3439           UREL   > ZEROS
  3440              MOVE ER-0321          TO EMI-ERROR
  3441              MOVE -1               TO URECDTEL
  3442              PERFORM 9900-ERROR-FORMAT THRU  9900-EXIT.
  3443     IF AUTHRCVL > 0
  3444        IF AUTHRCVI = 'N' OR 'Y'
  3445           CONTINUE
  3446        ELSE
  3447           MOVE ER-0287        TO EMI-ERROR
  3448           MOVE -1             TO AUTHRCVL
  3449           MOVE AL-UABON       TO AUTHRCVA
  3450           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3451        END-IF
  3452     END-IF.
  3453
  3454     IF NOT EMI-NO-ERRORS
  3455        GO TO 8200-SEND-DATAONLY.
  3456
  3457     IF NOT MODIFY-CAP
  3458         MOVE ER-0070            TO EMI-ERROR
  3459         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3460         MOVE LOW-VALUES TO EL162AO
  3461         GO TO 8100-SEND-INITIAL-MAP.
  3462
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  70
* EL162.cbl
  3464     PERFORM 3000-BUILD-KEYS.
  3465
  3466     IF REC-DATA
  3467        PERFORM 4000-UPDATE-RECEIVE-DATES THRU 4099-EXIT
  3468                VARYING SC-INDX FROM 1 BY 1 UNTIL
  3469                SC-INDX = 5.
  3470
  3471     PERFORM 4100-CREATE-NEW-TRLR THRU 4199-EXIT.
  3472
  3473     MOVE ER-ZEROS               TO EMI-ERROR.
  3474     MOVE SPACES                 TO ADDR1I ADDR2I ADDR3I ADDR4I
  3475                                    ZIPI PHONEI.
  3476
  3477     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3478
  3479     MOVE -1                     TO SC-RECL (1).
  3480     GO TO 8200-SEND-DATAONLY.
  3481
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  71
* EL162.cbl
  3483 2000-ZERO-PI-TRLR-TABLE.
  3484
  3485     MOVE +0                     TO PI-TRLRS (SUB).
  3486     ADD +1 TO SUB.
  3487
  3488     IF SUB > +50
  3489        MOVE +0                  TO SUB
  3490        GO TO 2010-EXIT.
  3491
  3492     GO TO 2000-ZERO-PI-TRLR-TABLE.
  3493
  3494 2010-EXIT.
  3495     EXIT.
  3496
  3497 3000-BUILD-KEYS.
  3498     MOVE PI-CLAIM-NO            TO PI-CLAM-CLAIM
  3499                                    PI-ACTV-CLAIM
  3500                                    CLAIMNOI.
  3501
  3502     MOVE PI-CERT-NO             TO PI-CLAM-CERT-NO
  3503                                    PI-ACTV-CERT-NO
  3504                                    CERTNOI.
  3505
  3506     MOVE PI-COMPANY-CD          TO PI-CLAM-COMP-CD
  3507                                    PI-ACTV-COMP-CD.
  3508
  3509     MOVE PI-CARRIER             TO PI-CLAM-CARRIER
  3510                                    PI-ACTV-CARRIER
  3511                                    CARRI.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  72
* EL162.cbl
  3513 4000-UPDATE-RECEIVE-DATES.
  3514
  3515     IF SC-RECL (SC-INDX) = ZERO AND SC-STOPL (SC-INDX)
  3516        GO TO 4099-EXIT.
  3517
  3518     MOVE SC-TRLRNO (SC-INDX)    TO PI-ACTV-SEQ.
  3519
  3520*00648      IF SC-RECL (SC-INDX) = ZERO
  3521*00649          EXEC CICS READ
  3522*00650               DATASET (ELTRLR-FILE-ID)
  3523*00651               RIDFLD  (PI-ACTV-KEY)
  3524*00652               SET     (ADDRESS OF ACTIVITY-TRAILERS)
  3525*00653          END-EXEC
  3526*00654         ELSE
  3527
  3528* EXEC CICS READ
  3529*             DATASET(ELTRLR-FILE-ID)
  3530*             RIDFLD (PI-ACTV-KEY)
  3531*             SET    (ADDRESS OF ACTIVITY-TRAILERS)
  3532*             UPDATE
  3533*        END-EXEC.
  3534*    MOVE '&"S        EU         (   #00003484' TO DFHEIV0
  3535     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3536     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3537     MOVE X'2020233030303033343834' TO DFHEIV0(25:11)
  3538     CALL 'kxdfhei1' USING DFHEIV0,
  3539           ELTRLR-FILE-ID,
  3540           DFHEIV20,
  3541           DFHEIV99,
  3542           PI-ACTV-KEY,
  3543           DFHEIV99,
  3544           DFHEIV99,
  3545           DFHEIV99
  3546     SET ADDRESS OF ACTIVITY-TRAILERS TO
  3547         DFHEIV20
  3548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3549
  3550
  3551     SET INDX2 TO SC-INDX.
  3552
  3553     IF SC-STOPL (SC-INDX) = ZEROS
  3554         GO TO 4000-BYPASS-STOP-DATE
  3555     END-IF.
  3556
  3557     IF (CORRESPONDENCE-TR AND
  3558         STOP-DATE-SAVE (INDX2) LESS THAN AT-LETTER-SENT-DT)
  3559              OR
  3560        (FORM-CONTROL-TR AND
  3561         STOP-DATE-SAVE (INDX2) LESS THAN AT-FORM-SEND-ON-DT)
  3562           MOVE ER-0896          TO EMI-ERROR
  3563           MOVE -1               TO SC-STOPL (SC-INDX)
  3564           MOVE AL-UABON         TO SC-STOPA (SC-INDX)
  3565           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3566
  3567* EXEC CICS SYNCPOINT
  3568*               ROLLBACK
  3569*          END-EXEC
  3570*    MOVE '6"R                   !   #00003506' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  73
* EL162.cbl
  3571     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  3572     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3573     MOVE X'2020233030303033353036' TO DFHEIV0(25:11)
  3574     CALL 'kxdfhei1' USING DFHEIV0
  3575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3576           GO TO 8200-SEND-DATAONLY
  3577     END-IF.
  3578
  3579     IF CORRESPONDENCE-TR
  3580        MOVE STOP-DATE-SAVE (INDX2) TO AT-STOP-LETTER-DT
  3581        MOVE PI-PROCESSOR-ID     TO AT-CORR-LAST-UPDATED-BY
  3582        MOVE BIN-CURRENT-DATE    TO AT-CORR-LAST-MAINT-DT
  3583     END-IF.
  3584
  3585     IF FORM-CONTROL-TR
  3586        MOVE STOP-DATE-SAVE (INDX2) TO AT-STOP-FORM-DT
  3587        MOVE PI-PROCESSOR-ID     TO AT-FORM-LAST-UPDATED-BY
  3588        MOVE BIN-CURRENT-DATE    TO AT-FORM-LAST-MAINT-DT
  3589     END-IF.
  3590     MOVE AL-UANOF               TO SC-STOPA (SC-INDX).
  3591
  3592 4000-BYPASS-STOP-DATE.
  3593
  3594     IF SC-RECL (SC-INDX) = ZEROS
  3595*00673         GO TO 4099-EXIT.
  3596        GO TO 4090-REWRITE
  3597     END-IF.
  3598
  3599     SET INDX TO SC-INDX.
  3600
  3601     IF (CORRESPONDENCE-TR AND
  3602         REC-DATE-SAVE (INDX)  LESS THAN AT-LETTER-SENT-DT)
  3603              OR
  3604        (FORM-CONTROL-TR AND
  3605         REC-DATE-SAVE (INDX)  LESS THAN AT-FORM-SEND-ON-DT)
  3606           MOVE ER-0514          TO EMI-ERROR
  3607           MOVE -1               TO SC-RECL (SC-INDX)
  3608           MOVE AL-UABON         TO SC-RECA (SC-INDX)
  3609           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3610
  3611* EXEC CICS SYNCPOINT
  3612*               ROLLBACK
  3613*          END-EXEC
  3614*    MOVE '6"R                   !   #00003543' TO DFHEIV0
  3615     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  3616     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3617     MOVE X'2020233030303033353433' TO DFHEIV0(25:11)
  3618     CALL 'kxdfhei1' USING DFHEIV0
  3619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3620           GO TO 8200-SEND-DATAONLY.
  3621
  3622     IF CORRESPONDENCE-TR
  3623        MOVE REC-DATE-SAVE (INDX)   TO AT-LETTER-ANSWERED-DT
  3624        MOVE PI-PROCESSOR-ID        TO AT-CORR-LAST-UPDATED-BY
  3625        MOVE BIN-CURRENT-DATE       TO AT-CORR-LAST-MAINT-DT.
  3626
  3627     IF FORM-CONTROL-TR
  3628        MOVE PI-PROCESSOR-ID        TO AT-FORM-LAST-UPDATED-BY
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  74
* EL162.cbl
  3629        MOVE BIN-CURRENT-DATE       TO AT-FORM-LAST-MAINT-DT
  3630        IF SC-TYPE (SC-INDX) = 'C'
  3631           MOVE REC-DATE-SAVE (INDX)   TO AT-FORM-ANSWERED-DT
  3632        ELSE
  3633        IF SC-TYPE (SC-INDX) = 'E'
  3634           MOVE REC-DATE-SAVE (INDX)   TO AT-EMP-FORM-ANSWERED-DT
  3635        ELSE
  3636        IF SC-TYPE (SC-INDX) = 'P'
  3637           MOVE REC-DATE-SAVE (INDX)   TO AT-PHY-FORM-ANSWERED-DT.
  3638
  3639     MOVE AL-UANOF               TO SC-RECA (SC-INDX).
  3640
  3641 4090-REWRITE.
  3642
  3643     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  3644
  3645     IF PI-COMPANY-ID = 'DMD'
  3646         MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY.
  3647
  3648
  3649* EXEC CICS REWRITE
  3650*         FROM   (ACTIVITY-TRAILERS)
  3651*         DATASET(ELTRLR-FILE-ID)
  3652*    END-EXEC.
  3653     MOVE LENGTH OF
  3654      ACTIVITY-TRAILERS
  3655       TO DFHEIV11
  3656*    MOVE '&& L                  %   #00003574' TO DFHEIV0
  3657     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3658     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3659     MOVE X'2020233030303033353734' TO DFHEIV0(25:11)
  3660     CALL 'kxdfhei1' USING DFHEIV0,
  3661           ELTRLR-FILE-ID,
  3662           ACTIVITY-TRAILERS,
  3663           DFHEIV11,
  3664           DFHEIV99
  3665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3666
  3667
  3668 4099-EXIT.
  3669      EXIT.
  3670
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  75
* EL162.cbl
  3672 4100-CREATE-NEW-TRLR.
  3673
  3674
  3675* EXEC CICS READ
  3676*         DATASET(ELMSTR-FILE-ID)
  3677*         SET    (ADDRESS OF CLAIM-MASTER)
  3678*         RIDFLD (PI-CLAM-KEY)
  3679*         UPDATE
  3680*    END-EXEC.
  3681*    MOVE '&"S        EU         (   #00003585' TO DFHEIV0
  3682     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3683     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3684     MOVE X'2020233030303033353835' TO DFHEIV0(25:11)
  3685     CALL 'kxdfhei1' USING DFHEIV0,
  3686           ELMSTR-FILE-ID,
  3687           DFHEIV20,
  3688           DFHEIV99,
  3689           PI-CLAM-KEY,
  3690           DFHEIV99,
  3691           DFHEIV99,
  3692           DFHEIV99
  3693     SET ADDRESS OF CLAIM-MASTER TO
  3694         DFHEIV20
  3695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3696
  3697
  3698     IF FILEL > ZEROS
  3699        MOVE FILEI               TO CL-FILE-LOCATION.
  3700
  3701     IF NOT UNSOL-DATA
  3702        GO TO 4150-REWRITE-CLAIM.
  3703
  3704     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
  3705
  3706
  3707* EXEC CICS GETMAIN
  3708*         SET    (ADDRESS OF ACTIVITY-TRAILERS)
  3709*         INITIMG(GETMAIN-SPACE)
  3710*         LENGTH (ACTV-LENGTH)
  3711*    END-EXEC.
  3712*    MOVE ',"IL                  $   #00003600' TO DFHEIV0
  3713     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3714     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3715     MOVE X'2020233030303033363030' TO DFHEIV0(25:11)
  3716     CALL 'kxdfhei1' USING DFHEIV0,
  3717           DFHEIV20,
  3718           ACTV-LENGTH,
  3719           GETMAIN-SPACE
  3720     SET ADDRESS OF ACTIVITY-TRAILERS TO
  3721         DFHEIV20
  3722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3723
  3724
  3725     MOVE 'AT'                   TO AT-RECORD-ID.
  3726     MOVE  4                     TO AT-TRAILER-TYPE.
  3727     MOVE BIN-CURRENT-DATE       TO AT-RECORDED-DT
  3728                                    AT-CORR-LAST-MAINT-DT
  3729
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  76
* EL162.cbl
  3730     IF UBYL > +0
  3731        MOVE UBYI                TO AT-RECORDED-BY
  3732                                    AT-CORR-LAST-UPDATED-BY
  3733     ELSE
  3734        MOVE PI-PROCESSOR-ID     TO AT-RECORDED-BY
  3735                                    AT-CORR-LAST-UPDATED-BY.
  3736
  3737     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  3738     MOVE PI-ACTV-KEY            TO AT-CONTROL-PRIMARY.
  3739     MOVE PI-CLAIM-NO            TO AT-CLAIM-NO.
  3740     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
  3741     MOVE USENT-SAVE             TO AT-LETTER-SENT-DT.
  3742     MOVE LOW-VALUES             TO AT-RECEIPT-FOLLOW-UP
  3743                                    AT-AUTO-RE-SEND-DT
  3744                                    AT-INITIAL-PRINT-DATE
  3745                                    AT-RESEND-PRINT-DATE.
  3746     MOVE URECDTE-SAVE           TO AT-LETTER-ANSWERED-DT.
  3747     MOVE ZEROS                  TO AT-LETTER-ARCHIVE-NO.
  3748     MOVE '1'                    TO AT-LETTER-ORIGIN.
  3749
  3750     IF UFORML > 0
  3751        MOVE UFORMI              TO AT-STD-LETTER-FORM
  3752       ELSE
  3753        MOVE SPACES              TO AT-STD-LETTER-FORM.
  3754
  3755     IF UREL > 0
  3756        MOVE UREI                TO AT-REASON-TEXT
  3757       ELSE
  3758        MOVE SPACES              TO AT-REASON-TEXT.
  3759     IF AUTHRCVL > 0
  3760        MOVE AUTHRCVI            TO AT-AUTH-RCVD
  3761     ELSE
  3762        MOVE SPACES              TO AT-AUTH-RCVD
  3763     END-IF.
  3764
  3765     MOVE SPACES                 TO AT-ADDRESSEE-NAME
  3766                                    AT-ADDRESEE-TYPE.
  3767     MOVE ZEROS                  TO AT-ADDRESS-REC-SEQ-NO.
  3768     MOVE 'U'                    TO AT-CORR-SOL-UNSOL.
  3769
  3770
  3771* EXEC CICS WRITE
  3772*         DATASET(ELTRLR-FILE-ID)
  3773*         FROM   (ACTIVITY-TRAILERS)
  3774*         RIDFLD (AT-CONTROL-PRIMARY)
  3775*    END-EXEC.
  3776     MOVE LENGTH OF
  3777      ACTIVITY-TRAILERS
  3778       TO DFHEIV11
  3779*    MOVE '&$ L                  ''   #00003651' TO DFHEIV0
  3780     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3781     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3782     MOVE X'2020233030303033363531' TO DFHEIV0(25:11)
  3783     CALL 'kxdfhei1' USING DFHEIV0,
  3784           ELTRLR-FILE-ID,
  3785           ACTIVITY-TRAILERS,
  3786           DFHEIV11,
  3787           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  77
* EL162.cbl
  3788           DFHEIV99,
  3789           DFHEIV99
  3790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3791
  3792
  3793     MOVE SPACES                 TO URECDTEI
  3794                                    USENTI
  3795*00795                                     UBYI
  3796                                    UFORMI
  3797                                    UREI.
  3798
  3799     MOVE AL-UANOF               TO URECDTEA
  3800                                    USENTA
  3801*00801                                     UBYA
  3802                                    UFORMA
  3803                                    UREA.
  3804
  3805     MOVE PI-PROCESSOR-ID        TO UBYI.
  3806
  3807 4150-REWRITE-CLAIM.
  3808
  3809* EXEC CICS HANDLE CONDITION
  3810*        DUPKEY (4199-EXIT)
  3811*    END-EXEC.
  3812*    MOVE '"$$                   ! # #00003672' TO DFHEIV0
  3813     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  3814     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3815     MOVE X'2320233030303033363732' TO DFHEIV0(25:11)
  3816     CALL 'kxdfhei1' USING DFHEIV0
  3817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3818
  3819
  3820     MOVE PI-PROCESSOR-ID   TO  CL-LAST-MAINT-USER.
  3821     MOVE EIBTIME           TO  CL-LAST-MAINT-HHMMSS.
  3822     MOVE BIN-CURRENT-DATE  TO  CL-LAST-MAINT-DT.
  3823     MOVE '2'               TO  CL-LAST-MAINT-TYPE.
  3824
  3825     IF PI-COMPANY-ID = 'DMD'
  3826         MOVE 11                 TO CL-ACTIVITY-CODE
  3827         MOVE BIN-CURRENT-DATE   TO CL-ACTIVITY-MAINT-DT
  3828         MOVE 'CORR'             TO CL-ACTIVITY-MAINT-TYPE
  3829         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID.
  3830
  3831
  3832* EXEC CICS REWRITE
  3833*         DATASET(ELMSTR-FILE-ID)
  3834*         FROM   (CLAIM-MASTER)
  3835*    END-EXEC.
  3836     MOVE LENGTH OF
  3837      CLAIM-MASTER
  3838       TO DFHEIV11
  3839*    MOVE '&& L                  %   #00003687' TO DFHEIV0
  3840     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3841     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3842     MOVE X'2020233030303033363837' TO DFHEIV0(25:11)
  3843     CALL 'kxdfhei1' USING DFHEIV0,
  3844           ELMSTR-FILE-ID,
  3845           CLAIM-MASTER,
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  78
* EL162.cbl
  3846           DFHEIV11,
  3847           DFHEIV99
  3848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3849
  3850
  3851 4199-EXIT.
  3852      EXIT.
  3853
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  79
* EL162.cbl
  3855 4200-LOCATE-ADDRESS.
  3856     IF ADDR-TYPE = '3' AND ADDR-SEQ = ZEROS
  3857        GO TO 4210-READ-ACCOUNT.
  3858
  3859     IF ADDR-TYPE = SPACES OR ADDR-SEQ = ZEROS
  3860        GO TO 4290-ERROR.
  3861
  3862     MOVE ADDR-SEQ               TO PI-ACTV-SEQ.
  3863
  3864
  3865* EXEC CICS HANDLE CONDITION
  3866*         NOTFND(4290-ERROR)
  3867*    END-EXEC.
  3868*    MOVE '"$I                   ! $ #00003705' TO DFHEIV0
  3869     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3871     MOVE X'2420233030303033373035' TO DFHEIV0(25:11)
  3872     CALL 'kxdfhei1' USING DFHEIV0
  3873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3874
  3875
  3876
  3877* EXEC CICS READ
  3878*         DATASET(ELTRLR-FILE-ID)
  3879*         RIDFLD (PI-ACTV-KEY)
  3880*         SET    (ADDRESS OF ACTIVITY-TRAILERS)
  3881*    END-EXEC.
  3882*    MOVE '&"S        E          (   #00003709' TO DFHEIV0
  3883     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3884     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3885     MOVE X'2020233030303033373039' TO DFHEIV0(25:11)
  3886     CALL 'kxdfhei1' USING DFHEIV0,
  3887           ELTRLR-FILE-ID,
  3888           DFHEIV20,
  3889           DFHEIV99,
  3890           PI-ACTV-KEY,
  3891           DFHEIV99,
  3892           DFHEIV99,
  3893           DFHEIV99
  3894     SET ADDRESS OF ACTIVITY-TRAILERS TO
  3895         DFHEIV20
  3896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3897
  3898
  3899     MOVE AT-MAIL-TO-NAME        TO ADDR1O.
  3900     MOVE AT-ADDRESS-LINE-1      TO ADDR2O.
  3901     MOVE AT-ADDRESS-LINE-2      TO ADDR3O.
  3902*    MOVE AT-CITY-STATE          TO ADDR4O.
  3903     STRING AT-CITY ' ' AT-STATE
  3904        DELIMITED BY '  ' INTO ADDR4O
  3905     END-STRING
  3906     MOVE AT-PHONE-NO            TO PHONEO.
  3907     INSPECT PHONEI CONVERTING ' ' TO '-'.
  3908
  3909     IF AT-CANADIAN-POST-CODE
  3910         MOVE AT-CAN-POSTAL-1    TO WS-CAN-POSTAL-CD-1
  3911         MOVE AT-CAN-POSTAL-2    TO WS-CAN-POSTAL-CD-2
  3912         MOVE SPACES             TO WS-DASH-CAN
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  80
* EL162.cbl
  3913                                    WS-CAN-FILLER
  3914         MOVE WS-CANADIAN-POSTAL-CODES
  3915                                 TO ZIPO
  3916     ELSE
  3917         MOVE AT-ZIP-CODE        TO WS-ZIP-CODE
  3918         IF AT-ZIP-PLUS4 = SPACES OR ZEROS
  3919             MOVE SPACES         TO WS-ZIP-PLUS4
  3920                                    WS-DASH
  3921             MOVE WS-ZIP         TO ZIPO
  3922         ELSE
  3923             MOVE AT-ZIP-PLUS4   TO WS-ZIP-PLUS4
  3924             MOVE '-'            TO WS-DASH
  3925             MOVE WS-ZIP         TO ZIPO.
  3926
  3927     GO TO 4299-EXIT.
  3928
  3929 4210-READ-ACCOUNT.
  3930     MOVE PI-COMPANY-CD          TO ACCT-CO.
  3931     MOVE PI-CARRIER             TO ACCT-CARRIER.
  3932     MOVE PI-GROUPING            TO ACCT-GROUPING.
  3933     MOVE PI-STATE               TO ACCT-STATE.
  3934     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  3935     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DATE.
  3936
  3937
  3938* EXEC CICS HANDLE CONDITION
  3939*         NOTOPEN(8880-ACCT-NOT-OPEN)
  3940*         NOTFND (4250-ACCT-NOT-FOUND)
  3941*    END-EXEC.
  3942*    MOVE '"$JI                  ! % #00003753' TO DFHEIV0
  3943     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  3944     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3945     MOVE X'2520233030303033373533' TO DFHEIV0(25:11)
  3946     CALL 'kxdfhei1' USING DFHEIV0
  3947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3948
  3949
  3950
  3951* EXEC CICS STARTBR
  3952*         RIDFLD   (ACCT-KEY)
  3953*         DATASET  (ERACCT-FILE-ID)
  3954*         KEYLENGTH(13)
  3955*         GENERIC
  3956*    END-EXEC.
  3957     MOVE 13
  3958       TO DFHEIV11
  3959     MOVE 0
  3960       TO DFHEIV12
  3961*    MOVE '&,   KG    G          &   #00003758' TO DFHEIV0
  3962     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3963     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3964     MOVE X'2020233030303033373538' TO DFHEIV0(25:11)
  3965     CALL 'kxdfhei1' USING DFHEIV0,
  3966           ERACCT-FILE-ID,
  3967           ACCT-KEY,
  3968           DFHEIV11,
  3969           DFHEIV12,
  3970           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  81
* EL162.cbl
  3971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3972
  3973
  3974     MOVE ACCT-PARTIAL-KEY       TO ACCT-SAVE-KEY.
  3975
  3976 4230-READNEXT.
  3977
  3978* EXEC CICS READNEXT
  3979*         DATASET(ERACCT-FILE-ID)
  3980*         SET    (ADDRESS OF ACCOUNT-MASTER)
  3981*         RIDFLD (ACCT-KEY)
  3982*    END-EXEC.
  3983     MOVE 0
  3984       TO DFHEIV11
  3985*    MOVE '&.S                   )   #00003768' TO DFHEIV0
  3986     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3987     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3988     MOVE X'2020233030303033373638' TO DFHEIV0(25:11)
  3989     CALL 'kxdfhei1' USING DFHEIV0,
  3990           ERACCT-FILE-ID,
  3991           DFHEIV20,
  3992           DFHEIV99,
  3993           ACCT-KEY,
  3994           DFHEIV99,
  3995           DFHEIV11,
  3996           DFHEIV99,
  3997           DFHEIV99
  3998     SET ADDRESS OF ACCOUNT-MASTER TO
  3999         DFHEIV20
  4000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4001
  4002
  4003     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
  4004        GO TO 4250-ACCT-NOT-FOUND.
  4005
  4006     IF PI-CERT-EFF-DT NOT LESS THAN AM-EFFECTIVE-DT AND
  4007        PI-CERT-EFF-DT     LESS THAN AM-EXPIRATION-DT
  4008        NEXT SENTENCE
  4009      ELSE
  4010        GO TO 4230-READNEXT.
  4011
  4012     MOVE AM-NAME                TO ADDR1O.
  4013     MOVE AM-PERSON              TO ADDR2O.
  4014     MOVE AM-ADDRS               TO ADDR3O.
  4015*    MOVE AM-CITY                TO ADDR4O.
  4016     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  4017        DELIMITED BY '  ' INTO ADDR4O
  4018     END-STRING
  4019
  4020     MOVE AM-TEL-NO              TO WS-WORK-PHONE.
  4021     INSPECT WS-WORK-PHONE CONVERTING ' ' TO '0'.
  4022     MOVE WS-NUMERIC-PHONE       TO PHONEO.
  4023     INSPECT PHONEI CONVERTING ' ' TO '-'.
  4024
  4025     IF AM-CANADIAN-POST-CODE
  4026         MOVE AM-CAN-POSTAL-1    TO WS-CAN-POSTAL-CD-1
  4027         MOVE AM-CAN-POSTAL-2    TO WS-CAN-POSTAL-CD-2
  4028         MOVE SPACES             TO WS-DASH-CAN
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  82
* EL162.cbl
  4029                                    WS-CAN-FILLER
  4030         MOVE WS-CANADIAN-POSTAL-CODES
  4031                                 TO ZIPO
  4032     ELSE
  4033         MOVE AM-ZIP-PRIME       TO WS-ZIP-CODE
  4034         IF AM-ZIP-PLUS4 = SPACES OR ZEROS
  4035             MOVE SPACES         TO WS-ZIP-PLUS4
  4036                                    WS-DASH
  4037             MOVE WS-ZIP         TO ZIPO
  4038         ELSE
  4039             MOVE AM-ZIP-PLUS4   TO WS-ZIP-PLUS4
  4040             MOVE '-'            TO WS-DASH
  4041             MOVE WS-ZIP         TO ZIPO.
  4042
  4043     PERFORM 4240-ENDBR.
  4044
  4045     GO TO 4299-EXIT.
  4046
  4047 4240-ENDBR.
  4048
  4049* EXEC CICS ENDBR
  4050*         DATASET(ERACCT-FILE-ID)
  4051*    END-EXEC.
  4052     MOVE 0
  4053       TO DFHEIV11
  4054*    MOVE '&2                    $   #00003819' TO DFHEIV0
  4055     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4056     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4057     MOVE X'2020233030303033383139' TO DFHEIV0(25:11)
  4058     CALL 'kxdfhei1' USING DFHEIV0,
  4059           ERACCT-FILE-ID,
  4060           DFHEIV11,
  4061           DFHEIV99
  4062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4063
  4064
  4065 4250-ACCT-NOT-FOUND.
  4066     PERFORM 4240-ENDBR.
  4067     MOVE ER-0179                TO EMI-ERROR.
  4068     MOVE -1                     TO SC-RECL (1).
  4069     MOVE SPACES                 TO ADDR1I ADDR2I ADDR3I ADDR4I
  4070                                    ZIPI PHONEI.
  4071
  4072     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4073
  4074 4290-ERROR.
  4075     MOVE ER-0322                TO EMI-ERROR.
  4076     MOVE -1                     TO SC-RECL (1).
  4077     MOVE SPACES                 TO ADDR1I ADDR2I ADDR3I ADDR4I
  4078                                    ZIPI PHONEI.
  4079
  4080     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4081
  4082 4299-EXIT.
  4083      EXIT.
  4084
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  83
* EL162.cbl
  4086 6000-BROWSE-FORWARD.
  4087     IF PI-ACTV-SAVE NOT = PI-ACTV-PARTIAL
  4088        MOVE ER-0066             TO EMI-ERROR
  4089        MOVE -1                  TO SC-RECL (1)
  4090        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4091        GO TO 8200-SEND-DATAONLY.
  4092
  4093     MOVE LOW-VALUES             TO EL162AI.
  4094     ADD 1 TO PI-ACTV-SEQ.
  4095
  4096     GO TO 7000-BUILD-SCREEN.
  4097
  4098 6100-BROWSE-BACKWARD.
  4099
  4100     IF PI-NEXT-TRLR-SUB > 8
  4101        SUBTRACT 4 FROM PI-NEXT-TRLR-SUB.
  4102
  4103     MOVE PI-NEXT-TRLR-SUB       TO SUB.
  4104
  4105     IF SUB = 1 OR 5
  4106        MOVE ER-0067             TO EMI-ERROR
  4107        MOVE -1                  TO SC-RECL (1)
  4108        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4109        MOVE  1                  TO SUB
  4110        MOVE  +1                 TO PI-NEXT-TRLR-SUB
  4111     ELSE
  4112        SUBTRACT 4 FROM SUB
  4113        MOVE SUB                 TO PI-NEXT-TRLR-SUB.
  4114
  4115     MOVE LOW-VALUES             TO EL162AI
  4116                                    TRL-LINES.
  4117     MOVE PI-ACTV-SAVE           TO PI-ACTV-PARTIAL.
  4118
  4119     MOVE PI-TRLRS (SUB)         TO PI-ACTV-SEQ.
  4120
  4121     GO TO 7000-BUILD-SCREEN.
  4122
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  84
* EL162.cbl
  4124 6200-FORMAT-DATA.
  4125
  4126     IF FORM-CONTROL-TR
  4127        GO TO 6250-FORMAT-FORM.
  4128
  4129     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES
  4130        MOVE AT-LETTER-ANSWERED-DT TO DC-BIN-DATE-1
  4131        MOVE SPACES                TO DC-OPTION-CODE
  4132        PERFORM 9700-DATE-LINK
  4133        MOVE DC-GREG-DATE-1-EDIT   TO SC-REC (SC-INDX).
  4134
  4135     IF AT-STOP-LETTER-DT NOT = LOW-VALUES AND SPACES
  4136        MOVE AT-STOP-LETTER-DT     TO DC-BIN-DATE-1
  4137        MOVE SPACES                TO DC-OPTION-CODE
  4138        PERFORM 9700-DATE-LINK
  4139        MOVE DC-GREG-DATE-1-EDIT   TO SC-STOP (SC-INDX)
  4140     END-IF.
  4141
  4142     IF AT-LETTER-SENT-DT NOT = LOW-VALUES
  4143        MOVE AT-LETTER-SENT-DT   TO DC-BIN-DATE-1
  4144        MOVE SPACES              TO DC-OPTION-CODE
  4145        PERFORM 9700-DATE-LINK
  4146        MOVE DC-GREG-DATE-1-EDIT TO SC-SENT (SC-INDX).
  4147
  4148     IF AT-AUTO-RE-SEND-DT NOT = LOW-VALUES
  4149        MOVE AT-AUTO-RE-SEND-DT  TO DC-BIN-DATE-1
  4150        MOVE SPACES              TO DC-OPTION-CODE
  4151        PERFORM 9700-DATE-LINK
  4152        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4153
  4154     IF AT-RECEIPT-FOLLOW-UP NOT = LOW-VALUES
  4155        MOVE AT-RECEIPT-FOLLOW-UP TO DC-BIN-DATE-1
  4156        MOVE SPACES               TO DC-OPTION-CODE
  4157        PERFORM 9700-DATE-LINK
  4158        MOVE DC-GREG-DATE-1-EDIT  TO SC-FOLLOWUP (SC-INDX).
  4159
  4160     MOVE AT-STD-LETTER-FORM     TO SC-FORM (SC-INDX).
  4161
  4162     IF INSURED-ADDRESEE
  4163        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4164     ELSE
  4165     IF BENEFICIARY-ADDRESEE
  4166        MOVE 'BENEFI '           TO SC-TO (SC-INDX)
  4167     ELSE
  4168     IF ACCOUNT-ADDRESEE
  4169        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4170     ELSE
  4171     IF PHYSICIAN-ADDRESEE
  4172        MOVE 'DOCTOR'            TO SC-TO (SC-INDX)
  4173     ELSE
  4174     IF EMPLOYER-ADDRESEE
  4175        MOVE 'EMPLOYER'          TO SC-TO (SC-INDX)
  4176     ELSE
  4177     IF OTHER-ADDRESEE-1
  4178        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4179     ELSE
  4180        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4181
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  85
* EL162.cbl
  4182     IF AT-LETTER-ARCHIVE-NO NOT = +0
  4183        MOVE AT-LETTER-ARCHIVE-NO TO SC-ARCHIVE (SC-INDX)
  4184     ELSE
  4185        MOVE SPACES              TO SC-ARCHIVE (SC-INDX).
  4186
  4187     MOVE 'L'                    TO SC-TYPE   (SC-INDX).
  4188
  4189     MOVE AT-REASON-TEXT         TO SC-REASON (SC-INDX).
  4190
  4191*    IF PI-COMPANY-ID = 'DMD'
  4192*       IF AT-DMD-LETTER-PURGED
  4193*          MOVE AT-REASON-TEXT          TO WS-REASON
  4194*          MOVE AT-DMD-LETTER-PURGE-DT  TO DC-BIN-DATE-1
  4195*          MOVE SPACES                  TO DC-OPTION-CODE
  4196*          PERFORM 9700-DATE-LINK
  4197*          MOVE 'PURGED -'              TO WS-REASON (51:9)
  4198*          MOVE DC-GREG-DATE-1-EDIT     TO WS-REASON (60:11)
  4199*          MOVE WS-REASON               TO SC-REASON (SC-INDX).
  4200*
  4201     MOVE AT-RECORDED-BY         TO SC-BY     (SC-INDX).
  4202     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO (SC-INDX).
  4203     MOVE AL-UANOF               TO SC-RECA   (SC-INDX)
  4204                                    SC-STOPA  (SC-INDX).
  4205
  4206     GO TO 6299-EXIT.
  4207
  4208 6250-FORMAT-FORM.
  4209
  4210     IF AT-STOP-FORM-DT NOT = LOW-VALUES AND SPACES
  4211        MOVE AT-STOP-FORM-DT       TO DC-BIN-DATE-1
  4212        MOVE SPACES                TO DC-OPTION-CODE
  4213        PERFORM 9700-DATE-LINK
  4214        MOVE DC-GREG-DATE-1-EDIT   TO SC-STOP (SC-INDX)
  4215     END-IF.
  4216
  4217     IF AT-FORM-SEND-ON-DT NOT = LOW-VALUES
  4218        IF (AT-FORM-ANSWERED-DT = LOW-VALUES)
  4219                         OR
  4220           (AT-FORM-ANSWERED-DT NOT = LOW-VALUES  AND
  4221            AT-FORM-ANSWERED-DT = BIN-CURRENT-DATE)
  4222             NEXT SENTENCE
  4223         ELSE
  4224             GO TO 6260-CHECK-EMPLOYER-FORM
  4225     ELSE
  4226        GO TO 6260-CHECK-EMPLOYER-FORM.
  4227
  4228     IF AT-FORM-ANSWERED-DT NOT = LOW-VALUES
  4229        MOVE AT-FORM-ANSWERED-DT TO DC-BIN-DATE-1
  4230        MOVE SPACES              TO DC-OPTION-CODE
  4231        PERFORM 9700-DATE-LINK
  4232        MOVE DC-GREG-DATE-1-EDIT TO SC-REC (SC-INDX).
  4233
  4234     IF AT-FORM-SEND-ON-DT NOT = LOW-VALUES
  4235        MOVE AT-FORM-SEND-ON-DT  TO DC-BIN-DATE-1
  4236        MOVE SPACES              TO DC-OPTION-CODE
  4237        PERFORM 9700-DATE-LINK
  4238        MOVE DC-GREG-DATE-1-EDIT TO SC-SENT (SC-INDX).
  4239
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  86
* EL162.cbl
  4240     IF AT-FORM-RE-SEND-DT NOT = LOW-VALUES
  4241        MOVE AT-FORM-RE-SEND-DT  TO DC-BIN-DATE-1
  4242        MOVE SPACES              TO DC-OPTION-CODE
  4243        PERFORM 9700-DATE-LINK
  4244        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4245
  4246     IF AT-FORM-FOLLOW-UP-DT NOT = LOW-VALUES
  4247        MOVE AT-FORM-FOLLOW-UP-DT   TO DC-BIN-DATE-1
  4248        MOVE SPACES                 TO DC-OPTION-CODE
  4249        PERFORM 9700-DATE-LINK
  4250        MOVE DC-GREG-DATE-1-EDIT TO SC-FOLLOWUP (SC-INDX).
  4251
  4252     IF AT-FORM-TYPE = '1'
  4253        MOVE 'INIT'              TO SC-FORM (SC-INDX)
  4254     ELSE
  4255        MOVE 'PROG'              TO SC-FORM (SC-INDX).
  4256
  4257     IF FORM-TO-INSURED
  4258        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4259     ELSE
  4260     IF FORM-TO-ACCOUNT
  4261        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4262     ELSE
  4263     IF FORM-TO-OTHER-1
  4264        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4265     ELSE
  4266     IF FORM-TO-OTHER-2
  4267        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4268
  4269     MOVE 'CLAIMANT'             TO SC-ARCHIVE (SC-INDX).
  4270     MOVE 'C'                    TO SC-TYPE    (SC-INDX).
  4271     MOVE AT-SEQUENCE-NO         TO PI-TRLRS (PI-NEXT-TRLR-SUB)
  4272     MOVE AT-INSTRUCT-LN-1       TO SC-REASON  (SC-INDX).
  4273     MOVE AT-RECORDED-BY         TO SC-BY      (SC-INDX).
  4274     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO  (SC-INDX).
  4275     MOVE AL-UANOF               TO SC-RECA    (SC-INDX).
  4276     MOVE AL-UANOF               TO SC-STOPA   (SC-INDX).
  4277
  4278 6260-CHECK-EMPLOYER-FORM.
  4279
  4280     IF AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES
  4281        IF (AT-EMP-FORM-ANSWERED-DT = LOW-VALUES)
  4282                          OR
  4283           (AT-EMP-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4284            AT-EMP-FORM-ANSWERED-DT = BIN-CURRENT-DATE)
  4285              NEXT SENTENCE
  4286          ELSE
  4287              GO TO 6280-CHECK-PHYSICIAN-FORM
  4288     ELSE
  4289        GO TO 6280-CHECK-PHYSICIAN-FORM.
  4290
  4291     IF SC-TYPE (SC-INDX) = 'C'
  4292        SET SC-INDX UP BY 1
  4293        ADD +1 TO PI-NEXT-TRLR-SUB.
  4294
  4295     IF AT-EMP-FORM-ANSWERED-DT NOT = LOW-VALUES
  4296        MOVE AT-EMP-FORM-ANSWERED-DT TO DC-BIN-DATE-1
  4297        MOVE SPACES                  TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  87
* EL162.cbl
  4298        PERFORM 9700-DATE-LINK
  4299        MOVE DC-GREG-DATE-1-EDIT     TO SC-REC (SC-INDX).
  4300
  4301     IF AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES
  4302        MOVE AT-EMP-FORM-SEND-ON-DT TO DC-BIN-DATE-1
  4303        MOVE SPACES                 TO DC-OPTION-CODE
  4304        PERFORM 9700-DATE-LINK
  4305        MOVE DC-GREG-DATE-1-EDIT    TO SC-SENT (SC-INDX).
  4306
  4307     IF AT-FORM-RE-SEND-DT NOT = LOW-VALUES
  4308        MOVE AT-FORM-RE-SEND-DT  TO DC-BIN-DATE-1
  4309        MOVE SPACES              TO DC-OPTION-CODE
  4310        PERFORM 9700-DATE-LINK
  4311        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4312
  4313     IF AT-FORM-FOLLOW-UP-DT NOT = LOW-VALUES
  4314        MOVE AT-FORM-FOLLOW-UP-DT   TO DC-BIN-DATE-1
  4315        MOVE SPACES                 TO DC-OPTION-CODE
  4316        PERFORM 9700-DATE-LINK
  4317        MOVE DC-GREG-DATE-1-EDIT    TO SC-FOLLOWUP (SC-INDX).
  4318
  4319     IF AT-FORM-TYPE = '1'
  4320        MOVE 'INIT'              TO SC-FORM (SC-INDX)
  4321     ELSE
  4322        MOVE 'PROG'              TO SC-FORM (SC-INDX).
  4323
  4324     IF FORM-TO-INSURED
  4325        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4326     ELSE
  4327     IF FORM-TO-ACCOUNT
  4328        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4329     ELSE
  4330     IF FORM-TO-OTHER-1
  4331        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4332     ELSE
  4333     IF FORM-TO-OTHER-2
  4334        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4335
  4336     MOVE 'EMPLOYER'             TO SC-ARCHIVE (SC-INDX).
  4337     MOVE 'E'                    TO SC-TYPE    (SC-INDX).
  4338     MOVE AT-SEQUENCE-NO         TO PI-TRLRS (PI-NEXT-TRLR-SUB)
  4339     MOVE AT-INSTRUCT-LN-1       TO SC-REASON  (SC-INDX).
  4340     MOVE AT-RECORDED-BY         TO SC-BY      (SC-INDX).
  4341     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO  (SC-INDX).
  4342     MOVE AL-UANOF               TO SC-RECA    (SC-INDX)
  4343                                    SC-STOPA   (SC-INDX).
  4344
  4345 6280-CHECK-PHYSICIAN-FORM.
  4346
  4347     IF AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES
  4348        IF (AT-PHY-FORM-ANSWERED-DT = LOW-VALUES)
  4349                         OR
  4350           (AT-PHY-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4351            AT-PHY-FORM-ANSWERED-DT = BIN-CURRENT-DATE)
  4352              NEXT SENTENCE
  4353          ELSE
  4354              GO TO 6299-EXIT
  4355     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  88
* EL162.cbl
  4356        GO TO 6299-EXIT.
  4357
  4358     IF SC-TYPE (SC-INDX) = 'C' OR 'E'
  4359        SET SC-INDX UP BY 1
  4360        ADD +1 TO PI-NEXT-TRLR-SUB.
  4361
  4362     IF AT-PHY-FORM-ANSWERED-DT NOT = LOW-VALUES
  4363        MOVE AT-PHY-FORM-ANSWERED-DT TO DC-BIN-DATE-1
  4364        MOVE SPACES                  TO DC-OPTION-CODE
  4365        PERFORM 9700-DATE-LINK
  4366        MOVE DC-GREG-DATE-1-EDIT     TO SC-REC (SC-INDX).
  4367
  4368     IF AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES
  4369        MOVE AT-PHY-FORM-SEND-ON-DT TO DC-BIN-DATE-1
  4370        MOVE SPACES                 TO DC-OPTION-CODE
  4371        PERFORM 9700-DATE-LINK
  4372        MOVE DC-GREG-DATE-1-EDIT    TO SC-SENT (SC-INDX).
  4373
  4374     IF AT-FORM-RE-SEND-DT NOT = LOW-VALUES
  4375        MOVE AT-FORM-RE-SEND-DT  TO DC-BIN-DATE-1
  4376        MOVE SPACES              TO DC-OPTION-CODE
  4377        PERFORM 9700-DATE-LINK
  4378        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4379
  4380     IF AT-FORM-FOLLOW-UP-DT NOT = LOW-VALUES
  4381        MOVE AT-FORM-FOLLOW-UP-DT   TO DC-BIN-DATE-1
  4382        MOVE SPACES                 TO DC-OPTION-CODE
  4383        PERFORM 9700-DATE-LINK
  4384        MOVE DC-GREG-DATE-1-EDIT    TO SC-FOLLOWUP (SC-INDX).
  4385
  4386     IF AT-FORM-TYPE = '1'
  4387        MOVE 'INIT'              TO SC-FORM (SC-INDX)
  4388     ELSE
  4389        MOVE 'PROG'              TO SC-FORM (SC-INDX).
  4390
  4391     IF FORM-TO-INSURED
  4392        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4393     ELSE
  4394     IF FORM-TO-ACCOUNT
  4395        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4396     ELSE
  4397     IF FORM-TO-OTHER-1
  4398        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4399     ELSE
  4400     IF FORM-TO-OTHER-2
  4401        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4402
  4403     MOVE ' DOCTOR '             TO SC-ARCHIVE (SC-INDX).
  4404     MOVE 'P'                    TO SC-TYPE    (SC-INDX).
  4405     MOVE AT-SEQUENCE-NO         TO PI-TRLRS (PI-NEXT-TRLR-SUB)
  4406     MOVE AT-INSTRUCT-LN-1       TO SC-REASON  (SC-INDX).
  4407     MOVE AT-RECORDED-BY         TO SC-BY      (SC-INDX).
  4408     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO  (SC-INDX).
  4409     MOVE AL-UANOF               TO SC-RECA    (SC-INDX)
  4410                                    SC-STOPA   (SC-INDX).
  4411
  4412 6299-EXIT.
  4413      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  89
* EL162.cbl
  4414
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  90
* EL162.cbl
  4416 7000-BUILD-SCREEN.
  4417
  4418     IF PI-CLAIM-NO = SPACES
  4419        MOVE ER-0319             TO EMI-ERROR
  4420        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4421        GO TO 8100-SEND-INITIAL-MAP.
  4422
  4423     PERFORM 3000-BUILD-KEYS.
  4424
  4425     MOVE PI-PROCESSOR-ID        TO UBYI.
  4426
  4427
  4428* EXEC CICS HANDLE CONDITION
  4429*         NOTOPEN(8870-CLAIM-NOT-OPEN)
  4430*         NOTFND (8860-CLAIM-NOT-FOUND)
  4431*    END-EXEC.
  4432*    MOVE '"$JI                  ! & #00004185' TO DFHEIV0
  4433     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  4434     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4435     MOVE X'2620233030303034313835' TO DFHEIV0(25:11)
  4436     CALL 'kxdfhei1' USING DFHEIV0
  4437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4438
  4439
  4440
  4441* EXEC CICS READ
  4442*         DATASET(ELMSTR-FILE-ID)
  4443*         RIDFLD (PI-CLAM-KEY)
  4444*         SET    (ADDRESS OF CLAIM-MASTER)
  4445*    END-EXEC.
  4446*    MOVE '&"S        E          (   #00004190' TO DFHEIV0
  4447     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4448     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4449     MOVE X'2020233030303034313930' TO DFHEIV0(25:11)
  4450     CALL 'kxdfhei1' USING DFHEIV0,
  4451           ELMSTR-FILE-ID,
  4452           DFHEIV20,
  4453           DFHEIV99,
  4454           PI-CLAM-KEY,
  4455           DFHEIV99,
  4456           DFHEIV99,
  4457           DFHEIV99
  4458     SET ADDRESS OF CLAIM-MASTER TO
  4459         DFHEIV20
  4460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4461
  4462
  4463     EVALUATE TRUE
  4464     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  4465        MOVE PI-LIFE-OVERRIDE-L6 TO TYPEI
  4466     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
  4467        MOVE PI-AH-OVERRIDE-L6   TO TYPEI
  4468     WHEN CL-CLAIM-TYPE = 'I'
  4469        MOVE ' IU   '            TO TYPEI
  4470     WHEN CL-CLAIM-TYPE = 'G'
  4471        MOVE ' GAP  '            TO TYPEI
  4472
  4473     WHEN CL-CLAIM-TYPE = 'F'
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  91
* EL162.cbl
  4474        MOVE ' FAM  '            TO TYPEI
  4475     END-EVALUATE
  4476
  4477     MOVE CL-INSURED-LAST-NAME   TO LASTNMEI.
  4478     MOVE CL-FILE-LOCATION       TO FILEI.
  4479     MOVE PI-ACTV-PARTIAL        TO PI-ACTV-SAVE.
  4480
  4481     IF CL-1ST-TRL-AVAIL
  4482        GO TO 7100-NOT-FOUND.
  4483
  4484 7010-START-BROWSE.
  4485
  4486
  4487* EXEC CICS HANDLE CONDITION
  4488*         NOTOPEN(8820-ACTV-NOT-OPEN)
  4489*         NOTFND (7100-NOT-FOUND)
  4490*         ENDFILE(7100-NOT-FOUND)
  4491*    END-EXEC.
  4492*    MOVE '"$JI''                 ! '' #00004219' TO DFHEIV0
  4493     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  4494     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4495     MOVE X'2720233030303034323139' TO DFHEIV0(25:11)
  4496     CALL 'kxdfhei1' USING DFHEIV0
  4497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4498
  4499
  4500
  4501* EXEC CICS STARTBR
  4502*         DATASET(ELTRLR-FILE-ID)
  4503*         RIDFLD (PI-ACTV-KEY)
  4504*         GTEQ
  4505*    END-EXEC.
  4506     MOVE 0
  4507       TO DFHEIV11
  4508*    MOVE '&,         G          &   #00004225' TO DFHEIV0
  4509     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4510     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4511     MOVE X'2020233030303034323235' TO DFHEIV0(25:11)
  4512     CALL 'kxdfhei1' USING DFHEIV0,
  4513           ELTRLR-FILE-ID,
  4514           PI-ACTV-KEY,
  4515           DFHEIV99,
  4516           DFHEIV11,
  4517           DFHEIV99
  4518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4519
  4520
  4521     SET SC-INDX TO 1.
  4522
  4523 7020-READ-NEXT.
  4524
  4525
  4526* EXEC CICS READNEXT
  4527*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  4528*         RIDFLD   (PI-ACTV-KEY)
  4529*         DATASET  (ELTRLR-FILE-ID)
  4530*    END-EXEC.
  4531     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  92
* EL162.cbl
  4532       TO DFHEIV11
  4533*    MOVE '&.S                   )   #00004235' TO DFHEIV0
  4534     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4535     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4536     MOVE X'2020233030303034323335' TO DFHEIV0(25:11)
  4537     CALL 'kxdfhei1' USING DFHEIV0,
  4538           ELTRLR-FILE-ID,
  4539           DFHEIV20,
  4540           DFHEIV99,
  4541           PI-ACTV-KEY,
  4542           DFHEIV99,
  4543           DFHEIV11,
  4544           DFHEIV99,
  4545           DFHEIV99
  4546     SET ADDRESS OF ACTIVITY-TRAILERS TO
  4547         DFHEIV20
  4548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4549
  4550
  4551     IF PI-ACTV-PARTIAL NOT = PI-ACTV-SAVE
  4552        GO TO 7100-NOT-FOUND.
  4553
  4554     IF AT-TRAILER-TYPE = '4' OR  'A'
  4555        NEXT SENTENCE
  4556     ELSE
  4557        GO TO 7020-READ-NEXT.
  4558
  4559     IF CORRESPONDENCE-TR
  4560        IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND
  4561           AT-LETTER-ANSWERED-DT NOT = BIN-CURRENT-DATE
  4562             GO TO 7020-READ-NEXT.
  4563
  4564     IF CORRESPONDENCE-TR AND
  4565        AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND
  4566        AT-RESEND-LETTER-FORM NOT = LOW-VALUES
  4567             GO TO 7020-READ-NEXT
  4568     END-IF.
  4569
  4570     IF CORRESPONDENCE-TR AND
  4571        AT-STOP-LETTER-DT NOT = LOW-VALUES AND
  4572        AT-STOP-LETTER-DT NOT = SPACES AND
  4573        AT-STOP-LETTER-DT NOT = BIN-CURRENT-DATE
  4574*        AT-STOP-LETTER-DT = AT-LETTER-SENT-DT
  4575             GO TO 7020-READ-NEXT
  4576     END-IF.
  4577
  4578     IF NOT FORM-CONTROL-TR
  4579        GO TO 7030-CONTINUE.
  4580
  4581     IF ((AT-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4582          AT-FORM-ANSWERED-DT NOT = BIN-CURRENT-DATE) OR
  4583          AT-FORM-SEND-ON-DT = LOW-VALUES)
  4584       AND
  4585        ((AT-EMP-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4586          AT-EMP-FORM-ANSWERED-DT NOT = BIN-CURRENT-DATE) OR
  4587          AT-EMP-FORM-SEND-ON-DT = LOW-VALUES)
  4588       AND
  4589        ((AT-PHY-FORM-ANSWERED-DT NOT = LOW-VALUES AND
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  93
* EL162.cbl
  4590          AT-PHY-FORM-ANSWERED-DT NOT = BIN-CURRENT-DATE) OR
  4591          AT-PHY-FORM-SEND-ON-DT = LOW-VALUES)
  4592             GO TO 7020-READ-NEXT.
  4593
  4594     IF (AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES) AND
  4595        (AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES)
  4596        IF SC-INDX > 2
  4597           MOVE PI-ACTV-SAVE-SEQ TO PI-ACTV-SEQ
  4598           GO TO 7040-END-BUILD-SCREEN.
  4599
  4600     IF (AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES) OR
  4601        (AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES)
  4602        IF SC-INDX > 3
  4603           MOVE PI-ACTV-SAVE-SEQ TO PI-ACTV-SEQ
  4604           GO TO 7040-END-BUILD-SCREEN.
  4605
  4606 7030-CONTINUE.
  4607
  4608     PERFORM 6200-FORMAT-DATA THRU 6299-EXIT.
  4609
  4610     MOVE PI-ACTV-SEQ             TO PI-ACTV-SAVE-SEQ.
  4611
  4612     MOVE AT-SEQUENCE-NO          TO PI-TRLRS (PI-NEXT-TRLR-SUB).
  4613
  4614     ADD 1   TO PI-NEXT-TRLR-SUB.
  4615     SET SC-INDX UP BY 1.
  4616
  4617     IF SC-INDX NOT = 5
  4618        GO TO 7020-READ-NEXT.
  4619
  4620 7040-END-BUILD-SCREEN.
  4621
  4622     IF SC-INDX = +2
  4623        ADD +3 TO PI-NEXT-TRLR-SUB
  4624     ELSE
  4625     IF SC-INDX = +3
  4626        ADD +2 TO PI-NEXT-TRLR-SUB
  4627     ELSE
  4628     IF SC-INDX = +4
  4629        ADD +1 TO PI-NEXT-TRLR-SUB.
  4630
  4631     MOVE -1                     TO SC-RECL (1).
  4632     GO TO 8100-SEND-INITIAL-MAP.
  4633
  4634 7100-NOT-FOUND.
  4635     IF PI-NEXT-TRLR-SUB = 1
  4636        MOVE ER-0320             TO EMI-ERROR
  4637        MOVE -1                  TO URECDTEL
  4638        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4639        GO TO 8100-SEND-INITIAL-MAP.
  4640
  4641     MOVE -1                     TO SC-RECL (1).
  4642
  4643*    IF ANY LINES WERE PRINTED THEN
  4644*    SET THE SUB TO ALWAYS BE 1 GREATER THAN A MULTIPLE OF 4.
  4645
  4646     SET INDX-WORK TO SC-INDX.
  4647
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  94
* EL162.cbl
  4648     IF SC-INDX NOT = 1
  4649        COMPUTE PI-NEXT-TRLR-SUB = (4 - INDX-WORK) + 1 +
  4650                                    PI-NEXT-TRLR-SUB.
  4651
  4652     IF EIBAID NOT = DFHPF1
  4653        GO TO 8100-SEND-INITIAL-MAP.
  4654
  4655     MOVE ER-0066                TO EMI-ERROR.
  4656     MOVE -1                     TO SC-RECL (1).
  4657
  4658     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4659
  4660     GO TO 8100-SEND-INITIAL-MAP.
  4661
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  95
* EL162.cbl
  4663 8100-SEND-INITIAL-MAP.
  4664     MOVE SAVE-DATE    TO RUNDTEO.
  4665     MOVE EIBTIME      TO TIME-IN.
  4666     MOVE TIME-OUT     TO RUNTIMEO.
  4667
  4668     IF NOT EMI-NO-ERRORS
  4669         SET EMI-INDX TO 1
  4670         MOVE EMI-MESSAGE-AREA (EMI-INDX) TO ERRMSG1O.
  4671
  4672     IF PI-COMPANY-ID NOT = 'DMD'
  4673         MOVE SPACES             TO PF4KEYO.
  4674
  4675     IF PI-RETURN-TO-PROGRAM = 'EL150'
  4676         MOVE SPACES             TO PF5KEYO.
  4677
  4678
  4679* EXEC CICS SEND
  4680*        MAP   (MAP-NAME)
  4681*        MAPSET(MAPSET-NAME)
  4682*        FROM  (EL162AO)
  4683*        ERASE
  4684*        CURSOR
  4685*    END-EXEC.
  4686     MOVE LENGTH OF
  4687      EL162AO
  4688       TO DFHEIV12
  4689     MOVE -1
  4690       TO DFHEIV11
  4691*    MOVE '8$     CT  E    H L F ,   #00004368' TO DFHEIV0
  4692     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  4693     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4694     MOVE X'2020233030303034333638' TO DFHEIV0(25:11)
  4695     CALL 'kxdfhei1' USING DFHEIV0,
  4696           MAP-NAME,
  4697           EL162AO,
  4698           DFHEIV12,
  4699           MAPSET-NAME,
  4700           DFHEIV99,
  4701           DFHEIV99,
  4702           DFHEIV99,
  4703           DFHEIV11,
  4704           DFHEIV99,
  4705           DFHEIV99,
  4706           DFHEIV99
  4707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4708
  4709
  4710     GO TO 9100-RETURN-TRAN.
  4711
  4712 8200-SEND-DATAONLY.
  4713     MOVE SAVE-DATE            TO RUNDTEO.
  4714     MOVE EIBTIME              TO TIME-IN.
  4715     MOVE TIME-OUT             TO RUNTIMEO.
  4716     MOVE EMI-MESSAGE-AREA (1) TO ERRMSG1O.
  4717
  4718     IF PI-COMPANY-ID NOT = 'DMD'
  4719         MOVE SPACES             TO PF4KEYO.
  4720
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  96
* EL162.cbl
  4721     IF PI-RETURN-TO-PROGRAM = 'EL150'
  4722         MOVE SPACES             TO PF5KEYO.
  4723
  4724
  4725* EXEC CICS SEND
  4726*        MAP   (MAP-NAME)
  4727*        MAPSET(MAPSET-NAME)
  4728*        FROM  (EL162AO)
  4729*        DATAONLY
  4730*        CURSOR
  4731*    END-EXEC.
  4732     MOVE LENGTH OF
  4733      EL162AO
  4734       TO DFHEIV12
  4735     MOVE -1
  4736       TO DFHEIV11
  4737*    MOVE '8$D    CT       H L F ,   #00004390' TO DFHEIV0
  4738     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4739     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4740     MOVE X'2020233030303034333930' TO DFHEIV0(25:11)
  4741     CALL 'kxdfhei1' USING DFHEIV0,
  4742           MAP-NAME,
  4743           EL162AO,
  4744           DFHEIV12,
  4745           MAPSET-NAME,
  4746           DFHEIV99,
  4747           DFHEIV99,
  4748           DFHEIV99,
  4749           DFHEIV11,
  4750           DFHEIV99,
  4751           DFHEIV99,
  4752           DFHEIV99
  4753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4754
  4755
  4756     GO TO 9100-RETURN-TRAN.
  4757
  4758 8300-SEND-TEXT.
  4759
  4760* EXEC CICS SEND TEXT
  4761*        FROM  (LOGOFF-TEXT)
  4762*        LENGTH(LOGOFF-LENGTH)
  4763*        ERASE
  4764*        FREEKB
  4765*    END-EXEC.
  4766*    MOVE '8&      T  E F  H   F -   #00004401' TO DFHEIV0
  4767     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4768     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4769     MOVE X'2020233030303034343031' TO DFHEIV0(25:11)
  4770     CALL 'kxdfhei1' USING DFHEIV0,
  4771           LOGOFF-TEXT,
  4772           LOGOFF-LENGTH,
  4773           DFHEIV99,
  4774           DFHEIV99,
  4775           DFHEIV99,
  4776           DFHEIV99,
  4777           DFHEIV99,
  4778           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  97
* EL162.cbl
  4779           DFHEIV99,
  4780           DFHEIV99,
  4781           DFHEIV99,
  4782           DFHEIV99
  4783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4784
  4785
  4786
  4787* EXEC CICS RETURN
  4788*    END-EXEC.
  4789*    MOVE '.(                    ''   #00004408' TO DFHEIV0
  4790     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4791     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4792     MOVE X'2020233030303034343038' TO DFHEIV0(25:11)
  4793     CALL 'kxdfhei1' USING DFHEIV0,
  4794           DFHEIV99,
  4795           DFHEIV99,
  4796           DFHEIV99,
  4797           DFHEIV99,
  4798           DFHEIV99,
  4799           DFHEIV99
  4800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4801
  4802
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  98
* EL162.cbl
  4804 8600-DEEDIT.
  4805
  4806* EXEC CICS BIF DEEDIT
  4807*        FIELD (DEEDIT-FIELD)
  4808*        LENGTH(15)
  4809*    END-EXEC.
  4810     MOVE 15
  4811       TO DFHEIV11
  4812*    MOVE '@"L                   #   #00004413' TO DFHEIV0
  4813     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4814     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4815     MOVE X'2020233030303034343133' TO DFHEIV0(25:11)
  4816     CALL 'kxdfhei1' USING DFHEIV0,
  4817           DEEDIT-FIELD,
  4818           DFHEIV11
  4819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4820
  4821
  4822 8800-UNAUTHORIZED-ACCESS.
  4823     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  4824     GO TO 8300-SEND-TEXT.
  4825
  4826 8810-PF23.
  4827     MOVE EIBAID                   TO PI-ENTRY-CD-1.
  4828     MOVE XCTL-005 TO PGM-NAME.
  4829     GO TO 9300-XCTL.
  4830
  4831 8820-ACTV-NOT-OPEN.
  4832     MOVE ER-0172                TO EMI-ERROR.
  4833     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4834     GO TO 8200-SEND-DATAONLY.
  4835
  4836 8860-CLAIM-NOT-FOUND.
  4837     MOVE ER-0319                TO EMI-ERROR.
  4838     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4839     GO TO 8100-SEND-INITIAL-MAP.
  4840
  4841 8870-CLAIM-NOT-OPEN.
  4842     MOVE ER-0042                TO EMI-ERROR.
  4843     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4844     GO TO 8200-SEND-DATAONLY.
  4845
  4846 8880-ACCT-NOT-OPEN.
  4847     MOVE ER-0168                TO EMI-ERROR
  4848     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4849     GO TO 8200-SEND-DATAONLY.
  4850
  4851 9100-RETURN-TRAN.
  4852     MOVE EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  4853     MOVE MAP-NUMBER           TO PI-CURRENT-SCREEN-NO.
  4854
  4855* EXEC CICS RETURN
  4856*        TRANSID(TRANS-ID)
  4857*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4858*        LENGTH(PI-COMM-LENGTH)
  4859*    END-EXEC.
  4860*    MOVE '.(CT                  ''   #00004450' TO DFHEIV0
  4861     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page  99
* EL162.cbl
  4862     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4863     MOVE X'2020233030303034343530' TO DFHEIV0(25:11)
  4864     CALL 'kxdfhei1' USING DFHEIV0,
  4865           TRANS-ID,
  4866           PROGRAM-INTERFACE-BLOCK,
  4867           PI-COMM-LENGTH,
  4868           DFHEIV99,
  4869           DFHEIV99,
  4870           DFHEIV99
  4871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4872
  4873
  4874 9200-RETURN-MAIN-MENU.
  4875     MOVE XCTL-126 TO PGM-NAME.
  4876     GO TO 9300-XCTL.
  4877
  4878 9300-XCTL.
  4879
  4880* EXEC CICS XCTL
  4881*        PROGRAM(PGM-NAME)
  4882*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4883*        LENGTH(PI-COMM-LENGTH)
  4884*    END-EXEC.
  4885*    MOVE '.$C                   %   #00004461' TO DFHEIV0
  4886     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4887     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4888     MOVE X'2020233030303034343631' TO DFHEIV0(25:11)
  4889     CALL 'kxdfhei1' USING DFHEIV0,
  4890           PGM-NAME,
  4891           PROGRAM-INTERFACE-BLOCK,
  4892           PI-COMM-LENGTH,
  4893           DFHEIV99
  4894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4895
  4896
  4897 9400-CLEAR.
  4898     MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME.
  4899     GO TO 9300-XCTL.
  4900
  4901 9500-PF12.
  4902     MOVE XCTL-010 TO PGM-NAME.
  4903     GO TO 9300-XCTL.
  4904
  4905 9600-PGMID-ERROR.
  4906
  4907* EXEC CICS HANDLE CONDITION
  4908*        PGMIDERR(8300-SEND-TEXT)
  4909*    END-EXEC.
  4910*    MOVE '"$L                   ! ( #00004476' TO DFHEIV0
  4911     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4912     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4913     MOVE X'2820233030303034343736' TO DFHEIV0(25:11)
  4914     CALL 'kxdfhei1' USING DFHEIV0
  4915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4916
  4917
  4918     MOVE PGM-NAME     TO PI-CALLING-PROGRAM.
  4919     MOVE ' '          TO PI-ENTRY-CD-1.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page 100
* EL162.cbl
  4920     MOVE XCTL-005     TO PGM-NAME.
  4921     MOVE PGM-NAME     TO LOGOFF-PGM.
  4922     MOVE PGMIDERR-MSG TO LOGOFF-FILL.
  4923     GO TO 9300-XCTL.
  4924
  4925 9700-DATE-LINK.
  4926     MOVE LINK-ELDATCV           TO PGM-NAME.
  4927
  4928
  4929* EXEC CICS LINK
  4930*         PROGRAM (PGM-NAME)
  4931*         COMMAREA(DATE-CONVERSION-DATA)
  4932*         LENGTH  (DC-COMM-LENGTH)
  4933*    END-EXEC.
  4934*    MOVE '."C                   (   #00004490' TO DFHEIV0
  4935     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4936     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4937     MOVE X'2020233030303034343930' TO DFHEIV0(25:11)
  4938     CALL 'kxdfhei1' USING DFHEIV0,
  4939           PGM-NAME,
  4940           DATE-CONVERSION-DATA,
  4941           DC-COMM-LENGTH,
  4942           DFHEIV99,
  4943           DFHEIV99,
  4944           DFHEIV99,
  4945           DFHEIV99
  4946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4947
  4948
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page 101
* EL162.cbl
  4950 9900-ERROR-FORMAT.
  4951     IF NOT EMI-ERRORS-COMPLETE
  4952         MOVE LINK-001 TO PGM-NAME
  4953
  4954* EXEC CICS LINK
  4955*            PROGRAM (PGM-NAME)
  4956*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  4957*            LENGTH  (EMI-COMM-LENGTH)
  4958*        END-EXEC.
  4959*    MOVE '."C                   (   #00004500' TO DFHEIV0
  4960     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4961     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4962     MOVE X'2020233030303034353030' TO DFHEIV0(25:11)
  4963     CALL 'kxdfhei1' USING DFHEIV0,
  4964           PGM-NAME,
  4965           ERROR-MESSAGE-INTERFACE-BLOCK,
  4966           EMI-COMM-LENGTH,
  4967           DFHEIV99,
  4968           DFHEIV99,
  4969           DFHEIV99,
  4970           DFHEIV99
  4971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4972
  4973
  4974 9900-EXIT.
  4975     EXIT.
  4976
  4977 9990-ABEND.
  4978     MOVE LINK-004 TO PGM-NAME.
  4979     MOVE DFHEIBLK TO EMI-LINE1.
  4980
  4981
  4982* EXEC CICS LINK
  4983*        PROGRAM (PGM-NAME)
  4984*        COMMAREA(EMI-LINE1)
  4985*        LENGTH  (72)
  4986*    END-EXEC.
  4987     MOVE 72
  4988       TO DFHEIV11
  4989*    MOVE '."C                   (   #00004513' TO DFHEIV0
  4990     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4991     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4992     MOVE X'2020233030303034353133' TO DFHEIV0(25:11)
  4993     CALL 'kxdfhei1' USING DFHEIV0,
  4994           PGM-NAME,
  4995           EMI-LINE1,
  4996           DFHEIV11,
  4997           DFHEIV99,
  4998           DFHEIV99,
  4999           DFHEIV99,
  5000           DFHEIV99
  5001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5002
  5003
  5004     GO TO 8200-SEND-DATAONLY.
  5005
  5006 9995-SECURITY-VIOLATION.
  5007*                            COPY ELCSCTP.
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page 102
* EL162.cbl
  5008******************************************************************
  5009*                                                                *
  5010*                            ELCSCTP                             *
  5011*                            VMOD=2.001                          *
  5012*                                                                *
  5013*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5014******************************************************************
  5015
  5016
  5017     MOVE EIBDATE          TO SM-JUL-DATE.
  5018     MOVE EIBTRMID         TO SM-TERMID.
  5019     MOVE THIS-PGM         TO SM-PGM.
  5020     MOVE EIBTIME          TO TIME-IN.
  5021     MOVE TIME-OUT         TO SM-TIME.
  5022     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5023
  5024
  5025* EXEC CICS LINK
  5026*         PROGRAM  ('EL003')
  5027*         COMMAREA (SECURITY-MESSAGE)
  5028*         LENGTH   (80)
  5029*    END-EXEC.
  5030     MOVE 'EL003' TO DFHEIV1
  5031     MOVE 80
  5032       TO DFHEIV11
  5033*    MOVE '."C                   (   #00004539' TO DFHEIV0
  5034     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5035     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5036     MOVE X'2020233030303034353339' TO DFHEIV0(25:11)
  5037     CALL 'kxdfhei1' USING DFHEIV0,
  5038           DFHEIV1,
  5039           SECURITY-MESSAGE,
  5040           DFHEIV11,
  5041           DFHEIV99,
  5042           DFHEIV99,
  5043           DFHEIV99,
  5044           DFHEIV99
  5045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5046
  5047
  5048******************************************************************
  5049
  5050
  5051
  5052 9999-DFHBACK SECTION.
  5053     MOVE '9%                    "   ' TO DFHEIV0
  5054     MOVE 'EL162' TO DFHEIV1
  5055     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5056     GOBACK.
  5057 9999-DFHEXIT.
  5058     IF DFHEIGDJ EQUAL 0001
  5059         NEXT SENTENCE
  5060     ELSE IF DFHEIGDJ EQUAL 2
  5061         GO TO 9600-PGMID-ERROR,
  5062               9990-ABEND
  5063         DEPENDING ON DFHEIGDI
  5064     ELSE IF DFHEIGDJ EQUAL 3
  5065         GO TO 4199-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Jun-17 13:04 Page 103
* EL162.cbl
  5066         DEPENDING ON DFHEIGDI
  5067     ELSE IF DFHEIGDJ EQUAL 4
  5068         GO TO 4290-ERROR
  5069         DEPENDING ON DFHEIGDI
  5070     ELSE IF DFHEIGDJ EQUAL 5
  5071         GO TO 8880-ACCT-NOT-OPEN,
  5072               4250-ACCT-NOT-FOUND
  5073         DEPENDING ON DFHEIGDI
  5074     ELSE IF DFHEIGDJ EQUAL 6
  5075         GO TO 8870-CLAIM-NOT-OPEN,
  5076               8860-CLAIM-NOT-FOUND
  5077         DEPENDING ON DFHEIGDI
  5078     ELSE IF DFHEIGDJ EQUAL 7
  5079         GO TO 8820-ACTV-NOT-OPEN,
  5080               7100-NOT-FOUND,
  5081               7100-NOT-FOUND
  5082         DEPENDING ON DFHEIGDI
  5083     ELSE IF DFHEIGDJ EQUAL 8
  5084         GO TO 8300-SEND-TEXT
  5085         DEPENDING ON DFHEIGDI.
  5086     MOVE '9%                    "   ' TO DFHEIV0
  5087     MOVE 'EL162' TO DFHEIV1
  5088     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5089     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5420     Code:       14043
