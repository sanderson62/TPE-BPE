* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   1
* SOCK03.cbl
* Options: int("SOCK03.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK03.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK03.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   2
* SOCK03.cbl
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35******************************************************************
    36*                   C H A N G E   L O G
    37*
    38* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    39*-----------------------------------------------------------------
    40*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    41* EFFECTIVE    NUMBER
    42*-----------------------------------------------------------------
    43* 071112  IR2012042700001  PEMA  AHL CHANGES
    44* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
    45* 010213  CR2011083000005  PEMA  ADD SPECIAL DCC SPP DDF REFUND
    46* 101813  IR2013101700003  PEMA  FIX MN Net Balloon calc.
    47* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    48* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    49* 072415  IR2015071500003  PEMA  REMOVE CLOSE STATEMENT
    50******************************************************************
    51 environment division.
    52 data division.
    53 working-storage section.
    54 01  DFH-START PIC X(04).
    55*
    56* program buffers
    57*
    58 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    59     88  ALREADY-SENT              VALUE 'Y'.
    60 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
    61 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
    62     88  ELCERT-FINISHED            VALUE 'Y'.
    63 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
    64 77  WS-ERACCT-SW                PIC X VALUE SPACES.
    65     88  ERACCT-FOUND               VALUE 'Y'.
    66 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
    67 77 ws-send-msg-size           pic s9(8) comp value 4096.
    68 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    69 77 ws-recv-buf                pic x(4096).
    70 77 ws-send-buf                pic x(4096) VALUE SPACES.
    71 77 ws-recv-total              pic s9(8) comp value 0.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   3
* SOCK03.cbl
    72 77 ws-recv-left               pic s9(8) comp value 0.
    73 77 ws-seq-num                 pic s9(8) comp value 0.
    74 77 ws-flags                   pic s9(8) comp value 0.
    75 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    76 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
    77 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    78 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    79 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    80 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    81 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    82 77  ws-cancel-reason            pic x   value spaces.
    83 77  P1                          PIC S999 COMP-3 VALUE +0.
    84 77  P2                          PIC S999 COMP-3 VALUE +0.
    85 77  C0                          PIC S999 COMP-3 VALUE +0.
    86 77  C1                          PIC S999 COMP-3 VALUE +0.
    87 77  C2                          PIC S999 COMP-3 VALUE +0.
    88 77  C3                          PIC S999 COMP-3 VALUE +0.
    89 77 S1                           PIC S999 COMP-3 VALUE +0.
    90 77 S2                           PIC S999 COMP-3 VALUE +0.
    91 77 L1                           PIC S999 COMP-3 VALUE +0.
    92 77 L2                           PIC S999 COMP-3 VALUE +0.
    93 77 F1                           PIC S999 COMP-3 VALUE +0.
    94 77 WS-BUILD-SW                  PIC X.
    95    88  TIME-TO-BUILD               VALUE 'Y'.
    96 77 WS-SAVE-ERACCT               PIC X(2000).
    97 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    98 77 WS-STOP-SW                   PIC X  VALUE ' '.
    99    88  TOLD-TO-STOP               VALUE 'Y'.
   100 77 WS-PERFORM-SW                PIC X VALUE SPACES.
   101    88  GET-RATES                    VALUE 'R'.
   102    88  GET-ACT-ACCTS                VALUE 'A'.
   103 77 ws-bin-1st-pay-dt            pic xx  value low-values.
   104 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
   105 77 ws-disp-rate                 pic z9.99999.
   106 77  WS-ERCTBL-SW                PIC X VALUE ' '.
   107     88  END-OF-ERCTBL                 VALUE 'Y'.
   108 77  WS-STATUS                   PIC X.
   109 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
   110 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
   111 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
   112 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
   113 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   114 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   115 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   116 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   117 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   118 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   119 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
   120 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
   121     88  WS-ELCERT-FULL             VALUE '1'.
   122     88  WS-ELCERT-NAME             VALUE '2'.
   123     88  WS-ELCERT-CERT-NO          VALUE '3'.
   124     88  WS-ELCERT-ACT-NAME         VALUE '4'.
   125 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
   126 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   127     88  I-SAY-TO-STOP      VALUE 'Y'.
   128 77  WS-HEX-0A                   PIC X.
   129 77  WS-CALL-TYPE                PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   4
* SOCK03.cbl
   130 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
   131 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
   132 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   133 77  DD-IU-SW                    PIC X   VALUE ' '.
   134     88  DD-IU-PRESENT                 VALUE 'Y'.
   135 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   136 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   137 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   138 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   139 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   140 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   141 77  ws-ah-rfnd-clp              pic s9(7)v99 comp-3 value +0.
   142 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   143 77  WS-PDEF-RECORD-SW           PIC X           VALUE ' '.
   144     88  PDEF-FOUND                              VALUE 'Y'.
   145 77  ws-epiq-sw                  pic x  value ' '.
   146     88  ws-epiq-request           value 'Y'.
   147 77  ws-epiq-max                 pic s999 value +0 comp-3.
   148 01  WS-STRING-DATA.
   149     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   150     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   151     05  WS-CARRIER              PIC X        VALUE SPACES.
   152     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   153     05  WS-STATE                PIC XX       VALUE SPACES.
   154     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   155     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   156     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   157     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
   158     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   159     05  WS-MID-INIT             PIC X        VALUE SPACES.
   160     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   161     05  WS-LF-COVERAGE-TYPE     PIC X        VALUE SPACES.
   162     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   163     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   164     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   165     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   166     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   167     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   168     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   169     05  WS-LF-METHOD            PIC X(10)    VALUE SPACES.
   170     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   171     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
   172     05  WS-AH-COVERAGE-TYPE     PIC X        VALUE SPACES.
   173     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   174     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   175     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   176     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
   177     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
   178     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
   179     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
   180     05  WS-AH-METHOD            PIC X(10)    VALUE SPACES.
   181     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
   182     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
   183     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
   184     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   185     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
   186     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
   187     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   5
* SOCK03.cbl
   188     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   189     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   190     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   191     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   192     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
   193     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
   194     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   195     05  WS-MID-JINIT            PIC X        VALUE SPACES.
   196     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   197     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   198     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   199 01  ws-work-date.
   200     05  ws-work-ccyy            pic x(4).
   201     05  ws-work-mm              pic xx.
   202     05  ws-work-dd              pic xx.
   203 01  ws-work-date-num redefines ws-work-date
   204                                 pic 9(8).
   205 01  FILLER.
   206     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   207     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   208     12  WS-STATE-ABBREVIATION   PIC XX.
   209     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   210     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   211     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   212     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   213     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   214     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   215     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   216     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   217     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   218     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   219     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   220     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   221     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   222     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   223     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   224     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   225     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   226     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   227     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   228     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   229     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   230     12  WS-LF-OVERRIDE-L1       PIC  X(01).
   231     12  WS-LF-OVERRIDE-L2       PIC  X(02).
   232     12  WS-AH-OVERRIDE-L1       PIC  X(01).
   233     12  WS-AH-OVERRIDE-L2       PIC  X(02).
   234     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   235         88  WS-REDUCING                         VALUE 'R'.
   236         88  WS-LEVEL                            VALUE 'L'  'P'.
   237 01  ELMSTR-KEY.
   238     12  ELMSTR-COMP-CD          PIC X.
   239     12  ELMSTR-CERT-NO          PIC X(11).
   240 01  CTBL-KEY-SAVE               PIC X(5).
   241 01  CTBL-KEY.
   242     05  CTBL-COMPANY-CD         PIC X.
   243     05  CTBL-TABLE              PIC XXX.
   244     05  CTBL-BEN-TYPE           PIC X.
   245     05  CTBL-BEN-CODE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   6
* SOCK03.cbl
   246 01  ERPDEF-KEY-SAVE             PIC X(18).
   247 01  ERPDEF-KEY.
   248     12  ERPDEF-COMPANY-CD       PIC X.
   249     12  ERPDEF-STATE            PIC XX.
   250     12  ERPDEF-PROD-CD          PIC XXX.
   251     12  F                       PIC X(7).
   252     12  ERPDEF-BEN-TYPE         PIC X.
   253     12  ERPDEF-BEN-CODE         PIC XX.
   254     12  ERPDEF-EXP-DT           PIC XX.
   255 01  WS-AM3-KEY.
   256     12  WS-AM3-ACCOUNT          PIC X(10).
   257     12  WS-AM3-EXP-DT           PIC XX.
   258 01  WS-AM-KEY.
   259     12  WS-AM-COMPANY-CD        PIC X.
   260     12  WS-AM-CARRIER           PIC X.
   261     12  WS-AM-GROUPING          PIC X(6).
   262     12  WS-AM-STATE             PIC XX.
   263     12  WS-AM-ACCOUNT           PIC X(10).
   264     12  WS-AM-EXPIRATION-DT     PIC XX.
   265     12  WS-AM-FILLER            PIC XXXX.
   266 01  WS-CO-DATA.
   267     05  WS-CO-NUM               PIC X(10).
   268     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   269     05  WS-CO-NAME              PIC X(30).
   270     05  WS-CO-MAIL-NAME         PIC X(30).
   271     05  WS-CO-ADDR1             PIC X(30).
   272     05  WS-CO-ADDR2             PIC X(30).
   273     05  WS-CO-ADDR3             PIC X(30).
   274     05  WS-CO-ZIP               PIC X(9).
   275     05  WS-CO-PHONE             PIC X(10).
   276 01  WS-CF-KEY.
   277     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   278     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   279*        88  COMPANY-MASTER                      VALUE '1'.
   280*        88  STATE-MASTER                        VALUE '3'.
   281*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   282*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   283     12  WS-CF-ACCESS.
   284         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   285         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   286             20  FILLER          PIC  X(01).
   287             20  WS-CF-CARRIER   PIC  X(01).
   288     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   289 01  WS-CM-KEY.
   290     05  WS-CM-COMPANY-CD        PIC X.
   291     05  WS-CM-CARRIER           PIC X.
   292     05  WS-CM-GROUP             PIC X(6).
   293     05  WS-CM-STATE             PIC XX.
   294     05  WS-CM-ACCOUNT           PIC X(10).
   295     05  WS-CM-EFF-DT            PIC XX.
   296     05  WS-CM-CERT-NO           PIC X(11).
   297 01  WS-CM-KEY-A1.
   298     05  WS-CM-COMPANY-CD-A1     PIC X.
   299     05  WS-CM-LAST-NAME         PIC X(15).
   300     05  WS-CM-INITIALS          PIC XX.
   301 01  WS-CM-KEY-A4.
   302     05  WS-CM-COMPANY-CD-A4     PIC X.
   303     05  WS-CM-CERT-NO-A4        PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   7
* SOCK03.cbl
   304 01  WS-CID-NO                   PIC X(8).
   305 01  WS-DISP-RESP                PIC 9(5).
   306 01  WS-RESPONSE                 PIC S9(8)   COMP.
   307     88  RESP-NORMAL                  VALUE +00.
   308     88  RESP-NOTFND                  VALUE +13.
   309     88  RESP-DUPKEY                  VALUE +15.
   310     88  RESP-NOTOPEN                 VALUE +19.
   311     88  RESP-ENDFILE                 VALUE +20.
   312*                                 COPY ELCCERT.
   313******************************************************************
   314*                                                                *
   315*                            ELCCERT.                            *
   316*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   317*                            VMOD=2.013                          *
   318*                                                                *
   319*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   320*                                                                *
   321*   FILE TYPE = VSAM,KSDS                                        *
   322*   RECORD SIZE = 450  RECFORM = FIXED                           *
   323*                                                                *
   324*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   325*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   326*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   327*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   328*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   329*                                                                *
   330*   LOG = YES                                                    *
   331*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   332******************************************************************
   333*                   C H A N G E   L O G
   334*
   335* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   336*-----------------------------------------------------------------
   337*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   338* EFFECTIVE    NUMBER
   339*-----------------------------------------------------------------
   340* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   341* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   342* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   343* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   344* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   345* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   346* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   347* 032612  CR2011110200001  PEMA  AHL CHANGES
   348* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   349******************************************************************
   350
   351 01  CERTIFICATE-MASTER.
   352     12  CM-RECORD-ID                      PIC XX.
   353         88  VALID-CM-ID                      VALUE 'CM'.
   354
   355     12  CM-CONTROL-PRIMARY.
   356         16  CM-COMPANY-CD                 PIC X.
   357         16  CM-CARRIER                    PIC X.
   358         16  CM-GROUPING.
   359             20  CM-GROUPING-PREFIX        PIC X(3).
   360             20  CM-GROUPING-PRIME         PIC X(3).
   361         16  CM-STATE                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   8
* SOCK03.cbl
   362         16  CM-ACCOUNT.
   363             20  CM-ACCOUNT-PREFIX         PIC X(4).
   364             20  CM-ACCOUNT-PRIME          PIC X(6).
   365         16  CM-CERT-EFF-DT                PIC XX.
   366         16  CM-CERT-NO.
   367             20  CM-CERT-PRIME             PIC X(10).
   368             20  CM-CERT-SFX               PIC X.
   369
   370     12  CM-CONTROL-BY-NAME.
   371         16  CM-COMPANY-CD-A1              PIC X.
   372         16  CM-INSURED-LAST-NAME          PIC X(15).
   373         16  CM-INSURED-INITIALS.
   374             20  CM-INSURED-INITIAL1       PIC X.
   375             20  CM-INSURED-INITIAL2       PIC X.
   376
   377     12  CM-CONTROL-BY-SSN.
   378         16  CM-COMPANY-CD-A2              PIC X.
   379         16  CM-SOC-SEC-NO.
   380             20  CM-SSN-STATE              PIC XX.
   381             20  CM-SSN-ACCOUNT            PIC X(6).
   382             20  CM-SSN-LN3.
   383                 25  CM-INSURED-INITIALS-A2.
   384                     30 CM-INSURED-INITIAL1-A2   PIC X.
   385                     30 CM-INSURED-INITIAL2-A2   PIC X.
   386                 25 CM-PART-LAST-NAME-A2         PIC X.
   387
   388     12  CM-CONTROL-BY-CERT-NO.
   389         16  CM-COMPANY-CD-A4              PIC X.
   390         16  CM-CERT-NO-A4                 PIC X(11).
   391
   392     12  CM-CONTROL-BY-MEMB.
   393         16  CM-COMPANY-CD-A5              PIC X.
   394         16  CM-MEMBER-NO.
   395             20  CM-MEMB-STATE             PIC XX.
   396             20  CM-MEMB-ACCOUNT           PIC X(6).
   397             20  CM-MEMB-LN4.
   398                 25  CM-INSURED-INITIALS-A5.
   399                     30 CM-INSURED-INITIAL1-A5   PIC X.
   400                     30 CM-INSURED-INITIAL2-A5   PIC X.
   401                 25 CM-PART-LAST-NAME-A5         PIC XX.
   402
   403     12  CM-INSURED-PROFILE-DATA.
   404         16  CM-INSURED-FIRST-NAME.
   405             20  CM-INSURED-1ST-INIT       PIC X.
   406             20  FILLER                    PIC X(9).
   407         16  CM-INSURED-ISSUE-AGE          PIC 99.
   408         16  CM-INSURED-SEX                PIC X.
   409             88  CM-SEX-MALE                  VALUE 'M'.
   410             88  CM-SEX-FEMAL                 VALUE 'F'.
   411         16  CM-INSURED-JOINT-AGE          PIC 99.
   412         16  CM-JOINT-INSURED-NAME.
   413             20  CM-JT-LAST-NAME           PIC X(15).
   414             20  CM-JT-FIRST-NAME.
   415                 24  CM-JT-1ST-INIT        PIC X.
   416                 24  FILLER                PIC X(9).
   417             20  CM-JT-INITIAL             PIC X.
   418
   419     12  CM-LIFE-DATA.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page   9
* SOCK03.cbl
   420         16  CM-LF-BENEFIT-CD              PIC XX.
   421         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   422         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   423         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   424         16  CM-LF-DEV-CODE                PIC XXX.
   425         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   426         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   427         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   428         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   429         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   430         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   431         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   432         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   433         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   434         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   435         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   436         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   437         16  cm-temp-epiq                  pic xx.
   438             88  EPIQ-CLASS                  value 'EQ'.
   439*        16  FILLER                        PIC XX.
   440
   441     12  CM-AH-DATA.
   442         16  CM-AH-BENEFIT-CD              PIC XX.
   443         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   444         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   445         16  CM-AH-DEV-CODE                PIC XXX.
   446         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   447         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   448         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   449         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   450         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   451         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   452         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   453         16  CM-AH-PAID-THRU-DT            PIC XX.
   454             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   455         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   456         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
   457         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   458         16  FILLER                        PIC X.
   459
   460     12  CM-LOAN-INFORMATION.
   461         16  CM-LIVES                      PIC S9(7)     COMP-3.
   462         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   463                                           PIC S9(5)V99  COMP-3.
   464         16  CM-BILLED                     PIC S9(7)     COMP-3.
   465         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   466         16  CM-PAY-FREQUENCY              PIC S99.
   467         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   468         16  CM-RATE-CLASS                 PIC XX.
   469         16  CM-BENEFICIARY                PIC X(25).
   470         16  CM-POLICY-FORM-NO             PIC X(12).
   471         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   472         16  CM-LAST-ADD-ON-DT             PIC XX.
   473         16  CM-DEDUCTIBLE-AMOUNTS.
   474             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   475             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   476         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   477             20  CM-RESIDENT-STATE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  10
* SOCK03.cbl
   478             20  CM-RATE-CODE              PIC X(4).
   479             20  FILLER                    PIC XX.
   480         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   481             20  CM-LOAN-OFFICER           PIC X(5).
   482             20  FILLER                    PIC XXX.
   483         16  CM-CSR-CODE                   PIC XXX.
   484         16  CM-UNDERWRITING-CODE          PIC X.
   485             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   486         16  CM-POST-CARD-IND              PIC X.
   487         16  CM-NH-INTERFACE-SW            PIC X.
   488         16  CM-PREMIUM-TYPE               PIC X.
   489             88  CM-SING-PRM                  VALUE '1'.
   490             88  CM-O-B-COVERAGE              VALUE '2'.
   491             88  CM-OPEN-END                  VALUE '3'.
   492         16  CM-IND-GRP-TYPE               PIC X.
   493             88  CM-INDIVIDUAL                VALUE 'I'.
   494             88  CM-GROUP                     VALUE 'G'.
   495         16  CM-SKIP-CODE                  PIC X.
   496             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   497             88  SKIP-JULY                    VALUE '1'.
   498             88  SKIP-AUGUST                  VALUE '2'.
   499             88  SKIP-SEPTEMBER               VALUE '3'.
   500             88  SKIP-JULY-AUG                VALUE '4'.
   501             88  SKIP-AUG-SEPT                VALUE '5'.
   502             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   503             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   504             88  SKIP-JUNE                    VALUE '8'.
   505             88  SKIP-JUNE-JULY               VALUE '9'.
   506             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   507             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   508         16  CM-PAYMENT-MODE               PIC X.
   509             88  PAY-MONTHLY                  VALUE SPACE.
   510             88  PAY-WEEKLY                   VALUE '1'.
   511             88  PAY-SEMI-MONTHLY             VALUE '2'.
   512             88  PAY-BI-WEEKLY                VALUE '3'.
   513             88  PAY-SEMI-ANUALLY             VALUE '4'.
   514         16  CM-LOAN-NUMBER                PIC X(8).
   515         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   516         16  CM-OLD-LOF                    PIC XXX.
   517*        16  CM-LOAN-OFFICER               PIC XXX.
   518         16  CM-REIN-TABLE                 PIC XXX.
   519         16  CM-SPECIAL-REIN-CODE          PIC X.
   520         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   521         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   522         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   523
   524     12  CM-STATUS-DATA.
   525         16  CM-ENTRY-STATUS               PIC X.
   526         16  CM-ENTRY-DT                   PIC XX.
   527
   528         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   529         16  CM-LF-CANCEL-DT               PIC XX.
   530         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   531
   532         16  CM-LF-STATUS-AT-DEATH         PIC X.
   533         16  CM-LF-DEATH-DT                PIC XX.
   534         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   535
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  11
* SOCK03.cbl
   536         16  CM-LF-CURRENT-STATUS          PIC X.
   537             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   538                                                'M' '4' '5' '9'.
   539             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   540             88  CM-LF-POLICY-PENDING         VALUE '2'.
   541             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   542             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   543             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   544             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   545             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   546             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   547             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   548             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   549             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   550             88  CM-LF-DECLINED               VALUE 'D'.
   551             88  CM-LF-VOIDED                 VALUE 'V'.
   552
   553         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   554         16  CM-AH-CANCEL-DT               PIC XX.
   555         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   556
   557         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   558         16  CM-AH-SETTLEMENT-DT           PIC XX.
   559         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   560
   561         16  CM-AH-CURRENT-STATUS          PIC X.
   562             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   563                                                'M' '4' '5' '9'.
   564             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   565             88  CM-AH-POLICY-PENDING         VALUE '2'.
   566             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   567             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   568             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   569             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   570             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   571             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   572             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   573             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   574             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   575             88  CM-AH-DECLINED               VALUE 'D'.
   576             88  CM-AH-VOIDED                 VALUE 'V'.
   577
   578         16  CM-CLAIM-INTERFACE-SW         PIC X.
   579             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   580             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   581             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   582         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   583
   584         16  CM-ENTRY-BATCH                PIC X(6).
   585         16  CM-LF-EXIT-BATCH              PIC X(6).
   586         16  CM-AH-EXIT-BATCH              PIC X(6).
   587         16  CM-LAST-MONTH-END             PIC XX.
   588
   589     12  CM-NOTE-SW                        PIC X.
   590         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   591         88  CERT-NOTES-PRESENT               VALUE '1'.
   592         88  BILLING-NOTES-PRESENT            VALUE '2'.
   593         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  12
* SOCK03.cbl
   594         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   595         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   596         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   597         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   598     12  CM-COMP-EXCP-SW                   PIC X.
   599         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   600         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   601     12  CM-INSURED-ADDRESS-SW             PIC X.
   602         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   603         88  INSURED-ADDR-PRESENT             VALUE '1'.
   604
   605*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   606     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   607     12  FILLER                            PIC X.
   608
   609*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   610     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   611     12  FILLER                            PIC X.
   612*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   613     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
   614
   615     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   616         88  CERT-ADDED-BATCH                 VALUE ' '.
   617         88  CERT-ADDED-ONLINE                VALUE '1'.
   618         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   619         88  CERT-PURGED-OFFLINE              VALUE '3'.
   620         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   621     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   622         88  CERT-AS-LOADED                   VALUE ' '.
   623         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   624         88  CERT-CLAIM-ONLINE                VALUE '2'.
   625         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   626         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   627         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   628         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   629         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   630
   631     12  CM-ACCOUNT-COMM-PCTS.
   632         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   633         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   634
   635     12  CM-USER-FIELD                     PIC X.
   636     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   637     12  CM-CLP-STATE                      PIC XX.
   638     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   639     12  CM-USER-RESERVED                  PIC XXX.
   640     12  FILLER REDEFINES CM-USER-RESERVED.
   641         16  CM-AH-CLASS-CD                PIC XX.
   642         16  F                             PIC X.
   643******************************************************************
   644*                                 COPY ELCMSTR.
   645******************************************************************
   646*                                                                *
   647*                            ELCMSTR.                            *
   648*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   649*                            VMOD=2.012                          *
   650*                                                                *
   651*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  13
* SOCK03.cbl
   652*                                                                *
   653*   FILE TYPE = VSAM,KSDS                                        *
   654*   RECORD SIZE = 350  RECFORM = FIXED                           *
   655*                                                                *
   656*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   657*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   658*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   659*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   660*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   661*                                                 RKP=75,LEN=21  *
   662*                                                                *
   663*   **** NOTE ****                                               *
   664*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   665*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   666*                                                                *
   667*   LOG = YES                                                    *
   668*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   669******************************************************************
   670*                   C H A N G E   L O G
   671*
   672* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   673*-----------------------------------------------------------------
   674*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   675* EFFECTIVE    NUMBER
   676*-----------------------------------------------------------------
   677* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   678* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   679* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   680* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   681* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   682******************************************************************
   683 01  CLAIM-MASTER.
   684     12  CL-RECORD-ID                PIC XX.
   685         88  VALID-CL-ID         VALUE 'CL'.
   686
   687     12  CL-CONTROL-PRIMARY.
   688         16  CL-COMPANY-CD           PIC X.
   689         16  CL-CARRIER              PIC X.
   690         16  CL-CLAIM-NO             PIC X(7).
   691         16  CL-CERT-NO.
   692             20  CL-CERT-PRIME       PIC X(10).
   693             20  CL-CERT-SFX         PIC X.
   694
   695     12  CL-CONTROL-BY-NAME.
   696         16  CL-COMPANY-CD-A1        PIC X.
   697         16  CL-INSURED-LAST-NAME    PIC X(15).
   698         16  CL-INSURED-NAME.
   699             20  CL-INSURED-1ST-NAME PIC X(12).
   700             20  CL-INSURED-MID-INIT PIC X.
   701
   702     12  CL-CONTROL-BY-SSN.
   703         16  CL-COMPANY-CD-A2        PIC X.
   704         16  CL-SOC-SEC-NO.
   705             20  CL-SSN-STATE        PIC XX.
   706             20  CL-SSN-ACCOUNT      PIC X(6).
   707             20  CL-SSN-LN3          PIC X(3).
   708
   709     12  CL-CONTROL-BY-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  14
* SOCK03.cbl
   710         16  CL-COMPANY-CD-A4        PIC X.
   711         16  CL-CERT-NO-A4.
   712             20  CL-CERT-A4-PRIME    PIC X(10).
   713             20  CL-CERT-A4-SFX      PIC X.
   714
   715     12  CL-CONTROL-BY-CCN.
   716         16  CL-COMPANY-CD-A5        PIC X.
   717         16  CL-CCN-A5.
   718             20  CL-CCN.
   719                 24  CL-CCN-PREFIX-A5 PIC X(4).
   720                 24  CL-CCN-PRIME-A5 PIC X(12).
   721             20  CL-CCN-FILLER-A5    PIC X(4).
   722
   723     12  CL-INSURED-PROFILE-DATA.
   724         16  CL-INSURED-BIRTH-DT     PIC XX.
   725         16  CL-INSURED-SEX-CD       PIC X.
   726             88  INSURED-IS-MALE        VALUE 'M'.
   727             88  INSURED-IS-FEMALE      VALUE 'F'.
   728             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   729         16  CL-INSURED-OCC-CD       PIC X(6).
   730         16  FILLER                  PIC X(5).
   731
   732     12  CL-PROCESSING-INFO.
   733         16  CL-PROCESSOR-ID         PIC X(4).
   734         16  CL-CLAIM-STATUS         PIC X.
   735             88  CLAIM-IS-OPEN          VALUE 'O'.
   736             88  CLAIM-IS-CLOSED        VALUE 'C'.
   737         16  CL-CLAIM-TYPE           PIC X.
   738*            88  AH-CLAIM               VALUE 'A'.
   739*            88  LIFE-CLAIM             VALUE 'L'.
   740*            88  PROPERTY-CLAIM         VALUE 'P'.
   741*            88  IUI-CLAIM              VALUE 'I'.
   742*            88  GAP-CLAIM              VALUE 'G'.
   743*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   744         16  CL-CLAIM-PREM-TYPE      PIC X.
   745             88  SINGLE-PREMIUM         VALUE '1'.
   746             88  O-B-COVERAGE           VALUE '2'.
   747             88  OPEN-END-COVERAGE      VALUE '3'.
   748         16  CL-INCURRED-DT          PIC XX.
   749         16  CL-REPORTED-DT          PIC XX.
   750         16  CL-FILE-ESTABLISH-DT    PIC XX.
   751         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   752         16  CL-LAST-PMT-DT          PIC XX.
   753         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   754         16  CL-PAID-THRU-DT         PIC XX.
   755         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   756         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   757         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   758         16  CL-PMT-CALC-METHOD      PIC X.
   759             88  CL-360-DAY-YR          VALUE '1'.
   760             88  CL-365-DAY-YR          VALUE '2'.
   761             88  CL-FULL-MONTHS         VALUE '3'.
   762         16  CL-CAUSE-CD             PIC X(6).
   763
   764         16  CL-PRIME-CERT-NO.
   765             20  CL-PRIME-CERT-PRIME PIC X(10).
   766             20  CL-PRIME-CERT-SFX   PIC X.
   767
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  15
* SOCK03.cbl
   768         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   769             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   770             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   771
   772         16  CL-MICROFILM-NO         PIC X(10).
   773         16  FILLER REDEFINES CL-MICROFILM-NO.
   774             20  CL-BENEFIT-PERIOD   PIC 99.
   775             20  FILLER              PIC X(8).
   776         16  CL-PROG-FORM-TYPE       PIC X.
   777         16  CL-LAST-ADD-ON-DT       PIC XX.
   778
   779         16  CL-LAST-REOPEN-DT       PIC XX.
   780         16  CL-LAST-CLOSE-DT        PIC XX.
   781         16  CL-LAST-CLOSE-REASON    PIC X(01).
   782             88  FINAL-PAID             VALUE '1'.
   783             88  CLAIM-DENIED           VALUE '2'.
   784             88  AUTO-CLOSE             VALUE '3'.
   785             88  MANUAL-CLOSE           VALUE '4'.
   786             88  BENEFITS-CHANGED       VALUE 'C'.
   787             88  SETUP-ERRORS           VALUE 'E'.
   788         16  CL-ASSOC-CERT-SEQU      PIC S99.
   789         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   790         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   791             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   792         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   793         16  FILLER                  PIC X.
   794
   795     12  CL-CERTIFICATE-DATA.
   796         16  CL-CERT-ORIGIN          PIC X.
   797             88  CERT-WAS-ONLINE        VALUE '1'.
   798             88  CERT-WAS-CREATED       VALUE '2'.
   799             88  COVERAGE-WAS-ADDED     VALUE '3'.
   800         16  CL-CERT-KEY-DATA.
   801             20  CL-CERT-CARRIER     PIC X.
   802             20  CL-CERT-GROUPING    PIC X(6).
   803             20  CL-CERT-STATE       PIC XX.
   804             20  CL-CERT-ACCOUNT.
   805                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   806                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   807             20  CL-CERT-EFF-DT      PIC XX.
   808
   809     12  CL-STATUS-CONTROLS.
   810         16  CL-PRIORITY-CD          PIC X.
   811             88  CONFIDENTIAL-DATA      VALUE '8'.
   812             88  HIGHEST-PRIORITY       VALUE '9'.
   813         16  CL-SUPV-ATTN-CD         PIC X.
   814             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   815             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   816         16  CL-PURGED-DT            PIC XX.
   817         16  CL-RESTORED-DT          PIC XX.
   818         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   819         16  CL-NEXT-RESEND-DT       PIC XX.
   820         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   821         16  CL-CRITICAL-PERIOD      PIC 99.
   822*        16  FILLER                  PIC XX.
   823         16  CL-LAST-MAINT-DT        PIC XX.
   824         16  CL-LAST-MAINT-USER      PIC X(4).
   825         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  16
* SOCK03.cbl
   826         16  CL-LAST-MAINT-TYPE      PIC X.
   827             88  CLAIM-SET-UP           VALUE ' '.
   828             88  PAYMENT-MADE           VALUE '1'.
   829             88  LETTER-SENT            VALUE '2'.
   830             88  MASTER-WAS-ALTERED     VALUE '3'.
   831             88  MASTER-WAS-RESTORED    VALUE '4'.
   832             88  INCURRED-DATE-CHANGED  VALUE '5'.
   833             88  FILE-CONVERTED         VALUE '6'.
   834             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   835             88  ERROR-CORRECTION       VALUE 'E'.
   836         16  CL-RELATED-CLAIM-NO     PIC X(7).
   837         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   838         16  CL-BENEFICIARY          PIC X(10).
   839         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   840         16  CL-DENIAL-TYPE          PIC X.
   841             88  CL-TYPE-DENIAL          VALUE '1'.
   842             88  CL-TYPE-RESCISSION      VALUE '2'.
   843             88  CL-TYPE-REFORMATION     VALUE '3'.
   844             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   845             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   846         16  filler                  pic x(5).
   847*        16  CL-CRIT-PER-RECURRENT   PIC X.
   848*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   849*        16  CL-RTW-DT               PIC XX.
   850
   851     12  CL-TRAILER-CONTROLS.
   852         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   853             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   854             88  CL-LAST-TRL-AVAIL      VALUE +100.
   855             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   856         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   857         16  FILLER                  PIC XX.
   858         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   859         16  CL-ADDRESS-TRAILER-CNT.
   860             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   861                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   862             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   863                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   864             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   865                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   866             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   867                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   868             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   869                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   870             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   871                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   872             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   873                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   874
   875     12  CL-CV-REFERENCE-NO.
   876         16  CL-CV-REFNO-PRIME       PIC X(18).
   877         16  CL-CV-REFNO-SFX         PIC XX.
   878
   879     12  CL-FILE-LOCATION            PIC X(4).
   880
   881     12  CL-PROCESS-ERRORS.
   882         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   883             88  NO-FATAL-ERRORS        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  17
* SOCK03.cbl
   884         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   885             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   886
   887     12  CL-PRODUCT-CD               PIC X.
   888
   889     12  CL-CURRENT-KEY-DATA.
   890         16  CL-CURRENT-CARRIER      PIC X.
   891         16  CL-CURRENT-GROUPING     PIC X(6).
   892         16  CL-CURRENT-STATE        PIC XX.
   893         16  CL-CURRENT-ACCOUNT      PIC X(10).
   894
   895     12  CL-ASSOCIATES               PIC X.
   896         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   897         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   898         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   899         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   900
   901     12  CL-ACTIVITY-CODE            PIC 99.
   902     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   903     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   904
   905     12  CL-LAPSE-REPORT-CODE        PIC 9.
   906     12  CL-LAG-REPORT-CODE          PIC 9.
   907     12  CL-LOAN-TYPE                PIC XX.
   908     12  CL-LEGAL-STATE              PIC XX.
   909
   910     12  CL-YESNOSW                  PIC X.
   911     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   912         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   913         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   914         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   915     12  cl-insured-type             pic x.
   916         88  cl-claim-on-primary         value 'P'.
   917         88  cl-claim-on-co-borrower     value 'C'.
   918     12  cl-benefit-expiration-dt    PIC XX.
   919*                                 COPY ERCPDEF.
   920******************************************************************
   921*                                                                *
   922*                                                                *
   923*                            ERCPDEF.                            *
   924*                                                                *
   925*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   926*                                                                *
   927*    FILE TYPE = VSAM,KSDS                                       *
   928*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   929*                                                                *
   930*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   931*                                                                *
   932*    LOG = YES                                                   *
   933*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   934******************************************************************
   935*                   C H A N G E   L O G
   936*
   937* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   938*-----------------------------------------------------------------
   939*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   940* EFFECTIVE    NUMBER
   941*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  18
* SOCK03.cbl
   942* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   943* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   944* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   945******************************************************************
   946 01  PRODUCT-MASTER.
   947    12  PD-RECORD-ID                 PIC X(02).
   948        88  VALID-PD-ID                  VALUE 'PD'.
   949    12  PD-CONTROL-PRIMARY.
   950        16  PD-COMPANY-CD            PIC X.
   951        16  PD-STATE                 PIC XX.
   952        16  PD-PRODUCT-CD            PIC XXX.
   953        16  PD-FILLER                PIC X(7).
   954        16  PD-BEN-TYPE              PIC X.
   955        16  PD-BEN-CODE              PIC XX.
   956        16  PD-PROD-EXP-DT           PIC XX.
   957    12  FILLER                       PIC X(50).
   958    12  PD-PRODUCT-DATA OCCURS 8.
   959        16  PD-PROD-CODE             PIC X.
   960            88  PD-PROD-LIFE           VALUE 'L'.
   961            88  PD-PROD-PROP           VALUE 'P'.
   962            88  PD-PROD-AH             VALUE 'A'.
   963            88  PD-PROD-IU             VALUE 'I'.
   964            88  PD-PROD-GAP            VALUE 'G'.
   965            88  PD-PROD-FAML           VALUE 'F'.
   966        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   967        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   968        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   969        16  PD-MAX-TERM              PIC S999        COMP-3.
   970        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   971        16  FILLER                   PIC X.
   972        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   973        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   974        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   975        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   976        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   977        16  PD-REC-CRIT-PERIOD       PIC 99.
   978        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   979            20  PD-RECURRING-YN      PIC X.
   980            20  FILLER               PIC X.
   981        16  PD-RTW-MOS               PIC 99.
   982        16  PD-MAX-EXTENSION         PIC 99.
   983        16  pd-ben-pct               pic sv999 comp-3.
   984*       16  FILLER                   PIC XX.
   985    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   986    12  PD-TERM-LIMITS OCCURS 15.
   987        16  PD-LOW-TERM              PIC S999        COMP-3.
   988        16  PD-HI-TERM               PIC S999        COMP-3.
   989*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   990    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   991        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   992        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   993    12  PD-EARN-FACTORS.
   994        16  FILLER OCCURS 15.
   995            20  FILLER OCCURS 15.
   996                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   997    12  PD-PRODUCT-DESC              PIC X(80).
   998    12  PD-TRUNCATED                 PIC X.
   999    12  FILLER                       PIC X(59).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  19
* SOCK03.cbl
  1000    12  PD-MAINT-INFORMATION.
  1001        16  PD-LAST-MAINT-DT         PIC X(02).
  1002        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  1003        16  PD-LAST-MAINT-BY         PIC X(04).
  1004*                                 COPY ERCCTBL.
  1005******************************************************************
  1006*                                                                *
  1007*                                                                *
  1008*                            ERCCTBL                             *
  1009*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1010*                            VMOD=2.003
  1011*                                                                *
  1012*   ONLINE CREDIT SYSTEM                                         *
  1013*                                                                *
  1014*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  1015*                                                                *
  1016*   FILE TYPE = VSAM,KSDS                                        *
  1017*   RECORD SIZE = 200   RECFORM = FIXED                          *
  1018*                                                                *
  1019*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  1020*       ALTERNATE PATH = NONE                                    *
  1021*                                                                *
  1022*   LOG = NO                                                     *
  1023*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1024*                                                                *
  1025*                                                                *
  1026******************************************************************
  1027
  1028 01  COMM-TABLE-RECORD.
  1029     12  CT-RECORD-ID                      PIC XX.
  1030         88  VALID-CT-ID                      VALUE 'CT'.
  1031
  1032     12  CT-CONTROL-PRIMARY.
  1033         16  CT-COMPANY-CD                 PIC X.
  1034         16  CT-TABLE                      PIC XXX.
  1035         16  CT-CNTRL-2.
  1036             20  CT-BEN-TYPE               PIC X.
  1037             20  CT-BEN-CODE               PIC XX.
  1038
  1039     12  CT-MAINT-INFORMATION.
  1040         16  CT-LAST-MAINT-DT              PIC XX.
  1041         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1042         16  CT-LAST-MAINT-USER            PIC X(4).
  1043         16  FILLER                        PIC X(31).
  1044
  1045     12  CT-LIMITS.
  1046         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  1047
  1048         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  1049
  1050         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  1051
  1052     12  CT-RATES.
  1053         16  CT-RTX          OCCURS 27 TIMES.
  1054             20  CT-RT                     PIC SV9(5)     COMP-3.
  1055             20  CT-RT-R   REDEFINES
  1056                 CT-RT                     PIC XXX.
  1057
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  20
* SOCK03.cbl
  1058     12  FILLER                            PIC  X(42).
  1059
  1060******************************************************************
  1061*                                 COPY ELCCNTL.
  1062******************************************************************
  1063*                                                                *
  1064*                                                                *
  1065*                            ELCCNTL.                            *
  1066*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1067*                            VMOD=2.059                          *
  1068*                                                                *
  1069*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1070*                                                                *
  1071*   FILE TYPE = VSAM,KSDS                                        *
  1072*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1073*                                                                *
  1074*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1075*       ALTERNATE INDEX = NONE                                   *
  1076*                                                                *
  1077*   LOG = YES                                                    *
  1078*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1079******************************************************************
  1080*                   C H A N G E   L O G
  1081*
  1082* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1083*-----------------------------------------------------------------
  1084*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1085* EFFECTIVE    NUMBER
  1086*-----------------------------------------------------------------
  1087* 082503                   PEMA  ADD BENEFIT GROUP
  1088* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1089* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1090* 092705    2005050300006  PEMA  ADD SPP LEASES
  1091* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1092* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1093* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1094* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1095* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1096* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1097* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1098* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1099* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1100* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1101******************************************************************
  1102*
  1103 01  CONTROL-FILE.
  1104     12  CF-RECORD-ID                       PIC XX.
  1105         88  VALID-CF-ID                        VALUE 'CF'.
  1106
  1107     12  CF-CONTROL-PRIMARY.
  1108         16  CF-COMPANY-ID                  PIC XXX.
  1109         16  CF-RECORD-TYPE                 PIC X.
  1110             88  CF-COMPANY-MASTER              VALUE '1'.
  1111             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1112             88  CF-STATE-MASTER                VALUE '3'.
  1113             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1114             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1115             88  CF-CARRIER-MASTER              VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  21
* SOCK03.cbl
  1116             88  CF-MORTALITY-MASTER            VALUE '7'.
  1117             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1118             88  CF-TERMINAL-MASTER             VALUE '9'.
  1119             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1120             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1121             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1122             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1123             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1124             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1125             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1126             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1127             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1128         16  CF-ACCESS-CD-GENL              PIC X(4).
  1129         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1130             20  CF-PROCESSOR               PIC X(4).
  1131         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1132             20  CF-STATE-CODE              PIC XX.
  1133             20  FILLER                     PIC XX.
  1134         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1135             20  FILLER                     PIC XX.
  1136             20  CF-HI-BEN-IN-REC           PIC XX.
  1137         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1138             20  FILLER                     PIC XXX.
  1139             20  CF-CARRIER-CNTL            PIC X.
  1140         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1141             20  FILLER                     PIC XX.
  1142             20  CF-HI-TYPE-IN-REC          PIC 99.
  1143         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1144             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1145                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1146             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1147             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1148         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1149             20  FILLER                     PIC X.
  1150             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1151         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1152             20  FILLER                     PIC XX.
  1153             20  CF-MORTGAGE-PLAN           PIC XX.
  1154         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1155
  1156     12  CF-LAST-MAINT-DT                   PIC XX.
  1157     12  CF-LAST-MAINT-BY                   PIC X(4).
  1158     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1159
  1160     12  CF-RECORD-BODY                     PIC X(728).
  1161
  1162
  1163****************************************************************
  1164*             COMPANY MASTER RECORD                            *
  1165****************************************************************
  1166
  1167     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1168         16  CF-COMPANY-ADDRESS.
  1169             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1170             20  CF-CL-IN-CARE-OF           PIC X(30).
  1171             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1172             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1173             20  CF-CL-CITY-STATE           PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  22
* SOCK03.cbl
  1174             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1175             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1176         16  CF-COMPANY-CD                  PIC X.
  1177         16  CF-COMPANY-PASSWORD            PIC X(8).
  1178         16  CF-SECURITY-OPTION             PIC X.
  1179             88  ALL-SECURITY                   VALUE '1'.
  1180             88  COMPANY-VERIFY                 VALUE '2'.
  1181             88  PROCESSOR-VERIFY               VALUE '3'.
  1182             88  NO-SECURITY                    VALUE '4'.
  1183             88  ALL-BUT-TERM                   VALUE '5'.
  1184         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1185             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1186         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1187             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1188         16  CF-INFORCE-LOCATION            PIC X.
  1189             88  CERTS-ARE-ONLINE               VALUE '1'.
  1190             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1191             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1192         16  CF-LOWER-CASE-LETTERS          PIC X.
  1193         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1194             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1195             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1196             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1197             88  CF-ACCNT-CNTL                  VALUE '3'.
  1198             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1199
  1200         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1201         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1202
  1203         16  CF-LGX-CREDIT-USER             PIC X.
  1204             88  CO-IS-NOT-USER                 VALUE 'N'.
  1205             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1206
  1207         16 CF-CREDIT-CALC-CODES.
  1208             20  CF-CR-REM-TERM-CALC PIC X.
  1209               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1210               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1211               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1212               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1213               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1214               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1215               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1216             20  CF-CR-R78-METHOD           PIC X.
  1217               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1218               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1219
  1220         16  CF-CLAIM-CONTROL-COUNTS.
  1221             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1222                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1223
  1224             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1225                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1226
  1227             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1228                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1229
  1230             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1231                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  23
* SOCK03.cbl
  1232
  1233         16  CF-CURRENT-MONTH-END           PIC XX.
  1234
  1235         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1236             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1237             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1238             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1239             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1240                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1241                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1242             20  CF-CO-PREM-REJECT-SW       PIC X.
  1243                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1244                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1245             20  CF-CO-REF-REJECT-SW        PIC X.
  1246                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1247                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1248
  1249         16  CF-CO-REPORTING-DT             PIC XX.
  1250         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1251         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1252           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1253           88  CF-CO-MONTH-END                  VALUE '1'.
  1254
  1255         16  CF-LGX-CLAIM-USER              PIC X.
  1256             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1257             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1258
  1259         16  CF-CREDIT-EDIT-CONTROLS.
  1260             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1261             20  CF-MIN-AGE                 PIC 99.
  1262             20  CF-DEFAULT-AGE             PIC 99.
  1263             20  CF-MIN-TERM                PIC S999      COMP-3.
  1264             20  CF-MAX-TERM                PIC S999      COMP-3.
  1265             20  CF-DEFAULT-SEX             PIC X.
  1266             20  CF-JOINT-AGE-INPUT         PIC X.
  1267                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1268             20  CF-BIRTH-DATE-INPUT        PIC X.
  1269                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1270             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1271                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1272                 88  CF-ZERO-CARRIER            VALUE '1'.
  1273                 88  CF-ZERO-GROUPING           VALUE '2'.
  1274                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1275             20  CF-EDIT-SW                 PIC X.
  1276                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1277             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1278             20  CF-CR-PR-METHOD            PIC X.
  1279               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1280               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1281             20  FILLER                     PIC X.
  1282
  1283         16  CF-CREDIT-MISC-CONTROLS.
  1284             20  CF-REIN-TABLE-SW           PIC X.
  1285                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1286             20  CF-COMP-TABLE-SW           PIC X.
  1287                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1288             20  CF-EXPERIENCE-RETENTION-AGE
  1289                                            PIC S9        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  24
* SOCK03.cbl
  1290             20  CF-CONVERSION-DT           PIC XX.
  1291             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1292             20  CF-RUN-FREQUENCY-SW        PIC X.
  1293                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1294                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1295
  1296             20  CF-CR-CHECK-NO-CONTROL.
  1297                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1298                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1299                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1300                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1301                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1302                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1303
  1304                 24  CF-CR-CHECK-COUNT       REDEFINES
  1305                     CF-CR-CHECK-COUNTER      PIC X(4).
  1306
  1307                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1308                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1309
  1310                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1311                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1312                 24  CF-MAIL-PROCESSING       PIC X.
  1313                     88  MAIL-PROCESSING          VALUE 'Y'.
  1314
  1315         16  CF-MISC-SYSTEM-CONTROL.
  1316             20  CF-SYSTEM-C                 PIC X.
  1317                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1318             20  CF-SYSTEM-D                 PIC X.
  1319                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1320             20  CF-SOC-SEC-NO-SW            PIC X.
  1321                 88  SOC-SEC-NO-USED             VALUE '1'.
  1322             20  CF-MEMBER-NO-SW             PIC X.
  1323                 88  MEMBER-NO-USED              VALUE '1'.
  1324             20  CF-TAX-ID-NUMBER            PIC X(11).
  1325             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1326             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1327                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1328                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1329                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1330                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1331             20  CF-SYSTEM-E                 PIC X.
  1332                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1333
  1334         16  CF-LGX-LIFE-USER               PIC X.
  1335             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1336             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1337
  1338         16  CF-CR-MONTH-END-DT             PIC XX.
  1339
  1340         16  CF-FILE-MAINT-DATES.
  1341             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1342                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1343             20  CF-LAST-BATCH       REDEFINES
  1344                 CF-LAST-BATCH-NO               PIC X(4).
  1345             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1346             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1347             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  25
* SOCK03.cbl
  1348             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1349             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1350             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1351             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1352             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1353             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1354             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1355
  1356         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1357         16  FILLER                         PIC X.
  1358
  1359         16  CF-ALT-MORT-CODE               PIC X(4).
  1360         16  CF-MEMBER-CAPTION              PIC X(10).
  1361
  1362         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1363             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1364             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1365             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1366             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1367             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1368
  1369         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1370
  1371         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1372         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1373         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1374         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1375
  1376         16  CF-AH-OVERRIDE-L1              PIC X.
  1377         16  CF-AH-OVERRIDE-L2              PIC XX.
  1378         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1379         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1380
  1381         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1382         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1383
  1384         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1385         16  CF-AR-LAST-EL860-DT            PIC XX.
  1386         16  CF-MP-MONTH-END-DT             PIC XX.
  1387
  1388         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1389         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1390             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1391
  1392         16  CF-AR-MONTH-END-DT             PIC XX.
  1393
  1394         16  CF-CRDTCRD-USER                PIC X.
  1395             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1396             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1397
  1398         16  CF-CC-MONTH-END-DT             PIC XX.
  1399
  1400         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1401
  1402         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1403             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1404             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1405             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  26
* SOCK03.cbl
  1406         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1407         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1408         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1409         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1410             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1411             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1412         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1413         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1414         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1415             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1416         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1417
  1418         16  CF-CL-ZIP-CODE.
  1419             20  CF-CL-ZIP-PRIME.
  1420                 24  CF-CL-ZIP-1ST          PIC X.
  1421                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1422                 24  FILLER                 PIC X(4).
  1423             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1424         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1425             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1426             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1427             20  FILLER                     PIC XXX.
  1428
  1429         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1430         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1431         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1432         16  CF-CO-OPTION-START-DATE        PIC XX.
  1433         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1434           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1435                                                      '3' '4'.
  1436           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1437           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1438           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1439           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1440           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1441           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1442
  1443         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1444
  1445         16  CF-PAYMENT-APPROVAL-LEVELS.
  1446             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1447             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1448             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1449             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1450             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1451             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1452
  1453         16  CF-END-USER-REPORTING-USER     PIC X.
  1454             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1455             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1456
  1457         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1458             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1459             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1460
  1461         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1462
  1463         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  27
* SOCK03.cbl
  1464         16  FILLER                         PIC X.
  1465
  1466         16  CF-CREDIT-ARCHIVE-CNTL.
  1467             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1468             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1469             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1470
  1471         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1472
  1473         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1474             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1475             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1476
  1477         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1478             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1479             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1480
  1481         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1482
  1483         16  CF-CO-ACH-ID-CODE              PIC  X.
  1484             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1485             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1486             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1487         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1488         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1489         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1490         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1491         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1492         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1493         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1494         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1495         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1496                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1497         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1498                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1499
  1500         16  CF-CO-OVER-SHORT.
  1501             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1502             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1503
  1504*         16  FILLER                         PIC X(102).
  1505         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1506             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1507             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1508
  1509         16  CF-AH-APPROVAL-DAYS.
  1510             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1511             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1512             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1513             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1514
  1515         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1516
  1517         16  CF-APPROV-LEV-5.
  1518             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1519             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1520             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1521
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  28
* SOCK03.cbl
  1522         16  FILLER                         PIC X(68).
  1523****************************************************************
  1524*             PROCESSOR/USER RECORD                            *
  1525****************************************************************
  1526
  1527     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1528         16  CF-PROCESSOR-NAME              PIC X(30).
  1529         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1530         16  CF-PROCESSOR-TITLE             PIC X(26).
  1531         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1532                 88  MESSAGE-YES                VALUE 'Y'.
  1533                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1534
  1535*****************************************************
  1536****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1537****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1538****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1539****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1540*****************************************************
  1541
  1542         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1543             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1544             20  CF-APPLICATION-FORCE       PIC X.
  1545             20  CF-INDIVIDUAL-APP.
  1546                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1547                     28  CF-BROWSE-APP      PIC X.
  1548                     28  CF-UPDATE-APP      PIC X.
  1549
  1550         16  CF-CURRENT-TERM-ON             PIC X(4).
  1551         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1552             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1553             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1554             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1555             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1556             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1557             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1558             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1559         16  CF-PROCESSOR-CARRIER           PIC X.
  1560             88  NO-CARRIER-SECURITY            VALUE ' '.
  1561         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1562             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1563         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1564             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1565         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1566             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1567
  1568         16  CF-PROC-SYS-ACCESS-SW.
  1569             20  CF-PROC-CREDIT-CLAIMS-SW.
  1570                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1571                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1572                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1573                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1574             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1575                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1576                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1577             20  CF-PROC-LIFE-GNRLDGR-SW.
  1578                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1579                     88  ACCESS-TO-LIFE             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  29
* SOCK03.cbl
  1580                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1581                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1582             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1583                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1584                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1585         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1586             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1587             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1588         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1589
  1590         16  CF-APPROVAL-LEVEL                  PIC X.
  1591             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1592             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1593             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1594             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1595             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1596
  1597         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1598
  1599         16  CF-LANGUAGE-TYPE                   PIC X.
  1600             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1601             88  CF-LANG-IS-FR                      VALUE 'F'.
  1602
  1603         16  CF-CSR-IND                         PIC X.
  1604         16  FILLER                             PIC X(239).
  1605
  1606****************************************************************
  1607*             PROCESSOR/REMINDERS RECORD                       *
  1608****************************************************************
  1609
  1610     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1611         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1612             20  CF-START-REMIND-DT         PIC XX.
  1613             20  CF-END-REMIND-DT           PIC XX.
  1614             20  CF-REMINDER-TEXT           PIC X(50).
  1615         16  FILLER                         PIC X(296).
  1616
  1617
  1618****************************************************************
  1619*             STATE MASTER RECORD                              *
  1620****************************************************************
  1621
  1622     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1623         16  CF-STATE-ABBREVIATION          PIC XX.
  1624         16  CF-STATE-NAME                  PIC X(25).
  1625         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1626         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1627             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1628             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1629             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1630             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1631                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1632                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1633             20  CF-ST-PREM-REJECT-SW       PIC X.
  1634                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1635                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1636             20  CF-ST-REF-REJECT-SW        PIC X.
  1637                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  30
* SOCK03.cbl
  1638                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1639         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1640         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1641         16  CF-ST-REFUND-RULES.
  1642             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1643             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1644             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1645         16  CF-ST-FST-PMT-EXTENSION.
  1646             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1647             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1648                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1649                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1650                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1651                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1652         16  CF-ST-STATE-CALL.
  1653             20  CF-ST-CALL-UNEARNED        PIC X.
  1654             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1655             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1656         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1657             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1658             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1659         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1660         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1661         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1662         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1663         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1664         16  FILLER                         PIC X.
  1665         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1666             20  CF-ST-BENEFIT-CD           PIC XX.
  1667             20  CF-ST-BENEFIT-KIND         PIC X.
  1668                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1669                 88  CF-ST-AH-KIND              VALUE 'A'.
  1670             20  CF-ST-REM-TERM-CALC        PIC X.
  1671                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1672                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1673                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1674                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1675                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1676                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1677                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1678                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1679
  1680             20  CF-ST-REFUND-CALC          PIC X.
  1681                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1682                 88  ST-REFD-BY-R78             VALUE '1'.
  1683                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1684                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1685                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1686                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1687                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1688                 88  ST-REFD-UTAH               VALUE '7'.
  1689                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1690                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1691                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1692
  1693             20  CF-ST-EARNING-CALC         PIC X.
  1694                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1695                 88  ST-EARN-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  31
* SOCK03.cbl
  1696                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1697                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1698                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1699                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1700                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1701                 88  ST-EARN-MEAN               VALUE '8'.
  1702                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1703
  1704             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1705                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1706                 88  ST-OVRD-BY-R78             VALUE '1'.
  1707                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1708                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1709                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1710                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1711                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1712                 88  ST-OVRD-MEAN               VALUE '8'.
  1713                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1714             20  FILLER                     PIC X.
  1715
  1716         16  CF-ST-COMMISSION-CAPS.
  1717             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1718             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1719             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1720             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1721         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1722                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1723
  1724         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1725
  1726         16  CF-ST-STATUTORY-INTEREST.
  1727             20  CF-ST-STAT-DATE-FROM       PIC X.
  1728                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1729                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1730             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1731             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1732             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1733             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1734             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1735
  1736         16  CF-ST-OVER-SHORT.
  1737             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1738             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1739
  1740         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1741
  1742         16  CF-ST-RT-CALC                  PIC X.
  1743
  1744         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1745         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1746         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1747         16  CF-ST-RF-LR-CALC               PIC X.
  1748         16  CF-ST-RF-LL-CALC               PIC X.
  1749         16  CF-ST-RF-LN-CALC               PIC X.
  1750         16  CF-ST-RF-AH-CALC               PIC X.
  1751         16  CF-ST-RF-CP-CALC               PIC X.
  1752*        16  FILLER                         PIC X(206).
  1753*CIDMOD         16  FILLER                         PIC X(192).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  32
* SOCK03.cbl
  1754         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1755             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1756         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1757         16  CF-ST-VFY-2ND-BENE             PIC X.
  1758         16  CF-ST-CAUSAL-STATE             PIC X.
  1759         16  FILLER                         PIC X(185).
  1760
  1761****************************************************************
  1762*             BENEFIT MASTER RECORD                            *
  1763****************************************************************
  1764
  1765     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1766         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1767             20  CF-BENEFIT-CODE            PIC XX.
  1768             20  CF-BENEFIT-NUMERIC  REDEFINES
  1769                 CF-BENEFIT-CODE            PIC XX.
  1770             20  CF-BENEFIT-ALPHA           PIC XXX.
  1771             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1772             20  CF-BENEFIT-COMMENT         PIC X(10).
  1773
  1774             20  CF-LF-COVERAGE-TYPE        PIC X.
  1775                 88  CF-REDUCING                VALUE 'R'.
  1776                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1777
  1778             20  CF-SPECIAL-CALC-CD         PIC X.
  1779                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1780                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1781                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1782                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1783                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1784                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1785                 88  CF-FARM-PLAN               VALUE 'F'.
  1786                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1787                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1788                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1789                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1790                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1791                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1792                 88  CF-PRUDENTIAL              VALUE 'P'.
  1793                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1794                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1795                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1796                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1797                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1798                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1799
  1800             20  CF-JOINT-INDICATOR         PIC X.
  1801                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1802
  1803*            20  FILLER                     PIC X(12).
  1804             20  cf-maximum-benefits        pic s999 comp-3.
  1805             20  FILLER                     PIC X(09).
  1806             20  CF-BENEFIT-CATEGORY        PIC X.
  1807             20  CF-LOAN-TYPE               PIC X(8).
  1808
  1809             20  CF-CO-REM-TERM-CALC        PIC X.
  1810                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1811                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  33
* SOCK03.cbl
  1812                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1813                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1814                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1815
  1816             20  CF-CO-EARNINGS-CALC        PIC X.
  1817                 88  CO-EARN-BY-R78             VALUE '1'.
  1818                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1819                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1820                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1821                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1822                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1823                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1824                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1825
  1826             20  CF-CO-REFUND-CALC          PIC X.
  1827                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1828                 88  CO-REFD-BY-R78             VALUE '1'.
  1829                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1830                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1831                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1832                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1833                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1834                 88  CO-REFD-MEAN               VALUE '8'.
  1835                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1836                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1837                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1838
  1839             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1840                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1841                 88  CO-OVRD-BY-R78             VALUE '1'.
  1842                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1843                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1844                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1845                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1846                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1847                 88  CO-OVRD-MEAN               VALUE '8'.
  1848                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1849
  1850             20  CF-CO-BEN-I-G-CD           PIC X.
  1851                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1852                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1853                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1854
  1855         16  FILLER                         PIC X(304).
  1856
  1857
  1858****************************************************************
  1859*             CARRIER MASTER RECORD                            *
  1860****************************************************************
  1861
  1862     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1863         16  CF-ADDRESS-DATA.
  1864             20  CF-MAIL-TO-NAME            PIC X(30).
  1865             20  CF-IN-CARE-OF              PIC X(30).
  1866             20  CF-ADDRESS-LINE-1          PIC X(30).
  1867             20  CF-ADDRESS-LINE-2          PIC X(30).
  1868             20  CF-CITY-STATE              PIC X(30).
  1869             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  34
* SOCK03.cbl
  1870             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1871
  1872         16  CF-CLAIM-NO-CONTROL.
  1873             20  CF-CLAIM-NO-METHOD         PIC X.
  1874                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1875                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1876                 88  CLAIM-NO-SEQ               VALUE '3'.
  1877                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1878             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1879                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1880                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1881                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1882
  1883         16  CF-CHECK-NO-CONTROL.
  1884             20  CF-CHECK-NO-METHOD         PIC X.
  1885                 88  CHECK-NO-MANUAL            VALUE '1'.
  1886                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1887                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1888                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1889             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1890                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1891
  1892         16  CF-DOMICILE-STATE              PIC XX.
  1893
  1894         16  CF-EXPENSE-CONTROLS.
  1895             20  CF-EXPENSE-METHOD          PIC X.
  1896                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1897                 88  DOLLARS-PER-PMT            VALUE '2'.
  1898                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1899                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1900             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1901             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1902
  1903         16  CF-CORRESPONDENCE-CONTROL.
  1904             20  CF-LETTER-RESEND-OPT       PIC X.
  1905                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1906                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1907             20  FILLER                     PIC X(4).
  1908
  1909         16  CF-RESERVE-CONTROLS.
  1910             20  CF-MANUAL-SW               PIC X.
  1911                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1912             20  CF-FUTURE-SW               PIC X.
  1913                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1914             20  CF-PTC-SW                  PIC X.
  1915                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1916             20  CF-IBNR-SW                 PIC X.
  1917                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1918             20  CF-PTC-LF-SW               PIC X.
  1919                 88  CF-LF-PTC-USED             VALUE '1'.
  1920             20  CF-CDT-ACCESS-METHOD       PIC X.
  1921                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1922                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1923                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1924             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1925
  1926         16  CF-CLAIM-CALC-METHOD           PIC X.
  1927             88  360-PLUS-MONTHS                VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  35
* SOCK03.cbl
  1928             88  365-PLUS-MONTHS                VALUE '2'.
  1929             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1930             88  360-DAILY                      VALUE '4'.
  1931             88  365-DAILY                      VALUE '5'.
  1932
  1933         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1934         16  FILLER                         PIC X(11).
  1935
  1936         16  CF-LIMIT-AMOUNTS.
  1937             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1938             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1939             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1940             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1941             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1942             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1943             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1944             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1945             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1946             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1947
  1948         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1949         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1950         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1951
  1952         16  CF-ZIP-CODE.
  1953             20  CF-ZIP-PRIME.
  1954                 24  CF-ZIP-1ST             PIC X.
  1955                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1956                 24  FILLER                 PIC X(4).
  1957             20  CF-ZIP-PLUS4               PIC X(4).
  1958         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1959             20  CF-CAN-POSTAL-1            PIC XXX.
  1960             20  CF-CAN-POSTAL-2            PIC XXX.
  1961             20  FILLER                     PIC XXX.
  1962
  1963         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1964         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1965         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1966
  1967         16  CF-RATING-SWITCH               PIC X.
  1968             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1969             88  CF-NO-RATING                   VALUE 'N'.
  1970
  1971         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1972
  1973         16  CF-CARRIER-OVER-SHORT.
  1974             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1975             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1976
  1977         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1978         16  CF-SECPAY-SWITCH               PIC X.
  1979             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1980             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1981         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1982         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1983         16  FILLER                         PIC X(444).
  1984*        16  FILLER                         PIC X(452).
  1985
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  36
* SOCK03.cbl
  1986
  1987****************************************************************
  1988*             MORTALITY MASTER RECORD                          *
  1989****************************************************************
  1990
  1991     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1992         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1993                                INDEXED BY CF-MORT-NDX.
  1994             20  CF-MORT-TABLE              PIC X(5).
  1995             20  CF-MORT-TABLE-TYPE         PIC X.
  1996                 88  CF-MORT-JOINT              VALUE 'J'.
  1997                 88  CF-MORT-SINGLE             VALUE 'S'.
  1998                 88  CF-MORT-COMBINED           VALUE 'C'.
  1999                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2000                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2001             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2002             20  CF-MORT-AGE-METHOD         PIC XX.
  2003                 88  CF-AGE-LAST                VALUE 'AL'.
  2004                 88  CF-AGE-NEAR                VALUE 'AN'.
  2005             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2006             20  CF-MORT-ADJUSTMENT-DIRECTION
  2007                                            PIC X.
  2008                 88  CF-MINUS                   VALUE '-'.
  2009                 88  CF-PLUS                    VALUE '+'.
  2010             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2011             20  CF-MORT-JOINT-CODE         PIC X.
  2012                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2013             20  CF-MORT-PC-Q               PIC X.
  2014                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2015             20  CF-MORT-TABLE-CODE         PIC X(4).
  2016             20  CF-MORT-COMMENTS           PIC X(15).
  2017             20  FILLER                     PIC X(14).
  2018
  2019         16  FILLER                         PIC X(251).
  2020
  2021
  2022****************************************************************
  2023*             BUSSINESS TYPE MASTER RECORD                     *
  2024****************************************************************
  2025
  2026     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2027* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2028* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2029* AND RECORD 05 IS TYPES 81-99
  2030         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2031             20  CF-BUSINESS-TITLE          PIC  X(19).
  2032             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2033                                            PIC S9V9(4) COMP-3.
  2034             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2035             20  FILLER                     PIC  X.
  2036         16  FILLER                         PIC  X(248).
  2037
  2038
  2039****************************************************************
  2040*             TERMINAL MASTER RECORD                           *
  2041****************************************************************
  2042
  2043     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  37
* SOCK03.cbl
  2044
  2045         16  CF-COMPANY-TERMINALS.
  2046             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2047                                  PIC X(4).
  2048         16  FILLER               PIC X(248).
  2049
  2050
  2051****************************************************************
  2052*             LIFE EDIT MASTER RECORD                          *
  2053****************************************************************
  2054
  2055     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2056         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2057             20  CF-LIFE-CODE-IN            PIC XX.
  2058             20  CF-LIFE-CODE-OUT           PIC XX.
  2059         16  FILLER                         PIC X(248).
  2060
  2061
  2062****************************************************************
  2063*             AH EDIT MASTER RECORD                            *
  2064****************************************************************
  2065
  2066     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2067         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2068             20  CF-AH-CODE-IN              PIC XXX.
  2069             20  CF-AH-CODE-OUT             PIC XX.
  2070         16  FILLER                         PIC X(248).
  2071
  2072
  2073****************************************************************
  2074*             CREDIBILITY TABLES                               *
  2075****************************************************************
  2076
  2077     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2078         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2079                             INDEXED BY CF-CRDB-NDX.
  2080             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2081             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2082             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2083         16  FILLER                         PIC  X(332).
  2084
  2085
  2086****************************************************************
  2087*             REPORT CUSTOMIZATION RECORD                      *
  2088****************************************************************
  2089
  2090     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2091         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2092             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2093             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2094             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2095**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2096****       A T-TRANSFER.                                   ****
  2097             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2098
  2099         16  FILLER                         PIC XX.
  2100
  2101         16  CF-CARRIER-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  38
* SOCK03.cbl
  2102             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2103                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2104                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2105             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2106                                            PIC X.
  2107         16  CF-GROUP-CNTL-OPT.
  2108             20  CF-GROUP-OPT-SEQ           PIC 9.
  2109                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2110                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2111             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2112                                            PIC X(6).
  2113         16  CF-STATE-CNTL-OPT.
  2114             20  CF-STATE-OPT-SEQ           PIC 9.
  2115                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2116                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2117             20  CF-STATE-SELECT OCCURS 3 TIMES
  2118                                            PIC XX.
  2119         16  CF-ACCOUNT-CNTL-OPT.
  2120             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2121                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2122                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2123             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2124                                            PIC X(10).
  2125         16  CF-BUS-TYP-CNTL-OPT.
  2126             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2127                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2128                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2129             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2130                                            PIC XX.
  2131         16  CF-LF-TYP-CNTL-OPT.
  2132             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2133                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2134                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2135             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2136                                            PIC XX.
  2137         16  CF-AH-TYP-CNTL-OPT.
  2138             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2139                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2140                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2141             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2142                                            PIC XX.
  2143         16  CF-REPTCD1-CNTL-OPT.
  2144             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2145                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2146                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2147             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2148                                            PIC X(10).
  2149         16  CF-REPTCD2-CNTL-OPT.
  2150             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2151                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2152                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2153             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2154                                            PIC X(10).
  2155         16  CF-USER1-CNTL-OPT.
  2156             20  CF-USER1-OPT-SEQ           PIC 9.
  2157                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2158                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2159             20  CF-USER1-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  39
* SOCK03.cbl
  2160                                            PIC X(10).
  2161         16  CF-USER2-CNTL-OPT.
  2162             20  CF-USER2-OPT-SEQ           PIC 9.
  2163                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2164                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2165             20  CF-USER2-SELECT OCCURS 3 TIMES
  2166                                            PIC X(10).
  2167         16  CF-USER3-CNTL-OPT.
  2168             20  CF-USER3-OPT-SEQ           PIC 9.
  2169                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2170                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2171             20  CF-USER3-SELECT OCCURS 3 TIMES
  2172                                            PIC X(10).
  2173         16  CF-USER4-CNTL-OPT.
  2174             20  CF-USER4-OPT-SEQ           PIC 9.
  2175                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2176                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2177             20  CF-USER4-SELECT OCCURS 3 TIMES
  2178                                            PIC X(10).
  2179         16  CF-USER5-CNTL-OPT.
  2180             20  CF-USER5-OPT-SEQ           PIC 9.
  2181                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2182                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2183             20  CF-USER5-SELECT OCCURS 3 TIMES
  2184                                            PIC X(10).
  2185         16  CF-REINS-CNTL-OPT.
  2186             20  CF-REINS-OPT-SEQ           PIC 9.
  2187                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2188                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2189             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2190                 24  CF-REINS-PRIME         PIC XXX.
  2191                 24  CF-REINS-SUB           PIC XXX.
  2192
  2193         16  CF-AGENT-CNTL-OPT.
  2194             20  CF-AGENT-OPT-SEQ           PIC 9.
  2195                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2196                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2197             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2198                                            PIC X(10).
  2199
  2200         16  FILLER                         PIC X(43).
  2201
  2202         16  CF-LOSS-RATIO-SELECT.
  2203             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2204             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2205         16  CF-ENTRY-DATE-SELECT.
  2206             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2207             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2208         16  CF-EFFECTIVE-DATE-SELECT.
  2209             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2210             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2211
  2212         16  CF-EXCEPTION-LIST-IND          PIC X.
  2213             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2214
  2215         16  FILLER                         PIC X(318).
  2216
  2217****************************************************************
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  40
* SOCK03.cbl
  2218*                  EXCEPTION REPORTING RECORD                  *
  2219****************************************************************
  2220
  2221     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2222         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2223             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2224
  2225         16  CF-COMBINED-LIFE-AH-OPT.
  2226             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2227             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2228             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2229             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2230
  2231         16  CF-LIFE-OPT.
  2232             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2233             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2234             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2235             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2236             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2237             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2238             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2239             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2240             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2241             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2242
  2243         16  CF-AH-OPT.
  2244             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2245             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2246             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2247             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2248             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2249             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2250             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2251             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2252             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2253             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2254
  2255         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2256             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2257             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2258             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2259
  2260         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2261
  2262         16  FILLER                         PIC X(673).
  2263
  2264
  2265****************************************************************
  2266*             MORTGAGE SYSTEM PLAN RECORD                      *
  2267****************************************************************
  2268
  2269     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2270         16  CF-PLAN-TYPE                   PIC X.
  2271             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2272             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2273             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2274         16  CF-PLAN-ABBREV                 PIC XXX.
  2275         16  CF-PLAN-DESCRIPT               PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  41
* SOCK03.cbl
  2276         16  CF-PLAN-NOTES                  PIC X(20).
  2277         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2278         16  CF-PLAN-UNDERWRITING.
  2279             20  CF-PLAN-TERM-DATA.
  2280                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2281                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2282             20  CF-PLAN-AGE-DATA.
  2283                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2284                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2285                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2286             20  CF-PLAN-BENEFIT-DATA.
  2287                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2288                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2289                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2290                                            PIC S9(7)V99  COMP-3.
  2291         16  CF-PLAN-POLICY-FORMS.
  2292             20  CF-POLICY-FORM             PIC X(12).
  2293             20  CF-MASTER-APPLICATION      PIC X(12).
  2294             20  CF-MASTER-POLICY           PIC X(12).
  2295         16  CF-PLAN-RATING.
  2296             20  CF-RATE-CODE               PIC X(5).
  2297             20  CF-SEX-RATING              PIC X.
  2298                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2299                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2300             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2301             20  CF-SUB-STD-TYPE            PIC X.
  2302                 88  CF-PCT-OF-PREM            VALUE '1'.
  2303                 88  CF-PCT-OF-BENE            VALUE '2'.
  2304         16  CF-PLAN-PREM-TOLERANCES.
  2305             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2306             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2307         16  CF-PLAN-PYMT-TOLERANCES.
  2308             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2309             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2310         16  CF-PLAN-MISC-DATA.
  2311             20  FILLER                     PIC X.
  2312             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2313             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2314         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2315         16  CF-PLAN-IND-GRP                PIC X.
  2316             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2317                                                     '1'.
  2318             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2319                                                     '2'.
  2320         16  CF-MIB-SEARCH-SW               PIC X.
  2321             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2322             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2323             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2324             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2325         16  CF-ALPHA-SEARCH-SW             PIC X.
  2326             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2327             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2328             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2329             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2330             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2331             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2332             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2333             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  42
* SOCK03.cbl
  2334             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2335             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2336                                                     'A' 'B' 'C'
  2337                                                     'X' 'Y' 'Z'.
  2338         16  CF-EFF-DT-RULE-SW              PIC X.
  2339             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2340             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2341             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2342             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2343             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2344         16  FILLER                         PIC X(4).
  2345         16  CF-HEALTH-QUESTIONS            PIC X.
  2346             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2347         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2348         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2349         16  CF-PLAN-SNGL-JNT               PIC X.
  2350             88  CF-COMBINED-PLAN              VALUE 'C'.
  2351             88  CF-JNT-PLAN                   VALUE 'J'.
  2352             88  CF-SNGL-PLAN                  VALUE 'S'.
  2353         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2354         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2355         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2356         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2357         16  CF-RERATE-CNTL                 PIC  X.
  2358             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2359             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2360             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2361             88  CF-AUTO-RECALC                 VALUE '4'.
  2362         16  CF-BENEFIT-TYPE                PIC  X.
  2363             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2364             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2365         16  CF-POLICY-FEE                  PIC S999V99
  2366                                                    COMP-3.
  2367         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2368         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2369         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2370         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2371         16  FILLER                         PIC  X(32).
  2372         16  CF-TERMINATION-FORM            PIC  X(04).
  2373         16  FILLER                         PIC  X(08).
  2374         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2375                                                       COMP-3.
  2376         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2377         16  CF-ISSUE-LETTER                PIC  X(4).
  2378         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2379         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2380             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2381             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2382         16  CF-MP-REFUND-CALC              PIC X.
  2383             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2384             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2385             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2386             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2387             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2388             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2389             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2390             88  CF-MP-REFD-MEAN                VALUE '8'.
  2391         16  CF-ALT-RATE-CODE               PIC  X(5).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  43
* SOCK03.cbl
  2392
  2393
  2394         16  FILLER                         PIC X(498).
  2395****************************************************************
  2396*             MORTGAGE COMPANY MASTER RECORD                   *
  2397****************************************************************
  2398
  2399     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2400         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2401         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2402             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2403             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2404             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2405             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2406             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2407
  2408         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2409         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2410         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2411         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2412         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2413
  2414         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2415             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2416         16  CF-MP-RECON-USE-IND            PIC X(1).
  2417             88  CF-MP-USE-RECON             VALUE 'Y'.
  2418         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2419             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2420         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2421             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2422             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2423         16  FILLER                         PIC X(1).
  2424         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2425             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2426         16  CF-MORTG-MIB-VERSION           PIC X.
  2427             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2428             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2429             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2430         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2431             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2432                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2433             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2434                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2435             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2436                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2437             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2438                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2439             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2440                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2441             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2442                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2443         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2444         16  FILLER                         PIC X(7).
  2445         16  CF-MORTG-DESTINATION-SYMBOL.
  2446             20  CF-MORTG-MIB-COMM          PIC X(5).
  2447             20  CF-MORTG-MIB-TERM          PIC X(5).
  2448         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2449             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  44
* SOCK03.cbl
  2450         16  FILLER                         PIC X(03).
  2451         16  CF-MP-CHECK-NO-CONTROL.
  2452             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2453                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2454                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2455                                                ' ' LOW-VALUES.
  2456                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2457                                               VALUE '3'.
  2458         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2459         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2460         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2461             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2462                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2463             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2464                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2465             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2466                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2467             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2468                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2469             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2470                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2471             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2472                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2473         16  CF-MORTG-BILLING-AREA.
  2474             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2475                                            PIC X.
  2476         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2477         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2478         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2479         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2480             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2481             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2482         16  FILLER                         PIC X.
  2483         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2484             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2485             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2486         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2487         16  FILLER                         PIC X(8).
  2488         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2489         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2490         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2491         16  CF-ACH-COMPANY-ID.
  2492             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2493                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2494                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2495                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2496             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2497         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2498             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2499         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2500             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2501             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2502         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2503         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2504         16  FILLER                         PIC X(536).
  2505
  2506****************************************************************
  2507*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  45
* SOCK03.cbl
  2508****************************************************************
  2509
  2510     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2511         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2512             20  CF-FEMALE-HEIGHT.
  2513                 24  CF-FEMALE-FT           PIC 99.
  2514                 24  CF-FEMALE-IN           PIC 99.
  2515             20  CF-FEMALE-MIN-WT           PIC 999.
  2516             20  CF-FEMALE-MAX-WT           PIC 999.
  2517         16  FILLER                         PIC X(428).
  2518
  2519     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2520         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2521             20  CF-MALE-HEIGHT.
  2522                 24  CF-MALE-FT             PIC 99.
  2523                 24  CF-MALE-IN             PIC 99.
  2524             20  CF-MALE-MIN-WT             PIC 999.
  2525             20  CF-MALE-MAX-WT             PIC 999.
  2526         16  FILLER                         PIC X(428).
  2527******************************************************************
  2528*             AUTOMATIC ACTIVITY RECORD                          *
  2529******************************************************************
  2530     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2531         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2532             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2533             20  CF-SYS-LETTER-ID           PIC X(04).
  2534             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2535             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2536             20  CF-SYS-RESET-SW            PIC X(01).
  2537             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2538             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2539
  2540         16  FILLER                         PIC X(50).
  2541
  2542         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2543             20  CF-USER-ACTIVE-SW          PIC X(01).
  2544             20  CF-USER-LETTER-ID          PIC X(04).
  2545             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2546             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2547             20  CF-USER-RESET-SW           PIC X(01).
  2548             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2549             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2550             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2551
  2552         16  FILLER                         PIC X(246).
  2553*                                 COPY ERCACCT.
  2554******************************************************************
  2555*                                                                *
  2556*                                                                *
  2557*                            ERCACCT                             *
  2558*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2559*                            VMOD=2.031                          *
  2560*                                                                *
  2561*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2562*                                                                *
  2563*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2564*   VSAM ACCOUNT MASTER FILES.                                   *
  2565*                                                                *
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  46
* SOCK03.cbl
  2566*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2567*                                                                *
  2568*   FILE TYPE = VSAM,KSDS                                        *
  2569*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2570*                                                                *
  2571*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2572*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2573*                                                                *
  2574*   LOG = NO                                                     *
  2575*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2576*                                                                *
  2577*                                                                *
  2578******************************************************************
  2579*                   C H A N G E   L O G
  2580*
  2581* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2582*-----------------------------------------------------------------
  2583*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2584* EFFECTIVE    NUMBER
  2585*-----------------------------------------------------------------
  2586* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2587* 092705    2005050300006  PEMA  ADD SPP LEASES
  2588* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2589* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2590* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2591* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2592* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2593******************************************************************
  2594
  2595 01  ACCOUNT-MASTER.
  2596     12  AM-RECORD-ID                      PIC XX.
  2597         88  VALID-AM-ID                      VALUE 'AM'.
  2598
  2599     12  AM-CONTROL-PRIMARY.
  2600         16  AM-COMPANY-CD                 PIC X.
  2601         16  AM-MSTR-CNTRL.
  2602             20  AM-CONTROL-A.
  2603                 24  AM-CARRIER            PIC X.
  2604                 24  AM-GROUPING.
  2605                     28 AM-GROUPING-PREFIX PIC XXX.
  2606                     28 AM-GROUPING-PRIME  PIC XXX.
  2607                 24  AM-STATE              PIC XX.
  2608                 24  AM-ACCOUNT.
  2609                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2610                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2611             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2612                                           PIC X(19).
  2613             20  AM-CNTRL-B.
  2614                 24  AM-EXPIRATION-DT      PIC XX.
  2615                 24  FILLER                PIC X(4).
  2616             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2617                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2618
  2619     12  AM-CONTROL-BY-VAR-GRP.
  2620         16  AM-COMPANY-CD-A1              PIC X.
  2621         16  AM-VG-CARRIER                 PIC X.
  2622         16  AM-VG-GROUPING                PIC X(6).
  2623         16  AM-VG-STATE                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  47
* SOCK03.cbl
  2624         16  AM-VG-ACCOUNT                 PIC X(10).
  2625         16  AM-VG-DATE.
  2626             20  AM-VG-EXPIRATION-DT       PIC XX.
  2627             20  FILLER                    PIC X(4).
  2628         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2629                                           PIC 9(11)      COMP-3.
  2630     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2631         16  FILLER                        PIC X(10).
  2632         16  AM-VG-KEY3.
  2633             20  AM-VG3-ACCOUNT            PIC X(10).
  2634             20  AM-VG3-EXP-DT             PIC XX.
  2635         16  FILLER                        PIC X(4).
  2636     12  AM-MAINT-INFORMATION.
  2637         16  AM-LAST-MAINT-DT              PIC XX.
  2638         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2639         16  AM-LAST-MAINT-USER            PIC X(4).
  2640         16  FILLER                        PIC XX.
  2641
  2642     12  AM-EFFECTIVE-DT                   PIC XX.
  2643     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2644
  2645     12  AM-PREV-DATES  COMP-3.
  2646         16  AM-PREV-EXP-DT                PIC 9(11).
  2647         16  AM-PREV-EFF-DT                PIC 9(11).
  2648
  2649     12  AM-REPORT-CODE-1                  PIC X(10).
  2650     12  AM-REPORT-CODE-2                  PIC X(10).
  2651
  2652     12  AM-CITY-CODE                      PIC X(4).
  2653     12  AM-COUNTY-PARISH                  PIC X(6).
  2654
  2655     12  AM-NAME                           PIC X(30).
  2656     12  AM-PERSON                         PIC X(30).
  2657     12  AM-ADDRS                          PIC X(30).
  2658     12  AM-CITY.
  2659         16  AM-ADDR-CITY                  PIC X(28).
  2660         16  AM-ADDR-STATE                 PIC XX.
  2661     12  AM-ZIP.
  2662         16  AM-ZIP-PRIME.
  2663             20  AM-ZIP-PRI-1ST            PIC X.
  2664                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2665             20  FILLER                    PIC X(4).
  2666         16  AM-ZIP-PLUS4                  PIC X(4).
  2667     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2668         16  AM-CAN-POSTAL-1               PIC XXX.
  2669         16  AM-CAN-POSTAL-2               PIC XXX.
  2670         16  FILLER                        PIC XXX.
  2671     12  AM-TEL-NO.
  2672         16  AM-AREA-CODE                  PIC 999.
  2673         16  AM-TEL-PRE                    PIC 999.
  2674         16  AM-TEL-NBR                    PIC 9(4).
  2675     12  AM-TEL-LOC                        PIC X.
  2676         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2677         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2678
  2679     12  AM-COMM-STRUCTURE.
  2680         16  AM-DEFN-1.
  2681             20  AM-AGT-COMMS       OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  48
* SOCK03.cbl
  2682                 24  AM-AGT.
  2683                     28  AM-AGT-PREFIX     PIC X(4).
  2684                     28  AM-AGT-PRIME      PIC X(6).
  2685                 24  AM-COM-TYP            PIC X.
  2686                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2687                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2688                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2689                 24  AM-RECALC-LV-INDIC    PIC X.
  2690                 24  AM-RETRO-LV-INDIC     PIC X.
  2691                 24  AM-GL-CODES           PIC X.
  2692                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2693                 24  FILLER                PIC X(01).
  2694         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2695             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2696                 24  FILLER                PIC X(11).
  2697                 24  AM-L-COMA             PIC XXX.
  2698                 24  AM-J-COMA             PIC XXX.
  2699                 24  AM-A-COMA             PIC XXX.
  2700                 24  FILLER                PIC X(6).
  2701
  2702     12  AM-COMM-CHANGE-STATUS             PIC X.
  2703         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2704
  2705     12  AM-CSR-CODE                       PIC X(4).
  2706
  2707     12  AM-BILLING-STATUS                 PIC X.
  2708         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2709         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2710     12  AM-AUTO-REFUND-SW                 PIC X.
  2711         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2712         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2713     12  AM-GPCD                           PIC 99.
  2714     12  AM-IG                             PIC X.
  2715         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2716         88  AM-HAS-GROUP                     VALUE '2'.
  2717     12  AM-STATUS                         PIC X.
  2718         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2719         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2720         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2721         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2722         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2723         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2724     12  AM-REMIT-TO                       PIC 99.
  2725     12  AM-ID-NO                          PIC X(11).
  2726
  2727     12  AM-CAL-TABLE                      PIC XX.
  2728     12  AM-LF-DEVIATION                   PIC XXX.
  2729     12  AM-AH-DEVIATION                   PIC XXX.
  2730     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2731     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2732     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2733     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2734     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2735     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2736
  2737     12  AM-USER-FIELDS.
  2738         16  AM-FLD-1                      PIC XX.
  2739         16  AM-FLD-2                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  49
* SOCK03.cbl
  2740         16  AM-FLD-3                      PIC XX.
  2741         16  AM-FLD-4                      PIC XX.
  2742         16  AM-FLD-5                      PIC XX.
  2743
  2744     12  AM-1ST-PROD-DATE.
  2745         16  AM-1ST-PROD-YR                PIC XX.
  2746         16  AM-1ST-PROD-MO                PIC XX.
  2747         16  AM-1ST-PROD-DA                PIC XX.
  2748     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2749     12  AM-CERTS-PURGED-DATE.
  2750         16  AM-PUR-YR                     PIC XX.
  2751         16  AM-PUR-MO                     PIC XX.
  2752         16  AM-PUR-DA                     PIC XX.
  2753     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2754     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2755     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2756     12  AM-INACTIVE-DATE.
  2757         16  AM-INA-MO                     PIC 99.
  2758         16  AM-INA-DA                     PIC 99.
  2759         16  AM-INA-YR                     PIC 99.
  2760     12  AM-AR-HI-CERT-DATE                PIC XX.
  2761
  2762     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2763     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2764
  2765     12  AM-OB-PAYMENT-MODE                PIC X.
  2766         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2767         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2768         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2769         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2770
  2771     12  AM-AH-ONLY-INDICATOR              PIC X.
  2772         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2773         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2774
  2775     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2776
  2777     12  AM-OVER-SHORT.
  2778         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2779         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2780
  2781     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2782     12  AM-DCC-CLP-STATE                  PIC XX.
  2783
  2784     12  AM-RECALC-COMM                    PIC X.
  2785     12  AM-RECALC-REIN                    PIC X.
  2786
  2787     12  AM-REI-TABLE                      PIC XXX.
  2788     12  AM-REI-ET-LF                      PIC X.
  2789     12  AM-REI-ET-AH                      PIC X.
  2790     12  AM-REI-PE-LF                      PIC X.
  2791     12  AM-REI-PE-AH                      PIC X.
  2792     12  AM-REI-PRT-ST                     PIC X.
  2793     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2794     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2795     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2796     12  AM-REI-GROUP-A                    PIC X(6).
  2797     12  AM-REI-MORT                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  50
* SOCK03.cbl
  2798     12  AM-REI-PRT-OW                     PIC X.
  2799     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2800     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2801     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2802     12  AM-REI-GROUP-B                    PIC X(6).
  2803
  2804     12  AM-TRUST-TYPE                     PIC X(2).
  2805
  2806     12  AM-EMPLOYER-STMT-USED             PIC X.
  2807     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2808
  2809     12  AM-STD-AH-TYPE                    PIC XX.
  2810     12  AM-EARN-METHODS.
  2811         16  AM-EARN-METHOD-R              PIC X.
  2812             88 AM-REF-RL-R78                 VALUE 'R'.
  2813             88 AM-REF-RL-PR                  VALUE 'P'.
  2814             88 AM-REF-RL-MEAN                VALUE 'M'.
  2815             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2816         16  AM-EARN-METHOD-L              PIC X.
  2817             88 AM-REF-LL-R78                 VALUE 'R'.
  2818             88 AM-REF-LL-PR                  VALUE 'P'.
  2819             88 AM-REF-LL-MEAN                VALUE 'M'.
  2820             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2821         16  AM-EARN-METHOD-A              PIC X.
  2822             88 AM-REF-AH-R78                 VALUE 'R'.
  2823             88 AM-REF-AH-PR                  VALUE 'P'.
  2824             88 AM-REF-AH-MEAN                VALUE 'M'.
  2825             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2826             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2827             88 AM-REF-AH-NET                 VALUE 'N'.
  2828
  2829     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2830     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2831     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2832
  2833     12  AM-RET-Y-N                        PIC X.
  2834     12  AM-RET-P-E                        PIC X.
  2835     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2836     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2837     12  AM-RET-GRP                        PIC X(6).
  2838     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2839         16  AM-POOL-PRIME                 PIC XXX.
  2840         16  AM-POOL-SUB                   PIC XXX.
  2841     12  AM-RETRO-EARNINGS.
  2842         16  AM-RET-EARN-R                 PIC X.
  2843         16  AM-RET-EARN-L                 PIC X.
  2844         16  AM-RET-EARN-A                 PIC X.
  2845     12  AM-RET-ST-TAX-USE                 PIC X.
  2846         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2847         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2848     12  AM-RETRO-BEG-EARNINGS.
  2849         16  AM-RET-BEG-EARN-R             PIC X.
  2850         16  AM-RET-BEG-EARN-L             PIC X.
  2851         16  AM-RET-BEG-EARN-A             PIC X.
  2852     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2853     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2854
  2855     12  AM-USER-SELECT-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  51
* SOCK03.cbl
  2856         16  AM-USER-SELECT-1              PIC X(10).
  2857         16  AM-USER-SELECT-2              PIC X(10).
  2858         16  AM-USER-SELECT-3              PIC X(10).
  2859         16  AM-USER-SELECT-4              PIC X(10).
  2860         16  AM-USER-SELECT-5              PIC X(10).
  2861
  2862     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2863
  2864     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2865
  2866     12  AM-RPT045A-SWITCH                 PIC X.
  2867         88  RPT045A-OFF                   VALUE 'N'.
  2868
  2869     12  AM-INSURANCE-LIMITS.
  2870         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2871         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2872
  2873     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2874         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2875
  2876     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2877         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2878         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2879
  2880     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2881
  2882     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2883     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2884     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2885     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2886     12  AM-DCC-UEF-STATE                  PIC XX.
  2887     12  FILLER                            PIC XXX.
  2888     12  AM-REPORT-CODE-3                  PIC X(10).
  2889*    12  FILLER                            PIC X(22).
  2890
  2891     12  AM-RESERVE-DATE.
  2892         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2893         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2894         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2895
  2896     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2897     12  AM-NOTIFICATION-TYPES.
  2898         16  AM-NOTIF-OF-LETTERS           PIC X.
  2899         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2900         16  AM-NOTIF-OF-REPORTS           PIC X.
  2901         16  AM-NOTIF-OF-STATUS            PIC X.
  2902
  2903     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2904         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2905         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2906         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2907         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2908
  2909     12  AM-BENEFIT-CONTROLS.
  2910         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2911             20  AM-BENEFIT-CODE           PIC XX.
  2912             20  AM-BENEFIT-TYPE           PIC X.
  2913             20  AM-BENEFIT-REVISION       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  52
* SOCK03.cbl
  2914             20  AM-BENEFIT-REM-TERM       PIC X.
  2915             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2916             20  FILLER                    PIC XX.
  2917         16  FILLER                        PIC X(80).
  2918
  2919     12  AM-TRANSFER-DATA.
  2920         16  AM-TRANSFERRED-FROM.
  2921             20  AM-TRNFROM-CARRIER        PIC X.
  2922             20  AM-TRNFROM-GROUPING.
  2923                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2924                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2925             20  AM-TRNFROM-STATE          PIC XX.
  2926             20  AM-TRNFROM-ACCOUNT.
  2927                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2928                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2929             20  AM-TRNFROM-DTE            PIC XX.
  2930         16  AM-TRANSFERRED-TO.
  2931             20  AM-TRNTO-CARRIER          PIC X.
  2932             20  AM-TRNTO-GROUPING.
  2933                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2934                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2935             20  AM-TRNTO-STATE            PIC XX.
  2936             20  AM-TRNTO-ACCOUNT.
  2937                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2938                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2939             20  AM-TRNTO-DTE              PIC XX.
  2940         16  FILLER                        PIC X(10).
  2941
  2942     12  AM-SAVED-REMIT-TO                 PIC 99.
  2943
  2944     12  AM-COMM-STRUCTURE-SAVED.
  2945         16  AM-DEFN-1-SAVED.
  2946             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2947                 24  AM-AGT-SV             PIC X(10).
  2948                 24  AM-COM-TYP-SV         PIC X.
  2949                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2950                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2951                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2952                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2953                 24  FILLER                PIC X.
  2954                 24  AM-GL-CODES-SV        PIC X.
  2955                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2956                 24  FILLER                PIC X.
  2957         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2958             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2959                 24  FILLER                PIC X(11).
  2960                 24  AM-L-COMA-SV          PIC XXX.
  2961                 24  AM-J-COMA-SV          PIC XXX.
  2962                 24  AM-A-COMA-SV          PIC XXX.
  2963                 24  FILLER                PIC X(6).
  2964
  2965     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2966         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2967            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2968            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2969            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2970
  2971     12  AM-ORIG-DEALER-NO                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  53
* SOCK03.cbl
  2972     12  FILLER                            PIC X(120).
  2973
  2974     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2975         16  AM-CONTROL-NAME               PIC X(30).
  2976         16  AM-EXECUTIVE-ONE.
  2977             20  AM-EXEC1-NAME             PIC X(15).
  2978             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2979                                                          COMP-3.
  2980             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2981                                                          COMP-3.
  2982         16  AM-EXECUTIVE-TWO.
  2983             20  AM-EXEC2-NAME             PIC X(15).
  2984             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2985                                                          COMP-3.
  2986             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2987                                                          COMP-3.
  2988
  2989     12  AM-RETRO-ADDITIONAL-DATA.
  2990         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2991         16  AM-RETRO-PREM-P-E             PIC X.
  2992         16  AM-RETRO-CLMS-P-I             PIC X.
  2993         16  AM-RETRO-RET-BRACKET-LF.
  2994             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2995                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2996                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2997             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2998                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2999                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3000             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3001                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3002                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3003         16  AM-RETRO-RET-BRACKET-AH.
  3004             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3005                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3006                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3007                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3008             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3009                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3010                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3011             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3012                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3013                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3014
  3015     12  AM-COMMENTS.
  3016         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3017
  3018     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3019         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3020         16  AM-FLI-BILLING-CODE           PIC X.
  3021         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3022         16  AM-FLI-UNITED-IDENT           PIC X.
  3023         16  AM-FLI-INTEREST-LOST-DATA.
  3024             20  AM-FLI-BANK-NO            PIC X(5).
  3025             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3026             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3027             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3028         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3029             20  AM-FLI-AGT                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  54
* SOCK03.cbl
  3030             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3031             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3032         16  FILLER                        PIC X(102).
  3033
  3034     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3035         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3036             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3037             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3038             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3039             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3040             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3041         16  FILLER                          PIC X(10).
  3042******************************************************************
  3043*                                 COPY ELCDATE.
  3044******************************************************************
  3045*                                                                *
  3046*                                                                *
  3047*                            ELCDATE.                            *
  3048*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3049*                            VMOD=2.003
  3050*                                                                *
  3051*                                                                *
  3052*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3053*                 LENGTH = 200                                   *
  3054******************************************************************
  3055
  3056 01  DATE-CONVERSION-DATA.
  3057     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3058     12  DC-OPTION-CODE                PIC X.
  3059         88  BIN-TO-GREG                VALUE ' '.
  3060         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3061         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3062         88  YMD-GREG-TO-BIN            VALUE '3'.
  3063         88  MDY-GREG-TO-BIN            VALUE '4'.
  3064         88  JULIAN-TO-BIN              VALUE '5'.
  3065         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3066         88  FIND-CENTURY               VALUE '7'.
  3067         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3068         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3069         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3070         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3071         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3072         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3073         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3074         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3075         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3076         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3077         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3078         88  BIN-3-TO-GREG              VALUE 'I'.
  3079         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3080         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3081         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3082         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3083         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3084         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3085         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3086         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3087         88  THREE-CHARACTER-BIN
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  55
* SOCK03.cbl
  3088                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3089         88  GREGORIAN-TO-BIN
  3090                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3091         88  BIN-TO-GREGORIAN
  3092                  VALUES ' ' '1' 'I' '8' 'G'.
  3093         88  JULIAN-TO-BINARY
  3094                  VALUES '5' 'C' 'E' 'F'.
  3095     12  DC-ERROR-CODE                 PIC X.
  3096         88  NO-CONVERSION-ERROR        VALUE ' '.
  3097         88  DATE-CONVERSION-ERROR
  3098                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3099         88  DATE-IS-ZERO               VALUE '1'.
  3100         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3101         88  DATE-IS-INVALID            VALUE '3'.
  3102         88  DATE1-GREATER-DATE2        VALUE '4'.
  3103         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3104         88  DATE-INVALID-OPTION        VALUE '9'.
  3105         88  INVALID-CENTURY            VALUE 'A'.
  3106         88  ONLY-CENTURY               VALUE 'B'.
  3107         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3108         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3109     12  DC-END-OF-MONTH               PIC X.
  3110         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3111     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3112         88  USE-NORMAL-PROCESS         VALUE ' '.
  3113         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3114         88  ADJUST-UP-100-YRS          VALUE '2'.
  3115     12  FILLER                        PIC X.
  3116     12  DC-CONVERSION-DATES.
  3117         16  DC-BIN-DATE-1             PIC XX.
  3118         16  DC-BIN-DATE-2             PIC XX.
  3119         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3120         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3121                       DC-GREG-DATE-1-EDIT.
  3122             20  DC-EDIT1-MONTH        PIC 99.
  3123             20  SLASH1-1              PIC X.
  3124             20  DC-EDIT1-DAY          PIC 99.
  3125             20  SLASH1-2              PIC X.
  3126             20  DC-EDIT1-YEAR         PIC 99.
  3127         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3128         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3129                     DC-GREG-DATE-2-EDIT.
  3130             20  DC-EDIT2-MONTH        PIC 99.
  3131             20  SLASH2-1              PIC X.
  3132             20  DC-EDIT2-DAY          PIC 99.
  3133             20  SLASH2-2              PIC X.
  3134             20  DC-EDIT2-YEAR         PIC 99.
  3135         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3136         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3137                     DC-GREG-DATE-1-YMD.
  3138             20  DC-YMD-YEAR           PIC 99.
  3139             20  DC-YMD-MONTH          PIC 99.
  3140             20  DC-YMD-DAY            PIC 99.
  3141         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3142         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3143                      DC-GREG-DATE-1-MDY.
  3144             20  DC-MDY-MONTH          PIC 99.
  3145             20  DC-MDY-DAY            PIC 99.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  56
* SOCK03.cbl
  3146             20  DC-MDY-YEAR           PIC 99.
  3147         16  DC-GREG-DATE-1-ALPHA.
  3148             20  DC-ALPHA-MONTH        PIC X(10).
  3149             20  DC-ALPHA-DAY          PIC 99.
  3150             20  FILLER                PIC XX.
  3151             20  DC-ALPHA-CENTURY.
  3152                 24 DC-ALPHA-CEN-N     PIC 99.
  3153             20  DC-ALPHA-YEAR         PIC 99.
  3154         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3155         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3156         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3157         16  DC-JULIAN-DATE            PIC 9(05).
  3158         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3159                                       PIC 9(05).
  3160         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3161             20  DC-JULIAN-YEAR        PIC 99.
  3162             20  DC-JULIAN-DAYS        PIC 999.
  3163         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3164         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3165         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3166     12  DATE-CONVERSION-VARIBLES.
  3167         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3168         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3169             20  FILLER                PIC 9(3).
  3170             20  HOLD-CEN-1-CCYY.
  3171                 24  HOLD-CEN-1-CC     PIC 99.
  3172                 24  HOLD-CEN-1-YY     PIC 99.
  3173             20  HOLD-CEN-1-MO         PIC 99.
  3174             20  HOLD-CEN-1-DA         PIC 99.
  3175         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3176             20  HOLD-CEN-1-R-MO       PIC 99.
  3177             20  HOLD-CEN-1-R-DA       PIC 99.
  3178             20  HOLD-CEN-1-R-CCYY.
  3179                 24  HOLD-CEN-1-R-CC   PIC 99.
  3180                 24  HOLD-CEN-1-R-YY   PIC 99.
  3181             20  FILLER                PIC 9(3).
  3182         16  HOLD-CENTURY-1-X.
  3183             20  FILLER                PIC X(3)  VALUE SPACES.
  3184             20  HOLD-CEN-1-X-CCYY.
  3185                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3186                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3187             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3188             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3189         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3190             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3191             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3192             20  HOLD-CEN-1-R-X-CCYY.
  3193                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3194                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3195             20  FILLER                PIC XXX.
  3196         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3197         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3198         16  DC-JULIAN-DATE-1          PIC 9(07).
  3199         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3200             20  DC-JULIAN-1-CCYY.
  3201                 24  DC-JULIAN-1-CC    PIC 99.
  3202                 24  DC-JULIAN-1-YR    PIC 99.
  3203             20  DC-JULIAN-DA-1        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  57
* SOCK03.cbl
  3204         16  DC-JULIAN-DATE-2          PIC 9(07).
  3205         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3206             20  DC-JULIAN-2-CCYY.
  3207                 24  DC-JULIAN-2-CC    PIC 99.
  3208                 24  DC-JULIAN-2-YR    PIC 99.
  3209             20  DC-JULIAN-DA-2        PIC 999.
  3210         16  DC-GREG-DATE-A-EDIT.
  3211             20  DC-EDITA-MONTH        PIC 99.
  3212             20  SLASHA-1              PIC X VALUE '/'.
  3213             20  DC-EDITA-DAY          PIC 99.
  3214             20  SLASHA-2              PIC X VALUE '/'.
  3215             20  DC-EDITA-CCYY.
  3216                 24  DC-EDITA-CENT     PIC 99.
  3217                 24  DC-EDITA-YEAR     PIC 99.
  3218         16  DC-GREG-DATE-B-EDIT.
  3219             20  DC-EDITB-MONTH        PIC 99.
  3220             20  SLASHB-1              PIC X VALUE '/'.
  3221             20  DC-EDITB-DAY          PIC 99.
  3222             20  SLASHB-2              PIC X VALUE '/'.
  3223             20  DC-EDITB-CCYY.
  3224                 24  DC-EDITB-CENT     PIC 99.
  3225                 24  DC-EDITB-YEAR     PIC 99.
  3226         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3227         16  DC-GREG-DATE-CYMD-R REDEFINES
  3228                              DC-GREG-DATE-CYMD.
  3229             20  DC-CYMD-CEN           PIC 99.
  3230             20  DC-CYMD-YEAR          PIC 99.
  3231             20  DC-CYMD-MONTH         PIC 99.
  3232             20  DC-CYMD-DAY           PIC 99.
  3233         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3234         16  DC-GREG-DATE-MDCY-R REDEFINES
  3235                              DC-GREG-DATE-MDCY.
  3236             20  DC-MDCY-MONTH         PIC 99.
  3237             20  DC-MDCY-DAY           PIC 99.
  3238             20  DC-MDCY-CEN           PIC 99.
  3239             20  DC-MDCY-YEAR          PIC 99.
  3240    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3241        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3242    12  DC-EL310-DATE                  PIC X(21).
  3243    12  FILLER                         PIC X(28).
  3244*                                 COPY ELCCALC.
  3245******************************************************************
  3246*                                                                *
  3247*                           ELCCALC.                            *
  3248*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3249*                            VMOD=2.025                          *
  3250*                                                                *
  3251*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3252*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3253*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3254*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3255*                                                                *
  3256*  PASSED TO ELRTRM                                              *
  3257*  -----------------                                             *
  3258*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3259*  ORIGINAL TERM                                                 *
  3260*  BEGINNING DATE                                                *
  3261*  ENDING DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  58
* SOCK03.cbl
  3262*  COMPANY I.D.                                                  *
  3263*  ACCOUNT MASTER USER FIELD                                     *
  3264*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3265*  FREE LOOK DAYS                                                *
  3266*                                                                *
  3267*  RETURNED FROM ELRTRM                                          *
  3268*  ---------------------                                         *
  3269*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3270*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3271*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3272*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3273*----------------------------------------------------------------*
  3274*  PASSED TO ELRAMT                                              *
  3275*  ----------------                                              *
  3276*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3277*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3278*  ORIGINAL AMOUNT                                               *
  3279*  ALTERNATE BENEFIT (BALLON)                                    *
  3280*  A.P.R. - NET PAY ONLY                                         *
  3281*  METHOD
  3282*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3283*  COMPANY I.D.                                                  *
  3284*  BENEFIT TYPE                                                  *
  3285*                                                                *
  3286*  RETURNED FROM ELRAMT                                          *
  3287*  --------------------                                          *
  3288*  REMAINING AMOUNT 1 - CURRENT                                  *
  3289*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3290*  REMAINING AMOUNT FACTOR
  3291*----------------------------------------------------------------*
  3292*  PASSED TO ELRESV                                              *
  3293*  -----------------                                             *
  3294*  CERTIFICATE EFFECTIVE DATE                                    *
  3295*  VALUATION DATE                                                *
  3296*  PAID THRU DATE                                                *
  3297*  BENEFIT                                                       *
  3298*  INCURRED DATE                                                 *
  3299*  REPORTED DATE                                                 *
  3300*  ISSUE AGE                                                     *
  3301*  TERM                                                          *
  3302*  CDT PERCENT                                                   *
  3303*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3304* *CLAIM TYPE (LIFE, A/H)                                        *
  3305* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3306* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3307*                                                                *
  3308*  RETURNED FROM ELRESV                                          *
  3309*  --------------------                                          *
  3310*  CDT TABLE USED                                                *
  3311*  CDT FACTOR USED                                               *
  3312*  PAY TO CURRENT RESERVE                                        *
  3313*  I.B.N.R. - A/H ONLY                                           *
  3314*  FUTURE (ACCRUED) AH ONLY                                      *
  3315*----------------------------------------------------------------*
  3316*  PASSED TO ELRATE                                              *
  3317*  ----------------                                              *
  3318*  CERT ISSUE DATE                                               *
  3319*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  59
* SOCK03.cbl
  3320*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3321*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3322*  STATE CODE (CLIENT DEFINED)                                   *
  3323*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3324*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3325*  DEVIATION CODE                                                *
  3326*  ISSUE AGE                                                     *
  3327*  ORIGINAL BENEFIT AMOUNT                                       *
  3328*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3329*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3330*  BENEFIT KIND (LIFE OR A/H)                                    *
  3331*  A.P.R.                                                        *
  3332*  METHOD
  3333*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3334*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3335*  COMPANY I.D. (3 CHARACTER)                                    *
  3336*  BENEFIT CODE                                                  *
  3337*  BENEFIT OVERRIDE CODE                                         *
  3338*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3339*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3340*  JOINT INDICATOR (CSL ONLY)                                    *
  3341*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3342*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3343*                                                                *
  3344*  RETURNED FROM ELRATE                                          *
  3345*  --------------------                                          *
  3346*  CALCULATED PREMIUM                                            *
  3347*  PREMIUM RATE                                                  *
  3348*  MORTALITY CODE                                                *
  3349*  MAX ATTAINED AGE                                              *
  3350*  MAX AGE                                                       *
  3351*  MAX TERM                                                      *
  3352*  MAX MONTHLY BENEFIT                                           *
  3353*  MAX TOTAL BENIFIT                                             *
  3354*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3355*----------------------------------------------------------------*
  3356*  PASSED TO ELRFND                                              *
  3357*  ----------------                                              *
  3358*  CERT ISSUE DATE                                               *
  3359*  REFUND DATE                                                   *
  3360*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3361*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3362*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3363*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3364*  STATE CODE (CLIENT DEFINED)                                   *
  3365*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3366*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3367*  DEVIATION CODE                                                *
  3368*  ISSUE AGE                                                     *
  3369*  ORIGINAL BENEFIT AMOUNT                                       *
  3370*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3371*  PROCESS TYPE (CANCEL)                                         *
  3372*  BENEFIT KIND (LIFE OR A/H)                                    *
  3373*  A.P.R.                                                        *
  3374*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3375*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3376*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3377*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  60
* SOCK03.cbl
  3378*  COMPANY I.D. (3 CHARACTER)                                    *
  3379*  BENEFIT CODE                                                  *
  3380*  BENEFIT OVERRIDE CODE                                         *
  3381*                                                                *
  3382*  RETURNED FROM ELRFND                                          *
  3383*  --------------------                                          *
  3384*  CALCULATED REFUND                                             *
  3385*----------------------------------------------------------------*
  3386*  PASSED TO ELEARN                                              *
  3387*  ----------------                                              *
  3388*  CERT ISSUE DATE                                               *
  3389*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3390*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3391*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3392*  STATE CODE (CLIENT DEFINED)                                   *
  3393*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3394*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3395*  DEVIATION CODE                                                *
  3396*  ISSUE AGE                                                     *
  3397*  ORIGINAL BENEFIT AMOUNT                                       *
  3398*  BENEFIT KIND (LIFE OR A/H)                                    *
  3399*  A.P.R.                                                        *
  3400*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3401*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3402*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3403*  COMPANY I.D. (3 CHARACTER)                                    *
  3404*  BENEFIT CODE                                                  *
  3405*  BENEFIT OVERRIDE CODE                                         *
  3406*                                                                *
  3407*  RETURNED FROM ELEARN                                          *
  3408*  --------------------                                          *
  3409*  INDICATED  EARNINGS                                           *
  3410*----------------------------------------------------------------*
  3411*                 LENGTH = 450                                   *
  3412*                                                                *
  3413******************************************************************
  3414******************************************************************
  3415*                   C H A N G E   L O G
  3416*
  3417* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3418*-----------------------------------------------------------------
  3419*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3420* EFFECTIVE    NUMBER
  3421*-----------------------------------------------------------------
  3422* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3423* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3424* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3425* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3426* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3427* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3428* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3429* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3430* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3431******************************************************************
  3432
  3433 01  CALCULATION-PASS-AREA.
  3434     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3435                                     COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  61
* SOCK03.cbl
  3436
  3437     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3438       88  NO-CP-ERROR                             VALUE ZERO.
  3439       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3440                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3441       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3442       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3443       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3444       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3445       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3446       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3447       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3448       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3449       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3450       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3451       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3452       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3453       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3454       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3455       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3456       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3457       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3458
  3459     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3460       88  NO-CP-ERROR-2                           VALUE ZERO.
  3461***********************  INPUT AREAS ****************************
  3462
  3463     12  CP-CALCULATION-AREA.
  3464         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3465         16  CP-CERT-EFF-DT        PIC XX.
  3466         16  CP-VALUATION-DT       PIC XX.
  3467         16  CP-PAID-THRU-DT       PIC XX.
  3468         16  CP-BENEFIT-TYPE       PIC X.
  3469           88  CP-AH                               VALUE 'A' 'D'
  3470                                                   'I' 'U'.
  3471           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3472           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3473         16  CP-INCURRED-DT        PIC XX.
  3474         16  CP-REPORTED-DT        PIC XX.
  3475         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3476         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3477         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3478                                     COMP-3.
  3479         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3480                                     COMP-3.
  3481         16  CP-CDT-METHOD         PIC X.
  3482           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3483           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3484           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3485         16  CP-CLAIM-TYPE         PIC X.
  3486           88  CP-AH-CLAIM                         VALUE 'A'.
  3487           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3488         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3489                                     COMP-3.
  3490         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3491                                     COMP-3.
  3492         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3493                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  62
* SOCK03.cbl
  3494         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3495                                     COMP-3.
  3496         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3497                                     COMP-3.
  3498         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3499                                     COMP-3.
  3500         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3501                                     COMP-3.
  3502         16  CP-REM-TERM-METHOD    PIC X.
  3503           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3504           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3505           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3506           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3507           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3508           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3509           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3510         16  CP-EARNING-METHOD     PIC X.
  3511           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3512           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3513           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3514           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3515           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3516           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3517           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3518           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3519           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3520           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3521           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3522           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3523           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3524           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3525         16  CP-PROCESS-TYPE       PIC X.
  3526           88  CP-CLAIM                            VALUE '1'.
  3527           88  CP-CANCEL                           VALUE '2'.
  3528           88  CP-ISSUE                            VALUE '3'.
  3529         16  CP-SPECIAL-CALC-CD    PIC X.
  3530           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3531           88  CP-1-MTH-INTEREST               VALUE ' '.
  3532           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3533           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3534           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3535           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3536           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3537           88  CP-FARM-PLAN                    VALUE 'F'.
  3538           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3539           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3540           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3541           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3542           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3543           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3544           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3545           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3546           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3547           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3548                                                     'W' 'X'.
  3549           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3550           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3551           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  63
* SOCK03.cbl
  3552           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3553           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3554           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3555           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3556           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3557           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3558           88  CP-CSL-METH-1                   VALUE '5'.
  3559           88  CP-CSL-METH-2                   VALUE '6'.
  3560           88  CP-CSL-METH-3                   VALUE '7'.
  3561           88  CP-CSL-METH-4                   VALUE '8'.
  3562
  3563         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3564                                     COMP-3.
  3565         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3566         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3567         16  CP-STATE              PIC XX          VALUE SPACE.
  3568         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3569         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3570           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3571               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3572         16  CP-R78-OPTION         PIC X.
  3573           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3574           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3575
  3576         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3577         16  CP-IBNR-RESERVE-SW    PIC X.
  3578         16  CP-CLAIM-STATUS       PIC X.
  3579         16  CP-RATE-FILE          PIC X.
  3580         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3581                                     COMP-3.
  3582
  3583         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3584         16  CP-AH-OVERRIDE-CODE   PIC X.
  3585
  3586         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3587                                     COMP-3.
  3588         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3589                                   PIC S9(5)V99 COMP-3.
  3590         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3591                                     COMP-3.
  3592         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3593                                     COMP-3.
  3594         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3595                                     COMP-3.
  3596         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3597                                  PIC S9(7)V99 COMP-3.
  3598
  3599         16  CP-PAID-FROM-DATE     PIC X(02).
  3600         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3601         16  CP-EXT-DAYS-CALC      PIC X.
  3602           88  CP-EXT-NO-CHG                   VALUE ' '.
  3603           88  CP-EXT-CHG-LF                   VALUE '1'.
  3604           88  CP-EXT-CHG-AH                   VALUE '2'.
  3605           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3606         16  CP-DOMICILE-STATE     PIC XX.
  3607         16  CP-CARRIER            PIC X.
  3608         16  CP-REIN-FLAG          PIC X.
  3609         16  CP-REM-TRM-CALC-OPTION PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  64
* SOCK03.cbl
  3610           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3611                      '2' '3' '4' '5'.
  3612           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3613           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3614           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3615           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3616           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3617           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3618           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3619           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3620         16  CP-SIG-SWITCH         PIC X.
  3621         16  CP-RATING-METHOD      PIC X.
  3622           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3623           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3624           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3625           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3626           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3627           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3628           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3629           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3630           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3631         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3632                                     COMP-3.
  3633         16  CP-BEN-CATEGORY       PIC X.
  3634         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3635         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3636                                   PIC S99V9(5) COMP-3.
  3637         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3638         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3639                                   PIC S99V9(5) COMP-3.
  3640         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3641         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3642         16  CP-EXPIRE-DT          PIC XX.
  3643         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3644         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3645         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3646         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3647         16  CP-DDF-SPEC-CALC      PIC X.
  3648             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3649             88  CP-CALC-CLP              VALUE 'C'.
  3650         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3651         16  CP-CANCEL-REASON      PIC X.
  3652         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3653         16  CP-PMT-MODE           PIC X.
  3654         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3655         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3656         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3657         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3658         16  FILLER                PIC X.
  3659
  3660***************    OUTPUT FROM ELRESV   ************************
  3661
  3662         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3663
  3664         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3665                                     COMP-3.
  3666         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3667                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  65
* SOCK03.cbl
  3668         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3669                                     COMP-3.
  3670         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3671                                     COMP-3.
  3672         16  FILLER                PIC X(09).
  3673***************    OUTPUT FROM ELRTRM   *************************
  3674
  3675         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3676                                     COMP-3.
  3677         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3678                                     COMP-3.
  3679         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3680                                     COMP-3.
  3681         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3682                                     COMP-3.
  3683         16  FILLER                PIC X(12).
  3684
  3685***************    OUTPUT FROM ELRAMT   *************************
  3686
  3687         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3688                                     COMP-3.
  3689         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3690                                     COMP-3.
  3691         16  FILLER                PIC X(12).
  3692
  3693***************    OUTPUT FROM ELRATE   *************************
  3694
  3695         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3696                                     COMP-3.
  3697         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3698                                     COMP-3.
  3699         16  CP-MORTALITY-CODE     PIC X(4).
  3700         16  CP-RATE-EDIT-FLAG     PIC X.
  3701             88  CP-RATES-NEED-APR                  VALUE '1'.
  3702         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3703                                     COMP-3.
  3704         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3705         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3706         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3707                                   PIC S9(7)V99 COMP-3.
  3708         16  FILLER                PIC X(07).
  3709
  3710***************    OUTPUT FROM ELRFND   *************************
  3711
  3712         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3713                                     COMP-3.
  3714         16  CP-REFUND-TYPE-USED   PIC X.
  3715           88  CP-R-AS-R78                         VALUE '1'.
  3716           88  CP-R-AS-PRORATA                     VALUE '2'.
  3717           88  CP-R-AS-CALIF                       VALUE '3'.
  3718           88  CP-R-AS-TEXAS                       VALUE '4'.
  3719           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3720           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3721           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3722           88  CP-R-AS-MEAN                        VALUE '8'.
  3723           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3724           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3725           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  66
* SOCK03.cbl
  3726           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3727           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3728           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3729         16  FILLER                PIC X(12).
  3730
  3731***************    OUTPUT FROM ELEARN   *************************
  3732
  3733         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3734                                     COMP-3.
  3735         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3736                                     COMP-3.
  3737         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3738                                     COMP-3.
  3739         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3740                                     COMP-3.
  3741         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3742                                     COMP-3.
  3743         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3744                                     COMP-3.
  3745         16  CP-EARNING-TYPE-USED  PIC X.
  3746           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3747           88  CP-E-AS-R78                         VALUE '1'.
  3748           88  CP-E-AS-PRORATA                     VALUE '2'.
  3749           88  CP-E-AS-TEXAS                       VALUE '4'.
  3750           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3751           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3752           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3753           88  CP-E-AS-MEAN                        VALUE '8'.
  3754           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3755         16  FILLER                PIC X(12).
  3756
  3757***************    OUTPUT FROM ELPMNT   *************************
  3758
  3759         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3760                                     COMP-3.
  3761         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3762                                     COMP-3.
  3763         16  FILLER                PIC X(12).
  3764
  3765***************   MISC WORK AREAS    *****************************
  3766         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3767                                     COMP-3.
  3768         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3769                                     COMP-3.
  3770         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3771                                     COMP-3.
  3772         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3773                                     COMP-3.
  3774         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3775                                     COMP-3.
  3776         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3777                                     COMP-3.
  3778         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3779             88  OPEN-RATE-FILE                   VALUE 'O'.
  3780             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3781             88  IO-ERROR                         VALUE 'E'.
  3782
  3783         16  CP-FIRST-PAY-DATE     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  67
* SOCK03.cbl
  3784
  3785         16  CP-JOINT-INDICATOR    PIC X.
  3786
  3787         16  CP-RESERVE-REMAINING-TERM
  3788                                   PIC S9(4)V9    VALUE ZERO
  3789                                     COMP-3.
  3790
  3791         16  CP-INSURED-BIRTH-DT   PIC XX.
  3792
  3793         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3794                                     COMP-3.
  3795
  3796         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3797                                     COMP-3.
  3798
  3799         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3800                                     COMP-3.
  3801
  3802         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3803                                     COMP-3.
  3804
  3805         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3806                                     COMP-3.
  3807
  3808         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3809                                     COMP-3.
  3810
  3811         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3812                                     COMP-3.
  3813
  3814         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3815             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3816
  3817         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3818                                     COMP-3.
  3819         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3820                                     COMP-3.
  3821         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3822         16  FILLER                PIC X(15).
  3823******************************************************************
  3824****************************************************************
  3825*
  3826* Copyright (c) 2007 by Clerity Solutions, Inc.
  3827* All rights reserved.
  3828*
  3829****************************************************************
  3830 01  DFHEIV.
  3831   02  DFHEIV0               PIC X(35).
  3832   02  DFHEIV1               PIC X(08).
  3833   02  DFHEIV2               PIC X(08).
  3834   02  DFHEIV3               PIC X(08).
  3835   02  DFHEIV4               PIC X(06).
  3836   02  DFHEIV5               PIC X(04).
  3837   02  DFHEIV6               PIC X(04).
  3838   02  DFHEIV7               PIC X(02).
  3839   02  DFHEIV8               PIC X(02).
  3840   02  DFHEIV9               PIC X(01).
  3841   02  DFHEIV10              PIC S9(7) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  68
* SOCK03.cbl
  3842   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3843   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3844   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3845   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3846   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3847   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3848   02  DFHEIV17              PIC X(04).
  3849   02  DFHEIV18              PIC X(04).
  3850   02  DFHEIV19              PIC X(04).
  3851   02  DFHEIV20              USAGE IS POINTER.
  3852   02  DFHEIV21              USAGE IS POINTER.
  3853   02  DFHEIV22              USAGE IS POINTER.
  3854   02  DFHEIV23              USAGE IS POINTER.
  3855   02  DFHEIV24              USAGE IS POINTER.
  3856   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3857   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3858   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3859   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3860   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3861   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3862   02  FILLER                PIC X(02).
  3863   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3864   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3865   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3866   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3867   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3868 LINKAGE  SECTION.
  3869*****************************************************************
  3870*                                                               *
  3871* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3872* All rights reserved.                                          *
  3873*                                                               *
  3874*****************************************************************
  3875 01  dfheiblk.
  3876     02  eibtime          pic s9(7) comp-3.
  3877     02  eibdate          pic s9(7) comp-3.
  3878     02  eibtrnid         pic x(4).
  3879     02  eibtaskn         pic s9(7) comp-3.
  3880     02  eibtrmid         pic x(4).
  3881     02  dfheigdi         pic s9(4) comp.
  3882     02  eibcposn         pic s9(4) comp.
  3883     02  eibcalen         pic s9(4) comp.
  3884     02  eibaid           pic x(1).
  3885     02  eibfiller1       pic x(1).
  3886     02  eibfn            pic x(2).
  3887     02  eibfiller2       pic x(2).
  3888     02  eibrcode         pic x(6).
  3889     02  eibfiller3       pic x(2).
  3890     02  eibds            pic x(8).
  3891     02  eibreqid         pic x(8).
  3892     02  eibrsrce         pic x(8).
  3893     02  eibsync          pic x(1).
  3894     02  eibfree          pic x(1).
  3895     02  eibrecv          pic x(1).
  3896     02  eibsend          pic x(1).
  3897     02  eibatt           pic x(1).
  3898     02  eibeoc           pic x(1).
  3899     02  eibfmh           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  69
* SOCK03.cbl
  3900     02  eibcompl         pic x(1).
  3901     02  eibsig           pic x(1).
  3902     02  eibconf          pic x(1).
  3903     02  eiberr           pic x(1).
  3904     02  eibrldbk         pic x(1).
  3905     02  eiberrcd         pic x(4).
  3906     02  eibsynrb         pic x(1).
  3907     02  eibnodat         pic x(1).
  3908     02  eibfiller5       pic x(2).
  3909     02  eibresp          pic 9(09) comp.
  3910     02  eibresp2         pic 9(09) comp.
  3911     02  dfheigdj         pic s9(4) comp.
  3912     02  dfheigdk         pic s9(4) comp.
  3913 01  DFHCOMMAREA.
  3914   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3915   05 LSTN-NAME                PIC X(8).
  3916   05 LSTN-SUBNAME             PIC X(8).
  3917   05 CLIENT-IN-DATA.
  3918      15  CLIENT-CAR           PIC X.
  3919      15  CLIENT-GRP           PIC X(6).
  3920      15  CLIENT-STATE         PIC XX.
  3921      15  CLIENT-ACCOUNT       PIC X(10).
  3922*  DATES ARE IN FORMAT CCYYMMDD  ie. 20090330
  3923      15  CLIENT-EFF-DT        PIC X(8).
  3924      15  CLIENT-CERT-NO       PIC X(11).
  3925      15  CLIENT-LAST-NAME     PIC X(15).
  3926      15  CLIENT-FIRST-NAME    PIC X(10).
  3927      15  CLIENT-VAL-DT        PIC X(8).
  3928      15  CLIENT-CAN-REASON    PIC X.
  3929   05 SOCKADDR-IN-PARM.
  3930     15 SIN-FAMILY             PIC 9(4) COMP.
  3931     15 SIN-PORT               PIC 9(4) COMP.
  3932     15 SIN-ADDRESS            PIC 9(8) COMP.
  3933     15 SIN-ZERO               PIC X(8).
  3934 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3935 0000-DFHEXIT SECTION.
  3936     MOVE '9#                    $   ' TO DFHEIV0.
  3937     MOVE 'SOCK03' TO DFHEIV1.
  3938     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3939     display '  BEGIN SOCK03 '
  3940     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  3941     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  3942     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  3943        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  3944        IF CLIENT-IN-DATA (8:3) = 'AHL'
  3945           MOVE X'06'            TO WS-COMP-CD
  3946           MOVE 'AHL'            TO WS-SEND-BUF (5:3)
  3947                                    WS-COMP-ID
  3948        ELSE
  3949           IF CLIENT-IN-DATA (8:3) = 'DCC'
  3950              MOVE X'05'         TO WS-COMP-CD
  3951              MOVE 'DCC'         TO WS-SEND-BUF (5:3)
  3952                                    WS-COMP-ID
  3953           ELSE
  3954              MOVE X'04'         TO WS-COMP-CD
  3955              MOVE 'CID'         TO WS-SEND-BUF (5:3)
  3956                                    WS-COMP-ID
  3957           END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  70
* SOCK03.cbl
  3958        END-IF
  3959        move 'CSO'               to ws-send-buf (1:3)
  3960        move +25                 to ws-send-msg-size
  3961     END-IF
  3962     display 'SOCK03:sequence number  =', ws-seq-num.
  3963     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  3964     call "send" using by value GIVE-TAKE-SOCKET,
  3965         by reference ws-send-buf,
  3966         by value ws-send-msg-size,
  3967         by value ws-flags.
  3968     if return-code <= zero
  3969         display 'SOCK03:send error ',
  3970         go to socket-error.
  3971     move low-values to ws-recv-buf.
  3972     set ws-recv-total to zero.
  3973     compute ws-recv-left = ws-recv-msg-size.
  3974     display 'SOCK03:About to recv '
  3975     call "recv" using by value GIVE-TAKE-SOCKET,
  3976         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3977         by value ws-recv-left,
  3978         by value ws-flags.
  3979     if return-code < zero
  3980        display 'SOCK03:recv error ',
  3981        go to socket-error.
  3982     if return-code = zero
  3983        display 'SOCK03:client disconnected',
  3984        go to socket-error.
  3985*
  3986     display 'SOCK03:Good recv  '
  3987     display 'SOCK03:return code      = ', return-code
  3988     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:75)
  3989     move +4096                  to ws-send-msg-size
  3990*    move +750                   to ws-send-msg-size
  3991     move ws-recv-buf (1:72)     to client-in-data
  3992     MOVE SPACES                 TO WS-ELCERT-SW
  3993     MOVE X'0A'                  TO WS-HEX-0A
  3994     if client-account = 'EPIQ000001'
  3995        set ws-epiq-request to true
  3996        move spaces              to client-account
  3997     end-if
  3998     move +0 to ws-epiq-max
  3999     EVALUATE TRUE
  4000        WHEN (CLIENT-CAR NOT = SPACES)
  4001           AND (CLIENT-STATE NOT = SPACES)
  4002           AND (CLIENT-ACCOUNT NOT = SPACES)
  4003           AND (CLIENT-EFF-DT NOT = SPACES)
  4004           AND (CLIENT-CERT-NO NOT = SPACES)
  4005           SET WS-ELCERT-FULL    TO TRUE
  4006           DISPLAY ' SETTING FULL '
  4007        WHEN (CLIENT-CERT-NO NOT = SPACES)
  4008           SET WS-ELCERT-CERT-NO TO TRUE
  4009           DISPLAY ' SETTING CERT NO '
  4010*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  4011*          AND (CLIENT-LAST-NAME NOT = SPACES)
  4012        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  4013           AND (CLIENT-LAST-NAME NOT = SPACES)
  4014           SET WS-ELCERT-ACT-NAME TO TRUE
  4015        WHEN CLIENT-LAST-NAME NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  71
* SOCK03.cbl
  4016           SET WS-ELCERT-NAME    TO TRUE
  4017           DISPLAY ' SETTING NAME '
  4018        WHEN OTHER
  4019           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
  4020           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4021           MOVE ZEROS            TO WS-RESP
  4022           PERFORM 0030-BUILD-BUFFER
  4023                                 THRU 0030-EXIT
  4024           PERFORM 0020-SEND-BUFFER
  4025                                 THRU 0020-EXIT
  4026           PERFORM 0025-CLOSE-SOCKET
  4027                                 THRU 0025-EXIT
  4028           GO TO 0010-RETURN
  4029     END-EVALUATE
  4030     IF CLIENT-CAN-REASON = 'R'
  4031        MOVE 'R'                 TO WS-CANCEL-REASON
  4032     ELSE
  4033        MOVE ' '                 TO WS-CANCEL-REASON
  4034     END-IF
  4035     IF WS-ELCERT-KEY-SW NOT = SPACES
  4036        PERFORM 0050-BEGIN-REFUND-PROCESS
  4037                                 THRU 0050-EXIT
  4038     END-IF
  4039     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  4040     .
  4041 0010-RETURN.
  4042
  4043* exec cics return end-exec.
  4044*    MOVE '.(                    ''   #00004038' TO DFHEIV0
  4045     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4046     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4047     MOVE X'2020233030303034303338' TO DFHEIV0(25:11)
  4048     CALL 'kxdfhei1' USING DFHEIV0,
  4049           DFHEIV99,
  4050           DFHEIV99,
  4051           DFHEIV99,
  4052           DFHEIV99,
  4053           DFHEIV99,
  4054           DFHEIV99
  4055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4056
  4057
  4058* goback.
  4059     MOVE '9%                    "   ' TO DFHEIV0
  4060     MOVE 'SOCK03' TO DFHEIV1
  4061     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4062     goback.
  4063*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4064     .
  4065 0020-SEND-BUFFER.
  4066     display 'SOCK03:About to send      '
  4067     display 'SOCK03:sequence number  =', ws-seq-num.
  4068     display 'SOCK03:send buffer      =', ws-send-buf(1:300).
  4069     call "send" using by value GIVE-TAKE-SOCKET,
  4070         by reference ws-send-buf,
  4071         by value ws-send-msg-size,
  4072         by value ws-flags.
  4073     if return-code <= zero
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  72
* SOCK03.cbl
  4074         display 'SOCK03:send error ' return-code,
  4075         go to socket-error.
  4076 0020-EXIT.
  4077     EXIT.
  4078 0025-CLOSE-SOCKET.
  4079*    display 'SOCK03:closing socket'.
  4080*    call "close" using by value GIVE-TAKE-SOCKET .
  4081     display 'SOCK03:done'.
  4082     .
  4083 0025-EXIT.
  4084     EXIT.
  4085*
  4086* set up the receive buffer
  4087*
  4088     move low-values to ws-recv-buf.
  4089     set ws-recv-total to zero.
  4090     compute ws-recv-left = ws-recv-msg-size.
  4091*
  4092* receive data
  4093*
  4094 recv-1.
  4095     call "recv" using by value GIVE-TAKE-SOCKET,
  4096         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4097         by value ws-recv-left,
  4098         by value ws-flags.
  4099*
  4100* test what was received and decide what we should do
  4101*
  4102     if return-code < zero
  4103        display 'SOCK03:recv error ',
  4104        go to socket-error.
  4105     if return-code = zero
  4106        display 'SOCK03:client disconnected',
  4107        go to socket-error.
  4108*
  4109* have we received all the data yet?
  4110*
  4111     compute ws-recv-total = ws-recv-total + return-code.
  4112     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  4113*
  4114* not yet
  4115*
  4116     if ws-recv-left > 0 go to recv-1.
  4117*
  4118* received all the data
  4119*
  4120     display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  4121*
  4122* make sure what we received was what we sent
  4123*
  4124*    if ws-recv-buf <> ws-send-buf
  4125*        display "SOCK03:data doesn't match",
  4126*        go to socket-error.
  4127*
  4128* end of pass
  4129*
  4130*loop-end.
  4131*    if ws-seq-num = 5 go to socket-error.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  73
* SOCK03.cbl
  4132*    go to loop-1.
  4133*
  4134* program end
  4135*
  4136 socket-error.
  4137     if ws-seq-num <> 0
  4138         display "SOCK03:did not complete".
  4139*
  4140* flush the send buffer and deallocate
  4141*
  4142*    display 'SOCK03:closing socket'.
  4143*    call "close" using by value GIVE-TAKE-SOCKET .
  4144*
  4145* finised return to cics
  4146*
  4147 socket-fin.
  4148*    display 'SOCK03:closing socket'.
  4149*    call "close" using by value GIVE-TAKE-SOCKET .
  4150     display 'SOCK03:done'.
  4151
  4152* exec cics return end-exec.
  4153*    MOVE '.(                    ''   #00004128' TO DFHEIV0
  4154     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4155     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4156     MOVE X'2020233030303034313238' TO DFHEIV0(25:11)
  4157     CALL 'kxdfhei1' USING DFHEIV0,
  4158           DFHEIV99,
  4159           DFHEIV99,
  4160           DFHEIV99,
  4161           DFHEIV99,
  4162           DFHEIV99,
  4163           DFHEIV99
  4164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4165
  4166
  4167* goback.
  4168     MOVE '9%                    "   ' TO DFHEIV0
  4169     MOVE 'SOCK03' TO DFHEIV1
  4170     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4171     goback.
  4172 0030-BUILD-BUFFER.
  4173     MOVE SPACES                 TO WS-SEND-BUF
  4174     IF WS-CALL-TYPE = 'NEWBUS'
  4175        STRING
  4176           WS-COMMENT            ';'
  4177           WS-RESP               ';'
  4178           WS-CARRIER            ';'
  4179           WS-GROUPING           ';'
  4180           WS-STATE              ';'
  4181           WS-ACCOUNT            ';'
  4182           WS-CERT-EFF-DATE      ';'
  4183           WS-CERT-NO            ';'
  4184           WS-LAST-NAME          ';'
  4185           WS-FIRST-NAME         ';'
  4186           WS-MID-INIT           ';'
  4187           WS-LAST-JNAME         ';'
  4188           WS-FIRST-JNAME        ';'
  4189           WS-MID-JINIT          ';'
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  74
* SOCK03.cbl
  4190           WS-POST-CARD-SW       ';'
  4191           ws-lf-coverage-type   ';'
  4192           WS-LF-STATUS          ';'
  4193           WS-LF-BEN-CODE        ';'
  4194           WS-LF-BEN-CODE-DESC   ';'
  4195           WS-LF-TERM            ';'
  4196           WS-LF-REM-TERM        ';'
  4197           WS-LF-PREM            ';'
  4198           WS-LF-REFUND          ';'
  4199           WS-LF-METHOD          ';'
  4200           WS-LF-ORIG-BENEFIT    ';'
  4201           WS-LF-REM-BEN         ';'
  4202           WS-LF-EXPIRE-DATE     ';'
  4203           WS-LF-COMM            ';'
  4204           WS-LF-UEC             ';'
  4205           WS-AH-COVERAGE-TYPE   ';'
  4206           WS-AH-STATUS          ';'
  4207           WS-AH-BEN-CODE        ';'
  4208           WS-AH-BEN-CODE-DESC   ';'
  4209           WS-AH-TERM            ';'
  4210           WS-AH-REM-TERM        ';'
  4211           WS-AH-PREM            ';'
  4212           WS-AH-REFUND          ';'
  4213           WS-AH-METHOD          ';'
  4214           WS-AH-ORIG-BENEFIT    ';'
  4215           WS-AH-REM-BEN         ';'
  4216           WS-AH-EXPIRE-DATE     ';'
  4217           WS-AH-COMM            ';'
  4218           WS-AH-UEC             ';'
  4219           WS-ACCOUNT-NAME       ';'
  4220           WS-REPORT-CODE-1      ';'
  4221           WS-REPORT-CODE-2      ';'
  4222           WS-REPORT-CODE-3      ';'
  4223           WS-CLM-PAID-THRU-DT   ';'
  4224           WS-HEX-0A
  4225            DELIMITED BY '  ' INTO WS-SEND-BUF
  4226        END-STRING
  4227     ELSE
  4228        STRING
  4229           WS-COMMENT            ';'
  4230           WS-RESP               ';'
  4231           WS-CARRIER            ';'
  4232           WS-GROUPING           ';'
  4233           WS-STATE              ';'
  4234           WS-ACCOUNT            ';'
  4235           WS-CERT-EFF-DATE      ';'
  4236           WS-CERT-NO            ';'
  4237           WS-LAST-NAME          ';'
  4238           WS-FIRST-NAME         ';'
  4239           WS-MID-INIT           ';'
  4240           WS-LAST-JNAME         ';'
  4241           WS-FIRST-JNAME        ';'
  4242           WS-MID-JINIT          ';'
  4243           WS-POST-CARD-SW       ';'
  4244           WS-LF-STATUS          ';'
  4245           WS-LF-BEN-CODE        ';'
  4246           WS-LF-BEN-CODE-DESC   ';'
  4247           WS-LF-TERM            ';'
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  75
* SOCK03.cbl
  4248           WS-LF-REM-TERM        ';'
  4249           WS-LF-PREM            ';'
  4250           WS-LF-REFUND          ';'
  4251           WS-LF-METHOD          ';'
  4252           WS-LF-ORIG-BENEFIT    ';'
  4253           WS-LF-REM-BEN         ';'
  4254           WS-LF-EXPIRE-DATE     ';'
  4255           WS-LF-COMM            ';'
  4256           WS-LF-UEC             ';'
  4257           WS-AH-STATUS          ';'
  4258           WS-AH-BEN-CODE        ';'
  4259           WS-AH-BEN-CODE-DESC   ';'
  4260           WS-AH-TERM            ';'
  4261           WS-AH-REM-TERM        ';'
  4262           WS-AH-PREM            ';'
  4263           WS-AH-REFUND          ';'
  4264           WS-AH-METHOD          ';'
  4265           WS-AH-ORIG-BENEFIT    ';'
  4266           WS-AH-REM-BEN         ';'
  4267           WS-AH-EXPIRE-DATE     ';'
  4268           WS-AH-COMM            ';'
  4269           WS-AH-UEC             ';'
  4270           WS-ACCOUNT-NAME       ';'
  4271           WS-REPORT-CODE-1      ';'
  4272           WS-REPORT-CODE-2      ';'
  4273           WS-REPORT-CODE-3      ';'
  4274           WS-CLM-PAID-THRU-DT   ';'
  4275           'E'                   ';'
  4276            DELIMITED BY '  ' INTO WS-SEND-BUF
  4277        END-STRING
  4278     END-IF
  4279     .
  4280 0030-EXIT.
  4281     EXIT.
  4282 0050-BEGIN-REFUND-PROCESS.
  4283     IF WS-ELCERT-ACT-NAME
  4284        PERFORM 0060-FIND-FULL-KEY
  4285                                 THRU 0060-EXIT
  4286        MOVE AM-CARRIER          TO CLIENT-CAR
  4287        MOVE AM-GROUPING         TO CLIENT-GRP
  4288        MOVE AM-STATE            TO CLIENT-STATE
  4289     END-IF
  4290     PERFORM 0100-START-ELCERT     THRU 0100-EXIT
  4291     IF NOT RESP-NORMAL
  4292        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4293        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4294        MOVE WS-RESPONSE         TO WS-RESP
  4295        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4296        PERFORM 0020-SEND-BUFFER
  4297                                 THRU 0020-EXIT
  4298        PERFORM 0025-CLOSE-SOCKET
  4299                                 THRU 0025-EXIT
  4300        GO TO 0010-RETURN
  4301     END-IF
  4302     PERFORM 0150-READ-NEXT-ELCERT
  4303                                 THRU 0150-EXIT
  4304*    display ' came back from 0150 ' ws-response
  4305     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  76
* SOCK03.cbl
  4306        DISPLAY ' CERT NOT FOUND '
  4307        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4308        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4309        MOVE WS-RESPONSE         TO WS-RESP
  4310        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4311        PERFORM 0020-SEND-BUFFER
  4312                                 THRU 0020-EXIT
  4313        PERFORM 0025-CLOSE-SOCKET
  4314                                 THRU 0025-EXIT
  4315        GO TO 0010-RETURN
  4316     END-IF
  4317     PERFORM 0200-BEGIN-REFUND-PROCESS
  4318                                 THRU 0200-EXIT UNTIL
  4319        ELCERT-FINISHED
  4320     .
  4321 0050-EXIT.
  4322     EXIT.
  4323 0060-FIND-FULL-KEY.
  4324     MOVE ' ' TO WS-STOP-SW
  4325     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4326     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4327
  4328* EXEC CICS STARTBR
  4329*       DATASET  ('ERACCT3')
  4330*       RIDFLD   (WS-AM3-KEY)
  4331*       GTEQ
  4332*       RESP (WS-RESPONSE)
  4333*    END-EXEC
  4334     MOVE 'ERACCT3' TO DFHEIV1
  4335     MOVE 0
  4336       TO DFHEIV11
  4337*    MOVE '&,         G          &  N#00004285' TO DFHEIV0
  4338     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4339     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4340     MOVE X'204E233030303034323835' TO DFHEIV0(25:11)
  4341     CALL 'kxdfhei1' USING DFHEIV0,
  4342           DFHEIV1,
  4343           WS-AM3-KEY,
  4344           DFHEIV99,
  4345           DFHEIV11,
  4346           DFHEIV99
  4347     MOVE EIBRESP  TO WS-RESPONSE
  4348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4349     IF RESP-NORMAL
  4350        PERFORM UNTIL TOLD-TO-STOP
  4351
  4352* EXEC CICS READNEXT
  4353*             DATASET  ('ERACCT3')
  4354*             INTO     (ACCOUNT-MASTER)
  4355*             RIDFLD   (WS-AM3-KEY)
  4356*          END-EXEC
  4357     MOVE LENGTH OF
  4358      ACCOUNT-MASTER
  4359       TO DFHEIV12
  4360     MOVE 'ERACCT3' TO DFHEIV1
  4361     MOVE 0
  4362       TO DFHEIV11
  4363*    MOVE '&.IL                  )   #00004293' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  77
* SOCK03.cbl
  4364     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4365     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4366     MOVE X'2020233030303034323933' TO DFHEIV0(25:11)
  4367     CALL 'kxdfhei1' USING DFHEIV0,
  4368           DFHEIV1,
  4369           ACCOUNT-MASTER,
  4370           DFHEIV12,
  4371           WS-AM3-KEY,
  4372           DFHEIV99,
  4373           DFHEIV11,
  4374           DFHEIV99,
  4375           DFHEIV99
  4376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4377           EVALUATE TRUE
  4378              WHEN (RESP-NORMAL)
  4379                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4380                 AND (AM-COMPANY-CD = WS-COMP-CD)
  4381                 SET TOLD-TO-STOP TO TRUE
  4382              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4383                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4384                 CONTINUE
  4385              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4386                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4387                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4388                 MOVE ZEROS      TO WS-RESP
  4389                 PERFORM 0030-BUILD-BUFFER
  4390                                 THRU 0030-EXIT
  4391                 PERFORM 0020-SEND-BUFFER
  4392                                 THRU 0020-EXIT
  4393                 PERFORM 0025-CLOSE-SOCKET
  4394                                 THRU 0025-EXIT
  4395                 GO TO 0010-RETURN
  4396           END-EVALUATE
  4397        END-PERFORM
  4398
  4399* EXEC CICS ENDBR
  4400*          DATASET   ('ERACCT3')
  4401*       END-EXEC
  4402     MOVE 'ERACCT3' TO DFHEIV1
  4403     MOVE 0
  4404       TO DFHEIV11
  4405*    MOVE '&2                    $   #00004319' TO DFHEIV0
  4406     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4407     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4408     MOVE X'2020233030303034333139' TO DFHEIV0(25:11)
  4409     CALL 'kxdfhei1' USING DFHEIV0,
  4410           DFHEIV1,
  4411           DFHEIV11,
  4412           DFHEIV99
  4413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4414     ELSE
  4415        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4416        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4417        MOVE ZEROS      TO WS-RESP
  4418        PERFORM 0030-BUILD-BUFFER
  4419                                 THRU 0030-EXIT
  4420        PERFORM 0020-SEND-BUFFER
  4421                                 THRU 0020-EXIT
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  78
* SOCK03.cbl
  4422        PERFORM 0025-CLOSE-SOCKET
  4423                                 THRU 0025-EXIT
  4424        GO TO 0010-RETURN
  4425     END-IF
  4426     .
  4427 0060-EXIT.
  4428     EXIT.
  4429 0100-START-ELCERT.
  4430*    DISPLAY ' MADE 0100 START '
  4431     MOVE SPACES                 TO WS-SEND-BUF
  4432     INITIALIZE WS-STRING-DATA
  4433     MOVE LOW-VALUES             TO WS-CM-KEY
  4434                                    WS-CM-KEY-A1
  4435                                    WS-CM-KEY-A4
  4436     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4437                                    WS-CM-COMPANY-CD-A1
  4438                                    WS-CM-COMPANY-CD-A4
  4439     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4440     MOVE 'L'                    TO DC-OPTION-CODE
  4441     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4442     IF NO-CONVERSION-ERROR
  4443        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4444     ELSE
  4445        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4446        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4447        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4448        PERFORM 0020-SEND-BUFFER
  4449                                 THRU 0020-EXIT
  4450        PERFORM 0025-CLOSE-SOCKET
  4451                                 THRU 0025-EXIT
  4452        GO TO 0010-RETURN
  4453     END-IF
  4454     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
  4455        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
  4456        MOVE 'L'                 TO DC-OPTION-CODE
  4457        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4458        IF NO-CONVERSION-ERROR
  4459           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4460        ELSE
  4461           MOVE 'BAD EFF DT CONVERT '
  4462                                 TO WS-COMMENT
  4463           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4464           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4465           PERFORM 0020-SEND-BUFFER
  4466                                 THRU 0020-EXIT
  4467           PERFORM 0025-CLOSE-SOCKET
  4468                                 THRU 0025-EXIT
  4469           GO TO 0010-RETURN
  4470        END-IF
  4471     END-IF
  4472     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4473        (F1 > +10)
  4474        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
  4475     END-PERFORM
  4476     IF F1 > +1
  4477        SUBTRACT +1 FROM F1
  4478     END-IF
  4479     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  79
* SOCK03.cbl
  4480        (L1 > +15)
  4481        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4482     END-PERFORM
  4483     IF L1 > +1
  4484        SUBTRACT +1 FROM L1
  4485     END-IF
  4486     EVALUATE TRUE
  4487        WHEN WS-ELCERT-FULL
  4488           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4489           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4490           MOVE CLIENT-STATE        TO WS-CM-STATE
  4491           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4492           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4493           MOVE CLIENT-CERT-NO (1:10)
  4494                                    TO WS-CM-CERT-NO
  4495
  4496* EXEC CICS READ
  4497*             INTO    (CERTIFICATE-MASTER)
  4498*             DATASET ('ELCERT')
  4499*             RIDFLD  (WS-CM-KEY)
  4500*             RESP    (WS-RESPONSE)
  4501*          END-EXEC
  4502     MOVE LENGTH OF
  4503      CERTIFICATE-MASTER
  4504       TO DFHEIV11
  4505     MOVE 'ELCERT' TO DFHEIV1
  4506*    MOVE '&"IL       E          (  N#00004403' TO DFHEIV0
  4507     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4508     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4509     MOVE X'204E233030303034343033' TO DFHEIV0(25:11)
  4510     CALL 'kxdfhei1' USING DFHEIV0,
  4511           DFHEIV1,
  4512           CERTIFICATE-MASTER,
  4513           DFHEIV11,
  4514           WS-CM-KEY,
  4515           DFHEIV99,
  4516           DFHEIV99,
  4517           DFHEIV99
  4518     MOVE EIBRESP  TO WS-RESPONSE
  4519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4520        WHEN WS-ELCERT-ACT-NAME
  4521           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4522           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4523           MOVE CLIENT-STATE        TO WS-CM-STATE
  4524           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4525           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  4526           MOVE ZEROS               TO WS-CM-CERT-NO
  4527
  4528* EXEC CICS STARTBR
  4529*             DATASET ('ELCERT')
  4530*             RIDFLD  (WS-CM-KEY)
  4531*             RESP    (WS-RESPONSE)
  4532*          END-EXEC
  4533     MOVE 'ELCERT' TO DFHEIV1
  4534     MOVE 0
  4535       TO DFHEIV11
  4536*    MOVE '&,         G          &  N#00004416' TO DFHEIV0
  4537     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  80
* SOCK03.cbl
  4538     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4539     MOVE X'204E233030303034343136' TO DFHEIV0(25:11)
  4540     CALL 'kxdfhei1' USING DFHEIV0,
  4541           DFHEIV1,
  4542           WS-CM-KEY,
  4543           DFHEIV99,
  4544           DFHEIV11,
  4545           DFHEIV99
  4546     MOVE EIBRESP  TO WS-RESPONSE
  4547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4548        WHEN WS-ELCERT-NAME
  4549           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  4550           MOVE SPACES           TO WS-CM-INITIALS
  4551           COMPUTE WS-LENGTH = L1 + +1
  4552
  4553* EXEC CICS STARTBR
  4554*             DATASET   ('ELCERT2')
  4555*             RIDFLD    (WS-CM-KEY-A1)
  4556*             GENERIC
  4557*             KEYLENGTH (WS-LENGTH)
  4558*             GTEQ
  4559*             RESP      (WS-RESPONSE)
  4560*          END-EXEC
  4561     MOVE 'ELCERT2' TO DFHEIV1
  4562     MOVE 0
  4563       TO DFHEIV11
  4564*    MOVE '&,   KG    G          &  N#00004425' TO DFHEIV0
  4565     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4566     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4567     MOVE X'204E233030303034343235' TO DFHEIV0(25:11)
  4568     CALL 'kxdfhei1' USING DFHEIV0,
  4569           DFHEIV1,
  4570           WS-CM-KEY-A1,
  4571           WS-LENGTH,
  4572           DFHEIV11,
  4573           DFHEIV99
  4574     MOVE EIBRESP  TO WS-RESPONSE
  4575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4576*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  4577*          DISPLAY ' KEY ' WS-CM-KEY-A1
  4578        WHEN WS-ELCERT-CERT-NO
  4579* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
  4580           MOVE +11 TO WS-LENGTH
  4581           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
  4582
  4583* EXEC CICS STARTBR
  4584*             DATASET   ('ELCERT5')
  4585*             RIDFLD    (WS-CM-KEY-A4)
  4586*             GENERIC
  4587*             KEYLENGTH (WS-LENGTH)
  4588*             GTEQ
  4589*             RESP      (WS-RESPONSE)
  4590*          END-EXEC
  4591     MOVE 'ELCERT5' TO DFHEIV1
  4592     MOVE 0
  4593       TO DFHEIV11
  4594*    MOVE '&,   KG    G          &  N#00004439' TO DFHEIV0
  4595     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  81
* SOCK03.cbl
  4596     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4597     MOVE X'204E233030303034343339' TO DFHEIV0(25:11)
  4598     CALL 'kxdfhei1' USING DFHEIV0,
  4599           DFHEIV1,
  4600           WS-CM-KEY-A4,
  4601           WS-LENGTH,
  4602           DFHEIV11,
  4603           DFHEIV99
  4604     MOVE EIBRESP  TO WS-RESPONSE
  4605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4606     END-EVALUATE
  4607     .
  4608 0100-EXIT.
  4609     EXIT.
  4610 0150-READ-NEXT-ELCERT.
  4611*    DISPLAY ' MADE 0150 NEXT '
  4612     EVALUATE TRUE
  4613        WHEN WS-ELCERT-ACT-NAME
  4614*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  4615
  4616* EXEC CICS READNEXT
  4617*             DATASET   ('ELCERT')
  4618*             RIDFLD    (WS-CM-KEY)
  4619*             INTO      (CERTIFICATE-MASTER)
  4620*             RESP      (WS-RESPONSE)
  4621*          END-EXEC
  4622     MOVE LENGTH OF
  4623      CERTIFICATE-MASTER
  4624       TO DFHEIV12
  4625     MOVE 'ELCERT' TO DFHEIV1
  4626     MOVE 0
  4627       TO DFHEIV11
  4628*    MOVE '&.IL                  )  N#00004456' TO DFHEIV0
  4629     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4630     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4631     MOVE X'204E233030303034343536' TO DFHEIV0(25:11)
  4632     CALL 'kxdfhei1' USING DFHEIV0,
  4633           DFHEIV1,
  4634           CERTIFICATE-MASTER,
  4635           DFHEIV12,
  4636           WS-CM-KEY,
  4637           DFHEIV99,
  4638           DFHEIV11,
  4639           DFHEIV99,
  4640           DFHEIV99
  4641     MOVE EIBRESP  TO WS-RESPONSE
  4642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4643        WHEN WS-ELCERT-NAME
  4644*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  4645
  4646* EXEC CICS READNEXT
  4647*             DATASET   ('ELCERT2')
  4648*             RIDFLD    (WS-CM-KEY-A1)
  4649*             INTO      (CERTIFICATE-MASTER)
  4650*             RESP      (WS-RESPONSE)
  4651*          END-EXEC
  4652     MOVE LENGTH OF
  4653      CERTIFICATE-MASTER
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  82
* SOCK03.cbl
  4654       TO DFHEIV12
  4655     MOVE 'ELCERT2' TO DFHEIV1
  4656     MOVE 0
  4657       TO DFHEIV11
  4658*    MOVE '&.IL                  )  N#00004464' TO DFHEIV0
  4659     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4660     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4661     MOVE X'204E233030303034343634' TO DFHEIV0(25:11)
  4662     CALL 'kxdfhei1' USING DFHEIV0,
  4663           DFHEIV1,
  4664           CERTIFICATE-MASTER,
  4665           DFHEIV12,
  4666           WS-CM-KEY-A1,
  4667           DFHEIV99,
  4668           DFHEIV11,
  4669           DFHEIV99,
  4670           DFHEIV99
  4671     MOVE EIBRESP  TO WS-RESPONSE
  4672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4673        WHEN WS-ELCERT-CERT-NO
  4674
  4675* EXEC CICS READNEXT
  4676*             DATASET   ('ELCERT5')
  4677*             RIDFLD    (WS-CM-KEY-A4)
  4678*             INTO      (CERTIFICATE-MASTER)
  4679*             RESP      (WS-RESPONSE)
  4680*          END-EXEC
  4681     MOVE LENGTH OF
  4682      CERTIFICATE-MASTER
  4683       TO DFHEIV12
  4684     MOVE 'ELCERT5' TO DFHEIV1
  4685     MOVE 0
  4686       TO DFHEIV11
  4687*    MOVE '&.IL                  )  N#00004471' TO DFHEIV0
  4688     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4689     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4690     MOVE X'204E233030303034343731' TO DFHEIV0(25:11)
  4691     CALL 'kxdfhei1' USING DFHEIV0,
  4692           DFHEIV1,
  4693           CERTIFICATE-MASTER,
  4694           DFHEIV12,
  4695           WS-CM-KEY-A4,
  4696           DFHEIV99,
  4697           DFHEIV11,
  4698           DFHEIV99,
  4699           DFHEIV99
  4700     MOVE EIBRESP  TO WS-RESPONSE
  4701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4702     END-EVALUATE
  4703     .
  4704 0150-EXIT.
  4705     EXIT.
  4706 0200-BEGIN-REFUND-PROCESS.
  4707*    DISPLAY ' MADE 0200 BEGIN '
  4708     MOVE SPACES                 TO WS-BUFF-SENT-SW
  4709                                    WS-ERACCT-SW
  4710     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
  4711                                    WS-NCB-DIFF-ODD-DAYS
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  83
* SOCK03.cbl
  4712     INITIALIZE WS-STRING-DATA
  4713     IF RESP-NORMAL OR RESP-DUPKEY
  4714        EVALUATE TRUE
  4715           WHEN WS-ELCERT-ACT-NAME
  4716              EVALUATE TRUE
  4717                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  4718                    OR (CM-CARRIER NOT = CLIENT-CAR)
  4719                    OR (CM-GROUPING NOT = CLIENT-GRP)
  4720                    OR (CM-STATE NOT = CLIENT-STATE)
  4721                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
  4722                    SET ELCERT-FINISHED TO TRUE
  4723                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  4724                    CLIENT-LAST-NAME (1:L1))
  4725                    GO TO 0200-CONTINUE
  4726                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  4727                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4728                    GO TO 0200-CONTINUE
  4729                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  4730                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4731                     CLIENT-FIRST-NAME (1:F1)))
  4732                    GO TO 0200-CONTINUE
  4733                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  4734                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4735                    GO TO 0200-CONTINUE
  4736              END-EVALUATE
  4737           WHEN WS-ELCERT-CERT-NO
  4738              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4739                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
  4740                 SET ELCERT-FINISHED TO TRUE
  4741              ELSE
  4742                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4743                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4744                              OR
  4745                    ((CLIENT-LAST-NAME NOT = SPACES)
  4746                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  4747                        CLIENT-LAST-NAME (1:L1)))
  4748                              OR
  4749                    ((CLIENT-FIRST-NAME NOT = SPACES)
  4750                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4751                        CLIENT-FIRST-NAME (1:F1)))
  4752                              OR
  4753                    ((CLIENT-ACCOUNT NOT = SPACES)
  4754                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4755                     GO TO 0200-CONTINUE
  4756                 END-IF
  4757              END-IF
  4758           WHEN WS-ELCERT-NAME
  4759              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4760                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  4761                    CLIENT-LAST-NAME (1:L1))
  4762                  SET ELCERT-FINISHED TO TRUE
  4763              ELSE
  4764                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4765                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4766                           OR
  4767                 ((CLIENT-FIRST-NAME NOT = SPACES)
  4768                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4769                     CLIENT-FIRST-NAME (1:F1)))
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  84
* SOCK03.cbl
  4770                           OR
  4771                 ((CLIENT-ACCOUNT NOT = SPACES)
  4772                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4773                  GO TO 0200-CONTINUE
  4774                 END-IF
  4775              END-IF
  4776           WHEN OTHER
  4777              SET ELCERT-FINISHED   TO TRUE
  4778        END-EVALUATE
  4779     ELSE
  4780        SET ELCERT-FINISHED TO TRUE
  4781     END-IF
  4782*       IF WS-ELCERT-CERT-NO
  4783*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4784*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  4785*                          OR
  4786*                ((CLIENT-EFF-DT NOT = SPACES)
  4787*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4788*                          OR
  4789*                ((CLIENT-LAST-NAME NOT = SPACES)
  4790*                 AND (CM-INSURED-LAST-NAME NOT =
  4791*                    CLIENT-LAST-NAME))
  4792*                 SET ELCERT-FINISHED TO TRUE
  4793*          END-IF
  4794*          IF WS-ELCERT-NAME
  4795*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4796*                OR (CM-INSURED-LAST-NAME NOT =
  4797*                   CLIENT-LAST-NAME)
  4798*                            OR
  4799*                ((CLIENT-EFF-DT NOT = SPACES)
  4800*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4801*                 SET ELCERT-FINISHED TO TRUE
  4802*             END-IF
  4803*          ELSE
  4804*             SET ELCERT-FINISHED   TO TRUE
  4805*          END-IF
  4806     IF NOT WS-ELCERT-FULL
  4807        IF ELCERT-FINISHED
  4808           GO TO 0200-EXIT
  4809        END-IF
  4810     END-IF
  4811     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
  4812        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  4813        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4814        PERFORM 0030-BUILD-BUFFER
  4815                                 THRU 0030-EXIT
  4816        PERFORM 0020-SEND-BUFFER
  4817                                 THRU 0020-EXIT
  4818        GO TO 0200-CONTINUE
  4819     END-IF
  4820     if (ws-epiq-request)
  4821        and (not EPIQ-CLASS)
  4822        go to 0200-continue
  4823     end-if
  4824
  4825     if ws-epiq-request
  4826        add +1 to ws-epiq-max
  4827        if ws-epiq-max > +100
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  85
* SOCK03.cbl
  4828           go to 0200-continue
  4829        end-if
  4830     end-if
  4831     PERFORM 0300-GET-ELCNTL-RECORDS
  4832                                 THRU 0300-EXIT
  4833     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  4834     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  4835     MOVE +0                     TO DC-ELAPSED-MONTHS
  4836                                    DC-ELAPSED-DAYS
  4837     MOVE '1'                    TO DC-OPTION-CODE
  4838     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4839     IF NO-CONVERSION-ERROR
  4840        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  4841        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  4842     END-IF
  4843     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  4844     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  4845     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4846     IF NOT ALREADY-SENT
  4847        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
  4848     END-IF
  4849     .
  4850 0200-CONTINUE.
  4851     PERFORM 0150-READ-NEXT-ELCERT
  4852                                 THRU 0150-EXIT
  4853     .
  4854 0200-EXIT.
  4855     EXIT.
  4856 0300-GET-ELCNTL-RECORDS.
  4857     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  4858     IF NOT RESP-NORMAL
  4859        MOVE ' COMPANY RECORD NOT FOUND '
  4860                                 TO WS-COMMENT
  4861        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4862        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4863        PERFORM 0020-SEND-BUFFER
  4864                                 THRU 0020-EXIT
  4865        PERFORM 0025-CLOSE-SOCKET
  4866                                 THRU 0025-EXIT
  4867        GO TO 0010-RETURN
  4868     END-IF
  4869     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  4870        PERFORM 0320-GET-LIFE-RECORD
  4871                                 THRU 0320-EXIT
  4872        IF NOT RESP-NORMAL
  4873           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
  4874                                 TO WS-COMMENT
  4875           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4876           PERFORM 0030-BUILD-BUFFER
  4877                                 THRU 0030-EXIT
  4878           PERFORM 0020-SEND-BUFFER
  4879                                 THRU 0020-EXIT
  4880           PERFORM 0025-CLOSE-SOCKET
  4881                                 THRU 0025-EXIT
  4882           GO TO 0010-RETURN
  4883        END-IF
  4884     END-IF
  4885     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  86
* SOCK03.cbl
  4886        PERFORM 0330-GET-AH-RECORD
  4887                                 THRU 0330-EXIT
  4888        IF NOT RESP-NORMAL
  4889           MOVE ' AH BENEFIT RECORD NOT FOUND '
  4890                                 TO WS-COMMENT
  4891           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4892           PERFORM 0030-BUILD-BUFFER
  4893                                 THRU 0030-EXIT
  4894           PERFORM 0020-SEND-BUFFER
  4895                                 THRU 0020-EXIT
  4896           PERFORM 0025-CLOSE-SOCKET
  4897                                 THRU 0025-EXIT
  4898           GO TO 0010-RETURN
  4899        END-IF
  4900     END-IF
  4901     PERFORM 0340-GET-STATE-RECORD
  4902                                 THRU 0340-EXIT
  4903     IF NOT RESP-NORMAL
  4904        MOVE ' STATE RECORD NOT FOUND '
  4905                                 TO WS-COMMENT
  4906        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4907        PERFORM 0030-BUILD-BUFFER
  4908                                 THRU 0030-EXIT
  4909        PERFORM 0020-SEND-BUFFER
  4910                                 THRU 0020-EXIT
  4911        PERFORM 0025-CLOSE-SOCKET
  4912                                 THRU 0025-EXIT
  4913        GO TO 0010-RETURN
  4914     END-IF
  4915     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  4916     IF NOT ERACCT-FOUND
  4917        MOVE ' ACCOUNT NOT FOUND '
  4918                                 TO WS-COMMENT
  4919        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4920        PERFORM 0030-BUILD-BUFFER
  4921                                 THRU 0030-EXIT
  4922        PERFORM 0020-SEND-BUFFER
  4923                                 THRU 0020-EXIT
  4924        PERFORM 0025-CLOSE-SOCKET
  4925                                 THRU 0025-EXIT
  4926        GO TO 0010-RETURN
  4927     ELSE
  4928        MOVE AM-NAME             TO WS-ACCOUNT-NAME
  4929        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  4930        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
  4931        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
  4932     END-IF
  4933     .
  4934 0300-EXIT.
  4935     EXIT.
  4936 0310-GET-COMPANY.
  4937     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  4938     MOVE '1'                    TO  WS-CF-RECORD-TYPE
  4939     MOVE SPACES                 TO  WS-CF-ACCESS
  4940     MOVE +0                     TO  WS-CF-SEQUENCE-NO
  4941
  4942* EXEC CICS READ
  4943*       INTO    (CONTROL-FILE)
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  87
* SOCK03.cbl
  4944*       DATASET ('ELCNTL')
  4945*       RIDFLD  (WS-CF-KEY)
  4946*       RESP    (WS-RESPONSE)
  4947*    END-EXEC
  4948     MOVE LENGTH OF
  4949      CONTROL-FILE
  4950       TO DFHEIV11
  4951     MOVE 'ELCNTL' TO DFHEIV1
  4952*    MOVE '&"IL       E          (  N#00004716' TO DFHEIV0
  4953     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4954     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4955     MOVE X'204E233030303034373136' TO DFHEIV0(25:11)
  4956     CALL 'kxdfhei1' USING DFHEIV0,
  4957           DFHEIV1,
  4958           CONTROL-FILE,
  4959           DFHEIV11,
  4960           WS-CF-KEY,
  4961           DFHEIV99,
  4962           DFHEIV99,
  4963           DFHEIV99
  4964     MOVE EIBRESP  TO WS-RESPONSE
  4965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4966     IF (RESP-NORMAL)
  4967        AND (CF-COMPANY-ID = WS-COMP-ID)
  4968        AND (CF-RECORD-TYPE = '1')
  4969        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  4970        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
  4971        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
  4972        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  4973        IF CF-DEFAULT-APR NUMERIC
  4974           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  4975        ELSE
  4976           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  4977        END-IF
  4978        IF CF-VALID-REM-TRM-OPTION
  4979           MOVE CF-REM-TRM-CALC-OPTION
  4980                                 TO WS-CF-REM-TRM-CALC-OPTION
  4981        ELSE
  4982           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  4983        END-IF
  4984     END-IF
  4985     .
  4986 0310-EXIT.
  4987     EXIT.
  4988 0320-GET-LIFE-RECORD.
  4989     MOVE '4'                    TO WS-CF-RECORD-TYPE
  4990     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  4991                                    WS-LF-BEN-CODE
  4992     MOVE +0                     TO WS-CF-SEQUENCE-NO
  4993
  4994* EXEC CICS READ
  4995*       INTO    (CONTROL-FILE)
  4996*       DATASET ('ELCNTL')
  4997*       RIDFLD  (WS-CF-KEY)
  4998*       GTEQ
  4999*       RESP    (WS-RESPONSE)
  5000*    END-EXEC
  5001     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  88
* SOCK03.cbl
  5002      CONTROL-FILE
  5003       TO DFHEIV11
  5004     MOVE 'ELCNTL' TO DFHEIV1
  5005*    MOVE '&"IL       G          (  N#00004749' TO DFHEIV0
  5006     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5007     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5008     MOVE X'204E233030303034373439' TO DFHEIV0(25:11)
  5009     CALL 'kxdfhei1' USING DFHEIV0,
  5010           DFHEIV1,
  5011           CONTROL-FILE,
  5012           DFHEIV11,
  5013           WS-CF-KEY,
  5014           DFHEIV99,
  5015           DFHEIV99,
  5016           DFHEIV99
  5017     MOVE EIBRESP  TO WS-RESPONSE
  5018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5019     IF RESP-NORMAL
  5020        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5021        AND (CF-RECORD-TYPE = '4')
  5022        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5023           (S1 > +8)
  5024           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5025        END-PERFORM
  5026        IF S1 > +8
  5027           CONTINUE
  5028        ELSE
  5029           MOVE CF-BENEFIT-DESCRIP (S1)
  5030                                 TO WS-LF-BEN-CODE-DESC
  5031           MOVE CF-LF-COVERAGE-TYPE (S1)
  5032                                 TO WS-CF-LF-COVERAGE-TYPE
  5033           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5034              MOVE 'S'           TO WS-LF-COVERAGE-TYPE
  5035           ELSE
  5036              MOVE 'J'           TO WS-LF-COVERAGE-TYPE
  5037           END-IF
  5038           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5039               MOVE CF-CO-REM-TERM-CALC (S1)
  5040                                 TO WS-LF-CO-REM-TERM-CALC
  5041           END-IF
  5042           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  5043               MOVE CF-CO-EARNINGS-CALC (S1)
  5044                                 TO WS-LF-CO-EARNINGS-CALC
  5045                                    WS-LF-CO-REFUND-CALC
  5046           END-IF
  5047           IF CF-SPECIAL-CALC-CD (S1) > ' '
  5048               MOVE CF-SPECIAL-CALC-CD (S1)
  5049                                 TO WS-LF-SPECIAL-CALC-CD
  5050           END-IF
  5051           IF CF-CO-REFUND-CALC (S1) > '0'
  5052               MOVE CF-CO-REFUND-CALC (S1)
  5053                                 TO WS-LF-CO-REFUND-CALC
  5054        END-IF
  5055     END-IF
  5056     .
  5057 0320-EXIT.
  5058     EXIT.
  5059 0330-GET-AH-RECORD.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  89
* SOCK03.cbl
  5060     MOVE '5'                    TO WS-CF-RECORD-TYPE
  5061     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5062     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5063
  5064* EXEC CICS READ
  5065*       INTO    (CONTROL-FILE)
  5066*       DATASET ('ELCNTL')
  5067*       RIDFLD  (WS-CF-KEY)
  5068*       GTEQ
  5069*       RESP    (WS-RESPONSE)
  5070*    END-EXEC
  5071     MOVE LENGTH OF
  5072      CONTROL-FILE
  5073       TO DFHEIV11
  5074     MOVE 'ELCNTL' TO DFHEIV1
  5075*    MOVE '&"IL       G          (  N#00004800' TO DFHEIV0
  5076     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5077     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5078     MOVE X'204E233030303034383030' TO DFHEIV0(25:11)
  5079     CALL 'kxdfhei1' USING DFHEIV0,
  5080           DFHEIV1,
  5081           CONTROL-FILE,
  5082           DFHEIV11,
  5083           WS-CF-KEY,
  5084           DFHEIV99,
  5085           DFHEIV99,
  5086           DFHEIV99
  5087     MOVE EIBRESP  TO WS-RESPONSE
  5088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5089     IF RESP-NORMAL
  5090        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5091        AND (CF-RECORD-TYPE = '5')
  5092        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5093           (S1 > +8)
  5094           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5095        END-PERFORM
  5096        IF S1 > +8
  5097           CONTINUE
  5098        ELSE
  5099           MOVE CF-BENEFIT-DESCRIP (S1)
  5100                                 TO WS-AH-BEN-CODE-DESC
  5101           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5102              MOVE 'S'           TO WS-AH-COVERAGE-TYPE
  5103           ELSE
  5104              MOVE 'J'           TO WS-AH-COVERAGE-TYPE
  5105           END-IF
  5106           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5107              MOVE CF-CO-REM-TERM-CALC (S1)
  5108                                 TO WS-AH-CO-REM-TERM-CALC
  5109           END-IF
  5110           IF CF-CO-EARNINGS-CALC (S1) > ' '
  5111              MOVE CF-CO-EARNINGS-CALC (S1)
  5112                                 TO WS-AH-CO-EARNINGS-CALC
  5113                                    WS-AH-CO-REFUND-CALC
  5114           END-IF
  5115           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  5116              MOVE CF-SPECIAL-CALC-CD (S1)
  5117                                 TO WS-AH-SPECIAL-CALC-CD
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  90
* SOCK03.cbl
  5118           END-IF
  5119           IF CF-CO-REFUND-CALC (S1) > '0'
  5120              MOVE CF-CO-REFUND-CALC (S1)
  5121                                 TO WS-AH-CO-REFUND-CALC
  5122           END-IF
  5123           IF CF-BENEFIT-CATEGORY (S1) > ' '
  5124              MOVE CF-BENEFIT-CATEGORY (S1)
  5125                                 TO WS-AH-BEN-CATEGORY
  5126           END-IF
  5127        END-IF
  5128     END-IF
  5129     .
  5130 0330-EXIT.
  5131     EXIT.
  5132 0340-GET-STATE-RECORD.
  5133     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  5134     MOVE '3'                    TO WS-CF-RECORD-TYPE
  5135     MOVE CM-STATE               TO WS-CF-ACCESS
  5136     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5137
  5138* EXEC CICS READ
  5139*       INTO    (CONTROL-FILE)
  5140*       DATASET ('ELCNTL')
  5141*       RIDFLD  (WS-CF-KEY)
  5142*       RESP    (WS-RESPONSE)
  5143*    END-EXEC
  5144     MOVE LENGTH OF
  5145      CONTROL-FILE
  5146       TO DFHEIV11
  5147     MOVE 'ELCNTL' TO DFHEIV1
  5148*    MOVE '&"IL       E          (  N#00004855' TO DFHEIV0
  5149     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5150     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5151     MOVE X'204E233030303034383535' TO DFHEIV0(25:11)
  5152     CALL 'kxdfhei1' USING DFHEIV0,
  5153           DFHEIV1,
  5154           CONTROL-FILE,
  5155           DFHEIV11,
  5156           WS-CF-KEY,
  5157           DFHEIV99,
  5158           DFHEIV99,
  5159           DFHEIV99
  5160     MOVE EIBRESP  TO WS-RESPONSE
  5161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5162     IF (RESP-NORMAL)
  5163        AND (CF-COMPANY-ID = WS-COMP-ID)
  5164        AND (CF-RECORD-TYPE = '3')
  5165        AND (CF-STATE-CODE = CM-STATE)
  5166        MOVE CF-ST-FREE-LOOK-PERIOD
  5167                                 TO WS-FREE-LOOK
  5168        MOVE CF-STATE-ABBREVIATION
  5169                                 TO WS-STATE-ABBREVIATION
  5170        MOVE CF-ST-FST-PMT-DAYS-CHG
  5171                                 TO  WS-STATE-EXT-DAYS-CHG
  5172        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  5173           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  5174           IF CF-ST-RT-CALC NOT = SPACES
  5175              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  91
* SOCK03.cbl
  5176           END-IF
  5177           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  5178              IF CF-ST-RF-LR-CALC > '0'
  5179                 MOVE CF-ST-RF-LR-CALC
  5180                                 TO WS-LF-ST-REFUND-CALC
  5181              END-IF
  5182              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  5183                 IF CF-ST-RF-LN-CALC > '0'
  5184                    MOVE CF-ST-RF-LN-CALC
  5185                                 TO WS-LF-ST-REFUND-CALC
  5186                 END-IF
  5187              END-IF
  5188           ELSE
  5189              IF CF-ST-RF-LL-CALC > '0'
  5190                 MOVE CF-ST-RF-LL-CALC
  5191                                 TO WS-LF-ST-REFUND-CALC
  5192              END-IF
  5193           END-IF
  5194           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5195              (S1 > 50)
  5196              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5197                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  5198           END-PERFORM
  5199           IF S1 < +51
  5200              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5201                 MOVE CF-ST-REM-TERM-CALC (S1)
  5202                                 TO WS-LF-ST-REM-TERM-CALC
  5203              END-IF
  5204              IF CF-ST-REFUND-CALC (S1) > '0'
  5205                 MOVE CF-ST-REFUND-CALC (S1)
  5206                                 TO WS-LF-ST-REFUND-CALC
  5207              END-IF
  5208           END-IF
  5209        END-IF
  5210        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  5211           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  5212           IF CF-ST-RT-CALC NOT = SPACES
  5213              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  5214           END-IF
  5215           IF CF-ST-RF-AH-CALC > '0'
  5216              MOVE CF-ST-RF-AH-CALC
  5217                                 TO WS-AH-ST-REFUND-CALC
  5218           END-IF
  5219           IF WS-AH-SPECIAL-CALC-CD = 'C'
  5220              IF CF-ST-RF-CP-CALC > '0'
  5221                 MOVE CF-ST-RF-CP-CALC
  5222                                 TO WS-AH-ST-REFUND-CALC
  5223              END-IF
  5224           END-IF
  5225           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5226              (S1 > 50)
  5227              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5228                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
  5229           END-PERFORM
  5230           IF S1 < +51
  5231              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5232                 MOVE CF-ST-REM-TERM-CALC (S1)
  5233                                 TO WS-AH-ST-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  92
* SOCK03.cbl
  5234              END-IF
  5235              IF CF-ST-REFUND-CALC (S1) > '0'
  5236                 MOVE CF-ST-REFUND-CALC (S1)
  5237                                 TO WS-AH-ST-REFUND-CALC
  5238              END-IF
  5239           END-IF
  5240        END-IF
  5241     END-IF
  5242     .
  5243 0340-EXIT.
  5244     EXIT.
  5245 0350-GET-ERACCT.
  5246     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  5247                                    WS-AM-EARN-METHOD-R
  5248                                    WS-AM-EARN-METHOD-A
  5249                                    WS-LF-AM-REM-TERM-CALC
  5250                                    WS-AH-AM-REM-TERM-CALC
  5251     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  5252     MOVE CM-CARRIER             TO WS-AM-CARRIER
  5253     MOVE CM-GROUPING            TO WS-AM-GROUPING
  5254     MOVE CM-STATE               TO WS-AM-STATE
  5255     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  5256     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  5257     MOVE LOW-VALUES             TO WS-AM-FILLER
  5258     MOVE ' '                    TO WS-STOP-SW
  5259
  5260* EXEC CICS STARTBR
  5261*       DATASET  ('ERACCT')
  5262*       RIDFLD   (WS-AM-KEY)
  5263*       GTEQ
  5264*       RESP (WS-RESPONSE)
  5265*    END-EXEC
  5266     MOVE 'ERACCT' TO DFHEIV1
  5267     MOVE 0
  5268       TO DFHEIV11
  5269*    MOVE '&,         G          &  N#00004958' TO DFHEIV0
  5270     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5271     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5272     MOVE X'204E233030303034393538' TO DFHEIV0(25:11)
  5273     CALL 'kxdfhei1' USING DFHEIV0,
  5274           DFHEIV1,
  5275           WS-AM-KEY,
  5276           DFHEIV99,
  5277           DFHEIV11,
  5278           DFHEIV99
  5279     MOVE EIBRESP  TO WS-RESPONSE
  5280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5281     IF RESP-NORMAL
  5282        PERFORM UNTIL TOLD-TO-STOP
  5283
  5284* EXEC CICS READNEXT
  5285*             DATASET  ('ERACCT')
  5286*             INTO     (ACCOUNT-MASTER)
  5287*             RIDFLD   (WS-AM-KEY)
  5288*          END-EXEC
  5289     MOVE LENGTH OF
  5290      ACCOUNT-MASTER
  5291       TO DFHEIV12
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  93
* SOCK03.cbl
  5292     MOVE 'ERACCT' TO DFHEIV1
  5293     MOVE 0
  5294       TO DFHEIV11
  5295*    MOVE '&.IL                  )   #00004966' TO DFHEIV0
  5296     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5297     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5298     MOVE X'2020233030303034393636' TO DFHEIV0(25:11)
  5299     CALL 'kxdfhei1' USING DFHEIV0,
  5300           DFHEIV1,
  5301           ACCOUNT-MASTER,
  5302           DFHEIV12,
  5303           WS-AM-KEY,
  5304           DFHEIV99,
  5305           DFHEIV11,
  5306           DFHEIV99,
  5307           DFHEIV99
  5308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5309           IF RESP-NORMAL
  5310              EVALUATE TRUE
  5311                 WHEN AM-CONTROL-PRIMARY (1:20) NOT =
  5312                    CM-CONTROL-PRIMARY (1:20)
  5313                    SET TOLD-TO-STOP TO TRUE
  5314                 WHEN (AM-CONTROL-PRIMARY (1:20) =
  5315                    CM-CONTROL-PRIMARY (1:20))
  5316                    AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5317                    AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5318                    SET ERACCT-FOUND      TO TRUE
  5319                    SET TOLD-TO-STOP TO TRUE
  5320              END-EVALUATE
  5321           ELSE
  5322              SET TOLD-TO-STOP TO TRUE
  5323           END-IF
  5324        END-PERFORM
  5325
  5326* EXEC CICS ENDBR
  5327*          DATASET   ('ERACCT')
  5328*       END-EXEC
  5329     MOVE 'ERACCT' TO DFHEIV1
  5330     MOVE 0
  5331       TO DFHEIV11
  5332*    MOVE '&2                    $   #00004987' TO DFHEIV0
  5333     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5334     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5335     MOVE X'2020233030303034393837' TO DFHEIV0(25:11)
  5336     CALL 'kxdfhei1' USING DFHEIV0,
  5337           DFHEIV1,
  5338           DFHEIV11,
  5339           DFHEIV99
  5340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5341     END-IF
  5342     .
  5343 0350-EXIT.
  5344     EXIT.
  5345 0400-PROCESS-LIFE.
  5346     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5347     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5348     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5349     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  94
* SOCK03.cbl
  5350     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5351     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5352     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
  5353     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5354     MOVE CM-CARRIER             TO WS-CARRIER
  5355     MOVE CM-GROUPING            TO WS-GROUPING
  5356     MOVE CM-STATE               TO WS-STATE
  5357     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5358     MOVE CM-CERT-NO             TO WS-CERT-NO
  5359     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5360     MOVE ' '                    TO  DC-OPTION-CODE.
  5361     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5362     IF NO-CONVERSION-ERROR
  5363        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5364     ELSE
  5365        MOVE 99999999            TO WS-CERT-EFF-DATE
  5366     END-IF
  5367     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5368        GO TO 0400-EXIT
  5369     END-IF
  5370     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5371                                    WS-TOT-LF-PREM
  5372                                    WS-TOT-LF-COMM
  5373     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5374     MOVE ' '                    TO  DC-OPTION-CODE
  5375     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5376     IF NO-CONVERSION-ERROR
  5377        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
  5378     ELSE
  5379        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5380     END-IF
  5381     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5382     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5383     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5384     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5385     MOVE CM-STATE               TO CP-STATE
  5386     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5387     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5388     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5389     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5390     MOVE CM-LOAN-APR            TO CP-LOAN-APR
  5391     MOVE '2'                    TO CP-PROCESS-TYPE
  5392     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5393     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
  5394     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5395     MOVE WS-CF-REM-TRM-CALC-OPTION
  5396                                 TO CP-REM-TRM-CALC-OPTION
  5397     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5398     IF WS-LF-CO-REM-TERM-CALC > '0'
  5399        MOVE WS-LF-CO-REM-TERM-CALC
  5400                                 TO CP-REM-TERM-METHOD
  5401     END-IF
  5402     IF WS-LF-ST-REM-TERM-CALC > '0'
  5403         MOVE WS-LF-ST-REM-TERM-CALC
  5404                                 TO  CP-REM-TERM-METHOD.
  5405     IF WS-LF-AM-REM-TERM-CALC > '0'
  5406         MOVE WS-LF-AM-REM-TERM-CALC
  5407                                 TO  CP-REM-TERM-METHOD.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  95
* SOCK03.cbl
  5408     IF (WS-COMP-ID = 'CID')
  5409        AND (CP-STATE-STD-ABBRV = 'WI')
  5410        MOVE '7'                 TO CP-REM-TERM-METHOD
  5411        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5412     END-IF
  5413     IF (WS-COMP-ID = 'CID')
  5414        AND (CP-STATE-STD-ABBRV = 'MO')
  5415        AND (CM-CERT-EFF-DT >= X'9B41')
  5416        AND (CM-CERT-EFF-DT <= X'A2FB')
  5417        MOVE '7'                 TO CP-REM-TERM-METHOD
  5418        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5419     END-IF
  5420     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5421                                    CP-LOAN-TERM
  5422                                    WS-LF-TERM
  5423     IF CP-TRUNCATED-LIFE
  5424         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5425     IF CP-TERM-IS-DAYS
  5426        IF CM-LF-TERM-IN-DAYS NUMERIC
  5427           MOVE CM-LF-TERM-IN-DAYS
  5428                                 TO CP-TERM-OR-EXT-DAYS
  5429        ELSE
  5430           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5431        END-IF
  5432     ELSE
  5433        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5434           MOVE CM-PMT-EXTENSION-DAYS
  5435                                 TO CP-TERM-OR-EXT-DAYS
  5436        ELSE
  5437           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5438        END-IF
  5439     END-IF
  5440     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5441     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5442        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5443        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5444     END-IF
  5445     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5446     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5447     MOVE ' '                    TO WS-CLM-STOP-SW
  5448     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5449     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5450
  5451* EXEC CICS STARTBR
  5452*       DATASET     ('ELMSTR5')
  5453*       RIDFLD      (ELMSTR-KEY)
  5454*       RESP        (WS-RESPONSE)
  5455*    END-EXEC
  5456     MOVE 'ELMSTR5' TO DFHEIV1
  5457     MOVE 0
  5458       TO DFHEIV11
  5459*    MOVE '&,         G          &  N#00005099' TO DFHEIV0
  5460     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5461     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5462     MOVE X'204E233030303035303939' TO DFHEIV0(25:11)
  5463     CALL 'kxdfhei1' USING DFHEIV0,
  5464           DFHEIV1,
  5465           ELMSTR-KEY,
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  96
* SOCK03.cbl
  5466           DFHEIV99,
  5467           DFHEIV11,
  5468           DFHEIV99
  5469     MOVE EIBRESP  TO WS-RESPONSE
  5470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5471     DISPLAY ' AFTER START ' WS-RESPONSE
  5472     IF RESP-NORMAL
  5473        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5474
  5475* EXEC CICS READNEXT
  5476*             DATASET   ('ELMSTR5')
  5477*             RIDFLD    (ELMSTR-KEY)
  5478*             INTO      (CLAIM-MASTER)
  5479*             RESP      (WS-RESPONSE)
  5480*          END-EXEC
  5481     MOVE LENGTH OF
  5482      CLAIM-MASTER
  5483       TO DFHEIV12
  5484     MOVE 'ELMSTR5' TO DFHEIV1
  5485     MOVE 0
  5486       TO DFHEIV11
  5487*    MOVE '&.IL                  )  N#00005107' TO DFHEIV0
  5488     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5489     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5490     MOVE X'204E233030303035313037' TO DFHEIV0(25:11)
  5491     CALL 'kxdfhei1' USING DFHEIV0,
  5492           DFHEIV1,
  5493           CLAIM-MASTER,
  5494           DFHEIV12,
  5495           ELMSTR-KEY,
  5496           DFHEIV99,
  5497           DFHEIV11,
  5498           DFHEIV99,
  5499           DFHEIV99
  5500     MOVE EIBRESP  TO WS-RESPONSE
  5501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5502        IF (RESP-NORMAL OR RESP-DUPKEY)
  5503           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5504           AND (CM-CERT-NO = CL-CERT-NO)
  5505           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5506              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5507              IF CL-CLAIM-TYPE = 'L'
  5508                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5509                    MOVE 'D'     TO WS-AH-STATUS
  5510                 END-IF
  5511                 IF CLAIM-IS-OPEN
  5512                    MOVE ' OPEN LIFE CLAIM '
  5513                                 TO WS-COMMENT
  5514                    MOVE 'L'     TO WS-LF-STATUS
  5515                    GO TO 0400-EXIT
  5516                 ELSE
  5517                    MOVE ' DEATH CLAIM APPLIED '
  5518                                 TO WS-COMMENT
  5519                    MOVE 'D'     TO WS-LF-STATUS
  5520*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
  5521*                      MOVE CL-PAID-THRU-DT
  5522*                                TO WS-LF-BIN-PAID-THRU-DT
  5523*                   END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  97
* SOCK03.cbl
  5524                 END-IF
  5525              END-IF
  5526           END-IF
  5527        ELSE
  5528           SET I-SAY-TO-STOP TO TRUE
  5529        END-IF
  5530        END-PERFORM
  5531
  5532* EXEC CICS ENDBR
  5533*          DATASET   ('ELMSTR5')
  5534*       END-EXEC
  5535     MOVE 'ELMSTR5' TO DFHEIV1
  5536     MOVE 0
  5537       TO DFHEIV11
  5538*    MOVE '&2                    $   #00005142' TO DFHEIV0
  5539     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5540     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5541     MOVE X'2020233030303035313432' TO DFHEIV0(25:11)
  5542     CALL 'kxdfhei1' USING DFHEIV0,
  5543           DFHEIV1,
  5544           DFHEIV11,
  5545           DFHEIV99
  5546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5547     END-IF
  5548     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  5549*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  5550        MOVE WS-LF-BIN-PAID-THRU-DT
  5551                                 TO DC-BIN-DATE-1
  5552        MOVE ' '                 TO DC-OPTION-CODE
  5553        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5554        IF NO-CONVERSION-ERROR
  5555           MOVE DC-GREG-DATE-CYMD
  5556                                 TO WS-CLM-PAID-THRU-DT
  5557        ELSE
  5558           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  5559        END-IF
  5560*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  5561*          MOVE 'CAN DT =< CLM PD THRU DT'
  5562*                                TO WS-COMMENT
  5563*          MOVE 'P'              TO WS-LF-STATUS
  5564*          GO TO 0400-EXIT
  5565*       END-IF
  5566        GO TO 0400-EXIT
  5567     END-IF
  5568     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  5569     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5570        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5571        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  5572        COMPUTE CP-REMAINING-TERM-1 =
  5573                CP-REMAINING-TERM-1 - +1
  5574        COMPUTE CP-REMAINING-TERM-2 =
  5575                CP-REMAINING-TERM-2 - +1
  5576     END-IF
  5577     IF CP-REMAINING-TERM-1 NEGATIVE
  5578        MOVE ZEROS               TO CP-REMAINING-TERM-1
  5579     END-IF
  5580     IF CP-REMAINING-TERM-2 NEGATIVE
  5581        MOVE ZEROS               TO CP-REMAINING-TERM-2
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  98
* SOCK03.cbl
  5582     END-IF
  5583     IF CM-LIFE-COMM-PCT NOT NUMERIC
  5584        MOVE ZERO                TO CM-LIFE-COMM-PCT
  5585     END-IF
  5586     IF CM-LIFE-COMM-PCT > ZEROS
  5587        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  5588           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  5589     END-IF
  5590     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  5591     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  5592     IF CM-LF-CURRENT-STATUS = '8'
  5593        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5594           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  5595                                 TO WS-COMMENT
  5596           MOVE 'C'              TO WS-LF-STATUS
  5597*          PERFORM 0030-BUILD-BUFFER
  5598*                                THRU 0030-EXIT
  5599*          PERFORM 0020-SEND-BUFFER
  5600*                                THRU 0020-EXIT
  5601*          SET ALREADY-SENT      TO TRUE
  5602*          MOVE SPACES           TO WS-COMMENT
  5603           GO TO 0400-EXIT
  5604*          PERFORM 0025-CLOSE-SOCKET
  5605*                                THRU 0025-EXIT
  5606*          GO TO 0010-RETURN
  5607        END-IF
  5608     END-IF
  5609     IF CM-LF-CURRENT-STATUS = '7'
  5610        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5611           MOVE ' DEATH CLAIM APPLIED '
  5612                                 TO WS-COMMENT
  5613           MOVE 'D'              TO WS-LF-STATUS
  5614*          PERFORM 0030-BUILD-BUFFER
  5615*                                THRU 0030-EXIT
  5616*          IF NOT ALREADY-SENT
  5617*             PERFORM 0020-SEND-BUFFER
  5618*                                THRU 0020-EXIT
  5619*             SET ALREADY-SENT   TO TRUE
  5620*          END-IF
  5621           GO TO 0400-EXIT
  5622*          PERFORM 0025-CLOSE-SOCKET
  5623*                                THRU 0025-EXIT
  5624*          GO TO 0010-RETURN
  5625        END-IF
  5626     END-IF
  5627     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  5628        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  5629        MOVE 'LF COVERAGE EXPIRED '
  5630                                 TO WS-COMMENT
  5631        MOVE 'E'                 TO WS-LF-STATUS
  5632        GO TO 0400-EXIT
  5633     END-IF
  5634     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5635        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5636        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5637     ELSE
  5638        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  5639     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page  99
* SOCK03.cbl
  5640     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  5641     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  5642*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  5643     if ws-comp-id = 'AHL'
  5644        move cm-lf-class-cd      to cp-class-code
  5645        if cp-class-code = spaces
  5646           move zeros            to cp-class-code
  5647        end-if
  5648     else
  5649        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  5650     end-if
  5651     IF (ws-comp-id = 'DCC')
  5652        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  5653        MOVE ' '                 TO WS-PDEF-RECORD-SW
  5654        PERFORM 0730-GET-DDF-FACTORS
  5655                                 THRU 0730-EXIT
  5656        IF PDEF-FOUND
  5657           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  5658              (P1 > +8)
  5659              OR (PD-PROD-CODE (P1) = 'L')
  5660           END-PERFORM
  5661           IF P1 < +9
  5662              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  5663           END-IF
  5664        END-IF
  5665     END-IF
  5666     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
  5667*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
  5668     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  5669        CM-LF-ALT-BENEFIT-AMT
  5670*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  5671     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  5672                                    WS-LF-REM-BEN
  5673     move cm-lf-premium-amt      to ws-tot-lf-prem
  5674     if ws-lf-co-earnings-calc = 'B'
  5675        COMPUTE WS-TOT-LF-PREM = ws-tot-lf-prem
  5676           + CM-LF-ALT-PREMIUM-AMT
  5677     end-if
  5678     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  5679     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5680        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5681        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5682     ELSE
  5683        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  5684     END-IF
  5685     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  5686     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  5687     IF WS-LF-ST-REFUND-CALC > ZERO
  5688         MOVE WS-LF-ST-REFUND-CALC
  5689                                 TO  CP-EARNING-METHOD.
  5690     IF WS-LF-FO-REFUND-CALC > ZERO
  5691         MOVE WS-LF-FO-REFUND-CALC
  5692                                 TO  CP-EARNING-METHOD.
  5693     IF CP-RATING-METHOD = '4'
  5694        MOVE '4'                 TO CP-EARNING-METHOD
  5695     END-IF
  5696*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  5697     if ws-comp-id = 'AHL'
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 100
* SOCK03.cbl
  5698        move cm-lf-class-cd      to cp-class-code
  5699        if cp-class-code = spaces
  5700           move zeros            to cp-class-code
  5701        end-if
  5702     else
  5703        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  5704     end-if
  5705     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  5706     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  5707                                     CP-RATING-BENEFIT-AMT.
  5708     IF CP-STATE-STD-ABBRV = 'OR'
  5709         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5710                                         CM-LF-ALT-BENEFIT-AMT.
  5711****   N O T E   ****
  5712*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  5713*      THE OH HARD CODING IN ELCRFNDP
  5714     IF WS-COMP-ID = 'CID'
  5715        IF CP-STATE-STD-ABBRV = 'OH'
  5716           MOVE WS-LF-CO-EARNINGS-CALC
  5717                                 TO CP-EARNING-METHOD
  5718        END-IF
  5719     END-IF
  5720****   N O T E   ****
  5721     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  5722     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  5723     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  5724     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  5725     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  5726     IF CP-EARN-AS-NET-PAY
  5727        IF CP-LOAN-APR <= ZEROS
  5728           IF WS-CF-DEFAULT-APR > ZEROS
  5729              MOVE WS-CF-DEFAULT-APR
  5730                                 TO  CP-LOAN-APR
  5731           END-IF
  5732        END-IF
  5733     END-IF
  5734*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  5735*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  5736*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  5737*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  5738*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  5739*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  5740*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  5741*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
  5742*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  5743*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  5744*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  5745*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  5746*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
  5747*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  5748*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  5749*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  5750*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
  5751*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  5752     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  5753     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  5754     DISPLAY ' MADE IT BACK FROM ELRFND '
  5755     IF (CP-ERROR-RATE-IS-ZERO)
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 101
* SOCK03.cbl
  5756        OR (CP-ERROR-RATE-NOT-FOUND)
  5757        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5758        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
  5759          DELIMITED BY SIZE INTO WS-COMMENT
  5760        END-STRING
  5761        MOVE 'X'                 TO WS-LF-STATUS
  5762        GO TO 0400-EXIT
  5763*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5764*       IF NOT ALREADY-SENT
  5765*          PERFORM 0020-SEND-BUFFER
  5766*                                THRU 0020-EXIT
  5767*          SET ALREADY-SENT      TO TRUE
  5768*       END-IF
  5769*       PERFORM 0025-CLOSE-SOCKET
  5770*                                THRU 0025-EXIT
  5771*       GO TO 0010-RETURN
  5772     END-IF
  5773     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
  5774                                    WS-TOT-LF-RFND
  5775     IF (WS-LF-STATUS = SPACES)
  5776        OR (CP-CALC-REFUND > ZEROS)
  5777        MOVE 'A'                 TO WS-LF-STATUS
  5778     END-IF
  5779     EVALUATE TRUE
  5780        WHEN CP-R-AS-R78
  5781           MOVE 'RULE 78'          TO  WS-LF-METHOD
  5782        WHEN  CP-R-AS-PRORATA
  5783           MOVE 'PRO RATA'         TO  WS-LF-METHOD
  5784        WHEN CP-R-AS-CALIF
  5785           MOVE 'CALIF'            TO  WS-LF-METHOD
  5786        WHEN CP-R-AS-TEXAS
  5787           MOVE 'IRREG'            TO  WS-LF-METHOD
  5788        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  5789           MOVE 'UTAH'             TO  WS-LF-METHOD
  5790        WHEN CP-R-AS-FARM-PLAN
  5791           MOVE 'FARM PLAN'        TO  WS-LF-METHOD
  5792        WHEN CP-R-AS-NET-PAY
  5793           MOVE 'NET PAY'          TO  WS-LF-METHOD
  5794        WHEN CP-R-AS-ANTICIPATION
  5795           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  5796        WHEN CP-R-AS-MEAN
  5797           MOVE 'MEAN'             TO  WS-LF-METHOD
  5798        WHEN CP-R-AS-SUM-OF-DIGITS
  5799           MOVE 'SUM OF DIGIT'     TO  WS-LF-METHOD
  5800     END-EVALUATE
  5801     IF WS-TOT-LF-RFND > ZEROS
  5802        COMPUTE WS-WORK-FACTOR ROUNDED =
  5803           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  5804        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
  5805           WS-TOT-LF-COMM
  5806     END-IF
  5807     IF ERACCT-FOUND
  5808        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  5809           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  5810        END-IF
  5811        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5812           IF (AM-COMM-CHARGEBACK (1) = 99)
  5813                     OR
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 102
* SOCK03.cbl
  5814              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5815                     OR
  5816              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5817              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5818              MOVE ZEROS         TO WS-LF-UEC
  5819           END-IF
  5820        END-IF
  5821     END-IF
  5822     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  5823        GO TO 0400-EXIT
  5824     END-IF
  5825     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  5826     MOVE '2'                    TO  CP-EARNING-METHOD
  5827                                     CP-RATING-METHOD.
  5828     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  5829                                     CP-REMAINING-BENEFIT
  5830                                     CP-RATING-BENEFIT-AMT.
  5831     IF CP-STATE-STD-ABBRV = 'OR'
  5832         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5833                                         CM-LF-ALT-BENEFIT-AMT.
  5834     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  5835     IF ws-comp-id = 'CID'
  5836        IF (CP-STATE-STD-ABBRV = 'MN')
  5837           AND (CM-CERT-EFF-DT > X'A4FF')
  5838           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  5839           MOVE '5'              TO CP-EARNING-METHOD
  5840           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  5841        END-IF
  5842     END-IF
  5843     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  5844     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  5845     IF (CP-ERROR-RATE-IS-ZERO)
  5846        OR (CP-ERROR-RATE-NOT-FOUND)
  5847        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5848        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  5849          DELIMITED BY SIZE INTO WS-COMMENT
  5850        END-STRING
  5851        MOVE 'X'              TO WS-LF-STATUS
  5852        GO TO 0400-EXIT
  5853*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5854*       IF NOT ALREADY-SENT
  5855*          PERFORM 0020-SEND-BUFFER
  5856*                                THRU 0020-EXIT
  5857*          SET ALREADY-SENT      TO TRUE
  5858*       END-IF
  5859*       PERFORM 0025-CLOSE-SOCKET
  5860*                                THRU 0025-EXIT
  5861*       GO TO 0010-RETURN
  5862     END-IF
  5863     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  5864     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  5865     IF WS-TOT-LF-RFND > ZEROS
  5866        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
  5867           WS-TOT-LF-COMM
  5868     END-IF
  5869     IF ERACCT-FOUND
  5870        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5871           IF (AM-COMM-CHARGEBACK (1) = 99)
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 103
* SOCK03.cbl
  5872                     OR
  5873              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5874                     OR
  5875              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5876              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5877              MOVE ZEROS         TO WS-LF-UEC
  5878           END-IF
  5879        END-IF
  5880     END-IF
  5881     .
  5882 0400-EXIT.
  5883     EXIT.
  5884 0500-PROCESS-AH.
  5885     IF CM-AH-BENEFIT-CD = '  ' OR '00'
  5886        GO TO 0500-EXIT
  5887     END-IF
  5888     MOVE ZEROS                  TO WS-TOT-AH-RFND
  5889                                    WS-TOT-AH-PREM
  5890                                    WS-TOT-AH-COMM
  5891     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5892     MOVE ' '                    TO  DC-OPTION-CODE
  5893     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5894     IF NO-CONVERSION-ERROR
  5895        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
  5896     ELSE
  5897        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  5898     END-IF
  5899     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
  5900     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  5901     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  5902     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  5903     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  5904     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  5905     MOVE CM-STATE               TO  CP-STATE.
  5906     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  5907     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  5908     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  5909     MOVE '2'                    TO  CP-PROCESS-TYPE.
  5910     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
  5911     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  5912     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  5913     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  5914     MOVE WS-CF-CR-REM-TERM-CALC
  5915                                 TO  CP-REM-TERM-METHOD.
  5916     IF WS-AH-CO-REM-TERM-CALC > '0'
  5917         MOVE WS-AH-CO-REM-TERM-CALC
  5918                                 TO  CP-REM-TERM-METHOD.
  5919     IF WS-AH-ST-REM-TERM-CALC > '0'
  5920         MOVE WS-AH-ST-REM-TERM-CALC
  5921                                 TO  CP-REM-TERM-METHOD.
  5922     IF WS-AH-AM-REM-TERM-CALC > '0'
  5923         MOVE WS-AH-AM-REM-TERM-CALC
  5924                                 TO  CP-REM-TERM-METHOD.
  5925     IF (WS-COMP-ID = 'CID')
  5926        AND (CP-STATE-STD-ABBRV = 'WI')
  5927        MOVE '7'                 TO CP-REM-TERM-METHOD
  5928        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5929     END-IF
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 104
* SOCK03.cbl
  5930     IF (WS-COMP-ID = 'CID')
  5931        AND (CP-STATE-STD-ABBRV = 'MO')
  5932        AND (CM-CERT-EFF-DT >= X'9B41')
  5933        AND (CM-CERT-EFF-DT <= X'A2FB')
  5934        MOVE '7'                 TO CP-REM-TERM-METHOD
  5935        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5936     END-IF
  5937     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  5938                                     CP-LOAN-TERM.
  5939     IF  NOT  CP-TERM-IS-DAYS
  5940         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  5941             MOVE CM-PMT-EXTENSION-DAYS
  5942                                 TO  CP-TERM-OR-EXT-DAYS
  5943         ELSE
  5944             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  5945     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5946     IF CM-AH-COMM-PCT > ZEROS
  5947        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  5948           CM-AH-PREMIUM-AMT
  5949     END-IF
  5950     IF (ws-comp-id = 'DCC')
  5951        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  5952        compute ws-tot-ah-comm = cm-ah-premium-amt -
  5953           (cm-ah-clp + cm-addl-clp)
  5954     end-if
  5955     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  5956     IF WS-AH-STATUS = 'D'
  5957        GO TO 0500-EXIT
  5958     END-IF
  5959     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
  5960     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  5961     MOVE ' '                    TO WS-CLM-STOP-SW
  5962     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5963     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5964
  5965* EXEC CICS STARTBR
  5966*       DATASET     ('ELMSTR5')
  5967*       RIDFLD      (ELMSTR-KEY)
  5968*       RESP        (WS-RESPONSE)
  5969*    END-EXEC
  5970     MOVE 'ELMSTR5' TO DFHEIV1
  5971     MOVE 0
  5972       TO DFHEIV11
  5973*    MOVE '&,         G          &  N#00005562' TO DFHEIV0
  5974     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5975     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5976     MOVE X'204E233030303035353632' TO DFHEIV0(25:11)
  5977     CALL 'kxdfhei1' USING DFHEIV0,
  5978           DFHEIV1,
  5979           ELMSTR-KEY,
  5980           DFHEIV99,
  5981           DFHEIV11,
  5982           DFHEIV99
  5983     MOVE EIBRESP  TO WS-RESPONSE
  5984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5985     DISPLAY ' AFTER START ' WS-RESPONSE
  5986     IF RESP-NORMAL
  5987        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 105
* SOCK03.cbl
  5988           DISPLAY ' AH READNEXT '
  5989
  5990* EXEC CICS READNEXT
  5991*             DATASET   ('ELMSTR5')
  5992*             RIDFLD    (ELMSTR-KEY)
  5993*             INTO      (CLAIM-MASTER)
  5994*             RESP      (WS-RESPONSE)
  5995*          END-EXEC
  5996     MOVE LENGTH OF
  5997      CLAIM-MASTER
  5998       TO DFHEIV12
  5999     MOVE 'ELMSTR5' TO DFHEIV1
  6000     MOVE 0
  6001       TO DFHEIV11
  6002*    MOVE '&.IL                  )  N#00005571' TO DFHEIV0
  6003     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6004     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6005     MOVE X'204E233030303035353731' TO DFHEIV0(25:11)
  6006     CALL 'kxdfhei1' USING DFHEIV0,
  6007           DFHEIV1,
  6008           CLAIM-MASTER,
  6009           DFHEIV12,
  6010           ELMSTR-KEY,
  6011           DFHEIV99,
  6012           DFHEIV11,
  6013           DFHEIV99,
  6014           DFHEIV99
  6015     MOVE EIBRESP  TO WS-RESPONSE
  6016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6017        IF (RESP-NORMAL OR RESP-DUPKEY)
  6018           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6019           AND (CM-CERT-NO = CL-CERT-NO)
  6020           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6021              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6022              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G' OR 'F')
  6023                 IF CLAIM-IS-OPEN
  6024                    DISPLAY ' FOUND OPEN AH CLAIM '
  6025                    MOVE ' OPEN HEALTH CLAIM '
  6026                                 TO WS-COMMENT
  6027                    MOVE 'H'     TO WS-AH-STATUS
  6028                 ELSE
  6029                    DISPLAY ' FOUND CLOSED AH CLAIM '
  6030                    MOVE ' CLOSED HEALTH CLAIM '
  6031                                 TO WS-COMMENT
  6032                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  6033                       MOVE CL-PAID-THRU-DT
  6034                                 TO WS-AH-BIN-PAID-THRU-DT
  6035                    END-IF
  6036                 END-IF
  6037              END-IF
  6038           END-IF
  6039        ELSE
  6040           SET I-SAY-TO-STOP TO TRUE
  6041        END-IF
  6042        END-PERFORM
  6043
  6044* EXEC CICS ENDBR
  6045*          DATASET   ('ELMSTR5')
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 106
* SOCK03.cbl
  6046*       END-EXEC
  6047     MOVE 'ELMSTR5' TO DFHEIV1
  6048     MOVE 0
  6049       TO DFHEIV11
  6050*    MOVE '&2                    $   #00005603' TO DFHEIV0
  6051     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6052     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6053     MOVE X'2020233030303035363033' TO DFHEIV0(25:11)
  6054     CALL 'kxdfhei1' USING DFHEIV0,
  6055           DFHEIV1,
  6056           DFHEIV11,
  6057           DFHEIV99
  6058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6059     END-IF
  6060     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6061*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
  6062        MOVE WS-AH-BIN-PAID-THRU-DT
  6063                                 TO DC-BIN-DATE-1
  6064        MOVE ' '                 TO DC-OPTION-CODE
  6065        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6066        IF NO-CONVERSION-ERROR
  6067           MOVE DC-GREG-DATE-CYMD
  6068                                 TO WS-CLM-PAID-THRU-DT
  6069        ELSE
  6070           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6071        END-IF
  6072        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  6073           MOVE 'CAN DT NOT > CLM CLOSE DT '
  6074                                 TO WS-COMMENT
  6075           MOVE 'P'              TO WS-AH-STATUS
  6076           GO TO 0500-EXIT
  6077        END-IF
  6078     END-IF
  6079     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6080     IF CM-AH-CURRENT-STATUS = '8'
  6081        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6082           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  6083                                 TO WS-COMMENT
  6084           MOVE 'C'              TO WS-AH-STATUS
  6085           GO TO 0500-EXIT
  6086        END-IF
  6087     END-IF
  6088     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  6089        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  6090           MOVE ' SETTLEMENT CLAIM APPLIED '
  6091                                 TO WS-COMMENT
  6092           MOVE 'S'              TO WS-AH-STATUS
  6093*          PERFORM 0030-BUILD-BUFFER
  6094*                                THRU 0030-EXIT
  6095*          IF NOT ALREADY-SENT
  6096*             PERFORM 0020-SEND-BUFFER
  6097*                                THRU 0020-EXIT
  6098*             SET ALREADY-SENT   TO TRUE
  6099*          END-IF
  6100           GO TO 0500-EXIT
  6101*          PERFORM 0025-CLOSE-SOCKET
  6102*                                THRU 0025-EXIT
  6103*          GO TO 0010-RETURN
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 107
* SOCK03.cbl
  6104        END-IF
  6105     END-IF
  6106     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6107        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
  6108        MOVE 'AH COVERAGE EXPIRED '
  6109                                 TO WS-COMMENT
  6110        MOVE 'E'                 TO WS-AH-STATUS
  6111        GO TO 0500-EXIT
  6112     END-IF
  6113     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
  6114                                    WS-AH-PREM
  6115     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  6116     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  6117        * CP-REMAINING-TERM-1
  6118     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  6119                                     WS-AH-REM-TERM
  6120     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6121     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6122     IF WS-AH-ST-REFUND-CALC > ZERO
  6123         MOVE WS-AH-ST-REFUND-CALC
  6124                                 TO  CP-EARNING-METHOD.
  6125     IF WS-AH-FO-REFUND-CALC > ZERO
  6126         MOVE WS-AH-FO-REFUND-CALC
  6127                                 TO  CP-EARNING-METHOD.
  6128*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6129     if ws-comp-id = 'AHL'
  6130        move cm-ah-class-cd      to cp-class-code
  6131        if cp-class-code = spaces
  6132           move zeros            to cp-class-code
  6133        end-if
  6134     else
  6135        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6136     end-if
  6137     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6138     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6139                                     CP-RATING-BENEFIT-AMT.
  6140     IF CP-STATE-STD-ABBRV = 'OR'
  6141         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  6142                                         CM-AH-ORIG-TERM.
  6143     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6144     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6145     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6146     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  6147     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6148     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6149     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6150     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6151     MOVE ' '                    TO  DC-OPTION-CODE.
  6152     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6153     IF CP-STATE-STD-ABBRV = 'OH'
  6154        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6155         IF (CP-ORIGINAL-TERM > 60)
  6156           AND (DC-GREG-DATE-1-YMD > '831101')
  6157           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  6158             MOVE '6'            TO  CP-EARNING-METHOD
  6159         END-IF
  6160        END-IF
  6161        IF WS-COMP-ID = 'CID'
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 108
* SOCK03.cbl
  6162           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  6163                           LOW-VALUES)
  6164              IF CP-CRITICAL-PERIOD
  6165                 MOVE '2'       TO CP-EARNING-METHOD
  6166              ELSE
  6167                 MOVE '6'       TO CP-EARNING-METHOD
  6168              END-IF
  6169           ELSE
  6170              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  6171                 MOVE '2'       TO CP-EARNING-METHOD
  6172              ELSE
  6173                 IF ((CM-LF-ORIG-TERM > 60) AND
  6174                    (CM-RATE-CLASS NOT = 'L '))
  6175                               OR
  6176                    (WS-LF-CO-EARNINGS-CALC = '5')
  6177                    IF CP-CRITICAL-PERIOD
  6178                       MOVE '2'  TO CP-EARNING-METHOD
  6179                    ELSE
  6180                       MOVE '6'  TO CP-EARNING-METHOD
  6181                    END-IF
  6182                 ELSE
  6183                    MOVE '1'     TO CP-EARNING-METHOD
  6184                 END-IF
  6185              END-IF
  6186           END-IF
  6187        END-IF
  6188     END-IF
  6189     IF CP-STATE-STD-ABBRV = 'VA'
  6190       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6191         IF DC-GREG-DATE-1-YMD > '921231'
  6192            IF CP-ORIGINAL-TERM > 61
  6193                MOVE '6'            TO  CP-EARNING-METHOD
  6194            ELSE
  6195                MOVE '1'            TO  CP-EARNING-METHOD.
  6196     IF CP-EARN-AS-NET-PAY
  6197        IF CP-LOAN-APR <= ZEROS
  6198           IF WS-CF-DEFAULT-APR > ZEROS
  6199              MOVE WS-CF-DEFAULT-APR
  6200                                 TO  CP-LOAN-APR
  6201           END-IF
  6202        END-IF
  6203     END-IF
  6204     IF WS-COMP-ID = 'DCC'
  6205        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6206           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  6207           MOVE 'S'              TO CP-EARNING-METHOD
  6208        END-IF
  6209     END-IF
  6210     MOVE WS-CANCEL-REASON       TO CP-CANCEL-REASON
  6211     IF (WS-COMP-ID = 'DCC')
  6212        AND (CP-EARNING-METHOD = 'D')
  6213        MOVE +0                  TO WS-DDF-ADMIN-FEES
  6214                                    WS-DDF-CSO-ADMIN-FEE
  6215                                    WS-DDF-1ST-YR-TOT-EXP
  6216                                    WS-DDF-COMM-AND-MFEE
  6217        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  6218           S1 > +10
  6219           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 109
* SOCK03.cbl
  6220              IF (AM-A-COM (S1) NUMERIC)
  6221                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  6222                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  6223              ELSE
  6224                 MOVE +0         TO WS-COMM-PCT C0
  6225                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  6226                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  6227              END-IF
  6228              IF AM-COM-TYP (S1) = 'L' OR 'N'
  6229                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  6230                    + WS-COMM-PCT
  6231              END-IF
  6232              IF AM-COM-TYP (S1) = 'N'
  6233                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  6234                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  6235              END-IF
  6236              IF AM-COM-TYP (S1) = 'J' OR 'L'
  6237                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  6238                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  6239              END-IF
  6240              IF AM-COM-TYP (S1) = 'I'
  6241                 COMPUTE WS-DDF-COMM-AND-MFEE
  6242                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  6243              END-IF
  6244           END-IF
  6245        END-PERFORM
  6246        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  6247        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  6248        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  6249           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  6250     END-IF
  6251     IF (WS-COMP-ID = 'DCC')
  6252        AND (CP-EARNING-METHOD = 'D')
  6253        AND (ws-CANCEL-REASON NOT = 'R')
  6254        PERFORM 0730-GET-DDF-FACTORS
  6255                                 THRU 0730-EXIT
  6256        IF NOT PDEF-FOUND
  6257           MOVE ' DDF UE FACTORS  NOT FOUND '
  6258                                 TO WS-COMMENT
  6259           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  6260           PERFORM 0030-BUILD-BUFFER
  6261                                 THRU 0030-EXIT
  6262           PERFORM 0020-SEND-BUFFER
  6263                                 THRU 0020-EXIT
  6264           PERFORM 0025-CLOSE-SOCKET
  6265                                 THRU 0025-EXIT
  6266           GO TO 0010-RETURN
  6267        END-IF
  6268*       IF NOT PDEF-FOUND
  6269*          MOVE ER-9999          TO EMI-ERROR
  6270*          PERFORM 9700-ERROR-FORMAT
  6271*                                THRU 9799-EXIT
  6272*          GO TO 8200-SEND-DATAONLY
  6273*       END-IF
  6274        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  6275                                 TO CP-DDF-LO-FACT
  6276        MOVE PD-UEP-FACTOR (P1 P2)
  6277                                 TO CP-DDF-HI-FACT
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 110
* SOCK03.cbl
  6278        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  6279        MOVE CM-AH-CLP           TO CP-DDF-CLP
  6280        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  6281        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  6282           + PD-1ST-YR-ADMIN-ALLOW
  6283        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  6284*       IF PI-CLP-YN = 'Y'
  6285*          MOVE 'C'              TO CP-DDF-SPEC-CALC
  6286*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  6287*                                   CP-DDF-CLP
  6288*          MOVE ZEROS            TO CP-1ST-YR-ALLOW
  6289*       END-IF
  6290        IF DD-IU-PRESENT
  6291           MOVE 'I'              TO CP-EARNING-METHOD
  6292        END-IF
  6293        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6294                                    CP-CLP-RATE-UP
  6295        IF (CP-CALC-GROSS-FEE)
  6296           AND (CP-IU-RATE-UP NOT = ZEROS)
  6297           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  6298              / CP-ORIGINAL-PREMIUM)
  6299           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  6300              / (1 - TEX-FACT-8)
  6301        END-IF
  6302     END-IF
  6303     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6304     IF (CP-ERROR-RATE-IS-ZERO)
  6305        OR (CP-ERROR-RATE-NOT-FOUND)
  6306        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6307        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  6308          DELIMITED BY SIZE INTO WS-COMMENT
  6309        END-STRING
  6310        IF WS-AH-STATUS NOT = 'H'
  6311           MOVE 'X'                 TO WS-AH-STATUS
  6312        END-IF
  6313        GO TO 0500-EXIT
  6314*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6315*       IF NOT ALREADY-SENT
  6316*          PERFORM 0020-SEND-BUFFER
  6317*                                THRU 0020-EXIT
  6318*          SET ALREADY-SENT      TO TRUE
  6319*       END-IF
  6320*       PERFORM 0025-CLOSE-SOCKET
  6321*                                THRU 0025-EXIT
  6322*       GO TO 0010-RETURN
  6323     END-IF
  6324     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  6325                                    WS-TOT-AH-RFND
  6326     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  6327     IF ((WS-AH-STATUS = SPACES)
  6328        OR (CP-CALC-REFUND > ZEROS))
  6329                  AND
  6330          (WS-AH-STATUS NOT = 'H')
  6331        MOVE 'A'                 TO WS-AH-STATUS
  6332     END-IF
  6333     IF WS-COMP-ID = 'DCC'
  6334        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6335        AND (CP-EARNING-METHOD = 'D' OR 'I')
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 111
* SOCK03.cbl
  6336        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6337        MOVE 'C'                 TO CP-DDF-SPEC-CALC
  6338        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
  6339        MOVE ZEROS               TO CP-1ST-YR-ALLOW
  6340        PERFORM 0720-LINK-REFUND THRU  0720-EXIT
  6341        MOVE CP-CALC-REFUND      TO ws-ah-rfnd-clp
  6342        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
  6343     END-IF
  6344     EVALUATE TRUE
  6345        WHEN CP-R-AS-R78
  6346           MOVE 'RULE 78'          TO  WS-AH-METHOD
  6347        WHEN CP-R-AS-PRORATA
  6348           MOVE 'PRO RATA'         TO  WS-AH-METHOD
  6349        WHEN CP-REFUND-TYPE-USED = '3'
  6350           MOVE 'CALIF'            TO  WS-AH-METHOD
  6351        WHEN CP-R-AS-TEXAS
  6352           MOVE 'IRREG'            TO  WS-AH-METHOD
  6353        WHEN CP-R-AS-FARM-PLAN
  6354           MOVE 'FARM PLAN'        TO  WS-AH-METHOD
  6355        WHEN CP-R-AS-NET-PAY
  6356           MOVE 'NET PAY'          TO  WS-AH-METHOD
  6357        WHEN CP-R-AS-ANTICIPATION
  6358           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  6359        WHEN CP-R-AS-MEAN
  6360           MOVE 'MEAN'             TO  WS-AH-METHOD
  6361        WHEN CP-R-AS-SUM-OF-DIGITS
  6362           MOVE 'SUM OF DIGIT'     TO  WS-AH-METHOD
  6363        WHEN CP-GAP-ACTUARIAL
  6364           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  6365     END-EVALUATE
  6366     IF WS-TOT-AH-RFND > ZEROS
  6367        IF (ws-comp-id = 'DCC')
  6368           AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6369           compute ws-work-factor rounded =
  6370              ws-ah-rfnd-clp / cm-ah-clp
  6371        else
  6372           COMPUTE WS-WORK-FACTOR ROUNDED =
  6373              WS-TOT-AH-RFND / WS-TOT-AH-PREM
  6374        end-if
  6375        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
  6376           WS-TOT-AH-COMM
  6377     END-IF
  6378     IF ERACCT-FOUND
  6379        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6380           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6381        END-IF
  6382        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6383           IF (AM-COMM-CHARGEBACK (1) = 99)
  6384                     OR
  6385              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6386                     OR
  6387              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6388              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6389              MOVE ZEROS         TO WS-AH-UEC
  6390           END-IF
  6391        END-IF
  6392     END-IF
  6393     .
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 112
* SOCK03.cbl
  6394 0500-EXIT.
  6395     EXIT.
  6396 0700-LINK-REM-TERM.
  6397
  6398* EXEC CICS LINK
  6399*        PROGRAM   ('ELRTRM')
  6400*        COMMAREA  (CALCULATION-PASS-AREA)
  6401*        LENGTH    (CP-COMM-LENGTH)
  6402*    END-EXEC.
  6403     MOVE 'ELRTRM' TO DFHEIV1
  6404*    MOVE '."C                   (   #00005944' TO DFHEIV0
  6405     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6406     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6407     MOVE X'2020233030303035393434' TO DFHEIV0(25:11)
  6408     CALL 'kxdfhei1' USING DFHEIV0,
  6409           DFHEIV1,
  6410           CALCULATION-PASS-AREA,
  6411           CP-COMM-LENGTH,
  6412           DFHEIV99,
  6413           DFHEIV99,
  6414           DFHEIV99,
  6415           DFHEIV99
  6416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6417
  6418 0700-EXIT.
  6419     EXIT.
  6420 0710-LINK-REM-AMOUNT.
  6421
  6422* EXEC CICS LINK
  6423*        PROGRAM   ('ELRAMT')
  6424*        COMMAREA  (CALCULATION-PASS-AREA)
  6425*        LENGTH    (CP-COMM-LENGTH)
  6426*    END-EXEC
  6427     MOVE 'ELRAMT' TO DFHEIV1
  6428*    MOVE '."C                   (   #00005952' TO DFHEIV0
  6429     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6431     MOVE X'2020233030303035393532' TO DFHEIV0(25:11)
  6432     CALL 'kxdfhei1' USING DFHEIV0,
  6433           DFHEIV1,
  6434           CALCULATION-PASS-AREA,
  6435           CP-COMM-LENGTH,
  6436           DFHEIV99,
  6437           DFHEIV99,
  6438           DFHEIV99,
  6439           DFHEIV99
  6440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6441     .
  6442 0710-EXIT.
  6443     EXIT.
  6444 0720-LINK-REFUND.
  6445
  6446* EXEC CICS LINK
  6447*        PROGRAM   ('ELRFND')
  6448*        COMMAREA  (CALCULATION-PASS-AREA)
  6449*        LENGTH    (CP-COMM-LENGTH)
  6450*    END-EXEC
  6451     MOVE 'ELRFND' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 113
* SOCK03.cbl
  6452*    MOVE '."C                   (   #00005961' TO DFHEIV0
  6453     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6454     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6455     MOVE X'2020233030303035393631' TO DFHEIV0(25:11)
  6456     CALL 'kxdfhei1' USING DFHEIV0,
  6457           DFHEIV1,
  6458           CALCULATION-PASS-AREA,
  6459           CP-COMM-LENGTH,
  6460           DFHEIV99,
  6461           DFHEIV99,
  6462           DFHEIV99,
  6463           DFHEIV99
  6464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6465     .
  6466 0720-EXIT.
  6467     EXIT.
  6468 0730-GET-DDF-FACTORS.
  6469     MOVE ' '                    TO WS-PDEF-RECORD-SW
  6470     MOVE WS-COMP-CD             TO ERPDEF-KEY
  6471     MOVE CM-STATE               TO ERPDEF-STATE
  6472     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  6473     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  6474     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  6475     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  6476     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  6477
  6478* EXEC CICS STARTBR
  6479*        DATASET  ('ERPDEF')
  6480*        RIDFLD   (ERPDEF-KEY)
  6481*        GTEQ
  6482*        RESP     (WS-RESPONSE)
  6483*    END-EXEC
  6484     MOVE 'ERPDEF' TO DFHEIV1
  6485     MOVE 0
  6486       TO DFHEIV11
  6487*    MOVE '&,         G          &  N#00005978' TO DFHEIV0
  6488     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6489     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6490     MOVE X'204E233030303035393738' TO DFHEIV0(25:11)
  6491     CALL 'kxdfhei1' USING DFHEIV0,
  6492           DFHEIV1,
  6493           ERPDEF-KEY,
  6494           DFHEIV99,
  6495           DFHEIV11,
  6496           DFHEIV99
  6497     MOVE EIBRESP  TO WS-RESPONSE
  6498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6499     IF NOT RESP-NORMAL
  6500        GO TO 0730-EXIT
  6501     END-IF
  6502     .
  6503 0730-READNEXT.
  6504
  6505* EXEC CICS READNEXT
  6506*       DATASET  ('ERPDEF')
  6507*       INTO     (PRODUCT-MASTER)
  6508*       RIDFLD   (ERPDEF-KEY)
  6509*       RESP     (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 114
* SOCK03.cbl
  6510*    END-EXEC
  6511     MOVE LENGTH OF
  6512      PRODUCT-MASTER
  6513       TO DFHEIV12
  6514     MOVE 'ERPDEF' TO DFHEIV1
  6515     MOVE 0
  6516       TO DFHEIV11
  6517*    MOVE '&.IL                  )  N#00005989' TO DFHEIV0
  6518     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6519     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6520     MOVE X'204E233030303035393839' TO DFHEIV0(25:11)
  6521     CALL 'kxdfhei1' USING DFHEIV0,
  6522           DFHEIV1,
  6523           PRODUCT-MASTER,
  6524           DFHEIV12,
  6525           ERPDEF-KEY,
  6526           DFHEIV99,
  6527           DFHEIV11,
  6528           DFHEIV99,
  6529           DFHEIV99
  6530     MOVE EIBRESP  TO WS-RESPONSE
  6531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6532     IF NOT RESP-NORMAL
  6533        GO TO 0730-ENDBR
  6534     END-IF
  6535     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  6536        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  6537           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  6538        ELSE
  6539           GO TO 0730-READNEXT
  6540        END-IF
  6541     ELSE
  6542        GO TO 0730-ENDBR
  6543     END-IF
  6544     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  6545        (P1 > +8)
  6546        OR (PD-PROD-CODE (P1) = 'I')
  6547     END-PERFORM
  6548     IF P1 < +9
  6549        SET DD-IU-PRESENT        TO TRUE
  6550     END-IF
  6551     IF CM-LOAN-TERM = ZEROS
  6552        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  6553     END-IF
  6554     IF PD-TRUNCATED = 'Y'
  6555        MOVE CM-LOAN-TERM        TO WS-TERM
  6556     ELSE
  6557        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  6558     END-IF
  6559     EVALUATE TRUE
  6560        WHEN WS-TERM > +168
  6561           MOVE 15               TO P1
  6562        WHEN WS-TERM > +156
  6563           MOVE 14               TO P1
  6564        WHEN WS-TERM > +144
  6565           MOVE 13               TO P1
  6566        WHEN WS-TERM > +132
  6567           MOVE 12               TO P1
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 115
* SOCK03.cbl
  6568        WHEN WS-TERM > +120
  6569           MOVE 11               TO P1
  6570        WHEN WS-TERM > +108
  6571           MOVE 10               TO P1
  6572        WHEN WS-TERM > +96
  6573           MOVE 9                TO P1
  6574        WHEN WS-TERM > +84
  6575           MOVE 8                TO P1
  6576        WHEN WS-TERM > +72
  6577           MOVE 7                TO P1
  6578        WHEN WS-TERM > +60
  6579           MOVE 6                TO P1
  6580        WHEN WS-TERM > +48
  6581           MOVE 5                TO P1
  6582        WHEN WS-TERM > +36
  6583           MOVE 4                TO P1
  6584        WHEN WS-TERM > +24
  6585           MOVE 3                TO P1
  6586        WHEN WS-TERM > +12
  6587           MOVE 2                TO P1
  6588        WHEN OTHER
  6589           MOVE 1                TO P1
  6590     END-EVALUATE
  6591     EVALUATE TRUE
  6592*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  6593*          AND (DD-IU-PRESENT)
  6594*          MOVE 2                TO P2
  6595*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  6596*          MOVE 1                TO P2
  6597        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  6598           MOVE 2                TO P2
  6599        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  6600           MOVE 3                TO P2
  6601        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  6602           MOVE 4                TO P2
  6603        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  6604           MOVE 5                TO P2
  6605        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  6606           MOVE 6                TO P2
  6607        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  6608           MOVE 7                TO P2
  6609        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  6610           MOVE 8                TO P2
  6611        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  6612           MOVE 9                TO P2
  6613        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  6614           MOVE 10               TO P2
  6615        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  6616           MOVE 11               TO P2
  6617        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  6618           MOVE 12               TO P2
  6619        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  6620           MOVE 13               TO P2
  6621        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  6622           MOVE 14               TO P2
  6623        WHEN OTHER
  6624           MOVE 15               TO P2
  6625     END-EVALUATE
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 116
* SOCK03.cbl
  6626     .
  6627 0730-ENDBR.
  6628
  6629* EXEC CICS ENDBR
  6630*       DATASET  ('ERPDEF')
  6631*    END-EXEC
  6632     MOVE 'ERPDEF' TO DFHEIV1
  6633     MOVE 0
  6634       TO DFHEIV11
  6635*    MOVE '&2                    $   #00006091' TO DFHEIV0
  6636     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6637     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6638     MOVE X'2020233030303036303931' TO DFHEIV0(25:11)
  6639     CALL 'kxdfhei1' USING DFHEIV0,
  6640           DFHEIV1,
  6641           DFHEIV11,
  6642           DFHEIV99
  6643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6644     .
  6645 0730-EXIT.
  6646     EXIT.
  6647 0740-GET-ERCTBL.
  6648     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  6649     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  6650     MOVE 'A'                    TO CTBL-BEN-TYPE
  6651     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  6652     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  6653     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  6654     IF RESP-NORMAL
  6655        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  6656     ELSE
  6657        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  6658        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  6659        MOVE 'A'                    TO CTBL-BEN-TYPE
  6660        MOVE 'AA'                   TO CTBL-BEN-CODE
  6661        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  6662        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  6663        IF RESP-NORMAL
  6664           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  6665        END-IF
  6666     END-IF
  6667     .
  6668 0740-EXIT.
  6669     EXIT.
  6670 0750-READ-ERCTBL.
  6671
  6672* EXEC CICS READ
  6673*         INTO    (COMM-TABLE-RECORD)
  6674*         DATASET ('ERCTBL')
  6675*         RIDFLD  (CTBL-KEY)
  6676*         RESP    (WS-RESPONSE)
  6677*    END-EXEC
  6678     MOVE LENGTH OF
  6679      COMM-TABLE-RECORD
  6680       TO DFHEIV11
  6681     MOVE 'ERCTBL' TO DFHEIV1
  6682*    MOVE '&"IL       E          (  N#00006121' TO DFHEIV0
  6683     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 117
* SOCK03.cbl
  6684     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6685     MOVE X'204E233030303036313231' TO DFHEIV0(25:11)
  6686     CALL 'kxdfhei1' USING DFHEIV0,
  6687           DFHEIV1,
  6688           COMM-TABLE-RECORD,
  6689           DFHEIV11,
  6690           CTBL-KEY,
  6691           DFHEIV99,
  6692           DFHEIV99,
  6693           DFHEIV99
  6694     MOVE EIBRESP  TO WS-RESPONSE
  6695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6696     .
  6697 0750-EXIT.
  6698     EXIT.
  6699 0760-FIND-COMM.
  6700     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  6701        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  6702        OR (C1 > +3)
  6703     END-PERFORM
  6704     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  6705        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  6706        OR (C2 > +3)
  6707     END-PERFORM
  6708     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  6709        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  6710        OR (C3 > +3)
  6711     END-PERFORM
  6712     IF C1 > +3
  6713        MOVE +1                  TO C1
  6714     END-IF
  6715     IF C2 > +3
  6716        MOVE +1                  TO C2
  6717     END-IF
  6718     IF C3 > +3
  6719        MOVE +1                  TO C3
  6720     END-IF
  6721     IF C1 = +3
  6722        MOVE +18                 TO C0
  6723     ELSE
  6724        IF C1 = +2
  6725           MOVE +9               TO C0
  6726        END-IF
  6727     END-IF
  6728     IF C2 = +3
  6729        ADD +6                   TO C0
  6730     ELSE
  6731        IF C2 = +2
  6732           ADD +3                TO C0
  6733        END-IF
  6734     END-IF
  6735     ADD C3                      TO C0
  6736     MOVE CT-RT (C0)             TO WS-COMM-PCT
  6737     .
  6738 0760-EXIT.
  6739     EXIT.
  6740 9700-DATE-LINK.
  6741
* Micro Focus Server Express         V5.1 revision 000 28-Jul-15 12:59 Page 118
* SOCK03.cbl
  6742* EXEC CICS LINK
  6743*         PROGRAM  ('ELDATCV')
  6744*         COMMAREA (DATE-CONVERSION-DATA)
  6745*         LENGTH   (DC-COMM-LENGTH)
  6746*    END-EXEC.
  6747     MOVE 'ELDATCV' TO DFHEIV1
  6748*    MOVE '."C                   (   #00006172' TO DFHEIV0
  6749     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6750     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6751     MOVE X'2020233030303036313732' TO DFHEIV0(25:11)
  6752     CALL 'kxdfhei1' USING DFHEIV0,
  6753           DFHEIV1,
  6754           DATE-CONVERSION-DATA,
  6755           DC-COMM-LENGTH,
  6756           DFHEIV99,
  6757           DFHEIV99,
  6758           DFHEIV99,
  6759           DFHEIV99
  6760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6761
  6762 9700-EXIT.
  6763      EXIT.
  6764
  6765 9999-DFHBACK SECTION.
  6766     MOVE '9%                    "   ' TO DFHEIV0
  6767     MOVE 'SOCK03' TO DFHEIV1
  6768     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6769     GOBACK.
  6770 9999-DFHEXIT.
  6771     IF DFHEIGDJ EQUAL 0001
  6772         NEXT SENTENCE.
  6773     MOVE '9%                    "   ' TO DFHEIV0
  6774     MOVE 'SOCK03' TO DFHEIV1
  6775     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6776     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       18424     Code:       28448
