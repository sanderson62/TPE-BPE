* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   1
* EL689.cbl
* Options: int("EL689.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL689.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL689.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL689.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL689 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 15:10:07.
     7*                            VMOD=2.037
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11*DATE-COMPILED.
    12*REMARKS.    TRANSACTION - EXH3 - CREDIT LETTER WRITER.
    13*
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   2
* EL689.cbl
    14******************************************************************
    15
    16* W-FILE-USED REFERENCE LIST:
    17* (1)  ELCNTL - COMPANY
    18* (2)  ELCNTL - LIFE BENEFIT
    19* (3)  ELCNTL - A&H BENEFIT
    20* (4)  ELCNTL - CARRIER
    21* (5)  MAIL
    22* (6)  ERACCT
    23* (7)  USED FOR SYSTEM VARIABLES ?
    24* (8)  ELCERT
    25* (9)  PENDING BUSINESS
    26* (10) COMPENSATION
    27* (11) ELCNTL - PROCESSOR DATA ?
    28* (12) ERCHEK
    29* (13) ERPYAJ
    30* (14) NOT USED
    31* (15) NOT USED
    32* (16) NOT USED
    33* (17) NOT USED
    34* (18) NOT USED
    35* (19) NOT USED
    36* (20) NOT USED
    37*
    38******************************************************************
    39*                   C H A N G E   L O G
    40*
    41* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    42*-----------------------------------------------------------------
    43*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    44* EFFECTIVE    NUMBER
    45*-----------------------------------------------------------------
    46* 101501    2001100100006  SMVA  ADD USERID to screen header
    47*                                ADJUSTED REDEFINES EL689AI FILLER
    48* 031504    2004020600009  SMVA  PULL MOST CURRENT ACCT ADDRESS
    49* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    50* 100705    2004072800003  PEMA  ADD NEW VARIABLES
    51* 072308    2008062700001  PEMA  ADD NEW VARIABLES
    52* 092908    2008013100006  PEMA  MOVE VAR 154
    53* 102408  CR2008091000001  PEMA  MOVE PNDB VARS TO CERT VARS
    54* 051209  CR2009021700003  PEMA  ADD CRED BENE VARIABLES
    55* 051209  CR2009042700002  PEMA  ADD ERACCT ACCT NUMBER VARIABLE
    56* 022510  IR2009062300003  PEMA  ADD ENDFILE TEST TO ERACCT READ
    57* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    58* 041811  CR2011010400001  PEMA  DISABLE PF8 FOR CERTAIN USERS
    59* 042011  CR2011010400001  PEMA  FIX CRED BENE ADDRESS LINES
    60* 061411  CR2011061300001  PEMA  ADD ALWA TO PF8 DISABLE LIST
    61* 092911  IR2011092900001  AJRA  CLEAR LABEL LINES BEFORE CRED BEN
    62* 022712  IR2012022700001  AJRA  DON'T COUNT &&&&&& IN LINES
    63* 122011  CR2011022800001  AJRA  NAPERSOFT
    64* 090612  IR2012090600001  AJRA  NAPERSOFT
    65* 091712  IR2012091400001  AJRA  NAPERSOFT CERT ID
    66* 091912  IR2012091900001  AJRA  ALLOW FOLLOW UP DATE TO = CURR DT
    67* 101812  CR2012101700002  AJRA  ADD ENDARCH AND SCREENID
    68* 110512  CR2012101700002  AJRA  EXIT LETTER WRITER AFTER PF7
    69* 120512  CR2012101700002  AJRA  ADD RE ENCL CODE
    70******************************************************************
    71
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   3
* EL689.cbl
    72 DATA DIVISION.
    73 WORKING-STORAGE SECTION.
    74 01  DFH-START PIC X(04).
    75 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    76 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    77                                   USAGE POINTER.
    78 77  FILLER  PIC X(32) VALUE '********************************'.
    79 77  FILLER  PIC X(32) VALUE '*    EL689 WORKING STORAGE     *'.
    80 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
    81 01  P pointer.
    82 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    83 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    84 01  var-ptr pointer.
    85 01  env-var-len                 pic 9(4)  binary.
    86 01  rc                          pic 9(9)  binary.
    87 01  WS-KIXHOST                  PIC X(10).
    88 01  WS-KIXSYS.
    89     05  WS-KIX-FIL1             PIC X(10).
    90     05  WS-KIX-APPS             PIC X(10).
    91     05  WS-KIX-ENV              PIC X(10).
    92     05  WS-KIX-MYENV            PIC X(10).
    93     05  WS-KIX-SYS              PIC X(10).
    94 01 srch-commarea.
    95*                                copy ELCADLTRSPI.
    96******************************************************************
    97*                   C H A N G E   L O G
    98*
    99* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   100*-----------------------------------------------------------------
   101*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   102* EFFECTIVE    NUMBER
   103*-----------------------------------------------------------------
   104* 060611    2011022800001  PEMA  NEW COPYBOOK
   105* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   106* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   107******************************************************************
   108****************************************
   109*  commarea for NaperSoft On Demand Admin services letters
   110*  (business logic input & output)
   111****************************************
   112     03  BL-INPUT.
   113         05  BL-DATA-SRCE        PIC X.
   114         05  BL-LETTER-ID        PIC XXXX.
   115         05  BL-CARRIER          PIC X.
   116         05  BL-GROUP            PIC X(6).
   117         05  BL-STATE            PIC XX.
   118         05  BL-ACCOUNT          PIC X(10).
   119         05  BL-EFF-DT           PIC X(10).
   120         05  BL-CERT-NO          PIC X(11).
   121         05  BL-BATCH-NO         PIC X(6).
   122         05  BL-BATCH-SEQ        PIC 9(8).
   123         05  BL-RESP-NO          PIC X(10).
   124         05  BL-NO-OF-COPIES     PIC 99.
   125         05  BL-PROC-ID          PIC XXXX.
   126         05  BL-COMP-ID          PIC XXX.
   127         05  BL-PRINT-NOW-SW     PIC X.
   128         05  BL-ENC-CD           PIC XXX.
   129         05  BL-RESEND-DT        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   4
* EL689.cbl
   130         05  BL-FOLLOW-UP-DT     PIC X(10).
   131         05  BL-ARCHIVE-NO       PIC 9(8).
   132         05  BL-FUNC             PIC X(8).
   133         05  BL-COMMENTS         PIC X(100).
   134         05  FILLER REDEFINES BL-COMMENTS.
   135             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   136             10  BL-LETTER-TO-ACCT PIC X.
   137             10  BL-LETTER-TO-BENE PIC X.
   138             10  BL-WRITE-ERARCH   PIC X.
   139                 88  ERARCH-QWS      VALUE 'Q'.
   140                 88  ERARCH-BATCH    VALUE 'B'.
   141                 88  ERARCH-TEMP     VALUE 'T'.
   142             10  BL-PROCESS-TYPE PIC X(07).
   143             10  BL-CERT-FORM-ID PIC X(05).
   144             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   145             10  BL-SOURCE-SCREEN PIC X(8).
   146             10  FILLER          PIC X(25).
   147     03  BL-OUTPUT.
   148         05  BL-STATUS                   PIC X.
   149             88  BL-OK                      VALUE "P".
   150             88  BL-FAIL                  VALUE "F".
   151         05  BL-MESSAGE          PIC X(50).
   152     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   153     03  FILLER                  PIC X(31).
   154 01  W-WORK-AREAS.
   155     12  FILLER                  PIC  X(18)
   156                                      VALUE 'PROGRAM WORK AREA:'.
   157
   158     12  W-ASKTIME-CTR           PIC S9(04)  COMP   VALUE +0.
   159     12  W-CWA-NDX               PIC S9(04)  COMP   VALUE +0.
   160     12  W-DISPLAY-NDX           PIC S9(04)  COMP   VALUE +0.
   161     12  W-FIRST-BAD-VARIABLE    PIC S9(04)  COMP   VALUE +0.
   162     12  W-NDX                   PIC S9(04)  COMP   VALUE +0.
   163     12  W-NDX2                  PIC S9(04)  COMP   VALUE +0.
   164     12  W-SEQ-CTR               PIC S9(04)  COMP   VALUE +0.
   165     12  W-TS-ITEM               PIC S9(04)  COMP   VALUE +0.
   166     12  W-TOTAL-LINE-LENGTH     PIC S9(04)  COMP   VALUE +0.
   167     12  W-WORK-NDX              PIC S9(04)  COMP   VALUE +0.
   168
   169     12  W-ADJUST-SHORT          PIC S9(03) VALUE +0   COMP-3.
   170     12  W-DIFFERENCE            PIC S9(07)V9(02)
   171                                            VALUE +0   COMP-3.
   172     12  W-INITIAL-COLUMN        PIC S9(03) VALUE +0   COMP-3.
   173     12  W-LAST-COLUMN           PIC S9(03) VALUE +70 COMP-3.
   174     12  W-LAST-SQUEEZED-SPACE   PIC S9(03) VALUE +0   COMP-3.
   175     12  W-LAST-TX-SPACE         PIC S9(03) VALUE +0   COMP-3.
   176     12  W-LAST-WC-SPACE         PIC S9(03) VALUE +0   COMP-3.
   177     12  W-LINE-COUNT            PIC S9(03) VALUE +0   COMP-3.
   178     12  W-LINE-INDENT-1         PIC  9(02) VALUE 0    COMP-3.
   179     12  W-LINE-INDENT-2         PIC  9(02) VALUE 0    COMP-3.
   180     12  W-LINE-INDENT-3         PIC  9(02) VALUE 0    COMP-3.
   181     12  W-LINE-INDENT-4         PIC  9(02) VALUE 0    COMP-3.
   182     12  W-LINE-INDENT-5         PIC  9(02) VALUE 0    COMP-3.
   183     12  W-MAX-LINES-PER-PAGE    PIC  9(02) VALUE 56   COMP-3.
   184     12  W-NEXT-INDENT           PIC  9(02) VALUE 0    COMP-3.
   185     12  W-PAGE                  PIC S9(02) VALUE +0   COMP-3.
   186     12  W-PAGE-LINE             PIC S9(03) VALUE +0   COMP-3.
   187     12  W-PARAGRAPH-INDENT      PIC  9(02) VALUE 0    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   5
* EL689.cbl
   188     12  W-ROLL-COUNTER          PIC S9(03) VALUE +0   COMP-3.
   189     12  W-START-COLUMN          PIC S9(03) VALUE +1   COMP-3.
   190     12  W-TEMP-CURRENT-LINE     PIC S9(03) VALUE +0   COMP-3.
   191     12  W-TOO-FAR               PIC S9(03) VALUE +71 COMP-3.
   192     12  W-TOP-MARGIN            PIC  9(02) VALUE 0    COMP-3.
   193     12  W-TOTAL-TX-LINES        PIC S9(03) VALUE +0   COMP-3.
   194     12  W-TS-GROUP-WORK         PIC  9(05) VALUE 0    COMP-3.
   195     12  W-WORK-INDENT           PIC  9(02) VALUE 0    COMP-3.
   196     12  W-WORK-AMOUNT           PIC S9(09)V9(02)
   197                                            VALUE +0   COMP-3.
   198
   199     12  W-DATA-SOURCE           PIC  9(01) VALUE 0.
   200     12  W-LABEL-SOURCE          PIC  9(01) value 0.
   201         88  W-LABEL-SOURCE-VALID           VALUE 1 THRU 7.
   202     12  W-LABEL-JOINT-NAME      PIC  X(30) VALUE SPACES.
   203     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
   204     12  W-NUMB-LABEL-LINES      PIC  9(01) VALUE 0.
   205     12  W-PRINT-CONTROL         PIC  9(02) VALUE 0.
   206     12  W-SAVE-REVISION         PIC  9(03) value 0.
   207     12  W-DISPLAY-3             PIC  9(03) value 0.
   208     12  W-DISPLAY-8             PIC  9(08) value 0.
   209     12  W-DISPLAY-7             PIC  9(07) value 0.
   210     12  W-EDIT-2-5-S            PIC  Z9.9(05).
   211     12  W-EDIT-3-0              PIC  ZZ9.
   212     12  W-EDIT-7-2              PIC  $$,$$$,$$9.99.
   213     12  W-EDIT-7-2-NEGATIVE     PIC  $$,$$$,$$9.99-.
   214     12  W-EDIT-9-2              PIC  $$$$,$$$,$$9.99.
   215     12  W-EDIT-12-2             PIC  $$$$,$$$,$$$,$$9.99.
   216
   217     12  WS-ACCT-PKEY-MATCH-SW   PIC  X(01) VALUE SPACE.
   218         88  PRIOR-MATCH-ACCT-PKEY          VALUE 'Y'.
   219
   220     12  W-ARCH-SUPPRESS         PIC 99999999.
   221     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   222                                 PIC  X(08).
   223     12  W-COMP-WORK-AREA.
   224         16  W-CWA-CHAR OCCURS 10 TIMES
   225                                 PIC  X(01).
   226     12  W-INCOMING-ARCHIVE      PIC  X(08).
   227     12  W-INCOMING-ARCH-NO REDEFINES W-INCOMING-ARCHIVE
   228                                 PIC  9(08).
   229
   230     12  W-BATCH-BREAKDOWN.
   231         16  W-BATCH-CONTROL     PIC S9(08) COMP.
   232         16  W-BATCH-SEQ         PIC S9(04) COMP.
   233     12  W-BEN-HOLD              PIC  X(02).
   234     12  W-BENEFIT-WORK          PIC  X(03).
   235     12  W-BEN-R REDEFINES W-BENEFIT-WORK.
   236         16  W-ELIM-DAYS         PIC  X(02).
   237         16  FILLER              PIC  X(01).
   238     12  W-CALL-PGM              PIC  X(08).
   239     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
   240
   241     12  FILLER                  PIC  X(09) VALUE 'LINE CNTL'.
   242     12  W-LINE-CONTROL-RECORD.
   243         16  W-LC-LINE-WIDTH     PIC  9(02).
   244         16  FILLER              PIC  X(01).
   245         16  W-LC-PARAGRAPH-INDENT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   6
* EL689.cbl
   246                                 PIC  9(02).
   247         16  FILLER              PIC  X(01).
   248         16  W-LC-MAX-LINES-PER-PAGE
   249                                 PIC  9(02).
   250         16  FILLER              PIC  X(01).
   251         16  W-LC-LINE-ADJUST    PIC  9(02).
   252         16  FILLER              PIC  X(01).
   253         16  W-LC-LINE-INDENT-1  PIC  9(02).
   254         16  FILLER              PIC  X(01).
   255         16  W-LC-LINE-INDENT-2  PIC  9(02).
   256         16  FILLER              PIC  X(01).
   257         16  W-LC-LINE-INDENT-3  PIC  9(02).
   258         16  FILLER              PIC  X(01).
   259         16  W-LC-LINE-INDENT-4  PIC  9(02).
   260         16  FILLER              PIC  X(01).
   261         16  W-LC-LINE-INDENT-5  PIC  9(02).
   262         16  FILLER              PIC  X(01).
   263         16  W-LC-TOP-MARGIN     PIC  9(02).
   264         16  FILLER              PIC  X(01).
   265         16  W-LC-CASE-IND       PIC  X(01).
   266             88  W-LC-USE-BOTH-CASES        VALUE 'Y'.
   267         16  FILLER              PIC  X(01).
   268         16  W-LC-PAGE-IND       PIC  X(01).
   269             88  W-LC-CREATE-PAGES          VALUE 'Y'.
   270     12  W-DATE-WORK             PIC  9(07).
   271     12  W-DT-REDEF REDEFINES W-DATE-WORK.
   272         16  FILLER              PIC  X(02).
   273         16  W-DT-WORK           PIC  9(05).
   274
   275     12  W-DEEDIT-FIELD          PIC  X(15).
   276     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
   277
   278     12  W-EDIT-DATE-1.
   279         16  W-ED1-MM            PIC  X(02).
   280         16  FILLER              PIC  X(01) VALUE '/'.
   281         16  W-ED1-DD            PIC  X(02).
   282         16  FILLER              PIC  X(01) VALUE '/'.
   283         16  W-ED1-YY            PIC  X(02).
   284
   285     12  W-EDIT-DATE-2.
   286         16  W-ED2-DD            PIC  X(02).
   287         16  FILLER              PIC  X(01) VALUE '/'.
   288         16  W-ED2-MM            PIC  X(02).
   289         16  FILLER              PIC  X(01) VALUE '/'.
   290         16  W-ED2-YY            PIC  X(02).
   291
   292     12  W-LABEL-HOLD-AREA.
   293         16  W-LABEL-LINES OCCURS 6 TIMES.
   294             20  W-LABEL-ZIP.
   295                 24  W-LABEL-1ST-ZIP  PIC  X(05).
   296                 24  W-LABEL-DASH     PIC  X(01).
   297                 24  W-LABEL-2ND-ZIP  PIC  X(04).
   298             20  W-LAB-CAN-POSTAL-CODES REDEFINES W-LABEL-ZIP.
   299                 24  W-LAB-CAN-POSTAL-CD-1
   300                                      PIC  X(03).
   301                 24  W-LAB-CAN-DASH   PIC  X(01).
   302                 24  W-LAB-CAN-POSTAL-CD-2
   303                                      PIC  X(03).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   7
* EL689.cbl
   304                 24  W-LAB-CAN-FILLER PIC  X(03).
   305             20  FILLER               PIC  X(10).
   306             20  W-LAST-ZIP.
   307                 24  W-LAST-1ST-ZIP   PIC  X(05).
   308                 24  W-LABEL-DASH-LAST
   309                                      PIC  X(01).
   310                 24  W-LAST-2ND-ZIP   PIC  X(04).
   311             20  W-LAST-CAN-POSTAL-CODES REDEFINES W-LAST-ZIP.
   312                 24  W-LAST-CAN-POSTAL-CD-1
   313                                      PIC  X(03).
   314                 24  W-LAST-CAN-DASH  PIC  X(01).
   315                 24  W-LAST-CAN-POSTAL-CD-2
   316                                      PIC  X(03).
   317                 24  W-LAST-CAN-FILLER
   318                                      PIC  X(03).
   319
   320     12  W-LAST-CHAR             PIC  X(01).
   321         88  W-LAST-CHAR-PUNC    VALUE '-' '/'.
   322     12  W-LAST-SQ-CHAR          PIC  X(01).
   323
   324     12  W-LINE-NUM.
   325         16  W-LINE1             PIC  X(01).
   326         16  W-LINE23            PIC  9(02).
   327     12  W-LIN-NUM REDEFINES W-LINE-NUM
   328                                 PIC  9(03).
   329
   330     12  W-NAME-LAST             PIC  X(15).
   331     12  W-NAME-FIRST.
   332         16  W-NAME-FIRST-INIT   PIC  X(01).
   333         16  W-NAME-FIRST-REMAIN PIC  X(14).
   334     12  W-NAME-MIDDLE.
   335         16  FILLER              PIC  X(01).
   336         16  W-NAME-MIDDLE-2     PIC  X(01).
   337         16  FILLER              PIC  X(13).
   338
   339     12  W-PAGE-PRT.
   340         16  FILLER              PIC  X(34) VALUE SPACES.
   341         16  W-PAGE-NUMBER       PIC  Z9.
   342         16  FILLER              PIC  X(01) VALUE '.'.
   343         16  FILLER              PIC  X(33) VALUE SPACES.
   344
   345     12  W-PHONE-IN              PIC  9(11) VALUE ZEROS.
   346     12  W-PHONE-IN-R   REDEFINES W-PHONE-IN.
   347         16  FILLER              PIC  9(01).
   348         16  W-PHI-AREA          PIC  9(03).
   349         16  W-PHI-PFX           PIC  9(03).
   350         16  W-PHI-SFX           PIC  9(04).
   351     12  W-PHONE-OUT.
   352         16  W-PO-AREA           PIC  X(03).
   353         16  FILLER              PIC  X(01) VALUE '-'.
   354         16  W-PO-PFX            PIC  X(03).
   355         16  FILLER              PIC  X(01) VALUE '-'.
   356         16  W-PO-SFX            PIC  X(04).
   357
   358     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
   359     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
   360     12  W-SAVE-PLAN             PIC  X(02) VALUE SPACES.
   361
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   8
* EL689.cbl
   362     12  W-SINGLE-LINE           PIC  X(70).
   363     12  W-SINGLE-LINE-BY REDEFINES W-SINGLE-LINE.
   364         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY NDX1 NDX2 NDXA
   365                                 PIC  X(01).
   366
   367     12  W-SQUEEZED-LINE.
   368         16  W-SQ-CHAR OCCURS 70 TIMES
   369                       INDEXED BY W-SQ-NDX
   370                                 PIC  X(01).
   371
   372     12  W-TIME-IN               PIC S9(07).
   373     12  W-TIME-OUT-R REDEFINES W-TIME-IN.
   374         16  FILLER              PIC  X(01).
   375         16  W-TIME-OUT          PIC  99V9(02).
   376         16  FILLER              PIC  X(02).
   377
   378     12  W-TS-NAME-TEXT.
   379         16  W-TS-ID-TEXT        PIC  X(04) VALUE '104A'.
   380         16  W-TS-ID-TIME
   381             REDEFINES W-TS-ID-TEXT
   382                                 PIC S9(07) COMP-3.
   383         16  W-TS-TERM-TEXT.
   384             20 W-TS-TERM-PREFIX PIC  X(02).
   385             20 FILLER           PIC  X(02).
   386     12  W-TS-NAME-SCREEN.
   387         16  FILLER              PIC  X(04) VALUE '689X'.
   388         16  W-TS-TERM-SCREEN    PIC  X(04).
   389
   390     12  W-WORK-LINE.
   391         16  W-WORK-CHAR OCCURS 70 TIMES
   392                       INDEXED BY W-WC-NDX
   393                                  W-WC-NDX2
   394                                  W-WC-NDX3
   395                                 PIC  X(01).
   396
   397     12  W-WORK-ZIP-NUMERIC      PIC  9(09).
   398     12  W-WORK-ZIP REDEFINES W-WORK-ZIP-NUMERIC.
   399         16  W-WORK-ZIP5         PIC  X(05).
   400         16  W-WORK-ZIP4         PIC  X(04).
   401     12  W-CANADIAN-POSTAL-CODES REDEFINES W-WORK-ZIP-NUMERIC.
   402         16  W-CAN-POSTAL-CD-1.
   403             20  FILLER          PIC  X(01).
   404                 88 W-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   405             20  FILLER          PIC  X(02).
   406         16  W-CAN-POSTAL-CD-2   PIC  X(03).
   407         16  W-FILLER            PIC  X(03).
   408
   409**** Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   410*                   COPY ELCZREC.
   411******************************************************************
   412*                                                                *
   413*                                                                *
   414*                            ELCZREC.                            *
   415*                                                                *
   416*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   417*                                                                *
   418******************************************************************
   419*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page   9
* EL689.cbl
   420*                   C H A N G E   L O G
   421*
   422* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   423*-----------------------------------------------------------------
   424*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   425* EFFECTIVE    NUMBER
   426*-----------------------------------------------------------------
   427* 122011    2011022800001  AJRA  NEW FILE
   428* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   429*-----------------------------------------------------------------
   430 01  W-Z-CONTROL-DATA.
   431     05  W-NUMBER-OF-COPIES      PIC  9.
   432     05  FILLER                  PIC  X.
   433     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   434     05  FILLER                  PIC  X.
   435     05  W-DAYS-TO-RESEND        PIC  999.
   436     05  FILLER                  PIC  X.
   437     05  W-FORM-TO-RESEND        PIC  X(4).
   438     05  FILLER                  PIC  X.
   439     05  W-PROMPT-LETTER         PIC  X.
   440     05  FILLER                  PIC  X.
   441     05  W-ENCLOSURE-CD          PIC  XXX.
   442     05  FILLER                  PIC  X.
   443     05  W-AUTO-CLOSE-IND        PIC  X.
   444     05  FILLER                  PIC  X.
   445     05  W-LETTER-TO-BENE        PIC  X.
   446     05  FILLER                  PIC  X.
   447     05  W-LETTER-TO-ACCT        PIC  X.
   448     05  FILLER                  PIC  X.
   449     05  W-LETTER-TYPE           PIC  X.
   450     05  FILLER                  PIC  X.
   451     05  W-PRINT-CERTIFICATE     PIC  X.
   452     05  FILLER                  PIC  X.
   453     05  W-REFUND-REQUIRED       PIC  X.
   454     05  FILLER                  PIC  X.
   455     05  W-ONBASE-CODE           PIC  XX.
   456     05  FILLER                  PIC  X.
   457     05  W-ACCT-SUMM             PIC  X.
   458     05  FILLER                  PIC  X.
   459     05  W-CSO-SUMM              PIC  X.
   460     05  FILLER                  PIC  X(31).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  10
* EL689.cbl
   462 01  W-SWITCH-INDICATORS-AREA.
   463     12  FILLER                  PIC  X(16)
   464                                      VALUE 'PROGRAM SWITCHS:'.
   465     12  W-ADDRESS-ONLY-SW       PIC  X(01) VALUE ' '.
   466         88  W-ADDRESS-ONLY      VALUE 'Y'.
   467         88  W-FULL-DATA         VALUE ' '.
   468     12  W-ACCT-BROWSE-STARTED-SW
   469                                 PIC  X(01) VALUE 'N'.
   470         88  W-ACCT-BROWSE-STARTED          VALUE 'Y'.
   471     12  W-ARCT-BROWSE-STARTED   PIC  X(01) VALUE 'N'.
   472     12  W-CERT-FOUND-SW         PIC  X(01) VALUE 'N'.
   473         88  W-CERT-FOUND                   VALUE 'Y'.
   474     12  W-CHARACTER-TYPE        PIC  X(01).
   475         88  W-END-OF-SENTENCE   VALUE '.' '?' '!'.
   476         88  W-PUNCTUATION       VALUE '.' '?' '!' ',' ';'.
   477         88  W-SPACE             VALUE ' '.
   478     12  W-COMP-BROWSE-SW        PIC  X(01) VALUE 'N'.
   479         88  W-COMP-BROWSE-STARTED          VALUE 'Y'.
   480     12  W-DATA-SHRINK-IND       PIC  X(01) VALUE SPACES.
   481         88  W-DATA-SHRINKING    VALUE 'Y'.
   482     12  W-END-OF-SENTENCE-IND   PIC  X(01) VALUE SPACES.
   483         88  W-END-OF-SENTENCE-WORKING      VALUE 'Y'.
   484     12  W-FIRST-BAD-VARIABLE-IND
   485                                 PIC  X(01) VALUE SPACES.
   486         88  W-FIRST-BAD-VARIABLE-FOUND     VALUE 'Y'.
   487     12  W-FIRST-CHAR-FOUND-IND  PIC  X(01) VALUE SPACES.
   488         88  W-FIRST-CHAR-FOUND             VALUE 'Y'.
   489         88  W-FIRST-CHAR-NOT-FOUND         VALUE SPACES.
   490     12  W-FORM-CHANGED-IND      PIC  X(01) VALUE SPACES.
   491         88  W-FORM-CHANGED                 VALUE 'Y'.
   492     12  W-FORM-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   493         88  W-FORM-SQUEEZE-ON              VALUE 'Y'.
   494         88  W-FORM-SQUEEZE-OFF             VALUE ' '.
   495     12  W-HOLD-IND              PIC  X(01) VALUE SPACES.
   496         88  W-HOLD-ON                      VALUE 'Y'.
   497         88  W-HOLD-OFF                     VALUE ' '.
   498     12  W-INDIVIDUAL-DATA-SW    PIC  X(01) VALUE ' '.
   499         88  W-INDIVIDUAL-DATA-COMPLETED    VALUE 'Y'.
   500         88  W-INDIV-DATA-NOT-COMPLETED     VALUE ' '.
   501     12  W-KEY-FIELDS-CHANGED-IND
   502                                 PIC  X(01) VALUE ' '.
   503         88  W-KEY-FIELDS-CHANGED           VALUE 'Y'.
   504         88  W-KEY-FIELDS-NOT-CHANGED       VALUE ' '.
   505     12  W-LAST-ONE              PIC  X(01) VALUE HIGH-VALUES.
   506         88  W-LAST-ONE-A-SPACE  VALUE ' '.
   507     12  W-LINE-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   508         88  W-NEW-PARAGRAPH                VALUE 'P' 'Q' 'R' 'S'
   509                                                   'T' 'U'.
   510         88  W-CONTINUE-PARAGRAPH           VALUE 'C' 'D' 'E' 'F'
   511                                                   'G' 'H'.
   512         88  W-FORM-CONTROL-LINE            VALUE 'K'.
   513         88  W-DO-NOT-ADJUST                VALUE 'N'.
   514         88  W-ADJUST-TO-LINE-LENGTH        VALUE 'A'.
   515         88  W-AS-IS                        VALUE 'A' 'N'.
   516         88  W-CONTINUE-PREVIOUS-PROCESS    VALUE ' ' '1' '2' '3'
   517                                                   '4' '5'.
   518
   519     12  W-PNDB-FOUND-SW         PIC  X(01) VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  11
* EL689.cbl
   520         88  W-PNDB-FOUND                   VALUE 'Y'.
   521     12  W-REMAINING-VAR-SW      PIC  X(01) VALUE SPACES.
   522         88  W-REMAINING-VAR-FOUND          VALUE 'Y'.
   523     12  W-REVERSE-DATE-SW       PIC  X(01) VALUE SPACES.
   524         88  W-REVERSE-DATE                 VALUE 'Y'.
   525     12  W-TEXT-BROWSED-SW       PIC  X(01) VALUE 'N'.
   526         88  W-TEXT-BROWSE-STARTED          VALUE 'Y'.
   527         88  W-TEXT-BROWSE-NOT-STARTED      VALUE 'N'.
   528
   529     12  W-VALID-ENDT-SW         PIC  X(01) VALUE 'N'.
   530         88  W-VALID-ENDT                   VALUE 'Y'.
   531     12  W-RESPONSE              PIC S9(8)   COMP.
   532         88  RESP-NORMAL                  VALUE +00.
   533         88  RESP-NOTFND                  VALUE +13.
   534         88  RESP-DUPREC                  VALUE +14.
   535         88  RESP-DUPKEY                  VALUE +15.
   536         88  RESP-NOTOPEN                 VALUE +19.
   537         88  RESP-ENDFILE                 VALUE +20.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  12
* EL689.cbl
   539 01  WS-SAVE-AREA.
   540     12  WS-SAV-AM-DEFN-1.
   541         16  WS-SAV-AM-AGT-COMMS OCCURS 10 TIMES.
   542             20  WS-SAV-AM-AGT             PIC  X(10).
   543             20  WS-SAV-AM-COM-TYP         PIC  X(01).
   544             20  FILLER                    PIC  X(15).
   545     12  WS-SAV-AM-REMIT-TO                PIC  9(02).
   546     12  WS-SAV-AM-CSR-CODE                PIC  X(04).
   547     12  WS-SAV-AM-CARRIER                 PIC  X(01).
   548     12  WS-SAV-AM-ACCOUNT                 PIC  X(10).
   549     12  WS-SAV-AM-CONTROL-NAME            PIC  X(30).
   550     12  WS-SAV-AM-NAME                    PIC  X(30).
   551     12  WS-SAV-AM-PERSON                  PIC  X(30).
   552     12  WS-SAV-AM-ADDRS                   PIC  X(30).
   553     12  WS-SAV-AM-CITY                    PIC  X(30).
   554     12  WS-SAV-AM-ERACCT-ACCOUNT          PIC  X(10).
   555     12  WS-SAV-AM-ZIP.
   556         16  WS-SAV-AM-ZIP-PRIME.
   557             20  WS-SAV-AM-ZIP-PRI-1ST     PIC  X(01).
   558                 88  SAVE-AM-CANADIAN-POST-CODE       VALUE
   559                     'A' THRU 'Z'.
   560             20  FILLER                    PIC  X(04).
   561         16  FILLER                        PIC  X(04).
   562     12  WS-SAV-AM-CANADIAN-POSTAL-CODE REDEFINES
   563                        WS-SAV-AM-ZIP      PIC  X(09).
   564     12  WS-SAV-AM-TEL-NO.
   565         16  WS-SAV-AM-AREA-CODE           PIC 9(03).
   566         16  WS-SAV-AM-TEL-PRE             PIC 9(03).
   567         16  WS-SAV-AM-TEL-NBR             PIC 9(04).
   568 01  W-KEY-AREAS.
   569     12  FILLER                    PIC  X(13)
   570                                      VALUE 'PROGRAM KEYS:'.
   571
   572     12  W-ACCT-SAVE-KEY           PIC  X(20).
   573     12  W-ACCT-KEY.
   574         16  W-ACCT-PARTIAL-KEY.
   575             20  W-ACCT-COMPANY-CD PIC  X(01).
   576             20  W-ACCT-CARRIER    PIC  X(01).
   577             20  W-ACCT-GROUPING   PIC  X(06).
   578             20  W-ACCT-STATE      PIC  X(02).
   579             20  W-ACCT-ACCOUNT    PIC  X(10).
   580         16  W-ACCT-EXP-DT         PIC  X(02).
   581
   582     12  W-ARCH-SAVE-KEY         PIC  X(05).
   583     12  W-ARCH-KEY.
   584         16  W-ARCH-PARTIAL-KEY.
   585             20  W-ARCH-COMPANY-CD
   586                                 PIC  X(01).
   587             20  W-ARCH-NUMBER   PIC S9(08)      COMP.
   588         16  W-ARCH-SEQ-NO       PIC S9(04)      COMP VALUE +0.
   589
   590     12  W-ARCT-KEY.
   591         16  W-ARCT-PARTIAL-KEY.
   592             20  W-ARCT-COMPANY-CD
   593                                 PIC  X(01).
   594             20  W-ARCT-NUMBER   PIC S9(08)      COMP.
   595         16  W-ARCT-REC-TYPE     PIC  X(01).
   596         16  W-ARCT-SEQ-NO       PIC S9(04)      COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  13
* EL689.cbl
   597
   598     12  W-CERT-KEY.
   599         16  W-CERT-COMPANY-CD   PIC  X(01).
   600         16  W-CERT-CARRIER      PIC  X(01).
   601         16  W-CERT-GROUPING     PIC  X(06).
   602         16  W-CERT-STATE        PIC  X(02).
   603         16  W-CERT-ACCOUNT      PIC  X(10).
   604         16  W-CERT-EFF-DT       PIC  X(02).
   605         16  W-CERT-CERT-NO.
   606             20  W-CERT-CERT-PRIME
   607                                 PIC  X(10).
   608             20  W-CERT-CERT-SFX PIC  X(01).
   609
   610     12  W-CHEK-KEY.
   611         16  W-CHEK-COMPANY-CD   PIC  X(01).
   612         16  W-CHEK-CARRIER      PIC  X(01).
   613         16  W-CHEK-GROUPING     PIC  X(06).
   614         16  W-CHEK-STATE        PIC  X(02).
   615         16  W-CHEK-ACCOUNT      PIC  X(10).
   616         16  W-CHEK-EFF-DT       PIC  X(02).
   617         16  W-CHEK-CERT-NO.
   618             20  W-CHEK-CERT-PRIME
   619                                 PIC  X(10).
   620             20  W-CHEK-CERT-SFX PIC  X(01).
   621         16  W-CHEK-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   622
   623     12  W-CNTL-KEY.
   624         16  W-CNTL-COMPANY-ID   PIC  X(03).
   625         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   626         16  W-CNTL-GENL.
   627             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   628             20  W-CNTL-GEN2.
   629                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   630                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   631         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   632
   633     12  W-COMP-SAVE-KEY         PIC  X(29).
   634     12  W-COMP-KEY.
   635         16  W-COMP-COMPANY-CD   PIC  X(01).
   636         16  W-COMP-CARRIER      PIC  X(01).
   637         16  W-COMP-GROUPING     PIC  X(06).
   638         16  W-COMP-RESP-PERSON.
   639             20  W-COMP-RP-CHAR OCCURS 10 TIMES
   640                                INDEXED BY W-COMP-NDX
   641                                 PIC  X(01).
   642         16  W-COMP-ACCOUNT      PIC  X(10).
   643         16  W-COMP-TYPE         PIC  X(01).
   644
   645     12  W-DELETE-KEY.
   646         16  W-DELETE-PARTIAL-KEY.
   647             20  W-DELETE-COMPANY-CD
   648                                 PIC  X(01).
   649             20  W-DELETE-NUMBER PIC S9(08)      COMP.
   650         16  W-DELETE-RECORD-TYPE
   651                                 PIC  X(01).
   652         16  W-DELETE-SEQ        PIC S9(04)      COMP VALUE +0.
   653
   654     12  W-MAIL-KEY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  14
* EL689.cbl
   655         16  W-MAIL-COMPANY-CD   PIC  X(01).
   656         16  W-MAIL-CARRIER      PIC  X(01).
   657         16  W-MAIL-GROUPING     PIC  X(06).
   658         16  W-MAIL-STATE        PIC  X(02).
   659         16  W-MAIL-ACCOUNT      PIC  X(10).
   660         16  W-MAIL-EFF-DT       PIC  X(02).
   661         16  W-MAIL-CERT-NO.
   662             20  W-MAIL-CERT-PRIME
   663                                 PIC  X(10).
   664             20  W-MAIL-CERT-SFX PIC  X(01).
   665
   666     12  W-PNDB-KEY.
   667         16  W-PNDB-COMPANY-CD   PIC  X(01).
   668         16  W-PNDB-ENTRY        PIC  X(06).
   669         16  W-PNDB-SEQ-NO       PIC S9(04)  COMP.
   670         16  W-PNDB-CHG-SEQ-NO   PIC S9(04)  COMP.
   671
   672     12  W-PNDB2-KEY.
   673         16  W-PNDB2-COMPANY-CD  PIC  X(01).
   674         16  W-PNDB2-CARRIER     PIC  X(01).
   675         16  W-PNDB2-GROUPING    PIC  X(06).
   676         16  W-PNDB2-STATE       PIC  X(02).
   677         16  W-PNDB2-ACCOUNT     PIC  X(10).
   678         16  W-PNDB2-EFF-DT      PIC  X(02).
   679         16  W-PNDB2-CERT-NO.
   680             20  W-PNDB2-CERT-PRIME
   681                                 PIC  X(10).
   682             20  W-PNDB2-CERT-SFX
   683                                 PIC  X(01).
   684         16  W-PNDB2-ALT-CHG-SEQ-NO
   685                                 PIC S9(04)  COMP.
   686         16  W-PNDB2-TYPE        PIC  X(01).
   687
   688     12  W-PYAJ-KEY.
   689         16  W-PYAJ-COMPANY-CD   PIC  X(01).
   690         16  W-PYAJ-CARRIER      PIC  X(01).
   691         16  W-PYAJ-GROUPING     PIC  X(06).
   692         16  W-PYAJ-FIN-RESP     PIC  X(10).
   693         16  W-PYAJ-ACCOUNT      PIC  X(10).
   694         16  W-PYAJ-FILE-SEQ-NO  PIC S9(08)    COMP.
   695         16  W-PYAJ-RECORD-TYPE  PIC  X(01).
   696
   697     12  W-SC-QUID-KEY.
   698         16  W-SC-QUID-TERMINAL  PIC  X(04).
   699         16  W-SC-QUID-SYSTEM    PIC  X(04).
   700
   701     12  W-TEXT-SAVE-KEY         PIC  X(05).
   702     12  W-TEXT-KEY.
   703         16  W-TEXT-PARTIAL-KEY.
   704             20  W-TEXT-COMPANY-CD
   705                                 PIC  X(01).
   706             20  W-TEXT-LETTER   PIC  X(04).
   707         16  W-TEXT-FILLER       PIC  X(08)   VALUE SPACES.
   708         16  W-TEXT-SEQ          PIC S9(04)   VALUE +0    COMP.
   709
   710     12  W-ERENDT-KEY-BY-ARCH.
   711         16  W-ERENDT-COMPANY-CD-A1 PIC X.
   712         16  W-ERENDT-ARCHIVE       PIC 9(8) BINARY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  15
* EL689.cbl
   713
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  16
* EL689.cbl
   715 01  FILLER                      PIC  X(22)
   716                                 VALUE 'INTERFACE AREA STARTS:'.
   717*    COPY ELCINTF.
   718******************************************************************
   719*                                                                *
   720*                                                                *
   721*                            ELCINTF.                            *
   722*                            VMOD=2.017                          *
   723*                                                                *
   724*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   725*                                                                *
   726*       LENGTH = 1024                                            *
   727*                                                                *
   728******************************************************************
   729*                   C H A N G E   L O G
   730*
   731* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   732*-----------------------------------------------------------------
   733*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   734* EFFECTIVE    NUMBER
   735*-----------------------------------------------------------------
   736* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   737******************************************************************
   738 01  PROGRAM-INTERFACE-BLOCK.
   739     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   740     12  PI-CALLING-PROGRAM              PIC X(8).
   741     12  PI-SAVED-PROGRAM-1              PIC X(8).
   742     12  PI-SAVED-PROGRAM-2              PIC X(8).
   743     12  PI-SAVED-PROGRAM-3              PIC X(8).
   744     12  PI-SAVED-PROGRAM-4              PIC X(8).
   745     12  PI-SAVED-PROGRAM-5              PIC X(8).
   746     12  PI-SAVED-PROGRAM-6              PIC X(8).
   747     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   748     12  PI-COMPANY-ID                   PIC XXX.
   749     12  PI-COMPANY-CD                   PIC X.
   750
   751     12  PI-COMPANY-PASSWORD             PIC X(8).
   752
   753     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   754
   755     12  PI-CONTROL-IN-PROGRESS.
   756         16  PI-CARRIER                  PIC X.
   757         16  PI-GROUPING                 PIC X(6).
   758         16  PI-STATE                    PIC XX.
   759         16  PI-ACCOUNT                  PIC X(10).
   760         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   761                                         PIC X(10).
   762         16  PI-CLAIM-CERT-GRP.
   763             20  PI-CLAIM-NO             PIC X(7).
   764             20  PI-CERT-NO.
   765                 25  PI-CERT-PRIME       PIC X(10).
   766                 25  PI-CERT-SFX         PIC X.
   767             20  PI-CERT-EFF-DT          PIC XX.
   768         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   769             20  PI-PLAN-CODE            PIC X(2).
   770             20  PI-REVISION-NUMBER      PIC X(3).
   771             20  PI-PLAN-EFF-DT          PIC X(2).
   772             20  PI-PLAN-EXP-DT          PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  17
* EL689.cbl
   773             20  FILLER                  PIC X(11).
   774         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   775             20  PI-OE-REFERENCE-1.
   776                 25  PI-OE-REF-1-PRIME   PIC X(18).
   777                 25  PI-OE-REF-1-SUFF    PIC XX.
   778
   779     12  PI-SESSION-IN-PROGRESS          PIC X.
   780         88  CLAIM-SESSION                   VALUE '1'.
   781         88  CREDIT-SESSION                  VALUE '2'.
   782         88  WARRANTY-SESSION                VALUE '3'.
   783         88  MORTGAGE-SESSION                VALUE '4'.
   784         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   785
   786
   787*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   788
   789     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   790     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   791
   792     12  PI-CREDIT-USER                  PIC X.
   793         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   794         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   795
   796     12  PI-CLAIM-USER                   PIC X.
   797         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   798         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   799
   800     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   801         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   802         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   803         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   804         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   805         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   806
   807     12  PI-PROCESSOR-ID                 PIC X(4).
   808
   809     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   810
   811     12  PI-MEMBER-CAPTION               PIC X(10).
   812
   813     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   814         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   815
   816     12  PI-LIFE-OVERRIDE-L1             PIC X.
   817     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   818     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   819     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   820
   821     12  PI-AH-OVERRIDE-L1               PIC X.
   822     12  PI-AH-OVERRIDE-L2               PIC XX.
   823     12  PI-AH-OVERRIDE-L6               PIC X(6).
   824     12  PI-AH-OVERRIDE-L12              PIC X(12).
   825
   826     12  PI-NEW-SYSTEM                   PIC X(2).
   827
   828     12  PI-PRIMARY-CERT-NO              PIC X(11).
   829     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   830         88  PI-USES-PAID-TO                 VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  18
* EL689.cbl
   831     12  PI-CRDTCRD-SYSTEM.
   832         16  PI-CRDTCRD-USER             PIC X.
   833             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   834             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   835         16  PI-CC-MONTH-END-DT          PIC XX.
   836     12  PI-PROCESSOR-PRINTER            PIC X(4).
   837
   838     12  PI-OE-REFERENCE-2.
   839         16  PI-OE-REF-2-PRIME           PIC X(10).
   840         16  PI-OE-REF-2-SUFF            PIC X.
   841
   842     12  PI-REM-TRM-CALC-OPTION          PIC X.
   843
   844     12  PI-LANGUAGE-TYPE                PIC X.
   845             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   846             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   847             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   848
   849     12  PI-POLICY-LINKAGE-IND           PIC X.
   850         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   851         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   852                                                   LOW-VALUES.
   853
   854     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   855     12  PI-CLAIM-PW-SESSION             PIC X(1).
   856         88  PI-CLAIM-CREDIT                 VALUE '1'.
   857         88  PI-CLAIM-CONVEN                 VALUE '2'.
   858
   859     12  PI-PROCESSOR-CSR-IND            PIC X.
   860         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   861         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   862
   863     12  FILLER                          PIC X(3).
   864
   865     12  PI-SYSTEM-LEVEL                 PIC X(145).
   866
   867     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   868         PI-SYSTEM-LEVEL.
   869
   870         16  PI-ENTRY-CODES.
   871             20  PI-ENTRY-CD-1           PIC X.
   872             20  PI-ENTRY-CD-2           PIC X.
   873
   874         16  PI-RETURN-CODES.
   875             20  PI-RETURN-CD-1          PIC X.
   876             20  PI-RETURN-CD-2          PIC X.
   877
   878         16  PI-UPDATE-STATUS-SAVE.
   879             20  PI-UPDATE-BY            PIC X(4).
   880             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   881
   882         16  PI-LOWER-CASE-LETTERS       PIC X.
   883             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   884
   885*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   886*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   887*            88  CARRIER-CLM-CNTL            VALUE '2'.
   888
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  19
* EL689.cbl
   889         16  PI-CERT-ACCESS-CONTROL      PIC X.
   890             88  ST-ACCNT-CNTL               VALUE ' '.
   891             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   892             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   893             88  ACCNT-CNTL                  VALUE '3'.
   894             88  CARR-ACCNT-CNTL             VALUE '4'.
   895
   896         16  PI-PROCESSOR-CAP-LIST.
   897             20  PI-SYSTEM-CONTROLS.
   898                24 PI-SYSTEM-DISPLAY     PIC X.
   899                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   900                24 PI-SYSTEM-MODIFY      PIC X.
   901                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   902             20  FILLER                  PIC XX.
   903             20  PI-DISPLAY-CAP          PIC X.
   904                 88  DISPLAY-CAP             VALUE 'Y'.
   905             20  PI-MODIFY-CAP           PIC X.
   906                 88  MODIFY-CAP              VALUE 'Y'.
   907             20  PI-MSG-AT-LOGON-CAP     PIC X.
   908                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   909             20  PI-FORCE-CAP            PIC X.
   910                 88  FORCE-CAP               VALUE 'Y'.
   911
   912         16  PI-PROGRAM-CONTROLS.
   913             20  PI-PGM-PRINT-OPT        PIC X.
   914             20  PI-PGM-FORMAT-OPT       PIC X.
   915             20  PI-PGM-PROCESS-OPT      PIC X.
   916             20  PI-PGM-TOTALS-OPT       PIC X.
   917
   918         16  PI-HELP-INTERFACE.
   919             20  PI-LAST-ERROR-NO        PIC X(4).
   920             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   921
   922         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   923             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   924
   925         16  PI-CR-CONTROL-IN-PROGRESS.
   926             20  PI-CR-CARRIER           PIC X.
   927             20  PI-CR-GROUPING          PIC X(6).
   928             20  PI-CR-STATE             PIC XX.
   929             20  PI-CR-ACCOUNT           PIC X(10).
   930             20  PI-CR-FIN-RESP          PIC X(10).
   931             20  PI-CR-TYPE              PIC X.
   932
   933         16  PI-CR-BATCH-NUMBER          PIC X(6).
   934
   935         16  PI-CR-MONTH-END-DT          PIC XX.
   936
   937         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   938             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   939             88  PI-ZERO-CARRIER             VALUE '1'.
   940             88  PI-ZERO-GROUPING            VALUE '2'.
   941             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   942
   943         16  PI-CARRIER-SECURITY         PIC X.
   944             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   945
   946         16  PI-ACCOUNT-SECURITY         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  20
* EL689.cbl
   947             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   948             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   949
   950         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   951             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   952                                         INDEXED BY PI-ACCESS-NDX
   953                                         PIC X.
   954
   955         16  PI-GA-BILLING-CONTROL       PIC X.
   956             88  PI-GA-BILLING               VALUE '1'.
   957
   958         16  PI-MAIL-PROCESSING          PIC X.
   959             88  PI-MAIL-YES                 VALUE 'Y'.
   960
   961         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   962
   963         16  PI-AR-SYSTEM.
   964             20  PI-AR-PROCESSING-CNTL   PIC X.
   965                 88  PI-AR-PROCESSING        VALUE 'Y'.
   966             20  PI-AR-SUMMARY-CODE      PIC X(6).
   967             20  PI-AR-MONTH-END-DT      PIC XX.
   968
   969         16  PI-MP-SYSTEM.
   970             20  PI-MORTGAGE-USER            PIC X.
   971                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   972                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   973             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   974                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   975                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   976                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   977                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   978                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   979             20  PI-MP-MONTH-END-DT          PIC XX.
   980             20  PI-MP-REFERENCE-NO.
   981                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   982                 24  PI-MP-REFERENCE-SFX     PIC XX.
   983
   984         16  PI-LABEL-CONTROL            PIC X(01).
   985             88  PI-CREATE-LABELS                    VALUE 'Y'.
   986             88  PI-BYPASS-LABELS                    VALUE 'N'.
   987
   988         16  PI-BILL-GROUPING-CODE       PIC X(01).
   989             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   990
   991         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   992             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   993             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   994
   995         16  FILLER                      PIC X(14).
   996
   997     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   998******************************************************************
   999     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
  1000*    COPY ELC1042.
  1001******************************************************************
  1002*                                                                *
  1003*                                                                *
  1004*                           ELC1042                              *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  21
* EL689.cbl
  1005*                            VMOD=2.002                          *
  1006*                                                                *
  1007*    NOTE                                                        *
  1008*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1009*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1010*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1011*        TO THESE PROGRAMS.                                      *
  1012*                                                                *
  1013*    NOTE                                                        *
  1014*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1015*        USE ONLY!                                               *
  1016*                                                                *
  1017******************************************************************
  1018
  1019         16  PI-1042-WA.
  1020             20  PI-ACTION       PIC  X(01).
  1021                 88 PI-SHOW-MODE           VALUE '1'.
  1022                 88 PI-CLEAR-MODE          VALUE '2'.
  1023                 88 PI-CREATE-MODE         VALUE '3'.
  1024             20  PI-COMM-CONTROL PIC  X(12).
  1025             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1026             20  PI-EOF-SW       PIC  X(01).
  1027                 88  PI-FILE-EOF           VALUE 'Y'.
  1028             20  PI-FILETYP      PIC  X(01).
  1029             20  PI-FORM-SQUEEZE-CONTROL
  1030                                 PIC  X(01).
  1031                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1032                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1033             20  PI-LAST-CONTROL PIC  X(12).
  1034             20  PI-TEMP-STOR-ITEMS
  1035                                 PIC S9(04) COMP.
  1036             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1037             20  PI-UPDATE-SW    PIC  9(01).
  1038                 88 ANY-UPDATES            VALUE 1.
  1039             20  PI-104-SCREEN-SENT-IND
  1040                                 PIC  X(01).
  1041                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1042                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1043             20  PI-1042-SCREEN-SENT-IND
  1044                                 PIC  X(01).
  1045                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1046                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1047             20  PI-1042-ARCHIVE-IND
  1048                                 PIC  X(01).
  1049                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1050             20  FILLER          PIC  X(29).
  1051*    COPY ELC689PI.
  1052******************************************************************
  1053*                                                                *
  1054*                            ELC689PI                            *
  1055*                            VMOD=2.003                          *
  1056*                                                                *
  1057*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  1058*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  1059*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  1060*                                                                *
  1061*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  1062*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  22
* EL689.cbl
  1063*    BETWEEN PROGRAMS.                                           *
  1064*                                                                *
  1065*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1066*                                                                *
  1067*               EL631 - EL689  - EL6891 - EL6892                 *
  1068*                                                                *
  1069******************************************************************
  1070*                   C H A N G E   L O G
  1071*
  1072* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1073*-----------------------------------------------------------------
  1074*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1075* EFFECTIVE    NUMBER
  1076*-----------------------------------------------------------------
  1077* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  1078* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  1079* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1080******************************************************************
  1081
  1082
  1083         16  PI-689-WORK-AREA.
  1084             20  PI-689-ALT-PRINTER-ID
  1085                                 PIC  X(04).
  1086             20  PI-689-ARCHIVE-NUMBER
  1087                                 PIC  9(08).
  1088             20  PI-689-ARCHIVE-SW
  1089                                 PIC  X(01).
  1090                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  1091             20  PI-689-DATA-SOURCE
  1092                                 PIC  X(01).
  1093                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  1094                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  1095                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  1096                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  1097                 88  PI-689-SRC-CHECKS         VALUE '5'.
  1098             20  PI-689-ERROR-IND
  1099                                 PIC  X(01).
  1100                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  1101             20  PI-689-ERROR    PIC  9(04).
  1102                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  1103                 88  PI-689-FATAL-ERROR
  1104                     VALUES 0004 0006 0008 0013 0023 0029 0033
  1105                            0042 0047 0051 0066 0067 0070
  1106                            0168 0169 0174 0175 0176 0177 0179
  1107                            0180 0181 0182 0184 0185 0189 0190
  1108                            0191
  1109                            0215 0279 0280
  1110                            0412 0413 0454
  1111                            0533 0537
  1112                            2055 2114 2208 2209 2216 2232 2369
  1113                            2398 2433 2908 2999
  1114                            3000 3770 3771 3775
  1115                            7250 7365 7367 7368 7369 7370 7371
  1116                            7272 7373 7374 7376 7377 7378 7379
  1117                            7381 7388 7390 7393 7395 7396 7398
  1118                            9095 9096 9281 9298 9299 9320 9327
  1119                            9426 9427.
  1120                 88  PI-689-STOP-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  23
* EL689.cbl
  1121                     VALUES 0004 0008 0013 0023 0029 0033
  1122                            0042 0047 0066 0067 0070
  1123                            0168 0169 0174 0175 0176 0177
  1124                            0181 0182 0184 0185 0189 0190
  1125                            0279 0280
  1126                            0412 0413 0454
  1127                            2055 2208 2209 2216 2232
  1128                            2398 2999
  1129                            3000 3770 3771 3775
  1130                            7250 7365 7369 7370 7371
  1131                            7272 7373 7374 7376 7377 7378 7379
  1132                            7381 7388 7390 7393 7396 7398
  1133                            9095 9096 9299 9320 9426.
  1134             20  PI-689-FOLLOW-UP-DATE
  1135                                 PIC  X(02).
  1136             20  PI-689-FORM-NUMBER
  1137                                 PIC  X(04).
  1138             20  PI-689-LABEL-SOURCE
  1139                                 PIC X(01).
  1140                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  1141                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  1142                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  1143                 88  PI-689-SOURCE-COMP     VALUE '4'.
  1144                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  1145                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  1146                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  1147             20  PI-689-NUMBER-COPIES
  1148                                 PIC  9(01).
  1149             20  PI-689-NUMBER-LABEL-LINES
  1150                                 PIC  9(01).
  1151             20  PI-689-NUMBER-TEXT-RECORDS
  1152                                 PIC  9(03).
  1153             20  PI-689-PRINT-ORDER-SW
  1154                                 PIC  X(01).
  1155                 88  PI-689-PRINT-FIRST     VALUE '1'.
  1156                 88  PI-689-PRINT-SECOND    VALUE '2'.
  1157                 88  PI-689-PRINT-LATER     VALUE '3'.
  1158                 88  PI-689-PRINT-ONLY      VALUE '4'.
  1159             20  PI-689-PRINT-RESTRICTION
  1160                                 PIC  X(01).
  1161                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  1162                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  1163                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  1164             20  PI-689-PRINT-SW PIC  X(01).
  1165                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  1166             20  PI-689-RESEND-DATE-1
  1167                                 PIC  X(02).
  1168             20  PI-689-RESEND-LETR-1
  1169                                 PIC X(4).
  1170             20  PI-689-TEMP-STOR-ID
  1171                                 PIC  X(08).
  1172             20  PI-689-USE-SCREEN-IND
  1173                                 PIC  X(01).
  1174                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  1175             20  PI-689-ARCH-POINTER
  1176                                 PIC S9(08) COMP.
  1177                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  1178             20  PI-689-ARCT-POINTER
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  24
* EL689.cbl
  1179                                 PIC S9(08) COMP.
  1180                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  1181             20  PI-689-VARIABLE-DATA-GRP.
  1182                 24  PI-689-VARIABLE-DATA-1
  1183                                 PIC  X(30).
  1184                 24  PI-689-VARIABLE-DATA-2
  1185                                 PIC  X(30).
  1186                 24  PI-689-VARIABLE-DATA-3
  1187                                 PIC  X(30).
  1188                 24  PI-689-VARIABLE-DATA-4
  1189                                 PIC  X(30).
  1190
  1191         16  PI-689-KEY-DATA-FIELDS.
  1192             20  PI-689-ACCOUNT  PIC  X(10).
  1193             20  PI-689-CARRIER  PIC  X(01).
  1194             20  PI-689-CERT-NO.
  1195                 24  PI-689-CERT-PRIME
  1196                                 PIC  X(10).
  1197                 24  PI-689-CERT-SFX
  1198                                 PIC  X(01).
  1199             20  PI-689-CHG-SEQ-NO
  1200                                 PIC S9(04)    COMP.
  1201             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  1202                                 PIC  X(02).
  1203             20  PI-689-ENTRY-BATCH
  1204                                 PIC  X(06).
  1205             20  PI-689-EFF-DATE PIC  X(02).
  1206             20  PI-689-EXP-DATE PIC  X(02).
  1207             20  PI-689-GROUPING PIC  X(06).
  1208             20  PI-689-RESP-PERSON
  1209                                 PIC  X(10).
  1210             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  1211             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  1212                                 PIC  X(04).
  1213             20  PI-689-STATE    PIC  X(02).
  1214             20  PI-689-TYPE     PIC  X(01).
  1215             20  PI-689-CONTROL  PIC S9(08)    COMP.
  1216             20  PI-689-ALT-SEQ-NO
  1217                                 PIC S9(04)    COMP.
  1218         16  PI-689-DATE-EDIT    PIC  X(08).
  1219         16  PI-689-FOLLOW-UP-EDIT
  1220                                 PIC  X(08).
  1221         16  PI-689-RESEND1-EDIT PIC  X(08).
  1222         16  PI-689-SEQ-EDIT     PIC  X(08).
  1223         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  1224         16  PI-689-LBL-OVERRIDE PIC  X(01).
  1225             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  1226         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  1227         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
  1228         16  PI-PROMPT-IND       PIC X(1).
  1229         16  PI-CERT-FORM-ID     PIC X(5).
  1230         16  PI-PRINT-NOW        PIC X(1).
  1231         16  PI-ENCLOSURE-CD     PIC X(3).
  1232         16  PI-CERT-REQ-IND     PIC X(1).
  1233         16  PI-ENDT-ARCH-NO     PIC 9(8).
  1234         16  FILLER              PIC X(245).
  1235*        16  FILLER                        PIC X(276).
  1236*        16  FILLER                        PIC X(280).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  25
* EL689.cbl
  1237
  1238 01  FILLER                      PIC  X(20)
  1239                                 VALUE ':INTERFACE AREA ENDS'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  26
* EL689.cbl
  1241 01  FILLER                      PIC  X(16)
  1242                        VALUE 'MAP AREA STARTS:'.
  1243*    COPY EL689S.
  1244 01  EL689AI.
  1245     05  FILLER            PIC  X(0012).
  1246*    -------------------------------
  1247     05  RUNDTEL PIC S9(0004) COMP.
  1248     05  RUNDTEF PIC  X(0001).
  1249     05  FILLER REDEFINES RUNDTEF.
  1250         10  RUNDTEA PIC  X(0001).
  1251     05  RUNDTEI PIC  X(0008).
  1252*    -------------------------------
  1253     05  RUNTIMEL PIC S9(0004) COMP.
  1254     05  RUNTIMEF PIC  X(0001).
  1255     05  FILLER REDEFINES RUNTIMEF.
  1256         10  RUNTIMEA PIC  X(0001).
  1257     05  RUNTIMEI PIC  X(0005).
  1258*    -------------------------------
  1259     05  HOSTL PIC S9(0004) COMP.
  1260     05  HOSTF PIC  X(0001).
  1261     05  FILLER REDEFINES HOSTF.
  1262         10  HOSTA PIC  X(0001).
  1263     05  HOSTI PIC  X(0010).
  1264*    -------------------------------
  1265     05  SYSL PIC S9(0004) COMP.
  1266     05  SYSF PIC  X(0001).
  1267     05  FILLER REDEFINES SYSF.
  1268         10  SYSA PIC  X(0001).
  1269     05  SYSI PIC  X(0008).
  1270*    -------------------------------
  1271     05  COMPANYL PIC S9(0004) COMP.
  1272     05  COMPANYF PIC  X(0001).
  1273     05  FILLER REDEFINES COMPANYF.
  1274         10  COMPANYA PIC  X(0001).
  1275     05  COMPANYI PIC  X(0003).
  1276*    -------------------------------
  1277     05  USERIDL PIC S9(0004) COMP.
  1278     05  USERIDF PIC  X(0001).
  1279     05  FILLER REDEFINES USERIDF.
  1280         10  USERIDA PIC  X(0001).
  1281     05  USERIDI PIC  X(0004).
  1282*    -------------------------------
  1283     05  MAINTL PIC S9(0004) COMP.
  1284     05  MAINTF PIC  X(0001).
  1285     05  FILLER REDEFINES MAINTF.
  1286         10  MAINTA PIC  X(0001).
  1287     05  MAINTI PIC  X(0001).
  1288*    -------------------------------
  1289     05  FORML PIC S9(0004) COMP.
  1290     05  FORMF PIC  X(0001).
  1291     05  FILLER REDEFINES FORMF.
  1292         10  FORMA PIC  X(0001).
  1293     05  FORMI PIC  X(0004).
  1294*    -------------------------------
  1295     05  ARCHNUML PIC S9(0004) COMP.
  1296     05  ARCHNUMF PIC  X(0001).
  1297     05  FILLER REDEFINES ARCHNUMF.
  1298         10  ARCHNUMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  27
* EL689.cbl
  1299     05  ARCHNUMI PIC  99999999.
  1300*    -------------------------------
  1301     05  PRTNOWL PIC S9(0004) COMP.
  1302     05  PRTNOWF PIC  X(0001).
  1303     05  FILLER REDEFINES PRTNOWF.
  1304         10  PRTNOWA PIC  X(0001).
  1305     05  PRTNOWI PIC  X(0001).
  1306*    -------------------------------
  1307     05  CARRIERL PIC S9(0004) COMP.
  1308     05  CARRIERF PIC  X(0001).
  1309     05  FILLER REDEFINES CARRIERF.
  1310         10  CARRIERA PIC  X(0001).
  1311     05  CARRIERI PIC  X(0001).
  1312*    -------------------------------
  1313     05  GROUPL PIC S9(0004) COMP.
  1314     05  GROUPF PIC  X(0001).
  1315     05  FILLER REDEFINES GROUPF.
  1316         10  GROUPA PIC  X(0001).
  1317     05  GROUPI PIC  X(0006).
  1318*    -------------------------------
  1319     05  STATEL PIC S9(0004) COMP.
  1320     05  STATEF PIC  X(0001).
  1321     05  FILLER REDEFINES STATEF.
  1322         10  STATEA PIC  X(0001).
  1323     05  STATEI PIC  X(0002).
  1324*    -------------------------------
  1325     05  ACCTL PIC S9(0004) COMP.
  1326     05  ACCTF PIC  X(0001).
  1327     05  FILLER REDEFINES ACCTF.
  1328         10  ACCTA PIC  X(0001).
  1329     05  ACCTI PIC  X(0010).
  1330*    -------------------------------
  1331     05  CERTL PIC S9(0004) COMP.
  1332     05  CERTF PIC  X(0001).
  1333     05  FILLER REDEFINES CERTF.
  1334         10  CERTA PIC  X(0001).
  1335     05  CERTI PIC  X(0010).
  1336*    -------------------------------
  1337     05  SFXL PIC S9(0004) COMP.
  1338     05  SFXF PIC  X(0001).
  1339     05  FILLER REDEFINES SFXF.
  1340         10  SFXA PIC  X(0001).
  1341     05  SFXI PIC  X(0001).
  1342*    -------------------------------
  1343     05  TYPEL PIC S9(0004) COMP.
  1344     05  TYPEF PIC  X(0001).
  1345     05  FILLER REDEFINES TYPEF.
  1346         10  TYPEA PIC  X(0001).
  1347     05  TYPEI PIC  X(0001).
  1348*    -------------------------------
  1349     05  DATEL PIC S9(0004) COMP.
  1350     05  DATEF PIC  X(0001).
  1351     05  FILLER REDEFINES DATEF.
  1352         10  DATEA PIC  X(0001).
  1353     05  DATEI PIC  X(0008).
  1354*    -------------------------------
  1355     05  FOLLOWL PIC S9(0004) COMP.
  1356     05  FOLLOWF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  28
* EL689.cbl
  1357     05  FILLER REDEFINES FOLLOWF.
  1358         10  FOLLOWA PIC  X(0001).
  1359     05  FOLLOWI PIC  X(0008).
  1360*    -------------------------------
  1361     05  RESEND1L PIC S9(0004) COMP.
  1362     05  RESEND1F PIC  X(0001).
  1363     05  FILLER REDEFINES RESEND1F.
  1364         10  RESEND1A PIC  X(0001).
  1365     05  RESEND1I PIC  X(0008).
  1366*    -------------------------------
  1367     05  ENCL PIC S9(0004) COMP.
  1368     05  ENCF PIC  X(0001).
  1369     05  FILLER REDEFINES ENCF.
  1370         10  ENCA PIC  X(0001).
  1371     05  ENCI PIC  X(0003).
  1372*    -------------------------------
  1373     05  ENDARCHL PIC S9(0004) COMP.
  1374     05  ENDARCHF PIC  X(0001).
  1375     05  FILLER REDEFINES ENDARCHF.
  1376         10  ENDARCHA PIC  X(0001).
  1377     05  ENDARCHI PIC  99999999.
  1378*    -------------------------------
  1379     05  CERTIDL PIC S9(0004) COMP.
  1380     05  CERTIDF PIC  X(0001).
  1381     05  FILLER REDEFINES CERTIDF.
  1382         10  CERTIDA PIC  X(0001).
  1383     05  CERTIDI PIC  X(0005).
  1384*    -------------------------------
  1385     05  ADDRSL PIC S9(0004) COMP.
  1386     05  ADDRSF PIC  X(0001).
  1387     05  FILLER REDEFINES ADDRSF.
  1388         10  ADDRSA PIC  X(0001).
  1389     05  ADDRSI PIC  X(0001).
  1390*    -------------------------------
  1391     05  PRINTERL PIC S9(0004) COMP.
  1392     05  PRINTERF PIC  X(0001).
  1393     05  FILLER REDEFINES PRINTERF.
  1394         10  PRINTERA PIC  X(0001).
  1395     05  PRINTERI PIC  X(0004).
  1396*    -------------------------------
  1397     05  COPIESL PIC S9(0004) COMP.
  1398     05  COPIESF PIC  X(0001).
  1399     05  FILLER REDEFINES COPIESF.
  1400         10  COPIESA PIC  X(0001).
  1401     05  COPIESI PIC  X(0001).
  1402*    -------------------------------
  1403     05  DATASORL PIC S9(0004) COMP.
  1404     05  DATASORF PIC  X(0001).
  1405     05  FILLER REDEFINES DATASORF.
  1406         10  DATASORA PIC  X(0001).
  1407     05  DATASORI PIC  X(0001).
  1408*    -------------------------------
  1409     05  ADDRLBLL PIC S9(0004) COMP.
  1410     05  ADDRLBLF PIC  X(0001).
  1411     05  FILLER REDEFINES ADDRLBLF.
  1412         10  ADDRLBLA PIC  X(0001).
  1413     05  ADDRLBLI PIC  X(0001).
  1414*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  29
* EL689.cbl
  1415     05  RPERSONL PIC S9(0004) COMP.
  1416     05  RPERSONF PIC  X(0001).
  1417     05  FILLER REDEFINES RPERSONF.
  1418         10  RPERSONA PIC  X(0001).
  1419     05  RPERSONI PIC  X(0010).
  1420*    -------------------------------
  1421     05  BENTRYL PIC S9(0004) COMP.
  1422     05  BENTRYF PIC  X(0001).
  1423     05  FILLER REDEFINES BENTRYF.
  1424         10  BENTRYA PIC  X(0001).
  1425     05  BENTRYI PIC  X(0006).
  1426*    -------------------------------
  1427     05  SEQL PIC S9(0004) COMP.
  1428     05  SEQF PIC  X(0001).
  1429     05  FILLER REDEFINES SEQF.
  1430         10  SEQA PIC  X(0001).
  1431     05  SEQI PIC  X(0008).
  1432*    -------------------------------
  1433     05  BCSEQL PIC S9(0004) COMP.
  1434     05  BCSEQF PIC  X(0001).
  1435     05  FILLER REDEFINES BCSEQF.
  1436         10  BCSEQA PIC  X(0001).
  1437     05  BCSEQI PIC  X(0004).
  1438*    -------------------------------
  1439     05  L1L PIC S9(0004) COMP.
  1440     05  L1F PIC  X(0001).
  1441     05  FILLER REDEFINES L1F.
  1442         10  L1A PIC  X(0001).
  1443     05  L1I PIC  X(0003).
  1444*    -------------------------------
  1445     05  TEXT1L PIC S9(0004) COMP.
  1446     05  TEXT1F PIC  X(0001).
  1447     05  FILLER REDEFINES TEXT1F.
  1448         10  TEXT1A PIC  X(0001).
  1449     05  TEXT1I PIC  X(0070).
  1450*    -------------------------------
  1451     05  L2L PIC S9(0004) COMP.
  1452     05  L2F PIC  X(0001).
  1453     05  FILLER REDEFINES L2F.
  1454         10  L2A PIC  X(0001).
  1455     05  L2I PIC  X(0003).
  1456*    -------------------------------
  1457     05  TEXT2L PIC S9(0004) COMP.
  1458     05  TEXT2F PIC  X(0001).
  1459     05  FILLER REDEFINES TEXT2F.
  1460         10  TEXT2A PIC  X(0001).
  1461     05  TEXT2I PIC  X(0070).
  1462*    -------------------------------
  1463     05  L3L PIC S9(0004) COMP.
  1464     05  L3F PIC  X(0001).
  1465     05  FILLER REDEFINES L3F.
  1466         10  L3A PIC  X(0001).
  1467     05  L3I PIC  X(0003).
  1468*    -------------------------------
  1469     05  TEXT3L PIC S9(0004) COMP.
  1470     05  TEXT3F PIC  X(0001).
  1471     05  FILLER REDEFINES TEXT3F.
  1472         10  TEXT3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  30
* EL689.cbl
  1473     05  TEXT3I PIC  X(0070).
  1474*    -------------------------------
  1475     05  L4L PIC S9(0004) COMP.
  1476     05  L4F PIC  X(0001).
  1477     05  FILLER REDEFINES L4F.
  1478         10  L4A PIC  X(0001).
  1479     05  L4I PIC  X(0003).
  1480*    -------------------------------
  1481     05  TEXT4L PIC S9(0004) COMP.
  1482     05  TEXT4F PIC  X(0001).
  1483     05  FILLER REDEFINES TEXT4F.
  1484         10  TEXT4A PIC  X(0001).
  1485     05  TEXT4I PIC  X(0070).
  1486*    -------------------------------
  1487     05  L5L PIC S9(0004) COMP.
  1488     05  L5F PIC  X(0001).
  1489     05  FILLER REDEFINES L5F.
  1490         10  L5A PIC  X(0001).
  1491     05  L5I PIC  X(0003).
  1492*    -------------------------------
  1493     05  TEXT5L PIC S9(0004) COMP.
  1494     05  TEXT5F PIC  X(0001).
  1495     05  FILLER REDEFINES TEXT5F.
  1496         10  TEXT5A PIC  X(0001).
  1497     05  TEXT5I PIC  X(0070).
  1498*    -------------------------------
  1499     05  L6L PIC S9(0004) COMP.
  1500     05  L6F PIC  X(0001).
  1501     05  FILLER REDEFINES L6F.
  1502         10  L6A PIC  X(0001).
  1503     05  L6I PIC  X(0003).
  1504*    -------------------------------
  1505     05  TEXT6L PIC S9(0004) COMP.
  1506     05  TEXT6F PIC  X(0001).
  1507     05  FILLER REDEFINES TEXT6F.
  1508         10  TEXT6A PIC  X(0001).
  1509     05  TEXT6I PIC  X(0070).
  1510*    -------------------------------
  1511     05  L7L PIC S9(0004) COMP.
  1512     05  L7F PIC  X(0001).
  1513     05  FILLER REDEFINES L7F.
  1514         10  L7A PIC  X(0001).
  1515     05  L7I PIC  X(0003).
  1516*    -------------------------------
  1517     05  TEXT7L PIC S9(0004) COMP.
  1518     05  TEXT7F PIC  X(0001).
  1519     05  FILLER REDEFINES TEXT7F.
  1520         10  TEXT7A PIC  X(0001).
  1521     05  TEXT7I PIC  X(0070).
  1522*    -------------------------------
  1523     05  L8L PIC S9(0004) COMP.
  1524     05  L8F PIC  X(0001).
  1525     05  FILLER REDEFINES L8F.
  1526         10  L8A PIC  X(0001).
  1527     05  L8I PIC  X(0003).
  1528*    -------------------------------
  1529     05  TEXT8L PIC S9(0004) COMP.
  1530     05  TEXT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  31
* EL689.cbl
  1531     05  FILLER REDEFINES TEXT8F.
  1532         10  TEXT8A PIC  X(0001).
  1533     05  TEXT8I PIC  X(0070).
  1534*    -------------------------------
  1535     05  L9L PIC S9(0004) COMP.
  1536     05  L9F PIC  X(0001).
  1537     05  FILLER REDEFINES L9F.
  1538         10  L9A PIC  X(0001).
  1539     05  L9I PIC  X(0003).
  1540*    -------------------------------
  1541     05  TEXT9L PIC S9(0004) COMP.
  1542     05  TEXT9F PIC  X(0001).
  1543     05  FILLER REDEFINES TEXT9F.
  1544         10  TEXT9A PIC  X(0001).
  1545     05  TEXT9I PIC  X(0070).
  1546*    -------------------------------
  1547     05  L10L PIC S9(0004) COMP.
  1548     05  L10F PIC  X(0001).
  1549     05  FILLER REDEFINES L10F.
  1550         10  L10A PIC  X(0001).
  1551     05  L10I PIC  X(0003).
  1552*    -------------------------------
  1553     05  TEXT10L PIC S9(0004) COMP.
  1554     05  TEXT10F PIC  X(0001).
  1555     05  FILLER REDEFINES TEXT10F.
  1556         10  TEXT10A PIC  X(0001).
  1557     05  TEXT10I PIC  X(0070).
  1558*    -------------------------------
  1559     05  L11L PIC S9(0004) COMP.
  1560     05  L11F PIC  X(0001).
  1561     05  FILLER REDEFINES L11F.
  1562         10  L11A PIC  X(0001).
  1563     05  L11I PIC  X(0003).
  1564*    -------------------------------
  1565     05  TEXT11L PIC S9(0004) COMP.
  1566     05  TEXT11F PIC  X(0001).
  1567     05  FILLER REDEFINES TEXT11F.
  1568         10  TEXT11A PIC  X(0001).
  1569     05  TEXT11I PIC  X(0070).
  1570*    -------------------------------
  1571     05  L12L PIC S9(0004) COMP.
  1572     05  L12F PIC  X(0001).
  1573     05  FILLER REDEFINES L12F.
  1574         10  L12A PIC  X(0001).
  1575     05  L12I PIC  X(0003).
  1576*    -------------------------------
  1577     05  TEXT12L PIC S9(0004) COMP.
  1578     05  TEXT12F PIC  X(0001).
  1579     05  FILLER REDEFINES TEXT12F.
  1580         10  TEXT12A PIC  X(0001).
  1581     05  TEXT12I PIC  X(0070).
  1582*    -------------------------------
  1583     05  ERRMSGL PIC S9(0004) COMP.
  1584     05  ERRMSGF PIC  X(0001).
  1585     05  FILLER REDEFINES ERRMSGF.
  1586         10  ERRMSGA PIC  X(0001).
  1587     05  ERRMSGI PIC  X(0079).
  1588*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  32
* EL689.cbl
  1589     05  ENTERPFL PIC S9(0004) COMP.
  1590     05  ENTERPFF PIC  X(0001).
  1591     05  FILLER REDEFINES ENTERPFF.
  1592         10  ENTERPFA PIC  X(0001).
  1593     05  ENTERPFI PIC  99.
  1594*    -------------------------------
  1595     05  PF8HDL PIC S9(0004) COMP.
  1596     05  PF8HDF PIC  X(0001).
  1597     05  FILLER REDEFINES PF8HDF.
  1598         10  PF8HDA PIC  X(0001).
  1599     05  PF8HDI PIC  X(0022).
  1600 01  EL689AO REDEFINES EL689AI.
  1601     05  FILLER            PIC  X(0012).
  1602*    -------------------------------
  1603     05  FILLER            PIC  X(0003).
  1604     05  RUNDTEO PIC  X(0008).
  1605*    -------------------------------
  1606     05  FILLER            PIC  X(0003).
  1607     05  RUNTIMEO PIC  99.99.
  1608*    -------------------------------
  1609     05  FILLER            PIC  X(0003).
  1610     05  HOSTO PIC  X(0010).
  1611*    -------------------------------
  1612     05  FILLER            PIC  X(0003).
  1613     05  SYSO PIC  X(0008).
  1614*    -------------------------------
  1615     05  FILLER            PIC  X(0003).
  1616     05  COMPANYO PIC  X(0003).
  1617*    -------------------------------
  1618     05  FILLER            PIC  X(0003).
  1619     05  USERIDO PIC  X(0004).
  1620*    -------------------------------
  1621     05  FILLER            PIC  X(0003).
  1622     05  MAINTO PIC  X(0001).
  1623*    -------------------------------
  1624     05  FILLER            PIC  X(0003).
  1625     05  FORMO PIC  X(0004).
  1626*    -------------------------------
  1627     05  FILLER            PIC  X(0003).
  1628     05  ARCHNUMO PIC  99999999.
  1629*    -------------------------------
  1630     05  FILLER            PIC  X(0003).
  1631     05  PRTNOWO PIC  X(0001).
  1632*    -------------------------------
  1633     05  FILLER            PIC  X(0003).
  1634     05  CARRIERO PIC  X(0001).
  1635*    -------------------------------
  1636     05  FILLER            PIC  X(0003).
  1637     05  GROUPO PIC  X(0006).
  1638*    -------------------------------
  1639     05  FILLER            PIC  X(0003).
  1640     05  STATEO PIC  X(0002).
  1641*    -------------------------------
  1642     05  FILLER            PIC  X(0003).
  1643     05  ACCTO PIC  X(0010).
  1644*    -------------------------------
  1645     05  FILLER            PIC  X(0003).
  1646     05  CERTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  33
* EL689.cbl
  1647*    -------------------------------
  1648     05  FILLER            PIC  X(0003).
  1649     05  SFXO PIC  X(0001).
  1650*    -------------------------------
  1651     05  FILLER            PIC  X(0003).
  1652     05  TYPEO PIC  X(0001).
  1653*    -------------------------------
  1654     05  FILLER            PIC  X(0003).
  1655     05  DATEO PIC  X(0008).
  1656*    -------------------------------
  1657     05  FILLER            PIC  X(0003).
  1658     05  FOLLOWO PIC  X(0008).
  1659*    -------------------------------
  1660     05  FILLER            PIC  X(0003).
  1661     05  RESEND1O PIC  X(0008).
  1662*    -------------------------------
  1663     05  FILLER            PIC  X(0003).
  1664     05  ENCO PIC  X(0003).
  1665*    -------------------------------
  1666     05  FILLER            PIC  X(0003).
  1667     05  ENDARCHO PIC  99999999.
  1668*    -------------------------------
  1669     05  FILLER            PIC  X(0003).
  1670     05  CERTIDO PIC  X(0005).
  1671*    -------------------------------
  1672     05  FILLER            PIC  X(0003).
  1673     05  ADDRSO PIC  X(0001).
  1674*    -------------------------------
  1675     05  FILLER            PIC  X(0003).
  1676     05  PRINTERO PIC  X(0004).
  1677*    -------------------------------
  1678     05  FILLER            PIC  X(0003).
  1679     05  COPIESO PIC  X(0001).
  1680*    -------------------------------
  1681     05  FILLER            PIC  X(0003).
  1682     05  DATASORO PIC  X(0001).
  1683*    -------------------------------
  1684     05  FILLER            PIC  X(0003).
  1685     05  ADDRLBLO PIC  X(0001).
  1686*    -------------------------------
  1687     05  FILLER            PIC  X(0003).
  1688     05  RPERSONO PIC  X(0010).
  1689*    -------------------------------
  1690     05  FILLER            PIC  X(0003).
  1691     05  BENTRYO PIC  X(0006).
  1692*    -------------------------------
  1693     05  FILLER            PIC  X(0003).
  1694     05  SEQO PIC  X(0008).
  1695*    -------------------------------
  1696     05  FILLER            PIC  X(0003).
  1697     05  BCSEQO PIC  X(0004).
  1698*    -------------------------------
  1699     05  FILLER            PIC  X(0003).
  1700     05  L1O PIC  X(0003).
  1701*    -------------------------------
  1702     05  FILLER            PIC  X(0003).
  1703     05  TEXT1O PIC  X(0070).
  1704*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  34
* EL689.cbl
  1705     05  FILLER            PIC  X(0003).
  1706     05  L2O PIC  X(0003).
  1707*    -------------------------------
  1708     05  FILLER            PIC  X(0003).
  1709     05  TEXT2O PIC  X(0070).
  1710*    -------------------------------
  1711     05  FILLER            PIC  X(0003).
  1712     05  L3O PIC  X(0003).
  1713*    -------------------------------
  1714     05  FILLER            PIC  X(0003).
  1715     05  TEXT3O PIC  X(0070).
  1716*    -------------------------------
  1717     05  FILLER            PIC  X(0003).
  1718     05  L4O PIC  X(0003).
  1719*    -------------------------------
  1720     05  FILLER            PIC  X(0003).
  1721     05  TEXT4O PIC  X(0070).
  1722*    -------------------------------
  1723     05  FILLER            PIC  X(0003).
  1724     05  L5O PIC  X(0003).
  1725*    -------------------------------
  1726     05  FILLER            PIC  X(0003).
  1727     05  TEXT5O PIC  X(0070).
  1728*    -------------------------------
  1729     05  FILLER            PIC  X(0003).
  1730     05  L6O PIC  X(0003).
  1731*    -------------------------------
  1732     05  FILLER            PIC  X(0003).
  1733     05  TEXT6O PIC  X(0070).
  1734*    -------------------------------
  1735     05  FILLER            PIC  X(0003).
  1736     05  L7O PIC  X(0003).
  1737*    -------------------------------
  1738     05  FILLER            PIC  X(0003).
  1739     05  TEXT7O PIC  X(0070).
  1740*    -------------------------------
  1741     05  FILLER            PIC  X(0003).
  1742     05  L8O PIC  X(0003).
  1743*    -------------------------------
  1744     05  FILLER            PIC  X(0003).
  1745     05  TEXT8O PIC  X(0070).
  1746*    -------------------------------
  1747     05  FILLER            PIC  X(0003).
  1748     05  L9O PIC  X(0003).
  1749*    -------------------------------
  1750     05  FILLER            PIC  X(0003).
  1751     05  TEXT9O PIC  X(0070).
  1752*    -------------------------------
  1753     05  FILLER            PIC  X(0003).
  1754     05  L10O PIC  X(0003).
  1755*    -------------------------------
  1756     05  FILLER            PIC  X(0003).
  1757     05  TEXT10O PIC  X(0070).
  1758*    -------------------------------
  1759     05  FILLER            PIC  X(0003).
  1760     05  L11O PIC  X(0003).
  1761*    -------------------------------
  1762     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  35
* EL689.cbl
  1763     05  TEXT11O PIC  X(0070).
  1764*    -------------------------------
  1765     05  FILLER            PIC  X(0003).
  1766     05  L12O PIC  X(0003).
  1767*    -------------------------------
  1768     05  FILLER            PIC  X(0003).
  1769     05  TEXT12O PIC  X(0070).
  1770*    -------------------------------
  1771     05  FILLER            PIC  X(0003).
  1772     05  ERRMSGO PIC  X(0079).
  1773*    -------------------------------
  1774     05  FILLER            PIC  X(0003).
  1775     05  ENTERPFO PIC  X(0002).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  PF8HDO PIC  X(0022).
  1779*    -------------------------------
  1780 01  W-MAP-REDEF REDEFINES EL689AI.
  1781*    12  FILLER                  PIC X(218).
  1782     12  FILLER                  PIC X(267).
  1783     12  EL689RI.
  1784         16  W-TEXT-LINES OCCURS 12 TIMES INDEXED BY W-SC-NDX.
  1785             20  W-SC-LINEL      PIC S9(04) COMP.
  1786             20  W-SC-LINEA      PIC  X(01).
  1787             20  W-SC-LINE       PIC  X(03).
  1788             20  W-SC-TEXTL      PIC S9(04) COMP.
  1789             20  W-SC-TEXTA      PIC  X(01).
  1790             20  W-SC-TEXT       PIC  X(70).
  1791*    12  FILLER                  PIC  X(87).
  1792     12  FILLER                  PIC  X(112).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  36
* EL689.cbl
  1794 01  W-CONSTANT-AREA.
  1795     12  FILLER                  PIC  X(18)
  1796                                 VALUE 'PROGRAM CONSTANTS:'.
  1797     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
  1798     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
  1799     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
  1800     12  W-ENDT-LENGTH           PIC S9(04)  COMP  VALUE +579.
  1801     12  W-MAX-LINES             PIC S9(03) VALUE +300 COMP-3.
  1802     12  W-NUM-LINES-PER-SCREEN  PIC  9(02)        VALUE 12.
  1803     12  W-TS-NUM-REC-IN-GROUP   PIC  9(02)        VALUE 50.
  1804     12  W-TS-LENGTH             PIC S9(04)  COMP  VALUE +3650.
  1805     12  W-TS-MAP-LENGTH         PIC S9(04)  COMP  VALUE +1260.
  1806     12  W-ZEROS                 PIC S9(03) VALUE +000 COMP-3.
  1807
  1808     12  W-ACCT-FILE-ID          PIC  X(08) VALUE 'ERACCT'.
  1809     12  W-ACCT2-FILE-ID         PIC  X(08) VALUE 'ERACCT2'.
  1810     12  W-ARCH-FILE-ID          PIC  X(08) VALUE 'ERARCH'.
  1811     12  W-ARCH2-FILE-ID         PIC  X(08) VALUE 'ERARCH2'.
  1812     12  W-ARCH3-FILE-ID         PIC  X(08) VALUE 'ERARCH3'.
  1813     12  W-ARCH4-FILE-ID         PIC  X(08) VALUE 'ERARCH4'.
  1814     12  W-ARCH5-FILE-ID         PIC  X(08) VALUE 'ERARCH5'.
  1815     12  W-ARCT-FILE-ID          PIC  X(08) VALUE 'ERARCT'.
  1816     12  W-CERT-FILE-ID          PIC  X(08) VALUE 'ELCERT'.
  1817     12  W-CHEK-FILE-ID          PIC  X(08) VALUE 'ERCHEK'.
  1818     12  W-CNTL-FILE-ID          PIC  X(08) VALUE 'ELCNTL'.
  1819     12  W-COMP-FILE-ID          PIC  X(08) VALUE 'ERCOMP'.
  1820     12  W-GETMAIN-SPACE         PIC  X(01) VALUE SPACE.
  1821     12  W-LGXX-ID               PIC  X(04) VALUE 'LGXX'.
  1822     12  W-LINK-001              PIC  X(05) VALUE 'EL001'.
  1823     12  W-LINK-004              PIC  X(05) VALUE 'EL004'.
  1824     12  W-LINK-ELDATCV          PIC  X(07) VALUE 'ELDATCV'.
  1825     12  W-LOWER-CASE            PIC  X(26)
  1826         VALUE 'abcdefghijklmnopqrstuvwxyz'.
  1827     12  W-MAIL-FILE-ID          PIC  X(08) VALUE 'ERMAIL'.
  1828     12  W-MAP.
  1829         16  W-MAP-PREFIX        PIC  X(02) VALUE 'EL'.
  1830         16  W-MAP-NUM           PIC  X(04) VALUE '689A'.
  1831         16  W-MAP-FILLER        PIC  X(02) VALUE SPACES.
  1832     12  W-MAPSET                PIC  X(08) VALUE 'EL689S'.
  1833     12  W-PGM-EL1042            PIC  X(08) VALUE 'EL1042'.
  1834     12  W-PGM-EL690             PIC  X(08) VALUE 'EL690'.
  1835     12  W-PGM-EL626             PIC  X(08) VALUE 'EL626'.
  1836     12  W-PNDB-FILE-ID          PIC  X(08) VALUE 'ERPNDB'.
  1837     12  W-PRINT-TRANS           PIC  X(04) VALUE 'EXH5'.
  1838     12  W-PYAJ-FILE-ID          PIC  X(08) VALUE 'ERPYAJ'.
  1839
  1840     12  W-TEXT-FILE-ID          PIC  X(08) VALUE 'ELLETR'.
  1841     12  W-THIS-PGM              PIC  X(08) VALUE 'EL689'.
  1842     12  W-TOP-FORM              PIC  X(70)
  1843                              VALUE '*****TOP OF FORM *****'.
  1844     12  W-TRANSACTION           PIC  X(04) VALUE 'EXH3'.
  1845     12  W-UPPER-CASE            PIC  X(26)
  1846         VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
  1847     12  W-XCTL-005              PIC  X(05) VALUE 'EL005'.
  1848     12  W-XCTL-010              PIC  X(05) VALUE 'EL010'.
  1849     12  W-XCTL-626              PIC  X(05) VALUE 'EL626'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  37
* EL689.cbl
  1851 01  W-VARIABLE-PROCESS-CNTLS.
  1852     12  FILLER                  PIC  X(26)
  1853                        VALUE 'VARIABLE WORK AREA STARTS:'.
  1854     12  W-NUM-OF-VARIABLES      PIC S9(03) VALUE +189 COMP-3.
  1855     12  W-VAR-HOLD.
  1856         16  W-V1                PIC  X(01).
  1857         16  W-V2                PIC  X(01).
  1858         16  W-V3                PIC  X(01).
  1859     12  FILLER REDEFINES W-VAR-HOLD.
  1860         16  W-VAR-RELATIVE-NUM  PIC  9(03).
  1861     12  W-FIELD-SQUEEZE-IND     PIC  X(01).
  1862         88  W-SQUEEZE-FIELD          VALUE '#'.
  1863
  1864 01  W-SUPPORTED-VARIABLES.
  1865
  1866*****************COMPANY VARIABLES - ELCNTL ********************
  1867*****COMPANY NAME
  1868     12  FILLER                  PIC  X(03) VALUE '001'.
  1869     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1870     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1871     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1872     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1873
  1874*****FULL COMPANY ADDRESS
  1875     12  FILLER                  PIC  X(03) VALUE '002'.
  1876     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1877     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1878     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1879     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1880
  1881     12  FILLER                  PIC  X(03) VALUE '003'.
  1882     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1883     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1884     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1885     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1886
  1887     12  FILLER                  PIC  X(03) VALUE '004'.
  1888     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1889     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1890     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1891     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1892
  1893     12  FILLER                  PIC  X(03) VALUE '005'.
  1894     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1895     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1896     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1897     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1898
  1899     12  FILLER                  PIC  X(03) VALUE '006'.
  1900     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1901     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1902     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1903     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1904
  1905*****REMAINING 4 ARE NOT CURRENTLY USED
  1906     12  FILLER                  PIC  X(03) VALUE '007'.
  1907     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1908     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  38
* EL689.cbl
  1909     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1910     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1911
  1912     12  FILLER                  PIC  X(03) VALUE '008'.
  1913     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1914     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1915     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1916     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1917
  1918     12  FILLER                  PIC  X(03) VALUE '009'.
  1919     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1920     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1921     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1922     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1923
  1924     12  FILLER                  PIC  X(03) VALUE '010'.
  1925     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1926     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1927     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1928     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1929
  1930************ LIFE BENEFIT VARIABLES - ELCNTL *******************
  1931*****LIFE BENEFIT DESCRIPTION
  1932     12  FILLER                  PIC  X(03) VALUE '011'.
  1933     12  FILLER                  PIC S9(04) COMP VALUE +10.
  1934     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1935     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1936     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1937
  1938*****REMAINING 3 ARE NOT CURRENTLY USED
  1939     12  FILLER                  PIC  X(03) VALUE '012'.
  1940     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1941     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1942     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1943     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1944
  1945     12  FILLER                  PIC  X(03) VALUE '013'.
  1946     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1947     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1948     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1949     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1950
  1951     12  FILLER                  PIC  X(03) VALUE '014'.
  1952     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1953     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1954     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1955     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1956
  1957************* A&H BENEFIT VARIABLES - ELCNTL *******************
  1958*****AH BENEFIT DESCRIPTION
  1959     12  FILLER                  PIC  X(03) VALUE '015'.
  1960     12  FILLER                  PIC S9(04) COMP VALUE +10.
  1961     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1962     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1963     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1964
  1965*****ELIMINATION PERIOD
  1966     12  FILLER                  PIC  X(03) VALUE '016'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  39
* EL689.cbl
  1967     12  FILLER                  PIC S9(04) COMP VALUE +2.
  1968     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1969     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1970     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1971
  1972*****REMAINING 3 ARE NOT CURRENTLY USED
  1973     12  FILLER                  PIC  X(03) VALUE '017'.
  1974     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1975     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1976     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1977     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1978
  1979     12  FILLER                  PIC  X(03) VALUE '018'.
  1980     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1981     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1982     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1983     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1984
  1985     12  FILLER                  PIC  X(03) VALUE '019'.
  1986     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1987     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1988     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1989     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1990
  1991*****************CARRIER VARIABLES - ELCNTL ********************
  1992*****CARRIER NAME
  1993     12  FILLER                  PIC  X(03) VALUE '020'.
  1994     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1995     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1996     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1997     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1998
  1999*****FULL CARRIER ADDRESS
  2000     12  FILLER                  PIC  X(03) VALUE '021'.
  2001     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2002     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2003     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2004     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2005
  2006     12  FILLER                  PIC  X(03) VALUE '022'.
  2007     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2008     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2009     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2010     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2011
  2012     12  FILLER                  PIC  X(03) VALUE '023'.
  2013     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2014     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2015     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2016     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2017
  2018     12  FILLER                  PIC  X(03) VALUE '024'.
  2019     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2020     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2021     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2022     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2023
  2024     12  FILLER                  PIC  X(03) VALUE '025'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  40
* EL689.cbl
  2025     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2026     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2027     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2028     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2029
  2030*****CARRIER PHONE NUMBER
  2031     12  FILLER                  PIC  X(03) VALUE '026'.
  2032     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2033     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2034     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2035     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2036
  2037*****REMAINING 4 ARE NOT CURRENTLY USED
  2038     12  FILLER                  PIC  X(03) VALUE '027'.
  2039     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2040     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2041     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2042     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2043
  2044     12  FILLER                  PIC  X(03) VALUE '028'.
  2045     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2046     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2047     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2048     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2049
  2050     12  FILLER                  PIC  X(03) VALUE '029'.
  2051     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2052     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2053     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2054     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2055
  2056     12  FILLER                  PIC  X(03) VALUE '030'.
  2057     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2058     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2059     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2060     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2061
  2062***************** MAIL VARIABLES - ELMAIL **********************
  2063*****FULL MAIL ADDRESS
  2064     12  FILLER                  PIC  X(03) VALUE '031'.
  2065     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2066     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2067     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2068     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2069
  2070     12  FILLER                  PIC  X(03) VALUE '032'.
  2071     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2072     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2073     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2074     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2075
  2076     12  FILLER                  PIC  X(03) VALUE '033'.
  2077     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2078     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2079     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2080     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2081
  2082     12  FILLER                  PIC  X(03) VALUE '034'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  41
* EL689.cbl
  2083     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2084     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2085     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2086     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2087
  2088     12  FILLER                  PIC  X(03) VALUE '035'.
  2089     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2090     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2091     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2092     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2093
  2094     12  FILLER                  PIC  X(03) VALUE '036'.
  2095     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2096     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2097     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2098     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2099**** CRED BENE NAME FROM ERMAIL
  2100     12  FILLER                  PIC  X(03) VALUE '037'.
  2101     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2102     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2103     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2104     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2105*****REMAINING 2 ARE NOT CURRENTLY USED
  2106     12  FILLER                  PIC  X(03) VALUE '038'.
  2107     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2108     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2109     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2110     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2111
  2112     12  FILLER                  PIC  X(03) VALUE '039'.
  2113     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2114     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2115     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2116     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2117
  2118*************** ACCOUNT VARIABLES - ERACCT *********************
  2119*****ACCOUNT NAME
  2120     12  FILLER                  PIC  X(03) VALUE '040'.
  2121     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2122     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2123     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2124     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2125
  2126*****FULL ACCOUNT ADDRESS
  2127     12  FILLER                  PIC  X(03) VALUE '041'.
  2128     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2129     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2130     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2131     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2132
  2133     12  FILLER                  PIC  X(03) VALUE '042'.
  2134     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2135     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2136     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2137     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2138
  2139     12  FILLER                  PIC  X(03) VALUE '043'.
  2140     12  FILLER                  PIC S9(04) COMP VALUE +30.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  42
* EL689.cbl
  2141     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2142     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2143     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2144
  2145     12  FILLER                  PIC  X(03) VALUE '044'.
  2146     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2147     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2148     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2149     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2150
  2151     12  FILLER                  PIC  X(03) VALUE '045'.
  2152     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2153     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2154     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2155     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2156
  2157*****ACCOUNT PHONE NUMBER
  2158     12  FILLER                  PIC  X(03) VALUE '046'.
  2159     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2160     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2161     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2162     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2163
  2164*****ACCOUNT CONTROL NAME AM-CONTROL-NAME
  2165     12  FILLER                  PIC  X(03) VALUE '047'.
  2166     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2167     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2168     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2169     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2170
  2171****ACCOUNT CSR CODE
  2172     12  FILLER                  PIC  X(03) VALUE '048'.
  2173     12  FILLER                  PIC S9(04) COMP VALUE +4..
  2174     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2175     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2176     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2177****ACCOUNT ACCOUNT NUMBER
  2178     12  FILLER                  PIC  X(03) VALUE '049'.
  2179     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2180     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2181     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2182     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2183
  2184**** CRED BENE ADDRESS LINE 1 ERMAIL
  2185     12  FILLER                  PIC  X(03) VALUE '050'.
  2186     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2187     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2188     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2189     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2190
  2191**** CRED BENE ADDRESS LINE 2 ERMAIL
  2192     12  FILLER                  PIC  X(03) VALUE '051'.
  2193     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2194     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2195     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2196     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2197
  2198**** CRED BENE CITY STATE   ERMAIL
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  43
* EL689.cbl
  2199     12  FILLER                  PIC  X(03) VALUE '052'.
  2200     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2201     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2202     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2203     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2204
  2205**** CRED BENE ZIP  1 ERMAIL
  2206     12  FILLER                  PIC  X(03) VALUE '053'.
  2207     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2208     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2209     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2210     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2211
  2212*****REMAINING 6 ARE NOT CURRENTLY USED
  2213     12  FILLER                  PIC  X(03) VALUE '054'.
  2214     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2215     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2216     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2217     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2218
  2219     12  FILLER                  PIC  X(03) VALUE '055'.
  2220     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2221     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2222     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2223     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2224
  2225     12  FILLER                  PIC  X(03) VALUE '056'.
  2226     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2227     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2228     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2229     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2230
  2231     12  FILLER                  PIC  X(03) VALUE '057'.
  2232     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2233     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2234     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2235     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2236
  2237     12  FILLER                  PIC  X(03) VALUE '058'.
  2238     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2239     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2240     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2241     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2242
  2243     12  FILLER                  PIC  X(03) VALUE '059'.
  2244     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2245     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2246     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2247     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2248
  2249*************** NON FILE VARIABLES *****************************
  2250*****CURRENT DATE
  2251     12  FILLER                  PIC  X(03) VALUE '060'.
  2252     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2253     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2254     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2255     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2256
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  44
* EL689.cbl
  2257*****FULL CURRENT DATE
  2258     12  FILLER                  PIC  X(03) VALUE '061'.
  2259     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2260     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2261     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2262     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2263
  2264*****FORM
  2265     12  FILLER                  PIC  X(03) VALUE '062'.
  2266     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2267     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2268     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2269     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2270
  2271*****VARIABLE 1
  2272     12  FILLER                  PIC  X(03) VALUE '063'.
  2273     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2274     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2275     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2276     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2277
  2278*****VARIABLE 2
  2279     12  FILLER                  PIC  X(03) VALUE '064'.
  2280     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2281     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2282     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2283     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2284
  2285*****VARIABLE 3
  2286     12  FILLER                  PIC  X(03) VALUE '065'.
  2287     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2288     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2289     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2290     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2291
  2292*****VARIABLE 4
  2293     12  FILLER                  PIC  X(03) VALUE '066'.
  2294     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2295     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2296     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2297     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2298
  2299*****REMAINING 3 ARE NOT CURRENTLY USED
  2300     12  FILLER                  PIC  X(03) VALUE '067'.
  2301     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2302     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2303     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2304     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2305
  2306     12  FILLER                  PIC  X(03) VALUE '068'.
  2307     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2308     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2309     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2310     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2311
  2312     12  FILLER                  PIC  X(03) VALUE '069'.
  2313     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2314     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  45
* EL689.cbl
  2315     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2316     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2317
  2318************** CERTIFICATE VARIABLES - ELCERT *****************
  2319*****CARRIER CODE IN CERT
  2320     12  FILLER                  PIC  X(03) VALUE '070'.
  2321     12  FILLER                  PIC S9(04) COMP VALUE +1.
  2322     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2323     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2324     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2325
  2326*****GROUPING CODE IN CERT
  2327     12  FILLER                  PIC  X(03) VALUE '071'.
  2328     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2329     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2330     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2331     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2332
  2333*****ACCOUNT NUMBER IN CERT
  2334     12  FILLER                  PIC  X(03) VALUE '072'.
  2335     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2336     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2337     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2338     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2339
  2340*****CERTIFICATE NUMBER
  2341     12  FILLER                  PIC  X(03) VALUE '073'.
  2342     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2343     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2344     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2345     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2346
  2347*****CERT EFFECTIVE DATE
  2348     12  FILLER                  PIC  X(03) VALUE '074'.
  2349     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2350     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2351     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2352     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2353
  2354*****CERT EXPIRATION DATE (LIFE)
  2355     12  FILLER                  PIC  X(03) VALUE '075'.
  2356     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2357     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2358     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2359     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2360
  2361*****CERT EXPIRATION DATE (AH)
  2362     12  FILLER                  PIC  X(03) VALUE '076'.
  2363     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2364     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2365     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2366     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2367
  2368*****LIFE TERM
  2369     12  FILLER                  PIC  X(03) VALUE '077'.
  2370     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2371     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2372     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  46
* EL689.cbl
  2373     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2374
  2375*****AH  TERM
  2376     12  FILLER                  PIC  X(03) VALUE '078'.
  2377     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2378     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2379     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2380     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2381
  2382*****LIFE COVERAGE AMOUNT
  2383     12  FILLER                  PIC  X(03) VALUE '079'.
  2384     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2385     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2386     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2387     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2388
  2389*****AH MONTHLY BENEFIT
  2390     12  FILLER                  PIC  X(03) VALUE '080'.
  2391     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2392     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2393     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2394     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2395
  2396*****LIFE CANCEL DATE
  2397     12  FILLER                  PIC  X(03) VALUE '081'.
  2398     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2399     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2400     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2401     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2402
  2403*****AH CANCEL DATE
  2404     12  FILLER                  PIC  X(03) VALUE '082'.
  2405     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2406     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2407     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2408     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2409
  2410*****LIFE COVERAGE FORM NUMBER
  2411     12  FILLER                  PIC  X(03) VALUE '083'.
  2412     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2413     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2414     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2415     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2416
  2417*****UNUSED
  2418     12  FILLER                  PIC  X(03) VALUE '084'.
  2419     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2420     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2421     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2422     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2423
  2424*****INSUREDS AGE AT POLICY ISSUE (NOT USED)
  2425     12  FILLER                  PIC  X(03) VALUE '085'.
  2426     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2427     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2428     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2429     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2430
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  47
* EL689.cbl
  2431*****LOAN NUMBER
  2432     12  FILLER                  PIC  X(03) VALUE '086'.
  2433     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2434     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2435     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2436     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2437
  2438*****LOAN BALANCE
  2439     12  FILLER                  PIC  X(03) VALUE '087'.
  2440     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2441     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2442     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2443     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2444
  2445*****MEMBER NUMBER
  2446     12  FILLER                  PIC  X(03) VALUE '088'.
  2447     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2448     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2449     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2450     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2451
  2452*****INSURED SOC SEC NUMBER
  2453     12  FILLER                  PIC  X(03) VALUE '089'.
  2454     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2455     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2456     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2457     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2458
  2459*****INSURED INITIALS & LAST NAME (CERTIFICATE)
  2460     12  FILLER                  PIC  X(03) VALUE '090'.
  2461     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2462     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2463     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2464     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2465
  2466*****INSURED FIRST NAME (CERTIFICATE)
  2467     12  FILLER                  PIC  X(03) VALUE '091'.
  2468     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2469     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2470     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2471     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2472
  2473*****INSURED MIDDLE INITIAL (CERTIFICATE)
  2474     12  FILLER                  PIC  X(03) VALUE '092'.
  2475     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2476     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2477     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2478     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2479
  2480*****ORIG TERM * MON BEN
  2481     12  FILLER                  PIC  X(03) VALUE '093'.
  2482     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2483     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2484     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2485     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2486
  2487*****INSURED'S NAME (LAST, FIRST, INIT)
  2488     12  FILLER                  PIC  X(03) VALUE '094'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  48
* EL689.cbl
  2489     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2490     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2491     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2492     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2493
  2494*****INSURED'S NAME (FIRST, INIT, LAST)
  2495     12  FILLER                  PIC  X(03) VALUE  '095'.
  2496     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2497     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2498     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2499     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2500
  2501*****TITLE (MR/MS)
  2502     12  FILLER                  PIC  X(03) VALUE '096'.
  2503     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2504     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2505     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2506     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2507
  2508*****LIFE PREMIUM (CERTIFICATE)
  2509     12  FILLER                  PIC  X(03) VALUE '097'.
  2510     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2511     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2512     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2513     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2514
  2515*****A/H PREMIUM (CERTIFICATE)
  2516     12  FILLER                  PIC  X(03) VALUE '098'.
  2517     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2518     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2519     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2520     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2521
  2522*****JOINT'S INITIALS & LAST NAME (CERTIFICATE)
  2523     12  FILLER                  PIC  X(03) VALUE '099'.
  2524     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2525     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2526     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2527     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2528
  2529*****JOINT'S FIRST NAME (CERTIFICATE)
  2530     12  FILLER                  PIC  X(03) VALUE '100'.
  2531     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2532     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2533     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2534     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2535
  2536*****JOINT'S MIDDLE INITIAL (CERTIFICATE)
  2537     12  FILLER                  PIC  X(03) VALUE '101'.
  2538     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2539     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2540     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2541     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2542
  2543*****JOINT'S NAME (LAST, FIRST, INIT)
  2544     12  FILLER                  PIC  X(03) VALUE '102'.
  2545     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2546     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  49
* EL689.cbl
  2547     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2548     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2549
  2550*****JOINT'S NAME (FIRST, INIT, LAST)
  2551     12  FILLER                  PIC  X(03) VALUE '103'.
  2552     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2553     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2554     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2555     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2556
  2557*****INSURED'S FIRST AND LAST NAME
  2558     12  FILLER                  PIC  X(03) VALUE '104'.
  2559     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2560     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2561     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2562     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2563
  2564*****JOINT'S FIRST AND LAST NAME
  2565     12  FILLER                  PIC  X(03) VALUE '105'.
  2566     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2567     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2568     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2569     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2570
  2571*****ENTERED LIFE REFUND (CERT)
  2572     12  FILLER                  PIC  X(03) VALUE '106'.
  2573     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2574     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2575     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2576     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2577
  2578*****ENTERED A/H REFUND (CERT)
  2579     12  FILLER                  PIC  X(03) VALUE '107'.
  2580     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2581     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2582     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2583     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2584
  2585*****INSURED'S LAST NAME
  2586     12  FILLER                  PIC  X(03) VALUE '108'.
  2587     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2588     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2589     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2590     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2591
  2592*****BENEFICIARY
  2593     12  FILLER                  PIC  X(03) VALUE  '109'.
  2594     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2595     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2596     12  FILLER                  PIC  X(01) VALUE 'Y'.
  2597     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2598
  2599************** PENDING VARIABLES - ERPNDB *********************
  2600*****INSURED DATE OF BIRTH
  2601     12  FILLER                  PIC  X(03) VALUE '110'.
  2602     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2603     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2604     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  50
* EL689.cbl
  2605     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2606
  2607*****ENTERED LIFE PREMIUM (PENDING)
  2608     12  FILLER                  PIC  X(03) VALUE '111'.
  2609     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2610     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2611     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2612     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2613
  2614*****ENTERED A/H PREMIUM (PENDING)
  2615     12  FILLER                  PIC  X(03) VALUE '112'.
  2616     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2617     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2618     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2619     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2620
  2621*****CALCULATED LIFE PREMIUM (PENDING)
  2622     12  FILLER                  PIC  X(03) VALUE '113'.
  2623     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2624     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2625     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2626     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2627
  2628*****CALCULATED A/H PREMIUM (PENDING)
  2629     12  FILLER                  PIC  X(03) VALUE '114'.
  2630     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2631     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2632     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2633     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2634
  2635*****DIFFERENCE ENTER/COMPUTED LIFE PREMIUM (PENDING)
  2636     12  FILLER                  PIC  X(03) VALUE '115'.
  2637     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2638     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2639     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2640     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2641
  2642*****DIFFERENCE ENTER/COMPUTED A/H PREMIUM (PENDING)
  2643     12  FILLER                  PIC  X(03) VALUE '116'.
  2644     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2645     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2646     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2647     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2648
  2649*****PRIOR CANCEL DATE
  2650     12  FILLER                  PIC  X(03) VALUE '117'.
  2651     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2652     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2653     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2654     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2655
  2656*****ENTERED LIFE REFUND (PENDING)
  2657     12  FILLER                  PIC  X(03) VALUE '118'.
  2658     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2659     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2660     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2661     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2662
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  51
* EL689.cbl
  2663*****ENTERED A/H REFUND (PENDING)
  2664     12  FILLER                  PIC  X(03) VALUE '119'.
  2665     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2666     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2667     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2668     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2669
  2670*****CALCULATED LIFE REFUND (PENDING)
  2671     12  FILLER                  PIC  X(03) VALUE '120'.
  2672     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2673     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2674     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2675     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2676
  2677*****CALCULATED A/H REFUND (PENDING)
  2678     12  FILLER                  PIC  X(03) VALUE '121'.
  2679     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2680     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2681     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2682     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2683
  2684*****DIFFERENCE ENTER/COMPUTED LIFE REFUND (PENDING)
  2685     12  FILLER                  PIC  X(03) VALUE '122'.
  2686     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2687     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2688     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2689     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2690
  2691*****DIFFERENCE ENTER/COMPUTED A/H REFUND (PENDING)
  2692     12  FILLER                  PIC  X(03) VALUE '123'.
  2693     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2694     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2695     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2696     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2697
  2698*****INSUREDS AGE
  2699     12  FILLER                  PIC  X(03) VALUE '124'.
  2700     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2701     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2702     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2703     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2704
  2705*****LIFE BENEFIT (PENDING)
  2706     12  FILLER                  PIC  X(03) VALUE '125'.
  2707     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2708     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2709     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2710     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2711
  2712*****A/H BENEFIT (PENDING)
  2713     12  FILLER                  PIC  X(03) VALUE '126'.
  2714     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2715     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2716     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2717     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2718
  2719*****LIFE RATE
  2720     12  FILLER                  PIC  X(03) VALUE '127'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  52
* EL689.cbl
  2721     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2722     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2723     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2724     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2725
  2726*****A/H RATE
  2727     12  FILLER                  PIC  X(03) VALUE '128'.
  2728     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2729     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2730     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2731     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2732
  2733*****TERM (PENDING)
  2734     12  FILLER                  PIC  X(03) VALUE '129'.
  2735     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2736     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2737     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2738     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2739
  2740*****BATCH NUMBER
  2741     12  FILLER                  PIC  X(03) VALUE '130'.
  2742     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2743     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2744     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2745     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2746
  2747*****TOTAL OF LIFE AND A&H REFUND
  2748     12  FILLER                  PIC  X(03) VALUE '131'.
  2749     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2750     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2751     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2752     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2753
  2754*****NH INTEREST ON REFUNDS
  2755     12  FILLER                  PIC  X(03) VALUE '132'.
  2756     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2757     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2758     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2759     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2760*****GREATER OF THE LIFE AND AH CANCEL DATE
  2761     12  FILLER                  PIC  X(03) VALUE '133'.
  2762     12  FILLER                  PIC S9(04) COMP VALUE +8.
  2763     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2764     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2765     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2766
  2767*****THE NEXT 6 NOT CURRENTLY USED
  2768     12  FILLER                  PIC  X(03) VALUE '134'.
  2769     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2770     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2771     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2772     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2773
  2774     12  FILLER                  PIC  X(03) VALUE '135'.
  2775     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2776     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2777     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2778     12  FILLER                  PIC S9(04) COMP VALUE +09.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  53
* EL689.cbl
  2779
  2780     12  FILLER                  PIC  X(03) VALUE '136'.
  2781     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2782     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2783     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2784     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2785
  2786     12  FILLER                  PIC  X(03) VALUE '137'.
  2787     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2788     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2789     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2790     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2791
  2792     12  FILLER                  PIC  X(03) VALUE '138'.
  2793     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2794     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2795     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2796     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2797
  2798     12  FILLER                  PIC  X(03) VALUE '139'.
  2799     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2800     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2801     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2802     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2803
  2804************** COMPENSATION VARIABLES - ERCOMP ****************
  2805*****COMPENSATION ACCT NAME
  2806     12  FILLER                  PIC  X(03) VALUE '140'.
  2807     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2808     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2809     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2810     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2811
  2812*****FULL COMPENSATION ADDRESS TYPE 'A'
  2813     12  FILLER                  PIC  X(03) VALUE '141'.
  2814     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2815     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2816     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2817     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2818
  2819     12  FILLER                  PIC  X(03) VALUE '142'.
  2820     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2821     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2822     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2823     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2824
  2825     12  FILLER                  PIC  X(03) VALUE '143'.
  2826     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2827     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2828     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2829     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2830
  2831     12  FILLER                  PIC  X(03) VALUE '144'.
  2832     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2833     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2834     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2835     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2836
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  54
* EL689.cbl
  2837     12  FILLER                  PIC  X(03) VALUE '145'.
  2838     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2839     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2840     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2841     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2842
  2843     12  FILLER                  PIC  X(03) VALUE '146'.
  2844     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2845     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2846     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2847     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2848
  2849*****COMPENSATION PHONE NUMBER
  2850     12  FILLER                  PIC  X(03) VALUE '147'.
  2851     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2852     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2853     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2854     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2855
  2856*****COMPENSATION CSR NAME
  2857     12  FILLER                  PIC  X(03) VALUE '148'.
  2858     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2859     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2860     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2861     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2862
  2863*****COMPENSATION LAST STATEMENT DATE
  2864     12  FILLER                  PIC  X(03) VALUE '149'.
  2865     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2866     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2867     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2868     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2869
  2870*****COMPENSATION ENDING BALANCE
  2871     12  FILLER                  PIC  X(03) VALUE '150'.
  2872     12  FILLER                  PIC S9(04) COMP VALUE +14.
  2873     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2874     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2875     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2876
  2877******************  PROCESSOR DATA - ELCNTL (2) ****************
  2878*****EXECUTING PROCESSOR NAME
  2879     12  FILLER                  PIC  X(03) VALUE '151'.
  2880     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2881     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2882     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2883     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2884
  2885*****PROCESSOR TITLE
  2886     12  FILLER                  PIC  X(03) VALUE '152'.
  2887     12  FILLER                  PIC S9(04) COMP VALUE +26.
  2888     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2889     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2890     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2891
  2892*****PROCESSOR
  2893     12  FILLER                  PIC  X(03) VALUE '153'.
  2894     12  FILLER                  PIC S9(04) COMP VALUE +04.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  55
* EL689.cbl
  2895     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2896     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2897     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2898
  2899*****CSR TITLE
  2900     12  FILLER                  PIC  X(03) VALUE '154'.
  2901     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2902     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2903     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2904     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2905*****REMAINING 2 ARE NOT CURRENTLY USED
  2906     12  FILLER                  PIC  X(03) VALUE '155'.
  2907     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2908     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2909     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2910     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2911
  2912     12  FILLER                  PIC  X(03) VALUE '156'.
  2913     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2914     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2915     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2916     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2917
  2918******************  CHECK DATA - ERCHEK    *********************
  2919*****CHECK AMOUNT
  2920     12  FILLER                  PIC  X(03) VALUE '157'.
  2921     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2922     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2923     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2924     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2925
  2926*****CHECK NUMBER
  2927     12  FILLER                  PIC  X(03) VALUE '158'.
  2928     12  FILLER                  PIC S9(04) COMP VALUE +7.
  2929     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2930     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2931     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2932
  2933*****PAYEE 1 NAME
  2934     12  FILLER                  PIC  X(03) VALUE '159'.
  2935     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2936     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2937     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2938     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2939
  2940*****PAYEE 2 NAME
  2941     12  FILLER                  PIC  X(03) VALUE '160'.
  2942     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2943     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2944     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2945     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2946
  2947*****ADDRSS 1
  2948     12  FILLER                  PIC  X(03) VALUE '161'.
  2949     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2950     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2951     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2952     12  FILLER                  PIC S9(04) COMP VALUE +12.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  56
* EL689.cbl
  2953
  2954*****ADDRESS 2
  2955     12  FILLER                  PIC  X(03) VALUE '162'.
  2956     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2957     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2958     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2959     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2960
  2961*****PAYEE CITY STATE
  2962     12  FILLER                  PIC  X(03) VALUE '163'.
  2963     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2964     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2965     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2966     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2967
  2968*****ZIP CODE
  2969     12  FILLER                  PIC  X(03) VALUE '164'.
  2970     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2971     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2972     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2973     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2974
  2975*****CHECK CONTROL
  2976     12  FILLER                  PIC  X(03) VALUE '165'.
  2977     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2978     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2979     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2980     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2981
  2982*****REASON FOR CHECK
  2983     12  FILLER                  PIC  X(03) VALUE '166'.
  2984     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2985     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2986     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2987     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2988
  2989*****REMAINING 3 ARE NOT CURRENTLY USED
  2990     12  FILLER                  PIC  X(03) VALUE '167'.
  2991     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2992     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2993     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2994     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2995
  2996     12  FILLER                  PIC  X(03) VALUE '168'.
  2997     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2998     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2999     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3000     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3001
  3002     12  FILLER                  PIC  X(03) VALUE '169'.
  3003     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3004     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3005     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3006     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3007
  3008
  3009*********** PAYMENT AND ADJUSTMENT DATA - ERPYAJ  **************
  3010*****CHECK AMOUNT - PYAJ
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  57
* EL689.cbl
  3011     12  FILLER                  PIC  X(03) VALUE '170'.
  3012     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3013     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3014     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3015     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3016
  3017*****CHECK NUMBER - PYAJ
  3018     12  FILLER                  PIC  X(03) VALUE '171'.
  3019     12  FILLER                  PIC S9(04) COMP VALUE +7.
  3020     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3021     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3022     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3023
  3024*****CHECK CONTROL - PYAJ
  3025     12  FILLER                  PIC  X(03) VALUE '172'.
  3026     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3027     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3028     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3029     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3030
  3031***** COMMENT - PYAJ
  3032     12  FILLER                  PIC  X(03) VALUE '173'.
  3033     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3034     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3035     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3036     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3037
  3038*****NEW FIELDS.
  3039*****COMPENSATION FULL ADDRESS TYPE 'G'
  3040     12  FILLER                  PIC  X(03) VALUE '174'.
  3041     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3042     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3043     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3044     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3045
  3046     12  FILLER                  PIC  X(03) VALUE '175'.
  3047     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3048     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3049     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3050     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3051
  3052     12  FILLER                  PIC  X(03) VALUE '176'.
  3053     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3054     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3055     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3056     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3057
  3058     12  FILLER                  PIC  X(03) VALUE '177'.
  3059     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3060     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3061     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3062     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3063
  3064     12  FILLER                  PIC  X(03) VALUE '178'.
  3065     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3066     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3067     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3068     12  FILLER                  PIC S9(04) COMP VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  58
* EL689.cbl
  3069
  3070     12  FILLER                  PIC  X(03) VALUE '179'.
  3071     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3072     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3073     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3074     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3075
  3076*****COMPENSATION FINANCIAL RESPONSIBLE NO.
  3077     12  FILLER                  PIC  X(03) VALUE '180'.
  3078     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3079     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3080     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3081     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3082**** COMPENSATION BILLING SWITCH
  3083     12  FILLER                  PIC XXX    VALUE '181'.
  3084     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3085     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3086     12  FILLER                  PIC X      VALUE ALL 'N'.
  3087     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3088*****COMPENSATION FAX NUMBER
  3089     12  FILLER                  PIC  X(03) VALUE '182'.
  3090     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3091     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3092     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3093     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3094**** COMPENSATION STATUS
  3095     12  FILLER                  PIC XXX    VALUE '183'.
  3096     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3097     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3098     12  FILLER                  PIC X      VALUE ALL 'N'.
  3099     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3100***** THE VARS 184 - 189 WILL TYPICALLY BE USED FOR DCC BANKS
  3101*****COMPENSATION FULL ADDRESS TYPE 'B'
  3102     12  FILLER                  PIC  X(03) VALUE '184'.
  3103     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3104     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3105     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3106     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3107
  3108     12  FILLER                  PIC  X(03) VALUE '185'.
  3109     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3110     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3111     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3112     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3113
  3114     12  FILLER                  PIC  X(03) VALUE '186'.
  3115     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3116     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3117     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3118     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3119
  3120     12  FILLER                  PIC  X(03) VALUE '187'.
  3121     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3122     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3123     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3124     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3125
  3126     12  FILLER                  PIC  X(03) VALUE '188'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  59
* EL689.cbl
  3127     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3128     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3129     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3130     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3131
  3132     12  FILLER                  PIC  X(03) VALUE '189'.
  3133     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3134     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3135     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3136     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3137
  3138
  3139 01  FILLER REDEFINES W-SUPPORTED-VARIABLES.
  3140*    12  W-VARIABLE-GRP OCCURS 180 TIMES
  3141     12  W-VARIABLE-GRP OCCURS 189 TIMES
  3142                        INDEXED BY W-VG-NDX.
  3143         16  W-VARIABLE-ID         PIC  X(03).
  3144         16  W-VARIABLE-SIZE       PIC S9(04) COMP.
  3145         16  W-VG-TEXT.
  3146             20  W-VAR-CHAR
  3147                        OCCURS 30 TIMES
  3148                        INDEXED BY W-VC-NDX
  3149                                   PIC  X(01).
  3150         16  W-VARIABLE-UPLOW-IND  PIC  X(01).
  3151             88  W-USE-UPPER-AND-LOWER-CASE VALUE 'Y'.
  3152
  3153         16  W-VARIABLE-SOURCE   PIC S9(04) COMP.
  3154
  3155 01  W-VAR-END                   PIC  X(23)
  3156                        VALUE ':VARIABLE WORK AREA END'.
  3157
  3158 01  W-PROGRAM-TABLE-AREA.
  3159     12  FILLER                  PIC  X(15)
  3160                                 VALUE 'PROGRAM TABLES:'.
  3161
  3162     12  W-RECORD-TABLE              VALUE SPACES.
  3163         16  W-RC-GRP OCCURS 500 TIMES
  3164                       INDEXED BY W-RG-NDX
  3165                                  W-RG-NDX1.
  3166             20  W-RC-TEXT.
  3167                 24  W-RC-CHAR OCCURS 70 TIMES
  3168                                INDEXED BY W-RC-NDX
  3169                                           W-RC-NDX1
  3170                                 PIC  X(01).
  3171             20  W-RC-PC         PIC  9(02).
  3172             20  W-RC-SC         PIC  X(01).
  3173
  3174     12  FILLER REDEFINES W-RECORD-TABLE.
  3175         16  W-REC-CHAR OCCURS 36500 TIMES
  3176                        INDEXED BY W-RVS-NDX
  3177                                   W-RVS-NDX2
  3178                                 PIC  X(01).
  3179     12  FILLER REDEFINES W-RECORD-TABLE.
  3180         16  W-TS-GROUP OCCURS 10 TIMES
  3181                        INDEXED BY W-TS-NDX
  3182                                 PIC X(3650).
  3183
  3184     12  FILLER                  PIC  X(11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  60
* EL689.cbl
  3185                                 VALUE 'TEXT TABLE:'.
  3186     12  W-TX-TABLE                  VALUE SPACES.
  3187         16  W-TX-GRP OCCURS 500 TIMES
  3188                       INDEXED BY W-TG-NDX
  3189                                  W-TG-NDX2.
  3190             20  W-TX-TEXT.
  3191                 24  W-TX-CHAR OCCURS 70 TIMES
  3192                                    INDEXED BY W-TX-NDX
  3193                                               W-TX-NDX1
  3194                                               W-TX-NDX2
  3195                                 PIC  X(01).
  3196             20  W-TX-PC         PIC  9(02).
  3197             20  W-TX-SC         PIC  X(01).
  3198
  3199     12  FILLER                  PIC  X(11)
  3200                                 VALUE 'FILE TABLE:'.
  3201     12  W-FILE-TABLE                VALUE SPACES.
  3202         16  W-FILE-USE-IND OCCURS 20 TIMES
  3203                       INDEXED BY W-FILE-NDX
  3204                                 PIC  X(01).
  3205             88  W-FILE-NOT-USED     VALUE SPACE.
  3206             88  W-FILE-USED         VALUE 'Y'.
  3207
  3208     12  FILLER                  PIC  X(14)
  3209                                 VALUE 'END OF TABLES:'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  61
* EL689.cbl
  3211 01  ERROR-MESSAGES.
  3212     12  ER-0000                 PIC  X(04) VALUE '0000'.
  3213     12  ER-0004                 PIC  X(04) VALUE '0004'.
  3214     12  ER-0006                 PIC  X(04) VALUE '0006'.
  3215     12  ER-0008                 PIC  X(04) VALUE '0008'.
  3216     12  ER-0013                 PIC  X(04) VALUE '0013'.
  3217     12  ER-0023                 PIC  X(04) VALUE '0023'.
  3218     12  ER-0029                 PIC  X(04) VALUE '0029'.
  3219     12  ER-0033                 PIC  X(04) VALUE '0033'.
  3220     12  ER-0042                 PIC  X(04) VALUE '0042'.
  3221     12  ER-0047                 PIC  X(04) VALUE '0047'.
  3222     12  ER-0051                 PIC  X(04) VALUE '0051'.
  3223     12  ER-0066                 PIC  X(04) VALUE '0066'.
  3224     12  ER-0067                 PIC  X(04) VALUE '0067'.
  3225     12  ER-0070                 PIC  X(04) VALUE '0070'.
  3226     12  ER-0168                 PIC  X(04) VALUE '0168'.
  3227     12  ER-0169                 PIC  X(04) VALUE '0169'.
  3228     12  ER-0174                 PIC  X(04) VALUE '0174'.
  3229     12  ER-0175                 PIC  X(04) VALUE '0175'.
  3230     12  ER-0176                 PIC  X(04) VALUE '0176'.
  3231     12  ER-0177                 PIC  X(04) VALUE '0177'.
  3232     12  ER-0179                 PIC  X(04) VALUE '0179'.
  3233     12  ER-0180                 PIC  X(04) VALUE '0180'.
  3234     12  ER-0181                 PIC  X(04) VALUE '0181'.
  3235     12  ER-0182                 PIC  X(04) VALUE '0182'.
  3236     12  ER-0184                 PIC  X(04) VALUE '0184'.
  3237     12  ER-0185                 PIC  X(04) VALUE '0185'.
  3238     12  ER-0187                 PIC  X(04) VALUE '0187'.
  3239     12  ER-0188                 PIC  X(04) VALUE '0188'.
  3240     12  ER-0189                 PIC  X(04) VALUE '0189'.
  3241     12  ER-0190                 PIC  X(04) VALUE '0190'.
  3242     12  ER-0191                 PIC  X(04) VALUE '0191'.
  3243     12  ER-0215                 PIC  X(04) VALUE '0215'.
  3244     12  ER-0279                 PIC  X(04) VALUE '0279'.
  3245     12  ER-0280                 PIC  X(04) VALUE '0280'.
  3246     12  ER-0412                 PIC  X(04) VALUE '0412'.
  3247     12  ER-0413                 PIC  X(04) VALUE '0413'.
  3248     12  ER-0454                 PIC  X(04) VALUE '0454'.
  3249     12  ER-0533                 PIC  X(04) VALUE '0533'.
  3250     12  ER-0537                 PIC  X(04) VALUE '0537'.
  3251     12  ER-0715                 PIC  X(04) VALUE '0715'.
  3252     12  ER-0894                 PIC  X(04) VALUE '0894'.
  3253     12  ER-1560                 PIC  X(04) VALUE '1560'.
  3254     12  ER-1565                 PIC  X(04) VALUE '1565'.
  3255     12  ER-1778                 PIC  X(04) VALUE '1778'.
  3256     12  ER-1818                 PIC  X(04) VALUE '1818'.
  3257     12  ER-2055                 PIC  X(04) VALUE '2055'.
  3258     12  ER-2114                 PIC  X(04) VALUE '2114'.
  3259     12  ER-2208                 PIC  X(04) VALUE '2208'.
  3260     12  ER-2209                 PIC  X(04) VALUE '2209'.
  3261     12  ER-2216                 PIC  X(04) VALUE '2216'.
  3262     12  ER-2232                 PIC  X(04) VALUE '2232'.
  3263     12  ER-2369                 PIC  X(04) VALUE '2369'.
  3264     12  ER-2398                 PIC  X(04) VALUE '2398'.
  3265     12  ER-2433                 PIC  X(04) VALUE '2433'.
  3266     12  ER-2908                 PIC  X(04) VALUE '2908'.
  3267     12  ER-2999                 PIC  X(04) VALUE '2999'.
  3268     12  ER-3000                 PIC  X(04) VALUE '3000'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  62
* EL689.cbl
  3269     12  ER-3770                 PIC  X(04) VALUE '3770'.
  3270     12  ER-3771                 PIC  X(04) VALUE '3771'.
  3271     12  ER-3775                 PIC  X(04) VALUE '3775'.
  3272     12  ER-3783                 PIC  X(04) VALUE '3783'.
  3273     12  ER-7243                 PIC  X(04) VALUE '7243'.
  3274     12  ER-7245                 PIC  X(04) VALUE '7245'.
  3275     12  ER-7246                 PIC  X(04) VALUE '7246'.
  3276     12  ER-7247                 PIC  X(04) VALUE '7247'.
  3277     12  ER-7250                 PIC  X(04) VALUE '7250'.
  3278     12  ER-7365                 PIC  X(04) VALUE '7365'.
  3279     12  ER-7367                 PIC  X(04) VALUE '7367'.
  3280     12  ER-7368                 PIC  X(04) VALUE '7368'.
  3281     12  ER-7369                 PIC  X(04) VALUE '7369'.
  3282     12  ER-7370                 PIC  X(04) VALUE '7370'.
  3283     12  ER-7371                 PIC  X(04) VALUE '7371'.
  3284     12  ER-7372                 PIC  X(04) VALUE '7372'.
  3285     12  ER-7373                 PIC  X(04) VALUE '7373'.
  3286     12  ER-7374                 PIC  X(04) VALUE '7374'.
  3287     12  ER-7376                 PIC  X(04) VALUE '7376'.
  3288     12  ER-7377                 PIC  X(04) VALUE '7377'.
  3289     12  ER-7378                 PIC  X(04) VALUE '7378'.
  3290     12  ER-7379                 PIC  X(04) VALUE '7379'.
  3291     12  ER-7381                 PIC  X(04) VALUE '7381'.
  3292     12  ER-7388                 PIC  X(04) VALUE '7388'.
  3293     12  ER-7390                 PIC  X(04) VALUE '7390'.
  3294     12  ER-7393                 PIC  X(04) VALUE '7393'.
  3295     12  ER-7395                 PIC  X(04) VALUE '7395'.
  3296     12  ER-7396                 PIC  X(04) VALUE '7396'.
  3297     12  ER-7398                 PIC  X(04) VALUE '7398'.
  3298     12  ER-8965                 PIC  X(04) VALUE '8965'.
  3299     12  ER-9095                 PIC  X(04) VALUE '9095'.
  3300     12  ER-9097                 PIC  X(04) VALUE '9097'.
  3301     12  ER-9281                 PIC  X(04) VALUE '9281'.
  3302     12  ER-9283                 PIC  X(04) VALUE '9283'.
  3303     12  ER-9298                 PIC  X(04) VALUE '9298'.
  3304     12  ER-9299                 PIC  X(04) VALUE '9299'.
  3305     12  ER-9320                 PIC  X(04) VALUE '9320'.
  3306     12  ER-9327                 PIC  X(04) VALUE '9327'.
  3307     12  ER-9426                 PIC  X(04) VALUE '9426'.
  3308     12  ER-9427                 PIC  X(04) VALUE '9427'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  63
* EL689.cbl
  3310*    COPY ELCAID.
  3311******************************************************************
  3312*                                                                *
  3313*                            ELCAID.                             *
  3314*                            VMOD=2.001                          *
  3315*                                                                *
  3316*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3317*                                                                *
  3318*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3319*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3320******************************************************************
  3321
  3322 01  DFHAID.
  3323   02  DFHNULL   PIC  X  VALUE  ' '.
  3324   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3325   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3326   02  DFHPEN    PIC  X  VALUE  '='.
  3327   02  DFHOPID   PIC  X  VALUE  'W'.
  3328   02  DFHPA1    PIC  X  VALUE  '%'.
  3329   02  DFHPA2    PIC  X  VALUE  '>'.
  3330   02  DFHPA3    PIC  X  VALUE  ','.
  3331   02  DFHPF1    PIC  X  VALUE  '1'.
  3332   02  DFHPF2    PIC  X  VALUE  '2'.
  3333   02  DFHPF3    PIC  X  VALUE  '3'.
  3334   02  DFHPF4    PIC  X  VALUE  '4'.
  3335   02  DFHPF5    PIC  X  VALUE  '5'.
  3336   02  DFHPF6    PIC  X  VALUE  '6'.
  3337   02  DFHPF7    PIC  X  VALUE  '7'.
  3338   02  DFHPF8    PIC  X  VALUE  '8'.
  3339   02  DFHPF9    PIC  X  VALUE  '9'.
  3340   02  DFHPF10   PIC  X  VALUE  ':'.
  3341   02  DFHPF11   PIC  X  VALUE  '#'.
  3342   02  DFHPF12   PIC  X  VALUE  '@'.
  3343   02  DFHPF13   PIC  X  VALUE  'A'.
  3344   02  DFHPF14   PIC  X  VALUE  'B'.
  3345   02  DFHPF15   PIC  X  VALUE  'C'.
  3346   02  DFHPF16   PIC  X  VALUE  'D'.
  3347   02  DFHPF17   PIC  X  VALUE  'E'.
  3348   02  DFHPF18   PIC  X  VALUE  'F'.
  3349   02  DFHPF19   PIC  X  VALUE  'G'.
  3350   02  DFHPF20   PIC  X  VALUE  'H'.
  3351   02  DFHPF21   PIC  X  VALUE  'I'.
  3352*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3353   02  DFHPF22   PIC  X  VALUE  '['.
  3354   02  DFHPF23   PIC  X  VALUE  '.'.
  3355   02  DFHPF24   PIC  X  VALUE  '<'.
  3356   02  DFHMSRE   PIC  X  VALUE  'X'.
  3357   02  DFHSTRF   PIC  X  VALUE  'h'.
  3358   02  DFHTRIG   PIC  X  VALUE  '"'.
  3359 01  FILLER    REDEFINES DFHAID.
  3360     12  FILLER                  PIC  X(08).
  3361     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  64
* EL689.cbl
  3363*    COPY ELCATTR.
  3364******************************************************************
  3365*                                                                *
  3366*                            ELCATTR.                            *
  3367*                            VMOD=2.001                          *
  3368*                                                                *
  3369*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  3370*                                                                *
  3371*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  3372*                                                                *
  3373*                   POS 1   P=PROTECTED                          *
  3374*                           U=UNPROTECTED                        *
  3375*                           S=ASKIP                              *
  3376*                   POS 2   A=ALPHA/NUMERIC                      *
  3377*                           N=NUMERIC                            *
  3378*                   POS 3   N=NORMAL                             *
  3379*                           B=BRIGHT                             *
  3380*                           D=DARK                               *
  3381*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  3382*                           OF=MODIFIED DATA TAG OFF             *
  3383*                                                                *
  3384*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  3385******************************************************************
  3386 01  ATTRIBUTE-LIST.
  3387     12  AL-PABOF            PIC X       VALUE 'Y'.
  3388     12  AL-PABON            PIC X       VALUE 'Z'.
  3389     12  AL-PADOF            PIC X       VALUE '%'.
  3390     12  AL-PADON            PIC X       VALUE '_'.
  3391     12  AL-PANOF            PIC X       VALUE '-'.
  3392     12  AL-PANON            PIC X       VALUE '/'.
  3393     12  AL-SABOF            PIC X       VALUE '8'.
  3394     12  AL-SABON            PIC X       VALUE '9'.
  3395     12  AL-SADOF            PIC X       VALUE '@'.
  3396     12  AL-SADON            PIC X       VALUE QUOTE.
  3397     12  AL-SANOF            PIC X       VALUE '0'.
  3398     12  AL-SANON            PIC X       VALUE '1'.
  3399     12  AL-UABOF            PIC X       VALUE 'H'.
  3400     12  AL-UABON            PIC X       VALUE 'I'.
  3401     12  AL-UADOF            PIC X       VALUE '<'.
  3402     12  AL-UADON            PIC X       VALUE '('.
  3403     12  AL-UANOF            PIC X       VALUE ' '.
  3404     12  AL-UANON            PIC X       VALUE 'A'.
  3405     12  AL-UNBOF            PIC X       VALUE 'Q'.
  3406     12  AL-UNBON            PIC X       VALUE 'R'.
  3407     12  AL-UNDOF            PIC X       VALUE '*'.
  3408     12  AL-UNDON            PIC X       VALUE ')'.
  3409     12  AL-UNNOF            PIC X       VALUE '&'.
  3410     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  65
* EL689.cbl
  3412*    COPY ELCDATE.
  3413******************************************************************
  3414*                                                                *
  3415*                                                                *
  3416*                            ELCDATE.                            *
  3417*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3418*                            VMOD=2.003
  3419*                                                                *
  3420*                                                                *
  3421*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3422*                 LENGTH = 200                                   *
  3423******************************************************************
  3424
  3425 01  DATE-CONVERSION-DATA.
  3426     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3427     12  DC-OPTION-CODE                PIC X.
  3428         88  BIN-TO-GREG                VALUE ' '.
  3429         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3430         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3431         88  YMD-GREG-TO-BIN            VALUE '3'.
  3432         88  MDY-GREG-TO-BIN            VALUE '4'.
  3433         88  JULIAN-TO-BIN              VALUE '5'.
  3434         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3435         88  FIND-CENTURY               VALUE '7'.
  3436         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3437         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3438         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3439         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3440         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3441         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3442         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3443         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3444         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3445         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3446         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3447         88  BIN-3-TO-GREG              VALUE 'I'.
  3448         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3449         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3450         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3451         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3452         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3453         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3454         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3455         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3456         88  THREE-CHARACTER-BIN
  3457                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3458         88  GREGORIAN-TO-BIN
  3459                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3460         88  BIN-TO-GREGORIAN
  3461                  VALUES ' ' '1' 'I' '8' 'G'.
  3462         88  JULIAN-TO-BINARY
  3463                  VALUES '5' 'C' 'E' 'F'.
  3464     12  DC-ERROR-CODE                 PIC X.
  3465         88  NO-CONVERSION-ERROR        VALUE ' '.
  3466         88  DATE-CONVERSION-ERROR
  3467                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3468         88  DATE-IS-ZERO               VALUE '1'.
  3469         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  66
* EL689.cbl
  3470         88  DATE-IS-INVALID            VALUE '3'.
  3471         88  DATE1-GREATER-DATE2        VALUE '4'.
  3472         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3473         88  DATE-INVALID-OPTION        VALUE '9'.
  3474         88  INVALID-CENTURY            VALUE 'A'.
  3475         88  ONLY-CENTURY               VALUE 'B'.
  3476         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3477         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3478     12  DC-END-OF-MONTH               PIC X.
  3479         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3480     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3481         88  USE-NORMAL-PROCESS         VALUE ' '.
  3482         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3483         88  ADJUST-UP-100-YRS          VALUE '2'.
  3484     12  FILLER                        PIC X.
  3485     12  DC-CONVERSION-DATES.
  3486         16  DC-BIN-DATE-1             PIC XX.
  3487         16  DC-BIN-DATE-2             PIC XX.
  3488         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3489         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3490                       DC-GREG-DATE-1-EDIT.
  3491             20  DC-EDIT1-MONTH        PIC 99.
  3492             20  SLASH1-1              PIC X.
  3493             20  DC-EDIT1-DAY          PIC 99.
  3494             20  SLASH1-2              PIC X.
  3495             20  DC-EDIT1-YEAR         PIC 99.
  3496         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3497         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3498                     DC-GREG-DATE-2-EDIT.
  3499             20  DC-EDIT2-MONTH        PIC 99.
  3500             20  SLASH2-1              PIC X.
  3501             20  DC-EDIT2-DAY          PIC 99.
  3502             20  SLASH2-2              PIC X.
  3503             20  DC-EDIT2-YEAR         PIC 99.
  3504         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3505         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3506                     DC-GREG-DATE-1-YMD.
  3507             20  DC-YMD-YEAR           PIC 99.
  3508             20  DC-YMD-MONTH          PIC 99.
  3509             20  DC-YMD-DAY            PIC 99.
  3510         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3511         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3512                      DC-GREG-DATE-1-MDY.
  3513             20  DC-MDY-MONTH          PIC 99.
  3514             20  DC-MDY-DAY            PIC 99.
  3515             20  DC-MDY-YEAR           PIC 99.
  3516         16  DC-GREG-DATE-1-ALPHA.
  3517             20  DC-ALPHA-MONTH        PIC X(10).
  3518             20  DC-ALPHA-DAY          PIC 99.
  3519             20  FILLER                PIC XX.
  3520             20  DC-ALPHA-CENTURY.
  3521                 24 DC-ALPHA-CEN-N     PIC 99.
  3522             20  DC-ALPHA-YEAR         PIC 99.
  3523         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3524         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3525         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3526         16  DC-JULIAN-DATE            PIC 9(05).
  3527         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  67
* EL689.cbl
  3528                                       PIC 9(05).
  3529         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3530             20  DC-JULIAN-YEAR        PIC 99.
  3531             20  DC-JULIAN-DAYS        PIC 999.
  3532         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3533         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3534         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3535     12  DATE-CONVERSION-VARIBLES.
  3536         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3537         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3538             20  FILLER                PIC 9(3).
  3539             20  HOLD-CEN-1-CCYY.
  3540                 24  HOLD-CEN-1-CC     PIC 99.
  3541                 24  HOLD-CEN-1-YY     PIC 99.
  3542             20  HOLD-CEN-1-MO         PIC 99.
  3543             20  HOLD-CEN-1-DA         PIC 99.
  3544         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3545             20  HOLD-CEN-1-R-MO       PIC 99.
  3546             20  HOLD-CEN-1-R-DA       PIC 99.
  3547             20  HOLD-CEN-1-R-CCYY.
  3548                 24  HOLD-CEN-1-R-CC   PIC 99.
  3549                 24  HOLD-CEN-1-R-YY   PIC 99.
  3550             20  FILLER                PIC 9(3).
  3551         16  HOLD-CENTURY-1-X.
  3552             20  FILLER                PIC X(3)  VALUE SPACES.
  3553             20  HOLD-CEN-1-X-CCYY.
  3554                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3555                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3556             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3557             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3558         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3559             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3560             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3561             20  HOLD-CEN-1-R-X-CCYY.
  3562                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3563                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3564             20  FILLER                PIC XXX.
  3565         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3566         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3567         16  DC-JULIAN-DATE-1          PIC 9(07).
  3568         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3569             20  DC-JULIAN-1-CCYY.
  3570                 24  DC-JULIAN-1-CC    PIC 99.
  3571                 24  DC-JULIAN-1-YR    PIC 99.
  3572             20  DC-JULIAN-DA-1        PIC 999.
  3573         16  DC-JULIAN-DATE-2          PIC 9(07).
  3574         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3575             20  DC-JULIAN-2-CCYY.
  3576                 24  DC-JULIAN-2-CC    PIC 99.
  3577                 24  DC-JULIAN-2-YR    PIC 99.
  3578             20  DC-JULIAN-DA-2        PIC 999.
  3579         16  DC-GREG-DATE-A-EDIT.
  3580             20  DC-EDITA-MONTH        PIC 99.
  3581             20  SLASHA-1              PIC X VALUE '/'.
  3582             20  DC-EDITA-DAY          PIC 99.
  3583             20  SLASHA-2              PIC X VALUE '/'.
  3584             20  DC-EDITA-CCYY.
  3585                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  68
* EL689.cbl
  3586                 24  DC-EDITA-YEAR     PIC 99.
  3587         16  DC-GREG-DATE-B-EDIT.
  3588             20  DC-EDITB-MONTH        PIC 99.
  3589             20  SLASHB-1              PIC X VALUE '/'.
  3590             20  DC-EDITB-DAY          PIC 99.
  3591             20  SLASHB-2              PIC X VALUE '/'.
  3592             20  DC-EDITB-CCYY.
  3593                 24  DC-EDITB-CENT     PIC 99.
  3594                 24  DC-EDITB-YEAR     PIC 99.
  3595         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3596         16  DC-GREG-DATE-CYMD-R REDEFINES
  3597                              DC-GREG-DATE-CYMD.
  3598             20  DC-CYMD-CEN           PIC 99.
  3599             20  DC-CYMD-YEAR          PIC 99.
  3600             20  DC-CYMD-MONTH         PIC 99.
  3601             20  DC-CYMD-DAY           PIC 99.
  3602         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3603         16  DC-GREG-DATE-MDCY-R REDEFINES
  3604                              DC-GREG-DATE-MDCY.
  3605             20  DC-MDCY-MONTH         PIC 99.
  3606             20  DC-MDCY-DAY           PIC 99.
  3607             20  DC-MDCY-CEN           PIC 99.
  3608             20  DC-MDCY-YEAR          PIC 99.
  3609    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3610        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3611    12  DC-EL310-DATE                  PIC X(21).
  3612    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  69
* EL689.cbl
  3614*    COPY ELCNWA.
  3615*****************************************************************
  3616*                                                               *
  3617*                                                               *
  3618*                            ELCNWA.                            *
  3619*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3620*                            VMOD=2.003                         *
  3621*                                                               *
  3622*            M O V E   N A M E   W O R K   A R E A.             *
  3623*                                                               *
  3624*****************************************************************.
  3625
  3626 01  WS-NAME-WORK-AREA.
  3627     05  WS-INSURED-LAST-NAME        PIC X(15).
  3628     05  WS-INSURED-1ST-NAME         PIC X(12).
  3629     05  WS-INSURED-MID-INIT         PIC X.
  3630
  3631     05  WS-NAME-WORK.
  3632         10  WS-NW                   PIC X
  3633             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  3634
  3635     05  WS-NAME-WORK2.
  3636         10  WS-NW2                  PIC X
  3637             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  3638                                        NWA-INDEX0.
  3639
  3640     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  3641                                     COMP-3.
  3642
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  70
* EL689.cbl
  3644*    COPY ELCEMIB.
  3645******************************************************************
  3646*                                                                *
  3647*                                                                *
  3648*                            ELCEMIB.                            *
  3649*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3650*                            VMOD=2.005                          *
  3651*                                                                *
  3652*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  3653*                                                                *
  3654******************************************************************
  3655 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  3656     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  3657     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  3658     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  3659     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  3660     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  3661     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  3662     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  3663     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  3664     12  EMI-SWITCH1             PIC X        VALUE '1'.
  3665         88  EMI-NO-ERRORS                    VALUE '1'.
  3666         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  3667         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  3668     12  EMI-SWITCH2             PIC X        VALUE '1'.
  3669         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  3670     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  3671         88  EMI-AREA1-EMPTY                  VALUE '1'.
  3672         88  EMI-AREA1-FULL                   VALUE '2'.
  3673     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  3674         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3675         88  EMI-AREA2-FULL                   VALUE '2'.
  3676     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3677         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3678         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3679         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3680         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3681         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3682     12  EMI-ERROR-LINES.
  3683         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3684         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3685         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3686         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3687             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3688                 24  EMI-ERR-NUM         PIC X(4).
  3689                 24  EMI-FILLER          PIC X.
  3690                 24  EMI-SEV             PIC X.
  3691                 24  FILLER              PIC X.
  3692             20  FILLER                  PIC X(02).
  3693     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3694         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3695             20  EMI-ERROR-NUMBER    PIC X(4).
  3696             20  EMI-FILL            PIC X.
  3697             20  EMI-SEVERITY        PIC X.
  3698             20  FILLER              PIC X.
  3699             20  EMI-ERROR-TEXT.
  3700                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3701                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  71
* EL689.cbl
  3702     12  EMI-SEVERITY-SAVE           PIC X.
  3703         88  EMI-NOTE                    VALUE 'N'.
  3704         88  EMI-WARNING                 VALUE 'W'.
  3705         88  EMI-FORCABLE                VALUE 'F'.
  3706         88  EMI-FATAL                   VALUE 'X'.
  3707     12  EMI-MESSAGE-FLAG            PIC X.
  3708         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3709         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3710     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3711     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3712         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3713         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3714         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3715     12  FILLER                      PIC X(137)  VALUE SPACES.
  3716     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3717     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3718     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3719     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  3720 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  72
* EL689.cbl
  3722*    COPY ELCLOGOF.
  3723******************************************************************
  3724*                                                                *
  3725*                                                                *
  3726*                            ELCLOGOF.                           *
  3727*                            VMOD=2.001                          *
  3728*                                                                *
  3729*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  3730*                                                                *
  3731******************************************************************
  3732 01  CLASIC-LOGOFF.
  3733     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  3734     12  LOGOFF-TEXT.
  3735         16  FILLER          PIC X(5)    VALUE SPACES.
  3736         16  LOGOFF-MSG.
  3737             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  3738             20  FILLER      PIC X       VALUE SPACES.
  3739             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  3740         16  FILLER          PIC X(80)
  3741           VALUE '* YOU ARE NOW LOGGED OFF'.
  3742         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  3743         16  FILLER          PIC X       VALUE QUOTE.
  3744         16  LOGOFF-SYS-MSG  PIC X(17)
  3745           VALUE 'S CLAS-IC SYSTEM '.
  3746     12  TEXT-MESSAGES.
  3747         16  UNACCESS-MSG    PIC X(29)
  3748             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  3749         16  PGMIDERR-MSG    PIC X(17)
  3750             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  73
* EL689.cbl
  3752*    COPY ELCSCTM.
  3753******************************************************************
  3754*                                                                *
  3755*                                                                *
  3756*                            ELCSCTM                             *
  3757*                            VMOD=2.001                          *
  3758*                                                                *
  3759*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  3760*                                                                *
  3761******************************************************************
  3762 01  SECURITY-MESSAGE.
  3763     12  FILLER                          PIC X(30)
  3764            VALUE '** LOGIC SECURITY VIOLATION -'.
  3765     12  SM-READ                         PIC X(6).
  3766     12  FILLER                          PIC X(5)
  3767            VALUE ' PGM='.
  3768     12  SM-PGM                          PIC X(6).
  3769     12  FILLER                          PIC X(5)
  3770            VALUE ' OPR='.
  3771     12  SM-PROCESSOR-ID                 PIC X(4).
  3772     12  FILLER                          PIC X(6)
  3773            VALUE ' TERM='.
  3774     12  SM-TERMID                       PIC X(4).
  3775     12  FILLER                          PIC XX   VALUE SPACE.
  3776     12  SM-JUL-DATE                     PIC 9(5).
  3777     12  FILLER                          PIC X    VALUE SPACE.
  3778     12  SM-TIME                         PIC 99.99.
  3779
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  74
* EL689.cbl
  3781*    COPY ELCSCRTY.
  3782******************************************************************
  3783*                                                                *
  3784*                                                                *
  3785*                            ELCSCRTY                            *
  3786*                            VMOD=2.001                          *
  3787*                                                                *
  3788*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  3789*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  3790*        SAVED IN PI-SECURITY-ADDRESS.                           *
  3791*                                                                *
  3792******************************************************************
  3793 01  SECURITY-CONTROL.
  3794     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  3795     12  FILLER                       PIC XX    VALUE 'SC'.
  3796     12  SC-CREDIT-CODES.
  3797         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  3798             20  SC-CREDIT-DISPLAY    PIC X.
  3799             20  SC-CREDIT-UPDATE     PIC X.
  3800     12  SC-CLAIMS-CODES.
  3801         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  3802             20  SC-CLAIMS-DISPLAY    PIC X.
  3803             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  75
* EL689.cbl
  3805
  3806 01  W-TS-WORK-AREA              PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  76
* EL689.cbl
  3808****************************************************************
  3809*
  3810* Copyright (c) 2007 by Clerity Solutions, Inc.
  3811* All rights reserved.
  3812*
  3813****************************************************************
  3814 01  DFHEIV.
  3815   02  DFHEIV0               PIC X(35).
  3816   02  DFHEIV1               PIC X(08).
  3817   02  DFHEIV2               PIC X(08).
  3818   02  DFHEIV3               PIC X(08).
  3819   02  DFHEIV4               PIC X(06).
  3820   02  DFHEIV5               PIC X(04).
  3821   02  DFHEIV6               PIC X(04).
  3822   02  DFHEIV7               PIC X(02).
  3823   02  DFHEIV8               PIC X(02).
  3824   02  DFHEIV9               PIC X(01).
  3825   02  DFHEIV10              PIC S9(7) COMP-3.
  3826   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3827   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3828   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3829   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3830   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3831   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3832   02  DFHEIV17              PIC X(04).
  3833   02  DFHEIV18              PIC X(04).
  3834   02  DFHEIV19              PIC X(04).
  3835   02  DFHEIV20              USAGE IS POINTER.
  3836   02  DFHEIV21              USAGE IS POINTER.
  3837   02  DFHEIV22              USAGE IS POINTER.
  3838   02  DFHEIV23              USAGE IS POINTER.
  3839   02  DFHEIV24              USAGE IS POINTER.
  3840   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3841   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3842   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3843   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3844   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3845   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3846   02  FILLER                PIC X(02).
  3847   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3848   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3849   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3850   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3851   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3852 LINKAGE  SECTION.
  3853*****************************************************************
  3854*                                                               *
  3855* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3856* All rights reserved.                                          *
  3857*                                                               *
  3858*****************************************************************
  3859 01  dfheiblk.
  3860     02  eibtime          pic s9(7) comp-3.
  3861     02  eibdate          pic s9(7) comp-3.
  3862     02  eibtrnid         pic x(4).
  3863     02  eibtaskn         pic s9(7) comp-3.
  3864     02  eibtrmid         pic x(4).
  3865     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  77
* EL689.cbl
  3866     02  eibcposn         pic s9(4) comp.
  3867     02  eibcalen         pic s9(4) comp.
  3868     02  eibaid           pic x(1).
  3869     02  eibfiller1       pic x(1).
  3870     02  eibfn            pic x(2).
  3871     02  eibfiller2       pic x(2).
  3872     02  eibrcode         pic x(6).
  3873     02  eibfiller3       pic x(2).
  3874     02  eibds            pic x(8).
  3875     02  eibreqid         pic x(8).
  3876     02  eibrsrce         pic x(8).
  3877     02  eibsync          pic x(1).
  3878     02  eibfree          pic x(1).
  3879     02  eibrecv          pic x(1).
  3880     02  eibsend          pic x(1).
  3881     02  eibatt           pic x(1).
  3882     02  eibeoc           pic x(1).
  3883     02  eibfmh           pic x(1).
  3884     02  eibcompl         pic x(1).
  3885     02  eibsig           pic x(1).
  3886     02  eibconf          pic x(1).
  3887     02  eiberr           pic x(1).
  3888     02  eibrldbk         pic x(1).
  3889     02  eiberrcd         pic x(4).
  3890     02  eibsynrb         pic x(1).
  3891     02  eibnodat         pic x(1).
  3892     02  eibfiller5       pic x(2).
  3893     02  eibresp          pic 9(09) comp.
  3894     02  eibresp2         pic 9(09) comp.
  3895     02  dfheigdj         pic s9(4) comp.
  3896     02  dfheigdk         pic s9(4) comp.
  3897 01  DFHCOMMAREA                 PIC X(1024).
  3898 01  var  pic x(30).
  3899
  3900*    COPY ERCACCT.
  3901******************************************************************
  3902*                                                                *
  3903*                                                                *
  3904*                            ERCACCT                             *
  3905*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3906*                            VMOD=2.031                          *
  3907*                                                                *
  3908*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3909*                                                                *
  3910*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3911*   VSAM ACCOUNT MASTER FILES.                                   *
  3912*                                                                *
  3913*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3914*                                                                *
  3915*   FILE TYPE = VSAM,KSDS                                        *
  3916*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3917*                                                                *
  3918*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3919*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3920*                                                                *
  3921*   LOG = NO                                                     *
  3922*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3923*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  78
* EL689.cbl
  3924*                                                                *
  3925******************************************************************
  3926*                   C H A N G E   L O G
  3927*
  3928* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3929*-----------------------------------------------------------------
  3930*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3931* EFFECTIVE    NUMBER
  3932*-----------------------------------------------------------------
  3933* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3934* 092705    2005050300006  PEMA  ADD SPP LEASES
  3935* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3936* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3937* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3938* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3939* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3940******************************************************************
  3941
  3942 01  ACCOUNT-MASTER.
  3943     12  AM-RECORD-ID                      PIC XX.
  3944         88  VALID-AM-ID                      VALUE 'AM'.
  3945
  3946     12  AM-CONTROL-PRIMARY.
  3947         16  AM-COMPANY-CD                 PIC X.
  3948         16  AM-MSTR-CNTRL.
  3949             20  AM-CONTROL-A.
  3950                 24  AM-CARRIER            PIC X.
  3951                 24  AM-GROUPING.
  3952                     28 AM-GROUPING-PREFIX PIC XXX.
  3953                     28 AM-GROUPING-PRIME  PIC XXX.
  3954                 24  AM-STATE              PIC XX.
  3955                 24  AM-ACCOUNT.
  3956                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3957                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3958             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3959                                           PIC X(19).
  3960             20  AM-CNTRL-B.
  3961                 24  AM-EXPIRATION-DT      PIC XX.
  3962                 24  FILLER                PIC X(4).
  3963             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3964                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3965
  3966     12  AM-CONTROL-BY-VAR-GRP.
  3967         16  AM-COMPANY-CD-A1              PIC X.
  3968         16  AM-VG-CARRIER                 PIC X.
  3969         16  AM-VG-GROUPING                PIC X(6).
  3970         16  AM-VG-STATE                   PIC XX.
  3971         16  AM-VG-ACCOUNT                 PIC X(10).
  3972         16  AM-VG-DATE.
  3973             20  AM-VG-EXPIRATION-DT       PIC XX.
  3974             20  FILLER                    PIC X(4).
  3975         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3976                                           PIC 9(11)      COMP-3.
  3977     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3978         16  FILLER                        PIC X(10).
  3979         16  AM-VG-KEY3.
  3980             20  AM-VG3-ACCOUNT            PIC X(10).
  3981             20  AM-VG3-EXP-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  79
* EL689.cbl
  3982         16  FILLER                        PIC X(4).
  3983     12  AM-MAINT-INFORMATION.
  3984         16  AM-LAST-MAINT-DT              PIC XX.
  3985         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3986         16  AM-LAST-MAINT-USER            PIC X(4).
  3987         16  FILLER                        PIC XX.
  3988
  3989     12  AM-EFFECTIVE-DT                   PIC XX.
  3990     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3991
  3992     12  AM-PREV-DATES  COMP-3.
  3993         16  AM-PREV-EXP-DT                PIC 9(11).
  3994         16  AM-PREV-EFF-DT                PIC 9(11).
  3995
  3996     12  AM-REPORT-CODE-1                  PIC X(10).
  3997     12  AM-REPORT-CODE-2                  PIC X(10).
  3998
  3999     12  AM-CITY-CODE                      PIC X(4).
  4000     12  AM-COUNTY-PARISH                  PIC X(6).
  4001
  4002     12  AM-NAME                           PIC X(30).
  4003     12  AM-PERSON                         PIC X(30).
  4004     12  AM-ADDRS                          PIC X(30).
  4005     12  AM-CITY.
  4006         16  AM-ADDR-CITY                  PIC X(28).
  4007         16  AM-ADDR-STATE                 PIC XX.
  4008     12  AM-ZIP.
  4009         16  AM-ZIP-PRIME.
  4010             20  AM-ZIP-PRI-1ST            PIC X.
  4011                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4012             20  FILLER                    PIC X(4).
  4013         16  AM-ZIP-PLUS4                  PIC X(4).
  4014     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4015         16  AM-CAN-POSTAL-1               PIC XXX.
  4016         16  AM-CAN-POSTAL-2               PIC XXX.
  4017         16  FILLER                        PIC XXX.
  4018     12  AM-TEL-NO.
  4019         16  AM-AREA-CODE                  PIC 999.
  4020         16  AM-TEL-PRE                    PIC 999.
  4021         16  AM-TEL-NBR                    PIC 9(4).
  4022     12  AM-TEL-LOC                        PIC X.
  4023         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4024         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4025
  4026     12  AM-COMM-STRUCTURE.
  4027         16  AM-DEFN-1.
  4028             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4029                 24  AM-AGT.
  4030                     28  AM-AGT-PREFIX     PIC X(4).
  4031                     28  AM-AGT-PRIME      PIC X(6).
  4032                 24  AM-COM-TYP            PIC X.
  4033                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4034                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4035                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4036                 24  AM-RECALC-LV-INDIC    PIC X.
  4037                 24  AM-RETRO-LV-INDIC     PIC X.
  4038                 24  AM-GL-CODES           PIC X.
  4039                 24  AM-COMM-CHARGEBACK    PIC 9(02).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  80
* EL689.cbl
  4040                 24  FILLER                PIC X(01).
  4041         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4042             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4043                 24  FILLER                PIC X(11).
  4044                 24  AM-L-COMA             PIC XXX.
  4045                 24  AM-J-COMA             PIC XXX.
  4046                 24  AM-A-COMA             PIC XXX.
  4047                 24  FILLER                PIC X(6).
  4048
  4049     12  AM-COMM-CHANGE-STATUS             PIC X.
  4050         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4051
  4052     12  AM-CSR-CODE                       PIC X(4).
  4053
  4054     12  AM-BILLING-STATUS                 PIC X.
  4055         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4056         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4057     12  AM-AUTO-REFUND-SW                 PIC X.
  4058         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4059         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4060     12  AM-GPCD                           PIC 99.
  4061     12  AM-IG                             PIC X.
  4062         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4063         88  AM-HAS-GROUP                     VALUE '2'.
  4064     12  AM-STATUS                         PIC X.
  4065         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4066         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4067         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4068         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4069         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4070         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4071     12  AM-REMIT-TO                       PIC 99.
  4072     12  AM-ID-NO                          PIC X(11).
  4073
  4074     12  AM-CAL-TABLE                      PIC XX.
  4075     12  AM-LF-DEVIATION                   PIC XXX.
  4076     12  AM-AH-DEVIATION                   PIC XXX.
  4077     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4078     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4079     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4080     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4081     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4082     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4083
  4084     12  AM-USER-FIELDS.
  4085         16  AM-FLD-1                      PIC XX.
  4086         16  AM-FLD-2                      PIC XX.
  4087         16  AM-FLD-3                      PIC XX.
  4088         16  AM-FLD-4                      PIC XX.
  4089         16  AM-FLD-5                      PIC XX.
  4090
  4091     12  AM-1ST-PROD-DATE.
  4092         16  AM-1ST-PROD-YR                PIC XX.
  4093         16  AM-1ST-PROD-MO                PIC XX.
  4094         16  AM-1ST-PROD-DA                PIC XX.
  4095     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4096     12  AM-CERTS-PURGED-DATE.
  4097         16  AM-PUR-YR                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  81
* EL689.cbl
  4098         16  AM-PUR-MO                     PIC XX.
  4099         16  AM-PUR-DA                     PIC XX.
  4100     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4101     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4102     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4103     12  AM-INACTIVE-DATE.
  4104         16  AM-INA-MO                     PIC 99.
  4105         16  AM-INA-DA                     PIC 99.
  4106         16  AM-INA-YR                     PIC 99.
  4107     12  AM-AR-HI-CERT-DATE                PIC XX.
  4108
  4109     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4110     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4111
  4112     12  AM-OB-PAYMENT-MODE                PIC X.
  4113         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4114         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4115         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4116         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4117
  4118     12  AM-AH-ONLY-INDICATOR              PIC X.
  4119         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4120         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4121
  4122     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4123
  4124     12  AM-OVER-SHORT.
  4125         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4126         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4127
  4128     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4129     12  AM-DCC-CLP-STATE                  PIC XX.
  4130
  4131     12  AM-RECALC-COMM                    PIC X.
  4132     12  AM-RECALC-REIN                    PIC X.
  4133
  4134     12  AM-REI-TABLE                      PIC XXX.
  4135     12  AM-REI-ET-LF                      PIC X.
  4136     12  AM-REI-ET-AH                      PIC X.
  4137     12  AM-REI-PE-LF                      PIC X.
  4138     12  AM-REI-PE-AH                      PIC X.
  4139     12  AM-REI-PRT-ST                     PIC X.
  4140     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4141     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4142     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4143     12  AM-REI-GROUP-A                    PIC X(6).
  4144     12  AM-REI-MORT                       PIC X(4).
  4145     12  AM-REI-PRT-OW                     PIC X.
  4146     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4147     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4148     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4149     12  AM-REI-GROUP-B                    PIC X(6).
  4150
  4151     12  AM-TRUST-TYPE                     PIC X(2).
  4152
  4153     12  AM-EMPLOYER-STMT-USED             PIC X.
  4154     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4155
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  82
* EL689.cbl
  4156     12  AM-STD-AH-TYPE                    PIC XX.
  4157     12  AM-EARN-METHODS.
  4158         16  AM-EARN-METHOD-R              PIC X.
  4159             88 AM-REF-RL-R78                 VALUE 'R'.
  4160             88 AM-REF-RL-PR                  VALUE 'P'.
  4161             88 AM-REF-RL-MEAN                VALUE 'M'.
  4162             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4163         16  AM-EARN-METHOD-L              PIC X.
  4164             88 AM-REF-LL-R78                 VALUE 'R'.
  4165             88 AM-REF-LL-PR                  VALUE 'P'.
  4166             88 AM-REF-LL-MEAN                VALUE 'M'.
  4167             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4168         16  AM-EARN-METHOD-A              PIC X.
  4169             88 AM-REF-AH-R78                 VALUE 'R'.
  4170             88 AM-REF-AH-PR                  VALUE 'P'.
  4171             88 AM-REF-AH-MEAN                VALUE 'M'.
  4172             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4173             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4174             88 AM-REF-AH-NET                 VALUE 'N'.
  4175
  4176     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4177     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4178     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4179
  4180     12  AM-RET-Y-N                        PIC X.
  4181     12  AM-RET-P-E                        PIC X.
  4182     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4183     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4184     12  AM-RET-GRP                        PIC X(6).
  4185     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4186         16  AM-POOL-PRIME                 PIC XXX.
  4187         16  AM-POOL-SUB                   PIC XXX.
  4188     12  AM-RETRO-EARNINGS.
  4189         16  AM-RET-EARN-R                 PIC X.
  4190         16  AM-RET-EARN-L                 PIC X.
  4191         16  AM-RET-EARN-A                 PIC X.
  4192     12  AM-RET-ST-TAX-USE                 PIC X.
  4193         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4194         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4195     12  AM-RETRO-BEG-EARNINGS.
  4196         16  AM-RET-BEG-EARN-R             PIC X.
  4197         16  AM-RET-BEG-EARN-L             PIC X.
  4198         16  AM-RET-BEG-EARN-A             PIC X.
  4199     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4200     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4201
  4202     12  AM-USER-SELECT-OPTIONS.
  4203         16  AM-USER-SELECT-1              PIC X(10).
  4204         16  AM-USER-SELECT-2              PIC X(10).
  4205         16  AM-USER-SELECT-3              PIC X(10).
  4206         16  AM-USER-SELECT-4              PIC X(10).
  4207         16  AM-USER-SELECT-5              PIC X(10).
  4208
  4209     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4210
  4211     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4212
  4213     12  AM-RPT045A-SWITCH                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  83
* EL689.cbl
  4214         88  RPT045A-OFF                   VALUE 'N'.
  4215
  4216     12  AM-INSURANCE-LIMITS.
  4217         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4218         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4219
  4220     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4221         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4222
  4223     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4224         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4225         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4226
  4227     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4228
  4229     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4230     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4231     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4232     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4233     12  AM-DCC-UEF-STATE                  PIC XX.
  4234     12  FILLER                            PIC XXX.
  4235     12  AM-REPORT-CODE-3                  PIC X(10).
  4236*    12  FILLER                            PIC X(22).
  4237
  4238     12  AM-RESERVE-DATE.
  4239         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4240         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4241         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4242
  4243     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4244     12  AM-NOTIFICATION-TYPES.
  4245         16  AM-NOTIF-OF-LETTERS           PIC X.
  4246         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4247         16  AM-NOTIF-OF-REPORTS           PIC X.
  4248         16  AM-NOTIF-OF-STATUS            PIC X.
  4249
  4250     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4251         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4252         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4253         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4254         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4255
  4256     12  AM-BENEFIT-CONTROLS.
  4257         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4258             20  AM-BENEFIT-CODE           PIC XX.
  4259             20  AM-BENEFIT-TYPE           PIC X.
  4260             20  AM-BENEFIT-REVISION       PIC XXX.
  4261             20  AM-BENEFIT-REM-TERM       PIC X.
  4262             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4263             20  FILLER                    PIC XX.
  4264         16  FILLER                        PIC X(80).
  4265
  4266     12  AM-TRANSFER-DATA.
  4267         16  AM-TRANSFERRED-FROM.
  4268             20  AM-TRNFROM-CARRIER        PIC X.
  4269             20  AM-TRNFROM-GROUPING.
  4270                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4271                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  84
* EL689.cbl
  4272             20  AM-TRNFROM-STATE          PIC XX.
  4273             20  AM-TRNFROM-ACCOUNT.
  4274                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4275                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4276             20  AM-TRNFROM-DTE            PIC XX.
  4277         16  AM-TRANSFERRED-TO.
  4278             20  AM-TRNTO-CARRIER          PIC X.
  4279             20  AM-TRNTO-GROUPING.
  4280                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4281                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4282             20  AM-TRNTO-STATE            PIC XX.
  4283             20  AM-TRNTO-ACCOUNT.
  4284                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4285                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4286             20  AM-TRNTO-DTE              PIC XX.
  4287         16  FILLER                        PIC X(10).
  4288
  4289     12  AM-SAVED-REMIT-TO                 PIC 99.
  4290
  4291     12  AM-COMM-STRUCTURE-SAVED.
  4292         16  AM-DEFN-1-SAVED.
  4293             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4294                 24  AM-AGT-SV             PIC X(10).
  4295                 24  AM-COM-TYP-SV         PIC X.
  4296                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4297                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4298                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4299                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4300                 24  FILLER                PIC X.
  4301                 24  AM-GL-CODES-SV        PIC X.
  4302                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4303                 24  FILLER                PIC X.
  4304         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4305             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4306                 24  FILLER                PIC X(11).
  4307                 24  AM-L-COMA-SV          PIC XXX.
  4308                 24  AM-J-COMA-SV          PIC XXX.
  4309                 24  AM-A-COMA-SV          PIC XXX.
  4310                 24  FILLER                PIC X(6).
  4311
  4312     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4313         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4314            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4315            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4316            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4317
  4318     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4319     12  FILLER                            PIC X(120).
  4320
  4321     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4322         16  AM-CONTROL-NAME               PIC X(30).
  4323         16  AM-EXECUTIVE-ONE.
  4324             20  AM-EXEC1-NAME             PIC X(15).
  4325             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4326                                                          COMP-3.
  4327             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4328                                                          COMP-3.
  4329         16  AM-EXECUTIVE-TWO.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  85
* EL689.cbl
  4330             20  AM-EXEC2-NAME             PIC X(15).
  4331             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4332                                                          COMP-3.
  4333             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4334                                                          COMP-3.
  4335
  4336     12  AM-RETRO-ADDITIONAL-DATA.
  4337         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4338         16  AM-RETRO-PREM-P-E             PIC X.
  4339         16  AM-RETRO-CLMS-P-I             PIC X.
  4340         16  AM-RETRO-RET-BRACKET-LF.
  4341             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4342                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4343                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4344             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4345                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4346                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4347             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4348                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4349                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4350         16  AM-RETRO-RET-BRACKET-AH.
  4351             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4352                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4353                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4354                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4355             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4356                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4357                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4358             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4359                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4360                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4361
  4362     12  AM-COMMENTS.
  4363         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4364
  4365     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4366         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4367         16  AM-FLI-BILLING-CODE           PIC X.
  4368         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4369         16  AM-FLI-UNITED-IDENT           PIC X.
  4370         16  AM-FLI-INTEREST-LOST-DATA.
  4371             20  AM-FLI-BANK-NO            PIC X(5).
  4372             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4373             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4374             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4375         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4376             20  AM-FLI-AGT                PIC X(9).
  4377             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4378             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4379         16  FILLER                        PIC X(102).
  4380
  4381     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4382         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4383             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4384             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4385             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4386             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4387             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  86
* EL689.cbl
  4388         16  FILLER                          PIC X(10).
  4389******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  87
* EL689.cbl
  4391*    COPY ERCARCH.
  4392******************************************************************
  4393*                                                                *
  4394*                            ERCARCH.                            *
  4395*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4396*                            VMOD=2.002                          *
  4397*                                                                *
  4398*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4399*                                                                *
  4400*   FILE TYPE = VSAM,KSDS                                        *
  4401*   RECORD SIZE = 250  RECFORM = FIXED                           *
  4402*                                                                *
  4403*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  4404*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  4405*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  4406*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  4407*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  4408*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  4409*                                                                *
  4410*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4411******************************************************************
  4412*                   C H A N G E   L O G
  4413*
  4414* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4415*-----------------------------------------------------------------
  4416*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4417* EFFECTIVE    NUMBER
  4418*-----------------------------------------------------------------
  4419* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  4420* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4421* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4422******************************************************************
  4423 01  LETTER-ARCHIVE.
  4424     12  LA-RECORD-ID                PIC  X(02).
  4425         88  LA-VALID-ID                VALUE 'LA'.
  4426
  4427     12  LA-CONTROL-PRIMARY.
  4428         16  LA-COMPANY-CD           PIC  X(01).
  4429         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  4430
  4431     12  LA-CONTROL-BY-CERT-RESP.
  4432         16  LA-COMPANY-CD-A2        PIC  X(01).
  4433         16  LA-CERT-NO-A2.
  4434             20  LA-CERT-PRIME-A2    PIC  X(10).
  4435             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  4436         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  4437             20  LA-RESP-PERSON-A2   PIC  X(10).
  4438             20  LA-TYPE-A2          PIC  X(01).
  4439         16  LA-CARRIER-A2           PIC  X(01).
  4440         16  LA-GROUPING-A2          PIC  X(06).
  4441         16  LA-STATE-A2             PIC  X(02).
  4442         16  LA-ACCOUNT-A2           PIC  X(10).
  4443         16  LA-EFFECT-DATE-A2       PIC  X(02).
  4444         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  4445
  4446     12  LA-CONTROL-BY-FORM.
  4447         16  LA-COMPANY-CD-A3        PIC  X(01).
  4448         16  LA-FORM-A3              PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  88
* EL689.cbl
  4449         16  LA-CARRIER-A3           PIC  X(01).
  4450         16  LA-GROUPING-A3          PIC  X(06).
  4451         16  LA-STATE-A3             PIC  X(02).
  4452         16  LA-ACCOUNT-A3           PIC  X(10).
  4453         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  4454
  4455     12  LA-CONTROL-BY-PROCESSOR.
  4456         16  LA-COMPANY-CD-A4        PIC  X(01).
  4457         16  LA-PROCESSOR-CD         PIC  X(04).
  4458         16  LA-CARRIER-A4           PIC  X(01).
  4459         16  LA-GROUPING-A4          PIC  X(06).
  4460         16  LA-STATE-A4             PIC  X(02).
  4461         16  LA-ACCOUNT-A4           PIC  X(10).
  4462         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  4463
  4464     12  LA-CONTROL-BY-KEY-FIELDS.
  4465         16  LA-COMPANY-CD-A5        PIC  X(01).
  4466         16  LA-CARRIER-A5           PIC  X(01).
  4467         16  LA-GROUPING-A5          PIC  X(06).
  4468         16  LA-STATE-A5             PIC  X(02).
  4469         16  LA-ACCOUNT-A5           PIC  X(10).
  4470         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  4471
  4472     12  LA-CONTROL-BY-GROUP-CODE.
  4473         16  LA-COMPANY-CD-A6        PIC  X(01).
  4474         16  LA-ENTRY-A6.
  4475             20  LA-FILLER           PIC  X(02).
  4476             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  4477         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  4478
  4479     12  FILLER                      PIC  X(09).
  4480
  4481     12  LA-HEADER-RECORD.
  4482         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  4483         16  LA-CREATION-DATE        PIC  X(02).
  4484         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  4485         16  LA-FINAL-ACT-DATE       REDEFINES
  4486               LA-FOLLOW-UP-DATE     PIC  X(02).
  4487         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  4488         16  LA-NO-OF-COPIES         PIC S9(01).
  4489         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  4490         16  LA-REPLY-DATE           PIC  X(02).
  4491         16  LA-RESEND-DATES.
  4492             20  LA-RESEND-DATE      PIC  X(02).
  4493             20  LA-SENT-DATE        PIC  X(02).
  4494             20  FILLER              PIC  X(08).
  4495         16  LA-SOURCE-INFORMATION.
  4496             20  LA-DATA-SOURCE      PIC  X(01).
  4497             20  LA-ADDR-SOURCE      PIC  X(01).
  4498         16  LA-STATUS               PIC  X(01).
  4499             88  LA-STATUS-ACTIVE         VALUE 'A'.
  4500             88  LA-STATUS-COMPLETED      VALUE 'C'.
  4501             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  4502             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  4503             88  LA-STATUS-PURGED         VALUE 'P'.
  4504             88  LA-STATUS-VOIDED         VALUE 'V'.
  4505         16  LA-LAST-RESENT-PRINT-DATE
  4506                                     PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  89
* EL689.cbl
  4507         16  LA-PRINT-RESTRICTION    PIC  X(01).
  4508             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4509                                          VALUE 'C'.
  4510             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4511                                          VALUE 'F'.
  4512             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4513                                          VALUE 'P'.
  4514         16  LA-PURGED-DATE          PIC  X(02).
  4515         16  LA-VOIDED-DATE          PIC  X(02).
  4516         16  LA-RESEND-LETR          PIC  X(4).
  4517         16  FILLER                  PIC  X(08).
  4518*        16  LA-RESEND-LETR-2        PIC  X(4).
  4519*        16  LA-RESEND-LETR-3        PIC  X(4).
  4520*        16  FILLER                  PIC  X(59).
  4521         16  LA-ARCHIVE-STATUS       PIC  X.
  4522             88  LA-TEMP                VALUE 'T'.
  4523             88  LA-QWS                 VALUE 'Q'.
  4524             88  LA-BATCH               VALUE 'B'.
  4525         16  LA-FINAL-ACT-IND        PIC  X(1).
  4526         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  4527         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  4528         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  4529                                     PIC X(4).
  4530         16  FILLER                  PIC  X(42).
  4531*        16  FILLER                  PIC  X(71).
  4532         16  LA-LAST-MAINT-DATE      PIC  X(2).
  4533         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  4534         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  4535                                     PIC  X(4).
  4536         16  LA-LAST-UPDATED-BY      PIC  X(4).
  4537
  4538******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  90
* EL689.cbl
  4540*    COPY ERCARCT.
  4541******************************************************************
  4542*                                                                *
  4543*                            ERCARCT.                            *
  4544*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4545*                            VMOD=2.002                          *
  4546*                                                                *
  4547*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  4548*                                                                *
  4549*   FILE TYPE = VSAM,KSDS                                        *
  4550*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  4551*                                                                *
  4552*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  4553*                                                                *
  4554*   LOG = NO                                                     *
  4555*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4556******************************************************************
  4557*                   C H A N G E   L O G
  4558*
  4559* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4560*-----------------------------------------------------------------
  4561*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4562* EFFECTIVE    NUMBER
  4563*-----------------------------------------------------------------
  4564* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4565******************************************************************
  4566 01  LETTER-ARCHIVE-TEXT.
  4567     12  LT-RECORD-ID                PIC  X(02).
  4568         88  LT-VALID-ID                VALUE 'LT'.
  4569
  4570     12  LT-CONTROL-PRIMARY.
  4571         16  LT-COMPANY-CD           PIC  X(01).
  4572         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  4573         16  LT-RECORD-TYPE          PIC  X(01).
  4574             88  LT-ADDRESS-DATA        VALUE '1'.
  4575             88  LT-TEXT-DATA           VALUE '2'.
  4576             88  LT-COMMENT-DATA        VALUE '3'.
  4577         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  4578
  4579     12  FILLER                      PIC  X(28).
  4580     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  4581
  4582     12  LT-TEXT-RECORD.
  4583         16  LT-LETTER-TEXT OCCURS 20 TIMES
  4584                            INDEXED BY LT-NDX.
  4585             20  LT-TEXT-LINE        PIC  X(70).
  4586             20  LT-SKIP-CONTROL     PIC  X(02).
  4587                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  4588                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  4589             20  FILLER              PIC  X(08).
  4590
  4591     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  4592         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  4593             20  LT-COMMENT-LINE     PIC X(69).
  4594             20  LT-COMMENT-CHG-DT   PIC X(02).
  4595             20  LT-COMMENT-CHG-BY   PIC X(04).
  4596             20  FILLER              PIC X(05).
  4597
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  91
* EL689.cbl
  4599*    COPY ELCCERT.
  4600******************************************************************
  4601*                                                                *
  4602*                            ELCCERT.                            *
  4603*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4604*                            VMOD=2.013                          *
  4605*                                                                *
  4606*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4607*                                                                *
  4608*   FILE TYPE = VSAM,KSDS                                        *
  4609*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4610*                                                                *
  4611*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4612*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4613*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4614*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4615*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4616*                                                                *
  4617*   LOG = YES                                                    *
  4618*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4619******************************************************************
  4620*                   C H A N G E   L O G
  4621*
  4622* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4623*-----------------------------------------------------------------
  4624*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4625* EFFECTIVE    NUMBER
  4626*-----------------------------------------------------------------
  4627* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4628* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4629* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4630* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4631* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4632* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4633* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4634* 032612  CR2011110200001  PEMA  AHL CHANGES
  4635******************************************************************
  4636
  4637 01  CERTIFICATE-MASTER.
  4638     12  CM-RECORD-ID                      PIC XX.
  4639         88  VALID-CM-ID                      VALUE 'CM'.
  4640
  4641     12  CM-CONTROL-PRIMARY.
  4642         16  CM-COMPANY-CD                 PIC X.
  4643         16  CM-CARRIER                    PIC X.
  4644         16  CM-GROUPING.
  4645             20  CM-GROUPING-PREFIX        PIC X(3).
  4646             20  CM-GROUPING-PRIME         PIC X(3).
  4647         16  CM-STATE                      PIC XX.
  4648         16  CM-ACCOUNT.
  4649             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4650             20  CM-ACCOUNT-PRIME          PIC X(6).
  4651         16  CM-CERT-EFF-DT                PIC XX.
  4652         16  CM-CERT-NO.
  4653             20  CM-CERT-PRIME             PIC X(10).
  4654             20  CM-CERT-SFX               PIC X.
  4655
  4656     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  92
* EL689.cbl
  4657         16  CM-COMPANY-CD-A1              PIC X.
  4658         16  CM-INSURED-LAST-NAME          PIC X(15).
  4659         16  CM-INSURED-INITIALS.
  4660             20  CM-INSURED-INITIAL1       PIC X.
  4661             20  CM-INSURED-INITIAL2       PIC X.
  4662
  4663     12  CM-CONTROL-BY-SSN.
  4664         16  CM-COMPANY-CD-A2              PIC X.
  4665         16  CM-SOC-SEC-NO.
  4666             20  CM-SSN-STATE              PIC XX.
  4667             20  CM-SSN-ACCOUNT            PIC X(6).
  4668             20  CM-SSN-LN3.
  4669                 25  CM-INSURED-INITIALS-A2.
  4670                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4671                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4672                 25 CM-PART-LAST-NAME-A2         PIC X.
  4673
  4674     12  CM-CONTROL-BY-CERT-NO.
  4675         16  CM-COMPANY-CD-A4              PIC X.
  4676         16  CM-CERT-NO-A4                 PIC X(11).
  4677
  4678     12  CM-CONTROL-BY-MEMB.
  4679         16  CM-COMPANY-CD-A5              PIC X.
  4680         16  CM-MEMBER-NO.
  4681             20  CM-MEMB-STATE             PIC XX.
  4682             20  CM-MEMB-ACCOUNT           PIC X(6).
  4683             20  CM-MEMB-LN4.
  4684                 25  CM-INSURED-INITIALS-A5.
  4685                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4686                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4687                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4688
  4689     12  CM-INSURED-PROFILE-DATA.
  4690         16  CM-INSURED-FIRST-NAME.
  4691             20  CM-INSURED-1ST-INIT       PIC X.
  4692             20  FILLER                    PIC X(9).
  4693         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4694         16  CM-INSURED-SEX                PIC X.
  4695             88  CM-SEX-MALE                  VALUE 'M'.
  4696             88  CM-SEX-FEMAL                 VALUE 'F'.
  4697         16  CM-INSURED-JOINT-AGE          PIC 99.
  4698         16  CM-JOINT-INSURED-NAME.
  4699             20  CM-JT-LAST-NAME           PIC X(15).
  4700             20  CM-JT-FIRST-NAME.
  4701                 24  CM-JT-1ST-INIT        PIC X.
  4702                 24  FILLER                PIC X(9).
  4703             20  CM-JT-INITIAL             PIC X.
  4704
  4705     12  CM-LIFE-DATA.
  4706         16  CM-LF-BENEFIT-CD              PIC XX.
  4707         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4708         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4709         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4710         16  CM-LF-DEV-CODE                PIC XXX.
  4711         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4712         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4713         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4714         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  93
* EL689.cbl
  4715         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4716         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4717         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4718         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4719         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4720         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4721         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4722         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4723         16  FILLER                        PIC XX.
  4724
  4725     12  CM-AH-DATA.
  4726         16  CM-AH-BENEFIT-CD              PIC XX.
  4727         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4728         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4729         16  CM-AH-DEV-CODE                PIC XXX.
  4730         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4731         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4732         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4733         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4734         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4735         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4736         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4737         16  CM-AH-PAID-THRU-DT            PIC XX.
  4738             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4739         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4740         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4741         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4742         16  FILLER                        PIC X.
  4743
  4744     12  CM-LOAN-INFORMATION.
  4745         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4746         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4747                                           PIC S9(5)V99  COMP-3.
  4748         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4749         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4750         16  CM-PAY-FREQUENCY              PIC S99.
  4751         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4752         16  CM-RATE-CLASS                 PIC XX.
  4753         16  CM-BENEFICIARY                PIC X(25).
  4754         16  CM-POLICY-FORM-NO             PIC X(12).
  4755         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4756         16  CM-LAST-ADD-ON-DT             PIC XX.
  4757         16  CM-DEDUCTIBLE-AMOUNTS.
  4758             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4759             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4760         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4761             20  CM-RESIDENT-STATE         PIC XX.
  4762             20  CM-RATE-CODE              PIC X(4).
  4763             20  FILLER                    PIC XX.
  4764         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4765             20  CM-LOAN-OFFICER           PIC X(5).
  4766             20  FILLER                    PIC XXX.
  4767         16  CM-CSR-CODE                   PIC XXX.
  4768         16  CM-UNDERWRITING-CODE          PIC X.
  4769             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4770         16  CM-POST-CARD-IND              PIC X.
  4771         16  CM-NH-INTERFACE-SW            PIC X.
  4772         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  94
* EL689.cbl
  4773             88  CM-SING-PRM                  VALUE '1'.
  4774             88  CM-O-B-COVERAGE              VALUE '2'.
  4775             88  CM-OPEN-END                  VALUE '3'.
  4776         16  CM-IND-GRP-TYPE               PIC X.
  4777             88  CM-INDIVIDUAL                VALUE 'I'.
  4778             88  CM-GROUP                     VALUE 'G'.
  4779         16  CM-SKIP-CODE                  PIC X.
  4780             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4781             88  SKIP-JULY                    VALUE '1'.
  4782             88  SKIP-AUGUST                  VALUE '2'.
  4783             88  SKIP-SEPTEMBER               VALUE '3'.
  4784             88  SKIP-JULY-AUG                VALUE '4'.
  4785             88  SKIP-AUG-SEPT                VALUE '5'.
  4786             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4787             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4788             88  SKIP-JUNE                    VALUE '8'.
  4789             88  SKIP-JUNE-JULY               VALUE '9'.
  4790             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4791             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4792         16  CM-PAYMENT-MODE               PIC X.
  4793             88  PAY-MONTHLY                  VALUE SPACE.
  4794             88  PAY-WEEKLY                   VALUE '1'.
  4795             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4796             88  PAY-BI-WEEKLY                VALUE '3'.
  4797             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4798         16  CM-LOAN-NUMBER                PIC X(8).
  4799         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4800         16  CM-OLD-LOF                    PIC XXX.
  4801*        16  CM-LOAN-OFFICER               PIC XXX.
  4802         16  CM-REIN-TABLE                 PIC XXX.
  4803         16  CM-SPECIAL-REIN-CODE          PIC X.
  4804         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4805         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4806         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4807
  4808     12  CM-STATUS-DATA.
  4809         16  CM-ENTRY-STATUS               PIC X.
  4810         16  CM-ENTRY-DT                   PIC XX.
  4811
  4812         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4813         16  CM-LF-CANCEL-DT               PIC XX.
  4814         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4815
  4816         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4817         16  CM-LF-DEATH-DT                PIC XX.
  4818         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4819
  4820         16  CM-LF-CURRENT-STATUS          PIC X.
  4821             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4822                                                'M' '4' '5' '9'.
  4823             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4824             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4825             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4826             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4827             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4828             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4829             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4830             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  95
* EL689.cbl
  4831             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4832             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4833             88  CM-LF-DECLINED               VALUE 'D'.
  4834             88  CM-LF-VOIDED                 VALUE 'V'.
  4835
  4836         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4837         16  CM-AH-CANCEL-DT               PIC XX.
  4838         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4839
  4840         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4841         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4842         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4843
  4844         16  CM-AH-CURRENT-STATUS          PIC X.
  4845             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4846                                                'M' '4' '5' '9'.
  4847             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4848             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4849             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4850             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4851             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4852             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4853             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4854             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4855             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4856             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4857             88  CM-AH-DECLINED               VALUE 'D'.
  4858             88  CM-AH-VOIDED                 VALUE 'V'.
  4859
  4860         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4861             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4862             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4863             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4864         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4865
  4866         16  CM-ENTRY-BATCH                PIC X(6).
  4867         16  CM-LF-EXIT-BATCH              PIC X(6).
  4868         16  CM-AH-EXIT-BATCH              PIC X(6).
  4869         16  CM-LAST-MONTH-END             PIC XX.
  4870
  4871     12  CM-NOTE-SW                        PIC X.
  4872         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4873         88  CERT-NOTES-PRESENT               VALUE '1'.
  4874         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4875         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4876         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4877         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4878         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4879         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4880     12  CM-COMP-EXCP-SW                   PIC X.
  4881         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4882         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4883     12  CM-INSURED-ADDRESS-SW             PIC X.
  4884         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4885         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4886
  4887*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4888     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  96
* EL689.cbl
  4889     12  FILLER                            PIC X.
  4890
  4891*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4892     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4893     12  FILLER                            PIC X.
  4894*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4895     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4896
  4897     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4898         88  CERT-ADDED-BATCH                 VALUE ' '.
  4899         88  CERT-ADDED-ONLINE                VALUE '1'.
  4900         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4901         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4902         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4903     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4904         88  CERT-AS-LOADED                   VALUE ' '.
  4905         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4906         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4907         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4908         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4909         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4910         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4911         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4912
  4913     12  CM-ACCOUNT-COMM-PCTS.
  4914         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4915         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4916
  4917     12  CM-USER-FIELD                     PIC X.
  4918     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4919     12  CM-CLP-STATE                      PIC XX.
  4920     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4921     12  CM-USER-RESERVED                  PIC XXX.
  4922     12  FILLER REDEFINES CM-USER-RESERVED.
  4923         16  CM-AH-CLASS-CD                PIC XX.
  4924         16  F                             PIC X.
  4925******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  97
* EL689.cbl
  4927*    COPY ERCCHEK.
  4928******************************************************************
  4929*                                                                *
  4930*                                                                *
  4931*                            ERCCHEK                             *
  4932*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4933*                            VMOD=2.008                          *
  4934*                                                                *
  4935*   FILE DESCRIPTION = CHECK RECORDS                             *
  4936*                                                                *
  4937*   FILE TYPE = VSAM,KSDS                                        *
  4938*   RECORD SIZE = 600    RECFORM = FIXED                         *
  4939*                                                                *
  4940*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  4941*       ALTERNATE INDEX = NONE                                   *
  4942*                                                                *
  4943*   LOG = YES                                                    *
  4944*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4945******************************************************************
  4946 01  CHECK-RECORDS.
  4947     12  CH-RECORD-ID                      PIC XX.
  4948         88  VALID-CH-ID                      VALUE 'CH'.
  4949
  4950     12  CH-CONTROL-PRIMARY.
  4951         16  CH-COMPANY-CD                 PIC X.
  4952         16  CH-CARRIER                    PIC X.
  4953         16  CH-GROUPING                   PIC X(6).
  4954         16  CH-STATE                      PIC XX.
  4955         16  CH-ACCOUNT                    PIC X(10).
  4956         16  CH-CERT-EFF-DT                PIC XX.
  4957         16  CH-CERT-NO.
  4958             20  CH-CERT-PRIME             PIC X(10).
  4959             20  CH-CERT-SFX               PIC X.
  4960         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  4961
  4962     12  CH-RECORDED-DT                    PIC XX.
  4963     12  CH-RECORDED-BY                    PIC X(4).
  4964     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  4965
  4966     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  4967     12  CH-CHECK-NO                       PIC X(7).
  4968     12  CH-REASON-FOR-CHECK               PIC X(25).
  4969     12  CH-CHECK-WRITTEN-DT               PIC XX.
  4970     12  CH-OFFLINE-CHECK-IND              PIC X.
  4971         88  MANUAL-CHECK-WRITTEN             VALUE 'Y'.
  4972
  4973     12  CH-PAYEE-INFO.
  4974         16  CH-PAYEE-NAME-1               PIC X(30).
  4975         16  CH-PAYEE-NAME-2               PIC X(30).
  4976         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  4977         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  4978         16  CH-PAYEE-CITY-ST              PIC X(30).
  4979         16  CH-PAYEE-ZIP-CODE.
  4980             20  CH-PAYEE-ZIP.
  4981                 24  CH-ZIP-PRI-1ST        PIC X.
  4982                     88  CH-CANADIAN-POST-CODE
  4983                                           VALUES 'A' THRU 'Z'.
  4984                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  98
* EL689.cbl
  4985             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  4986         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  4987             20  CH-CAN-POSTAL-1           PIC XXX.
  4988             20  CH-CAN-POSTAL-2           PIC XXX.
  4989             20  FILLER                    PIC XXX.
  4990
  4991     12  CH-CHECK-STUB-TEXT.
  4992         16  CH-STUB-LINE-1                PIC X(50).
  4993         16  CH-STUB-LINE-2                PIC X(50).
  4994         16  CH-STUB-LINE-3                PIC X(50).
  4995         16  FILLER.
  4996           18  CH-STUB-LINE-4              PIC X(20).
  4997           18  CH-LIENHOLDER-NAME          PIC X(30).
  4998
  4999     12  CH-COMPENSATION-CONTROL.
  5000         16  CH-COMP-CARRIER               PIC X.
  5001         16  CH-COMP-GROUPING              PIC X(6).
  5002         16  CH-COMP-FIN-RESP              PIC X(10).
  5003         16  CH-COMP-ACCOUNT               PIC X(10).
  5004
  5005     12  CH-CREDIT-SELECT-DT               PIC XX.
  5006     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  5007     12  CH-PAYEE-CODE                     PIC X(6).
  5008
  5009     12  CH-VOID-DATA.
  5010         20  CH-VOID-DT                    PIC XX.
  5011         20  CH-VOID-BY                    PIC X(4).
  5012         20  CH-VOID-REASON                PIC X(25).
  5013
  5014     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  5015             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5016     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  5017
  5018     12  CH-CHECK-REFERENCE                PIC X(12).
  5019     12  CH-CHECK-ORIGIN-SW                PIC X.
  5020             88  CH-REFUND-CHECK              VALUE 'R'.
  5021             88  CH-MAINT-CHECK               VALUE 'M'.
  5022
  5023     12  CH-CANC-DT                        PIC XX.
  5024     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  5025     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  5026
  5027     12  CH-INSURED-NAME                   PIC X(28).
  5028
  5029     12  CH-DEDUCT-WITHHELD                PIC S9(5)V99  COMP-3.
  5030     12  CH-ADDITIONAL-CHARGE              PIC S9(5)V99  COMP-3.
  5031
  5032     12  CH-LETTER-TABLE.
  5033         16  CH-LETTERS OCCURS 3 TIMES
  5034                        INDEXED BY CH-LT-NDX
  5035                                           PIC X(04).
  5036
  5037     12  FILLER                            PIC X(07).
  5038
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page  99
* EL689.cbl
  5040*    COPY ELCCNTL.
  5041******************************************************************
  5042*                                                                *
  5043*                                                                *
  5044*                            ELCCNTL.                            *
  5045*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5046*                            VMOD=2.059                          *
  5047*                                                                *
  5048*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5049*                                                                *
  5050*   FILE TYPE = VSAM,KSDS                                        *
  5051*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5052*                                                                *
  5053*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5054*       ALTERNATE INDEX = NONE                                   *
  5055*                                                                *
  5056*   LOG = YES                                                    *
  5057*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5058******************************************************************
  5059*                   C H A N G E   L O G
  5060*
  5061* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5062*-----------------------------------------------------------------
  5063*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5064* EFFECTIVE    NUMBER
  5065*-----------------------------------------------------------------
  5066* 082503                   PEMA  ADD BENEFIT GROUP
  5067* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5068* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5069* 092705    2005050300006  PEMA  ADD SPP LEASES
  5070* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5071* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5072* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5073* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5074* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5075* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5076******************************************************************
  5077*
  5078 01  CONTROL-FILE.
  5079     12  CF-RECORD-ID                       PIC XX.
  5080         88  VALID-CF-ID                        VALUE 'CF'.
  5081
  5082     12  CF-CONTROL-PRIMARY.
  5083         16  CF-COMPANY-ID                  PIC XXX.
  5084         16  CF-RECORD-TYPE                 PIC X.
  5085             88  CF-COMPANY-MASTER              VALUE '1'.
  5086             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5087             88  CF-STATE-MASTER                VALUE '3'.
  5088             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5089             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5090             88  CF-CARRIER-MASTER              VALUE '6'.
  5091             88  CF-MORTALITY-MASTER            VALUE '7'.
  5092             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5093             88  CF-TERMINAL-MASTER             VALUE '9'.
  5094             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5095             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5096             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5097             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 100
* EL689.cbl
  5098             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5099             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5100             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5101             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5102             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5103         16  CF-ACCESS-CD-GENL              PIC X(4).
  5104         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5105             20  CF-PROCESSOR               PIC X(4).
  5106         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5107             20  CF-STATE-CODE              PIC XX.
  5108             20  FILLER                     PIC XX.
  5109         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5110             20  FILLER                     PIC XX.
  5111             20  CF-HI-BEN-IN-REC           PIC XX.
  5112         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5113             20  FILLER                     PIC XXX.
  5114             20  CF-CARRIER-CNTL            PIC X.
  5115         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5116             20  FILLER                     PIC XX.
  5117             20  CF-HI-TYPE-IN-REC          PIC 99.
  5118         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5119             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5120                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5121             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5122             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5123         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5124             20  FILLER                     PIC X.
  5125             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5126         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5127             20  FILLER                     PIC XX.
  5128             20  CF-MORTGAGE-PLAN           PIC XX.
  5129         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5130
  5131     12  CF-LAST-MAINT-DT                   PIC XX.
  5132     12  CF-LAST-MAINT-BY                   PIC X(4).
  5133     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5134
  5135     12  CF-RECORD-BODY                     PIC X(728).
  5136
  5137
  5138****************************************************************
  5139*             COMPANY MASTER RECORD                            *
  5140****************************************************************
  5141
  5142     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5143         16  CF-COMPANY-ADDRESS.
  5144             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5145             20  CF-CL-IN-CARE-OF           PIC X(30).
  5146             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5147             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5148             20  CF-CL-CITY-STATE           PIC X(30).
  5149             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5150             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5151         16  CF-COMPANY-CD                  PIC X.
  5152         16  CF-COMPANY-PASSWORD            PIC X(8).
  5153         16  CF-SECURITY-OPTION             PIC X.
  5154             88  ALL-SECURITY                   VALUE '1'.
  5155             88  COMPANY-VERIFY                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 101
* EL689.cbl
  5156             88  PROCESSOR-VERIFY               VALUE '3'.
  5157             88  NO-SECURITY                    VALUE '4'.
  5158             88  ALL-BUT-TERM                   VALUE '5'.
  5159         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5160             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5161         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5162             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5163         16  CF-INFORCE-LOCATION            PIC X.
  5164             88  CERTS-ARE-ONLINE               VALUE '1'.
  5165             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5166             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5167         16  CF-LOWER-CASE-LETTERS          PIC X.
  5168         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5169             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5170             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5171             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5172             88  CF-ACCNT-CNTL                  VALUE '3'.
  5173             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5174
  5175         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5176         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5177
  5178         16  CF-LGX-CREDIT-USER             PIC X.
  5179             88  CO-IS-NOT-USER                 VALUE 'N'.
  5180             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5181
  5182         16 CF-CREDIT-CALC-CODES.
  5183             20  CF-CR-REM-TERM-CALC PIC X.
  5184               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5185               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5186               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5187               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5188               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5189               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5190               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5191             20  CF-CR-R78-METHOD           PIC X.
  5192               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5193               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5194
  5195         16  CF-CLAIM-CONTROL-COUNTS.
  5196             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5197                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5198
  5199             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5200                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5201
  5202             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5203                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5204
  5205             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5206                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5207
  5208         16  CF-CURRENT-MONTH-END           PIC XX.
  5209
  5210         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5211             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5212             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5213             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 102
* EL689.cbl
  5214             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5215                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5216                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5217             20  CF-CO-PREM-REJECT-SW       PIC X.
  5218                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5219                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5220             20  CF-CO-REF-REJECT-SW        PIC X.
  5221                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5222                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5223
  5224         16  CF-CO-REPORTING-DT             PIC XX.
  5225         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5226         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5227           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5228           88  CF-CO-MONTH-END                  VALUE '1'.
  5229
  5230         16  CF-LGX-CLAIM-USER              PIC X.
  5231             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5232             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5233
  5234         16  CF-CREDIT-EDIT-CONTROLS.
  5235             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5236             20  CF-MIN-AGE                 PIC 99.
  5237             20  CF-DEFAULT-AGE             PIC 99.
  5238             20  CF-MIN-TERM                PIC S999      COMP-3.
  5239             20  CF-MAX-TERM                PIC S999      COMP-3.
  5240             20  CF-DEFAULT-SEX             PIC X.
  5241             20  CF-JOINT-AGE-INPUT         PIC X.
  5242                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5243             20  CF-BIRTH-DATE-INPUT        PIC X.
  5244                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5245             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5246                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5247                 88  CF-ZERO-CARRIER            VALUE '1'.
  5248                 88  CF-ZERO-GROUPING           VALUE '2'.
  5249                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5250             20  CF-EDIT-SW                 PIC X.
  5251                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5252             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5253             20  CF-CR-PR-METHOD            PIC X.
  5254               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5255               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5256             20  FILLER                     PIC X.
  5257
  5258         16  CF-CREDIT-MISC-CONTROLS.
  5259             20  CF-REIN-TABLE-SW           PIC X.
  5260                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5261             20  CF-COMP-TABLE-SW           PIC X.
  5262                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5263             20  CF-EXPERIENCE-RETENTION-AGE
  5264                                            PIC S9        COMP-3.
  5265             20  CF-CONVERSION-DT           PIC XX.
  5266             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5267             20  CF-RUN-FREQUENCY-SW        PIC X.
  5268                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5269                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5270
  5271             20  CF-CR-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 103
* EL689.cbl
  5272                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5273                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5274                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5275                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5276                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5277                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5278
  5279                 24  CF-CR-CHECK-COUNT       REDEFINES
  5280                     CF-CR-CHECK-COUNTER      PIC X(4).
  5281
  5282                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5283                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5284
  5285                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5286                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5287                 24  CF-MAIL-PROCESSING       PIC X.
  5288                     88  MAIL-PROCESSING          VALUE 'Y'.
  5289
  5290         16  CF-MISC-SYSTEM-CONTROL.
  5291             20  CF-SYSTEM-C                 PIC X.
  5292                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5293             20  CF-SYSTEM-D                 PIC X.
  5294                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5295             20  CF-SOC-SEC-NO-SW            PIC X.
  5296                 88  SOC-SEC-NO-USED             VALUE '1'.
  5297             20  CF-MEMBER-NO-SW             PIC X.
  5298                 88  MEMBER-NO-USED              VALUE '1'.
  5299             20  CF-TAX-ID-NUMBER            PIC X(11).
  5300             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5301             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5302                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5303                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5304                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5305                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5306             20  CF-SYSTEM-E                 PIC X.
  5307                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5308
  5309         16  CF-LGX-LIFE-USER               PIC X.
  5310             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5311             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5312
  5313         16  CF-CR-MONTH-END-DT             PIC XX.
  5314
  5315         16  CF-FILE-MAINT-DATES.
  5316             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5317                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5318             20  CF-LAST-BATCH       REDEFINES
  5319                 CF-LAST-BATCH-NO               PIC X(4).
  5320             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5321             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5322             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5323             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5324             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5325             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5326             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5327             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5328             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5329             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 104
* EL689.cbl
  5330
  5331         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5332         16  FILLER                         PIC X.
  5333
  5334         16  CF-ALT-MORT-CODE               PIC X(4).
  5335         16  CF-MEMBER-CAPTION              PIC X(10).
  5336
  5337         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5338             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5339             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5340             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5341             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5342             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5343
  5344         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5345
  5346         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5347         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5348         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5349         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5350
  5351         16  CF-AH-OVERRIDE-L1              PIC X.
  5352         16  CF-AH-OVERRIDE-L2              PIC XX.
  5353         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5354         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5355
  5356         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5357         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5358
  5359         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5360         16  CF-AR-LAST-EL860-DT            PIC XX.
  5361         16  CF-MP-MONTH-END-DT             PIC XX.
  5362
  5363         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5364         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5365             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5366
  5367         16  CF-AR-MONTH-END-DT             PIC XX.
  5368
  5369         16  CF-CRDTCRD-USER                PIC X.
  5370             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5371             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5372
  5373         16  CF-CC-MONTH-END-DT             PIC XX.
  5374
  5375         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5376
  5377         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5378             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5379             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5380             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5381         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5382         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5383         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5384         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5385             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5386             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5387         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 105
* EL689.cbl
  5388         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5389         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5390             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5391         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5392
  5393         16  CF-CL-ZIP-CODE.
  5394             20  CF-CL-ZIP-PRIME.
  5395                 24  CF-CL-ZIP-1ST          PIC X.
  5396                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5397                 24  FILLER                 PIC X(4).
  5398             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5399         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5400             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5401             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5402             20  FILLER                     PIC XXX.
  5403
  5404         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5405         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5406         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5407         16  CF-CO-OPTION-START-DATE        PIC XX.
  5408         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5409           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5410                                                      '3' '4'.
  5411           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5412           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5413           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5414           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5415           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5416           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5417
  5418         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5419
  5420         16  CF-PAYMENT-APPROVAL-LEVELS.
  5421             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5422             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5423             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5424             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5425             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5426             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5427
  5428         16  CF-END-USER-REPORTING-USER     PIC X.
  5429             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5430             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5431
  5432         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5433             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5434             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5435
  5436         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5437
  5438         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5439         16  FILLER                         PIC X.
  5440
  5441         16  CF-CREDIT-ARCHIVE-CNTL.
  5442             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5443             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5444             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5445
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 106
* EL689.cbl
  5446         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5447
  5448         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5449             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5450             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5451
  5452         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5453             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5454             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5455
  5456         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5457
  5458         16  CF-CO-ACH-ID-CODE              PIC  X.
  5459             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5460             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5461             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5462         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5463         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5464         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5465         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5466         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5467         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5468         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5469         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5470         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5471                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5472         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5473                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5474
  5475         16  CF-CO-OVER-SHORT.
  5476             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5477             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5478
  5479*         16  FILLER                         PIC X(102).
  5480         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5481             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5482             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5483
  5484         16  CF-AH-APPROVAL-DAYS.
  5485             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5486             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5487             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5488             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5489
  5490         16  FILLER                         PIC X(82).
  5491****************************************************************
  5492*             PROCESSOR/USER RECORD                            *
  5493****************************************************************
  5494
  5495     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5496         16  CF-PROCESSOR-NAME              PIC X(30).
  5497         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5498         16  CF-PROCESSOR-TITLE             PIC X(26).
  5499         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5500                 88  MESSAGE-YES                VALUE 'Y'.
  5501                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5502
  5503*****************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 107
* EL689.cbl
  5504****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5505****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5506****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5507****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5508*****************************************************
  5509
  5510         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5511             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5512             20  CF-APPLICATION-FORCE       PIC X.
  5513             20  CF-INDIVIDUAL-APP.
  5514                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5515                     28  CF-BROWSE-APP      PIC X.
  5516                     28  CF-UPDATE-APP      PIC X.
  5517
  5518         16  CF-CURRENT-TERM-ON             PIC X(4).
  5519         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5520             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5521             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5522             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5523             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5524             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5525             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5526             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5527         16  CF-PROCESSOR-CARRIER           PIC X.
  5528             88  NO-CARRIER-SECURITY            VALUE ' '.
  5529         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5530             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5531         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5532             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5533         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5534             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5535
  5536         16  CF-PROC-SYS-ACCESS-SW.
  5537             20  CF-PROC-CREDIT-CLAIMS-SW.
  5538                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5539                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5540                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5541                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5542             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5543                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5544                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5545             20  CF-PROC-LIFE-GNRLDGR-SW.
  5546                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5547                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5548                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5549                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5550             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5551                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5552                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5553         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5554             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5555             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5556         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5557
  5558         16  CF-APPROVAL-LEVEL                  PIC X.
  5559             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5560             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5561             88  APPROVAL-LEVEL-3                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 108
* EL689.cbl
  5562             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5563
  5564         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5565
  5566         16  CF-LANGUAGE-TYPE                   PIC X.
  5567             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5568             88  CF-LANG-IS-FR                      VALUE 'F'.
  5569
  5570         16  CF-CSR-IND                         PIC X.
  5571         16  FILLER                             PIC X(239).
  5572
  5573****************************************************************
  5574*             PROCESSOR/REMINDERS RECORD                       *
  5575****************************************************************
  5576
  5577     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5578         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5579             20  CF-START-REMIND-DT         PIC XX.
  5580             20  CF-END-REMIND-DT           PIC XX.
  5581             20  CF-REMINDER-TEXT           PIC X(50).
  5582         16  FILLER                         PIC X(296).
  5583
  5584
  5585****************************************************************
  5586*             STATE MASTER RECORD                              *
  5587****************************************************************
  5588
  5589     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5590         16  CF-STATE-ABBREVIATION          PIC XX.
  5591         16  CF-STATE-NAME                  PIC X(25).
  5592         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5593         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5594             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5595             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5596             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5597             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5598                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5599                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5600             20  CF-ST-PREM-REJECT-SW       PIC X.
  5601                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5602                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5603             20  CF-ST-REF-REJECT-SW        PIC X.
  5604                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5605                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5606         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5607         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5608         16  CF-ST-REFUND-RULES.
  5609             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5610             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5611             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5612         16  CF-ST-FST-PMT-EXTENSION.
  5613             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5614             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5615                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5616                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5617                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5618                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5619         16  CF-ST-STATE-CALL.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 109
* EL689.cbl
  5620             20  CF-ST-CALL-UNEARNED        PIC X.
  5621             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5622             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5623         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5624             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5625             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5626         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5627         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5628         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5629         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5630         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5631         16  FILLER                         PIC X.
  5632         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5633             20  CF-ST-BENEFIT-CD           PIC XX.
  5634             20  CF-ST-BENEFIT-KIND         PIC X.
  5635                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5636                 88  CF-ST-AH-KIND              VALUE 'A'.
  5637             20  CF-ST-REM-TERM-CALC        PIC X.
  5638                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5639                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5640                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5641                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5642                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5643                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5644                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5645                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5646
  5647             20  CF-ST-REFUND-CALC          PIC X.
  5648                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5649                 88  ST-REFD-BY-R78             VALUE '1'.
  5650                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5651                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5652                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5653                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5654                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5655                 88  ST-REFD-UTAH               VALUE '7'.
  5656                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5657                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5658                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5659
  5660             20  CF-ST-EARNING-CALC         PIC X.
  5661                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5662                 88  ST-EARN-BY-R78             VALUE '1'.
  5663                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5664                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5665                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5666                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5667                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5668                 88  ST-EARN-MEAN               VALUE '8'.
  5669                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5670
  5671             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5672                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5673                 88  ST-OVRD-BY-R78             VALUE '1'.
  5674                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5675                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5676                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5677                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 110
* EL689.cbl
  5678                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5679                 88  ST-OVRD-MEAN               VALUE '8'.
  5680                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5681             20  FILLER                     PIC X.
  5682
  5683         16  CF-ST-COMMISSION-CAPS.
  5684             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5685             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5686             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5687             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5688         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5689                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5690
  5691         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5692
  5693         16  CF-ST-STATUTORY-INTEREST.
  5694             20  CF-ST-STAT-DATE-FROM       PIC X.
  5695                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5696                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5697             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5698             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5699             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5700             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5701             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5702
  5703         16  CF-ST-OVER-SHORT.
  5704             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5705             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5706
  5707         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5708
  5709         16  CF-ST-RT-CALC                  PIC X.
  5710
  5711         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5712         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5713         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5714         16  CF-ST-RF-LR-CALC               PIC X.
  5715         16  CF-ST-RF-LL-CALC               PIC X.
  5716         16  CF-ST-RF-LN-CALC               PIC X.
  5717         16  CF-ST-RF-AH-CALC               PIC X.
  5718         16  CF-ST-RF-CP-CALC               PIC X.
  5719*        16  FILLER                         PIC X(206).
  5720*CIDMOD         16  FILLER                         PIC X(192).
  5721         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5722             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5723         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5724         16  CF-ST-VFY-2ND-BENE             PIC X.
  5725         16  FILLER                         PIC X(186).
  5726
  5727****************************************************************
  5728*             BENEFIT MASTER RECORD                            *
  5729****************************************************************
  5730
  5731     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5732         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5733             20  CF-BENEFIT-CODE            PIC XX.
  5734             20  CF-BENEFIT-NUMERIC  REDEFINES
  5735                 CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 111
* EL689.cbl
  5736             20  CF-BENEFIT-ALPHA           PIC XXX.
  5737             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5738             20  CF-BENEFIT-COMMENT         PIC X(10).
  5739
  5740             20  CF-LF-COVERAGE-TYPE        PIC X.
  5741                 88  CF-REDUCING                VALUE 'R'.
  5742                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5743
  5744             20  CF-SPECIAL-CALC-CD         PIC X.
  5745                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5746                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5747                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5748                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5749                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5750                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5751                 88  CF-FARM-PLAN               VALUE 'F'.
  5752                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5753                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5754                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5755                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5756                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5757                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5758                 88  CF-PRUDENTIAL              VALUE 'P'.
  5759                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5760                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5761                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5762                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5763                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5764                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5765
  5766             20  CF-JOINT-INDICATOR         PIC X.
  5767                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5768
  5769*            20  FILLER                     PIC X(12).
  5770             20  FILLER                     PIC X(11).
  5771             20  CF-BENEFIT-CATEGORY        PIC X.
  5772             20  CF-LOAN-TYPE               PIC X(8).
  5773
  5774             20  CF-CO-REM-TERM-CALC        PIC X.
  5775                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5776                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5777                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5778                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5779                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5780
  5781             20  CF-CO-EARNINGS-CALC        PIC X.
  5782                 88  CO-EARN-BY-R78             VALUE '1'.
  5783                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5784                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5785                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5786                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5787                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5788                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5789                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5790
  5791             20  CF-CO-REFUND-CALC          PIC X.
  5792                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5793                 88  CO-REFD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 112
* EL689.cbl
  5794                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5795                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5796                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5797                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5798                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5799                 88  CO-REFD-MEAN               VALUE '8'.
  5800                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5801                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5802                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5803
  5804             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5805                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5806                 88  CO-OVRD-BY-R78             VALUE '1'.
  5807                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5808                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5809                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5810                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5811                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5812                 88  CO-OVRD-MEAN               VALUE '8'.
  5813                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5814
  5815             20  CF-CO-BEN-I-G-CD           PIC X.
  5816                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5817                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5818                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5819
  5820         16  FILLER                         PIC X(304).
  5821
  5822
  5823****************************************************************
  5824*             CARRIER MASTER RECORD                            *
  5825****************************************************************
  5826
  5827     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5828         16  CF-ADDRESS-DATA.
  5829             20  CF-MAIL-TO-NAME            PIC X(30).
  5830             20  CF-IN-CARE-OF              PIC X(30).
  5831             20  CF-ADDRESS-LINE-1          PIC X(30).
  5832             20  CF-ADDRESS-LINE-2          PIC X(30).
  5833             20  CF-CITY-STATE              PIC X(30).
  5834             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5835             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5836
  5837         16  CF-CLAIM-NO-CONTROL.
  5838             20  CF-CLAIM-NO-METHOD         PIC X.
  5839                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5840                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5841                 88  CLAIM-NO-SEQ               VALUE '3'.
  5842                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5843             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5844                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5845                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5846                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5847
  5848         16  CF-CHECK-NO-CONTROL.
  5849             20  CF-CHECK-NO-METHOD         PIC X.
  5850                 88  CHECK-NO-MANUAL            VALUE '1'.
  5851                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 113
* EL689.cbl
  5852                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5853                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5854             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5855                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5856
  5857         16  CF-DOMICILE-STATE              PIC XX.
  5858
  5859         16  CF-EXPENSE-CONTROLS.
  5860             20  CF-EXPENSE-METHOD          PIC X.
  5861                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5862                 88  DOLLARS-PER-PMT            VALUE '2'.
  5863                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5864                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5865             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5866             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5867
  5868         16  CF-CORRESPONDENCE-CONTROL.
  5869             20  CF-LETTER-RESEND-OPT       PIC X.
  5870                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5871                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5872             20  FILLER                     PIC X(4).
  5873
  5874         16  CF-RESERVE-CONTROLS.
  5875             20  CF-MANUAL-SW               PIC X.
  5876                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5877             20  CF-FUTURE-SW               PIC X.
  5878                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5879             20  CF-PTC-SW                  PIC X.
  5880                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5881             20  CF-IBNR-SW                 PIC X.
  5882                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5883             20  CF-PTC-LF-SW               PIC X.
  5884                 88  CF-LF-PTC-USED             VALUE '1'.
  5885             20  CF-CDT-ACCESS-METHOD       PIC X.
  5886                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5887                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5888                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5889             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5890
  5891         16  CF-CLAIM-CALC-METHOD           PIC X.
  5892             88  360-PLUS-MONTHS                VALUE '1'.
  5893             88  365-PLUS-MONTHS                VALUE '2'.
  5894             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5895             88  360-DAILY                      VALUE '4'.
  5896             88  365-DAILY                      VALUE '5'.
  5897
  5898         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5899         16  FILLER                         PIC X(11).
  5900
  5901         16  CF-LIMIT-AMOUNTS.
  5902             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5903             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5904             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5905             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5906             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5907             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5908             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5909             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 114
* EL689.cbl
  5910             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5911             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5912
  5913         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5914         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5915         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5916
  5917         16  CF-ZIP-CODE.
  5918             20  CF-ZIP-PRIME.
  5919                 24  CF-ZIP-1ST             PIC X.
  5920                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5921                 24  FILLER                 PIC X(4).
  5922             20  CF-ZIP-PLUS4               PIC X(4).
  5923         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5924             20  CF-CAN-POSTAL-1            PIC XXX.
  5925             20  CF-CAN-POSTAL-2            PIC XXX.
  5926             20  FILLER                     PIC XXX.
  5927
  5928         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5929         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5930         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5931
  5932         16  CF-RATING-SWITCH               PIC X.
  5933             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5934             88  CF-NO-RATING                   VALUE 'N'.
  5935
  5936         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5937
  5938         16  CF-CARRIER-OVER-SHORT.
  5939             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5940             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5941
  5942         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5943         16  CF-SECPAY-SWITCH               PIC X.
  5944             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5945             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5946         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5947         16  FILLER                         PIC X(448).
  5948*        16  FILLER                         PIC X(452).
  5949
  5950
  5951****************************************************************
  5952*             MORTALITY MASTER RECORD                          *
  5953****************************************************************
  5954
  5955     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5956         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5957                                INDEXED BY CF-MORT-NDX.
  5958             20  CF-MORT-TABLE              PIC X(5).
  5959             20  CF-MORT-TABLE-TYPE         PIC X.
  5960                 88  CF-MORT-JOINT              VALUE 'J'.
  5961                 88  CF-MORT-SINGLE             VALUE 'S'.
  5962                 88  CF-MORT-COMBINED           VALUE 'C'.
  5963                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5964                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5965             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5966             20  CF-MORT-AGE-METHOD         PIC XX.
  5967                 88  CF-AGE-LAST                VALUE 'AL'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 115
* EL689.cbl
  5968                 88  CF-AGE-NEAR                VALUE 'AN'.
  5969             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5970             20  CF-MORT-ADJUSTMENT-DIRECTION
  5971                                            PIC X.
  5972                 88  CF-MINUS                   VALUE '-'.
  5973                 88  CF-PLUS                    VALUE '+'.
  5974             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5975             20  CF-MORT-JOINT-CODE         PIC X.
  5976                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5977             20  CF-MORT-PC-Q               PIC X.
  5978                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5979             20  CF-MORT-TABLE-CODE         PIC X(4).
  5980             20  CF-MORT-COMMENTS           PIC X(15).
  5981             20  FILLER                     PIC X(14).
  5982
  5983         16  FILLER                         PIC X(251).
  5984
  5985
  5986****************************************************************
  5987*             BUSSINESS TYPE MASTER RECORD                     *
  5988****************************************************************
  5989
  5990     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5991* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5992* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5993* AND RECORD 05 IS TYPES 81-99
  5994         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5995             20  CF-BUSINESS-TITLE          PIC  X(19).
  5996             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5997                                            PIC S9V9(4) COMP-3.
  5998             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5999             20  FILLER                     PIC  X.
  6000         16  FILLER                         PIC  X(248).
  6001
  6002
  6003****************************************************************
  6004*             TERMINAL MASTER RECORD                           *
  6005****************************************************************
  6006
  6007     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6008
  6009         16  CF-COMPANY-TERMINALS.
  6010             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6011                                  PIC X(4).
  6012         16  FILLER               PIC X(248).
  6013
  6014
  6015****************************************************************
  6016*             LIFE EDIT MASTER RECORD                          *
  6017****************************************************************
  6018
  6019     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6020         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6021             20  CF-LIFE-CODE-IN            PIC XX.
  6022             20  CF-LIFE-CODE-OUT           PIC XX.
  6023         16  FILLER                         PIC X(248).
  6024
  6025
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 116
* EL689.cbl
  6026****************************************************************
  6027*             AH EDIT MASTER RECORD                            *
  6028****************************************************************
  6029
  6030     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6031         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6032             20  CF-AH-CODE-IN              PIC XXX.
  6033             20  CF-AH-CODE-OUT             PIC XX.
  6034         16  FILLER                         PIC X(248).
  6035
  6036
  6037****************************************************************
  6038*             CREDIBILITY TABLES                               *
  6039****************************************************************
  6040
  6041     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6042         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6043                             INDEXED BY CF-CRDB-NDX.
  6044             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6045             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6046             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6047         16  FILLER                         PIC  X(332).
  6048
  6049
  6050****************************************************************
  6051*             REPORT CUSTOMIZATION RECORD                      *
  6052****************************************************************
  6053
  6054     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6055         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6056             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6057             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6058             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6059**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6060****       A T-TRANSFER.                                   ****
  6061             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6062
  6063         16  FILLER                         PIC XX.
  6064
  6065         16  CF-CARRIER-CNTL-OPT.
  6066             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6067                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6068                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6069             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6070                                            PIC X.
  6071         16  CF-GROUP-CNTL-OPT.
  6072             20  CF-GROUP-OPT-SEQ           PIC 9.
  6073                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6074                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6075             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6076                                            PIC X(6).
  6077         16  CF-STATE-CNTL-OPT.
  6078             20  CF-STATE-OPT-SEQ           PIC 9.
  6079                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6080                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6081             20  CF-STATE-SELECT OCCURS 3 TIMES
  6082                                            PIC XX.
  6083         16  CF-ACCOUNT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 117
* EL689.cbl
  6084             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6085                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6086                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6087             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6088                                            PIC X(10).
  6089         16  CF-BUS-TYP-CNTL-OPT.
  6090             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6091                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6092                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6093             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6094                                            PIC XX.
  6095         16  CF-LF-TYP-CNTL-OPT.
  6096             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6097                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6098                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6099             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6100                                            PIC XX.
  6101         16  CF-AH-TYP-CNTL-OPT.
  6102             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6103                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6104                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6105             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6106                                            PIC XX.
  6107         16  CF-REPTCD1-CNTL-OPT.
  6108             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6109                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6110                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6111             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6112                                            PIC X(10).
  6113         16  CF-REPTCD2-CNTL-OPT.
  6114             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6115                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6116                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6117             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6118                                            PIC X(10).
  6119         16  CF-USER1-CNTL-OPT.
  6120             20  CF-USER1-OPT-SEQ           PIC 9.
  6121                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6122                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6123             20  CF-USER1-SELECT OCCURS 3 TIMES
  6124                                            PIC X(10).
  6125         16  CF-USER2-CNTL-OPT.
  6126             20  CF-USER2-OPT-SEQ           PIC 9.
  6127                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6128                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6129             20  CF-USER2-SELECT OCCURS 3 TIMES
  6130                                            PIC X(10).
  6131         16  CF-USER3-CNTL-OPT.
  6132             20  CF-USER3-OPT-SEQ           PIC 9.
  6133                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6134                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6135             20  CF-USER3-SELECT OCCURS 3 TIMES
  6136                                            PIC X(10).
  6137         16  CF-USER4-CNTL-OPT.
  6138             20  CF-USER4-OPT-SEQ           PIC 9.
  6139                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6140                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6141             20  CF-USER4-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 118
* EL689.cbl
  6142                                            PIC X(10).
  6143         16  CF-USER5-CNTL-OPT.
  6144             20  CF-USER5-OPT-SEQ           PIC 9.
  6145                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6146                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6147             20  CF-USER5-SELECT OCCURS 3 TIMES
  6148                                            PIC X(10).
  6149         16  CF-REINS-CNTL-OPT.
  6150             20  CF-REINS-OPT-SEQ           PIC 9.
  6151                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6152                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6153             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6154                 24  CF-REINS-PRIME         PIC XXX.
  6155                 24  CF-REINS-SUB           PIC XXX.
  6156
  6157         16  CF-AGENT-CNTL-OPT.
  6158             20  CF-AGENT-OPT-SEQ           PIC 9.
  6159                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6160                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6161             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6162                                            PIC X(10).
  6163
  6164         16  FILLER                         PIC X(43).
  6165
  6166         16  CF-LOSS-RATIO-SELECT.
  6167             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6168             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6169         16  CF-ENTRY-DATE-SELECT.
  6170             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6171             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6172         16  CF-EFFECTIVE-DATE-SELECT.
  6173             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6174             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6175
  6176         16  CF-EXCEPTION-LIST-IND          PIC X.
  6177             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6178
  6179         16  FILLER                         PIC X(318).
  6180
  6181****************************************************************
  6182*                  EXCEPTION REPORTING RECORD                  *
  6183****************************************************************
  6184
  6185     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6186         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6187             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6188
  6189         16  CF-COMBINED-LIFE-AH-OPT.
  6190             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6191             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6192             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6193             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6194
  6195         16  CF-LIFE-OPT.
  6196             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6197             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6198             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6199             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 119
* EL689.cbl
  6200             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6201             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6202             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6203             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6204             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6205             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6206
  6207         16  CF-AH-OPT.
  6208             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6209             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6210             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6211             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6212             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6213             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6214             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6215             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6216             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6217             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6218
  6219         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6220             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6221             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6222             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6223
  6224         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6225
  6226         16  FILLER                         PIC X(673).
  6227
  6228
  6229****************************************************************
  6230*             MORTGAGE SYSTEM PLAN RECORD                      *
  6231****************************************************************
  6232
  6233     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6234         16  CF-PLAN-TYPE                   PIC X.
  6235             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6236             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6237             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6238         16  CF-PLAN-ABBREV                 PIC XXX.
  6239         16  CF-PLAN-DESCRIPT               PIC X(10).
  6240         16  CF-PLAN-NOTES                  PIC X(20).
  6241         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6242         16  CF-PLAN-UNDERWRITING.
  6243             20  CF-PLAN-TERM-DATA.
  6244                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6245                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6246             20  CF-PLAN-AGE-DATA.
  6247                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6248                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6249                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6250             20  CF-PLAN-BENEFIT-DATA.
  6251                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6252                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6253                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6254                                            PIC S9(7)V99  COMP-3.
  6255         16  CF-PLAN-POLICY-FORMS.
  6256             20  CF-POLICY-FORM             PIC X(12).
  6257             20  CF-MASTER-APPLICATION      PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 120
* EL689.cbl
  6258             20  CF-MASTER-POLICY           PIC X(12).
  6259         16  CF-PLAN-RATING.
  6260             20  CF-RATE-CODE               PIC X(5).
  6261             20  CF-SEX-RATING              PIC X.
  6262                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6263                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6264             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6265             20  CF-SUB-STD-TYPE            PIC X.
  6266                 88  CF-PCT-OF-PREM            VALUE '1'.
  6267                 88  CF-PCT-OF-BENE            VALUE '2'.
  6268         16  CF-PLAN-PREM-TOLERANCES.
  6269             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6270             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6271         16  CF-PLAN-PYMT-TOLERANCES.
  6272             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6273             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6274         16  CF-PLAN-MISC-DATA.
  6275             20  FILLER                     PIC X.
  6276             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6277             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6278         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6279         16  CF-PLAN-IND-GRP                PIC X.
  6280             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6281                                                     '1'.
  6282             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6283                                                     '2'.
  6284         16  CF-MIB-SEARCH-SW               PIC X.
  6285             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6286             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6287             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6288             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6289         16  CF-ALPHA-SEARCH-SW             PIC X.
  6290             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6291             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6292             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6293             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6294             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6295             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6296             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6297             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6298             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6299             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6300                                                     'A' 'B' 'C'
  6301                                                     'X' 'Y' 'Z'.
  6302         16  CF-EFF-DT-RULE-SW              PIC X.
  6303             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6304             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6305             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6306             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6307             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6308         16  FILLER                         PIC X(4).
  6309         16  CF-HEALTH-QUESTIONS            PIC X.
  6310             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6311         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6312         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6313         16  CF-PLAN-SNGL-JNT               PIC X.
  6314             88  CF-COMBINED-PLAN              VALUE 'C'.
  6315             88  CF-JNT-PLAN                   VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 121
* EL689.cbl
  6316             88  CF-SNGL-PLAN                  VALUE 'S'.
  6317         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6318         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6319         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6320         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6321         16  CF-RERATE-CNTL                 PIC  X.
  6322             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6323             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6324             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6325             88  CF-AUTO-RECALC                 VALUE '4'.
  6326         16  CF-BENEFIT-TYPE                PIC  X.
  6327             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6328             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6329         16  CF-POLICY-FEE                  PIC S999V99
  6330                                                    COMP-3.
  6331         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6332         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6333         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6334         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6335         16  FILLER                         PIC  X(32).
  6336         16  CF-TERMINATION-FORM            PIC  X(04).
  6337         16  FILLER                         PIC  X(08).
  6338         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6339                                                       COMP-3.
  6340         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6341         16  CF-ISSUE-LETTER                PIC  X(4).
  6342         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6343         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6344             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6345             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6346         16  CF-MP-REFUND-CALC              PIC X.
  6347             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6348             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6349             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6350             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6351             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6352             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6353             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6354             88  CF-MP-REFD-MEAN                VALUE '8'.
  6355         16  CF-ALT-RATE-CODE               PIC  X(5).
  6356
  6357
  6358         16  FILLER                         PIC X(498).
  6359****************************************************************
  6360*             MORTGAGE COMPANY MASTER RECORD                   *
  6361****************************************************************
  6362
  6363     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6364         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6365         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6366             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6367             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6368             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6369             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6370             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6371
  6372         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6373         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 122
* EL689.cbl
  6374         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6375         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6376         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6377
  6378         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6379             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6380         16  CF-MP-RECON-USE-IND            PIC X(1).
  6381             88  CF-MP-USE-RECON             VALUE 'Y'.
  6382         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6383             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6384         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6385             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6386             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6387         16  FILLER                         PIC X(1).
  6388         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6389             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6390         16  CF-MORTG-MIB-VERSION           PIC X.
  6391             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6392             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6393             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6394         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6395             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6396                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6397             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6398                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6399             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6400                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6401             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6402                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6403             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6404                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6405             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6406                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6407         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6408         16  FILLER                         PIC X(7).
  6409         16  CF-MORTG-DESTINATION-SYMBOL.
  6410             20  CF-MORTG-MIB-COMM          PIC X(5).
  6411             20  CF-MORTG-MIB-TERM          PIC X(5).
  6412         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6413             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6414         16  FILLER                         PIC X(03).
  6415         16  CF-MP-CHECK-NO-CONTROL.
  6416             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6417                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6418                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6419                                                ' ' LOW-VALUES.
  6420                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6421                                               VALUE '3'.
  6422         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6423         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6424         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6425             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6426                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6427             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6428                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6429             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6430                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6431             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 123
* EL689.cbl
  6432                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6433             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6434                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6435             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6436                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6437         16  CF-MORTG-BILLING-AREA.
  6438             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6439                                            PIC X.
  6440         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6441         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6442         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6443         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6444             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6445             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6446         16  FILLER                         PIC X.
  6447         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6448             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6449             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6450         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6451         16  FILLER                         PIC X(8).
  6452         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6453         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6454         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6455         16  CF-ACH-COMPANY-ID.
  6456             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6457                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6458                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6459                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6460             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6461         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6462             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6463         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6464             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6465             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6466         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6467         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6468         16  FILLER                         PIC X(536).
  6469
  6470****************************************************************
  6471*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6472****************************************************************
  6473
  6474     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6475         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6476             20  CF-FEMALE-HEIGHT.
  6477                 24  CF-FEMALE-FT           PIC 99.
  6478                 24  CF-FEMALE-IN           PIC 99.
  6479             20  CF-FEMALE-MIN-WT           PIC 999.
  6480             20  CF-FEMALE-MAX-WT           PIC 999.
  6481         16  FILLER                         PIC X(428).
  6482
  6483     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6484         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6485             20  CF-MALE-HEIGHT.
  6486                 24  CF-MALE-FT             PIC 99.
  6487                 24  CF-MALE-IN             PIC 99.
  6488             20  CF-MALE-MIN-WT             PIC 999.
  6489             20  CF-MALE-MAX-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 124
* EL689.cbl
  6490         16  FILLER                         PIC X(428).
  6491******************************************************************
  6492*             AUTOMATIC ACTIVITY RECORD                          *
  6493******************************************************************
  6494     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6495         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6496             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6497             20  CF-SYS-LETTER-ID           PIC X(04).
  6498             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6499             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6500             20  CF-SYS-RESET-SW            PIC X(01).
  6501             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6502             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6503
  6504         16  FILLER                         PIC X(50).
  6505
  6506         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6507             20  CF-USER-ACTIVE-SW          PIC X(01).
  6508             20  CF-USER-LETTER-ID          PIC X(04).
  6509             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6510             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6511             20  CF-USER-RESET-SW           PIC X(01).
  6512             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6513             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6514             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6515
  6516         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 125
* EL689.cbl
  6518*    COPY ERCCOMP.
  6519******************************************************************
  6520*                                                                *
  6521*                                                                *
  6522*                            ERCCOMP                             *
  6523*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6524*                            VMOD=2.019                          *
  6525*                                                                *
  6526*   ONLINE CREDIT SYSTEM                                         *
  6527*                                                                *
  6528*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6529*                                                                *
  6530*   FILE TYPE = VSAM,KSDS                                        *
  6531*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6532*                                                                *
  6533*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6534*       ALTERNATE PATH = NONE                                    *
  6535*                                                                *
  6536*   LOG = NO                                                     *
  6537*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6538*                                                                *
  6539******************************************************************
  6540*                   C H A N G E   L O G
  6541*
  6542* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6543*-----------------------------------------------------------------
  6544*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6545* EFFECTIVE    NUMBER
  6546*-----------------------------------------------------------------
  6547* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6548* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6549* 092205    2005050300006  PEMA  ADD LEASE FEE
  6550* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6551* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6552* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6553* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6554* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6555* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  6556******************************************************************
  6557
  6558 01  COMPENSATION-MASTER.
  6559     12  CO-RECORD-ID                          PIC XX.
  6560         88  VALID-CO-ID                          VALUE 'CO'.
  6561
  6562     12  CO-CONTROL-PRIMARY.
  6563         16  CO-COMPANY-CD                     PIC X.
  6564         16  CO-CONTROL.
  6565             20  CO-CTL-1.
  6566                 24  CO-CARR-GROUP.
  6567                     28  CO-CARRIER            PIC X.
  6568                     28  CO-GROUPING.
  6569                         32  CO-GROUP-PREFIX   PIC XXX.
  6570                         32  CO-GROUP-PRIME    PIC XXX.
  6571                 24  CO-RESP-NO.
  6572                     28  CO-RESP-PREFIX        PIC X(4).
  6573                     28  CO-RESP-PRIME         PIC X(6).
  6574             20  CO-CTL-2.
  6575                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 126
* EL689.cbl
  6576                     28  CO-ACCT-PREFIX        PIC X(4).
  6577                     28  CO-ACCT-PRIME         PIC X(6).
  6578         16  CO-TYPE                           PIC X.
  6579             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6580             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6581             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6582
  6583     12  CO-MAINT-INFORMATION.
  6584         16  CO-LAST-MAINT-DT                  PIC XX.
  6585         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6586         16  CO-LAST-MAINT-USER                PIC X(4).
  6587     12  FILLER                                PIC XX.
  6588     12  CO-STMT-TYPE                          PIC XXX.
  6589     12  CO-COMP-TYPE                          PIC X.
  6590         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6591     12  CO-STMT-OWNER                         PIC X(4).
  6592     12  CO-BALANCE-CONTROL                    PIC X.
  6593         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6594         88  CO-NO-BALANCE                        VALUE 'N'.
  6595
  6596     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6597         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6598         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6599         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6600
  6601     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6602         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6603         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6604
  6605     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6606     12  CO-GA-DIRECT-DEP                      PIC X.
  6607     12  CO-FUTURE-SPACE                       PIC X.
  6608         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6609
  6610     12  CO-ACCT-NAME                          PIC X(30).
  6611     12  CO-MAIL-NAME                          PIC X(30).
  6612     12  CO-ADDR-1                             PIC X(30).
  6613     12  CO-ADDR-2                             PIC X(30).
  6614     12  CO-ADDR-3.
  6615         16  CO-ADDR-CITY                      PIC X(27).
  6616         16  CO-ADDR-STATE                     PIC XX.
  6617     12  CO-CSO-1099                           PIC X.
  6618     12  CO-ZIP.
  6619         16  CO-ZIP-PRIME.
  6620             20  CO-ZIP-PRI-1ST                PIC X.
  6621                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6622             20  FILLER                        PIC X(4).
  6623         16  CO-ZIP-PLUS4                      PIC X(4).
  6624     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6625         16  CO-CAN-POSTAL-1                   PIC XXX.
  6626         16  CO-CAN-POSTAL-2                   PIC XXX.
  6627         16  FILLER                            PIC XXX.
  6628     12  CO-SOC-SEC                            PIC X(13).
  6629     12  CO-TELEPHONE.
  6630         16  CO-AREA-CODE                      PIC XXX.
  6631         16  CO-PREFIX                         PIC XXX.
  6632         16  CO-PHONE                          PIC X(4).
  6633
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 127
* EL689.cbl
  6634     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  6635
  6636     12  CO-AR-BAL-LEVEL                       PIC X.
  6637         88  CO-AR-REF-LVL                        VALUE '1'.
  6638         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6639         88  CO-AR-BILL-LVL                       VALUE '2'.
  6640         88  CO-AR-AGT-LVL                        VALUE '3'.
  6641         88  CO-AR-FR-LVL                         VALUE '4'.
  6642
  6643     12  CO-AR-NORMAL-PRINT                    PIC X.
  6644         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6645         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6646
  6647     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6648
  6649     12  CO-AR-REPORTING                       PIC X.
  6650         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6651         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6652
  6653     12  CO-AR-PULL-CHECK                      PIC X.
  6654         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6655         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6656
  6657     12  CO-AR-BALANCE-PRINT                   PIC X.
  6658         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6659
  6660     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6661         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6662         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6663         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6664
  6665     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6666
  6667     12  CO-USER-CODE                          PIC X.
  6668     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6669
  6670******************************************************************
  6671*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6672*    THE LAST MONTH END RUN.
  6673******************************************************************
  6674
  6675     12  CO-LAST-ACTIVITY-DATE.
  6676         16  CO-ACT-YEAR                       PIC 99.
  6677         16  CO-ACT-MONTH                      PIC 99.
  6678         16  CO-ACT-DAY                        PIC 99.
  6679
  6680     12  CO-LAST-STMT-DT.
  6681         16  CO-LAST-STMT-YEAR                 PIC 99.
  6682         16  CO-LAST-STMT-MONTH                PIC 99.
  6683         16  CO-LAST-STMT-DAY                  PIC 99.
  6684
  6685     12  CO-MO-END-TOTALS.
  6686         16  CO-MONTHLY-TOTALS.
  6687             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6688             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6689             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6690             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6691             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 128
* EL689.cbl
  6692
  6693         16  CO-AGING-TOTALS.
  6694             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6695             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6696             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6697             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6698
  6699         16  CO-YTD-TOTALS.
  6700             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6701             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6702
  6703         16  CO-OVER-UNDER-TOTALS.
  6704             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6705             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6706
  6707     12  CO-MISCELLANEOUS-TOTALS.
  6708         16  CO-FICA-TOTALS.
  6709             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6710             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6711
  6712         16  CO-CLAIM-TOTALS.
  6713             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6714             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6715
  6716******************************************************************
  6717*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6718*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6719******************************************************************
  6720
  6721     12  CO-CURRENT-TOTALS.
  6722         16  CO-CURRENT-LAST-STMT-DT.
  6723             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6724             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6725             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6726
  6727         16  CO-CURRENT-MONTHLY-TOTALS.
  6728             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6729             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6730             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6731             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6732             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6733
  6734         16  CO-CURRENT-AGING-TOTALS.
  6735             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6736             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6737             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6738             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6739
  6740         16  CO-CURRENT-YTD-TOTALS.
  6741             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6742             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6743
  6744     12  CO-PAID-COMM-TOTALS.
  6745         16  CO-YTD-PAID-COMMS.
  6746             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6747             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6748
  6749     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 129
* EL689.cbl
  6750         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  6751         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6752
  6753     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6754         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6755         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6756         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6757         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6758         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  6759         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  6760         88  CO-FINAL-LETTER                  VALUE 'F'.
  6761         88  CO-RECONCILING                   VALUE 'R'.
  6762         88  CO-PHONE-CALL                    VALUE 'P'.
  6763         88  CO-LEGAL                         VALUE 'L'.
  6764         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  6765         88  CO-WRITE-OFF                     VALUE 'W'.
  6766         88  CO-NO-ACTION                     VALUE 'N' ' '.
  6767
  6768     12  CO-CSR-CODE                       PIC X(4).
  6769
  6770     12  CO-GA-STATUS-INFO.
  6771         16  CO-GA-EFFECTIVE-DT            PIC XX.
  6772         16  CO-GA-TERMINATION-DT          PIC XX.
  6773         16  CO-GA-STATUS-CODE             PIC X.
  6774             88  CO-GA-ACTIVE                 VALUE 'A'.
  6775             88  CO-GA-INACTIVE               VALUE 'I'.
  6776             88  CO-GA-PENDING                VALUE 'P'.
  6777         16  CO-GA-COMMENTS.
  6778             20  CO-GA-COMMENT-1           PIC X(40).
  6779             20  CO-GA-COMMENT-2           PIC X(40).
  6780             20  CO-GA-COMMENT-3           PIC X(40).
  6781             20  CO-GA-COMMENT-4           PIC X(40).
  6782
  6783     12  CO-RPTCD2                         PIC X(10).
  6784     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  6785         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  6786         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  6787
  6788     12  CO-TYPE-AGENT                     PIC X(01).
  6789         88  CO-CORPORATION                   VALUE 'C'.
  6790         88  CO-PARTNERSHIP                   VALUE 'P'.
  6791         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  6792         88  CO-TRUST                         VALUE 'T'.
  6793         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  6794
  6795     12  CO-FAXNO.
  6796         16  CO-FAX-AREA-CODE                  PIC XXX.
  6797         16  CO-FAX-PREFIX                     PIC XXX.
  6798         16  CO-FAX-PHONE                      PIC X(4).
  6799
  6800     12  CO-BANK-INFORMATION.
  6801         16  CO-BANK-TRANSIT-NO                PIC X(8).
  6802         16  CO-BANK-TRANSIT-NON REDEFINES
  6803             CO-BANK-TRANSIT-NO                PIC 9(8).
  6804
  6805         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  6806     12  CO-MISC-DEDUCT-INFO REDEFINES
  6807                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 130
* EL689.cbl
  6808         16  CO-MD-GL-ACCT                     PIC X(10).
  6809         16  CO-MD-DIV                         PIC XX.
  6810         16  CO-MD-CENTER                      PIC X(4).
  6811         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  6812         16  CO-CREATE-AP-CHECK                PIC X.
  6813         16  CO-DELIVER-CK-TO-MEL              PIC X.
  6814         16  FILLER                            PIC XXX.
  6815     12  CO-ACH-STATUS                         PIC X.
  6816         88  CO-ACH-ACTIVE                         VALUE 'A'.
  6817         88  CO-ACH-PENDING                        VALUE 'P'.
  6818
  6819     12  CO-BILL-SW                            PIC X.
  6820     12  CO-CONTROL-NAME                       PIC X(30).
  6821     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  6822     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  6823     12  CO-CLP-STATE                          PIC XX.
  6824     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  6825     12  CO-SPP-REFUND-EDIT                    PIC X.
  6826
  6827******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 131
* EL689.cbl
  6829*    COPY ERCMAIL.
  6830******************************************************************
  6831*                                                                *
  6832*                                                                *
  6833*                            ERCMAIL                             *
  6834*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6835*                            VMOD=2.003                          *
  6836*                                                                *
  6837*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6838*                                                                *
  6839*   FILE TYPE = VSAM,KSDS                                        *
  6840*   RECORD SIZE = 374   RECFORM = FIX                            *
  6841*                                                                *
  6842*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6843*   ALTERNATE PATH    = NOT USED                                 *
  6844*                                                                *
  6845*   LOG = YES                                                    *
  6846*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6847******************************************************************
  6848*                   C H A N G E   L O G
  6849*
  6850* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6851*-----------------------------------------------------------------
  6852*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6853* EFFECTIVE    NUMBER
  6854*-----------------------------------------------------------------
  6855* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6856* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6857* 111108                   PEMA  ADD CRED BENE ADDR2
  6858******************************************************************
  6859
  6860 01  MAILING-DATA.
  6861     12  MA-RECORD-ID                      PIC XX.
  6862         88  VALID-MA-ID                       VALUE 'MA'.
  6863
  6864     12  MA-CONTROL-PRIMARY.
  6865         16  MA-COMPANY-CD                 PIC X.
  6866         16  MA-CARRIER                    PIC X.
  6867         16  MA-GROUPING.
  6868             20  MA-GROUPING-PREFIX        PIC XXX.
  6869             20  MA-GROUPING-PRIME         PIC XXX.
  6870         16  MA-STATE                      PIC XX.
  6871         16  MA-ACCOUNT.
  6872             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6873             20  MA-ACCOUNT-PRIME          PIC X(6).
  6874         16  MA-CERT-EFF-DT                PIC XX.
  6875         16  MA-CERT-NO.
  6876             20  MA-CERT-PRIME             PIC X(10).
  6877             20  MA-CERT-SFX               PIC X.
  6878
  6879     12  FILLER                            PIC XX.
  6880
  6881     12  MA-ACCESS-CONTROL.
  6882         16  MA-SOURCE-SYSTEM              PIC XX.
  6883             88  MA-FROM-CREDIT                VALUE 'CR'.
  6884             88  MA-FROM-VSI                   VALUE 'VS'.
  6885             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6886             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 132
* EL689.cbl
  6887         16  MA-RECORD-ADD-DT              PIC XX.
  6888         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6889         16  MA-LAST-MAINT-DT              PIC XX.
  6890         16  MA-LAST-MAINT-BY              PIC XXXX.
  6891         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6892
  6893     12  MA-PROFILE-INFO.
  6894         16  MA-QUALIFY-CODE-1             PIC XX.
  6895         16  MA-QUALIFY-CODE-2             PIC XX.
  6896         16  MA-QUALIFY-CODE-3             PIC XX.
  6897         16  MA-QUALIFY-CODE-4             PIC XX.
  6898         16  MA-QUALIFY-CODE-5             PIC XX.
  6899
  6900         16  MA-INSURED-LAST-NAME          PIC X(15).
  6901         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6902         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6903         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6904         16  MA-INSURED-BIRTH-DT           PIC XX.
  6905         16  MA-INSURED-SEX                PIC X.
  6906             88  MA-SEX-MALE                   VALUE 'M'.
  6907             88  MA-SEX-FEMALE                 VALUE 'F'.
  6908         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6909
  6910         16  MA-ADDRESS-CORRECTED          PIC X.
  6911         16  MA-JOINT-BIRTH-DT             PIC XX.
  6912*        16  FILLER                        PIC X(12).
  6913
  6914         16  MA-ADDRESS-LINE-1             PIC X(30).
  6915         16  MA-ADDRESS-LINE-2             PIC X(30).
  6916         16  MA-CITY-STATE.
  6917             20  MA-CITY                   PIC X(28).
  6918             20  MA-ADDR-STATE             PIC XX.
  6919         16  MA-ZIP.
  6920             20  MA-ZIP-CODE.
  6921                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6922                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6923                 24  FILLER                PIC X(4).
  6924             20  MA-ZIP-PLUS4              PIC X(4).
  6925         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6926             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6927             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6928             20  FILLER                    PIC X(3).
  6929
  6930         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6931
  6932         16  FILLER                        PIC XXX.
  6933*        16  FILLER                        PIC X(10).
  6934
  6935     12  MA-CRED-BENE-INFO.
  6936         16  MA-CRED-BENE-NAME                 PIC X(25).
  6937         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6938         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6939         16  MA-CRED-BENE-CTYST.
  6940             20  MA-CRED-BENE-CITY             PIC X(28).
  6941             20  MA-CRED-BENE-STATE            PIC XX.
  6942         16  MA-CRED-BENE-ZIP.
  6943             20  MA-CB-ZIP-CODE.
  6944                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 133
* EL689.cbl
  6945                     88  MA-CB-CANADIAN-POST-CODE
  6946                                           VALUE 'A' THRU 'Z'.
  6947                 24  FILLER                    PIC X(4).
  6948             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6949         16  MA-CB-CANADIAN-POSTAL-CODE
  6950                            REDEFINES MA-CRED-BENE-ZIP.
  6951             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6952             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6953             20  FILLER                        PIC X(3).
  6954     12  MA-POST-CARD-MAIL-DATA.
  6955         16  MA-MAIL-DATA OCCURS 7.
  6956             20  MA-MAIL-TYPE              PIC X.
  6957                 88  MA-12MO-MAILING           VALUE '1'.
  6958                 88  MA-EXP-MAILING            VALUE '2'.
  6959             20  MA-MAIL-STATUS            PIC X.
  6960                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6961                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6962                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6963             20  MA-MAIL-DATE              PIC XX.
  6964     12  FILLER                            PIC XX.
  6965     12  FILLER                            PIC XX.
  6966*    12  FILLER                            PIC X(30).
  6967******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 134
* EL689.cbl
  6969*    COPY ERCPNDB.
  6970******************************************************************
  6971*                                                                *
  6972*                                                                *
  6973*                            ERCPNDB.                            *
  6974*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6975*                            VMOD=2.025                          *
  6976*                                                                *
  6977*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  6978*                                                                *
  6979******************************************************************
  6980*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  6981*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  6982******************************************************************
  6983*                                                                *
  6984*                                                                *
  6985*   FILE TYPE = VSAM,KSDS                                        *
  6986*   RECORD SIZE = 585  RECFORM = FIXED                           *
  6987*                                                                *
  6988*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  6989*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  6990*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  6991*                                                 RKP=13,LEN=36  *
  6992*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  6993*                                      AND CHG-SEQ.)             *
  6994*                                                RKP=49,LEN=11   *
  6995*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  6996*                                      AND CHG-SEQ.)             *
  6997*                                                RKP=60,LEN=15   *
  6998*                                                                *
  6999*   LOG = NO                                                     *
  7000*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7001******************************************************************
  7002******************************************************************
  7003*                   C H A N G E   L O G
  7004*
  7005* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7006*-----------------------------------------------------------------
  7007*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7008* EFFECTIVE    NUMBER
  7009*-----------------------------------------------------------------
  7010* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7011* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7012* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7013* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  7014* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  7015* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  7016* 032306                   PEMA  ADD BOW LOAN NUMBER
  7017* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  7018* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7019* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7020* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7021* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  7022* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7023* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7024* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  7025******************************************************************
  7026
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 135
* EL689.cbl
  7027 01  PENDING-BUSINESS.
  7028     12  PB-RECORD-ID                     PIC XX.
  7029         88  VALID-PB-ID                        VALUE 'PB'.
  7030
  7031     12  PB-CONTROL-PRIMARY.
  7032         16  PB-COMPANY-CD                PIC X.
  7033         16  PB-ENTRY-BATCH               PIC X(6).
  7034         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  7035         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  7036
  7037     12  PB-CONTROL-BY-ACCOUNT.
  7038         16  PB-COMPANY-CD-A1             PIC X.
  7039         16  PB-CARRIER                   PIC X.
  7040         16  PB-GROUPING.
  7041             20  PB-GROUPING-PREFIX       PIC XXX.
  7042             20  PB-GROUPING-PRIME        PIC XXX.
  7043         16  PB-STATE                     PIC XX.
  7044         16  PB-ACCOUNT.
  7045             20  PB-ACCOUNT-PREFIX        PIC X(4).
  7046             20  PB-ACCOUNT-PRIME         PIC X(6).
  7047         16  PB-CERT-EFF-DT               PIC XX.
  7048         16  PB-CERT-NO.
  7049             20  PB-CERT-PRIME            PIC X(10).
  7050             20  PB-CERT-SFX              PIC X.
  7051         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  7052
  7053         16  PB-RECORD-TYPE               PIC X.
  7054             88  PB-MAILING-DATA                VALUE '0'.
  7055             88  PB-ISSUE                       VALUE '1'.
  7056             88  PB-CANCELLATION                VALUE '2'.
  7057             88  PB-BATCH-TRAILER               VALUE '9'.
  7058
  7059     12  PB-CONTROL-BY-ORIG-BATCH.
  7060         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  7061         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  7062         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  7063         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  7064
  7065     12  PB-CONTROL-BY-CSR.
  7066         16  PB-CSR-COMPANY-CD            PIC X.
  7067         16  PB-CSR-ID                    PIC X(4).
  7068         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  7069         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  7070         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  7071******************************************************************
  7072*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  7073******************************************************************
  7074
  7075     12  PB-LAST-MAINT-DT                 PIC XX.
  7076     12  PB-LAST-MAINT-BY                 PIC X(4).
  7077     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7078
  7079     12  PB-RECORD-BODY                   PIC X(375).
  7080
  7081     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  7082         16  PB-CERT-ORIGIN               PIC X.
  7083             88  CLASIC-CREATED-CERT         VALUE '1'.
  7084         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 136
* EL689.cbl
  7085             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  7086             20  PB-I-INSURED-FIRST-NAME.
  7087                 24  PB-I-INSURED-1ST-INIT PIC X.
  7088                 24  FILLER                PIC X(9).
  7089             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  7090         16  PB-I-AGE                     PIC S99   COMP-3.
  7091         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  7092         16  PB-I-BIRTHDAY                PIC XX.
  7093         16  PB-I-INSURED-SEX             PIC X.
  7094             88  PB-SEX-MALE     VALUE 'M'.
  7095             88  PB-SEX-FEMALE   VALUE 'F'.
  7096
  7097         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  7098         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  7099         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  7100         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  7101         16  PB-I-SKIP-CODE               PIC X.
  7102             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  7103             88  PB-SKIP-JULY              VALUE '1'.
  7104             88  PB-SKIP-AUGUST            VALUE '2'.
  7105             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  7106             88  PB-SKIP-JULY-AUG          VALUE '4'.
  7107             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  7108             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  7109             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  7110             88  PB-SKIP-JUNE              VALUE '8'.
  7111             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  7112             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  7113             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  7114         16  PB-I-TERM-TYPE               PIC X.
  7115             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  7116             88  PB-PAID-WEEKLY            VALUE 'W'.
  7117             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  7118             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  7119             88  PB-PAID-13-YEARLY         VALUE 'T'.
  7120         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  7121         16  PB-I-POLICY-FORM-NO          PIC X(12).
  7122         16  PB-I-DATA-ENTRY-SW           PIC X.
  7123             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  7124             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  7125             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  7126             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  7127         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  7128         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  7129*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  7130         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  7131         16  FILLER                       PIC X.
  7132
  7133         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  7134             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  7135             88  PB-INVALID-LIFE             VALUE '  ' '00'
  7136                                                   '90' THRU '99'.
  7137         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  7138                                          PIC XX.
  7139         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  7140         16  PB-I-AMOUNT-FINANCED REDEFINES
  7141                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  7142         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 137
* EL689.cbl
  7143         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  7144                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  7145         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7146         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  7147         16  PB-I-CLP-AMOUNT REDEFINES
  7148                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  7149         16  PB-I-LF-CALC-FLAG            PIC X.
  7150             88 PB-COMP-LF-PREM               VALUE '?'.
  7151         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  7152         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  7153         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  7154         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  7155         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7156         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  7157         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  7158         16  PB-I-LF-ABBR                 PIC XXX.
  7159         16  PB-I-LF-INPUT-CD             PIC XX.
  7160
  7161         16  PB-I-AH-BENEFIT-CD           PIC XX.
  7162             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  7163             88  PB-INVALID-AH               VALUE '  ' '00'
  7164                                                   '90' THRU '99'.
  7165         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  7166         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7167         16  PB-I-AH-CALC-FLAG            PIC X.
  7168             88 PB-COMP-AH-PREM                  VALUE '?'.
  7169         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  7170         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  7171         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7172         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  7173         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  7174         16  PB-I-AH-ABBR                 PIC XXX.
  7175         16  PB-I-AH-INPUT-CD             PIC XXX.
  7176
  7177         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  7178         16  PB-I-REIN-TABLE              PIC XXX.
  7179         16  PB-I-BUSINESS-TYPE           PIC 99.
  7180         16  PB-I-INDV-GRP-CD             PIC X.
  7181         16  PB-I-MORT-CODE.
  7182             20  PB-I-TABLE               PIC X.
  7183             20  PB-I-INTEREST            PIC XX.
  7184             20  PB-I-MORT-TYP            PIC X.
  7185         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  7186         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  7187         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  7188         16  PB-I-INDV-GRP-OVRD           PIC X.
  7189         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  7190         16  PB-I-SIG-SW                  PIC X.
  7191             88  PB-POLICY-SIGNED             VALUE 'Y'.
  7192         16  PB-I-RATE-CLASS              PIC XX.
  7193         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  7194         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  7195         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  7196         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  7197         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  7198         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  7199         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  7200         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 138
* EL689.cbl
  7201         16  PB-I-OB-FLAG                 PIC X.
  7202             88  PB-I-OB                      VALUE 'B'.
  7203             88  PB-I-SUMMARY                 VALUE 'Z'.
  7204         16  PB-I-ENTRY-STATUS            PIC X.
  7205             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  7206                                              'M' '5' '9' '2'.
  7207             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  7208             88  PB-I-POLICY-PENDING          VALUE '2'.
  7209             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  7210             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  7211             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  7212             88  PB-I-REIN-ONLY               VALUE '9'.
  7213             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  7214             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  7215             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  7216             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  7217         16  PB-I-INT-CODE                PIC X.
  7218             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  7219             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  7220         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  7221         16  PB-I-SOC-SEC-NO              PIC X(11).
  7222         16  PB-I-MEMBER-NO               PIC X(12).
  7223         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  7224*        16  PB-I-LOAN-OFFICER            PIC XXX.
  7225         16  PB-I-OLD-LOF                 PIC XXX.
  7226         16  PB-I-LF-EXPIRE-DT            PIC XX.
  7227         16  PB-I-AH-EXPIRE-DT            PIC XX.
  7228         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  7229         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  7230         16  PB-I-LIFE-INDICATOR          PIC X.
  7231             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  7232         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  7233         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  7234                                          PIC S9(5)V99    COMP-3.
  7235         16  PB-I-MAIL-ADDRS-SW           PIC X.
  7236             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  7237             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  7238         16  PB-I-1ST-PMT-DT              PIC XX.
  7239         16  PB-I-JOINT-INSURED.
  7240             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  7241             20 PB-I-JOINT-FIRST-NAME.
  7242                24  PB-I-JOINT-FIRST-INIT PIC X.
  7243                24  FILLER                PIC X(9).
  7244             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  7245*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  7246         16  PB-I-BENEFICIARY-NAME.
  7247             20  PB-I-BANK-NUMBER         PIC X(10).
  7248             20  FILLER                   PIC X(15).
  7249         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  7250         16  PB-I-REFERENCE               PIC X(12).
  7251         16  FILLER REDEFINES PB-I-REFERENCE.
  7252             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  7253             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  7254             20  PB-I-CLP-STATE           PIC XX.
  7255         16  PB-I-UNDERWRITING-STATUS     PIC X.
  7256             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  7257             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  7258             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 139
* EL689.cbl
  7259         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  7260         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  7261         16  PB-I-RESIDENT-STATE          PIC XX.
  7262         16  PB-I-RATE-CODE               PIC X(4).
  7263         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  7264         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7265         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7266         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  7267         16  PB-I-BANK-NOCHRGB            PIC 99.
  7268         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  7269         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  7270
  7271     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  7272         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  7273             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  7274         16  PB-C-CANCEL-ORIGIN           PIC X.
  7275             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  7276         16  PB-C-LF-CANCEL-DT            PIC XX.
  7277         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7278         16  PB-C-LF-CALC-REQ             PIC X.
  7279             88 PB-COMP-LF-CANCEL            VALUE '?'.
  7280         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  7281         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  7282         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  7283             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  7284         16  PB-C-AH-CANCEL-DT            PIC XX.
  7285         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7286         16  PB-C-AH-CALC-REQ             PIC X.
  7287             88 PB-COMP-AH-CANCEL            VALUE '?'.
  7288         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  7289         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  7290         16  PB-C-LAST-NAME               PIC X(15).
  7291         16  PB-C-REFUND-SW               PIC X.
  7292             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  7293             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  7294         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  7295         16  PB-C-PAYEE-CODE              PIC X(6).
  7296         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  7297         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  7298         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  7299         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  7300         16  PB-C-REFERENCE               PIC X(12).
  7301         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7302         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7303         16  PB-C-POST-CARD-IND           PIC X.
  7304         16  PB-C-CANCEL-REASON           PIC X.
  7305         16  PB-C-REF-INTERFACE-SW        PIC X.
  7306         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  7307         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  7308         16  FILLER                       PIC X(01).
  7309*        16  FILLER                       PIC X(18).
  7310         16  PB-C-POLICY-FORM-NO          PIC X(12).
  7311*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  7312         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  7313         16  PB-CANCELED-CERT-DATA.
  7314             20  PB-CI-INSURED-NAME.
  7315                 24  PB-CI-LAST-NAME      PIC X(15).
  7316                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 140
* EL689.cbl
  7317             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  7318             20  PB-CI-INSURED-SEX        PIC X.
  7319             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  7320             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  7321             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  7322             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  7323             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7324             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  7325             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  7326             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  7327             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  7328             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7329             20  PB-CI-RATE-CLASS         PIC XX.
  7330             20  PB-CI-RATE-DEV-LF        PIC XXX.
  7331             20  PB-CI-RATE-DEV-AH        PIC XXX.
  7332             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  7333             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  7334             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  7335             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  7336             20  PB-CI-LF-ABBR            PIC X(3).
  7337             20  PB-CI-AH-ABBR            PIC X(3).
  7338             20  PB-CI-OB-FLAG            PIC X.
  7339                 88  PB-CI-OB                VALUE 'B'.
  7340             20  PB-CI-LF-POLICY-STATUS   PIC X.
  7341                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  7342                                           'M' '4' '5' '9' '2'.
  7343                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  7344                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  7345                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  7346                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  7347                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  7348                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  7349                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  7350                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  7351                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  7352                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  7353                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  7354                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  7355             20  PB-CI-AH-POLICY-STATUS   PIC X.
  7356                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  7357                                           'M' '4' '5' '9' '2'.
  7358                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  7359                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  7360                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  7361                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  7362                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  7363                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  7364                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  7365                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  7366                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  7367                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  7368                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  7369                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  7370             20  PB-CI-PAY-FREQUENCY      PIC 99.
  7371             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  7372             20  PB-CI-SOC-SEC-NO         PIC X(11).
  7373             20  PB-CI-MEMBER-NO          PIC X(12).
  7374             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 141
* EL689.cbl
  7375                 88  PB-CI-ADD-ON                  VALUE 'A'.
  7376                 88  PB-CI-SIMPLE                  VALUE 'S'.
  7377             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  7378             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  7379             20  PB-CI-COMP-EXCP-SW       PIC X.
  7380                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  7381                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  7382             20  PB-CI-ENTRY-STATUS       PIC X.
  7383             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  7384             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  7385             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  7386             20  PB-CI-DEATH-DT           PIC XX.
  7387             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  7388             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  7389             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7390             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7391             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  7392             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  7393             20  PB-CI-ENTRY-DT              PIC XX.
  7394             20  PB-CI-ENTRY-BATCH           PIC X(6).
  7395             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  7396             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  7397             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  7398             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  7399             20  PB-CI-OLD-LOF               PIC XXX.
  7400*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  7401             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  7402             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  7403             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  7404             20  PB-CI-INDV-GRP-CD           PIC X.
  7405             20  PB-CI-BENEFICIARY-NAME.
  7406                 24  PB-CI-BANK-NUMBER       PIC X(10).
  7407                 24  FILLER                  PIC X(15).
  7408             20  PB-CI-NOTE-SW               PIC X.
  7409             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  7410             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  7411             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  7412             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  7413             20  PB-CI-LOAN-OFFICER          PIC X(5).
  7414             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  7415             20  PB-CI-FIRST-NAME            PIC X(10).
  7416             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  7417
  7418         16  FILLER                       PIC X(13).
  7419*032306  16  FILLER                       PIC X(27).
  7420*        16  FILLER                       PIC X(46).
  7421
  7422     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  7423         16  FILLER                       PIC X(10).
  7424         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  7425         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  7426         16  PB-M-INSURED-MID-INIT        PIC X.
  7427         16  PB-M-INSURED-AGE             PIC 99.
  7428         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  7429         16  PB-M-INSURED-SEX             PIC X.
  7430         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  7431         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  7432         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 142
* EL689.cbl
  7433         16  PB-M-INSURED-CITY-STATE.
  7434             20  PB-M-INSURED-CITY        PIC X(28).
  7435             20  PB-M-INSURED-STATE       PIC XX.
  7436         16  PB-M-INSURED-ZIP-CODE.
  7437             20  PB-M-INSURED-ZIP-PRIME.
  7438                 24  PB-M-INSURED-ZIP-1   PIC X.
  7439                     88  PB-M-CANADIAN-POST-CODE
  7440                                             VALUE 'A' THRU 'Z'.
  7441                 24  FILLER               PIC X(4).
  7442             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  7443         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  7444                                        PB-M-INSURED-ZIP-CODE.
  7445             20  PM-M-INS-CAN-POST1       PIC XXX.
  7446             20  PM-M-INS-CAN-POST2       PIC XXX.
  7447             20  FILLER                   PIC XXX.
  7448         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  7449         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  7450         16  PB-M-CRED-BENE-NAME          PIC X(30).
  7451         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  7452         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  7453         16  PB-M-CRED-BENE-CITYST.
  7454             20  PB-M-CRED-BENE-CITY      PIC X(28).
  7455             20  PB-M-CRED-BENE-STATE     PIC XX.
  7456         16  FILLER                       PIC X(92).
  7457
  7458     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  7459         16  FILLER                       PIC X(10).
  7460         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7461         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7462         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7463         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7464         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7465         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7466         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7467         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7468         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7469         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7470         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7471         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7472         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  7473         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  7474         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  7475         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  7476         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  7477         16  PB-ACCOUNT-NAME              PIC X(30).
  7478         16  PB-PREM-REF-RPT-FLAG         PIC X.
  7479         16  PB-REFERENCE                 PIC X(12).
  7480         16  PB-B-RECEIVED-DT             PIC XX.
  7481         16  FILLER                       PIC X(234).
  7482
  7483     12  PB-RECORD-STATUS.
  7484         16  PB-CREDIT-SELECT-DT          PIC XX.
  7485         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  7486         16  PB-BILLED-DT                 PIC XX.
  7487         16  PB-BILLING-STATUS            PIC X.
  7488             88  PB-ENTRY-REVERSED            VALUE 'R'.
  7489             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  7490             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 143
* EL689.cbl
  7491         16  PB-RECORD-BILL               PIC X.
  7492             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  7493             88  PB-RECORD-RETURNED           VALUE 'R'.
  7494             88  PB-RECORD-ENDORSED           VALUE 'E'.
  7495             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  7496             88  PB-OVERRIDE-AH               VALUE 'A'.
  7497             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  7498         16  PB-BATCH-ENTRY               PIC X.
  7499             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  7500             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  7501             88  PB-REISSUED-CERT             VALUE 'E'.
  7502             88  PB-MONTHLY-CERT              VALUE 'M'.
  7503             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  7504             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  7505             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  7506         16  PB-FORCE-CODE                PIC X.
  7507             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  7508             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  7509             88  PB-CANCEL-FORCE              VALUE '8'.
  7510             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  7511             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  7512             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  7513             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  7514             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  7515             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  7516             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  7517         16  PB-FATAL-FLAG                PIC X.
  7518             88  PB-FATAL-ERRORS              VALUE 'X'.
  7519         16  PB-FORCE-ER-CD               PIC X.
  7520             88  PB-FORCE-ERRORS              VALUE 'F'.
  7521             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  7522         16  PB-WARN-ER-CD                PIC X.
  7523             88  PB-WARNING-ERRORS            VALUE 'W'.
  7524         16  FILLER                       PIC X.
  7525         16  PB-OUT-BAL-CD                PIC X.
  7526             88  PB-OUT-OF-BAL                VALUE 'O'.
  7527         16  PB-LIFE-OVERRIDE-L1          PIC X.
  7528         16  PB-AH-OVERRIDE-L1            PIC X.
  7529         16  PB-INPUT-DT                  PIC XX.
  7530         16  PB-INPUT-BY                  PIC X(4).
  7531         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  7532         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  7533         16  PB-TOLERANCE-REJECT-SW       PIC X.
  7534         16  PB-LF-EARNING-METHOD         PIC X.
  7535         16  PB-AH-EARNING-METHOD         PIC X.
  7536         16  PB-LF-TERM-CALC-METHOD       PIC X.
  7537         16  PB-AH-TERM-CALC-METHOD       PIC X.
  7538         16  PB-REIN-CD                   PIC XXX.
  7539         16  PB-LF-REFUND-TYPE            PIC X.
  7540         16  PB-AH-REFUND-TYPE            PIC X.
  7541         16  PB-ACCT-EFF-DT               PIC XX.
  7542         16  PB-ACCT-EXP-DT               PIC XX.
  7543         16  PB-COMPANY-ID                PIC X(3).
  7544         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7545         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7546         16  PB-SV-CARRIER                PIC X.
  7547         16  PB-SV-GROUPING               PIC X(6).
  7548         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 144
* EL689.cbl
  7549         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  7550         16  PB-GA-BILLING-INFO.
  7551             20  PB-GA-BILL-DT OCCURS 5 TIMES
  7552                                          PIC XX.
  7553         16  PB-SV-REMIT-TO  REDEFINES
  7554             PB-GA-BILLING-INFO           PIC X(10).
  7555         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  7556         16  PB-I-LOAN-OFFICER            PIC X(5).
  7557         16  PB-I-VIN                     PIC X(17).
  7558
  7559         16  FILLER                       PIC X(04).
  7560         16  IMNET-BYPASS-SW              PIC X.
  7561
  7562******************************************************************
  7563*                COMMON EDIT ERRORS                              *
  7564******************************************************************
  7565
  7566     12  PB-COMMON-ERRORS.
  7567         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  7568                                           PIC S9(4)     COMP.
  7569
  7570******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 145
* EL689.cbl
  7572*    COPY ERCPYAJ.
  7573******************************************************************
  7574*                                                                *
  7575*                            ERCPYAJ                             *
  7576*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7577*                            VMOD=2.015                          *
  7578*                                                                *
  7579*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7580*                                                                *
  7581*                                                                *
  7582*   FILE TYPE = VSAM,KSDS                                        *
  7583*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7584*                                                                *
  7585*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7586*       ALTERNATE PATHS = NONE                                   *
  7587*                                                                *
  7588*   LOG = YES                                                    *
  7589*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7590******************************************************************
  7591******************************************************************
  7592*                   C H A N G E   L O G
  7593*
  7594* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7595*-----------------------------------------------------------------
  7596*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7597* EFFECTIVE    NUMBER
  7598*-----------------------------------------------------------------
  7599* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7600* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7601******************************************************************
  7602
  7603 01  PENDING-PAY-ADJ.
  7604     12  PY-RECORD-ID                     PIC XX.
  7605         88  VALID-PY-ID                        VALUE 'PY'.
  7606
  7607     12  PY-CONTROL-PRIMARY.
  7608         16  PY-COMPANY-CD                PIC X.
  7609         16  PY-CARRIER                   PIC X.
  7610         16  PY-GROUPING                  PIC X(6).
  7611         16  PY-FIN-RESP                  PIC X(10).
  7612         16  PY-ACCOUNT                   PIC X(10).
  7613         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7614                                          PIC X(10).
  7615         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7616         16  PY-RECORD-TYPE               PIC X.
  7617             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7618             88  PY-DEPOSIT                   VALUE 'D'.
  7619             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7620             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7621             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7622             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7623             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7624             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7625             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7626             88  PY-FICA-ENTRY                VALUE 'F'.
  7627             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7628             88  PY-POLICY-FEE                VALUE 'W'.
  7629             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 146
* EL689.cbl
  7630
  7631     12  PY-PYMT-TYPE                     PIC X.
  7632             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7633             88  PY-REINS-PYMT                VALUE 'R'.
  7634             88  PY-EXP-PYMT                  VALUE 'E'.
  7635
  7636     12  PY-BIL-INV                       PIC X(6).
  7637     12  PY-REF-NO                        PIC X(12).
  7638
  7639     12  PY-LAST-MAINT-DT                 PIC XX.
  7640     12  PY-LAST-MAINT-BY                 PIC X(4).
  7641     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7642
  7643     12  PY-PYADJ-RECORD.
  7644         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7645         16  PY-ENTRY-COMMENT             PIC X(30).
  7646         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7647             20  PY-GL-ACCOUNT            PIC X(10).
  7648             20  PY-GL-STATE              PIC X(02).
  7649             20  PY-GL-CANC-SW            PIC X(01).
  7650                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7651                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7652             20  PY-GL-COMMENT            PIC X(10).
  7653             20  FILLER      REDEFINES PY-GL-COMMENT.
  7654                 24  PY-GL-CHECK-NO       PIC 9(06).
  7655                 24  FILLER               PIC X(04).
  7656             20  FILLER                   PIC X(07).
  7657         16  PY-SAVE-ACCOUNT              PIC X(10).
  7658         16  PY-SAVE-TYPE                 PIC X(01).
  7659
  7660         16  PY-LETTERS.
  7661             20  PY-LETTER OCCURS 3 TIMES
  7662                           INDEXED BY PY-LET-NDX
  7663                                          PIC X(04).
  7664
  7665         16  PY-ERCOMP-TYPE               PIC X.
  7666             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7667             88  PY-GA-TYPE                   VALUE 'G'.
  7668             88  PY-BANK-TYPE                 VALUE 'B'.
  7669         16  FILLER                       PIC X(05).
  7670
  7671     12  PY-RECORD-STATUS.
  7672         16  PY-CREDIT-SELECT-DT          PIC XX.
  7673         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7674         16  PY-BILLED-DATE               PIC XX.
  7675         16  PY-REPORTED-DT               PIC XX.
  7676         16  PY-PMT-APPLIED               PIC X.
  7677             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7678             88  PY-GA-PMT                    VALUE 'G'.
  7679             88  PY-OVWRITE-PMT               VALUE 'O'.
  7680             88  PY-NON-AR-PMT                VALUE 'N'.
  7681         16  FILLER                       PIC X(5).
  7682         16  PY-INPUT-DT                  PIC XX.
  7683         16  PY-CHECK-NUMBER              PIC X(6).
  7684         16  PY-VOID-SW                   PIC X.
  7685             88  PY-CHECK-VOIDED              VALUE 'V'.
  7686         16  PY-CHECK-ORIGIN-SW           PIC X.
  7687             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 147
* EL689.cbl
  7688             88  PY-REFUND-CHECK              VALUE 'R'.
  7689             88  PY-GA-CHECK                  VALUE 'G'.
  7690             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7691             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7692         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7693         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7694         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7695         16  PY-BILL-FLAG                 PIC X.
  7696             88  PY-BILLED                    VALUE 'B'.
  7697         16  PY-AR-FLAG                   PIC X.
  7698             88  PY-AR-CYCLE                  VALUE 'C'.
  7699             88  PY-AR-MONTH-END              VALUE 'M'.
  7700         16  PY-AR-DATE                   PIC XX.
  7701
  7702     12  PY-GL-CODES.
  7703         16  PY-GL-DB                     PIC X(14).
  7704         16  PY-GL-CR                     PIC X(14).
  7705         16  PY-GL-FLAG                   PIC X.
  7706         16  PY-GL-DATE                   PIC XX.
  7707
  7708     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7709     12  FILLER                           PIC X(3).
  7710******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 148
* EL689.cbl
  7712*    COPY ELCTEXT.
  7713******************************************************************
  7714*                                                                *
  7715*                                                                *
  7716*                            ELCTEXT.                            *
  7717*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7718*                            VMOD=2.008                          *
  7719*                                                                *
  7720*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  7721*                                     FORM LETTERS,              *
  7722*                                     CERT FORM DISPLAY.
  7723*                                                                *
  7724*   FILE TYPE = VSAM,KSDS                                        *
  7725*   RECORD SIZE = 100   RECFORM = FIXED                          *
  7726*                                                                *
  7727*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  7728*       ALTERNATE INDEX = NONE                                   *
  7729*                                                                *
  7730*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  7731*       ALTERNATE INDEX = NONE                                   *
  7732*                                                                *
  7733*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  7734*       ALTERNATE INDEX = NONE                                   *
  7735*                                                                *
  7736*   LOG = NO                                                     *
  7737*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7738******************************************************************
  7739 01  TEXT-FILES.
  7740     12  TEXT-FILE-ID                PIC XX.
  7741         88  FORMS-FILE-TEXT            VALUE 'TF'.
  7742         88  LETTER-FILE-TEXT           VALUE 'TL'.
  7743         88  HELP-FILE-TEXT             VALUE 'TH'.
  7744
  7745     12  TX-CONTROL-PRIMARY.
  7746         16  TX-COMPANY-CD           PIC X.
  7747             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  7748         16  TX-ACCESS-CD-GENL       PIC X(12).
  7749
  7750         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7751             20  TX-LETTER-NO        PIC X(4).
  7752             20  FILLER              PIC X(8).
  7753
  7754         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7755             20  TX-FORM-NO          PIC X(12).
  7756
  7757         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7758             20  TX-HELP-TYPE        PIC X.
  7759                 88  HELP-FOR-GENERAL   VALUE ' '.
  7760                 88  HELP-BY-SCREEN     VALUE 'S'.
  7761                 88  HELP-BY-ERROR      VALUE 'E'.
  7762             20  TX-SCREEN-OR-ERROR  PIC X(4).
  7763                 88  GENERAL-INFO-HELP  VALUE '0000'.
  7764             20  TX-HELP-FOR-COMPANY  PIC XXX.
  7765                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  7766             20  FILLER              PIC X(4).
  7767
  7768         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  7769
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 149
* EL689.cbl
  7770     12  TX-PROCESS-CONTROL          PIC XX.
  7771         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  7772
  7773     12  TX-TEXT-LINE                PIC X(70).
  7774
  7775     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  7776         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  7777         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  7778         88  TX-VALID-FORM-SQUEEZE-VALUE
  7779                                        VALUE 'Y' ' '.
  7780
  7781     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  7782         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  7783         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  7784         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  7785         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  7786         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  7787         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  7788         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  7789                                              'K' 'N' ' '
  7790                                              'Z'.
  7791
  7792     12  TX-ARCHIVE-SW               PIC X.
  7793         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  7794         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  7795         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  7796
  7797     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  7798     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  7799
  7800     12  TX-BSR-CODE                 PIC X.
  7801         88  TX-BSR-LETTER              VALUE 'B'.
  7802         88  TX-NON-BSR-LETTER          VALUE ' '.
  7803
  7804     12  FILLER                      PIC X.
  7805*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 150
* EL689.cbl
  7807*    COPY ERCENDT.
  7808******************************************************************
  7809*                                                                *
  7810*                                                                *
  7811*                            ERCENDT.                            *
  7812*                            VMOD=2.001                          *
  7813*                                                                *
  7814*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7815*                                                                *
  7816*   FILE TYPE = VSAM,KSDS                                        *
  7817*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7818*                                                                *
  7819*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7820*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7821*                                                                *
  7822*   LOG = NO                                                     *
  7823*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7824******************************************************************
  7825*-----------------------------------------------------------------
  7826*                   C H A N G E   L O G
  7827*
  7828* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7829*-----------------------------------------------------------------
  7830*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7831* EFFECTIVE    NUMBER
  7832*-----------------------------------------------------------------
  7833* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7834*                                WITH OPEN CLAIMS
  7835* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7836* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7837*-----------------------------------------------------------------
  7838 01  ENDORSEMENT-RECORD.
  7839     12  EN-RECORD-ID                PIC XX.
  7840         88  VALID-EN-ID                VALUE 'EN'.
  7841     12  EN-CONTROL-PRIMARY.
  7842         16  EN-COMPANY-CD           PIC X.
  7843         16  EN-CARRIER              PIC X.
  7844         16  EN-GROUPING             PIC X(6).
  7845         16  EN-STATE                PIC XX.
  7846         16  EN-ACCOUNT              PIC X(10).
  7847         16  EN-CERT-EFF-DT          PIC XX.
  7848         16  EN-CERT-NO.
  7849             20  EN-CERT-PRIME       PIC X(10).
  7850             20  EN-CERT-SFX         PIC X.
  7851         16  EN-REC-TYPE             PIC X.
  7852             88  EN-ISSUE               VALUE 'I'.
  7853             88  EN-CANCELLATION        VALUE 'C'.
  7854         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7855     12  EN-CONTROL-BY-ARCH-NO.
  7856         16  EN-COMPANY-CD-A1              PIC X.
  7857         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7858     12  EN-LAST-MAINT-DT            PIC XX.
  7859     12  EN-LAST-MAINT-BY            PIC X(4).
  7860     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7861     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7862     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7863         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7864         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 151
* EL689.cbl
  7865         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7866         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7867         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7868         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7869         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7870         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7871         16  EN-LF-ORIG-BENCD        PIC XX.
  7872         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7873         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7874         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7875         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7876         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7877         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7878*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7879         16  EN-ORIG-CRED-BENE       PIC X(25).
  7880         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7881         16  FILLER                  PIC X.
  7882         16  EN-AH-ORIG-BENCD        PIC XX.
  7883         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7884         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7885         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7886         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7887*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7888*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7889         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7890         16  F                       PIC X(09).
  7891         16  EN-AH-ORIG-CP           PIC 99.
  7892         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7893         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7894         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7895         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7896         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7897         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7898         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7899         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7900         16  EN-LF-NEW-BENCD         PIC XX.
  7901         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7902         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7903         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7904         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7905         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7906         16  EN-LF-NEW-EXP-DT        PIC XX.
  7907         16  EN-NEW-CRED-BENE        PIC X(25).
  7908         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7909         16  FILLER                  PIC X.
  7910         16  EN-AH-NEW-BENCD         PIC XX.
  7911         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7912         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7913         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7914         16  EN-AH-NEW-EXP-DT        PIC XX.
  7915*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7916*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7917*        16  F                       PIC X(12).
  7918         16  EN-AH-NEW-CP            PIC 99.
  7919         16  EN-SIG-SW               PIC X.
  7920         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7921         16  FILLER                  PIC X(37).
  7922     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 152
* EL689.cbl
  7923         16  EN-LF-ORIG-REF-DT       PIC XX.
  7924         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7925         16  EN-AH-ORIG-REF-DT       PIC XX.
  7926         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7927         16  EN-LF-NEW-REF-DT        PIC XX.
  7928         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7929         16  EN-AH-NEW-REF-DT        PIC XX.
  7930         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7931         16  EN-FLAG-CERT            PIC X.
  7932         16  EN-INS-LAST-NAME        PIC X(15).
  7933         16  EN-INS-FIRST-NAME       PIC X(10).
  7934         16  EN-INS-MIDDLE-INIT      PIC X.
  7935         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7936         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7937         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7938         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7939         16  FILLER                  PIC X(262).
  7940     12  EN-MONEY-SW             PIC X.
  7941     12  EN-HEALTH-APP           PIC X.
  7942     12  EN-VOUCHER-SW           PIC X.
  7943     12  EN-PAYEE                PIC X(14).
  7944     12  EN-INPUT-DT             PIC XX.
  7945     12  EN-PROCESS-DT           PIC XX.
  7946     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7947     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7948     12  EN-REASON-CODES.
  7949         16  F OCCURS 12.
  7950             20  EN-REASON-CODE  PIC X(4).
  7951     12  EN-TEMPLATE-USED        PIC X(8).
  7952     12  EN-DOCU-TYPE            PIC X.
  7953         88  EN-VERI-DOCU          VALUE 'V'.
  7954         88  EN-GCE-DOCU           VALUE 'G'.
  7955         88  EN-CANC-DOCU          VALUE 'C'.
  7956     12  EN-COMMENTS1            PIC X(13).
  7957     12  EN-COMMENTS2            PIC X(70).
  7958     12  EN-COMM-CHGBK           PIC X.
  7959         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7960         88  EN-CHG-ACCT           VALUE 'Y'.
  7961     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7962     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7963     12  EN-BATCH-NUMBER         PIC X(6).
  7964     12  EN-ACCT-SUMM            PIC X.
  7965     12  EN-CSO-SUMM             PIC X.
  7966     12  FILLER                  PIC X(13).
  7967******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 153
* EL689.cbl
  7969 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  7970                          ACCOUNT-MASTER LETTER-ARCHIVE
  7971                          LETTER-ARCHIVE-TEXT
  7972                          CERTIFICATE-MASTER CHECK-RECORDS
  7973                          CONTROL-FILE COMPENSATION-MASTER
  7974                          MAILING-DATA PENDING-BUSINESS
  7975                          PENDING-PAY-ADJ TEXT-FILES
  7976                          ENDORSEMENT-RECORD.
  7977 0000-DFHEXIT SECTION.
  7978     MOVE '9#                    $   ' TO DFHEIV0.
  7979     MOVE 'EL689' TO DFHEIV1.
  7980     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7981     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7982
  7983     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7984     MOVE '5'                    TO DC-OPTION-CODE.
  7985     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  7986     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  7987     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  7988                                    W-CURRENT-SAVE.
  7989
  7990     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7991     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  7992                                 TO EMI-SAVE-AREA.
  7993
  7994     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  7995                                    W-TS-TERM-SCREEN.
  7996
  7997     IF  EIBCALEN EQUAL 0
  7998         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  7999         GO TO 8300-SEND-TEXT
  8000     END-IF.
  8001     set P to address of KIXSYS
  8002     CALL "getenv" using by value P returning var-ptr
  8003     if var-ptr = null then
  8004        display ' kixsys not set '
  8005     else
  8006        set address of var to var-ptr
  8007        move 0 to env-var-len
  8008        inspect var tallying env-var-len
  8009          for characters before X'00'
  8010*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  8011        unstring var (1:env-var-len) delimited by '/'
  8012           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8013              WS-KIX-SYS
  8014        end-unstring
  8015*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  8016*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8017     end-if
  8018     set P to address of KIXHOST
  8019     CALL "getenv" using by value P returning var-ptr
  8020     if var-ptr = null then
  8021        display ' kixhost not set '
  8022     else
  8023        set address of var to var-ptr
  8024        move 0 to env-var-len
  8025        inspect var tallying env-var-len
  8026          for characters before X'00'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 154
* EL689.cbl
  8027*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  8028        MOVE var(1:env-var-len)  to ws-kixhost
  8029*       unstring var (1:env-var-len) delimited by '/'
  8030*          into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8031*             WS-KIX-SYS
  8032*       end-unstring
  8033        DISPLAY ' WS KIX HOST ' WS-KIXSYS
  8034*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8035     end-if
  8036     IF  PI-689-CREATE-NO-SCREENS
  8037         GO TO 0600-BYPASS-SCREEN-CNTL
  8038     END-IF.
  8039
  8040     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  8041         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  8042             MOVE PI-SAVED-PROGRAM-5
  8043                                 TO PI-SAVED-PROGRAM-6
  8044             MOVE PI-SAVED-PROGRAM-4
  8045                                 TO PI-SAVED-PROGRAM-5
  8046             MOVE PI-SAVED-PROGRAM-3
  8047                                 TO PI-SAVED-PROGRAM-4
  8048             MOVE PI-SAVED-PROGRAM-2
  8049                                 TO PI-SAVED-PROGRAM-3
  8050             MOVE PI-SAVED-PROGRAM-1
  8051                                 TO PI-SAVED-PROGRAM-2
  8052             MOVE PI-RETURN-TO-PROGRAM
  8053                                 TO PI-SAVED-PROGRAM-1
  8054             MOVE PI-CALLING-PROGRAM
  8055                                 TO PI-RETURN-TO-PROGRAM
  8056             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  8057             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8058             MOVE LOW-VALUES     TO EL689AO
  8059             PERFORM 9905-INITIALIZE-SECURITY THRU 9905-EXIT
  8060             IF PI-689-ARCHIVE-NUMBER NOT NUMERIC
  8061                MOVE ZEROS       TO PI-689-ARCHIVE-NUMBEr
  8062             END-IF
  8063             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6311'
  8064                     AND
  8065                 PI-689-KEY-DATA-FIELDS GREATER THAN LOW-VALUES
  8066                 GO TO 0400-EL6311-INCOMING
  8067             ELSE
  8068                 MOVE PI-689-ARCHIVE-NUMBER
  8069                                 TO W-INCOMING-ARCHIVE
  8070                 MOVE LOW-VALUES TO PI-1042-WA
  8071                                    PI-689-WORK-AREA
  8072                 MOVE ZEROS      TO PI-CURRENT-LINE
  8073                                    PI-TEMP-STOR-ITEMS
  8074                                    PI-TOTAL-LINES
  8075                                    PI-UPDATE-SW
  8076                                    PI-689-NUMBER-LABEL-LINES
  8077                                    PI-689-NUMBER-TEXT-RECORDS
  8078                                    PI-689-ERROR
  8079                 MOVE SPACES     TO PI-689-PRINT-SW
  8080                                    PI-689-ALT-PRINTER-ID
  8081                                    PI-689-LBL-OVERRIDE
  8082                                    PI-COMM-CONTROL
  8083                                    PI-689-FORM-NUMBER
  8084                                    PI-689-TEMP-STOR-ID
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 155
* EL689.cbl
  8085                                    PI-689-LABEL-SOURCE
  8086                                    PI-689-USE-SCREEN-IND
  8087                 MOVE '2'        TO PI-ACTION
  8088                 MOVE -1         TO MAINTL
  8089                 MOVE PI-LOWER-CASE-LETTERS
  8090                                 TO W-LC-CASE-IND
  8091                 IF  W-INCOMING-ARCHIVE NUMERIC
  8092                         AND
  8093                     W-INCOMING-ARCH-NO GREATER THAN ZEROS
  8094                     MOVE 'S'    TO MAINTI
  8095                     MOVE +1     TO MAINTL
  8096                     MOVE AL-UANON
  8097                                 TO MAINTA
  8098                     MOVE W-INCOMING-ARCH-NO
  8099                                 TO ARCHNUMI
  8100                     MOVE +8     TO ARCHNUML
  8101                     MOVE AL-UNNON
  8102                                 TO ARCHNUMA
  8103                     GO TO 1000-SHOW
  8104                 ELSE
  8105                     GO TO 0450-SPECIAL-INPUT-PROCESS
  8106                 END-IF
  8107             END-IF
  8108         ELSE
  8109             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  8110             MOVE PI-RETURN-TO-PROGRAM
  8111                                     TO PI-CALLING-PROGRAM
  8112             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  8113             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  8114             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  8115             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  8116             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  8117             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  8118             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  8119             PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8120             MOVE LOW-VALUES         TO EL689AO
  8121             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8122             SET W-RG-NDX            TO PI-CURRENT-LINE
  8123             PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8124                 VARYING
  8125                     W-SC-NDX FROM 1 BY 1
  8126                 UNTIL
  8127                     W-SC-NDX GREATER THAN
  8128                     W-NUM-LINES-PER-SCREEN
  8129             MOVE PI-689-ALT-PRINTER-ID
  8130                                     TO PRINTERO
  8131             MOVE AL-UANON           TO PRINTERA
  8132             MOVE -1                 TO PRINTERL
  8133             GO TO 8100-SEND-INITIAL-MAP
  8134         END-IF
  8135     END-IF.
  8136
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 156
* EL689.cbl
  8138 0200-RECEIVE.
  8139
  8140     MOVE PI-689-FATAL-CTR       TO EMI-FATAL-CTR
  8141     MOVE PI-689-FORCABLE-CTR    TO EMI-FORCABLE-CTR
  8142     IF  EMI-FATAL-CTR GREATER THAN ZEROS
  8143             OR
  8144         EMI-FORCABLE-CTR GREATER THAN ZEROS
  8145         MOVE 'Y'                TO W-HOLD-IND.
  8146
  8147     MOVE W-TRANSACTION          TO EIBTRNID.
  8148     MOVE EMI-SAVE-AREA          TO ERROR-MESSAGE-INTERFACE-BLOCK.
  8149     MOVE ZEROS                  TO W-LAST-ERROR.
  8150     MOVE LOW-VALUES             TO EL689AI.
  8151     MOVE '104A'                 TO W-TS-ID-TEXT.
  8152     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8153                                    W-TS-TERM-SCREEN.
  8154
  8155
  8156* EXEC CICS HANDLE AID
  8157*        CLEAR    (9300-DFHCLEAR)
  8158*        PA1      (9200-PA)
  8159*        PA2      (9200-PA)
  8160*        PA3      (9200-PA)
  8161*    END-EXEC.
  8162*    MOVE '"&=!"#               V! " #00008151' TO DFHEIV0
  8163     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  8164     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  8165     MOVE X'2220233030303038313531' TO DFHEIV0(25:11)
  8166     CALL 'kxdfhei1' USING DFHEIV0
  8167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8168
  8169
  8170
  8171* EXEC CICS HANDLE CONDITION
  8172*        PGMIDERR (9700-PGMID-ERROR)
  8173*        ERROR    (9800-ABEND)
  8174*        MAPFAIL  (0325-MAPFAIL)
  8175*    END-EXEC.
  8176*    MOVE '"$L.?                 ! # #00008158' TO DFHEIV0
  8177     MOVE X'22244C2E3F20202020202020' TO DFHEIV0(1:12)
  8178     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8179     MOVE X'2320233030303038313538' TO DFHEIV0(25:11)
  8180     CALL 'kxdfhei1' USING DFHEIV0
  8181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8182
  8183
  8184
  8185* EXEC CICS SYNCPOINT
  8186*    END-EXEC.
  8187*    MOVE '6"                    !   #00008164' TO DFHEIV0
  8188     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  8189     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8190     MOVE X'2020233030303038313634' TO DFHEIV0(25:11)
  8191     CALL 'kxdfhei1' USING DFHEIV0
  8192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8193
  8194
  8195     IF PI-LOWER-CASE-LETTERS = 'Y'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 157
* EL689.cbl
  8196*    IF  W-LC-USE-BOTH-CASES
  8197
  8198* EXEC CICS RECEIVE
  8199*            MAP      (W-MAP)
  8200*            MAPSET   (W-MAPSET)
  8201*            INTO     (EL689AI)
  8202*            ASIS
  8203*        END-EXEC
  8204     MOVE LENGTH OF
  8205      EL689AI
  8206       TO DFHEIV11
  8207*    MOVE '8"TAI  L              ''   #00008169' TO DFHEIV0
  8208     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8209     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8210     MOVE X'2020233030303038313639' TO DFHEIV0(25:11)
  8211     CALL 'kxdfhei1' USING DFHEIV0,
  8212           W-MAP,
  8213           EL689AI,
  8214           DFHEIV11,
  8215           W-MAPSET,
  8216           DFHEIV99,
  8217           DFHEIV99
  8218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8219     ELSE
  8220
  8221* EXEC CICS RECEIVE
  8222*            MAP      (W-MAP)
  8223*            MAPSET   (W-MAPSET)
  8224*            INTO     (EL689AI)
  8225*        END-EXEC.
  8226     MOVE LENGTH OF
  8227      EL689AI
  8228       TO DFHEIV11
  8229*    MOVE '8"T I  L              ''   #00008176' TO DFHEIV0
  8230     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8231     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8232     MOVE X'2020233030303038313736' TO DFHEIV0(25:11)
  8233     CALL 'kxdfhei1' USING DFHEIV0,
  8234           W-MAP,
  8235           EL689AI,
  8236           DFHEIV11,
  8237           W-MAPSET,
  8238           DFHEIV99,
  8239           DFHEIV99
  8240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8241
  8242
  8243     IF  NOT DISPLAY-CAP
  8244         MOVE 'READ'             TO SM-READ
  8245         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8246         MOVE ER-9097            TO EMI-ERROR
  8247         MOVE -1                 TO MAINTL
  8248         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8249         GO TO 8100-SEND-INITIAL-MAP.
  8250
  8251     INSPECT MAINTI CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
  8252
  8253     IF  ENTERPFL EQUAL 0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 158
* EL689.cbl
  8254         GO TO 0300-CHECK-PFKEYS.
  8255
  8256     IF  EIBAID NOT EQUAL DFHENTER
  8257         MOVE ER-0004            TO EMI-ERROR
  8258         GO TO 0320-INPUT-ERROR.
  8259
  8260     IF  ENTERPFI NUMERIC
  8261             AND
  8262         ENTERPFI GREATER THAN 0
  8263             AND
  8264         ENTERPFI LESS THAN 25
  8265         MOVE PF-VALUES (ENTERPFI)
  8266                                 TO EIBAID
  8267     ELSE
  8268         MOVE ER-0029            TO EMI-ERROR
  8269         GO TO 0320-INPUT-ERROR.
  8270
  8271 0300-CHECK-PFKEYS.
  8272
  8273     IF  EIBAID EQUAL DFHPF23
  8274         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8275         MOVE ZEROS              TO PI-TOTAL-LINES
  8276                                    PI-CURRENT-LINE
  8277         MOVE EIBAID             TO PI-ENTRY-CD-1
  8278         MOVE W-XCTL-005         TO W-CALL-PGM
  8279         GO TO 9400-XCTL.
  8280
  8281     IF  EIBAID EQUAL DFHPF24
  8282         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8283         MOVE ZEROS              TO PI-TOTAL-LINES
  8284                                    PI-CURRENT-LINE
  8285         MOVE W-XCTL-626         TO W-CALL-PGM
  8286         GO TO 9400-XCTL.
  8287
  8288     MOVE SPACES                 TO W-KEY-FIELDS-CHANGED-IND
  8289                                    W-FORM-CHANGED-IND.
  8290
  8291     IF  PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8292             OR
  8293         PI-SHOW-MODE
  8294         NEXT SENTENCE
  8295     ELSE
  8296         IF  PI-689-FORM-NUMBER GREATER THAN SPACES
  8297                 AND
  8298             FORML NOT EQUAL ZEROS
  8299                 AND
  8300             PI-689-FORM-NUMBER NOT EQUAL FORMI
  8301             MOVE FORMI          TO PI-689-FORM-NUMBER
  8302             MOVE LOW-VALUES     TO EL689AI
  8303                                    PI-1042-WA
  8304                                    PI-689-FOLLOW-UP-DATE
  8305                                    PI-689-PRINT-RESTRICTION
  8306                                    PI-689-RESEND-DATE-1
  8307                                    PI-689-RESEND1-EDIT
  8308                                    PI-689-FOLLOW-UP-DATE
  8309                                    PI-689-FOLLOW-UP-EDIT
  8310                                    PI-689-ERROR-IND
  8311             MOVE ZEROS          TO PI-689-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 159
* EL689.cbl
  8312                                    PI-689-NUMBER-COPIES
  8313                                    PI-689-NUMBER-LABEL-LINES
  8314                                    PI-689-NUMBER-TEXT-RECORDS
  8315                                    PI-CURRENT-LINE
  8316                                    PI-TEMP-STOR-ITEMS
  8317                                    PI-TOTAL-LINES
  8318                                    PI-UPDATE-SW
  8319             MOVE SPACES         TO PI-689-PRINT-SW
  8320                                    PI-689-ALT-PRINTER-ID
  8321                                    PI-COMM-CONTROL
  8322                                    PI-689-TEMP-STOR-ID
  8323                                    PI-689-USE-SCREEN-IND
  8324                                    PI-689-RESEND-LETR-1
  8325                                    PI-CERT-FORM-ID
  8326             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8327             MOVE DFHENTER       TO EIBAID
  8328             MOVE 'Y'            TO W-FORM-CHANGED-IND
  8329             GO TO 0330-FUNCTION-CHECK
  8330         ELSE
  8331             IF  PI-689-DATA-SOURCE NOT EQUAL DATASORI
  8332                     OR
  8333                 (PI-689-LABEL-SOURCE NOT EQUAL ADDRSI
  8334                         AND
  8335                     (PI-689-LABEL-SOURCE NOT EQUAL SPACES
  8336                             OR
  8337                         ADDRSI NOT EQUAL LOW-VALUES))
  8338                     OR
  8339                 PI-689-CARRIER NOT EQUAL CARRIERI
  8340                     OR
  8341                 PI-689-GROUPING NOT EQUAL GROUPI
  8342                     OR
  8343                 PI-689-STATE NOT EQUAL STATEI
  8344                     OR
  8345                 PI-689-ACCOUNT NOT EQUAL ACCTI
  8346                     OR
  8347                 PI-689-CERT-PRIME NOT EQUAL CERTI
  8348                     OR
  8349                 PI-689-CERT-SFX NOT EQUAL SFXI
  8350                     OR
  8351                 PI-689-TYPE NOT EQUAL TYPEI
  8352                     OR
  8353                 PI-689-DATE-EDIT NOT EQUAL DATEI
  8354                     OR
  8355                 PI-689-RESP-PERSON NOT EQUAL RPERSONI
  8356                     OR
  8357                 PI-689-SEQ-EDIT NOT EQUAL SEQI
  8358                     OR
  8359                 PI-689-ENTRY-BATCH NOT EQUAL BENTRYI
  8360                     OR
  8361                 PI-689-BCSEQ-EDIT NOT EQUAL BCSEQI
  8362                 MOVE 'Y'        TO W-KEY-FIELDS-CHANGED-IND
  8363                 MOVE DFHENTER   TO EIBAID
  8364                 GO TO 0330-FUNCTION-CHECK.
  8365
  8366*    IF  EIBAID EQUAL DFHPF1
  8367*        MOVE +7                 TO W-ROLL-COUNTER
  8368*        GO TO 4000-ROLL-PAGE.
  8369
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 160
* EL689.cbl
  8370*    IF  EIBAID EQUAL DFHPF2
  8371*        MOVE -7                 TO W-ROLL-COUNTER
  8372*        GO TO 4000-ROLL-PAGE.
  8373
  8374*    IF  EIBAID EQUAL DFHPF3
  8375*        IF  W-HOLD-ON
  8376*            MOVE ER-7245        TO EMI-ERROR
  8377*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8378*            MOVE -1             TO MAINTL
  8379*            MOVE AL-UABON       TO MAINTA
  8380*            GO TO 8200-SEND-DATAONLY
  8381*        ELSE
  8382*            GO TO 0330-FUNCTION-CHECK.
  8383*    IF (EIBAID = DFHPF8)
  8384*       AND (PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR
  8385*         'CAGB' OR 'DLVA' OR 'ECCA' OR 'KRHA' OR 'ALWA')
  8386*       MOVE ER-0029             TO EMI-ERROR
  8387*       GO TO 0320-INPUT-ERROR
  8388*    END-IF
  8389*    IF EIBAID = DFHPF4 OR DFHPF8
  8390*        IF  W-HOLD-ON
  8391*            MOVE ER-7245        TO EMI-ERROR
  8392*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8393*            MOVE -1             TO MAINTL
  8394*            MOVE AL-UABON       TO MAINTA
  8395*            GO TO 8200-SEND-DATAONLY
  8396*        ELSE
  8397*            GO TO 0330-FUNCTION-CHECK.
  8398
  8399*    IF  EIBAID = DFHPF5
  8400*        COMPUTE W-ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  8401*        GO TO 4000-ROLL-PAGE.
  8402
  8403*    IF  EIBAID = DFHPF6
  8404*        MOVE PI-TOTAL-LINES     TO W-ROLL-COUNTER
  8405*        GO TO 4000-ROLL-PAGE.
  8406
  8407     IF  EIBAID EQUAL DFHPF7
  8408         IF PI-PROMPT-IND EQUAL 'Y'
  8409             MOVE ER-0894        TO EMI-ERROR
  8410             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8411             MOVE -1             TO MAINTL
  8412             MOVE AL-UABON       TO MAINTA
  8413             GO TO 8200-SEND-DATAONLY
  8414         END-IF
  8415     END-IF.
  8416
  8417     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8418         IF  W-HOLD-ON
  8419             MOVE ER-7245        TO EMI-ERROR
  8420             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8421             MOVE -1             TO MAINTL
  8422             MOVE AL-UABON       TO MAINTA
  8423             GO TO 8200-SEND-DATAONLY
  8424         ELSE
  8425             GO TO 0330-FUNCTION-CHECK.
  8426
  8427     IF  EIBAID EQUAL DFHENTER
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 161
* EL689.cbl
  8428         GO TO 0330-FUNCTION-CHECK.
  8429
  8430     MOVE ER-0029                TO EMI-ERROR.
  8431
  8432 0320-INPUT-ERROR.
  8433
  8434     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8435
  8436     IF  ENTERPFL EQUAL 0
  8437         MOVE -1                 TO MAINTL
  8438         MOVE AL-UABON           TO MAINTA
  8439     ELSE
  8440         MOVE AL-UNBON           TO ENTERPFA
  8441         MOVE -1                 TO ENTERPFL.
  8442
  8443     GO TO 8200-SEND-DATAONLY.
  8444
  8445 0325-MAPFAIL.
  8446***********************************************************
  8447*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  8448*      LETTERS ON A 3275 PRINTER.                         *
  8449***********************************************************
  8450
  8451     PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8452
  8453     SET W-RG-NDX                TO PI-CURRENT-LINE.
  8454     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8455             VARYING
  8456         W-SC-NDX FROM 1 BY 1
  8457             UNTIL
  8458         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
  8459
  8460     MOVE -1                     TO MAINTL.
  8461     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 162
* EL689.cbl
  8463 0330-FUNCTION-CHECK.
  8464
  8465     IF  MAINTI EQUAL 'S'
  8466*        IF EIBAID = DFHPF4 OR DFHPF8
  8467*            GO TO 7900-PRINT-LETTER-NOW
  8468*        ELSE
  8469             GO TO 1000-SHOW.
  8470
  8471     IF  NOT MODIFY-CAP
  8472         MOVE 'UPDATE'           TO SM-READ
  8473         PERFORM 9995-SECURITY-VIOLATION
  8474         MOVE ER-0070            TO EMI-ERROR
  8475         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8476         MOVE -1                 TO MAINTL
  8477         GO TO 8100-SEND-INITIAL-MAP.
  8478
  8479     IF  W-FORM-CHANGED
  8480             OR
  8481         W-KEY-FIELDS-CHANGED
  8482         GO TO 0330-EDIT.
  8483
  8484     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8485
  8486
  8487*    IF  EIBAID EQUAL DFHPF3
  8488*        IF  PI-NO-CARRIER-SECURITY
  8489*                AND
  8490*            PI-NO-ACCOUNT-SECURITY
  8491*            GO TO 5000-EDIT-MODE.
  8492
  8493     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8494         IF  PI-NO-CARRIER-SECURITY
  8495                 AND
  8496             PI-NO-ACCOUNT-SECURITY
  8497             GO TO 5400-LETTER-RELEASE
  8498         ELSE
  8499             IF  PI-689-PRINT-PERFORMED
  8500                 GO TO 5400-LETTER-RELEASE
  8501             ELSE
  8502                 MOVE AL-UNBON TO ENTERPFA
  8503                 MOVE -1       TO ENTERPFL
  8504                 MOVE ER-2398  TO EMI-ERROR
  8505                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8506                 GO TO 8200-SEND-DATAONLY.
  8507
  8508*    IF  EIBAID = DFHPF4 OR DFHPF8
  8509*        GO TO 7900-PRINT-LETTER-NOW.
  8510
  8511 0330-EDIT.
  8512
  8513     IF  W-SC-TEXTL (1) NOT EQUAL ZEROS
  8514             OR
  8515         W-SC-TEXTL (2) NOT EQUAL ZEROS
  8516             OR
  8517         W-SC-TEXTL (3) NOT EQUAL ZEROS
  8518             OR
  8519         W-SC-TEXTL (4) NOT EQUAL ZEROS
  8520             OR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 163
* EL689.cbl
  8521         W-SC-TEXTL (5) NOT EQUAL ZEROS
  8522             OR
  8523         W-SC-TEXTL (6) NOT EQUAL ZEROS
  8524             OR
  8525         W-SC-TEXTL (7) NOT EQUAL ZEROS
  8526             OR
  8527         W-SC-TEXTL (8) NOT EQUAL ZEROS
  8528             OR
  8529         W-SC-TEXTL (9) NOT EQUAL ZEROS
  8530             OR
  8531         W-SC-TEXTL (10) NOT EQUAL ZEROS
  8532             OR
  8533         W-SC-TEXTL (11) NOT EQUAL ZEROS
  8534         IF  W-KEY-FIELDS-CHANGED
  8535                 OR
  8536             W-FORM-CHANGED
  8537             MOVE ER-7250        TO EMI-ERROR
  8538             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8539             MOVE -1             TO MAINTL
  8540             MOVE AL-UABON       TO MAINTA
  8541         ELSE
  8542             PERFORM 4100-SET-NDX THRU 4100-EXIT
  8543             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
  8544                     VARYING
  8545                 W-SC-NDX FROM 1 BY 1
  8546                     UNTIL
  8547                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
  8548             MOVE ER-7398        TO EMI-ERROR
  8549             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8550             MOVE -1             TO MAINTL
  8551             MOVE AL-UABON       TO MAINTA
  8552             GO TO 8200-SEND-DATAONLY.
  8553
  8554     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8555
  8556     IF  W-KEY-FIELDS-CHANGED
  8557             OR
  8558         PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8559         PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  8560         IF  MAINTI EQUAL 'C'
  8561             GO TO 2000-CREATE
  8562         ELSE
  8563             NEXT SENTENCE
  8564     ELSE
  8565         IF  W-FORM-CHANGED
  8566             PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  8567             IF  MAINTI EQUAL 'C'
  8568                 GO TO 2000-CREATE
  8569             ELSE
  8570                 NEXT SENTENCE
  8571         ELSE
  8572             MOVE -1             TO MAINTL
  8573             GO TO 8200-SEND-DATAONLY.
  8574
  8575     MOVE ER-0023                TO EMI-ERROR.
  8576     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8577     MOVE -1                     TO MAINTL.
  8578     MOVE AL-UABON               TO MAINTA.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 164
* EL689.cbl
  8579     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 165
* EL689.cbl
  8581 0350-EDIT-ROUTINE.
  8582
  8583     IF  MAINTI EQUAL 'C'
  8584             AND
  8585         FORML EQUAL ZEROS
  8586         MOVE -1                 TO FORML
  8587         MOVE ER-0177            TO EMI-ERROR
  8588         MOVE AL-UABON           TO FORMA
  8589         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8590
  8591     IF PRTNOWL > ZEROS
  8592        IF PRTNOWI = 'Y' OR 'N' OR 'P' OR ' '
  8593           MOVE PRTNOWI          TO PI-PRINT-NOW
  8594           MOVE AL-UANON         TO PRTNOWA
  8595        END-IF
  8596     END-IF
  8597     IF ENDARCHL > ZEROS
  8598        IF ENDARCHI NUMERIC
  8599            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
  8600            MOVE AL-UNNON       TO ENDARCHA
  8601            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
  8602            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
  8603            MOVE 'N'            TO W-VALID-ENDT-SW
  8604            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
  8605            IF NOT W-VALID-ENDT
  8606                MOVE -1         TO ENDARCHL
  8607                MOVE ER-1565    TO EMI-ERROR
  8608                MOVE AL-UNBON   TO ENDARCHA
  8609                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8610            END-IF
  8611        END-IF
  8612     END-IF
  8613     MOVE SPACES                 TO PI-689-PRINT-RESTRICTION
  8614*    IF  PRTRESTL NOT EQUAL ZEROS
  8615*        PERFORM 0360-EDIT-PRINT-RESTRICTIONS THRU 0360-EXIT.
  8616
  8617     IF  FOLLOWL NOT EQUAL ZEROS
  8618         MOVE FOLLOWI            TO W-DEEDIT-FIELD
  8619         PERFORM 8600-DEEDIT
  8620         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  8621         MOVE '4'                TO DC-OPTION-CODE
  8622         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8623         IF  DATE-CONVERSION-ERROR
  8624             MOVE ER-0182        TO EMI-ERROR
  8625             MOVE -1             TO FOLLOWL
  8626             MOVE AL-UABON       TO FOLLOWA
  8627             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8628         ELSE
  8629             MOVE DC-GREG-DATE-1-EDIT
  8630                                 TO FOLLOWO
  8631                                    PI-689-FOLLOW-UP-EDIT
  8632             MOVE AL-UANON       TO FOLLOWA
  8633             MOVE DC-BIN-DATE-1  TO PI-689-FOLLOW-UP-DATE
  8634     ELSE
  8635         MOVE LOW-VALUES         TO PI-689-FOLLOW-UP-DATE.
  8636
  8637     IF  PI-689-FOLLOW-UP-DATE NOT EQUAL LOW-VALUES
  8638         IF  PI-689-FOLLOW-UP-DATE LESS THAN
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 166
* EL689.cbl
  8639                 W-SAVE-BIN-DATE
  8640             MOVE ER-0533        TO EMI-ERROR
  8641             MOVE AL-UABON       TO FOLLOWA
  8642             MOVE -1             TO FOLLOWL
  8643             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8644
  8645     IF  RESEND1L NOT EQUAL ZEROS
  8646         MOVE RESEND1I           TO W-DEEDIT-FIELD
  8647         PERFORM 8600-DEEDIT
  8648         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  8649         MOVE '4'                TO DC-OPTION-CODE
  8650         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8651         IF  DATE-CONVERSION-ERROR
  8652             MOVE ER-0185        TO EMI-ERROR
  8653             MOVE -1             TO RESEND1L
  8654             MOVE AL-UABON       TO RESEND1A
  8655             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8656         ELSE
  8657             MOVE DC-GREG-DATE-1-EDIT
  8658                                 TO RESEND1O
  8659                                    PI-689-RESEND1-EDIT
  8660             MOVE AL-UANON       TO RESEND1A
  8661             MOVE DC-BIN-DATE-1  TO PI-689-RESEND-DATE-1
  8662     ELSE
  8663         MOVE LOW-VALUES         TO PI-689-RESEND-DATE-1.
  8664
  8665     IF  PI-689-RESEND-DATE-1 NOT EQUAL LOW-VALUES
  8666         IF  PI-689-RESEND-DATE-1 NOT GREATER THAN
  8667                 W-SAVE-BIN-DATE
  8668             MOVE ER-0537        TO EMI-ERROR
  8669             MOVE AL-UABON       TO RESEND1A
  8670             MOVE -1             TO RESEND1L
  8671             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8672
  8673     IF ENCL > ZEROS
  8674        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  8675                                          PI-ENCLOSURE-CD
  8676        IF ENCI  = 'A'   OR
  8677                   'C'   OR
  8678                   'CLM' OR
  8679                   'E'   OR
  8680                   'ENV' OR
  8681                   '0'
  8682              OR 'RE'
  8683              OR '1' OR '2' OR '3' OR 'B' OR 'D'
  8684           MOVE ENCI             TO PI-ENCLOSURE-CD
  8685                                    W-ENCLOSURE-CD
  8686           MOVE AL-UANON         TO ENCA
  8687        ELSE
  8688           MOVE ER-1560          TO EMI-ERROR
  8689           MOVE -1               TO ENCL
  8690           MOVE AL-UABON         TO ENCA
  8691           PERFORM 9900-ERROR-FORMAT
  8692                                 THRU 9900-EXIT
  8693        END-IF
  8694     END-IF
  8695
  8696
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 167
* EL689.cbl
  8697     IF NOT PI-CREATE-LABELS
  8698         MOVE PI-LABEL-CONTROL   TO ADDRLBLI
  8699         MOVE AL-PANON           TO ADDRLBLA
  8700         GO TO 0350-BYPASS-OVERRIDE.
  8701
  8702     IF  ADDRLBLL GREATER THAN ZEROS
  8703          INSPECT ADDRLBLI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8704          IF ADDRLBLI = 'N' OR 'Y'
  8705              MOVE ADDRLBLI      TO PI-689-LBL-OVERRIDE
  8706              MOVE AL-UANON      TO ADDRLBLA
  8707          ELSE
  8708             MOVE ER-3783        TO EMI-ERROR
  8709             MOVE -1             TO ADDRLBLL
  8710             MOVE AL-UABON       TO ADDRLBLA
  8711             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8712
  8713 0350-BYPASS-OVERRIDE.
  8714
  8715     IF  PI-BYPASS-LABELS
  8716             OR
  8717         FORMI EQUAL '9999'
  8718             OR
  8719         PI-689-LABELS-OVERRIDEN
  8720         MOVE SPACES             TO PI-689-LABEL-SOURCE
  8721         MOVE LOW-VALUES         TO ADDRSI
  8722         MOVE AL-UANOF           TO ADDRSA
  8723         MOVE ZEROS              TO ADDRSL
  8724     ELSE
  8725         IF  ADDRSL GREATER THAN ZEROS
  8726             MOVE ADDRSI         TO W-LABEL-SOURCE
  8727             IF  W-LABEL-SOURCE-VALID
  8728                 MOVE ADDRSI     TO PI-689-LABEL-SOURCE
  8729             ELSE
  8730                 MOVE -1         TO ADDRSL
  8731                 MOVE ER-0176    TO EMI-ERROR
  8732                 MOVE AL-UABON   TO ADDRSA
  8733                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8734         ELSE
  8735             IF  MAINTI EQUAL 'C'
  8736                 MOVE -1         TO ADDRSL
  8737                 MOVE ER-0176    TO EMI-ERROR
  8738                 MOVE AL-UABON   TO ADDRSA
  8739                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8740
  8741     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  8742     IF  PRINTERL GREATER ZERO
  8743         INSPECT PRINTERI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8744         MOVE AL-UANON           TO PRINTERA
  8745         MOVE PRINTERI           TO PI-689-ALT-PRINTER-ID
  8746                                    PI-ALT-DMD-PRT-ID
  8747     ELSE
  8748         IF  PI-NO-CARRIER-SECURITY
  8749                 AND
  8750             PI-NO-ACCOUNT-SECURITY
  8751             IF  PI-PROCESSOR-PRINTER GREATER THAN SPACES
  8752                 MOVE PI-PROCESSOR-PRINTER
  8753                                 TO PI-689-ALT-PRINTER-ID
  8754                                    PRINTERI
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 168
* EL689.cbl
  8755                 MOVE AL-UABON   TO PRINTERA
  8756             ELSE
  8757                 MOVE PI-COMPANY-ID
  8758                                 TO W-CNTL-COMPANY-ID
  8759                 MOVE '1'        TO W-CNTL-RECORD-TYPE
  8760                 MOVE SPACES     TO W-CNTL-GENL
  8761                 MOVE ZEROS      TO W-CNTL-SEQ-NO
  8762
  8763* EXEC CICS HANDLE CONDITION
  8764*                     NOTOPEN    (8040-CNTL-NOT-OPEN)
  8765*                     NOTFND     (7945-NOT-FOUND)
  8766*                END-EXEC
  8767*    MOVE '"$JI                  ! $ #00008701' TO DFHEIV0
  8768     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8769     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8770     MOVE X'2420233030303038373031' TO DFHEIV0(25:11)
  8771     CALL 'kxdfhei1' USING DFHEIV0
  8772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8773
  8774* EXEC CICS READ
  8775*                     DATASET    (W-CNTL-FILE-ID)
  8776*                     SET        (ADDRESS OF CONTROL-FILE)
  8777*                     RIDFLD     (W-CNTL-KEY)
  8778*                END-EXEC
  8779*    MOVE '&"S        E          (   #00008705' TO DFHEIV0
  8780     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8781     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8782     MOVE X'2020233030303038373035' TO DFHEIV0(25:11)
  8783     CALL 'kxdfhei1' USING DFHEIV0,
  8784           W-CNTL-FILE-ID,
  8785           DFHEIV20,
  8786           DFHEIV99,
  8787           W-CNTL-KEY,
  8788           DFHEIV99,
  8789           DFHEIV99,
  8790           DFHEIV99
  8791     SET ADDRESS OF CONTROL-FILE TO
  8792         DFHEIV20
  8793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8794                 MOVE CF-FORMS-PRINTER-ID
  8795                                 TO PI-689-ALT-PRINTER-ID
  8796                                    PRINTERI
  8797                                    W-TS-TERM-TEXT
  8798                 MOVE AL-UABON   TO PRINTERA
  8799         ELSE
  8800             MOVE AL-UABON       TO PRINTERA
  8801             MOVE -1             TO PRINTERL
  8802             MOVE ER-9283        TO EMI-ERROR
  8803             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8804
  8805     IF  COPIESL NOT EQUAL ZEROS
  8806         IF  COPIESI NOT NUMERIC
  8807                 OR
  8808             COPIESI EQUAL '0'
  8809             MOVE ER-0184        TO EMI-ERROR
  8810             MOVE -1             TO COPIESL
  8811             MOVE AL-UABON       TO COPIESA
  8812             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 169
* EL689.cbl
  8813         ELSE
  8814             MOVE COPIESI        TO PI-689-NUMBER-COPIES
  8815             MOVE AL-UANON       TO COPIESA
  8816     ELSE
  8817         IF FORMI EQUAL '9999'
  8818             MOVE 1              TO PI-689-NUMBER-COPIES
  8819                                    COPIESL
  8820                                    COPIESO.
  8821
  8822     IF  FORML NOT EQUAL ZEROS
  8823         INSPECT FORMI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8824         MOVE FORMI              TO PI-689-FORM-NUMBER.
  8825
  8826     MOVE SPACES                 TO W-HOLD-IND.
  8827
  8828     IF PI-CERT-REQ-IND = 'Y'
  8829       IF  CERTIDL NOT EQUAL ZEROS
  8830         IF CERTIDI NUMERIC
  8831             MOVE AL-UANON      TO CERTIDA
  8832             MOVE CERTIDI       TO PI-CERT-FORM-ID
  8833         ELSE
  8834             MOVE ER-1778       TO EMI-ERROR
  8835             MOVE -1            TO CERTIDL
  8836             MOVE AL-UABON      TO CERTIDA
  8837             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8838         END-IF
  8839       ELSE
  8840          MOVE ER-0715       TO EMI-ERROR
  8841          MOVE -1            TO CERTIDL
  8842          MOVE AL-UABON      TO CERTIDA
  8843          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8844       END-IF
  8845     END-IF.
  8846
  8847     IF  NOT EMI-NO-ERRORS
  8848         IF  EMI-ERROR EQUAL ER-7250
  8849             GO TO 0350-EXIT
  8850         ELSE
  8851            MOVE -1             TO MAINTL
  8852            GO TO 8200-SEND-DATAONLY.
  8853
  8854 0350-EXIT.
  8855      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 170
* EL689.cbl
  8857 0355-CHECK-ERENDT.
  8858
  8859*     EXEC CICS GETMAIN
  8860*          SET      (ADDRESS OF ENDORSEMENT-RECORD)
  8861*          LENGTH   (W-ENDT-LENGTH)
  8862*     END-EXEC
  8863
  8864
  8865* EXEC CICS READ
  8866*         DATASET    ('ERENDT2')
  8867*         SET        (ADDRESS OF ENDORSEMENT-RECORD)
  8868*         RIDFLD     (W-ERENDT-KEY-BY-ARCH)
  8869*         RESP       (W-RESPONSE)
  8870*    END-EXEC
  8871     MOVE 'ERENDT2' TO DFHEIV1
  8872*    MOVE '&"S        E          (  N#00008780' TO DFHEIV0
  8873     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8874     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8875     MOVE X'204E233030303038373830' TO DFHEIV0(25:11)
  8876     CALL 'kxdfhei1' USING DFHEIV0,
  8877           DFHEIV1,
  8878           DFHEIV20,
  8879           DFHEIV99,
  8880           W-ERENDT-KEY-BY-ARCH,
  8881           DFHEIV99,
  8882           DFHEIV99,
  8883           DFHEIV99
  8884     SET ADDRESS OF ENDORSEMENT-RECORD TO
  8885         DFHEIV20
  8886     MOVE EIBRESP  TO W-RESPONSE
  8887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8888
  8889     IF (RESP-NORMAL)
  8890         IF PI-RETURN-TO-PROGRAM EQUAL 'EL6311'  AND
  8891            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  8892            EN-CARRIER     =  PI-689-CARRIER     AND
  8893            EN-GROUPING    =  PI-689-GROUPING    AND
  8894            EN-STATE       =  PI-689-STATE       AND
  8895            EN-ACCOUNT     =  PI-689-ACCOUNT     AND
  8896            EN-CERT-EFF-DT =  PI-689-EFF-DATE    AND
  8897            EN-CERT-NO     =  PI-689-CERT-NO
  8898               SET W-VALID-ENDT TO TRUE
  8899         END-IF
  8900         IF PI-RETURN-TO-PROGRAM EQUAL 'EL1273'  AND
  8901            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  8902            EN-CARRIER     =  PI-CARRIER         AND
  8903            EN-GROUPING    =  PI-GROUPING        AND
  8904            EN-STATE       =  PI-STATE           AND
  8905            EN-ACCOUNT     =  PI-ACCOUNT         AND
  8906            EN-CERT-EFF-DT =  PI-CERT-EFF-DT     AND
  8907            EN-CERT-NO     =  PI-CERT-NO
  8908               SET W-VALID-ENDT TO TRUE
  8909         END-IF
  8910     END-IF
  8911      .
  8912
  8913 0355-EXIT.
  8914      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 171
* EL689.cbl
  8916 0360-EDIT-PRINT-RESTRICTIONS.
  8917
  8918*    INSPECT PRTRESTI CONVERTING W-LOWER-CASE
  8919*                                TO W-UPPER-CASE.
  8920*
  8921*    IF  (PI-689-PRINT-RESTRICTION EQUAL ' ' OR 'F'
  8922*                                     OR 'P' OR LOW-VALUES)
  8923*            AND
  8924*        PRTRESTI EQUAL 'C'
  8925*            AND
  8926*        PI-689-CONTROL NOT GREATER THAN ZEROS
  8927*        MOVE ER-7243            TO EMI-ERROR
  8928*        MOVE -1                 TO PRTRESTL
  8929*        MOVE AL-UABON           TO PRTRESTA
  8930*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8931*        GO TO 0360-EXIT.
  8932*
  8933*    IF  PRTRESTL NOT EQUAL ZEROS
  8934*        IF PRTRESTI = 'C' OR 'F' OR 'P'
  8935*            MOVE PRTRESTI       TO PI-689-PRINT-RESTRICTION
  8936*            MOVE AL-UANON       TO PRTRESTA
  8937*        ELSE
  8938*            IF  PRTRESTI EQUAL ' '
  8939*                MOVE SPACES     TO PI-689-PRINT-RESTRICTION
  8940*                MOVE AL-UANON   TO PRTRESTA
  8941*            ELSE
  8942*                MOVE ER-7393    TO EMI-ERROR
  8943*                MOVE -1         TO PRTRESTL
  8944*                MOVE AL-UABON   TO PRTRESTA
  8945*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8946*
  8947*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
  8948*            AND
  8949*        W-HOLD-ON
  8950*            AND
  8951*        PI-689-CONTROL NOT GREATER THAN ZEROS
  8952*        MOVE ER-7243            TO EMI-ERROR
  8953*        MOVE -1                 TO PRTRESTL
  8954*        MOVE AL-UABON           TO PRTRESTA
  8955*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8956     .
  8957 0360-EXIT.
  8958      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 172
* EL689.cbl
  8960 0400-EL6311-INCOMING.
  8961
  8962     MOVE ZEROS                  TO PI-CURRENT-LINE
  8963                                    PI-TEMP-STOR-ITEMS
  8964                                    PI-TOTAL-LINES
  8965                                    PI-UPDATE-SW
  8966                                    PI-689-NUMBER-LABEL-LINES
  8967                                    PI-689-ERROR
  8968                                    PI-689-NUMBER-TEXT-RECORDS.
  8969     MOVE SPACES                 TO PI-689-PRINT-SW
  8970                                    PI-689-ALT-PRINTER-ID
  8971                                    PI-COMM-CONTROL
  8972                                    PI-689-FORM-NUMBER
  8973                                    PI-689-TEMP-STOR-ID
  8974                                    PI-689-LABEL-SOURCE
  8975                                    PI-689-USE-SCREEN-IND.
  8976
  8977     IF PI-CREATE-LABELS
  8978         MOVE  AL-UANON          TO ADDRLBLA
  8979         MOVE  +1                TO ADDRLBLL.
  8980
  8981     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  8982                                    PI-689-LBL-OVERRIDE.
  8983
  8984     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
  8985     MOVE '2'                    TO PI-ACTION.
  8986     MOVE -1                     TO MAINTL.
  8987
  8988     MOVE AL-UANON               TO PRTNOWA.
  8989     MOVE +1                     TO PRTNOWL.
  8990     MOVE 'N'                    TO PRTNOWI
  8991                                    PI-PRINT-NOW.
  8992
  8993     IF  PI-689-CARRIER NOT EQUAL LOW-VALUES
  8994         MOVE AL-UANON           TO CARRIERA
  8995         MOVE +1                 TO CARRIERL
  8996         MOVE PI-689-CARRIER     TO CARRIERI.
  8997
  8998     IF  PI-689-GROUPING NOT EQUAL LOW-VALUES
  8999         MOVE +6                 TO GROUPL
  9000         MOVE AL-UANON           TO GROUPA
  9001         MOVE PI-689-GROUPING    TO GROUPI.
  9002
  9003     IF  PI-689-STATE NOT EQUAL LOW-VALUES
  9004         MOVE +2                 TO STATEL
  9005         MOVE AL-UANON           TO STATEA
  9006         MOVE PI-689-STATE       TO STATEI.
  9007
  9008     IF  PI-689-ACCOUNT NOT EQUAL LOW-VALUES
  9009         MOVE +10                TO ACCTL
  9010         MOVE AL-UANON           TO ACCTA
  9011         MOVE PI-689-ACCOUNT     TO ACCTI.
  9012
  9013     IF  PI-689-CERT-PRIME NOT EQUAL LOW-VALUES
  9014         MOVE +10                TO CERTL
  9015         MOVE AL-UANON           TO CERTA
  9016         MOVE PI-689-CERT-PRIME  TO CERTI.
  9017
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 173
* EL689.cbl
  9018     IF  PI-689-CERT-SFX NOT EQUAL LOW-VALUES
  9019         MOVE +1                 TO SFXL
  9020         MOVE AL-UANON           TO SFXA
  9021         MOVE PI-689-CERT-SFX    TO SFXI.
  9022
  9023     IF  PI-689-ENTRY-BATCH NOT EQUAL LOW-VALUES
  9024         MOVE +6                 TO BENTRYL
  9025         MOVE AL-UANON           TO BENTRYA
  9026         MOVE PI-689-ENTRY-BATCH TO BENTRYI.
  9027
  9028     MOVE +4                     TO BCSEQL.
  9029     MOVE AL-UANON               TO BCSEQA.
  9030     MOVE PI-689-CHG-SEQ-NO      TO BCSEQI.
  9031
  9032     IF  PI-689-SEQ-NO NOT EQUAL ZEROS
  9033         MOVE +8                 TO SEQL
  9034         MOVE AL-UANON           TO SEQA
  9035         MOVE PI-689-SEQ-NO      TO SEQI.
  9036
  9037     IF  PI-689-EFF-DATE NOT EQUAL LOW-VALUES
  9038         MOVE PI-689-EFF-DATE    TO DC-BIN-DATE-1
  9039         MOVE ' '                TO DC-OPTION-CODE
  9040         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9041         MOVE +8                 TO DATEL
  9042         MOVE DC-GREG-DATE-1-EDIT
  9043                                 TO DATEI
  9044         MOVE AL-UANON           TO DATEA.
  9045
  9046     MOVE -1                     TO MAINTL.
  9047     MOVE '4'                    TO DATASORI
  9048                                    PI-689-DATA-SOURCE.
  9049     MOVE +1                     TO DATASORL.
  9050     MOVE AL-UANON               TO DATASORA.
  9051
  9052     GO TO 8100-SEND-INITIAL-MAP.
  9053
  9054 0400-EXIT.
  9055      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 174
* EL689.cbl
  9057 0450-SPECIAL-INPUT-PROCESS.
  9058
  9059     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6501'
  9060             AND
  9061         PI-CARRIER GREATER THAN LOW-VALUES
  9062         MOVE '1'                TO DATASORI
  9063                                    PI-689-DATA-SOURCE
  9064         MOVE PI-CARRIER         TO CARRIERI
  9065         MOVE PI-GROUPING        TO GROUPI
  9066         MOVE PI-STATE           TO STATEI
  9067         MOVE PI-ACCOUNT         TO ACCTI
  9068         MOVE PI-CERT-EFF-DT     TO DC-BIN-DATE-1
  9069         MOVE ' '                TO DC-OPTION-CODE
  9070         PERFORM 9500-LINK-DATE-CONVERT
  9071             THRU 9500-EXIT
  9072         MOVE DC-GREG-DATE-1-EDIT
  9073                                 TO DATEI
  9074         MOVE 'N'                TO PRTNOWI
  9075                                    PI-PRINT-NOW
  9076         MOVE AL-UANON           TO ACCTA
  9077                                    CARRIERA
  9078                                    DATEA
  9079                                    DATASORA
  9080                                    GROUPA
  9081                                    STATEA
  9082                                    PRTNOWA
  9083         MOVE +1                 TO CARRIERL
  9084                                    DATASORL
  9085                                    PRTNOWL
  9086         MOVE -1                 TO MAINTL
  9087         MOVE +6                 TO GROUPL
  9088         MOVE +2                 TO STATEL
  9089         MOVE +8                 TO DATEL
  9090         MOVE +10                TO ACCTL
  9091     ELSE
  9092         IF  PI-RETURN-TO-PROGRAM EQUAL 'EL652'
  9093                 AND
  9094             PI-CARRIER GREATER THAN LOW-VALUES
  9095             MOVE '3'            TO DATASORI
  9096                                    PI-689-DATA-SOURCE
  9097             MOVE PI-CR-CARRIER  TO CARRIERI
  9098             MOVE PI-CR-GROUPING TO GROUPI
  9099             MOVE PI-CR-ACCOUNT  TO ACCTI
  9100             MOVE PI-CR-FIN-RESP TO RPERSONI
  9101             MOVE PI-CR-TYPE     TO TYPEI
  9102             MOVE 'N'            TO PRTNOWI
  9103                                    PI-PRINT-NOW
  9104             MOVE AL-UANON       TO CARRIERA
  9105                                    GROUPA
  9106                                    ACCTA
  9107                                    DATASORA
  9108                                    RPERSONA
  9109                                    TYPEA
  9110                                    PRTNOWA
  9111             MOVE +1             TO CARRIERL
  9112                                    DATASORL
  9113                                    TYPEL
  9114                                    PRTNOWL
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 175
* EL689.cbl
  9115             MOVE -1             TO MAINTL
  9116             MOVE +6             TO GROUPL
  9117             MOVE +10            TO ACCTL
  9118                                    RPERSONL
  9119         ELSE
  9120             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL1273'
  9121                     AND
  9122                 PI-CARRIER GREATER THAN LOW-VALUES
  9123                 MOVE '2'        TO DATASORI
  9124                                    PI-689-DATA-SOURCE
  9125                 MOVE PI-CARRIER TO CARRIERI
  9126                 MOVE PI-GROUPING
  9127                                 TO GROUPI
  9128                 MOVE PI-STATE   TO STATEI
  9129                 MOVE PI-ACCOUNT TO ACCTI
  9130                 MOVE PI-CERT-PRIME
  9131                                 TO CERTI
  9132                 MOVE PI-CERT-SFX
  9133                                 TO SFXI
  9134                 MOVE PI-CERT-EFF-DT
  9135                                 TO DC-BIN-DATE-1
  9136                 MOVE ' '        TO DC-OPTION-CODE
  9137                 PERFORM 9500-LINK-DATE-CONVERT
  9138                     THRU 9500-EXIT
  9139                 MOVE DC-GREG-DATE-1-EDIT
  9140                                 TO DATEI
  9141                 MOVE 'N'        TO PRTNOWI
  9142                                    PI-PRINT-NOW
  9143                 MOVE AL-UANON   TO CARRIERA
  9144                                    GROUPA
  9145                                    STATEA
  9146                                    ACCTA
  9147                                    CERTA
  9148                                    SFXA
  9149                                    DATEA
  9150                                    ADDRSA
  9151                                    DATASORA
  9152                                    PRTNOWA
  9153                 MOVE +1         TO CARRIERL
  9154                                    SFXL
  9155                                    DATASORL
  9156                                    ADDRSL
  9157                                    PRTNOWL
  9158                 MOVE -1         TO MAINTL
  9159                 MOVE +6         TO GROUPL
  9160                 MOVE +2         TO STATEL
  9161                 MOVE +8         TO DATEL
  9162                 MOVE +10        TO ACCTL
  9163                                    CERTL.
  9164
  9165     IF PI-CREATE-LABELS
  9166         MOVE  AL-UANON          TO ADDRLBLA
  9167         MOVE  +1                TO ADDRLBLL.
  9168
  9169     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9170                                    PI-689-LBL-OVERRIDE.
  9171
  9172     MOVE LOW-VALUES             TO PI-689-KEY-DATA-FIELDS.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 176
* EL689.cbl
  9173     GO TO 8100-SEND-INITIAL-MAP.
  9174
  9175 0450-EXIT.
  9176      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 177
* EL689.cbl
  9178 0600-BYPASS-SCREEN-CNTL.
  9179***************************************************************
  9180*     THIS ROUTINE WILL PROCESS A NEW LETTER REQUIREMENT      *
  9181*     WITH THE INFORMATION FOUND IN THE PI AREA WITHOUT       *
  9182*     PERFORMING ANY SCREEN IO.                               *
  9183***************************************************************
  9184
  9185
  9186* EXEC CICS HANDLE CONDITION
  9187*        PGMIDERR (9700-PGMID-ERROR)
  9188*        MAPFAIL  (0325-MAPFAIL)
  9189*        ERROR    (9800-ABEND)
  9190*    END-EXEC.
  9191*    MOVE '"$L?.                 ! % #00009083' TO DFHEIV0
  9192     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  9193     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9194     MOVE X'2520233030303039303833' TO DFHEIV0(25:11)
  9195     CALL 'kxdfhei1' USING DFHEIV0
  9196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9197
  9198
  9199     MOVE LOW-VALUES             TO EL689AI.
  9200
  9201     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM
  9202
  9203     MOVE PI-689-FORM-NUMBER     TO FORMI.
  9204     MOVE +4                     TO FORML.
  9205
  9206     IF  PI-689-NUMBER-COPIES GREATER THAN ZERO
  9207         MOVE PI-689-NUMBER-COPIES
  9208                                 TO COPIESI
  9209         MOVE +1                 TO COPIESL.
  9210
  9211     MOVE PI-689-LABEL-SOURCE    TO ADDRSI.
  9212     MOVE +1                     TO ADDRSL.
  9213     MOVE PI-689-DATA-SOURCE     TO DATASORI.
  9214     MOVE +1                     TO DATASORL.
  9215
  9216*    IF  PI-689-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
  9217*        MOVE PI-689-PRINT-RESTRICTION
  9218*                                TO PRTRESTI
  9219*        MOVE +1                 TO PRTRESTL.
  9220
  9221     MOVE SPACES                 TO PI-689-PRINT-SW
  9222                                    PI-689-LBL-OVERRIDE.
  9223     MOVE ZEROS                  TO PI-TOTAL-LINES
  9224                                    PI-CURRENT-LINE
  9225                                    PI-TEMP-STOR-ITEMS
  9226                                    PI-UPDATE-SW
  9227                                    PI-689-ERROR
  9228                                    PI-689-NUMBER-LABEL-LINES
  9229                                    PI-689-NUMBER-TEXT-RECORDS.
  9230
  9231     IF  PI-689-ALT-PRINTER-ID NOT EQUAL LOW-VALUES
  9232         MOVE +4                 TO PRINTERL
  9233         MOVE PI-689-ALT-PRINTER-ID
  9234                                 TO PRINTERI PI-ALT-DMD-PRT-ID.
  9235
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 178
* EL689.cbl
  9236     MOVE SPACES                 TO PI-689-ALT-PRINTER-ID.
  9237
  9238     IF  PI-689-SOURCE-VARIABLE
  9239         PERFORM 0700-GET-VARIABLE-LABEL THRU 0700-EXIT.
  9240
  9241     MOVE SPACES                 TO W-CNTL-KEY
  9242     MOVE LOW-VALUES             TO W-ACCT-KEY
  9243                                    W-CERT-KEY
  9244                                    W-CHEK-KEY
  9245                                    W-COMP-KEY
  9246                                    W-MAIL-KEY
  9247                                    W-PNDB-KEY
  9248                                    W-PNDB2-KEY
  9249                                    W-PYAJ-KEY.
  9250
  9251     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9252     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9253                                    W-CERT-COMPANY-CD
  9254                                    W-CHEK-COMPANY-CD
  9255                                    W-COMP-COMPANY-CD
  9256                                    W-MAIL-COMPANY-CD
  9257                                    W-PNDB-COMPANY-CD
  9258                                    W-PNDB2-COMPANY-CD
  9259                                    W-PYAJ-COMPANY-CD.
  9260
  9261     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
  9262         MOVE PI-689-CARRIER     TO W-ACCT-CARRIER
  9263                                    W-CERT-CARRIER
  9264                                    W-MAIL-CARRIER
  9265                                    W-CERT-CARRIER
  9266                                    W-COMP-CARRIER
  9267                                    W-CHEK-CARRIER
  9268                                    W-PNDB2-CARRIER
  9269                                    W-PYAJ-CARRIER.
  9270
  9271     IF  PI-689-GROUPING GREATER THAN LOW-VALUES
  9272         MOVE PI-689-GROUPING    TO W-ACCT-GROUPING
  9273                                    W-CERT-GROUPING
  9274                                    W-CHEK-GROUPING
  9275                                    W-COMP-GROUPING
  9276                                    W-MAIL-GROUPING
  9277                                    W-PNDB2-GROUPING
  9278                                    W-PYAJ-GROUPING.
  9279
  9280     IF  PI-689-STATE GREATER THAN LOW-VALUES
  9281         MOVE PI-689-STATE       TO W-ACCT-STATE
  9282                                    W-CERT-STATE
  9283                                    W-CHEK-STATE
  9284                                    W-MAIL-STATE
  9285                                    W-PNDB2-STATE.
  9286
  9287     IF  PI-689-ACCOUNT GREATER THAN LOW-VALUES
  9288         IF PI-689-DATA-SOURCE = '3' OR '6'
  9289             MOVE PI-689-ACCOUNT TO W-COMP-ACCOUNT
  9290                                    W-PYAJ-ACCOUNT
  9291         ELSE
  9292             MOVE PI-689-ACCOUNT TO W-ACCT-ACCOUNT
  9293                                    W-CERT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 179
* EL689.cbl
  9294                                    W-CHEK-ACCOUNT
  9295                                    W-MAIL-ACCOUNT
  9296                                    W-PNDB2-ACCOUNT.
  9297
  9298     IF  PI-689-EFF-DATE GREATER THAN LOW-VALUES
  9299         MOVE PI-689-EFF-DATE    TO W-CERT-EFF-DT
  9300                                    W-CHEK-EFF-DT
  9301                                    W-MAIL-EFF-DT
  9302                                    W-PNDB2-EFF-DT.
  9303
  9304     IF  PI-689-CERT-PRIME GREATER THAN LOW-VALUES
  9305         MOVE PI-689-CERT-PRIME  TO W-CERT-CERT-PRIME
  9306                                    W-CHEK-CERT-PRIME
  9307                                    W-MAIL-CERT-PRIME
  9308                                    W-PNDB2-CERT-PRIME
  9309
  9310         IF  PI-689-CERT-SFX GREATER THAN LOW-VALUES
  9311             MOVE PI-689-CERT-SFX
  9312                                 TO W-CERT-CERT-SFX
  9313                                    W-CHEK-CERT-SFX
  9314                                    W-MAIL-CERT-SFX
  9315                                    W-PNDB2-CERT-SFX
  9316         ELSE
  9317             MOVE SPACES         TO W-CERT-CERT-SFX
  9318                                    W-CHEK-CERT-SFX
  9319                                    W-MAIL-CERT-SFX
  9320                                    W-PNDB2-CERT-SFX.
  9321
  9322     IF  PI-689-RESP-PERSON GREATER THAN LOW-VALUES
  9323         IF PI-689-DATA-SOURCE = '3' OR '6'
  9324             MOVE PI-689-RESP-PERSON
  9325                                 TO W-COMP-RESP-PERSON
  9326                                    W-PYAJ-FIN-RESP.
  9327
  9328     IF  PI-689-TYPE GREATER THAN LOW-VALUES
  9329         IF PI-689-DATA-SOURCE = '3' OR '6'
  9330             MOVE PI-689-TYPE    TO W-COMP-TYPE
  9331                                    W-PYAJ-RECORD-TYPE
  9332         ELSE
  9333             MOVE PI-689-TYPE    TO W-PNDB2-TYPE.
  9334
  9335     IF  PI-689-SEQ-NO GREATER THAN ZEROS
  9336         MOVE PI-689-SEQ-NO      TO W-PNDB-SEQ-NO
  9337                                    W-PYAJ-FILE-SEQ-NO
  9338                                    W-CHEK-SEQ-NO.
  9339
  9340     IF  PI-689-CHG-SEQ-NO GREATER THAN ZEROS
  9341         MOVE PI-689-CHG-SEQ-NO  TO W-PNDB-CHG-SEQ-NO
  9342                                    W-PNDB2-ALT-CHG-SEQ-NO.
  9343
  9344     IF  PI-689-ENTRY-BATCH GREATER THAN LOW-VALUES
  9345         MOVE PI-689-ENTRY-BATCH TO W-PNDB-ENTRY.
  9346
  9347     IF  PI-689-NO-ERRORS-DETECTED
  9348         PERFORM 2000-CREATE THRU 2000-EXIT
  9349         IF  NOT PI-689-FATAL-ERROR
  9350                 AND
  9351             NOT PI-689-ERR-DETECTED-PREV
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 180
* EL689.cbl
  9352             IF  PI-689-PRINT-ONLY
  9353                 PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9354             ELSE
  9355                 IF  PI-689-PRINT-FIRST
  9356                     PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9357                     IF  NOT PI-689-FATAL-ERROR
  9358                         IF  PI-689-ARCHIVE-LETTER
  9359                             PERFORM 5400-LETTER-RELEASE
  9360                                 THRU 5400-EXIT
  9361                         ELSE
  9362                             MOVE ER-7390
  9363                                 TO PI-689-ERROR
  9364                     ELSE
  9365                         NEXT SENTENCE
  9366                 ELSE
  9367                     IF  NOT PI-689-ARCHIVE-LETTER
  9368                         MOVE ER-7390
  9369                                 TO PI-689-ERROR
  9370                     ELSE
  9371                         PERFORM 5400-LETTER-RELEASE
  9372                             THRU 5400-EXIT
  9373                         IF  NOT PI-689-FATAL-ERROR
  9374                             IF  PI-689-PRINT-SECOND
  9375                                 PERFORM 7900-PRINT-LETTER-NOW
  9376                                     THRU 7900-EXIT.
  9377
  9378 0600-EXIT.
  9379     EXIT.
  9380
  9381 0620-RETURN-TO-CALLER.
  9382
  9383     MOVE PROGRAM-INTERFACE-BLOCK
  9384                                 TO DFHCOMMAREA.
  9385
  9386* EXEC CICS RETURN
  9387*    END-EXEC.
  9388*    MOVE '.(                    ''   #00009275' TO DFHEIV0
  9389     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9390     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9391     MOVE X'2020233030303039323735' TO DFHEIV0(25:11)
  9392     CALL 'kxdfhei1' USING DFHEIV0,
  9393           DFHEIV99,
  9394           DFHEIV99,
  9395           DFHEIV99,
  9396           DFHEIV99,
  9397           DFHEIV99,
  9398           DFHEIV99
  9399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9400
  9401
  9402 0700-GET-VARIABLE-LABEL.
  9403
  9404     IF  PI-689-VARIABLE-DATA-1 NOT GREATER THAN SPACES
  9405         MOVE '(VARIABLE NOT PROVIDED)'
  9406                                 TO W-RC-TEXT (1)
  9407                                    W-VG-TEXT (48)
  9408         GO TO 0700-EXIT.
  9409
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 181
* EL689.cbl
  9410     MOVE PI-689-VARIABLE-DATA-1 TO W-RC-TEXT (1)
  9411                                    W-VG-TEXT (48).
  9412     MOVE PI-689-VARIABLE-DATA-2 TO W-RC-TEXT (2)
  9413                                    W-VG-TEXT (49).
  9414     MOVE PI-689-VARIABLE-DATA-3 TO W-RC-TEXT (3)
  9415                                    W-VG-TEXT (50).
  9416     MOVE PI-689-VARIABLE-DATA-4 TO W-RC-TEXT (4)
  9417                                    W-VG-TEXT (51).
  9418     SET W-RG-NDX                TO +5.
  9419
  9420 0700-EXIT.
  9421     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 182
* EL689.cbl
  9423 0800-EDIT-KEY-FIELDS.
  9424***************************************************************
  9425*     THIS ROUTINE WILL DECIDE WHAT FIELDS ARE NECESSARY      *
  9426*     FROM THE DATA SOURCE FIELD.  IF A NECESSARY FIELD       *
  9427*     IS NOT PROVIDED AN ERROR WILL PREVENT FURTHER           *
  9428*     PROCESSING.                                             *
  9429***************************************************************
  9430     MOVE SPACES                 TO W-CNTL-KEY
  9431     MOVE LOW-VALUES             TO W-ACCT-KEY
  9432                                    W-CERT-KEY
  9433                                    W-CHEK-KEY
  9434                                    W-COMP-KEY
  9435                                    W-MAIL-KEY
  9436                                    W-PNDB-KEY
  9437                                    W-PNDB2-KEY
  9438                                    W-PYAJ-KEY.
  9439
  9440     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9441     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9442                                    W-CERT-COMPANY-CD
  9443                                    W-CHEK-COMPANY-CD
  9444                                    W-COMP-COMPANY-CD
  9445                                    W-MAIL-COMPANY-CD
  9446                                    W-PNDB-COMPANY-CD
  9447                                    W-PNDB2-COMPANY-CD
  9448                                    W-PYAJ-COMPANY-CD.
  9449
  9450     PERFORM 0900-EDIT-CARRIER THRU 0900-EXIT.
  9451     PERFORM 0905-EDIT-GROUPING THRU 0905-EXIT.
  9452     PERFORM 0910-EDIT-STATE THRU 0910-EXIT.
  9453     PERFORM 0915-EDIT-ACCOUNT THRU 0915-EXIT.
  9454     PERFORM 0920-EDIT-EXP-DATE THRU 0920-EXIT.
  9455     PERFORM 0925-EDIT-EFF-DATE THRU 0925-EXIT.
  9456     PERFORM 0930-EDIT-CERTIFICATE THRU 0930-EXIT.
  9457     PERFORM 0935-EDIT-RESP-PERSON THRU 0935-EXIT.
  9458     PERFORM 0940-EDIT-ACCOUNT THRU 0940-EXIT.
  9459     PERFORM 0945-EDIT-TYPE THRU 0945-EXIT.
  9460     PERFORM 0950-EDIT-ENTRY THRU 0950-EXIT.
  9461     PERFORM 0955-EDIT-SEQUENCE THRU 0955-EXIT.
  9462     PERFORM 0960-EDIT-BATCH-SEQ THRU 0960-EXIT.
  9463     PERFORM 0965-EDIT-TYPE THRU 0965-EXIT.
  9464
  9465     IF  DATASORI NUMERIC
  9466         MOVE DATASORI           TO W-DATA-SOURCE
  9467                                    PI-689-DATA-SOURCE
  9468         GO TO 0800-SOURCE-ACCOUNT
  9469               0800-SOURCE-CERTIFICATE
  9470               0800-SOURCE-COMPENSATION
  9471               0800-SOURCE-PENDING
  9472               0800-SOURCE-CHEK
  9473               0800-SOURCE-PAYMENTS-ADJS
  9474                                 DEPENDING ON W-DATA-SOURCE.
  9475
  9476     IF  FORMI NOT EQUAL '9999'
  9477         MOVE ER-7365            TO EMI-ERROR
  9478         MOVE -1                 TO MAINTL
  9479         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9480         GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 183
* EL689.cbl
  9481
  9482     ELSE
  9483         GO TO 0800-EXIT.
  9484
  9485 0800-SOURCE-ACCOUNT.
  9486
  9487     IF  W-ACCT-COMPANY-CD EQUAL LOW-VALUES
  9488             OR
  9489         W-ACCT-CARRIER EQUAL LOW-VALUES
  9490             OR
  9491         W-ACCT-GROUPING EQUAL LOW-VALUES
  9492             OR
  9493         W-ACCT-STATE EQUAL LOW-VALUES
  9494             OR
  9495         W-ACCT-ACCOUNT EQUAL LOW-VALUES
  9496             OR
  9497         W-ACCT-EXP-DT EQUAL LOW-VALUES
  9498         MOVE ER-7376            TO EMI-ERROR
  9499         MOVE -1                 TO MAINTL
  9500         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9501
  9502     GO TO 0800-ERROR-TEST.
  9503
  9504 0800-SOURCE-CERTIFICATE.
  9505
  9506     IF  W-CERT-COMPANY-CD EQUAL LOW-VALUES
  9507             OR
  9508         W-CERT-CARRIER EQUAL LOW-VALUES
  9509             OR
  9510         W-CERT-GROUPING EQUAL LOW-VALUES
  9511             OR
  9512         W-CERT-STATE EQUAL LOW-VALUES
  9513             OR
  9514         W-CERT-ACCOUNT EQUAL LOW-VALUES
  9515             OR
  9516         W-CERT-EFF-DT EQUAL LOW-VALUES
  9517             OR
  9518         W-CERT-CERT-NO EQUAL LOW-VALUES
  9519         MOVE ER-7377            TO EMI-ERROR
  9520         MOVE -1                 TO MAINTL
  9521         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9522
  9523     GO TO 0800-ERROR-TEST.
  9524
  9525 0800-SOURCE-COMPENSATION.
  9526
  9527     IF  W-COMP-COMPANY-CD EQUAL LOW-VALUES
  9528             OR
  9529         W-COMP-CARRIER EQUAL LOW-VALUES
  9530             OR
  9531         W-COMP-GROUPING EQUAL LOW-VALUES
  9532             OR
  9533         W-COMP-RESP-PERSON EQUAL LOW-VALUES
  9534             OR
  9535         W-COMP-TYPE EQUAL LOW-VALUES
  9536             OR
  9537         (W-COMP-TYPE EQUAL 'A'
  9538                 AND
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 184
* EL689.cbl
  9539             W-COMP-ACCOUNT EQUAL LOW-VALUES)
  9540         MOVE ER-7378            TO EMI-ERROR
  9541         MOVE -1                 TO MAINTL
  9542         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9543
  9544     GO TO 0800-ERROR-TEST.
  9545
  9546 0800-SOURCE-PENDING.
  9547
  9548     IF  BENTRYL EQUAL ZEROS
  9549         IF  W-PNDB2-COMPANY-CD EQUAL LOW-VALUES
  9550                 OR
  9551             W-PNDB2-CARRIER EQUAL LOW-VALUES
  9552                 OR
  9553             W-PNDB2-GROUPING EQUAL LOW-VALUES
  9554                 OR
  9555             W-PNDB2-STATE EQUAL LOW-VALUES
  9556                 OR
  9557             W-PNDB2-ACCOUNT EQUAL LOW-VALUES
  9558                 OR
  9559             W-PNDB2-EFF-DT EQUAL LOW-VALUES
  9560                 OR
  9561             W-PNDB2-CERT-NO EQUAL LOW-VALUES
  9562                 OR
  9563             W-PNDB2-TYPE EQUAL LOW-VALUES
  9564                 OR
  9565             W-PNDB2-ALT-CHG-SEQ-NO NOT = ZEROS
  9566             MOVE ER-7379        TO EMI-ERROR
  9567             MOVE -1             TO MAINTL
  9568             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9569         ELSE
  9570             NEXT SENTENCE
  9571     ELSE
  9572         IF  W-PNDB-COMPANY-CD EQUAL LOW-VALUES
  9573                 OR
  9574             W-PNDB-ENTRY EQUAL LOW-VALUES
  9575                 OR
  9576             W-PNDB-SEQ-NO EQUAL ZEROS
  9577             MOVE ER-7379        TO EMI-ERROR
  9578             MOVE -1             TO MAINTL
  9579             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9580
  9581     GO TO 0800-ERROR-TEST.
  9582
  9583 0800-SOURCE-CHEK.
  9584
  9585     IF  W-CHEK-COMPANY-CD EQUAL LOW-VALUES
  9586             OR
  9587         W-CHEK-CARRIER EQUAL LOW-VALUES
  9588             OR
  9589         W-CHEK-GROUPING EQUAL LOW-VALUES
  9590             OR
  9591         W-CHEK-STATE EQUAL LOW-VALUES
  9592             OR
  9593         W-CHEK-ACCOUNT EQUAL LOW-VALUES
  9594             OR
  9595         W-CHEK-EFF-DT EQUAL LOW-VALUES
  9596             OR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 185
* EL689.cbl
  9597         W-CHEK-CERT-NO EQUAL LOW-VALUES
  9598         MOVE ER-7381            TO EMI-ERROR
  9599         MOVE -1                 TO MAINTL
  9600         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9601
  9602     GO TO 0800-ERROR-TEST.
  9603
  9604 0800-SOURCE-PAYMENTS-ADJS.
  9605
  9606     IF  W-PYAJ-COMPANY-CD EQUAL LOW-VALUES
  9607             OR
  9608         W-PYAJ-CARRIER EQUAL LOW-VALUES
  9609             OR
  9610         W-PYAJ-GROUPING EQUAL LOW-VALUES
  9611             OR
  9612         W-PYAJ-FIN-RESP EQUAL LOW-VALUES
  9613             OR
  9614         W-PYAJ-ACCOUNT EQUAL LOW-VALUES
  9615             OR
  9616         W-PYAJ-RECORD-TYPE EQUAL LOW-VALUES
  9617         MOVE ER-7396            TO EMI-ERROR
  9618         MOVE -1                 TO MAINTL
  9619         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9620
  9621     GO TO 0800-ERROR-TEST.
  9622
  9623 0800-ERROR-TEST.
  9624
  9625     IF  NOT EMI-NO-ERRORS
  9626         IF  EMI-ERROR EQUAL ER-7250
  9627             GO TO 0800-EXIT
  9628         ELSE
  9629             GO TO 8200-SEND-DATAONLY.
  9630
  9631 0800-EXIT.
  9632     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 186
* EL689.cbl
  9634 0900-EDIT-CARRIER.
  9635
  9636     IF  CARRIERL EQUAL ZEROES
  9637         MOVE LOW-VALUES         TO PI-689-CARRIER
  9638                                    W-ACCT-CARRIER
  9639                                    W-CERT-CARRIER
  9640                                    W-COMP-CARRIER
  9641                                    W-CHEK-CARRIER
  9642                                    W-MAIL-CARRIER
  9643                                    W-PNDB2-CARRIER
  9644                                    W-PYAJ-CARRIER
  9645     ELSE
  9646         PERFORM 0990-CARRIER-VALIDITY-CHECK THRU 0990-EXIT.
  9647
  9648 0900-EXIT.
  9649     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 187
* EL689.cbl
  9651 0905-EDIT-GROUPING.
  9652
  9653     IF  GROUPL EQUAL ZEROES
  9654         MOVE LOW-VALUES         TO PI-689-GROUPING
  9655                                    W-ACCT-GROUPING
  9656                                    W-CERT-GROUPING
  9657                                    W-CHEK-GROUPING
  9658                                    W-COMP-GROUPING
  9659                                    W-MAIL-GROUPING
  9660                                    W-PNDB2-GROUPING
  9661                                    W-PYAJ-GROUPING
  9662     ELSE
  9663         MOVE AL-UANON           TO GROUPA
  9664         MOVE GROUPI             TO PI-689-GROUPING
  9665                                    W-ACCT-GROUPING
  9666                                    W-CERT-GROUPING
  9667                                    W-CHEK-GROUPING
  9668                                    W-COMP-GROUPING
  9669                                    W-MAIL-GROUPING
  9670                                    W-PNDB2-GROUPING
  9671                                    W-PYAJ-GROUPING.
  9672
  9673 0905-EXIT.
  9674     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 188
* EL689.cbl
  9676 0910-EDIT-STATE.
  9677
  9678     IF  STATEL EQUAL ZEROES
  9679         MOVE LOW-VALUES         TO PI-689-STATE
  9680                                    W-ACCT-STATE
  9681                                    W-CERT-STATE
  9682                                    W-CHEK-STATE
  9683                                    W-MAIL-STATE
  9684                                    W-PNDB2-STATE
  9685     ELSE
  9686         PERFORM 0994-STATE-VALIDITY-CHECK THRU 0994-EXIT.
  9687
  9688 0910-EXIT.
  9689     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 189
* EL689.cbl
  9691 0915-EDIT-ACCOUNT.
  9692
  9693     IF  ACCTL EQUAL ZEROES
  9694         MOVE LOW-VALUES         TO PI-689-ACCOUNT
  9695                                    W-ACCT-ACCOUNT
  9696                                    W-CERT-ACCOUNT
  9697                                    W-CHEK-ACCOUNT
  9698                                    W-COMP-ACCOUNT
  9699                                    W-MAIL-ACCOUNT
  9700                                    W-PNDB2-ACCOUNT
  9701                                    W-PYAJ-ACCOUNT
  9702     ELSE
  9703         MOVE AL-UANON           TO ACCTA
  9704         MOVE ACCTI              TO PI-689-ACCOUNT
  9705                                    W-ACCT-ACCOUNT
  9706                                    W-CERT-ACCOUNT
  9707                                    W-CHEK-ACCOUNT
  9708                                    W-COMP-ACCOUNT
  9709                                    W-MAIL-ACCOUNT
  9710                                    W-PYAJ-ACCOUNT
  9711                                    W-PNDB2-ACCOUNT.
  9712
  9713 0915-EXIT.
  9714     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 190
* EL689.cbl
  9716 0920-EDIT-EXP-DATE.
  9717
  9718     IF  DATEL NOT EQUAL ZEROS
  9719         IF  DATEI EQUAL '99/99/99' OR '999999'
  9720             MOVE '99/99/99'     TO DATEO
  9721                                    PI-689-DATE-EDIT
  9722             MOVE AL-UANON       TO DATEA
  9723             MOVE HIGH-VALUES    TO PI-689-EXP-DATE
  9724                                    W-ACCT-EXP-DT
  9725         ELSE
  9726             MOVE DATEI          TO W-DEEDIT-FIELD
  9727             PERFORM 8600-DEEDIT
  9728             MOVE W-DEEDIT-FIELD-V0
  9729                                 TO DC-GREG-DATE-1-MDY
  9730             MOVE '4'            TO DC-OPTION-CODE
  9731             PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9732             IF  DATE-CONVERSION-ERROR
  9733                 MOVE ER-0454    TO EMI-ERROR
  9734                 MOVE -1         TO DATEL
  9735                 MOVE AL-UABON   TO DATEA
  9736                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9737             ELSE
  9738                 MOVE DC-GREG-DATE-1-EDIT
  9739                                 TO DATEO
  9740                                    PI-689-DATE-EDIT
  9741                 MOVE AL-UANON   TO DATEA
  9742                 MOVE DC-BIN-DATE-1
  9743                                 TO PI-689-EXP-DATE
  9744                                    W-ACCT-EXP-DT
  9745     ELSE
  9746         MOVE LOW-VALUES         TO PI-689-EXP-DATE
  9747                                    W-ACCT-EXP-DT
  9748                                    PI-689-DATE-EDIT.
  9749
  9750 0920-EXIT.
  9751     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 191
* EL689.cbl
  9753 0925-EDIT-EFF-DATE.
  9754
  9755     IF  CERTL EQUAL ZERO
  9756             AND
  9757         DATASORI NOT EQUAL '2'
  9758         GO TO 0925-EXIT.
  9759
  9760     IF  DATEL NOT EQUAL ZEROS
  9761         MOVE DATEI              TO W-DEEDIT-FIELD
  9762         PERFORM 8600-DEEDIT
  9763         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9764         MOVE '4'                TO DC-OPTION-CODE
  9765         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9766
  9767         IF  DATE-CONVERSION-ERROR
  9768             MOVE ER-0215        TO EMI-ERROR
  9769             MOVE -1             TO DATEL
  9770             MOVE AL-UABON       TO DATEA
  9771             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9772         ELSE
  9773             MOVE DC-GREG-DATE-1-EDIT
  9774                                 TO DATEO
  9775                                    PI-689-DATE-EDIT
  9776             MOVE AL-UANON       TO DATEA
  9777             MOVE DC-BIN-DATE-1  TO PI-689-EFF-DATE
  9778                                    W-CERT-EFF-DT
  9779                                    W-CHEK-EFF-DT
  9780                                    W-MAIL-EFF-DT
  9781                                    W-PNDB2-EFF-DT
  9782     ELSE
  9783         MOVE LOW-VALUES         TO PI-689-EFF-DATE
  9784                                    W-PNDB2-EFF-DT
  9785                                    W-CHEK-EFF-DT
  9786                                    W-MAIL-EFF-DT
  9787                                    W-CERT-EFF-DT
  9788                                    PI-689-DATE-EDIT.
  9789
  9790 0925-EXIT.
  9791     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 192
* EL689.cbl
  9793 0930-EDIT-CERTIFICATE.
  9794
  9795     IF  CERTL EQUAL ZEROES
  9796         MOVE LOW-VALUES         TO PI-689-CERT-PRIME
  9797                                    W-CERT-CERT-PRIME
  9798                                    W-CHEK-CERT-PRIME
  9799                                    W-MAIL-CERT-PRIME
  9800                                    W-PNDB2-CERT-PRIME
  9801                                    PI-689-CERT-SFX
  9802                                    W-CERT-CERT-SFX
  9803                                    W-CHEK-CERT-SFX
  9804                                    W-MAIL-CERT-SFX
  9805                                    W-PNDB2-CERT-SFX
  9806     ELSE
  9807         MOVE AL-UANON           TO CERTA
  9808         MOVE CERTI              TO PI-689-CERT-PRIME
  9809                                    W-CERT-CERT-PRIME
  9810                                    W-CHEK-CERT-PRIME
  9811                                    W-MAIL-CERT-PRIME
  9812                                    W-PNDB2-CERT-PRIME
  9813         IF  SFXL EQUAL ZEROES
  9814                 OR
  9815             SFXI EQUAL LOW-VALUES
  9816             MOVE SPACES         TO PI-689-CERT-SFX
  9817                                    W-CERT-CERT-SFX
  9818                                    W-CHEK-CERT-SFX
  9819                                    W-MAIL-CERT-SFX
  9820                                    W-PNDB2-CERT-SFX
  9821         ELSE
  9822             MOVE AL-UANON       TO SFXA
  9823             MOVE SFXI           TO PI-689-CERT-SFX
  9824                                    W-CERT-CERT-SFX
  9825                                    W-CHEK-CERT-SFX
  9826                                    W-MAIL-CERT-SFX
  9827                                    W-PNDB2-CERT-SFX.
  9828
  9829 0930-EXIT.
  9830     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 193
* EL689.cbl
  9832 0935-EDIT-RESP-PERSON.
  9833
  9834     IF  RPERSONL EQUAL ZEROES
  9835         MOVE LOW-VALUES         TO PI-689-RESP-PERSON
  9836                                    W-COMP-RESP-PERSON
  9837                                    W-PYAJ-FIN-RESP
  9838     ELSE
  9839         MOVE AL-UANON           TO RPERSONA
  9840         MOVE RPERSONI           TO PI-689-RESP-PERSON
  9841                                    W-PYAJ-FIN-RESP
  9842                                    W-COMP-RESP-PERSON.
  9843
  9844 0935-EXIT.
  9845     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 194
* EL689.cbl
  9847 0940-EDIT-ACCOUNT.
  9848
  9849     IF  ACCTL EQUAL ZEROES
  9850         MOVE LOW-VALUES         TO PI-689-ACCOUNT
  9851                                    W-COMP-ACCOUNT
  9852                                    W-PYAJ-ACCOUNT
  9853     ELSE
  9854         MOVE AL-UANON           TO ACCTA
  9855         MOVE ACCTI              TO PI-689-ACCOUNT
  9856                                    W-PYAJ-ACCOUNT
  9857                                    W-COMP-ACCOUNT.
  9858
  9859 0940-EXIT.
  9860     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 195
* EL689.cbl
  9862 0945-EDIT-TYPE.
  9863
  9864     IF  TYPEL EQUAL ZEROES
  9865         MOVE LOW-VALUES         TO PI-689-TYPE
  9866                                    W-COMP-TYPE
  9867                                    W-PYAJ-RECORD-TYPE
  9868     ELSE
  9869         INSPECT TYPEI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9870         IF TYPEI = 'C' OR 'G' OR 'A'
  9871             MOVE AL-UANON       TO TYPEA
  9872             MOVE TYPEI          TO PI-689-TYPE
  9873                                    W-COMP-TYPE
  9874                                    W-PYAJ-RECORD-TYPE
  9875         ELSE
  9876             MOVE ER-7368        TO EMI-ERROR
  9877             MOVE -1             TO TYPEL
  9878             MOVE AL-UABON       TO TYPEA
  9879             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9880
  9881 0945-EXIT.
  9882     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 196
* EL689.cbl
  9884 0950-EDIT-ENTRY.
  9885
  9886     IF  BENTRYL EQUAL ZEROES
  9887         MOVE LOW-VALUES         TO PI-689-ENTRY-BATCH
  9888                                    W-PNDB-ENTRY
  9889     ELSE
  9890         MOVE AL-UANON           TO BENTRYA
  9891         MOVE BENTRYI            TO PI-689-ENTRY-BATCH
  9892                                    W-PNDB-ENTRY.
  9893
  9894 0950-EXIT.
  9895     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 197
* EL689.cbl
  9897 0955-EDIT-SEQUENCE.
  9898
  9899     IF  SEQL NOT EQUAL ZEROS
  9900         IF  SEQI NOT NUMERIC
  9901                 OR
  9902             SEQI EQUAL '0'
  9903             MOVE ER-7367        TO EMI-ERROR
  9904             MOVE -1             TO SEQL
  9905             MOVE AL-UABON       TO SEQA
  9906             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9907         ELSE
  9908             MOVE AL-UANON       TO SEQA
  9909             MOVE SEQI           TO PI-689-SEQ-NO
  9910                                    W-CHEK-SEQ-NO
  9911                                    W-PYAJ-FILE-SEQ-NO
  9912                                    W-PNDB-SEQ-NO
  9913                                    PI-689-SEQ-EDIT
  9914     ELSE
  9915         MOVE LOW-VALUES         TO PI-689-SEQ-EDIT.
  9916
  9917 0955-EXIT.
  9918     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 198
* EL689.cbl
  9920 0960-EDIT-BATCH-SEQ.
  9921
  9922     IF  BCSEQL NOT EQUAL ZEROS
  9923         IF  BCSEQI NOT NUMERIC
  9924             MOVE ER-7368        TO EMI-ERROR
  9925             MOVE -1             TO BCSEQL
  9926             MOVE AL-UABON       TO BCSEQA
  9927             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9928         ELSE
  9929             MOVE AL-UANON       TO BCSEQA
  9930             MOVE BCSEQI         TO PI-689-CHG-SEQ-NO
  9931                                    W-PNDB-CHG-SEQ-NO
  9932                                    W-PNDB2-ALT-CHG-SEQ-NO
  9933                                    PI-689-BCSEQ-EDIT
  9934     ELSE
  9935         MOVE LOW-VALUES         TO PI-689-BCSEQ-EDIT.
  9936
  9937 0960-EXIT.
  9938     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 199
* EL689.cbl
  9940 0965-EDIT-TYPE.
  9941
  9942     IF  TYPEL EQUAL ZEROES
  9943         MOVE LOW-VALUES         TO PI-689-TYPE
  9944                                    W-PNDB2-TYPE
  9945     ELSE
  9946         IF  DATASORI NOT EQUAL '4'
  9947             GO TO 0965-EXIT
  9948         ELSE
  9949             IF TYPEI = '0' OR '1' OR '2' OR '3'
  9950                 MOVE AL-UANON   TO TYPEA
  9951                 MOVE TYPEI      TO PI-689-TYPE
  9952                                    W-PNDB2-TYPE
  9953             ELSE
  9954                 MOVE ER-7370    TO EMI-ERROR
  9955                 MOVE -1         TO TYPEL
  9956                 MOVE AL-UABON   TO TYPEA
  9957                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9958
  9959 0965-EXIT.
  9960     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 200
* EL689.cbl
  9962 0990-CARRIER-VALIDITY-CHECK.
  9963
  9964     IF  CARRIERI EQUAL SPACES
  9965         GO TO 0990-EXIT.
  9966
  9967     MOVE SPACES                 TO W-CNTL-KEY.
  9968     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9969     MOVE '6'                    TO W-CNTL-RECORD-TYPE.
  9970     MOVE CARRIERI               TO W-CNTL-GEN4.
  9971     MOVE +0                     TO W-CNTL-SEQ-NO.
  9972
  9973
  9974* EXEC CICS HANDLE CONDITION
  9975*        NOTFND  (0990-CARRIER-NOT-FOUND)
  9976*        NOTOPEN (8040-CNTL-NOT-OPEN)
  9977*    END-EXEC.
  9978*    MOVE '"$IJ                  ! & #00009849' TO DFHEIV0
  9979     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9980     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9981     MOVE X'2620233030303039383439' TO DFHEIV0(25:11)
  9982     CALL 'kxdfhei1' USING DFHEIV0
  9983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9984
  9985
  9986
  9987* EXEC CICS READ
  9988*        DATASET (W-CNTL-FILE-ID)
  9989*        SET     (ADDRESS OF CONTROL-FILE)
  9990*        RIDFLD  (W-CNTL-KEY)
  9991*    END-EXEC.
  9992*    MOVE '&"S        E          (   #00009854' TO DFHEIV0
  9993     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9994     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9995     MOVE X'2020233030303039383534' TO DFHEIV0(25:11)
  9996     CALL 'kxdfhei1' USING DFHEIV0,
  9997           W-CNTL-FILE-ID,
  9998           DFHEIV20,
  9999           DFHEIV99,
 10000           W-CNTL-KEY,
 10001           DFHEIV99,
 10002           DFHEIV99,
 10003           DFHEIV99
 10004     SET ADDRESS OF CONTROL-FILE TO
 10005         DFHEIV20
 10006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10007
 10008
 10009     IF  PI-NO-CARRIER-SECURITY
 10010             OR
 10011         PI-CARRIER-SECURITY EQUAL CARRIERI
 10012         MOVE AL-UANON           TO CARRIERA
 10013         MOVE CARRIERI           TO PI-689-CARRIER
 10014                                    W-ACCT-CARRIER
 10015                                    W-CERT-CARRIER
 10016                                    W-CHEK-CARRIER
 10017                                    W-COMP-CARRIER
 10018                                    W-MAIL-CARRIER
 10019                                    W-PNDB2-CARRIER
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 201
* EL689.cbl
 10020                                    W-PYAJ-CARRIER
 10021     ELSE
 10022         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
 10023         MOVE ER-9095            TO EMI-ERROR
 10024         MOVE -1                 TO MAINTL
 10025         MOVE AL-UANON           TO MAINTA
 10026         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10027
 10028     GO TO 0990-EXIT.
 10029
 10030 0990-CARRIER-NOT-FOUND.
 10031
 10032     MOVE -1                     TO CARRIERL.
 10033     MOVE AL-UABON               TO CARRIERA.
 10034     MOVE ER-2208                TO EMI-ERROR.
 10035     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10036
 10037 0990-EXIT.
 10038     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 202
* EL689.cbl
 10040 0994-STATE-VALIDITY-CHECK.
 10041
 10042     IF  STATEI EQUAL SPACES
 10043         GO TO 0994-EXIT.
 10044
 10045     MOVE SPACES                 TO W-CNTL-KEY.
 10046     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10047     MOVE '3'                    TO W-CNTL-RECORD-TYPE.
 10048     MOVE STATEI                 TO W-CNTL-GEN1.
 10049     MOVE +0                     TO W-CNTL-SEQ-NO.
 10050
 10051
 10052* EXEC CICS HANDLE CONDITION
 10053*        NOTFND  (0994-STATE-NOT-FOUND)
 10054*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10055*    END-EXEC.
 10056*    MOVE '"$IJ                  ! '' #00009902' TO DFHEIV0
 10057     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10058     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10059     MOVE X'2720233030303039393032' TO DFHEIV0(25:11)
 10060     CALL 'kxdfhei1' USING DFHEIV0
 10061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10062
 10063
 10064
 10065* EXEC CICS READ
 10066*        DATASET (W-CNTL-FILE-ID)
 10067*        SET     (ADDRESS OF CONTROL-FILE)
 10068*        RIDFLD  (W-CNTL-KEY)
 10069*    END-EXEC.
 10070*    MOVE '&"S        E          (   #00009907' TO DFHEIV0
 10071     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10072     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10073     MOVE X'2020233030303039393037' TO DFHEIV0(25:11)
 10074     CALL 'kxdfhei1' USING DFHEIV0,
 10075           W-CNTL-FILE-ID,
 10076           DFHEIV20,
 10077           DFHEIV99,
 10078           W-CNTL-KEY,
 10079           DFHEIV99,
 10080           DFHEIV99,
 10081           DFHEIV99
 10082     SET ADDRESS OF CONTROL-FILE TO
 10083         DFHEIV20
 10084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10085
 10086
 10087     MOVE AL-UANON               TO STATEA.
 10088     MOVE STATEI                 TO PI-689-STATE
 10089                                    W-ACCT-STATE
 10090                                    W-CERT-STATE
 10091                                    W-CHEK-STATE
 10092                                    W-MAIL-STATE
 10093                                    W-PNDB2-STATE.
 10094
 10095     GO TO 0994-EXIT.
 10096
 10097 0994-STATE-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 203
* EL689.cbl
 10098
 10099     MOVE -1                     TO STATEL.
 10100     MOVE AL-UABON               TO STATEA.
 10101     MOVE ER-2209                TO EMI-ERROR.
 10102     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10103
 10104 0994-EXIT.
 10105     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 204
* EL689.cbl
 10107 1000-SHOW.
 10108***************************************************************
 10109*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
 10110*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN.  IF THE       *
 10111*     HEADER RECORD IS FOUND THE TEXT IS THEN READ AND        *
 10112*     WILL BE INSERTED INTO THE W-TS-TABLE AND DISPLAYED.     *
 10113***************************************************************
 10114
 10115     MOVE SPACES                 TO W-RECORD-TABLE.
 10116
 10117     IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 10118          MOVE PI-689-LBL-OVERRIDE
 10119                                 TO ADDRLBLI
 10120          MOVE +1                TO ADDRLBLL
 10121          MOVE AL-UANON          TO ADDRLBLA
 10122     ELSE
 10123          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 10124          MOVE +1                TO ADDRLBLL
 10125          MOVE AL-UANON          TO ADDRLBLA.
 10126
 10127     IF  ARCHNUML EQUAL ZEROS
 10128         MOVE -1                 TO ARCHNUML
 10129         MOVE AL-UNBON           TO ARCHNUMA
 10130         MOVE ER-0174            TO EMI-ERROR
 10131         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10132         GO TO 8200-SEND-DATAONLY.
 10133
 10134     IF  ARCHNUMI NOT NUMERIC
 10135         MOVE -1                 TO ARCHNUML
 10136         MOVE AL-UNBON           TO ARCHNUMA
 10137         MOVE ER-0175            TO EMI-ERROR
 10138         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10139         GO TO 8200-SEND-DATAONLY.
 10140
 10141     IF  PI-SHOW-MODE
 10142
 10143         IF  PI-689-ARCHIVE-NUMBER EQUAL ARCHNUMI
 10144             MOVE -1             TO MAINTL
 10145             GO TO 8200-SEND-DATAONLY
 10146         ELSE
 10147             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT.
 10148
 10149     MOVE +0                     TO W-ARCH-SEQ-NO
 10150                                    W-ARCT-SEQ-NO.
 10151     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD
 10152                                    W-ARCT-COMPANY-CD.
 10153     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 10154                                    W-ARCT-NUMBER
 10155                                    PI-689-ARCHIVE-NUMBER.
 10156     MOVE ' '                    TO W-ARCT-REC-TYPE.
 10157     MOVE '1'                    TO PI-ACTION.
 10158     MOVE SPACES                 TO PI-689-PRINT-SW
 10159                                    PI-689-FORM-NUMBER
 10160                                    W-DELETE-KEY.
 10161     SET W-RG-NDX                TO W-ZEROS.
 10162
 10163
 10164* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 205
* EL689.cbl
 10165*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 10166*         NOTFND     (1070-ARCH-NOT-FOUND)
 10167*         ENDFILE    (1070-ARCH-NOT-FOUND)
 10168*    END-EXEC.
 10169*    MOVE '"$JI''                 ! ( #00009989' TO DFHEIV0
 10170     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 10171     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10172     MOVE X'2820233030303039393839' TO DFHEIV0(25:11)
 10173     CALL 'kxdfhei1' USING DFHEIV0
 10174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10175
 10176
 10177
 10178* EXEC CICS READ
 10179*        DATASET (W-ARCH-FILE-ID)
 10180*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10181*        RIDFLD  (W-ARCH-KEY)
 10182*    END-EXEC.
 10183*    MOVE '&"S        E          (   #00009995' TO DFHEIV0
 10184     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10185     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10186     MOVE X'2020233030303039393935' TO DFHEIV0(25:11)
 10187     CALL 'kxdfhei1' USING DFHEIV0,
 10188           W-ARCH-FILE-ID,
 10189           DFHEIV20,
 10190           DFHEIV99,
 10191           W-ARCH-KEY,
 10192           DFHEIV99,
 10193           DFHEIV99,
 10194           DFHEIV99
 10195     SET ADDRESS OF LETTER-ARCHIVE TO
 10196         DFHEIV20
 10197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10198
 10199
 10200     PERFORM 1040-FORMAT-HEADER-DATA THRU 1040-EXIT.
 10201
 10202*    EXEC CICS HANDLE CONDITION
 10203*         NOTOPEN    (8015-ARCT-NOT-OPEN)
 10204*         NOTFND     (1020-ARCT-ENDBR)
 10205*         ENDFILE    (1020-ARCT-ENDBR)
 10206*    END-EXEC.
 10207*
 10208*1005-START-BROWSE.
 10209*
 10210*    EXEC CICS STARTBR
 10211*         DATASET    (W-ARCT-FILE-ID)
 10212*         RIDFLD     (W-ARCT-KEY)
 10213*         GTEQ
 10214*    END-EXEC.
 10215*
 10216*    MOVE 'Y'                    TO W-ARCT-BROWSE-STARTED.
 10217*
 10218*1010-READ-NEXT.
 10219*
 10220*    EXEC CICS READNEXT
 10221*         SET       (ADDRESS OF LETTER-ARCHIVE-TEXT)
 10222*         DATASET   (W-ARCT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 206
* EL689.cbl
 10223*         RIDFLD    (W-ARCT-KEY)
 10224*    END-EXEC.
 10225*
 10226*    IF  W-ARCH-PARTIAL-KEY EQUAL W-ARCT-PARTIAL-KEY
 10227*        IF  LT-ADDRESS-DATA
 10228*            IF  PI-CREATE-LABELS  AND
 10229*                NOT PI-689-LABELS-OVERRIDEN
 10230*                PERFORM 1050-MOVE-LABELS THRU 1050-EXIT
 10231*                        VARYING
 10232*                    LT-NDX FROM 1 BY 1
 10233*                        UNTIL
 10234*                    LT-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 10235*                GO TO 1010-READ-NEXT
 10236*            ELSE
 10237*                MOVE LT-CONTROL-PRIMARY
 10238*                                TO W-DELETE-KEY
 10239*                GO TO 1010-READ-NEXT
 10240*        ELSE
 10241*            PERFORM 1030-TEXT-BUILD THRU 1030-EXIT
 10242*                    VARYING
 10243*                LT-NDX FROM 1 BY 1
 10244*                    UNTIL
 10245*                LT-NDX GREATER THAN LT-NUM-LINES-ON-RECORD
 10246*                    OR
 10247*                LT-NDX GREATER THAN +20
 10248*            GO TO 1010-READ-NEXT.
 10249*
 10250*1020-ARCT-ENDBR.
 10251*
 10252*    IF  W-ARCT-BROWSE-STARTED EQUAL 'Y'
 10253*        EXEC CICS ENDBR
 10254*             DATASET   (W-ARCT-FILE-ID)
 10255*        END-EXEC.
 10256*
 10257*    IF  W-RG-NDX EQUAL ZEROS
 10258*        GO TO 1080-ARCHIVE-TEXT-NOT-FOUND.
 10259*
 10260*    IF  PI-689-NUMBER-LABEL-LINES GREATER THAN +0
 10261*            AND
 10262*        PI-BYPASS-LABELS
 10263*        MOVE W-DELETE-KEY       TO W-ARCT-KEY
 10264*        PERFORM 1060-DELETE-ADDRESS-RECORD THRU 1060-EXIT
 10265*        MOVE +0                 TO PI-689-NUMBER-LABEL-LINES.
 10266*
 10267*    SET PI-TOTAL-LINES          TO W-RG-NDX.
 10268*    MOVE 1                      TO PI-CURRENT-LINE.
 10269*    SET W-RG-NDX                TO +1.
 10270*
 10271*    PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10272*            VARYING
 10273*        W-SC-NDX FROM 1 BY 1
 10274*            UNTIL
 10275*        W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10276
 10277     MOVE -1                     TO MAINTL.
 10278     GO TO 8100-SEND-INITIAL-MAP.
 10279
 10280 1020-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 207
* EL689.cbl
 10281     EXIT.
 10282
 10283 1030-TEXT-BUILD.
 10284
 10285     SET W-RG-NDX UP BY 1.
 10286     MOVE LT-SKIP-CONTROL (LT-NDX)
 10287                                 TO W-PRINT-CONTROL.
 10288
 10289     IF  W-PRINT-CONTROL EQUAL 99
 10290         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 10291         SET W-RG-NDX UP BY 1
 10292     ELSE
 10293         SET W-RG-NDX UP BY W-PRINT-CONTROL.
 10294
 10295     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10296     MOVE LT-SKIP-CONTROL (LT-NDX)
 10297                                 TO W-RC-PC (W-RG-NDX).
 10298     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10299
 10300 1030-EXIT.
 10301     EXIT.
 10302
 10303 1040-FORMAT-HEADER-DATA.
 10304
 10305     MOVE LA-ACCOUNT-A2          TO ACCTO.
 10306     MOVE LA-ADDR-SOURCE         TO ADDRSO.
 10307     MOVE LA-CARRIER-A2          TO CARRIERO.
 10308     MOVE LA-CERT-NO-A2          TO CERTO.
 10309     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
 10310     MOVE LA-DATA-SOURCE         TO DATASORO.
 10311
 10312     IF  LA-EFFECT-DATE-A2 EQUAL LOW-VALUES
 10313         MOVE ZEROES             TO DATEO
 10314
 10315     ELSE
 10316         MOVE LA-EFFECT-DATE-A2  TO DC-BIN-DATE-1
 10317         MOVE ' '                TO DC-OPTION-CODE
 10318         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10319         MOVE DC-GREG-DATE-1-EDIT
 10320                                 TO DATEO.
 10321
 10322     IF  LA-FOLLOW-UP-DATE EQUAL LOW-VALUES
 10323         MOVE ZEROES             TO FOLLOWO
 10324     ELSE
 10325         MOVE LA-FOLLOW-UP-DATE  TO DC-BIN-DATE-1
 10326         MOVE ' '                TO DC-OPTION-CODE
 10327         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10328         MOVE DC-GREG-DATE-1-EDIT
 10329                                 TO FOLLOWO.
 10330
 10331     MOVE LA-FORM-A3             TO FORMO.
 10332     MOVE LA-GROUPING-A2         TO GROUPO.
 10333     MOVE LA-NO-OF-COPIES        TO COPIESO
 10334                                    PI-689-NUMBER-COPIES.
 10335
 10336*    IF LA-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
 10337*        MOVE LA-PRINT-RESTRICTION
 10338*                                TO PRTRESTO
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 208
* EL689.cbl
 10339*    ELSE
 10340*        MOVE SPACES             TO PRTRESTO.
 10341
 10342     IF  LA-RESEND-DATE = LOW-VALUES
 10343         MOVE ZEROES             TO RESEND1O
 10344     ELSE
 10345         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
 10346         MOVE ' '                TO DC-OPTION-CODE
 10347         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10348         MOVE DC-GREG-DATE-1-EDIT
 10349                                 TO RESEND1O.
 10350
 10351     MOVE LA-STATE-A2            TO STATEO.
 10352
 10353     MOVE LA-NUMBER-LABEL-LINES  TO PI-689-NUMBER-LABEL-LINES.
 10354
 10355 1040-EXIT.
 10356     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 209
* EL689.cbl
 10358 1050-MOVE-LABELS.
 10359
 10360     SET W-RG-NDX                TO LT-NDX.
 10361     MOVE ZEROS                  TO W-RC-PC (W-RG-NDX).
 10362     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10363     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10364
 10365 1050-EXIT.
 10366     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 210
* EL689.cbl
 10368 1060-DELETE-ADDRESS-RECORD.
 10369
 10370
 10371* EXEC CICS DELETE
 10372*        DATASET (W-ARCT-FILE-ID)
 10373*        RIDFLD  (W-DELETE-KEY)
 10374*    END-EXEC.
 10375*    MOVE '&(  R                 &   #00010171' TO DFHEIV0
 10376     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 10377     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10378     MOVE X'2020233030303130313731' TO DFHEIV0(25:11)
 10379     CALL 'kxdfhei1' USING DFHEIV0,
 10380           W-ARCT-FILE-ID,
 10381           W-DELETE-KEY,
 10382           DFHEIV99,
 10383           DFHEIV99,
 10384           DFHEIV99
 10385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10386
 10387
 10388
 10389* EXEC CICS READ
 10390*        DATASET (W-ARCH-FILE-ID)
 10391*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10392*        RIDFLD  (W-ARCH-KEY)
 10393*        UPDATE
 10394*    END-EXEC.
 10395*    MOVE '&"S        EU         (   #00010176' TO DFHEIV0
 10396     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10397     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10398     MOVE X'2020233030303130313736' TO DFHEIV0(25:11)
 10399     CALL 'kxdfhei1' USING DFHEIV0,
 10400           W-ARCH-FILE-ID,
 10401           DFHEIV20,
 10402           DFHEIV99,
 10403           W-ARCH-KEY,
 10404           DFHEIV99,
 10405           DFHEIV99,
 10406           DFHEIV99
 10407     SET ADDRESS OF LETTER-ARCHIVE TO
 10408         DFHEIV20
 10409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10410
 10411
 10412     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES.
 10413
 10414
 10415* EXEC CICS REWRITE
 10416*         FROM      (LETTER-ARCHIVE)
 10417*         DATASET   (W-ARCH-FILE-ID)
 10418*    END-EXEC.
 10419     MOVE LENGTH OF
 10420      LETTER-ARCHIVE
 10421       TO DFHEIV11
 10422*    MOVE '&& L                  %   #00010185' TO DFHEIV0
 10423     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10424     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10425     MOVE X'2020233030303130313835' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 211
* EL689.cbl
 10426     CALL 'kxdfhei1' USING DFHEIV0,
 10427           W-ARCH-FILE-ID,
 10428           LETTER-ARCHIVE,
 10429           DFHEIV11,
 10430           DFHEIV99
 10431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10432
 10433
 10434 1060-EXIT.
 10435     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 212
* EL689.cbl
 10437 1070-ARCH-NOT-FOUND.
 10438
 10439     MOVE ER-7371                TO EMI-ERROR.
 10440     MOVE -1                     TO ARCHNUML.
 10441     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10442     GO TO 8100-SEND-INITIAL-MAP.
 10443
 10444 1080-ARCHIVE-TEXT-NOT-FOUND.
 10445
 10446     MOVE ER-7372                TO EMI-ERROR.
 10447     MOVE -1                     TO ARCHNUML.
 10448     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10449     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 213
* EL689.cbl
 10451 2000-CREATE.
 10452***************************************************************
 10453*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
 10454*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
 10455*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
 10456*    WILL BE DISPLAYED ON THE SCREEN.                         *
 10457*                                                             *
 10458***************************************************************
 10459
 10460***************************************************************
 10461*    CHECK TO SEE IF IT IS THE SAME REQUEST OR NOT.           *
 10462*    IF IT IS A NEW REQUEST AND A LETTER WAS PRINTED          *
 10463*    THEN FORCE AN ERROR.                                     *
 10464***************************************************************
 10465
 10466     IF  PI-689-CREATE-NO-SCREENS
 10467         GO TO 2000-GET-TEXT.
 10468
 10469     IF  PI-CREATE-MODE
 10470         IF  PI-689-PRINT-PERFORMED
 10471                 AND
 10472             FORMI NOT EQUAL 9999
 10473             MOVE ER-0279    TO EMI-ERROR
 10474             MOVE -1         TO MAINTL
 10475             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10476             GO TO 8200-SEND-DATAONLY.
 10477
 10478     IF  ARCHNUML GREATER THAN ZEROS
 10479         MOVE ER-9320            TO EMI-ERROR
 10480         MOVE -1                 TO ARCHNUML
 10481         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10482         GO TO 8200-SEND-DATAONLY.
 10483
 10484***************************************************************
 10485*    IF  A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE     *
 10486*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
 10487***************************************************************
 10488
 10489     IF  FORMI EQUAL '9999'
 10490         MOVE 16                 TO PI-TOTAL-LINES
 10491         MOVE 1                  TO PI-CURRENT-LINE
 10492         MOVE SPACES             TO W-FILE-TABLE
 10493                                    W-LINE-CONTROL-RECORD
 10494                                    W-RECORD-TABLE
 10495                                    W-SINGLE-LINE
 10496                                    W-SQUEEZED-LINE
 10497                                    W-TS-WORK-AREA
 10498                                    W-TX-TABLE
 10499         PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 10500         MOVE '3'                TO PI-ACTION
 10501         MOVE FORMI              TO PI-689-FORM-NUMBER
 10502                                    PI-COMM-CONTROL
 10503         MOVE ZEROS              TO PI-UPDATE-SW
 10504         MOVE W-PGM-EL1042       TO W-CALL-PGM
 10505         GO TO 9400-XCTL.
 10506
 10507 2000-GET-TEXT.
 10508
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 214
* EL689.cbl
 10509     MOVE SPACES                 TO W-FILE-TABLE
 10510                                    W-LINE-CONTROL-RECORD
 10511                                    W-RECORD-TABLE
 10512                                    W-SINGLE-LINE
 10513                                    W-SQUEEZED-LINE
 10514                                    W-TS-WORK-AREA
 10515                                    W-TX-TABLE.
 10516     SET W-TG-NDX                TO +1
 10517     MOVE ZEROS                  TO W-INITIAL-COLUMN
 10518                                    W-LINE-COUNT
 10519                                    W-LINE-INDENT-1
 10520                                    W-LINE-INDENT-2
 10521                                    W-LINE-INDENT-3
 10522                                    W-LINE-INDENT-4
 10523                                    W-LINE-INDENT-5
 10524                                    W-PAGE
 10525                                    W-PARAGRAPH-INDENT
 10526                                    W-TOP-MARGIN
 10527                                    W-WORK-INDENT.
 10528     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
 10529     MOVE +70                    TO W-LAST-COLUMN.
 10530     MOVE +56                    TO W-MAX-LINES-PER-PAGE.
 10531     MOVE +1                     TO W-START-COLUMN.
 10532     MOVE +71                    TO W-TOO-FAR.
 10533
 10534     MOVE PI-COMPANY-CD          TO W-TEXT-COMPANY-CD.
 10535     MOVE FORMI                  TO W-TEXT-LETTER.
 10536     MOVE W-TEXT-PARTIAL-KEY     TO W-TEXT-SAVE-KEY.
 10537     MOVE 'N'                    TO W-TEXT-BROWSED-SW.
 10538
 10539
 10540* EXEC CICS HANDLE CONDITION
 10541*         NOTFND     (2001-NOT-FOUND)
 10542*         ENDFILE    (2001-NOT-FOUND)
 10543*         NOTOPEN    (8050-TEXT-NOT-OPEN)
 10544*    END-EXEC.
 10545*    MOVE '"$I''J                 ! ) #00010295' TO DFHEIV0
 10546     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 10547     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10548     MOVE X'2920233030303130323935' TO DFHEIV0(25:11)
 10549     CALL 'kxdfhei1' USING DFHEIV0
 10550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10551
 10552
 10553
 10554* EXEC CICS STARTBR
 10555*         DATASET    (W-TEXT-FILE-ID)
 10556*         RIDFLD     (W-TEXT-KEY)
 10557*         GTEQ
 10558*    END-EXEC.
 10559     MOVE 0
 10560       TO DFHEIV11
 10561*    MOVE '&,         G          &   #00010301' TO DFHEIV0
 10562     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10563     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10564     MOVE X'2020233030303130333031' TO DFHEIV0(25:11)
 10565     CALL 'kxdfhei1' USING DFHEIV0,
 10566           W-TEXT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 215
* EL689.cbl
 10567           W-TEXT-KEY,
 10568           DFHEIV99,
 10569           DFHEIV11,
 10570           DFHEIV99
 10571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10572
 10573
 10574
 10575* EXEC CICS HANDLE CONDITION
 10576*         ENDFILE    (2000-ENDBR)
 10577*    END-EXEC.
 10578*    MOVE '"$''                   ! * #00010307' TO DFHEIV0
 10579     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 10580     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10581     MOVE X'2A20233030303130333037' TO DFHEIV0(25:11)
 10582     CALL 'kxdfhei1' USING DFHEIV0
 10583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10584
 10585
 10586 2000-READ-NEXT.
 10587
 10588     IF  W-TG-NDX GREATER THAN W-MAX-LINES
 10589         MOVE ER-0051            TO EMI-ERROR
 10590         MOVE -1                 TO MAINTL
 10591         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10592         GO TO 2000-ENDBR.
 10593
 10594
 10595* EXEC CICS READNEXT
 10596*         DATASET    (W-TEXT-FILE-ID)
 10597*         SET        (ADDRESS OF TEXT-FILES)
 10598*         RIDFLD     (W-TEXT-KEY)
 10599*    END-EXEC.
 10600     MOVE 0
 10601       TO DFHEIV11
 10602*    MOVE '&.S                   )   #00010319' TO DFHEIV0
 10603     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10604     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10605     MOVE X'2020233030303130333139' TO DFHEIV0(25:11)
 10606     CALL 'kxdfhei1' USING DFHEIV0,
 10607           W-TEXT-FILE-ID,
 10608           DFHEIV20,
 10609           DFHEIV99,
 10610           W-TEXT-KEY,
 10611           DFHEIV99,
 10612           DFHEIV11,
 10613           DFHEIV99,
 10614           DFHEIV99
 10615     SET ADDRESS OF TEXT-FILES TO
 10616         DFHEIV20
 10617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10618
 10619
 10620     IF  W-TEXT-PARTIAL-KEY NOT EQUAL W-TEXT-SAVE-KEY
 10621         GO TO 2000-ENDBR.
 10622
 10623     MOVE 'Y'                    TO W-TEXT-BROWSED-SW.
 10624
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 216
* EL689.cbl
 10625     MOVE TX-FORM-SQUEEZE-CONTROL
 10626                                 TO W-FORM-SQUEEZE-IND.
 10627
 10628     IF  PI-689-ARCHIVE-SW NOT GREATER THAN SPACES
 10629         MOVE TX-ARCHIVE-SW      TO PI-689-ARCHIVE-SW.
 10630
 10631     IF  TX-FORM-CONTROL-LINE
 10632         PERFORM 2100-PROCESS-FORM-CONTROL-LINE THRU 2100-EXIT
 10633         GO TO 2000-READ-NEXT.
 10634
 10635     IF  TX-LINE-SQUEEZE-CONTROL EQUAL 'Z'
 10636         PERFORM 2150-PROCESS-Z-CONTROLS THRU 2150-EXIT
 10637         GO TO 2000-READ-NEXT.
 10638
 10639     MOVE TX-TEXT-LINE           TO W-TX-TEXT (W-TG-NDX).
 10640     MOVE TX-PROCESS-CONTROL     TO W-TX-PC (W-TG-NDX).
 10641     PERFORM 2200-CHECK-FOR-VARIABLE THRU 2200-EXIT.
 10642     MOVE TX-LINE-SQUEEZE-CONTROL
 10643                                 TO W-TX-SC (W-TG-NDX).
 10644
 10645     SET W-TG-NDX UP BY 1.
 10646     GO TO 2000-READ-NEXT.
 10647
 10648 2000-ENDBR.
 10649
 10650
 10651* EXEC CICS ENDBR
 10652*        DATASET     (W-TEXT-FILE-ID)
 10653*    END-EXEC.
 10654     MOVE 0
 10655       TO DFHEIV11
 10656*    MOVE '&2                    $   #00010355' TO DFHEIV0
 10657     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10658     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10659     MOVE X'2020233030303130333535' TO DFHEIV0(25:11)
 10660     CALL 'kxdfhei1' USING DFHEIV0,
 10661           W-TEXT-FILE-ID,
 10662           DFHEIV11,
 10663           DFHEIV99
 10664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10665
 10666
 10667     IF  W-TEXT-BROWSE-NOT-STARTED
 10668         MOVE ER-0006            TO EMI-ERROR
 10669         MOVE -1                 TO FORML
 10670         MOVE AL-UABON           TO FORMA
 10671         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10672         GO TO 8350-SEND-DATAONLY-ERASEAUP.
 10673
 10674     SET  W-TOTAL-TX-LINES       TO W-TG-NDX.
 10675     SUBTRACT +1 FROM W-TOTAL-TX-LINES.
 10676     MOVE 1                      TO PI-CURRENT-LINE.
 10677
 10678     IF  COPIESL NOT GREATER THAN ZEROS
 10679         MOVE +1                 TO COPIESI
 10680                                    PI-689-NUMBER-COPIES
 10681         MOVE +1                 TO COPIESL
 10682         MOVE AL-UNNON           TO COPIESA.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 217
* EL689.cbl
 10683
 10684***************************************************************
 10685*    IF IT IS A FORM WITH VARIABLES, THEN RESOLVE ALL OF      *
 10686*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
 10687***************************************************************
 10688
 10689     PERFORM 6000-RESOLVE-VARIABLES THRU 6000-EXIT.
 10690
 10691*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
 10692*        IF  PI-689-CONTROL NOT GREATER THAN ZEROS
 10693*            MOVE ER-7243        TO EMI-ERROR
 10694*            MOVE -1             TO PRTRESTL
 10695*            MOVE AL-UABON       TO PRTRESTA
 10696*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10697
 10698     IF  PI-CREATE-LABELS AND
 10699         NOT  PI-689-LABELS-OVERRIDEN
 10700         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 10701         SET W-RG-NDX UP BY +1
 10702     ELSE
 10703         SET W-RG-NDX            TO +1.
 10704
 10705     MOVE W-TOP-FORM             TO W-RC-TEXT (W-RG-NDX).
 10706     SET W-RG-NDX UP BY W-TOP-MARGIN.
 10707
 10708     PERFORM 7400-CREATE-LETTER THRU 7400-EXIT.
 10709
 10710     SET PI-TOTAL-LINES          TO W-RG-NDX.
 10711
 10712     IF  W-FIRST-BAD-VARIABLE-FOUND
 10713         SET W-RG-NDX            TO W-FIRST-BAD-VARIABLE
 10714         MOVE W-FIRST-BAD-VARIABLE
 10715                                 TO PI-CURRENT-LINE
 10716     ELSE
 10717         SET W-RG-NDX            TO 1.
 10718
 10719     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10720             VARYING
 10721         W-SC-NDX FROM 1 BY 1
 10722             UNTIL
 10723         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 10724     IF  PI-689-CREATE-NO-SCREENS
 10725         GO TO 2000-EXIT
 10726     ELSE
 10727         IF  W-FORM-CHANGED
 10728             MOVE '3'            TO PI-ACTION
 10729             MOVE -1             TO MAINTL
 10730             GO TO 8100-SEND-INITIAL-MAP
 10731         ELSE
 10732             MOVE '3'            TO PI-ACTION
 10733             MOVE -1             TO MAINTL
 10734             GO TO 8350-SEND-DATAONLY-ERASEAUP.
 10735
 10736 2000-EXIT.
 10737     EXIT.
 10738
 10739 2001-NOT-FOUND.
 10740
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 218
* EL689.cbl
 10741     MOVE ER-0006                TO EMI-ERROR.
 10742     MOVE -1                     TO FORML.
 10743     MOVE AL-UABON               TO FORMA.
 10744     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10745     GO TO 8350-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 219
* EL689.cbl
 10747 2100-PROCESS-FORM-CONTROL-LINE.
 10748
 10749     MOVE TX-TEXT-LINE           TO W-LINE-CONTROL-RECORD.
 10750
 10751     IF  W-LC-LINE-WIDTH NUMERIC
 10752             AND
 10753         W-LC-LINE-WIDTH GREATER THAN ZEROS
 10754         COMPUTE W-INITIAL-COLUMN
 10755             = (70 - W-LC-LINE-WIDTH) / 2
 10756         COMPUTE W-START-COLUMN = W-INITIAL-COLUMN + 1
 10757         COMPUTE W-LAST-COLUMN ROUNDED
 10758             = W-INITIAL-COLUMN + W-LC-LINE-WIDTH
 10759         COMPUTE W-TOO-FAR = W-LAST-COLUMN + 1
 10760     ELSE
 10761         MOVE 70                 TO W-LC-LINE-WIDTH.
 10762
 10763     IF  W-LC-PARAGRAPH-INDENT NUMERIC
 10764             AND
 10765         W-LC-PARAGRAPH-INDENT GREATER THAN ZEROS
 10766         MOVE W-LC-PARAGRAPH-INDENT
 10767                                 TO W-PARAGRAPH-INDENT.
 10768
 10769     IF  W-LC-MAX-LINES-PER-PAGE NUMERIC
 10770             AND
 10771         W-LC-MAX-LINES-PER-PAGE GREATER THAN ZEROS
 10772         MOVE W-LC-MAX-LINES-PER-PAGE
 10773                                 TO W-MAX-LINES-PER-PAGE.
 10774
 10775     IF  W-LC-LINE-ADJUST NUMERIC
 10776             AND
 10777         W-LC-LINE-ADJUST GREATER THAN ZEROS
 10778         COMPUTE W-TOTAL-LINE-LENGTH
 10779             = W-LC-LINE-WIDTH + (W-LC-LINE-ADJUST * 2)
 10780         IF  W-TOTAL-LINE-LENGTH LESS THAN +71
 10781             ADD W-LC-LINE-ADJUST
 10782                                 TO W-INITIAL-COLUMN
 10783                                    W-LAST-COLUMN
 10784                                    W-START-COLUMN
 10785                                    W-TOO-FAR.
 10786
 10787     IF  W-LC-LINE-INDENT-1 NUMERIC
 10788             AND
 10789         W-LC-LINE-INDENT-1 LESS THAN W-LC-LINE-WIDTH
 10790         MOVE W-LC-LINE-INDENT-1 TO W-LINE-INDENT-1
 10791     ELSE
 10792         MOVE +0                 TO W-LINE-INDENT-1.
 10793
 10794     IF  W-LC-LINE-INDENT-2 NUMERIC
 10795             AND
 10796         W-LC-LINE-INDENT-2 LESS THAN W-LC-LINE-WIDTH
 10797         MOVE W-LC-LINE-INDENT-2 TO W-LINE-INDENT-2
 10798     ELSE
 10799         MOVE +0                 TO W-LINE-INDENT-2.
 10800
 10801     IF  W-LC-LINE-INDENT-3 NUMERIC
 10802             AND
 10803         W-LC-LINE-INDENT-3 LESS THAN W-LC-LINE-WIDTH
 10804         MOVE W-LC-LINE-INDENT-3 TO W-LINE-INDENT-3
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 220
* EL689.cbl
 10805     ELSE
 10806         MOVE +0                 TO W-LINE-INDENT-3.
 10807
 10808     IF  W-LC-LINE-INDENT-4 NUMERIC
 10809             AND
 10810         W-LC-LINE-INDENT-4 LESS THAN W-LC-LINE-WIDTH
 10811         MOVE W-LC-LINE-INDENT-4 TO W-LINE-INDENT-4
 10812     ELSE
 10813         MOVE +0                 TO W-LINE-INDENT-4.
 10814
 10815     IF  W-LC-LINE-INDENT-5 NUMERIC
 10816             AND
 10817         W-LC-LINE-INDENT-5 LESS THAN W-LC-LINE-WIDTH
 10818         MOVE W-LC-LINE-INDENT-5 TO W-LINE-INDENT-5
 10819
 10820     ELSE
 10821         MOVE +0                 TO W-LINE-INDENT-5.
 10822
 10823     IF  W-LC-TOP-MARGIN NUMERIC
 10824         MOVE W-LC-TOP-MARGIN    TO W-TOP-MARGIN
 10825     ELSE
 10826         MOVE +0                 TO W-TOP-MARGIN.
 10827
 10828     IF W-LC-CASE-IND = 'Y' OR 'N'
 10829         NEXT SENTENCE
 10830     ELSE
 10831         MOVE PI-LOWER-CASE-LETTERS
 10832                                 TO W-LC-CASE-IND.
 10833
 10834 2100-EXIT.
 10835     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 221
* EL689.cbl
 10837 2150-PROCESS-Z-CONTROLS.
 10838
 10839     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
 10840
 10841     IF PI-689-RESEND-DATE-1 = LOW-VALUES
 10842        IF W-DAYS-TO-RESEND NUMERIC
 10843           IF W-DAYS-TO-RESEND > ZEROS
 10844              MOVE '6'           TO DC-OPTION-CODE
 10845              MOVE W-SAVE-BIN-DATE
 10846                                 TO DC-BIN-DATE-1
 10847              MOVE ZEROS         TO DC-ELAPSED-MONTHS
 10848              MOVE W-DAYS-TO-RESEND
 10849                                 TO DC-ELAPSED-DAYS
 10850              PERFORM 9500-LINK-DATE-CONVERT
 10851                                 THRU 9500-EXIT
 10852              IF NO-CONVERSION-ERROR
 10853                 MOVE DC-BIN-DATE-2
 10854                                 TO PI-689-RESEND-DATE-1
 10855                 MOVE DC-GREG-DATE-1-EDIT
 10856                                 TO RESEND1O
 10857                                    PI-689-RESEND1-EDIT
 10858                 MOVE AL-UANON
 10859                                 TO RESEND1A
 10860                 MOVE +8         TO RESEND1L
 10861              ELSE
 10862                 MOVE ER-3770
 10863                                 TO EMI-ERROR
 10864                 MOVE -1         TO MAINTL
 10865                 PERFORM 9900-ERROR-FORMAT
 10866                                 THRU 9900-EXIT
 10867                 GO TO 8200-SEND-DATAONLY
 10868              END-IF
 10869           END-IF
 10870        END-IF
 10871     END-IF
 10872     IF W-FORM-TO-RESEND NOT = SPACES AND ZEROS
 10873        MOVE W-FORM-TO-RESEND    TO PI-689-RESEND-LETR-1
 10874     END-IF
 10875     IF  PI-689-FOLLOW-UP-DATE EQUAL LOW-VALUES
 10876         IF  W-DAYS-TO-FOLLOW-UP NUMERIC
 10877            IF  W-DAYS-TO-FOLLOW-UP >= ZEROS
 10878                 MOVE '6'        TO DC-OPTION-CODE
 10879                 MOVE W-SAVE-BIN-DATE
 10880                                 TO DC-BIN-DATE-1
 10881                 MOVE ZEROS      TO DC-ELAPSED-MONTHS
 10882                 MOVE W-DAYS-TO-FOLLOW-UP
 10883                                 TO DC-ELAPSED-DAYS
 10884                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10885                 IF  NO-CONVERSION-ERROR
 10886                     MOVE DC-BIN-DATE-2
 10887                                 TO PI-689-FOLLOW-UP-DATE
 10888                     MOVE DC-GREG-DATE-1-EDIT
 10889                                 TO FOLLOWO
 10890                     MOVE AL-UANON
 10891                                 TO FOLLOWA
 10892                     MOVE +8     TO FOLLOWL
 10893                 ELSE
 10894                     MOVE ER-3771
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 222
* EL689.cbl
 10895                                 TO EMI-ERROR
 10896                     MOVE -1     TO MAINTL
 10897                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10898                     GO TO 8200-SEND-DATAONLY.
 10899
 10900     IF  COPIESI NOT NUMERIC
 10901             OR
 10902         COPIESI NOT GREATER THAN ZEROS
 10903         IF  W-NUMBER-OF-COPIES NUMERIC
 10904             IF  W-NUMBER-OF-COPIES GREATER THAN ZEROS
 10905                 MOVE W-NUMBER-OF-COPIES
 10906                                 TO COPIESI
 10907                                    PI-689-NUMBER-COPIES
 10908                 MOVE AL-UNNON   TO COPIESA
 10909                 MOVE +1         TO COPIESL
 10910             ELSE
 10911                 MOVE +1         TO COPIESI
 10912                                    PI-689-NUMBER-COPIES
 10913                 MOVE AL-UNNON   TO COPIESA
 10914                 MOVE +1         TO COPIESL
 10915         ELSE
 10916             MOVE +1             TO COPIESI
 10917                                    PI-689-NUMBER-COPIES
 10918             MOVE AL-UNNON       TO COPIESA
 10919             MOVE +1             TO COPIESL.
 10920
 10921     IF W-PROMPT-LETTER EQUAL 'Y'
 10922         MOVE 'Y'                TO PI-PROMPT-IND
 10923         MOVE ER-0894            TO EMI-ERROR
 10924         MOVE -1                 TO MAINTL
 10925         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10926     END-IF.
 10927
 10928     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
 10929                                           ENCO
 10930     MOVE AL-UANON                      TO ENCA
 10931     MOVE +3                            TO ENCL
 10932
 10933     IF W-PRINT-CERTIFICATE = 'Y'
 10934        MOVE 'Y' TO PI-CERT-REQ-IND
 10935        IF CERTIDL > ZEROS
 10936            IF CERTIDI NUMERIC
 10937              MOVE AL-UANON      TO CERTIDA
 10938              MOVE CERTIDI       TO PI-CERT-FORM-ID
 10939            ELSE
 10940              MOVE ER-1778       TO EMI-ERROR
 10941              MOVE -1            TO CERTIDL
 10942              MOVE AL-UABON      TO CERTIDA
 10943              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10944           END-IF
 10945        ELSE
 10946              MOVE ER-0715       TO EMI-ERROR
 10947              MOVE -1            TO CERTIDL
 10948              MOVE AL-UABON      TO CERTIDA
 10949              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10950        END-IF
 10951     END-IF.
 10952
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 223
* EL689.cbl
 10953*    IF  PI-689-PRINT-RESTRICTION NOT = 'C' AND 'F' AND 'P' AND
 10954*                                       SPACES
 10955*        IF  W-PRINT-RESTRICTED
 10956*            MOVE W-PRINT-RESTRICTED-IND
 10957*                                TO PRTRESTI
 10958*                                   PI-689-PRINT-RESTRICTION
 10959*            MOVE AL-UANON       TO PRTRESTA
 10960*            MOVE +1             TO PRTRESTL.
 10961     .
 10962 2150-EXIT.
 10963     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 224
* EL689.cbl
 10965 2200-CHECK-FOR-VARIABLE.
 10966
 10967     IF  W-TX-TEXT (W-TG-NDX) EQUAL SPACES
 10968         GO TO 2200-EXIT.
 10969
 10970     SET W-TX-NDX                TO +1.
 10971
 10972 2200-CONTINUE.
 10973
 10974     SEARCH W-TX-CHAR
 10975         VARYING
 10976             W-TX-NDX
 10977         AT END
 10978             GO TO 2200-EXIT
 10979         WHEN
 10980             W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 10981             NEXT SENTENCE.
 10982
 10983     SET W-TX-NDX UP BY +1.
 10984
 10985     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 10986         PERFORM 2220-BUILD-VARIABLE-NUMBER THRU 2220-EXIT
 10987         GO TO 2200-CONTINUE.
 10988
 10989 2200-EXIT.
 10990     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 225
* EL689.cbl
 10992 2220-BUILD-VARIABLE-NUMBER.
 10993
 10994     SET W-TX-NDX UP BY +1.
 10995     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V1.
 10996     SET W-TX-NDX UP BY +1.
 10997     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V2.
 10998     SET W-TX-NDX UP BY +1.
 10999     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V3.
 11000
 11001     IF  W-VAR-RELATIVE-NUM NUMERIC
 11002         SET W-FILE-NDX TO W-VARIABLE-SOURCE (W-VAR-RELATIVE-NUM)
 11003         MOVE 'Y' TO W-FILE-USE-IND (W-FILE-NDX).
 11004
 11005 2220-EXIT.
 11006     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 226
* EL689.cbl
 11008 4000-ROLL-PAGE.
 11009
 11010     IF  ENTERPFL NOT EQUAL ZEROS
 11011         MOVE -1                 TO ENTERPFL
 11012     ELSE
 11013         MOVE -1                 TO MAINTL.
 11014
 11015     IF  PI-TOTAL-LINES EQUAL 0
 11016         MOVE ER-0047            TO EMI-ERROR
 11017         MOVE -1                 TO MAINTL
 11018         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11019         GO TO 8200-SEND-DATAONLY.
 11020
 11021     COMPUTE W-TEMP-CURRENT-LINE EQUAL
 11022         PI-CURRENT-LINE + W-ROLL-COUNTER.
 11023
 11024     IF  W-TEMP-CURRENT-LINE NEGATIVE
 11025             OR
 11026         W-TEMP-CURRENT-LINE EQUAL ZEROS
 11027         MOVE ER-0067            TO EMI-ERROR
 11028         MOVE -1                 TO MAINTL
 11029         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11030         MOVE 1                  TO W-TEMP-CURRENT-LINE.
 11031
 11032*    IF  W-TEMP-CURRENT-LINE GREATER THAN PI-TOTAL-LINES
 11033*            AND
 11034*        (EIBAID EQUAL DFHPF1 OR DFHPF6)
 11035*        MOVE ER-0066            TO EMI-ERROR
 11036*        MOVE -1                 TO MAINTL
 11037*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11038*        COMPUTE W-TEMP-CURRENT-LINE
 11039*            = PI-TOTAL-LINES + 1 - W-NUM-LINES-PER-SCREEN
 11040*        IF  W-TEMP-CURRENT-LINE NEGATIVE
 11041*                OR
 11042*            W-TEMP-CURRENT-LINE = ZEROS
 11043*            MOVE 1 TO W-TEMP-CURRENT-LINE.
 11044
 11045     IF  EMI-ERROR NOT EQUAL ER-0191
 11046             AND
 11047         MAINTI NOT EQUAL 'S'
 11048         PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
 11049         PERFORM 4100-SET-NDX THRU 4100-EXIT
 11050         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11051                 VARYING
 11052             W-SC-NDX FROM 1 BY 1
 11053                 UNTIL
 11054             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11055
 11056     IF  EMI-ERROR EQUAL ER-0066 OR ER-0067 OR ER-0000 OR
 11057                         ER-0191
 11058         NEXT SENTENCE
 11059     ELSE
 11060         GO TO 8200-SEND-DATAONLY.
 11061
 11062     MOVE W-TEMP-CURRENT-LINE    TO PI-CURRENT-LINE
 11063     SET W-RG-NDX                TO PI-CURRENT-LINE
 11064     MOVE LOW-VALUES             TO EL689RI
 11065*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 227
* EL689.cbl
 11066     PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
 11067     SET W-RG-NDX                TO PI-CURRENT-LINE
 11068     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 11069             VARYING
 11070         W-SC-NDX FROM 1 BY 1
 11071             UNTIL
 11072         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 11073
 11074     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 228
* EL689.cbl
 11076 4100-SET-NDX.
 11077
 11078     IF  PI-CURRENT-LINE EQUAL 0
 11079         SET W-RG-NDX            TO 1
 11080     ELSE
 11081         SET W-RG-NDX            TO PI-CURRENT-LINE.
 11082
 11083 4100-EXIT.
 11084      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 229
* EL689.cbl
 11086 4200-UPDATE-TABLE-FROM-SCREEN.
 11087
 11088     IF  W-SC-TEXTL (W-SC-NDX) NOT EQUAL ZEROS
 11089         MOVE ZEROS              TO W-SC-TEXTL (W-SC-NDX)
 11090         IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11091             IF  PI-TOTAL-LINES EQUAL W-MAX-LINES
 11092                 MOVE ER-0051    TO EMI-ERROR
 11093                 MOVE -1         TO MAINTL
 11094                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11095                 GO TO 8200-SEND-DATAONLY
 11096             ELSE
 11097                 MOVE W-SC-TEXT (W-SC-NDX)
 11098                                 TO W-RC-TEXT (W-RG-NDX)
 11099                 ADD 1           TO PI-TOTAL-LINES
 11100         ELSE
 11101             MOVE W-SC-TEXT (W-SC-NDX)
 11102                                 TO W-RC-TEXT (W-RG-NDX).
 11103
 11104     SET W-RG-NDX UP BY 1.
 11105
 11106 4200-EXIT.
 11107      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 230
* EL689.cbl
 11109 5000-EDIT-MODE.
 11110***************************************************************
 11111*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
 11112*    AND THE W-TS-TABLE OF LETTER TEXT.  IT WILL THEN         *
 11113*    TRANSFER TO THE W-TEXT-EDITOR PROGRAM.                   *
 11114***************************************************************
 11115
 11116     IF  PI-SHOW-MODE
 11117         MOVE ER-0188            TO EMI-ERROR
 11118         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11119         MOVE -1                 TO MAINTL
 11120         MOVE AL-UABON           TO MAINTA
 11121         GO TO 8200-SEND-DATAONLY.
 11122
 11123     IF  PI-CURRENT-LINE EQUAL ZEROS
 11124         MOVE ER-0187            TO EMI-ERROR
 11125         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11126         MOVE -1                 TO MAINTL
 11127         GO TO 8200-SEND-DATAONLY.
 11128
 11129     PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11130     PERFORM 4100-SET-NDX THRU 4100-EXIT.
 11131     PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11132             VARYING
 11133         W-SC-NDX FROM 1 BY 1
 11134             UNTIL
 11135         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11136
 11137     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 11138
 11139     MOVE PI-689-FORM-NUMBER     TO PI-COMM-CONTROL.
 11140     MOVE ZEROS                  TO PI-UPDATE-SW.
 11141     MOVE '1'                    TO PI-ENTRY-CD-1.
 11142     MOVE W-PGM-EL1042           TO W-CALL-PGM.
 11143     GO TO 9400-XCTL.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 231
* EL689.cbl
 11145 5400-LETTER-RELEASE.
 11146***************************************************************
 11147*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
 11148*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS IN       *
 11149*    THE ARCHIVE FILE.                                        *
 11150*    THE FUNCTIONS BELOW WILL BE PERFORMED.                   *
 11151*        1. CHECK SECURITY.                                   *
 11152*        2. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS.        *
 11153*        3. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
 11154*        4. WRITE THE NEW ARCHIVE RECORDS FROM W-TS-TABLE.    *
 11155*        5. RESET INSURED'S CONTROL FIELDS AND RETURN THE     *
 11156*           ARCHIVE NUMBER USED  TO FILE THE RECORDS.         *
 11157***************************************************************
 11158
 11159     IF  NOT MODIFY-CAP
 11160         MOVE ER-0070            TO EMI-ERROR
 11161         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11162         MOVE -1                 TO MAINTL
 11163         GO TO 8200-SEND-DATAONLY.
 11164
 11165     IF  PI-SHOW-MODE
 11166         MOVE ER-0188            TO EMI-ERROR
 11167         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11168         MOVE -1                 TO MAINTL
 11169         MOVE AL-UABON           TO MAINTA
 11170         GO TO 8200-SEND-DATAONLY.
 11171
 11172      IF  ARCHNUML GREATER THAN ZEROS
 11173          MOVE ER-9320            TO EMI-ERROR
 11174          MOVE -1                 TO ARCHNUML
 11175          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11176          GO TO 8200-SEND-DATAONLY.
 11177
 11178*     IF  PI-CURRENT-LINE EQUAL ZEROS
 11179*        MOVE ER-0187            TO EMI-ERROR
 11180*        MOVE -1                 TO MAINTL
 11181*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11182*        GO TO 8200-SEND-DATAONLY.
 11183
 11184*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11185*
 11186*    IF  NOT PI-689-CREATE-NO-SCREENS
 11187*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 11188*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11189*                VARYING
 11190*            W-SC-NDX FROM 1 BY 1
 11191*                UNTIL
 11192*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 11193*        IF  EMI-FATAL-CTR GREATER THAN ZEROS
 11194*                OR
 11195*            PI-689-FATAL-ERROR
 11196*            GO TO 8200-SEND-DATAONLY.
 11197*
 11198*    MOVE SPACES                 TO W-REMAINING-VAR-SW.
 11199*    PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 11200*            VARYING
 11201*        W-RVS-NDX FROM +1 BY +1
 11202*            UNTIL
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 232
* EL689.cbl
 11203*        W-RVS-NDX > +36500
 11204*            OR
 11205*        W-REMAINING-VAR-FOUND.
 11206*
 11207*    IF  NOT PI-689-CREATE-NO-SCREENS
 11208*        IF  W-REMAINING-VAR-FOUND
 11209*            GO TO 4000-ROLL-PAGE.
 11210
 11211*    MOVE SPACES                 TO W-CNTL-KEY.
 11212*    MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11213*    MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 11214*    MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 11215*
 11216*    EXEC CICS HANDLE CONDITION
 11217*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11218*         NOTFND     (5470-CNTL-NOT-FOUND)
 11219*    END-EXEC.
 11220*
 11221*    EXEC CICS READ
 11222*         DATASET    (W-CNTL-FILE-ID)
 11223*         SET        (ADDRESS OF CONTROL-FILE)
 11224*         RIDFLD     (W-CNTL-KEY)
 11225*         UPDATE
 11226*    END-EXEC.
 11227*
 11228*    IF  CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
 11229*        MOVE ZEROS              TO CF-CREDIT-LAST-ARCH-NUM
 11230*                                   CF-CREDIT-START-ARCH-NUM.
 11231*
 11232*    ADD 1                       TO CF-CREDIT-LAST-ARCH-NUM.
 11233*    MOVE CF-CREDIT-LAST-ARCH-NUM
 11234*                                TO W-ARCH-NUMBER
 11235*                                   W-ARCT-NUMBER.
 11236*
 11237*    EXEC CICS REWRITE
 11238*         FROM      (CONTROL-FILE)
 11239*         DATASET   (W-CNTL-FILE-ID)
 11240*    END-EXEC
 11241
 11242*    EXEC CICS HANDLE CONDITION
 11243*         NOTOPEN   (8010-ARCH-NOT-OPEN)
 11244*    END-EXEC.
 11245*
 11246*    EXEC CICS GETMAIN
 11247*       SET      (ADDRESS OF LETTER-ARCHIVE)
 11248*       LENGTH   (W-ARCH-LENGTH)
 11249*    END-EXEC
 11250*
 11251*    MOVE SPACES                 TO LETTER-ARCHIVE
 11252*    MOVE 'LA'                   TO LA-RECORD-ID.
 11253*    MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
 11254*                                   LA-ARCHIVE-NO-A2
 11255*                                   LA-ARCHIVE-NO-A3
 11256*                                   LA-ARCHIVE-NO-A4
 11257*                                   LA-ARCHIVE-NO-A5
 11258*                                   LA-ARCHIVE-NO-A6
 11259*                                   PI-689-ARCHIVE-NUMBER.
 11260*    MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 233
* EL689.cbl
 11261*                                   LA-COMPANY-CD-A2
 11262*                                   LA-COMPANY-CD-A3
 11263*                                   LA-COMPANY-CD-A4
 11264*                                   LA-COMPANY-CD-A5
 11265*                                   LA-COMPANY-CD-A6.
 11266*    MOVE PI-689-CARRIER         TO LA-CARRIER-A2
 11267*                                   LA-CARRIER-A3
 11268*                                   LA-CARRIER-A4
 11269*                                   LA-CARRIER-A5.
 11270*    MOVE PI-689-EFF-DATE        TO LA-EFFECT-DATE-A2.
 11271*    MOVE PI-689-GROUPING        TO LA-GROUPING-A2
 11272*                                   LA-GROUPING-A3
 11273*                                   LA-GROUPING-A4
 11274*                                   LA-GROUPING-A5.
 11275*    MOVE PI-689-ACCOUNT         TO LA-ACCOUNT-A2
 11276*                                   LA-ACCOUNT-A3
 11277*                                   LA-ACCOUNT-A4
 11278*                                   LA-ACCOUNT-A5.
 11279*    MOVE PI-689-STATE           TO LA-STATE-A2
 11280*                                   LA-STATE-A3
 11281*                                   LA-STATE-A4
 11282*                                   LA-STATE-A5.
 11283*
 11284*    IF  PI-689-DATA-SOURCE EQUAL '3'
 11285*            AND
 11286*        PI-689-RESP-PERSON GREATER THAN SPACES
 11287*        MOVE PI-689-RESP-PERSON
 11288*                                TO LA-RESP-PERSON-A2
 11289*        MOVE PI-689-TYPE        TO LA-TYPE-A2
 11290*    ELSE
 11291*        IF  PI-689-CERT-PRIME GREATER THAN SPACES
 11292*            MOVE PI-689-CERT-PRIME
 11293*                                TO LA-CERT-PRIME-A2
 11294*            MOVE PI-689-CERT-SFX
 11295*                                TO LA-CERT-SUFFIX-A2
 11296*        ELSE
 11297*            MOVE LOW-VALUE      TO LA-RESP-PERSON-A2
 11298*                                   LA-TYPE-A2.
 11299*
 11300*    IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 11301*        MOVE PI-689-ENTRY-BATCH TO LA-ENTRY-A6
 11302*        IF  PI-689-CONTROL GREATER THAN ZEROS
 11303*                AND
 11304*            PI-689-PRINT-RESTRICTION EQUAL 'C'
 11305*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 11306*            MOVE 'CK'           TO LA-FILLER
 11307*        ELSE
 11308*            NEXT SENTENCE
 11309*    ELSE
 11310*        IF  PI-689-CONTROL GREATER THAN ZEROS
 11311*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 11312*            MOVE 'CK'           TO LA-FILLER
 11313*        ELSE
 11314*            MOVE LOW-VALUES     TO LA-ENTRY-A6.
 11315*
 11316*    MOVE ZEROS                  TO W-SEQ-CTR.
 11317*
 11318*    MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 234
* EL689.cbl
 11319*
 11320*    MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
 11321*                                   LA-INITIAL-PRINT-DATE
 11322*                                   LA-SENT-DATE
 11323*                                   LA-REPLY-DATE.
 11324*    MOVE 'A'                    TO LA-STATUS.
 11325*
 11326*    IF  PI-689-NUMBER-COPIES NOT NUMERIC
 11327*            OR
 11328*        PI-689-NUMBER-COPIES EQUAL ZEROS
 11329*        MOVE  1                 TO LA-NO-OF-COPIES
 11330*    ELSE
 11331*        MOVE PI-689-NUMBER-COPIES
 11332*                                TO LA-NO-OF-COPIES.
 11333*
 11334*    MOVE PI-689-FORM-NUMBER     TO LA-FORM-A3.
 11335*    MOVE PI-689-FOLLOW-UP-DATE  TO LA-FOLLOW-UP-DATE.
 11336*    MOVE PI-689-PRINT-RESTRICTION
 11337*                                TO LA-PRINT-RESTRICTION
 11338*    MOVE PI-689-LABEL-SOURCE    TO LA-ADDR-SOURCE.
 11339*    MOVE PI-689-DATA-SOURCE     TO LA-DATA-SOURCE.
 11340*    MOVE PI-689-RESEND-DATE-1   TO LA-RESEND-DATE
 11341*    MOVE PI-689-RESEND-LETR-1   TO LA-RESEND-LETR
 11342*    MOVE W-CURRENT-SAVE         TO LA-CREATION-DATE.
 11343*
 11344*    IF  PI-689-PRINT-PERFORMED
 11345*        MOVE SPACES             TO PI-689-PRINT-SW
 11346*        MOVE W-CURRENT-SAVE     TO LA-INITIAL-PRINT-DATE
 11347*        IF  LA-RESEND-DATE = LOW-VALUES
 11348*            MOVE 'C'            TO LA-STATUS.
 11349*
 11350*    MOVE PI-689-NUMBER-LABEL-LINES
 11351*                                TO LA-NUMBER-LABEL-LINES.
 11352*    MOVE ZEROS                  TO PI-689-NUMBER-TEXT-RECORDS.
 11353*
 11354*    PERFORM 5410-CREATE-TEXT-RECORDS THRU 5410-EXIT.
 11355*
 11356*    MOVE PI-689-NUMBER-TEXT-RECORDS
 11357*    MOVE ZEROS                  TO LA-NO-OF-TEXT-RECORDS.
 11358*
 11359*    EXEC CICS HANDLE CONDITION
 11360*        DUPREC    (5460-DUPLICATE-ARCHIVE-RCD)
 11361*    END-EXEC.
 11362*
 11363*    PERFORM 5650-WRITE-ARCHIVE THRU 5650-EXIT.
 11364*    MOVE ER-0280                TO EMI-ERROR.
 11365*    MOVE -1                     TO MAINTL.
 11366*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11367*    MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 11368*    MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1).
 11369     .
 11370 5400-END.
 11371     DISPLAY ' MADE IT TO 5400 '
 11372     MOVE SPACES                 TO BL-INPUT
 11373     MOVE ZEROS                  TO BL-ARCHIVE-NO
 11374     MOVE PI-689-DATA-SOURCE     TO BL-DATA-SRCE
 11375     MOVE PI-689-CARRIER         TO BL-CARRIER
 11376     MOVE PI-689-GROUPING        TO BL-GROUP
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 235
* EL689.cbl
 11377     MOVE PI-689-STATE           TO BL-STATE
 11378     MOVE PI-689-ACCOUNT         TO BL-ACCOUNT
 11379     IF PI-689-EFF-DATE NOT = LOW-VALUES
 11380        MOVE PI-689-EFF-DATE     TO DC-BIN-DATE-1
 11381        MOVE ' '                 TO DC-OPTION-CODE
 11382        PERFORM 9500-LINK-DATE-CONVERT
 11383                                 THRU 9500-EXIT
 11384        IF NO-CONVERSION-ERROR
 11385           MOVE DC-GREG-DATE-1-EDIT
 11386                                 TO BL-EFF-DT
 11387        END-IF
 11388     END-IF
 11389     MOVE PI-689-CERT-NO         TO BL-CERT-NO
 11390     MOVE PI-689-ENTRY-BATCH     TO BL-BATCH-NO
 11391     MOVE PI-689-SEQ-NO          TO BL-BATCH-SEQ
 11392     MOVE PI-689-RESP-PERSON     TO BL-RESP-NO
 11393     MOVE PI-689-FORM-NUMBER     TO BL-LETTER-ID
 11394     MOVE PI-689-NUMBER-COPIES   TO BL-NO-OF-COPIES
 11395     IF PI-ENDT-ARCH-NO > ZERO
 11396         MOVE PI-ENDT-ARCH-NO    TO BL-ENDT-ARCH-NO
 11397     END-IF
 11398     MOVE 'LETTER  '             TO BL-SOURCE-SCREEN
 11399     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
 11400*    MOVE 'ALWA'                 TO BL-PROC-ID
 11401     MOVE PI-COMPANY-ID          TO BL-COMP-ID
 11402*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
 11403     MOVE PI-ENCLOSURE-CD        TO BL-ENC-CD
 11404     IF PI-689-RESEND-DATE-1 NOT = LOW-VALUES
 11405        MOVE PI-689-RESEND-DATE-1 TO DC-BIN-DATE-1
 11406        MOVE ' '                 TO DC-OPTION-CODE
 11407        PERFORM 9500-LINK-DATE-CONVERT
 11408                                 THRU 9500-EXIT
 11409        IF NO-CONVERSION-ERROR
 11410           MOVE DC-GREG-DATE-B-EDIT
 11411                                 TO BL-RESEND-DT
 11412        END-IF
 11413     END-IF
 11414     IF PI-689-FOLLOW-UP-DATE NOT = LOW-VALUES
 11415        MOVE PI-689-FOLLOW-UP-DATE TO DC-BIN-DATE-1
 11416        MOVE ' '                 TO DC-OPTION-CODE
 11417        PERFORM 9500-LINK-DATE-CONVERT
 11418                                 THRU 9500-EXIT
 11419        IF NO-CONVERSION-ERROR
 11420           MOVE DC-GREG-DATE-B-EDIT
 11421                                 TO BL-FOLLOW-UP-DT
 11422        END-IF
 11423     END-IF
 11424*    MOVE IFF-COMMENTS           TO BL-COMMENTS
 11425*    MOVE 'TEST COMMENTS'        TO BL-COMMENTS
 11426     MOVE PI-CERT-FORM-ID        TO BL-CERT-FORM-ID
 11427     if eibaid = dfhpf7
 11428        move 'B'                 TO BL-WRITE-ERARCH
 11429     else
 11430        move 'T'                 to bl-write-erarch
 11431     end-if
 11432    DISPLAY ' ABOUT TO LINK TO NSRASBL '
 11433*****************************************
 11434* Invoke the LETTER business logic
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 236
* EL689.cbl
 11435*****************************************
 11436
 11437* exec cics link
 11438*       program('NSRASBL')
 11439*       commarea(srch-commarea)
 11440*    end-exec.
 11441     MOVE LENGTH OF
 11442      srch-commarea
 11443       TO DFHEIV11
 11444     MOVE 'NSRASBL' TO DFHEIV1
 11445*    MOVE '."C                   (   #00011128' TO DFHEIV0
 11446     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11447     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11448     MOVE X'2020233030303131313238' TO DFHEIV0(25:11)
 11449     CALL 'kxdfhei1' USING DFHEIV0,
 11450           DFHEIV1,
 11451           srch-commarea,
 11452           DFHEIV11,
 11453           DFHEIV99,
 11454           DFHEIV99,
 11455           DFHEIV99,
 11456           DFHEIV99
 11457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11458
 11459     DISPLAY ' MADE IT BACK FROM NSRASBL ' bl-status ' '
 11460        bl-message ' ' bl-archive-no
 11461     move bl-archive-no to w-arch-number
 11462
 11463     if eibaid = dfhpf7
 11464        MOVE ER-0280                TO EMI-ERROR
 11465        MOVE -1                     TO MAINTL
 11466        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11467        MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 11468        MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1)
 11469        MOVE '2'                    TO PI-ACTION
 11470        MOVE ZEROS                  TO PI-TOTAL-LINES
 11471                                       PI-CURRENT-LINE
 11472        MOVE SPACES                 TO PI-689-PRINT-SW
 11473                                       PI-689-FORM-NUMBER
 11474        GO TO 9300-DFHCLEAR
 11475     else
 11476        move w-arch-number          to archnumo
 11477        MOVE ER-1818                TO EMI-ERROR
 11478        MOVE -1                     TO MAINTL
 11479        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11480     end-if
 11481     MOVE -1                     TO MAINTL
 11482     GO TO 8200-SEND-DATAONLY
 11483     .
 11484 5400-EXIT.
 11485     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 237
* EL689.cbl
 11487 5410-CREATE-TEXT-RECORDS.
 11488
 11489*    EXEC CICS HANDLE CONDITION
 11490*         NOTOPEN   (8015-ARCT-NOT-OPEN)
 11491*         DUPREC    (5465-DUPLICATE-ARCH-TEXT)
 11492*    END-EXEC.
 11493*
 11494*    IF  PI-689-CREATE-NO-SCREENS
 11495*        IF  PI-689-GET-ARCT-MAIN
 11496*            EXEC CICS GETMAIN
 11497*                 SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 11498*                 LENGTH   (W-ARCT-LENGTH)
 11499*            END-EXEC
 11500*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF
 11501*                                    LETTER-ARCHIVE-TEXT
 11502*            MOVE LCP-WS-ADDR-COMP
 11503*                                TO PI-689-ARCT-POINTER
 11504*        ELSE
 11505*            MOVE PI-689-ARCT-POINTER
 11506*                                TO LCP-WS-ADDR-COMP
 11507*            SET ADDRESS OF LETTER-ARCHIVE-TEXT
 11508*                                TO LCP-WS-ADDR-PNTR
 11509*    ELSE
 11510*        EXEC CICS GETMAIN
 11511*             SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 11512*             LENGTH   (W-ARCT-LENGTH)
 11513*        END-EXEC.
 11514*
 11515*    PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 11516*
 11517*    MOVE ZEROS                  TO W-SEQ-CTR
 11518*
 11519*    IF  PI-CREATE-LABELS AND
 11520*        NOT PI-689-LABELS-OVERRIDEN
 11521*        MOVE '1'                TO LT-RECORD-TYPE
 11522*        MOVE +0                 TO LT-LINE-SEQ-NO
 11523*        PERFORM 5600-FORMAT-ADDRESS-LINE THRU 5600-EXIT
 11524*                VARYING
 11525*            W-RG-NDX FROM 1 BY 1
 11526*                UNTIL
 11527*            W-RG-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 11528*        PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 11529*        PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT
 11530*    ELSE
 11531*        SET W-RG-NDX            TO +1.
 11532*
 11533*    SET LT-NDX                  TO W-ZEROS.
 11534*
 11535*    PERFORM 5500-FORMAT-TEXT THRU 5500-EXIT
 11536*            VARYING
 11537*        W-RG-NDX FROM W-RG-NDX BY +1
 11538*            UNTIL
 11539*        W-RG-NDX GREATER THAN PI-TOTAL-LINES.
 11540
 11541 5410-EXIT.
 11542     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 238
* EL689.cbl
 11544 5415-INITIALIZE-TEXT.
 11545
 11546     MOVE SPACES                 TO LETTER-ARCHIVE-TEXT.
 11547     MOVE 'LT'                   TO LT-RECORD-ID.
 11548
 11549     MOVE LA-ARCHIVE-NO          TO LT-ARCHIVE-NO.
 11550     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
 11551
 11552     MOVE ZEROS                  TO LT-LINE-SEQ-NO
 11553                                    LT-NUM-LINES-ON-RECORD.
 11554
 11555 5415-EXIT.
 11556     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 239
* EL689.cbl
 11558 5460-DUPLICATE-ARCHIVE-RCD.
 11559
 11560     IF  NOT PI-689-CREATE-NO-SCREENS
 11561
 11562* EXEC CICS SYNCPOINT ROLLBACK
 11563*        END-EXEC.
 11564*    MOVE '6"R                   !   #00011234' TO DFHEIV0
 11565     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11566     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11567     MOVE X'2020233030303131323334' TO DFHEIV0(25:11)
 11568     CALL 'kxdfhei1' USING DFHEIV0
 11569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11570
 11571
 11572     MOVE ER-9426                TO EMI-ERROR.
 11573     MOVE -1                     TO MAINTL.
 11574     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11575     GO TO 8200-SEND-DATAONLY.
 11576
 11577 5465-DUPLICATE-ARCH-TEXT.
 11578
 11579     IF  NOT PI-689-CREATE-NO-SCREENS
 11580
 11581* EXEC CICS SYNCPOINT ROLLBACK
 11582*        END-EXEC.
 11583*    MOVE '6"R                   !   #00011245' TO DFHEIV0
 11584     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11585     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11586     MOVE X'2020233030303131323435' TO DFHEIV0(25:11)
 11587     CALL 'kxdfhei1' USING DFHEIV0
 11588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11589
 11590
 11591     MOVE ER-7369                TO EMI-ERROR.
 11592     MOVE -1                     TO MAINTL.
 11593     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11594     GO TO 8200-SEND-DATAONLY.
 11595
 11596 5470-CNTL-NOT-FOUND.
 11597
 11598     MOVE ER-9299                TO EMI-ERROR.
 11599     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11600     MOVE -1                     TO MAINTL.
 11601     MOVE AL-UANON               TO MAINTA.
 11602     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 240
* EL689.cbl
 11604 5500-FORMAT-TEXT.
 11605
 11606     SET LT-NDX UP BY +1.
 11607
 11608     IF  W-RC-TEXT (W-RG-NDX) EQUAL W-TOP-FORM
 11609         SET W-RG-NDX UP BY 1
 11610         MOVE 99                 TO LT-SKIP-CONTROL (LT-NDX)
 11611         MOVE W-RC-TEXT (W-RG-NDX)
 11612                                 TO LT-TEXT-LINE (LT-NDX)
 11613     ELSE
 11614         IF  W-RC-TEXT (W-RG-NDX) EQUAL SPACES
 11615             MOVE ZEROS          TO W-PRINT-CONTROL
 11616             PERFORM 5505-FIND-USED-LINE THRU 5505-EXIT
 11617                     VARYING
 11618                 W-RG-NDX FROM W-RG-NDX BY 1
 11619                     UNTIL
 11620                 W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11621                     OR
 11622                 W-RC-TEXT (W-RG-NDX) GREATER THAN SPACES
 11623             IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11624                 GO TO 5500-WRITE-TEST
 11625             ELSE
 11626                 MOVE W-PRINT-CONTROL
 11627                                 TO LT-SKIP-CONTROL (LT-NDX)
 11628                 MOVE W-RC-TEXT (W-RG-NDX)
 11629                                 TO LT-TEXT-LINE (LT-NDX)
 11630         ELSE
 11631             MOVE W-RC-TEXT (W-RG-NDX)
 11632                                 TO LT-TEXT-LINE (LT-NDX)
 11633             MOVE ZEROS          TO W-PRINT-CONTROL.
 11634
 11635     ADD +1                      TO LT-NUM-LINES-ON-RECORD.
 11636
 11637 5500-WRITE-TEST.
 11638
 11639     IF  W-RG-NDX NOT LESS THAN PI-TOTAL-LINES
 11640         IF  LT-TEXT-RECORD NOT EQUAL SPACES
 11641             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 11642             MOVE '2'            TO LT-RECORD-TYPE
 11643             ADD +1              TO W-SEQ-CTR
 11644             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 11645             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 11646         ELSE
 11647             NEXT SENTENCE
 11648     ELSE
 11649         IF  LT-NDX EQUAL +20
 11650             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 11651             MOVE '2'            TO LT-RECORD-TYPE
 11652             ADD +1              TO W-SEQ-CTR
 11653             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 11654             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 11655             SET LT-NDX          TO W-ZEROS
 11656             PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 11657
 11658 5500-EXIT.
 11659      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 241
* EL689.cbl
 11661 5505-FIND-USED-LINE.
 11662
 11663     ADD +1                      TO W-PRINT-CONTROL.
 11664
 11665 5505-EXIT.
 11666      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 242
* EL689.cbl
 11668 5600-FORMAT-ADDRESS-LINE.
 11669
 11670     SET LT-NDX                  TO W-RG-NDX.
 11671     MOVE W-RC-TEXT (W-RG-NDX)   TO LT-TEXT-LINE (LT-NDX).
 11672
 11673 5600-EXIT.
 11674     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 243
* EL689.cbl
 11676 5650-WRITE-ARCHIVE.
 11677
 11678
 11679* EXEC CICS WRITE
 11680*         DATASET   (W-ARCH-FILE-ID)
 11681*         FROM      (LETTER-ARCHIVE)
 11682*         RIDFLD    (LA-CONTROL-PRIMARY)
 11683*    END-EXEC.
 11684     MOVE LENGTH OF
 11685      LETTER-ARCHIVE
 11686       TO DFHEIV11
 11687*    MOVE '&$ L                  ''   #00011335' TO DFHEIV0
 11688     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11689     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11690     MOVE X'2020233030303131333335' TO DFHEIV0(25:11)
 11691     CALL 'kxdfhei1' USING DFHEIV0,
 11692           W-ARCH-FILE-ID,
 11693           LETTER-ARCHIVE,
 11694           DFHEIV11,
 11695           LA-CONTROL-PRIMARY,
 11696           DFHEIV99,
 11697           DFHEIV99
 11698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11699
 11700
 11701 5650-EXIT.
 11702     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 244
* EL689.cbl
 11704 5655-WRITE-ARCHIVE-TEXT.
 11705
 11706
 11707* EXEC CICS WRITE
 11708*         DATASET   (W-ARCT-FILE-ID)
 11709*         FROM      (LETTER-ARCHIVE-TEXT)
 11710*         RIDFLD    (LT-CONTROL-PRIMARY)
 11711*    END-EXEC.
 11712     MOVE LENGTH OF
 11713      LETTER-ARCHIVE-TEXT
 11714       TO DFHEIV11
 11715*    MOVE '&$ L                  ''   #00011346' TO DFHEIV0
 11716     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11717     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11718     MOVE X'2020233030303131333436' TO DFHEIV0(25:11)
 11719     CALL 'kxdfhei1' USING DFHEIV0,
 11720           W-ARCT-FILE-ID,
 11721           LETTER-ARCHIVE-TEXT,
 11722           DFHEIV11,
 11723           LT-CONTROL-PRIMARY,
 11724           DFHEIV99,
 11725           DFHEIV99
 11726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11727
 11728
 11729 5655-EXIT.
 11730     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 245
* EL689.cbl
 11732 6000-RESOLVE-VARIABLES.
 11733***************************************************************
 11734*    THIS ROUTINE WILL FORMAT THE SYSTEM DEFINED SYMBOLS      *
 11735*    WITH DATA PERTAINING TO THE FORM WITH VARIABLES.         *
 11736*    THIS ROUTINE IS PERFORM THRU 6000-EXIT IN ORDER TO       *
 11737*    RESOLVE ALL OF THE SYMBOLS.                              *
 11738*                                                             *
 11739***************************************************************
 11740
 11741     PERFORM 6200-GET-COMPANY-DATA THRU 6200-EXIT.
 11742     PERFORM 6250-GET-CNTL2-DATA THRU 6250-EXIT.
 11743     PERFORM 6400-GET-PENDING-DATA THRU 6400-EXIT.
 11744     PERFORM 6450-GET-CERT-DATA THRU 6450-EXIT.
 11745     PERFORM 6500-GET-ACCOUNT-DATA THRU 6500-EXIT
 11746*    PERFORM 6350-GET-CSR-DATA   THRU 6350-EXIT
 11747     PERFORM 6600-GET-COMPENSATION-DATA THRU 6600-EXIT.
 11748     PERFORM 6700-GET-MAIL-DATA THRU 6700-EXIT.
 11749     PERFORM 6300-GET-CARRIER-DATA THRU 6300-EXIT.
 11750     PERFORM 6750-GET-LIFE-BENEFIT-DATA THRU 6750-EXIT.
 11751     PERFORM 6800-GET-A-H-BENEFIT-DATA THRU 6800-EXIT.
 11752     PERFORM 6850-GET-CHECK-DATA THRU 6850-EXIT.
 11753     PERFORM 6900-GET-PYAJ-DATA THRU 6900-EXIT.
 11754     PERFORM 6950-MOVE-SYSTEM-DATA THRU 6950-EXIT.
 11755
 11756     MOVE SPACES                 TO W-REVERSE-DATE-SW.
 11757
 11758 6000-EXIT.
 11759     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 246
* EL689.cbl
 11761 6200-GET-COMPANY-DATA.
 11762
 11763     IF  ADDRSI EQUAL '3'
 11764             AND
 11765         PI-CREATE-LABELS
 11766             AND
 11767         NOT PI-689-LABELS-OVERRIDEN
 11768         NEXT SENTENCE
 11769     ELSE
 11770         IF  W-FILE-NOT-USED (1)
 11771             GO TO 6200-EXIT.
 11772
 11773     MOVE SPACES                 TO W-CNTL-KEY.
 11774     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11775     MOVE +0                     TO W-CNTL-SEQ-NO.
 11776     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 11777
 11778
 11779* EXEC CICS HANDLE CONDITION
 11780*         NOTOPEN   (8040-CNTL-NOT-OPEN)
 11781*         NOTFND    (6200-CNTL1-NOT-FOUND)
 11782*    END-EXEC.
 11783*    MOVE '"$JI                  ! + #00011401' TO DFHEIV0
 11784     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11785     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11786     MOVE X'2B20233030303131343031' TO DFHEIV0(25:11)
 11787     CALL 'kxdfhei1' USING DFHEIV0
 11788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11789
 11790
 11791
 11792* EXEC CICS READ
 11793*         DATASET   (W-CNTL-FILE-ID)
 11794*         SET       (ADDRESS OF CONTROL-FILE)
 11795*         RIDFLD    (W-CNTL-KEY)
 11796*    END-EXEC.
 11797*    MOVE '&"S        E          (   #00011406' TO DFHEIV0
 11798     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11799     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11800     MOVE X'2020233030303131343036' TO DFHEIV0(25:11)
 11801     CALL 'kxdfhei1' USING DFHEIV0,
 11802           W-CNTL-FILE-ID,
 11803           DFHEIV20,
 11804           DFHEIV99,
 11805           W-CNTL-KEY,
 11806           DFHEIV99,
 11807           DFHEIV99,
 11808           DFHEIV99
 11809     SET ADDRESS OF CONTROL-FILE TO
 11810         DFHEIV20
 11811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11812
 11813
 11814     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 11815     MOVE CF-CL-MAIL-TO-NAME     TO W-LABEL-LINES (1)
 11816                                    W-VG-TEXT (25).
 11817     MOVE CF-CL-IN-CARE-OF       TO W-LABEL-LINES (2).
 11818     MOVE CF-CL-ADDR-LINE-1      TO W-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 247
* EL689.cbl
 11819     MOVE CF-CL-ADDR-LINE-2      TO W-LABEL-LINES (4).
 11820     MOVE CF-CL-CITY-STATE       TO W-LABEL-LINES (5).
 11821
 11822     IF  CF-CL-CAN-POST-CODE
 11823         MOVE CF-CL-CANADIAN-POSTAL-CODE
 11824                                 TO W-CANADIAN-POSTAL-CODES
 11825         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 11826         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 11827         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 11828                                    W-LAB-CAN-FILLER (6)
 11829         GO TO 6200-CONTINUE.
 11830
 11831     IF CF-CL-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 11832         MOVE CF-CL-ZIP-CODE     TO W-WORK-ZIP
 11833         MOVE SPACES             TO W-LABEL-ZIP (6)
 11834         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 11835
 11836         IF  W-WORK-ZIP4 GREATER THAN '0000'
 11837             MOVE '-'            TO W-LABEL-DASH (6)
 11838             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 11839             GO TO 6200-CONTINUE
 11840         ELSE
 11841             MOVE SPACES         TO W-LABEL-DASH (6)
 11842                                    W-LABEL-2ND-ZIP (6)
 11843             GO TO 6200-CONTINUE.
 11844
 11845     IF  CF-CL-ZIP-CODE-NUM NOT NUMERIC
 11846         GO TO 6200-CONTINUE.
 11847
 11848     MOVE CF-CL-ZIP-CODE-NUM     TO W-WORK-ZIP-NUMERIC.
 11849
 11850     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 11851         COMPUTE W-WORK-ZIP-NUMERIC
 11852             = W-WORK-ZIP-NUMERIC * 10000.
 11853
 11854     MOVE SPACES                 TO W-LABEL-ZIP (6).
 11855     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 11856
 11857     IF  W-WORK-ZIP4 GREATER THAN '0000'
 11858         MOVE '-'                TO W-LABEL-DASH (6)
 11859         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 11860         GO TO 6200-CONTINUE
 11861     ELSE
 11862         MOVE SPACES             TO W-LABEL-DASH (6)
 11863                                    W-LABEL-2ND-ZIP (6)
 11864         GO TO 6200-CONTINUE.
 11865
 11866 6200-CONTINUE.
 11867
 11868     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 11869
 11870     IF  ADDRSI EQUAL '3'
 11871             AND
 11872         PI-CREATE-LABELS
 11873             AND
 11874         NOT PI-689-LABELS-OVERRIDEN
 11875         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (1)
 11876         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (2)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 248
* EL689.cbl
 11877         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (3)
 11878         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (04)
 11879         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (5)
 11880         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (6)
 11881         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 11882         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 11883         SET W-RG-NDX UP BY +1
 11884     ELSE
 11885         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (1)
 11886         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (2)
 11887         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (3)
 11888         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (4)
 11889         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (5)
 11890         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (6).
 11891
 11892     GO TO 6200-EXIT.
 11893
 11894 6200-CNTL1-NOT-FOUND.
 11895
 11896     MOVE ER-9299                TO EMI-ERROR.
 11897     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11898     MOVE -1                     TO ADDRSL.
 11899     MOVE AL-UANON               TO ADDRSA.
 11900     GO TO 8200-SEND-DATAONLY.
 11901
 11902 6200-EXIT.
 11903     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 249
* EL689.cbl
 11905 6250-GET-CNTL2-DATA.
 11906
 11907     IF  PI-PROCESSOR-ID EQUAL W-LGXX-ID
 11908         GO TO 6250-EXIT.
 11909
 11910     IF  W-FILE-NOT-USED (11)
 11911         GO TO 6250-EXIT.
 11912
 11913     MOVE SPACES                 TO W-CNTL-KEY.
 11914     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11915     MOVE +0                     TO W-CNTL-SEQ-NO.
 11916     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 11917     MOVE PI-PROCESSOR-ID        TO W-CNTL-GENL.
 11918
 11919
 11920* EXEC CICS HANDLE CONDITION
 11921*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11922*         NOTFND     (6250-CNTL2-NOT-FOUND)
 11923*    END-EXEC.
 11924*    MOVE '"$JI                  ! , #00011517' TO DFHEIV0
 11925     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11926     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11927     MOVE X'2C20233030303131353137' TO DFHEIV0(25:11)
 11928     CALL 'kxdfhei1' USING DFHEIV0
 11929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11930
 11931
 11932
 11933* EXEC CICS READ
 11934*         DATASET    (W-CNTL-FILE-ID)
 11935*         SET        (ADDRESS OF CONTROL-FILE)
 11936*         RIDFLD     (W-CNTL-KEY)
 11937*    END-EXEC.
 11938*    MOVE '&"S        E          (   #00011522' TO DFHEIV0
 11939     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11940     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11941     MOVE X'2020233030303131353232' TO DFHEIV0(25:11)
 11942     CALL 'kxdfhei1' USING DFHEIV0,
 11943           W-CNTL-FILE-ID,
 11944           DFHEIV20,
 11945           DFHEIV99,
 11946           W-CNTL-KEY,
 11947           DFHEIV99,
 11948           DFHEIV99,
 11949           DFHEIV99
 11950     SET ADDRESS OF CONTROL-FILE TO
 11951         DFHEIV20
 11952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11953
 11954
 11955     MOVE CF-PROCESSOR           TO W-VG-TEXT (153).
 11956     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (151).
 11957     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (152).
 11958     GO TO 6250-EXIT.
 11959
 11960 6250-CNTL2-NOT-FOUND.
 11961
 11962     MOVE ER-9299                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 250
* EL689.cbl
 11963     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11964     MOVE -1                     TO MAINTL.
 11965     MOVE AL-UANON               TO MAINTA.
 11966     GO TO 8200-SEND-DATAONLY.
 11967
 11968 6250-EXIT.
 11969     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 251
* EL689.cbl
 11971 6300-GET-CARRIER-DATA.
 11972
 11973     IF  ADDRSI EQUAL '2'
 11974             AND
 11975         PI-CREATE-LABELS
 11976             AND
 11977         NOT PI-689-LABELS-OVERRIDEN
 11978         NEXT SENTENCE
 11979     ELSE
 11980         IF  W-FILE-NOT-USED (4)
 11981             GO TO 6300-EXIT.
 11982
 11983     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
 11984         MOVE SPACES             TO W-CNTL-KEY
 11985         MOVE PI-COMPANY-ID      TO W-CNTL-COMPANY-ID
 11986         MOVE +0                 TO W-CNTL-SEQ-NO
 11987         MOVE '6'                TO W-CNTL-RECORD-TYPE
 11988         MOVE PI-689-CARRIER     TO W-CNTL-GEN4
 11989     ELSE
 11990         MOVE ER-9327            TO EMI-ERROR
 11991         MOVE -1                 TO CARRIERL
 11992         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11993         GO TO 6300-EXIT.
 11994
 11995
 11996* EXEC CICS HANDLE CONDITION
 11997*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11998*         NOTFND     (6300-CNTL6-NOT-FOUND)
 11999*    END-EXEC.
 12000*    MOVE '"$JI                  ! - #00011568' TO DFHEIV0
 12001     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12002     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12003     MOVE X'2D20233030303131353638' TO DFHEIV0(25:11)
 12004     CALL 'kxdfhei1' USING DFHEIV0
 12005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12006
 12007
 12008
 12009* EXEC CICS READ
 12010*         DATASET    (W-CNTL-FILE-ID)
 12011*         SET        (ADDRESS OF CONTROL-FILE)
 12012*         RIDFLD     (W-CNTL-KEY)
 12013*    END-EXEC.
 12014*    MOVE '&"S        E          (   #00011573' TO DFHEIV0
 12015     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12016     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12017     MOVE X'2020233030303131353733' TO DFHEIV0(25:11)
 12018     CALL 'kxdfhei1' USING DFHEIV0,
 12019           W-CNTL-FILE-ID,
 12020           DFHEIV20,
 12021           DFHEIV99,
 12022           W-CNTL-KEY,
 12023           DFHEIV99,
 12024           DFHEIV99,
 12025           DFHEIV99
 12026     SET ADDRESS OF CONTROL-FILE TO
 12027         DFHEIV20
 12028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 252
* EL689.cbl
 12029
 12030
 12031     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12032     MOVE CF-MAIL-TO-NAME        TO W-LABEL-LINES (1).
 12033     MOVE CF-IN-CARE-OF          TO W-LABEL-LINES (2).
 12034     MOVE CF-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 12035     MOVE CF-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 12036     MOVE CF-CITY-STATE          TO W-LABEL-LINES (5).
 12037
 12038     IF  CF-CANADIAN-POST-CODE
 12039         MOVE CF-CANADIAN-POSTAL-CODE
 12040                                 TO W-CANADIAN-POSTAL-CODES
 12041         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12042         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12043         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12044                                    W-LAB-CAN-FILLER (6)
 12045         GO TO 6300-CONTINUE.
 12046
 12047     IF CF-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 12048         MOVE CF-ZIP-CODE        TO W-WORK-ZIP
 12049         MOVE SPACES             TO W-LABEL-ZIP (6)
 12050         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12051         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12052             MOVE '-'            TO W-LABEL-DASH (6)
 12053             MOVE W-WORK-ZIP4
 12054                                 TO W-LABEL-2ND-ZIP (6)
 12055             GO TO 6300-CONTINUE
 12056         ELSE
 12057             MOVE SPACES         TO W-LABEL-DASH (6)
 12058                                    W-LABEL-2ND-ZIP (6)
 12059             GO TO 6300-CONTINUE.
 12060
 12061     IF  CF-ZIP-CODE-NUM NOT NUMERIC
 12062         GO TO 6300-CONTINUE.
 12063
 12064     MOVE CF-ZIP-CODE-NUM TO W-WORK-ZIP-NUMERIC.
 12065
 12066     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 12067         COMPUTE W-WORK-ZIP-NUMERIC
 12068             = W-WORK-ZIP-NUMERIC * 10000.
 12069
 12070     MOVE SPACES                 TO W-LABEL-ZIP (6).
 12071     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 12072
 12073     IF  W-WORK-ZIP4 GREATER THAN '0000'
 12074         MOVE '-'                TO W-LABEL-DASH (6)
 12075         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 12076         GO TO 6300-CONTINUE
 12077     ELSE
 12078         MOVE SPACES             TO W-LABEL-DASH (6)
 12079                                    W-LABEL-2ND-ZIP (6)
 12080         GO TO 6300-CONTINUE.
 12081
 12082 6300-CONTINUE.
 12083
 12084     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12085
 12086     IF  ADDRSI EQUAL '2'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 253
* EL689.cbl
 12087             AND
 12088         PI-CREATE-LABELS
 12089             AND
 12090         NOT PI-689-LABELS-OVERRIDEN
 12091         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (20)
 12092         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (21)
 12093         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (22)
 12094         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (23)
 12095         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (24)
 12096         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (25)
 12097         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12098         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12099         SET W-RG-NDX UP BY +1
 12100     ELSE
 12101         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (20)
 12102         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (21)
 12103         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (22)
 12104         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (23)
 12105         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (24)
 12106         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (25).
 12107
 12108     IF  W-FULL-DATA
 12109         MOVE ZEROS              TO W-PHONE-IN
 12110         MOVE CF-PHONE-NO        TO W-PHONE-IN
 12111         MOVE W-PHI-AREA         TO W-PO-AREA
 12112         MOVE W-PHI-PFX          TO W-PO-PFX
 12113         MOVE W-PHI-SFX          TO W-PO-SFX
 12114         MOVE W-PHONE-OUT        TO W-VG-TEXT (26).
 12115
 12116     GO TO 6300-EXIT.
 12117
 12118 6300-CNTL6-NOT-FOUND.
 12119
 12120     MOVE ER-9298                TO EMI-ERROR.
 12121     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12122     MOVE -1                     TO ADDRSL.
 12123     MOVE AL-UANON               TO ADDRSA.
 12124     GO TO 8200-SEND-DATAONLY.
 12125
 12126 6300-EXIT.
 12127     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 254
* EL689.cbl
 12129 6350-GET-CSR-DATA.
 12130     IF W-VG-TEXT (148) (1:4) = '****' OR SPACES
 12131        GO TO 6350-EXIT
 12132     END-IF
 12133*    IF W-FILE-NOT-USED (11)
 12134*       GO TO 6350-EXIT
 12135*    END-IF
 12136     MOVE SPACES                 TO W-CNTL-KEY
 12137     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
 12138     MOVE +0                     TO W-CNTL-SEQ-NO
 12139     MOVE '2'                    TO W-CNTL-RECORD-TYPE
 12140     MOVE CO-CSR-CODE            TO W-CNTL-GENL
 12141
 12142* EXEC CICS HANDLE CONDITION
 12143*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 12144*         NOTFND     (6350-CNTL2-NOT-FOUND)
 12145*    END-EXEC
 12146*    MOVE '"$JI                  ! . #00011689' TO DFHEIV0
 12147     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12148     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12149     MOVE X'2E20233030303131363839' TO DFHEIV0(25:11)
 12150     CALL 'kxdfhei1' USING DFHEIV0
 12151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12152
 12153* EXEC CICS READ
 12154*         DATASET    (W-CNTL-FILE-ID)
 12155*         SET        (ADDRESS OF CONTROL-FILE)
 12156*         RIDFLD     (W-CNTL-KEY)
 12157*    END-EXEC
 12158*    MOVE '&"S        E          (   #00011693' TO DFHEIV0
 12159     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12160     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12161     MOVE X'2020233030303131363933' TO DFHEIV0(25:11)
 12162     CALL 'kxdfhei1' USING DFHEIV0,
 12163           W-CNTL-FILE-ID,
 12164           DFHEIV20,
 12165           DFHEIV99,
 12166           W-CNTL-KEY,
 12167           DFHEIV99,
 12168           DFHEIV99,
 12169           DFHEIV99
 12170     SET ADDRESS OF CONTROL-FILE TO
 12171         DFHEIV20
 12172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12173     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 12174     GO TO 6350-EXIT
 12175     .
 12176 6350-CNTL2-NOT-FOUND.
 12177     MOVE ER-9299                TO EMI-ERROR.
 12178     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12179     MOVE -1                     TO MAINTL.
 12180     MOVE AL-UANON               TO MAINTA.
 12181     GO TO 8200-SEND-DATAONLY.
 12182 6350-EXIT.
 12183     EXIT.
 12184 6400-GET-PENDING-DATA.
 12185
 12186     IF (ADDRSI EQUAL '7')
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 255
* EL689.cbl
 12187        AND (PI-CREATE-LABELS)
 12188        AND (NOT PI-689-LABELS-OVERRIDEN)
 12189        CONTINUE
 12190     ELSE
 12191        IF PI-689-DATA-SOURCE = '4'
 12192           CONTINUE
 12193        ELSE
 12194           IF W-FILE-NOT-USED (9)
 12195              GO TO 6400-EXIT
 12196           END-IF
 12197        END-IF
 12198     END-IF
 12199     IF  W-PNDB-ENTRY EQUAL LOW-VALUES
 12200         MOVE ER-9327            TO EMI-ERROR
 12201         MOVE -1                 TO MAINTL
 12202         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12203         GO TO 6400-EXIT.
 12204
 12205 6400-READ-PNDB-ONLY.
 12206
 12207
 12208* EXEC CICS HANDLE CONDITION
 12209*         NOTOPEN (8060-PNDB-NOT-OPEN)
 12210*         NOTFND  (8070-PNDB-NOT-FOUND)
 12211*    END-EXEC.
 12212*    MOVE '"$JI                  ! / #00011732' TO DFHEIV0
 12213     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12214     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12215     MOVE X'2F20233030303131373332' TO DFHEIV0(25:11)
 12216     CALL 'kxdfhei1' USING DFHEIV0
 12217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12218
 12219
 12220
 12221* EXEC CICS READ
 12222*         DATASET (W-PNDB-FILE-ID)
 12223*         SET     (ADDRESS OF PENDING-BUSINESS)
 12224*         RIDFLD  (W-PNDB-KEY)
 12225*    END-EXEC.
 12226*    MOVE '&"S        E          (   #00011737' TO DFHEIV0
 12227     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12228     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12229     MOVE X'2020233030303131373337' TO DFHEIV0(25:11)
 12230     CALL 'kxdfhei1' USING DFHEIV0,
 12231           W-PNDB-FILE-ID,
 12232           DFHEIV20,
 12233           DFHEIV99,
 12234           W-PNDB-KEY,
 12235           DFHEIV99,
 12236           DFHEIV99,
 12237           DFHEIV99
 12238     SET ADDRESS OF PENDING-BUSINESS TO
 12239         DFHEIV20
 12240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12241
 12242
 12243     MOVE 'Y'                    TO W-PNDB-FOUND-SW.
 12244
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 256
* EL689.cbl
 12245     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 12246         MOVE PB-SV-CARRIER      TO PB-CARRIER
 12247                                    PI-689-CARRIER
 12248         MOVE PB-SV-GROUPING     TO PB-GROUPING
 12249                                    PI-689-GROUPING
 12250         MOVE PB-SV-STATE        TO PB-STATE
 12251                                    PI-689-STATE
 12252         MOVE PB-CONTROL-BY-ACCOUNT
 12253                                 TO W-CERT-KEY
 12254                                    W-MAIL-KEY
 12255                                    W-ACCT-KEY
 12256         MOVE PB-ACCOUNT         TO PI-689-ACCOUNT
 12257         MOVE PB-CERT-EFF-DT     TO PI-689-EFF-DATE
 12258         MOVE PB-CERT-NO         TO PI-689-CERT-NO.
 12259
 12260 6400-ONLY-STOP.
 12261
 12262     MOVE PB-ENTRY-BATCH         TO W-VG-TEXT (130).
 12263
 12264     IF  NOT PB-ISSUE
 12265         GO TO 6400-CANCEL.
 12266
 12267     MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1.
 12268     MOVE SPACES                 TO DC-OPTION-CODE.
 12269     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12270
 12271     IF  NO-CONVERSION-ERROR
 12272         MOVE DC-GREG-DATE-1-EDIT
 12273                                 TO W-VG-TEXT (110).
 12274
 12275     MOVE PB-I-AGE               TO W-EDIT-3-0.
 12276     MOVE W-EDIT-3-0             TO W-VG-TEXT (124).
 12277     MOVE PB-I-LF-PREMIUM-AMT    TO W-EDIT-7-2.
 12278     MOVE W-EDIT-7-2             TO W-VG-TEXT (111).
 12279     MOVE PB-I-AH-PREMIUM-AMT    TO W-EDIT-7-2.
 12280     MOVE W-EDIT-7-2             TO W-VG-TEXT (112).
 12281     MOVE PB-I-LF-PREM-CALC      TO W-EDIT-7-2.
 12282     MOVE W-EDIT-7-2             TO W-VG-TEXT (113).
 12283     MOVE PB-I-AH-PREM-CALC      TO W-EDIT-7-2.
 12284     MOVE W-EDIT-7-2             TO W-VG-TEXT (114).
 12285     MOVE PB-I-LF-BENEFIT-AMT    TO W-EDIT-9-2.
 12286     MOVE W-EDIT-9-2             TO W-VG-TEXT (125).
 12287     MOVE PB-I-AH-BENEFIT-AMT    TO W-EDIT-7-2.
 12288     MOVE W-EDIT-7-2             TO W-VG-TEXT (126).
 12289     MOVE PB-I-LF-RATE           TO W-EDIT-2-5-S.
 12290     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (127).
 12291     MOVE PB-I-AH-RATE           TO W-EDIT-2-5-S.
 12292     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (128).
 12293     MOVE PB-I-LOAN-TERM         TO W-EDIT-3-0.
 12294     MOVE W-EDIT-3-0             TO W-VG-TEXT (129).
 12295
 12296     COMPUTE W-DIFFERENCE
 12297         = PB-I-LF-PREM-CALC - PB-I-LF-PREMIUM-AMT.
 12298
 12299     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 12300     MOVE W-EDIT-7-2             TO W-VG-TEXT (115).
 12301
 12302     COMPUTE W-DIFFERENCE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 257
* EL689.cbl
 12303         = PB-I-AH-PREM-CALC - PB-I-AH-PREMIUM-AMT.
 12304
 12305     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 12306     MOVE W-EDIT-7-2             TO W-VG-TEXT (116).
 12307
 12308 6400-CANCEL.
 12309
 12310     IF  NOT PB-CANCELLATION
 12311         GO TO 6400-EXIT.
 12312
 12313     MOVE PB-CI-AH-PRIOR-CANCEL-DT
 12314                                 TO DC-BIN-DATE-1.
 12315     MOVE SPACES                 TO DC-OPTION-CODE.
 12316     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12317
 12318     IF  NO-CONVERSION-ERROR
 12319         MOVE DC-GREG-DATE-1-EDIT
 12320                                 TO W-VG-TEXT (117).
 12321
 12322     MOVE PB-C-LF-CANCEL-AMT     TO W-EDIT-7-2.
 12323     MOVE W-EDIT-7-2             TO W-VG-TEXT (118).
 12324     MOVE PB-C-AH-CANCEL-AMT     TO W-EDIT-7-2.
 12325     MOVE W-EDIT-7-2             TO W-VG-TEXT (119).
 12326     MOVE PB-C-LF-REF-CALC       TO W-EDIT-7-2.
 12327     MOVE W-EDIT-7-2             TO W-VG-TEXT (120).
 12328     MOVE PB-C-AH-REF-CALC       TO W-EDIT-7-2.
 12329     MOVE W-EDIT-7-2             TO W-VG-TEXT (121).
 12330     COMPUTE W-EDIT-7-2 = PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT
 12331     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 12332
 12333     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 12334        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 12335     END-IF
 12336     MOVE PB-C-NH-INT-ON-REFS    TO W-EDIT-7-2
 12337     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 12338     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
 12339     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-1
 12340        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-1
 12341     END-IF
 12342     MOVE SPACES                 TO DC-OPTION-CODE
 12343     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 12344
 12345     IF NO-CONVERSION-ERROR
 12346        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 12347     END-IF
 12348
 12349     COMPUTE W-DIFFERENCE = PB-C-LF-REF-CALC
 12350                           - PB-C-LF-CANCEL-AMT.
 12351
 12352     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 12353     MOVE W-EDIT-7-2             TO W-VG-TEXT (122).
 12354
 12355     COMPUTE W-DIFFERENCE = PB-C-AH-REF-CALC
 12356                           - PB-C-AH-CANCEL-AMT.
 12357
 12358     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 12359     MOVE W-EDIT-7-2             TO W-VG-TEXT (123).
 12360
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 258
* EL689.cbl
 12361 6400-EXIT.
 12362     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 259
* EL689.cbl
 12364 6450-GET-CERT-DATA.
 12365     IF  W-FILE-NOT-USED (8)
 12366         GO TO 6450-EXIT.
 12367
 12368     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 12369         MOVE ER-9327            TO EMI-ERROR
 12370         MOVE -1                 TO MAINTL
 12371         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12372         GO TO 6450-EXIT.
 12373
 12374 6450-READ-CERT-ONLY.
 12375
 12376
 12377* EXEC CICS HANDLE CONDITION
 12378*         NOTOPEN (8030-CERT-NOT-OPEN)
 12379*         NOTFND  (8035-CERT-NOT-FOUND)
 12380*    END-EXEC.
 12381*    MOVE '"$JI                  ! 0 #00011876' TO DFHEIV0
 12382     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12383     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12384     MOVE X'3020233030303131383736' TO DFHEIV0(25:11)
 12385     CALL 'kxdfhei1' USING DFHEIV0
 12386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12387
 12388
 12389
 12390* EXEC CICS READ
 12391*         DATASET (W-CERT-FILE-ID)
 12392*         SET     (ADDRESS OF CERTIFICATE-MASTER)
 12393*         RIDFLD  (W-CERT-KEY)
 12394*    END-EXEC.
 12395*    MOVE '&"S        E          (   #00011881' TO DFHEIV0
 12396     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12397     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12398     MOVE X'2020233030303131383831' TO DFHEIV0(25:11)
 12399     CALL 'kxdfhei1' USING DFHEIV0,
 12400           W-CERT-FILE-ID,
 12401           DFHEIV20,
 12402           DFHEIV99,
 12403           W-CERT-KEY,
 12404           DFHEIV99,
 12405           DFHEIV99,
 12406           DFHEIV99
 12407     SET ADDRESS OF CERTIFICATE-MASTER TO
 12408         DFHEIV20
 12409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12410
 12411
 12412     MOVE 'Y'                    TO W-CERT-FOUND-SW.
 12413
 12414 6450-ONLY-STOP.
 12415
 12416     MOVE CM-INSURED-LAST-NAME   TO W-VG-TEXT (108).
 12417
 12418     MOVE CM-BENEFICIARY         TO W-VG-TEXT (109).
 12419
 12420     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 12421     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 260
* EL689.cbl
 12422     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 12423     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12424     MOVE WS-NAME-WORK           TO W-VG-TEXT (95).
 12425
 12426     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 12427     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 12428     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 12429     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 12430     MOVE WS-NAME-WORK           TO W-VG-TEXT (94).
 12431
 12432     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 12433     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 12434     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 12435     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 12436     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12437     MOVE WS-NAME-WORK           TO W-VG-TEXT (90).
 12438
 12439     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 12440     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 12441     MOVE SPACES                 TO W-NAME-MIDDLE.
 12442     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12443     MOVE WS-NAME-WORK           TO W-VG-TEXT (104).
 12444
 12445     MOVE CM-INSURED-FIRST-NAME  TO W-VG-TEXT (91).
 12446     MOVE CM-INSURED-INITIAL2    TO W-VG-TEXT (92).
 12447
 12448     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 12449     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 12450     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 12451     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12452     MOVE WS-NAME-WORK           TO W-VG-TEXT (103)
 12453                                    W-LABEL-JOINT-NAME.
 12454
 12455     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 12456     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 12457     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 12458     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 12459     MOVE WS-NAME-WORK           TO W-VG-TEXT (102).
 12460
 12461     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 12462     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 12463     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 12464     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 12465     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12466     MOVE WS-NAME-WORK           TO W-VG-TEXT (99).
 12467
 12468     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 12469     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 12470     MOVE SPACES                 TO W-NAME-MIDDLE.
 12471     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 12472     MOVE WS-NAME-WORK           TO W-VG-TEXT (105).
 12473
 12474     MOVE CM-JT-FIRST-NAME       TO W-VG-TEXT (100).
 12475     MOVE CM-JT-INITIAL          TO W-VG-TEXT (101).
 12476
 12477     COMPUTE W-WORK-AMOUNT
 12478         = CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT.
 12479     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 261
* EL689.cbl
 12480     MOVE W-EDIT-9-2             TO W-VG-TEXT (97).
 12481     MOVE CM-AH-PREMIUM-AMT      TO W-EDIT-7-2.
 12482     MOVE W-EDIT-7-2             TO W-VG-TEXT (98).
 12483
 12484     IF  CM-SEX-FEMAL
 12485         MOVE 'MS.'              TO W-VG-TEXT (96)
 12486
 12487     ELSE
 12488         MOVE 'MR.'              TO W-VG-TEXT (96).
 12489
 12490     MOVE CM-CARRIER OF CERTIFICATE-MASTER
 12491                                 TO W-VG-TEXT (70).
 12492     MOVE CM-GROUPING            TO W-VG-TEXT (71).
 12493     MOVE CM-ACCOUNT             TO W-VG-TEXT (72).
 12494     MOVE CM-CERT-NO             TO W-VG-TEXT (73).
 12495     MOVE CM-INSURED-ISSUE-AGE   TO W-DISPLAY-3.
 12496     MOVE W-DISPLAY-3            TO W-VG-TEXT (83).
 12497     MOVE CM-LOAN-NUMBER         TO W-VG-TEXT (86).
 12498     MOVE CM-LOAN-BALANCE        TO W-EDIT-7-2.
 12499     MOVE W-EDIT-7-2             TO W-VG-TEXT (87).
 12500     MOVE CM-MEMBER-NO           TO W-VG-TEXT (88).
 12501     MOVE CM-SOC-SEC-NO          TO W-VG-TEXT (89).
 12502     MOVE CM-POLICY-FORM-NO      TO W-VG-TEXT (83).
 12503     MOVE CM-LF-ORIG-TERM        TO W-EDIT-3-0.
 12504     MOVE W-EDIT-3-0             TO W-VG-TEXT (77).
 12505     MOVE CM-LF-BENEFIT-AMT      TO W-EDIT-9-2.
 12506     MOVE W-EDIT-9-2             TO W-VG-TEXT (79).
 12507     MOVE CM-AH-ORIG-TERM        TO W-EDIT-3-0.
 12508     MOVE W-EDIT-3-0             TO W-VG-TEXT (78).
 12509     MOVE CM-AH-BENEFIT-AMT      TO W-EDIT-7-2.
 12510     MOVE W-EDIT-7-2             TO W-VG-TEXT (80).
 12511     MOVE CM-AH-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 12512     MOVE W-EDIT-7-2             TO W-VG-TEXT (107).
 12513     MOVE CM-LF-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 12514     MOVE W-EDIT-7-2             TO W-VG-TEXT (106).
 12515     IF PI-689-DATA-SOURCE NOT = '4'
 12516     COMPUTE W-EDIT-7-2 = CM-LF-ITD-CANCEL-AMT
 12517        + CM-AH-ITD-CANCEL-AMT
 12518     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 12519     IF CM-NH-INT-ON-REFS NOT NUMERIC
 12520        MOVE ZEROS               TO CM-NH-INT-ON-REFS
 12521     END-IF
 12522     MOVE CM-NH-INT-ON-REFS      TO W-EDIT-7-2
 12523     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 12524     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
 12525     IF CM-AH-CANCEL-DT > DC-BIN-DATE-1
 12526        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
 12527     END-IF
 12528     MOVE SPACES                 TO DC-OPTION-CODE
 12529     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 12530
 12531     IF NO-CONVERSION-ERROR
 12532        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 12533     END-IF
 12534     END-IF
 12535     COMPUTE W-WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 12536     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
 12537     MOVE W-EDIT-9-2             TO W-VG-TEXT (93).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 262
* EL689.cbl
 12538
 12539     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1.
 12540     MOVE SPACES                 TO DC-OPTION-CODE.
 12541     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12542
 12543     IF  NO-CONVERSION-ERROR
 12544         MOVE DC-GREG-DATE-1-EDIT
 12545                                 TO W-VG-TEXT (81).
 12546
 12547     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1.
 12548     MOVE SPACES                 TO DC-OPTION-CODE.
 12549     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12550
 12551     IF  NO-CONVERSION-ERROR
 12552         MOVE DC-GREG-DATE-1-EDIT
 12553                                 TO W-VG-TEXT (82).
 12554
 12555     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12556     MOVE SPACES                 TO DC-OPTION-CODE.
 12557     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12558
 12559     IF  NO-CONVERSION-ERROR
 12560         MOVE DC-GREG-DATE-1-EDIT
 12561                                 TO W-VG-TEXT (74).
 12562
 12563     MOVE CM-LF-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 12564
 12565     IF  CM-PMT-EXTENSION-DAYS NUMERIC
 12566         MOVE CM-PMT-EXTENSION-DAYS
 12567                                 TO DC-ELAPSED-DAYS
 12568     ELSE
 12569         MOVE ZEROS              TO DC-ELAPSED-DAYS.
 12570
 12571     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12572     MOVE '6'                    TO DC-OPTION-CODE.
 12573     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12574
 12575     IF  NO-CONVERSION-ERROR
 12576         MOVE DC-GREG-DATE-1-EDIT
 12577                                 TO W-VG-TEXT (75).
 12578
 12579     MOVE CM-AH-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 12580     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12581     MOVE '6'                    TO DC-OPTION-CODE.
 12582     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12583
 12584     IF  NO-CONVERSION-ERROR
 12585         MOVE DC-GREG-DATE-1-EDIT
 12586                                 TO W-VG-TEXT (76).
 12587
 12588 6450-EXIT.
 12589     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 263
* EL689.cbl
 12591 6500-GET-ACCOUNT-DATA.
 12592
 12593     IF  ADDRSI EQUAL '1'
 12594             AND
 12595         PI-CREATE-LABELS
 12596             AND
 12597         NOT PI-689-LABELS-OVERRIDEN
 12598         NEXT SENTENCE
 12599     ELSE
 12600         IF  W-FILE-NOT-USED (6)
 12601             GO TO 6500-EXIT
 12602         END-IF
 12603     END-IF.
 12604
 12605 6500-READ-ACCT-ONLY.
 12606
 12607     IF  W-ACCT-ACCOUNT EQUAL LOW-VALUES
 12608         MOVE ER-9327            TO EMI-ERROR
 12609         MOVE -1                 TO MAINTL
 12610         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12611         GO TO 6500-EXIT.
 12612
 12613
 12614* EXEC CICS HANDLE CONDITION
 12615*         NOTOPEN    (8020-ACCT-NOT-OPEN)
 12616*         NOTFND     (6500-ACCT-NOT-FOUND)
 12617*         ENDFILE    (6500-ONLY-STOP)
 12618*    END-EXEC.
 12619*    MOVE '"$JI''                 ! 1 #00012088' TO DFHEIV0
 12620     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 12621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12622     MOVE X'3120233030303132303838' TO DFHEIV0(25:11)
 12623     CALL 'kxdfhei1' USING DFHEIV0
 12624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12625
 12626
 12627
 12628* EXEC CICS STARTBR
 12629*         RIDFLD     (W-ACCT-KEY)
 12630*         DATASET    (W-ACCT-FILE-ID)
 12631*         KEYLENGTH  (20)
 12632*         GENERIC
 12633*    END-EXEC.
 12634     MOVE 20
 12635       TO DFHEIV11
 12636     MOVE 0
 12637       TO DFHEIV12
 12638*    MOVE '&,   KG    G          &   #00012094' TO DFHEIV0
 12639     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 12640     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12641     MOVE X'2020233030303132303934' TO DFHEIV0(25:11)
 12642     CALL 'kxdfhei1' USING DFHEIV0,
 12643           W-ACCT-FILE-ID,
 12644           W-ACCT-KEY,
 12645           DFHEIV11,
 12646           DFHEIV12,
 12647           DFHEIV99
 12648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 264
* EL689.cbl
 12649
 12650
 12651     MOVE W-ACCT-PARTIAL-KEY     TO W-ACCT-SAVE-KEY.
 12652     MOVE 'Y'                    TO W-ACCT-BROWSE-STARTED-SW.
 12653
 12654 6500-READNEXT.
 12655
 12656
 12657* EXEC CICS READNEXT
 12658*         DATASET    (W-ACCT-FILE-ID)
 12659*         SET        (ADDRESS OF ACCOUNT-MASTER)
 12660*         RIDFLD     (W-ACCT-KEY)
 12661*    END-EXEC.
 12662     MOVE 0
 12663       TO DFHEIV11
 12664*    MOVE '&.S                   )   #00012106' TO DFHEIV0
 12665     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12666     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12667     MOVE X'2020233030303132313036' TO DFHEIV0(25:11)
 12668     CALL 'kxdfhei1' USING DFHEIV0,
 12669           W-ACCT-FILE-ID,
 12670           DFHEIV20,
 12671           DFHEIV99,
 12672           W-ACCT-KEY,
 12673           DFHEIV99,
 12674           DFHEIV11,
 12675           DFHEIV99,
 12676           DFHEIV99
 12677     SET ADDRESS OF ACCOUNT-MASTER TO
 12678         DFHEIV20
 12679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12680
 12681
 12682     IF  W-ACCT-PARTIAL-KEY NOT EQUAL W-ACCT-SAVE-KEY
 12683         IF  PRIOR-MATCH-ACCT-PKEY
 12684             CONTINUE
 12685*            GO TO 6500-ONLY-STOP
 12686         ELSE
 12687             IF  W-FILE-NOT-USED (6)
 12688                 PERFORM 6500-ENDBR
 12689                 GO TO 6500-EXIT
 12690             ELSE
 12691                 GO TO 6500-ACCT-NOT-FOUND
 12692             END-IF
 12693         END-IF
 12694     ELSE
 12695         SET PRIOR-MATCH-ACCT-PKEY TO TRUE
 12696         MOVE AM-CARRIER           TO WS-SAV-AM-CARRIER
 12697         MOVE AM-ACCOUNT           TO WS-SAV-AM-ACCOUNT
 12698         MOVE AM-DEFN-1            TO WS-SAV-AM-DEFN-1
 12699         MOVE AM-REMIT-TO          TO WS-SAV-AM-REMIT-TO
 12700         MOVE AM-NAME              TO WS-SAV-AM-NAME
 12701         MOVE AM-PERSON            TO WS-SAV-AM-PERSON
 12702         MOVE AM-ADDRS             TO WS-SAV-AM-ADDRS
 12703         MOVE SPACES               TO WS-SAV-AM-CITY
 12704*        MOVE AM-CITY              TO WS-SAV-AM-CITY
 12705         STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 12706            DELIMITED BY '  ' INTO WS-SAV-AM-CITY
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 265
* EL689.cbl
 12707         END-STRING
 12708         MOVE AM-ZIP               TO WS-SAV-AM-ZIP
 12709         MOVE AM-TEL-NO            TO WS-SAV-AM-TEL-NO
 12710         MOVE AM-CONTROL-NAME      TO WS-SAV-AM-CONTROL-NAME
 12711         MOVE AM-CSR-CODE          TO WS-SAV-AM-CSR-CODE
 12712         MOVE AM-ACCOUNT           TO WS-SAV-AM-ERACCT-ACCOUNT
 12713         GO TO 6500-READNEXT
 12714     END-IF
 12715     .
 12716 6500-ONLY-STOP.
 12717
 12718     IF  NOT PI-NO-CARRIER-SECURITY
 12719             AND
 12720         PI-CARRIER-SECURITY NOT = WS-SAV-AM-CARRIER
 12721         MOVE -1                 TO CARRIERL
 12722         MOVE AL-UANON           TO CARRIERA
 12723         MOVE ER-9095            TO EMI-ERROR
 12724         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12725         PERFORM 6500-ENDBR
 12726         GO TO 8200-SEND-DATAONLY.
 12727
 12728     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12729     MOVE WS-SAV-AM-NAME         TO W-LABEL-LINES (1).
 12730     MOVE WS-SAV-AM-PERSON       TO W-LABEL-LINES (2).
 12731     MOVE WS-SAV-AM-ADDRS        TO W-LABEL-LINES (3).
 12732     MOVE WS-SAV-AM-CITY         TO W-LABEL-LINES (4).
 12733
 12734     MOVE WS-SAV-AM-ZIP          TO W-WORK-ZIP.
 12735     MOVE SPACES                 TO W-LABEL-ZIP (5).
 12736
 12737     IF  SAVE-AM-CANADIAN-POST-CODE
 12738         MOVE WS-SAV-AM-CANADIAN-POSTAL-CODE
 12739                                 TO W-CANADIAN-POSTAL-CODES
 12740         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 12741         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 12742         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 12743                                    W-LAB-CAN-FILLER (5)
 12744     ELSE
 12745         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 12746
 12747         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12748             MOVE '-'            TO W-LABEL-DASH (5)
 12749             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 12750         ELSE
 12751             MOVE SPACES         TO W-LABEL-DASH (5)
 12752                                    W-LABEL-2ND-ZIP (5).
 12753
 12754     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12755
 12756     IF  ADDRSI EQUAL '1'
 12757             AND
 12758         PI-CREATE-LABELS
 12759             AND
 12760         NOT PI-689-LABELS-OVERRIDEN
 12761         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 12762                                    W-VG-TEXT (40)
 12763         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 12764                                    W-VG-TEXT (41)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 266
* EL689.cbl
 12765         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 12766                                    W-VG-TEXT (42)
 12767         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 12768                                    W-VG-TEXT (43)
 12769         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 12770                                    W-VG-TEXT (44)
 12771         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 12772                                    W-VG-TEXT (45)
 12773         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12774         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12775         SET W-RG-NDX UP BY +1
 12776     ELSE
 12777         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (40)
 12778         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (41)
 12779         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (42)
 12780         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (43)
 12781         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (44)
 12782         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (45).
 12783
 12784     IF  WS-SAV-AM-TEL-NO NOT NUMERIC
 12785             OR
 12786         WS-SAV-AM-TEL-NO EQUAL ZEROS
 12787         MOVE SPACES             TO W-VG-TEXT (46)
 12788     ELSE
 12789         MOVE ZEROS                  TO W-PHONE-IN
 12790         MOVE WS-SAV-AM-AREA-CODE    TO W-PO-AREA
 12791         MOVE WS-SAV-AM-TEL-PRE      TO W-PO-PFX
 12792         MOVE WS-SAV-AM-TEL-NBR      TO W-PO-SFX
 12793         MOVE W-PHONE-OUT            TO W-VG-TEXT (46).
 12794
 12795     IF WS-SAV-AM-CONTROL-NAME (1:1) NOT = LOW-VALUES
 12796        MOVE WS-SAV-AM-CONTROL-NAME  TO W-VG-TEXT (47)
 12797     ELSE
 12798        MOVE SPACES                   TO W-VG-TEXT (47)
 12799     END-IF.
 12800     MOVE WS-SAV-AM-CSR-CODE     TO W-VG-TEXT (48)
 12801     MOVE WS-SAV-AM-ERACCT-ACCOUNT
 12802                                 TO W-VG-TEXT (49)
 12803
 12804     MOVE WS-SAV-AM-ACCOUNT      TO W-VG-TEXT (72)
 12805     PERFORM 6500-ENDBR.
 12806
 12807     GO TO 6500-EXIT.
 12808
 12809 6500-ENDBR.
 12810
 12811     IF  W-ACCT-BROWSE-STARTED
 12812         MOVE 'N'                TO W-ACCT-BROWSE-STARTED-SW
 12813
 12814* EXEC CICS ENDBR
 12815*            DATASET (W-ACCT-FILE-ID)
 12816*        END-EXEC
 12817     MOVE 0
 12818       TO DFHEIV11
 12819*    MOVE '&2                    $   #00012243' TO DFHEIV0
 12820     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12821     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12822     MOVE X'2020233030303132323433' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 267
* EL689.cbl
 12823     CALL 'kxdfhei1' USING DFHEIV0,
 12824           W-ACCT-FILE-ID,
 12825           DFHEIV11,
 12826           DFHEIV99
 12827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12828     END-IF.
 12829
 12830 6500-ACCT-NOT-FOUND.
 12831
 12832     PERFORM 6500-ENDBR.
 12833
 12834     IF  DATASORI NOT EQUAL '1'
 12835         MOVE ER-0179            TO EMI-ERROR
 12836         GO TO 6500-EXIT.
 12837
 12838     MOVE ER-0179                TO EMI-ERROR.
 12839     MOVE -1                     TO MAINTL.
 12840     MOVE AL-UNBON               TO MAINTA.
 12841     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12842     GO TO 8200-SEND-DATAONLY.
 12843
 12844 6500-EXIT.
 12845     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 268
* EL689.cbl
 12847 6600-GET-COMPENSATION-DATA.
 12848
 12849     IF  ADDRSI EQUAL '4'
 12850             AND
 12851         PI-CREATE-LABELS
 12852             AND
 12853         NOT PI-689-LABELS-OVERRIDEN
 12854         NEXT SENTENCE
 12855     ELSE
 12856         IF  W-FILE-NOT-USED (10)
 12857             GO TO 6600-EXIT.
 12858
 12859     IF  W-COMP-RESP-PERSON GREATER THAN LOW-VALUES
 12860         MOVE W-COMP-KEY         TO W-COMP-SAVE-KEY
 12861         GO TO 6600-START.
 12862
 12863     IF  PI-ZERO-CARRIER
 12864             OR
 12865         PI-ZERO-CAR-GROUP
 12866         MOVE ZEROS              TO W-COMP-CARRIER.
 12867
 12868     IF  PI-ZERO-GROUPING
 12869             OR
 12870         PI-ZERO-CAR-GROUP
 12871         MOVE ZEROS              TO W-COMP-GROUPING.
 12872
 12873     IF  W-FILE-NOT-USED (6)
 12874         PERFORM 6500-READ-ACCT-ONLY THRU 6500-READNEXT
 12875         IF  EMI-ERROR EQUAL ER-0179
 12876             MOVE ER-9327        TO EMI-ERROR
 12877             MOVE -1             TO MAINTL
 12878             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12879             GO TO 6600-EXIT.
 12880
 12881     MOVE  'A'                   TO W-COMP-TYPE.
 12882
 12883     IF  WS-SAV-AM-REMIT-TO GREATER THAN ZEROS
 12884         MOVE WS-SAV-AM-AGT (WS-SAV-AM-REMIT-TO)
 12885                                 TO W-COMP-RESP-PERSON
 12886     ELSE
 12887         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 12888
 12889     PERFORM VARYING W-NDX FROM +1 BY +1 UNTIL
 12890        (W-NDX > +10)
 12891            OR
 12892         (WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F')
 12893     END-PERFORM
 12894
 12895     IF  WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F'
 12896         MOVE WS-SAV-AM-AGT (W-NDX)  TO W-COMP-ACCOUNT
 12897     ELSE
 12898         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 12899
 12900     PERFORM 6500-ENDBR.
 12901     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 12902
 12903     IF  W-COMP-RESP-PERSON EQUAL LOW-VALUES
 12904         MOVE ER-9327            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 269
* EL689.cbl
 12905         MOVE -1                 TO MAINTL
 12906         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12907         GO TO 6600-EXIT.
 12908
 12909 6600-START.
 12910
 12911
 12912* EXEC CICS HANDLE CONDITION
 12913*         NOTOPEN (8080-COMP-NOT-OPEN)
 12914*         NOTFND  (6600-COMP-NOT-FOUND)
 12915*    END-EXEC.
 12916*    MOVE '"$JI                  ! 2 #00012329' TO DFHEIV0
 12917     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12918     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12919     MOVE X'3220233030303132333239' TO DFHEIV0(25:11)
 12920     CALL 'kxdfhei1' USING DFHEIV0
 12921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12922
 12923
 12924
 12925* EXEC CICS STARTBR
 12926*         RIDFLD  (W-COMP-KEY)
 12927*         DATASET (W-COMP-FILE-ID)
 12928*    END-EXEC.
 12929     MOVE 0
 12930       TO DFHEIV11
 12931*    MOVE '&,         G          &   #00012334' TO DFHEIV0
 12932     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12933     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12934     MOVE X'2020233030303132333334' TO DFHEIV0(25:11)
 12935     CALL 'kxdfhei1' USING DFHEIV0,
 12936           W-COMP-FILE-ID,
 12937           W-COMP-KEY,
 12938           DFHEIV99,
 12939           DFHEIV11,
 12940           DFHEIV99
 12941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12942
 12943
 12944     MOVE 'Y'                    TO W-COMP-BROWSE-SW.
 12945
 12946 6600-READNEXT.
 12947
 12948
 12949* EXEC CICS READNEXT
 12950*         DATASET (W-COMP-FILE-ID)
 12951*         SET     (ADDRESS OF COMPENSATION-MASTER)
 12952*         RIDFLD  (W-COMP-KEY)
 12953*    END-EXEC.
 12954     MOVE 0
 12955       TO DFHEIV11
 12956*    MOVE '&.S                   )   #00012343' TO DFHEIV0
 12957     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12958     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12959     MOVE X'2020233030303132333433' TO DFHEIV0(25:11)
 12960     CALL 'kxdfhei1' USING DFHEIV0,
 12961           W-COMP-FILE-ID,
 12962           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 270
* EL689.cbl
 12963           DFHEIV99,
 12964           W-COMP-KEY,
 12965           DFHEIV99,
 12966           DFHEIV11,
 12967           DFHEIV99,
 12968           DFHEIV99
 12969     SET ADDRESS OF COMPENSATION-MASTER TO
 12970         DFHEIV20
 12971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12972
 12973
 12974     IF CO-CONTROL-PRIMARY
 12975           NOT = W-COMP-SAVE-KEY
 12976        GO TO 6600-COMP-NOT-FOUND.
 12977
 12978     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12979     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1)
 12980                                    W-VG-TEXT (140).
 12981     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 12982     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 12983     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 12984*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 12985     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 12986        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 12987     END-STRING
 12988
 12989     MOVE CO-ZIP                 TO W-WORK-ZIP.
 12990
 12991     IF  CO-CANADIAN-POST-CODE
 12992         MOVE CO-CANADIAN-POSTAL-CODE
 12993                                 TO W-CANADIAN-POSTAL-CODES
 12994         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12995         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12996         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12997                                    W-LAB-CAN-FILLER (6)
 12998     ELSE
 12999         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13000
 13001         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13002             MOVE '-'            TO W-LABEL-DASH (6)
 13003             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13004         ELSE
 13005             MOVE SPACES         TO W-LABEL-DASH (6)
 13006                                    W-LABEL-2ND-ZIP (6).
 13007
 13008     IF  CO-TELEPHONE NOT NUMERIC
 13009             OR
 13010         CO-TELEPHONE = ZEROS
 13011         MOVE SPACES             TO W-VG-TEXT (147)
 13012     ELSE
 13013         MOVE ZEROS              TO W-PHONE-IN
 13014         MOVE CO-AREA-CODE       TO W-PO-AREA
 13015         MOVE CO-PREFIX          TO W-PO-PFX
 13016         MOVE CO-PHONE           TO W-PO-SFX
 13017         MOVE W-PHONE-OUT        TO W-VG-TEXT (147).
 13018
 13019     IF (CO-FAXNO NOT NUMERIC)
 13020        OR (CO-FAXNO = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 271
* EL689.cbl
 13021        MOVE SPACES              TO W-VG-TEXT (182)
 13022     ELSE
 13023        MOVE ZEROS               TO W-PHONE-IN
 13024        MOVE CO-FAX-AREA-CODE    TO W-PO-AREA
 13025        MOVE CO-FAX-PREFIX       TO W-PO-PFX
 13026        MOVE CO-FAX-PHONE        TO W-PO-SFX
 13027        MOVE W-PHONE-OUT         TO W-VG-TEXT (182)
 13028     END-IF
 13029     IF CO-GA-STATUS-CODE NOT = 'A' AND 'I' AND 'P'
 13030        MOVE SPACES              TO W-VG-TEXT (183)
 13031     ELSE
 13032        EVALUATE CO-GA-STATUS-CODE
 13033           WHEN 'A'
 13034              MOVE 'ACTIVE'      TO W-VG-TEXT (183)
 13035           WHEN 'I'
 13036              MOVE 'INACTIVE'    TO W-VG-TEXT (183)
 13037           WHEN 'P'
 13038              MOVE 'PENDING'     TO W-VG-TEXT (183)
 13039        END-EVALUATE
 13040     END-IF
 13041     IF CO-BILL-SW NOT = 'B' AND 'R' AND 'T' AND 'S'
 13042        MOVE SPACES              TO W-VG-TEXT (181)
 13043     ELSE
 13044        EVALUATE CO-BILL-SW
 13045           WHEN 'B'
 13046              MOVE 'BILLED'      TO W-VG-TEXT (181)
 13047           WHEN 'R'
 13048              MOVE 'REMIT'       TO W-VG-TEXT (181)
 13049           WHEN 'T'
 13050              MOVE 'T'           TO W-VG-TEXT (181)
 13051           WHEN 'S'
 13052              MOVE 'S'           TO W-VG-TEXT (181)
 13053        END-EVALUATE
 13054     END-IF
 13055     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13056
 13057     IF  ADDRSI EQUAL '4'
 13058             AND
 13059         PI-CREATE-LABELS
 13060             AND
 13061         NOT PI-689-LABELS-OVERRIDEN
 13062         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13063                                    W-VG-TEXT (141)
 13064         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13065                                    W-VG-TEXT (142)
 13066         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13067                                    W-VG-TEXT (143)
 13068         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13069                                    W-VG-TEXT (144)
 13070         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13071                                    W-VG-TEXT (145)
 13072         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13073                                    W-VG-TEXT (146)
 13074         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13075         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13076         SET W-RG-NDX UP BY +1
 13077     ELSE
 13078         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (141)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 272
* EL689.cbl
 13079         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (142)
 13080         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (143)
 13081         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (144)
 13082         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (145)
 13083         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (146).
 13084
 13085     PERFORM 6630-GET-CSR-NAME THRU 6630-EXIT.
 13086
 13087     MOVE CO-RESP-NO             TO W-VG-TEXT (180).
 13088     MOVE CO-END-BAL             TO W-EDIT-7-2-NEGATIVE.
 13089     MOVE W-EDIT-7-2-NEGATIVE    TO W-VG-TEXT (150).
 13090
 13091     MOVE CO-LAST-STMT-DT        TO DC-GREG-DATE-1-YMD.
 13092     MOVE '3'                    TO DC-OPTION-CODE.
 13093     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13094
 13095     IF  NO-CONVERSION-ERROR
 13096         MOVE DC-GREG-DATE-1-ALPHA
 13097                                 TO W-VG-TEXT (149).
 13098
 13099     PERFORM 6620-GET-G-DATA THRU 6620-EXIT.
 13100     PERFORM 6626-GET-B-DATA     THRU 6626-EXIT
 13101
 13102     PERFORM 6600-ENDBR.
 13103     GO TO 6600-EXIT.
 13104
 13105 6600-ENDBR.
 13106
 13107     IF  W-COMP-BROWSE-STARTED
 13108         MOVE 'N'                      TO W-COMP-BROWSE-SW
 13109
 13110* EXEC CICS ENDBR
 13111*             DATASET(W-COMP-FILE-ID)
 13112*        END-EXEC.
 13113     MOVE 0
 13114       TO DFHEIV11
 13115*    MOVE '&2                    $   #00012484' TO DFHEIV0
 13116     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13117     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13118     MOVE X'2020233030303132343834' TO DFHEIV0(25:11)
 13119     CALL 'kxdfhei1' USING DFHEIV0,
 13120           W-COMP-FILE-ID,
 13121           DFHEIV11,
 13122           DFHEIV99
 13123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13124
 13125
 13126 6600-COMP-NOT-FOUND.
 13127
 13128     PERFORM 6600-ENDBR.
 13129
 13130     IF ADDRSL GREATER ZERO
 13131         IF ADDRSI = '4'
 13132            IF PI-689-TYPE EQUAL LOW-VALUES OR SPACES
 13133                MOVE ER-7378                TO EMI-ERROR
 13134                MOVE -1                     TO TYPEL
 13135                MOVE AL-UNBON               TO TYPEA
 13136                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 273
* EL689.cbl
 13137                GO TO 8200-SEND-DATAONLY
 13138            ELSE
 13139                MOVE ER-2114                TO EMI-ERROR
 13140                MOVE -1                     TO ADDRSL
 13141                MOVE AL-UNBON               TO ADDRSA
 13142                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13143                GO TO 8200-SEND-DATAONLY.
 13144
 13145 6600-EXIT.
 13146     EXIT.
 13147 6620-GET-G-DATA.
 13148
 13149     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY.
 13150
 13151     IF  CO-RPTCD2 GREATER THAN SPACES
 13152         MOVE SPACES             TO W-COMP-RESP-PERSON
 13153         MOVE CO-RPTCD2          TO W-COMP-WORK-AREA
 13154         MOVE +10                TO W-CWA-NDX
 13155         PERFORM 6622-FIND-LAST-NON-SPACE
 13156         SET W-COMP-NDX          TO +10
 13157         PERFORM 6625-FILL-IN-RESP-PERSON.
 13158         INSPECT W-COMP-RESP-PERSON CONVERTING SPACES TO ZEROS.
 13159
 13160     MOVE LOW-VALUES             TO W-COMP-ACCOUNT.
 13161     MOVE 'G'                    TO W-COMP-TYPE.
 13162     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 13163
 13164
 13165* EXEC CICS RESETBR
 13166*         RIDFLD  (W-COMP-KEY)
 13167*         DATASET (W-COMP-FILE-ID)
 13168*    END-EXEC.
 13169     MOVE 0
 13170       TO DFHEIV11
 13171*    MOVE '&4         G          &   #00012526' TO DFHEIV0
 13172     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 13173     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13174     MOVE X'2020233030303132353236' TO DFHEIV0(25:11)
 13175     CALL 'kxdfhei1' USING DFHEIV0,
 13176           W-COMP-FILE-ID,
 13177           W-COMP-KEY,
 13178           DFHEIV99,
 13179           DFHEIV11,
 13180           DFHEIV99
 13181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13182
 13183
 13184
 13185* EXEC CICS READNEXT
 13186*         DATASET (W-COMP-FILE-ID)
 13187*         SET     (ADDRESS OF COMPENSATION-MASTER)
 13188*         RIDFLD  (W-COMP-KEY)
 13189*    END-EXEC.
 13190     MOVE 0
 13191       TO DFHEIV11
 13192*    MOVE '&.S                   )   #00012531' TO DFHEIV0
 13193     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13194     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 274
* EL689.cbl
 13195     MOVE X'2020233030303132353331' TO DFHEIV0(25:11)
 13196     CALL 'kxdfhei1' USING DFHEIV0,
 13197           W-COMP-FILE-ID,
 13198           DFHEIV20,
 13199           DFHEIV99,
 13200           W-COMP-KEY,
 13201           DFHEIV99,
 13202           DFHEIV11,
 13203           DFHEIV99,
 13204           DFHEIV99
 13205     SET ADDRESS OF COMPENSATION-MASTER TO
 13206         DFHEIV20
 13207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13208
 13209
 13210     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 13211         GO TO 6620-EXIT.
 13212
 13213     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13214     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 13215     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 13216     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 13217     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 13218*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 13219     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 13220        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 13221     END-STRING
 13222
 13223     MOVE CO-ZIP                 TO W-WORK-ZIP.
 13224
 13225     IF  CO-CANADIAN-POST-CODE
 13226         MOVE CO-CANADIAN-POSTAL-CODE
 13227                                 TO W-CANADIAN-POSTAL-CODES
 13228         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13229         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13230         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13231                                    W-LAB-CAN-FILLER (6)
 13232     ELSE
 13233         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13234         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13235             MOVE '-'            TO W-LABEL-DASH (6)
 13236             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13237         ELSE
 13238             MOVE SPACES         TO W-LABEL-DASH (6)
 13239                                    W-LABEL-2ND-ZIP (6).
 13240
 13241     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13242
 13243     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (174).
 13244     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (175).
 13245     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (176).
 13246     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (177).
 13247     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (178).
 13248     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (179).
 13249
 13250 6620-EXIT.
 13251     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 275
* EL689.cbl
 13253 6622-FIND-LAST-NON-SPACE.
 13254
 13255     IF  W-CWA-CHAR (W-CWA-NDX) EQUAL SPACES
 13256         SUBTRACT +1 FROM W-CWA-NDX
 13257         GO TO 6622-FIND-LAST-NON-SPACE.
 13258
 13259 6622-EXIT.
 13260     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 276
* EL689.cbl
 13262 6625-FILL-IN-RESP-PERSON.
 13263
 13264     MOVE W-CWA-CHAR (W-CWA-NDX) TO W-COMP-RP-CHAR (W-COMP-NDX)
 13265     SET W-COMP-NDX DOWN BY +1.
 13266     SUBTRACT +1 FROM W-CWA-NDX.
 13267
 13268     IF  W-CWA-NDX GREATER THAN ZEROS
 13269         GO TO 6625-FILL-IN-RESP-PERSON.
 13270
 13271 6625-EXIT.
 13272     EXIT.
 13273 6626-GET-B-DATA.
 13274     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY
 13275     IF W-FILE-USED (8)
 13276        PERFORM 6450-READ-CERT-ONLY
 13277        IF W-CERT-FOUND
 13278           MOVE CM-BENEFICIARY (1:10)
 13279                                 TO W-COMP-RESP-PERSON
 13280        ELSE
 13281           MOVE SPACES           TO W-COMP-RESP-PERSON
 13282           GO TO 6626-EXIT
 13283        END-IF
 13284     ELSE
 13285        MOVE CM-BENEFICIARY (1:10)
 13286                                 TO W-COMP-RESP-PERSON
 13287     END-IF
 13288     MOVE LOW-VALUES             TO W-COMP-ACCOUNT
 13289     MOVE 'B'                    TO W-COMP-TYPE
 13290     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY
 13291
 13292
 13293* EXEC CICS RESETBR
 13294*         RIDFLD  (W-COMP-KEY)
 13295*         DATASET (W-COMP-FILE-ID)
 13296*    END-EXEC.
 13297     MOVE 0
 13298       TO DFHEIV11
 13299*    MOVE '&4         G          &   #00012619' TO DFHEIV0
 13300     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 13301     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13302     MOVE X'2020233030303132363139' TO DFHEIV0(25:11)
 13303     CALL 'kxdfhei1' USING DFHEIV0,
 13304           W-COMP-FILE-ID,
 13305           W-COMP-KEY,
 13306           DFHEIV99,
 13307           DFHEIV11,
 13308           DFHEIV99
 13309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13310
 13311
 13312
 13313* EXEC CICS READNEXT
 13314*         DATASET (W-COMP-FILE-ID)
 13315*         SET     (ADDRESS OF COMPENSATION-MASTER)
 13316*         RIDFLD  (W-COMP-KEY)
 13317*    END-EXEC.
 13318     MOVE 0
 13319       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 277
* EL689.cbl
 13320*    MOVE '&.S                   )   #00012624' TO DFHEIV0
 13321     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13322     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13323     MOVE X'2020233030303132363234' TO DFHEIV0(25:11)
 13324     CALL 'kxdfhei1' USING DFHEIV0,
 13325           W-COMP-FILE-ID,
 13326           DFHEIV20,
 13327           DFHEIV99,
 13328           W-COMP-KEY,
 13329           DFHEIV99,
 13330           DFHEIV11,
 13331           DFHEIV99,
 13332           DFHEIV99
 13333     SET ADDRESS OF COMPENSATION-MASTER TO
 13334         DFHEIV20
 13335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13336
 13337
 13338     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 13339         GO TO 6626-EXIT.
 13340
 13341     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13342     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 13343     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 13344     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 13345     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 13346*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 13347     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 13348        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 13349     END-STRING
 13350
 13351     MOVE CO-ZIP                 TO W-WORK-ZIP.
 13352
 13353     IF  CO-CANADIAN-POST-CODE
 13354         MOVE CO-CANADIAN-POSTAL-CODE
 13355                                 TO W-CANADIAN-POSTAL-CODES
 13356         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13357         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13358         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13359                                    W-LAB-CAN-FILLER (6)
 13360     ELSE
 13361         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13362         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13363             MOVE '-'            TO W-LABEL-DASH (6)
 13364             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13365         ELSE
 13366             MOVE SPACES         TO W-LABEL-DASH (6)
 13367                                    W-LABEL-2ND-ZIP (6).
 13368
 13369     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13370
 13371     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (184).
 13372     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (185).
 13373     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (186).
 13374     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (187).
 13375     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (188).
 13376     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (189).
 13377
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 278
* EL689.cbl
 13378 6626-EXIT.
 13379     EXIT.
 13380 6630-GET-CSR-NAME.
 13381
 13382     MOVE SPACES                 TO W-CNTL-KEY.
 13383     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 13384     MOVE +0                     TO W-CNTL-SEQ-NO.
 13385     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 13386     MOVE CO-CSR-CODE            TO W-CNTL-GENL.
 13387
 13388
 13389* EXEC CICS HANDLE CONDITION
 13390*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13391*         NOTFND     (6630-CNTL2-NOT-FOUND)
 13392*    END-EXEC.
 13393*    MOVE '"$JI                  ! 3 #00012680' TO DFHEIV0
 13394     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13396     MOVE X'3320233030303132363830' TO DFHEIV0(25:11)
 13397     CALL 'kxdfhei1' USING DFHEIV0
 13398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13399
 13400
 13401
 13402* EXEC CICS READ
 13403*         DATASET    (W-CNTL-FILE-ID)
 13404*         SET        (ADDRESS OF CONTROL-FILE)
 13405*         RIDFLD     (W-CNTL-KEY)
 13406*    END-EXEC.
 13407*    MOVE '&"S        E          (   #00012685' TO DFHEIV0
 13408     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13409     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13410     MOVE X'2020233030303132363835' TO DFHEIV0(25:11)
 13411     CALL 'kxdfhei1' USING DFHEIV0,
 13412           W-CNTL-FILE-ID,
 13413           DFHEIV20,
 13414           DFHEIV99,
 13415           W-CNTL-KEY,
 13416           DFHEIV99,
 13417           DFHEIV99,
 13418           DFHEIV99
 13419     SET ADDRESS OF CONTROL-FILE TO
 13420         DFHEIV20
 13421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13422
 13423
 13424     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (148).
 13425     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 13426     GO TO 6630-EXIT.
 13427
 13428 6630-CNTL2-NOT-FOUND.
 13429
 13430*    MOVE ER-8965                TO EMI-ERROR.
 13431*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13432*    MOVE -1                     TO MAINTL.
 13433*    MOVE AL-UANON               TO MAINTA.
 13434*    GO TO 8200-SEND-DATAONLY
 13435     .
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 279
* EL689.cbl
 13436 6630-EXIT.
 13437     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 280
* EL689.cbl
 13439 6700-GET-MAIL-DATA.
 13440
 13441     IF  ADDRSI EQUAL '5'
 13442             AND
 13443         PI-CREATE-LABELS
 13444             AND
 13445         NOT PI-689-LABELS-OVERRIDEN
 13446         NEXT SENTENCE
 13447     ELSE
 13448         IF  W-FILE-NOT-USED (5)
 13449             GO TO 6700-EXIT.
 13450
 13451     IF  W-MAIL-CERT-NO EQUAL LOW-VALUES
 13452         MOVE ER-9327            TO EMI-ERROR
 13453         MOVE -1                 TO MAINTL
 13454         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13455         GO TO 6700-EXIT.
 13456
 13457
 13458* EXEC CICS HANDLE CONDITION
 13459*         NOTOPEN (8090-MAIL-NOT-OPEN)
 13460*         NOTFND  (6700-MAIL-NOT-FOUND)
 13461*    END-EXEC.
 13462*    MOVE '"$JI                  ! 4 #00012724' TO DFHEIV0
 13463     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13464     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13465     MOVE X'3420233030303132373234' TO DFHEIV0(25:11)
 13466     CALL 'kxdfhei1' USING DFHEIV0
 13467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13468
 13469
 13470
 13471* EXEC CICS READ
 13472*         DATASET(W-MAIL-FILE-ID)
 13473*         SET    (ADDRESS OF MAILING-DATA)
 13474*         RIDFLD (W-MAIL-KEY)
 13475*    END-EXEC.
 13476*    MOVE '&"S        E          (   #00012729' TO DFHEIV0
 13477     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13478     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13479     MOVE X'2020233030303132373239' TO DFHEIV0(25:11)
 13480     CALL 'kxdfhei1' USING DFHEIV0,
 13481           W-MAIL-FILE-ID,
 13482           DFHEIV20,
 13483           DFHEIV99,
 13484           W-MAIL-KEY,
 13485           DFHEIV99,
 13486           DFHEIV99,
 13487           DFHEIV99
 13488     SET ADDRESS OF MAILING-DATA TO
 13489         DFHEIV20
 13490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13491
 13492
 13493     MOVE MA-INSURED-LAST-NAME   TO W-NAME-LAST.
 13494     MOVE MA-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13495     MOVE MA-INSURED-MIDDLE-INIT TO W-NAME-MIDDLE.
 13496     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 281
* EL689.cbl
 13497
 13498     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13499     MOVE WS-NAME-WORK           TO W-LABEL-LINES (1).
 13500     MOVE W-LABEL-JOINT-NAME     TO W-LABEL-LINES (2).
 13501     MOVE MA-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 13502     MOVE MA-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 13503*    MOVE MA-CITY-STATE          TO W-LABEL-LINES (5).
 13504     STRING MA-CITY ' ' MA-ADDR-STATE
 13505        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 13506     END-STRING
 13507
 13508     MOVE MA-ZIP                 TO W-WORK-ZIP.
 13509     MOVE SPACES                 TO W-LABEL-ZIP (6).
 13510
 13511     IF  MA-CANADIAN-POST-CODE
 13512         MOVE MA-CANADIAN-POSTAL-CODE
 13513                                 TO W-CANADIAN-POSTAL-CODES
 13514         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13515         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13516         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13517                                    W-LAB-CAN-FILLER (6)
 13518     ELSE
 13519         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13520         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13521             MOVE '-'            TO W-LABEL-DASH (6)
 13522             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13523         ELSE
 13524             MOVE SPACES         TO W-LABEL-DASH (6)
 13525                                    W-LABEL-2ND-ZIP (6).
 13526
 13527     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13528
 13529     IF  ADDRSI EQUAL '5'
 13530             AND
 13531         PI-CREATE-LABELS
 13532             AND
 13533         NOT PI-689-LABELS-OVERRIDEN
 13534         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13535                                    W-VG-TEXT (31)
 13536         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13537                                    W-VG-TEXT (32)
 13538         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13539                                    W-VG-TEXT (33)
 13540         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13541                                    W-VG-TEXT (34)
 13542         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13543                                    W-VG-TEXT (35)
 13544         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13545                                    W-VG-TEXT (36)
 13546         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13547         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13548         SET W-RG-NDX UP BY +1
 13549     ELSE
 13550         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (31)
 13551         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (32)
 13552         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (33)
 13553         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (34)
 13554         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (35)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 282
* EL689.cbl
 13555         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (36).
 13556     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13557     MOVE MA-CRED-BENE-NAME      TO W-LABEL-LINES (1)
 13558     MOVE MA-CRED-BENE-ADDR      TO W-LABEL-LINES (2)
 13559     MOVE MA-CRED-BENE-ADDR2     TO W-LABEL-LINES (3)
 13560     STRING MA-CRED-BENE-CITY ' ' MA-CRED-BENE-STATE
 13561        DELIMITED BY '  ' INTO W-LABEL-LINES (4)
 13562     END-STRING
 13563
 13564     MOVE MA-CRED-BENE-ZIP       TO W-WORK-ZIP
 13565     MOVE SPACES                 TO W-LABEL-ZIP (5)
 13566
 13567     IF  MA-CB-CANADIAN-POST-CODE
 13568         MOVE MA-CB-CANADIAN-POSTAL-CODE
 13569                                 TO W-CANADIAN-POSTAL-CODES
 13570         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 13571         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 13572         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 13573                                    W-LAB-CAN-FILLER (5)
 13574     ELSE
 13575         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 13576         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13577             MOVE '-'            TO W-LABEL-DASH (5)
 13578             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 13579         ELSE
 13580             MOVE SPACES         TO W-LABEL-DASH (5)
 13581                                    W-LABEL-2ND-ZIP (5)
 13582         END-IF
 13583     END-IF
 13584     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT
 13585     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (37)
 13586     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (50)
 13587     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (51)
 13588     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (52)
 13589     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (53)
 13590     GO TO 6700-EXIT.
 13591
 13592 6700-MAIL-NOT-FOUND.
 13593
 13594     IF  ADDRSL GREATER ZERO
 13595         IF ADDRSI = '5'
 13596            MOVE ER-3000         TO EMI-ERROR
 13597            MOVE -1              TO ADDRSL
 13598            MOVE AL-UNBON        TO ADDRSA
 13599            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13600            GO TO 8200-SEND-DATAONLY.
 13601
 13602 6700-EXIT.
 13603     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 283
* EL689.cbl
 13605 6750-GET-LIFE-BENEFIT-DATA.
 13606
 13607     IF  W-FILE-NOT-USED (2)
 13608         GO TO 6750-EXIT.
 13609
 13610     MOVE SPACES                 TO W-CNTL-GEN2.
 13611
 13612     IF  DATASORI EQUAL '2'
 13613         IF  W-FILE-NOT-USED (8)
 13614             PERFORM 6450-READ-CERT-ONLY
 13615             IF  W-CERT-FOUND
 13616                 MOVE CM-LF-BENEFIT-CD
 13617                                 TO W-BEN-HOLD
 13618                                    W-CNTL-GEN2
 13619             ELSE
 13620                 NEXT SENTENCE
 13621         ELSE
 13622             MOVE CM-LF-BENEFIT-CD
 13623                                 TO W-BEN-HOLD
 13624                                    W-CNTL-GEN2
 13625     ELSE
 13626         IF  DATASORI EQUAL '4'
 13627             IF  W-FILE-NOT-USED (9)
 13628                 PERFORM 6400-READ-PNDB-ONLY
 13629                 IF  W-PNDB-FOUND
 13630                     IF  PI-689-TYPE = '1'
 13631                         MOVE PB-I-LF-BENEFIT-CD
 13632                                 TO W-BEN-HOLD
 13633                                    W-CNTL-GEN2
 13634                     ELSE
 13635                         MOVE PB-CI-LF-BENEFIT-CD
 13636                                 TO W-BEN-HOLD
 13637                                    W-CNTL-GEN2
 13638             ELSE
 13639                 NEXT SENTENCE
 13640         ELSE
 13641             IF  W-FILE-USED (8)
 13642                 MOVE CM-LF-BENEFIT-CD
 13643                                 TO W-BEN-HOLD
 13644                                    W-CNTL-GEN2
 13645             ELSE
 13646                 IF  W-FILE-USED (9)
 13647                     IF  PI-689-TYPE = '1'
 13648                         MOVE PB-I-LF-BENEFIT-CD
 13649                                 TO W-BEN-HOLD
 13650                                    W-CNTL-GEN2
 13651                     ELSE
 13652                         MOVE PB-CI-LF-BENEFIT-CD
 13653                                 TO W-BEN-HOLD
 13654                                    W-CNTL-GEN2.
 13655
 13656     IF  W-CNTL-GEN2 EQUAL SPACES
 13657         MOVE ER-9327            TO EMI-ERROR
 13658         MOVE -1                 TO MAINTL
 13659         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13660         GO TO 6750-EXIT.
 13661
 13662     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 284
* EL689.cbl
 13663     MOVE '4'                    TO W-CNTL-RECORD-TYPE.
 13664     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 13665
 13666
 13667* EXEC CICS HANDLE CONDITION
 13668*         NOTOPEN (8040-CNTL-NOT-OPEN)
 13669*         NOTFND  (6750-EXIT)
 13670*    END-EXEC.
 13671*    MOVE '"$JI                  ! 5 #00012908' TO DFHEIV0
 13672     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13673     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13674     MOVE X'3520233030303132393038' TO DFHEIV0(25:11)
 13675     CALL 'kxdfhei1' USING DFHEIV0
 13676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13677
 13678
 13679
 13680* EXEC CICS READ
 13681*         DATASET (W-CNTL-FILE-ID)
 13682*         SET     (ADDRESS OF CONTROL-FILE)
 13683*         GTEQ
 13684*         RIDFLD  (W-CNTL-KEY)
 13685*    END-EXEC.
 13686*    MOVE '&"S        G          (   #00012913' TO DFHEIV0
 13687     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13688     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13689     MOVE X'2020233030303132393133' TO DFHEIV0(25:11)
 13690     CALL 'kxdfhei1' USING DFHEIV0,
 13691           W-CNTL-FILE-ID,
 13692           DFHEIV20,
 13693           DFHEIV99,
 13694           W-CNTL-KEY,
 13695           DFHEIV99,
 13696           DFHEIV99,
 13697           DFHEIV99
 13698     SET ADDRESS OF CONTROL-FILE TO
 13699         DFHEIV20
 13700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13701
 13702
 13703     MOVE 1                      TO W-NDX.
 13704
 13705 6750-LOOP.
 13706
 13707     IF  W-NDX = 9
 13708         GO TO 6750-EXIT.
 13709
 13710     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 13711         ADD 1                   TO W-NDX
 13712         GO TO 6750-LOOP.
 13713
 13714     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 13715         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 13716                                 TO W-VG-TEXT (11).
 13717
 13718 6750-EXIT.
 13719     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 285
* EL689.cbl
 13721 6800-GET-A-H-BENEFIT-DATA.
 13722
 13723     IF  W-FILE-NOT-USED (3)
 13724         GO TO 6800-EXIT.
 13725
 13726     MOVE SPACES                 TO W-CNTL-GEN2.
 13727
 13728     IF  DATASORI EQUAL '2'
 13729         IF  W-FILE-NOT-USED (8)
 13730             PERFORM 6450-READ-CERT-ONLY
 13731             IF  W-CERT-FOUND
 13732                 MOVE CM-AH-BENEFIT-CD
 13733                                 TO W-BEN-HOLD
 13734                                    W-CNTL-GEN2
 13735             ELSE
 13736                 NEXT SENTENCE
 13737         ELSE
 13738             MOVE CM-AH-BENEFIT-CD
 13739                                 TO W-BEN-HOLD
 13740                                    W-CNTL-GEN2
 13741     ELSE
 13742         IF  DATASORI EQUAL '4'
 13743             IF  W-FILE-NOT-USED (9)
 13744                 PERFORM 6400-READ-PNDB-ONLY
 13745                 IF  W-PNDB-FOUND
 13746                     IF  PI-689-TYPE = '1'
 13747                         MOVE PB-I-AH-BENEFIT-CD
 13748                                 TO W-BEN-HOLD
 13749                                    W-CNTL-GEN2
 13750                     ELSE
 13751                         MOVE PB-CI-AH-BENEFIT-CD
 13752                                 TO W-BEN-HOLD
 13753                                    W-CNTL-GEN2
 13754             ELSE
 13755                 NEXT SENTENCE
 13756         ELSE
 13757             IF  W-FILE-USED (8)
 13758                 MOVE CM-AH-BENEFIT-CD
 13759                                 TO W-BEN-HOLD
 13760                                    W-CNTL-GEN2
 13761             ELSE
 13762                 IF  W-FILE-USED (9)
 13763                     IF  PI-689-TYPE = '1'
 13764                         MOVE PB-I-AH-BENEFIT-CD
 13765                                 TO W-BEN-HOLD
 13766                                    W-CNTL-GEN2
 13767                     ELSE
 13768                         MOVE PB-CI-AH-BENEFIT-CD
 13769                                 TO W-BEN-HOLD
 13770                                    W-CNTL-GEN2.
 13771
 13772     IF  W-CNTL-GEN2 EQUAL SPACES
 13773         MOVE ER-9327            TO EMI-ERROR
 13774         MOVE -1                 TO MAINTL
 13775         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13776         GO TO 6800-EXIT.
 13777
 13778     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 286
* EL689.cbl
 13779     MOVE '5'                    TO W-CNTL-RECORD-TYPE.
 13780     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 13781
 13782
 13783* EXEC CICS HANDLE CONDITION
 13784*         NOTOPEN (8040-CNTL-NOT-OPEN)
 13785*         NOTFND  (6800-EXIT)
 13786*    END-EXEC.
 13787*    MOVE '"$JI                  ! 6 #00012999' TO DFHEIV0
 13788     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13789     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13790     MOVE X'3620233030303132393939' TO DFHEIV0(25:11)
 13791     CALL 'kxdfhei1' USING DFHEIV0
 13792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13793
 13794
 13795
 13796* EXEC CICS READ
 13797*         DATASET (W-CNTL-FILE-ID)
 13798*         SET     (ADDRESS OF CONTROL-FILE)
 13799*         RIDFLD  (W-CNTL-KEY)
 13800*         GTEQ
 13801*    END-EXEC.
 13802*    MOVE '&"S        G          (   #00013004' TO DFHEIV0
 13803     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13804     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13805     MOVE X'2020233030303133303034' TO DFHEIV0(25:11)
 13806     CALL 'kxdfhei1' USING DFHEIV0,
 13807           W-CNTL-FILE-ID,
 13808           DFHEIV20,
 13809           DFHEIV99,
 13810           W-CNTL-KEY,
 13811           DFHEIV99,
 13812           DFHEIV99,
 13813           DFHEIV99
 13814     SET ADDRESS OF CONTROL-FILE TO
 13815         DFHEIV20
 13816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13817
 13818
 13819     MOVE 1                      TO W-NDX.
 13820
 13821 6800-LOOP-AH.
 13822
 13823     IF  W-NDX = 9
 13824         GO TO 6800-EXIT.
 13825
 13826     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 13827         ADD 1                   TO W-NDX
 13828         GO TO 6800-LOOP-AH.
 13829
 13830     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 13831         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 13832                                 TO W-VG-TEXT (15)
 13833         MOVE CF-BENEFIT-ALPHA (W-NDX)
 13834                                 TO W-BENEFIT-WORK
 13835         MOVE W-ELIM-DAYS        TO W-VG-TEXT (16).
 13836
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 287
* EL689.cbl
 13837 6800-EXIT.
 13838     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 288
* EL689.cbl
 13840 6850-GET-CHECK-DATA.
 13841
 13842     IF  ADDRSI EQUAL '6'
 13843             AND
 13844         PI-CREATE-LABELS
 13845             AND
 13846         NOT PI-689-LABELS-OVERRIDEN
 13847         NEXT SENTENCE
 13848     ELSE
 13849         IF  W-FILE-NOT-USED (12)
 13850             GO TO 6850-EXIT.
 13851
 13852     IF  W-CHEK-CERT-NO EQUAL LOW-VALUES
 13853         MOVE ER-9327            TO EMI-ERROR
 13854         MOVE -1                 TO MAINTL
 13855         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13856         GO TO 6850-EXIT.
 13857
 13858
 13859* EXEC CICS HANDLE CONDITION
 13860*         NOTOPEN (8045-CHEK-NOT-OPEN)
 13861*         NOTFND  (6850-CHEK-NOT-FOUND)
 13862*    END-EXEC.
 13863*    MOVE '"$JI                  ! 7 #00013050' TO DFHEIV0
 13864     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13865     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13866     MOVE X'3720233030303133303530' TO DFHEIV0(25:11)
 13867     CALL 'kxdfhei1' USING DFHEIV0
 13868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13869
 13870
 13871
 13872* EXEC CICS READ
 13873*         DATASET (W-CHEK-FILE-ID)
 13874*         SET     (ADDRESS OF CHECK-RECORDS)
 13875*         RIDFLD  (W-CHEK-KEY)
 13876*    END-EXEC.
 13877*    MOVE '&"S        E          (   #00013055' TO DFHEIV0
 13878     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13879     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13880     MOVE X'2020233030303133303535' TO DFHEIV0(25:11)
 13881     CALL 'kxdfhei1' USING DFHEIV0,
 13882           W-CHEK-FILE-ID,
 13883           DFHEIV20,
 13884           DFHEIV99,
 13885           W-CHEK-KEY,
 13886           DFHEIV99,
 13887           DFHEIV99,
 13888           DFHEIV99
 13889     SET ADDRESS OF CHECK-RECORDS TO
 13890         DFHEIV20
 13891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13892
 13893
 13894     MOVE CH-CHECK-NO            TO W-VG-TEXT (158).
 13895     MOVE CH-AMOUNT-PAID         TO W-EDIT-7-2.
 13896     MOVE W-EDIT-7-2             TO W-VG-TEXT (157).
 13897     MOVE CH-CHECK-QUE-CONTROL   TO W-DISPLAY-8
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 289
* EL689.cbl
 13898                                    PI-689-CONTROL.
 13899     MOVE W-DISPLAY-8            TO W-VG-TEXT (165).
 13900     MOVE CH-REASON-FOR-CHECK    TO W-VG-TEXT (166).
 13901
 13902     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13903     MOVE CH-PAYEE-NAME-1        TO W-LABEL-LINES (1).
 13904     MOVE CH-PAYEE-NAME-2        TO W-LABEL-LINES (2).
 13905     MOVE CH-PAYEE-ADDRESS-1     TO W-LABEL-LINES (3).
 13906     MOVE CH-PAYEE-ADDRESS-2     TO W-LABEL-LINES (4).
 13907     MOVE CH-PAYEE-CITY-ST       TO W-LABEL-LINES (5).
 13908
 13909     MOVE CH-PAYEE-ZIP           TO W-WORK-ZIP.
 13910     MOVE SPACES                 TO W-LABEL-ZIP (6).
 13911
 13912     IF  CH-CANADIAN-POST-CODE
 13913         MOVE CH-CANADIAN-POSTAL-CODE
 13914                                 TO W-CANADIAN-POSTAL-CODES
 13915         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13916         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13917         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13918                                    W-LAB-CAN-FILLER (6)
 13919     ELSE
 13920         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13921         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13922             MOVE '-'            TO W-LABEL-DASH (6)
 13923             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13924         ELSE
 13925             MOVE SPACES         TO W-LABEL-DASH (6)
 13926                                    W-LABEL-2ND-ZIP (6).
 13927
 13928     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13929
 13930     IF  ADDRSI EQUAL '6'
 13931             AND
 13932         PI-CREATE-LABELS
 13933             AND
 13934         NOT PI-689-LABELS-OVERRIDEN
 13935         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13936                                    W-VG-TEXT (159)
 13937         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13938                                    W-VG-TEXT (160)
 13939         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13940                                    W-VG-TEXT (161)
 13941         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13942                                    W-VG-TEXT (162)
 13943         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13944                                    W-VG-TEXT (163)
 13945         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13946                                    W-VG-TEXT (164)
 13947         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13948         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13949         SET W-RG-NDX UP BY +1
 13950     ELSE
 13951         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (159)
 13952         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (160)
 13953         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (161)
 13954         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (162)
 13955         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (163)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 290
* EL689.cbl
 13956         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (164).
 13957
 13958     GO TO 6850-EXIT.
 13959
 13960 6850-CHEK-NOT-FOUND.
 13961
 13962     IF  ADDRSL GREATER ZERO
 13963         IF ADDRSI = '6'
 13964            MOVE ER-2908         TO EMI-ERROR
 13965            MOVE -1              TO ADDRSL
 13966            MOVE AL-UNBON        TO ADDRSA
 13967            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13968            GO TO 8200-SEND-DATAONLY.
 13969
 13970 6850-EXIT.
 13971     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 291
* EL689.cbl
 13973 6900-GET-PYAJ-DATA.
 13974
 13975     IF  W-FILE-NOT-USED (13)
 13976         GO TO 6900-EXIT.
 13977
 13978     IF  W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 13979         MOVE ER-9327            TO EMI-ERROR
 13980         MOVE -1                 TO MAINTL
 13981         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13982         GO TO 6900-EXIT.
 13983
 13984
 13985* EXEC CICS HANDLE CONDITION
 13986*         NOTOPEN (8085-PYAJ-NOT-OPEN)
 13987*         NOTFND  (6900-PYAJ-NOT-FOUND)
 13988*    END-EXEC.
 13989*    MOVE '"$JI                  ! 8 #00013151' TO DFHEIV0
 13990     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13991     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13992     MOVE X'3820233030303133313531' TO DFHEIV0(25:11)
 13993     CALL 'kxdfhei1' USING DFHEIV0
 13994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13995
 13996
 13997 6900-READ-NEXT.
 13998
 13999
 14000* EXEC CICS READ
 14001*         DATASET (W-PYAJ-FILE-ID)
 14002*         SET     (ADDRESS OF PENDING-PAY-ADJ)
 14003*         RIDFLD  (W-PYAJ-KEY)
 14004*         GTEQ
 14005*    END-EXEC.
 14006*    MOVE '&"S        G          (   #00013158' TO DFHEIV0
 14007     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14008     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14009     MOVE X'2020233030303133313538' TO DFHEIV0(25:11)
 14010     CALL 'kxdfhei1' USING DFHEIV0,
 14011           W-PYAJ-FILE-ID,
 14012           DFHEIV20,
 14013           DFHEIV99,
 14014           W-PYAJ-KEY,
 14015           DFHEIV99,
 14016           DFHEIV99,
 14017           DFHEIV99
 14018     SET ADDRESS OF PENDING-PAY-ADJ TO
 14019         DFHEIV20
 14020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14021
 14022
 14023     IF  PY-COMPANY-CD NOT EQUAL W-PYAJ-COMPANY-CD
 14024             OR
 14025         PY-CARRIER NOT EQUAL W-PYAJ-CARRIER
 14026             OR
 14027         PY-GROUPING NOT EQUAL W-PYAJ-GROUPING
 14028             OR
 14029         PY-FIN-RESP NOT EQUAL W-PYAJ-FIN-RESP
 14030             OR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 292
* EL689.cbl
 14031         PY-ACCOUNT NOT EQUAL W-PYAJ-ACCOUNT
 14032         GO TO 6900-PYAJ-NOT-FOUND.
 14033
 14034     IF  PI-689-SEQ-NO GREATER THAN ZEROS
 14035             AND
 14036         PY-FILE-SEQ-NO NOT EQUAL PI-689-SEQ-NO
 14037         GO TO 6900-PYAJ-NOT-FOUND.
 14038
 14039     IF  PY-RECORD-TYPE NOT EQUAL W-PYAJ-RECORD-TYPE
 14040         MOVE PY-CONTROL-PRIMARY TO W-PYAJ-KEY
 14041         ADD +1                  TO W-PYAJ-FILE-SEQ-NO
 14042         GO TO 6900-READ-NEXT.
 14043
 14044     MOVE PY-CHECK-NUMBER        TO W-DISPLAY-7.
 14045     MOVE W-DISPLAY-7            TO W-VG-TEXT (171).
 14046
 14047     MOVE PY-ENTRY-AMT           TO W-EDIT-7-2.
 14048     MOVE W-EDIT-7-2             TO W-VG-TEXT (170).
 14049
 14050     MOVE PY-CHECK-QUE-CONTROL   TO W-DISPLAY-8
 14051                                    PI-689-CONTROL.
 14052     MOVE W-DISPLAY-8            TO W-VG-TEXT (172).
 14053     MOVE PY-ENTRY-COMMENT       TO W-VG-TEXT (173).
 14054
 14055     GO TO 6900-EXIT.
 14056
 14057 6900-PYAJ-NOT-FOUND.
 14058
 14059     MOVE ER-7395                TO EMI-ERROR
 14060     MOVE -1                     TO DATASORL
 14061     MOVE AL-UNBON               TO DATASORA
 14062     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14063     GO TO 8200-SEND-DATAONLY.
 14064
 14065 6900-EXIT.
 14066     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 293
* EL689.cbl
 14068 6950-MOVE-SYSTEM-DATA.
 14069
 14070     IF  W-FILE-NOT-USED (7)
 14071         GO TO 6950-EXIT.
 14072
 14073     MOVE EIBDATE                TO W-DATE-WORK.
 14074     MOVE W-DT-WORK              TO DC-JULIAN-YYDDD.
 14075     MOVE '5'                    TO DC-OPTION-CODE.
 14076     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 14077     MOVE DC-GREG-DATE-1-EDIT    TO W-VG-TEXT (60).
 14078     MOVE DC-GREG-DATE-1-ALPHA   TO W-VG-TEXT (61).
 14079
 14080     MOVE FORMI                  TO W-VG-TEXT (62).
 14081
 14082     IF  PI-689-VARIABLE-DATA-1 GREATER THAN SPACES
 14083         MOVE PI-689-VARIABLE-DATA-1
 14084                                 TO W-VG-TEXT (63)
 14085         MOVE PI-689-VARIABLE-DATA-2
 14086                                 TO W-VG-TEXT (64)
 14087         MOVE PI-689-VARIABLE-DATA-3
 14088                                 TO W-VG-TEXT (65)
 14089         MOVE PI-689-VARIABLE-DATA-4
 14090                                 TO W-VG-TEXT (66)
 14091     ELSE
 14092         MOVE '(VARIABLE NOT PROVIDED)'
 14093                                 TO W-VG-TEXT (63).
 14094
 14095 6950-EXIT.
 14096     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 294
* EL689.cbl
 14098 7000-FORMAT-SCREEN.
 14099
 14100     IF  MAINTI EQUAL 'S'
 14101             OR
 14102         PI-SHOW-MODE
 14103         MOVE AL-PANOF           TO W-SC-TEXTA (W-SC-NDX)
 14104     ELSE
 14105         MOVE AL-UANOF           TO W-SC-TEXTA (W-SC-NDX).
 14106
 14107     IF  W-RG-NDX NOT GREATER THAN PI-689-NUMBER-LABEL-LINES
 14108         SET W-LINE23            TO W-RG-NDX
 14109         MOVE 'A'                TO W-LINE1
 14110     ELSE
 14111         SET W-LIN-NUM           TO W-RG-NDX
 14112         COMPUTE W-LIN-NUM
 14113             = W-LIN-NUM - PI-689-NUMBER-LABEL-LINES - 1.
 14114
 14115     MOVE W-LINE-NUM             TO W-SC-LINE (W-SC-NDX).
 14116     MOVE W-RC-TEXT (W-RG-NDX)   TO W-SC-TEXT (W-SC-NDX).
 14117     SET W-RG-NDX UP BY 1.
 14118
 14119 7000-EXIT.
 14120      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 295
* EL689.cbl
 14122 7100-FORMAT-LAST-NAME-1ST.
 14123*****************************************************************
 14124*             M O V E   N A M E   R O U T I N E                 *
 14125*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14126*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14127*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14128*                  FIELD                   VALUE                *
 14129*           W-NAME-LAST    (CL15)      SMITH                    *
 14130*           W-NAME-FIRST   (CL15)      JOHN                     *
 14131*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 14132*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14133*     CONTAIN                                                   *
 14134*                SMITH, JOHN ALLEN                              *
 14135*     OR                                                        *
 14136*                SMITH, JOHN A.                                 *
 14137*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14138*     COPYBOOK, ELCNWA.                                         *
 14139*****************************************************************.
 14140
 14141     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 14142     MOVE ZERO                   TO WS-NAME-SW.
 14143     SET NWA-INDEX               TO +1.
 14144
 14145     IF  W-NAME-LAST EQUAL SPACES
 14146             AND
 14147         W-NAME-MIDDLE EQUAL SPACES
 14148         MOVE +1                 TO WS-NAME-SW.
 14149
 14150     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14151     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 14152
 14153     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14154     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 14155
 14156     SET NWA-INDEX UP BY +1.
 14157
 14158     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 14159         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 14160             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14161             SET NWA-INDEX UP BY +1
 14162             MOVE '.'            TO WS-NW (NWA-INDEX)
 14163             SET NWA-INDEX UP BY +2
 14164         ELSE
 14165             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14166             PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 14167
 14168 7100-EXIT.
 14169     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 296
* EL689.cbl
 14171 7110-MOVE-NAME.
 14172
 14173     IF  WS-NAME-SW GREATER THAN +1
 14174         GO TO 7110-EXIT.
 14175
 14176     IF  WS-NAME-WORK2 = SPACES
 14177         GO TO 7110-EXIT.
 14178
 14179     SET NWA-INDEX2            TO +1.
 14180     SET NWA-INDEX3            TO +2.
 14181
 14182 7110-MOVE-NAME-CYCLE.
 14183
 14184     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 14185
 14186     IF  NWA-INDEX LESS THAN +30
 14187         SET NWA-INDEX UP BY +1
 14188     ELSE
 14189         ADD +2                TO WS-NAME-SW
 14190         GO TO 7110-EXIT.
 14191
 14192     IF  NWA-INDEX2 LESS THAN +20
 14193         SET NWA-INDEX3 UP BY +1
 14194         SET NWA-INDEX2 UP BY +1.
 14195
 14196     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 14197             AND
 14198         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 14199         IF  WS-NAME-SW EQUAL ZERO
 14200             MOVE ','            TO WS-NW (NWA-INDEX)
 14201             SET NWA-INDEX UP BY +2
 14202             MOVE +1             TO WS-NAME-SW
 14203             GO TO 7110-EXIT
 14204         ELSE
 14205             GO TO 7110-EXIT.
 14206
 14207     GO TO 7110-MOVE-NAME-CYCLE.
 14208
 14209 7110-EXIT.
 14210     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 297
* EL689.cbl
 14212 7200-FORMAT-NAME-STRAIGHT.
 14213*****************************************************************
 14214*           M O V E   N A M E   R O U T I N E                   *
 14215*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14216*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14217*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14218*                  FIELD                   VALUE                *
 14219*           W-NAME-LAST    (CL15)      SMITH                    *
 14220*           W-NAME-FIRST   (CL15)      JOHN                     *
 14221*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 14222*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14223*     CONTAIN                                                   *
 14224*              JOHN A. SMITH                                    *
 14225*     OR                                                        *
 14226*              JOHN ALLEN SMITH                                 *
 14227*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14228*     COPYBOOK, ELCNWA.                                         *
 14229*****************************************************************
 14230
 14231     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 14232     MOVE ZERO                   TO WS-NAME-SW.
 14233     SET NWA-INDEX               TO +1.
 14234
 14235     IF  W-NAME-FIRST EQUAL SPACES
 14236             AND
 14237         W-NAME-MIDDLE EQUAL SPACES
 14238         MOVE W-NAME-LAST        TO WS-NAME-WORK
 14239         GO TO 7200-EXIT.
 14240
 14241     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14242     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 14243
 14244     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 14245         SET NWA-INDEX UP BY +1
 14246
 14247         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 14248             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14249             SET NWA-INDEX UP BY +1
 14250             MOVE '.'            TO WS-NW (NWA-INDEX)
 14251             SET NWA-INDEX UP BY +1
 14252
 14253         ELSE
 14254             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14255             PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 14256
 14257     SET NWA-INDEX UP BY +1
 14258     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14259     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 14260
 14261 7200-EXIT.
 14262     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 298
* EL689.cbl
 14264 7290-MOVE-NAME.
 14265
 14266     IF  WS-NAME-SW GREATER THAN +1
 14267         GO TO 7290-EXIT.
 14268
 14269     IF  WS-NAME-WORK2 EQUAL SPACES
 14270         GO TO 7290-EXIT.
 14271
 14272     SET NWA-INDEX2            TO +1.
 14273     SET NWA-INDEX3            TO +2.
 14274
 14275 7290-MOVE-NAME-CYCLE.
 14276
 14277     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 14278
 14279     IF  NWA-INDEX LESS THAN +30
 14280         SET NWA-INDEX UP BY +1
 14281     ELSE
 14282         ADD +2                TO WS-NAME-SW
 14283         GO TO 7290-EXIT.
 14284
 14285     IF  NWA-INDEX2 LESS THAN +20
 14286         SET NWA-INDEX2 UP BY +1
 14287         SET NWA-INDEX3 UP BY +1.
 14288
 14289     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 14290             AND
 14291         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 14292         GO TO 7290-EXIT.
 14293
 14294     GO TO 7290-MOVE-NAME-CYCLE.
 14295
 14296 7290-EXIT.
 14297     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 299
* EL689.cbl
 14299 7300-LABEL-MOVE.
 14300
 14301     IF  W-LABEL-HOLD-AREA = SPACES
 14302         MOVE +0                 TO W-NUMB-LABEL-LINES
 14303         GO TO 7300-EXIT.
 14304
 14305     IF  W-LABEL-LINES (1) = SPACES
 14306         MOVE W-LABEL-LINES (2)  TO W-LABEL-LINES (1)
 14307         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 14308         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 14309         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 14310         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14311         MOVE SPACES             TO W-LABEL-LINES (6)
 14312         GO TO 7300-LABEL-MOVE.
 14313
 14314     IF  W-LABEL-LINES (2) = SPACES
 14315             AND
 14316         W-LABEL-LINES (3) = SPACES
 14317             AND
 14318         W-LABEL-LINES (4) = SPACES
 14319             AND
 14320         W-LABEL-LINES (5) = SPACES
 14321             AND
 14322         W-LABEL-LINES (6) = SPACES
 14323         MOVE 1                  TO W-NDX
 14324                                    W-NUMB-LABEL-LINES
 14325         GO TO 7300-EXIT.
 14326
 14327 7300-TRY-2.
 14328
 14329     IF  W-LABEL-LINES (2) = SPACES
 14330         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 14331         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 14332         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 14333         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14334         MOVE SPACES             TO W-LABEL-LINES (6)
 14335         GO TO 7300-TRY-2.
 14336
 14337     IF  W-LABEL-LINES (3) = SPACES
 14338             AND
 14339         W-LABEL-LINES (4) = SPACES
 14340             AND
 14341         W-LABEL-LINES (5) = SPACES
 14342             AND
 14343         W-LABEL-LINES (6) = SPACES
 14344         MOVE 2                  TO W-NDX
 14345         GO TO 7300-MOVE-ZIP.
 14346
 14347 7300-TRY-3.
 14348
 14349     IF  W-LABEL-LINES (3) = SPACES
 14350         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 14351         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 14352         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14353         MOVE SPACES             TO W-LABEL-LINES (6)
 14354         GO TO 7300-TRY-3.
 14355
 14356     IF  W-LABEL-LINES (4) = SPACES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 300
* EL689.cbl
 14357             AND
 14358         W-LABEL-LINES (5) = SPACES
 14359             AND
 14360         W-LABEL-LINES (6) = SPACES
 14361         MOVE 3                   TO W-NDX
 14362         GO TO 7300-MOVE-ZIP.
 14363
 14364 7300-TRY-4.
 14365
 14366     IF  W-LABEL-LINES (4) = SPACES
 14367         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 14368         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14369         MOVE SPACES             TO W-LABEL-LINES (6)
 14370         GO TO 7300-TRY-4.
 14371
 14372     IF  W-LABEL-LINES (5) = SPACES
 14373             AND
 14374         W-LABEL-LINES (6) = SPACES
 14375         MOVE 4                  TO W-NDX
 14376         GO TO 7300-MOVE-ZIP.
 14377
 14378 7300-TRY-5.
 14379
 14380     IF  W-LABEL-LINES (5) = SPACES
 14381         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 14382         MOVE SPACES             TO W-LABEL-LINES (6)
 14383         GO TO 7300-TRY-5
 14384     ELSE
 14385         IF  W-LABEL-LINES (6) = SPACES
 14386             MOVE 5              TO W-NDX
 14387             GO TO 7300-MOVE-ZIP
 14388         ELSE
 14389             MOVE 6              TO W-NDX.
 14390
 14391 7300-MOVE-ZIP.
 14392
 14393     COMPUTE W-NDX2 = W-NDX - 1.
 14394
 14395     IF  W-LAST-ZIP (W-NDX2) = SPACES
 14396*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 14397
 14398         IF  W-LABEL-1ST-ZIP (W-NDX) NUMERIC
 14399                 MOVE W-LABEL-ZIP (W-NDX)
 14400                                 TO W-LAST-ZIP (W-NDX2)
 14401                 MOVE SPACES     TO W-LABEL-LINES (W-NDX)
 14402                 MOVE W-NDX2     TO W-NUMB-LABEL-LINES
 14403                 GO TO 7300-EXIT.
 14404
 14405     MOVE W-NDX                  TO W-NUMB-LABEL-LINES.
 14406
 14407 7300-EXIT.
 14408     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 301
* EL689.cbl
 14410 7400-CREATE-LETTER.
 14411****************************************************************
 14412*    THIS AREA CONTROLS THE PROCESSING OF INDIVIDUAL INPUT     *
 14413*    RECORDS.                                                  *
 14414****************************************************************
 14415
 14416     SET W-SQ-NDX                TO W-START-COLUMN.
 14417     MOVE SPACES                 TO W-SQUEEZED-LINE
 14418                                    W-WORK-LINE.
 14419     MOVE W-START-COLUMN         TO W-LAST-SQUEEZED-SPACE
 14420     MOVE +1                     TO W-LAST-WC-SPACE.
 14421     MOVE HIGH-VALUES            TO W-LAST-SQ-CHAR.
 14422
 14423     SET W-TG-NDX                TO +1.
 14424
 14425     PERFORM 7410-TEXT-LINE-PROCESS THRU 7410-EXIT
 14426            VARYING
 14427         W-TG-NDX FROM W-TG-NDX BY +1
 14428            UNTIL
 14429         W-TG-NDX GREATER THAN W-TOTAL-TX-LINES.
 14430
 14431     IF  W-FORM-SQUEEZE-ON
 14432             AND
 14433         W-SQUEEZED-LINE GREATER THAN SPACES
 14434         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT.
 14435
 14436     PERFORM 7640-PAGING THRU 7640-EXIT.
 14437
 14438 7400-EXIT.
 14439     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 302
* EL689.cbl
 14441 7410-TEXT-LINE-PROCESS.
 14442***************************************************************
 14443*    THIS ROUTINE SEARCHES THE TEXT WORK AREA FOR ANY         *
 14444*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 14445*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 14446*    DATA THAT WAS GENERATED PREVIOUSLY.  WHILE PERFORMING    *
 14447*    THIS FUNCTION THE ROUTINE MOVES EACH CHARACTER OR ITS    *
 14448*    VARIABLE REPLACEMENT TO A WORK LINE.                     *
 14449***************************************************************
 14450
 14451
 14452     SET W-WC-NDX                TO W-ZEROS.
 14453     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 14454
 14455     MOVE W-TX-SC (W-TG-NDX)     TO W-LINE-SQUEEZE-IND.
 14456
 14457     PERFORM 7420-TEXT-CHAR-PROCESS THRU 7420-EXIT
 14458             VARYING
 14459         W-TX-NDX FROM +1 BY +1
 14460             UNTIL
 14461         W-TX-NDX GREATER THAN +70.
 14462
 14463****************************************************************
 14464*    IF SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS    *
 14465*    EACH LINE OF TEXT IS PROCESSED ACCORDING TO THE INDICATED *
 14466*    LINE SQUEEZE CONTROL.                                     *
 14467****************************************************************
 14468     IF  W-FORM-SQUEEZE-ON
 14469
 14470         IF  W-WORK-LINE GREATER THAN SPACES
 14471                 OR
 14472             W-AS-IS
 14473             PERFORM 7450-SQUEEZING THRU 7450-EXIT
 14474
 14475         ELSE
 14476             NEXT SENTENCE
 14477****************************************************************
 14478*    IF NO SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS *
 14479*    EACH LINE OF TEXT IS PRINT AS IS EXCEPT FOR VARIABLES     *
 14480****************************************************************
 14481     ELSE
 14482         IF  W-WORK-LINE GREATER THAN SPACES
 14483             MOVE W-TX-PC (W-TG-NDX)
 14484                                 TO W-PRINT-CONTROL
 14485             MOVE W-WORK-LINE    TO W-SQUEEZED-LINE
 14486             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14487             MOVE SPACES         TO W-WORK-LINE.
 14488
 14489 7410-EXIT.
 14490     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 303
* EL689.cbl
 14492 7420-TEXT-CHAR-PROCESS.
 14493****************************************************************
 14494*    LOOKING FOR VARIABLE INDICATORS (**XXX) THIS SECTION      *
 14495*    CONTROLS THE CONVERSION OF THESE INDICATORS INTO THEIR    *
 14496*    ACTUAL VALUES.  IT MOVES THESE REPLACEMENTS AND THE       *
 14497*    REMAINING CHARACTERS TO THE WORK LINE.                    *
 14498****************************************************************
 14499
 14500     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 14501             AND
 14502         W-LAST-CHAR EQUAL '@'
 14503         PERFORM 7430-PROCESS-VARIABLE THRU 7430-EXIT.
 14504
 14505     SET W-WC-NDX UP BY +1.
 14506
 14507     IF  W-WC-NDX GREATER THAN +70
 14508         IF  W-FORM-SQUEEZE-ON
 14509                 AND
 14510             NOT W-AS-IS
 14511             PERFORM 7440-BACK-TO-NEAREST-WORD THRU 7440-EXIT
 14512                     VARYING
 14513                 W-WC-NDX FROM W-LAST-WC-SPACE BY +1
 14514                     UNTIL
 14515                 W-WC-NDX EQUAL +71
 14516             SET W-TX-NDX        TO W-LAST-TX-SPACE
 14517
 14518             IF  W-WORK-LINE GREATER THAN SPACES
 14519                 PERFORM 7450-SQUEEZING THRU 7450-EXIT
 14520                 MOVE SPACES     TO W-WORK-LINE
 14521                                    W-LINE-SQUEEZE-IND
 14522                 SET W-WC-NDX    TO +1
 14523             ELSE
 14524                 SET W-WC-NDX    TO +1
 14525         ELSE
 14526             PERFORM 7460-REMAIN-CHAR-CHECK THRU 7460-EXIT.
 14527
 14528     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14529                                 TO W-CHARACTER-TYPE.
 14530
 14531     SET W-WC-NDX2               TO W-WC-NDX.
 14532     SET W-WC-NDX2 DOWN BY +1.
 14533
 14534     IF  W-PUNCTUATION
 14535             AND
 14536         W-WC-NDX2 GREATER THAN W-ZEROS
 14537             AND
 14538         W-WORK-CHAR (W-WC-NDX2) EQUAL SPACES
 14539         SET W-WC-NDX DOWN BY +1.
 14540
 14541     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14542                                 TO W-LAST-CHAR
 14543                                    W-WORK-CHAR (W-WC-NDX).
 14544
 14545     IF  W-LAST-CHAR EQUAL SPACES
 14546         SET W-LAST-WC-SPACE     TO W-WC-NDX
 14547         SET W-LAST-TX-SPACE     TO W-TX-NDX.
 14548
 14549 7420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 304
* EL689.cbl
 14550     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 305
* EL689.cbl
 14552 7430-PROCESS-VARIABLE.
 14553******************************************************************
 14554*    THIS SECTION CHECKS ON ALL '@@XXX' FORMATED CHARACTER       *
 14555*    GROUPS.  IF IN PROPER FORMAT, EACH GROUP IS REPLACED WITH   *
 14556*    ITS CORRESPONDING VALUES.                                   *
 14557******************************************************************
 14558
 14559     SET W-TX-NDX UP BY +1.
 14560
 14561     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 14562         MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14563                                 TO W-V1
 14564         SET W-TX-NDX UP BY +1
 14565
 14566         IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 14567             MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14568                                 TO W-V2
 14569             SET W-TX-NDX UP BY +1
 14570             IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 14571                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14572                                 TO W-V3
 14573                 SET W-TX-NDX UP BY +1
 14574                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14575                                 TO W-FIELD-SQUEEZE-IND
 14576                 GO TO 7430-CONTINUE
 14577             ELSE
 14578                 SET W-TX-NDX DOWN BY +3
 14579                 MOVE ER-0180    TO EMI-ERROR
 14580                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14581                 MOVE -1         TO MAINTL
 14582                 MOVE HIGH-VALUES
 14583                                 TO W-LAST-CHAR
 14584         ELSE
 14585             SET W-TX-NDX DOWN BY +2
 14586             MOVE ER-0180        TO EMI-ERROR
 14587             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14588             MOVE -1             TO MAINTL
 14589             MOVE HIGH-VALUES    TO W-LAST-CHAR
 14590     ELSE
 14591         SET W-TX-NDX DOWN BY +1
 14592         MOVE ER-7246            TO EMI-ERROR
 14593         MOVE -1                 TO MAINTL
 14594         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14595         MOVE HIGH-VALUES        TO W-LAST-CHAR.
 14596
 14597****************************************************************
 14598*    WHEN THE PROPER FORM IS NOT FOUND THE CHARACTERS INVOLVED *
 14599*    ARE TRANSFERRED INTACT AND A NOTE MADE INDICATING THIS    *
 14600*    ACTION.                                                   *
 14601****************************************************************
 14602
 14603     IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 14604         MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 14605         GO TO 7430-EXIT
 14606     ELSE
 14607         GO TO 7430-EXIT.
 14608
 14609 7430-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 306
* EL689.cbl
 14610
 14611     IF  W-VAR-RELATIVE-NUM LESS THAN 001
 14612             OR
 14613         W-VAR-RELATIVE-NUM GREATER THAN W-NUM-OF-VARIABLES
 14614         SET W-TX-NDX DOWN BY +4
 14615         MOVE ER-0180            TO EMI-ERROR
 14616         MOVE -1                 TO MAINTL
 14617         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14618         MOVE HIGH-VALUES        TO W-LAST-CHAR
 14619         IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 14620             MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 14621             GO TO 7430-EXIT
 14622         ELSE
 14623             GO TO 7430-EXIT.
 14624
 14625     SET W-VG-NDX                TO W-VAR-RELATIVE-NUM.
 14626
 14627     SET W-WC-NDX DOWN BY +1.
 14628
 14629     IF  (W-FORM-SQUEEZE-OFF
 14630                 AND
 14631             NOT W-SQUEEZE-FIELD)
 14632             OR
 14633         (W-FORM-SQUEEZE-ON
 14634                 AND
 14635             W-AS-IS)
 14636         PERFORM 7435-MOVE-VARIABLE-DIRECT THRU 7435-EXIT
 14637                 VARYING
 14638             W-VC-NDX FROM +1 BY +1
 14639                 UNTIL
 14640             W-VC-NDX GREATER THAN
 14641                 W-VARIABLE-SIZE (W-VG-NDX)
 14642
 14643         IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +5
 14644             SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 14645             SET W-TX-NDX DOWN BY +5
 14646             IF  W-TX-NDX GREATER THAN +70
 14647                 SET W-TX-NDX    TO +70
 14648                 GO TO 7430-EXIT
 14649             ELSE
 14650                 GO TO 7430-EXIT
 14651         ELSE
 14652             COMPUTE W-ADJUST-SHORT
 14653                 = 5 - W-VARIABLE-SIZE (W-VG-NDX)
 14654             SET W-WC-NDX UP BY W-ADJUST-SHORT
 14655             GO TO 7430-EXIT.
 14656
 14657     IF  W-SQUEEZE-FIELD
 14658         SET W-TX-NDX UP BY +1.
 14659
 14660     MOVE SPACES                 TO W-FIRST-CHAR-FOUND-IND.
 14661
 14662     PERFORM 7470-MOVE-CHAR THRU 7470-EXIT
 14663             VARYING
 14664         W-VC-NDX FROM +1 BY +1
 14665             UNTIL
 14666         W-VC-NDX GREATER THAN
 14667             W-VARIABLE-SIZE (W-VG-NDX).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 307
* EL689.cbl
 14668
 14669     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 14670
 14671     IF  W-FORM-SQUEEZE-ON
 14672         GO TO 7430-EXIT.
 14673
 14674     IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +6
 14675         SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 14676         SET W-TX-NDX DOWN BY +6
 14677         IF  W-TX-NDX GREATER THAN +70
 14678             SET W-TX-NDX        TO +70.
 14679
 14680     IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 14681         SET W-WC-NDX DOWN BY +1.
 14682
 14683 7430-EXIT.
 14684     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 308
* EL689.cbl
 14686 7435-MOVE-VARIABLE-DIRECT.
 14687
 14688     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 14689             AND
 14690         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 14691             AND
 14692         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 14693             AND
 14694         (W-VC-NDX GREATER THAN +1
 14695                 AND
 14696             W-LAST-CHAR NOT EQUAL SPACE
 14697                 AND
 14698             NOT W-LAST-CHAR-PUNC)
 14699         IF  W-LC-USE-BOTH-CASES
 14700             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14701                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 14702         ELSE
 14703             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14704                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 14705
 14706     SET W-WC-NDX UP BY +1.
 14707     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14708                                 TO W-WORK-CHAR (W-WC-NDX)
 14709                                    W-LAST-CHAR.
 14710
 14711 7435-EXIT.
 14712     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 309
* EL689.cbl
 14714 7437-FIND-NEXT-CHARACTER.
 14715*DELIBERATELY LEFT BLANK.
 14716 7437-EXIT.
 14717     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 310
* EL689.cbl
 14719 7440-BACK-TO-NEAREST-WORD.
 14720
 14721     MOVE SPACES                 TO W-WORK-CHAR (W-WC-NDX).
 14722
 14723 7440-EXIT.
 14724     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 311
* EL689.cbl
 14726 7450-SQUEEZING.
 14727
 14728     IF  W-NEW-PARAGRAPH
 14729         PERFORM 7600-SET-PARA-INDENT THRU 7600-EXIT
 14730         MOVE SPACES             TO W-LINE-SQUEEZE-IND
 14731         IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14732             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14733             MOVE W-TX-PC (W-TG-NDX)
 14734                                 TO W-PRINT-CONTROL
 14735             MOVE SPACES         TO W-SQUEEZED-LINE
 14736             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 14737             SET W-SQ-NDX UP BY W-WORK-INDENT
 14738         ELSE
 14739             MOVE W-TX-PC (W-TG-NDX)
 14740                                 TO W-PRINT-CONTROL
 14741             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 14742             SET W-SQ-NDX UP BY W-WORK-INDENT
 14743     ELSE
 14744         IF  W-DO-NOT-ADJUST
 14745             MOVE SPACES         TO W-LINE-SQUEEZE-IND
 14746             IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14747                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14748                 MOVE W-WORK-LINE
 14749                                 TO W-SQUEEZED-LINE
 14750                 MOVE W-TX-PC (W-TG-NDX)
 14751                                 TO W-PRINT-CONTROL
 14752                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14753                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 14754                 MOVE SPACES     TO W-SQUEEZED-LINE
 14755                 GO TO 7450-EXIT
 14756             ELSE
 14757                 MOVE W-WORK-LINE
 14758                                 TO W-SQUEEZED-LINE
 14759                 MOVE W-TX-PC (W-TG-NDX)
 14760                                 TO W-PRINT-CONTROL
 14761                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14762                 MOVE SPACES     TO W-SQUEEZED-LINE
 14763                                    W-WORK-LINE
 14764                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 14765                 GO TO 7450-EXIT
 14766         ELSE
 14767             IF  W-ADJUST-TO-LINE-LENGTH
 14768                 MOVE SPACES     TO W-LINE-SQUEEZE-IND
 14769
 14770                 IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14771                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14772                     SET W-SQ-NDX
 14773                                 TO W-INITIAL-COLUMN
 14774                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 14775                             VARYING
 14776                         W-WC-NDX FROM 1 BY 1
 14777                             UNTIL
 14778                         W-SQ-NDX EQUAL W-TOO-FAR
 14779                     MOVE W-TX-PC (W-TG-NDX)
 14780                                 TO W-PRINT-CONTROL
 14781                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14782                     SET W-SQ-NDX
 14783                                 TO W-INITIAL-COLUMN
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 312
* EL689.cbl
 14784                     MOVE SPACES TO W-SQUEEZED-LINE
 14785                                    W-WORK-LINE
 14786                     GO TO 7450-EXIT
 14787                 ELSE
 14788                     SET W-SQ-NDX
 14789                                 TO W-INITIAL-COLUMN
 14790                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 14791                             VARYING
 14792                         W-WC-NDX FROM 1 BY 1
 14793                             UNTIL
 14794                         W-SQ-NDX EQUAL W-TOO-FAR
 14795                     MOVE W-TX-PC (W-TG-NDX)
 14796                                 TO W-PRINT-CONTROL
 14797                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14798                     MOVE SPACES TO W-SQUEEZED-LINE
 14799                                    W-WORK-LINE
 14800                     SET W-SQ-NDX
 14801                                 TO W-INITIAL-COLUMN
 14802                     GO TO 7450-EXIT
 14803             ELSE
 14804                 IF  W-CONTINUE-PARAGRAPH
 14805                     IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14806                         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14807                         PERFORM 7610-SET-CONP-INDENT
 14808                             THRU 7610-EXIT
 14809                         MOVE SPACES
 14810                                 TO W-LINE-SQUEEZE-IND
 14811                         MOVE W-TX-PC (W-TG-NDX)
 14812                                 TO W-PRINT-CONTROL
 14813                         MOVE SPACES
 14814                                 TO W-SQUEEZED-LINE
 14815                         SET W-SQ-NDX
 14816                                 TO W-INITIAL-COLUMN
 14817                         SET W-SQ-NDX UP BY W-WORK-INDENT
 14818                     ELSE
 14819                         PERFORM 7610-SET-CONP-INDENT
 14820                             THRU 7610-EXIT
 14821                         MOVE SPACES
 14822                                 TO W-LINE-SQUEEZE-IND
 14823                         MOVE W-TX-PC (W-TG-NDX)
 14824                                 TO W-PRINT-CONTROL
 14825                         MOVE SPACES
 14826                                 TO W-SQUEEZED-LINE
 14827                         SET W-SQ-NDX
 14828                                 TO W-INITIAL-COLUMN
 14829                         SET W-SQ-NDX UP BY W-WORK-INDENT.
 14830
 14831
 14832     PERFORM 7480-UPDATE-SQUEEZED-LINE THRU 7480-EXIT
 14833             VARYING
 14834         W-WC-NDX FROM +1 BY +1
 14835             UNTIL
 14836         W-WC-NDX GREATER THAN +70.
 14837
 14838 7450-EXIT.
 14839     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 313
* EL689.cbl
 14841 7460-REMAIN-CHAR-CHECK.
 14842
 14843     IF  W-TX-NDX EQUAL W-WC-NDX
 14844         MOVE W-TX-PC (W-TG-NDX)
 14845                                 TO W-PRINT-CONTROL
 14846         MOVE W-WORK-LINE        TO W-SQUEEZED-LINE
 14847         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14848         MOVE SPACES             TO W-WORK-LINE
 14849         SET W-WC-NDX            TO +1
 14850     ELSE
 14851         SET W-TX-NDX1           TO W-TX-NDX
 14852         SEARCH W-TX-CHAR
 14853             VARYING W-TX-NDX1
 14854             AT END
 14855                 MOVE W-TX-PC (W-TG-NDX)
 14856                                 TO W-PRINT-CONTROL
 14857                 MOVE W-WORK-LINE
 14858                                 TO W-SQUEEZED-LINE
 14859                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14860                 MOVE SPACES     TO W-WORK-LINE
 14861                 SET W-WC-NDX    TO +1
 14862                 SET W-TX-NDX    TO +1
 14863                 SET W-TG-NDX UP BY +1
 14864             WHEN
 14865                 W-TX-CHAR (W-TG-NDX W-TX-NDX1) NOT EQUAL SPACES
 14866                 MOVE ER-9427    TO EMI-ERROR
 14867                 MOVE -1         TO MAINTL
 14868                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14869                 MOVE W-TX-PC (W-TG-NDX)
 14870                                 TO W-PRINT-CONTROL
 14871                 MOVE W-WORK-LINE
 14872                                 TO W-SQUEEZED-LINE
 14873                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14874                 MOVE SPACES     TO W-WORK-LINE
 14875                 SET W-WC-NDX    TO +1.
 14876
 14877 7460-EXIT.
 14878     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 314
* EL689.cbl
 14880 7470-MOVE-CHAR.
 14881
 14882     IF  W-FIRST-CHAR-NOT-FOUND
 14883             AND
 14884         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 14885         MOVE SPACES             TO W-LAST-CHAR
 14886         GO TO 7470-EXIT.
 14887
 14888     MOVE 'Y'                    TO W-FIRST-CHAR-FOUND-IND.
 14889
 14890     IF  W-SQUEEZE-FIELD
 14891             AND
 14892         W-LAST-CHAR EQUAL SPACES
 14893             AND
 14894         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 14895         GO TO 7470-EXIT.
 14896
 14897     SET W-WC-NDX UP BY +1.
 14898
 14899     IF  W-WC-NDX GREATER THAN +70
 14900         IF  W-FORM-SQUEEZE-ON
 14901             GO TO 7470-EXIT
 14902         ELSE
 14903             MOVE ER-9427        TO EMI-ERROR
 14904             MOVE -1             TO MAINTL
 14905             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14906             GO TO 7470-EXIT.
 14907
 14908     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 14909             AND
 14910         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 14911             AND
 14912         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 14913             AND
 14914         (W-VC-NDX GREATER THAN +1
 14915                 AND
 14916             W-LAST-CHAR NOT EQUAL SPACE
 14917                 AND
 14918             NOT W-LAST-CHAR-PUNC)
 14919         IF  W-LC-USE-BOTH-CASES
 14920             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14921                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 14922         ELSE
 14923             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14924                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 14925
 14926     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14927                                 TO W-WORK-CHAR (W-WC-NDX)
 14928                                    W-LAST-CHAR.
 14929
 14930     IF  W-LAST-CHAR EQUAL SPACES
 14931         SET W-LAST-WC-SPACE     TO W-WC-NDX.
 14932
 14933 7470-EXIT.
 14934     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 315
* EL689.cbl
 14936 7480-UPDATE-SQUEEZED-LINE.
 14937****************************************************************
 14938*    THIS SECTION CONTROLS THE MOVEMENT FROM THE WORK LINE TO *
 14939*    THE SQUEEZED LINE.  DURING THIS PROCESS ALL EXTRA SPACES  *
 14940*    (DEFINED AS TWO OR MORE SPACES NOT FOLLOWING A END OF     *
 14941*    SENTENCE INDICATOR) ARE REMOVED.  IF THE LAST CHARACTER   *
 14942*    IS NOT A SPACE OR PUNCTUATION MARK AN UNFINISHED WORD IS  *
 14943*    ASSUMED.  EVERYTHING TO THE PREVIOUS SPACE IS REMOVED     *
 14944****************************************************************
 14945
 14946     SET W-SQ-NDX UP BY +1.
 14947
 14948     IF  W-SQ-NDX GREATER THAN W-LAST-COLUMN
 14949         MOVE W-SQ-CHAR (W-LAST-COLUMN)
 14950                                 TO W-CHARACTER-TYPE
 14951         IF  W-PUNCTUATION
 14952                 OR
 14953             W-SPACE
 14954             PERFORM 7485-FIND-NEXT-CHARACTER THRU 7485-EXIT
 14955             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14956             MOVE SPACES         TO W-SQUEEZED-LINE
 14957             SET W-SQ-NDX        TO W-START-COLUMN
 14958             SET W-SQ-NDX UP BY W-NEXT-INDENT
 14959             SET W-LAST-SQUEEZED-SPACE
 14960                                 TO W-SQ-NDX
 14961         ELSE
 14962             PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 14963             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14964             MOVE SPACES         TO W-SQUEEZED-LINE
 14965             SET W-SQ-NDX        TO W-START-COLUMN
 14966             SET W-SQ-NDX UP BY W-NEXT-INDENT
 14967             SET W-LAST-SQUEEZED-SPACE
 14968                                 TO W-SQ-NDX.
 14969
 14970     IF  W-WC-NDX GREATER THAN +70
 14971         GO TO 7480-EXIT.
 14972
 14973     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 14974
 14975     IF  W-END-OF-SENTENCE
 14976         MOVE 'Y'                TO W-END-OF-SENTENCE-IND
 14977         SET W-WORK-NDX          TO W-SQ-NDX
 14978         COMPUTE W-DISPLAY-NDX = W-WORK-NDX - 1
 14979         IF  W-DISPLAY-NDX EQUAL W-LAST-SQUEEZED-SPACE
 14980             SET W-SQ-NDX        TO W-LAST-SQUEEZED-SPACE
 14981         ELSE
 14982             NEXT SENTENCE
 14983     ELSE
 14984         IF  W-PUNCTUATION
 14985                 AND
 14986             W-LAST-SQ-CHAR EQUAL SPACES
 14987             SET W-SQ-NDX DOWN BY +1
 14988             MOVE SPACES         TO W-END-OF-SENTENCE-IND
 14989         ELSE
 14990             IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 14991                 IF  W-LAST-SQ-CHAR EQUAL SPACES
 14992                     IF  W-END-OF-SENTENCE-WORKING
 14993                         MOVE SPACES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 316
* EL689.cbl
 14994                                 TO W-END-OF-SENTENCE-IND
 14995                         SET W-LAST-SQUEEZED-SPACE
 14996                                 TO W-SQ-NDX
 14997                     ELSE
 14998                         SET W-SQ-NDX DOWN BY +1
 14999                         GO TO 7480-EXIT
 15000                 ELSE
 15001                     SET W-LAST-SQUEEZED-SPACE
 15002                                 TO W-SQ-NDX
 15003             ELSE
 15004                 MOVE SPACES     TO W-END-OF-SENTENCE-IND.
 15005
 15006     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX)
 15007                                    W-LAST-SQ-CHAR.
 15008
 15009     IF  W-WC-NDX EQUAL +70
 15010             AND
 15011         W-WORK-CHAR (W-WC-NDX) GREATER THAN SPACES
 15012             AND
 15013         W-SQ-NDX NOT EQUAL W-LAST-COLUMN
 15014         SET W-SQ-NDX UP BY +1
 15015         SET W-LAST-SQUEEZED-SPACE
 15016                                 TO W-SQ-NDX
 15017         MOVE SPACES             TO W-SQ-CHAR (W-SQ-NDX)
 15018                                    W-LAST-SQ-CHAR.
 15019
 15020 7480-EXIT.
 15021     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 317
* EL689.cbl
 15023 7485-FIND-NEXT-CHARACTER.
 15024
 15025     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 15026
 15027     IF  W-PUNCTUATION
 15028         PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 15029     ELSE
 15030         SET W-WC-NDX            TO W-WC-NDX
 15031         SEARCH W-WORK-CHAR
 15032             VARYING W-WC-NDX
 15033             AT END
 15034                 GO TO 7485-EXIT
 15035             WHEN
 15036                 W-WORK-CHAR (W-WC-NDX) NOT EQUAL SPACES
 15037                 GO TO 7485-EXIT.
 15038
 15039 7485-EXIT.
 15040     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 318
* EL689.cbl
 15042 7490-REMOVE-LAST-WORD.
 15043
 15044*********  NOTE: W-WORK-LINE ALWAYS STARTS WITH A FULL WORD*******
 15045     IF  W-WC-NDX EQUAL +1
 15046         GO TO 7490-EXIT.
 15047
 15048     ADD +1                      TO W-LAST-SQUEEZED-SPACE.
 15049
 15050     PERFORM 7500-CLEAR-SQUEEZED-EXCESS THRU 7500-EXIT
 15051             VARYING
 15052         W-SQ-NDX FROM W-LAST-SQUEEZED-SPACE BY +1
 15053             UNTIL
 15054         W-SQ-NDX EQUAL W-TOO-FAR.
 15055
 15056     SET W-WORK-NDX              TO W-WC-NDX.
 15057     COMPUTE W-LAST-WC-SPACE
 15058         = W-WORK-NDX - W-TOO-FAR + W-LAST-SQUEEZED-SPACE.
 15059     SET W-WC-NDX                TO W-LAST-WC-SPACE.
 15060
 15061 7490-EXIT.
 15062     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 319
* EL689.cbl
 15064 7500-CLEAR-SQUEEZED-EXCESS.
 15065
 15066     MOVE SPACES                 TO W-SQ-CHAR (W-SQ-NDX).
 15067
 15068 7500-EXIT.
 15069     EXIT.
 15070
 15071 7505-MOVE-STRAIGHT.
 15072
 15073     SET W-SQ-NDX UP BY +1.
 15074
 15075     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX).
 15076
 15077 7505-EXIT.
 15078     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 320
* EL689.cbl
 15080 7510-MOVE-TO-TABLE.
 15081
 15082     IF  W-PRINT-CONTROL NOT NUMERIC
 15083         MOVE 00                 TO W-PRINT-CONTROL
 15084         ADD +1                  TO W-LINE-COUNT
 15085     ELSE
 15086         IF  W-PRINT-CONTROL EQUAL 99
 15087             PERFORM 7640-PAGING THRU 7640-EXIT
 15088             MOVE 00             TO W-PRINT-CONTROL
 15089             SET W-RG-NDX UP BY +1
 15090             MOVE W-TOP-FORM     TO W-RC-TEXT (W-RG-NDX)
 15091             MOVE +1             TO W-LINE-COUNT
 15092             SET W-RG-NDX UP BY W-TOP-MARGIN
 15093         ELSE
 15094           IF W-SQUEEZED-LINE (1:6) NOT EQUAL '&&&&&&'
 15095             COMPUTE W-LINE-COUNT
 15096                 = W-LINE-COUNT + W-PRINT-CONTROL + 1.
 15097
 15098     IF  W-LINE-COUNT GREATER THAN W-MAX-LINES-PER-PAGE
 15099         PERFORM 7640-PAGING THRU 7640-EXIT
 15100         MOVE 00                 TO W-PRINT-CONTROL
 15101         SET W-RG-NDX UP BY +1
 15102         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 15103         SET W-RG-NDX UP BY W-TOP-MARGIN
 15104         MOVE +1                 TO W-LINE-COUNT.
 15105
 15106     SET W-RG-NDX UP BY W-PRINT-CONTROL.
 15107     SET W-RG-NDX UP BY +1.
 15108     MOVE W-SQUEEZED-LINE        TO W-RC-TEXT (W-RG-NDX).
 15109     MOVE 00                     TO W-PRINT-CONTROL.
 15110
 15111     IF  W-FIRST-BAD-VARIABLE-FOUND
 15112             AND
 15113         W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15114         SET W-FIRST-BAD-VARIABLE
 15115                                 TO W-RG-NDX.
 15116
 15117 7510-EXIT.
 15118     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 321
* EL689.cbl
 15120 7600-SET-PARA-INDENT.
 15121
 15122     IF  W-LINE-SQUEEZE-IND EQUAL 'P'
 15123         MOVE W-PARAGRAPH-INDENT TO W-WORK-INDENT
 15124     ELSE
 15125     IF  W-LINE-SQUEEZE-IND EQUAL 'Q'
 15126         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 15127         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 15128     ELSE
 15129     IF  W-LINE-SQUEEZE-IND EQUAL 'R'
 15130         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 15131         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 15132     ELSE
 15133     IF  W-LINE-SQUEEZE-IND EQUAL 'S'
 15134         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 15135         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 15136     ELSE
 15137     IF  W-LINE-SQUEEZE-IND EQUAL 'T'
 15138         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 15139         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 15140     ELSE
 15141     IF  W-LINE-SQUEEZE-IND EQUAL 'U'
 15142         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT
 15143         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT.
 15144
 15145     SET W-TG-NDX2               TO W-TG-NDX.
 15146     SET W-TG-NDX2 UP BY +1.
 15147
 15148     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 15149         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 15150     ELSE
 15151         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 15152
 15153 7600-EXIT.
 15154     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 322
* EL689.cbl
 15156 7610-SET-CONP-INDENT.
 15157
 15158     IF  W-LINE-SQUEEZE-IND EQUAL 'C'
 15159         MOVE +0                 TO W-WORK-INDENT
 15160     ELSE
 15161     IF  W-LINE-SQUEEZE-IND EQUAL 'D'
 15162         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 15163     ELSE
 15164     IF  W-LINE-SQUEEZE-IND EQUAL 'E'
 15165         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 15166     ELSE
 15167     IF  W-LINE-SQUEEZE-IND EQUAL 'F'
 15168         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 15169     ELSE
 15170     IF  W-LINE-SQUEEZE-IND EQUAL 'G'
 15171         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 15172     ELSE
 15173     IF  W-LINE-SQUEEZE-IND EQUAL 'H'
 15174         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT.
 15175
 15176     SET W-TG-NDX2               TO W-TG-NDX.
 15177     SET W-TG-NDX2 UP BY +1.
 15178
 15179     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 15180         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 15181     ELSE
 15182         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 15183
 15184 7610-EXIT.
 15185     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 323
* EL689.cbl
 15187 7630-NEXT-LINE.
 15188
 15189     IF  W-TX-SC (W-TG-NDX2) EQUAL ' '
 15190         MOVE ZEROS              TO W-NEXT-INDENT
 15191     ELSE
 15192     IF  W-TX-SC (W-TG-NDX2) EQUAL '1'
 15193         MOVE W-LINE-INDENT-1    TO W-NEXT-INDENT
 15194     ELSE
 15195     IF  W-TX-SC (W-TG-NDX2) EQUAL '2'
 15196         MOVE W-LINE-INDENT-2    TO W-NEXT-INDENT
 15197     ELSE
 15198     IF  W-TX-SC (W-TG-NDX2) EQUAL '3'
 15199         MOVE W-LINE-INDENT-3    TO W-NEXT-INDENT
 15200     ELSE
 15201     IF  W-TX-SC (W-TG-NDX2) EQUAL '4'
 15202         MOVE W-LINE-INDENT-4    TO W-NEXT-INDENT
 15203     ELSE
 15204     IF  W-TX-SC (W-TG-NDX2) EQUAL '5'
 15205         MOVE W-LINE-INDENT-5    TO W-NEXT-INDENT
 15206     ELSE
 15207         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 15208         SUBTRACT W-PARAGRAPH-INDENT
 15209                                  FROM W-NEXT-INDENT.
 15210
 15211 7630-EXIT.
 15212     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 324
* EL689.cbl
 15214 7640-PAGING.
 15215
 15216     IF  NOT W-LC-CREATE-PAGES
 15217         GO TO 7640-EXIT.
 15218
 15219     IF  W-LINE-COUNT GREATER ZEROS
 15220             AND
 15221         W-RG-NDX GREATER THAN +1
 15222         ADD +1                  TO W-PAGE
 15223         MOVE W-PAGE             TO W-PAGE-NUMBER
 15224         COMPUTE W-PAGE-LINE
 15225             = W-MAX-LINES-PER-PAGE - W-LINE-COUNT + 3
 15226         IF  W-PAGE-LINE GREATER THAN +2
 15227             SET W-RG-NDX UP BY W-PAGE-LINE
 15228             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX)
 15229         ELSE
 15230             SET W-RG-NDX UP BY +2
 15231             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX).
 15232
 15233 7640-EXIT.
 15234     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 325
* EL689.cbl
 15236 7700-READ-TEXT-TS.
 15237**************************************************************
 15238*  THIS PARAGRAPH READS THE TEMPORARY STORAGE RECORDS THAT   *
 15239*  CONTAIN THE TEXT THAT IS PAST BETWEEN EL689, EL6892       *
 15240*  AND EL1042.                                               *
 15241**************************************************************
 15242
 15243
 15244* EXEC CICS HANDLE CONDITION
 15245*         QIDERR     (7700-TS-ERROR)
 15246*         ITEMERR    (7700-TS-ERROR)
 15247*    END-EXEC.
 15248*    MOVE '"$N<                  ! 9 #00014385' TO DFHEIV0
 15249     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 15250     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15251     MOVE X'3920233030303134333835' TO DFHEIV0(25:11)
 15252     CALL 'kxdfhei1' USING DFHEIV0
 15253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15254
 15255
 15256     SET W-TS-NDX                TO 1.
 15257     MOVE 1                      TO W-TS-ITEM.
 15258
 15259 7700-LOOP.
 15260
 15261     IF  W-TS-ITEM GREATER THAN PI-TEMP-STOR-ITEMS
 15262         IF  PI-TEMP-STOR-ITEMS GREATER THAN ZEROS
 15263             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 15264             GO TO 7700-EXIT
 15265         ELSE
 15266             GO TO 7700-EXIT.
 15267
 15268
 15269* EXEC CICS READQ TS
 15270*         INTO     (W-TS-WORK-AREA)
 15271*         QUEUE    (W-TS-NAME-TEXT)
 15272*         LENGTH   (W-TS-LENGTH)
 15273*         ITEM     (W-TS-ITEM)
 15274*    END-EXEC.
 15275*    MOVE '*$II   L              ''   #00014402' TO DFHEIV0
 15276     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 15277     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15278     MOVE X'2020233030303134343032' TO DFHEIV0(25:11)
 15279     CALL 'kxdfhei1' USING DFHEIV0,
 15280           W-TS-NAME-TEXT,
 15281           W-TS-WORK-AREA,
 15282           W-TS-LENGTH,
 15283           W-TS-ITEM,
 15284           DFHEIV99,
 15285           DFHEIV99
 15286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15287
 15288
 15289     MOVE W-TS-WORK-AREA         TO W-TS-GROUP (W-TS-NDX).
 15290     SET W-TS-NDX UP BY 1.
 15291     ADD 1                       TO W-TS-ITEM.
 15292     GO TO 7700-LOOP.
 15293
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 326
* EL689.cbl
 15294 7700-TS-ERROR.
 15295
 15296     IF  EIBTRNID = W-TRANSACTION OR 'EX14'
 15297         MOVE ER-0033            TO EMI-ERROR
 15298         MOVE -1                 TO MAINTL
 15299         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15300         GO TO 8200-SEND-DATAONLY.
 15301
 15302 7700-EXIT.
 15303      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 327
* EL689.cbl
 15305 7740-RESTORE-SCREEN.
 15306
 15307     MOVE 'C'                    TO MAINTI.
 15308     MOVE +1                     TO MAINTL.
 15309     MOVE AL-UANON               TO MAINTA.
 15310
 15311     MOVE PI-689-FORM-NUMBER     TO FORMI.
 15312     MOVE +4                     TO FORML.
 15313     MOVE AL-UANON               TO FORMA.
 15314
 15315*    IF  PI-689-PRINT-RESTRICTION GREATER THAN SPACES
 15316*        MOVE PI-689-PRINT-RESTRICTION
 15317*                                TO PRTRESTL
 15318*        MOVE +1                 TO PRTRESTL
 15319*        MOVE AL-UANON           TO PRTRESTA.
 15320
 15321     IF  PI-689-FOLLOW-UP-EDIT GREATER THAN SPACES
 15322         MOVE PI-689-FOLLOW-UP-EDIT
 15323                                 TO FOLLOWI
 15324         MOVE +8                 TO FOLLOWL
 15325         MOVE AL-UANON           TO FOLLOWA.
 15326
 15327     IF  PI-689-RESEND1-EDIT GREATER THAN SPACES
 15328         MOVE PI-689-RESEND1-EDIT
 15329                                 TO RESEND1I
 15330         MOVE +8                 TO RESEND1L
 15331         MOVE AL-UANON           TO RESEND1A.
 15332     IF  PI-689-ALT-PRINTER-ID GREATER THAN SPACES
 15333         MOVE PI-689-ALT-PRINTER-ID
 15334                                 TO PRINTERI
 15335         MOVE +1                 TO PRINTERL
 15336         MOVE AL-UANON           TO PRINTERA.
 15337
 15338     IF  PI-BYPASS-LABELS
 15339          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 15340          MOVE +1                TO ADDRLBLL
 15341          MOVE AL-UANON          TO ADDRLBLA
 15342     ELSE
 15343          IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 15344               MOVE PI-689-LBL-OVERRIDE
 15345                                 TO ADDRLBLI
 15346               MOVE +1           TO ADDRLBLL
 15347               MOVE AL-UANON     TO ADDRLBLA.
 15348
 15349     IF  PI-689-NUMBER-COPIES GREATER THAN ZEROS
 15350         MOVE PI-689-NUMBER-COPIES   TO COPIESI
 15351         MOVE +1                     TO COPIESL
 15352         MOVE AL-UNNON               TO COPIESA.
 15353
 15354     IF  PI-689-LABEL-SOURCE GREATER THAN SPACES
 15355         MOVE PI-689-LABEL-SOURCE
 15356                                 TO ADDRSI
 15357         MOVE +1                 TO ADDRSL
 15358         MOVE AL-UANON           TO ADDRSA.
 15359
 15360     MOVE PI-689-DATA-SOURCE     TO DATASORI.
 15361     MOVE +1                     TO DATASORL.
 15362     MOVE AL-UANON               TO DATASORA.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 328
* EL689.cbl
 15363
 15364     IF  PI-689-CARRIER GREATER THAN SPACES
 15365         MOVE PI-689-CARRIER     TO CARRIERI
 15366         MOVE +1                 TO CARRIERL
 15367         MOVE AL-UANON           TO CARRIERA.
 15368
 15369     IF  PI-689-GROUPING GREATER THAN SPACES
 15370         MOVE PI-689-GROUPING    TO GROUPI
 15371         MOVE +6                 TO GROUPL
 15372         MOVE AL-UANON           TO GROUPA.
 15373
 15374     IF  PI-689-STATE GREATER THAN SPACES
 15375         MOVE PI-689-STATE       TO STATEI
 15376         MOVE +2                 TO STATEL
 15377         MOVE AL-UANON           TO STATEA.
 15378
 15379     IF  PI-689-ACCOUNT GREATER THAN SPACES
 15380         MOVE PI-689-ACCOUNT     TO ACCTI
 15381         MOVE +10                TO ACCTL
 15382         MOVE AL-UANON           TO ACCTA.
 15383
 15384     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 15385         MOVE PI-689-CERT-PRIME  TO CERTI
 15386         MOVE +10                TO CERTL
 15387         MOVE AL-UANON           TO CERTA.
 15388
 15389     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 15390         MOVE PI-689-CERT-SFX    TO SFXI
 15391         MOVE +1                 TO SFXL
 15392         MOVE AL-UANON           TO SFXA.
 15393
 15394     IF  PI-689-TYPE GREATER THAN SPACES
 15395         MOVE PI-689-TYPE        TO TYPEI
 15396         MOVE +1                 TO TYPEL
 15397         MOVE AL-UANON           TO TYPEA.
 15398
 15399     IF  PI-689-RESP-PERSON GREATER THAN SPACES
 15400         MOVE PI-689-RESP-PERSON TO RPERSONI
 15401         MOVE +10                TO RPERSONL
 15402         MOVE AL-UANON           TO RPERSONA.
 15403
 15404     IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 15405         MOVE PI-689-ENTRY-BATCH TO BENTRYI
 15406         MOVE +6                 TO BENTRYL
 15407         MOVE AL-UANON           TO BENTRYA.
 15408
 15409     IF  PI-689-SEQ-EDIT GREATER THAN SPACES
 15410         MOVE PI-689-SEQ-EDIT    TO SEQI
 15411         MOVE +8                 TO SEQL
 15412         MOVE AL-UNNON           TO SEQA.
 15413
 15414     IF  PI-689-BCSEQ-EDIT GREATER THAN SPACES
 15415         MOVE PI-689-BCSEQ-EDIT  TO BCSEQI
 15416         MOVE +4                 TO BCSEQL
 15417         MOVE AL-UNNON           TO BCSEQA.
 15418
 15419     IF  PI-689-DATE-EDIT GREATER THAN SPACES
 15420         MOVE PI-689-DATE-EDIT   TO DATEI
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 329
* EL689.cbl
 15421         MOVE +8                 TO DATEL
 15422         MOVE AL-UNNON           TO DATEA.
 15423
 15424     IF PI-CERT-FORM-ID GREATER THAN SPACES
 15425        MOVE PI-CERT-FORM-ID     TO CERTIDI
 15426        MOVE +5                  TO CERTIDL
 15427        MOVE AL-UNNON            TO CERTIDA
 15428     END-IF.
 15429
 15430     IF PI-PRINT-NOW GREATER THAN SPACES
 15431        MOVE PI-PRINT-NOW        TO PRTNOWI
 15432        MOVE +1                  TO PRTNOWL
 15433        MOVE AL-UNNON            TO PRTNOWA
 15434     END-IF.
 15435     IF PI-ENDT-ARCH-NO GREATER THAN ZERO
 15436        MOVE PI-ENDT-ARCH-NO     TO ENDARCHI
 15437        MOVE +8                  TO ENDARCHL
 15438        MOVE AL-UNNON            TO ENDARCHA
 15439     END-IF
 15440
 15441     MOVE PI-ENCLOSURE-CD        TO ENCI.
 15442     MOVE +3                     TO ENCL.
 15443     MOVE AL-UANON               TO ENCA.
 15444
 15445 7749-EXIT.
 15446     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 330
* EL689.cbl
 15448 7760-PUT-TEMP-STORAGE.
 15449**************************************************************
 15450*  THIS PARAGRAPH WRITES THE TEMPORARY STORAGE RECORDS THAT  *
 15451*  WILL CONTAIN THE CONTENTS OF THE TEXT TABLE FOR USE BY    *
 15452*  EL1042 AND EL6892.                                        *
 15453**************************************************************
 15454
 15455     SET W-TS-NDX                TO 1.
 15456     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 15457
 15458     MOVE -1                     TO MAINTL.
 15459     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 15460             VARYING
 15461         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 15462             UNTIL
 15463         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 15464
 15465 7760-EXIT.
 15466      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 331
* EL689.cbl
 15468 7780-DELETE-TEMP-STOR-TEXT.
 15469
 15470
 15471* EXEC CICS HANDLE CONDITION
 15472*         QIDERR      (7780-EXIT)
 15473*    END-EXEC.
 15474*    MOVE '"$N                   ! : #00014590' TO DFHEIV0
 15475     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 15476     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15477     MOVE X'3A20233030303134353930' TO DFHEIV0(25:11)
 15478     CALL 'kxdfhei1' USING DFHEIV0
 15479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15480
 15481
 15482
 15483* EXEC CICS DELETEQ TS
 15484*         QUEUE       (W-TS-NAME-TEXT)
 15485*    END-EXEC.
 15486*    MOVE '*&                    #   #00014594' TO DFHEIV0
 15487     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 15488     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15489     MOVE X'2020233030303134353934' TO DFHEIV0(25:11)
 15490     CALL 'kxdfhei1' USING DFHEIV0,
 15491           W-TS-NAME-TEXT,
 15492           DFHEIV99
 15493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15494
 15495
 15496 7780-EXIT.
 15497     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 332
* EL689.cbl
 15499 7840-WRITE-TS.
 15500
 15501     MOVE W-TS-GROUP (W-TS-NDX)  TO W-TS-WORK-AREA.
 15502     SET W-TS-NDX UP BY 1.
 15503     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 15504
 15505
 15506* EXEC CICS WRITEQ TS
 15507*         FROM    (W-TS-WORK-AREA)
 15508*         QUEUE   (W-TS-NAME-TEXT)
 15509*         LENGTH  (W-TS-LENGTH)
 15510*         ITEM    (PI-TEMP-STOR-ITEMS)
 15511*    END-EXEC.
 15512*    MOVE '*" I                  ''   #00014607' TO DFHEIV0
 15513     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 15514     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15515     MOVE X'2020233030303134363037' TO DFHEIV0(25:11)
 15516     CALL 'kxdfhei1' USING DFHEIV0,
 15517           W-TS-NAME-TEXT,
 15518           W-TS-WORK-AREA,
 15519           W-TS-LENGTH,
 15520           PI-TEMP-STOR-ITEMS,
 15521           DFHEIV99,
 15522           DFHEIV99
 15523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15524
 15525
 15526 7840-EXIT.
 15527     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 333
* EL689.cbl
 15529 7900-PRINT-LETTER-NOW.
 15530***************************************************************
 15531*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 15532*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 15533*     THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS.          *
 15534*     THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE.       *
 15535*     THE LETTER IS SAVED IN TEMP-STORAGE AND A START IS      *
 15536*     ISSUED FOR THE PRINT TRANSACTION.                       *
 15537***************************************************************
 15538
 15539*    IF (EIBAID = DFHPF4 OR DFHPF8)
 15540*            AND
 15541*        PI-SHOW-MODE
 15542*        IF  PRINTERL GREATER ZERO
 15543*            INSPECT PRINTERI CONVERTING W-LOWER-CASE TO
 15544*                                                    W-UPPER-CASE
 15545*            MOVE PRINTERI       TO PI-689-ALT-PRINTER-ID
 15546*                                   PI-ALT-DMD-PRT-ID.
 15547*
 15548*    IF  EIBAID EQUAL DFHPF8
 15549*            AND
 15550*        PI-SHOW-MODE
 15551*            AND
 15552*        LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
 15553*        MOVE ER-7247            TO EMI-ERROR
 15554*        MOVE -1                 TO MAINTL
 15555*        MOVE AL-UABON           TO MAINTA
 15556*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15557*        GO TO 8200-SEND-DATAONLY.
 15558
 15559     IF  PI-TOTAL-LINES EQUAL 0
 15560         MOVE ER-0187            TO EMI-ERROR
 15561         MOVE -1                 TO MAINTL
 15562         MOVE AL-UABON           TO MAINTA
 15563         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15564         GO TO 8200-SEND-DATAONLY.
 15565
 15566     IF  EMI-ERROR NOT EQUAL ER-0191
 15567         IF  PI-689-CREATE-NO-SCREENS
 15568*                OR
 15569*            (EIBAID = DFHPF4 OR DFHPF8)
 15570             SET W-RG-NDX        TO +1
 15571         ELSE
 15572             PERFORM 4100-SET-NDX THRU 4100-EXIT
 15573             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 15574                     VARYING
 15575                 W-SC-NDX FROM 1 BY 1
 15576                     UNTIL
 15577                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 15578
 15579     MOVE SPACES                 TO W-REMAINING-VAR-SW.
 15580
 15581     IF EIBAID NOT = DFHPF4 AND DFHPF8
 15582         PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 15583                 VARYING
 15584             W-RVS-NDX FROM +1 BY +1
 15585                 UNTIL
 15586             W-RVS-NDX GREATER THAN +36500
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 334
* EL689.cbl
 15587                 OR
 15588             W-REMAINING-VAR-FOUND
 15589         IF  W-REMAINING-VAR-FOUND
 15590             GO TO 4000-ROLL-PAGE.
 15591
 15592*    IF EIBAID = DFHPF4 OR DFHPF8
 15593*       PERFORM 7700-READ-TEXT-TS
 15594*                                THRU 7700-EXIT
 15595*
 15596*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 15597*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 15598*                VARYING
 15599*            W-SC-NDX FROM 1 BY 1
 15600*                UNTIL
 15601*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 15602*
 15603*       PERFORM 7760-PUT-TEMP-STORAGE
 15604*                                THRU 7760-EXIT
 15605*    END-IF
 15606     IF PI-689-ALT-PRINTER-ID NOT = SPACES AND LOW-VALUES
 15607         MOVE PI-689-ALT-PRINTER-ID
 15608                                 TO W-TS-TERM-TEXT
 15609     ELSE
 15610         IF PI-PROCESSOR-PRINTER NOT = SPACES AND LOW-VALUES
 15611             MOVE PI-PROCESSOR-PRINTER
 15612                                 TO W-TS-TERM-TEXT
 15613         ELSE
 15614             MOVE PI-COMPANY-ID  TO W-CNTL-COMPANY-ID
 15615             MOVE '1'            TO W-CNTL-RECORD-TYPE
 15616             MOVE SPACES         TO W-CNTL-GENL
 15617             MOVE ZEROS          TO W-CNTL-SEQ-NO
 15618
 15619* EXEC CICS HANDLE CONDITION
 15620*                 NOTOPEN    (8040-CNTL-NOT-OPEN)
 15621*                 NOTFND     (7945-NOT-FOUND)
 15622*            END-EXEC
 15623*    MOVE '"$JI                  ! ; #00014706' TO DFHEIV0
 15624     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 15625     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15626     MOVE X'3B20233030303134373036' TO DFHEIV0(25:11)
 15627     CALL 'kxdfhei1' USING DFHEIV0
 15628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15629
 15630* EXEC CICS READ
 15631*                 DATASET    (W-CNTL-FILE-ID)
 15632*                 SET        (ADDRESS OF CONTROL-FILE)
 15633*                 RIDFLD     (W-CNTL-KEY)
 15634*            END-EXEC
 15635*    MOVE '&"S        E          (   #00014710' TO DFHEIV0
 15636     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15637     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15638     MOVE X'2020233030303134373130' TO DFHEIV0(25:11)
 15639     CALL 'kxdfhei1' USING DFHEIV0,
 15640           W-CNTL-FILE-ID,
 15641           DFHEIV20,
 15642           DFHEIV99,
 15643           W-CNTL-KEY,
 15644           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 335
* EL689.cbl
 15645           DFHEIV99,
 15646           DFHEIV99
 15647     SET ADDRESS OF CONTROL-FILE TO
 15648         DFHEIV20
 15649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15650             MOVE CF-FORMS-PRINTER-ID
 15651                                 TO W-TS-TERM-TEXT.
 15652
 15653***********************************************************
 15654*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 15655*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 15656***********************************************************
 15657
 15658     SET W-TS-NDX                TO 1.
 15659     MOVE EIBTIME                TO W-TS-ID-TIME.
 15660     MOVE W-TS-NAME-TEXT         TO PI-689-TEMP-STOR-ID.
 15661     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 15662
 15663     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 15664             VARYING
 15665         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 15666             UNTIL
 15667         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 15668
 15669*    IF  EIBAID EQUAL DFHPF8
 15670*        MOVE '1'                TO PI-689-PRINT-SW
 15671*    ELSE
 15672         MOVE SPACES             TO PI-689-PRINT-SW.
 15673
 15674
 15675* EXEC CICS HANDLE CONDITION
 15676*         TERMIDERR  (7935-TERM-ERROR)
 15677*         TRANSIDERR (7940-TRAN-ERROR)
 15678*    END-EXEC.
 15679*    MOVE '"$[\                  ! < #00014739' TO DFHEIV0
 15680     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 15681     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15682     MOVE X'3C20233030303134373339' TO DFHEIV0(25:11)
 15683     CALL 'kxdfhei1' USING DFHEIV0
 15684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15685
 15686
 15687
 15688* EXEC CICS START
 15689*             INTERVAL    (0)
 15690*             TRANSID     (W-PRINT-TRANS)
 15691*             FROM        (PROGRAM-INTERFACE-BLOCK)
 15692*             LENGTH      (PI-COMM-LENGTH)
 15693*             TERMID      (W-TS-TERM-TEXT)
 15694*    END-EXEC.
 15695     MOVE 0 TO DFHEIV10
 15696*    MOVE '0(ILFT                1   #00014744' TO DFHEIV0
 15697     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 15698     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
 15699     MOVE X'2020233030303134373434' TO DFHEIV0(25:11)
 15700     CALL 'kxdfhei1' USING DFHEIV0,
 15701           DFHEIV10,
 15702           W-PRINT-TRANS,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 336
* EL689.cbl
 15703           DFHEIV99,
 15704           PROGRAM-INTERFACE-BLOCK,
 15705           PI-COMM-LENGTH,
 15706           W-TS-TERM-TEXT,
 15707           DFHEIV99,
 15708           DFHEIV99,
 15709           DFHEIV99,
 15710           DFHEIV99,
 15711           DFHEIV99,
 15712           DFHEIV99,
 15713           DFHEIV99,
 15714           DFHEIV99,
 15715           DFHEIV99,
 15716           DFHEIV99
 15717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15718
 15719
 15720
 15721* EXEC CICS SYNCPOINT
 15722*    END-EXEC.
 15723*    MOVE '6"                    !   #00014752' TO DFHEIV0
 15724     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
 15725     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15726     MOVE X'2020233030303134373532' TO DFHEIV0(25:11)
 15727     CALL 'kxdfhei1' USING DFHEIV0
 15728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15729
 15730
 15731     IF  PI-689-CREATE-NO-SCREENS
 15732         GO TO 7900-EXIT.
 15733
 15734*    IF  EIBAID EQUAL DFHPF8
 15735*            AND
 15736*        PI-SHOW-MODE
 15737*            AND
 15738*        LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES
 15739*        PERFORM 7920-UPDATE-INITIAL-PRINT THRU 7920-EXIT.
 15740
 15741     MOVE ER-0189                TO EMI-ERROR.
 15742     MOVE -1                     TO MAINTL.
 15743
 15744     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 15745     MOVE -1                     TO MAINTL
 15746     MOVE AL-UABON               TO MAINTA
 15747     MOVE '104A'                 TO W-TS-ID-TEXT
 15748     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 15749                                    W-TS-TERM-SCREEN
 15750     GO TO 8200-SEND-DATAONLY.
 15751
 15752 7900-EXIT.
 15753     EXIT.
 15754
 15755 7915-SEARCH-REMAINING-VARS.
 15756
 15757     IF  W-REC-CHAR (W-RVS-NDX) EQUAL '@'
 15758         SET W-RVS-NDX2          TO W-RVS-NDX
 15759         SET W-RVS-NDX2 UP BY +1
 15760         IF  W-REC-CHAR (W-RVS-NDX2) EQUAL '@'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 337
* EL689.cbl
 15761             SET W-RVS-NDX2 UP BY +1
 15762             IF  W-REC-CHAR (W-RVS-NDX2) NUMERIC
 15763                 SET PI-CURRENT-LINE  TO W-RVS-NDX
 15764                 COMPUTE PI-CURRENT-LINE
 15765                     = PI-CURRENT-LINE / 73
 15766                 MOVE 'Y'        TO W-REMAINING-VAR-SW
 15767                 MOVE +0         TO W-ROLL-COUNTER
 15768                 MOVE ER-0191    TO EMI-ERROR
 15769                 MOVE -1         TO MAINTL
 15770                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15771
 15772 7915-EXIT.
 15773     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 338
* EL689.cbl
 15775 7920-UPDATE-INITIAL-PRINT.
 15776
 15777
 15778* EXEC CICS HANDLE CONDITION
 15779*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 15780*         NOTFND     (1070-ARCH-NOT-FOUND)
 15781*         ENDFILE    (1070-ARCH-NOT-FOUND)
 15782*    END-EXEC.
 15783*    MOVE '"$JI''                 ! = #00014801' TO DFHEIV0
 15784     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 15785     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15786     MOVE X'3D20233030303134383031' TO DFHEIV0(25:11)
 15787     CALL 'kxdfhei1' USING DFHEIV0
 15788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15789
 15790     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
 15791     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 15792
 15793* EXEC CICS READ
 15794*        DATASET (W-ARCH-FILE-ID)
 15795*        SET     (ADDRESS OF LETTER-ARCHIVE)
 15796*        RIDFLD  (W-ARCH-PARTIAL-KEY)
 15797*        UPDATE
 15798*    END-EXEC.
 15799*    MOVE '&"S        EU         (   #00014808' TO DFHEIV0
 15800     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15801     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15802     MOVE X'2020233030303134383038' TO DFHEIV0(25:11)
 15803     CALL 'kxdfhei1' USING DFHEIV0,
 15804           W-ARCH-FILE-ID,
 15805           DFHEIV20,
 15806           DFHEIV99,
 15807           W-ARCH-PARTIAL-KEY,
 15808           DFHEIV99,
 15809           DFHEIV99,
 15810           DFHEIV99
 15811     SET ADDRESS OF LETTER-ARCHIVE TO
 15812         DFHEIV20
 15813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15814
 15815
 15816     MOVE W-SAVE-BIN-DATE        TO LA-INITIAL-PRINT-DATE.
 15817
 15818     IF  LA-RESEND-DATE = LOW-VALUES
 15819         MOVE 'C'                TO LA-STATUS.
 15820
 15821
 15822* EXEC CICS REWRITE
 15823*         FROM      (LETTER-ARCHIVE)
 15824*         DATASET   (W-ARCH-FILE-ID)
 15825*    END-EXEC.
 15826     MOVE LENGTH OF
 15827      LETTER-ARCHIVE
 15828       TO DFHEIV11
 15829*    MOVE '&& L                  %   #00014820' TO DFHEIV0
 15830     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15831     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15832     MOVE X'2020233030303134383230' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 339
* EL689.cbl
 15833     CALL 'kxdfhei1' USING DFHEIV0,
 15834           W-ARCH-FILE-ID,
 15835           LETTER-ARCHIVE,
 15836           DFHEIV11,
 15837           DFHEIV99
 15838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15839
 15840
 15841 7920-EXIT.
 15842     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 340
* EL689.cbl
 15844 7935-TERM-ERROR.
 15845
 15846     MOVE ER-0412                TO EMI-ERROR.
 15847     MOVE SPACES                 TO PI-689-PRINT-SW.
 15848     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15849     MOVE -1                     TO MAINTL.
 15850     GO TO 8200-SEND-DATAONLY.
 15851
 15852 7940-TRAN-ERROR.
 15853
 15854     MOVE ER-0413                TO EMI-ERROR.
 15855     MOVE SPACES                 TO PI-689-PRINT-SW.
 15856     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15857     MOVE -1                     TO MAINTL.
 15858     GO TO 8200-SEND-DATAONLY.
 15859
 15860 7945-NOT-FOUND.
 15861
 15862     MOVE ER-0190                TO EMI-ERROR.
 15863     MOVE -1                     TO MAINTL.
 15864     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15865     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 341
* EL689.cbl
 15867 8010-ARCH-NOT-OPEN.
 15868
 15869     MOVE ER-7388                TO EMI-ERROR.
 15870     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15871     MOVE -1                     TO MAINTL.
 15872     GO TO 8200-SEND-DATAONLY.
 15873
 15874 8015-ARCT-NOT-OPEN.
 15875
 15876     MOVE ER-7373                TO EMI-ERROR.
 15877     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15878     MOVE -1                     TO MAINTL.
 15879     GO TO 8200-SEND-DATAONLY.
 15880
 15881 8020-ACCT-NOT-OPEN.
 15882
 15883     MOVE ER-0168 TO EMI-ERROR
 15884     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15885     MOVE -1                     TO MAINTL.
 15886     GO TO 8200-SEND-DATAONLY.
 15887
 15888 8030-CERT-NOT-OPEN.
 15889
 15890     MOVE ER-0169 TO EMI-ERROR.
 15891     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15892     MOVE -1                     TO MAINTL.
 15893     GO TO 8200-SEND-DATAONLY.
 15894
 15895 8035-CERT-NOT-FOUND.
 15896
 15897     MOVE ER-2369 TO EMI-ERROR.
 15898     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15899     MOVE -1                     TO MAINTL.
 15900     GO TO 8200-SEND-DATAONLY.
 15901
 15902 8040-CNTL-NOT-OPEN.
 15903
 15904     MOVE ER-0042                TO EMI-ERROR.
 15905     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15906     MOVE -1                     TO MAINTL.
 15907     GO TO 8200-SEND-DATAONLY.
 15908
 15909 8045-CHEK-NOT-OPEN.
 15910
 15911     MOVE ER-3775                TO EMI-ERROR.
 15912     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15913     MOVE -1                     TO MAINTL.
 15914     GO TO 8200-SEND-DATAONLY.
 15915
 15916 8050-TEXT-NOT-OPEN.
 15917
 15918     MOVE ER-0013                TO EMI-ERROR.
 15919     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15920     MOVE -1                     TO MAINTL.
 15921     GO TO 8200-SEND-DATAONLY.
 15922
 15923 8060-PNDB-NOT-OPEN.
 15924
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 342
* EL689.cbl
 15925     MOVE ER-2216 TO EMI-ERROR.
 15926     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15927     MOVE -1                     TO MAINTL.
 15928     GO TO 8200-SEND-DATAONLY.
 15929
 15930 8070-PNDB-NOT-FOUND.
 15931
 15932     MOVE ER-7374 TO EMI-ERROR.
 15933     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15934     MOVE -1                     TO MAINTL.
 15935     GO TO 8200-SEND-DATAONLY.
 15936
 15937 8080-COMP-NOT-OPEN.
 15938
 15939     MOVE ER-2055 TO EMI-ERROR
 15940     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15941     MOVE -1                     TO MAINTL.
 15942     GO TO 8200-SEND-DATAONLY.
 15943
 15944 8085-PYAJ-NOT-OPEN.
 15945
 15946     MOVE ER-2232 TO EMI-ERROR
 15947     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15948     MOVE -1                     TO MAINTL.
 15949     GO TO 8200-SEND-DATAONLY.
 15950
 15951 8090-MAIL-NOT-OPEN.
 15952
 15953     MOVE ER-2999                TO EMI-ERROR.
 15954     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15955     MOVE -1                     TO MAINTL.
 15956     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 343
* EL689.cbl
 15958 8100-SEND-INITIAL-MAP.
 15959
 15960     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 15961     IF  PI-689-CREATE-NO-SCREENS
 15962         MOVE '9999'             TO PI-689-ERROR
 15963         GO TO 0620-RETURN-TO-CALLER.
 15964
 15965     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 15966
 15967     IF  NOT EMI-NO-ERRORS
 15968         MOVE EMI-MESSAGE-AREA (1)
 15969                                 TO ERRMSGO
 15970     ELSE
 15971         MOVE SPACES             TO ERRMSGO.
 15972     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 15973                                 TO SYSO
 15974     MOVE WS-KIXHOST             TO HOSTO
 15975     IF PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR 'CAGB'
 15976        OR 'DLVA' OR 'ECCA' OR 'KRHA'
 15977        MOVE AL-SADOF            TO PF8HDA
 15978     END-IF
 15979     IF NOT PI-CREATE-LABELS
 15980         MOVE AL-PANON           TO ADDRLBLA.
 15981
 15982
 15983* EXEC CICS SEND
 15984*        MAP    (W-MAP)
 15985*        MAPSET (W-MAPSET)
 15986*        FROM   (EL689AO)
 15987*        ERASE
 15988*        CURSOR
 15989*    END-EXEC.
 15990     MOVE LENGTH OF
 15991      EL689AO
 15992       TO DFHEIV12
 15993     MOVE -1
 15994       TO DFHEIV11
 15995*    MOVE '8$     CT  E    H L F ,   #00014966' TO DFHEIV0
 15996     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15997     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15998     MOVE X'2020233030303134393636' TO DFHEIV0(25:11)
 15999     CALL 'kxdfhei1' USING DFHEIV0,
 16000           W-MAP,
 16001           EL689AO,
 16002           DFHEIV12,
 16003           W-MAPSET,
 16004           DFHEIV99,
 16005           DFHEIV99,
 16006           DFHEIV99,
 16007           DFHEIV11,
 16008           DFHEIV99,
 16009           DFHEIV99,
 16010           DFHEIV99
 16011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16012
 16013
 16014     GO TO 9000-RETURN-TRANS.
 16015
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 344
* EL689.cbl
 16016 8100-EXIT.
 16017     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 345
* EL689.cbl
 16019 8200-SEND-DATAONLY.
 16020
 16021     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 16022     IF  PI-689-CREATE-NO-SCREENS
 16023         MOVE '9999'             TO PI-689-ERROR
 16024         GO TO 0620-RETURN-TO-CALLER.
 16025
 16026     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 16027
 16028     IF EMI-ERROR = ER-0715
 16029         DISPLAY 'ER 0715'
 16030         MOVE -1          TO CERTIDL
 16031         MOVE +0          TO MAINTL
 16032     END-IF
 16033
 16034     IF  NOT EMI-NO-ERRORS
 16035         MOVE EMI-MESSAGE-AREA (1)
 16036                                 TO ERRMSGO
 16037     ELSE
 16038         MOVE SPACES             TO ERRMSGO.
 16039
 16040
 16041* EXEC CICS SEND
 16042*        MAP    (W-MAP)
 16043*        MAPSET (W-MAPSET)
 16044*        FROM   (EL689AO)
 16045*        DATAONLY
 16046*        CURSOR
 16047*    END-EXEC.
 16048     MOVE LENGTH OF
 16049      EL689AO
 16050       TO DFHEIV12
 16051     MOVE -1
 16052       TO DFHEIV11
 16053*    MOVE '8$D    CT       H L F ,   #00015000' TO DFHEIV0
 16054     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16055     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16056     MOVE X'2020233030303135303030' TO DFHEIV0(25:11)
 16057     CALL 'kxdfhei1' USING DFHEIV0,
 16058           W-MAP,
 16059           EL689AO,
 16060           DFHEIV12,
 16061           W-MAPSET,
 16062           DFHEIV99,
 16063           DFHEIV99,
 16064           DFHEIV99,
 16065           DFHEIV11,
 16066           DFHEIV99,
 16067           DFHEIV99,
 16068           DFHEIV99
 16069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16070
 16071
 16072     GO TO 9000-RETURN-TRANS.
 16073
 16074 8200-EXIT.
 16075     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 346
* EL689.cbl
 16077 8300-SEND-TEXT.
 16078
 16079     IF  PI-689-CREATE-NO-SCREENS
 16080         MOVE '9999'             TO PI-689-ERROR
 16081         GO TO 0620-RETURN-TO-CALLER.
 16082
 16083
 16084* EXEC CICS SEND TEXT
 16085*        FROM    (LOGOFF-TEXT)
 16086*        LENGTH  (LOGOFF-LENGTH)
 16087*        ERASE
 16088*        FREEKB
 16089*    END-EXEC.
 16090*    MOVE '8&      T  E F  H   F -   #00015019' TO DFHEIV0
 16091     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16092     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16093     MOVE X'2020233030303135303139' TO DFHEIV0(25:11)
 16094     CALL 'kxdfhei1' USING DFHEIV0,
 16095           LOGOFF-TEXT,
 16096           LOGOFF-LENGTH,
 16097           DFHEIV99,
 16098           DFHEIV99,
 16099           DFHEIV99,
 16100           DFHEIV99,
 16101           DFHEIV99,
 16102           DFHEIV99,
 16103           DFHEIV99,
 16104           DFHEIV99,
 16105           DFHEIV99,
 16106           DFHEIV99
 16107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16108
 16109
 16110     GO TO 9000-RETURN-TRANS.
 16111
 16112 8300-EXIT.
 16113     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 347
* EL689.cbl
 16115 8350-SEND-DATAONLY-ERASEAUP.
 16116
 16117     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 16118     PERFORM 7760-PUT-TEMP-STORAGE
 16119                                 THRU 7760-EXIT
 16120     IF  PI-689-CREATE-NO-SCREENS
 16121         MOVE '9999'             TO PI-689-ERROR
 16122         GO TO 0620-RETURN-TO-CALLER.
 16123
 16124     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 16125
 16126     IF EMI-ERROR = ER-0715
 16127         DISPLAY 'ER 0715'
 16128         MOVE -1          TO CERTIDL
 16129         MOVE +0          TO MAINTL
 16130     END-IF
 16131
 16132     IF  NOT EMI-NO-ERRORS
 16133         MOVE EMI-MESSAGE-AREA (1)
 16134                                 TO ERRMSGO
 16135     ELSE
 16136         MOVE SPACES             TO ERRMSGO.
 16137
 16138
 16139* EXEC CICS SEND
 16140*        MAP      (W-MAP)
 16141*        MAPSET   (W-MAPSET)
 16142*        FROM     (EL689AO)
 16143*        DATAONLY
 16144*        ERASEAUP
 16145*        CURSOR
 16146*    END-EXEC.
 16147     MOVE LENGTH OF
 16148      EL689AO
 16149       TO DFHEIV12
 16150     MOVE -1
 16151       TO DFHEIV11
 16152*    MOVE '8$D    CT  A    H L F ,   #00015054' TO DFHEIV0
 16153     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 16154     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16155     MOVE X'2020233030303135303534' TO DFHEIV0(25:11)
 16156     CALL 'kxdfhei1' USING DFHEIV0,
 16157           W-MAP,
 16158           EL689AO,
 16159           DFHEIV12,
 16160           W-MAPSET,
 16161           DFHEIV99,
 16162           DFHEIV99,
 16163           DFHEIV99,
 16164           DFHEIV11,
 16165           DFHEIV99,
 16166           DFHEIV99,
 16167           DFHEIV99
 16168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16169
 16170
 16171     GO TO 9000-RETURN-TRANS.
 16172
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 348
* EL689.cbl
 16173 8350-EXIT.
 16174     EXIT.
 16175
 16176 8600-DEEDIT.
 16177
 16178
 16179* EXEC CICS BIF DEEDIT
 16180*         FIELD    (W-DEEDIT-FIELD)
 16181*         LENGTH   (15)
 16182*    END-EXEC.
 16183     MOVE 15
 16184       TO DFHEIV11
 16185*    MOVE '@"L                   #   #00015070' TO DFHEIV0
 16186     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 16187     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16188     MOVE X'2020233030303135303730' TO DFHEIV0(25:11)
 16189     CALL 'kxdfhei1' USING DFHEIV0,
 16190           W-DEEDIT-FIELD,
 16191           DFHEIV11
 16192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16193
 16194
 16195 8600-EXIT.
 16196     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 349
* EL689.cbl
 16198 9000-RETURN-TRANS.
 16199
 16200     MOVE EMI-FATAL-CTR      TO PI-689-FATAL-CTR
 16201     MOVE EMI-FORCABLE-CTR   TO PI-689-FORCABLE-CTR
 16202     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 16203     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
 16204
 16205* EXEC CICS RETURN
 16206*        TRANSID    (W-TRANSACTION)
 16207*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 16208*        LENGTH     (PI-COMM-LENGTH)
 16209*    END-EXEC.
 16210*    MOVE '.(CT                  ''   #00015084' TO DFHEIV0
 16211     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16212     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16213     MOVE X'2020233030303135303834' TO DFHEIV0(25:11)
 16214     CALL 'kxdfhei1' USING DFHEIV0,
 16215           W-TRANSACTION,
 16216           PROGRAM-INTERFACE-BLOCK,
 16217           PI-COMM-LENGTH,
 16218           DFHEIV99,
 16219           DFHEIV99,
 16220           DFHEIV99
 16221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16222
 16223*    MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 16224*    MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16225*    GO TO 0200-RECEIVE.
 16226
 16227 9000-EXIT.
 16228     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 350
* EL689.cbl
 16230 9200-PA.
 16231
 16232     MOVE ER-0008                TO EMI-ERROR.
 16233     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16234     MOVE -1                     TO MAINTL.
 16235     GO TO 8200-SEND-DATAONLY.
 16236
 16237 9200-EXIT.
 16238     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 351
* EL689.cbl
 16240 9300-DFHCLEAR.
 16241
 16242     IF PI-RETURN-TO-PROGRAM = 'EL689' OR 'EL690'
 16243         MOVE '2'                TO PI-ACTION.
 16244
 16245     IF  PI-CLEAR-MODE
 16246         MOVE PI-RETURN-TO-PROGRAM
 16247                                 TO W-CALL-PGM
 16248         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 16249         GO TO 9400-XCTL
 16250     ELSE
 16251         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 16252         MOVE LOW-VALUES         TO EL689AO
 16253                                    PI-1042-WA
 16254                                    PI-689-WORK-AREA
 16255         MOVE ZEROS              TO PI-CURRENT-LINE
 16256                                    PI-TEMP-STOR-ITEMS
 16257                                    PI-TOTAL-LINES
 16258                                    PI-UPDATE-SW
 16259                                    PI-689-NUMBER-LABEL-LINES
 16260         MOVE SPACES             TO PI-689-PRINT-SW
 16261                                    PI-689-ALT-PRINTER-ID
 16262                                    PI-COMM-CONTROL
 16263                                    PI-689-FORM-NUMBER
 16264                                    PI-689-TEMP-STOR-ID
 16265                                    PI-689-LABEL-SOURCE
 16266                                    PI-689-USE-SCREEN-IND
 16267         MOVE '2'                TO PI-ACTION
 16268         MOVE -1                 TO MAINTL
 16269         GO TO 8100-SEND-INITIAL-MAP.
 16270
 16271 9300-EXIT.
 16272     EXIT.
 16273
 16274 9400-XCTL.
 16275
 16276
 16277* EXEC CICS XCTL
 16278*        PROGRAM  (W-CALL-PGM)
 16279*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 16280*        LENGTH   (PI-COMM-LENGTH)
 16281*    END-EXEC.
 16282*    MOVE '.$C                   %   #00015142' TO DFHEIV0
 16283     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16284     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16285     MOVE X'2020233030303135313432' TO DFHEIV0(25:11)
 16286     CALL 'kxdfhei1' USING DFHEIV0,
 16287           W-CALL-PGM,
 16288           PROGRAM-INTERFACE-BLOCK,
 16289           PI-COMM-LENGTH,
 16290           DFHEIV99
 16291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16292
 16293
 16294 9400-EXIT.
 16295     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 352
* EL689.cbl
 16297 9500-LINK-DATE-CONVERT.
 16298
 16299     IF  DC-BIN-DATE-1 EQUAL HIGH-VALUES
 16300             AND
 16301         DC-OPTION-CODE EQUAL ' '
 16302         MOVE '99/99/99'         TO DC-GREG-DATE-1-EDIT
 16303         GO TO 9500-EXIT.
 16304
 16305
 16306* EXEC CICS LINK
 16307*        PROGRAM    ('ELDATCV')
 16308*        COMMAREA   (DATE-CONVERSION-DATA)
 16309*        LENGTH     (DC-COMM-LENGTH)
 16310*    END-EXEC.
 16311     MOVE 'ELDATCV' TO DFHEIV1
 16312*    MOVE '."C                   (   #00015159' TO DFHEIV0
 16313     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16314     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16315     MOVE X'2020233030303135313539' TO DFHEIV0(25:11)
 16316     CALL 'kxdfhei1' USING DFHEIV0,
 16317           DFHEIV1,
 16318           DATE-CONVERSION-DATA,
 16319           DC-COMM-LENGTH,
 16320           DFHEIV99,
 16321           DFHEIV99,
 16322           DFHEIV99,
 16323           DFHEIV99
 16324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16325
 16326
 16327     IF  NO-CONVERSION-ERROR
 16328             AND
 16329         PI-COMPANY-ID EQUAL 'AUK'
 16330             AND
 16331         W-REVERSE-DATE
 16332         MOVE DC-GREG-DATE-1-EDIT
 16333                                 TO W-EDIT-DATE-1
 16334         MOVE W-ED1-MM           TO W-ED2-MM
 16335         MOVE W-ED1-DD           TO W-ED2-DD
 16336         MOVE W-ED1-YY           TO W-ED2-YY
 16337         MOVE W-EDIT-DATE-2      TO DC-GREG-DATE-1-EDIT.
 16338
 16339 9500-EXIT.
 16340     EXIT.
 16341
 16342 9600-FORMAT-DATE-TIME.
 16343
 16344     MOVE W-SAVE-DATE            TO RUNDTEO.
 16345     MOVE EIBTIME                TO W-TIME-IN.
 16346     MOVE W-TIME-OUT             TO RUNTIMEO.
 16347     MOVE PI-COMPANY-ID          TO COMPANYO.
 16348     MOVE PI-PROCESSOR-ID        TO USERIDO.
 16349     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 16350
 16351 9600-EXIT.
 16352     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 353
* EL689.cbl
 16354 9700-PGMID-ERROR.
 16355
 16356     IF  PI-689-CREATE-NO-SCREENS
 16357         MOVE '9999'             TO PI-689-ERROR
 16358         GO TO 0620-RETURN-TO-CALLER.
 16359
 16360
 16361* EXEC CICS  HANDLE CONDITION
 16362*        PGMIDERR  (8300-SEND-TEXT)
 16363*    END-EXEC.
 16364*    MOVE '"$L                   ! > #00015198' TO DFHEIV0
 16365     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16367     MOVE X'3E20233030303135313938' TO DFHEIV0(25:11)
 16368     CALL 'kxdfhei1' USING DFHEIV0
 16369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16370
 16371
 16372     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
 16373     MOVE ' '                    TO PI-ENTRY-CD-1.
 16374     MOVE W-XCTL-005             TO W-CALL-PGM
 16375                                    LOGOFF-PGM.
 16376     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16377
 16378     PERFORM 9400-XCTL THRU 9400-EXIT.
 16379
 16380 9700-EXIT.
 16381     EXIT.
 16382
 16383 9800-ABEND.
 16384
 16385     IF  PI-689-CREATE-NO-SCREENS
 16386         MOVE '9999'             TO PI-689-ERROR
 16387         GO TO 0620-RETURN-TO-CALLER.
 16388
 16389     MOVE W-LINK-004             TO W-CALL-PGM.
 16390     MOVE DFHEIBLK               TO EMI-LINE1
 16391
 16392
 16393* EXEC CICS  LINK
 16394*        PROGRAM   (W-CALL-PGM)
 16395*        COMMAREA  (EMI-LINE1)
 16396*        LENGTH    (72)
 16397*    END-EXEC.
 16398     MOVE 72
 16399       TO DFHEIV11
 16400*    MOVE '."C                   (   #00015222' TO DFHEIV0
 16401     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16402     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16403     MOVE X'2020233030303135323232' TO DFHEIV0(25:11)
 16404     CALL 'kxdfhei1' USING DFHEIV0,
 16405           W-CALL-PGM,
 16406           EMI-LINE1,
 16407           DFHEIV11,
 16408           DFHEIV99,
 16409           DFHEIV99,
 16410           DFHEIV99,
 16411           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 354
* EL689.cbl
 16412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16413
 16414
 16415     GO TO 8200-SEND-DATAONLY.
 16416
 16417 9800-EXIT.
 16418     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 355
* EL689.cbl
 16420 9900-ERROR-FORMAT.
 16421
 16422     IF  PI-689-CREATE-NO-SCREENS
 16423         MOVE EMI-ERROR          TO PI-689-ERROR
 16424         IF  PI-689-FATAL-ERROR
 16425             GO TO 0620-RETURN-TO-CALLER
 16426         ELSE
 16427             GO TO 9900-EXIT.
 16428
 16429     IF  EMI-ERROR EQUAL ER-9097
 16430         NEXT SENTENCE
 16431     ELSE
 16432         IF  EMI-ERRORS-COMPLETE
 16433                 OR
 16434             EMI-ERROR EQUAL W-LAST-ERROR
 16435             GO TO 9900-EXIT.
 16436
 16437     MOVE W-LINK-001             TO W-CALL-PGM.
 16438
 16439
 16440* EXEC CICS LINK
 16441*        PROGRAM    (W-CALL-PGM)
 16442*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 16443*        LENGTH     (EMI-COMM-LENGTH)
 16444*    END-EXEC.
 16445*    MOVE '."C                   (   #00015252' TO DFHEIV0
 16446     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16447     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16448     MOVE X'2020233030303135323532' TO DFHEIV0(25:11)
 16449     CALL 'kxdfhei1' USING DFHEIV0,
 16450           W-CALL-PGM,
 16451           ERROR-MESSAGE-INTERFACE-BLOCK,
 16452           EMI-COMM-LENGTH,
 16453           DFHEIV99,
 16454           DFHEIV99,
 16455           DFHEIV99,
 16456           DFHEIV99
 16457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16458
 16459
 16460     IF  EMI-SEVERITY (2) EQUAL 'X'
 16461             AND
 16462         EMI-SEVERITY (1) NOT EQUAL 'X'
 16463         MOVE EMI-MESSAGE-AREA (2)
 16464                                 TO EMI-MESSAGE-AREA (1).
 16465
 16466     MOVE EMI-ERROR              TO W-LAST-ERROR.
 16467
 16468 9900-EXIT.
 16469     EXIT.
 16470
 16471 9905-INITIALIZE-SECURITY.
 16472******************************************************************
 16473*                                                                *
 16474*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
 16475*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
 16476*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
 16477*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 356
* EL689.cbl
 16478*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
 16479*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
 16480*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
 16481*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
 16482*                                                                *
 16483*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
 16484*       IS ALSO PROVIDED BY THIS LOGIC.                          *
 16485*                                                                *
 16486******************************************************************
 16487
 16488     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
 16489         MOVE 'Y'                TO PI-DISPLAY-CAP
 16490                                    PI-MODIFY-CAP
 16491     ELSE
 16492
 16493* EXEC CICS READQ TS
 16494*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
 16495*            INTO   (SECURITY-CONTROL)
 16496*            LENGTH (SC-COMM-LENGTH)
 16497*            ITEM   (1)
 16498*        END-EXEC
 16499     MOVE 1
 16500       TO DFHEIV11
 16501*    MOVE '*$II   L              ''   #00015290' TO DFHEIV0
 16502     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 16503     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16504     MOVE X'2020233030303135323930' TO DFHEIV0(25:11)
 16505     CALL 'kxdfhei1' USING DFHEIV0,
 16506           PI-SECURITY-TEMP-STORE-ID,
 16507           SECURITY-CONTROL,
 16508           SC-COMM-LENGTH,
 16509           DFHEIV11,
 16510           DFHEIV99,
 16511           DFHEIV99
 16512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16513         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
 16514                                 TO PI-DISPLAY-CAP
 16515         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
 16516                                 TO PI-MODIFY-CAP.
 16517
 16518 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 357
* EL689.cbl
 16520 9995-SECURITY-VIOLATION.
 16521
 16522     MOVE EIBDATE                TO SM-JUL-DATE.
 16523     MOVE EIBTRMID               TO SM-TERMID.
 16524     MOVE W-THIS-PGM             TO SM-PGM.
 16525     MOVE EIBTIME                TO W-TIME-IN.
 16526     MOVE W-TIME-OUT             TO SM-TIME.
 16527     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
 16528
 16529
 16530* EXEC CICS LINK
 16531*         PROGRAM  ('EL003')
 16532*         COMMAREA (SECURITY-MESSAGE)
 16533*         LENGTH   (80)
 16534*    END-EXEC.
 16535     MOVE 'EL003' TO DFHEIV1
 16536     MOVE 80
 16537       TO DFHEIV11
 16538*    MOVE '."C                   (   #00015312' TO DFHEIV0
 16539     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16540     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16541     MOVE X'2020233030303135333132' TO DFHEIV0(25:11)
 16542     CALL 'kxdfhei1' USING DFHEIV0,
 16543           DFHEIV1,
 16544           SECURITY-MESSAGE,
 16545           DFHEIV11,
 16546           DFHEIV99,
 16547           DFHEIV99,
 16548           DFHEIV99,
 16549           DFHEIV99
 16550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16551
 16552
 16553 9995-EXIT.
 16554     EXIT.
 16555
 16556 9999-GOBACK.
 16557
 16558
 16559* GOBACK.
 16560     MOVE '9%                    "   ' TO DFHEIV0
 16561     MOVE 'EL689' TO DFHEIV1
 16562     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16563     GOBACK.
 16564
 16565 9999-EXIT.
 16566     EXIT.
 16567
 16568 9999-DFHBACK SECTION.
 16569     MOVE '9%                    "   ' TO DFHEIV0
 16570     MOVE 'EL689' TO DFHEIV1
 16571     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16572     GOBACK.
 16573 9999-DFHEXIT.
 16574     IF DFHEIGDJ EQUAL 0001
 16575         NEXT SENTENCE
 16576     ELSE IF DFHEIGDJ EQUAL 2
 16577         GO TO 9300-DFHCLEAR,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 358
* EL689.cbl
 16578               9200-PA,
 16579               9200-PA,
 16580               9200-PA
 16581         DEPENDING ON DFHEIGDI
 16582     ELSE IF DFHEIGDJ EQUAL 3
 16583         GO TO 9700-PGMID-ERROR,
 16584               9800-ABEND,
 16585               0325-MAPFAIL
 16586         DEPENDING ON DFHEIGDI
 16587     ELSE IF DFHEIGDJ EQUAL 4
 16588         GO TO 8040-CNTL-NOT-OPEN,
 16589               7945-NOT-FOUND
 16590         DEPENDING ON DFHEIGDI
 16591     ELSE IF DFHEIGDJ EQUAL 5
 16592         GO TO 9700-PGMID-ERROR,
 16593               0325-MAPFAIL,
 16594               9800-ABEND
 16595         DEPENDING ON DFHEIGDI
 16596     ELSE IF DFHEIGDJ EQUAL 6
 16597         GO TO 0990-CARRIER-NOT-FOUND,
 16598               8040-CNTL-NOT-OPEN
 16599         DEPENDING ON DFHEIGDI
 16600     ELSE IF DFHEIGDJ EQUAL 7
 16601         GO TO 0994-STATE-NOT-FOUND,
 16602               8040-CNTL-NOT-OPEN
 16603         DEPENDING ON DFHEIGDI
 16604     ELSE IF DFHEIGDJ EQUAL 8
 16605         GO TO 8010-ARCH-NOT-OPEN,
 16606               1070-ARCH-NOT-FOUND,
 16607               1070-ARCH-NOT-FOUND
 16608         DEPENDING ON DFHEIGDI
 16609     ELSE IF DFHEIGDJ EQUAL 9
 16610         GO TO 2001-NOT-FOUND,
 16611               2001-NOT-FOUND,
 16612               8050-TEXT-NOT-OPEN
 16613         DEPENDING ON DFHEIGDI
 16614     ELSE IF DFHEIGDJ EQUAL 10
 16615         GO TO 2000-ENDBR
 16616         DEPENDING ON DFHEIGDI
 16617     ELSE IF DFHEIGDJ EQUAL 11
 16618         GO TO 8040-CNTL-NOT-OPEN,
 16619               6200-CNTL1-NOT-FOUND
 16620         DEPENDING ON DFHEIGDI
 16621     ELSE IF DFHEIGDJ EQUAL 12
 16622         GO TO 8040-CNTL-NOT-OPEN,
 16623               6250-CNTL2-NOT-FOUND
 16624         DEPENDING ON DFHEIGDI
 16625     ELSE IF DFHEIGDJ EQUAL 13
 16626         GO TO 8040-CNTL-NOT-OPEN,
 16627               6300-CNTL6-NOT-FOUND
 16628         DEPENDING ON DFHEIGDI
 16629     ELSE IF DFHEIGDJ EQUAL 14
 16630         GO TO 8040-CNTL-NOT-OPEN,
 16631               6350-CNTL2-NOT-FOUND
 16632         DEPENDING ON DFHEIGDI
 16633     ELSE IF DFHEIGDJ EQUAL 15
 16634         GO TO 8060-PNDB-NOT-OPEN,
 16635               8070-PNDB-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 359
* EL689.cbl
 16636         DEPENDING ON DFHEIGDI
 16637     ELSE IF DFHEIGDJ EQUAL 16
 16638         GO TO 8030-CERT-NOT-OPEN,
 16639               8035-CERT-NOT-FOUND
 16640         DEPENDING ON DFHEIGDI
 16641     ELSE IF DFHEIGDJ EQUAL 17
 16642         GO TO 8020-ACCT-NOT-OPEN,
 16643               6500-ACCT-NOT-FOUND,
 16644               6500-ONLY-STOP
 16645         DEPENDING ON DFHEIGDI
 16646     ELSE IF DFHEIGDJ EQUAL 18
 16647         GO TO 8080-COMP-NOT-OPEN,
 16648               6600-COMP-NOT-FOUND
 16649         DEPENDING ON DFHEIGDI
 16650     ELSE IF DFHEIGDJ EQUAL 19
 16651         GO TO 8040-CNTL-NOT-OPEN,
 16652               6630-CNTL2-NOT-FOUND
 16653         DEPENDING ON DFHEIGDI
 16654     ELSE IF DFHEIGDJ EQUAL 20
 16655         GO TO 8090-MAIL-NOT-OPEN,
 16656               6700-MAIL-NOT-FOUND
 16657         DEPENDING ON DFHEIGDI
 16658     ELSE IF DFHEIGDJ EQUAL 21
 16659         GO TO 8040-CNTL-NOT-OPEN,
 16660               6750-EXIT
 16661         DEPENDING ON DFHEIGDI
 16662     ELSE IF DFHEIGDJ EQUAL 22
 16663         GO TO 8040-CNTL-NOT-OPEN,
 16664               6800-EXIT
 16665         DEPENDING ON DFHEIGDI
 16666     ELSE IF DFHEIGDJ EQUAL 23
 16667         GO TO 8045-CHEK-NOT-OPEN,
 16668               6850-CHEK-NOT-FOUND
 16669         DEPENDING ON DFHEIGDI
 16670     ELSE IF DFHEIGDJ EQUAL 24
 16671         GO TO 8085-PYAJ-NOT-OPEN,
 16672               6900-PYAJ-NOT-FOUND
 16673         DEPENDING ON DFHEIGDI
 16674     ELSE IF DFHEIGDJ EQUAL 25
 16675         GO TO 7700-TS-ERROR,
 16676               7700-TS-ERROR
 16677         DEPENDING ON DFHEIGDI
 16678     ELSE IF DFHEIGDJ EQUAL 26
 16679         GO TO 7780-EXIT
 16680         DEPENDING ON DFHEIGDI
 16681     ELSE IF DFHEIGDJ EQUAL 27
 16682         GO TO 8040-CNTL-NOT-OPEN,
 16683               7945-NOT-FOUND
 16684         DEPENDING ON DFHEIGDI
 16685     ELSE IF DFHEIGDJ EQUAL 28
 16686         GO TO 7935-TERM-ERROR,
 16687               7940-TRAN-ERROR
 16688         DEPENDING ON DFHEIGDI
 16689     ELSE IF DFHEIGDJ EQUAL 29
 16690         GO TO 8010-ARCH-NOT-OPEN,
 16691               1070-ARCH-NOT-FOUND,
 16692               1070-ARCH-NOT-FOUND
 16693         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:05 Page 360
* EL689.cbl
 16694     ELSE IF DFHEIGDJ EQUAL 30
 16695         GO TO 8300-SEND-TEXT
 16696         DEPENDING ON DFHEIGDI.
 16697     MOVE '9%                    "   ' TO DFHEIV0
 16698     MOVE 'EL689' TO DFHEIV1
 16699     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16700     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       98740     Code:       54740
