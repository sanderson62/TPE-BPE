* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35* 020613    2012092400007  AJRA  ADD CAUSAL STATE MESSAGE
    36******************************************************************
    37
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   3
* EL130.cbl
    39 ENVIRONMENT DIVISION.
    40 DATA DIVISION.
    41 WORKING-STORAGE SECTION.
    42 01  DFH-START PIC X(04).
    43 77  FILLER  PIC X(32)  VALUE '********************************'.
    44 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    45 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    46
    47*    COPY ELCSCTM.
    48******************************************************************
    49*                                                                *
    50*                                                                *
    51*                            ELCSCTM                             *
    52*                            VMOD=2.001                          *
    53*                                                                *
    54*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    55*                                                                *
    56******************************************************************
    57 01  SECURITY-MESSAGE.
    58     12  FILLER                          PIC X(30)
    59            VALUE '** LOGIC SECURITY VIOLATION -'.
    60     12  SM-READ                         PIC X(6).
    61     12  FILLER                          PIC X(5)
    62            VALUE ' PGM='.
    63     12  SM-PGM                          PIC X(6).
    64     12  FILLER                          PIC X(5)
    65            VALUE ' OPR='.
    66     12  SM-PROCESSOR-ID                 PIC X(4).
    67     12  FILLER                          PIC X(6)
    68            VALUE ' TERM='.
    69     12  SM-TERMID                       PIC X(4).
    70     12  FILLER                          PIC XX   VALUE SPACE.
    71     12  SM-JUL-DATE                     PIC 9(5).
    72     12  FILLER                          PIC X    VALUE SPACE.
    73     12  SM-TIME                         PIC 99.99.
    74
    75
    76*    COPY ELCSCRTY.
    77******************************************************************
    78*                                                                *
    79*                                                                *
    80*                            ELCSCRTY                            *
    81*                            VMOD=2.001                          *
    82*                                                                *
    83*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    84*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    85*        SAVED IN PI-SECURITY-ADDRESS.                           *
    86*                                                                *
    87******************************************************************
    88 01  SECURITY-CONTROL.
    89     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    90     12  FILLER                       PIC XX    VALUE 'SC'.
    91     12  SC-CREDIT-CODES.
    92         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    93             20  SC-CREDIT-DISPLAY    PIC X.
    94             20  SC-CREDIT-UPDATE     PIC X.
    95     12  SC-CLAIMS-CODES.
    96         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   4
* EL130.cbl
    97             20  SC-CLAIMS-DISPLAY    PIC X.
    98             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   5
* EL130.cbl
   100 01  WS-DATE-AREA.
   101     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   102     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   103     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   104
   105 01  WS-CRI-SSN-WORK-AREA.
   106     05  WS-CRI-SOC-SEC-NO.
   107         10  WS-SS-REPT-CD       PIC X(5).
   108         10  WS-SS-LAST-NAME     PIC X(5).
   109         10  WS-SS-INITIAL       PIC X.
   110
   111     05  WS-CRI-REPORT-CODE.
   112         10  FILLER              PIC X(5).
   113         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   114
   115     05  WS-CRI-LAST-NAME.
   116         10  WS-CRI-NAME-MOVE    PIC X(5).
   117         10  FILLER              PIC X(10).
   118
   119 01  STANDARD-AREAS.
   120     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   121     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   122     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   123     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   124     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   125     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   126     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   127     12  PGM-NAME            PIC X(8).
   128     12  TIME-IN             PIC S9(7).
   129     12  TIME-OUT-R  REDEFINES TIME-IN.
   130         16  FILLER          PIC X.
   131         16  TIME-OUT        PIC 99V99.
   132         16  FILLER          PIC X(2).
   133     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   134     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   135     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   136     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   137     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   138     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   139     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   140     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   141     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   142     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   143     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   144     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   145     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   146     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   147     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   148     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   149     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   150     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   151     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   152     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   153     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   154     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
   155     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   156     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   157     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   6
* EL130.cbl
   158     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   159     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   160     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   161     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   162     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   163     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   164     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   165     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   166     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   167     12  FILE-ID             PIC X(8).
   168     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   169     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   170     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   171     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   172     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   173     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   174     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   175     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   176     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +550.
   177
   178 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   179     12  M                   PIC S9(7)V99           VALUE ZEROS.
   180     12  L                   PIC S9(7)V99           VALUE ZEROS.
   181     12  N                   PIC S9(3)              VALUE ZEROS.
   182     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   183     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   184     12  I                   PIC S99V9(5)           VALUE ZEROS.
   185     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   186     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   187     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   188     12  R                   PIC S9(3)              VALUE ZEROS.
   189     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   190     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   191     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   192     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   193     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   194     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   195     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   196     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   197     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   198
   199 01  TERM-CALC-WORK-AREA.
   200     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   201     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   202     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   203     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   204     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   205     12  V-EXPONENTS.
   206        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   207     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   208
   209 01  MISC-WORK-AREAS.
   210     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   211     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   212     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
   213     12  QID.
   214         16  QID-TERM        PIC X(4).
   215         16  FILLER          PIC X(4)    VALUE '130A'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   7
* EL130.cbl
   216     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   217     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   218     12  WS-GROUP-NO.
   219         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   220         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   221
   222     12  WS-RESPONSE         PIC S9(8)   COMP.
   223         88  WS-RESP-NORMAL              VALUE +00.
   224         88  WS-RESP-ERROR               VALUE +01.
   225         88  WS-RESP-NOTFND              VALUE +13.
   226
   227***************************************************************
   228*                                                             *
   229*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   230*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   231*    CHANGES WITH IN MAP EL130A.                              *
   232*                                                             *
   233***************************************************************
   234
   235     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   236     12  WS-SAVE-CLAIM-MASTER.
   237         16  FILLER                    PIC XX.
   238         16  WS-SAVE-CLAIM-KEY.
   239             20  WS-SAVE-COMPANY-CD    PIC X.
   240             20  WS-SAVE-CARRIER       PIC X.
   241             20  WS-SAVE-CLAIM-NO      PIC X(7).
   242             20  WS-SAVE-CERT-NO       PIC X(11).
   243         16  FILLER                    PIC X(328).
   244     12  SAVE-CURRENT-DATE         PIC XX.
   245     12  SAVE-CONTROL              PIC X(39).
   246     12  SAVE-ERACCT-KEY           PIC X(26).
   247     12  SAVE-COUNTER              PIC S9(8)   COMP.
   248     12  SAVE-METHOD               PIC X.
   249     12  SAVE-COMPANY-ID           PIC XXX.
   250     12  SAVE-COMPANY-CD           PIC X.
   251     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   252     12  SAVE-CREDIT-USER          PIC X.
   253     12  SAVE-CLAIM-USER           PIC X.
   254     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   255     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   256     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   257     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   258     12  SAVE-AH-OVERRIDE-L1       PIC X.
   259     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   260     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   261     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   262     12  FILLER                    PIC X.
   263*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   264     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   265     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   266     12  SAVE-EL127-TO-EL130-CNTRL.
   267         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
   268         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   269         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   270             20  SAVE-EL127-CARRIER  PIC X.
   271             20  SAVE-EL127-GROUPING PIC X(6).
   272             20  SAVE-EL127-STATE    PIC X(2).
   273             20  SAVE-EL127-ACCOUNT  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   8
* EL130.cbl
   274             20  SAVE-EL127-CERT-NO  PIC X(11).
   275             20  SAVE-EL127-EFF-DT   PIC XX.
   276     12  SAVE-EL659-TO-EL130-CNTRL.
   277         16  SAVE-EL659-CARRIER    PIC X.
   278         16  SAVE-EL659-GROUPING   PIC X(6).
   279         16  SAVE-EL659-STATE      PIC XX.
   280         16  SAVE-EL659-ACCOUNT    PIC X(10).
   281     12  DIVIDE-QUOT               PIC 999.
   282     12  DIVIDE-REM                PIC 999.
   283     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   284     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   285     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   286     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   287     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   288     12  WS-RESERVE-CONTROLS       PIC X(9).
   289     12  WS-EXPENSE-CONTROLS       PIC X(7).
   290     12  WS-REIN-TABLE.
   291         16  WS-REIN-1             PIC X            VALUE SPACE.
   292         16  WS-REIN-2             PIC X            VALUE SPACE.
   293         16  WS-REIN-3             PIC X            VALUE SPACE.
   294     12  WS-BENE-CALC-METHOD       PIC X.
   295     12  WS-EARNINGS-CALC          PIC X.
   296     12  WS-LF-EARNINGS-CALC       PIC X.
   297         88 TEX-REG                VALUE '4'.
   298         88 NET-PAY                VALUE '5'.
   299     12  WS-AH-EARNINGS-CALC       PIC X.
   300     12  WS-SPECIAL-CALC-CD        PIC X(01).
   301     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   302     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   303     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   304     12  WS-CLAIM-NUMBER.
   305         16  WS-CN-PREFIX.
   306             20  WS-CN-PRF-A PIC X.
   307             20  WS-CN-PRF-B PIC X.
   308         16  WS-CN-NUMBER    PIC 9(5).
   309     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   310     12  WS-CLAIM-SEQU.
   311         16  FILLER          PIC X    VALUE '('.
   312         16  WS-CURRENT-SEQU PIC Z9.
   313         16  FILLER          PIC X(4) VALUE ' OF '.
   314         16  WS-OF-SEQU      PIC Z9.
   315         16  FILLER          PIC X    VALUE ')'.
   316     12  DATE-WORK.
   317       14  FILLER                PIC XX.
   318       14  DATE-MM               PIC XX.
   319       14  DATE-DD               PIC XX.
   320       14  DATE-YY               PIC XX.
   321     12  CURR-DATE REDEFINES DATE-WORK.
   322         16  CURR-MM.
   323           18  CURR-M1           PIC 9.
   324           18  CURR-M2           PIC 9.
   325         16  FILLER              PIC X(5).
   326         16  CURR-YEAR           PIC 9.
   327     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   328     12  SUB                     PIC 99.
   329     12  MY-DATE.
   330         16  MY-MM               PIC XX.
   331         16  FILLER              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page   9
* EL130.cbl
   332         16  MY-YY               PIC XX.
   333
   334     12  WS-EDIT-BEN-CODE        PIC XX.
   335         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   336                                          '90' THRU '99'.
   337
   338     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   339     12  WS-BEN-HOLD             PIC XX.
   340     12  WS-BEN-ALPHA-HOLD.
   341         15  WS-BEN-ALPHA-2      PIC XX.
   342         15  WS-BEN-ALPHA-1      PIC X.
   343     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   344     12  WS-REC-TYPE             PIC X.
   345     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   346     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   347     12  ARCH-NUMBER             PIC S9(8)   COMP.
   348     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   349         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   350         88  REIN-REC-FOUND                  VALUE 'Y'.
   351
   352     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   353     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   354
   355
   356 01  CSO-WORK-FIELDS.
   357     12  WS-BLANK            PIC X       VALUE ' '.
   358
   359     12  WS-MA-CONTROL-PRIMARY.
   360         16  WS-MA-COMPANY-CD        PIC  X.
   361         16  WS-MA-CARRIER           PIC  X.
   362         16  WS-MA-GROUPING          PIC  X(6).
   363         16  WS-MA-STATE             PIC  XX.
   364         16  WS-MA-ACCOUNT           PIC  X(10).
   365         16  WS-MA-CERT-EFF-DT       PIC  XX.
   366         16  WS-MA-CERT-NO.
   367             20  WS-MA-CERT-PRIME    PIC  X(10).
   368             20  WS-MA-CERT-SFX      PIC  X.
   369
   370     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   371     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   372     12  WS-SOC-SEC-NUMBER.
   373         16  WS-SOC-SEC-NO       PIC 9(9).
   374         16  WS-SOC-SEC-BLANK    PIC X(2).
   375     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   376         16  WS-SSN-1-3          PIC 9(3).
   377         16  WS-SSN-DASH1        PIC X(1).
   378         16  WS-SSN-4-5          PIC 9(2).
   379         16  WS-SSN-DASH2        PIC X(1).
   380         16  WS-SSN-6-9          PIC 9(4).
   381
   382     12  WS-DIAG-VIN-MSG.
   383         16  FILLER          PIC X(11)
   384             VALUE 'VIN NUMBER '.
   385         16  WS-DIAG-VIN     PIC X(17).
   386
   387     12  WS-VERIFY-NOTE      PIC X(34)
   388         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   389
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  10
* EL130.cbl
   390     12  WS-CAUSAL-NOTE      PIC X(40)
   391         VALUE 'VERIFY IF DX RELATED TO PRIOR CONDITION '.
   392
   393 01  MAP-DATE-AREAS.
   394     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   395     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   396     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   397     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   398     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   399     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   400     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   401     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   402     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   403     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   404     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   405     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   406     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   407     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   408     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   409     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   410     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   411     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   412     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   413         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   414     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   415     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   416     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   417     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   418
   419 01  ACCESS-KEYS.
   420     12  ELACTQ-KEY.
   421         16  ELACTQ-COMPANY-CD       PIC X.
   422         16  ELACTQ-CARRIER          PIC X.
   423         16  ELACTQ-CLAIM-NO         PIC X(7).
   424         16  ELACTQ-CERT-NO          PIC X(11).
   425     12  ELMSTR-KEY.
   426         16  MSTR-COMP-CD            PIC X.
   427         16  MSTR-CARRIER            PIC X.
   428         16  MSTR-CLAIM-NO           PIC X(7).
   429         16  MSTR-CERT-NO.
   430             20  MSTR-CERT-NO-PRIME  PIC X(10).
   431             20  MSTR-CERT-NO-SUFX   PIC X.
   432     12  SAVE-ELMSTR-KEY.
   433         16  SAVE-COMP-CD            PIC X.
   434         16  SAVE-CARRIER            PIC X.
   435         16  SAVE-CLAIM-NO           PIC X(7).
   436         16  SAVE-CERT-NO.
   437             20  SAVE-CERT-NO-PRIME  PIC X(10).
   438             20  SAVE-CERT-NO-SUFX   PIC X.
   439     12  ELMSTR5-KEY.
   440         16  MSTR5-COMP-CD           PIC X.
   441         16  MSTR5-CERT-NO.
   442             20  MSTR5-CERT-NO-PRIME PIC X(10).
   443             20  MSTR5-CERT-NO-SUFX  PIC X.
   444     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   445         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   446         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   447         88  CLAIM-RECORD-FOUND            VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  11
* EL130.cbl
   448     12  ELCNTL-KEY.
   449         16  CNTL-COMP-ID    PIC X(3).
   450         16  CNTL-REC-TYPE   PIC X.
   451         16  CNTL-ACCESS.
   452             20  FILLER      PIC XX.
   453             20  CNTL-BENEFIT.
   454                 24  FILLER  PIC X.
   455                 24  CNTL-CARRIER PIC X.
   456         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   457     12  ELCERT-KEY.
   458         16  CERT-COMP-CD    PIC X.
   459         16  CERT-CARRIER    PIC X.
   460         16  CERT-GROUPING   PIC X(6).
   461         16  CERT-STATE      PIC X(2).
   462         16  CERT-ACCOUNT.
   463             20  CERT-ACCOUNT-PREFIX PIC X(4).
   464             20  CERT-ACCOUNT-PRIME  PIC X(6).
   465         16  CERT-EFF-DT     PIC XX.
   466         16  CERT-CERT-NO.
   467             20  CERT-CERT-NO-PRIME  PIC X(10).
   468             20  CERT-CERT-NO-SUFX   PIC X.
   469     12  ELCERT-KEY-5.
   470         16  CERT-COMP-CD-5      PIC X.
   471         16  CERT-CERT-5.
   472             20  CERT-CERT-5-PRIME   PIC X(10).
   473             20  CERT-CERT-5-SUFX    PIC X.
   474     12  ERACCT-KEY.
   475         16  ACCT-COMP-CD    PIC X.
   476         16  ACCT-CARRIER    PIC X.
   477         16  ACCT-GROUPING   PIC X(6).
   478         16  ACCT-STATE      PIC X(2).
   479         16  ACCT-ACCOUNT    PIC X(10).
   480         16  ACCT-EXP-DT     PIC XX.
   481     12  ELTRLR-KEY.
   482         16  TRLR-COMP-CD    PIC X.
   483         16  TRLR-CARRIER    PIC X.
   484         16  TRLR-CLAIM-NO   PIC X(7).
   485         16  TRLR-CERT-NO.
   486             20  TRLR-CERT-NO-PRIME  PIC X(10).
   487             20  TRLR-CERT-NO-SUFX   PIC X.
   488         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   489         16  TRLR-TYPE       PIC X.
   490     12  ELBENE-KEY.
   491         16  BENE-COMP-CD    PIC X.
   492         16  BENE-RCD-TYPE   PIC X.
   493         16  BENE-CODE       PIC X(10).
   494     12  ERREIN-KEY.
   495         16  REIN-COMP-CD        PIC X(01).
   496         16  REIN-TYPE           PIC X(01).
   497         16  REIN-TABLE-CO.
   498             20  REIN-CODE-1     PIC X(01).
   499             20  REIN-CODE-2     PIC X(01).
   500             20  REIN-CODE-3     PIC X(01).
   501         16  FILLER              PIC X(03).
   502     12  ELCRTT-KEY.
   503         16  CTRLR-COMP-CD       PIC X.
   504         16  CTRLR-CARRIER       PIC X.
   505         16  CTRLR-GROUPING      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  12
* EL130.cbl
   506         16  CTRLR-STATE         PIC X(2).
   507         16  CTRLR-ACCOUNT       PIC X(10).
   508         16  CTRLR-EFF-DT        PIC XX.
   509         16  CTRLR-CERT-NO       PIC X(11).
   510         16  CTRLR-REC-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  13
* EL130.cbl
   512 01  ERROR-MESSAGES.
   513     12  ER-0000                 PIC X(4)  VALUE '0000'.
   514     12  ER-0004                 PIC X(4)  VALUE '0004'.
   515     12  ER-0019                 PIC X(4)  VALUE '0019'.
   516     12  ER-0023                 PIC X(4)  VALUE '0023'.
   517     12  ER-0029                 PIC X(4)  VALUE '0029'.
   518     12  ER-0033                 PIC X(4)  VALUE '0033'.
   519     12  ER-0068                 PIC X(4)  VALUE '0068'.
   520     12  ER-0070                 PIC X(4)  VALUE '0070'.
   521     12  ER-0194                 PIC X(4)  VALUE '0194'.
   522     12  ER-0202                 PIC X(4)  VALUE '0202'.
   523     12  ER-0203                 PIC X(4)  VALUE '0203'.
   524     12  ER-0204                 PIC X(4)  VALUE '0204'.
   525     12  ER-0205                 PIC X(4)  VALUE '0205'.
   526     12  ER-0206                 PIC X(4)  VALUE '0206'.
   527     12  ER-0207                 PIC X(4)  VALUE '0207'.
   528     12  ER-0213                 PIC X(4)  VALUE '0213'.
   529     12  ER-0214                 PIC X(4)  VALUE '0214'.
   530     12  ER-0217                 PIC X(4)  VALUE '0217'.
   531     12  ER-0219                 PIC X(4)  VALUE '0219'.
   532     12  ER-0220                 PIC X(4)  VALUE '0220'.
   533     12  ER-0221                 PIC X(4)  VALUE '0221'.
   534     12  ER-0222                 PIC X(4)  VALUE '0222'.
   535     12  ER-0223                 PIC X(4)  VALUE '0223'.
   536     12  ER-0224                 PIC X(4)  VALUE '0224'.
   537     12  ER-0225                 PIC X(4)  VALUE '0225'.
   538     12  ER-0226                 PIC X(4)  VALUE '0226'.
   539     12  ER-0227                 PIC X(4)  VALUE '0227'.
   540     12  ER-0229                 PIC X(4)  VALUE '0229'.
   541     12  ER-0230                 PIC X(4)  VALUE '0230'.
   542     12  ER-0231                 PIC X(4)  VALUE '0231'.
   543     12  ER-0232                 PIC X(4)  VALUE '0232'.
   544     12  ER-0233                 PIC X(4)  VALUE '0233'.
   545     12  ER-0234                 PIC X(4)  VALUE '0234'.
   546     12  ER-0235                 PIC X(4)  VALUE '0235'.
   547     12  ER-0236                 PIC X(4)  VALUE '0236'.
   548     12  ER-0237                 PIC X(4)  VALUE '0237'.
   549     12  ER-0238                 PIC X(4)  VALUE '0238'.
   550     12  ER-0239                 PIC X(4)  VALUE '0239'.
   551     12  ER-0240                 PIC X(4)  VALUE '0240'.
   552     12  ER-0241                 PIC X(4)  VALUE '0241'.
   553     12  ER-0243                 PIC X(4)  VALUE '0243'.
   554     12  ER-0244                 PIC X(4)  VALUE '0244'.
   555     12  ER-0245                 PIC X(4)  VALUE '0245'.
   556     12  ER-0246                 PIC X(4)  VALUE '0246'.
   557     12  ER-0247                 PIC X(4)  VALUE '0247'.
   558     12  ER-0248                 PIC X(4)  VALUE '0248'.
   559     12  ER-0250                 PIC X(4)  VALUE '0250'.
   560     12  ER-0251                 PIC X(4)  VALUE '0251'.
   561     12  ER-0252                 PIC X(4)  VALUE '0252'.
   562     12  ER-0253                 PIC X(4)  VALUE '0253'.
   563     12  ER-0254                 PIC X(4)  VALUE '0254'.
   564     12  ER-0257                 PIC X(4)  VALUE '0257'.
   565     12  ER-0258                 PIC X(4)  VALUE '0258'.
   566     12  ER-0260                 PIC X(4)  VALUE '0260'.
   567     12  ER-0261                 PIC X(4)  VALUE '0261'.
   568     12  ER-0263                 PIC X(4)  VALUE '0263'.
   569     12  ER-0264                 PIC X(4)  VALUE '0264'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  14
* EL130.cbl
   570     12  ER-0265                 PIC X(4)  VALUE '0265'.
   571     12  ER-0266                 PIC X(4)  VALUE '0266'.
   572     12  ER-0267                 PIC X(4)  VALUE '0267'.
   573     12  ER-0334                 PIC X(4)  VALUE '0334'.
   574     12  ER-0337                 PIC X(4)  VALUE '0337'.
   575     12  ER-0412                 PIC X(4)  VALUE '0412'.
   576     12  ER-0413                 PIC X(4)  VALUE '0413'.
   577     12  ER-0428                 PIC X(4)  VALUE '0428'.
   578     12  ER-0429                 PIC X(4)  VALUE '0429'.
   579     12  ER-0430                 PIC X(4)  VALUE '0430'.
   580     12  ER-0433                 PIC X(4)  VALUE '0433'.
   581     12  ER-0434                 PIC X(4)  VALUE '0434'.
   582     12  ER-0458                 PIC X(4)  VALUE '0458'.
   583     12  ER-0489                 PIC X(4)  VALUE '0489'.
   584     12  ER-0509                 PIC X(4)  VALUE '0509'.
   585     12  ER-0510                 PIC X(4)  VALUE '0510'.
   586     12  ER-0511                 PIC X(4)  VALUE '0511'.
   587     12  ER-0512                 PIC X(4)  VALUE '0512'.
   588     12  ER-0516                 PIC X(4)  VALUE '0516'.
   589     12  ER-0517                 PIC X(4)  VALUE '0517'.
   590     12  ER-0518                 PIC X(4)  VALUE '0518'.
   591     12  ER-0519                 PIC X(4)  VALUE '0519'.
   592     12  ER-0520                 PIC X(4)  VALUE '0520'.
   593     12  ER-0521                 PIC X(4)  VALUE '0521'.
   594     12  ER-0522                 PIC X(4)  VALUE '0522'.
   595     12  ER-0523                 PIC X(4)  VALUE '0523'.
   596     12  ER-0544                 PIC X(4)  VALUE '0544'.
   597     12  ER-0546                 PIC X(4)  VALUE '0546'.
   598     12  ER-0558                 PIC X(4)  VALUE '0558'.
   599     12  ER-0560                 PIC X(4)  VALUE '0560'.
   600     12  ER-0562                 PIC X(4)  VALUE '0562'.
   601     12  ER-0565                 PIC X(4)  VALUE '0565'.
   602     12  ER-0569                 PIC X(4)  VALUE '0569'.
   603     12  ER-0693                 PIC X(4)  VALUE '0693'.
   604     12  ER-0715                 PIC X(4)  VALUE '0715'.
   605     12  ER-0840                 PIC X(4)  VALUE '0840'.
   606     12  ER-0841                 PIC X(4)  VALUE '0841'.
   607     12  ER-0842                 PIC X(4)  VALUE '0842'.
   608     12  ER-0843                 PIC X(4)  VALUE '0843'.
   609     12  ER-0878                 PIC X(4)  VALUE '0878'.
   610     12  ER-0887                 PIC X(4)  VALUE '0887'.
   611     12  ER-2280                 PIC X(4)  VALUE '2280'.
   612     12  ER-2370                 PIC X(4)  VALUE '2370'.
   613     12  ER-2371                 PIC X(4)  VALUE '2371'.
   614     12  ER-2378                 PIC X(4)  VALUE '2378'.
   615     12  ER-2380                 PIC X(4)  VALUE '2380'.
   616     12  ER-2566                 PIC X(4)  VALUE '2566'.
   617     12  ER-2848                 PIC X(4)  VALUE '2848'.
   618     12  ER-3548                 PIC X(4)  VALUE '3548'.
   619     12  ER-7008                 PIC X(4)  VALUE '7008'.
   620     12  ER-7319                 PIC X(4)  VALUE '7319'.
   621     12  ER-7321                 PIC X(4)  VALUE '7321'.
   622     12  ER-7352                 PIC X(4)  VALUE '7352'.
   623     12  ER-7353                 PIC X(4)  VALUE '7353'.
   624     12  ER-7575                 PIC X(4)  VALUE '7575'.
   625     12  ER-7577                 PIC X(4)  VALUE '7577'.
   626     12  ER-7634                 PIC X(4)  VALUE '7634'.
   627     12  ER-7635                 PIC X(4)  VALUE '7635'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  15
* EL130.cbl
   628     12  ER-7636                 PIC X(4)  VALUE '7636'.
   629     12  ER-7637                 PIC X(4)  VALUE '7637'.
   630     12  ER-7638                 PIC X(4)  VALUE '7638'.
   631     12  ER-7639                 PIC X(4)  VALUE '7639'.
   632     12  ER-7640                 PIC X(4)  VALUE '7640'.
   633     12  ER-7641                 PIC X(4)  VALUE '7641'.
   634     12  ER-7642                 PIC X(4)  VALUE '7642'.
   635     12  ER-7643                 PIC X(4)  VALUE '7643'.
   636     12  ER-7646                 PIC X(4)  VALUE '7646'.
   637     12  ER-7647                 PIC X(4)  VALUE '7647'.
   638     12  ER-7648                 PIC X(4)  VALUE '7648'.
   639     12  ER-7649                 PIC X(4)  VALUE '7649'.
   640     12  ER-7651                 PIC X(4)  VALUE '7651'.
   641     12  ER-7670                 PIC X(4)  VALUE '7670'.
   642     12  ER-7671                 PIC X(4)  VALUE '7671'.
   643     12  ER-7686                 PIC X(4)  VALUE '7686'.
   644     12  ER-7688                 PIC X(4)  VALUE '7688'.
   645     12  ER-7689                 PIC X(4)  VALUE '7689'.
   646     12  ER-7691                 PIC X(4)  VALUE '7691'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  16
* EL130.cbl
   648*    COPY ELCLNKLT.
   649******************************************************************
   650*                                                                *
   651*                                                                *
   652*                           ELCLNKLT                             *
   653*                            VMOD=2.003                          *
   654*                                                                *
   655*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   656*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   657*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   658*                                                                *
   659*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   660*   COMPLETING THE REQUIRED FIELDS.                              *
   661*                                                                *
   662*   THE CALLING PROGRAM SHOULD CHECK:                            *
   663*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   664*                              9999 INDICATES AN UNKNOWN ABEND   *
   665*                                   WAS DETECTED.                *
   666*                              ALL OTHER VALUES ARE NORMAL ERROR *
   667*                              CODES FOUND IN THE ERROR FILE.    *
   668******************************************************************
   669 01  W-1523-LINKDATA.
   670     12  W-1523-COMMON-PI-DATA.
   671         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   672         16  FILLER              PIC  X(67).
   673         16  W-1523-COMPANY-CD   PIC  X(01).
   674         16  FILLER              PIC  X(10).
   675         16  W-1523-CONTROL-IN-PROGRESS.
   676             20  W-1523-CARRIER  PIC  X(01).
   677             20  W-1523-GROUPING PIC  X(06).
   678             20  W-1523-STATE    PIC  X(02).
   679             20  W-1523-ACCOUNT  PIC  X(10).
   680             20  W-1523-CLAIM-CERT-GRP.
   681                 24  W-1523-CLAIM-NO
   682                                 PIC  X(07).
   683                 24  W-1523-CERT-NO.
   684                     28  W-1523-CERT-PRIME
   685                                 PIC  X(10).
   686                     28  W-1523-CERT-SFX
   687                                 PIC  X(01).
   688                 24  W-1523-CERT-EFF-DT
   689                                 PIC  X(02).
   690         16  FILLER              PIC X(265).
   691
   692     12  W-1523-WORK-AREA.
   693         16  W-1523-FORM-NUMBER  PIC  X(04).
   694         16  W-1523-NUMBER-COPIES
   695                                 PIC  9(01).
   696         16  W-1523-ADDR-TYPE    PIC  X(02).
   697         16  W-1523-FOLLOW-UP-DATE
   698                                 PIC  X(02).
   699         16  W-1523-RESEND-DATE  PIC  X(02).
   700         16  W-1523-ERROR-CODE   PIC  9(04).
   701             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   702             88  W-1523-FATAL-ERROR
   703                                    VALUES  0006 0013 0042
   704                                            0154 0168 0169
   705                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  17
* EL130.cbl
   706                                            0179 0186 0281
   707                                            0332 2055 3697
   708                                            3698 3699 3770
   709                                            3771 3772 7675
   710                                            9106 9808 9883
   711                                            9887.
   712             88  W-1523-STOP-ERRORS
   713                                    VALUES  0013 0042 0154
   714                                            0168 0169 0172
   715                                            0281 0332 2055
   716                                            3698 3699 7675
   717                                            9106 9808 9883
   718                                            9999.
   719         16  W-1523-REASON       PIC  X(70).
   720         16  W-1523-ARCHIVE-NUMBER
   721                                 PIC  9(08).
   722     12  W-1523-POINTER-AREA.
   723         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   724         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   725         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   726         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   727         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  18
* EL130.cbl
   729*    COPY ELCINTF.
   730******************************************************************
   731*                                                                *
   732*                                                                *
   733*                            ELCINTF.                            *
   734*                            VMOD=2.017                          *
   735*                                                                *
   736*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   737*                                                                *
   738*       LENGTH = 1024                                            *
   739*                                                                *
   740******************************************************************
   741*                   C H A N G E   L O G
   742*
   743* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   744*-----------------------------------------------------------------
   745*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   746* EFFECTIVE    NUMBER
   747*-----------------------------------------------------------------
   748* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   749******************************************************************
   750 01  PROGRAM-INTERFACE-BLOCK.
   751     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   752     12  PI-CALLING-PROGRAM              PIC X(8).
   753     12  PI-SAVED-PROGRAM-1              PIC X(8).
   754     12  PI-SAVED-PROGRAM-2              PIC X(8).
   755     12  PI-SAVED-PROGRAM-3              PIC X(8).
   756     12  PI-SAVED-PROGRAM-4              PIC X(8).
   757     12  PI-SAVED-PROGRAM-5              PIC X(8).
   758     12  PI-SAVED-PROGRAM-6              PIC X(8).
   759     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   760     12  PI-COMPANY-ID                   PIC XXX.
   761     12  PI-COMPANY-CD                   PIC X.
   762
   763     12  PI-COMPANY-PASSWORD             PIC X(8).
   764
   765     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   766
   767     12  PI-CONTROL-IN-PROGRESS.
   768         16  PI-CARRIER                  PIC X.
   769         16  PI-GROUPING                 PIC X(6).
   770         16  PI-STATE                    PIC XX.
   771         16  PI-ACCOUNT                  PIC X(10).
   772         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   773                                         PIC X(10).
   774         16  PI-CLAIM-CERT-GRP.
   775             20  PI-CLAIM-NO             PIC X(7).
   776             20  PI-CERT-NO.
   777                 25  PI-CERT-PRIME       PIC X(10).
   778                 25  PI-CERT-SFX         PIC X.
   779             20  PI-CERT-EFF-DT          PIC XX.
   780         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   781             20  PI-PLAN-CODE            PIC X(2).
   782             20  PI-REVISION-NUMBER      PIC X(3).
   783             20  PI-PLAN-EFF-DT          PIC X(2).
   784             20  PI-PLAN-EXP-DT          PIC X(2).
   785             20  FILLER                  PIC X(11).
   786         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  19
* EL130.cbl
   787             20  PI-OE-REFERENCE-1.
   788                 25  PI-OE-REF-1-PRIME   PIC X(18).
   789                 25  PI-OE-REF-1-SUFF    PIC XX.
   790
   791     12  PI-SESSION-IN-PROGRESS          PIC X.
   792         88  CLAIM-SESSION                   VALUE '1'.
   793         88  CREDIT-SESSION                  VALUE '2'.
   794         88  WARRANTY-SESSION                VALUE '3'.
   795         88  MORTGAGE-SESSION                VALUE '4'.
   796         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   797
   798
   799*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   800
   801     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   802     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   803
   804     12  PI-CREDIT-USER                  PIC X.
   805         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   806         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   807
   808     12  PI-CLAIM-USER                   PIC X.
   809         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   810         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   811
   812     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   813         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   814         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   815         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   816         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   817         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   818
   819     12  PI-PROCESSOR-ID                 PIC X(4).
   820
   821     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   822
   823     12  PI-MEMBER-CAPTION               PIC X(10).
   824
   825     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   826         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   827
   828     12  PI-LIFE-OVERRIDE-L1             PIC X.
   829     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   830     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   831     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   832
   833     12  PI-AH-OVERRIDE-L1               PIC X.
   834     12  PI-AH-OVERRIDE-L2               PIC XX.
   835     12  PI-AH-OVERRIDE-L6               PIC X(6).
   836     12  PI-AH-OVERRIDE-L12              PIC X(12).
   837
   838     12  PI-NEW-SYSTEM                   PIC X(2).
   839
   840     12  PI-PRIMARY-CERT-NO              PIC X(11).
   841     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   842         88  PI-USES-PAID-TO                 VALUE '1'.
   843     12  PI-CRDTCRD-SYSTEM.
   844         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  20
* EL130.cbl
   845             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   846             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   847         16  PI-CC-MONTH-END-DT          PIC XX.
   848     12  PI-PROCESSOR-PRINTER            PIC X(4).
   849
   850     12  PI-OE-REFERENCE-2.
   851         16  PI-OE-REF-2-PRIME           PIC X(10).
   852         16  PI-OE-REF-2-SUFF            PIC X.
   853
   854     12  PI-REM-TRM-CALC-OPTION          PIC X.
   855
   856     12  PI-LANGUAGE-TYPE                PIC X.
   857             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   858             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   859             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   860
   861     12  PI-POLICY-LINKAGE-IND           PIC X.
   862         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   863         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   864                                                   LOW-VALUES.
   865
   866     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   867     12  PI-CLAIM-PW-SESSION             PIC X(1).
   868         88  PI-CLAIM-CREDIT                 VALUE '1'.
   869         88  PI-CLAIM-CONVEN                 VALUE '2'.
   870
   871     12  PI-PROCESSOR-CSR-IND            PIC X.
   872         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   873         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   874
   875     12  FILLER                          PIC X(3).
   876
   877     12  PI-SYSTEM-LEVEL                 PIC X(145).
   878
   879     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   880         PI-SYSTEM-LEVEL.
   881
   882         16  PI-ENTRY-CODES.
   883             20  PI-ENTRY-CD-1           PIC X.
   884             20  PI-ENTRY-CD-2           PIC X.
   885
   886         16  PI-RETURN-CODES.
   887             20  PI-RETURN-CD-1          PIC X.
   888             20  PI-RETURN-CD-2          PIC X.
   889
   890         16  PI-UPDATE-STATUS-SAVE.
   891             20  PI-UPDATE-BY            PIC X(4).
   892             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   893
   894         16  PI-LOWER-CASE-LETTERS       PIC X.
   895             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   896
   897*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   898*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   899*            88  CARRIER-CLM-CNTL            VALUE '2'.
   900
   901         16  PI-CERT-ACCESS-CONTROL      PIC X.
   902             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  21
* EL130.cbl
   903             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   904             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   905             88  ACCNT-CNTL                  VALUE '3'.
   906             88  CARR-ACCNT-CNTL             VALUE '4'.
   907
   908         16  PI-PROCESSOR-CAP-LIST.
   909             20  PI-SYSTEM-CONTROLS.
   910                24 PI-SYSTEM-DISPLAY     PIC X.
   911                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   912                24 PI-SYSTEM-MODIFY      PIC X.
   913                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   914             20  FILLER                  PIC XX.
   915             20  PI-DISPLAY-CAP          PIC X.
   916                 88  DISPLAY-CAP             VALUE 'Y'.
   917             20  PI-MODIFY-CAP           PIC X.
   918                 88  MODIFY-CAP              VALUE 'Y'.
   919             20  PI-MSG-AT-LOGON-CAP     PIC X.
   920                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   921             20  PI-FORCE-CAP            PIC X.
   922                 88  FORCE-CAP               VALUE 'Y'.
   923
   924         16  PI-PROGRAM-CONTROLS.
   925             20  PI-PGM-PRINT-OPT        PIC X.
   926             20  PI-PGM-FORMAT-OPT       PIC X.
   927             20  PI-PGM-PROCESS-OPT      PIC X.
   928             20  PI-PGM-TOTALS-OPT       PIC X.
   929
   930         16  PI-HELP-INTERFACE.
   931             20  PI-LAST-ERROR-NO        PIC X(4).
   932             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   933
   934         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   935             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   936
   937         16  PI-CR-CONTROL-IN-PROGRESS.
   938             20  PI-CR-CARRIER           PIC X.
   939             20  PI-CR-GROUPING          PIC X(6).
   940             20  PI-CR-STATE             PIC XX.
   941             20  PI-CR-ACCOUNT           PIC X(10).
   942             20  PI-CR-FIN-RESP          PIC X(10).
   943             20  PI-CR-TYPE              PIC X.
   944
   945         16  PI-CR-BATCH-NUMBER          PIC X(6).
   946
   947         16  PI-CR-MONTH-END-DT          PIC XX.
   948
   949         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   950             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   951             88  PI-ZERO-CARRIER             VALUE '1'.
   952             88  PI-ZERO-GROUPING            VALUE '2'.
   953             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   954
   955         16  PI-CARRIER-SECURITY         PIC X.
   956             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   957
   958         16  PI-ACCOUNT-SECURITY         PIC X(10).
   959             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   960             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  22
* EL130.cbl
   961
   962         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   963             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   964                                         INDEXED BY PI-ACCESS-NDX
   965                                         PIC X.
   966
   967         16  PI-GA-BILLING-CONTROL       PIC X.
   968             88  PI-GA-BILLING               VALUE '1'.
   969
   970         16  PI-MAIL-PROCESSING          PIC X.
   971             88  PI-MAIL-YES                 VALUE 'Y'.
   972
   973         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   974
   975         16  PI-AR-SYSTEM.
   976             20  PI-AR-PROCESSING-CNTL   PIC X.
   977                 88  PI-AR-PROCESSING        VALUE 'Y'.
   978             20  PI-AR-SUMMARY-CODE      PIC X(6).
   979             20  PI-AR-MONTH-END-DT      PIC XX.
   980
   981         16  PI-MP-SYSTEM.
   982             20  PI-MORTGAGE-USER            PIC X.
   983                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   984                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   985             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   986                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   987                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   988                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   989                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   990                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   991             20  PI-MP-MONTH-END-DT          PIC XX.
   992             20  PI-MP-REFERENCE-NO.
   993                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   994                 24  PI-MP-REFERENCE-SFX     PIC XX.
   995
   996         16  PI-LABEL-CONTROL            PIC X(01).
   997             88  PI-CREATE-LABELS                    VALUE 'Y'.
   998             88  PI-BYPASS-LABELS                    VALUE 'N'.
   999
  1000         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1001             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1002
  1003         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1004             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1005             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1006
  1007         16  FILLER                      PIC X(14).
  1008
  1009     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1010******************************************************************
  1011     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1012         16  PI-MSTR-DT               PIC XX.
  1013         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1014         16  PI-TRLR-DT               PIC XX.
  1015         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1016         16  PI-LAST-CLAIM            PIC X(7).
  1017         16  PI-LAST-CARR             PIC X.
  1018         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  23
* EL130.cbl
  1019             20  PI-LAST-CERT-PRIME   PIC X(10).
  1020             20  PI-LAST-CERT-SUFX    PIC X.
  1021         16  PI-LAST-CLAIM-TYPE       PIC X.
  1022         16  PI-CURSOR                PIC S9(4)   COMP.
  1023         16  PI-SAVE-CERT.
  1024             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1025             20  PI-SAVE-CERT-SUFX    PIC X.
  1026         16  PI-SAVE-EFFDT            PIC X(2).
  1027         16  PI-SAVE-ACCOUNT          PIC X(10).
  1028         16  PI-INCURR-SW             PIC X.
  1029         16  PI-PRT-OPT               PIC X.
  1030         16  PI-ALT-PRT               PIC X(4).
  1031         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1032             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1033         16  FILLER                   PIC X(272).
  1034         16  PI-EL127-TO-EL130-CNTRL.
  1035             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1036             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1037             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1038                 24  PI-EL127-CARRIER        PIC X.
  1039                 24  PI-EL127-GROUPING       PIC X(6).
  1040                 24  PI-EL127-STATE          PIC X(2).
  1041                 24  PI-EL127-ACCOUNT        PIC X(10).
  1042                 24  PI-EL127-CERT-NO.
  1043                     28  PI-EL127-CERT-PRIME PIC X(10).
  1044                     28  PI-EL127-CERT-SUFX  PIC X.
  1045                 24  PI-EL127-EFF-DT         PIC XX.
  1046*        16  FILLER                          PIC X(50).
  1047         16  FILLER                          PIC X(31).
  1048         16  PI-EL659-TO-EL130-CNTRL.
  1049             20  PI-EL659-CARRIER            PIC X.
  1050             20  PI-EL659-GROUPING           PIC X(6).
  1051             20  PI-EL659-STATE              PIC XX.
  1052             20  PI-EL659-ACCOUNT            PIC X(10).
  1053
  1054         16  FILLER                          PIC X(19).
  1055
  1056         16  PI-SAVE-INCUR-DT                PIC X(02).
  1057         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1058*         16  FILLER                          PIC X(65).
  1059         16  PI-ST-VFY-2ND-BENE              PIC X.
  1060         16  PI-ST-CAUSAL-STATE              PIC X.
  1061         16  FILLER                          PIC X(63).
  1062
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  24
* EL130.cbl
  1064*    COPY EL130S.
  1065 01  EL130AI.
  1066     05  FILLER            PIC  X(0012).
  1067*    -------------------------------
  1068     05  RUNDTEL PIC S9(0004) COMP.
  1069     05  RUNDTEF PIC  X(0001).
  1070     05  FILLER REDEFINES RUNDTEF.
  1071         10  RUNDTEA PIC  X(0001).
  1072     05  RUNDTEI PIC  X(0008).
  1073*    -------------------------------
  1074     05  RUNTIMEL PIC S9(0004) COMP.
  1075     05  RUNTIMEF PIC  X(0001).
  1076     05  FILLER REDEFINES RUNTIMEF.
  1077         10  RUNTIMEA PIC  X(0001).
  1078     05  RUNTIMEI PIC  X(0005).
  1079*    -------------------------------
  1080     05  COMPL PIC S9(0004) COMP.
  1081     05  COMPF PIC  X(0001).
  1082     05  FILLER REDEFINES COMPF.
  1083         10  COMPA PIC  X(0001).
  1084     05  COMPI PIC  X(0003).
  1085*    -------------------------------
  1086     05  SEQUL PIC S9(0004) COMP.
  1087     05  SEQUF PIC  X(0001).
  1088     05  FILLER REDEFINES SEQUF.
  1089         10  SEQUA PIC  X(0001).
  1090     05  SEQUI PIC  X(0010).
  1091*    -------------------------------
  1092     05  MAINTL PIC S9(0004) COMP.
  1093     05  MAINTF PIC  X(0001).
  1094     05  FILLER REDEFINES MAINTF.
  1095         10  MAINTA PIC  X(0001).
  1096     05  MAINTI PIC  X(0001).
  1097*    -------------------------------
  1098     05  CLMNOL PIC S9(0004) COMP.
  1099     05  CLMNOF PIC  X(0001).
  1100     05  FILLER REDEFINES CLMNOF.
  1101         10  CLMNOA PIC  X(0001).
  1102     05  CLMNOI PIC  X(0007).
  1103*    -------------------------------
  1104     05  CLMCARRL PIC S9(0004) COMP.
  1105     05  CLMCARRF PIC  X(0001).
  1106     05  FILLER REDEFINES CLMCARRF.
  1107         10  CLMCARRA PIC  X(0001).
  1108     05  CLMCARRI PIC  X(0001).
  1109*    -------------------------------
  1110     05  CLMTYPEL PIC S9(0004) COMP.
  1111     05  CLMTYPEF PIC  X(0001).
  1112     05  FILLER REDEFINES CLMTYPEF.
  1113         10  CLMTYPEA PIC  X(0001).
  1114     05  CLMTYPEI PIC  X(0001).
  1115*    -------------------------------
  1116     05  CERTNOL PIC S9(0004) COMP.
  1117     05  CERTNOF PIC  X(0001).
  1118     05  FILLER REDEFINES CERTNOF.
  1119         10  CERTNOA PIC  X(0001).
  1120     05  CERTNOI PIC  X(0010).
  1121*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  25
* EL130.cbl
  1122     05  SUFXL PIC S9(0004) COMP.
  1123     05  SUFXF PIC  X(0001).
  1124     05  FILLER REDEFINES SUFXF.
  1125         10  SUFXA PIC  X(0001).
  1126     05  SUFXI PIC  X(0001).
  1127*    -------------------------------
  1128     05  PCERTNOL PIC S9(0004) COMP.
  1129     05  PCERTNOF PIC  X(0001).
  1130     05  FILLER REDEFINES PCERTNOF.
  1131         10  PCERTNOA PIC  X(0001).
  1132     05  PCERTNOI PIC  X(0010).
  1133*    -------------------------------
  1134     05  PSUFXL PIC S9(0004) COMP.
  1135     05  PSUFXF PIC  X(0001).
  1136     05  FILLER REDEFINES PSUFXF.
  1137         10  PSUFXA PIC  X(0001).
  1138     05  PSUFXI PIC  X(0001).
  1139*    -------------------------------
  1140     05  INCURL PIC S9(0004) COMP.
  1141     05  INCURF PIC  X(0001).
  1142     05  FILLER REDEFINES INCURF.
  1143         10  INCURA PIC  X(0001).
  1144     05  INCURI PIC  X(0008).
  1145*    -------------------------------
  1146     05  REPORTL PIC S9(0004) COMP.
  1147     05  REPORTF PIC  X(0001).
  1148     05  FILLER REDEFINES REPORTF.
  1149         10  REPORTA PIC  X(0001).
  1150     05  REPORTI PIC  X(0008).
  1151*    -------------------------------
  1152     05  CAUSEL PIC S9(0004) COMP.
  1153     05  CAUSEF PIC  X(0001).
  1154     05  FILLER REDEFINES CAUSEF.
  1155         10  CAUSEA PIC  X(0001).
  1156     05  CAUSEI PIC  X(0006).
  1157*    -------------------------------
  1158     05  ESTENDL PIC S9(0004) COMP.
  1159     05  ESTENDF PIC  X(0001).
  1160     05  FILLER REDEFINES ESTENDF.
  1161         10  ESTENDA PIC  X(0001).
  1162     05  ESTENDI PIC  X(0008).
  1163*    -------------------------------
  1164     05  DIAGL PIC S9(0004) COMP.
  1165     05  DIAGF PIC  X(0001).
  1166     05  FILLER REDEFINES DIAGF.
  1167         10  DIAGA PIC  X(0001).
  1168     05  DIAGI PIC  X(0060).
  1169*    -------------------------------
  1170     05  BENECDL PIC S9(0004) COMP.
  1171     05  BENECDF PIC  X(0001).
  1172     05  FILLER REDEFINES BENECDF.
  1173         10  BENECDA PIC  X(0001).
  1174     05  BENECDI PIC  X(0010).
  1175*    -------------------------------
  1176     05  BIRTHDTL PIC S9(0004) COMP.
  1177     05  BIRTHDTF PIC  X(0001).
  1178     05  FILLER REDEFINES BIRTHDTF.
  1179         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  26
* EL130.cbl
  1180     05  BIRTHDTI PIC  X(0008).
  1181*    -------------------------------
  1182     05  SSNL PIC S9(0004) COMP.
  1183     05  SSNF PIC  X(0001).
  1184     05  FILLER REDEFINES SSNF.
  1185         10  SSNA PIC  X(0001).
  1186     05  SSNI PIC  X(0011).
  1187*    -------------------------------
  1188     05  SEXL PIC S9(0004) COMP.
  1189     05  SEXF PIC  X(0001).
  1190     05  FILLER REDEFINES SEXF.
  1191         10  SEXA PIC  X(0001).
  1192     05  SEXI PIC  X(0001).
  1193*    -------------------------------
  1194     05  OCCCDL PIC S9(0004) COMP.
  1195     05  OCCCDF PIC  X(0001).
  1196     05  FILLER REDEFINES OCCCDF.
  1197         10  OCCCDA PIC  X(0001).
  1198     05  OCCCDI PIC  X(0006).
  1199*    -------------------------------
  1200     05  LSTNMEL PIC S9(0004) COMP.
  1201     05  LSTNMEF PIC  X(0001).
  1202     05  FILLER REDEFINES LSTNMEF.
  1203         10  LSTNMEA PIC  X(0001).
  1204     05  LSTNMEI PIC  X(0015).
  1205*    -------------------------------
  1206     05  FSTNMEL PIC S9(0004) COMP.
  1207     05  FSTNMEF PIC  X(0001).
  1208     05  FILLER REDEFINES FSTNMEF.
  1209         10  FSTNMEA PIC  X(0001).
  1210     05  FSTNMEI PIC  X(0012).
  1211*    -------------------------------
  1212     05  INITL PIC S9(0004) COMP.
  1213     05  INITF PIC  X(0001).
  1214     05  FILLER REDEFINES INITF.
  1215         10  INITA PIC  X(0001).
  1216     05  INITI PIC  X(0001).
  1217*    -------------------------------
  1218     05  LOANNOL PIC S9(0004) COMP.
  1219     05  LOANNOF PIC  X(0001).
  1220     05  FILLER REDEFINES LOANNOF.
  1221         10  LOANNOA PIC  X(0001).
  1222     05  LOANNOI PIC  X(0008).
  1223*    -------------------------------
  1224     05  CRTLNMEL PIC S9(0004) COMP.
  1225     05  CRTLNMEF PIC  X(0001).
  1226     05  FILLER REDEFINES CRTLNMEF.
  1227         10  CRTLNMEA PIC  X(0001).
  1228     05  CRTLNMEI PIC  X(0015).
  1229*    -------------------------------
  1230     05  CRTFNMEL PIC S9(0004) COMP.
  1231     05  CRTFNMEF PIC  X(0001).
  1232     05  FILLER REDEFINES CRTFNMEF.
  1233         10  CRTFNMEA PIC  X(0001).
  1234     05  CRTFNMEI PIC  X(0012).
  1235*    -------------------------------
  1236     05  CRTINITL PIC S9(0004) COMP.
  1237     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  27
* EL130.cbl
  1238     05  FILLER REDEFINES CRTINITF.
  1239         10  CRTINITA PIC  X(0001).
  1240     05  CRTINITI PIC  X(0001).
  1241*    -------------------------------
  1242     05  LOANBALL PIC S9(0004) COMP.
  1243     05  LOANBALF PIC  X(0001).
  1244     05  FILLER REDEFINES LOANBALF.
  1245         10  LOANBALA PIC  X(0001).
  1246     05  LOANBALI PIC  9(7)V99.
  1247*    -------------------------------
  1248     05  MANRSVL PIC S9(0004) COMP.
  1249     05  MANRSVF PIC  X(0001).
  1250     05  FILLER REDEFINES MANRSVF.
  1251         10  MANRSVA PIC  X(0001).
  1252     05  MANRSVI PIC  9(7)V99.
  1253*    -------------------------------
  1254     05  SUPVL PIC S9(0004) COMP.
  1255     05  SUPVF PIC  X(0001).
  1256     05  FILLER REDEFINES SUPVF.
  1257         10  SUPVA PIC  X(0001).
  1258     05  SUPVI PIC  X(0001).
  1259*    -------------------------------
  1260     05  PRICDL PIC S9(0004) COMP.
  1261     05  PRICDF PIC  X(0001).
  1262     05  FILLER REDEFINES PRICDF.
  1263         10  PRICDA PIC  X(0001).
  1264     05  PRICDI PIC  X(0001).
  1265*    -------------------------------
  1266     05  PRODL PIC S9(0004) COMP.
  1267     05  PRODF PIC  X(0001).
  1268     05  FILLER REDEFINES PRODF.
  1269         10  PRODA PIC  X(0001).
  1270     05  PRODI PIC  X(0008).
  1271*    -------------------------------
  1272     05  PRODCDL PIC S9(0004) COMP.
  1273     05  PRODCDF PIC  X(0001).
  1274     05  FILLER REDEFINES PRODCDF.
  1275         10  PRODCDA PIC  X(0001).
  1276     05  PRODCDI PIC  X(0001).
  1277*    -------------------------------
  1278     05  FILETOL PIC S9(0004) COMP.
  1279     05  FILETOF PIC  X(0001).
  1280     05  FILLER REDEFINES FILETOF.
  1281         10  FILETOA PIC  X(0001).
  1282     05  FILETOI PIC  X(0004).
  1283*    -------------------------------
  1284     05  PROCCDL PIC S9(0004) COMP.
  1285     05  PROCCDF PIC  X(0001).
  1286     05  FILLER REDEFINES PROCCDF.
  1287         10  PROCCDA PIC  X(0001).
  1288     05  PROCCDI PIC  X(0004).
  1289*    -------------------------------
  1290     05  RELCLML PIC S9(0004) COMP.
  1291     05  RELCLMF PIC  X(0001).
  1292     05  FILLER REDEFINES RELCLMF.
  1293         10  RELCLMA PIC  X(0001).
  1294     05  RELCLMI PIC  X(0007).
  1295*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  28
* EL130.cbl
  1296     05  PRTOPTL PIC S9(0004) COMP.
  1297     05  PRTOPTF PIC  X(0001).
  1298     05  FILLER REDEFINES PRTOPTF.
  1299         10  PRTOPTA PIC  X(0001).
  1300     05  PRTOPTI PIC  X(0001).
  1301*    -------------------------------
  1302     05  ALTPRTL PIC S9(0004) COMP.
  1303     05  ALTPRTF PIC  X(0001).
  1304     05  FILLER REDEFINES ALTPRTF.
  1305         10  ALTPRTA PIC  X(0001).
  1306     05  ALTPRTI PIC  X(0004).
  1307*    -------------------------------
  1308     05  CERTMTL PIC S9(0004) COMP.
  1309     05  CERTMTF PIC  X(0001).
  1310     05  FILLER REDEFINES CERTMTF.
  1311         10  CERTMTA PIC  X(0001).
  1312     05  CERTMTI PIC  X(0001).
  1313*    -------------------------------
  1314     05  CRTCARRL PIC S9(0004) COMP.
  1315     05  CRTCARRF PIC  X(0001).
  1316     05  FILLER REDEFINES CRTCARRF.
  1317         10  CRTCARRA PIC  X(0001).
  1318     05  CRTCARRI PIC  X(0001).
  1319*    -------------------------------
  1320     05  GROUPL PIC S9(0004) COMP.
  1321     05  GROUPF PIC  X(0001).
  1322     05  FILLER REDEFINES GROUPF.
  1323         10  GROUPA PIC  X(0001).
  1324     05  GROUPI PIC  X(0006).
  1325*    -------------------------------
  1326     05  STATEL PIC S9(0004) COMP.
  1327     05  STATEF PIC  X(0001).
  1328     05  FILLER REDEFINES STATEF.
  1329         10  STATEA PIC  X(0001).
  1330     05  STATEI PIC  X(0002).
  1331*    -------------------------------
  1332     05  ACCOUNTL PIC S9(0004) COMP.
  1333     05  ACCOUNTF PIC  X(0001).
  1334     05  FILLER REDEFINES ACCOUNTF.
  1335         10  ACCOUNTA PIC  X(0001).
  1336     05  ACCOUNTI PIC  X(0010).
  1337*    -------------------------------
  1338     05  EFFDTL PIC S9(0004) COMP.
  1339     05  EFFDTF PIC  X(0001).
  1340     05  FILLER REDEFINES EFFDTF.
  1341         10  EFFDTA PIC  X(0001).
  1342     05  EFFDTI PIC  X(0008).
  1343*    -------------------------------
  1344     05  CRTSSNL PIC S9(0004) COMP.
  1345     05  CRTSSNF PIC  X(0001).
  1346     05  FILLER REDEFINES CRTSSNF.
  1347         10  CRTSSNA PIC  X(0001).
  1348     05  CRTSSNI PIC  X(0011).
  1349*    -------------------------------
  1350     05  MEMCAPL PIC S9(0004) COMP.
  1351     05  MEMCAPF PIC  X(0001).
  1352     05  FILLER REDEFINES MEMCAPF.
  1353         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  29
* EL130.cbl
  1354     05  MEMCAPI PIC  X(0010).
  1355*    -------------------------------
  1356     05  MEMBERL PIC S9(0004) COMP.
  1357     05  MEMBERF PIC  X(0001).
  1358     05  FILLER REDEFINES MEMBERF.
  1359         10  MEMBERA PIC  X(0001).
  1360     05  MEMBERI PIC  X(0012).
  1361*    -------------------------------
  1362     05  REINCDL PIC S9(0004) COMP.
  1363     05  REINCDF PIC  X(0001).
  1364     05  FILLER REDEFINES REINCDF.
  1365         10  REINCDA PIC  X(0001).
  1366     05  REINCDI PIC  X(0001).
  1367*    -------------------------------
  1368     05  ISSAGEL PIC S9(0004) COMP.
  1369     05  ISSAGEF PIC  X(0001).
  1370     05  FILLER REDEFINES ISSAGEF.
  1371         10  ISSAGEA PIC  X(0001).
  1372     05  ISSAGEI PIC  X(0002).
  1373*    -------------------------------
  1374     05  APRL PIC S9(0004) COMP.
  1375     05  APRF PIC  X(0001).
  1376     05  FILLER REDEFINES APRF.
  1377         10  APRA PIC  X(0001).
  1378     05  APRI PIC  9(4)V9(4).
  1379*    -------------------------------
  1380     05  PMTFREQL PIC S9(0004) COMP.
  1381     05  PMTFREQF PIC  X(0001).
  1382     05  FILLER REDEFINES PMTFREQF.
  1383         10  PMTFREQA PIC  X(0001).
  1384     05  PMTFREQI PIC  99.
  1385*    -------------------------------
  1386     05  INDGRPL PIC S9(0004) COMP.
  1387     05  INDGRPF PIC  X(0001).
  1388     05  FILLER REDEFINES INDGRPF.
  1389         10  INDGRPA PIC  X(0001).
  1390     05  INDGRPI PIC  X(0001).
  1391*    -------------------------------
  1392     05  PREMTYPL PIC S9(0004) COMP.
  1393     05  PREMTYPF PIC  X(0001).
  1394     05  FILLER REDEFINES PREMTYPF.
  1395         10  PREMTYPA PIC  X(0001).
  1396     05  PREMTYPI PIC  X(0001).
  1397*    -------------------------------
  1398     05  ADDONDTL PIC S9(0004) COMP.
  1399     05  ADDONDTF PIC  X(0001).
  1400     05  FILLER REDEFINES ADDONDTF.
  1401         10  ADDONDTA PIC  X(0001).
  1402     05  ADDONDTI PIC  X(0008).
  1403*    -------------------------------
  1404     05  JNTLNMEL PIC S9(0004) COMP.
  1405     05  JNTLNMEF PIC  X(0001).
  1406     05  FILLER REDEFINES JNTLNMEF.
  1407         10  JNTLNMEA PIC  X(0001).
  1408     05  JNTLNMEI PIC  X(0015).
  1409*    -------------------------------
  1410     05  JNTFNMEL PIC S9(0004) COMP.
  1411     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  30
* EL130.cbl
  1412     05  FILLER REDEFINES JNTFNMEF.
  1413         10  JNTFNMEA PIC  X(0001).
  1414     05  JNTFNMEI PIC  X(0002).
  1415*    -------------------------------
  1416     05  JNTINITL PIC S9(0004) COMP.
  1417     05  JNTINITF PIC  X(0001).
  1418     05  FILLER REDEFINES JNTINITF.
  1419         10  JNTINITA PIC  X(0001).
  1420     05  JNTINITI PIC  X(0001).
  1421*    -------------------------------
  1422     05  JNTAGEL PIC S9(0004) COMP.
  1423     05  JNTAGEF PIC  X(0001).
  1424     05  FILLER REDEFINES JNTAGEF.
  1425         10  JNTAGEA PIC  X(0001).
  1426     05  JNTAGEI PIC  X(0002).
  1427*    -------------------------------
  1428     05  LCVDSCRL PIC S9(0004) COMP.
  1429     05  LCVDSCRF PIC  X(0001).
  1430     05  FILLER REDEFINES LCVDSCRF.
  1431         10  LCVDSCRA PIC  X(0001).
  1432     05  LCVDSCRI PIC  X(0006).
  1433*    -------------------------------
  1434     05  LCVKINDL PIC S9(0004) COMP.
  1435     05  LCVKINDF PIC  X(0001).
  1436     05  FILLER REDEFINES LCVKINDF.
  1437         10  LCVKINDA PIC  X(0001).
  1438     05  LCVKINDI PIC  X(0003).
  1439*    -------------------------------
  1440     05  LCVCDL PIC S9(0004) COMP.
  1441     05  LCVCDF PIC  X(0001).
  1442     05  FILLER REDEFINES LCVCDF.
  1443         10  LCVCDA PIC  X(0001).
  1444     05  LCVCDI PIC  X(0002).
  1445*    -------------------------------
  1446     05  LCVOTRML PIC S9(0004) COMP.
  1447     05  LCVOTRMF PIC  X(0001).
  1448     05  FILLER REDEFINES LCVOTRMF.
  1449         10  LCVOTRMA PIC  X(0001).
  1450     05  LCVOTRMI PIC  999.
  1451*    -------------------------------
  1452     05  LCVRTRML PIC S9(0004) COMP.
  1453     05  LCVRTRMF PIC  X(0001).
  1454     05  FILLER REDEFINES LCVRTRMF.
  1455         10  LCVRTRMA PIC  X(0001).
  1456     05  LCVRTRMI PIC  X(0003).
  1457*    -------------------------------
  1458     05  LCVRATEL PIC S9(0004) COMP.
  1459     05  LCVRATEF PIC  X(0001).
  1460     05  FILLER REDEFINES LCVRATEF.
  1461         10  LCVRATEA PIC  X(0001).
  1462     05  LCVRATEI PIC  9999V99.
  1463*    -------------------------------
  1464     05  LCVBENEL PIC S9(0004) COMP.
  1465     05  LCVBENEF PIC  X(0001).
  1466     05  FILLER REDEFINES LCVBENEF.
  1467         10  LCVBENEA PIC  X(0001).
  1468     05  LCVBENEI PIC  9(9)V99.
  1469*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  31
* EL130.cbl
  1470     05  LCVFORML PIC S9(0004) COMP.
  1471     05  LCVFORMF PIC  X(0001).
  1472     05  FILLER REDEFINES LCVFORMF.
  1473         10  LCVFORMA PIC  X(0001).
  1474     05  LCVFORMI PIC  X(0012).
  1475*    -------------------------------
  1476     05  LCVCNDTL PIC S9(0004) COMP.
  1477     05  LCVCNDTF PIC  X(0001).
  1478     05  FILLER REDEFINES LCVCNDTF.
  1479         10  LCVCNDTA PIC  X(0001).
  1480     05  LCVCNDTI PIC  X(0008).
  1481*    -------------------------------
  1482     05  LCVEXITL PIC S9(0004) COMP.
  1483     05  LCVEXITF PIC  X(0001).
  1484     05  FILLER REDEFINES LCVEXITF.
  1485         10  LCVEXITA PIC  X(0001).
  1486     05  LCVEXITI PIC  X(0008).
  1487*    -------------------------------
  1488     05  LCVSTATL PIC S9(0004) COMP.
  1489     05  LCVSTATF PIC  X(0001).
  1490     05  FILLER REDEFINES LCVSTATF.
  1491         10  LCVSTATA PIC  X(0001).
  1492     05  LCVSTATI PIC  X(0006).
  1493*    -------------------------------
  1494     05  ACVDSCRL PIC S9(0004) COMP.
  1495     05  ACVDSCRF PIC  X(0001).
  1496     05  FILLER REDEFINES ACVDSCRF.
  1497         10  ACVDSCRA PIC  X(0001).
  1498     05  ACVDSCRI PIC  X(0006).
  1499*    -------------------------------
  1500     05  ACVKINDL PIC S9(0004) COMP.
  1501     05  ACVKINDF PIC  X(0001).
  1502     05  FILLER REDEFINES ACVKINDF.
  1503         10  ACVKINDA PIC  X(0001).
  1504     05  ACVKINDI PIC  X(0003).
  1505*    -------------------------------
  1506     05  ACVCDL PIC S9(0004) COMP.
  1507     05  ACVCDF PIC  X(0001).
  1508     05  FILLER REDEFINES ACVCDF.
  1509         10  ACVCDA PIC  X(0001).
  1510     05  ACVCDI PIC  X(0002).
  1511*    -------------------------------
  1512     05  ACVOTRML PIC S9(0004) COMP.
  1513     05  ACVOTRMF PIC  X(0001).
  1514     05  FILLER REDEFINES ACVOTRMF.
  1515         10  ACVOTRMA PIC  X(0001).
  1516     05  ACVOTRMI PIC  999.
  1517*    -------------------------------
  1518     05  ACVRTRML PIC S9(0004) COMP.
  1519     05  ACVRTRMF PIC  X(0001).
  1520     05  FILLER REDEFINES ACVRTRMF.
  1521         10  ACVRTRMA PIC  X(0001).
  1522     05  ACVRTRMI PIC  X(0003).
  1523*    -------------------------------
  1524     05  ACVRATEL PIC S9(0004) COMP.
  1525     05  ACVRATEF PIC  X(0001).
  1526     05  FILLER REDEFINES ACVRATEF.
  1527         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  32
* EL130.cbl
  1528     05  ACVRATEI PIC  9999V99.
  1529*    -------------------------------
  1530     05  ACVBENEL PIC S9(0004) COMP.
  1531     05  ACVBENEF PIC  X(0001).
  1532     05  FILLER REDEFINES ACVBENEF.
  1533         10  ACVBENEA PIC  X(0001).
  1534     05  ACVBENEI PIC  9(9)V99.
  1535*    -------------------------------
  1536     05  ACVFORML PIC S9(0004) COMP.
  1537     05  ACVFORMF PIC  X(0001).
  1538     05  FILLER REDEFINES ACVFORMF.
  1539         10  ACVFORMA PIC  X(0001).
  1540     05  ACVFORMI PIC  X(0012).
  1541*    -------------------------------
  1542     05  ACVCNDTL PIC S9(0004) COMP.
  1543     05  ACVCNDTF PIC  X(0001).
  1544     05  FILLER REDEFINES ACVCNDTF.
  1545         10  ACVCNDTA PIC  X(0001).
  1546     05  ACVCNDTI PIC  X(0008).
  1547*    -------------------------------
  1548     05  ACVEXITL PIC S9(0004) COMP.
  1549     05  ACVEXITF PIC  X(0001).
  1550     05  FILLER REDEFINES ACVEXITF.
  1551         10  ACVEXITA PIC  X(0001).
  1552     05  ACVEXITI PIC  X(0008).
  1553*    -------------------------------
  1554     05  ACVSTATL PIC S9(0004) COMP.
  1555     05  ACVSTATF PIC  X(0001).
  1556     05  FILLER REDEFINES ACVSTATF.
  1557         10  ACVSTATA PIC  X(0001).
  1558     05  ACVSTATI PIC  X(0006).
  1559*    -------------------------------
  1560     05  ERRMSG1L PIC S9(0004) COMP.
  1561     05  ERRMSG1F PIC  X(0001).
  1562     05  FILLER REDEFINES ERRMSG1F.
  1563         10  ERRMSG1A PIC  X(0001).
  1564     05  ERRMSG1I PIC  X(0072).
  1565*    -------------------------------
  1566     05  ERRMSG2L PIC S9(0004) COMP.
  1567     05  ERRMSG2F PIC  X(0001).
  1568     05  FILLER REDEFINES ERRMSG2F.
  1569         10  ERRMSG2A PIC  X(0001).
  1570     05  ERRMSG2I PIC  X(0072).
  1571*    -------------------------------
  1572     05  BCERT1L PIC S9(0004) COMP.
  1573     05  BCERT1F PIC  X(0001).
  1574     05  FILLER REDEFINES BCERT1F.
  1575         10  BCERT1A PIC  X(0001).
  1576     05  BCERT1I PIC  X(0010).
  1577*    -------------------------------
  1578     05  BSUFX1L PIC S9(0004) COMP.
  1579     05  BSUFX1F PIC  X(0001).
  1580     05  FILLER REDEFINES BSUFX1F.
  1581         10  BSUFX1A PIC  X(0001).
  1582     05  BSUFX1I PIC  X(0001).
  1583*    -------------------------------
  1584     05  BCERT2L PIC S9(0004) COMP.
  1585     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  33
* EL130.cbl
  1586     05  FILLER REDEFINES BCERT2F.
  1587         10  BCERT2A PIC  X(0001).
  1588     05  BCERT2I PIC  X(0010).
  1589*    -------------------------------
  1590     05  BSUFX2L PIC S9(0004) COMP.
  1591     05  BSUFX2F PIC  X(0001).
  1592     05  FILLER REDEFINES BSUFX2F.
  1593         10  BSUFX2A PIC  X(0001).
  1594     05  BSUFX2I PIC  X(0001).
  1595*    -------------------------------
  1596     05  BCERT3L PIC S9(0004) COMP.
  1597     05  BCERT3F PIC  X(0001).
  1598     05  FILLER REDEFINES BCERT3F.
  1599         10  BCERT3A PIC  X(0001).
  1600     05  BCERT3I PIC  X(0010).
  1601*    -------------------------------
  1602     05  BSUFX3L PIC S9(0004) COMP.
  1603     05  BSUFX3F PIC  X(0001).
  1604     05  FILLER REDEFINES BSUFX3F.
  1605         10  BSUFX3A PIC  X(0001).
  1606     05  BSUFX3I PIC  X(0001).
  1607*    -------------------------------
  1608     05  BCERT4L PIC S9(0004) COMP.
  1609     05  BCERT4F PIC  X(0001).
  1610     05  FILLER REDEFINES BCERT4F.
  1611         10  BCERT4A PIC  X(0001).
  1612     05  BCERT4I PIC  X(0010).
  1613*    -------------------------------
  1614     05  BSUFX4L PIC S9(0004) COMP.
  1615     05  BSUFX4F PIC  X(0001).
  1616     05  FILLER REDEFINES BSUFX4F.
  1617         10  BSUFX4A PIC  X(0001).
  1618     05  BSUFX4I PIC  X(0001).
  1619*    -------------------------------
  1620     05  BCERT5L PIC S9(0004) COMP.
  1621     05  BCERT5F PIC  X(0001).
  1622     05  FILLER REDEFINES BCERT5F.
  1623         10  BCERT5A PIC  X(0001).
  1624     05  BCERT5I PIC  X(0010).
  1625*    -------------------------------
  1626     05  BSUFX5L PIC S9(0004) COMP.
  1627     05  BSUFX5F PIC  X(0001).
  1628     05  FILLER REDEFINES BSUFX5F.
  1629         10  BSUFX5A PIC  X(0001).
  1630     05  BSUFX5I PIC  X(0001).
  1631*    -------------------------------
  1632     05  ENTERPFL PIC S9(0004) COMP.
  1633     05  ENTERPFF PIC  X(0001).
  1634     05  FILLER REDEFINES ENTERPFF.
  1635         10  ENTERPFA PIC  X(0001).
  1636     05  ENTERPFI PIC  99.
  1637*    -------------------------------
  1638     05  PF5L PIC S9(0004) COMP.
  1639     05  PF5F PIC  X(0001).
  1640     05  FILLER REDEFINES PF5F.
  1641         10  PF5A PIC  X(0001).
  1642     05  PF5I PIC  X(0013).
  1643 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  34
* EL130.cbl
  1644     05  FILLER            PIC  X(0012).
  1645*    -------------------------------
  1646     05  FILLER            PIC  X(0003).
  1647     05  RUNDTEO PIC  X(0008).
  1648*    -------------------------------
  1649     05  FILLER            PIC  X(0003).
  1650     05  RUNTIMEO PIC  99.99.
  1651*    -------------------------------
  1652     05  FILLER            PIC  X(0003).
  1653     05  COMPO PIC  X(0003).
  1654*    -------------------------------
  1655     05  FILLER            PIC  X(0003).
  1656     05  SEQUO PIC  X(0010).
  1657*    -------------------------------
  1658     05  FILLER            PIC  X(0003).
  1659     05  MAINTO PIC  X(0001).
  1660*    -------------------------------
  1661     05  FILLER            PIC  X(0003).
  1662     05  CLMNOO PIC  X(0007).
  1663*    -------------------------------
  1664     05  FILLER            PIC  X(0003).
  1665     05  CLMCARRO PIC  X(0001).
  1666*    -------------------------------
  1667     05  FILLER            PIC  X(0003).
  1668     05  CLMTYPEO PIC  X(0001).
  1669*    -------------------------------
  1670     05  FILLER            PIC  X(0003).
  1671     05  CERTNOO PIC  X(0010).
  1672*    -------------------------------
  1673     05  FILLER            PIC  X(0003).
  1674     05  SUFXO PIC  X(0001).
  1675*    -------------------------------
  1676     05  FILLER            PIC  X(0003).
  1677     05  PCERTNOO PIC  X(0010).
  1678*    -------------------------------
  1679     05  FILLER            PIC  X(0003).
  1680     05  PSUFXO PIC  X(0001).
  1681*    -------------------------------
  1682     05  FILLER            PIC  X(0003).
  1683     05  INCURO PIC  X(0008).
  1684*    -------------------------------
  1685     05  FILLER            PIC  X(0003).
  1686     05  REPORTO PIC  X(0008).
  1687*    -------------------------------
  1688     05  FILLER            PIC  X(0003).
  1689     05  CAUSEO PIC  X(0006).
  1690*    -------------------------------
  1691     05  FILLER            PIC  X(0003).
  1692     05  ESTENDO PIC  X(0008).
  1693*    -------------------------------
  1694     05  FILLER            PIC  X(0003).
  1695     05  DIAGO PIC  X(0060).
  1696*    -------------------------------
  1697     05  FILLER            PIC  X(0003).
  1698     05  BENECDO PIC  X(0010).
  1699*    -------------------------------
  1700     05  FILLER            PIC  X(0003).
  1701     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  35
* EL130.cbl
  1702*    -------------------------------
  1703     05  FILLER            PIC  X(0003).
  1704     05  SSNO PIC  X(0011).
  1705*    -------------------------------
  1706     05  FILLER            PIC  X(0003).
  1707     05  SEXO PIC  X(0001).
  1708*    -------------------------------
  1709     05  FILLER            PIC  X(0003).
  1710     05  OCCCDO PIC  X(0006).
  1711*    -------------------------------
  1712     05  FILLER            PIC  X(0003).
  1713     05  LSTNMEO PIC  X(0015).
  1714*    -------------------------------
  1715     05  FILLER            PIC  X(0003).
  1716     05  FSTNMEO PIC  X(0012).
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
  1719     05  INITO PIC  X(0001).
  1720*    -------------------------------
  1721     05  FILLER            PIC  X(0003).
  1722     05  LOANNOO PIC  X(0008).
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  CRTLNMEO PIC  X(0015).
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
  1728     05  CRTFNMEO PIC  X(0012).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  CRTINITO PIC  X(0001).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  LOANBALO PIC  ZZZZZ9.99.
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  MANRSVO PIC  Z(5)9.99.
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
  1740     05  SUPVO PIC  X(0001).
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  PRICDO PIC  X(0001).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  PRODO PIC  X(0008).
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  PRODCDO PIC  X(0001).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  FILETOO PIC  X(0004).
  1753*    -------------------------------
  1754     05  FILLER            PIC  X(0003).
  1755     05  PROCCDO PIC  X(0004).
  1756*    -------------------------------
  1757     05  FILLER            PIC  X(0003).
  1758     05  RELCLMO PIC  X(0007).
  1759*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  36
* EL130.cbl
  1760     05  FILLER            PIC  X(0003).
  1761     05  PRTOPTO PIC  X(0001).
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  ALTPRTO PIC  X(0004).
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  CERTMTO PIC  X(0001).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  CRTCARRO PIC  X(0001).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  GROUPO PIC  X(0006).
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  STATEO PIC  X(0002).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  ACCOUNTO PIC  X(0010).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  EFFDTO PIC  X(0008).
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  CRTSSNO PIC  X(0011).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  MEMCAPO PIC  X(0010).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  MEMBERO PIC  X(0012).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  REINCDO PIC  X(0001).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  ISSAGEO PIC  X(0002).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  APRO PIC  9(3).9(4).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  PMTFREQO PIC  99.
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  INDGRPO PIC  X(0001).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  PREMTYPO PIC  X(0001).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  ADDONDTO PIC  X(0008).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  JNTLNMEO PIC  X(0015).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  37
* EL130.cbl
  1818     05  JNTFNMEO PIC  X(0002).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  JNTINITO PIC  X(0001).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  JNTAGEO PIC  X(0002).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  LCVDSCRO PIC  X(0006).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  LCVKINDO PIC  X(0003).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  LCVCDO PIC  X(0002).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  LCVOTRMO PIC  999.
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  LCVRTRMO PIC  ZZZ.
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  LCVRATEO PIC  ZZZ.ZZ.
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  LCVFORMO PIC  X(0012).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  LCVCNDTO PIC  X(0008).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  LCVEXITO PIC  X(0008).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  LCVSTATO PIC  X(0006).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  ACVDSCRO PIC  X(0006).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  ACVKINDO PIC  X(0003).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  ACVCDO PIC  X(0002).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  ACVOTRMO PIC  999.
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  ACVRTRMO PIC  ZZZ.
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  38
* EL130.cbl
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  ACVFORMO PIC  X(0012).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  ACVCNDTO PIC  X(0008).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  ACVEXITO PIC  X(0008).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  ACVSTATO PIC  X(0006).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  ERRMSG1O PIC  X(0072).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  ERRMSG2O PIC  X(0072).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  BCERT1O PIC  X(0010).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  BSUFX1O PIC  X(0001).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  BCERT2O PIC  X(0010).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  BSUFX2O PIC  X(0001).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  BCERT3O PIC  X(0010).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  BSUFX3O PIC  X(0001).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  BCERT4O PIC  X(0010).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  BSUFX4O PIC  X(0001).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  BCERT5O PIC  X(0010).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  BSUFX5O PIC  X(0001).
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  ENTERPFO PIC  X(0002).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  PF5O PIC  X(0013).
  1933*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  39
* EL130.cbl
  1935*    COPY ELCDATE.
  1936******************************************************************
  1937*                                                                *
  1938*                                                                *
  1939*                            ELCDATE.                            *
  1940*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1941*                            VMOD=2.003
  1942*                                                                *
  1943*                                                                *
  1944*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1945*                 LENGTH = 200                                   *
  1946******************************************************************
  1947
  1948 01  DATE-CONVERSION-DATA.
  1949     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1950     12  DC-OPTION-CODE                PIC X.
  1951         88  BIN-TO-GREG                VALUE ' '.
  1952         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1953         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1954         88  YMD-GREG-TO-BIN            VALUE '3'.
  1955         88  MDY-GREG-TO-BIN            VALUE '4'.
  1956         88  JULIAN-TO-BIN              VALUE '5'.
  1957         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1958         88  FIND-CENTURY               VALUE '7'.
  1959         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1960         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1961         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1962         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1963         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1964         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1965         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1966         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1967         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1968         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1969         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1970         88  BIN-3-TO-GREG              VALUE 'I'.
  1971         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1972         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1973         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1974         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1975         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1976         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1977         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1978         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1979         88  THREE-CHARACTER-BIN
  1980                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1981         88  GREGORIAN-TO-BIN
  1982                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1983         88  BIN-TO-GREGORIAN
  1984                  VALUES ' ' '1' 'I' '8' 'G'.
  1985         88  JULIAN-TO-BINARY
  1986                  VALUES '5' 'C' 'E' 'F'.
  1987     12  DC-ERROR-CODE                 PIC X.
  1988         88  NO-CONVERSION-ERROR        VALUE ' '.
  1989         88  DATE-CONVERSION-ERROR
  1990                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1991         88  DATE-IS-ZERO               VALUE '1'.
  1992         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  40
* EL130.cbl
  1993         88  DATE-IS-INVALID            VALUE '3'.
  1994         88  DATE1-GREATER-DATE2        VALUE '4'.
  1995         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1996         88  DATE-INVALID-OPTION        VALUE '9'.
  1997         88  INVALID-CENTURY            VALUE 'A'.
  1998         88  ONLY-CENTURY               VALUE 'B'.
  1999         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2000         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2001     12  DC-END-OF-MONTH               PIC X.
  2002         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2003     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2004         88  USE-NORMAL-PROCESS         VALUE ' '.
  2005         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2006         88  ADJUST-UP-100-YRS          VALUE '2'.
  2007     12  FILLER                        PIC X.
  2008     12  DC-CONVERSION-DATES.
  2009         16  DC-BIN-DATE-1             PIC XX.
  2010         16  DC-BIN-DATE-2             PIC XX.
  2011         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2012         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2013                       DC-GREG-DATE-1-EDIT.
  2014             20  DC-EDIT1-MONTH        PIC 99.
  2015             20  SLASH1-1              PIC X.
  2016             20  DC-EDIT1-DAY          PIC 99.
  2017             20  SLASH1-2              PIC X.
  2018             20  DC-EDIT1-YEAR         PIC 99.
  2019         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2020         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2021                     DC-GREG-DATE-2-EDIT.
  2022             20  DC-EDIT2-MONTH        PIC 99.
  2023             20  SLASH2-1              PIC X.
  2024             20  DC-EDIT2-DAY          PIC 99.
  2025             20  SLASH2-2              PIC X.
  2026             20  DC-EDIT2-YEAR         PIC 99.
  2027         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2028         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2029                     DC-GREG-DATE-1-YMD.
  2030             20  DC-YMD-YEAR           PIC 99.
  2031             20  DC-YMD-MONTH          PIC 99.
  2032             20  DC-YMD-DAY            PIC 99.
  2033         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2034         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2035                      DC-GREG-DATE-1-MDY.
  2036             20  DC-MDY-MONTH          PIC 99.
  2037             20  DC-MDY-DAY            PIC 99.
  2038             20  DC-MDY-YEAR           PIC 99.
  2039         16  DC-GREG-DATE-1-ALPHA.
  2040             20  DC-ALPHA-MONTH        PIC X(10).
  2041             20  DC-ALPHA-DAY          PIC 99.
  2042             20  FILLER                PIC XX.
  2043             20  DC-ALPHA-CENTURY.
  2044                 24 DC-ALPHA-CEN-N     PIC 99.
  2045             20  DC-ALPHA-YEAR         PIC 99.
  2046         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2047         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2048         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2049         16  DC-JULIAN-DATE            PIC 9(05).
  2050         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  41
* EL130.cbl
  2051                                       PIC 9(05).
  2052         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2053             20  DC-JULIAN-YEAR        PIC 99.
  2054             20  DC-JULIAN-DAYS        PIC 999.
  2055         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2056         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2057         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2058     12  DATE-CONVERSION-VARIBLES.
  2059         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2060         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2061             20  FILLER                PIC 9(3).
  2062             20  HOLD-CEN-1-CCYY.
  2063                 24  HOLD-CEN-1-CC     PIC 99.
  2064                 24  HOLD-CEN-1-YY     PIC 99.
  2065             20  HOLD-CEN-1-MO         PIC 99.
  2066             20  HOLD-CEN-1-DA         PIC 99.
  2067         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2068             20  HOLD-CEN-1-R-MO       PIC 99.
  2069             20  HOLD-CEN-1-R-DA       PIC 99.
  2070             20  HOLD-CEN-1-R-CCYY.
  2071                 24  HOLD-CEN-1-R-CC   PIC 99.
  2072                 24  HOLD-CEN-1-R-YY   PIC 99.
  2073             20  FILLER                PIC 9(3).
  2074         16  HOLD-CENTURY-1-X.
  2075             20  FILLER                PIC X(3)  VALUE SPACES.
  2076             20  HOLD-CEN-1-X-CCYY.
  2077                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2078                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2079             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2080             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2081         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2082             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2083             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2084             20  HOLD-CEN-1-R-X-CCYY.
  2085                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2086                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2087             20  FILLER                PIC XXX.
  2088         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2089         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2090         16  DC-JULIAN-DATE-1          PIC 9(07).
  2091         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2092             20  DC-JULIAN-1-CCYY.
  2093                 24  DC-JULIAN-1-CC    PIC 99.
  2094                 24  DC-JULIAN-1-YR    PIC 99.
  2095             20  DC-JULIAN-DA-1        PIC 999.
  2096         16  DC-JULIAN-DATE-2          PIC 9(07).
  2097         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2098             20  DC-JULIAN-2-CCYY.
  2099                 24  DC-JULIAN-2-CC    PIC 99.
  2100                 24  DC-JULIAN-2-YR    PIC 99.
  2101             20  DC-JULIAN-DA-2        PIC 999.
  2102         16  DC-GREG-DATE-A-EDIT.
  2103             20  DC-EDITA-MONTH        PIC 99.
  2104             20  SLASHA-1              PIC X VALUE '/'.
  2105             20  DC-EDITA-DAY          PIC 99.
  2106             20  SLASHA-2              PIC X VALUE '/'.
  2107             20  DC-EDITA-CCYY.
  2108                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  42
* EL130.cbl
  2109                 24  DC-EDITA-YEAR     PIC 99.
  2110         16  DC-GREG-DATE-B-EDIT.
  2111             20  DC-EDITB-MONTH        PIC 99.
  2112             20  SLASHB-1              PIC X VALUE '/'.
  2113             20  DC-EDITB-DAY          PIC 99.
  2114             20  SLASHB-2              PIC X VALUE '/'.
  2115             20  DC-EDITB-CCYY.
  2116                 24  DC-EDITB-CENT     PIC 99.
  2117                 24  DC-EDITB-YEAR     PIC 99.
  2118         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2119         16  DC-GREG-DATE-CYMD-R REDEFINES
  2120                              DC-GREG-DATE-CYMD.
  2121             20  DC-CYMD-CEN           PIC 99.
  2122             20  DC-CYMD-YEAR          PIC 99.
  2123             20  DC-CYMD-MONTH         PIC 99.
  2124             20  DC-CYMD-DAY           PIC 99.
  2125         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2126         16  DC-GREG-DATE-MDCY-R REDEFINES
  2127                              DC-GREG-DATE-MDCY.
  2128             20  DC-MDCY-MONTH         PIC 99.
  2129             20  DC-MDCY-DAY           PIC 99.
  2130             20  DC-MDCY-CEN           PIC 99.
  2131             20  DC-MDCY-YEAR          PIC 99.
  2132    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2133        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2134    12  DC-EL310-DATE                  PIC X(21).
  2135    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  43
* EL130.cbl
  2137*    COPY ELCCALC.
  2138******************************************************************
  2139*                                                                *
  2140*                           ELCCALC.                            *
  2141*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2142*                            VMOD=2.025                          *
  2143*                                                                *
  2144*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2145*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2146*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2147*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2148*                                                                *
  2149*  PASSED TO ELRTRM                                              *
  2150*  -----------------                                             *
  2151*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2152*  ORIGINAL TERM                                                 *
  2153*  BEGINNING DATE                                                *
  2154*  ENDING DATE                                                   *
  2155*  COMPANY I.D.                                                  *
  2156*  ACCOUNT MASTER USER FIELD                                     *
  2157*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2158*  FREE LOOK DAYS                                                *
  2159*                                                                *
  2160*  RETURNED FROM ELRTRM                                          *
  2161*  ---------------------                                         *
  2162*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2163*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2164*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2165*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2166*----------------------------------------------------------------*
  2167*  PASSED TO ELRAMT                                              *
  2168*  ----------------                                              *
  2169*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2170*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2171*  ORIGINAL AMOUNT                                               *
  2172*  ALTERNATE BENEFIT (BALLON)                                    *
  2173*  A.P.R. - NET PAY ONLY                                         *
  2174*  METHOD
  2175*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2176*  COMPANY I.D.                                                  *
  2177*  BENEFIT TYPE                                                  *
  2178*                                                                *
  2179*  RETURNED FROM ELRAMT                                          *
  2180*  --------------------                                          *
  2181*  REMAINING AMOUNT 1 - CURRENT                                  *
  2182*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2183*  REMAINING AMOUNT FACTOR
  2184*----------------------------------------------------------------*
  2185*  PASSED TO ELRESV                                              *
  2186*  -----------------                                             *
  2187*  CERTIFICATE EFFECTIVE DATE                                    *
  2188*  VALUATION DATE                                                *
  2189*  PAID THRU DATE                                                *
  2190*  BENEFIT                                                       *
  2191*  INCURRED DATE                                                 *
  2192*  REPORTED DATE                                                 *
  2193*  ISSUE AGE                                                     *
  2194*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  44
* EL130.cbl
  2195*  CDT PERCENT                                                   *
  2196*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2197* *CLAIM TYPE (LIFE, A/H)                                        *
  2198* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2199* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2200*                                                                *
  2201*  RETURNED FROM ELRESV                                          *
  2202*  --------------------                                          *
  2203*  CDT TABLE USED                                                *
  2204*  CDT FACTOR USED                                               *
  2205*  PAY TO CURRENT RESERVE                                        *
  2206*  I.B.N.R. - A/H ONLY                                           *
  2207*  FUTURE (ACCRUED) AH ONLY                                      *
  2208*----------------------------------------------------------------*
  2209*  PASSED TO ELRATE                                              *
  2210*  ----------------                                              *
  2211*  CERT ISSUE DATE                                               *
  2212*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2213*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2214*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2215*  STATE CODE (CLIENT DEFINED)                                   *
  2216*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2217*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2218*  DEVIATION CODE                                                *
  2219*  ISSUE AGE                                                     *
  2220*  ORIGINAL BENEFIT AMOUNT                                       *
  2221*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2222*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2223*  BENEFIT KIND (LIFE OR A/H)                                    *
  2224*  A.P.R.                                                        *
  2225*  METHOD
  2226*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2227*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2228*  COMPANY I.D. (3 CHARACTER)                                    *
  2229*  BENEFIT CODE                                                  *
  2230*  BENEFIT OVERRIDE CODE                                         *
  2231*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2232*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2233*  JOINT INDICATOR (CSL ONLY)                                    *
  2234*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2235*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2236*                                                                *
  2237*  RETURNED FROM ELRATE                                          *
  2238*  --------------------                                          *
  2239*  CALCULATED PREMIUM                                            *
  2240*  PREMIUM RATE                                                  *
  2241*  MORTALITY CODE                                                *
  2242*  MAX ATTAINED AGE                                              *
  2243*  MAX AGE                                                       *
  2244*  MAX TERM                                                      *
  2245*  MAX MONTHLY BENEFIT                                           *
  2246*  MAX TOTAL BENIFIT                                             *
  2247*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2248*----------------------------------------------------------------*
  2249*  PASSED TO ELRFND                                              *
  2250*  ----------------                                              *
  2251*  CERT ISSUE DATE                                               *
  2252*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  45
* EL130.cbl
  2253*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2254*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2255*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2256*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2257*  STATE CODE (CLIENT DEFINED)                                   *
  2258*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2259*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2260*  DEVIATION CODE                                                *
  2261*  ISSUE AGE                                                     *
  2262*  ORIGINAL BENEFIT AMOUNT                                       *
  2263*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2264*  PROCESS TYPE (CANCEL)                                         *
  2265*  BENEFIT KIND (LIFE OR A/H)                                    *
  2266*  A.P.R.                                                        *
  2267*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2268*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2269*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2270*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2271*  COMPANY I.D. (3 CHARACTER)                                    *
  2272*  BENEFIT CODE                                                  *
  2273*  BENEFIT OVERRIDE CODE                                         *
  2274*                                                                *
  2275*  RETURNED FROM ELRFND                                          *
  2276*  --------------------                                          *
  2277*  CALCULATED REFUND                                             *
  2278*----------------------------------------------------------------*
  2279*  PASSED TO ELEARN                                              *
  2280*  ----------------                                              *
  2281*  CERT ISSUE DATE                                               *
  2282*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2283*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2284*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2285*  STATE CODE (CLIENT DEFINED)                                   *
  2286*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2287*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2288*  DEVIATION CODE                                                *
  2289*  ISSUE AGE                                                     *
  2290*  ORIGINAL BENEFIT AMOUNT                                       *
  2291*  BENEFIT KIND (LIFE OR A/H)                                    *
  2292*  A.P.R.                                                        *
  2293*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2294*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2295*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2296*  COMPANY I.D. (3 CHARACTER)                                    *
  2297*  BENEFIT CODE                                                  *
  2298*  BENEFIT OVERRIDE CODE                                         *
  2299*                                                                *
  2300*  RETURNED FROM ELEARN                                          *
  2301*  --------------------                                          *
  2302*  INDICATED  EARNINGS                                           *
  2303*----------------------------------------------------------------*
  2304*                 LENGTH = 450                                   *
  2305*                                                                *
  2306******************************************************************
  2307******************************************************************
  2308*                   C H A N G E   L O G
  2309*
  2310* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  46
* EL130.cbl
  2311*-----------------------------------------------------------------
  2312*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2313* EFFECTIVE    NUMBER
  2314*-----------------------------------------------------------------
  2315* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2316* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2317* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2318* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2319* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2320* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2321* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2322* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2323* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2324******************************************************************
  2325
  2326 01  CALCULATION-PASS-AREA.
  2327     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2328                                     COMP.
  2329
  2330     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2331       88  NO-CP-ERROR                             VALUE ZERO.
  2332       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2333                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2334       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2335       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2336       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2337       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2338       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2339       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2340       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2341       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2342       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2343       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2344       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2345       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2346       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2347       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2348       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2349       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2350       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2351
  2352     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2353       88  NO-CP-ERROR-2                           VALUE ZERO.
  2354***********************  INPUT AREAS ****************************
  2355
  2356     12  CP-CALCULATION-AREA.
  2357         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2358         16  CP-CERT-EFF-DT        PIC XX.
  2359         16  CP-VALUATION-DT       PIC XX.
  2360         16  CP-PAID-THRU-DT       PIC XX.
  2361         16  CP-BENEFIT-TYPE       PIC X.
  2362           88  CP-AH                               VALUE 'A' 'D'
  2363                                                   'I' 'U'.
  2364           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2365           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2366         16  CP-INCURRED-DT        PIC XX.
  2367         16  CP-REPORTED-DT        PIC XX.
  2368         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  47
* EL130.cbl
  2369         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2370         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2371                                     COMP-3.
  2372         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2373                                     COMP-3.
  2374         16  CP-CDT-METHOD         PIC X.
  2375           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2376           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2377           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2378         16  CP-CLAIM-TYPE         PIC X.
  2379           88  CP-AH-CLAIM                         VALUE 'A'.
  2380           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2381         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2382                                     COMP-3.
  2383         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2384                                     COMP-3.
  2385         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2386                                     COMP-3.
  2387         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2388                                     COMP-3.
  2389         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2390                                     COMP-3.
  2391         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2392                                     COMP-3.
  2393         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2394                                     COMP-3.
  2395         16  CP-REM-TERM-METHOD    PIC X.
  2396           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2397           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2398           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2399           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2400           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2401           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2402           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2403         16  CP-EARNING-METHOD     PIC X.
  2404           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2405           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2406           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2407           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2408           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2409           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2410           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2411           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2412           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2413           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2414           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2415           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2416           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2417           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2418         16  CP-PROCESS-TYPE       PIC X.
  2419           88  CP-CLAIM                            VALUE '1'.
  2420           88  CP-CANCEL                           VALUE '2'.
  2421           88  CP-ISSUE                            VALUE '3'.
  2422         16  CP-SPECIAL-CALC-CD    PIC X.
  2423           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2424           88  CP-1-MTH-INTEREST               VALUE ' '.
  2425           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2426           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  48
* EL130.cbl
  2427           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2428           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2429           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2430           88  CP-FARM-PLAN                    VALUE 'F'.
  2431           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2432           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2433           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2434           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2435           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2436           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2437           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2438           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2439           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2440           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2441                                                     'W' 'X'.
  2442           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2443           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2444           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2445           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2446           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2447           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2448           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2449           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2450           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2451           88  CP-CSL-METH-1                   VALUE '5'.
  2452           88  CP-CSL-METH-2                   VALUE '6'.
  2453           88  CP-CSL-METH-3                   VALUE '7'.
  2454           88  CP-CSL-METH-4                   VALUE '8'.
  2455
  2456         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2457                                     COMP-3.
  2458         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2459         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2460         16  CP-STATE              PIC XX          VALUE SPACE.
  2461         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2462         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2463           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2464               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2465         16  CP-R78-OPTION         PIC X.
  2466           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2467           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2468
  2469         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2470         16  CP-IBNR-RESERVE-SW    PIC X.
  2471         16  CP-CLAIM-STATUS       PIC X.
  2472         16  CP-RATE-FILE          PIC X.
  2473         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2474                                     COMP-3.
  2475
  2476         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2477         16  CP-AH-OVERRIDE-CODE   PIC X.
  2478
  2479         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2480                                     COMP-3.
  2481         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2482                                   PIC S9(5)V99 COMP-3.
  2483         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2484                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  49
* EL130.cbl
  2485         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2486                                     COMP-3.
  2487         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2488                                     COMP-3.
  2489         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2490                                  PIC S9(7)V99 COMP-3.
  2491
  2492         16  CP-PAID-FROM-DATE     PIC X(02).
  2493         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2494         16  CP-EXT-DAYS-CALC      PIC X.
  2495           88  CP-EXT-NO-CHG                   VALUE ' '.
  2496           88  CP-EXT-CHG-LF                   VALUE '1'.
  2497           88  CP-EXT-CHG-AH                   VALUE '2'.
  2498           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2499         16  CP-DOMICILE-STATE     PIC XX.
  2500         16  CP-CARRIER            PIC X.
  2501         16  CP-REIN-FLAG          PIC X.
  2502         16  CP-REM-TRM-CALC-OPTION PIC X.
  2503           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2504                      '2' '3' '4' '5'.
  2505           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2506           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2507           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2508           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2509           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2510           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2511           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2512           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2513         16  CP-SIG-SWITCH         PIC X.
  2514         16  CP-RATING-METHOD      PIC X.
  2515           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2516           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2517           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2518           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2519           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2520           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2521           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2522           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2523           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2524         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2525                                     COMP-3.
  2526         16  CP-BEN-CATEGORY       PIC X.
  2527         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2528         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2529                                   PIC S99V9(5) COMP-3.
  2530         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2531         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2532                                   PIC S99V9(5) COMP-3.
  2533         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2534         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2535         16  CP-EXPIRE-DT          PIC XX.
  2536         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2537         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2538         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2539         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2540         16  CP-DDF-SPEC-CALC      PIC X.
  2541             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2542             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  50
* EL130.cbl
  2543         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2544         16  CP-CANCEL-REASON      PIC X.
  2545         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2546         16  CP-PMT-MODE           PIC X.
  2547         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2548         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2549         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2550         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2551         16  FILLER                PIC X.
  2552
  2553***************    OUTPUT FROM ELRESV   ************************
  2554
  2555         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2556
  2557         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2558                                     COMP-3.
  2559         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2560                                     COMP-3.
  2561         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2562                                     COMP-3.
  2563         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2564                                     COMP-3.
  2565         16  FILLER                PIC X(09).
  2566***************    OUTPUT FROM ELRTRM   *************************
  2567
  2568         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2569                                     COMP-3.
  2570         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2571                                     COMP-3.
  2572         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2573                                     COMP-3.
  2574         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2575                                     COMP-3.
  2576         16  FILLER                PIC X(12).
  2577
  2578***************    OUTPUT FROM ELRAMT   *************************
  2579
  2580         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2581                                     COMP-3.
  2582         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2583                                     COMP-3.
  2584         16  FILLER                PIC X(12).
  2585
  2586***************    OUTPUT FROM ELRATE   *************************
  2587
  2588         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2589                                     COMP-3.
  2590         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2591                                     COMP-3.
  2592         16  CP-MORTALITY-CODE     PIC X(4).
  2593         16  CP-RATE-EDIT-FLAG     PIC X.
  2594             88  CP-RATES-NEED-APR                  VALUE '1'.
  2595         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2596                                     COMP-3.
  2597         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2598         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2599         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2600                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  51
* EL130.cbl
  2601         16  FILLER                PIC X(07).
  2602
  2603***************    OUTPUT FROM ELRFND   *************************
  2604
  2605         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2606                                     COMP-3.
  2607         16  CP-REFUND-TYPE-USED   PIC X.
  2608           88  CP-R-AS-R78                         VALUE '1'.
  2609           88  CP-R-AS-PRORATA                     VALUE '2'.
  2610           88  CP-R-AS-CALIF                       VALUE '3'.
  2611           88  CP-R-AS-TEXAS                       VALUE '4'.
  2612           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2613           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2614           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2615           88  CP-R-AS-MEAN                        VALUE '8'.
  2616           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2617           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2618           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2619           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2620           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2621           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2622         16  FILLER                PIC X(12).
  2623
  2624***************    OUTPUT FROM ELEARN   *************************
  2625
  2626         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2627                                     COMP-3.
  2628         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2629                                     COMP-3.
  2630         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2631                                     COMP-3.
  2632         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2633                                     COMP-3.
  2634         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2635                                     COMP-3.
  2636         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2637                                     COMP-3.
  2638         16  CP-EARNING-TYPE-USED  PIC X.
  2639           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2640           88  CP-E-AS-R78                         VALUE '1'.
  2641           88  CP-E-AS-PRORATA                     VALUE '2'.
  2642           88  CP-E-AS-TEXAS                       VALUE '4'.
  2643           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2644           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2645           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2646           88  CP-E-AS-MEAN                        VALUE '8'.
  2647           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2648         16  FILLER                PIC X(12).
  2649
  2650***************    OUTPUT FROM ELPMNT   *************************
  2651
  2652         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2653                                     COMP-3.
  2654         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2655                                     COMP-3.
  2656         16  FILLER                PIC X(12).
  2657
  2658***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  52
* EL130.cbl
  2659         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2660                                     COMP-3.
  2661         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2662                                     COMP-3.
  2663         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2664                                     COMP-3.
  2665         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2666                                     COMP-3.
  2667         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2668                                     COMP-3.
  2669         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2670                                     COMP-3.
  2671         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2672             88  OPEN-RATE-FILE                   VALUE 'O'.
  2673             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2674             88  IO-ERROR                         VALUE 'E'.
  2675
  2676         16  CP-FIRST-PAY-DATE     PIC XX.
  2677
  2678         16  CP-JOINT-INDICATOR    PIC X.
  2679
  2680         16  CP-RESERVE-REMAINING-TERM
  2681                                   PIC S9(4)V9    VALUE ZERO
  2682                                     COMP-3.
  2683
  2684         16  CP-INSURED-BIRTH-DT   PIC XX.
  2685
  2686         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2687                                     COMP-3.
  2688
  2689         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2690                                     COMP-3.
  2691
  2692         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2693                                     COMP-3.
  2694
  2695         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2696                                     COMP-3.
  2697
  2698         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2699                                     COMP-3.
  2700
  2701         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2702                                     COMP-3.
  2703
  2704         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2705                                     COMP-3.
  2706
  2707         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2708             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2709
  2710         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2711                                     COMP-3.
  2712         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2713                                     COMP-3.
  2714         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2715         16  FILLER                PIC X(15).
  2716******************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  53
* EL130.cbl
  2718*    COPY ELCLOGOF.
  2719******************************************************************
  2720*                                                                *
  2721*                                                                *
  2722*                            ELCLOGOF.                           *
  2723*                            VMOD=2.001                          *
  2724*                                                                *
  2725*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2726*                                                                *
  2727******************************************************************
  2728 01  CLASIC-LOGOFF.
  2729     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2730     12  LOGOFF-TEXT.
  2731         16  FILLER          PIC X(5)    VALUE SPACES.
  2732         16  LOGOFF-MSG.
  2733             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2734             20  FILLER      PIC X       VALUE SPACES.
  2735             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2736         16  FILLER          PIC X(80)
  2737           VALUE '* YOU ARE NOW LOGGED OFF'.
  2738         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2739         16  FILLER          PIC X       VALUE QUOTE.
  2740         16  LOGOFF-SYS-MSG  PIC X(17)
  2741           VALUE 'S CLAS-IC SYSTEM '.
  2742     12  TEXT-MESSAGES.
  2743         16  UNACCESS-MSG    PIC X(29)
  2744             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2745         16  PGMIDERR-MSG    PIC X(17)
  2746             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  54
* EL130.cbl
  2748*    COPY ELCATTR.
  2749******************************************************************
  2750*                                                                *
  2751*                            ELCATTR.                            *
  2752*                            VMOD=2.001                          *
  2753*                                                                *
  2754*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2755*                                                                *
  2756*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2757*                                                                *
  2758*                   POS 1   P=PROTECTED                          *
  2759*                           U=UNPROTECTED                        *
  2760*                           S=ASKIP                              *
  2761*                   POS 2   A=ALPHA/NUMERIC                      *
  2762*                           N=NUMERIC                            *
  2763*                   POS 3   N=NORMAL                             *
  2764*                           B=BRIGHT                             *
  2765*                           D=DARK                               *
  2766*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2767*                           OF=MODIFIED DATA TAG OFF             *
  2768*                                                                *
  2769*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2770******************************************************************
  2771 01  ATTRIBUTE-LIST.
  2772     12  AL-PABOF            PIC X       VALUE 'Y'.
  2773     12  AL-PABON            PIC X       VALUE 'Z'.
  2774     12  AL-PADOF            PIC X       VALUE '%'.
  2775     12  AL-PADON            PIC X       VALUE '_'.
  2776     12  AL-PANOF            PIC X       VALUE '-'.
  2777     12  AL-PANON            PIC X       VALUE '/'.
  2778     12  AL-SABOF            PIC X       VALUE '8'.
  2779     12  AL-SABON            PIC X       VALUE '9'.
  2780     12  AL-SADOF            PIC X       VALUE '@'.
  2781     12  AL-SADON            PIC X       VALUE QUOTE.
  2782     12  AL-SANOF            PIC X       VALUE '0'.
  2783     12  AL-SANON            PIC X       VALUE '1'.
  2784     12  AL-UABOF            PIC X       VALUE 'H'.
  2785     12  AL-UABON            PIC X       VALUE 'I'.
  2786     12  AL-UADOF            PIC X       VALUE '<'.
  2787     12  AL-UADON            PIC X       VALUE '('.
  2788     12  AL-UANOF            PIC X       VALUE ' '.
  2789     12  AL-UANON            PIC X       VALUE 'A'.
  2790     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2791     12  AL-UNBON            PIC X       VALUE 'R'.
  2792     12  AL-UNDOF            PIC X       VALUE '*'.
  2793     12  AL-UNDON            PIC X       VALUE ')'.
  2794     12  AL-UNNOF            PIC X       VALUE '&'.
  2795     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  55
* EL130.cbl
  2797*    COPY ELCEMIB.
  2798******************************************************************
  2799*                                                                *
  2800*                                                                *
  2801*                            ELCEMIB.                            *
  2802*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2803*                            VMOD=2.005                          *
  2804*                                                                *
  2805*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2806*                                                                *
  2807******************************************************************
  2808 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2809     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2810     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2811     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2812     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2813     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2814     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2815     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2816     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2817     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2818         88  EMI-NO-ERRORS                    VALUE '1'.
  2819         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2820         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2821     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2822         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2823     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2824         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2825         88  EMI-AREA1-FULL                   VALUE '2'.
  2826     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2827         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2828         88  EMI-AREA2-FULL                   VALUE '2'.
  2829     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2830         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2831         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2832         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2833         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2834         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2835     12  EMI-ERROR-LINES.
  2836         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2837         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2838         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2839         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2840             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2841                 24  EMI-ERR-NUM         PIC X(4).
  2842                 24  EMI-FILLER          PIC X.
  2843                 24  EMI-SEV             PIC X.
  2844                 24  FILLER              PIC X.
  2845             20  FILLER                  PIC X(02).
  2846     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2847         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2848             20  EMI-ERROR-NUMBER    PIC X(4).
  2849             20  EMI-FILL            PIC X.
  2850             20  EMI-SEVERITY        PIC X.
  2851             20  FILLER              PIC X.
  2852             20  EMI-ERROR-TEXT.
  2853                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2854                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  56
* EL130.cbl
  2855     12  EMI-SEVERITY-SAVE           PIC X.
  2856         88  EMI-NOTE                    VALUE 'N'.
  2857         88  EMI-WARNING                 VALUE 'W'.
  2858         88  EMI-FORCABLE                VALUE 'F'.
  2859         88  EMI-FATAL                   VALUE 'X'.
  2860     12  EMI-MESSAGE-FLAG            PIC X.
  2861         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2862         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2863     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2864     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2865         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2866         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2867         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2868     12  FILLER                      PIC X(137)  VALUE SPACES.
  2869     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2870     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2871     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2872     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  57
* EL130.cbl
  2874*    COPY ELCJPFX.
  2875******************************************************************
  2876*                                                                *
  2877*                                                                *
  2878*                            ELCJPFX.                            *
  2879*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2880*                            VMOD=2.002                          *
  2881*                                                                *
  2882*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2883*                                                                *
  2884*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2885*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2886*        ELCNTL - CONTROL FILE                                   *
  2887*        ELMSTR - CLAIM MASTERS                                  *
  2888*        ELTRLR - ACTIVITY TRAILERS                              *
  2889*        ELCHKQ - CHECK QUE                                      *
  2890******************************************************************
  2891 01  JOURNAL-RECORD.
  2892     12  JP-USER-ID                  PIC X(4).
  2893     12  JP-FILE-ID                  PIC X(8).
  2894     12  JP-PROGRAM-ID               PIC X(8).
  2895     12  JP-RECORD-TYPE              PIC X.
  2896         88 JP-ADD              VALUE 'A'.
  2897         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2898         88 JP-AFTER-CHANGE     VALUE 'C'.
  2899         88 JP-DELETE           VALUE 'D'.
  2900         88 JP-GENERIC-DELETE   VALUE 'G'.
  2901         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2902         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2903     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2904     12  JP-RECORD-AREA
  2905
  2906
  2907         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  58
* EL130.cbl
  2909*    COPY ELCAID.
  2910******************************************************************
  2911*                                                                *
  2912*                            ELCAID.                             *
  2913*                            VMOD=2.001                          *
  2914*                                                                *
  2915*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2916*                                                                *
  2917*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2918*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2919******************************************************************
  2920
  2921 01  DFHAID.
  2922   02  DFHNULL   PIC  X  VALUE  ' '.
  2923   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2924   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2925   02  DFHPEN    PIC  X  VALUE  '='.
  2926   02  DFHOPID   PIC  X  VALUE  'W'.
  2927   02  DFHPA1    PIC  X  VALUE  '%'.
  2928   02  DFHPA2    PIC  X  VALUE  '>'.
  2929   02  DFHPA3    PIC  X  VALUE  ','.
  2930   02  DFHPF1    PIC  X  VALUE  '1'.
  2931   02  DFHPF2    PIC  X  VALUE  '2'.
  2932   02  DFHPF3    PIC  X  VALUE  '3'.
  2933   02  DFHPF4    PIC  X  VALUE  '4'.
  2934   02  DFHPF5    PIC  X  VALUE  '5'.
  2935   02  DFHPF6    PIC  X  VALUE  '6'.
  2936   02  DFHPF7    PIC  X  VALUE  '7'.
  2937   02  DFHPF8    PIC  X  VALUE  '8'.
  2938   02  DFHPF9    PIC  X  VALUE  '9'.
  2939   02  DFHPF10   PIC  X  VALUE  ':'.
  2940   02  DFHPF11   PIC  X  VALUE  '#'.
  2941   02  DFHPF12   PIC  X  VALUE  '@'.
  2942   02  DFHPF13   PIC  X  VALUE  'A'.
  2943   02  DFHPF14   PIC  X  VALUE  'B'.
  2944   02  DFHPF15   PIC  X  VALUE  'C'.
  2945   02  DFHPF16   PIC  X  VALUE  'D'.
  2946   02  DFHPF17   PIC  X  VALUE  'E'.
  2947   02  DFHPF18   PIC  X  VALUE  'F'.
  2948   02  DFHPF19   PIC  X  VALUE  'G'.
  2949   02  DFHPF20   PIC  X  VALUE  'H'.
  2950   02  DFHPF21   PIC  X  VALUE  'I'.
  2951*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2952   02  DFHPF22   PIC  X  VALUE  '['.
  2953   02  DFHPF23   PIC  X  VALUE  '.'.
  2954   02  DFHPF24   PIC  X  VALUE  '<'.
  2955   02  DFHMSRE   PIC  X  VALUE  'X'.
  2956   02  DFHSTRF   PIC  X  VALUE  'h'.
  2957   02  DFHTRIG   PIC  X  VALUE  '"'.
  2958
  2959 01  FILLER    REDEFINES DFHAID.
  2960     12  FILLER              PIC X(8).
  2961     12  PF-VALUES           PIC X       OCCURS 12.
  2962
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  59
* EL130.cbl
  2964****************************************************************
  2965*
  2966* Copyright (c) 2007 by Clerity Solutions, Inc.
  2967* All rights reserved.
  2968*
  2969****************************************************************
  2970 01  DFHEIV.
  2971   02  DFHEIV0               PIC X(35).
  2972   02  DFHEIV1               PIC X(08).
  2973   02  DFHEIV2               PIC X(08).
  2974   02  DFHEIV3               PIC X(08).
  2975   02  DFHEIV4               PIC X(06).
  2976   02  DFHEIV5               PIC X(04).
  2977   02  DFHEIV6               PIC X(04).
  2978   02  DFHEIV7               PIC X(02).
  2979   02  DFHEIV8               PIC X(02).
  2980   02  DFHEIV9               PIC X(01).
  2981   02  DFHEIV10              PIC S9(7) COMP-3.
  2982   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2983   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2984   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2985   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2986   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2987   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2988   02  DFHEIV17              PIC X(04).
  2989   02  DFHEIV18              PIC X(04).
  2990   02  DFHEIV19              PIC X(04).
  2991   02  DFHEIV20              USAGE IS POINTER.
  2992   02  DFHEIV21              USAGE IS POINTER.
  2993   02  DFHEIV22              USAGE IS POINTER.
  2994   02  DFHEIV23              USAGE IS POINTER.
  2995   02  DFHEIV24              USAGE IS POINTER.
  2996   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2997   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2998   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2999   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3000   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3001   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3002   02  FILLER                PIC X(02).
  3003   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3004   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3005   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3006   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3007   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3008 LINKAGE  SECTION.
  3009*****************************************************************
  3010*                                                               *
  3011* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3012* All rights reserved.                                          *
  3013*                                                               *
  3014*****************************************************************
  3015 01  dfheiblk.
  3016     02  eibtime          pic s9(7) comp-3.
  3017     02  eibdate          pic s9(7) comp-3.
  3018     02  eibtrnid         pic x(4).
  3019     02  eibtaskn         pic s9(7) comp-3.
  3020     02  eibtrmid         pic x(4).
  3021     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  60
* EL130.cbl
  3022     02  eibcposn         pic s9(4) comp.
  3023     02  eibcalen         pic s9(4) comp.
  3024     02  eibaid           pic x(1).
  3025     02  eibfiller1       pic x(1).
  3026     02  eibfn            pic x(2).
  3027     02  eibfiller2       pic x(2).
  3028     02  eibrcode         pic x(6).
  3029     02  eibfiller3       pic x(2).
  3030     02  eibds            pic x(8).
  3031     02  eibreqid         pic x(8).
  3032     02  eibrsrce         pic x(8).
  3033     02  eibsync          pic x(1).
  3034     02  eibfree          pic x(1).
  3035     02  eibrecv          pic x(1).
  3036     02  eibsend          pic x(1).
  3037     02  eibatt           pic x(1).
  3038     02  eibeoc           pic x(1).
  3039     02  eibfmh           pic x(1).
  3040     02  eibcompl         pic x(1).
  3041     02  eibsig           pic x(1).
  3042     02  eibconf          pic x(1).
  3043     02  eiberr           pic x(1).
  3044     02  eibrldbk         pic x(1).
  3045     02  eiberrcd         pic x(4).
  3046     02  eibsynrb         pic x(1).
  3047     02  eibnodat         pic x(1).
  3048     02  eibfiller5       pic x(2).
  3049     02  eibresp          pic 9(09) comp.
  3050     02  eibresp2         pic 9(09) comp.
  3051     02  dfheigdj         pic s9(4) comp.
  3052     02  dfheigdk         pic s9(4) comp.
  3053
  3054 01  DFHCOMMAREA             PIC X(1024).
  3055
  3056*01 PARMLIST .
  3057*    02  FILLER              PIC S9(8)   COMP.
  3058*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3059*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3060*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3061*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3062*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3063*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3064*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3065*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3066*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  61
* EL130.cbl
  3068*    COPY ELCMSTR.
  3069******************************************************************
  3070*                                                                *
  3071*                            ELCMSTR.                            *
  3072*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3073*                            VMOD=2.012                          *
  3074*                                                                *
  3075*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3076*                                                                *
  3077*   FILE TYPE = VSAM,KSDS                                        *
  3078*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3079*                                                                *
  3080*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3081*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3082*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3083*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3084*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3085*                                                 RKP=75,LEN=21  *
  3086*                                                                *
  3087*   **** NOTE ****                                               *
  3088*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3089*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3090*                                                                *
  3091*   LOG = YES                                                    *
  3092*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3093******************************************************************
  3094*                   C H A N G E   L O G
  3095*
  3096* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3097*-----------------------------------------------------------------
  3098*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3099* EFFECTIVE    NUMBER
  3100*-----------------------------------------------------------------
  3101* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3102* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3103******************************************************************
  3104 01  CLAIM-MASTER.
  3105     12  CL-RECORD-ID                PIC XX.
  3106         88  VALID-CL-ID         VALUE 'CL'.
  3107
  3108     12  CL-CONTROL-PRIMARY.
  3109         16  CL-COMPANY-CD           PIC X.
  3110         16  CL-CARRIER              PIC X.
  3111         16  CL-CLAIM-NO             PIC X(7).
  3112         16  CL-CERT-NO.
  3113             20  CL-CERT-PRIME       PIC X(10).
  3114             20  CL-CERT-SFX         PIC X.
  3115
  3116     12  CL-CONTROL-BY-NAME.
  3117         16  CL-COMPANY-CD-A1        PIC X.
  3118         16  CL-INSURED-LAST-NAME    PIC X(15).
  3119         16  CL-INSURED-NAME.
  3120             20  CL-INSURED-1ST-NAME PIC X(12).
  3121             20  CL-INSURED-MID-INIT PIC X.
  3122
  3123     12  CL-CONTROL-BY-SSN.
  3124         16  CL-COMPANY-CD-A2        PIC X.
  3125         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  62
* EL130.cbl
  3126             20  CL-SSN-STATE        PIC XX.
  3127             20  CL-SSN-ACCOUNT      PIC X(6).
  3128             20  CL-SSN-LN3          PIC X(3).
  3129
  3130     12  CL-CONTROL-BY-CERT-NO.
  3131         16  CL-COMPANY-CD-A4        PIC X.
  3132         16  CL-CERT-NO-A4.
  3133             20  CL-CERT-A4-PRIME    PIC X(10).
  3134             20  CL-CERT-A4-SFX      PIC X.
  3135
  3136     12  CL-CONTROL-BY-CCN.
  3137         16  CL-COMPANY-CD-A5        PIC X.
  3138         16  CL-CCN-A5.
  3139             20  CL-CCN.
  3140                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3141                 24  CL-CCN-PRIME-A5 PIC X(12).
  3142             20  CL-CCN-FILLER-A5    PIC X(4).
  3143
  3144     12  CL-INSURED-PROFILE-DATA.
  3145         16  CL-INSURED-BIRTH-DT     PIC XX.
  3146         16  CL-INSURED-SEX-CD       PIC X.
  3147             88  INSURED-IS-MALE        VALUE 'M'.
  3148             88  INSURED-IS-FEMALE      VALUE 'F'.
  3149             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3150         16  CL-INSURED-OCC-CD       PIC X(6).
  3151         16  FILLER                  PIC X(5).
  3152
  3153     12  CL-PROCESSING-INFO.
  3154         16  CL-PROCESSOR-ID         PIC X(4).
  3155         16  CL-CLAIM-STATUS         PIC X.
  3156             88  CLAIM-IS-OPEN          VALUE 'O'.
  3157             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3158         16  CL-CLAIM-TYPE           PIC X.
  3159*            88  AH-CLAIM               VALUE 'A'.
  3160*            88  LIFE-CLAIM             VALUE 'L'.
  3161*            88  PROPERTY-CLAIM         VALUE 'P'.
  3162*            88  IUI-CLAIM              VALUE 'I'.
  3163*            88  GAP-CLAIM              VALUE 'G'.
  3164         16  CL-CLAIM-PREM-TYPE      PIC X.
  3165             88  SINGLE-PREMIUM         VALUE '1'.
  3166             88  O-B-COVERAGE           VALUE '2'.
  3167             88  OPEN-END-COVERAGE      VALUE '3'.
  3168         16  CL-INCURRED-DT          PIC XX.
  3169         16  CL-REPORTED-DT          PIC XX.
  3170         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3171         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3172         16  CL-LAST-PMT-DT          PIC XX.
  3173         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3174         16  CL-PAID-THRU-DT         PIC XX.
  3175         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3176         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3177         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3178         16  CL-PMT-CALC-METHOD      PIC X.
  3179             88  CL-360-DAY-YR          VALUE '1'.
  3180             88  CL-365-DAY-YR          VALUE '2'.
  3181             88  CL-FULL-MONTHS         VALUE '3'.
  3182         16  CL-CAUSE-CD             PIC X(6).
  3183
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  63
* EL130.cbl
  3184         16  CL-PRIME-CERT-NO.
  3185             20  CL-PRIME-CERT-PRIME PIC X(10).
  3186             20  CL-PRIME-CERT-SFX   PIC X.
  3187
  3188         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3189             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3190             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3191
  3192         16  CL-MICROFILM-NO         PIC X(10).
  3193         16  CL-PROG-FORM-TYPE       PIC X.
  3194         16  CL-LAST-ADD-ON-DT       PIC XX.
  3195
  3196         16  CL-LAST-REOPEN-DT       PIC XX.
  3197         16  CL-LAST-CLOSE-DT        PIC XX.
  3198         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3199             88  FINAL-PAID             VALUE '1'.
  3200             88  CLAIM-DENIED           VALUE '2'.
  3201             88  AUTO-CLOSE             VALUE '3'.
  3202             88  MANUAL-CLOSE           VALUE '4'.
  3203             88  BENEFITS-CHANGED       VALUE 'C'.
  3204             88  SETUP-ERRORS           VALUE 'E'.
  3205         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3206         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3207         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3208             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3209         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3210         16  FILLER                  PIC X.
  3211
  3212     12  CL-CERTIFICATE-DATA.
  3213         16  CL-CERT-ORIGIN          PIC X.
  3214             88  CERT-WAS-ONLINE        VALUE '1'.
  3215             88  CERT-WAS-CREATED       VALUE '2'.
  3216             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3217         16  CL-CERT-KEY-DATA.
  3218             20  CL-CERT-CARRIER     PIC X.
  3219             20  CL-CERT-GROUPING    PIC X(6).
  3220             20  CL-CERT-STATE       PIC XX.
  3221             20  CL-CERT-ACCOUNT.
  3222                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3223                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3224             20  CL-CERT-EFF-DT      PIC XX.
  3225
  3226     12  CL-STATUS-CONTROLS.
  3227         16  CL-PRIORITY-CD          PIC X.
  3228             88  CONFIDENTIAL-DATA      VALUE '8'.
  3229             88  HIGHEST-PRIORITY       VALUE '9'.
  3230         16  CL-SUPV-ATTN-CD         PIC X.
  3231             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3232             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3233         16  CL-PURGED-DT            PIC XX.
  3234         16  CL-RESTORED-DT          PIC XX.
  3235         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3236         16  CL-NEXT-RESEND-DT       PIC XX.
  3237         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3238         16  FILLER                  PIC XX.
  3239         16  CL-LAST-MAINT-DT        PIC XX.
  3240         16  CL-LAST-MAINT-USER      PIC X(4).
  3241         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  64
* EL130.cbl
  3242         16  CL-LAST-MAINT-TYPE      PIC X.
  3243             88  CLAIM-SET-UP           VALUE ' '.
  3244             88  PAYMENT-MADE           VALUE '1'.
  3245             88  LETTER-SENT            VALUE '2'.
  3246             88  MASTER-WAS-ALTERED     VALUE '3'.
  3247             88  MASTER-WAS-RESTORED    VALUE '4'.
  3248             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3249             88  FILE-CONVERTED         VALUE '6'.
  3250             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3251             88  ERROR-CORRECTION       VALUE 'E'.
  3252         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3253         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3254         16  CL-BENEFICIARY          PIC X(10).
  3255         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3256         16  CL-DENIAL-TYPE          PIC X.
  3257             88  CL-TYPE-DENIAL          VALUE '1'.
  3258             88  CL-TYPE-RESCISSION      VALUE '2'.
  3259             88  CL-TYPE-REFORMATION     VALUE '3'.
  3260             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3261             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3262         16  FILLER                  PIC X(5).
  3263
  3264     12  CL-TRAILER-CONTROLS.
  3265         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3266             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3267             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3268             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3269         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3270         16  FILLER                  PIC XX.
  3271         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3272         16  CL-ADDRESS-TRAILER-CNT.
  3273             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3274                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3275             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3276                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3277             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3278                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3279             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3280                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3281             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3282                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3283             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3284                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3285             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3286                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3287
  3288     12  CL-CV-REFERENCE-NO.
  3289         16  CL-CV-REFNO-PRIME       PIC X(18).
  3290         16  CL-CV-REFNO-SFX         PIC XX.
  3291
  3292     12  CL-FILE-LOCATION            PIC X(4).
  3293
  3294     12  CL-PROCESS-ERRORS.
  3295         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3296             88  NO-FATAL-ERRORS        VALUE ZERO.
  3297         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3298             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3299
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  65
* EL130.cbl
  3300     12  CL-PRODUCT-CD               PIC X.
  3301
  3302     12  CL-CURRENT-KEY-DATA.
  3303         16  CL-CURRENT-CARRIER      PIC X.
  3304         16  CL-CURRENT-GROUPING     PIC X(6).
  3305         16  CL-CURRENT-STATE        PIC XX.
  3306         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3307
  3308     12  CL-ASSOCIATES               PIC X.
  3309         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3310         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3311         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3312         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3313
  3314     12  CL-ACTIVITY-CODE            PIC 99.
  3315     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3316     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3317
  3318     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3319     12  CL-LAG-REPORT-CODE          PIC 9.
  3320     12  CL-LOAN-TYPE                PIC XX.
  3321     12  CL-LEGAL-STATE              PIC XX.
  3322
  3323*    12  FILLER                      PIC X(5).
  3324     12  CL-YESNOSW                  PIC X.
  3325     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  66
* EL130.cbl
  3327*    COPY ELCCNTL.
  3328******************************************************************
  3329*                                                                *
  3330*                                                                *
  3331*                            ELCCNTL.                            *
  3332*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3333*                            VMOD=2.059                          *
  3334*                                                                *
  3335*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3336*                                                                *
  3337*   FILE TYPE = VSAM,KSDS                                        *
  3338*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3339*                                                                *
  3340*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3341*       ALTERNATE INDEX = NONE                                   *
  3342*                                                                *
  3343*   LOG = YES                                                    *
  3344*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3345******************************************************************
  3346*                   C H A N G E   L O G
  3347*
  3348* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3349*-----------------------------------------------------------------
  3350*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3351* EFFECTIVE    NUMBER
  3352*-----------------------------------------------------------------
  3353* 082503                   PEMA  ADD BENEFIT GROUP
  3354* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3355* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3356* 092705    2005050300006  PEMA  ADD SPP LEASES
  3357* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3358* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3359* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3360* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3361* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3362* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3363* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3364******************************************************************
  3365*
  3366 01  CONTROL-FILE.
  3367     12  CF-RECORD-ID                       PIC XX.
  3368         88  VALID-CF-ID                        VALUE 'CF'.
  3369
  3370     12  CF-CONTROL-PRIMARY.
  3371         16  CF-COMPANY-ID                  PIC XXX.
  3372         16  CF-RECORD-TYPE                 PIC X.
  3373             88  CF-COMPANY-MASTER              VALUE '1'.
  3374             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3375             88  CF-STATE-MASTER                VALUE '3'.
  3376             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3377             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3378             88  CF-CARRIER-MASTER              VALUE '6'.
  3379             88  CF-MORTALITY-MASTER            VALUE '7'.
  3380             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3381             88  CF-TERMINAL-MASTER             VALUE '9'.
  3382             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3383             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3384             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  67
* EL130.cbl
  3385             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3386             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3387             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3388             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3389             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3390             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3391         16  CF-ACCESS-CD-GENL              PIC X(4).
  3392         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3393             20  CF-PROCESSOR               PIC X(4).
  3394         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3395             20  CF-STATE-CODE              PIC XX.
  3396             20  FILLER                     PIC XX.
  3397         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3398             20  FILLER                     PIC XX.
  3399             20  CF-HI-BEN-IN-REC           PIC XX.
  3400         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3401             20  FILLER                     PIC XXX.
  3402             20  CF-CARRIER-CNTL            PIC X.
  3403         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3404             20  FILLER                     PIC XX.
  3405             20  CF-HI-TYPE-IN-REC          PIC 99.
  3406         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3407             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3408                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3409             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3410             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3411         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3412             20  FILLER                     PIC X.
  3413             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3414         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3415             20  FILLER                     PIC XX.
  3416             20  CF-MORTGAGE-PLAN           PIC XX.
  3417         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3418
  3419     12  CF-LAST-MAINT-DT                   PIC XX.
  3420     12  CF-LAST-MAINT-BY                   PIC X(4).
  3421     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3422
  3423     12  CF-RECORD-BODY                     PIC X(728).
  3424
  3425
  3426****************************************************************
  3427*             COMPANY MASTER RECORD                            *
  3428****************************************************************
  3429
  3430     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3431         16  CF-COMPANY-ADDRESS.
  3432             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3433             20  CF-CL-IN-CARE-OF           PIC X(30).
  3434             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3435             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3436             20  CF-CL-CITY-STATE           PIC X(30).
  3437             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3438             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3439         16  CF-COMPANY-CD                  PIC X.
  3440         16  CF-COMPANY-PASSWORD            PIC X(8).
  3441         16  CF-SECURITY-OPTION             PIC X.
  3442             88  ALL-SECURITY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  68
* EL130.cbl
  3443             88  COMPANY-VERIFY                 VALUE '2'.
  3444             88  PROCESSOR-VERIFY               VALUE '3'.
  3445             88  NO-SECURITY                    VALUE '4'.
  3446             88  ALL-BUT-TERM                   VALUE '5'.
  3447         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3448             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3449         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3450             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3451         16  CF-INFORCE-LOCATION            PIC X.
  3452             88  CERTS-ARE-ONLINE               VALUE '1'.
  3453             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3454             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3455         16  CF-LOWER-CASE-LETTERS          PIC X.
  3456         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3457             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3458             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3459             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3460             88  CF-ACCNT-CNTL                  VALUE '3'.
  3461             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3462
  3463         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3464         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3465
  3466         16  CF-LGX-CREDIT-USER             PIC X.
  3467             88  CO-IS-NOT-USER                 VALUE 'N'.
  3468             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3469
  3470         16 CF-CREDIT-CALC-CODES.
  3471             20  CF-CR-REM-TERM-CALC PIC X.
  3472               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3473               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3474               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3475               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3476               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3477               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3478               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3479             20  CF-CR-R78-METHOD           PIC X.
  3480               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3481               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3482
  3483         16  CF-CLAIM-CONTROL-COUNTS.
  3484             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3485                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3486
  3487             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3488                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3489
  3490             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3491                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3492
  3493             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3494                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3495
  3496         16  CF-CURRENT-MONTH-END           PIC XX.
  3497
  3498         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3499             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3500             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  69
* EL130.cbl
  3501             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3502             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3503                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3504                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3505             20  CF-CO-PREM-REJECT-SW       PIC X.
  3506                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3507                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3508             20  CF-CO-REF-REJECT-SW        PIC X.
  3509                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3510                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3511
  3512         16  CF-CO-REPORTING-DT             PIC XX.
  3513         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3514         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3515           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3516           88  CF-CO-MONTH-END                  VALUE '1'.
  3517
  3518         16  CF-LGX-CLAIM-USER              PIC X.
  3519             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3520             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3521
  3522         16  CF-CREDIT-EDIT-CONTROLS.
  3523             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3524             20  CF-MIN-AGE                 PIC 99.
  3525             20  CF-DEFAULT-AGE             PIC 99.
  3526             20  CF-MIN-TERM                PIC S999      COMP-3.
  3527             20  CF-MAX-TERM                PIC S999      COMP-3.
  3528             20  CF-DEFAULT-SEX             PIC X.
  3529             20  CF-JOINT-AGE-INPUT         PIC X.
  3530                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3531             20  CF-BIRTH-DATE-INPUT        PIC X.
  3532                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3533             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3534                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3535                 88  CF-ZERO-CARRIER            VALUE '1'.
  3536                 88  CF-ZERO-GROUPING           VALUE '2'.
  3537                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3538             20  CF-EDIT-SW                 PIC X.
  3539                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3540             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3541             20  CF-CR-PR-METHOD            PIC X.
  3542               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3543               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3544             20  FILLER                     PIC X.
  3545
  3546         16  CF-CREDIT-MISC-CONTROLS.
  3547             20  CF-REIN-TABLE-SW           PIC X.
  3548                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3549             20  CF-COMP-TABLE-SW           PIC X.
  3550                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3551             20  CF-EXPERIENCE-RETENTION-AGE
  3552                                            PIC S9        COMP-3.
  3553             20  CF-CONVERSION-DT           PIC XX.
  3554             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3555             20  CF-RUN-FREQUENCY-SW        PIC X.
  3556                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3557                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3558
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  70
* EL130.cbl
  3559             20  CF-CR-CHECK-NO-CONTROL.
  3560                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3561                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3562                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3563                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3564                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3565                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3566
  3567                 24  CF-CR-CHECK-COUNT       REDEFINES
  3568                     CF-CR-CHECK-COUNTER      PIC X(4).
  3569
  3570                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3571                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3572
  3573                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3574                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3575                 24  CF-MAIL-PROCESSING       PIC X.
  3576                     88  MAIL-PROCESSING          VALUE 'Y'.
  3577
  3578         16  CF-MISC-SYSTEM-CONTROL.
  3579             20  CF-SYSTEM-C                 PIC X.
  3580                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3581             20  CF-SYSTEM-D                 PIC X.
  3582                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3583             20  CF-SOC-SEC-NO-SW            PIC X.
  3584                 88  SOC-SEC-NO-USED             VALUE '1'.
  3585             20  CF-MEMBER-NO-SW             PIC X.
  3586                 88  MEMBER-NO-USED              VALUE '1'.
  3587             20  CF-TAX-ID-NUMBER            PIC X(11).
  3588             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3589             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3590                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3591                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3592                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3593                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3594             20  CF-SYSTEM-E                 PIC X.
  3595                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3596
  3597         16  CF-LGX-LIFE-USER               PIC X.
  3598             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3599             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3600
  3601         16  CF-CR-MONTH-END-DT             PIC XX.
  3602
  3603         16  CF-FILE-MAINT-DATES.
  3604             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3605                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3606             20  CF-LAST-BATCH       REDEFINES
  3607                 CF-LAST-BATCH-NO               PIC X(4).
  3608             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3609             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3610             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3611             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3612             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3613             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3614             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3615             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3616             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  71
* EL130.cbl
  3617             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3618
  3619         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3620         16  FILLER                         PIC X.
  3621
  3622         16  CF-ALT-MORT-CODE               PIC X(4).
  3623         16  CF-MEMBER-CAPTION              PIC X(10).
  3624
  3625         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3626             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3627             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3628             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3629             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3630             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3631
  3632         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3633
  3634         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3635         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3636         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3637         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3638
  3639         16  CF-AH-OVERRIDE-L1              PIC X.
  3640         16  CF-AH-OVERRIDE-L2              PIC XX.
  3641         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3642         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3643
  3644         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3645         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3646
  3647         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3648         16  CF-AR-LAST-EL860-DT            PIC XX.
  3649         16  CF-MP-MONTH-END-DT             PIC XX.
  3650
  3651         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3652         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3653             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3654
  3655         16  CF-AR-MONTH-END-DT             PIC XX.
  3656
  3657         16  CF-CRDTCRD-USER                PIC X.
  3658             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3659             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3660
  3661         16  CF-CC-MONTH-END-DT             PIC XX.
  3662
  3663         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3664
  3665         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3666             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3667             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3668             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3669         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3670         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3671         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3672         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3673             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3674             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  72
* EL130.cbl
  3675         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3676         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3677         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3678             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3679         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3680
  3681         16  CF-CL-ZIP-CODE.
  3682             20  CF-CL-ZIP-PRIME.
  3683                 24  CF-CL-ZIP-1ST          PIC X.
  3684                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3685                 24  FILLER                 PIC X(4).
  3686             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3687         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3688             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3689             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3690             20  FILLER                     PIC XXX.
  3691
  3692         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3693         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3694         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3695         16  CF-CO-OPTION-START-DATE        PIC XX.
  3696         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3697           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3698                                                      '3' '4'.
  3699           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3700           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3701           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3702           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3703           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3704           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3705
  3706         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3707
  3708         16  CF-PAYMENT-APPROVAL-LEVELS.
  3709             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3710             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3711             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3712             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3713             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3714             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3715
  3716         16  CF-END-USER-REPORTING-USER     PIC X.
  3717             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3718             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3719
  3720         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3721             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3722             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3723
  3724         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3725
  3726         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3727         16  FILLER                         PIC X.
  3728
  3729         16  CF-CREDIT-ARCHIVE-CNTL.
  3730             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3731             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3732             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  73
* EL130.cbl
  3733
  3734         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3735
  3736         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3737             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3738             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3739
  3740         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3741             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3742             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3743
  3744         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3745
  3746         16  CF-CO-ACH-ID-CODE              PIC  X.
  3747             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3748             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3749             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3750         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3751         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3752         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3753         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3754         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3755         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3756         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3757         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3758         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3759                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3760         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3761                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3762
  3763         16  CF-CO-OVER-SHORT.
  3764             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3765             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3766
  3767*         16  FILLER                         PIC X(102).
  3768         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3769             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3770             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3771
  3772         16  CF-AH-APPROVAL-DAYS.
  3773             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3774             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3775             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3776             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3777
  3778         16  FILLER                         PIC X(82).
  3779****************************************************************
  3780*             PROCESSOR/USER RECORD                            *
  3781****************************************************************
  3782
  3783     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3784         16  CF-PROCESSOR-NAME              PIC X(30).
  3785         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3786         16  CF-PROCESSOR-TITLE             PIC X(26).
  3787         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3788                 88  MESSAGE-YES                VALUE 'Y'.
  3789                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3790
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  74
* EL130.cbl
  3791*****************************************************
  3792****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3793****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3794****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3795****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3796*****************************************************
  3797
  3798         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3799             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3800             20  CF-APPLICATION-FORCE       PIC X.
  3801             20  CF-INDIVIDUAL-APP.
  3802                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3803                     28  CF-BROWSE-APP      PIC X.
  3804                     28  CF-UPDATE-APP      PIC X.
  3805
  3806         16  CF-CURRENT-TERM-ON             PIC X(4).
  3807         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3808             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3809             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3810             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3811             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3812             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3813             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3814             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3815         16  CF-PROCESSOR-CARRIER           PIC X.
  3816             88  NO-CARRIER-SECURITY            VALUE ' '.
  3817         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3818             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3819         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3820             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3821         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3822             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3823
  3824         16  CF-PROC-SYS-ACCESS-SW.
  3825             20  CF-PROC-CREDIT-CLAIMS-SW.
  3826                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3827                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3828                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3829                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3830             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3831                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3832                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3833             20  CF-PROC-LIFE-GNRLDGR-SW.
  3834                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3835                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3836                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3837                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3838             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3839                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3840                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3841         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3842             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3843             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3844         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3845
  3846         16  CF-APPROVAL-LEVEL                  PIC X.
  3847             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3848             88  APPROVAL-LEVEL-2                   VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  75
* EL130.cbl
  3849             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3850             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3851
  3852         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3853
  3854         16  CF-LANGUAGE-TYPE                   PIC X.
  3855             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3856             88  CF-LANG-IS-FR                      VALUE 'F'.
  3857
  3858         16  CF-CSR-IND                         PIC X.
  3859         16  FILLER                             PIC X(239).
  3860
  3861****************************************************************
  3862*             PROCESSOR/REMINDERS RECORD                       *
  3863****************************************************************
  3864
  3865     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3866         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3867             20  CF-START-REMIND-DT         PIC XX.
  3868             20  CF-END-REMIND-DT           PIC XX.
  3869             20  CF-REMINDER-TEXT           PIC X(50).
  3870         16  FILLER                         PIC X(296).
  3871
  3872
  3873****************************************************************
  3874*             STATE MASTER RECORD                              *
  3875****************************************************************
  3876
  3877     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3878         16  CF-STATE-ABBREVIATION          PIC XX.
  3879         16  CF-STATE-NAME                  PIC X(25).
  3880         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3881         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3882             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3883             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3884             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3885             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3886                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3887                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3888             20  CF-ST-PREM-REJECT-SW       PIC X.
  3889                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3890                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3891             20  CF-ST-REF-REJECT-SW        PIC X.
  3892                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3893                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3894         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3895         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3896         16  CF-ST-REFUND-RULES.
  3897             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3898             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3899             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3900         16  CF-ST-FST-PMT-EXTENSION.
  3901             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3902             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3903                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3904                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3905                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3906                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  76
* EL130.cbl
  3907         16  CF-ST-STATE-CALL.
  3908             20  CF-ST-CALL-UNEARNED        PIC X.
  3909             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3910             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3911         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3912             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3913             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3914         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3915         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3916         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3917         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3918         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3919         16  FILLER                         PIC X.
  3920         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3921             20  CF-ST-BENEFIT-CD           PIC XX.
  3922             20  CF-ST-BENEFIT-KIND         PIC X.
  3923                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3924                 88  CF-ST-AH-KIND              VALUE 'A'.
  3925             20  CF-ST-REM-TERM-CALC        PIC X.
  3926                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3927                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3928                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3929                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3930                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3931                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3932                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3933                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3934
  3935             20  CF-ST-REFUND-CALC          PIC X.
  3936                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3937                 88  ST-REFD-BY-R78             VALUE '1'.
  3938                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3939                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3940                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3941                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3942                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3943                 88  ST-REFD-UTAH               VALUE '7'.
  3944                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3945                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3946                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3947
  3948             20  CF-ST-EARNING-CALC         PIC X.
  3949                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3950                 88  ST-EARN-BY-R78             VALUE '1'.
  3951                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3952                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3953                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3954                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3955                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3956                 88  ST-EARN-MEAN               VALUE '8'.
  3957                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3958
  3959             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3960                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3961                 88  ST-OVRD-BY-R78             VALUE '1'.
  3962                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3963                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3964                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  77
* EL130.cbl
  3965                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3966                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3967                 88  ST-OVRD-MEAN               VALUE '8'.
  3968                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3969             20  FILLER                     PIC X.
  3970
  3971         16  CF-ST-COMMISSION-CAPS.
  3972             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3973             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3974             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3975             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3976         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3977                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3978
  3979         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3980
  3981         16  CF-ST-STATUTORY-INTEREST.
  3982             20  CF-ST-STAT-DATE-FROM       PIC X.
  3983                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3984                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3985             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3986             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3987             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3988             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3989             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3990
  3991         16  CF-ST-OVER-SHORT.
  3992             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3993             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3994
  3995         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3996
  3997         16  CF-ST-RT-CALC                  PIC X.
  3998
  3999         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4000         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4001         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4002         16  CF-ST-RF-LR-CALC               PIC X.
  4003         16  CF-ST-RF-LL-CALC               PIC X.
  4004         16  CF-ST-RF-LN-CALC               PIC X.
  4005         16  CF-ST-RF-AH-CALC               PIC X.
  4006         16  CF-ST-RF-CP-CALC               PIC X.
  4007*        16  FILLER                         PIC X(206).
  4008*CIDMOD         16  FILLER                         PIC X(192).
  4009         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4010             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4011         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4012         16  CF-ST-VFY-2ND-BENE             PIC X.
  4013         16  CF-ST-CAUSAL-STATE             PIC X.
  4014         16  FILLER                         PIC X(185).
  4015
  4016****************************************************************
  4017*             BENEFIT MASTER RECORD                            *
  4018****************************************************************
  4019
  4020     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4021         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4022             20  CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  78
* EL130.cbl
  4023             20  CF-BENEFIT-NUMERIC  REDEFINES
  4024                 CF-BENEFIT-CODE            PIC XX.
  4025             20  CF-BENEFIT-ALPHA           PIC XXX.
  4026             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4027             20  CF-BENEFIT-COMMENT         PIC X(10).
  4028
  4029             20  CF-LF-COVERAGE-TYPE        PIC X.
  4030                 88  CF-REDUCING                VALUE 'R'.
  4031                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4032
  4033             20  CF-SPECIAL-CALC-CD         PIC X.
  4034                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4035                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4036                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4037                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4038                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4039                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4040                 88  CF-FARM-PLAN               VALUE 'F'.
  4041                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4042                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4043                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4044                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4045                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4046                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4047                 88  CF-PRUDENTIAL              VALUE 'P'.
  4048                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4049                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4050                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4051                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4052                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4053                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4054
  4055             20  CF-JOINT-INDICATOR         PIC X.
  4056                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4057
  4058*            20  FILLER                     PIC X(12).
  4059             20  FILLER                     PIC X(11).
  4060             20  CF-BENEFIT-CATEGORY        PIC X.
  4061             20  CF-LOAN-TYPE               PIC X(8).
  4062
  4063             20  CF-CO-REM-TERM-CALC        PIC X.
  4064                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4065                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4066                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4067                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4068                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4069
  4070             20  CF-CO-EARNINGS-CALC        PIC X.
  4071                 88  CO-EARN-BY-R78             VALUE '1'.
  4072                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4073                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4074                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4075                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4076                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4077                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4078                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4079
  4080             20  CF-CO-REFUND-CALC          PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  79
* EL130.cbl
  4081                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4082                 88  CO-REFD-BY-R78             VALUE '1'.
  4083                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4084                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4085                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4086                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4087                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4088                 88  CO-REFD-MEAN               VALUE '8'.
  4089                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4090                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4091                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4092
  4093             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4094                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4095                 88  CO-OVRD-BY-R78             VALUE '1'.
  4096                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4097                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4098                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4099                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4100                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4101                 88  CO-OVRD-MEAN               VALUE '8'.
  4102                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4103
  4104             20  CF-CO-BEN-I-G-CD           PIC X.
  4105                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4106                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4107                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4108
  4109         16  FILLER                         PIC X(304).
  4110
  4111
  4112****************************************************************
  4113*             CARRIER MASTER RECORD                            *
  4114****************************************************************
  4115
  4116     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4117         16  CF-ADDRESS-DATA.
  4118             20  CF-MAIL-TO-NAME            PIC X(30).
  4119             20  CF-IN-CARE-OF              PIC X(30).
  4120             20  CF-ADDRESS-LINE-1          PIC X(30).
  4121             20  CF-ADDRESS-LINE-2          PIC X(30).
  4122             20  CF-CITY-STATE              PIC X(30).
  4123             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4124             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4125
  4126         16  CF-CLAIM-NO-CONTROL.
  4127             20  CF-CLAIM-NO-METHOD         PIC X.
  4128                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4129                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4130                 88  CLAIM-NO-SEQ               VALUE '3'.
  4131                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4132             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4133                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4134                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4135                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4136
  4137         16  CF-CHECK-NO-CONTROL.
  4138             20  CF-CHECK-NO-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  80
* EL130.cbl
  4139                 88  CHECK-NO-MANUAL            VALUE '1'.
  4140                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4141                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4142                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4143             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4144                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4145
  4146         16  CF-DOMICILE-STATE              PIC XX.
  4147
  4148         16  CF-EXPENSE-CONTROLS.
  4149             20  CF-EXPENSE-METHOD          PIC X.
  4150                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4151                 88  DOLLARS-PER-PMT            VALUE '2'.
  4152                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4153                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4154             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4155             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4156
  4157         16  CF-CORRESPONDENCE-CONTROL.
  4158             20  CF-LETTER-RESEND-OPT       PIC X.
  4159                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4160                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4161             20  FILLER                     PIC X(4).
  4162
  4163         16  CF-RESERVE-CONTROLS.
  4164             20  CF-MANUAL-SW               PIC X.
  4165                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4166             20  CF-FUTURE-SW               PIC X.
  4167                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4168             20  CF-PTC-SW                  PIC X.
  4169                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4170             20  CF-IBNR-SW                 PIC X.
  4171                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4172             20  CF-PTC-LF-SW               PIC X.
  4173                 88  CF-LF-PTC-USED             VALUE '1'.
  4174             20  CF-CDT-ACCESS-METHOD       PIC X.
  4175                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4176                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4177                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4178             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4179
  4180         16  CF-CLAIM-CALC-METHOD           PIC X.
  4181             88  360-PLUS-MONTHS                VALUE '1'.
  4182             88  365-PLUS-MONTHS                VALUE '2'.
  4183             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4184             88  360-DAILY                      VALUE '4'.
  4185             88  365-DAILY                      VALUE '5'.
  4186
  4187         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4188         16  FILLER                         PIC X(11).
  4189
  4190         16  CF-LIMIT-AMOUNTS.
  4191             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4192             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4193             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4194             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4195             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4196             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  81
* EL130.cbl
  4197             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4198             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4199             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4200             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4201
  4202         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4203         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4204         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4205
  4206         16  CF-ZIP-CODE.
  4207             20  CF-ZIP-PRIME.
  4208                 24  CF-ZIP-1ST             PIC X.
  4209                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4210                 24  FILLER                 PIC X(4).
  4211             20  CF-ZIP-PLUS4               PIC X(4).
  4212         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4213             20  CF-CAN-POSTAL-1            PIC XXX.
  4214             20  CF-CAN-POSTAL-2            PIC XXX.
  4215             20  FILLER                     PIC XXX.
  4216
  4217         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4218         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4219         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4220
  4221         16  CF-RATING-SWITCH               PIC X.
  4222             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4223             88  CF-NO-RATING                   VALUE 'N'.
  4224
  4225         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4226
  4227         16  CF-CARRIER-OVER-SHORT.
  4228             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4229             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4230
  4231         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4232         16  CF-SECPAY-SWITCH               PIC X.
  4233             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4234             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4235         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4236         16  FILLER                         PIC X(448).
  4237*        16  FILLER                         PIC X(452).
  4238
  4239
  4240****************************************************************
  4241*             MORTALITY MASTER RECORD                          *
  4242****************************************************************
  4243
  4244     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4245         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4246                                INDEXED BY CF-MORT-NDX.
  4247             20  CF-MORT-TABLE              PIC X(5).
  4248             20  CF-MORT-TABLE-TYPE         PIC X.
  4249                 88  CF-MORT-JOINT              VALUE 'J'.
  4250                 88  CF-MORT-SINGLE             VALUE 'S'.
  4251                 88  CF-MORT-COMBINED           VALUE 'C'.
  4252                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4253                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4254             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  82
* EL130.cbl
  4255             20  CF-MORT-AGE-METHOD         PIC XX.
  4256                 88  CF-AGE-LAST                VALUE 'AL'.
  4257                 88  CF-AGE-NEAR                VALUE 'AN'.
  4258             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4259             20  CF-MORT-ADJUSTMENT-DIRECTION
  4260                                            PIC X.
  4261                 88  CF-MINUS                   VALUE '-'.
  4262                 88  CF-PLUS                    VALUE '+'.
  4263             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4264             20  CF-MORT-JOINT-CODE         PIC X.
  4265                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4266             20  CF-MORT-PC-Q               PIC X.
  4267                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4268             20  CF-MORT-TABLE-CODE         PIC X(4).
  4269             20  CF-MORT-COMMENTS           PIC X(15).
  4270             20  FILLER                     PIC X(14).
  4271
  4272         16  FILLER                         PIC X(251).
  4273
  4274
  4275****************************************************************
  4276*             BUSSINESS TYPE MASTER RECORD                     *
  4277****************************************************************
  4278
  4279     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4280* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4281* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4282* AND RECORD 05 IS TYPES 81-99
  4283         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4284             20  CF-BUSINESS-TITLE          PIC  X(19).
  4285             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4286                                            PIC S9V9(4) COMP-3.
  4287             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4288             20  FILLER                     PIC  X.
  4289         16  FILLER                         PIC  X(248).
  4290
  4291
  4292****************************************************************
  4293*             TERMINAL MASTER RECORD                           *
  4294****************************************************************
  4295
  4296     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4297
  4298         16  CF-COMPANY-TERMINALS.
  4299             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4300                                  PIC X(4).
  4301         16  FILLER               PIC X(248).
  4302
  4303
  4304****************************************************************
  4305*             LIFE EDIT MASTER RECORD                          *
  4306****************************************************************
  4307
  4308     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4309         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4310             20  CF-LIFE-CODE-IN            PIC XX.
  4311             20  CF-LIFE-CODE-OUT           PIC XX.
  4312         16  FILLER                         PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  83
* EL130.cbl
  4313
  4314
  4315****************************************************************
  4316*             AH EDIT MASTER RECORD                            *
  4317****************************************************************
  4318
  4319     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4320         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4321             20  CF-AH-CODE-IN              PIC XXX.
  4322             20  CF-AH-CODE-OUT             PIC XX.
  4323         16  FILLER                         PIC X(248).
  4324
  4325
  4326****************************************************************
  4327*             CREDIBILITY TABLES                               *
  4328****************************************************************
  4329
  4330     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4331         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4332                             INDEXED BY CF-CRDB-NDX.
  4333             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4334             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4335             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4336         16  FILLER                         PIC  X(332).
  4337
  4338
  4339****************************************************************
  4340*             REPORT CUSTOMIZATION RECORD                      *
  4341****************************************************************
  4342
  4343     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4344         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4345             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4346             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4347             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4348**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4349****       A T-TRANSFER.                                   ****
  4350             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4351
  4352         16  FILLER                         PIC XX.
  4353
  4354         16  CF-CARRIER-CNTL-OPT.
  4355             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4356                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4357                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4358             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4359                                            PIC X.
  4360         16  CF-GROUP-CNTL-OPT.
  4361             20  CF-GROUP-OPT-SEQ           PIC 9.
  4362                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4363                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4364             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4365                                            PIC X(6).
  4366         16  CF-STATE-CNTL-OPT.
  4367             20  CF-STATE-OPT-SEQ           PIC 9.
  4368                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4369                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4370             20  CF-STATE-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  84
* EL130.cbl
  4371                                            PIC XX.
  4372         16  CF-ACCOUNT-CNTL-OPT.
  4373             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4374                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4375                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4376             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4377                                            PIC X(10).
  4378         16  CF-BUS-TYP-CNTL-OPT.
  4379             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4380                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4381                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4382             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4383                                            PIC XX.
  4384         16  CF-LF-TYP-CNTL-OPT.
  4385             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4386                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4387                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4388             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4389                                            PIC XX.
  4390         16  CF-AH-TYP-CNTL-OPT.
  4391             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4392                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4393                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4394             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4395                                            PIC XX.
  4396         16  CF-REPTCD1-CNTL-OPT.
  4397             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4398                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4399                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4400             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4401                                            PIC X(10).
  4402         16  CF-REPTCD2-CNTL-OPT.
  4403             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4404                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4405                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4406             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4407                                            PIC X(10).
  4408         16  CF-USER1-CNTL-OPT.
  4409             20  CF-USER1-OPT-SEQ           PIC 9.
  4410                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4411                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4412             20  CF-USER1-SELECT OCCURS 3 TIMES
  4413                                            PIC X(10).
  4414         16  CF-USER2-CNTL-OPT.
  4415             20  CF-USER2-OPT-SEQ           PIC 9.
  4416                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4417                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4418             20  CF-USER2-SELECT OCCURS 3 TIMES
  4419                                            PIC X(10).
  4420         16  CF-USER3-CNTL-OPT.
  4421             20  CF-USER3-OPT-SEQ           PIC 9.
  4422                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4423                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4424             20  CF-USER3-SELECT OCCURS 3 TIMES
  4425                                            PIC X(10).
  4426         16  CF-USER4-CNTL-OPT.
  4427             20  CF-USER4-OPT-SEQ           PIC 9.
  4428                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  85
* EL130.cbl
  4429                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4430             20  CF-USER4-SELECT OCCURS 3 TIMES
  4431                                            PIC X(10).
  4432         16  CF-USER5-CNTL-OPT.
  4433             20  CF-USER5-OPT-SEQ           PIC 9.
  4434                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4435                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4436             20  CF-USER5-SELECT OCCURS 3 TIMES
  4437                                            PIC X(10).
  4438         16  CF-REINS-CNTL-OPT.
  4439             20  CF-REINS-OPT-SEQ           PIC 9.
  4440                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4441                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4442             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4443                 24  CF-REINS-PRIME         PIC XXX.
  4444                 24  CF-REINS-SUB           PIC XXX.
  4445
  4446         16  CF-AGENT-CNTL-OPT.
  4447             20  CF-AGENT-OPT-SEQ           PIC 9.
  4448                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4449                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4450             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4451                                            PIC X(10).
  4452
  4453         16  FILLER                         PIC X(43).
  4454
  4455         16  CF-LOSS-RATIO-SELECT.
  4456             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4457             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4458         16  CF-ENTRY-DATE-SELECT.
  4459             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4460             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4461         16  CF-EFFECTIVE-DATE-SELECT.
  4462             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4463             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4464
  4465         16  CF-EXCEPTION-LIST-IND          PIC X.
  4466             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4467
  4468         16  FILLER                         PIC X(318).
  4469
  4470****************************************************************
  4471*                  EXCEPTION REPORTING RECORD                  *
  4472****************************************************************
  4473
  4474     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4475         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4476             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4477
  4478         16  CF-COMBINED-LIFE-AH-OPT.
  4479             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4480             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4481             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4482             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4483
  4484         16  CF-LIFE-OPT.
  4485             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4486             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  86
* EL130.cbl
  4487             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4488             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4489             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4490             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4491             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4492             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4493             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4494             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4495
  4496         16  CF-AH-OPT.
  4497             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4498             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4499             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4500             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4501             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4502             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4503             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4504             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4505             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4506             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4507
  4508         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4509             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4510             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4511             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4512
  4513         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4514
  4515         16  FILLER                         PIC X(673).
  4516
  4517
  4518****************************************************************
  4519*             MORTGAGE SYSTEM PLAN RECORD                      *
  4520****************************************************************
  4521
  4522     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4523         16  CF-PLAN-TYPE                   PIC X.
  4524             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4525             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4526             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4527         16  CF-PLAN-ABBREV                 PIC XXX.
  4528         16  CF-PLAN-DESCRIPT               PIC X(10).
  4529         16  CF-PLAN-NOTES                  PIC X(20).
  4530         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4531         16  CF-PLAN-UNDERWRITING.
  4532             20  CF-PLAN-TERM-DATA.
  4533                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4534                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4535             20  CF-PLAN-AGE-DATA.
  4536                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4537                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4538                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4539             20  CF-PLAN-BENEFIT-DATA.
  4540                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4541                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4542                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4543                                            PIC S9(7)V99  COMP-3.
  4544         16  CF-PLAN-POLICY-FORMS.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  87
* EL130.cbl
  4545             20  CF-POLICY-FORM             PIC X(12).
  4546             20  CF-MASTER-APPLICATION      PIC X(12).
  4547             20  CF-MASTER-POLICY           PIC X(12).
  4548         16  CF-PLAN-RATING.
  4549             20  CF-RATE-CODE               PIC X(5).
  4550             20  CF-SEX-RATING              PIC X.
  4551                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4552                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4553             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4554             20  CF-SUB-STD-TYPE            PIC X.
  4555                 88  CF-PCT-OF-PREM            VALUE '1'.
  4556                 88  CF-PCT-OF-BENE            VALUE '2'.
  4557         16  CF-PLAN-PREM-TOLERANCES.
  4558             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4559             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4560         16  CF-PLAN-PYMT-TOLERANCES.
  4561             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4562             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4563         16  CF-PLAN-MISC-DATA.
  4564             20  FILLER                     PIC X.
  4565             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4566             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4567         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4568         16  CF-PLAN-IND-GRP                PIC X.
  4569             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4570                                                     '1'.
  4571             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4572                                                     '2'.
  4573         16  CF-MIB-SEARCH-SW               PIC X.
  4574             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4575             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4576             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4577             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4578         16  CF-ALPHA-SEARCH-SW             PIC X.
  4579             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4580             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4581             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4582             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4583             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4584             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4585             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4586             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4587             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4588             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4589                                                     'A' 'B' 'C'
  4590                                                     'X' 'Y' 'Z'.
  4591         16  CF-EFF-DT-RULE-SW              PIC X.
  4592             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4593             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4594             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4595             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4596             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4597         16  FILLER                         PIC X(4).
  4598         16  CF-HEALTH-QUESTIONS            PIC X.
  4599             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4600         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4601         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4602         16  CF-PLAN-SNGL-JNT               PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  88
* EL130.cbl
  4603             88  CF-COMBINED-PLAN              VALUE 'C'.
  4604             88  CF-JNT-PLAN                   VALUE 'J'.
  4605             88  CF-SNGL-PLAN                  VALUE 'S'.
  4606         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4607         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4608         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4609         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4610         16  CF-RERATE-CNTL                 PIC  X.
  4611             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4612             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4613             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4614             88  CF-AUTO-RECALC                 VALUE '4'.
  4615         16  CF-BENEFIT-TYPE                PIC  X.
  4616             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4617             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4618         16  CF-POLICY-FEE                  PIC S999V99
  4619                                                    COMP-3.
  4620         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4621         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4622         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4623         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4624         16  FILLER                         PIC  X(32).
  4625         16  CF-TERMINATION-FORM            PIC  X(04).
  4626         16  FILLER                         PIC  X(08).
  4627         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4628                                                       COMP-3.
  4629         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4630         16  CF-ISSUE-LETTER                PIC  X(4).
  4631         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4632         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4633             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4634             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4635         16  CF-MP-REFUND-CALC              PIC X.
  4636             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4637             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4638             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4639             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4640             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4641             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4642             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4643             88  CF-MP-REFD-MEAN                VALUE '8'.
  4644         16  CF-ALT-RATE-CODE               PIC  X(5).
  4645
  4646
  4647         16  FILLER                         PIC X(498).
  4648****************************************************************
  4649*             MORTGAGE COMPANY MASTER RECORD                   *
  4650****************************************************************
  4651
  4652     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4653         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4654         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4655             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4656             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4657             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4658             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4659             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4660
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  89
* EL130.cbl
  4661         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4662         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4663         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4664         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4665         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4666
  4667         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4668             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4669         16  CF-MP-RECON-USE-IND            PIC X(1).
  4670             88  CF-MP-USE-RECON             VALUE 'Y'.
  4671         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4672             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4673         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4674             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4675             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4676         16  FILLER                         PIC X(1).
  4677         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4678             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4679         16  CF-MORTG-MIB-VERSION           PIC X.
  4680             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4681             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4682             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4683         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4684             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4685                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4686             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4687                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4688             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4689                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4690             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4691                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4692             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4693                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4694             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4695                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4696         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4697         16  FILLER                         PIC X(7).
  4698         16  CF-MORTG-DESTINATION-SYMBOL.
  4699             20  CF-MORTG-MIB-COMM          PIC X(5).
  4700             20  CF-MORTG-MIB-TERM          PIC X(5).
  4701         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4702             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4703         16  FILLER                         PIC X(03).
  4704         16  CF-MP-CHECK-NO-CONTROL.
  4705             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4706                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4707                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4708                                                ' ' LOW-VALUES.
  4709                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4710                                               VALUE '3'.
  4711         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4712         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4713         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4714             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4715                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4716             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4717                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4718             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  90
* EL130.cbl
  4719                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4720             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4721                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4722             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4723                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4724             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4725                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4726         16  CF-MORTG-BILLING-AREA.
  4727             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4728                                            PIC X.
  4729         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4730         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4731         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4732         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4733             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4734             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4735         16  FILLER                         PIC X.
  4736         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4737             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4738             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4739         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4740         16  FILLER                         PIC X(8).
  4741         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4742         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4743         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4744         16  CF-ACH-COMPANY-ID.
  4745             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4746                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4747                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4748                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4749             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4750         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4751             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4752         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4753             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4754             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4755         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4756         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4757         16  FILLER                         PIC X(536).
  4758
  4759****************************************************************
  4760*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4761****************************************************************
  4762
  4763     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4764         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4765             20  CF-FEMALE-HEIGHT.
  4766                 24  CF-FEMALE-FT           PIC 99.
  4767                 24  CF-FEMALE-IN           PIC 99.
  4768             20  CF-FEMALE-MIN-WT           PIC 999.
  4769             20  CF-FEMALE-MAX-WT           PIC 999.
  4770         16  FILLER                         PIC X(428).
  4771
  4772     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4773         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4774             20  CF-MALE-HEIGHT.
  4775                 24  CF-MALE-FT             PIC 99.
  4776                 24  CF-MALE-IN             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  91
* EL130.cbl
  4777             20  CF-MALE-MIN-WT             PIC 999.
  4778             20  CF-MALE-MAX-WT             PIC 999.
  4779         16  FILLER                         PIC X(428).
  4780******************************************************************
  4781*             AUTOMATIC ACTIVITY RECORD                          *
  4782******************************************************************
  4783     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4784         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4785             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4786             20  CF-SYS-LETTER-ID           PIC X(04).
  4787             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4788             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4789             20  CF-SYS-RESET-SW            PIC X(01).
  4790             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4791             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4792
  4793         16  FILLER                         PIC X(50).
  4794
  4795         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4796             20  CF-USER-ACTIVE-SW          PIC X(01).
  4797             20  CF-USER-LETTER-ID          PIC X(04).
  4798             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4799             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4800             20  CF-USER-RESET-SW           PIC X(01).
  4801             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4802             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4803             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4804
  4805         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  92
* EL130.cbl
  4807*    COPY ELCCERT.
  4808******************************************************************
  4809*                                                                *
  4810*                            ELCCERT.                            *
  4811*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4812*                            VMOD=2.013                          *
  4813*                                                                *
  4814*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4815*                                                                *
  4816*   FILE TYPE = VSAM,KSDS                                        *
  4817*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4818*                                                                *
  4819*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4820*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4821*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4822*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4823*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4824*                                                                *
  4825*   LOG = YES                                                    *
  4826*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4827******************************************************************
  4828*                   C H A N G E   L O G
  4829*
  4830* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4831*-----------------------------------------------------------------
  4832*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4833* EFFECTIVE    NUMBER
  4834*-----------------------------------------------------------------
  4835* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4836* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4837* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4838* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4839* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4840* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4841* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4842* 032612  CR2011110200001  PEMA  AHL CHANGES
  4843******************************************************************
  4844
  4845 01  CERTIFICATE-MASTER.
  4846     12  CM-RECORD-ID                      PIC XX.
  4847         88  VALID-CM-ID                      VALUE 'CM'.
  4848
  4849     12  CM-CONTROL-PRIMARY.
  4850         16  CM-COMPANY-CD                 PIC X.
  4851         16  CM-CARRIER                    PIC X.
  4852         16  CM-GROUPING.
  4853             20  CM-GROUPING-PREFIX        PIC X(3).
  4854             20  CM-GROUPING-PRIME         PIC X(3).
  4855         16  CM-STATE                      PIC XX.
  4856         16  CM-ACCOUNT.
  4857             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4858             20  CM-ACCOUNT-PRIME          PIC X(6).
  4859         16  CM-CERT-EFF-DT                PIC XX.
  4860         16  CM-CERT-NO.
  4861             20  CM-CERT-PRIME             PIC X(10).
  4862             20  CM-CERT-SFX               PIC X.
  4863
  4864     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  93
* EL130.cbl
  4865         16  CM-COMPANY-CD-A1              PIC X.
  4866         16  CM-INSURED-LAST-NAME          PIC X(15).
  4867         16  CM-INSURED-INITIALS.
  4868             20  CM-INSURED-INITIAL1       PIC X.
  4869             20  CM-INSURED-INITIAL2       PIC X.
  4870
  4871     12  CM-CONTROL-BY-SSN.
  4872         16  CM-COMPANY-CD-A2              PIC X.
  4873         16  CM-SOC-SEC-NO.
  4874             20  CM-SSN-STATE              PIC XX.
  4875             20  CM-SSN-ACCOUNT            PIC X(6).
  4876             20  CM-SSN-LN3.
  4877                 25  CM-INSURED-INITIALS-A2.
  4878                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4879                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4880                 25 CM-PART-LAST-NAME-A2         PIC X.
  4881
  4882     12  CM-CONTROL-BY-CERT-NO.
  4883         16  CM-COMPANY-CD-A4              PIC X.
  4884         16  CM-CERT-NO-A4                 PIC X(11).
  4885
  4886     12  CM-CONTROL-BY-MEMB.
  4887         16  CM-COMPANY-CD-A5              PIC X.
  4888         16  CM-MEMBER-NO.
  4889             20  CM-MEMB-STATE             PIC XX.
  4890             20  CM-MEMB-ACCOUNT           PIC X(6).
  4891             20  CM-MEMB-LN4.
  4892                 25  CM-INSURED-INITIALS-A5.
  4893                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4894                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4895                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4896
  4897     12  CM-INSURED-PROFILE-DATA.
  4898         16  CM-INSURED-FIRST-NAME.
  4899             20  CM-INSURED-1ST-INIT       PIC X.
  4900             20  FILLER                    PIC X(9).
  4901         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4902         16  CM-INSURED-SEX                PIC X.
  4903             88  CM-SEX-MALE                  VALUE 'M'.
  4904             88  CM-SEX-FEMAL                 VALUE 'F'.
  4905         16  CM-INSURED-JOINT-AGE          PIC 99.
  4906         16  CM-JOINT-INSURED-NAME.
  4907             20  CM-JT-LAST-NAME           PIC X(15).
  4908             20  CM-JT-FIRST-NAME.
  4909                 24  CM-JT-1ST-INIT        PIC X.
  4910                 24  FILLER                PIC X(9).
  4911             20  CM-JT-INITIAL             PIC X.
  4912
  4913     12  CM-LIFE-DATA.
  4914         16  CM-LF-BENEFIT-CD              PIC XX.
  4915         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4916         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4917         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4918         16  CM-LF-DEV-CODE                PIC XXX.
  4919         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4920         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4921         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4922         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  94
* EL130.cbl
  4923         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4924         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4925         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4926         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4927         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4928         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4929         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4930         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4931         16  FILLER                        PIC XX.
  4932
  4933     12  CM-AH-DATA.
  4934         16  CM-AH-BENEFIT-CD              PIC XX.
  4935         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4936         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4937         16  CM-AH-DEV-CODE                PIC XXX.
  4938         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4939         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4940         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4941         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4942         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4943         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4944         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4945         16  CM-AH-PAID-THRU-DT            PIC XX.
  4946             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4947         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4948         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4949         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4950         16  FILLER                        PIC X.
  4951
  4952     12  CM-LOAN-INFORMATION.
  4953         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4954         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4955                                           PIC S9(5)V99  COMP-3.
  4956         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4957         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4958         16  CM-PAY-FREQUENCY              PIC S99.
  4959         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4960         16  CM-RATE-CLASS                 PIC XX.
  4961         16  CM-BENEFICIARY                PIC X(25).
  4962         16  CM-POLICY-FORM-NO             PIC X(12).
  4963         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4964         16  CM-LAST-ADD-ON-DT             PIC XX.
  4965         16  CM-DEDUCTIBLE-AMOUNTS.
  4966             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4967             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4968         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4969             20  CM-RESIDENT-STATE         PIC XX.
  4970             20  CM-RATE-CODE              PIC X(4).
  4971             20  FILLER                    PIC XX.
  4972         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4973             20  CM-LOAN-OFFICER           PIC X(5).
  4974             20  FILLER                    PIC XXX.
  4975         16  CM-CSR-CODE                   PIC XXX.
  4976         16  CM-UNDERWRITING-CODE          PIC X.
  4977             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4978         16  CM-POST-CARD-IND              PIC X.
  4979         16  CM-NH-INTERFACE-SW            PIC X.
  4980         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  95
* EL130.cbl
  4981             88  CM-SING-PRM                  VALUE '1'.
  4982             88  CM-O-B-COVERAGE              VALUE '2'.
  4983             88  CM-OPEN-END                  VALUE '3'.
  4984         16  CM-IND-GRP-TYPE               PIC X.
  4985             88  CM-INDIVIDUAL                VALUE 'I'.
  4986             88  CM-GROUP                     VALUE 'G'.
  4987         16  CM-SKIP-CODE                  PIC X.
  4988             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4989             88  SKIP-JULY                    VALUE '1'.
  4990             88  SKIP-AUGUST                  VALUE '2'.
  4991             88  SKIP-SEPTEMBER               VALUE '3'.
  4992             88  SKIP-JULY-AUG                VALUE '4'.
  4993             88  SKIP-AUG-SEPT                VALUE '5'.
  4994             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4995             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4996             88  SKIP-JUNE                    VALUE '8'.
  4997             88  SKIP-JUNE-JULY               VALUE '9'.
  4998             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4999             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5000         16  CM-PAYMENT-MODE               PIC X.
  5001             88  PAY-MONTHLY                  VALUE SPACE.
  5002             88  PAY-WEEKLY                   VALUE '1'.
  5003             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5004             88  PAY-BI-WEEKLY                VALUE '3'.
  5005             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5006         16  CM-LOAN-NUMBER                PIC X(8).
  5007         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5008         16  CM-OLD-LOF                    PIC XXX.
  5009*        16  CM-LOAN-OFFICER               PIC XXX.
  5010         16  CM-REIN-TABLE                 PIC XXX.
  5011         16  CM-SPECIAL-REIN-CODE          PIC X.
  5012         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5013         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5014         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5015
  5016     12  CM-STATUS-DATA.
  5017         16  CM-ENTRY-STATUS               PIC X.
  5018         16  CM-ENTRY-DT                   PIC XX.
  5019
  5020         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5021         16  CM-LF-CANCEL-DT               PIC XX.
  5022         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5023
  5024         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5025         16  CM-LF-DEATH-DT                PIC XX.
  5026         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5027
  5028         16  CM-LF-CURRENT-STATUS          PIC X.
  5029             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5030                                                'M' '4' '5' '9'.
  5031             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5032             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5033             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5034             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5035             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5036             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5037             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5038             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  96
* EL130.cbl
  5039             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5040             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5041             88  CM-LF-DECLINED               VALUE 'D'.
  5042             88  CM-LF-VOIDED                 VALUE 'V'.
  5043
  5044         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5045         16  CM-AH-CANCEL-DT               PIC XX.
  5046         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5047
  5048         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5049         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5050         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5051
  5052         16  CM-AH-CURRENT-STATUS          PIC X.
  5053             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5054                                                'M' '4' '5' '9'.
  5055             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5056             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5057             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5058             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5059             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5060             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5061             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5062             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5063             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5064             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5065             88  CM-AH-DECLINED               VALUE 'D'.
  5066             88  CM-AH-VOIDED                 VALUE 'V'.
  5067
  5068         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5069             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5070             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5071             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5072         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5073
  5074         16  CM-ENTRY-BATCH                PIC X(6).
  5075         16  CM-LF-EXIT-BATCH              PIC X(6).
  5076         16  CM-AH-EXIT-BATCH              PIC X(6).
  5077         16  CM-LAST-MONTH-END             PIC XX.
  5078
  5079     12  CM-NOTE-SW                        PIC X.
  5080         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5081         88  CERT-NOTES-PRESENT               VALUE '1'.
  5082         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5083         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5084         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5085         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5086         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5087         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5088     12  CM-COMP-EXCP-SW                   PIC X.
  5089         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5090         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5091     12  CM-INSURED-ADDRESS-SW             PIC X.
  5092         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5093         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5094
  5095*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5096     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  97
* EL130.cbl
  5097     12  FILLER                            PIC X.
  5098
  5099*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5100     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5101     12  FILLER                            PIC X.
  5102*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5103     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5104
  5105     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5106         88  CERT-ADDED-BATCH                 VALUE ' '.
  5107         88  CERT-ADDED-ONLINE                VALUE '1'.
  5108         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5109         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5110         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5111     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5112         88  CERT-AS-LOADED                   VALUE ' '.
  5113         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5114         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5115         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5116         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5117         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5118         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5119         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5120
  5121     12  CM-ACCOUNT-COMM-PCTS.
  5122         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5123         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5124
  5125     12  CM-USER-FIELD                     PIC X.
  5126     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5127     12  CM-CLP-STATE                      PIC XX.
  5128     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5129     12  CM-USER-RESERVED                  PIC XXX.
  5130     12  FILLER REDEFINES CM-USER-RESERVED.
  5131         16  CM-AH-CLASS-CD                PIC XX.
  5132         16  F                             PIC X.
  5133******************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  98
* EL130.cbl
  5135*    COPY ERCACCT.
  5136******************************************************************
  5137*                                                                *
  5138*                                                                *
  5139*                            ERCACCT                             *
  5140*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5141*                            VMOD=2.031                          *
  5142*                                                                *
  5143*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5144*                                                                *
  5145*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5146*   VSAM ACCOUNT MASTER FILES.                                   *
  5147*                                                                *
  5148*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5149*                                                                *
  5150*   FILE TYPE = VSAM,KSDS                                        *
  5151*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5152*                                                                *
  5153*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5154*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5155*                                                                *
  5156*   LOG = NO                                                     *
  5157*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5158*                                                                *
  5159*                                                                *
  5160******************************************************************
  5161*                   C H A N G E   L O G
  5162*
  5163* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5164*-----------------------------------------------------------------
  5165*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5166* EFFECTIVE    NUMBER
  5167*-----------------------------------------------------------------
  5168* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5169* 092705    2005050300006  PEMA  ADD SPP LEASES
  5170* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5171* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5172* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5173* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5174* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5175******************************************************************
  5176
  5177 01  ACCOUNT-MASTER.
  5178     12  AM-RECORD-ID                      PIC XX.
  5179         88  VALID-AM-ID                      VALUE 'AM'.
  5180
  5181     12  AM-CONTROL-PRIMARY.
  5182         16  AM-COMPANY-CD                 PIC X.
  5183         16  AM-MSTR-CNTRL.
  5184             20  AM-CONTROL-A.
  5185                 24  AM-CARRIER            PIC X.
  5186                 24  AM-GROUPING.
  5187                     28 AM-GROUPING-PREFIX PIC XXX.
  5188                     28 AM-GROUPING-PRIME  PIC XXX.
  5189                 24  AM-STATE              PIC XX.
  5190                 24  AM-ACCOUNT.
  5191                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5192                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page  99
* EL130.cbl
  5193             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5194                                           PIC X(19).
  5195             20  AM-CNTRL-B.
  5196                 24  AM-EXPIRATION-DT      PIC XX.
  5197                 24  FILLER                PIC X(4).
  5198             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5199                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5200
  5201     12  AM-CONTROL-BY-VAR-GRP.
  5202         16  AM-COMPANY-CD-A1              PIC X.
  5203         16  AM-VG-CARRIER                 PIC X.
  5204         16  AM-VG-GROUPING                PIC X(6).
  5205         16  AM-VG-STATE                   PIC XX.
  5206         16  AM-VG-ACCOUNT                 PIC X(10).
  5207         16  AM-VG-DATE.
  5208             20  AM-VG-EXPIRATION-DT       PIC XX.
  5209             20  FILLER                    PIC X(4).
  5210         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5211                                           PIC 9(11)      COMP-3.
  5212     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5213         16  FILLER                        PIC X(10).
  5214         16  AM-VG-KEY3.
  5215             20  AM-VG3-ACCOUNT            PIC X(10).
  5216             20  AM-VG3-EXP-DT             PIC XX.
  5217         16  FILLER                        PIC X(4).
  5218     12  AM-MAINT-INFORMATION.
  5219         16  AM-LAST-MAINT-DT              PIC XX.
  5220         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5221         16  AM-LAST-MAINT-USER            PIC X(4).
  5222         16  FILLER                        PIC XX.
  5223
  5224     12  AM-EFFECTIVE-DT                   PIC XX.
  5225     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5226
  5227     12  AM-PREV-DATES  COMP-3.
  5228         16  AM-PREV-EXP-DT                PIC 9(11).
  5229         16  AM-PREV-EFF-DT                PIC 9(11).
  5230
  5231     12  AM-REPORT-CODE-1                  PIC X(10).
  5232     12  AM-REPORT-CODE-2                  PIC X(10).
  5233
  5234     12  AM-CITY-CODE                      PIC X(4).
  5235     12  AM-COUNTY-PARISH                  PIC X(6).
  5236
  5237     12  AM-NAME                           PIC X(30).
  5238     12  AM-PERSON                         PIC X(30).
  5239     12  AM-ADDRS                          PIC X(30).
  5240     12  AM-CITY.
  5241         16  AM-ADDR-CITY                  PIC X(28).
  5242         16  AM-ADDR-STATE                 PIC XX.
  5243     12  AM-ZIP.
  5244         16  AM-ZIP-PRIME.
  5245             20  AM-ZIP-PRI-1ST            PIC X.
  5246                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5247             20  FILLER                    PIC X(4).
  5248         16  AM-ZIP-PLUS4                  PIC X(4).
  5249     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5250         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 100
* EL130.cbl
  5251         16  AM-CAN-POSTAL-2               PIC XXX.
  5252         16  FILLER                        PIC XXX.
  5253     12  AM-TEL-NO.
  5254         16  AM-AREA-CODE                  PIC 999.
  5255         16  AM-TEL-PRE                    PIC 999.
  5256         16  AM-TEL-NBR                    PIC 9(4).
  5257     12  AM-TEL-LOC                        PIC X.
  5258         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5259         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5260
  5261     12  AM-COMM-STRUCTURE.
  5262         16  AM-DEFN-1.
  5263             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5264                 24  AM-AGT.
  5265                     28  AM-AGT-PREFIX     PIC X(4).
  5266                     28  AM-AGT-PRIME      PIC X(6).
  5267                 24  AM-COM-TYP            PIC X.
  5268                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5269                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5270                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5271                 24  AM-RECALC-LV-INDIC    PIC X.
  5272                 24  AM-RETRO-LV-INDIC     PIC X.
  5273                 24  AM-GL-CODES           PIC X.
  5274                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5275                 24  FILLER                PIC X(01).
  5276         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5277             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5278                 24  FILLER                PIC X(11).
  5279                 24  AM-L-COMA             PIC XXX.
  5280                 24  AM-J-COMA             PIC XXX.
  5281                 24  AM-A-COMA             PIC XXX.
  5282                 24  FILLER                PIC X(6).
  5283
  5284     12  AM-COMM-CHANGE-STATUS             PIC X.
  5285         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5286
  5287     12  AM-CSR-CODE                       PIC X(4).
  5288
  5289     12  AM-BILLING-STATUS                 PIC X.
  5290         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5291         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5292     12  AM-AUTO-REFUND-SW                 PIC X.
  5293         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5294         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5295     12  AM-GPCD                           PIC 99.
  5296     12  AM-IG                             PIC X.
  5297         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5298         88  AM-HAS-GROUP                     VALUE '2'.
  5299     12  AM-STATUS                         PIC X.
  5300         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5301         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5302         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5303         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5304         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5305         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5306     12  AM-REMIT-TO                       PIC 99.
  5307     12  AM-ID-NO                          PIC X(11).
  5308
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 101
* EL130.cbl
  5309     12  AM-CAL-TABLE                      PIC XX.
  5310     12  AM-LF-DEVIATION                   PIC XXX.
  5311     12  AM-AH-DEVIATION                   PIC XXX.
  5312     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5313     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5314     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5315     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5316     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5317     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5318
  5319     12  AM-USER-FIELDS.
  5320         16  AM-FLD-1                      PIC XX.
  5321         16  AM-FLD-2                      PIC XX.
  5322         16  AM-FLD-3                      PIC XX.
  5323         16  AM-FLD-4                      PIC XX.
  5324         16  AM-FLD-5                      PIC XX.
  5325
  5326     12  AM-1ST-PROD-DATE.
  5327         16  AM-1ST-PROD-YR                PIC XX.
  5328         16  AM-1ST-PROD-MO                PIC XX.
  5329         16  AM-1ST-PROD-DA                PIC XX.
  5330     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5331     12  AM-CERTS-PURGED-DATE.
  5332         16  AM-PUR-YR                     PIC XX.
  5333         16  AM-PUR-MO                     PIC XX.
  5334         16  AM-PUR-DA                     PIC XX.
  5335     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5336     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5337     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5338     12  AM-INACTIVE-DATE.
  5339         16  AM-INA-MO                     PIC 99.
  5340         16  AM-INA-DA                     PIC 99.
  5341         16  AM-INA-YR                     PIC 99.
  5342     12  AM-AR-HI-CERT-DATE                PIC XX.
  5343
  5344     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5345     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5346
  5347     12  AM-OB-PAYMENT-MODE                PIC X.
  5348         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5349         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5350         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5351         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5352
  5353     12  AM-AH-ONLY-INDICATOR              PIC X.
  5354         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5355         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5356
  5357     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5358
  5359     12  AM-OVER-SHORT.
  5360         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5361         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5362
  5363     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5364     12  AM-DCC-CLP-STATE                  PIC XX.
  5365
  5366     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 102
* EL130.cbl
  5367     12  AM-RECALC-REIN                    PIC X.
  5368
  5369     12  AM-REI-TABLE                      PIC XXX.
  5370     12  AM-REI-ET-LF                      PIC X.
  5371     12  AM-REI-ET-AH                      PIC X.
  5372     12  AM-REI-PE-LF                      PIC X.
  5373     12  AM-REI-PE-AH                      PIC X.
  5374     12  AM-REI-PRT-ST                     PIC X.
  5375     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5376     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5377     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5378     12  AM-REI-GROUP-A                    PIC X(6).
  5379     12  AM-REI-MORT                       PIC X(4).
  5380     12  AM-REI-PRT-OW                     PIC X.
  5381     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5382     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5383     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5384     12  AM-REI-GROUP-B                    PIC X(6).
  5385
  5386     12  AM-TRUST-TYPE                     PIC X(2).
  5387
  5388     12  AM-EMPLOYER-STMT-USED             PIC X.
  5389     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5390
  5391     12  AM-STD-AH-TYPE                    PIC XX.
  5392     12  AM-EARN-METHODS.
  5393         16  AM-EARN-METHOD-R              PIC X.
  5394             88 AM-REF-RL-R78                 VALUE 'R'.
  5395             88 AM-REF-RL-PR                  VALUE 'P'.
  5396             88 AM-REF-RL-MEAN                VALUE 'M'.
  5397             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5398         16  AM-EARN-METHOD-L              PIC X.
  5399             88 AM-REF-LL-R78                 VALUE 'R'.
  5400             88 AM-REF-LL-PR                  VALUE 'P'.
  5401             88 AM-REF-LL-MEAN                VALUE 'M'.
  5402             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5403         16  AM-EARN-METHOD-A              PIC X.
  5404             88 AM-REF-AH-R78                 VALUE 'R'.
  5405             88 AM-REF-AH-PR                  VALUE 'P'.
  5406             88 AM-REF-AH-MEAN                VALUE 'M'.
  5407             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5408             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5409             88 AM-REF-AH-NET                 VALUE 'N'.
  5410
  5411     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5412     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5413     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5414
  5415     12  AM-RET-Y-N                        PIC X.
  5416     12  AM-RET-P-E                        PIC X.
  5417     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5418     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5419     12  AM-RET-GRP                        PIC X(6).
  5420     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5421         16  AM-POOL-PRIME                 PIC XXX.
  5422         16  AM-POOL-SUB                   PIC XXX.
  5423     12  AM-RETRO-EARNINGS.
  5424         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 103
* EL130.cbl
  5425         16  AM-RET-EARN-L                 PIC X.
  5426         16  AM-RET-EARN-A                 PIC X.
  5427     12  AM-RET-ST-TAX-USE                 PIC X.
  5428         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5429         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5430     12  AM-RETRO-BEG-EARNINGS.
  5431         16  AM-RET-BEG-EARN-R             PIC X.
  5432         16  AM-RET-BEG-EARN-L             PIC X.
  5433         16  AM-RET-BEG-EARN-A             PIC X.
  5434     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5435     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5436
  5437     12  AM-USER-SELECT-OPTIONS.
  5438         16  AM-USER-SELECT-1              PIC X(10).
  5439         16  AM-USER-SELECT-2              PIC X(10).
  5440         16  AM-USER-SELECT-3              PIC X(10).
  5441         16  AM-USER-SELECT-4              PIC X(10).
  5442         16  AM-USER-SELECT-5              PIC X(10).
  5443
  5444     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5445
  5446     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5447
  5448     12  AM-RPT045A-SWITCH                 PIC X.
  5449         88  RPT045A-OFF                   VALUE 'N'.
  5450
  5451     12  AM-INSURANCE-LIMITS.
  5452         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5453         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5454
  5455     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5456         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5457
  5458     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5459         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5460         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5461
  5462     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5463
  5464     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5465     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5466     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5467     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5468     12  AM-DCC-UEF-STATE                  PIC XX.
  5469     12  FILLER                            PIC XXX.
  5470     12  AM-REPORT-CODE-3                  PIC X(10).
  5471*    12  FILLER                            PIC X(22).
  5472
  5473     12  AM-RESERVE-DATE.
  5474         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5475         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5476         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5477
  5478     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5479     12  AM-NOTIFICATION-TYPES.
  5480         16  AM-NOTIF-OF-LETTERS           PIC X.
  5481         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5482         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 104
* EL130.cbl
  5483         16  AM-NOTIF-OF-STATUS            PIC X.
  5484
  5485     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5486         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5487         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5488         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5489         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5490
  5491     12  AM-BENEFIT-CONTROLS.
  5492         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5493             20  AM-BENEFIT-CODE           PIC XX.
  5494             20  AM-BENEFIT-TYPE           PIC X.
  5495             20  AM-BENEFIT-REVISION       PIC XXX.
  5496             20  AM-BENEFIT-REM-TERM       PIC X.
  5497             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5498             20  FILLER                    PIC XX.
  5499         16  FILLER                        PIC X(80).
  5500
  5501     12  AM-TRANSFER-DATA.
  5502         16  AM-TRANSFERRED-FROM.
  5503             20  AM-TRNFROM-CARRIER        PIC X.
  5504             20  AM-TRNFROM-GROUPING.
  5505                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5506                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5507             20  AM-TRNFROM-STATE          PIC XX.
  5508             20  AM-TRNFROM-ACCOUNT.
  5509                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5510                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5511             20  AM-TRNFROM-DTE            PIC XX.
  5512         16  AM-TRANSFERRED-TO.
  5513             20  AM-TRNTO-CARRIER          PIC X.
  5514             20  AM-TRNTO-GROUPING.
  5515                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5516                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5517             20  AM-TRNTO-STATE            PIC XX.
  5518             20  AM-TRNTO-ACCOUNT.
  5519                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5520                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5521             20  AM-TRNTO-DTE              PIC XX.
  5522         16  FILLER                        PIC X(10).
  5523
  5524     12  AM-SAVED-REMIT-TO                 PIC 99.
  5525
  5526     12  AM-COMM-STRUCTURE-SAVED.
  5527         16  AM-DEFN-1-SAVED.
  5528             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5529                 24  AM-AGT-SV             PIC X(10).
  5530                 24  AM-COM-TYP-SV         PIC X.
  5531                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5532                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5533                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5534                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5535                 24  FILLER                PIC X.
  5536                 24  AM-GL-CODES-SV        PIC X.
  5537                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5538                 24  FILLER                PIC X.
  5539         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5540             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 105
* EL130.cbl
  5541                 24  FILLER                PIC X(11).
  5542                 24  AM-L-COMA-SV          PIC XXX.
  5543                 24  AM-J-COMA-SV          PIC XXX.
  5544                 24  AM-A-COMA-SV          PIC XXX.
  5545                 24  FILLER                PIC X(6).
  5546
  5547     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5548         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5549            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5550            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5551            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5552
  5553     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5554     12  FILLER                            PIC X(120).
  5555
  5556     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5557         16  AM-CONTROL-NAME               PIC X(30).
  5558         16  AM-EXECUTIVE-ONE.
  5559             20  AM-EXEC1-NAME             PIC X(15).
  5560             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5561                                                          COMP-3.
  5562             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5563                                                          COMP-3.
  5564         16  AM-EXECUTIVE-TWO.
  5565             20  AM-EXEC2-NAME             PIC X(15).
  5566             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5567                                                          COMP-3.
  5568             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5569                                                          COMP-3.
  5570
  5571     12  AM-RETRO-ADDITIONAL-DATA.
  5572         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5573         16  AM-RETRO-PREM-P-E             PIC X.
  5574         16  AM-RETRO-CLMS-P-I             PIC X.
  5575         16  AM-RETRO-RET-BRACKET-LF.
  5576             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5577                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5578                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5579             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5580                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5581                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5582             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5583                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5584                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5585         16  AM-RETRO-RET-BRACKET-AH.
  5586             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5587                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5588                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5589                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5590             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5591                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5592                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5593             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5594                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5595                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5596
  5597     12  AM-COMMENTS.
  5598         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 106
* EL130.cbl
  5599
  5600     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5601         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5602         16  AM-FLI-BILLING-CODE           PIC X.
  5603         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5604         16  AM-FLI-UNITED-IDENT           PIC X.
  5605         16  AM-FLI-INTEREST-LOST-DATA.
  5606             20  AM-FLI-BANK-NO            PIC X(5).
  5607             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5608             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5609             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5610         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5611             20  AM-FLI-AGT                PIC X(9).
  5612             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5613             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5614         16  FILLER                        PIC X(102).
  5615
  5616     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5617         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5618             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5619             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5620             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5621             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5622             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5623         16  FILLER                          PIC X(10).
  5624******************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 107
* EL130.cbl
  5626*    COPY ELCTRLR.
  5627******************************************************************
  5628*                                                                *
  5629*                            ELCTRLR.                            *
  5630*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5631*                            VMOD=2.014                          *
  5632*                                                                *
  5633*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5634*                                                                *
  5635*   FILE TYPE = VSAM,KSDS                                        *
  5636*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5637*                                                                *
  5638*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5639*       ALTERNATE INDEX = NONE                                   *
  5640*                                                                *
  5641*   LOG = YES                                                    *
  5642*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5643******************************************************************
  5644*                   C H A N G E   L O G
  5645*
  5646* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5647*-----------------------------------------------------------------
  5648*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5649* EFFECTIVE    NUMBER
  5650*-----------------------------------------------------------------
  5651* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5652* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5653* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5654* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5655* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5656* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5657* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5658* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5659* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5660* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5661* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5662* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5663* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5664******************************************************************
  5665 01  ACTIVITY-TRAILERS.
  5666     12  AT-RECORD-ID                    PIC XX.
  5667         88  VALID-AT-ID                       VALUE 'AT'.
  5668
  5669     12  AT-CONTROL-PRIMARY.
  5670         16  AT-COMPANY-CD               PIC X.
  5671         16  AT-CARRIER                  PIC X.
  5672         16  AT-CLAIM-NO                 PIC X(7).
  5673         16  AT-CERT-NO.
  5674             20  AT-CERT-PRIME           PIC X(10).
  5675             20  AT-CERT-SFX             PIC X.
  5676         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5677             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5678             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5679             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5680             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5681             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5682             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5683             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 108
* EL130.cbl
  5684             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5685             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5686             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5687             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5688             88  AT-BENEFICIARY-TRL           VALUE +91.
  5689             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5690             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5691
  5692     12  AT-TRAILER-TYPE                 PIC X.
  5693         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5694         88  PAYMENT-TR                       VALUE '2'.
  5695         88  AUTO-PAY-TR                      VALUE '3'.
  5696         88  CORRESPONDENCE-TR                VALUE '4'.
  5697         88  ADDRESS-TR                       VALUE '5'.
  5698         88  GENERAL-INFO-TR                  VALUE '6'.
  5699         88  AUTO-PROMPT-TR                   VALUE '7'.
  5700         88  DENIAL-TR                        VALUE '8'.
  5701         88  INCURRED-CHG-TR                  VALUE '9'.
  5702         88  FORM-CONTROL-TR                  VALUE 'A'.
  5703
  5704     12  AT-RECORDED-DT                  PIC XX.
  5705     12  AT-RECORDED-BY                  PIC X(4).
  5706     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5707
  5708     12  AT-TRAILER-BODY                 PIC X(165).
  5709
  5710     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5711         16  AT-RESERVE-CONTROLS.
  5712             20  AT-MANUAL-SW            PIC X.
  5713                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5714             20  AT-FUTURE-SW            PIC X.
  5715                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5716             20  AT-PTC-SW               PIC X.
  5717                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5718             20  AT-IBNR-SW              PIC X.
  5719                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5720             20  AT-PTC-LF-SW            PIC X.
  5721                 88  AT-LF-PTC-USED          VALUE '1'.
  5722             20  AT-CDT-ACCESS-METHOD    PIC X.
  5723                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5724                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5725                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5726             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5727         16  AT-LAST-COMPUTED-DT         PIC XX.
  5728         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5729         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5730         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5731         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5732         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5733         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5734         16  AT-EXPENSE-CONTROLS.
  5735             20  AT-EXPENSE-METHOD       PIC X.
  5736                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5737                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5738                 88  PERCENT-OF-PMT           VALUE '3'.
  5739                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5740             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5741             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 109
* EL130.cbl
  5742         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5743         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5744
  5745         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5746         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5747
  5748*        16  FILLER                      PIC X(53).
  5749         16  FILLER                      PIC X(47).
  5750
  5751         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5752         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5753
  5754         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5755             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5756             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5757*                    C = CLOSED
  5758*                    O = OPEN
  5759             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5760*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5761
  5762     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5763         16  AT-PAYMENT-TYPE             PIC X.
  5764             88  PARTIAL-PAYMENT                VALUE '1'.
  5765             88  FINAL-PAYMENT                  VALUE '2'.
  5766             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5767             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5768             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5769             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5770             88  VOIDED-PAYMENT                 VALUE '9'.
  5771             88  TRANSFER                       VALUE 'T'.
  5772             88  LIFE-INTEREST                  VALUE 'I'.
  5773
  5774         16  AT-CLAIM-TYPE               PIC X.
  5775             88  PAID-FOR-AH                    VALUE 'A'.
  5776             88  PAID-FOR-LIFE                  VALUE 'L'.
  5777             88  PAID-FOR-IUI                   VALUE 'I'.
  5778             88  PAID-FOR-GAP                   VALUE 'G'.
  5779         16  AT-CLAIM-PREM-TYPE          PIC X.
  5780             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5781             88  AT-O-B-COVERAGE                VALUE '2'.
  5782             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5783         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5784         16  AT-CHECK-NO                 PIC X(7).
  5785         16  AT-PAID-FROM-DT             PIC XX.
  5786         16  AT-PAID-THRU-DT             PIC XX.
  5787         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5788         16  FILLER                      PIC X.
  5789         16  AT-PAYEES-NAME              PIC X(30).
  5790         16  AT-PAYMENT-ORIGIN           PIC X.
  5791             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5792             88  ONLINE-AUTO-PMT                VALUE '2'.
  5793             88  OFFLINE-PMT                    VALUE '3'.
  5794         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5795         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5796         16  AT-VOID-DATA.
  5797             20  AT-VOID-DT              PIC XX.
  5798*00144       20  AT-VOID-REASON          PIC X(30).
  5799             20  AT-VOID-REASON          PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 110
* EL130.cbl
  5800         16  AT-PMT-APPROVED-BY          PIC X(04).
  5801         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5802         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5803         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5804                                         PIC S99V9(5)  COMP-3.
  5805         16  AT-CREDIT-INTERFACE.
  5806             20  AT-PMT-SELECT-DT        PIC XX.
  5807                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5808             20  AT-PMT-ACCEPT-DT        PIC XX.
  5809                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5810             20  AT-VOID-SELECT-DT       PIC XX.
  5811                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5812             20  AT-VOID-ACCEPT-DT       PIC XX.
  5813                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5814
  5815         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5816                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5817                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5818         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5819
  5820         16  AT-FORCE-CONTROL            PIC X.
  5821             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5822         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5823         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5824         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5825         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5826         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5827         16  AT-BENEFIT-TYPE             PIC X.
  5828
  5829         16  AT-EXPENSE-TYPE             PIC X.
  5830         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5831
  5832         16  AT-PAYEE-TYPE-CD.
  5833             20  AT-PAYEE-TYPE           PIC X.
  5834                 88  INSURED-PAID           VALUE 'I'.
  5835                 88  BENEFICIARY-PAID       VALUE 'B'.
  5836                 88  ACCOUNT-PAID           VALUE 'A'.
  5837                 88  OTHER-1-PAID           VALUE 'O'.
  5838                 88  OTHER-2-PAID           VALUE 'Q'.
  5839                 88  DOCTOR-PAID            VALUE 'P'.
  5840                 88  EMPLOYER-PAID          VALUE 'E'.
  5841             20  AT-PAYEE-SEQ            PIC X.
  5842
  5843         16  AT-CASH-PAYMENT             PIC X.
  5844         16  AT-GROUPED-PAYMENT          PIC X.
  5845         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5846         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5847         16  AT-APPROVED-LEVEL           PIC X.
  5848         16  AT-VOID-TYPE                PIC X.
  5849             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5850             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5851         16  AT-AIG-UNEMP-IND            PIC X.
  5852             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5853         16  AT-ASSOCIATES               PIC X.
  5854             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5855             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5856
  5857         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 111
* EL130.cbl
  5858         16  AT-CV-PMT-CODE              PIC X.
  5859             88  FULL-DEATH-PAYMENT         VALUE '1'.
  5860             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5861             88  FULL-ADD-PAYMENT           VALUE '3'.
  5862             88  HALF-ADD-PAYMENT           VALUE '4'.
  5863             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5864             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5865             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5866             88  ADDL-PAYMENT               VALUE '8'.
  5867
  5868         16  AT-EOB-CODE1                PIC XXX.
  5869         16  AT-EOB-CODE2                PIC XXX.
  5870         16  AT-EOB-CODE3                PIC XXX.
  5871         16  AT-EOB-CODE4                PIC XXX.
  5872         16  FILLER REDEFINES AT-EOB-CODE4.
  5873             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5874             20  FILLER                  PIC X.
  5875         16  AT-EOB-CODE5                PIC XXX.
  5876         16  FILLER REDEFINES AT-EOB-CODE5.
  5877             20  AT-PMT-PROOF-DT         PIC XX.
  5878             20  FILLER                  PIC X.
  5879
  5880         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5881             88  AT-PRINT-EOB            VALUE 'Y'.
  5882
  5883         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  5884         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  5885
  5886     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  5887         16  AT-SCHEDULE-START-DT        PIC XX.
  5888         16  AT-SCHEDULE-END-DT          PIC XX.
  5889         16  AT-TERMINATED-DT            PIC XX.
  5890         16  AT-LAST-PMT-TYPE            PIC X.
  5891             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  5892             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  5893         16  AT-FIRST-PMT-DATA.
  5894             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5895             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  5896             20  AT-1ST-PAY-THRU-DT      PIC XX.
  5897         16  AT-REGULAR-PMT-DATA.
  5898             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  5899             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  5900             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  5901         16  AT-AUTO-PAYEE-CD.
  5902             20  AT-AUTO-PAYEE-TYPE      PIC X.
  5903                 88  INSURED-PAID-AUTO      VALUE 'I'.
  5904                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  5905                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  5906                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  5907                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  5908             20  AT-AUTO-PAYEE-SEQ       PIC X.
  5909         16  AT-AUTO-PAY-DAY             PIC 99.
  5910         16  AT-AUTO-CASH                PIC X.
  5911             88  AT-CASH                      VALUE 'Y'.
  5912             88  AT-NON-CASH                  VALUE 'N'.
  5913*        16  FILLER                      PIC X(129).
  5914         16  AT-AUTO-END-LETTER          PIC X(4).
  5915         16  FILLER                      PIC X(125).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 112
* EL130.cbl
  5916
  5917         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  5918         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  5919
  5920     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  5921         16  AT-LETTER-SENT-DT           PIC XX.
  5922         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  5923         16  AT-AUTO-RE-SEND-DT          PIC XX.
  5924         16  AT-LETTER-ANSWERED-DT       PIC XX.
  5925         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  5926         16  AT-LETTER-ORIGIN            PIC X.
  5927             88  ONLINE-CREATION              VALUE '1' '3'.
  5928             88  OFFLINE-CREATION             VALUE '2' '4'.
  5929             88  NAPER-ONLINE-CREATION        VALUE '3'.
  5930             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  5931         16  AT-STD-LETTER-FORM          PIC X(4).
  5932         16  AT-REASON-TEXT              PIC X(70).
  5933         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  5934         16  AT-ADDRESEE-TYPE            PIC X.
  5935              88  INSURED-ADDRESEE            VALUE 'I'.
  5936              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  5937              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  5938              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  5939              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  5940              88  OTHER-ADDRESEE-1            VALUE 'O'.
  5941              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  5942         16  AT-ADDRESSEE-NAME           PIC X(30).
  5943         16  AT-INITIAL-PRINT-DATE       PIC XX.
  5944         16  AT-RESEND-PRINT-DATE        PIC XX.
  5945         16  AT-CORR-SOL-UNSOL           PIC X.
  5946         16  AT-LETTER-PURGED-DT         PIC XX.
  5947*
  5948*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  5949*
  5950         16  AT-CSO-REDEFINITION.
  5951             20  AT-RESEND-LETTER-FORM   PIC X(4).
  5952             20  AT-AUTO-CLOSE-IND       PIC X(1).
  5953             20  AT-LETTER-TO-BENE       PIC X(1).
  5954             20  AT-STOP-LETTER-DT       PIC X(2).
  5955             20  FILLER                  PIC X(19).
  5956*             20  FILLER                  PIC X(27).
  5957             20  AT-CSO-LETTER-STATUS    PIC X.
  5958                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  5959                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  5960                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  5961             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  5962             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  5963*
  5964*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  5965*
  5966*        16  FILLER                      PIC X(26).
  5967*
  5968*        16  AT-DMD-BSR-CODE             PIC X.
  5969*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  5970*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  5971*
  5972*        16  AT-DMD-LETTER-STATUS        PIC X.
  5973*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 113
* EL130.cbl
  5974*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  5975*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  5976*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  5977*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  5978
  5979         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  5980         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  5981
  5982     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  5983         16  AT-ADDRESS-TYPE             PIC X.
  5984             88  INSURED-ADDRESS               VALUE 'I'.
  5985             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  5986             88  ACCOUNT-ADDRESS               VALUE 'A'.
  5987             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  5988             88  EMPLOYER-ADDRESS              VALUE 'E'.
  5989             88  OTHER-ADDRESS-1               VALUE 'O'.
  5990             88  OTHER-ADDRESS-2               VALUE 'Q'.
  5991         16  AT-MAIL-TO-NAME             PIC X(30).
  5992         16  AT-ADDRESS-LINE-1           PIC X(30).
  5993         16  AT-ADDRESS-LINE-2           PIC X(30).
  5994         16  AT-CITY-STATE.
  5995             20  AT-CITY                 PIC X(28).
  5996             20  AT-STATE                PIC XX.
  5997         16  AT-ZIP.
  5998             20  AT-ZIP-CODE.
  5999                 24  AT-ZIP-1ST          PIC X.
  6000                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6001                 24  FILLER              PIC X(4).
  6002             20  AT-ZIP-PLUS4            PIC X(4).
  6003         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6004             20  AT-CAN-POSTAL-1         PIC XXX.
  6005             20  AT-CAN-POSTAL-2         PIC XXX.
  6006             20  FILLER                  PIC XXX.
  6007         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6008*         16  FILLER                      PIC X(23).
  6009         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6010         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6011         16  FILLER                      PIC X(13).
  6012         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6013         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6014
  6015     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6016         16  AT-INFO-LINE-1              PIC X(60).
  6017         16  AT-INFO-LINE-2              PIC X(60).
  6018         16  AT-INFO-TRAILER-TYPE        PIC X.
  6019             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6020             88  AT-CALL-NOTE            VALUE 'C'.
  6021             88  AT-MAINT-NOTE           VALUE 'M'.
  6022             88  AT-CERT-CHANGE          VALUE 'X'.
  6023             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6024             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6025         16  AT-CALL-TYPE                PIC X.
  6026             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6027             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6028         16  AT-NOTE-CONTINUATION        PIC X.
  6029             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6030         16  AT-EOB-CODES-EXIST          PIC X.
  6031             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 114
* EL130.cbl
  6032         16  FILLER                      PIC X(35).
  6033         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6034         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6035
  6036     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6037         16  AT-PROMPT-LINE-1            PIC X(60).
  6038         16  AT-PROMPT-LINE-2            PIC X(60).
  6039         16  AT-PROMPT-START-DT          PIC XX.
  6040         16  AT-PROMPT-END-DT            PIC XX.
  6041         16  FILLER                      PIC X(35).
  6042         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6043         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6044
  6045     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6046         16  AT-DENIAL-INFO-1            PIC X(60).
  6047         16  AT-DENIAL-INFO-2            PIC X(60).
  6048         16  AT-DENIAL-DT                PIC XX.
  6049         16  AT-RETRACTION-DT            PIC XX.
  6050         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6051*         16  FILLER                      PIC X(31).
  6052         16  AT-DENIAL-PROOF-DT          PIC XX.
  6053         16  FILLER                      PIC X(29).
  6054         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6055         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6056
  6057     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6058         16  AT-OLD-INCURRED-DT          PIC XX.
  6059         16  AT-OLD-REPORTED-DT          PIC XX.
  6060         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6061         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6062         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6063         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6064         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6065         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6066         16  FILLER                      PIC X(26).
  6067         16  AT-OLD-DIAG-CODE            PIC X(6).
  6068         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6069         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6070         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6071         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6072         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6073         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6074         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6075         16  FILLER                      PIC X(25).
  6076         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6077
  6078     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6079         16  AT-FORM-SEND-ON-DT          PIC XX.
  6080         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6081         16  AT-FORM-RE-SEND-DT          PIC XX.
  6082         16  AT-FORM-ANSWERED-DT         PIC XX.
  6083         16  AT-FORM-PRINTED-DT          PIC XX.
  6084         16  AT-FORM-REPRINT-DT          PIC XX.
  6085         16  AT-FORM-TYPE                PIC X.
  6086             88  INITIAL-FORM                  VALUE '1'.
  6087             88  PROGRESS-FORM                 VALUE '2'.
  6088         16  AT-INSTRUCT-LN-1            PIC X(28).
  6089         16  AT-INSTRUCT-LN-2            PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 115
* EL130.cbl
  6090         16  AT-INSTRUCT-LN-3            PIC X(28).
  6091         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6092         16  AT-FORM-ADDRESS             PIC X.
  6093             88  FORM-TO-INSURED              VALUE 'I'.
  6094             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6095             88  FORM-TO-OTHER-1              VALUE 'O'.
  6096             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6097         16  AT-RELATED-1.
  6098             20 AT-REL-CARR-1            PIC X.
  6099             20 AT-REL-CLAIM-1           PIC X(7).
  6100             20 AT-REL-CERT-1            PIC X(11).
  6101         16  AT-RELATED-2.
  6102             20 AT-REL-CARR-2            PIC X.
  6103             20 AT-REL-CLAIM-2           PIC X(7).
  6104             20 AT-REL-CERT-2            PIC X(11).
  6105         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6106         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6107         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6108         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6109         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6110         16  AT-STOP-FORM-DT             PIC X(2).
  6111
  6112         16  FILLER                      PIC X(09).
  6113         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6114         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6115******************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 116
* EL130.cbl
  6117*    COPY ELCBENE.
  6118******************************************************************
  6119*                                                                *
  6120*                            ELCBENE.                            *
  6121*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6122*                            VMOD=2.006                          *
  6123*                                                                *
  6124*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6125*                                                                *
  6126*   FILE TYPE = VSAM,KSDS                                        *
  6127*   RECORD SIZE = 500   RECFORM = FIX                            *
  6128*                                                                *
  6129*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6130*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6131*                                                                *
  6132*   LOG = YES                                                    *
  6133*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6134*                                                                *
  6135*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6136******************************************************************
  6137
  6138 01  BENEFICIARY-MASTER.
  6139     12  BE-RECORD-ID                PIC XX.
  6140         88  VALID-BE-ID                VALUE 'BE'.
  6141
  6142     12  BE-CONTROL-PRIMARY.
  6143         16  BE-COMPANY-CD           PIC X.
  6144         16  BE-RECORD-TYPE          PIC X.
  6145             88  BENEFICIARY-RECORD  VALUE 'B'.
  6146             88  ADJUSTOR-RECORD     VALUE 'A'.
  6147         16  BE-BENEFICIARY          PIC X(10).
  6148     12  BE-CONTROL-BY-NAME.
  6149         16  BE-COMPANY-CD-A1        PIC X.
  6150         16  BE-RECORD-TYPE-A1       PIC X.
  6151         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6152         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6153
  6154     12  BE-LAST-MAINT-DT            PIC XX.
  6155     12  BE-LAST-MAINT-BY            PIC X(4).
  6156     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6157
  6158     12  BE-ADDRESS-DATA.
  6159         16  BE-MAIL-TO-NAME         PIC X(30).
  6160         16  BE-ADDRESS-LINE-1       PIC X(30).
  6161         16  BE-ADDRESS-LINE-2       PIC X(30).
  6162         16  BE-ADDRESS-LINE-3       PIC X(30).
  6163         16  BE-CITY-STATE.
  6164             20  BE-CITY             PIC X(28).
  6165             20  BE-STATE            PIC XX.
  6166         16  BE-ZIP-CODE.
  6167             20  BE-ZIP-PRIME.
  6168                 24  BE-ZIP-1ST      PIC X.
  6169                     88  BE-CANADIAN-POST-CODE
  6170                                         VALUE 'A' THRU 'Z'.
  6171                 24  FILLER          PIC X(4).
  6172             20  BE-ZIP-PLUS4        PIC X(4).
  6173         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6174             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 117
* EL130.cbl
  6175             20  BE-CAN-POSTAL-2     PIC XXX.
  6176             20  FILLER              PIC XXX.
  6177         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6178         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6179
  6180******************************************************************
  6181*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6182*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6183******************************************************************
  6184     12  BE-CARRIER                  PIC X.
  6185
  6186     12  BE-ADDRESS-DATA2.
  6187         16  BE-MAIL-TO-NAME2        PIC X(30).
  6188         16  BE-ADDRESS-LINE-12      PIC X(30).
  6189         16  BE-ADDRESS-LINE-22      PIC X(30).
  6190         16  BE-ADDRESS-LINE-32      PIC X(30).
  6191         16  BE-CITY-STATE2.
  6192             20  BE-CITY2            PIC X(28).
  6193             20  BE-STATE2           PIC XX.
  6194         16  BE-ZIP-CODE2.
  6195             20  BE-ZIP-PRIME2.
  6196                 24  BE-ZIP-1ST2     PIC X.
  6197                     88  BE-CANADIAN-POST-CODE2
  6198                                         VALUE 'A' THRU 'Z'.
  6199                 24  FILLER          PIC X(4).
  6200             20  BE-ZIP-PLUS42       PIC X(4).
  6201         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6202             20  BE-CAN-POSTAL-12    PIC XXX.
  6203             20  BE-CAN-POSTAL-22    PIC XXX.
  6204             20  FILLER              PIC XXX.
  6205         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6206         16  BE-BILLING-STMT-DATA.
  6207             20  BE-BSR              PIC X.
  6208                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6209                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6210             20  BE-BSR-FROM         PIC X(30).
  6211             20  BE-BSR-DEPT         PIC X(30).
  6212             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6213             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6214             20  BE-OUTPUT-TYPE      PIC X.
  6215                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6216                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6217
  6218     12  FILLER                      PIC X(28).
  6219******************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 118
* EL130.cbl
  6221*    COPY ELCDAR.
  6222******************************************************************
  6223*                                                                *
  6224*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6225*   FILE TYPE = VSAM,KSDS                                        *
  6226*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6227*   BASE CLUSTER = DLYACTV                                       *
  6228*   LOG = YES                                                    *
  6229*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6230*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6231*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6232*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6233*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6234*               BY PROGRAM "LGINFCE".                            *
  6235*                                                                *
  6236******************************************************************
  6237 01  DAILY-ACTIVITY-RECORD.
  6238     05  DA-KEY.
  6239         10  DA-COMP-CD          PIC X.
  6240         10  DA-CARRIER          PIC X.
  6241         10  DA-CLAIM-NO         PIC X(7).
  6242         10  DA-CERT-NO.
  6243             15  DA-CERT-PRIME   PIC X(10).
  6244             15  DA-CERT-SFX     PIC X.
  6245     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6246     05  DA-RECORD-TYPE          PIC X.
  6247     05  FILLER                  PIC X(2).
  6248******************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 119
* EL130.cbl
  6250*    COPY ELCACTQ.
  6251******************************************************************
  6252*                                                                *
  6253*                            ELCACTQ.                            *
  6254*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6255*                            VMOD=2.004                          *
  6256*                                                                *
  6257*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6258*                                                                *
  6259*   FILE TYPE = VSAM,KSDS                                        *
  6260*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6261*                                                                *
  6262*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6263*       ALTERNATE INDEX = NONE                                   *
  6264*                                                                *
  6265*   LOG = YES                                                    *
  6266*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6267*                                                                *
  6268*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6269******************************************************************
  6270
  6271 01  ACTIVITY-QUE.
  6272     12  AQ-RECORD-ID                PIC XX.
  6273         88  VALID-AQ-ID                VALUE 'AQ'.
  6274
  6275     12  AQ-CONTROL-PRIMARY.
  6276         16  AQ-COMPANY-CD           PIC X.
  6277         16  AQ-CARRIER              PIC X.
  6278         16  AQ-CLAIM-NO             PIC X(7).
  6279         16  AQ-CERT-NO.
  6280             20  AQ-CERT-PRIME       PIC X(10).
  6281             20  AQ-CERT-SFX         PIC X.
  6282
  6283     12  AQ-PENDING-ACTIVITY-FLAGS.
  6284         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6285         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6286             88  PENDING-PAYMENTS       VALUE '1'.
  6287         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6288             88  PENDING-FULL-PRINT     VALUE '1'.
  6289             88  PENDING-PART-PRINT     VALUE '2'.
  6290         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6291             88  PENDING-LETTERS        VALUE '1'.
  6292         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6293             88  PENDING-RESTORE        VALUE 'C'.
  6294             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6295
  6296     12  FILLER                      PIC X(20).
  6297
  6298     12  AQ-RESEND-DATE              PIC XX.
  6299     12  AQ-FOLLOWUP-DATE            PIC XX.
  6300     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6301     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6302     12  AQ-AUTO-LETTER              PIC X(4).
  6303     12  FILLER                      PIC XX.
  6304     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6305*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 120
* EL130.cbl
  6307*    COPY ELCARCH.
  6308******************************************************************
  6309*                                                                *
  6310*                            ELCARCH.                            *
  6311*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6312*                            VMOD=2.007                          *
  6313*                                                                *
  6314*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6315*                                                                *
  6316*   FILE TYPE = VSAM,KSDS                                        *
  6317*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6318*                                                                *
  6319*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6320*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6321*                                                                *
  6322*   LOG = NO                                                     *
  6323*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6324*                                                                *
  6325*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6326******************************************************************
  6327 01  LETTER-ARCHIVE.
  6328     12  LA-RECORD-ID                PIC XX.
  6329         88  VALID-LA-ID                VALUE 'LA'.
  6330
  6331     12  LA-CONTROL-PRIMARY.
  6332         16  LA-COMPANY-CD           PIC X.
  6333         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6334         16  LA-RECORD-TYPE          PIC X.
  6335             88  LA-HEADER-DATA         VALUE '1'.
  6336             88  LA-ADDRESS-DATA        VALUE '2'.
  6337             88  LA-TEXT-DATA           VALUE '3'.
  6338             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6339         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6340
  6341     12  LA-CONTROL-BY-TYPE.
  6342         16  LA-COMPANY-CD-A1        PIC X.
  6343         16  LA-RECORD-TYPE-A1       PIC X.
  6344         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6345         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6346
  6347     12  LA-TEXT-RECORD.
  6348         16  LA-SKIP-CONTROL         PIC XX.
  6349             88  NO-LINES-SKIPPED       VALUE SPACES.
  6350             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6351         16  LA-TEXT-LINE            PIC X(70).
  6352
  6353     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6354         16  FILLER                  PIC XX.
  6355         16  LA-ADDRESS-LINE         PIC X(30).
  6356         16  FILLER                  PIC X(40).
  6357
  6358     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6359         16  FILLER                  PIC XX.
  6360         16  LA-CARRIER              PIC X.
  6361         16  LA-CLAIM-NO             PIC X(7).
  6362         16  LA-CERT-NO.
  6363             20  LA-CERT-PRIME       PIC X(10).
  6364             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 121
* EL130.cbl
  6365         16  LA-NO-OF-COPIES         PIC S9.
  6366         16  LA-RESEND-DATE          PIC XX.
  6367         16  LA-PROCESSOR-CD         PIC X(4).
  6368         16  LA-CREATION-DT          PIC XX.
  6369         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6370         16  LA-RESEND-PRINT-DATE    PIC XX.
  6371         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6372         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6373*
  6374* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6375*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6376*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6377*   I        20  LA-DMD-RES-ST           PIC XX.
  6378*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6379*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6380*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6381*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6382*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6383*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6384*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6385*   I        20  LA-DMD-UND-CODE         PIC XX.
  6386*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6387*   V    16  FILLER                  PIC X(15).
  6388* -----
  6389*
  6390* REINSERTED  CSO  MODS
  6391*
  6392         16  FILLER.
  6393             20  FILLER                  PIC X(29).
  6394             20  LA-CSO-LETTER-STATUS    PIC X.
  6395                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6396                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6397                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6398             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6399             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6400*
  6401
  6402     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6403         16  FILLER                  PIC XX.
  6404         16  LA4-CARRIER             PIC X.
  6405         16  LA4-CLAIM-NO            PIC X(7).
  6406         16  LA4-CERT-NO.
  6407             20  LA4-CERT-PRIME      PIC X(10).
  6408             20  LA4-CERT-SFX        PIC X.
  6409         16  LA4-NO-OF-COPIES        PIC S9.
  6410         16  LA4-RESEND-DATE         PIC XX.
  6411         16  LA4-PROCESSOR-CD        PIC X(4).
  6412         16  LA4-CREATION-DT         PIC XX.
  6413         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6414         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6415         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6416         16  LA4-FORM-TYPE           PIC X.
  6417             88  LA4-INITIAL-FORM    VALUE '1'.
  6418             88  LA4-PROGRESS-FORM   VALUE '2'.
  6419         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6420         16  LA4-STATE               PIC X(02).
  6421         16  FILLER                  PIC X(31).
  6422******************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 122
* EL130.cbl
  6424*    COPY ERCREIN.
  6425******************************************************************
  6426*                                                                *
  6427*                            ERCREIN                             *
  6428*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6429*                            VMOD=2.010                          *
  6430*                                                                *
  6431*   ONLINE CREDIT SYSTEM                                         *
  6432*                                                                *
  6433*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6434*                                                                *
  6435*   FILE TYPE = VSAM,KSDS                                        *
  6436*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6437*                                                                *
  6438*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6439*       ALTERNATE PATH = NONE                                    *
  6440*                                                                *
  6441*   LOG = NO                                                     *
  6442*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6443*                                                                *
  6444******************************************************************
  6445*                   C H A N G E   L O G
  6446*
  6447* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6448*-----------------------------------------------------------------
  6449*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6450* EFFECTIVE    NUMBER
  6451*-----------------------------------------------------------------
  6452* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6453* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6454******************************************************************
  6455 01  REINSURANCE-RECORD.
  6456     12  RE-RECORD-ID                      PIC XX.
  6457         88  VALID-RE-ID                      VALUE 'RE'.
  6458
  6459     12  RE-CONTROL-PRIMARY.
  6460         16  RE-COMPANY-CD                 PIC X.
  6461         16  RE-KEY.
  6462             20  RE-CODE                   PIC X.
  6463                 88  RE-TABLE-RECORD          VALUE 'A'.
  6464                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6465             20  RE-TABLE                  PIC XXX.
  6466             20  FILLER                    PIC XXX.
  6467         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6468             20  FILLER                    PIC X.
  6469             20  RE-COMPANY.
  6470                 24  RE-COMP-PRIME         PIC XXX.
  6471                 24  RE-COMP-SUB           PIC XXX.
  6472
  6473     12  RE-MAINT-INFORMATION.
  6474         16  RE-LAST-MAINT-DT              PIC XX.
  6475         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6476         16  RE-LAST-MAINT-USER            PIC X(4).
  6477         16  FILLER                        PIC X(10).
  6478
  6479     12  RE-TABLE-DATA.
  6480         16  RE-100-COMP                   PIC 99.
  6481
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 123
* EL130.cbl
  6482         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6483             20  RE-REI-COMP-NO.
  6484                 24  RE-REI-COMP           PIC XXX.
  6485                 24  RE-REI-COMP-SUB       PIC XXX.
  6486             20  RE-LF-QC                  PIC X.
  6487             20  RE-AH-QC                  PIC X.
  6488             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6489             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6490             20  RE-LFAGE-LO               PIC 99.
  6491             20  RE-LFAGE-HI               PIC 99.
  6492             20  RE-AHAGE-LO               PIC 99.
  6493             20  RE-AHAGE-HI               PIC 99.
  6494             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6495             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6496             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6497             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6498             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6499             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6500             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6501             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6502             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6503             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6504             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6505             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6506             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6507             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6508             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6509             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6510             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6511             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6512             20  RE-LF-BEN-CODE            PIC X.
  6513             20  RE-AH-BEN-CODE            PIC X.
  6514             20  RE-INTERACTIVE            PIC X.
  6515             20  RE-REMAINING              PIC X.
  6516             20  RE-LF-RUNOFF-SW           PIC X.
  6517             20  RE-AH-RUNOFF-SW           PIC X.
  6518             20  FILLER                    PIC X(19).
  6519
  6520         16  RE-COMP-INFO-END              PIC X(6).
  6521         16  RE-NSP-ST-CD-LF               PIC XX.
  6522         16  RE-NSP-ST-CD-AH               PIC XX.
  6523         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6524             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6525
  6526         16  FILLER                        PIC X(27).
  6527
  6528     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6529         16  RE-NAME                       PIC X(30).
  6530         16  RE-LF-PE                      PIC X.
  6531         16  RE-AH-PE                      PIC X.
  6532         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6533         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6534         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6535         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6536         16  RE-PRT-ST                     PIC X.
  6537         16  RE-PRT-OW                     PIC X.
  6538         16  RE-MORT-CODE                  PIC X(4).
  6539         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 124
* EL130.cbl
  6540         16  RE-ZERO-LF-FEE                PIC X.
  6541         16  RE-ZERO-AH-FEE                PIC X.
  6542         16  RE-CEDE-NAME                  PIC X(30).
  6543         16  RE-LF-COMM                    PIC X.
  6544         16  RE-AH-COMM                    PIC X.
  6545         16  RE-LF-TAX                     PIC X.
  6546         16  RE-AH-TAX                     PIC X.
  6547         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6548         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6549         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6550
  6551         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6552             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6553
  6554         16  RE-LF-CEDING-FEE-BRACKETS.
  6555             20  RE-LF-FEE-METHOD          PIC X.
  6556                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6557                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6558                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6559                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6560             20  RE-LF-FEE-BASIS           PIC X.
  6561                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6562                 88  RE-LF-NET-CEDED               VALUE '2'.
  6563                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6564                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6565                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6566                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6567                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6568                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6569             20  FILLER                    PIC XXX.
  6570             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6571                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6572                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6573
  6574         16  RE-AH-CEDING-FEE-BRACKETS.
  6575             20  RE-AH-FEE-METHOD          PIC X.
  6576                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6577                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6578                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6579                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6580             20  RE-AH-FEE-BASIS           PIC X.
  6581                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6582                 88  RE-AH-NET-CEDED               VALUE '2'.
  6583                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6584                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6585                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6586                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6587                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6588                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6589             20  FILLER                    PIC XXX.
  6590             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6591                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6592                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6593
  6594         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6595
  6596         16  RE-OLD-CEDING-STMT            PIC X.
  6597
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 125
* EL130.cbl
  6598         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6599         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6600         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6601         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6602         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6603         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6604         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6605         16  RE-MORT-SW                    PIC X.
  6606         16  RE-CEDING-TYPE-FLAG           PIC X.
  6607             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6608             88  RE-CEDED                          VALUE 'C'.
  6609             88  RE-ASSUMED                        VALUE 'A'.
  6610             88  RE-PHANTOM                        VALUE 'P'.
  6611
  6612         16  RE-CEDING-STMT-OPT-A          PIC X.
  6613             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6614         16  RE-CEDING-STMT-OPT-B          PIC X.
  6615             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6616         16  RE-CEDING-STMT-OPT-C          PIC X.
  6617             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6618         16  RE-CEDING-STMT-OPT-D          PIC X.
  6619             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6620         16  RE-CEDING-STMT-OPT-E          PIC X.
  6621             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6622
  6623         16  RE-PRT-CRSV                   PIC X.
  6624
  6625         16  RE-GL-CENTER                  PIC X(4).
  6626
  6627         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6628
  6629         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6630
  6631         16  RE-EARN-STOP-CODE             PIC X.
  6632             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6633             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6634
  6635         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6636             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6637
  6638         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6639         16  FILLER                        PIC X(2281).
  6640
  6641         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6642
  6643******************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 126
* EL130.cbl
  6645*    COPY ERCMAIL.
  6646******************************************************************
  6647*                                                                *
  6648*                                                                *
  6649*                            ERCMAIL                             *
  6650*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6651*                            VMOD=2.003                          *
  6652*                                                                *
  6653*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6654*                                                                *
  6655*   FILE TYPE = VSAM,KSDS                                        *
  6656*   RECORD SIZE = 374   RECFORM = FIX                            *
  6657*                                                                *
  6658*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6659*   ALTERNATE PATH    = NOT USED                                 *
  6660*                                                                *
  6661*   LOG = YES                                                    *
  6662*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6663******************************************************************
  6664*                   C H A N G E   L O G
  6665*
  6666* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6667*-----------------------------------------------------------------
  6668*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6669* EFFECTIVE    NUMBER
  6670*-----------------------------------------------------------------
  6671* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6672* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6673* 111108                   PEMA  ADD CRED BENE ADDR2
  6674******************************************************************
  6675
  6676 01  MAILING-DATA.
  6677     12  MA-RECORD-ID                      PIC XX.
  6678         88  VALID-MA-ID                       VALUE 'MA'.
  6679
  6680     12  MA-CONTROL-PRIMARY.
  6681         16  MA-COMPANY-CD                 PIC X.
  6682         16  MA-CARRIER                    PIC X.
  6683         16  MA-GROUPING.
  6684             20  MA-GROUPING-PREFIX        PIC XXX.
  6685             20  MA-GROUPING-PRIME         PIC XXX.
  6686         16  MA-STATE                      PIC XX.
  6687         16  MA-ACCOUNT.
  6688             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6689             20  MA-ACCOUNT-PRIME          PIC X(6).
  6690         16  MA-CERT-EFF-DT                PIC XX.
  6691         16  MA-CERT-NO.
  6692             20  MA-CERT-PRIME             PIC X(10).
  6693             20  MA-CERT-SFX               PIC X.
  6694
  6695     12  FILLER                            PIC XX.
  6696
  6697     12  MA-ACCESS-CONTROL.
  6698         16  MA-SOURCE-SYSTEM              PIC XX.
  6699             88  MA-FROM-CREDIT                VALUE 'CR'.
  6700             88  MA-FROM-VSI                   VALUE 'VS'.
  6701             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6702             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 127
* EL130.cbl
  6703         16  MA-RECORD-ADD-DT              PIC XX.
  6704         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6705         16  MA-LAST-MAINT-DT              PIC XX.
  6706         16  MA-LAST-MAINT-BY              PIC XXXX.
  6707         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6708
  6709     12  MA-PROFILE-INFO.
  6710         16  MA-QUALIFY-CODE-1             PIC XX.
  6711         16  MA-QUALIFY-CODE-2             PIC XX.
  6712         16  MA-QUALIFY-CODE-3             PIC XX.
  6713         16  MA-QUALIFY-CODE-4             PIC XX.
  6714         16  MA-QUALIFY-CODE-5             PIC XX.
  6715
  6716         16  MA-INSURED-LAST-NAME          PIC X(15).
  6717         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6718         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6719         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6720         16  MA-INSURED-BIRTH-DT           PIC XX.
  6721         16  MA-INSURED-SEX                PIC X.
  6722             88  MA-SEX-MALE                   VALUE 'M'.
  6723             88  MA-SEX-FEMALE                 VALUE 'F'.
  6724         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6725
  6726         16  MA-ADDRESS-CORRECTED          PIC X.
  6727         16  MA-JOINT-BIRTH-DT             PIC XX.
  6728*        16  FILLER                        PIC X(12).
  6729
  6730         16  MA-ADDRESS-LINE-1             PIC X(30).
  6731         16  MA-ADDRESS-LINE-2             PIC X(30).
  6732         16  MA-CITY-STATE.
  6733             20  MA-CITY                   PIC X(28).
  6734             20  MA-ADDR-STATE             PIC XX.
  6735         16  MA-ZIP.
  6736             20  MA-ZIP-CODE.
  6737                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6738                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6739                 24  FILLER                PIC X(4).
  6740             20  MA-ZIP-PLUS4              PIC X(4).
  6741         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6742             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6743             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6744             20  FILLER                    PIC X(3).
  6745
  6746         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6747
  6748         16  FILLER                        PIC XXX.
  6749*        16  FILLER                        PIC X(10).
  6750
  6751     12  MA-CRED-BENE-INFO.
  6752         16  MA-CRED-BENE-NAME                 PIC X(25).
  6753         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6754         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6755         16  MA-CRED-BENE-CTYST.
  6756             20  MA-CRED-BENE-CITY             PIC X(28).
  6757             20  MA-CRED-BENE-STATE            PIC XX.
  6758         16  MA-CRED-BENE-ZIP.
  6759             20  MA-CB-ZIP-CODE.
  6760                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 128
* EL130.cbl
  6761                     88  MA-CB-CANADIAN-POST-CODE
  6762                                           VALUE 'A' THRU 'Z'.
  6763                 24  FILLER                    PIC X(4).
  6764             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6765         16  MA-CB-CANADIAN-POSTAL-CODE
  6766                            REDEFINES MA-CRED-BENE-ZIP.
  6767             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6768             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6769             20  FILLER                        PIC X(3).
  6770     12  MA-POST-CARD-MAIL-DATA.
  6771         16  MA-MAIL-DATA OCCURS 7.
  6772             20  MA-MAIL-TYPE              PIC X.
  6773                 88  MA-12MO-MAILING           VALUE '1'.
  6774                 88  MA-EXP-MAILING            VALUE '2'.
  6775             20  MA-MAIL-STATUS            PIC X.
  6776                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6777                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6778                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6779             20  MA-MAIL-DATE              PIC XX.
  6780     12  FILLER                            PIC XX.
  6781     12  FILLER                            PIC XX.
  6782*    12  FILLER                            PIC X(30).
  6783******************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 129
* EL130.cbl
  6785*    COPY ELCCRTT.
  6786******************************************************************
  6787*                                                                *
  6788*                            ELCCRTT.                            *
  6789*                                                                *
  6790*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  6791*                                                                *
  6792*   FILE TYPE = VSAM,KSDS                                        *
  6793*   RECORD SIZE = 552  RECFORM = FIXED                           *
  6794*                                                                *
  6795*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  6796*                                                                *
  6797*   LOG = YES                                                    *
  6798*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6799******************************************************************
  6800*                   C H A N G E   L O G
  6801*
  6802* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6803*-----------------------------------------------------------------
  6804*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6805* EFFECTIVE    NUMBER
  6806*-----------------------------------------------------------------
  6807* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  6808* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  6809* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  6810* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  6811******************************************************************
  6812
  6813 01  CERTIFICATE-TRAILERS.
  6814     12  CS-RECORD-ID                      PIC XX.
  6815         88  VALID-CS-ID                      VALUE 'CS'.
  6816
  6817     12  CS-CONTROL-PRIMARY.
  6818         16  CS-COMPANY-CD                 PIC X.
  6819         16  CS-CARRIER                    PIC X.
  6820         16  CS-GROUPING                   PIC X(6).
  6821         16  CS-STATE                      PIC XX.
  6822         16  CS-ACCOUNT                    PIC X(10).
  6823         16  CS-CERT-EFF-DT                PIC XX.
  6824         16  CS-CERT-NO.
  6825             20  CS-CERT-PRIME             PIC X(10).
  6826             20  CS-CERT-SFX               PIC X.
  6827         16  CS-TRAILER-TYPE               PIC X.
  6828             88  COMM-TRLR           VALUE 'A'.
  6829             88  FUTURE-TRLR         VALUE 'B'.
  6830             88  CERT-DATA-TRLR      VALUE 'C'.
  6831
  6832     12  CS-DATA-AREA                      PIC X(516).
  6833
  6834     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  6835         16  CS-BANK-COMMISSION-AREA.
  6836             20  CS-BANK-COMMS       OCCURS 10.
  6837                 24  CS-AGT                PIC X(10).
  6838                 24  CS-COM-TYP            PIC X.
  6839                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  6840                 24  CS-RECALC-LV-INDIC    PIC X.
  6841                 24  FILLER                PIC X(10).
  6842         16  FILLER                        PIC X(256).
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 130
* EL130.cbl
  6843
  6844     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  6845         16  CS-VIN-NUMBER                 PIC X(17).
  6846         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  6847         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  6848         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  6849         16  FILLER                        PIC X(496).
  6850******************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 131
* EL130.cbl
  6852
  6853 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  6854                          CONTROL-FILE CERTIFICATE-MASTER
  6855                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  6856                          BENEFICIARY-MASTER
  6857                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  6858                          LETTER-ARCHIVE REINSURANCE-RECORD
  6859                          MAILING-DATA CERTIFICATE-TRAILERS.
  6860 0000-DFHEXIT SECTION.
  6861     MOVE '9#                    $   ' TO DFHEIV0.
  6862     MOVE 'EL130' TO DFHEIV1.
  6863     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6864     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6865     MOVE '5'                    TO DC-OPTION-CODE.
  6866     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  6867     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  6868     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  6869
  6870     IF EIBCALEN = ZERO
  6871         GO TO 8800-UNAUTHORIZED-ACCESS
  6872     END-IF.
  6873
  6874     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  6875     MOVE EIBTRMID               TO QID-TERM.
  6876     MOVE +2                     TO EMI-NUMBER-OF-LINES.
  6877     MOVE '2'                    TO EMI-SWITCH2.
  6878     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  6879     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  6880
  6881
  6882
  6883* EXEC CICS HANDLE CONDITION
  6884*        QIDERR     (0100-TEST-ENTRY)
  6885*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  6886*        PGMIDERR   (9600-PGMID-ERROR)
  6887*        TERMIDERR  (8820-TERM-ERROR)
  6888*        TRANSIDERR (8830-TRAN-ERROR)
  6889*        ERROR      (9990-ABEND)
  6890*    END-EXEC.
  6891*    MOVE '"$N?L[\.              ! " #00006878' TO DFHEIV0
  6892     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  6893     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6894     MOVE X'2220233030303036383738' TO DFHEIV0(25:11)
  6895     CALL 'kxdfhei1' USING DFHEIV0
  6896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6897
  6898
  6899     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  6900        PI-CALLING-PROGRAM   = XCTL-6592
  6901         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  6902     ELSE
  6903         MOVE SPACES             TO RETURNED-FROM
  6904     END-IF.
  6905
  6906     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6907         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6908             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6909             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 132
* EL130.cbl
  6910             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6911             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6912             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6913             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6914             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6915             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  6916         ELSE
  6917             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  6918             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  6919             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  6920             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  6921             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  6922             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  6923             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  6924             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  6925         END-IF
  6926     END-IF.
  6927
  6928     IF EIBTRNID = TRANS-ID
  6929         IF EIBAID = DFHCLEAR
  6930             GO TO 9400-CLEAR
  6931         ELSE
  6932             GO TO 0200-RECEIVE
  6933         END-IF
  6934     END-IF.
  6935
  6936     IF RETURNED-FROM NOT = SPACES
  6937         GO TO 0600-RECOVER-TEMP-STORAGE
  6938     END-IF.
  6939
  6940     MOVE LOW-VALUES TO EL130AO.
  6941
  6942
  6943
  6944* EXEC CICS DELETEQ TS
  6945*         QUEUE   (QID)
  6946*    END-EXEC.
  6947*    MOVE '*&                    #   #00006931' TO DFHEIV0
  6948     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  6949     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6950     MOVE X'2020233030303036393331' TO DFHEIV0(25:11)
  6951     CALL 'kxdfhei1' USING DFHEIV0,
  6952           QID,
  6953           DFHEIV99
  6954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6955
  6956
  6957 0100-TEST-ENTRY.
  6958     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  6959         GO TO 0650-FROM-EL127
  6960     ELSE
  6961         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  6962                                    PI-CERT-PROCESSED
  6963                                    PI-LETTER-ERROR-CODE
  6964     END-IF.
  6965
  6966     IF PI-RETURN-TO-PROGRAM = XCTL-132
  6967         GO TO 0640-FROM-EL132
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 133
* EL130.cbl
  6968     END-IF.
  6969
  6970     GO TO 8100-SEND-INITIAL-MAP.
  6971
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 134
* EL130.cbl
  6973 0200-RECEIVE.
  6974     MOVE LOW-VALUES             TO EL130AI.
  6975
  6976     IF PI-PROCESSOR-ID = 'LGXX'
  6977*        NEXT SENTENCE
  6978         CONTINUE
  6979     ELSE
  6980
  6981* EXEC CICS READQ TS
  6982*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6983*            INTO    (SECURITY-CONTROL)
  6984*            LENGTH  (SC-COMM-LENGTH)
  6985*            ITEM    (SC-ITEM)
  6986*        END-EXEC
  6987*    MOVE '*$II   L              ''   #00006958' TO DFHEIV0
  6988     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6989     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6990     MOVE X'2020233030303036393538' TO DFHEIV0(25:11)
  6991     CALL 'kxdfhei1' USING DFHEIV0,
  6992           PI-SECURITY-TEMP-STORE-ID,
  6993           SECURITY-CONTROL,
  6994           SC-COMM-LENGTH,
  6995           SC-ITEM,
  6996           DFHEIV99,
  6997           DFHEIV99
  6998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6999         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  7000         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  7001         IF NOT DISPLAY-CAP
  7002             MOVE 'READ'              TO  SM-READ
  7003             PERFORM 9995-SECURITY-VIOLATION
  7004             MOVE ER-0070             TO  EMI-ERROR
  7005             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7006             GO TO 8100-SEND-INITIAL-MAP
  7007         END-IF
  7008     END-IF.
  7009
  7010     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7011         MOVE ER-7008 TO EMI-ERROR
  7012         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7013         MOVE -1 TO MAINTL
  7014         GO TO 8200-SEND-DATAONLY
  7015     END-IF.
  7016
  7017
  7018
  7019* EXEC CICS RECEIVE
  7020*         MAP     (MAP-NAME)
  7021*         MAPSET  (MAPSET-NAME)
  7022*         INTO    (EL130AI)
  7023*    END-EXEC.
  7024     MOVE LENGTH OF
  7025      EL130AI
  7026       TO DFHEIV11
  7027*    MOVE '8"T I  L              ''   #00006983' TO DFHEIV0
  7028     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7029     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7030     MOVE X'2020233030303036393833' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 135
* EL130.cbl
  7031     CALL 'kxdfhei1' USING DFHEIV0,
  7032           MAP-NAME,
  7033           EL130AI,
  7034           DFHEIV11,
  7035           MAPSET-NAME,
  7036           DFHEIV99,
  7037           DFHEIV99
  7038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7039
  7040
  7041     IF NOT PI-NO-CARRIER-SECURITY
  7042        MOVE +1                  TO CLMCARRL
  7043        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7044     END-IF.
  7045
  7046     IF ENTERPFL = ZERO
  7047         GO TO 0300-CHECK-PFKEYS
  7048     END-IF.
  7049
  7050     IF EIBAID NOT = DFHENTER
  7051         MOVE ER-0004            TO EMI-ERROR
  7052         GO TO 0320-INPUT-ERROR
  7053     END-IF.
  7054
  7055     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7056         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7057     ELSE
  7058         MOVE ER-0029            TO EMI-ERROR
  7059         GO TO 0320-INPUT-ERROR
  7060     END-IF.
  7061
  7062 0300-CHECK-PFKEYS.
  7063     IF EIBAID = DFHPF23
  7064         GO TO 8810-PF23
  7065     END-IF.
  7066
  7067     IF EIBAID = DFHPF24
  7068         GO TO 9200-RETURN-MAIN-MENU
  7069     END-IF.
  7070
  7071     IF EIBAID = DFHPF12
  7072         GO TO 9500-PF12
  7073     END-IF.
  7074
  7075     IF EIBAID = DFHPF3
  7076         MOVE SPACES              TO MAINTI
  7077         MOVE ZEROS               TO MAINTL
  7078         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7079         MOVE XCTL-127            TO PGM-NAME
  7080         GO TO 9300-XCTL
  7081     END-IF.
  7082
  7083     IF EIBAID = DFHPF4
  7084         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7085         MOVE XCTL-132            TO PGM-NAME
  7086         GO TO 9300-XCTL
  7087     END-IF.
  7088
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 136
* EL130.cbl
  7089     IF EIBAID = DFHPF13
  7090         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7091             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7092             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7093             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7094             MOVE PI-STATE            TO  PI-CR-STATE
  7095             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7096             MOVE XCTL-650            TO  PGM-NAME
  7097             GO TO 9300-XCTL
  7098         ELSE
  7099             MOVE -1                  TO  ENTERPFL
  7100             MOVE ER-2566             TO  EMI-ERROR
  7101             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7102             GO TO 8100-SEND-INITIAL-MAP
  7103         END-IF
  7104     END-IF.
  7105
  7106     IF EIBAID = DFHPF5
  7107         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7108             ADD +1 TO PI-CERT-PROCESSED
  7109             GO TO 0650-FROM-EL127
  7110         ELSE
  7111             MOVE ER-7686         TO EMI-ERROR
  7112             GO TO 0320-INPUT-ERROR
  7113         END-IF
  7114     END-IF.
  7115
  7116     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7117         GO TO 0800-TEST-PREVIOUS-CONTROL
  7118     END-IF.
  7119
  7120     IF PI-HAS-CLAS-IC-CRDTCRD
  7121         IF EIBAID = DFHPF10
  7122             MOVE XCTL-725          TO PGM-NAME
  7123             GO TO 9300-XCTL
  7124         END-IF
  7125     END-IF.
  7126
  7127     IF EIBAID = DFHPF14
  7128         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7129         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7130         MOVE XCTL-659            TO PGM-NAME
  7131         GO TO 9300-XCTL
  7132     END-IF.
  7133
  7134     IF EIBAID = DFHPF15
  7135         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7136         MOVE XCTL-114            TO PGM-NAME
  7137         GO TO 9300-XCTL
  7138     END-IF.
  7139
  7140     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7141         GO TO 0330-EDIT-DATA
  7142     END-IF.
  7143
  7144     MOVE ER-0029                TO EMI-ERROR.
  7145
  7146 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 137
* EL130.cbl
  7147     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7148
  7149     MOVE AL-UNBON               TO ENTERPFA.
  7150
  7151     IF ENTERPFL = ZERO
  7152         MOVE -1                 TO MAINTL
  7153     ELSE
  7154         MOVE -1                 TO ENTERPFL
  7155     END-IF.
  7156
  7157     GO TO 8200-SEND-DATAONLY.
  7158
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 138
* EL130.cbl
  7160 0330-EDIT-DATA.
  7161
  7162     IF MAINTI = 'S'
  7163         IF PRTOPTL GREATER THAN 0
  7164             IF PRTOPTI NOT = 'N' AND 'L'
  7165                 MOVE AL-UABON   TO  PRTOPTA
  7166                 MOVE -1         TO  PRTOPTL
  7167                 MOVE ER-0334    TO  EMI-ERROR
  7168                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7169                 GO TO 8200-SEND-DATAONLY
  7170             ELSE
  7171                 IF PRTOPTI = 'L'
  7172                     GO TO 0400-CREATE-ELACTQ
  7173                 ELSE
  7174                     GO TO 0480-PRINT-NOW
  7175                 END-IF
  7176             END-IF
  7177         ELSE
  7178             GO TO 1000-SHOW-CLAIM
  7179         END-IF
  7180     END-IF.
  7181
  7182     IF NOT MODIFY-CAP
  7183         MOVE 'UPDATE'       TO  SM-READ
  7184         PERFORM 9995-SECURITY-VIOLATION
  7185         MOVE ER-0070        TO  EMI-ERROR
  7186         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7187         GO TO 8100-SEND-INITIAL-MAP
  7188     END-IF.
  7189
  7190     IF MAINTI = 'D'
  7191         GO TO 2000-DELETE-CLAIM
  7192     END-IF.
  7193
  7194     IF MAINTI = 'A'
  7195         GO TO 3000-ADD-CLAIM
  7196     END-IF.
  7197
  7198     IF MAINTI = 'I'
  7199         GO TO 5000-INCURRED-CHANGE
  7200     END-IF.
  7201
  7202     MOVE ER-0023                TO EMI-ERROR.
  7203     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7204     MOVE -1                     TO MAINTL.
  7205     MOVE AL-UABON               TO MAINTA.
  7206
  7207     GO TO 8200-SEND-DATAONLY.
  7208
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 139
* EL130.cbl
  7210 0400-CREATE-ELACTQ.
  7211     IF CLMNOI   = PI-LAST-CLAIM      AND
  7212        CLMCARRI = PI-LAST-CARR       AND
  7213        CERTNOI  = PI-LAST-CERT-PRIME AND
  7214        SUFXI    = PI-LAST-CERT-SUFX
  7215         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7216         MOVE PI-LAST-CARR       TO PI-CARRIER
  7217         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7218     ELSE
  7219         MOVE ER-0207            TO EMI-ERROR
  7220         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7221         MOVE -1                 TO MAINTL
  7222         GO TO 8200-SEND-DATAONLY
  7223     END-IF.
  7224
  7225     IF (NOT PI-NO-CARRIER-SECURITY OR
  7226         NOT PI-NO-ACCOUNT-SECURITY)
  7227         MOVE AL-UABON      TO  PRTOPTA
  7228         MOVE -1            TO  PRTOPTL
  7229         MOVE ER-2378       TO  EMI-ERROR
  7230         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7231         GO TO 8200-SEND-DATAONLY
  7232     END-IF.
  7233
  7234     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7235     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7236     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7237     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7238
  7239
  7240
  7241* EXEC CICS HANDLE CONDITION
  7242*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7243*    END-EXEC.
  7244*    MOVE '"$I                   ! # #00007188' TO DFHEIV0
  7245     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7246     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7247     MOVE X'2320233030303037313838' TO DFHEIV0(25:11)
  7248     CALL 'kxdfhei1' USING DFHEIV0
  7249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7250
  7251
  7252
  7253
  7254* EXEC CICS READ
  7255*         UPDATE
  7256*         DATASET    (ELACTQ-DSID)
  7257*         SET        (ADDRESS OF ACTIVITY-QUE)
  7258*         RIDFLD     (ELACTQ-KEY)
  7259*    END-EXEC.
  7260*    MOVE '&"S        EU         (   #00007193' TO DFHEIV0
  7261     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7262     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7263     MOVE X'2020233030303037313933' TO DFHEIV0(25:11)
  7264     CALL 'kxdfhei1' USING DFHEIV0,
  7265           ELACTQ-DSID,
  7266           DFHEIV20,
  7267           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 140
* EL130.cbl
  7268           ELACTQ-KEY,
  7269           DFHEIV99,
  7270           DFHEIV99,
  7271           DFHEIV99
  7272     SET ADDRESS OF ACTIVITY-QUE TO
  7273         DFHEIV20
  7274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7275
  7276
  7277     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7278     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7279
  7280
  7281
  7282* EXEC CICS REWRITE
  7283*         DATASET     (ELACTQ-DSID)
  7284*         FROM        (ACTIVITY-QUE)
  7285*    END-EXEC.
  7286     MOVE LENGTH OF
  7287      ACTIVITY-QUE
  7288       TO DFHEIV11
  7289*    MOVE '&& L                  %   #00007204' TO DFHEIV0
  7290     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7291     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7292     MOVE X'2020233030303037323034' TO DFHEIV0(25:11)
  7293     CALL 'kxdfhei1' USING DFHEIV0,
  7294           ELACTQ-DSID,
  7295           ACTIVITY-QUE,
  7296           DFHEIV11,
  7297           DFHEIV99
  7298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7299
  7300
  7301     GO TO 0470-STATUS-FINISH.
  7302
  7303 0450-ADD-ELACTQ-RECORD.
  7304
  7305
  7306* EXEC CICS GETMAIN
  7307*        SET     (ADDRESS OF ACTIVITY-QUE)
  7308*        LENGTH  (ELACTQ-LENGTH)
  7309*        INITIMG (GETMAIN-SPACE)
  7310*    END-EXEC.
  7311*    MOVE ',"IL                  $   #00007213' TO DFHEIV0
  7312     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7313     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7314     MOVE X'2020233030303037323133' TO DFHEIV0(25:11)
  7315     CALL 'kxdfhei1' USING DFHEIV0,
  7316           DFHEIV20,
  7317           ELACTQ-LENGTH,
  7318           GETMAIN-SPACE
  7319     SET ADDRESS OF ACTIVITY-QUE TO
  7320         DFHEIV20
  7321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7322
  7323
  7324     MOVE 'AQ'              TO AQ-RECORD-ID.
  7325     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 141
* EL130.cbl
  7326     MOVE +0                TO AQ-PAYMENT-COUNTER
  7327                               AQ-PMT-UNAPPROVED-COUNT.
  7328     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7329                               AQ-FOLLOWUP-DATE.
  7330     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7331     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7332
  7333
  7334
  7335* EXEC CICS WRITE
  7336*         DATASET     (ELACTQ-DSID)
  7337*         FROM        (ACTIVITY-QUE)
  7338*         RIDFLD      (ELACTQ-KEY)
  7339*    END-EXEC.
  7340     MOVE LENGTH OF
  7341      ACTIVITY-QUE
  7342       TO DFHEIV11
  7343*    MOVE '&$ L                  ''   #00007229' TO DFHEIV0
  7344     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7345     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7346     MOVE X'2020233030303037323239' TO DFHEIV0(25:11)
  7347     CALL 'kxdfhei1' USING DFHEIV0,
  7348           ELACTQ-DSID,
  7349           ACTIVITY-QUE,
  7350           DFHEIV11,
  7351           ELACTQ-KEY,
  7352           DFHEIV99,
  7353           DFHEIV99
  7354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7355
  7356
  7357 0470-STATUS-FINISH.
  7358     MOVE AL-UANOF               TO  PRTOPTA
  7359                                     ALTPRTA.
  7360
  7361     MOVE SPACES                 TO  PRTOPTO
  7362                                     ALTPRTO.
  7363
  7364     MOVE ER-0000                TO EMI-ERROR.
  7365     MOVE -1                     TO MAINTL.
  7366     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7367     GO TO 8100-SEND-INITIAL-MAP.
  7368
  7369 0480-PRINT-NOW.
  7370
  7371
  7372* EXEC CICS HANDLE CONDITION
  7373*        TERMIDERR   (8820-TERM-ERROR)
  7374*        TRANSIDERR  (8830-TRAN-ERROR)
  7375*    END-EXEC.
  7376*    MOVE '"$[\                  ! $ #00007249' TO DFHEIV0
  7377     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7378     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7379     MOVE X'2420233030303037323439' TO DFHEIV0(25:11)
  7380     CALL 'kxdfhei1' USING DFHEIV0
  7381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7382
  7383
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 142
* EL130.cbl
  7384     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7385     MOVE '1'                    TO  CNTL-REC-TYPE.
  7386     MOVE SPACES                 TO  CNTL-ACCESS.
  7387     MOVE +0                     TO  CNTL-SEQ-NO.
  7388     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7389
  7390     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7391
  7392     IF CF-FORMS-PRINTER-ID = SPACES
  7393         IF ALTPRTL NOT GREATER THAN 0
  7394             MOVE ER-0337        TO  EMI-ERROR
  7395             MOVE -1             TO  ALTPRTL
  7396             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7397             GO TO 8200-SEND-DATAONLY
  7398         END-IF
  7399     END-IF.
  7400
  7401     IF ALTPRTL GREATER THAN 0
  7402         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7403     END-IF.
  7404
  7405     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7406     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7407     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7408
  7409
  7410
  7411* EXEC CICS START
  7412*        TRANSID   (START-TRANS-ID)
  7413*        TERMID    (CF-FORMS-PRINTER-ID)
  7414*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7415*        LENGTH    (PI-COMM-LENGTH)
  7416*    END-EXEC.
  7417*    MOVE '0( LFT                1   #00007280' TO DFHEIV0
  7418     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7419     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7420     MOVE X'2020233030303037323830' TO DFHEIV0(25:11)
  7421     CALL 'kxdfhei1' USING DFHEIV0,
  7422           DFHEIV99,
  7423           START-TRANS-ID,
  7424           DFHEIV99,
  7425           PROGRAM-INTERFACE-BLOCK,
  7426           PI-COMM-LENGTH,
  7427           CF-FORMS-PRINTER-ID,
  7428           DFHEIV99,
  7429           DFHEIV99,
  7430           DFHEIV99,
  7431           DFHEIV99,
  7432           DFHEIV99,
  7433           DFHEIV99,
  7434           DFHEIV99,
  7435           DFHEIV99,
  7436           DFHEIV99,
  7437           DFHEIV99
  7438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7439
  7440
  7441     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 143
* EL130.cbl
  7442                                     ALTPRTA.
  7443
  7444     MOVE SPACES                 TO  PRTOPTO
  7445                                     ALTPRTO.
  7446
  7447     MOVE ER-0000                TO  EMI-ERROR.
  7448     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7449     MOVE -1                     TO  MAINTL.
  7450     GO TO 8100-SEND-INITIAL-MAP.
  7451
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 144
* EL130.cbl
  7453 0500-CREATE-TEMP-STORAGE.
  7454     MOVE EIBCPOSN               TO PI-CURSOR.
  7455
  7456
  7457
  7458* EXEC CICS WRITEQ TS
  7459*        QUEUE   (QID)
  7460*        FROM    (EL130AI)
  7461*        LENGTH  (QID-MAP-LENGTH)
  7462*    END-EXEC.
  7463*    MOVE '*"                    ''   #00007303' TO DFHEIV0
  7464     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7465     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7466     MOVE X'2020233030303037333033' TO DFHEIV0(25:11)
  7467     CALL 'kxdfhei1' USING DFHEIV0,
  7468           QID,
  7469           EL130AI,
  7470           QID-MAP-LENGTH,
  7471           DFHEIV99,
  7472           DFHEIV99,
  7473           DFHEIV99
  7474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7475
  7476
  7477
  7478
  7479* EXEC CICS WRITEQ TS
  7480*        QUEUE    (QID)
  7481*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7482*        LENGTH   (PI-COMM-LENGTH)
  7483*    END-EXEC.
  7484*    MOVE '*"                    ''   #00007310' TO DFHEIV0
  7485     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7486     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7487     MOVE X'2020233030303037333130' TO DFHEIV0(25:11)
  7488     CALL 'kxdfhei1' USING DFHEIV0,
  7489           QID,
  7490           PROGRAM-INTERFACE-BLOCK,
  7491           PI-COMM-LENGTH,
  7492           DFHEIV99,
  7493           DFHEIV99,
  7494           DFHEIV99
  7495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7496
  7497
  7498 0599-EXIT.
  7499      EXIT.
  7500
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 145
* EL130.cbl
  7502 0600-RECOVER-TEMP-STORAGE.
  7503     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7504     MOVE PI-EL127-TO-EL130-CNTRL
  7505                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7506     MOVE PI-EL659-TO-EL130-CNTRL
  7507                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7508     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7509     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7510     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7511     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7512     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7513     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7514     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7515     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7516     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7517     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7518     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7519     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7520     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7521     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7522     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7523     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7524                                 TO SAVE-BENEFICIARY
  7525
  7526
  7527
  7528* EXEC CICS HANDLE CONDITION
  7529*        NOTFND  (0660-NOT-FOUND)
  7530*        QIDERR  (0670-QIDERR)
  7531*    END-EXEC.
  7532*    MOVE '"$IN                  ! % #00007345' TO DFHEIV0
  7533     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7534     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7535     MOVE X'2520233030303037333435' TO DFHEIV0(25:11)
  7536     CALL 'kxdfhei1' USING DFHEIV0
  7537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7538
  7539
  7540
  7541
  7542* EXEC CICS READQ TS
  7543*        QUEUE    (QID)
  7544*        INTO     (EL130AI)
  7545*        LENGTH   (QID-MAP-LENGTH)
  7546*    END-EXEC.
  7547*    MOVE '*$I    L              ''   #00007351' TO DFHEIV0
  7548     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7549     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7550     MOVE X'2020233030303037333531' TO DFHEIV0(25:11)
  7551     CALL 'kxdfhei1' USING DFHEIV0,
  7552           QID,
  7553           EL130AI,
  7554           QID-MAP-LENGTH,
  7555           DFHEIV99,
  7556           DFHEIV99,
  7557           DFHEIV99
  7558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7559
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 146
* EL130.cbl
  7560
  7561     IF RETURNED-FROM = XCTL-131
  7562        IF CLAIM-DELETED-BY-EL131
  7563            MOVE LOW-VALUES      TO CERTNOI
  7564                                    SUFXI
  7565            MOVE ZEROS           TO CERTNOL
  7566                                    SUFXL
  7567         END-IF
  7568     END-IF.
  7569
  7570     IF RETURNED-FROM = XCTL-131
  7571         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7572         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7573                                    PI-CERT-PROCESSED
  7574     ELSE
  7575
  7576
  7577* EXEC CICS READQ TS
  7578*             QUEUE   (QID)
  7579*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7580*             LENGTH  (PI-COMM-LENGTH)
  7581*        END-EXEC
  7582*    MOVE '*$I    L              ''   #00007372' TO DFHEIV0
  7583     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7584     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7585     MOVE X'2020233030303037333732' TO DFHEIV0(25:11)
  7586     CALL 'kxdfhei1' USING DFHEIV0,
  7587           QID,
  7588           PROGRAM-INTERFACE-BLOCK,
  7589           PI-COMM-LENGTH,
  7590           DFHEIV99,
  7591           DFHEIV99,
  7592           DFHEIV99
  7593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7594     END-IF.
  7595
  7596
  7597* EXEC CICS DELETEQ TS
  7598*        QUEUE   (QID)
  7599*    END-EXEC.
  7600*    MOVE '*&                    #   #00007379' TO DFHEIV0
  7601     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7602     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7603     MOVE X'2020233030303037333739' TO DFHEIV0(25:11)
  7604     CALL 'kxdfhei1' USING DFHEIV0,
  7605           QID,
  7606           DFHEIV99
  7607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7608
  7609
  7610     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7611
  7612     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7613         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7614         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7615         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7616         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7617         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 147
* EL130.cbl
  7618         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7619         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7620         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7621         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7622         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7623         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7624         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7625         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7626         MOVE SAVE-CERT-ACCESS-CONTROL
  7627                                    TO PI-CERT-ACCESS-CONTROL
  7628         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7629                                    TO PI-CARRIER-CONTROL-LEVEL
  7630     END-IF.
  7631
  7632     IF RETURNED-FROM = XCTL-127
  7633         MOVE SAVE-EL127-TO-EL130-CNTRL
  7634                                 TO PI-EL127-TO-EL130-CNTRL
  7635     END-IF.
  7636
  7637     IF RETURNED-FROM = XCTL-6592
  7638        MOVE SAVE-EL659-TO-EL130-CNTRL
  7639                                 TO PI-EL659-TO-EL130-CNTRL
  7640     END-IF.
  7641
  7642     IF RETURNED-FROM = XCTL-114
  7643        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  7644           MOVE SAVE-BENEFICIARY TO BENECDI
  7645           MOVE +10              TO BENECDL
  7646           MOVE -1               TO BIRTHDTL
  7647        END-IF
  7648     END-IF.
  7649     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  7650
  7651     IF MAINTL NOT = ZERO
  7652         MOVE AL-UANON           TO MAINTA
  7653     END-IF.
  7654
  7655     IF ENTERPFL NOT = ZERO
  7656         MOVE AL-UNNON           TO ENTERPFA
  7657     END-IF.
  7658
  7659     IF RETURNED-FROM = XCTL-127
  7660         GO TO 0650-FROM-EL127
  7661     END-IF.
  7662
  7663     IF RETURNED-FROM = XCTL-132
  7664         GO TO 0640-FROM-EL132
  7665     END-IF.
  7666
  7667     IF RETURNED-FROM = XCTL-650
  7668         MOVE AL-SABON           TO PF5A
  7669         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
  7670     END-IF.
  7671
  7672     IF RETURNED-FROM = XCTL-6592
  7673         GO TO 0630-FROM-EL6592
  7674     END-IF.
  7675
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 148
* EL130.cbl
  7676     IF MAINTI = 'S' OR 'I'
  7677        GO TO 1000-SHOW-CLAIM
  7678     END-IF.
  7679
  7680     GO TO 8100-SEND-INITIAL-MAP.
  7681
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 149
* EL130.cbl
  7683 0630-FROM-EL6592.
  7684     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  7685     MOVE PI-EL659-GROUPING      TO GROUPO.
  7686     MOVE PI-EL659-STATE         TO STATEO.
  7687     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  7688
  7689     MOVE AL-UANON               TO CRTCARRA
  7690                                    GROUPA
  7691                                    STATEA
  7692                                    ACCOUNTA.
  7693     GO TO 8100-SEND-INITIAL-MAP.
  7694
  7695 0640-FROM-EL132.
  7696     IF PI-CLAIM-NO = SPACES
  7697         GO TO 0645-NO-CLAIM-SELECTED
  7698     END-IF.
  7699
  7700     MOVE LOW-VALUES             TO EL130AI.
  7701     MOVE 'MSTR'                 TO FILE-SWITCH.
  7702     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  7703     MOVE PI-CARRIER             TO MSTR-CARRIER.
  7704     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  7705                                    CLMNOO.
  7706     MOVE AL-UANON               TO CLMNOA.
  7707     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  7708
  7709
  7710
  7711* EXEC CICS HANDLE CONDITION
  7712*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  7713*    END-EXEC.
  7714*    MOVE '"$I                   ! & #00007483' TO DFHEIV0
  7715     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7716     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7717     MOVE X'2620233030303037343833' TO DFHEIV0(25:11)
  7718     CALL 'kxdfhei1' USING DFHEIV0
  7719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7720
  7721
  7722     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  7723     MOVE 'X'                    TO CLAIM-SWITCH.
  7724     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  7725     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  7726     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  7727     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7728
  7729     MOVE ER-0213                TO EMI-ERROR.
  7730     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7731     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  7732     GO TO 8100-SEND-INITIAL-MAP.
  7733
  7734 0645-NO-CLAIM-SELECTED.
  7735
  7736     IF MAINTI = 'S' OR 'I'
  7737        GO TO 1000-SHOW-CLAIM
  7738     END-IF.
  7739
  7740     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 150
* EL130.cbl
  7741
  7742 0650-FROM-EL127.
  7743
  7744     IF PI-CERT-SELECT-CNT GREATER THAN +6
  7745         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7746                                    PI-CERT-PROCESSED
  7747     END-IF.
  7748
  7749     IF PI-RETURN-TO-PROGRAM = XCTL-727
  7750         MOVE +1                 TO PI-CERT-SELECT-CNT
  7751                                    PI-CERT-PROCESSED
  7752         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  7753         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  7754         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  7755         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  7756         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  7757         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  7758     END-IF.
  7759
  7760     IF PI-CERT-SELECT-CNT = ZERO
  7761         IF CERTNOI NOT = SPACES AND LOW-VALUES
  7762             MOVE CERTNOI        TO PI-CERT-NO
  7763             MOVE SUFXI          TO PI-CERT-SFX
  7764             GO TO 3000-READ-CERT
  7765         ELSE
  7766             GO TO 8100-SEND-INITIAL-MAP
  7767         END-IF
  7768     END-IF.
  7769
  7770     MOVE AL-SABON               TO PF5A.
  7771
  7772     IF PI-CERT-PROCESSED = 1
  7773         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  7774     END-IF.
  7775
  7776     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  7777     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  7778
  7779     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  7780     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  7781                                 TO CERT-CARRIER
  7782                                    PI-CARRIER.
  7783     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  7784                                 TO CERT-GROUPING
  7785                                    PI-GROUPING.
  7786     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  7787                                 TO CERT-STATE
  7788                                    PI-STATE.
  7789     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  7790                                 TO CERT-ACCOUNT
  7791                                    PI-ACCOUNT.
  7792     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  7793                                 TO CERT-EFF-DT
  7794                                    PI-CERT-EFF-DT.
  7795     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  7796                                 TO CERT-CERT-NO
  7797                                    PI-CERT-NO.
  7798
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 151
* EL130.cbl
  7799     MOVE 'CERT'                 TO FILE-SWITCH.
  7800     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  7801
  7802     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  7803     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  7804     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  7805
  7806     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  7807         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  7808         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  7809         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  7810         IF INCURRED-DATE-MATCH
  7811             MOVE ER-7352        TO EMI-ERROR
  7812             MOVE -1             TO CERTNOL
  7813             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7814         ELSE
  7815             IF NO-CLAIMS-FOR-CERT
  7816                 MOVE ER-7353    TO EMI-ERROR
  7817                 MOVE -1         TO CERTNOL
  7818                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7819             ELSE
  7820                 MOVE ER-0558    TO EMI-ERROR
  7821                 MOVE -1         TO CERTNOL
  7822                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7823             END-IF
  7824         END-IF
  7825     END-IF.
  7826
  7827     MOVE SPACES                 TO PI-PRT-OPT
  7828                                    PI-ALT-PRT.
  7829
  7830     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7831
  7832     IF LSTNMEL NOT GREATER ZERO
  7833        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  7834         MOVE CRTLNMEI           TO  LSTNMEO
  7835         MOVE CRTFNMEI           TO  FSTNMEO
  7836         MOVE CRTINITI           TO  INITO
  7837         MOVE AL-UANON           TO  LSTNMEA
  7838                                     FSTNMEA
  7839                                     INITA
  7840     END-IF.
  7841
  7842     IF SSNL GREATER ZERO
  7843         GO TO 0655-SKIP-SOCIAL-SECURITY
  7844     END-IF.
  7845
  7846     IF CRTSSNI = SPACES OR LOW-VALUES
  7847         GO TO 0655-SKIP-SOCIAL-SECURITY
  7848     END-IF.
  7849
  7850     IF CM-SSN-STATE   = CM-STATE AND
  7851        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  7852            GO TO 0655-SKIP-SOCIAL-SECURITY
  7853     END-IF.
  7854
  7855     MOVE CRTSSNI                TO SSNO
  7856     MOVE AL-UANON               TO SSNA.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 152
* EL130.cbl
  7857
  7858 0655-SKIP-SOCIAL-SECURITY.
  7859
  7860     IF CLMCARRL NOT = ZERO  AND
  7861        CLMCARRI NOT = CRTCARRI
  7862        MOVE ER-0562             TO EMI-ERROR
  7863        MOVE AL-UABON            TO CLMCARRA
  7864        MOVE -1                  TO CLMCARRL
  7865        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7866     END-IF.
  7867
  7868     IF CLMCARRL = ZERO
  7869        MOVE AL-UANON            TO CLMCARRA
  7870        MOVE CRTCARRI            TO CLMCARRI
  7871     END-IF.
  7872
  7873     MOVE 'A'                    TO MAINTO.
  7874     MOVE AL-UANON               TO MAINTA.
  7875
  7876     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7877        GO TO 8100-SEND-INITIAL-MAP
  7878     ELSE
  7879        GO TO 8150-SEND-MAP-CURSOR
  7880     END-IF.
  7881
  7882 0660-NOT-FOUND.
  7883     MOVE ER-0214                TO EMI-ERROR.
  7884     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7885     GO TO 8100-SEND-INITIAL-MAP.
  7886
  7887 0670-QIDERR.
  7888     MOVE ER-0033                TO EMI-ERROR.
  7889     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7890     GO TO 8100-SEND-INITIAL-MAP.
  7891
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 153
* EL130.cbl
  7893 0680-PLUG-SELECTED-CERTS.
  7894
  7895     MOVE AL-SANON               TO BCERT1A
  7896                                    BSUFX1A
  7897                                    BCERT2A
  7898                                    BSUFX2A
  7899                                    BCERT3A
  7900                                    BSUFX3A
  7901                                    BCERT4A
  7902                                    BSUFX4A
  7903                                    BCERT5A
  7904                                    BSUFX5A.
  7905
  7906     IF PCERTNOO = SPACES OR LOW-VALUES
  7907         MOVE PI-EL127-CERT-PRIME (1)
  7908                                 TO PCERTNOO
  7909         MOVE PI-EL127-CERT-SUFX  (1)
  7910                                 TO PSUFXO
  7911     END-IF.
  7912
  7913     MOVE PI-EL127-CERT-PRIME (1)
  7914                                 TO BCERT1O.
  7915     MOVE PI-EL127-CERT-SUFX  (1)
  7916                                 TO BSUFX1O.
  7917
  7918     IF PI-CERT-SELECT-CNT GREATER THAN 1
  7919         MOVE PI-EL127-CERT-PRIME (2)
  7920                                 TO BCERT2O
  7921         MOVE PI-EL127-CERT-SUFX  (2)
  7922                                 TO BSUFX2O
  7923     ELSE
  7924         MOVE LOW-VALUES         TO BCERT2O
  7925                                    BSUFX2O
  7926     END-IF.
  7927
  7928     IF PI-CERT-SELECT-CNT GREATER THAN 2
  7929         MOVE PI-EL127-CERT-PRIME (3)
  7930                                 TO BCERT3O
  7931         MOVE PI-EL127-CERT-SUFX  (3)
  7932                                 TO BSUFX3O
  7933     ELSE
  7934         MOVE LOW-VALUES         TO BCERT3O
  7935                                    BSUFX3O
  7936     END-IF.
  7937
  7938     IF PI-CERT-SELECT-CNT GREATER THAN 3
  7939         MOVE PI-EL127-CERT-PRIME (4)
  7940                                 TO BCERT4O
  7941         MOVE PI-EL127-CERT-SUFX  (4)
  7942                                 TO BSUFX4O
  7943     ELSE
  7944         MOVE LOW-VALUES         TO BCERT4O
  7945                                    BSUFX4O
  7946     END-IF.
  7947
  7948     IF PI-CERT-SELECT-CNT GREATER THAN 4
  7949         MOVE PI-EL127-CERT-PRIME (5)
  7950                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 154
* EL130.cbl
  7951         MOVE PI-EL127-CERT-SUFX  (5)
  7952                                 TO BSUFX5O
  7953     ELSE
  7954         MOVE LOW-VALUES         TO BCERT5O
  7955                                    BSUFX5O
  7956     END-IF.
  7957
  7958 0680-EXIT.
  7959     EXIT.
  7960
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 155
* EL130.cbl
  7962 0690-HIGHLIGHT-CERTS.
  7963
  7964     MOVE AL-UANON               TO PCERTNOA
  7965                                    PSUFXA.
  7966
  7967     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7968        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7969            MOVE AL-SABON        TO BCERT1A
  7970                                    BSUFX1A
  7971     ELSE
  7972         MOVE AL-SANON           TO BCERT1A
  7973                                    BSUFX1A
  7974     END-IF.
  7975
  7976     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7977        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7978            MOVE AL-SABON        TO BCERT2A
  7979                                    BSUFX2A
  7980     ELSE
  7981         MOVE AL-SANON           TO BCERT2A
  7982                                    BSUFX2A
  7983     END-IF.
  7984
  7985     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7986        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7987            MOVE AL-SABON        TO BCERT3A
  7988                                    BSUFX3A
  7989     ELSE
  7990         MOVE AL-SANON           TO BCERT3A
  7991                                    BSUFX3A
  7992     END-IF.
  7993
  7994     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7995        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7996            MOVE AL-SABON        TO BCERT4A
  7997                                    BSUFX4A
  7998     ELSE
  7999         MOVE AL-SANON           TO BCERT4A
  8000                                    BSUFX4A
  8001     END-IF.
  8002
  8003     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8004        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8005            MOVE AL-SABON        TO BCERT5A
  8006                                    BSUFX5A
  8007     ELSE
  8008         MOVE AL-SANON           TO BCERT5A
  8009                                    BSUFX5A
  8010     END-IF.
  8011
  8012 0690-EXIT.
  8013     EXIT.
  8014
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 156
* EL130.cbl
  8016 0800-TEST-PREVIOUS-CONTROL.
  8017     IF CLMNOI   = PI-LAST-CLAIM       AND
  8018        CLMCARRI = PI-LAST-CARR        AND
  8019        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8020        SUFXI    = PI-LAST-CERT-SUFX
  8021*        NEXT SENTENCE
  8022         CONTINUE
  8023     ELSE
  8024         MOVE ER-0207            TO EMI-ERROR
  8025         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8026         MOVE -1                 TO MAINTL
  8027         GO TO 8200-SEND-DATAONLY
  8028     END-IF.
  8029
  8030     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8031
  8032     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8033     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8034     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8035
  8036     IF EIBAID = DFHPF7
  8037         MOVE XCTL-157           TO PGM-NAME
  8038     END-IF.
  8039
  8040     IF EIBAID = DFHPF8
  8041         MOVE XCTL-141           TO PGM-NAME
  8042     END-IF.
  8043
  8044     IF EIBAID = DFHPF9
  8045        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8046                                    PI-SAVED-PROGRAM-2
  8047                                    PI-SAVED-PROGRAM-3
  8048                                    PI-SAVED-PROGRAM-4
  8049                                    PI-SAVED-PROGRAM-5
  8050                                    PI-SAVED-PROGRAM-6
  8051        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8052        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8053        MOVE XCTL-150            TO PGM-NAME
  8054     END-IF.
  8055
  8056     GO TO 9300-XCTL.
  8057
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 157
* EL130.cbl
  8059 1000-SHOW-CLAIM.
  8060
  8061     IF CLMNOL = ZERO
  8062         MOVE -1                 TO CLMNOL
  8063         MOVE AL-UABON           TO CLMNOA
  8064         MOVE ER-0202            TO EMI-ERROR
  8065         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8066     ELSE
  8067         MOVE AL-UANON           TO CLMNOA
  8068     END-IF.
  8069
  8070     IF PI-NO-CARRIER-SECURITY
  8071        IF CLMCARRL = ZERO
  8072             MOVE -1             TO CLMCARRL
  8073             MOVE AL-UABON       TO CLMCARRA
  8074             MOVE ER-0194        TO EMI-ERROR
  8075             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8076         ELSE
  8077             MOVE AL-UANON       TO CLMCARRA
  8078         END-IF
  8079     END-IF.
  8080
  8081     IF SUFXL = ZERO
  8082         MOVE SPACES             TO SUFXI
  8083         MOVE AL-UANON           TO SUFXA
  8084     ELSE
  8085         MOVE AL-UANON           TO SUFXA
  8086     END-IF.
  8087
  8088     IF NOT EMI-NO-ERRORS
  8089         GO TO 1050-SEND-CHECK
  8090     END-IF.
  8091
  8092
  8093
  8094* EXEC CICS HANDLE CONDITION
  8095*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8096*    END-EXEC.
  8097*    MOVE '"$I                   ! '' #00007858' TO DFHEIV0
  8098     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8099     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8100     MOVE X'2720233030303037383538' TO DFHEIV0(25:11)
  8101     CALL 'kxdfhei1' USING DFHEIV0
  8102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8103
  8104
  8105     MOVE 'MSTR'                 TO FILE-SWITCH
  8106     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8107
  8108     MOVE CLMCARRI               TO MSTR-CARRIER.
  8109     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8110
  8111     IF CERTNOL = ZERO     OR
  8112        CERTNOI = SPACES   OR
  8113        CERTNOI = LOW-VALUES
  8114         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8115         MOVE AL-SANON        TO CERTNOA
  8116                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 158
* EL130.cbl
  8117     ELSE
  8118         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8119     END-IF.
  8120
  8121     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8122     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8123
  8124
  8125
  8126* EXEC CICS HANDLE CONDITION
  8127*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8128*    END-EXEC.
  8129*    MOVE '"$I                   ! ( #00007882' TO DFHEIV0
  8130     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8131     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8132     MOVE X'2820233030303037383832' TO DFHEIV0(25:11)
  8133     CALL 'kxdfhei1' USING DFHEIV0
  8134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8135
  8136
  8137     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8138
  8139     IF NOT PI-NO-ACCOUNT-SECURITY
  8140         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8141           MOVE ER-2371          TO EMI-ERROR
  8142           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8143           MOVE -1               TO MAINTL
  8144           GO TO 8200-SEND-DATAONLY
  8145         END-IF
  8146     END-IF.
  8147
  8148
  8149
  8150* EXEC CICS HANDLE CONDITION
  8151*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8152*    END-EXEC.
  8153*    MOVE '"$I                   ! ) #00007898' TO DFHEIV0
  8154     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8155     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8156     MOVE X'2920233030303037383938' TO DFHEIV0(25:11)
  8157     CALL 'kxdfhei1' USING DFHEIV0
  8158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8159
  8160
  8161     MOVE 'Y'                    TO CLAIM-SWITCH.
  8162     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8163     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8164     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8165
  8166 1000-SHOW-END-OF-PERFORM.
  8167
  8168     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8169     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8170     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8171     MOVE CL-CERT-STATE          TO CERT-STATE.
  8172     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8173     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8174     MOVE CL-CERT-NO             TO CERT-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 159
* EL130.cbl
  8175
  8176     MOVE 'CERT'                 TO FILE-SWITCH.
  8177
  8178     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8179
  8180     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8181     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8182     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8183     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8184     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8185     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8186     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8187     MOVE CLMCARRI               TO PI-LAST-CARR.
  8188
  8189     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8190
  8191     IF MAINTI = 'I'
  8192         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8193                 BIRTHDTA  LSTNMEA   RELCLMA   OCCCDA
  8194                 LOANNOA   LOANBALA  BENECDA
  8195         MOVE AL-SANON TO  SSNA
  8196         MOVE SPACES   TO  INCURI    REPORTI  ESTENDI
  8197         MOVE 'Y'      TO PI-INCURR-SW
  8198         MOVE ER-0522  TO EMI-ERROR
  8199         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8200     ELSE
  8201         MOVE ' '      TO PI-INCURR-SW
  8202     END-IF.
  8203
  8204     MOVE -1                     TO MAINTL.
  8205     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8206     MOVE CERT-GROUPING          TO PI-GROUPING.
  8207     MOVE CERT-STATE             TO PI-STATE.
  8208     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8209     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8210     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8211     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8212
  8213     IF RETURNED-FROM NOT = SPACES
  8214         GO TO 8100-SEND-INITIAL-MAP
  8215     ELSE
  8216         GO TO 8200-SEND-DATAONLY
  8217     END-IF.
  8218
  8219 1025-SHOW-RECORD-NOT-FOUND.
  8220
  8221     IF FILE-SWITCH = 'MSTR'
  8222         MOVE ER-0204            TO EMI-ERROR
  8223     ELSE
  8224         IF FILE-SWITCH = 'TRLR'
  8225             MOVE ER-0205        TO EMI-ERROR
  8226         ELSE
  8227             MOVE ER-0206        TO EMI-ERROR
  8228         END-IF
  8229     END-IF.
  8230
  8231     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8232
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 160
* EL130.cbl
  8233 1050-SEND-CHECK.
  8234
  8235     IF RETURNED-FROM NOT = SPACES
  8236         GO TO 8100-SEND-INITIAL-MAP
  8237     ELSE
  8238         MOVE -1                 TO MAINTL
  8239         GO TO 8200-SEND-DATAONLY
  8240     END-IF.
  8241
  8242 2000-DELETE-CLAIM.
  8243     IF NOT MODIFY-CAP
  8244         MOVE ER-0070            TO EMI-ERROR
  8245         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8246         MOVE -1                 TO MAINTL
  8247         GO TO 8200-SEND-DATAONLY
  8248     END-IF.
  8249
  8250     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8251        CLMCARRI NOT = PI-LAST-CARR        OR
  8252        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8253        SUFXI    NOT = PI-LAST-CERT-SUFX
  8254         MOVE ER-0207            TO EMI-ERROR
  8255         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8256         MOVE -1                 TO MAINTL
  8257         GO TO 8200-SEND-DATAONLY
  8258     END-IF.
  8259
  8260
  8261
  8262* EXEC CICS HANDLE CONDITION
  8263*        NOTFND   (2050-DELETE-NOT-FOUND)
  8264*    END-EXEC.
  8265*    MOVE '"$I                   ! * #00008002' TO DFHEIV0
  8266     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8267     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8268     MOVE X'2A20233030303038303032' TO DFHEIV0(25:11)
  8269     CALL 'kxdfhei1' USING DFHEIV0
  8270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8271
  8272
  8273     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8274
  8275     MOVE CLMCARRI               TO MSTR-CARRIER.
  8276     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8277     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8278     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8279
  8280     MOVE 'MSTR'                 TO FILE-SWITCH.
  8281     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8282
  8283     MOVE 'Y'                    TO CLAIM-SWITCH.
  8284
  8285     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8286        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8287         MOVE ER-0068        TO EMI-ERROR
  8288         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8289         MOVE -1             TO MAINTL
  8290         GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 161
* EL130.cbl
  8291     END-IF.
  8292
  8293     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8294         MOVE ER-0569            TO EMI-ERROR
  8295         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8296         MOVE -1                 TO MAINTL
  8297         GO TO 8200-SEND-DATAONLY
  8298     END-IF.
  8299
  8300     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8301         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8302     END-IF.
  8303
  8304     IF CL-PURGED-DT NOT = LOW-VALUES
  8305         MOVE ER-7691            TO EMI-ERROR
  8306         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8307         MOVE -1                 TO MAINTL
  8308         GO TO 8200-SEND-DATAONLY
  8309     END-IF.
  8310
  8311     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8312     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8313     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8314     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8315     MOVE +0                     TO TRLR-SEQ-NO.
  8316     MOVE '1'                    TO TRLR-TYPE.
  8317
  8318     MOVE 'TRLR'                 TO FILE-SWITCH.
  8319
  8320
  8321
  8322* EXEC CICS READ
  8323*        UPDATE
  8324*        DATASET  (ELTRLR-DSID)
  8325*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8326*        RIDFLD   (ELTRLR-KEY)
  8327*    END-EXEC.
  8328*    MOVE '&"S        EU         (   #00008054' TO DFHEIV0
  8329     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8330     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8331     MOVE X'2020233030303038303534' TO DFHEIV0(25:11)
  8332     CALL 'kxdfhei1' USING DFHEIV0,
  8333           ELTRLR-DSID,
  8334           DFHEIV20,
  8335           DFHEIV99,
  8336           ELTRLR-KEY,
  8337           DFHEIV99,
  8338           DFHEIV99,
  8339           DFHEIV99
  8340     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8341         DFHEIV20
  8342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8343
  8344
  8345     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8346        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
  8347         MOVE ER-0068        TO EMI-ERROR
  8348         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 162
* EL130.cbl
  8349         MOVE -1             TO MAINTL
  8350         GO TO 8200-SEND-DATAONLY
  8351     END-IF.
  8352
  8353
  8354
  8355* EXEC CICS DELETE
  8356*        DATASET   (ELTRLR-DSID)
  8357*    END-EXEC.
  8358*    MOVE '&(                    &   #00008070' TO DFHEIV0
  8359     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8360     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8361     MOVE X'2020233030303038303730' TO DFHEIV0(25:11)
  8362     CALL 'kxdfhei1' USING DFHEIV0,
  8363           ELTRLR-DSID,
  8364           DFHEIV99,
  8365           DFHEIV99,
  8366           DFHEIV99,
  8367           DFHEIV99
  8368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8369
  8370
  8371     MOVE +90                    TO TRLR-SEQ-NO.
  8372     MOVE '6'                    TO TRLR-TYPE.
  8373
  8374
  8375
  8376* EXEC CICS READ
  8377*        UPDATE
  8378*        DATASET  (ELTRLR-DSID)
  8379*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8380*        RIDFLD   (ELTRLR-KEY)
  8381*    END-EXEC.
  8382*    MOVE '&"S        EU         (   #00008078' TO DFHEIV0
  8383     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8384     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8385     MOVE X'2020233030303038303738' TO DFHEIV0(25:11)
  8386     CALL 'kxdfhei1' USING DFHEIV0,
  8387           ELTRLR-DSID,
  8388           DFHEIV20,
  8389           DFHEIV99,
  8390           ELTRLR-KEY,
  8391           DFHEIV99,
  8392           DFHEIV99,
  8393           DFHEIV99
  8394     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8395         DFHEIV20
  8396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8397
  8398
  8399
  8400
  8401* EXEC CICS DELETE
  8402*        DATASET   (ELTRLR-DSID)
  8403*    END-EXEC.
  8404*    MOVE '&(                    &   #00008086' TO DFHEIV0
  8405     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8406     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 163
* EL130.cbl
  8407     MOVE X'2020233030303038303836' TO DFHEIV0(25:11)
  8408     CALL 'kxdfhei1' USING DFHEIV0,
  8409           ELTRLR-DSID,
  8410           DFHEIV99,
  8411           DFHEIV99,
  8412           DFHEIV99,
  8413           DFHEIV99
  8414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8415
  8416
  8417     MOVE +91                    TO TRLR-SEQ-NO.
  8418     MOVE '6'                    TO TRLR-TYPE.
  8419
  8420
  8421
  8422* EXEC CICS READ
  8423*        UPDATE
  8424*        DATASET  (ELTRLR-DSID)
  8425*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8426*        RIDFLD   (ELTRLR-KEY)
  8427*        RESP     (WS-RESPONSE)
  8428*    END-EXEC
  8429*    MOVE '&"S        EU         (  N#00008094' TO DFHEIV0
  8430     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8431     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8432     MOVE X'204E233030303038303934' TO DFHEIV0(25:11)
  8433     CALL 'kxdfhei1' USING DFHEIV0,
  8434           ELTRLR-DSID,
  8435           DFHEIV20,
  8436           DFHEIV99,
  8437           ELTRLR-KEY,
  8438           DFHEIV99,
  8439           DFHEIV99,
  8440           DFHEIV99
  8441     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8442         DFHEIV20
  8443     MOVE EIBRESP  TO WS-RESPONSE
  8444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8445
  8446     IF WS-RESP-NORMAL
  8447
  8448* EXEC CICS DELETE
  8449*          DATASET   (ELTRLR-DSID)
  8450*       END-EXEC
  8451*    MOVE '&(                    &   #00008103' TO DFHEIV0
  8452     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8453     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8454     MOVE X'2020233030303038313033' TO DFHEIV0(25:11)
  8455     CALL 'kxdfhei1' USING DFHEIV0,
  8456           ELTRLR-DSID,
  8457           DFHEIV99,
  8458           DFHEIV99,
  8459           DFHEIV99,
  8460           DFHEIV99
  8461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8462     END-IF.
  8463
  8464     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 164
* EL130.cbl
  8465     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8466     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8467     MOVE CL-CERT-STATE          TO CERT-STATE.
  8468     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8469     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8470     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8471
  8472     MOVE 'CERT'                 TO FILE-SWITCH.
  8473
  8474     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8475
  8476     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8477
  8478     IF WS-NUM-HOLD NOT = +0
  8479         GO TO 2005-REWRITE-CERT
  8480     END-IF.
  8481
  8482     IF NOT CERT-WAS-CREATED
  8483         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8484         GO TO 2005-REWRITE-CERT
  8485     END-IF.
  8486
  8487
  8488
  8489* EXEC CICS DELETE
  8490*        DATASET   (ELCERT-DSID)
  8491*    END-EXEC.
  8492*    MOVE '&(                    &   #00008132' TO DFHEIV0
  8493     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8494     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8495     MOVE X'2020233030303038313332' TO DFHEIV0(25:11)
  8496     CALL 'kxdfhei1' USING DFHEIV0,
  8497           ELCERT-DSID,
  8498           DFHEIV99,
  8499           DFHEIV99,
  8500           DFHEIV99,
  8501           DFHEIV99
  8502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8503
  8504
  8505     GO TO 2010-DELETE-CL.
  8506
  8507 2005-REWRITE-CERT.
  8508
  8509     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8510
  8511
  8512
  8513* EXEC CICS HANDLE CONDITION
  8514*         DUPKEY   (2010-DELETE-CL)
  8515*    END-EXEC.
  8516*    MOVE '"$$                   ! + #00008143' TO DFHEIV0
  8517     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8518     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8519     MOVE X'2B20233030303038313433' TO DFHEIV0(25:11)
  8520     CALL 'kxdfhei1' USING DFHEIV0
  8521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8522
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 165
* EL130.cbl
  8523
  8524
  8525
  8526* EXEC CICS REWRITE
  8527*        DATASET  (ELCERT-DSID)
  8528*        FROM     (CERTIFICATE-MASTER)
  8529*    END-EXEC.
  8530     MOVE LENGTH OF
  8531      CERTIFICATE-MASTER
  8532       TO DFHEIV11
  8533*    MOVE '&& L                  %   #00008148' TO DFHEIV0
  8534     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8535     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8536     MOVE X'2020233030303038313438' TO DFHEIV0(25:11)
  8537     CALL 'kxdfhei1' USING DFHEIV0,
  8538           ELCERT-DSID,
  8539           CERTIFICATE-MASTER,
  8540           DFHEIV11,
  8541           DFHEIV99
  8542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8543
  8544
  8545 2010-DELETE-CL.
  8546
  8547
  8548
  8549* EXEC CICS DELETE
  8550*        DATASET  (ELMSTR-DSID)
  8551*    END-EXEC.
  8552*    MOVE '&(                    &   #00008156' TO DFHEIV0
  8553     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8554     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8555     MOVE X'2020233030303038313536' TO DFHEIV0(25:11)
  8556     CALL 'kxdfhei1' USING DFHEIV0,
  8557           ELMSTR-DSID,
  8558           DFHEIV99,
  8559           DFHEIV99,
  8560           DFHEIV99,
  8561           DFHEIV99
  8562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8563
  8564
  8565     MOVE -1                     TO ONE-OR-MIN1.
  8566     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8567
  8568     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8569         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8570                                    WS-SAVE-CLAIM-KEY
  8571         MOVE +1                 TO ONE-OR-MIN1
  8572         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8573     END-IF.
  8574
  8575     MOVE ER-0000                TO EMI-ERROR.
  8576     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8577     MOVE LOW-VALUES             TO EL130AO.
  8578     MOVE -1                     TO MAINTL.
  8579     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8580     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 166
* EL130.cbl
  8581                                    PI-CERT-PROCESSED
  8582                                    PI-LETTER-ERROR-CODE.
  8583     GO TO 8100-SEND-INITIAL-MAP.
  8584
  8585 2050-DELETE-NOT-FOUND.
  8586     IF FILE-SWITCH = 'MSTR'
  8587         MOVE -1                 TO CLMNOL
  8588         MOVE ER-0204            TO EMI-ERROR
  8589     ELSE
  8590         IF FILE-SWITCH = 'TRLR'
  8591             MOVE -1             TO MAINTL
  8592             MOVE ER-0205        TO EMI-ERROR
  8593         ELSE
  8594             MOVE -1             TO CERTNOL
  8595             MOVE ER-0206        TO EMI-ERROR
  8596         END-IF
  8597     END-IF.
  8598
  8599     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8600     GO TO 8200-SEND-DATAONLY.
  8601
  8602 3000-ADD-CLAIM.
  8603     IF NOT MODIFY-CAP
  8604         MOVE ER-0070            TO EMI-ERROR
  8605         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8606         MOVE -1                 TO MAINTL
  8607         GO TO 8200-SEND-DATAONLY
  8608     END-IF.
  8609
  8610     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8611
  8612     IF CERTMTI = 'S'
  8613         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8614            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8615            WS-EFFDT = PI-SAVE-EFFDT       AND
  8616            ACCOUNTI = PI-SAVE-ACCOUNT
  8617             IF EMI-ERROR = 0
  8618                 GO TO 3010-TEST-FOR-ERRORS
  8619             ELSE
  8620                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8621                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8622                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8623                 MOVE PI-STATE         TO  CERT-STATE
  8624                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8625                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8626                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8627
  8628
  8629* EXEC CICS HANDLE CONDITION
  8630*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8631*                END-EXEC
  8632*    MOVE '"$I                   ! , #00008223' TO DFHEIV0
  8633     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8634     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8635     MOVE X'2C20233030303038323233' TO DFHEIV0(25:11)
  8636     CALL 'kxdfhei1' USING DFHEIV0
  8637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8638                 PERFORM 7940-READ-CERT THRU 7940-EXIT
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 167
* EL130.cbl
  8639                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  8640                 GO TO 3010-TEST-FOR-ERRORS
  8641             END-IF
  8642         END-IF
  8643     END-IF.
  8644
  8645     IF CERTMTI = 'A'
  8646         IF NOT PI-NO-CARRIER-SECURITY OR
  8647             NOT PI-NO-ACCOUNT-SECURITY
  8648             MOVE ER-2370          TO EMI-ERROR
  8649             MOVE -1               TO MAINTL
  8650             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8651             GO TO 8200-SEND-DATAONLY
  8652         ELSE
  8653             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  8654             GO TO 3010-TEST-FOR-ERRORS
  8655         END-IF
  8656     END-IF.
  8657
  8658     IF CERTNOL = ZEROS
  8659        GO TO 3010-TEST-FOR-ERRORS
  8660     END-IF.
  8661
  8662 3000-READ-CERT.
  8663
  8664     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  8665                                    MSTR5-COMP-CD.
  8666     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  8667                                    MSTR5-CERT-NO-PRIME.
  8668     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  8669                                    MSTR5-CERT-NO-SUFX.
  8670
  8671
  8672
  8673* EXEC CICS HANDLE CONDITION
  8674*         DUPKEY   (3008-DUP-ERROR)
  8675*         NOTFND   (3009-NOT-FOUND)
  8676*    END-EXEC
  8677*    MOVE '"$$I                  ! - #00008260' TO DFHEIV0
  8678     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  8679     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8680     MOVE X'2D20233030303038323630' TO DFHEIV0(25:11)
  8681     CALL 'kxdfhei1' USING DFHEIV0
  8682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8683
  8684     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  8685
  8686     IF NOT PI-NO-ACCOUNT-SECURITY
  8687         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  8688             MOVE ER-2371          TO EMI-ERROR
  8689             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8690             MOVE -1               TO MAINTL
  8691             GO TO 8200-SEND-DATAONLY
  8692         END-IF
  8693     END-IF.
  8694
  8695     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  8696     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 168
* EL130.cbl
  8697     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  8698     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  8699     MOVE CM-CARRIER             TO PI-CARRIER.
  8700     MOVE CM-GROUPING            TO PI-GROUPING.
  8701     MOVE CM-STATE               TO PI-STATE.
  8702     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  8703     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  8704     MOVE CM-CERT-NO             TO PI-CERT-NO.
  8705     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  8706
  8707     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  8708         IF LSTNMEO = SPACES OR LOW-VALUES
  8709             MOVE CRTLNMEI       TO  LSTNMEO
  8710             MOVE AL-UANON       TO  LSTNMEA
  8711         END-IF
  8712     END-IF.
  8713
  8714     MOVE 'S'                    TO CERTMTO.
  8715*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  8716     MOVE AL-SANON               TO CERTNOA.
  8717     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  8718                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  8719     IF EMI-NO-ERRORS
  8720         MOVE -1                  TO MAINTL
  8721     END-IF.
  8722
  8723     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8724         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8725         IF INCURRED-DATE-MATCH
  8726             MOVE ER-7352         TO EMI-ERROR
  8727             MOVE -1              TO CERTNOL
  8728             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8729         ELSE
  8730             IF NO-CLAIMS-FOR-CERT
  8731                 MOVE ER-7353     TO EMI-ERROR
  8732                 MOVE -1          TO CERTNOL
  8733                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8734             ELSE
  8735                 MOVE ER-0558     TO EMI-ERROR
  8736                 MOVE -1          TO CERTNOL
  8737                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8738                 GO TO 3010-TEST-FOR-ERRORS
  8739             END-IF
  8740         END-IF
  8741     END-IF.
  8742
  8743 3007-SEND-SCREEN.
  8744     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  8745         GO TO 8150-SEND-MAP-CURSOR
  8746     ELSE
  8747         GO TO 8200-SEND-DATAONLY
  8748     END-IF.
  8749
  8750 3008-DUP-ERROR.
  8751     MOVE ER-0560                TO EMI-ERROR.
  8752     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8753     MOVE -1                     TO CERTNOL.
  8754     GO TO 3007-SEND-SCREEN.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 169
* EL130.cbl
  8755
  8756 3009-NOT-FOUND.
  8757     MOVE ER-0214                TO EMI-ERROR.
  8758     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8759     MOVE -1                     TO CERTNOL.
  8760     GO TO 3007-SEND-SCREEN.
  8761
  8762 3010-TEST-FOR-ERRORS.
  8763
  8764     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  8765     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  8766
  8767     IF CERTMTI NOT = 'A'
  8768         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8769             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  8770             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  8771             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  8772             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8773             IF INCURRED-DATE-MATCH
  8774                 MOVE ER-7352         TO EMI-ERROR
  8775                 MOVE -1              TO CERTNOL
  8776                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8777             ELSE
  8778                 IF NO-CLAIMS-FOR-CERT
  8779                     MOVE ER-7353     TO EMI-ERROR
  8780                     MOVE -1          TO CERTNOL
  8781                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8782                 ELSE
  8783                     MOVE ER-0558     TO EMI-ERROR
  8784                     MOVE -1          TO CERTNOL
  8785                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8786                 END-IF
  8787             END-IF
  8788         END-IF
  8789     END-IF.
  8790
  8791     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  8792         MOVE ER-0433             TO EMI-ERROR
  8793         MOVE -1                  TO MAINTL
  8794         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8795         GO TO 8200-SEND-DATAONLY
  8796     END-IF.
  8797
  8798     IF EMI-NO-ERRORS
  8799         GO TO 3015-TRY-TO-BUILD
  8800     END-IF.
  8801
  8802     IF EIBAID = DFHPF6
  8803         IF EMI-FATAL-CTR NOT EQUAL ZERO
  8804             MOVE ER-0434         TO EMI-ERROR
  8805             MOVE -1              TO MAINTL
  8806             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8807             GO TO 8200-SEND-DATAONLY
  8808         ELSE
  8809             MOVE +1              TO INCURL
  8810             GO TO 3015-TRY-TO-BUILD
  8811         END-IF
  8812     END-IF.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 170
* EL130.cbl
  8813
  8814     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  8815         GO TO 8150-SEND-MAP-CURSOR
  8816     ELSE
  8817         GO TO 8200-SEND-DATAONLY
  8818     END-IF.
  8819
  8820 3015-TRY-TO-BUILD.
  8821     IF CLMNOL EQUAL ZERO
  8822         GO TO 3030-BUILD-CONT
  8823     END-IF.
  8824
  8825
  8826
  8827* EXEC CICS HANDLE CONDITION
  8828*        NOTFND   (3030-BUILD-CONT)
  8829*    END-EXEC.
  8830*    MOVE '"$I                   ! . #00008407' TO DFHEIV0
  8831     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8832     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8833     MOVE X'2E20233030303038343037' TO DFHEIV0(25:11)
  8834     CALL 'kxdfhei1' USING DFHEIV0
  8835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8836
  8837
  8838     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8839
  8840     MOVE CLMCARRI               TO MSTR-CARRIER.
  8841     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8842     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8843     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8844
  8845     MOVE 'MSTR'                 TO FILE-SWITCH.
  8846
  8847     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8848
  8849     MOVE ER-0221                TO EMI-ERROR.
  8850
  8851     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8852     MOVE -1                     TO MAINTL.
  8853     GO TO 8200-SEND-DATAONLY.
  8854
  8855 3030-BUILD-CONT.
  8856     IF CERTMTI NOT = 'A'
  8857         GO TO 3060-BUILD-CONT
  8858     END-IF.
  8859
  8860
  8861
  8862* EXEC CICS HANDLE CONDITION
  8863*        NOTFND   (3033-ACCT-NOT-FOUND)
  8864*        ENDFILE  (3033-ACCT-NOT-FOUND)
  8865*    END-EXEC.
  8866*    MOVE '"$I''                  ! / #00008434' TO DFHEIV0
  8867     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8868     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8869     MOVE X'2F20233030303038343334' TO DFHEIV0(25:11)
  8870     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 171
* EL130.cbl
  8871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8872
  8873
  8874     MOVE SPACES                 TO ERACCT-KEY.
  8875
  8876     IF CARR-GROUP-ST-ACCNT-CNTL
  8877         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  8878         MOVE CRTCARRI           TO ACCT-CARRIER
  8879         MOVE GROUPI             TO ACCT-GROUPING
  8880         MOVE STATEI             TO ACCT-STATE
  8881         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  8882         GO TO 3031-MOVE-ACCT-KEY
  8883     END-IF.
  8884
  8885     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  8886     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  8887
  8888     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  8889         MOVE STATEI             TO ACCT-STATE
  8890     END-IF.
  8891
  8892     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  8893         MOVE CRTCARRI           TO ACCT-CARRIER
  8894     END-IF.
  8895
  8896 3031-MOVE-ACCT-KEY.
  8897     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  8898
  8899
  8900
  8901* EXEC CICS STARTBR
  8902*        DATASET     (ERACCT2-DSID)
  8903*        RIDFLD      (SAVE-ERACCT-KEY)
  8904*        GENERIC
  8905*        KEYLENGTH   (20)
  8906*    END-EXEC.
  8907     MOVE 20
  8908       TO DFHEIV11
  8909     MOVE 0
  8910       TO DFHEIV12
  8911*    MOVE '&,   KG    G          &   #00008465' TO DFHEIV0
  8912     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  8913     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8914     MOVE X'2020233030303038343635' TO DFHEIV0(25:11)
  8915     CALL 'kxdfhei1' USING DFHEIV0,
  8916           ERACCT2-DSID,
  8917           SAVE-ERACCT-KEY,
  8918           DFHEIV11,
  8919           DFHEIV12,
  8920           DFHEIV99
  8921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8922
  8923
  8924
  8925
  8926* EXEC CICS HANDLE CONDITION
  8927*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  8928*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 172
* EL130.cbl
  8929*    MOVE '"$''                   ! 0 #00008473' TO DFHEIV0
  8930     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8931     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8932     MOVE X'3020233030303038343733' TO DFHEIV0(25:11)
  8933     CALL 'kxdfhei1' USING DFHEIV0
  8934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8935
  8936
  8937 3031-READ-ACCT-LOOP.
  8938
  8939
  8940* EXEC CICS READNEXT
  8941*        DATASET   (ERACCT2-DSID)
  8942*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8943*        RIDFLD    (SAVE-ERACCT-KEY)
  8944*    END-EXEC.
  8945     MOVE 0
  8946       TO DFHEIV11
  8947*    MOVE '&.S                   )   #00008479' TO DFHEIV0
  8948     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8949     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8950     MOVE X'2020233030303038343739' TO DFHEIV0(25:11)
  8951     CALL 'kxdfhei1' USING DFHEIV0,
  8952           ERACCT2-DSID,
  8953           DFHEIV20,
  8954           DFHEIV99,
  8955           SAVE-ERACCT-KEY,
  8956           DFHEIV99,
  8957           DFHEIV11,
  8958           DFHEIV99,
  8959           DFHEIV99
  8960     SET ADDRESS OF ACCOUNT-MASTER TO
  8961         DFHEIV20
  8962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8963
  8964
  8965     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  8966        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  8967        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  8968        ACCT-STATE    NOT = AM-VG-STATE       OR
  8969        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  8970         GO TO 3033-ACCT-NOT-FOUND
  8971     END-IF.
  8972
  8973     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  8974        WS-EFFDT LESS AM-EXPIRATION-DT
  8975         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  8976         MOVE AM-CARRIER       TO CERT-CARRIER
  8977         MOVE AM-GROUPING      TO CERT-GROUPING
  8978         MOVE AM-STATE         TO CERT-STATE
  8979         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  8980         MOVE WS-EFFDT         TO CERT-EFF-DT
  8981         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  8982         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  8983         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  8984         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  8985     END-IF.
  8986
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 173
* EL130.cbl
  8987     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  8988         GO TO 3031-READ-ACCT-LOOP
  8989     END-IF.
  8990
  8991 3032-NOT-IN-DT-RANGE.
  8992     MOVE ER-0226                TO EMI-ERROR.
  8993     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8994     MOVE -1                     TO EFFDTL.
  8995     GO TO 8200-SEND-DATAONLY.
  8996
  8997 3033-ACCT-NOT-FOUND.
  8998     MOVE ER-0226 TO EMI-ERROR.
  8999     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9000     MOVE -1                     TO ACCOUNTL.
  9001     GO TO 8200-SEND-DATAONLY.
  9002
  9003 3034-CHECK-EMPLOYER-STATEMENT.
  9004
  9005     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  9006*        NEXT SENTENCE
  9007         CONTINUE
  9008     ELSE
  9009         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9010     END-IF.
  9011
  9012     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9013     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9014     MOVE '1'                    TO  DC-OPTION-CODE.
  9015     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9016                                     DC-ELAPSED-DAYS.
  9017     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9018
  9019     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9020         DC-ELAPSED-DAYS LESS THAN +31)
  9021                      OR
  9022        (AM-EMPLOYER-STMT-USED = '2' AND
  9023         DC-ELAPSED-DAYS LESS THAN +61)
  9024                      OR
  9025        (AM-EMPLOYER-STMT-USED = '3' AND
  9026         DC-ELAPSED-DAYS LESS THAN +91)
  9027            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9028     END-IF.
  9029
  9030 3034-CHECK-ACCOUNT-LIMITS.
  9031
  9032     IF CERTMTI NOT = 'A'
  9033         GO TO 3060-BUILD-CONT
  9034     END-IF.
  9035
  9036     IF AM-STATUS NOT = '0'
  9037         MOVE ER-0225                TO EMI-ERROR
  9038         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9039         MOVE -1                     TO ACCOUNTL
  9040     END-IF.
  9041
  9042     IF EIBAID = DFHPF6
  9043         IF EMI-FATAL-CTR NOT = ZERO
  9044             MOVE ER-0434         TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 174
* EL130.cbl
  9045             MOVE -1              TO MAINTL
  9046             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9047             GO TO 8200-SEND-DATAONLY
  9048         END-IF
  9049     END-IF.
  9050
  9051*    IF PI-COMPANY-ID NOT = 'CRI'
  9052*        GO TO 3035-END-BROWSE
  9053*    END-IF.
  9054
  9055 3035-END-BROWSE.
  9056
  9057
  9058* EXEC CICS ENDBR
  9059*        DATASET    (ERACCT2-DSID)
  9060*    END-EXEC.
  9061     MOVE 0
  9062       TO DFHEIV11
  9063*    MOVE '&2                    $   #00008577' TO DFHEIV0
  9064     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9065     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9066     MOVE X'2020233030303038353737' TO DFHEIV0(25:11)
  9067     CALL 'kxdfhei1' USING DFHEIV0,
  9068           ERACCT2-DSID,
  9069           DFHEIV11,
  9070           DFHEIV99
  9071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9072
  9073
  9074 3040-CHECK-CERT-ALREADY-ON.
  9075
  9076
  9077* EXEC CICS HANDLE CONDITION
  9078*        NOTFND   (3070-BUILD-CONT)
  9079*    END-EXEC.
  9080*    MOVE '"$I                   ! 1 #00008583' TO DFHEIV0
  9081     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9083     MOVE X'3120233030303038353833' TO DFHEIV0(25:11)
  9084     CALL 'kxdfhei1' USING DFHEIV0
  9085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9086
  9087
  9088     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9089
  9090     MOVE ER-0229                TO EMI-ERROR.
  9091     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9092     MOVE -1                     TO MAINTL.
  9093     GO TO 8200-SEND-DATAONLY.
  9094
  9095 3060-BUILD-CONT.
  9096     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9097     MOVE CRTCARRI               TO CERT-CARRIER.
  9098     MOVE GROUPI                 TO CERT-GROUPING.
  9099     MOVE STATEI                 TO CERT-STATE.
  9100     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9101     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9102     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 175
* EL130.cbl
  9103     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9104
  9105
  9106
  9107* EXEC CICS HANDLE CONDITION
  9108*        NOTFND  (3065-CERT-NOT-FOUND)
  9109*    END-EXEC.
  9110*    MOVE '"$I                   ! 2 #00008605' TO DFHEIV0
  9111     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9112     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9113     MOVE X'3220233030303038363035' TO DFHEIV0(25:11)
  9114     CALL 'kxdfhei1' USING DFHEIV0
  9115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9116
  9117
  9118     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9119
  9120     GO TO 3070-BUILD-CONT.
  9121
  9122 3065-CERT-NOT-FOUND.
  9123     MOVE ER-0244                TO EMI-ERROR.
  9124     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9125     MOVE -1                     TO CERTNOL.
  9126     GO TO 8200-SEND-DATAONLY.
  9127
  9128 3070-BUILD-CONT.
  9129     IF CLMNOL NOT = ZERO
  9130         GO TO 3200-BUILD-ZERO-TRAILER
  9131     END-IF.
  9132
  9133     MOVE SPACES                 TO ELCNTL-KEY.
  9134
  9135     IF CONTROL-IS-ACTUAL-CARRIER
  9136         MOVE PI-CARRIER         TO CNTL-CARRIER
  9137     ELSE
  9138         MOVE PI-CARRIER-CONTROL-LEVEL
  9139                                 TO CNTL-CARRIER
  9140     END-IF.
  9141
  9142     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9143     MOVE '6'                    TO CNTL-REC-TYPE.
  9144     MOVE +0                     TO CNTL-SEQ-NO.
  9145
  9146
  9147
  9148* EXEC CICS HANDLE CONDITION
  9149*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9150*    END-EXEC.
  9151*    MOVE '"$I                   ! 3 #00008638' TO DFHEIV0
  9152     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9154     MOVE X'3320233030303038363338' TO DFHEIV0(25:11)
  9155     CALL 'kxdfhei1' USING DFHEIV0
  9156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9157
  9158
  9159
  9160
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 176
* EL130.cbl
  9161* EXEC CICS READ
  9162*        UPDATE
  9163*        DATASET   (ELCNTL-DSID)
  9164*        SET       (ADDRESS OF CONTROL-FILE)
  9165*        RIDFLD    (ELCNTL-KEY)
  9166*    END-EXEC.
  9167*    MOVE '&"S        EU         (   #00008643' TO DFHEIV0
  9168     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9169     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9170     MOVE X'2020233030303038363433' TO DFHEIV0(25:11)
  9171     CALL 'kxdfhei1' USING DFHEIV0,
  9172           ELCNTL-DSID,
  9173           DFHEIV20,
  9174           DFHEIV99,
  9175           ELCNTL-KEY,
  9176           DFHEIV99,
  9177           DFHEIV99,
  9178           DFHEIV99
  9179     SET ADDRESS OF CONTROL-FILE TO
  9180         DFHEIV20
  9181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9182
  9183
  9184     IF CLAIM-NO-MANUAL
  9185         GO TO 3120-CLAIM-MUST-BE-INPUT
  9186     END-IF.
  9187
  9188     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9189     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9190
  9191     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9192         CONTINUE
  9193     ELSE
  9194         GO TO 3080-ASSIGN-LOOP
  9195     END-IF.
  9196
  9197
  9198
  9199* EXEC CICS UNLOCK
  9200*        DATASET   (ELCNTL-DSID)
  9201*    END-EXEC.
  9202*    MOVE '&*                    #   #00008664' TO DFHEIV0
  9203     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9204     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9205     MOVE X'2020233030303038363634' TO DFHEIV0(25:11)
  9206     CALL 'kxdfhei1' USING DFHEIV0,
  9207           ELCNTL-DSID,
  9208           DFHEIV99
  9209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9210
  9211
  9212     MOVE '1'                    TO CNTL-REC-TYPE.
  9213     MOVE SPACES                 TO CNTL-ACCESS.
  9214
  9215     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9216
  9217
  9218
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 177
* EL130.cbl
  9219* EXEC CICS HANDLE CONDITION
  9220*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9221*    END-EXEC.
  9222*    MOVE '"$I                   ! 4 #00008674' TO DFHEIV0
  9223     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9224     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9225     MOVE X'3420233030303038363734' TO DFHEIV0(25:11)
  9226     CALL 'kxdfhei1' USING DFHEIV0
  9227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9228
  9229
  9230     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9231
  9232     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9233
  9234 3080-ASSIGN-LOOP.
  9235     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9236        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9237         MOVE +0                 TO SAVE-COUNTER
  9238     END-IF.
  9239
  9240     ADD +1 TO SAVE-COUNTER.
  9241
  9242     IF SAVE-METHOD  = '3'
  9243         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9244         GO TO 3090-SET-COMP
  9245     END-IF.
  9246
  9247     IF SAVE-METHOD  = '4'
  9248         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
  9249         MOVE CLMCARRI           TO WS-CN-PRF-A
  9250         GO TO 3090-SET-COMP
  9251     END-IF.
  9252
  9253     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9254     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9255     MOVE SAVE-DATE              TO CURR-DATE.
  9256
  9257     IF CURR-MM LESS '10'
  9258         MOVE CURR-M2             TO WS-CN-PRF-B
  9259     END-IF.
  9260
  9261     IF CURR-MM = '10'
  9262        MOVE 'A'                 TO WS-CN-PRF-B
  9263     END-IF.
  9264     IF CURR-MM = '11'
  9265        MOVE 'B'                 TO WS-CN-PRF-B
  9266     END-IF.
  9267     IF CURR-MM = '12'
  9268        MOVE 'C'                 TO WS-CN-PRF-B
  9269     END-IF.
  9270
  9271     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9272
  9273 3090-SET-COMP.
  9274
  9275     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9276     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 178
* EL130.cbl
  9277                                    CLMNOO.
  9278     MOVE AL-UANON               TO CLMNOA.
  9279     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9280     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9281     MOVE CLMCARRI               TO MSTR-CARRIER.
  9282
  9283
  9284
  9285* EXEC CICS HANDLE CONDITION
  9286*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9287*    END-EXEC.
  9288*    MOVE '"$I                   ! 5 #00008732' TO DFHEIV0
  9289     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9290     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9291     MOVE X'3520233030303038373332' TO DFHEIV0(25:11)
  9292     CALL 'kxdfhei1' USING DFHEIV0
  9293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9294
  9295
  9296     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9297
  9298     GO TO 3080-ASSIGN-LOOP.
  9299
  9300 3100-CARRIER-NOT-FOUND.
  9301     MOVE ER-0252                TO EMI-ERROR.
  9302     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9303     MOVE -1                     TO CLMCARRL.
  9304     GO TO 8200-SEND-DATAONLY.
  9305
  9306 3110-COMPANY-NOT-FOUND.
  9307     MOVE ER-0254                TO EMI-ERROR.
  9308     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9309     MOVE -1                     TO MAINTL.
  9310     GO TO 8200-SEND-DATAONLY.
  9311
  9312 3120-CLAIM-MUST-BE-INPUT.
  9313     MOVE ER-0264                TO EMI-ERROR.
  9314     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9315     MOVE -1                     TO CLMNOL.
  9316     GO TO 8200-SEND-DATAONLY.
  9317
  9318 3200-BUILD-ZERO-TRAILER.
  9319
  9320
  9321* EXEC CICS HANDLE CONDITION
  9322*        NOTFND
  9323*    END-EXEC.
  9324*    MOVE '"$                   ! 6 #00008760' TO DFHEIV0
  9325     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9326     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9327     MOVE X'3620233030303038373630' TO DFHEIV0(25:11)
  9328     CALL 'kxdfhei1' USING DFHEIV0
  9329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9330
  9331
  9332
  9333
  9334* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 179
* EL130.cbl
  9335*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9336*        LENGTH  (ELTRLR-LENGTH)
  9337*    END-EXEC.
  9338*    MOVE '," L                  $   #00008765' TO DFHEIV0
  9339     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9340     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9341     MOVE X'2020233030303038373635' TO DFHEIV0(25:11)
  9342     CALL 'kxdfhei1' USING DFHEIV0,
  9343           DFHEIV20,
  9344           ELTRLR-LENGTH,
  9345           DFHEIV99
  9346     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9347         DFHEIV20
  9348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9349
  9350
  9351     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9352     MOVE 'AT'                   TO AT-RECORD-ID.
  9353
  9354     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9355     MOVE CLMCARRI               TO AT-CARRIER.
  9356     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9357     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9358     MOVE +0                     TO AT-SEQUENCE-NO.
  9359     MOVE '1'                    TO AT-TRAILER-TYPE.
  9360
  9361     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9362     MOVE '5'                    TO DC-OPTION-CODE.
  9363     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9364     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9365                                    AT-RESERVES-LAST-MAINT-DT.
  9366
  9367     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9368                                    AT-RESERVES-LAST-UPDATED-BY.
  9369
  9370     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9371
  9372     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9373
  9374     MOVE +0                     TO AT-FUTURE-RESERVE
  9375                                    AT-IBNR-RESERVE
  9376                                    AT-PAY-CURRENT-RESERVE
  9377                                    AT-INITIAL-MANUAL-RESERVE
  9378                                    AT-CURRENT-MANUAL-RESERVE
  9379                                    AT-ITD-LIFE-REFUNDS
  9380                                    AT-ITD-AH-REFUNDS
  9381                                    AT-ITD-ADDITIONAL-RESERVE.
  9382
  9383     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9384
  9385     IF MANRSVL NOT = ZERO
  9386         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9387                                    AT-CURRENT-MANUAL-RESERVE
  9388     END-IF.
  9389
  9390     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9391
  9392     MOVE +0                     TO AT-ITD-PAID-EXPENSES
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 180
* EL130.cbl
  9393                                    AT-ITD-CHARGEABLE-EXPENSE.
  9394
  9395     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9396     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9397     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9398
  9399
  9400
  9401* EXEC CICS WRITE
  9402*        DATASET   (ELTRLR-DSID)
  9403*        FROM      (ACTIVITY-TRAILERS)
  9404*        RIDFLD    (AT-CONTROL-PRIMARY)
  9405*    END-EXEC.
  9406     MOVE LENGTH OF
  9407      ACTIVITY-TRAILERS
  9408       TO DFHEIV11
  9409*    MOVE '&$ L                  ''   #00008819' TO DFHEIV0
  9410     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9411     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9412     MOVE X'2020233030303038383139' TO DFHEIV0(25:11)
  9413     CALL 'kxdfhei1' USING DFHEIV0,
  9414           ELTRLR-DSID,
  9415           ACTIVITY-TRAILERS,
  9416           DFHEIV11,
  9417           AT-CONTROL-PRIMARY,
  9418           DFHEIV99,
  9419           DFHEIV99
  9420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9421
  9422
  9423     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9424
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 181
* EL130.cbl
  9426
  9427 3250-BUILD-I1-ADDRESS-TRAILER.
  9428
  9429     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9430     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9431     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9432     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9433     MOVE GROUPI                 TO WS-MA-GROUPING.
  9434     MOVE STATEI                 TO WS-MA-STATE.
  9435     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9436     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9437     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9438     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9439
  9440
  9441* EXEC CICS HANDLE CONDITION
  9442*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9443*    END-EXEC.
  9444*    MOVE '"$I                   ! 7 #00008842' TO DFHEIV0
  9445     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9446     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9447     MOVE X'3720233030303038383432' TO DFHEIV0(25:11)
  9448     CALL 'kxdfhei1' USING DFHEIV0
  9449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9450
  9451
  9452
  9453* EXEC CICS READ
  9454*        EQUAL
  9455*        DATASET   (ERMAIL-DSID)
  9456*        SET       (ADDRESS OF MAILING-DATA)
  9457*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9458*    END-EXEC.
  9459*    MOVE '&"S        E          (   #00008846' TO DFHEIV0
  9460     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9461     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9462     MOVE X'2020233030303038383436' TO DFHEIV0(25:11)
  9463     CALL 'kxdfhei1' USING DFHEIV0,
  9464           ERMAIL-DSID,
  9465           DFHEIV20,
  9466           DFHEIV99,
  9467           WS-MA-CONTROL-PRIMARY,
  9468           DFHEIV99,
  9469           DFHEIV99,
  9470           DFHEIV99
  9471     SET ADDRESS OF MAILING-DATA TO
  9472         DFHEIV20
  9473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9474
  9475
  9476     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9477         GO TO 3290-NO-INSURED-ADDRESS
  9478     END-IF.
  9479
  9480     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9481     MOVE 'AT'                   TO AT-RECORD-ID.
  9482
  9483     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 182
* EL130.cbl
  9484     MOVE CLMCARRI               TO AT-CARRIER.
  9485     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9486     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9487     MOVE +1                     TO AT-SEQUENCE-NO.
  9488     MOVE '5'                    TO AT-TRAILER-TYPE.
  9489
  9490     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9491     IF MA-INSURED-MIDDLE-INIT > SPACES
  9492        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9493               ' ' DELIMITED BY SIZE
  9494               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9495               ' ' DELIMITED BY SIZE
  9496               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9497        INTO AT-MAIL-TO-NAME
  9498     ELSE
  9499        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9500               ' ' DELIMITED BY SIZE
  9501               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9502        INTO AT-MAIL-TO-NAME
  9503     END-IF.
  9504     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9505     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9506*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9507     MOVE MA-CITY                TO AT-CITY
  9508     MOVE MA-ADDR-STATE          TO AT-STATE
  9509     MOVE MA-ZIP                 TO AT-ZIP
  9510     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9511
  9512     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9513                                    AT-ADDRESS-LAST-MAINT-DT.
  9514
  9515     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9516                                    AT-ADDRESS-LAST-UPDATED-BY.
  9517
  9518     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9519
  9520
  9521* EXEC CICS WRITE
  9522*        DATASET   (ELTRLR-DSID)
  9523*        FROM      (ACTIVITY-TRAILERS)
  9524*        RIDFLD    (AT-CONTROL-PRIMARY)
  9525*    END-EXEC.
  9526     MOVE LENGTH OF
  9527      ACTIVITY-TRAILERS
  9528       TO DFHEIV11
  9529*    MOVE '&$ L                  ''   #00008897' TO DFHEIV0
  9530     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9531     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9532     MOVE X'2020233030303038383937' TO DFHEIV0(25:11)
  9533     CALL 'kxdfhei1' USING DFHEIV0,
  9534           ELTRLR-DSID,
  9535           ACTIVITY-TRAILERS,
  9536           DFHEIV11,
  9537           AT-CONTROL-PRIMARY,
  9538           DFHEIV99,
  9539           DFHEIV99
  9540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9541
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 183
* EL130.cbl
  9542
  9543     ADD +1                      TO WS-INSURED-ADDR-CNT.
  9544     GO TO 3300-BUILD-NINETY-TRAILER.
  9545
  9546 3290-NO-INSURED-ADDRESS.
  9547      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
  9548
  9549 3300-BUILD-NINETY-TRAILER.
  9550
  9551     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9552     MOVE 'AT'                   TO AT-RECORD-ID.
  9553
  9554     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9555     MOVE CLMCARRI               TO AT-CARRIER.
  9556
  9557     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9558     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9559     MOVE +90                    TO AT-SEQUENCE-NO.
  9560     MOVE '6'                    TO AT-TRAILER-TYPE.
  9561
  9562     IF DIAGL NOT = ZERO
  9563         MOVE DIAGI              TO AT-INFO-LINE-1
  9564     END-IF.
  9565
  9566     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9567                                    AT-GEN-INFO-LAST-MAINT-DT.
  9568
  9569     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9570                                    AT-GEN-INFO-LAST-UPDATED-BY.
  9571     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9572
  9573
  9574
  9575* EXEC CICS WRITE
  9576*        DATASET   (ELTRLR-DSID)
  9577*        FROM      (ACTIVITY-TRAILERS)
  9578*        RIDFLD    (AT-CONTROL-PRIMARY)
  9579*    END-EXEC.
  9580     MOVE LENGTH OF
  9581      ACTIVITY-TRAILERS
  9582       TO DFHEIV11
  9583*    MOVE '&$ L                  ''   #00008934' TO DFHEIV0
  9584     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9585     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9586     MOVE X'2020233030303038393334' TO DFHEIV0(25:11)
  9587     CALL 'kxdfhei1' USING DFHEIV0,
  9588           ELTRLR-DSID,
  9589           ACTIVITY-TRAILERS,
  9590           DFHEIV11,
  9591           AT-CONTROL-PRIMARY,
  9592           DFHEIV99,
  9593           DFHEIV99
  9594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9595
  9596
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 184
* EL130.cbl
  9598 3400-CHECK-CERT-MAINT.
  9599
  9600     IF CERTMTI = 'A'
  9601         GO TO 3600-BUILD-NEW-CERT
  9602     END-IF.
  9603
  9604     IF NO-CLAIM-ATTACHED
  9605         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
  9606     END-IF.
  9607
  9608     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
  9609
  9610     IF CM-LF-CURRENT-STATUS = '2' OR
  9611        CM-AH-CURRENT-STATUS = '2'
  9612         GO TO 3400-REWRITE-CERT
  9613     END-IF.
  9614
  9615     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9616
  9617 3400-REWRITE-CERT.
  9618
  9619
  9620
  9621* EXEC CICS HANDLE CONDITION
  9622*        DUPKEY (3410-DUP-KEY)
  9623*    END-EXEC.
  9624*    MOVE '"$$                   ! 8 #00008963' TO DFHEIV0
  9625     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9626     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9627     MOVE X'3820233030303038393633' TO DFHEIV0(25:11)
  9628     CALL 'kxdfhei1' USING DFHEIV0
  9629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9630
  9631
  9632
  9633
  9634* EXEC CICS REWRITE
  9635*        DATASET   (ELCERT-DSID)
  9636*        FROM      (CERTIFICATE-MASTER)
  9637*    END-EXEC.
  9638     MOVE LENGTH OF
  9639      CERTIFICATE-MASTER
  9640       TO DFHEIV11
  9641*    MOVE '&& L                  %   #00008968' TO DFHEIV0
  9642     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9643     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9644     MOVE X'2020233030303038393638' TO DFHEIV0(25:11)
  9645     CALL 'kxdfhei1' USING DFHEIV0,
  9646           ELCERT-DSID,
  9647           CERTIFICATE-MASTER,
  9648           DFHEIV11,
  9649           DFHEIV99
  9650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9651
  9652
  9653 3410-DUP-KEY.
  9654     GO TO 3800-BUILD-NEW-CLAIM.
  9655
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 185
* EL130.cbl
  9656 3600-BUILD-NEW-CERT.
  9657
  9658
  9659* EXEC CICS GETMAIN
  9660*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  9661*        LENGTH   (ELCERT-LENGTH)
  9662*    END-EXEC.
  9663*    MOVE '," L                  $   #00008978' TO DFHEIV0
  9664     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9665     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9666     MOVE X'2020233030303038393738' TO DFHEIV0(25:11)
  9667     CALL 'kxdfhei1' USING DFHEIV0,
  9668           DFHEIV20,
  9669           ELCERT-LENGTH,
  9670           DFHEIV99
  9671     SET ADDRESS OF CERTIFICATE-MASTER TO
  9672         DFHEIV20
  9673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9674
  9675
  9676     MOVE SPACES                 TO CERTIFICATE-MASTER.
  9677
  9678     MOVE 'CM'                   TO CM-RECORD-ID.
  9679
  9680     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
  9681                                    CM-COMPANY-CD-A1
  9682                                    CM-COMPANY-CD-A2
  9683                                    CM-COMPANY-CD-A4
  9684                                    CM-COMPANY-CD-A5.
  9685
  9686     MOVE CERT-CARRIER           TO CM-CARRIER.
  9687     MOVE CERT-GROUPING          TO CM-GROUPING.
  9688     MOVE CERT-STATE             TO CM-STATE.
  9689     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
  9690     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
  9691     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
  9692
  9693     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
  9694                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
  9695                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
  9696                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
  9697                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
  9698                       CM-LIVES              CM-LOAN-TERM
  9699                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
  9700                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
  9701                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
  9702                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
  9703                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
  9704                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
  9705                       CM-LF-ALT-PREMIUM-RATE
  9706                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
  9707                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
  9708                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
  9709                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
  9710                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
  9711
  9712     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
  9713                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 186
* EL130.cbl
  9714                                    CM-AH-SETTLEMENT-DT
  9715                                    CM-AH-CANCEL-EXIT-DT
  9716                                    CM-AH-SETTLEMENT-EXIT-DT
  9717                                    CM-LF-LOAN-EXPIRE-DT
  9718                                    CM-LF-CANCEL-DT
  9719                                    CM-LF-DEATH-DT
  9720                                    CM-LF-CANCEL-EXIT-DT
  9721                                    CM-LF-DEATH-EXIT-DT
  9722                                    CM-LAST-ADD-ON-DT
  9723                                    CM-ENTRY-DT.
  9724
  9725     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
  9726     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
  9727     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
  9728
  9729     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
  9730                                    CM-PART-LAST-NAME-A2
  9731                                    CM-PART-LAST-NAME-A5.
  9732
  9733     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
  9734                                    CM-INSURED-INITIAL1-A2
  9735                                    CM-INSURED-INITIAL1-A5
  9736                                    CM-INSURED-FIRST-NAME.
  9737
  9738     IF CRTINITL GREATER ZERO
  9739         MOVE CRTINITI           TO CM-INSURED-INITIAL2
  9740                                    CM-INSURED-INITIAL2-A2
  9741                                    CM-INSURED-INITIAL2-A5
  9742     ELSE
  9743         MOVE SPACES             TO CM-INSURED-INITIAL2
  9744                                    CM-INSURED-INITIAL2-A2
  9745                                    CM-INSURED-INITIAL2-A5
  9746     END-IF.
  9747
  9748     IF CM-INSURED-INITIALS = SPACES
  9749         MOVE '**'               TO CM-INSURED-INITIALS
  9750     END-IF.
  9751
  9752     IF MEMBERL GREATER ZERO
  9753         MOVE MEMBERI              TO CM-MEMBER-NO
  9754     ELSE
  9755         MOVE CERT-STATE           TO CM-MEMB-STATE
  9756         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
  9757         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
  9758         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
  9759     END-IF.
  9760
  9761     IF JNTLNMEL GREATER ZERO
  9762         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
  9763     END-IF.
  9764
  9765     IF JNTFNMEL GREATER ZERO
  9766         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
  9767     END-IF.
  9768
  9769     IF JNTINITL GREATER ZERO
  9770         MOVE JNTINITI           TO CM-JT-INITIAL
  9771     END-IF.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 187
* EL130.cbl
  9772
  9773     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9774
  9775
  9776
  9777* EXEC CICS HANDLE CONDITION
  9778*        DUPKEY   (3690-CERT-WRITTEN)
  9779*    END-EXEC.
  9780*    MOVE '"$$                   ! 9 #00009083' TO DFHEIV0
  9781     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9782     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9783     MOVE X'3920233030303039303833' TO DFHEIV0(25:11)
  9784     CALL 'kxdfhei1' USING DFHEIV0
  9785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9786
  9787
  9788
  9789
  9790* EXEC CICS WRITE
  9791*        DATASET   (ELCERT-DSID)
  9792*        FROM      (CERTIFICATE-MASTER)
  9793*        RIDFLD    (CM-CONTROL-PRIMARY)
  9794*    END-EXEC.
  9795     MOVE LENGTH OF
  9796      CERTIFICATE-MASTER
  9797       TO DFHEIV11
  9798*    MOVE '&$ L                  ''   #00009088' TO DFHEIV0
  9799     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9800     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9801     MOVE X'2020233030303039303838' TO DFHEIV0(25:11)
  9802     CALL 'kxdfhei1' USING DFHEIV0,
  9803           ELCERT-DSID,
  9804           CERTIFICATE-MASTER,
  9805           DFHEIV11,
  9806           CM-CONTROL-PRIMARY,
  9807           DFHEIV99,
  9808           DFHEIV99
  9809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9810
  9811
  9812 3690-CERT-WRITTEN.
  9813
  9814     GO TO 3800-BUILD-NEW-CLAIM.
  9815
  9816 3690-EXIT.
  9817      EXIT.
  9818
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 188
* EL130.cbl
  9820 3700-BUILD-CERT.
  9821
  9822     IF CERTMTI NOT = 'A'
  9823         GO TO 3700-FINISH-CERT-BUILD
  9824     END-IF.
  9825
  9826     IF CERTMTI = 'A'
  9827         IF LCVCDL = ZEROS
  9828             MOVE ZEROS          TO CM-LF-BENEFIT-CD
  9829                                    CM-LF-ORIG-TERM
  9830                                    CM-LF-BENEFIT-AMT
  9831                                    CM-LF-PREMIUM-RATE
  9832             GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9833         END-IF
  9834     END-IF.
  9835
  9836     IF LCVCDL GREATER ZERO
  9837         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
  9838     END-IF.
  9839
  9840     IF LCVOTRML GREATER ZERO
  9841         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
  9842     END-IF.
  9843
  9844     IF LCVBENEL GREATER ZERO
  9845         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
  9846     END-IF.
  9847
  9848     IF LCVRATEL GREATER ZERO
  9849         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
  9850     END-IF.
  9851
  9852     IF WS-EXPIRE NOT = LOW-VALUES
  9853         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
  9854     END-IF.
  9855
  9856     IF LCVFORML GREATER ZERO
  9857         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
  9858     END-IF.
  9859
  9860     IF LCVCNDTL = ZERO
  9861        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9862     END-IF.
  9863
  9864     IF WS-LCVCNDT NOT = LOW-VALUES
  9865        MOVE '8'                 TO CM-LF-CURRENT-STATUS
  9866        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
  9867        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9868     END-IF.
  9869
  9870     IF CM-LF-CURRENT-STATUS = '7'
  9871        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
  9872        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
  9873        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
  9874                                    CM-LF-DEATH-DT
  9875        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9876     END-IF.
  9877
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 189
* EL130.cbl
  9878     IF CM-LF-CURRENT-STATUS = '8'
  9879        MOVE '1'                 TO CM-LF-CURRENT-STATUS
  9880        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
  9881     END-IF.
  9882
  9883 3700-BUILD-AH-COVERAGE-SIDE.
  9884
  9885     IF CERTMTI = 'A'
  9886         IF ACVCDL = ZEROS
  9887             MOVE ZEROS          TO CM-AH-BENEFIT-CD
  9888                                    CM-AH-ORIG-TERM
  9889                                    CM-AH-BENEFIT-AMT
  9890                                    CM-AH-PREMIUM-RATE
  9891             GO TO 3700-COVERAGE-BUILT
  9892         END-IF
  9893     END-IF.
  9894
  9895     IF ACVCDL GREATER ZERO
  9896         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
  9897     END-IF.
  9898
  9899     IF ACVOTRML GREATER ZERO
  9900         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
  9901     END-IF.
  9902
  9903     IF ACVBENEL GREATER ZERO
  9904         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
  9905     END-IF.
  9906
  9907     IF ACVRATEL GREATER ZERO
  9908         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
  9909     END-IF.
  9910
  9911     IF WS-EXPIRE NOT = LOW-VALUES
  9912         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
  9913     END-IF.
  9914
  9915     IF ACVFORML GREATER ZERO
  9916         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
  9917     END-IF.
  9918
  9919     IF ACVCNDTL = ZERO
  9920        GO TO 3700-COVERAGE-BUILT
  9921     END-IF.
  9922
  9923     IF WS-ACVCNDT NOT = LOW-VALUES
  9924        MOVE '8'                 TO CM-AH-CURRENT-STATUS
  9925        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
  9926        GO TO 3700-COVERAGE-BUILT
  9927     END-IF.
  9928
  9929     IF CM-AH-CURRENT-STATUS = '6'
  9930        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
  9931        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
  9932        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
  9933        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
  9934        GO TO 3700-COVERAGE-BUILT
  9935     END-IF.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 190
* EL130.cbl
  9936
  9937     IF CM-AH-CURRENT-STATUS = '8'
  9938        MOVE '1'                 TO CM-AH-CURRENT-STATUS
  9939        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
  9940     END-IF.
  9941
  9942 3700-COVERAGE-BUILT.
  9943     IF ISSAGEL GREATER ZERO
  9944         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
  9945     END-IF.
  9946
  9947     IF JNTAGEL GREATER ZERO
  9948         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
  9949     END-IF.
  9950
  9951     IF SEXL GREATER ZERO
  9952         MOVE SEXI               TO CM-INSURED-SEX
  9953     END-IF.
  9954
  9955     IF APRL GREATER ZERO
  9956         MOVE WS-APR             TO CM-LOAN-APR
  9957     END-IF.
  9958
  9959     IF PMTFREQL GREATER ZERO
  9960         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
  9961     END-IF.
  9962
  9963     IF INDGRPL GREATER ZERO
  9964         MOVE INDGRPI            TO CM-IND-GRP-TYPE
  9965     END-IF.
  9966
  9967     IF CERTMTI = 'A'
  9968         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
  9969     END-IF.
  9970
  9971     IF REINCDL GREATER ZERO
  9972         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
  9973                                    WS-REIN-1
  9974                                    WS-REIN-2
  9975                                    WS-REIN-3
  9976         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
  9977     END-IF.
  9978
  9979     IF WS-ADD-ON-DT NOT = LOW-VALUES
  9980         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
  9981     END-IF.
  9982
  9983     IF CRTSSNL GREATER ZERO
  9984         MOVE CRTSSNI            TO CM-SOC-SEC-NO
  9985     ELSE
  9986         IF SSNL GREATER ZERO
  9987             MOVE SSNI           TO CM-SOC-SEC-NO
  9988         END-IF
  9989     END-IF.
  9990
  9991     IF CRTSSNL = ZERO AND
  9992        SSNL    = ZERO
  9993         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 191
* EL130.cbl
  9994         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
  9995         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
  9996         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
  9997     END-IF.
  9998
  9999     IF CM-LF-CURRENT-STATUS = SPACES
 10000         MOVE '1'                TO CM-LF-CURRENT-STATUS
 10001     END-IF.
 10002
 10003     IF CM-AH-CURRENT-STATUS = SPACES
 10004         MOVE '1'                TO CM-AH-CURRENT-STATUS
 10005     END-IF.
 10006
 10007     IF CERTMTI = 'A'
 10008         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10009     END-IF.
 10010
 10011 3700-FINISH-CERT-BUILD.
 10012
 10013     IF LOANNOL GREATER ZERO
 10014         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10015     END-IF.
 10016
 10017     IF LOANBALL GREATER ZERO
 10018         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10019     END-IF.
 10020
 10021     IF PREMTYPL GREATER ZERO
 10022         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10023     END-IF.
 10024
 10025 3700-EXIT.
 10026      EXIT.
 10027
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 192
* EL130.cbl
 10029 3800-BUILD-NEW-CLAIM.
 10030
 10031*************************************************************
 10032*****           START OF ACTIVITY FILE PROCESSING          **
 10033*************************************************************
 10034     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10035         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10036                 6700-EXIT
 10037     END-IF.
 10038*************************************************************
 10039*****            END OF ACTIVITY FILE PROCESSING           **
 10040*************************************************************
 10041
 10042
 10043
 10044
 10045* EXEC CICS GETMAIN
 10046*        SET     (ADDRESS OF CLAIM-MASTER)
 10047*        LENGTH  (ELMSTR-LENGTH)
 10048*    END-EXEC.
 10049*    MOVE '," L                  $   #00009326' TO DFHEIV0
 10050     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10051     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10052     MOVE X'2020233030303039333236' TO DFHEIV0(25:11)
 10053     CALL 'kxdfhei1' USING DFHEIV0,
 10054           DFHEIV20,
 10055           ELMSTR-LENGTH,
 10056           DFHEIV99
 10057     SET ADDRESS OF CLAIM-MASTER TO
 10058         DFHEIV20
 10059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10060
 10061
 10062     MOVE SPACES TO CLAIM-MASTER.
 10063
 10064     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10065         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10066         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10067         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10068         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10069         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10070         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10071         CL-ACTIVITY-MAINT-DT.
 10072
 10073     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10074             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10075             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10076             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10077             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10078             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10079             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10080             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10081             CL-FORCEABLE-ERROR-CNT.
 10082
 10083     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10084
 10085     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10086                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 193
* EL130.cbl
 10087                                    CL-LAG-REPORT-CODE.
 10088
 10089     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10090     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10091
 10092     IF BENECDL NOT = ZEROS
 10093        MOVE BENECDI             TO CL-BENEFICIARY
 10094     END-IF.
 10095
 10096     MOVE 'CL'                   TO CL-RECORD-ID.
 10097     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10098
 10099     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10100                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10101                             CL-COMPANY-CD-A5.
 10102
 10103     MOVE CLMCARRI               TO CL-CARRIER.
 10104
 10105     IF CLMNOL = ZERO
 10106         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10107     ELSE
 10108         MOVE CLMNOI             TO CL-CLAIM-NO
 10109     END-IF.
 10110
 10111     MOVE CERTNOI                TO CL-CERT-PRIME
 10112                                    CL-CERT-A4-PRIME.
 10113
 10114     MOVE SUFXI                  TO CL-CERT-SFX
 10115                                    CL-CERT-A4-SFX.
 10116
 10117     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10118
 10119     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10120
 10121     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10122
 10123     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10124
 10125     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10126     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10127
 10128     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10129
 10130     IF CERTMTI = 'A'
 10131         MOVE '2'                TO CL-CERT-ORIGIN
 10132     ELSE
 10133         MOVE '1'                TO CL-CERT-ORIGIN
 10134     END-IF.
 10135
 10136     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10137     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10138     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10139     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10140     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10141
 10142 3820-REWRITE-CONTROL-FILE.
 10143
 10144     IF CLMNOL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 194
* EL130.cbl
 10145         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10146     END-IF.
 10147
 10148     IF CF-RECORD-TYPE = '6'
 10149         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10150     ELSE
 10151         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10152     END-IF.
 10153
 10154
 10155
 10156* EXEC CICS REWRITE
 10157*        DATASET   (ELCNTL-DSID)
 10158*        FROM      (CONTROL-FILE)
 10159*    END-EXEC.
 10160     MOVE LENGTH OF
 10161      CONTROL-FILE
 10162       TO DFHEIV11
 10163*    MOVE '&& L                  %   #00009424' TO DFHEIV0
 10164     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10165     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10166     MOVE X'2020233030303039343234' TO DFHEIV0(25:11)
 10167     CALL 'kxdfhei1' USING DFHEIV0,
 10168           ELCNTL-DSID,
 10169           CONTROL-FILE,
 10170           DFHEIV11,
 10171           DFHEIV99
 10172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10173
 10174
 10175 3830-SEQUENCE-CLAIM-RECORDS.
 10176
 10177     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10178     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10179     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10180
 10181     IF WS-ASSOC-CERT-TOTAL = ZERO
 10182         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10183                                    CL-ASSOC-CERT-TOTAL
 10184         GO TO 3840-WRITE-CLAIM-MASTER
 10185     END-IF.
 10186
 10187     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10188         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10189     ELSE
 10190         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10191     END-IF.
 10192
 10193     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10194     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10195     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10196
 10197 3840-WRITE-CLAIM-MASTER.
 10198
 10199     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
 10200     IF WS-REC-FOUND-SW = 'Y'
 10201         MOVE 01                 TO  CL-ACTIVITY-CODE
 10202         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 195
* EL130.cbl
 10203         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10204     END-IF.
 10205
 10206
 10207
 10208* EXEC CICS HANDLE CONDITION
 10209*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10210*    END-EXEC.
 10211*    MOVE '"$$                   ! : #00009461' TO DFHEIV0
 10212     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10213     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10214     MOVE X'3A20233030303039343631' TO DFHEIV0(25:11)
 10215     CALL 'kxdfhei1' USING DFHEIV0
 10216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10217
 10218
 10219** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10220     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10221
 10222
 10223
 10224* EXEC CICS WRITE
 10225*        DATASET   (ELMSTR-DSID)
 10226*        FROM      (CLAIM-MASTER)
 10227*        RIDFLD    (CL-CONTROL-PRIMARY)
 10228*    END-EXEC.
 10229     MOVE LENGTH OF
 10230      CLAIM-MASTER
 10231       TO DFHEIV11
 10232*    MOVE '&$ L                  ''   #00009469' TO DFHEIV0
 10233     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10234     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10235     MOVE X'2020233030303039343639' TO DFHEIV0(25:11)
 10236     CALL 'kxdfhei1' USING DFHEIV0,
 10237           ELMSTR-DSID,
 10238           CLAIM-MASTER,
 10239           DFHEIV11,
 10240           CL-CONTROL-PRIMARY,
 10241           DFHEIV99,
 10242           DFHEIV99
 10243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10244
 10245
 10246 3850-CLAIM-MSTR-WRITTEN.
 10247
 10248     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10249         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10250     END-IF.
 10251
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 196
* EL130.cbl
 10253 3990-ADD-DONE.
 10254     MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10255                                   EMI-SUB      EMI-SWITCH-AREA-2.
 10256     MOVE SPACES                TO EMI-ACTION-SWITCH
 10257                                   EMI-ERROR-LINES.
 10258
 10259     IF CLMNOL = ZERO
 10260         MOVE ER-0265            TO EMI-ERROR
 10261         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10262         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (1)
 10263                                    PI-LAST-CLAIM
 10264     ELSE
 10265         MOVE CLMNOI             TO PI-LAST-CLAIM
 10266         MOVE ER-0000            TO EMI-ERROR
 10267         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10268     END-IF.
 10269
 10270     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 10271       AND PI-ST-VFY-2ND-BENE = 'Y'
 10272         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10273         MOVE ER-7575            TO EMI-ERROR
 10274         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10275     END-IF.
 10276
 10277     IF WS-NO-INSURED-ADDRESS = 'Y'
 10278         MOVE ER-3548            TO EMI-ERROR
 10279         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10280     END-IF.
 10281
 10282     IF PI-ST-CAUSAL-STATE = 'B'  OR
 10283       (PI-ST-CAUSAL-STATE = 'L' AND
 10284              CLMTYPEI = PI-LIFE-OVERRIDE-L1)   OR
 10285       (PI-ST-CAUSAL-STATE = 'A' AND
 10286              CLMTYPEI = PI-AH-OVERRIDE-L1)
 10287         PERFORM 3994B-BUILD-NINETY-FOUR-TRAILER THRU 3994B-EXIT
 10288         MOVE ER-7577            TO EMI-ERROR
 10289         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10290     END-IF.
 10291
 10292     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10293     MOVE CLMCARRI                   TO  PI-CARRIER.
 10294     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10295     MOVE SUFXI                      TO  PI-CERT-SFX.
 10296
 10297     IF WS-LETTER-SW = 'Y'
 10298         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
 10299         IF W-1523-ERROR-CODE NOT = ZEROS
 10300             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10301             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10302         END-IF
 10303     END-IF.
 10304
 10305     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10306     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10307     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10308     MOVE CLMCARRI               TO PI-LAST-CARR.
 10309
 10310     IF PRTOPTL GREATER THAN 0
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 197
* EL130.cbl
 10311         MOVE PRTOPTI            TO PI-PRT-OPT
 10312     END-IF.
 10313     IF ALTPRTL GREATER THAN 0
 10314         MOVE ALTPRTI            TO PI-ALT-PRT
 10315     END-IF.
 10316
 10317     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10318         MOVE LOW-VALUES         TO EL130AI
 10319         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10320         MOVE AL-SANON           TO CERTNOA
 10321         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10322         MOVE AL-SANON           TO SUFXA
 10323         MOVE PI-LAST-CARR       TO CLMCARRO
 10324         MOVE AL-UANON           TO CLMCARRA
 10325         MOVE PI-LAST-CLAIM      TO CLMNOO
 10326         MOVE AL-UANON           TO CLMNOA
 10327         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10328         MOVE AL-UANON           TO CLMTYPEA
 10329     ELSE
 10330         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10331         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10332     END-IF.
 10333
 10334     IF PI-PRT-OPT = 'N' OR 'L'
 10335         MOVE PI-PRT-OPT         TO PRTOPTO
 10336         MOVE 1                  TO PRTOPTL
 10337     END-IF.
 10338
 10339     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10340         MOVE PI-ALT-PRT         TO ALTPRTO
 10341         MOVE 4                  TO ALTPRTL
 10342     END-IF.
 10343
 10344     IF PRTOPTL GREATER THAN 0
 10345         IF PRTOPTI = 'L'
 10346             GO TO 0400-CREATE-ELACTQ
 10347         ELSE
 10348             GO TO 0480-PRINT-NOW
 10349         END-IF
 10350     END-IF.
 10351
 10352     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10353         GO TO 8100-SEND-INITIAL-MAP
 10354     ELSE
 10355         MOVE LOW-VALUES         TO MAINTO
 10356         MOVE -1                 TO MAINTL
 10357         GO TO 8200-SEND-DATAONLY
 10358     END-IF.
 10359
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 198
* EL130.cbl
 10361 3993-MODIFY-SCREEN-ATTRB.
 10362
 10363     IF CERTMTL GREATER ZERO
 10364         MOVE AL-UANON           TO CERTMTA
 10365     END-IF.
 10366
 10367     IF EFFDTL GREATER ZERO
 10368         MOVE AL-UANON           TO EFFDTA
 10369     END-IF.
 10370
 10371     IF ACCOUNTL GREATER ZERO
 10372         MOVE AL-UANON           TO ACCOUNTA
 10373     END-IF.
 10374
 10375     IF STATEL GREATER ZERO
 10376         MOVE AL-UANON           TO STATEA
 10377     END-IF.
 10378
 10379     IF CRTCARRL GREATER ZERO
 10380         MOVE AL-UANON           TO CRTCARRA
 10381     END-IF.
 10382
 10383     IF GROUPL GREATER ZERO
 10384         MOVE AL-UANON           TO GROUPA
 10385     END-IF.
 10386
 10387     IF CRTLNMEL GREATER ZERO
 10388         MOVE AL-UANON           TO CRTLNMEA
 10389     END-IF.
 10390
 10391     IF CRTFNMEL GREATER ZERO
 10392         MOVE AL-UANON           TO CRTFNMEA
 10393     END-IF.
 10394
 10395     IF CRTINITL GREATER ZERO
 10396         MOVE AL-UANON           TO CRTINITA
 10397     END-IF.
 10398
 10399     IF ISSAGEL GREATER ZERO
 10400         MOVE AL-UNNON           TO ISSAGEA
 10401     END-IF.
 10402
 10403     IF JNTLNMEL GREATER ZERO
 10404         MOVE AL-UANON           TO JNTLNMEA
 10405     END-IF.
 10406
 10407     IF JNTFNMEL GREATER ZERO
 10408         MOVE AL-UANON           TO JNTFNMEA
 10409     END-IF.
 10410
 10411     IF JNTINITL GREATER ZERO
 10412         MOVE AL-UANON           TO JNTINITA
 10413     END-IF.
 10414
 10415     IF JNTAGEL GREATER ZERO
 10416         MOVE AL-UNNON           TO JNTAGEA
 10417     END-IF.
 10418
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 199
* EL130.cbl
 10419     IF CRTSSNL GREATER ZERO
 10420         MOVE AL-UANON           TO CRTSSNA
 10421     END-IF.
 10422
 10423     IF ACVDSCRL GREATER ZERO
 10424         MOVE AL-SANON           TO ACVDSCRA
 10425     END-IF.
 10426
 10427     IF ACVKINDL GREATER ZERO
 10428         MOVE AL-SANON           TO ACVKINDA
 10429     END-IF.
 10430
 10431     IF ACVCDL GREATER ZERO
 10432         MOVE AL-UANON           TO ACVCDA
 10433     END-IF.
 10434
 10435     IF ACVOTRML GREATER ZERO
 10436         MOVE AL-UNNON           TO ACVOTRMA
 10437     END-IF.
 10438
 10439     IF ACVRTRML GREATER ZERO
 10440         MOVE AL-UNNON           TO ACVRTRMA
 10441     END-IF.
 10442
 10443     IF ACVRATEL GREATER ZERO
 10444         MOVE AL-UNNON           TO ACVRATEA
 10445     END-IF.
 10446
 10447     IF ACVBENEL GREATER ZERO
 10448         MOVE AL-UNNON           TO ACVBENEA
 10449     END-IF.
 10450
 10451     IF ACVFORML GREATER ZERO
 10452         MOVE AL-UANON           TO ACVFORMA
 10453     END-IF.
 10454
 10455     IF ACVCNDTL GREATER ZERO
 10456         MOVE AL-UANON           TO ACVCNDTA
 10457     END-IF.
 10458
 10459     IF ACVEXITL GREATER ZERO
 10460         MOVE AL-UANON           TO ACVEXITA
 10461     END-IF.
 10462
 10463     IF ACVSTATL GREATER ZERO
 10464         MOVE AL-UANON           TO ACVSTATA
 10465     END-IF.
 10466
 10467     IF LCVDSCRL GREATER ZERO
 10468         MOVE AL-SANON           TO LCVDSCRA
 10469     END-IF.
 10470
 10471     IF LCVKINDL GREATER ZERO
 10472         MOVE AL-SANON           TO LCVKINDA
 10473     END-IF.
 10474
 10475     IF LCVCDL GREATER ZERO
 10476         MOVE AL-UANON           TO LCVCDA
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 200
* EL130.cbl
 10477     END-IF.
 10478
 10479     IF LCVOTRML GREATER ZERO
 10480         MOVE AL-UNNON           TO LCVOTRMA
 10481     END-IF.
 10482
 10483     IF LCVRTRML GREATER ZERO
 10484         MOVE AL-UNNON           TO LCVRTRMA
 10485     END-IF.
 10486
 10487     IF LCVRATEL GREATER ZERO
 10488         MOVE AL-UNNON           TO LCVRATEA
 10489     END-IF.
 10490
 10491     IF LCVBENEL GREATER ZERO
 10492         MOVE AL-UNNON           TO LCVBENEA
 10493     END-IF.
 10494
 10495     IF LCVFORML GREATER ZERO
 10496         MOVE AL-UANON           TO LCVFORMA
 10497     END-IF.
 10498
 10499     IF LCVCNDTL GREATER ZERO
 10500         MOVE AL-UANON           TO LCVCNDTA
 10501     END-IF.
 10502
 10503     IF LCVEXITL GREATER ZERO
 10504         MOVE AL-UANON           TO LCVEXITA
 10505     END-IF.
 10506
 10507     IF LCVSTATL GREATER ZERO
 10508         MOVE AL-UANON           TO LCVSTATA
 10509     END-IF.
 10510
 10511     IF MEMCAPL GREATER ZERO
 10512         MOVE AL-UANON           TO MEMCAPA
 10513     END-IF.
 10514
 10515     IF APRL GREATER ZERO
 10516         MOVE AL-UNNON           TO APRA
 10517     END-IF.
 10518
 10519     IF PMTFREQL GREATER ZERO
 10520         MOVE AL-UNNON           TO PMTFREQA
 10521     END-IF.
 10522
 10523     IF INDGRPL GREATER ZERO
 10524         MOVE AL-UANON           TO INDGRPA
 10525     END-IF.
 10526
 10527     IF PREMTYPL GREATER ZERO
 10528         MOVE AL-UANON           TO PREMTYPA
 10529     END-IF.
 10530
 10531     IF REINCDL GREATER ZERO
 10532         MOVE AL-UANON           TO REINCDA
 10533     END-IF.
 10534
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 201
* EL130.cbl
 10535     IF ADDONDTL GREATER ZERO
 10536         MOVE AL-UANON           TO ADDONDTA
 10537     END-IF.
 10538
 10539     IF MEMBERL GREATER ZERO
 10540         MOVE AL-UANON           TO MEMBERA
 10541     END-IF.
 10542
 10543     IF BCERT1L GREATER ZERO
 10544         MOVE AL-SANON           TO BCERT1A
 10545                                    BSUFX1A
 10546     END-IF.
 10547
 10548     IF BCERT2L GREATER ZERO
 10549         MOVE AL-SANON           TO BCERT2A
 10550                                    BSUFX2A
 10551     END-IF.
 10552
 10553     IF BCERT3L GREATER ZERO
 10554         MOVE AL-SANON           TO BCERT3A
 10555                                    BSUFX3A
 10556     END-IF.
 10557
 10558     IF BCERT4L GREATER ZERO
 10559         MOVE AL-SANON           TO BCERT4A
 10560                                    BSUFX4A
 10561     END-IF.
 10562
 10563     IF BCERT5L GREATER ZERO
 10564         MOVE AL-SANON           TO BCERT5A
 10565                                    BSUFX5A
 10566     END-IF.
 10567
 10568 3993-MODIFY-CLAIM-ATTRB.
 10569
 10570     IF PCERTNOL GREATER ZERO
 10571         MOVE AL-UANON           TO PCERTNOA
 10572     END-IF.
 10573
 10574     IF PSUFXL GREATER ZERO
 10575         MOVE AL-UANON           TO PSUFXA
 10576     END-IF.
 10577
 10578     IF LSTNMEL GREATER ZERO
 10579         MOVE AL-UANON           TO LSTNMEA
 10580     END-IF.
 10581
 10582     IF FSTNMEL GREATER ZERO
 10583         MOVE AL-UANON           TO FSTNMEA
 10584     END-IF.
 10585
 10586     IF INITL GREATER ZERO
 10587         MOVE AL-UANON           TO INITA
 10588     END-IF.
 10589
 10590     IF SEXL GREATER ZERO
 10591         MOVE AL-UANON           TO SEXA
 10592     END-IF.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 202
* EL130.cbl
 10593
 10594     IF OCCCDL GREATER ZERO
 10595         MOVE AL-UANON           TO OCCCDA
 10596     END-IF.
 10597
 10598     IF BIRTHDTL GREATER ZERO
 10599         MOVE AL-UANON           TO BIRTHDTA
 10600     END-IF.
 10601
 10602     IF SSNL GREATER ZERO
 10603         MOVE AL-UANON           TO SSNA
 10604     END-IF.
 10605
 10606     IF INCURL GREATER ZERO
 10607         MOVE AL-UANON           TO INCURA
 10608     END-IF.
 10609
 10610     IF REPORTL GREATER ZERO
 10611         MOVE AL-UANON           TO REPORTA
 10612     END-IF.
 10613
 10614     IF ESTENDL GREATER ZERO
 10615         MOVE AL-UANON           TO ESTENDA
 10616     END-IF.
 10617
 10618     IF DIAGL GREATER ZERO
 10619         MOVE AL-UANON           TO DIAGA
 10620     END-IF.
 10621
 10622     IF CAUSEL GREATER ZERO
 10623         MOVE AL-UANON           TO CAUSEA
 10624     END-IF.
 10625
 10626     IF MANRSVL GREATER ZERO
 10627         MOVE AL-UNNON           TO MANRSVA
 10628     END-IF.
 10629
 10630     IF RELCLML GREATER ZERO
 10631         MOVE AL-UANON           TO RELCLMA
 10632     END-IF.
 10633
 10634     IF LOANNOL GREATER ZERO
 10635         MOVE AL-UANON           TO LOANNOA
 10636     END-IF.
 10637
 10638     IF LOANBALL GREATER ZERO
 10639         MOVE AL-UNNON           TO LOANBALA
 10640     END-IF.
 10641
 10642     IF PROCCDL GREATER ZERO
 10643         MOVE AL-UANON           TO PROCCDA
 10644     END-IF.
 10645
 10646     IF BENECDL GREATER THAN ZERO
 10647         MOVE AL-UANON           TO  BENECDA
 10648     END-IF.
 10649
 10650     IF PRICDL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 203
* EL130.cbl
 10651         MOVE AL-UANON           TO PRICDA
 10652     END-IF.
 10653
 10654     IF SUPVL GREATER ZERO
 10655         MOVE AL-UANON           TO SUPVA
 10656     END-IF.
 10657
 10658     IF FILETOL GREATER ZERO
 10659         MOVE AL-UANON           TO FILETOA
 10660     END-IF.
 10661
 10662
 10663 3993-MODIFY-CLAIM-KEY-ATTRB.
 10664
 10665     IF CLMNOL GREATER ZERO
 10666         MOVE AL-UANON           TO CLMNOA
 10667     END-IF.
 10668
 10669     IF CLMCARRL GREATER ZERO
 10670         MOVE AL-UANON           TO CLMCARRA
 10671     END-IF.
 10672
 10673     IF CLMTYPEL GREATER ZERO
 10674         MOVE AL-UANON           TO CLMTYPEA
 10675     END-IF.
 10676
 10677     IF CERTNOL GREATER ZERO
 10678         MOVE AL-SANON           TO CERTNOA
 10679     END-IF.
 10680
 10681     IF SUFXL GREATER ZERO
 10682         MOVE AL-SANON           TO SUFXA
 10683     END-IF.
 10684
 10685 3993-EXIT.
 10686     EXIT.
 10687
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 204
* EL130.cbl
 10689 3994-BUILD-NINETY-THREE-TRAILER.
 10690
 10691     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 10692     MOVE 'AT'                   TO AT-RECORD-ID.
 10693
 10694     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 10695     MOVE CLMCARRI               TO AT-CARRIER.
 10696
 10697     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 10698     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 10699     MOVE +93                    TO AT-SEQUENCE-NO.
 10700     MOVE '6'                    TO AT-TRAILER-TYPE.
 10701     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 10702
 10703     MOVE WS-VERIFY-NOTE         TO AT-INFO-LINE-1.
 10704
 10705     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 10706                                    AT-GEN-INFO-LAST-MAINT-DT.
 10707
 10708     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10709                                    AT-GEN-INFO-LAST-UPDATED-BY.
 10710     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10711
 10712
 10713
 10714* EXEC CICS WRITE
 10715*        DATASET   (ELTRLR-DSID)
 10716*        FROM      (ACTIVITY-TRAILERS)
 10717*        RIDFLD    (AT-CONTROL-PRIMARY)
 10718*    END-EXEC.
 10719     MOVE LENGTH OF
 10720      ACTIVITY-TRAILERS
 10721       TO DFHEIV11
 10722*    MOVE '&$ L                  ''   #00009942' TO DFHEIV0
 10723     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10724     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10725     MOVE X'2020233030303039393432' TO DFHEIV0(25:11)
 10726     CALL 'kxdfhei1' USING DFHEIV0,
 10727           ELTRLR-DSID,
 10728           ACTIVITY-TRAILERS,
 10729           DFHEIV11,
 10730           AT-CONTROL-PRIMARY,
 10731           DFHEIV99,
 10732           DFHEIV99
 10733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10734
 10735
 10736 3994-EXIT.
 10737     EXIT.
 10738
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 205
* EL130.cbl
 10740 3994B-BUILD-NINETY-FOUR-TRAILER.
 10741
 10742     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 10743     MOVE 'AT'                   TO AT-RECORD-ID.
 10744
 10745     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 10746     MOVE CLMCARRI               TO AT-CARRIER.
 10747
 10748     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 10749     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 10750     MOVE +94                    TO AT-SEQUENCE-NO.
 10751     MOVE '6'                    TO AT-TRAILER-TYPE.
 10752     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 10753
 10754     MOVE WS-CAUSAL-NOTE         TO AT-INFO-LINE-1.
 10755
 10756     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 10757                                    AT-GEN-INFO-LAST-MAINT-DT.
 10758
 10759     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10760                                    AT-GEN-INFO-LAST-UPDATED-BY.
 10761     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10762
 10763
 10764
 10765* EXEC CICS WRITE
 10766*        DATASET   (ELTRLR-DSID)
 10767*        FROM      (ACTIVITY-TRAILERS)
 10768*        RIDFLD    (AT-CONTROL-PRIMARY)
 10769*    END-EXEC.
 10770     MOVE LENGTH OF
 10771      ACTIVITY-TRAILERS
 10772       TO DFHEIV11
 10773*    MOVE '&$ L                  ''   #00009976' TO DFHEIV0
 10774     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10775     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10776     MOVE X'2020233030303039393736' TO DFHEIV0(25:11)
 10777     CALL 'kxdfhei1' USING DFHEIV0,
 10778           ELTRLR-DSID,
 10779           ACTIVITY-TRAILERS,
 10780           DFHEIV11,
 10781           AT-CONTROL-PRIMARY,
 10782           DFHEIV99,
 10783           DFHEIV99
 10784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10785
 10786
 10787 3994B-EXIT.
 10788     EXIT.
 10789
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 206
* EL130.cbl
 10791 3995-BUILD-CLAIM-RECORD.
 10792
 10793     IF PROCCDL GREATER ZERO
 10794         MOVE PROCCDI            TO CL-PROCESSOR-ID
 10795     ELSE
 10796         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 10797     END-IF.
 10798
 10799     IF FSTNMEL GREATER ZERO
 10800         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 10801     END-IF.
 10802
 10803     IF INITL GREATER ZERO
 10804         MOVE INITI              TO CL-INSURED-MID-INIT
 10805     END-IF.
 10806
 10807     IF BIRTHDTL GREATER ZERO
 10808         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 10809     END-IF.
 10810
 10811     IF SEXL GREATER ZERO
 10812         MOVE SEXI               TO CL-INSURED-SEX-CD
 10813     END-IF.
 10814
 10815     IF OCCCDL GREATER ZERO
 10816         MOVE OCCCDI             TO CL-INSURED-OCC-CD
 10817     END-IF.
 10818
 10819     MOVE 'O'                    TO CL-CLAIM-STATUS.
 10820
 10821*    IF CLMTYPEL GREATER ZERO
 10822     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 10823*    END-IF.
 10824
 10825     IF PREMTYPL GREATER ZERO
 10826         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 10827     END-IF.
 10828
 10829     IF INCURL GREATER ZERO
 10830         MOVE WS-INCUR           TO CL-INCURRED-DT
 10831     END-IF.
 10832
 10833     IF REPORTL GREATER ZERO
 10834         MOVE WS-REPORT          TO CL-REPORTED-DT
 10835     END-IF.
 10836
 10837     IF EIBAID = DFHPF6
 10838         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
 10839             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 10840                 IF EMI-FORCABLE-CTR = +1
 10841                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 10842                 END-IF
 10843         END-IF
 10844     END-IF.
 10845
 10846     IF ESTENDL GREATER ZERO
 10847        MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 10848     END-IF.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 207
* EL130.cbl
 10849
 10850     IF ADDONDTL GREATER ZERO
 10851         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 10852     END-IF.
 10853
 10854     IF CAUSEL GREATER ZERO
 10855         MOVE CAUSEI             TO CL-CAUSE-CD
 10856     END-IF.
 10857
 10858     IF SSNL GREATER ZERO
 10859         MOVE SSNI               TO CL-SOC-SEC-NO
 10860     ELSE
 10861         MOVE CERT-STATE         TO CL-SSN-STATE
 10862         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 10863         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 10864     END-IF.
 10865
 10866     IF PRICDL GREATER ZERO
 10867         MOVE PRICDI             TO CL-PRIORITY-CD
 10868     END-IF.
 10869
 10870     IF SUPVL GREATER ZERO
 10871         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 10872     END-IF.
 10873
 10874     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 10875     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 10876     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 10877
 10878     IF RELCLML GREATER ZERO
 10879         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 10880     END-IF.
 10881
 10882     IF FILETOL GREATER ZERO
 10883         MOVE FILETOI            TO CL-FILE-LOCATION
 10884     END-IF.
 10885
 10886 3995-EXIT.
 10887      EXIT.
 10888
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 208
* EL130.cbl
 10890 4000-CALCULATE-CERT-TERM.
 10891
 10892     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 10893
 10894     MOVE N                      TO WS-TERM.
 10895
 10896     IF WS-TERM GREATER 120
 10897         MOVE 120                TO WS-TERM
 10898     END-IF.
 10899
 10900 4000-CALC-TERM-EXIT.
 10901      EXIT.
 10902
 10903 4100-CALC-GROSS-TERM.
 10904     MOVE HOLD-LOAN-BAL           TO L.
 10905     MOVE WS-ACVBENE              TO M.
 10906     COMPUTE N = L / M.
 10907     IF N LESS 1
 10908         MOVE 1  TO N
 10909     END-IF.
 10910
 10911     IF LCVCDL GREATER ZERO
 10912         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 10913     ELSE
 10914         MOVE ZEROS               TO WS-LF-RATE
 10915     END-IF.
 10916
 10917     IF ACVCDL GREATER ZERO
 10918         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 10919     ELSE
 10920         MOVE ZEROS               TO WS-AH-RATE
 10921     END-IF.
 10922
 10923     COMPUTE I = WS-APR / +1200.
 10924
 10925 4105-LOOP.
 10926     IF N GREATER 240
 10927         GO TO 4200-EXIT
 10928     END-IF.
 10929
 10930     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 10931
 10932     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 10933         ADD 1 TO N
 10934         GO TO 4105-LOOP
 10935     END-IF.
 10936
 10937 4200-EXIT.
 10938      EXIT.
 10939
 10940 4210-CALC-LEFT-RIGHTONE.
 10941      MOVE L         TO LEFT-TOT-1.
 10942      SUBTRACT 1 FROM N.
 10943      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 10944      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 10945      ADD 1 TO N.
 10946
 10947 4211-CALC-TERM1.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 209
* EL130.cbl
 10948      MOVE N         TO TERM1.
 10949      MULTIPLY M BY TERM1.
 10950
 10951 4212-LOOP.
 10952      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 10953      ADD 1 TO A-N.
 10954      MULTIPLY A-N BY TERM1.
 10955      SUBTRACT 1 FROM A-N.
 10956      ADD TERM1 TO LEFT-TOT-1.
 10957
 10958 4213-CALC-TERM2.
 10959      MOVE M         TO TERM2.
 10960      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 10961      MULTIPLY IA-N BY TERM2.
 10962      SUBTRACT TERM2 FROM LEFT-TOT-1.
 10963
 10964 4215-CALC-RIGHTONE.
 10965      MOVE M         TO RIGHT-TOT-1.
 10966      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 10967      MULTIPLY A-N BY RIGHT-TOT-1.
 10968
 10969 4220-EXIT.
 10970      EXIT.
 10971
 10972 4300-CALC-A-N.
 10973     IF N LESS 1
 10974         MOVE 0     TO A-N
 10975         GO TO 4300-EXIT
 10976     END-IF.
 10977
 10978     IF I = 0
 10979         MOVE .00001 TO I
 10980     END-IF.
 10981
 10982     ADD 1 TO I.
 10983     DIVIDE I INTO 1 GIVING V.
 10984     SUBTRACT 1 FROM I.
 10985     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 10986     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 10987     DIVIDE I INTO TERM3 GIVING A-N.
 10988
 10989 4300-EXIT.
 10990      EXIT.
 10991
 10992 4350-CALC-IA-N.
 10993     IF N LESS 1
 10994         MOVE 0      TO IA-N
 10995         GO TO 4400-EXIT
 10996     END-IF.
 10997
 10998     ADD 1 TO N.
 10999     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 11000     SUBTRACT 1 FROM N.
 11001     MULTIPLY N BY V-EX-N GIVING TERM3.
 11002     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 11003     SUBTRACT V FROM 1 GIVING TERM4.
 11004     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 11005
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 210
* EL130.cbl
 11006 4400-EXIT.
 11007      EXIT.
 11008
 11009 4450-CALC-V-EX-N.
 11010     IF N LESS 1
 11011         MOVE 1    TO V-EX-N
 11012         GO TO 4490-EXIT
 11013     END-IF.
 11014
 11015     MOVE N        TO NV-STORE.
 11016
 11017     IF V-EX-ONETIME = 1  OR
 11018        V NOT = V-EXPONENT (1)
 11019          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 11020     END-IF.
 11021
 11022 4460-LOOP.
 11023     IF N GREATER 248
 11024         MOVE 248 TO N
 11025     END-IF.
 11026
 11027     IF N = 1
 11028         MOVE V               TO V-EX-N
 11029     ELSE
 11030         MOVE V-EXPONENT (N)  TO V-EX-N
 11031     END-IF.
 11032
 11033     GO TO 4490-EXIT.
 11034
 11035 4470-BUILD-V-EX-TABLE.
 11036     MOVE 2      TO N.
 11037     MOVE V      TO V-EXPONENT (1)
 11038                    V-EX-N.
 11039
 11040 4471-LOOP.
 11041     MULTIPLY V BY V-EX-N.
 11042     MOVE V-EX-N   TO V-EXPONENT (N).
 11043
 11044     ADD 1 TO N.
 11045     IF N LESS 248
 11046         GO TO 4471-LOOP
 11047     END-IF.
 11048
 11049     MOVE NV-STORE     TO N.
 11050     MOVE ZERO         TO V-EX-ONETIME.
 11051
 11052 4480-EXIT.
 11053      EXIT.
 11054
 11055 4490-EXIT.
 11056      EXIT.
 11057
 11058 4500-CALC-NET-TERM.
 11059     MOVE HOLD-LOAN-BAL           TO L.
 11060     MOVE WS-ACVBENE              TO M.
 11061     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 11062
 11063     IF WS-REMAIN GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 211
* EL130.cbl
 11064         ADD 1 TO N
 11065     END-IF.
 11066
 11067     IF N = 0
 11068         MOVE 1 TO N
 11069     END-IF.
 11070
 11071 4700-EXIT.
 11072      EXIT.
 11073
 11074 4999-CALC-TERM-EXIT.
 11075     EXIT.
 11076
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 212
* EL130.cbl
 11078 5000-INCURRED-CHANGE.
 11079     IF NOT MODIFY-CAP
 11080         MOVE ER-0070            TO EMI-ERROR
 11081         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11082         MOVE -1                 TO MAINTL
 11083         GO TO 8200-SEND-DATAONLY
 11084     END-IF.
 11085
 11086     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 11087        CLMCARRI     NOT = PI-LAST-CARR        OR
 11088        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 11089        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 11090        PI-INCURR-SW NOT = 'Y'
 11091          GO TO 1000-SHOW-CLAIM
 11092     END-IF.
 11093
 11094     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 11095     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 11096     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 11097
 11098     IF EMI-NO-ERRORS
 11099         GO TO 5000-TRY-TO-BUILD
 11100     END-IF.
 11101
 11102     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 11103        MOVE ER-0433             TO EMI-ERROR
 11104        MOVE -1                  TO MAINTL
 11105        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11106        GO TO 8200-SEND-DATAONLY
 11107     END-IF.
 11108
 11109     IF EIBAID = DFHPF6
 11110         IF EMI-FATAL-CTR NOT EQUAL ZERO
 11111            MOVE ER-0434         TO EMI-ERROR
 11112            MOVE -1              TO MAINTL
 11113            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11114            GO TO 8200-SEND-DATAONLY
 11115         ELSE
 11116            MOVE +1              TO INCURL
 11117            GO TO 5000-TRY-TO-BUILD
 11118         END-IF
 11119     END-IF.
 11120
 11121     GO TO 8200-SEND-DATAONLY.
 11122
 11123 5000-TRY-TO-BUILD.
 11124
 11125     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 11126
 11127     MOVE CLMCARRI               TO MSTR-CARRIER.
 11128
 11129     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 11130     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 11131     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 11132
 11133     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 11134
 11135     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 213
* EL130.cbl
 11136         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 11137     END-IF.
 11138
 11139     IF CL-PURGED-DT NOT = LOW-VALUES
 11140
 11141
 11142* EXEC CICS UNLOCK
 11143*            DATASET   (ELMSTR-DSID)
 11144*        END-EXEC
 11145*    MOVE '&*                    #   #00010336' TO DFHEIV0
 11146     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11147     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11148     MOVE X'2020233030303130333336' TO DFHEIV0(25:11)
 11149     CALL 'kxdfhei1' USING DFHEIV0,
 11150           ELMSTR-DSID,
 11151           DFHEIV99
 11152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11153         MOVE ER-7691            TO EMI-ERROR
 11154         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11155         MOVE -1                 TO MAINTL
 11156         GO TO 8200-SEND-DATAONLY
 11157     END-IF.
 11158
 11159     IF CL-AUTO-PAY-SEQ NOT = ZERO
 11160
 11161
 11162* EXEC CICS UNLOCK
 11163*            DATASET   (ELMSTR-DSID)
 11164*       END-EXEC
 11165*    MOVE '&*                    #   #00010347' TO DFHEIV0
 11166     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11167     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11168     MOVE X'2020233030303130333437' TO DFHEIV0(25:11)
 11169     CALL 'kxdfhei1' USING DFHEIV0,
 11170           ELMSTR-DSID,
 11171           DFHEIV99
 11172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11173         MOVE ER-0523             TO EMI-ERROR
 11174         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11175         MOVE -1                  TO MAINTL
 11176         GO TO 8200-SEND-DATAONLY
 11177     END-IF.
 11178
 11179     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 11180
 11181     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 11182     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 11183     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 11184     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 11185     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 11186
 11187     IF MANRSVL GREATER ZERO
 11188        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 11189                                    AT-CURRENT-MANUAL-RESERVE
 11190     END-IF.
 11191     MOVE 1                      TO SUB.
 11192
 11193 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 214
* EL130.cbl
 11194     IF SUB = 1
 11195        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 11196        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 11197        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 11198     ELSE
 11199        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 11200        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 11201                                    AT-OPEN-CLOSE-REASON (SUB)
 11202     END-IF.
 11203
 11204     IF SUB NOT = 6
 11205        ADD 1                    TO SUB
 11206        GO TO 5010-LOOP
 11207     END-IF.
 11208
 11209 5020-UPDATE.
 11210
 11211     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 11212
 11213     IF DIAGL = ZERO
 11214         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 11215         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 11216         GO TO 5025-BYPASS-UPDATE
 11217     END-IF.
 11218
 11219     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 11220
 11221     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 11222     MOVE DIAGI                  TO AT-INFO-LINE-1.
 11223
 11224     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 11225
 11226 5025-BYPASS-UPDATE.
 11227
 11228
 11229
 11230* EXEC CICS GETMAIN
 11231*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11232*        LENGTH   (ELTRLR-LENGTH)
 11233*    END-EXEC.
 11234*    MOVE '," L                  $   #00010406' TO DFHEIV0
 11235     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 11236     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11237     MOVE X'2020233030303130343036' TO DFHEIV0(25:11)
 11238     CALL 'kxdfhei1' USING DFHEIV0,
 11239           DFHEIV20,
 11240           ELTRLR-LENGTH,
 11241           DFHEIV99
 11242     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11243         DFHEIV20
 11244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11245
 11246
 11247     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11248     MOVE 'AT'                   TO AT-RECORD-ID.
 11249
 11250     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11251     MOVE MSTR-CARRIER           TO AT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 215
* EL130.cbl
 11252     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11253     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 11254     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 11255     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 11256     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 11257     MOVE '9'                    TO AT-TRAILER-TYPE.
 11258     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11259     MOVE '5'                    TO DC-OPTION-CODE.
 11260     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11261     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 11262
 11263     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 11264     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11265
 11266     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 11267     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 11268     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 11269     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 11270     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 11271     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 11272     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 11273     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 11274     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 11275     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 11276
 11277     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 11278     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 11279     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 11280     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 11281     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 11282
 11283
 11284
 11285* EXEC CICS WRITE
 11286*        DATASET   (ELTRLR-DSID)
 11287*        FROM      (ACTIVITY-TRAILERS)
 11288*        RIDFLD    (AT-CONTROL-PRIMARY)
 11289*    END-EXEC.
 11290     MOVE LENGTH OF
 11291      ACTIVITY-TRAILERS
 11292       TO DFHEIV11
 11293*    MOVE '&$ L                  ''   #00010448' TO DFHEIV0
 11294     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11295     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11296     MOVE X'2020233030303130343438' TO DFHEIV0(25:11)
 11297     CALL 'kxdfhei1' USING DFHEIV0,
 11298           ELTRLR-DSID,
 11299           ACTIVITY-TRAILERS,
 11300           DFHEIV11,
 11301           AT-CONTROL-PRIMARY,
 11302           DFHEIV99,
 11303           DFHEIV99
 11304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11305
 11306
 11307     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 11308     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 11309     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 216
* EL130.cbl
 11310     MOVE CL-CERT-STATE          TO CERT-STATE.
 11311     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 11312     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 11313     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 11314
 11315
 11316
 11317* EXEC CICS HANDLE CONDITION
 11318*        NOTFND   (5050-CERT-NOT-FOUND)
 11319*    END-EXEC.
 11320*    MOVE '"$I                   ! ; #00010463' TO DFHEIV0
 11321     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11322     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11323     MOVE X'3B20233030303130343633' TO DFHEIV0(25:11)
 11324     CALL 'kxdfhei1' USING DFHEIV0
 11325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11326
 11327
 11328     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 11329
 11330     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 11331
 11332
 11333
 11334* EXEC CICS HANDLE CONDITION
 11335*         DUPKEY   (5030-CERT-WRITTEN)
 11336*    END-EXEC.
 11337*    MOVE '"$$                   ! < #00010472' TO DFHEIV0
 11338     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11339     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11340     MOVE X'3C20233030303130343732' TO DFHEIV0(25:11)
 11341     CALL 'kxdfhei1' USING DFHEIV0
 11342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11343
 11344
 11345
 11346
 11347* EXEC CICS REWRITE
 11348*        DATASET  (ELCERT-DSID)
 11349*        FROM     (CERTIFICATE-MASTER)
 11350*    END-EXEC.
 11351     MOVE LENGTH OF
 11352      CERTIFICATE-MASTER
 11353       TO DFHEIV11
 11354*    MOVE '&& L                  %   #00010477' TO DFHEIV0
 11355     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11356     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11357     MOVE X'2020233030303130343737' TO DFHEIV0(25:11)
 11358     CALL 'kxdfhei1' USING DFHEIV0,
 11359           ELCERT-DSID,
 11360           CERTIFICATE-MASTER,
 11361           DFHEIV11,
 11362           DFHEIV99
 11363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11364
 11365
 11366 5030-CERT-WRITTEN.
 11367
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 217
* EL130.cbl
 11368     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 11369                                    CL-INCURRED-DT
 11370                                    CL-REPORTED-DT
 11371                                    CL-EST-END-OF-DISAB-DT
 11372                                    CL-PAID-THRU-DT.
 11373
 11374     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 11375                                    CL-NO-OF-PMTS-MADE
 11376                                    CL-NO-OF-DAYS-PAID.
 11377
 11378     IF CLAIM-IS-CLOSED
 11379        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 11380        MOVE 'O'                 TO CL-CLAIM-STATUS
 11381     END-IF.
 11382
 11383     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 11384     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 11385     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11386
 11387
 11388
 11389* EXEC CICS HANDLE CONDITION
 11390*         DUPKEY   (5035-CLAIM-WRITTEN)
 11391*    END-EXEC.
 11392*    MOVE '"$$                   ! = #00010504' TO DFHEIV0
 11393     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11394     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11395     MOVE X'3D20233030303130353034' TO DFHEIV0(25:11)
 11396     CALL 'kxdfhei1' USING DFHEIV0
 11397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11398
 11399
 11400
 11401
 11402* EXEC CICS REWRITE
 11403*        DATASET   (ELMSTR-DSID)
 11404*        FROM      (CLAIM-MASTER)
 11405*    END-EXEC.
 11406     MOVE LENGTH OF
 11407      CLAIM-MASTER
 11408       TO DFHEIV11
 11409*    MOVE '&& L                  %   #00010509' TO DFHEIV0
 11410     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11411     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11412     MOVE X'2020233030303130353039' TO DFHEIV0(25:11)
 11413     CALL 'kxdfhei1' USING DFHEIV0,
 11414           ELMSTR-DSID,
 11415           CLAIM-MASTER,
 11416           DFHEIV11,
 11417           DFHEIV99
 11418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11419
 11420
 11421 5035-CLAIM-WRITTEN.
 11422
 11423     MOVE ER-0000                TO EMI-ERROR.
 11424     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11425
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 218
* EL130.cbl
 11426     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 11427     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 11428     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 11429     MOVE CLMCARRI               TO PI-LAST-CARR.
 11430
 11431     IF PRTOPTL GREATER ZERO
 11432         MOVE PRTOPTI            TO PI-PRT-OPT
 11433     END-IF.
 11434
 11435     IF ALTPRTL GREATER ZERO
 11436         MOVE ALTPRTI            TO PI-ALT-PRT
 11437     END-IF.
 11438
 11439     MOVE LOW-VALUES             TO EL130AI.
 11440
 11441     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 11442     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 11443     MOVE PI-LAST-CARR           TO CLMCARRO.
 11444     MOVE PI-LAST-CLAIM          TO CLMNOO.
 11445
 11446     IF PI-PRT-OPT = 'N' OR 'L'
 11447         MOVE PI-PRT-OPT         TO PRTOPTO
 11448         MOVE 1                  TO PRTOPTL
 11449     END-IF.
 11450
 11451     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 11452         MOVE PI-ALT-PRT         TO ALTPRTO
 11453         MOVE 4                  TO ALTPRTL
 11454     END-IF.
 11455
 11456     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 11457     MOVE AL-SANON               TO CERTNOA SUFXA.
 11458
 11459     MOVE SPACES                 TO PI-INCURR-SW.
 11460
 11461     IF PRTOPTL GREATER ZERO
 11462         IF PRTOPTI = 'L'
 11463             GO TO 0400-CREATE-ELACTQ
 11464         ELSE
 11465             GO TO 0480-PRINT-NOW
 11466         END-IF
 11467     END-IF.
 11468
 11469     GO TO 8100-SEND-INITIAL-MAP.
 11470
 11471 5050-CERT-NOT-FOUND.
 11472
 11473     MOVE ER-0244                TO EMI-ERROR.
 11474     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11475     MOVE -1                     TO CERTNOL.
 11476     GO TO 8200-SEND-DATAONLY.
 11477
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 219
* EL130.cbl
 11479 5500-BUILD-FORM-TRAILER.
 11480*************************************************************
 11481*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 11482*************************************************************
 11483
 11484     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 11485
 11486     IF  WS-BEN-ALPHA-2 = '30'
 11487         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 11488         MOVE '6'                TO DC-OPTION-CODE
 11489         IF CL-CARRIER = 'C'
 11490             MOVE +14            TO DC-ELAPSED-DAYS
 11491             MOVE +0             TO DC-ELAPSED-MONTHS
 11492             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11493             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 11494         ELSE
 11495             MOVE +21            TO DC-ELAPSED-DAYS
 11496             MOVE +0             TO DC-ELAPSED-MONTHS
 11497             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11498             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 11499         END-IF
 11500     END-IF.
 11501
 11502
 11503
 11504* EXEC CICS GETMAIN
 11505*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11506*         LENGTH   (ELTRLR-LENGTH)
 11507*         INITIMG  (GETMAIN-SPACE)
 11508*    END-EXEC.
 11509*    MOVE ',"IL                  $   #00010596' TO DFHEIV0
 11510     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11511     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11512     MOVE X'2020233030303130353936' TO DFHEIV0(25:11)
 11513     CALL 'kxdfhei1' USING DFHEIV0,
 11514           DFHEIV20,
 11515           ELTRLR-LENGTH,
 11516           GETMAIN-SPACE
 11517     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11518         DFHEIV20
 11519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11520
 11521
 11522     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 11523     MOVE 'AT'                   TO AT-RECORD-ID.
 11524
 11525     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 11526     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 11527     MOVE 'A'                    TO AT-TRAILER-TYPE.
 11528     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 11529                                    AT-FORM-LAST-MAINT-DT.
 11530     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11531                                    AT-FORM-LAST-UPDATED-BY.
 11532     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11533     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 11534     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 11535                                    AT-FORM-RE-SEND-DT
 11536                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 220
* EL130.cbl
 11537                                    AT-EMP-FORM-ANSWERED-DT
 11538                                    AT-PHY-FORM-ANSWERED-DT
 11539                                    AT-EMP-FORM-SEND-ON-DT
 11540                                    AT-FORM-PRINTED-DT
 11541                                    AT-FORM-REPRINT-DT.
 11542     MOVE '1'                    TO AT-FORM-TYPE.
 11543
 11544     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 11545                                    AT-INSTRUCT-LN-2
 11546                                    AT-INSTRUCT-LN-3.
 11547
 11548     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 11549     MOVE 'I'                    TO AT-FORM-ADDRESS.
 11550
 11551     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 11552
 11553     IF AM-EMPLOYER-STMT-USED = 'Y'
 11554        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 11555     END-IF.
 11556
 11557
 11558
 11559* EXEC CICS WRITE
 11560*         DATASET  (ELTRLR-DSID)
 11561*         FROM     (ACTIVITY-TRAILERS)
 11562*         RIDFLD   (AT-CONTROL-PRIMARY)
 11563*    END-EXEC.
 11564     MOVE LENGTH OF
 11565      ACTIVITY-TRAILERS
 11566       TO DFHEIV11
 11567*    MOVE '&$ L                  ''   #00010638' TO DFHEIV0
 11568     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11569     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11570     MOVE X'2020233030303130363338' TO DFHEIV0(25:11)
 11571     CALL 'kxdfhei1' USING DFHEIV0,
 11572           ELTRLR-DSID,
 11573           ACTIVITY-TRAILERS,
 11574           DFHEIV11,
 11575           AT-CONTROL-PRIMARY,
 11576           DFHEIV99,
 11577           DFHEIV99
 11578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11579
 11580
 11581 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 221
* EL130.cbl
 11583*************************************************************
 11584*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 11585*************************************************************
 11586
 11587 5700-BUILD-ARCHIVE-HEADER.
 11588
 11589     MOVE '1'                    TO CNTL-REC-TYPE.
 11590     MOVE ZEROS                  TO CNTL-SEQ-NO.
 11591     MOVE SPACES                 TO CNTL-ACCESS.
 11592
 11593
 11594
 11595* EXEC CICS READ
 11596*         DATASET  (ELCNTL-DSID)
 11597*         SET      (ADDRESS OF CONTROL-FILE)
 11598*         RIDFLD   (ELCNTL-KEY)
 11599*         UPDATE
 11600*    END-EXEC.
 11601*    MOVE '&"S        EU         (   #00010657' TO DFHEIV0
 11602     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11603     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11604     MOVE X'2020233030303130363537' TO DFHEIV0(25:11)
 11605     CALL 'kxdfhei1' USING DFHEIV0,
 11606           ELCNTL-DSID,
 11607           DFHEIV20,
 11608           DFHEIV99,
 11609           ELCNTL-KEY,
 11610           DFHEIV99,
 11611           DFHEIV99,
 11612           DFHEIV99
 11613     SET ADDRESS OF CONTROL-FILE TO
 11614         DFHEIV20
 11615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11616
 11617
 11618     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 11619
 11620     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 11621
 11622
 11623
 11624* EXEC CICS REWRITE
 11625*         FROM     (CONTROL-FILE)
 11626*         DATASET  (ELCNTL-DSID)
 11627*    END-EXEC.
 11628     MOVE LENGTH OF
 11629      CONTROL-FILE
 11630       TO DFHEIV11
 11631*    MOVE '&& L                  %   #00010669' TO DFHEIV0
 11632     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11633     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11634     MOVE X'2020233030303130363639' TO DFHEIV0(25:11)
 11635     CALL 'kxdfhei1' USING DFHEIV0,
 11636           ELCNTL-DSID,
 11637           CONTROL-FILE,
 11638           DFHEIV11,
 11639           DFHEIV99
 11640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 222
* EL130.cbl
 11641
 11642
 11643
 11644
 11645* EXEC CICS HANDLE CONDITION
 11646*         NOTOPEN  (9990-ABEND)
 11647*         DUPKEY   (5799-EXIT)
 11648*    END-EXEC.
 11649*    MOVE '"$J$                  ! > #00010675' TO DFHEIV0
 11650     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 11651     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11652     MOVE X'3E20233030303130363735' TO DFHEIV0(25:11)
 11653     CALL 'kxdfhei1' USING DFHEIV0
 11654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11655
 11656
 11657
 11658
 11659* EXEC CICS GETMAIN
 11660*         SET     (ADDRESS OF LETTER-ARCHIVE)
 11661*         LENGTH  (ELARCH-LENGTH)
 11662*    END-EXEC.
 11663*    MOVE '," L                  $   #00010681' TO DFHEIV0
 11664     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 11665     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11666     MOVE X'2020233030303130363831' TO DFHEIV0(25:11)
 11667     CALL 'kxdfhei1' USING DFHEIV0,
 11668           DFHEIV20,
 11669           ELARCH-LENGTH,
 11670           DFHEIV99
 11671     SET ADDRESS OF LETTER-ARCHIVE TO
 11672         DFHEIV20
 11673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11674
 11675
 11676     MOVE SPACES                 TO LETTER-ARCHIVE.
 11677     MOVE 'LA'                   TO LA-RECORD-ID.
 11678     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 11679                                    LA-ARCHIVE-NO-A1.
 11680     MOVE '4'                    TO LA-RECORD-TYPE
 11681                                    LA-RECORD-TYPE-A1.
 11682     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 11683                                    LA-LINE-SEQ-NO-A1.
 11684     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 11685                                    LA-COMPANY-CD-A1.
 11686     MOVE CL-CARRIER             TO LA4-CARRIER.
 11687     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 11688     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 11689     MOVE CL-CERT-STATE          TO LA4-STATE.
 11690     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 11691     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 11692     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 11693     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 11694                                    LA4-RESEND-PRINT-DATE
 11695                                    LA4-FORM-REM-PRINT-DT
 11696                                    LA4-RESEND-DATE.
 11697     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 11698     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 223
* EL130.cbl
 11699
 11700
 11701
 11702* EXEC CICS WRITE
 11703*         DATASET  (ELARCH-DSID)
 11704*         FROM     (LETTER-ARCHIVE)
 11705*         RIDFLD   (LA-CONTROL-PRIMARY)
 11706*    END-EXEC.
 11707     MOVE LENGTH OF
 11708      LETTER-ARCHIVE
 11709       TO DFHEIV11
 11710*    MOVE '&$ L                  ''   #00010711' TO DFHEIV0
 11711     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11712     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11713     MOVE X'2020233030303130373131' TO DFHEIV0(25:11)
 11714     CALL 'kxdfhei1' USING DFHEIV0,
 11715           ELARCH-DSID,
 11716           LETTER-ARCHIVE,
 11717           DFHEIV11,
 11718           LA-CONTROL-PRIMARY,
 11719           DFHEIV99,
 11720           DFHEIV99
 11721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11722
 11723
 11724 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 224
* EL130.cbl
 11726 6000-EDIT-CLAIM-DATA.
 11727
 11728     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 11729     MOVE '2'                    TO DC-OPTION-CODE.
 11730     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11731     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 11732
 11733     IF CLMNOL GREATER ZERO
 11734         IF CLMNOI = SPACES OR LOW-VALUES
 11735             MOVE -1             TO CLMNOL
 11736             MOVE AL-UABON       TO CLMNOA
 11737             MOVE ER-7688        TO EMI-ERROR
 11738             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11739         ELSE
 11740             MOVE AL-UANON       TO CLMNOA
 11741         END-IF
 11742     END-IF.
 11743
 11744     IF CERTNOL = ZERO
 11745         MOVE -1                 TO CERTNOL
 11746         MOVE AL-SABON           TO CERTNOA
 11747         MOVE ER-0203            TO EMI-ERROR
 11748         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11749     ELSE
 11750         MOVE AL-SANON           TO CERTNOA
 11751     END-IF.
 11752
 11753     IF SUFXL = ZERO
 11754         MOVE SPACES             TO SUFXI
 11755         MOVE AL-SANON           TO SUFXA
 11756     ELSE
 11757         MOVE AL-SANON           TO SUFXA
 11758     END-IF.
 11759
 11760     IF CLMCARRL = ZERO
 11761         MOVE -1                 TO CLMCARRL
 11762         MOVE ER-0194            TO EMI-ERROR
 11763         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11764     ELSE
 11765         MOVE CLMCARRI           TO PI-CARRIER
 11766         IF PI-NO-CARRIER-SECURITY
 11767             MOVE AL-UANON       TO CLMCARRA
 11768         END-IF
 11769     END-IF.
 11770
 11771     IF CLMTYPEL > ZERO
 11772        IF ((PI-COMPANY-ID = 'DCC')
 11773           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 11774              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G'))
 11775                        OR
 11776           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 11777           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 11778              AND PI-AH-OVERRIDE-L1))
 11779              MOVE -1             TO CLMTYPEL
 11780              MOVE AL-UABON       TO CLMTYPEA
 11781              MOVE ER-7634        TO EMI-ERROR
 11782              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11783        ELSE
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 225
* EL130.cbl
 11784           MOVE AL-UANON       TO CLMTYPEA
 11785        END-IF
 11786     ELSE
 11787        IF MAINTI = 'A'
 11788           MOVE -1             TO CLMTYPEL
 11789           MOVE AL-UABON       TO CLMTYPEA
 11790           MOVE ER-0546        TO EMI-ERROR
 11791           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11792        END-IF
 11793     END-IF
 11794
 11795     IF PCERTNOL = ZERO
 11796        MOVE CERTNOI             TO PCERTNOI
 11797        MOVE CERTNOL             TO PCERTNOL
 11798        MOVE AL-UANON            TO PCERTNOA
 11799     ELSE
 11800        MOVE AL-UANON            TO PCERTNOA
 11801     END-IF.
 11802
 11803     IF PSUFXL = ZERO
 11804        MOVE SUFXI               TO PSUFXI
 11805        MOVE SUFXL               TO PSUFXL
 11806        MOVE AL-UANON            TO PSUFXA
 11807     ELSE
 11808        MOVE AL-UANON            TO PSUFXA
 11809     END-IF.
 11810
 11811     IF MAINTI = 'I'
 11812         GO TO 6020-EDIT
 11813     END-IF.
 11814
 11815     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 11816         MOVE -1                 TO LSTNMEL
 11817         MOVE ER-0236            TO EMI-ERROR
 11818         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11819     ELSE
 11820         MOVE AL-UANON           TO LSTNMEA
 11821     END-IF.
 11822     IF SEXL > ZEROS
 11823        IF SEXI = 'M' OR 'F'
 11824           CONTINUE
 11825        ELSE
 11826           MOVE -1               TO SEXL
 11827           MOVE AL-UABON         TO SEXA
 11828           MOVE ER-0219          TO EMI-ERROR
 11829           PERFORM 9900-ERROR-FORMAT
 11830                                 THRU 9900-EXIT
 11831        END-IF
 11832     ELSE
 11833        IF MAINTI = 'A'
 11834           MOVE -1               TO SEXL
 11835           MOVE AL-UABON         TO SEXA
 11836           MOVE ER-0219          TO EMI-ERROR
 11837           PERFORM 9900-ERROR-FORMAT
 11838                                 THRU 9900-EXIT
 11839        END-IF
 11840     END-IF
 11841*    IF SEXI NOT = 'M' AND 'F'
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 226
* EL130.cbl
 11842*        MOVE -1                 TO SEXL
 11843*        MOVE AL-UABON           TO SEXA
 11844*        MOVE ER-0219            TO EMI-ERROR
 11845*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11846*    ELSE
 11847*        MOVE AL-UANON           TO SEXA
 11848*    END-IF.
 11849
 11850     IF SSNL GREATER THAN ZERO
 11851         MOVE SSNI TO WS-SOC-SEC-NUMBER
 11852         IF WS-SOC-SEC-NO NUMERIC AND
 11853           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 11854             NEXT SENTENCE
 11855         ELSE
 11856            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 11857               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 11858               WS-SSN-DASH2 = '-'
 11859                 NEXT SENTENCE
 11860            ELSE
 11861                 MOVE ER-0887        TO  EMI-ERROR
 11862                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11863                 MOVE AL-UABON       TO  SSNA
 11864                 MOVE -1             TO  SSNL
 11865            END-IF
 11866        END-IF
 11867     END-IF.
 11868
 11869     IF BIRTHDTL = ZERO
 11870         GO TO 6020-EDIT
 11871     END-IF.
 11872
 11873     IF BIRTHDTL GREATER ZERO
 11874         MOVE BIRTHDTI           TO DATE-WORK
 11875         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11876         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11877         MOVE '4'                TO DC-OPTION-CODE
 11878         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11879         IF DATE-CONVERSION-ERROR
 11880             MOVE AL-UABON       TO BIRTHDTA
 11881             MOVE -1             TO BIRTHDTL
 11882             MOVE ER-0220        TO EMI-ERROR
 11883             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11884             GO TO 6020-EDIT
 11885         END-IF
 11886     END-IF.
 11887
 11888******************************************************************
 11889**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 11890**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 11891**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 11892******************************************************************
 11893
 11894     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 11895         MOVE BIRTHDTI           TO  DATE-WORK
 11896         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11897         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 11898         MOVE '4'                TO  DC-OPTION-CODE
 11899         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 227
* EL130.cbl
 11900         MOVE +0                 TO  DC-ELAPSED-MONTHS
 11901                                     DC-ELAPSED-DAYS
 11902         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11903         IF DATE-CONVERSION-ERROR
 11904             MOVE AL-UABON       TO  BIRTHDTA
 11905             MOVE -1             TO  BIRTHDTL
 11906             MOVE ER-0220        TO  EMI-ERROR
 11907             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11908             GO TO 6020-EDIT
 11909         END-IF
 11910     END-IF.
 11911
 11912     MOVE AL-UANON               TO  BIRTHDTA.
 11913     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 11914     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 11915     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 11916
 11917 6020-EDIT.
 11918     IF INCURL GREATER ZERO
 11919         MOVE INCURI             TO DATE-WORK
 11920         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11921         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11922         MOVE '4'                TO DC-OPTION-CODE
 11923         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11924         IF DATE-CONVERSION-ERROR
 11925             MOVE AL-UABON       TO INCURA
 11926             MOVE -1             TO INCURL
 11927             MOVE ER-0222        TO EMI-ERROR
 11928             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11929         ELSE
 11930             MOVE AL-UANON       TO INCURA
 11931             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 11932             MOVE DC-BIN-DATE-1  TO WS-INCUR
 11933                                    PI-SAVE-INCUR-DT
 11934             IF WS-INCUR GREATER THAN WS-TODAY-DT
 11935                 MOVE ER-0511     TO EMI-ERROR
 11936                 MOVE -1          TO INCURL
 11937                 MOVE AL-UABON    TO INCURA
 11938                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11939             ELSE
 11940*                NEXT SENTENCE
 11941                 CONTINUE
 11942             END-IF
 11943         END-IF
 11944     ELSE
 11945         MOVE ER-0516         TO EMI-ERROR
 11946         MOVE AL-UABON        TO INCURA
 11947         MOVE -1              TO INCURL
 11948         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11949     END-IF.
 11950
 11951     IF REPORTL GREATER ZERO
 11952         MOVE REPORTI            TO DATE-WORK
 11953         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11954         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11955         MOVE '4'                TO DC-OPTION-CODE
 11956         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11957         IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 228
* EL130.cbl
 11958             MOVE AL-UABON       TO REPORTA
 11959             MOVE -1             TO REPORTL
 11960             MOVE ER-0223        TO EMI-ERROR
 11961             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11962         ELSE
 11963             MOVE AL-UANON       TO REPORTA
 11964             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 11965             MOVE DC-BIN-DATE-1  TO WS-REPORT
 11966             IF WS-REPORT GREATER THAN WS-TODAY-DT
 11967                 MOVE ER-0512     TO EMI-ERROR
 11968                 MOVE -1          TO REPORTL
 11969                 MOVE AL-UABON    TO REPORTA
 11970                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11971             ELSE
 11972*                NEXT SENTENCE
 11973                 CONTINUE
 11974             END-IF
 11975         END-IF
 11976     ELSE
 11977         MOVE ER-0517         TO EMI-ERROR
 11978         MOVE -1              TO REPORTL
 11979         MOVE AL-UABON        TO REPORTA
 11980         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11981     END-IF.
 11982
 11983     IF WS-REPORT NOT = LOW-VALUES
 11984         IF WS-INCUR GREATER THAN WS-REPORT
 11985             MOVE AL-UABON       TO REPORTA
 11986             MOVE -1             TO REPORTL
 11987             MOVE ER-0509        TO EMI-ERROR
 11988             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11989         END-IF
 11990     END-IF.
 11991
 11992     IF ESTENDL GREATER ZERO
 11993         MOVE ESTENDI            TO DATE-WORK
 11994         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11995         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11996         MOVE '4'                TO DC-OPTION-CODE
 11997         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11998         IF DATE-CONVERSION-ERROR
 11999             MOVE AL-UABON       TO ESTENDA
 12000             MOVE -1             TO ESTENDL
 12001             MOVE ER-0224        TO EMI-ERROR
 12002             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12003         ELSE
 12004             MOVE AL-UANON       TO ESTENDA
 12005             MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 12006             MOVE DC-BIN-DATE-1  TO WS-ESTEND
 12007             IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 12008                MOVE AL-UABON    TO ESTENDA
 12009                MOVE -1          TO ESTENDL
 12010                MOVE ER-0544     TO EMI-ERROR
 12011                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12012             END-IF
 12013         END-IF
 12014     END-IF.
 12015
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 229
* EL130.cbl
 12016     IF WS-ESTEND NOT = LOW-VALUES
 12017         IF WS-INCUR GREATER THAN WS-ESTEND
 12018             MOVE AL-UABON       TO ESTENDA
 12019             MOVE -1             TO ESTENDL
 12020             MOVE ER-0510        TO EMI-ERROR
 12021             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12022         END-IF
 12023     END-IF.
 12024
 12025     IF PRTOPTL GREATER ZERO
 12026         IF PRTOPTI NOT = 'N' AND 'L'
 12027             MOVE AL-UABON       TO PRTOPTA
 12028             MOVE -1             TO PRTOPTL
 12029             MOVE ER-0334        TO EMI-ERROR
 12030             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12031         END-IF
 12032     END-IF.
 12033
 12034     IF MANRSVL GREATER ZERO
 12035
 12036* EXEC CICS BIF DEEDIT
 12037*            FIELD   (MANRSVI)
 12038*            LENGTH  (9)
 12039*        END-EXEC
 12040     MOVE 9
 12041       TO DFHEIV11
 12042*    MOVE '@"L                   #   #00011028' TO DFHEIV0
 12043     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12044     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12045     MOVE X'2020233030303131303238' TO DFHEIV0(25:11)
 12046     CALL 'kxdfhei1' USING DFHEIV0,
 12047           MANRSVI,
 12048           DFHEIV11
 12049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12050         IF MANRSVI NOT NUMERIC
 12051             MOVE AL-UNBON       TO MANRSVA
 12052             MOVE -1             TO MANRSVL
 12053             MOVE ER-0489        TO EMI-ERROR
 12054             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12055         ELSE
 12056             MOVE AL-UNNON       TO MANRSVA
 12057             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 12058         END-IF
 12059     END-IF.
 12060
 12061     MOVE SPACES                 TO ELCNTL-KEY.
 12062
 12063     IF CONTROL-IS-ACTUAL-CARRIER
 12064         MOVE PI-CARRIER         TO CNTL-CARRIER
 12065     ELSE
 12066         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 12067     END-IF.
 12068
 12069     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12070     MOVE '6'                    TO CNTL-REC-TYPE.
 12071     MOVE +0                     TO CNTL-SEQ-NO.
 12072
 12073
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 230
* EL130.cbl
 12074
 12075* EXEC CICS HANDLE CONDITION
 12076*        NOTFND   (3100-CARRIER-NOT-FOUND)
 12077*    END-EXEC.
 12078*    MOVE '"$I                   ! ? #00011056' TO DFHEIV0
 12079     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12080     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12081     MOVE X'3F20233030303131303536' TO DFHEIV0(25:11)
 12082     CALL 'kxdfhei1' USING DFHEIV0
 12083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12084
 12085
 12086     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 12087
 12088     IF NOT CF-MANUAL-RESERVES-USED AND
 12089           WS-MANRSV GREATER ZERO
 12090         MOVE ER-0518             TO EMI-ERROR
 12091         MOVE -1                  TO MANRSVL
 12092         MOVE AL-UNBON            TO MANRSVA
 12093         MOVE ZEROS               TO WS-MANRSV
 12094         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12095     END-IF.
 12096
 12097     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 12098     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
 12099
 12100     IF SUPVL GREATER ZERO
 12101         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 12102             MOVE -1             TO SUPVL
 12103             MOVE AL-UABON       TO SUPVA
 12104             MOVE ER-0230        TO EMI-ERROR
 12105             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12106         ELSE
 12107             MOVE AL-UANON       TO SUPVA
 12108         END-IF
 12109     END-IF.
 12110
 12111     IF PROCCDL = ZERO
 12112        GO TO 6050-CONTINUE-EDITS
 12113     END-IF.
 12114
 12115     MOVE SPACES                 TO ELCNTL-KEY.
 12116     MOVE PROCCDI                TO CNTL-ACCESS.
 12117
 12118     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12119     MOVE '2'                    TO CNTL-REC-TYPE.
 12120     MOVE +0                     TO CNTL-SEQ-NO.
 12121
 12122
 12123
 12124* EXEC CICS HANDLE CONDITION
 12125*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 12126*    END-EXEC.
 12127*    MOVE '"$I                   ! @ #00011097' TO DFHEIV0
 12128     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12129     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12130     MOVE X'4020233030303131303937' TO DFHEIV0(25:11)
 12131     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 231
* EL130.cbl
 12132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12133
 12134
 12135     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 12136
 12137     GO TO 6050-CONTINUE-EDITS.
 12138
 12139 6040-NO-PROCESSOR-RECORD.
 12140     MOVE ER-0019                TO EMI-ERROR.
 12141     MOVE -1                     TO PROCCDL.
 12142     MOVE AL-UABON               TO PROCCDA.
 12143     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12144
 12145 6050-CONTINUE-EDITS.
 12146     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 12147           GO TO 6070-CONTINUE-EDITS
 12148     END-IF.
 12149
 12150     MOVE BENECDI                TO BENE-CODE.
 12151     MOVE 'B'                    TO BENE-RCD-TYPE.
 12152     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 12153
 12154
 12155
 12156* EXEC CICS HANDLE CONDITION
 12157*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 12158*    END-EXEC.
 12159*    MOVE '"$I                   ! A #00011121' TO DFHEIV0
 12160     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12162     MOVE X'4120233030303131313231' TO DFHEIV0(25:11)
 12163     CALL 'kxdfhei1' USING DFHEIV0
 12164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12165
 12166
 12167
 12168* EXEC CICS READ
 12169*         DATASET   (ELBENE-DSID)
 12170*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 12171*         RIDFLD    (ELBENE-KEY)
 12172*    END-EXEC.
 12173*    MOVE '&"S        E          (   #00011125' TO DFHEIV0
 12174     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12175     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12176     MOVE X'2020233030303131313235' TO DFHEIV0(25:11)
 12177     CALL 'kxdfhei1' USING DFHEIV0,
 12178           ELBENE-DSID,
 12179           DFHEIV20,
 12180           DFHEIV99,
 12181           ELBENE-KEY,
 12182           DFHEIV99,
 12183           DFHEIV99,
 12184           DFHEIV99
 12185     SET ADDRESS OF BENEFICIARY-MASTER TO
 12186         DFHEIV20
 12187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12188
 12189
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 232
* EL130.cbl
 12190     GO TO 6070-CONTINUE-EDITS.
 12191
 12192 6060-NO-BENEFICIARY-RECORD.
 12193     MOVE ER-0565                TO EMI-ERROR.
 12194     MOVE -1                     TO BENECDL.
 12195     MOVE AL-UABON               TO BENECDA.
 12196     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12197
 12198
 12199 6070-CONTINUE-EDITS.
 12200     IF CERTMTL GREATER ZERO
 12201         IF CERTMTI NOT = 'A' AND 'S'
 12202             MOVE -1             TO CERTMTL
 12203             MOVE AL-UABON       TO CERTMTA
 12204             MOVE ER-0267        TO EMI-ERROR
 12205             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12206         ELSE
 12207             MOVE AL-UANON       TO CERTMTA
 12208         END-IF
 12209     ELSE
 12210         GO TO 6000-EXIT
 12211     END-IF.
 12212
 12213     IF EFFDTL GREATER ZERO
 12214         MOVE EFFDTI             TO DATE-WORK
 12215         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12216         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12217         MOVE '4'                TO DC-OPTION-CODE
 12218         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12219         IF DATE-CONVERSION-ERROR
 12220             MOVE AL-UABON       TO EFFDTA
 12221             MOVE -1             TO EFFDTL
 12222             MOVE ER-0231        TO EMI-ERROR
 12223             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12224         ELSE
 12225             MOVE AL-UANON       TO EFFDTA
 12226             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 12227             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 12228         END-IF
 12229     ELSE
 12230         MOVE ER-0231            TO EMI-ERROR
 12231         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12232         MOVE -1                 TO EFFDTL
 12233         MOVE AL-UABON           TO EFFDTA
 12234     END-IF.
 12235
 12236     IF ACCOUNTL = ZERO
 12237         MOVE ER-0232            TO EMI-ERROR
 12238         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12239         MOVE AL-UABON           TO ACCOUNTA
 12240         MOVE -1                 TO ACCOUNTL
 12241     ELSE
 12242         MOVE AL-UANON           TO ACCOUNTA
 12243     END-IF.
 12244
 12245     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 12246        (STATEL = ZERO)
 12247         MOVE ER-0233        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 233
* EL130.cbl
 12248         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12249         MOVE AL-UABON       TO STATEA
 12250         MOVE -1             TO STATEL
 12251     ELSE
 12252         MOVE AL-UANON       TO STATEA
 12253     END-IF.
 12254
 12255     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 12256        (CRTCARRL = ZERO)
 12257         MOVE ER-0234        TO EMI-ERROR
 12258         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12259         MOVE AL-UABON       TO CRTCARRA
 12260         MOVE -1             TO CRTCARRL
 12261     ELSE
 12262         MOVE AL-UANON       TO CRTCARRA
 12263     END-IF.
 12264
 12265     IF PI-CERT-ACCESS-CONTROL = '1' AND
 12266        GROUPL = ZERO
 12267         MOVE ER-0235            TO EMI-ERROR
 12268         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12269         MOVE AL-UABON           TO GROUPA
 12270         MOVE -1                 TO GROUPL
 12271     ELSE
 12272         MOVE AL-UANON           TO GROUPA
 12273     END-IF.
 12274
 12275     IF CRTLNMEL = ZERO
 12276         IF LSTNMEI = SPACES OR LOW-VALUES
 12277             MOVE ER-0236            TO  EMI-ERROR
 12278             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12279             MOVE AL-UABON           TO  CRTLNMEA
 12280             MOVE -1                 TO  CRTLNMEL
 12281         ELSE
 12282             MOVE LSTNMEI            TO  CRTLNMEI
 12283             MOVE AL-UANON           TO  CRTLNMEA
 12284         END-IF
 12285     ELSE
 12286         MOVE AL-UANON               TO  CRTLNMEA
 12287     END-IF.
 12288
 12289     IF CRTFNMEL = ZERO
 12290         IF FSTNMEI = SPACES OR LOW-VALUES
 12291*            NEXT SENTENCE
 12292             CONTINUE
 12293         ELSE
 12294             MOVE FSTNMEI            TO  CRTFNMEI
 12295             MOVE AL-UANON           TO  CRTFNMEA
 12296         END-IF
 12297     END-IF.
 12298
 12299     IF CRTINITL = ZERO
 12300         IF INITI = SPACES OR LOW-VALUES
 12301*            NEXT SENTENCE
 12302             CONTINUE
 12303         ELSE
 12304             MOVE INITI              TO  CRTINITI
 12305             MOVE AL-UANON           TO  CRTINITA
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 234
* EL130.cbl
 12306         END-IF
 12307     END-IF.
 12308
 12309 6000-EXIT.
 12310     EXIT.
 12311
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 235
* EL130.cbl
 12313 6200-EDIT-CERT-DATA.
 12314     IF ISSAGEL GREATER ZERO
 12315         IF ISSAGEI NOT NUMERIC
 12316             MOVE ER-0237        TO EMI-ERROR
 12317             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12318             MOVE -1             TO ISSAGEL
 12319             MOVE AL-UNBON       TO ISSAGEA
 12320         ELSE
 12321             MOVE AL-UNNON       TO ISSAGEA
 12322         END-IF
 12323     END-IF.
 12324
 12325     IF JNTAGEL GREATER ZERO
 12326         IF JNTAGEI NOT NUMERIC
 12327             MOVE ER-0238        TO EMI-ERROR
 12328             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12329             MOVE -1             TO JNTAGEL
 12330             MOVE AL-UNBON       TO JNTAGEA
 12331         ELSE
 12332             MOVE AL-UNNON       TO JNTAGEA
 12333         END-IF
 12334     END-IF.
 12335
 12336     IF LCVCDL GREATER ZERO
 12337         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 12338         IF INVALID-BENEFIT-CODE
 12339             MOVE ER-7635        TO EMI-ERROR
 12340             MOVE -1             TO LCVCDL
 12341             MOVE AL-UABON       TO LCVCDA
 12342             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12343         ELSE
 12344             MOVE LCVCDI         TO WS-BEN-HOLD
 12345             MOVE '4'            TO WS-REC-TYPE
 12346             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 12347             IF WS-BEN-ALPHA-HOLD = SPACES
 12348                MOVE ER-7635     TO EMI-ERROR
 12349                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12350                MOVE -1          TO LCVCDL
 12351                MOVE AL-UABON    TO LCVCDA
 12352             ELSE
 12353                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 12354                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 12355                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 12356                MOVE AL-UANON           TO LCVCDA
 12357             END-IF
 12358         END-IF
 12359     END-IF.
 12360
 12361     IF ACVCDL GREATER ZERO
 12362         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 12363         IF INVALID-BENEFIT-CODE
 12364             MOVE ER-7635        TO EMI-ERROR
 12365             MOVE -1             TO ACVCDL
 12366             MOVE AL-UABON       TO ACVCDA
 12367             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12368         ELSE
 12369             MOVE ACVCDI         TO WS-BEN-HOLD
 12370             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 236
* EL130.cbl
 12371             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 12372             IF WS-BEN-ALPHA-HOLD = SPACES
 12373                MOVE ER-7635     TO EMI-ERROR
 12374                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12375                MOVE -1          TO ACVCDL
 12376                MOVE AL-UABON    TO ACVCDA
 12377             ELSE
 12378                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 12379                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 12380                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 12381                MOVE AL-UANON           TO ACVCDA
 12382             END-IF
 12383         END-IF
 12384     END-IF.
 12385
 12386     IF LCVOTRML GREATER ZERO
 12387         IF LCVOTRMI NOT NUMERIC
 12388             MOVE ER-7636        TO EMI-ERROR
 12389             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12390             MOVE -1             TO LCVOTRML
 12391             MOVE AL-UNBON       TO LCVOTRMA
 12392         ELSE
 12393             MOVE AL-UNNON       TO LCVOTRMA
 12394         END-IF
 12395     END-IF.
 12396
 12397     IF ACVOTRML GREATER ZERO
 12398         IF ACVOTRMI NOT NUMERIC
 12399             MOVE ER-7636        TO EMI-ERROR
 12400             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12401             MOVE -1             TO ACVOTRML
 12402             MOVE AL-UNBON       TO ACVOTRMA
 12403         ELSE
 12404             MOVE AL-UNNON       TO ACVOTRMA
 12405         END-IF
 12406     END-IF.
 12407
 12408     IF LCVRATEL GREATER ZERO
 12409
 12410* EXEC CICS BIF DEEDIT
 12411*            FIELD    (LCVRATEI)
 12412*            LENGTH   (06)
 12413*        END-EXEC
 12414     MOVE 06
 12415       TO DFHEIV11
 12416*    MOVE '@"L                   #   #00011350' TO DFHEIV0
 12417     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12418     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12419     MOVE X'2020233030303131333530' TO DFHEIV0(25:11)
 12420     CALL 'kxdfhei1' USING DFHEIV0,
 12421           LCVRATEI,
 12422           DFHEIV11
 12423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12424         IF LCVRATEI NOT NUMERIC
 12425             MOVE AL-UNBON       TO LCVRATEA
 12426             MOVE -1             TO LCVRATEL
 12427             MOVE ER-2280        TO EMI-ERROR
 12428             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 237
* EL130.cbl
 12429         ELSE
 12430             MOVE AL-UNNON       TO LCVRATEA
 12431             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 12432         END-IF
 12433     END-IF.
 12434
 12435     IF ACVRATEL GREATER ZERO
 12436
 12437* EXEC CICS BIF DEEDIT
 12438*            FIELD    (ACVRATEI)
 12439*            LENGTH   (06)
 12440*        END-EXEC
 12441     MOVE 06
 12442       TO DFHEIV11
 12443*    MOVE '@"L                   #   #00011366' TO DFHEIV0
 12444     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12445     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12446     MOVE X'2020233030303131333636' TO DFHEIV0(25:11)
 12447     CALL 'kxdfhei1' USING DFHEIV0,
 12448           ACVRATEI,
 12449           DFHEIV11
 12450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12451         IF ACVRATEI NOT NUMERIC
 12452             MOVE AL-UNBON       TO ACVRATEA
 12453             MOVE -1             TO ACVRATEL
 12454             MOVE ER-2280        TO EMI-ERROR
 12455             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12456         ELSE
 12457             MOVE AL-UNNON       TO ACVRATEA
 12458             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 12459         END-IF
 12460     END-IF.
 12461
 12462     IF LCVBENEL GREATER ZERO
 12463
 12464* EXEC CICS BIF DEEDIT
 12465*            FIELD    (LCVBENEI)
 12466*            LENGTH   (11)
 12467*        END-EXEC
 12468     MOVE 11
 12469       TO DFHEIV11
 12470*    MOVE '@"L                   #   #00011382' TO DFHEIV0
 12471     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12472     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12473     MOVE X'2020233030303131333832' TO DFHEIV0(25:11)
 12474     CALL 'kxdfhei1' USING DFHEIV0,
 12475           LCVBENEI,
 12476           DFHEIV11
 12477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12478         IF LCVBENEI NOT NUMERIC
 12479             MOVE AL-UNBON       TO LCVBENEA
 12480             MOVE -1             TO LCVBENEL
 12481             MOVE ER-7637        TO EMI-ERROR
 12482             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12483         ELSE
 12484             MOVE AL-UNNON       TO LCVBENEA
 12485             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 12486         END-IF
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 238
* EL130.cbl
 12487     END-IF.
 12488
 12489     IF ACVBENEL GREATER ZERO
 12490
 12491* EXEC CICS BIF DEEDIT
 12492*            FIELD    (ACVBENEI)
 12493*            LENGTH   (11)
 12494*        END-EXEC
 12495     MOVE 11
 12496       TO DFHEIV11
 12497*    MOVE '@"L                   #   #00011398' TO DFHEIV0
 12498     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12499     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12500     MOVE X'2020233030303131333938' TO DFHEIV0(25:11)
 12501     CALL 'kxdfhei1' USING DFHEIV0,
 12502           ACVBENEI,
 12503           DFHEIV11
 12504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12505         IF ACVBENEI NOT NUMERIC
 12506             MOVE AL-UNBON       TO ACVBENEA
 12507             MOVE -1             TO ACVBENEL
 12508             MOVE ER-7637        TO EMI-ERROR
 12509             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12510         ELSE
 12511             MOVE AL-UNNON       TO ACVBENEA
 12512             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 12513         END-IF
 12514     END-IF.
 12515
 12516     IF LCVCNDTL GREATER ZERO
 12517         IF LCVCNDTI NOT = SPACES
 12518             MOVE LCVCNDTI        TO DATE-WORK
 12519             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12520             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12521             MOVE '4'             TO DC-OPTION-CODE
 12522             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12523             IF DATE-CONVERSION-ERROR
 12524                 MOVE AL-UABON    TO LCVCNDTA
 12525                 MOVE -1          TO LCVCNDTL
 12526                 MOVE ER-7638     TO EMI-ERROR
 12527                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12528             ELSE
 12529                 MOVE AL-UANON    TO LCVCNDTA
 12530                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 12531                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 12532             END-IF
 12533         END-IF
 12534     END-IF.
 12535
 12536     IF ACVCNDTL GREATER ZERO
 12537         IF ACVCNDTI NOT = SPACES
 12538             MOVE ACVCNDTI        TO DATE-WORK
 12539             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12540             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12541             MOVE '4'             TO DC-OPTION-CODE
 12542             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12543             IF DATE-CONVERSION-ERROR
 12544                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 239
* EL130.cbl
 12545                 MOVE -1          TO ACVCNDTL
 12546                 MOVE ER-7638     TO EMI-ERROR
 12547                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12548             ELSE
 12549                 MOVE AL-UANON    TO ACVCNDTA
 12550                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 12551                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 12552             END-IF
 12553         END-IF
 12554     END-IF.
 12555
 12556     IF ADDONDTL GREATER ZERO
 12557         MOVE ADDONDTI        TO DATE-WORK
 12558         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12559         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12560         MOVE '4'             TO DC-OPTION-CODE
 12561         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12562         IF DATE-CONVERSION-ERROR
 12563             MOVE AL-UABON    TO ADDONDTA
 12564             MOVE -1          TO ADDONDTL
 12565             MOVE ER-7651     TO EMI-ERROR
 12566             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12567         ELSE
 12568             MOVE AL-UANON    TO ADDONDTA
 12569             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 12570             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 12571         END-IF
 12572     END-IF.
 12573
 12574     IF APRL GREATER ZERO
 12575
 12576* EXEC CICS BIF DEEDIT
 12577*            FIELD    (APRI)
 12578*            LENGTH   (8)
 12579*        END-EXEC
 12580     MOVE 8
 12581       TO DFHEIV11
 12582*    MOVE '@"L                   #   #00011472' TO DFHEIV0
 12583     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12584     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12585     MOVE X'2020233030303131343732' TO DFHEIV0(25:11)
 12586     CALL 'kxdfhei1' USING DFHEIV0,
 12587           APRI,
 12588           DFHEIV11
 12589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12590         IF APRI NOT NUMERIC
 12591             MOVE AL-UNBON       TO APRA
 12592             MOVE -1             TO APRL
 12593             MOVE ER-0248        TO EMI-ERROR
 12594             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12595         ELSE
 12596             MOVE AL-UNNON       TO APRA
 12597             MOVE APRI           TO WS-APR APRO
 12598         END-IF
 12599     END-IF.
 12600
 12601     IF PMTFREQL GREATER ZERO
 12602
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 240
* EL130.cbl
 12603* EXEC CICS BIF DEEDIT
 12604*            FIELD   (PMTFREQI)
 12605*            LENGTH  (2)
 12606*        END-EXEC
 12607     MOVE 2
 12608       TO DFHEIV11
 12609*    MOVE '@"L                   #   #00011488' TO DFHEIV0
 12610     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12611     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12612     MOVE X'2020233030303131343838' TO DFHEIV0(25:11)
 12613     CALL 'kxdfhei1' USING DFHEIV0,
 12614           PMTFREQI,
 12615           DFHEIV11
 12616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12617         IF PMTFREQI NOT NUMERIC
 12618             MOVE -1             TO PMTFREQL
 12619             MOVE AL-UNBON       TO PMTFREQA
 12620             MOVE ER-0258        TO EMI-ERROR
 12621             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12622         ELSE
 12623             MOVE AL-UNNON       TO PMTFREQA
 12624             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 12625         END-IF
 12626     END-IF.
 12627
 12628     IF INDGRPL GREATER ZERO
 12629         IF INDGRPI = 'I' OR 'G'
 12630             MOVE AL-UANON       TO INDGRPA
 12631         ELSE
 12632             MOVE -1 TO INDGRPL
 12633             MOVE AL-UABON       TO INDGRPA
 12634             MOVE ER-0260        TO EMI-ERROR
 12635             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12636         END-IF
 12637     END-IF.
 12638
 12639     IF LOANBALL GREATER ZERO
 12640         MOVE LOANBALI           TO DEEDIT-FIELD
 12641
 12642* EXEC CICS BIF DEEDIT
 12643*            FIELD   (DEEDIT-FIELD)
 12644*            LENGTH  (12)
 12645*        END-EXEC
 12646     MOVE 12
 12647       TO DFHEIV11
 12648*    MOVE '@"L                   #   #00011516' TO DFHEIV0
 12649     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12650     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12651     MOVE X'2020233030303131353136' TO DFHEIV0(25:11)
 12652     CALL 'kxdfhei1' USING DFHEIV0,
 12653           DEEDIT-FIELD,
 12654           DFHEIV11
 12655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12656         IF DEEDIT-FIELD NOT NUMERIC
 12657             MOVE AL-UNBON       TO LOANBALA
 12658             MOVE -1             TO LOANBALL
 12659             MOVE ER-0247        TO EMI-ERROR
 12660             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 241
* EL130.cbl
 12661         ELSE
 12662             MOVE AL-UNNON       TO LOANBALA
 12663             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 12664         END-IF
 12665     END-IF.
 12666
 12667     IF PREMTYPL GREATER ZERO
 12668         IF (PREMTYPI = '1' OR '2' OR '3')
 12669             MOVE AL-UANON       TO PREMTYPA
 12670         ELSE
 12671             MOVE -1             TO PREMTYPL
 12672             MOVE AL-UABON       TO PREMTYPA
 12673             MOVE ER-0227        TO EMI-ERROR
 12674             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12675         END-IF
 12676     END-IF.
 12677
 12678     IF REINCDL GREATER ZERO
 12679         MOVE LOW-VALUES         TO  ERREIN-KEY
 12680         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 12681         MOVE REINCDI            TO  REIN-CODE-1
 12682                                     REIN-CODE-2
 12683                                     REIN-CODE-3
 12684         MOVE 'A'                TO  REIN-TYPE
 12685         PERFORM 7992-READ-REIN THRU 7992-EXIT
 12686         IF REIN-REC-NOT-FOUND
 12687             MOVE ER-0266        TO  EMI-ERROR
 12688             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12689             MOVE -1             TO  REINCDL
 12690             MOVE AL-UABON       TO  REINCDA
 12691         ELSE
 12692             MOVE AL-UANON       TO  REINCDA
 12693         END-IF
 12694     END-IF.
 12695
 12696     IF CERTMTI NOT = 'A'
 12697        GO TO 6200-EXIT
 12698     END-IF.
 12699
 12700     IF PREMTYPI = '1'
 12701         IF LCVCDL GREATER ZERO
 12702             IF WS-LF-SPECIAL-CALC-CD = 'O'
 12703                 MOVE ER-0841        TO  EMI-ERROR
 12704                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12705                 MOVE -1             TO  PREMTYPL
 12706                 MOVE AL-UABON       TO  PREMTYPA
 12707             END-IF
 12708         END-IF
 12709     END-IF.
 12710
 12711     IF PREMTYPI = '1'
 12712         IF ACVCDL GREATER ZERO
 12713             IF WS-AH-SPECIAL-CALC-CD = 'O'
 12714                 MOVE ER-0841        TO  EMI-ERROR
 12715                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12716                 MOVE -1             TO  PREMTYPL
 12717                 MOVE AL-UABON       TO  PREMTYPA
 12718             END-IF
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 242
* EL130.cbl
 12719         END-IF
 12720     END-IF.
 12721
 12722     IF PREMTYPI = '2'
 12723         IF LCVCDL GREATER ZERO
 12724             IF (PI-COMPANY-ID = 'HAN') AND
 12725                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 12726                        OR
 12727                 WS-LF-SPECIAL-CALC-CD = 'O'
 12728*                NEXT SENTENCE
 12729                 CONTINUE
 12730             ELSE
 12731                 MOVE ER-0840        TO  EMI-ERROR
 12732                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12733                 MOVE -1             TO  PREMTYPL
 12734                 MOVE AL-UABON       TO  PREMTYPA
 12735             END-IF
 12736         END-IF
 12737     END-IF.
 12738
 12739     IF PREMTYPI = '2'
 12740         IF ACVCDL GREATER ZERO
 12741             IF (PI-COMPANY-ID = 'HAN')  AND
 12742                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 12743                        OR
 12744                 WS-AH-SPECIAL-CALC-CD = 'O'
 12745*                NEXT SENTENCE
 12746                 CONTINUE
 12747             ELSE
 12748                 MOVE ER-0840        TO  EMI-ERROR
 12749                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12750                 MOVE -1             TO  PREMTYPL
 12751                 MOVE AL-UABON       TO  PREMTYPA
 12752             END-IF
 12753         END-IF
 12754     END-IF.
 12755
 12756     IF LCVCDL = ZEROS
 12757        GO TO 6200-EXIT
 12758     END-IF.
 12759
 12760     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 12761         IF PMTFREQI NOT = ZEROS
 12762             MOVE ER-0428        TO EMI-ERROR
 12763             MOVE -1             TO PMTFREQL
 12764             MOVE AL-UNBON       TO PMTFREQA
 12765             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12766             GO TO 6200-CHECK-APR
 12767         END-IF
 12768     END-IF.
 12769
 12770     IF PMTFREQL = ZEROS AND TEX-REG
 12771         MOVE ER-0429            TO EMI-ERROR
 12772         MOVE -1                 TO PMTFREQL
 12773         MOVE AL-UNBON           TO PMTFREQA
 12774         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12775         GO TO 6200-CHECK-APR
 12776     END-IF.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 243
* EL130.cbl
 12777
 12778     IF LCVOTRMI NOT NUMERIC
 12779         GO TO 6200-CHECK-APR
 12780     END-IF.
 12781
 12782     IF WS-PMTFREQ NOT = ZERO
 12783         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 12784         GIVING DIVIDE-QUOT
 12785         REMAINDER DIVIDE-REM
 12786         IF DIVIDE-REM GREATER ZERO
 12787             MOVE ER-0430            TO EMI-ERROR
 12788             MOVE -1                 TO PMTFREQL
 12789             MOVE AL-UNBON           TO PMTFREQA
 12790             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12791         END-IF
 12792     END-IF.
 12793
 12794 6200-CHECK-APR.
 12795     IF NET-PAY AND APRL = ZEROS
 12796        MOVE ER-0257             TO EMI-ERROR
 12797        MOVE -1                  TO APRL
 12798        MOVE AL-UABON            TO APRA
 12799        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12800     END-IF.
 12801
 12802 6200-EXIT.
 12803     EXIT.
 12804
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 244
* EL130.cbl
 12806 6300-REQUIRED-CERT-EDIT.
 12807
 12808     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12809        GO TO 6300-REQUIRED-AH-EDIT
 12810     END-IF
 12811
 12812     IF LCVCDL = ZERO
 12813        MOVE ER-7639             TO EMI-ERROR
 12814        MOVE -1                  TO LCVCDL
 12815        MOVE AL-UABON            TO LCVCDA
 12816        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12817     END-IF.
 12818
 12819     IF LCVOTRML = ZERO
 12820        MOVE ER-7670             TO EMI-ERROR
 12821        MOVE -1                  TO LCVOTRML
 12822        MOVE AL-UNBON            TO LCVOTRMA
 12823        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12824     END-IF.
 12825
 12826     IF LCVBENEL = ZERO
 12827        MOVE ER-7671             TO EMI-ERROR
 12828        MOVE -1                  TO LCVBENEL
 12829        MOVE AL-UNBON            TO LCVBENEA
 12830        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12831     END-IF.
 12832
 12833     GO TO 6399-EXIT.
 12834
 12835 6300-REQUIRED-AH-EDIT.
 12836
 12837     IF ACVCDL = ZERO
 12838        MOVE ER-7639             TO EMI-ERROR
 12839        MOVE -1                  TO ACVCDL
 12840        MOVE AL-UABON            TO ACVCDA
 12841        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12842     END-IF.
 12843
 12844     IF ACVOTRML = ZERO
 12845         MOVE ER-7670             TO EMI-ERROR
 12846         MOVE -1                  TO ACVOTRML
 12847         MOVE AL-UNBON            TO ACVOTRMA
 12848         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12849     END-IF.
 12850
 12851     IF ACVBENEL = ZERO
 12852        MOVE ER-7671             TO EMI-ERROR
 12853        MOVE -1                  TO ACVBENEL
 12854        MOVE AL-UNBON            TO ACVBENEA
 12855        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12856     END-IF.
 12857
 12858 6399-EXIT.
 12859      EXIT.
 12860
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 245
* EL130.cbl
 12862 6400-TEST-CLAIM-REASONABILITY.
 12863
 12864     IF WS-INCUR = LOW-VALUES
 12865        GO TO 6499-EXIT
 12866     END-IF.
 12867
 12868     IF WS-EFFDT NOT = LOW-VALUES
 12869         IF WS-INCUR LESS WS-EFFDT
 12870             MOVE ER-0458          TO EMI-ERROR
 12871             MOVE -1               TO INCURL
 12872             MOVE AL-UABON         TO INCURA
 12873             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12874         END-IF
 12875     END-IF.
 12876
 12877     IF CERTMTI = 'A'
 12878        GO TO 6460-TEST-NEW-CERT
 12879     END-IF.
 12880
 12881     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12882     MOVE CRTCARRI               TO CERT-CARRIER.
 12883     MOVE GROUPI                 TO CERT-GROUPING.
 12884     MOVE STATEI                 TO CERT-STATE.
 12885     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 12886     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 12887     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 12888
 12889
 12890
 12891* EXEC CICS HANDLE CONDITION
 12892*         DUPKEY   (6499-EXIT)
 12893*         NOTFND   (6499-EXIT)
 12894*    END-EXEC.
 12895*    MOVE '"$$I                  ! B #00011754' TO DFHEIV0
 12896     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 12897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12898     MOVE X'4220233030303131373534' TO DFHEIV0(25:11)
 12899     CALL 'kxdfhei1' USING DFHEIV0
 12900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12901
 12902
 12903     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 12904
 12905     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 12906        'I' OR 'G')
 12907        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 12908     ELSE
 12909        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 12910     END-IF.
 12911
 12912     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12913     MOVE '6'                    TO DC-OPTION-CODE.
 12914     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12915
 12916     IF WS-INCUR GREATER THAN DC-BIN-DATE-2
 12917        MOVE ER-0519             TO EMI-ERROR
 12918        MOVE -1                  TO INCURL
 12919        MOVE AL-UABON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 246
* EL130.cbl
 12920        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12921     END-IF.
 12922
 12923     IF CLMCARRI NOT = CRTCARRI
 12924        MOVE ER-0562             TO EMI-ERROR
 12925        MOVE AL-UABON            TO CLMCARRA
 12926        MOVE -1                  TO CLMCARRL
 12927        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12928     END-IF.
 12929
 12930     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 12931        CM-AH-BENEFIT-CD = '00')
 12932                  OR
 12933        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 12934        CM-LF-BENEFIT-CD = '00')
 12935         MOVE ER-0521         TO EMI-ERROR
 12936         MOVE AL-UABON        TO CLMTYPEA
 12937         MOVE -1              TO CLMTYPEL
 12938         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12939     END-IF.
 12940*    IF CLMTYPEI = 'I' AND
 12941*       CM-AH-CRITICAL-PERIOD = +0
 12942*        MOVE ER-0521         TO EMI-ERROR
 12943*        MOVE AL-UABON        TO CLMTYPEA
 12944*        MOVE -1              TO CLMTYPEL
 12945*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12946*    END-IF
 12947
 12948*    IF PI-COMPANY-ID = 'CRI'
 12949*        IF MAINTI = 'A'
 12950*            IF CERT-PEND-ISSUE-ERROR  OR
 12951*               CERT-PEND-ISSUE-RETURNED
 12952*                MOVE -1                 TO CERTNOL
 12953*                MOVE AL-UABON           TO CERTNOA
 12954*                MOVE ER-7640            TO EMI-ERROR
 12955*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12956*            END-IF
 12957*        END-IF
 12958*    END-IF.
 12959
 12960     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 12961         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 12962         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 12963             GO TO 6450-DATE-ERROR
 12964         END-IF
 12965     END-IF.
 12966
 12967     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 12968         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 12969         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 12970             GO TO 6450-DATE-ERROR
 12971         END-IF
 12972     END-IF.
 12973
 12974     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 12975         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 12976             GO TO 6450-DATE-ERROR
 12977         END-IF
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 247
* EL130.cbl
 12978     END-IF.
 12979
 12980     GO TO 6499-EXIT.
 12981
 12982 6450-DATE-ERROR.
 12983     MOVE ER-0520                TO EMI-ERROR.
 12984     MOVE -1                     TO INCURL.
 12985     MOVE AL-UABON               TO INCURA.
 12986     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12987
 12988*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 12989*       (EMI-SEVERITY-SAVE = 'X')
 12990*        ADD 1                TO EMI-FORCABLE-CTR
 12991*        SUBTRACT 1 FROM EMI-FATAL-CTR
 12992*    END-IF.
 12993
 12994     GO TO 6499-EXIT.
 12995
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 248
* EL130.cbl
 12997 6460-TEST-NEW-CERT.
 12998
 12999     IF NOT EMI-NO-ERRORS
 13000        GO TO 6499-EXIT
 13001     END-IF.
 13002
 13003     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 13004
 13005     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 13006         ACVOTRML GREATER ZERO)
 13007        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 13008     END-IF.
 13009
 13010     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13011         LCVOTRML GREATER ZERO
 13012        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 13013     END-IF.
 13014
 13015     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 13016
 13017*    IF PI-COMPANY-ID = 'HAN'
 13018*        IF ADDONDTL GREATER ZERO
 13019*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 13020*            IF CLMTYPEI = 'A'
 13021*                IF ACVOTRMI NOT = ZEROS
 13022*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 13023*                ELSE
 13024*                    NEXT SENTENCE
 13025*                    CONTINUE
 13026*                END-IF
 13027*            ELSE
 13028*                IF LCVOTRMI NOT = ZEROS
 13029*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 13030*                END-IF
 13031*            END-IF
 13032*        END-IF
 13033*    END-IF.
 13034
 13035     MOVE '6'                    TO DC-OPTION-CODE.
 13036     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13037
 13038     IF NO-CONVERSION-ERROR
 13039         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 13040     END-IF.
 13041
 13042     IF WS-INCUR GREATER THAN WS-EXPIRE
 13043        MOVE ER-0519             TO EMI-ERROR
 13044        MOVE -1                  TO INCURL
 13045        MOVE AL-UABON            TO INCURA
 13046        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13047     END-IF.
 13048
 13049     IF CLMCARRI NOT = CRTCARRI
 13050        MOVE ER-0562             TO EMI-ERROR
 13051        MOVE AL-UABON            TO CLMCARRA
 13052        MOVE -1                  TO CLMCARRL
 13053        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13054     END-IF.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 249
* EL130.cbl
 13055
 13056     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 13057         ACVCDL = ZEROS)
 13058             MOVE ER-0521        TO EMI-ERROR
 13059             MOVE AL-UABON       TO CLMTYPEA
 13060             MOVE -1             TO CLMTYPEL
 13061             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13062     END-IF.
 13063
 13064     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 13065         LCVCDL = ZEROS
 13066             MOVE ER-0521        TO EMI-ERROR
 13067             MOVE AL-UABON       TO CLMTYPEA
 13068             MOVE -1             TO CLMTYPEL
 13069             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13070     END-IF.
 13071
 13072     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13073         IF LCVCNDTL GREATER ZERO
 13074             IF WS-INCUR GREATER THAN WS-LCVCNDT
 13075                 GO TO 6450-DATE-ERROR
 13076             END-IF
 13077         END-IF
 13078     END-IF.
 13079
 13080     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13081         IF ACVCNDTL GREATER ZERO
 13082             IF WS-INCUR GREATER THAN WS-ACVCNDT
 13083                 GO TO 6450-DATE-ERROR
 13084             END-IF
 13085         END-IF
 13086     END-IF.
 13087
 13088 6499-EXIT.
 13089     EXIT.
 13090
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 250
* EL130.cbl
 13092 6600-CHECK-AUTO-ACTIVITY.
 13093
 13094
 13095* EXEC CICS HANDLE CONDITION
 13096*        NOTFND   (6600-NOT-FOUND)
 13097*    END-EXEC.
 13098*    MOVE '"$I                   ! C #00011950' TO DFHEIV0
 13099     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13100     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13101     MOVE X'4320233030303131393530' TO DFHEIV0(25:11)
 13102     CALL 'kxdfhei1' USING DFHEIV0
 13103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13104
 13105
 13106     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 13107     MOVE 'T'                        TO  CNTL-REC-TYPE.
 13108     MOVE SPACES                     TO  CNTL-ACCESS.
 13109     MOVE +0                         TO  CNTL-SEQ-NO.
 13110
 13111     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13112
 13113     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 13114         MOVE 'N'                    TO  WS-REC-FOUND-SW
 13115                                         WS-LETTER-SW
 13116         GO TO 6600-EXIT
 13117     END-IF.
 13118
 13119     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 13120         MOVE 'N'                     TO  WS-LETTER-SW
 13121     ELSE
 13122         MOVE 'Y'                     TO  WS-LETTER-SW
 13123     END-IF.
 13124
 13125     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 13126     GO TO 6600-EXIT.
 13127
 13128 6600-START-AUTO-LETTER-WRITER.
 13129
 13130     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 13131     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 13132
 13133     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 13134
 13135     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 13136         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 13137         MOVE '6'                     TO  DC-OPTION-CODE
 13138         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 13139         MOVE +0                      TO  DC-ELAPSED-MONTHS
 13140         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13141         IF NO-CONVERSION-ERROR
 13142             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 13143         ELSE
 13144             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 13145         END-IF
 13146     END-IF.
 13147
 13148     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
 13149         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 251
* EL130.cbl
 13150         MOVE '6'                     TO  DC-OPTION-CODE
 13151         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 13152         MOVE +0                      TO  DC-ELAPSED-MONTHS
 13153         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13154         IF NO-CONVERSION-ERROR
 13155             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 13156         ELSE
 13157             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 13158         END-IF
 13159     END-IF.
 13160
 13161
 13162
 13163* EXEC CICS LINK
 13164*        PROGRAM    (LINK-1523)
 13165*        COMMAREA   (W-1523-LINKDATA)
 13166*        LENGTH     (W-1523-COMM-LENGTH)
 13167*    END-EXEC.
 13168*    MOVE '."C                   (   #00012010' TO DFHEIV0
 13169     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13170     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13171     MOVE X'2020233030303132303130' TO DFHEIV0(25:11)
 13172     CALL 'kxdfhei1' USING DFHEIV0,
 13173           LINK-1523,
 13174           W-1523-LINKDATA,
 13175           W-1523-COMM-LENGTH,
 13176           DFHEIV99,
 13177           DFHEIV99,
 13178           DFHEIV99,
 13179           DFHEIV99
 13180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13181
 13182
 13183     GO TO 6600-EXIT.
 13184
 13185 6600-NOT-FOUND.
 13186     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 13187
 13188 6600-EXIT.
 13189     EXIT.
 13190
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 252
* EL130.cbl
 13191/
 13192*************************************************************
 13193*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 13194*************************************************************
 13195
 13196 6700-OUTPUT-ACTIVITY-RECORD.
 13197
 13198
 13199
 13200* EXEC CICS GETMAIN
 13201*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 13202*        LENGTH (DLYACTV-LENGTH)
 13203*        INITIMG (WS-BLANK)
 13204*    END-EXEC.
 13205*    MOVE ',"IL                  $   #00012032' TO DFHEIV0
 13206     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13207     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13208     MOVE X'2020233030303132303332' TO DFHEIV0(25:11)
 13209     CALL 'kxdfhei1' USING DFHEIV0,
 13210           DFHEIV20,
 13211           DLYACTV-LENGTH,
 13212           WS-BLANK
 13213     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 13214         DFHEIV20
 13215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13216
 13217
 13218     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 13219     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 13220     MOVE CLMCARRI               TO DA-CARRIER.
 13221     IF CLMNOL EQUAL ZERO
 13222         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 13223     ELSE
 13224         MOVE CLMNOI             TO DA-CLAIM-NO
 13225     END-IF.
 13226     MOVE CERTNOI                TO DA-CERT-PRIME.
 13227     MOVE SUFXI                  TO DA-CERT-SFX.
 13228     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 13229     MOVE 'A'                    TO DA-RECORD-TYPE.
 13230
 13231
 13232* EXEC CICS HANDLE CONDITION
 13233*        NOTOPEN (6700-NOTOPEN-ERROR)
 13234*        DUPREC (6700-EXIT)
 13235*    END-EXEC.
 13236*    MOVE '"$J%                  ! D #00012051' TO DFHEIV0
 13237     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 13238     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13239     MOVE X'4420233030303132303531' TO DFHEIV0(25:11)
 13240     CALL 'kxdfhei1' USING DFHEIV0
 13241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13242
 13243
 13244
 13245* EXEC CICS WRITE
 13246*        DATASET (DLYACTV-DSID)
 13247*        RIDFLD (DA-KEY)
 13248*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 253
* EL130.cbl
 13249*        LENGTH (DLYACTV-LENGTH)
 13250*    END-EXEC.
 13251*    MOVE '&$ L                  ''   #00012056' TO DFHEIV0
 13252     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13253     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13254     MOVE X'2020233030303132303536' TO DFHEIV0(25:11)
 13255     CALL 'kxdfhei1' USING DFHEIV0,
 13256           DLYACTV-DSID,
 13257           DAILY-ACTIVITY-RECORD,
 13258           DLYACTV-LENGTH,
 13259           DA-KEY,
 13260           DFHEIV99,
 13261           DFHEIV99
 13262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13263
 13264     GO TO 6700-EXIT.
 13265
 13266 6700-NOTOPEN-ERROR.
 13267     MOVE '2955'                 TO EMI-ERROR.
 13268     MOVE -1                     TO MAINTL.
 13269     MOVE AL-UANON               TO MAINTA.
 13270     PERFORM 9900-ERROR-FORMAT THRU
 13271             9900-EXIT.
 13272     GO TO 8200-SEND-DATAONLY.
 13273
 13274 6700-EXIT.
 13275     EXIT.
 13276
 13277*************************************************************
 13278*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 13279*************************************************************
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 254
* EL130.cbl
 13280/
 13281 6990-DEEDIT-DATE.
 13282
 13283
 13284* EXEC CICS BIF DEEDIT
 13285*        FIELD   (DATE-WORK)
 13286*        LENGTH  (8)
 13287*    END-EXEC.
 13288     MOVE 8
 13289       TO DFHEIV11
 13290*    MOVE '@"L                   #   #00012081' TO DFHEIV0
 13291     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13292     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13293     MOVE X'2020233030303132303831' TO DFHEIV0(25:11)
 13294     CALL 'kxdfhei1' USING DFHEIV0,
 13295           DATE-WORK,
 13296           DFHEIV11
 13297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13298
 13299 6990-EXIT.
 13300     EXIT.
 13301
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 255
* EL130.cbl
 13303 7000-BUILD-OUTPUT-MAP.
 13304
 13305     IF CLAIM-SWITCH = 'N'
 13306         GO TO 7050-BUILD-MAP-CERT-DATA
 13307     END-IF.
 13308
 13309     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 13310         MOVE SPACES                 TO SEQUO
 13311         MOVE AL-SABOF               TO SEQUA
 13312     ELSE
 13313         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 13314         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 13315         MOVE WS-CLAIM-SEQU          TO SEQUO
 13316         MOVE AL-SABON               TO SEQUA
 13317     END-IF.
 13318
 13319     MOVE CL-CARRIER             TO CLMCARRO.
 13320     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 13321     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 13322     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 13323     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 13324     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 13325     MOVE CL-INSURED-MID-INIT    TO INITO.
 13326     MOVE CL-INSURED-SEX-CD      TO SEXO.
 13327     MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 13328
 13329     MOVE AL-UANON               TO CLMCARRA
 13330                                    CLMTYPEA
 13331                                    PCERTNOA
 13332                                    PSUFXA
 13333                                    LSTNMEA
 13334                                    FSTNMEA
 13335                                    INITA
 13336                                    SEXA
 13337                                    OCCCDA.
 13338
 13339     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 13340
 13341     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 13342         MOVE ' '                 TO DC-OPTION-CODE
 13343         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 13344         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13345         IF NOT DATE-CONVERSION-ERROR
 13346             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 13347             MOVE AL-UANON            TO BIRTHDTA
 13348         END-IF
 13349     END-IF.
 13350
 13351     MOVE CL-SOC-SEC-NO          TO SSNO.
 13352     MOVE AL-UANON               TO SSNA.
 13353
 13354     IF CL-INCURRED-DT NOT = LOW-VALUES
 13355         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13356         MOVE ' '                TO DC-OPTION-CODE
 13357         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13358         IF NOT DATE-CONVERSION-ERROR
 13359             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 13360             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 256
* EL130.cbl
 13361         END-IF
 13362     END-IF.
 13363
 13364     IF CL-REPORTED-DT NOT = LOW-VALUES
 13365         MOVE ' '                TO DC-OPTION-CODE
 13366         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 13367         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13368         IF NOT DATE-CONVERSION-ERROR
 13369             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 13370             MOVE AL-UANON            TO REPORTA
 13371         END-IF
 13372     END-IF.
 13373
 13374     IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 13375         MOVE ' '                 TO DC-OPTION-CODE
 13376         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 13377         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13378         IF NOT DATE-CONVERSION-ERROR
 13379             MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 13380             MOVE AL-UANON            TO ESTENDA
 13381         END-IF
 13382     END-IF.
 13383
 13384     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 13385     MOVE CL-CAUSE-CD            TO CAUSEO.
 13386     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 13387     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 13388     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 13389     MOVE CL-PRIORITY-CD         TO PRICDO.
 13390     MOVE AL-UANON               TO DIAGA
 13391                                    CAUSEA
 13392                                    RELCLMA
 13393                                    PROCCDA
 13394                                    PRICDA.
 13395     MOVE AL-UNNON               TO MANRSVA.
 13396
 13397*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 13398*        MOVE CL-PRODUCT-CD          TO PRODCDO
 13399*        MOVE AL-UANON               TO PRODCDA
 13400*    END-IF.
 13401
 13402     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 13403     MOVE CL-FILE-LOCATION       TO FILETOO.
 13404     MOVE CL-BENEFICIARY         TO BENECDO.
 13405     MOVE AL-UANON               TO SUPVA
 13406                                    FILETOA
 13407                                    BENECDA.
 13408
 13409     IF CLAIM-SWITCH = 'X'
 13410         GO TO 7099-EXIT
 13411     END-IF.
 13412
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 257
* EL130.cbl
 13414 7050-BUILD-MAP-CERT-DATA.
 13415     MOVE CM-CERT-PRIME          TO CERTNOO.
 13416     MOVE CM-CERT-SFX            TO SUFXO.
 13417     MOVE AL-SANON               TO CERTNOA
 13418                                    SUFXA.
 13419
 13420     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 13421         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 13422         MOVE ' '                TO DC-OPTION-CODE
 13423         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13424         IF NOT DATE-CONVERSION-ERROR
 13425             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 13426         END-IF
 13427     END-IF.
 13428
 13429     MOVE CM-ACCOUNT             TO ACCOUNTO.
 13430     MOVE CM-STATE               TO STATEO.
 13431     MOVE CM-CARRIER             TO CRTCARRO.
 13432     MOVE CM-GROUPING            TO GROUPO.
 13433     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 13434     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 13435     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 13436     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 13437     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 13438     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 13439     MOVE CM-JT-INITIAL          TO JNTINITO.
 13440     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 13441     MOVE AL-UANON               TO ACCOUNTA
 13442                                    STATEA
 13443                                    CRTCARRA
 13444                                    GROUPA
 13445                                    CRTLNMEA
 13446                                    CRTFNMEA
 13447                                    CRTINITA
 13448                                    JNTLNMEA
 13449                                    JNTFNMEA
 13450                                    JNTINITA.
 13451     MOVE AL-UNNON               TO ISSAGEA
 13452                                    JNTAGEA.
 13453
 13454     IF CM-SSN-STATE   = CM-STATE AND
 13455        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 13456*        NEXT SENTENCE
 13457         CONTINUE
 13458     ELSE
 13459         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 13460     END-IF.
 13461
 13462     MOVE AL-UANON               TO CRTSSNA.
 13463
 13464     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 13465     MOVE '2'                    TO DC-OPTION-CODE.
 13466     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13467     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 13468
 13469*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 13470     MOVE SPACES                 TO ELCNTL-KEY.
 13471     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 258
* EL130.cbl
 13472     MOVE '3'                    TO CNTL-REC-TYPE.
 13473     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13474     MOVE ZEROS                  TO CNTL-SEQ-NO.
 13475
 13476
 13477
 13478* EXEC CICS READ
 13479*        DATASET  (ELCNTL-DSID)
 13480*        SET      (ADDRESS OF CONTROL-FILE)
 13481*        RIDFLD   (ELCNTL-KEY)
 13482*        RESP     (WS-RESPONSE)
 13483*    END-EXEC.
 13484*    MOVE '&"S        E          (  N#00012263' TO DFHEIV0
 13485     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13486     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13487     MOVE X'204E233030303132323633' TO DFHEIV0(25:11)
 13488     CALL 'kxdfhei1' USING DFHEIV0,
 13489           ELCNTL-DSID,
 13490           DFHEIV20,
 13491           DFHEIV99,
 13492           ELCNTL-KEY,
 13493           DFHEIV99,
 13494           DFHEIV99,
 13495           DFHEIV99
 13496     SET ADDRESS OF CONTROL-FILE TO
 13497         DFHEIV20
 13498     MOVE EIBRESP  TO WS-RESPONSE
 13499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13500
 13501
 13502     IF WS-RESP-NOTFND
 13503          MOVE ER-2848           TO EMI-ERROR
 13504          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13505          GO TO 8100-SEND-INITIAL-MAP
 13506     END-IF.
 13507
 13508     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 13509     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
 13510     MOVE CF-ST-CAUSAL-STATE TO PI-ST-CAUSAL-STATE.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 259
* EL130.cbl
 13512     IF CM-LF-BENEFIT-CD = '00'
 13513         MOVE ZEROS              TO LCVOTRMO
 13514                                    LCVRTRMO
 13515                                    LCVRATEO
 13516                                    LCVBENEO
 13517         MOVE SPACES             TO LCVDSCRO
 13518                                    LCVCDO
 13519                                    LCVKINDO
 13520                                    LCVFORMO
 13521                                    LCVCNDTO
 13522                                    LCVEXITO
 13523                                    LCVSTATO
 13524         IF CLMTYPEL GREATER THAN ZERO AND
 13525            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13526                MOVE ER-0521     TO EMI-ERROR
 13527                MOVE AL-UABON    TO CLMTYPEA
 13528                MOVE -1          TO CLMTYPEL
 13529                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13530                GO TO 7060-FILL-AH-COVERAGE
 13531         ELSE
 13532             GO TO 7060-FILL-AH-COVERAGE
 13533         END-IF
 13534     END-IF.
 13535
 13536     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 13537     MOVE AL-UANON               TO LCVDSCRA.
 13538     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 13539     MOVE '4'                    TO WS-REC-TYPE.
 13540     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 13541     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 13542     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 13543     MOVE AL-UANON               TO LCVCDA.
 13544     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 13545                                    CP-ORIGINAL-TERM.
 13546     MOVE AL-UNNON               TO LCVOTRMA.
 13547     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13548     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13549     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 13550     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13551     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13552     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13553
 13554     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 13555     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 13556
 13557     IF CM-LF-PREMIUM-RATE NUMERIC
 13558         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 13559     ELSE
 13560         MOVE ZEROS              TO LCVRATEO
 13561     END-IF.
 13562
 13563     MOVE AL-UNNON               TO LCVRATEA.
 13564
 13565     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 13566         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 13567     END-IF.
 13568
 13569     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 260
* EL130.cbl
 13570
 13571     MOVE AL-UNNON               TO LCVBENEA.
 13572
 13573     IF CM-POLICY-FORM-NO NOT = SPACES
 13574         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 13575     ELSE
 13576         MOVE WS-FORM-HOLD       TO LCVFORMO
 13577     END-IF.
 13578
 13579     MOVE SPACES                 TO WS-FORM-HOLD.
 13580     MOVE 'L'                    TO WS-REC-TYPE.
 13581     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 13582
 13583     IF WS-FORM-HOLD NOT = SPACES
 13584         MOVE WS-FORM-HOLD       TO LCVFORMO
 13585         MOVE AL-UANON           TO LCVFORMA
 13586     END-IF.
 13587
 13588     IF CM-LF-CURRENT-STATUS = '8'
 13589         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 13590             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 13591             MOVE ' '             TO DC-OPTION-CODE
 13592             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13593             IF NOT DATE-CONVERSION-ERROR
 13594                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 13595                 MOVE AL-UANON            TO LCVCNDTA
 13596             END-IF
 13597         END-IF
 13598     END-IF.
 13599
 13600     IF CM-LF-CURRENT-STATUS = '7'
 13601         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 13602             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 13603             MOVE ' '            TO DC-OPTION-CODE
 13604             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13605             IF NOT DATE-CONVERSION-ERROR
 13606                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 13607                 MOVE AL-UANON   TO LCVCNDTA
 13608             END-IF
 13609         END-IF
 13610     END-IF.
 13611
 13612     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 13613         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 13614             MOVE ' '            TO DC-OPTION-CODE
 13615             MOVE CM-LF-DEATH-EXIT-DT
 13616                                 TO DC-BIN-DATE-1
 13617             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13618             IF NOT DATE-CONVERSION-ERROR
 13619                 MOVE DC-GREG-DATE-1-EDIT
 13620                                 TO LCVEXITO
 13621             END-IF
 13622         END-IF
 13623     END-IF.
 13624
 13625     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 13626         IF CP-REMAINING-TERM-3 = ZEROS
 13627             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 261
* EL130.cbl
 13628         ELSE
 13629             MOVE 'ACTIVE'       TO LCVSTATO
 13630         END-IF
 13631     END-IF.
 13632
 13633     IF CM-LF-CURRENT-STATUS = '2'
 13634        MOVE 'PEND  '            TO LCVSTATO
 13635     END-IF.
 13636     IF CM-LF-CURRENT-STATUS = '3'
 13637        MOVE 'RESTORE'           TO LCVSTATO
 13638     END-IF.
 13639     IF CM-LF-CURRENT-STATUS = '5'
 13640        MOVE 'REISSUE'           TO LCVSTATO
 13641     END-IF.
 13642     IF CM-LF-CURRENT-STATUS = '6'
 13643        MOVE 'LMP DIS'           TO LCVSTATO
 13644     END-IF.
 13645     IF CM-LF-CURRENT-STATUS = '7'
 13646        MOVE 'DEATH  '           TO LCVSTATO
 13647     END-IF.
 13648     IF CM-LF-CURRENT-STATUS = '8'
 13649        MOVE 'CANCEL '           TO LCVSTATO
 13650     END-IF.
 13651     IF CM-LF-CURRENT-STATUS = '9'
 13652        MOVE 'RE-ONLY'           TO LCVSTATO
 13653     END-IF.
 13654     IF CM-LF-CURRENT-STATUS = 'V'
 13655        MOVE 'VOID   '           TO LCVSTATO
 13656     END-IF.
 13657     IF CM-LF-CURRENT-STATUS = 'D'
 13658        MOVE 'DECLINE'           TO LCVSTATO
 13659     END-IF.
 13660
 13661     IF PI-COMPANY-ID = 'CID'
 13662         IF CM-LF-BENEFIT-CD >= '2O' AND
 13663            CM-LF-BENEFIT-CD <= '2V'
 13664             MOVE ER-0878       TO EMI-ERROR
 13665             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13666         END-IF
 13667     END-IF.
 13668
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 262
* EL130.cbl
 13670 7060-FILL-AH-COVERAGE.
 13671
 13672     IF CM-AH-BENEFIT-CD = '00'
 13673         MOVE ZEROS              TO ACVOTRMO
 13674                                    ACVRTRMO
 13675                                    ACVRATEO
 13676                                    ACVBENEO
 13677         MOVE SPACES             TO ACVDSCRO
 13678                                    ACVCDO
 13679                                    ACVKINDO
 13680                                    ACVFORMO
 13681                                    ACVCNDTO
 13682                                    ACVEXITO
 13683                                    ACVSTATO
 13684         IF (CLMTYPEL GREATER THAN ZERO AND
 13685             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 13686             MOVE ER-0521     TO EMI-ERROR
 13687             MOVE AL-UABON    TO CLMTYPEA
 13688             MOVE -1          TO CLMTYPEL
 13689             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13690             GO TO 7070-BUILD-MAP-FINISH
 13691         ELSE
 13692             GO TO 7070-BUILD-MAP-FINISH
 13693         END-IF
 13694     END-IF.
 13695
 13696     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 13697     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 13698     MOVE AL-UANON               TO ACVDSCRA
 13699                                    ACVCDA.
 13700     MOVE '5'                    TO WS-REC-TYPE.
 13701     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 13702     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 13703
 13704     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 13705                                    CP-ORIGINAL-TERM.
 13706     MOVE AL-UNNON               TO ACVOTRMA.
 13707
 13708     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13709     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13710     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 13711     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13712     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13713     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13714
 13715     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 13716     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 13717
 13718     IF CM-AH-PREMIUM-RATE NUMERIC
 13719         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 13720     ELSE
 13721         MOVE ZEROS              TO ACVRATEO
 13722     END-IF.
 13723
 13724     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 13725     MOVE AL-UNNON               TO ACVRATEA
 13726                                    ACVBENEA.
 13727
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 263
* EL130.cbl
 13728     IF CM-POLICY-FORM-NO NOT = SPACES
 13729         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 13730     ELSE
 13731         MOVE WS-FORM-HOLD       TO ACVFORMO
 13732         MOVE SPACES TO WS-FORM-HOLD
 13733         MOVE 'A'                TO WS-REC-TYPE
 13734         PERFORM 7400-READ-STATE THRU 7499-EXIT
 13735         IF WS-FORM-HOLD NOT = SPACES
 13736             MOVE WS-FORM-HOLD   TO ACVFORMO
 13737         END-IF
 13738     END-IF.
 13739
 13740     MOVE AL-UANON               TO ACVFORMA.
 13741
 13742     IF CM-AH-CURRENT-STATUS = '8'
 13743         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 13744             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 13745             MOVE ' '             TO DC-OPTION-CODE
 13746             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13747             IF NOT DATE-CONVERSION-ERROR
 13748                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 13749                MOVE AL-UANON    TO ACVCNDTA
 13750             END-IF
 13751         END-IF
 13752     END-IF.
 13753
 13754     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 13755         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 13756             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 13757             MOVE ' '             TO DC-OPTION-CODE
 13758             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13759             IF NOT DATE-CONVERSION-ERROR
 13760                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 13761                MOVE AL-UANON            TO ACVCNDTA
 13762             END-IF
 13763         END-IF
 13764     END-IF.
 13765
 13766     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 13767         MOVE ' '                TO DC-OPTION-CODE
 13768         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 13769         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13770         IF NOT DATE-CONVERSION-ERROR
 13771             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 13772         END-IF
 13773     END-IF.
 13774
 13775     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 13776         IF CP-REMAINING-TERM-3 = ZEROS
 13777             MOVE 'EXPIRED'      TO ACVSTATO
 13778         ELSE
 13779             MOVE 'ACTIVE'       TO ACVSTATO
 13780         END-IF
 13781     END-IF.
 13782
 13783     IF CM-AH-CURRENT-STATUS = '2'
 13784         MOVE 'PEND  '           TO ACVSTATO
 13785     END-IF.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 264
* EL130.cbl
 13786     IF CM-AH-CURRENT-STATUS = '3'
 13787         MOVE 'RESTORE'          TO ACVSTATO
 13788     END-IF.
 13789     IF CM-AH-CURRENT-STATUS = '5'
 13790         MOVE 'REISSUE'          TO ACVSTATO
 13791     END-IF.
 13792     IF CM-AH-CURRENT-STATUS = '6'
 13793         MOVE 'LMP DIS'          TO ACVSTATO
 13794     END-IF.
 13795     IF CM-AH-CURRENT-STATUS = '7'
 13796         MOVE 'DEATH  '          TO ACVSTATO
 13797     END-IF.
 13798     IF CM-AH-CURRENT-STATUS = '8'
 13799         MOVE 'CANCEL '          TO ACVSTATO
 13800     END-IF.
 13801     IF CM-AH-CURRENT-STATUS = '9'
 13802         MOVE 'RE-ONLY'          TO ACVSTATO
 13803     END-IF.
 13804     IF CM-AH-CURRENT-STATUS = 'V'
 13805         MOVE 'VOID   '          TO ACVSTATO
 13806     END-IF.
 13807     IF CM-AH-CURRENT-STATUS = 'D'
 13808         MOVE 'DECLINE'          TO ACVSTATO
 13809     END-IF.
 13810
 13811     IF PI-COMPANY-ID = 'DCC'
 13812        IF CM-ACCOUNT (9:2) = 'BI'
 13813           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 13814           MOVE CM-CARRIER       TO CTRLR-CARRIER
 13815           MOVE CM-GROUPING      TO CTRLR-GROUPING
 13816           MOVE CM-STATE         TO CTRLR-STATE
 13817           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 13818           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 13819           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 13820           MOVE 'C'              TO CTRLR-REC-TYPE
 13821
 13822* EXEC CICS READ
 13823*            DATASET  (ELCRTT-DSID)
 13824*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13825*            RIDFLD   (ELCRTT-KEY)
 13826*            RESP     (WS-RESPONSE)
 13827*          END-EXEC
 13828*    MOVE '&"S        E          (  N#00012589' TO DFHEIV0
 13829     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13830     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13831     MOVE X'204E233030303132353839' TO DFHEIV0(25:11)
 13832     CALL 'kxdfhei1' USING DFHEIV0,
 13833           ELCRTT-DSID,
 13834           DFHEIV20,
 13835           DFHEIV99,
 13836           ELCRTT-KEY,
 13837           DFHEIV99,
 13838           DFHEIV99,
 13839           DFHEIV99
 13840     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13841         DFHEIV20
 13842     MOVE EIBRESP  TO WS-RESPONSE
 13843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 265
* EL130.cbl
 13844           IF WS-RESP-NORMAL
 13845               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 13846               MOVE WS-DIAG-VIN-MSG TO DIAGO
 13847               MOVE AL-UANON        TO DIAGA
 13848           END-IF
 13849        END-IF
 13850     END-IF.
 13851
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 266
* EL130.cbl
 13853 7070-BUILD-MAP-FINISH.
 13854     MOVE CM-LOAN-APR            TO APRO.
 13855     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 13856     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 13857     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 13858     MOVE AL-UNNON               TO APRA
 13859                                    PMTFREQA.
 13860     MOVE AL-UANON               TO INDGRPA
 13861                                    PREMTYPA.
 13862
 13863     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 13864         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 13865         MOVE AL-UANON               TO REINCDA
 13866     END-IF.
 13867
 13868     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 13869*        NEXT SENTENCE
 13870         CONTINUE
 13871     ELSE
 13872         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 13873         MOVE ' '                TO DC-OPTION-CODE
 13874         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13875         IF NOT DATE-CONVERSION-ERROR
 13876             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 13877             MOVE AL-UANON            TO ADDONDTA
 13878         END-IF
 13879     END-IF.
 13880
 13881     IF CLAIM-SWITCH = 'N'
 13882         IF SEXL = ZEROS
 13883             MOVE CM-INSURED-SEX TO SEXO
 13884*            MOVE AL-UANON       TO SEXA
 13885         END-IF
 13886     END-IF.
 13887
 13888     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 13889         MOVE CM-MEMBER-NO       TO MEMBERO
 13890         MOVE AL-UANON           TO MEMBERA
 13891     END-IF.
 13892
 13893     IF MAINTI = 'A'
 13894         IF (LOANNOL = ZEROS OR
 13895             EIBAID = DFHPF5)
 13896             MOVE CM-LOAN-NUMBER TO LOANNOO
 13897             MOVE AL-UANON       TO LOANNOA
 13898         ELSE
 13899*            NEXT SENTENCE
 13900             CONTINUE
 13901         END-IF
 13902     ELSE
 13903         MOVE CM-LOAN-NUMBER     TO LOANNOO
 13904         MOVE AL-UANON           TO LOANNOA
 13905     END-IF.
 13906
 13907     IF MAINTI = 'A'
 13908         IF (LOANBALL = ZEROS OR
 13909             EIBAID = DFHPF5)
 13910             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 267
* EL130.cbl
 13911             MOVE AL-UNNON       TO LOANBALA
 13912         ELSE
 13913*            NEXT SENTENCE
 13914             CONTINUE
 13915         END-IF
 13916     ELSE
 13917         MOVE CM-LOAN-BALANCE    TO LOANBALO
 13918         MOVE AL-UNNON           TO LOANBALA
 13919     END-IF.
 13920
 13921     IF CM-PREMIUM-TYPE NOT = '3'
 13922         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 13923             PERFORM 7200-PROTECT-CERT-FIELDS
 13924         ELSE
 13925             PERFORM 7300-RESET-KEY-ATTRBS
 13926         END-IF
 13927     ELSE
 13928         PERFORM 7300-RESET-KEY-ATTRBS
 13929     END-IF.
 13930
 13931*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 13932*        NEXT SENTENCE
 13933*        CONTINUE
 13934*    ELSE
 13935         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 13936*    END-IF.
 13937
 13938 7099-EXIT.
 13939     EXIT.
 13940
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 268
* EL130.cbl
 13942 7100-READ-BENEFIT.
 13943
 13944
 13945* EXEC CICS HANDLE CONDITION
 13946*         NOTFND   (7120-NOT-FOUND)
 13947*    END-EXEC.
 13948*    MOVE '"$I                   ! E #00012695' TO DFHEIV0
 13949     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13950     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13951     MOVE X'4520233030303132363935' TO DFHEIV0(25:11)
 13952     CALL 'kxdfhei1' USING DFHEIV0
 13953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13954
 13955
 13956     MOVE SPACES                 TO ELCNTL-KEY.
 13957     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 13958     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 13959     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13960     MOVE ZEROS                  TO CNTL-SEQ-NO.
 13961
 13962 7105-READ-FILE.
 13963     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 13964
 13965     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 13966        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 13967          GO TO 7120-NOT-FOUND
 13968     END-IF.
 13969
 13970     MOVE 1                      TO SUB.
 13971 7110-LOOP.
 13972     IF SUB = 9
 13973         GO TO 7120-NOT-FOUND
 13974     END-IF.
 13975
 13976     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 13977         ADD 1                   TO SUB
 13978         GO TO 7110-LOOP
 13979     END-IF.
 13980
 13981     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 13982     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 13983     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 13984
 13985     GO TO 7199-EXIT.
 13986
 13987 7120-NOT-FOUND.
 13988     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 13989                                    WS-FORM-HOLD.
 13990
 13991 7199-EXIT.
 13992      EXIT.
 13993
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 269
* EL130.cbl
 13995 7200-PROTECT-CERT-FIELDS.
 13996     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 13997                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 13998                                LCVFORMA ACVFORMA JNTLNMEA
 13999                                JNTFNMEA JNTINITA.
 14000
 14001     IF CM-LF-CURRENT-STATUS = '2' OR
 14002        CM-AH-CURRENT-STATUS = '2'
 14003         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 14004     END-IF.
 14005
 14006     MOVE AL-SANOF TO
 14007            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 14008            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 14009            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 14010            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 14011            LCVRATEA   ACVRATEA.
 14012
 14013     MOVE 'S'                    TO CERTMTI.
 14014
 14015 7300-RESET-KEY-ATTRBS.
 14016     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 14017                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 14018                                LCVFORMA ACVFORMA JNTLNMEA
 14019                                JNTFNMEA JNTINITA.
 14020
 14021     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 14022         MOVE AL-SANOF           TO REINCDA
 14023     END-IF.
 14024
 14025     MOVE 'S'                    TO CERTMTI.
 14026
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 270
* EL130.cbl
 14028 7400-READ-STATE.
 14029
 14030
 14031* EXEC CICS HANDLE CONDITION
 14032*         NOTFND   (7499-EXIT)
 14033*    END-EXEC.
 14034*    MOVE '"$I                   ! F #00012773' TO DFHEIV0
 14035     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14036     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14037     MOVE X'4620233030303132373733' TO DFHEIV0(25:11)
 14038     CALL 'kxdfhei1' USING DFHEIV0
 14039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14040
 14041
 14042     MOVE SPACES                 TO ELCNTL-KEY.
 14043     MOVE CM-STATE               TO CNTL-ACCESS.
 14044     MOVE '3'                    TO CNTL-REC-TYPE.
 14045     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14046     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14047
 14048     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 14049
 14050     MOVE 1                      TO SUB.
 14051
 14052 7410-LOOP.
 14053     IF SUB = 21
 14054        GO TO 7499-EXIT
 14055     END-IF.
 14056
 14057*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 14058*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 14059*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 14060*        GO TO 7499-EXIT.
 14061
 14062     ADD 1                       TO SUB.
 14063     GO TO 7410-LOOP.
 14064
 14065 7499-EXIT.
 14066      EXIT.
 14067
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 271
* EL130.cbl
 14069 7500-BROWSE-FOR-DUPLICATE.
 14070
 14071     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 14072
 14073
 14074
 14075* EXEC CICS HANDLE CONDITION
 14076*        NOTFND   (7500-EXIT)
 14077*        DUPKEY   (7500-DUPLICATE-KEY)
 14078*        ENDFILE  (7500-EXIT)
 14079*    END-EXEC.
 14080*    MOVE '"$I$''                 ! G #00012809' TO DFHEIV0
 14081     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 14082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14083     MOVE X'4720233030303132383039' TO DFHEIV0(25:11)
 14084     CALL 'kxdfhei1' USING DFHEIV0
 14085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14086
 14087
 14088
 14089
 14090* EXEC CICS STARTBR
 14091*        DATASET    (ELMSTR5-DSID)
 14092*        RIDFLD     (ELMSTR5-KEY)
 14093*    END-EXEC.
 14094     MOVE 0
 14095       TO DFHEIV11
 14096*    MOVE '&,         G          &   #00012816' TO DFHEIV0
 14097     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14098     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14099     MOVE X'2020233030303132383136' TO DFHEIV0(25:11)
 14100     CALL 'kxdfhei1' USING DFHEIV0,
 14101           ELMSTR5-DSID,
 14102           ELMSTR5-KEY,
 14103           DFHEIV99,
 14104           DFHEIV11,
 14105           DFHEIV99
 14106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14107
 14108
 14109
 14110
 14111* EXEC CICS HANDLE CONDITION
 14112*        ENDFILE  (7500-END-BROWSE)
 14113*    END-EXEC.
 14114*    MOVE '"$''                   ! H #00012822' TO DFHEIV0
 14115     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14116     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14117     MOVE X'4820233030303132383232' TO DFHEIV0(25:11)
 14118     CALL 'kxdfhei1' USING DFHEIV0
 14119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14120
 14121
 14122 7500-READ-CLAIM-LOOP.
 14123
 14124
 14125
 14126* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 272
* EL130.cbl
 14127*        DATASET   (ELMSTR5-DSID)
 14128*        SET       (ADDRESS OF CLAIM-MASTER)
 14129*        RIDFLD    (ELMSTR5-KEY)
 14130*    END-EXEC.
 14131     MOVE 0
 14132       TO DFHEIV11
 14133*    MOVE '&.S                   )   #00012829' TO DFHEIV0
 14134     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14135     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14136     MOVE X'2020233030303132383239' TO DFHEIV0(25:11)
 14137     CALL 'kxdfhei1' USING DFHEIV0,
 14138           ELMSTR5-DSID,
 14139           DFHEIV20,
 14140           DFHEIV99,
 14141           ELMSTR5-KEY,
 14142           DFHEIV99,
 14143           DFHEIV11,
 14144           DFHEIV99,
 14145           DFHEIV99
 14146     SET ADDRESS OF CLAIM-MASTER TO
 14147         DFHEIV20
 14148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14149
 14150
 14151 7500-DUPLICATE-KEY.
 14152
 14153     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 14154        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 14155        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 14156        CL-CERT-STATE     NOT = CM-STATE       OR
 14157        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 14158        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 14159        CL-CERT-NO        NOT = CM-CERT-NO
 14160           GO TO 7500-CHECK-MATCH-COUNT
 14161     END-IF.
 14162
 14163     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 14164
 14165     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 14166        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 14167        GO TO 7500-END-BROWSE
 14168     ELSE
 14169        GO TO 7500-READ-CLAIM-LOOP
 14170     END-IF.
 14171
 14172 7500-CHECK-MATCH-COUNT.
 14173
 14174     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 14175        CL-CERT-NO    = CM-CERT-NO
 14176          GO TO 7500-READ-CLAIM-LOOP
 14177     END-IF.
 14178
 14179 7500-END-BROWSE.
 14180
 14181
 14182
 14183* EXEC CICS ENDBR
 14184*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 273
* EL130.cbl
 14185*    END-EXEC.
 14186     MOVE 0
 14187       TO DFHEIV11
 14188*    MOVE '&2                    $   #00012866' TO DFHEIV0
 14189     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14190     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14191     MOVE X'2020233030303132383636' TO DFHEIV0(25:11)
 14192     CALL 'kxdfhei1' USING DFHEIV0,
 14193           ELMSTR5-DSID,
 14194           DFHEIV11,
 14195           DFHEIV99
 14196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14197
 14198
 14199 7500-EXIT.
 14200     EXIT.
 14201
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 274
* EL130.cbl
 14203 7550-FALL-THRU-PARA.
 14204
 14205
 14206
 14207* EXEC CICS DUMP
 14208*         DUMPCODE ('E130')
 14209*         TASK
 14210*    END-EXEC.
 14211     MOVE 'E130' TO DFHEIV5
 14212*    MOVE '<"   T                $   #00012877' TO DFHEIV0
 14213     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 14214     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14215     MOVE X'2020233030303132383737' TO DFHEIV0(25:11)
 14216     CALL 'kxdfhei1' USING DFHEIV0,
 14217           DFHEIV5,
 14218           DFHEIV99,
 14219           DFHEIV99
 14220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14221
 14222
 14223
 14224
 14225* EXEC CICS RETURN
 14226*    END-EXEC.
 14227*    MOVE '.(                    ''   #00012883' TO DFHEIV0
 14228     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 14229     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14230     MOVE X'2020233030303132383833' TO DFHEIV0(25:11)
 14231     CALL 'kxdfhei1' USING DFHEIV0,
 14232           DFHEIV99,
 14233           DFHEIV99,
 14234           DFHEIV99,
 14235           DFHEIV99,
 14236           DFHEIV99,
 14237           DFHEIV99
 14238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14239
 14240
 14241 7600-BROWSE-CLAIM.
 14242
 14243
 14244
 14245* EXEC CICS READ
 14246*        DATASET(ELMSTR-DSID)
 14247*        SET    (ADDRESS OF CLAIM-MASTER)
 14248*        RIDFLD (ELMSTR-KEY)
 14249*        GENERIC
 14250*        EQUAL
 14251*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14252*    END-EXEC.
 14253*    MOVE '&"S  KG    E          (   #00012889' TO DFHEIV0
 14254     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14255     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14256     MOVE X'2020233030303132383839' TO DFHEIV0(25:11)
 14257     CALL 'kxdfhei1' USING DFHEIV0,
 14258           ELMSTR-DSID,
 14259           DFHEIV20,
 14260           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 275
* EL130.cbl
 14261           ELMSTR-KEY,
 14262           ELMSTR-GENERIC-LENGTH,
 14263           DFHEIV99,
 14264           DFHEIV99
 14265     SET ADDRESS OF CLAIM-MASTER TO
 14266         DFHEIV20
 14267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14268
 14269
 14270     MOVE CL-CERT-PRIME          TO CERTNOI.
 14271     MOVE CL-CERT-SFX            TO SUFXI.
 14272
 14273 7610-BROWSE-CLAIM-LOOP.
 14274
 14275     MOVE LOW-VALUES             TO BCERT1O
 14276                                    BSUFX1O
 14277                                    BCERT2O
 14278                                    BSUFX2O
 14279                                    BCERT3O
 14280                                    BSUFX3O
 14281                                    BCERT4O
 14282                                    BSUFX4O
 14283                                    BCERT5O
 14284                                    BSUFX5O.
 14285
 14286     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 14287
 14288
 14289
 14290* EXEC CICS HANDLE CONDITION
 14291*        ENDFILE  (7630-END-BROWSE)
 14292*    END-EXEC.
 14293*    MOVE '"$''                   ! I #00012917' TO DFHEIV0
 14294     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14295     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14296     MOVE X'4920233030303132393137' TO DFHEIV0(25:11)
 14297     CALL 'kxdfhei1' USING DFHEIV0
 14298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14299
 14300
 14301
 14302
 14303* EXEC CICS STARTBR
 14304*        DATASET    (ELMSTR-DSID)
 14305*        RIDFLD     (ELMSTR-KEY)
 14306*    END-EXEC.
 14307     MOVE 0
 14308       TO DFHEIV11
 14309*    MOVE '&,         G          &   #00012922' TO DFHEIV0
 14310     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14311     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14312     MOVE X'2020233030303132393232' TO DFHEIV0(25:11)
 14313     CALL 'kxdfhei1' USING DFHEIV0,
 14314           ELMSTR-DSID,
 14315           ELMSTR-KEY,
 14316           DFHEIV99,
 14317           DFHEIV11,
 14318           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 276
* EL130.cbl
 14319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14320
 14321
 14322     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 14323
 14324 7620-READ-CLAIM-LOOP.
 14325
 14326
 14327
 14328* EXEC CICS READNEXT
 14329*        DATASET   (ELMSTR-DSID)
 14330*        SET       (ADDRESS OF CLAIM-MASTER)
 14331*        RIDFLD    (ELMSTR-KEY)
 14332*    END-EXEC.
 14333     MOVE 0
 14334       TO DFHEIV11
 14335*    MOVE '&.S                   )   #00012932' TO DFHEIV0
 14336     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14337     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14338     MOVE X'2020233030303132393332' TO DFHEIV0(25:11)
 14339     CALL 'kxdfhei1' USING DFHEIV0,
 14340           ELMSTR-DSID,
 14341           DFHEIV20,
 14342           DFHEIV99,
 14343           ELMSTR-KEY,
 14344           DFHEIV99,
 14345           DFHEIV11,
 14346           DFHEIV99,
 14347           DFHEIV99
 14348     SET ADDRESS OF CLAIM-MASTER TO
 14349         DFHEIV20
 14350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14351
 14352
 14353     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 14354        CL-CARRIER     NOT = CLMCARRI       OR
 14355        CL-CLAIM-NO    NOT = CLMNOI
 14356          GO TO 7630-END-BROWSE
 14357     END-IF.
 14358
 14359     IF WS-ASSOCIATED-CERTS = 1
 14360         MOVE CL-CERT-PRIME      TO BCERT1O
 14361         MOVE CL-CERT-SFX        TO BSUFX1O
 14362     END-IF.
 14363
 14364     IF WS-ASSOCIATED-CERTS = 2
 14365         MOVE CL-CERT-PRIME      TO BCERT2O
 14366         MOVE CL-CERT-SFX        TO BSUFX2O
 14367     END-IF.
 14368
 14369     IF WS-ASSOCIATED-CERTS = 3
 14370         MOVE CL-CERT-PRIME      TO BCERT3O
 14371         MOVE CL-CERT-SFX        TO BSUFX3O
 14372     END-IF.
 14373
 14374     IF WS-ASSOCIATED-CERTS = 4
 14375         MOVE CL-CERT-PRIME      TO BCERT4O
 14376         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 277
* EL130.cbl
 14377     END-IF.
 14378
 14379     IF WS-ASSOCIATED-CERTS = 5
 14380         MOVE CL-CERT-PRIME      TO BCERT5O
 14381         MOVE CL-CERT-SFX        TO BSUFX5O
 14382     ELSE
 14383         ADD +1                  TO WS-ASSOCIATED-CERTS
 14384         GO TO 7620-READ-CLAIM-LOOP
 14385     END-IF.
 14386
 14387 7630-END-BROWSE.
 14388
 14389
 14390
 14391* EXEC CICS ENDBR
 14392*        DATASET   (ELMSTR-DSID)
 14393*    END-EXEC.
 14394     MOVE 0
 14395       TO DFHEIV11
 14396*    MOVE '&2                    $   #00012975' TO DFHEIV0
 14397     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14398     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14399     MOVE X'2020233030303132393735' TO DFHEIV0(25:11)
 14400     CALL 'kxdfhei1' USING DFHEIV0,
 14401           ELMSTR-DSID,
 14402           DFHEIV11,
 14403           DFHEIV99
 14404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14405
 14406
 14407 7640-HIGHLIGHT-CERT-DISPLAYED.
 14408
 14409     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 14410     MOVE AL-SANON               TO BCERT1A
 14411                                    BSUFX1A
 14412                                    BCERT2A
 14413                                    BSUFX2A
 14414                                    BCERT3A
 14415                                    BSUFX3A
 14416                                    BCERT4A
 14417                                    BSUFX4A
 14418                                    BCERT5A
 14419                                    BSUFX5A.
 14420
 14421     IF BCERT1O = CERTNOI AND
 14422        BSUFX1O = SUFXI
 14423            MOVE AL-SABON        TO BCERT1A
 14424                                    BSUFX1A
 14425     END-IF.
 14426
 14427     IF BCERT2O = CERTNOI AND
 14428        BSUFX2O = SUFXI
 14429            MOVE AL-SABON        TO BCERT2A
 14430                                    BSUFX2A
 14431     END-IF.
 14432
 14433     IF BCERT3O = CERTNOI AND
 14434        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 278
* EL130.cbl
 14435            MOVE AL-SABON        TO BCERT3A
 14436                                    BSUFX3A
 14437     END-IF.
 14438
 14439     IF BCERT4O = CERTNOI AND
 14440        BSUFX4O = SUFXI
 14441            MOVE AL-SABON        TO BCERT4A
 14442                                    BSUFX4A
 14443     END-IF.
 14444
 14445     IF BCERT5O = CERTNOI AND
 14446        BSUFX5O = SUFXI
 14447            MOVE AL-SABON        TO BCERT5A
 14448                                    BSUFX5A
 14449     END-IF.
 14450
 14451 7699-EXIT.
 14452     EXIT.
 14453
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 279
* EL130.cbl
 14455 7700-CHECK-SEQUENCE.
 14456
 14457
 14458
 14459* EXEC CICS HANDLE CONDITION
 14460*        ENDFILE  (7799-EXIT)
 14461*        NOTFND   (7799-EXIT)
 14462*    END-EXEC.
 14463*    MOVE '"$''I                  ! J #00013030' TO DFHEIV0
 14464     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 14465     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14466     MOVE X'4A20233030303133303330' TO DFHEIV0(25:11)
 14467     CALL 'kxdfhei1' USING DFHEIV0
 14468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14469
 14470
 14471
 14472
 14473* EXEC CICS READ
 14474*        DATASET(ELMSTR-DSID)
 14475*        SET    (ADDRESS OF CLAIM-MASTER)
 14476*        RIDFLD (ELMSTR-KEY)
 14477*        GENERIC
 14478*        EQUAL
 14479*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14480*    END-EXEC.
 14481*    MOVE '&"S  KG    E          (   #00013036' TO DFHEIV0
 14482     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14483     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14484     MOVE X'2020233030303133303336' TO DFHEIV0(25:11)
 14485     CALL 'kxdfhei1' USING DFHEIV0,
 14486           ELMSTR-DSID,
 14487           DFHEIV20,
 14488           DFHEIV99,
 14489           ELMSTR-KEY,
 14490           ELMSTR-GENERIC-LENGTH,
 14491           DFHEIV99,
 14492           DFHEIV99
 14493     SET ADDRESS OF CLAIM-MASTER TO
 14494         DFHEIV20
 14495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14496
 14497
 14498     COMPUTE WS-ASSOC-CERT-TOTAL =
 14499             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 14500
 14501     GO TO 7799-EXIT.
 14502
 14503 7710-RESEQUENCE-CLAIMS.
 14504
 14505
 14506
 14507* EXEC CICS HANDLE CONDITION
 14508*        ENDFILE  (7790-END-BROWSE)
 14509*    END-EXEC.
 14510*    MOVE '"$''                   ! K #00013053' TO DFHEIV0
 14511     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14512     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 280
* EL130.cbl
 14513     MOVE X'4B20233030303133303533' TO DFHEIV0(25:11)
 14514     CALL 'kxdfhei1' USING DFHEIV0
 14515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14516
 14517
 14518
 14519
 14520* EXEC CICS STARTBR
 14521*        DATASET    (ELMSTR-DSID)
 14522*        RIDFLD     (ELMSTR-KEY)
 14523*    END-EXEC.
 14524     MOVE 0
 14525       TO DFHEIV11
 14526*    MOVE '&,         G          &   #00013058' TO DFHEIV0
 14527     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14528     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14529     MOVE X'2020233030303133303538' TO DFHEIV0(25:11)
 14530     CALL 'kxdfhei1' USING DFHEIV0,
 14531           ELMSTR-DSID,
 14532           ELMSTR-KEY,
 14533           DFHEIV99,
 14534           DFHEIV11,
 14535           DFHEIV99
 14536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14537
 14538
 14539     ADD +1 TO WS-ASSOC-CERT-SEQU
 14540               WS-READNEXT-SWITCH.
 14541
 14542 7720-READ-CLAIM-LOOP.
 14543
 14544
 14545
 14546* EXEC CICS READNEXT
 14547*        DATASET   (ELMSTR-DSID)
 14548*        SET       (ADDRESS OF CLAIM-MASTER)
 14549*        RIDFLD    (ELMSTR-KEY)
 14550*    END-EXEC.
 14551     MOVE 0
 14552       TO DFHEIV11
 14553*    MOVE '&.S                   )   #00013069' TO DFHEIV0
 14554     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14555     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14556     MOVE X'2020233030303133303639' TO DFHEIV0(25:11)
 14557     CALL 'kxdfhei1' USING DFHEIV0,
 14558           ELMSTR-DSID,
 14559           DFHEIV20,
 14560           DFHEIV99,
 14561           ELMSTR-KEY,
 14562           DFHEIV99,
 14563           DFHEIV11,
 14564           DFHEIV99,
 14565           DFHEIV99
 14566     SET ADDRESS OF CLAIM-MASTER TO
 14567         DFHEIV20
 14568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14569
 14570
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 281
* EL130.cbl
 14571     IF WS-READNEXT-SWITCH = 1
 14572         ADD 1 TO WS-READNEXT-SWITCH
 14573         GO TO 7720-READ-CLAIM-LOOP
 14574     END-IF.
 14575
 14576 7730-END-BROWSE.
 14577
 14578
 14579
 14580* EXEC CICS ENDBR
 14581*        DATASET   (ELMSTR-DSID)
 14582*    END-EXEC.
 14583     MOVE 0
 14584       TO DFHEIV11
 14585*    MOVE '&2                    $   #00013083' TO DFHEIV0
 14586     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14587     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14588     MOVE X'2020233030303133303833' TO DFHEIV0(25:11)
 14589     CALL 'kxdfhei1' USING DFHEIV0,
 14590           ELMSTR-DSID,
 14591           DFHEIV11,
 14592           DFHEIV99
 14593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14594
 14595
 14596 7740-READ-CLAIM-UPDATE.
 14597
 14598     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 14599        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 14600        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 14601          GO TO 7799-EXIT
 14602     ELSE
 14603          MOVE ZERO              TO WS-READNEXT-SWITCH
 14604     END-IF.
 14605
 14606
 14607
 14608* EXEC CICS READ
 14609*        DATASET(ELMSTR-DSID)
 14610*        SET    (ADDRESS OF CLAIM-MASTER)
 14611*        RIDFLD (ELMSTR-KEY)
 14612*        UPDATE
 14613*    END-EXEC.
 14614*    MOVE '&"S        EU         (   #00013098' TO DFHEIV0
 14615     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14616     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14617     MOVE X'2020233030303133303938' TO DFHEIV0(25:11)
 14618     CALL 'kxdfhei1' USING DFHEIV0,
 14619           ELMSTR-DSID,
 14620           DFHEIV20,
 14621           DFHEIV99,
 14622           ELMSTR-KEY,
 14623           DFHEIV99,
 14624           DFHEIV99,
 14625           DFHEIV99
 14626     SET ADDRESS OF CLAIM-MASTER TO
 14627         DFHEIV20
 14628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 282
* EL130.cbl
 14629
 14630
 14631     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 14632     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 14633
 14634
 14635
 14636* EXEC CICS REWRITE
 14637*         DATASET     (ELMSTR-DSID)
 14638*         FROM        (CLAIM-MASTER)
 14639*    END-EXEC.
 14640     MOVE LENGTH OF
 14641      CLAIM-MASTER
 14642       TO DFHEIV11
 14643*    MOVE '&& L                  %   #00013109' TO DFHEIV0
 14644     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14645     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14646     MOVE X'2020233030303133313039' TO DFHEIV0(25:11)
 14647     CALL 'kxdfhei1' USING DFHEIV0,
 14648           ELMSTR-DSID,
 14649           CLAIM-MASTER,
 14650           DFHEIV11,
 14651           DFHEIV99
 14652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14653
 14654
 14655     GO TO 7710-RESEQUENCE-CLAIMS.
 14656
 14657 7790-END-BROWSE.
 14658
 14659
 14660
 14661* EXEC CICS ENDBR
 14662*        DATASET   (ELMSTR-DSID)
 14663*    END-EXEC.
 14664     MOVE 0
 14665       TO DFHEIV11
 14666*    MOVE '&2                    $   #00013119' TO DFHEIV0
 14667     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14668     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14669     MOVE X'2020233030303133313139' TO DFHEIV0(25:11)
 14670     CALL 'kxdfhei1' USING DFHEIV0,
 14671           ELMSTR-DSID,
 14672           DFHEIV11,
 14673           DFHEIV99
 14674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14675
 14676
 14677 7799-EXIT.
 14678     EXIT.
 14679
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 283
* EL130.cbl
 14681************************************************
 14682*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 14683************************************************
 14684
 14685 7900-READ-ACTV-UPDATE.
 14686     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14687     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14688     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14689     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14690     MOVE +0                     TO TRLR-SEQ-NO.
 14691     MOVE '1'                    TO TRLR-TYPE.
 14692     GO TO 7900-READ-TRAILER-UPDATE.
 14693
 14694 7900-READ-NINETY-UPDATE.
 14695     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14696     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14697     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14698     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14699     MOVE +90                    TO TRLR-SEQ-NO.
 14700     MOVE '6'                    TO TRLR-TYPE.
 14701
 14702 7900-READ-TRAILER-UPDATE.
 14703
 14704
 14705* EXEC CICS READ  UPDATE
 14706*        DATASET    (ELTRLR-DSID)
 14707*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 14708*        RIDFLD     (ELTRLR-KEY)
 14709*    END-EXEC.
 14710*    MOVE '&"S        EU         (   #00013150' TO DFHEIV0
 14711     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14712     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14713     MOVE X'2020233030303133313530' TO DFHEIV0(25:11)
 14714     CALL 'kxdfhei1' USING DFHEIV0,
 14715           ELTRLR-DSID,
 14716           DFHEIV20,
 14717           DFHEIV99,
 14718           ELTRLR-KEY,
 14719           DFHEIV99,
 14720           DFHEIV99,
 14721           DFHEIV99
 14722     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14723         DFHEIV20
 14724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14725
 14726
 14727 7900-EXIT.
 14728      EXIT.
 14729
 14730 7910-READ-ACTV.
 14731     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14732     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14733     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14734     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14735     MOVE +0                     TO TRLR-SEQ-NO.
 14736     MOVE '1'                    TO TRLR-TYPE.
 14737     GO TO 7910-READ-TRAILER.
 14738
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 284
* EL130.cbl
 14739 7910-READ-NINETY.
 14740     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14741     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14742     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14743     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14744     MOVE +90                    TO TRLR-SEQ-NO.
 14745     MOVE '6'                    TO TRLR-TYPE.
 14746
 14747 7910-READ-TRAILER.
 14748     MOVE 'TRLR'                 TO FILE-SWITCH.
 14749
 14750
 14751
 14752* EXEC CICS READ
 14753*        DATASET   (ELTRLR-DSID)
 14754*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14755*        RIDFLD    (ELTRLR-KEY)
 14756*    END-EXEC.
 14757*    MOVE '&"S        E          (   #00013180' TO DFHEIV0
 14758     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14759     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14760     MOVE X'2020233030303133313830' TO DFHEIV0(25:11)
 14761     CALL 'kxdfhei1' USING DFHEIV0,
 14762           ELTRLR-DSID,
 14763           DFHEIV20,
 14764           DFHEIV99,
 14765           ELTRLR-KEY,
 14766           DFHEIV99,
 14767           DFHEIV99,
 14768           DFHEIV99
 14769     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14770         DFHEIV20
 14771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14772
 14773
 14774 7910-EXIT.
 14775      EXIT.
 14776
 14777 7915-REWRITE-TRAILER.
 14778
 14779
 14780* EXEC CICS REWRITE
 14781*        DATASET   (ELTRLR-DSID)
 14782*        FROM      (ACTIVITY-TRAILERS)
 14783*    END-EXEC.
 14784     MOVE LENGTH OF
 14785      ACTIVITY-TRAILERS
 14786       TO DFHEIV11
 14787*    MOVE '&& L                  %   #00013191' TO DFHEIV0
 14788     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14789     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14790     MOVE X'2020233030303133313931' TO DFHEIV0(25:11)
 14791     CALL 'kxdfhei1' USING DFHEIV0,
 14792           ELTRLR-DSID,
 14793           ACTIVITY-TRAILERS,
 14794           DFHEIV11,
 14795           DFHEIV99
 14796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 285
* EL130.cbl
 14797
 14798
 14799 7915-EXIT.
 14800      EXIT.
 14801
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 286
* EL130.cbl
 14803********************************************
 14804*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 14805********************************************
 14806
 14807 7920-READ-CLAIM-UPDATE.
 14808
 14809
 14810
 14811* EXEC CICS READ
 14812*        UPDATE
 14813*        DATASET   (ELMSTR-DSID)
 14814*        SET       (ADDRESS OF CLAIM-MASTER)
 14815*        RIDFLD    (ELMSTR-KEY)
 14816*    END-EXEC.
 14817*    MOVE '&"S        EU         (   #00013207' TO DFHEIV0
 14818     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14819     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14820     MOVE X'2020233030303133323037' TO DFHEIV0(25:11)
 14821     CALL 'kxdfhei1' USING DFHEIV0,
 14822           ELMSTR-DSID,
 14823           DFHEIV20,
 14824           DFHEIV99,
 14825           ELMSTR-KEY,
 14826           DFHEIV99,
 14827           DFHEIV99,
 14828           DFHEIV99
 14829     SET ADDRESS OF CLAIM-MASTER TO
 14830         DFHEIV20
 14831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14832
 14833
 14834 7920-EXIT.
 14835      EXIT.
 14836
 14837 7950-READ-CLAIM.
 14838
 14839
 14840* EXEC CICS READ
 14841*        DATASET   (ELMSTR-DSID)
 14842*        SET       (ADDRESS OF CLAIM-MASTER)
 14843*        RIDFLD    (ELMSTR-KEY)
 14844*    END-EXEC.
 14845*    MOVE '&"S        E          (   #00013219' TO DFHEIV0
 14846     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14847     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14848     MOVE X'2020233030303133323139' TO DFHEIV0(25:11)
 14849     CALL 'kxdfhei1' USING DFHEIV0,
 14850           ELMSTR-DSID,
 14851           DFHEIV20,
 14852           DFHEIV99,
 14853           ELMSTR-KEY,
 14854           DFHEIV99,
 14855           DFHEIV99,
 14856           DFHEIV99
 14857     SET ADDRESS OF CLAIM-MASTER TO
 14858         DFHEIV20
 14859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14860
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 287
* EL130.cbl
 14861
 14862 7950-EXIT.
 14863      EXIT.
 14864
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 288
* EL130.cbl
 14866***************************************
 14867*  I/O REQUESTS AGAINST CONTROL FILE  *
 14868***************************************
 14869
 14870 7960-READ-CNTL-UPDATE.
 14871
 14872
 14873* EXEC CICS READ
 14874*        UPDATE
 14875*        DATASET  (ELCNTL-DSID)
 14876*        SET      (ADDRESS OF CONTROL-FILE)
 14877*        RIDFLD   (ELCNTL-KEY)
 14878*    END-EXEC.
 14879*    MOVE '&"S        EU         (   #00013235' TO DFHEIV0
 14880     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14881     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14882     MOVE X'2020233030303133323335' TO DFHEIV0(25:11)
 14883     CALL 'kxdfhei1' USING DFHEIV0,
 14884           ELCNTL-DSID,
 14885           DFHEIV20,
 14886           DFHEIV99,
 14887           ELCNTL-KEY,
 14888           DFHEIV99,
 14889           DFHEIV99,
 14890           DFHEIV99
 14891     SET ADDRESS OF CONTROL-FILE TO
 14892         DFHEIV20
 14893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14894
 14895
 14896 7960-EXIT.
 14897      EXIT.
 14898
 14899 7970-READ-CNTL.
 14900
 14901
 14902* EXEC CICS READ
 14903*        DATASET  (ELCNTL-DSID)
 14904*        SET      (ADDRESS OF CONTROL-FILE)
 14905*        RIDFLD   (ELCNTL-KEY)
 14906*    END-EXEC.
 14907*    MOVE '&"S        E          (   #00013247' TO DFHEIV0
 14908     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14909     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14910     MOVE X'2020233030303133323437' TO DFHEIV0(25:11)
 14911     CALL 'kxdfhei1' USING DFHEIV0,
 14912           ELCNTL-DSID,
 14913           DFHEIV20,
 14914           DFHEIV99,
 14915           ELCNTL-KEY,
 14916           DFHEIV99,
 14917           DFHEIV99,
 14918           DFHEIV99
 14919     SET ADDRESS OF CONTROL-FILE TO
 14920         DFHEIV20
 14921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14922
 14923
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 289
* EL130.cbl
 14924 7970-EXIT.
 14925      EXIT.
 14926
 14927 7975-READ-CNTL-GTEQ.
 14928
 14929
 14930* EXEC CICS READ
 14931*         DATASET   (ELCNTL-DSID)
 14932*         SET       (ADDRESS OF CONTROL-FILE)
 14933*         RIDFLD    (ELCNTL-KEY)
 14934*         GTEQ
 14935*     END-EXEC.
 14936*    MOVE '&"S        G          (   #00013258' TO DFHEIV0
 14937     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14938     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14939     MOVE X'2020233030303133323538' TO DFHEIV0(25:11)
 14940     CALL 'kxdfhei1' USING DFHEIV0,
 14941           ELCNTL-DSID,
 14942           DFHEIV20,
 14943           DFHEIV99,
 14944           ELCNTL-KEY,
 14945           DFHEIV99,
 14946           DFHEIV99,
 14947           DFHEIV99
 14948     SET ADDRESS OF CONTROL-FILE TO
 14949         DFHEIV20
 14950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14951
 14952
 14953 7975-EXIT.
 14954      EXIT.
 14955
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 290
* EL130.cbl
 14957**************************************************
 14958*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 14959**************************************************
 14960
 14961 7980-READ-CERT5.
 14962
 14963
 14964* EXEC CICS READ
 14965*         DATASET  (ELCERT5-DSID)
 14966*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14967*         RIDFLD   (ELCERT-KEY-5)
 14968*     END-EXEC.
 14969*    MOVE '&"S        E          (   #00013275' TO DFHEIV0
 14970     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14971     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14972     MOVE X'2020233030303133323735' TO DFHEIV0(25:11)
 14973     CALL 'kxdfhei1' USING DFHEIV0,
 14974           ELCERT5-DSID,
 14975           DFHEIV20,
 14976           DFHEIV99,
 14977           ELCERT-KEY-5,
 14978           DFHEIV99,
 14979           DFHEIV99,
 14980           DFHEIV99
 14981     SET ADDRESS OF CERTIFICATE-MASTER TO
 14982         DFHEIV20
 14983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14984
 14985
 14986 7980-EXIT.
 14987      EXIT.
 14988
 14989 7930-READ-CERT-UPDATE.
 14990
 14991
 14992* EXEC CICS READ
 14993*        DATASET  (ELCERT-DSID)
 14994*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 14995*        RIDFLD   (ELCERT-KEY)
 14996*        UPDATE
 14997*    END-EXEC.
 14998*    MOVE '&"S        EU         (   #00013286' TO DFHEIV0
 14999     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15000     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15001     MOVE X'2020233030303133323836' TO DFHEIV0(25:11)
 15002     CALL 'kxdfhei1' USING DFHEIV0,
 15003           ELCERT-DSID,
 15004           DFHEIV20,
 15005           DFHEIV99,
 15006           ELCERT-KEY,
 15007           DFHEIV99,
 15008           DFHEIV99,
 15009           DFHEIV99
 15010     SET ADDRESS OF CERTIFICATE-MASTER TO
 15011         DFHEIV20
 15012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15013
 15014
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 291
* EL130.cbl
 15015 7930-EXIT.
 15016      EXIT.
 15017
 15018 7940-READ-CERT.
 15019
 15020
 15021* EXEC CICS READ
 15022*        DATASET  (ELCERT-DSID)
 15023*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 15024*        RIDFLD   (ELCERT-KEY)
 15025*    END-EXEC.
 15026*    MOVE '&"S        E          (   #00013298' TO DFHEIV0
 15027     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15028     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15029     MOVE X'2020233030303133323938' TO DFHEIV0(25:11)
 15030     CALL 'kxdfhei1' USING DFHEIV0,
 15031           ELCERT-DSID,
 15032           DFHEIV20,
 15033           DFHEIV99,
 15034           ELCERT-KEY,
 15035           DFHEIV99,
 15036           DFHEIV99,
 15037           DFHEIV99
 15038     SET ADDRESS OF CERTIFICATE-MASTER TO
 15039         DFHEIV20
 15040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15041
 15042
 15043 7940-EXIT.
 15044      EXIT.
 15045
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 292
* EL130.cbl
 15047**************************************************
 15048*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 15049**************************************************
 15050
 15051 7991-READ-BENE.
 15052
 15053
 15054* EXEC CICS READ
 15055*         DATASET   (ELBENE-DSID)
 15056*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 15057*         RIDFLD    (ELBENE-KEY)
 15058*     END-EXEC.
 15059*    MOVE '&"S        E          (   #00013314' TO DFHEIV0
 15060     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15061     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15062     MOVE X'2020233030303133333134' TO DFHEIV0(25:11)
 15063     CALL 'kxdfhei1' USING DFHEIV0,
 15064           ELBENE-DSID,
 15065           DFHEIV20,
 15066           DFHEIV99,
 15067           ELBENE-KEY,
 15068           DFHEIV99,
 15069           DFHEIV99,
 15070           DFHEIV99
 15071     SET ADDRESS OF BENEFICIARY-MASTER TO
 15072         DFHEIV20
 15073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15074
 15075
 15076 7991-EXIT.
 15077      EXIT.
 15078
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 293
* EL130.cbl
 15080**************************************************
 15081*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 15082**************************************************
 15083
 15084 7992-READ-REIN.
 15085
 15086
 15087
 15088* EXEC CICS HANDLE CONDITION
 15089*        NOTFND   (7992-NOT-FOUND)
 15090*    END-EXEC.
 15091*    MOVE '"$I                   ! L #00013331' TO DFHEIV0
 15092     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15093     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15094     MOVE X'4C20233030303133333331' TO DFHEIV0(25:11)
 15095     CALL 'kxdfhei1' USING DFHEIV0
 15096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15097
 15098
 15099
 15100
 15101* EXEC CICS READ
 15102*        DATASET   (ERREIN-DSID)
 15103*        SET       (ADDRESS OF REINSURANCE-RECORD)
 15104*        RIDFLD    (ERREIN-KEY)
 15105*    END-EXEC.
 15106*    MOVE '&"S        E          (   #00013336' TO DFHEIV0
 15107     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15108     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15109     MOVE X'2020233030303133333336' TO DFHEIV0(25:11)
 15110     CALL 'kxdfhei1' USING DFHEIV0,
 15111           ERREIN-DSID,
 15112           DFHEIV20,
 15113           DFHEIV99,
 15114           ERREIN-KEY,
 15115           DFHEIV99,
 15116           DFHEIV99,
 15117           DFHEIV99
 15118     SET ADDRESS OF REINSURANCE-RECORD TO
 15119         DFHEIV20
 15120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15121
 15122
 15123     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 15124
 15125     GO TO 7992-EXIT.
 15126
 15127 7992-NOT-FOUND.
 15128     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 15129
 15130 7992-EXIT.
 15131     EXIT.
 15132
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 294
* EL130.cbl
 15134 8000-LOAD-ERROR-MESSAGES.
 15135     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 15136
 15137     IF EMI-NO-ERRORS
 15138         GO TO 8000-EXIT
 15139     END-IF.
 15140
 15141     IF EMI-NUMBER-OF-LINES = 1
 15142         MOVE EMI-LINE1          TO ERRMSG1O
 15143         GO TO 8000-EXIT
 15144     END-IF.
 15145
 15146     IF EMI-NUMBER-OF-LINES = 2
 15147          MOVE EMI-LINE1         TO ERRMSG1O
 15148          MOVE EMI-LINE2         TO ERRMSG2O
 15149          GO TO 8000-EXIT
 15150     END-IF.
 15151
 15152     MOVE EMI-LINE1              TO ERRMSG1O.
 15153
 15154 8000-EXIT.
 15155     EXIT.
 15156
 15157 8100-SEND-INITIAL-MAP.
 15158     MOVE SAVE-DATE              TO RUNDTEO.
 15159     MOVE EIBTIME                TO TIME-IN.
 15160     MOVE TIME-OUT               TO RUNTIMEO.
 15161     IF RETURNED-FROM = XCTL-114
 15162        CONTINUE
 15163     ELSE
 15164        MOVE -1                  TO MAINTL
 15165     END-IF.
 15166
 15167*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 15168         MOVE SPACES             TO PRODO.
 15169         MOVE AL-SANOF           TO PRODCDA.
 15170*    END-IF.
 15171
 15172     MOVE PI-COMPANY-ID          TO COMPO.
 15173     MOVE AL-PABOF               TO COMPA.
 15174     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 15175     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15176     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15177
 15178     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 15179
 15180     IF NOT PI-NO-CARRIER-SECURITY
 15181        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 15182        MOVE AL-SABOF            TO CLMCARRA
 15183     END-IF.
 15184
 15185     IF PI-PROCESSOR-ID = 'PEMA'
 15186        MOVE AL-UANON            TO CERTNOA
 15187                                    SUFXA
 15188     END-IF.
 15189*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15190*        NEXT SENTENCE
 15191*        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 295
* EL130.cbl
 15192*    ELSE
 15193         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 15194*    END-IF.
 15195
 15196
 15197
 15198* EXEC CICS SEND
 15199*        MAP     (MAP-NAME)
 15200*        MAPSET  (MAPSET-NAME)
 15201*        FROM    (EL130AO)
 15202*        ERASE
 15203*        CURSOR
 15204*    END-EXEC.
 15205     MOVE LENGTH OF
 15206      EL130AO
 15207       TO DFHEIV12
 15208     MOVE -1
 15209       TO DFHEIV11
 15210*    MOVE '8$     CT  E    H L F ,   #00013416' TO DFHEIV0
 15211     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15212     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15213     MOVE X'2020233030303133343136' TO DFHEIV0(25:11)
 15214     CALL 'kxdfhei1' USING DFHEIV0,
 15215           MAP-NAME,
 15216           EL130AO,
 15217           DFHEIV12,
 15218           MAPSET-NAME,
 15219           DFHEIV99,
 15220           DFHEIV99,
 15221           DFHEIV99,
 15222           DFHEIV11,
 15223           DFHEIV99,
 15224           DFHEIV99,
 15225           DFHEIV99
 15226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15227
 15228
 15229     GO TO 9100-RETURN-TRAN.
 15230
 15231 8150-SEND-MAP-CURSOR.
 15232     MOVE SAVE-DATE              TO RUNDTEO.
 15233     MOVE EIBTIME                TO TIME-IN.
 15234     MOVE TIME-OUT               TO RUNTIMEO.
 15235     MOVE PI-COMPANY-ID          TO COMPO.
 15236     MOVE AL-PABOF               TO COMPA
 15237     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 15238     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15239     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15240
 15241*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 15242         MOVE SPACES             TO PRODO.
 15243         MOVE AL-SANOF           TO PRODCDA.
 15244*    END-IF.
 15245
 15246     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 15247
 15248     IF NOT PI-NO-CARRIER-SECURITY
 15249         MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 296
* EL130.cbl
 15250         MOVE AL-SABOF            TO CLMCARRA
 15251     END-IF.
 15252
 15253     IF PI-PROCESSOR-ID = 'PEMA'
 15254        MOVE AL-UANON            TO CERTNOA
 15255                                    SUFXA
 15256     END-IF.
 15257*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15258*        NEXT SENTENCE
 15259*        CONTINUE
 15260*    ELSE
 15261         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 15262*    END-IF.
 15263
 15264
 15265
 15266* EXEC CICS SEND
 15267*        MAP      (MAP-NAME)
 15268*        MAPSET   (MAPSET-NAME)
 15269*        FROM     (EL130AO)
 15270*        CURSOR   (PI-CURSOR)
 15271*        ERASE
 15272*    END-EXEC.
 15273     MOVE LENGTH OF
 15274      EL130AO
 15275       TO DFHEIV11
 15276*    MOVE '8$     CT  E    H L F ,   #00013460' TO DFHEIV0
 15277     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15278     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15279     MOVE X'2020233030303133343630' TO DFHEIV0(25:11)
 15280     CALL 'kxdfhei1' USING DFHEIV0,
 15281           MAP-NAME,
 15282           EL130AO,
 15283           DFHEIV11,
 15284           MAPSET-NAME,
 15285           DFHEIV99,
 15286           DFHEIV99,
 15287           DFHEIV99,
 15288           PI-CURSOR,
 15289           DFHEIV99,
 15290           DFHEIV99,
 15291           DFHEIV99
 15292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15293
 15294
 15295     GO TO 9100-RETURN-TRAN.
 15296
 15297 8200-SEND-DATAONLY.
 15298     IF EIBAID = DFHPF11
 15299        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 15300        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15301     END-IF.
 15302
 15303     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 15304
 15305 8200-BYPASS-ERROR.
 15306     MOVE SAVE-DATE              TO RUNDTEO.
 15307     MOVE EIBTIME                TO TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 297
* EL130.cbl
 15308     MOVE TIME-OUT               TO RUNTIMEO.
 15309     MOVE PI-COMPANY-ID          TO COMPO.
 15310     MOVE AL-PABOF               TO COMPA
 15311     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 15312
 15313*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 15314         MOVE SPACES             TO PRODO.
 15315         MOVE AL-SANOF           TO PRODCDA.
 15316*    END-IF.
 15317
 15318     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15319     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15320
 15321     IF PI-PROCESSOR-ID = 'PEMA'
 15322        MOVE AL-UANON            TO CERTNOA
 15323                                    SUFXA
 15324     END-IF.
 15325     IF NOT PI-NO-CARRIER-SECURITY
 15326        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 15327        MOVE AL-SABOF            TO CLMCARRA
 15328     END-IF.
 15329
 15330*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15331*        NEXT SENTENCE
 15332*        CONTINUE
 15333*    ELSE
 15334         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 15335*    END-IF.
 15336
 15337*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 15338         MOVE AL-SANOF           TO PRODCDA.
 15339*    END-IF.
 15340
 15341
 15342
 15343* EXEC CICS SEND
 15344*        MAP      (MAP-NAME)
 15345*        MAPSET   (MAPSET-NAME)
 15346*        FROM     (EL130AO)
 15347*        DATAONLY
 15348*        CURSOR
 15349*    END-EXEC.
 15350     MOVE LENGTH OF
 15351      EL130AO
 15352       TO DFHEIV12
 15353     MOVE -1
 15354       TO DFHEIV11
 15355*    MOVE '8$D    CT       H L F ,   #00013515' TO DFHEIV0
 15356     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 15357     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15358     MOVE X'2020233030303133353135' TO DFHEIV0(25:11)
 15359     CALL 'kxdfhei1' USING DFHEIV0,
 15360           MAP-NAME,
 15361           EL130AO,
 15362           DFHEIV12,
 15363           MAPSET-NAME,
 15364           DFHEIV99,
 15365           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 298
* EL130.cbl
 15366           DFHEIV99,
 15367           DFHEIV11,
 15368           DFHEIV99,
 15369           DFHEIV99,
 15370           DFHEIV99
 15371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15372
 15373
 15374     GO TO 9100-RETURN-TRAN.
 15375
 15376 8300-SEND-TEXT.
 15377
 15378
 15379* EXEC CICS SEND TEXT
 15380*        FROM     (LOGOFF-TEXT)
 15381*        LENGTH   (LOGOFF-LENGTH)
 15382*        ERASE
 15383*        FREEKB
 15384*    END-EXEC.
 15385*    MOVE '8&      T  E F  H   F -   #00013527' TO DFHEIV0
 15386     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 15387     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 15388     MOVE X'2020233030303133353237' TO DFHEIV0(25:11)
 15389     CALL 'kxdfhei1' USING DFHEIV0,
 15390           LOGOFF-TEXT,
 15391           LOGOFF-LENGTH,
 15392           DFHEIV99,
 15393           DFHEIV99,
 15394           DFHEIV99,
 15395           DFHEIV99,
 15396           DFHEIV99,
 15397           DFHEIV99,
 15398           DFHEIV99,
 15399           DFHEIV99,
 15400           DFHEIV99,
 15401           DFHEIV99
 15402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15403
 15404
 15405
 15406
 15407* EXEC CICS RETURN
 15408*    END-EXEC.
 15409*    MOVE '.(                    ''   #00013535' TO DFHEIV0
 15410     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15411     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15412     MOVE X'2020233030303133353335' TO DFHEIV0(25:11)
 15413     CALL 'kxdfhei1' USING DFHEIV0,
 15414           DFHEIV99,
 15415           DFHEIV99,
 15416           DFHEIV99,
 15417           DFHEIV99,
 15418           DFHEIV99,
 15419           DFHEIV99
 15420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15421
 15422
 15423 8800-UNAUTHORIZED-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 299
* EL130.cbl
 15424     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 15425     GO TO 8300-SEND-TEXT.
 15426
 15427 8810-PF23.
 15428     MOVE EIBAID TO PI-ENTRY-CD-1.
 15429     MOVE XCTL-005               TO PGM-NAME.
 15430     GO TO 9300-XCTL.
 15431
 15432 8820-TERM-ERROR.
 15433     MOVE ER-0412                TO EMI-ERROR.
 15434     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15435     MOVE -1                     TO MAINTL.
 15436     GO TO 8200-SEND-DATAONLY.
 15437
 15438 8830-TRAN-ERROR.
 15439     MOVE ER-0413                TO EMI-ERROR.
 15440     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15441     MOVE -1                     TO MAINTL.
 15442     GO TO 8200-SEND-DATAONLY.
 15443
 15444 9000-RETURN-CICS.
 15445
 15446
 15447* EXEC CICS RETURN
 15448*    END-EXEC.
 15449*    MOVE '.(                    ''   #00013561' TO DFHEIV0
 15450     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15451     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15452     MOVE X'2020233030303133353631' TO DFHEIV0(25:11)
 15453     CALL 'kxdfhei1' USING DFHEIV0,
 15454           DFHEIV99,
 15455           DFHEIV99,
 15456           DFHEIV99,
 15457           DFHEIV99,
 15458           DFHEIV99,
 15459           DFHEIV99
 15460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15461
 15462
 15463 9100-RETURN-TRAN.
 15464     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 15465     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 15466
 15467
 15468
 15469* EXEC CICS RETURN
 15470*        TRANSID   (TRANS-ID)
 15471*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 15472*        LENGTH    (PI-COMM-LENGTH)
 15473*    END-EXEC.
 15474*    MOVE '.(CT                  ''   #00013569' TO DFHEIV0
 15475     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 15476     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15477     MOVE X'2020233030303133353639' TO DFHEIV0(25:11)
 15478     CALL 'kxdfhei1' USING DFHEIV0,
 15479           TRANS-ID,
 15480           PROGRAM-INTERFACE-BLOCK,
 15481           PI-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 300
* EL130.cbl
 15482           DFHEIV99,
 15483           DFHEIV99,
 15484           DFHEIV99
 15485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15486
 15487
 15488 9200-RETURN-MAIN-MENU.
 15489     MOVE XCTL-126               TO PGM-NAME.
 15490     GO TO 9300-XCTL.
 15491
 15492 9300-XCTL.
 15493
 15494
 15495* EXEC CICS XCTL
 15496*        PROGRAM   (PGM-NAME)
 15497*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 15498*        LENGTH    (PI-COMM-LENGTH)
 15499*    END-EXEC.
 15500*    MOVE '.$C                   %   #00013581' TO DFHEIV0
 15501     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 15502     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15503     MOVE X'2020233030303133353831' TO DFHEIV0(25:11)
 15504     CALL 'kxdfhei1' USING DFHEIV0,
 15505           PGM-NAME,
 15506           PROGRAM-INTERFACE-BLOCK,
 15507           PI-COMM-LENGTH,
 15508           DFHEIV99
 15509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15510
 15511
 15512 9400-CLEAR.
 15513     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 15514     GO TO 9300-XCTL.
 15515
 15516 9500-PF12.
 15517     MOVE XCTL-010               TO PGM-NAME.
 15518     GO TO 9300-XCTL.
 15519
 15520 9600-PGMID-ERROR.
 15521
 15522
 15523* EXEC CICS HANDLE CONDITION
 15524*        PGMIDERR  (8300-SEND-TEXT)
 15525*    END-EXEC.
 15526*    MOVE '"$L                   ! M #00013597' TO DFHEIV0
 15527     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 15528     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15529     MOVE X'4D20233030303133353937' TO DFHEIV0(25:11)
 15530     CALL 'kxdfhei1' USING DFHEIV0
 15531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15532
 15533
 15534     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 15535     MOVE ' '                    TO PI-ENTRY-CD-1.
 15536     MOVE XCTL-005               TO PGM-NAME.
 15537     MOVE PGM-NAME               TO LOGOFF-PGM.
 15538     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 15539     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 301
* EL130.cbl
 15540
 15541 9700-LINK-DATE-CONVERT.
 15542     MOVE LINK-ELDATCV           TO PGM-NAME.
 15543
 15544
 15545* EXEC CICS LINK
 15546*        PROGRAM    (PGM-NAME)
 15547*        COMMAREA   (DATE-CONVERSION-DATA)
 15548*        LENGTH     (DC-COMM-LENGTH)
 15549*    END-EXEC.
 15550*    MOVE '."C                   (   #00013611' TO DFHEIV0
 15551     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15552     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15553     MOVE X'2020233030303133363131' TO DFHEIV0(25:11)
 15554     CALL 'kxdfhei1' USING DFHEIV0,
 15555           PGM-NAME,
 15556           DATE-CONVERSION-DATA,
 15557           DC-COMM-LENGTH,
 15558           DFHEIV99,
 15559           DFHEIV99,
 15560           DFHEIV99,
 15561           DFHEIV99
 15562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15563
 15564
 15565 9700-EXIT.
 15566     EXIT.
 15567
 15568 9800-LINK-REM-TERM.
 15569     MOVE LINK-ELRTRM            TO PGM-NAME.
 15570
 15571
 15572* EXEC CICS LINK
 15573*        PROGRAM    (PGM-NAME)
 15574*        COMMAREA   (CALCULATION-PASS-AREA)
 15575*        LENGTH     (CP-COMM-LENGTH)
 15576*    END-EXEC.
 15577*    MOVE '."C                   (   #00013623' TO DFHEIV0
 15578     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15579     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15580     MOVE X'2020233030303133363233' TO DFHEIV0(25:11)
 15581     CALL 'kxdfhei1' USING DFHEIV0,
 15582           PGM-NAME,
 15583           CALCULATION-PASS-AREA,
 15584           CP-COMM-LENGTH,
 15585           DFHEIV99,
 15586           DFHEIV99,
 15587           DFHEIV99,
 15588           DFHEIV99
 15589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15590
 15591
 15592 9800-EXIT.
 15593     EXIT.
 15594
 15595 9900-ERROR-FORMAT.
 15596     IF NOT EMI-ERRORS-COMPLETE
 15597         MOVE LINK-001           TO PGM-NAME
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 302
* EL130.cbl
 15598
 15599* EXEC CICS LINK
 15600*            PROGRAM   (PGM-NAME)
 15601*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 15602*            LENGTH    (EMI-COMM-LENGTH)
 15603*        END-EXEC
 15604*    MOVE '."C                   (   #00013635' TO DFHEIV0
 15605     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15606     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15607     MOVE X'2020233030303133363335' TO DFHEIV0(25:11)
 15608     CALL 'kxdfhei1' USING DFHEIV0,
 15609           PGM-NAME,
 15610           ERROR-MESSAGE-INTERFACE-BLOCK,
 15611           EMI-COMM-LENGTH,
 15612           DFHEIV99,
 15613           DFHEIV99,
 15614           DFHEIV99,
 15615           DFHEIV99
 15616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15617     END-IF.
 15618
 15619 9900-EXIT.
 15620     EXIT.
 15621
 15622 9990-ABEND.
 15623     MOVE -1                     TO MAINTL.
 15624     MOVE LINK-004               TO PGM-NAME.
 15625     MOVE DFHEIBLK               TO EMI-LINE1.
 15626
 15627
 15628* EXEC CICS LINK
 15629*        PROGRAM   (PGM-NAME)
 15630*        COMMAREA  (EMI-LINE1)
 15631*        LENGTH    (72)
 15632*    END-EXEC.
 15633     MOVE 72
 15634       TO DFHEIV11
 15635*    MOVE '."C                   (   #00013650' TO DFHEIV0
 15636     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15637     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15638     MOVE X'2020233030303133363530' TO DFHEIV0(25:11)
 15639     CALL 'kxdfhei1' USING DFHEIV0,
 15640           PGM-NAME,
 15641           EMI-LINE1,
 15642           DFHEIV11,
 15643           DFHEIV99,
 15644           DFHEIV99,
 15645           DFHEIV99,
 15646           DFHEIV99
 15647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15648
 15649
 15650     MOVE EMI-LINE1              TO ERRMSG2O.
 15651
 15652     GO TO 8200-BYPASS-ERROR.
 15653
 15654
 15655
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 303
* EL130.cbl
 15656* GOBACK.
 15657     MOVE '9%                    "   ' TO DFHEIV0
 15658     MOVE 'EL130' TO DFHEIV1
 15659     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15660     GOBACK.
 15661
 15662 9995-SECURITY-VIOLATION.
 15663*             COPY ELCSCTP.
 15664******************************************************************
 15665*                                                                *
 15666*                            ELCSCTP                             *
 15667*                            VMOD=2.001                          *
 15668*                                                                *
 15669*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 15670******************************************************************
 15671
 15672
 15673     MOVE EIBDATE          TO SM-JUL-DATE.
 15674     MOVE EIBTRMID         TO SM-TERMID.
 15675     MOVE THIS-PGM         TO SM-PGM.
 15676     MOVE EIBTIME          TO TIME-IN.
 15677     MOVE TIME-OUT         TO SM-TIME.
 15678     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 15679
 15680
 15681* EXEC CICS LINK
 15682*         PROGRAM  ('EL003')
 15683*         COMMAREA (SECURITY-MESSAGE)
 15684*         LENGTH   (80)
 15685*    END-EXEC.
 15686     MOVE 'EL003' TO DFHEIV1
 15687     MOVE 80
 15688       TO DFHEIV11
 15689*    MOVE '."C                   (   #00013681' TO DFHEIV0
 15690     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15691     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15692     MOVE X'2020233030303133363831' TO DFHEIV0(25:11)
 15693     CALL 'kxdfhei1' USING DFHEIV0,
 15694           DFHEIV1,
 15695           SECURITY-MESSAGE,
 15696           DFHEIV11,
 15697           DFHEIV99,
 15698           DFHEIV99,
 15699           DFHEIV99,
 15700           DFHEIV99
 15701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15702
 15703
 15704******************************************************************
 15705
 15706
 15707 9995-EXIT.
 15708     EXIT.
 15709
 15710
 15711 9999-DFHBACK SECTION.
 15712     MOVE '9%                    "   ' TO DFHEIV0
 15713     MOVE 'EL130' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 304
* EL130.cbl
 15714     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15715     GOBACK.
 15716 9999-DFHEXIT.
 15717     IF DFHEIGDJ EQUAL 0001
 15718         NEXT SENTENCE
 15719     ELSE IF DFHEIGDJ EQUAL 2
 15720         GO TO 0100-TEST-ENTRY,
 15721               8100-SEND-INITIAL-MAP,
 15722               9600-PGMID-ERROR,
 15723               8820-TERM-ERROR,
 15724               8830-TRAN-ERROR,
 15725               9990-ABEND
 15726         DEPENDING ON DFHEIGDI
 15727     ELSE IF DFHEIGDJ EQUAL 3
 15728         GO TO 0450-ADD-ELACTQ-RECORD
 15729         DEPENDING ON DFHEIGDI
 15730     ELSE IF DFHEIGDJ EQUAL 4
 15731         GO TO 8820-TERM-ERROR,
 15732               8830-TRAN-ERROR
 15733         DEPENDING ON DFHEIGDI
 15734     ELSE IF DFHEIGDJ EQUAL 5
 15735         GO TO 0660-NOT-FOUND,
 15736               0670-QIDERR
 15737         DEPENDING ON DFHEIGDI
 15738     ELSE IF DFHEIGDJ EQUAL 6
 15739         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15740         DEPENDING ON DFHEIGDI
 15741     ELSE IF DFHEIGDJ EQUAL 7
 15742         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15743         DEPENDING ON DFHEIGDI
 15744     ELSE IF DFHEIGDJ EQUAL 8
 15745         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15746         DEPENDING ON DFHEIGDI
 15747     ELSE IF DFHEIGDJ EQUAL 9
 15748         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15749         DEPENDING ON DFHEIGDI
 15750     ELSE IF DFHEIGDJ EQUAL 10
 15751         GO TO 2050-DELETE-NOT-FOUND
 15752         DEPENDING ON DFHEIGDI
 15753     ELSE IF DFHEIGDJ EQUAL 11
 15754         GO TO 2010-DELETE-CL
 15755         DEPENDING ON DFHEIGDI
 15756     ELSE IF DFHEIGDJ EQUAL 12
 15757         GO TO 3010-TEST-FOR-ERRORS
 15758         DEPENDING ON DFHEIGDI
 15759     ELSE IF DFHEIGDJ EQUAL 13
 15760         GO TO 3008-DUP-ERROR,
 15761               3009-NOT-FOUND
 15762         DEPENDING ON DFHEIGDI
 15763     ELSE IF DFHEIGDJ EQUAL 14
 15764         GO TO 3030-BUILD-CONT
 15765         DEPENDING ON DFHEIGDI
 15766     ELSE IF DFHEIGDJ EQUAL 15
 15767         GO TO 3033-ACCT-NOT-FOUND,
 15768               3033-ACCT-NOT-FOUND
 15769         DEPENDING ON DFHEIGDI
 15770     ELSE IF DFHEIGDJ EQUAL 16
 15771         GO TO 3032-NOT-IN-DT-RANGE
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 305
* EL130.cbl
 15772         DEPENDING ON DFHEIGDI
 15773     ELSE IF DFHEIGDJ EQUAL 17
 15774         GO TO 3070-BUILD-CONT
 15775         DEPENDING ON DFHEIGDI
 15776     ELSE IF DFHEIGDJ EQUAL 18
 15777         GO TO 3065-CERT-NOT-FOUND
 15778         DEPENDING ON DFHEIGDI
 15779     ELSE IF DFHEIGDJ EQUAL 19
 15780         GO TO 3100-CARRIER-NOT-FOUND
 15781         DEPENDING ON DFHEIGDI
 15782     ELSE IF DFHEIGDJ EQUAL 20
 15783         GO TO 3110-COMPANY-NOT-FOUND
 15784         DEPENDING ON DFHEIGDI
 15785     ELSE IF DFHEIGDJ EQUAL 21
 15786         GO TO 3200-BUILD-ZERO-TRAILER
 15787         DEPENDING ON DFHEIGDI
 15788     ELSE IF DFHEIGDJ EQUAL 22
 15789         GO TO 9999-DFHBACK
 15790         DEPENDING ON DFHEIGDI
 15791     ELSE IF DFHEIGDJ EQUAL 23
 15792         GO TO 3290-NO-INSURED-ADDRESS
 15793         DEPENDING ON DFHEIGDI
 15794     ELSE IF DFHEIGDJ EQUAL 24
 15795         GO TO 3410-DUP-KEY
 15796         DEPENDING ON DFHEIGDI
 15797     ELSE IF DFHEIGDJ EQUAL 25
 15798         GO TO 3690-CERT-WRITTEN
 15799         DEPENDING ON DFHEIGDI
 15800     ELSE IF DFHEIGDJ EQUAL 26
 15801         GO TO 3850-CLAIM-MSTR-WRITTEN
 15802         DEPENDING ON DFHEIGDI
 15803     ELSE IF DFHEIGDJ EQUAL 27
 15804         GO TO 5050-CERT-NOT-FOUND
 15805         DEPENDING ON DFHEIGDI
 15806     ELSE IF DFHEIGDJ EQUAL 28
 15807         GO TO 5030-CERT-WRITTEN
 15808         DEPENDING ON DFHEIGDI
 15809     ELSE IF DFHEIGDJ EQUAL 29
 15810         GO TO 5035-CLAIM-WRITTEN
 15811         DEPENDING ON DFHEIGDI
 15812     ELSE IF DFHEIGDJ EQUAL 30
 15813         GO TO 9990-ABEND,
 15814               5799-EXIT
 15815         DEPENDING ON DFHEIGDI
 15816     ELSE IF DFHEIGDJ EQUAL 31
 15817         GO TO 3100-CARRIER-NOT-FOUND
 15818         DEPENDING ON DFHEIGDI
 15819     ELSE IF DFHEIGDJ EQUAL 32
 15820         GO TO 6040-NO-PROCESSOR-RECORD
 15821         DEPENDING ON DFHEIGDI
 15822     ELSE IF DFHEIGDJ EQUAL 33
 15823         GO TO 6060-NO-BENEFICIARY-RECORD
 15824         DEPENDING ON DFHEIGDI
 15825     ELSE IF DFHEIGDJ EQUAL 34
 15826         GO TO 6499-EXIT,
 15827               6499-EXIT
 15828         DEPENDING ON DFHEIGDI
 15829     ELSE IF DFHEIGDJ EQUAL 35
* Micro Focus Server Express         V5.1 revision 000 13-Feb-13 13:21 Page 306
* EL130.cbl
 15830         GO TO 6600-NOT-FOUND
 15831         DEPENDING ON DFHEIGDI
 15832     ELSE IF DFHEIGDJ EQUAL 36
 15833         GO TO 6700-NOTOPEN-ERROR,
 15834               6700-EXIT
 15835         DEPENDING ON DFHEIGDI
 15836     ELSE IF DFHEIGDJ EQUAL 37
 15837         GO TO 7120-NOT-FOUND
 15838         DEPENDING ON DFHEIGDI
 15839     ELSE IF DFHEIGDJ EQUAL 38
 15840         GO TO 7499-EXIT
 15841         DEPENDING ON DFHEIGDI
 15842     ELSE IF DFHEIGDJ EQUAL 39
 15843         GO TO 7500-EXIT,
 15844               7500-DUPLICATE-KEY,
 15845               7500-EXIT
 15846         DEPENDING ON DFHEIGDI
 15847     ELSE IF DFHEIGDJ EQUAL 40
 15848         GO TO 7500-END-BROWSE
 15849         DEPENDING ON DFHEIGDI
 15850     ELSE IF DFHEIGDJ EQUAL 41
 15851         GO TO 7630-END-BROWSE
 15852         DEPENDING ON DFHEIGDI
 15853     ELSE IF DFHEIGDJ EQUAL 42
 15854         GO TO 7799-EXIT,
 15855               7799-EXIT
 15856         DEPENDING ON DFHEIGDI
 15857     ELSE IF DFHEIGDJ EQUAL 43
 15858         GO TO 7790-END-BROWSE
 15859         DEPENDING ON DFHEIGDI
 15860     ELSE IF DFHEIGDJ EQUAL 44
 15861         GO TO 7992-NOT-FOUND
 15862         DEPENDING ON DFHEIGDI
 15863     ELSE IF DFHEIGDJ EQUAL 45
 15864         GO TO 8300-SEND-TEXT
 15865         DEPENDING ON DFHEIGDI.
 15866     MOVE '9%                    "   ' TO DFHEIV0
 15867     MOVE 'EL130' TO DFHEIV1
 15868     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15869     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       10552     Code:       48905
