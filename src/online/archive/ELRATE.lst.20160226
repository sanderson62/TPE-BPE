* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page   1
* ELRATE.cbl
* Options: int("ELRATE.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELRATE.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRATE.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRATE.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRATE.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:20:51.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.012
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page   2
* ELRATE.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25******************************************************************
    26*  REMARKS   *                                                   *
    27*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    28*            *    OPTION SPECIFIED, COMPUTE PREMIUM AMOUNTS      *
    29*            *    AND RATES.                                     *
    30******************************************************************
    31
    32
    33******************************************************************
    34*                                                                *
    35*              INPUT FIELDS USED                                 *
    36*                                                                *
    37******************************************************************
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM    (RATING TERM)          *
    39*  CLASS CODE       - CP-CLASS-CODE                              *
    40*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    41*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    42*  RATING BENEFIT   - CP-RATING-BENEFIT-AMT (TOT BEN ON BALLOON) *
    43*  BENEFIT TYPE     - CP-BENEFIT-TYPE                            *
    44*  STATE CODE (NUM) - CP-STATE                                   *
    45*  STATE CODE       - CP-STATE-STD-ABBV                          *
    46*  COMPANY I.D.     - CP-COMPANY-ID                              *
    47*  COMPANY CD (NUM) - CP-COMPANY-CD                              *
    48*  INSURED AGE      - CP-ISSUE-AGE                               *
    49*  RATING METHOD    - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  A.P.R.           - CP-LOAN-APR                                *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    54*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page   3
* ELRATE.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRATE  WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '***********VMOD 2.012 **********'.
    65
    66***  Y2K PROJ 7744
    67 01  WS-HOLD-RATE-EXP.
    68     05  WS-HOLD-RATE-EXP-AL PIC X(11).
    69     05  WS-HOLD-RATE-EXP-DT REDEFINES
    70         WS-HOLD-RATE-EXP-AL PIC 9(11).
    71***  Y2K PROJ 7744
    72
    73*                            COPY ELCRATWS.
    74******************************************************************
    75*                                                                *
    76*                                                                *
    77*                            ELCRATWS.                           *
    78*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    79*                            VMOD=2.010                          *
    80*                                                                *
    81******************************************************************
    82
    83 01  STANDARD-AREAS.
    84     12  ER-STATUS               PIC XX.
    85     12  WS-BROWSE-SW            PIC X       VALUE SPACE.
    86         88 WS-BROWSE-STARTED                VALUE 'Y'.
    87     12  WS-PREMIUM-RATE         PIC S99V9(5) COMP-3 VALUE ZERO.
    88     12  WS-FARM-TERM            PIC S9(3)    COMP-3 VALUE ZERO.
    89     12  OERATE-FILE-ID          PIC X(8)    VALUE 'OERATE'.
    90     12  ERRATE-FILE-ID          PIC X(8)    VALUE 'ERRATE'.
    91     12  ERRATE-KEY.
    92         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.
    93         16  RATE-STATE-CODE.
    94             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.
    95             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.
    96             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.
    97         16  RATE-L-AH-CODE.
    98             20  RATE-L-AH       PIC  X       VALUE SPACE.
    99             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.
   100         16  RATE-LIMITS.
   101             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.
   102             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   103             20  RATE-FUTURE     PIC  XX      VALUE SPACES.
   104             20  RATE-SEX        PIC  X       VALUE '9'.
   105         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.
   106
   107     12  SAVE-ERRATE-KEY.
   108         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.
   109         16  SVRT-STATE-CODE.
   110             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.
   111             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.
   112             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.
   113         16  SVRT-L-AH-CODE.
   114             20  SVRT-L-AH       PIC  X       VALUE SPACE.
   115             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.
   116         16  SVRT-LIMITS.
   117             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page   4
* ELRATE.cbl
   118             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   119             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.
   120             20  SVRT-SEX        PIC  X       VALUE '9'.
   121         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.
   122
   123     12  WS-SIN-PREM-RATE        PIC S99V9(07) VALUE +0.
   124     12  WS-TERM-MINUS-ONE       PIC S9(5)    COMP-3 VALUE +0.
   125
   126 01  CSL-WORK-AREAS          COMP-3.
   127     12  WK-C                PIC S9(3)V9(9)     VALUE ZEROS.
   128     12  WK-D                PIC S9(4)V9(9)     VALUE ZEROS.
   129     12  WK-J                PIC S999           VALUE ZEROS.
   130     12  WK-K                PIC S999           VALUE ZEROS.
   131     12  WK-L                PIC S99V9(9)       VALUE ZEROS.
   132     12  WK-S                PIC S999V9(4)      VALUE ZEROS.
   133     12  WK-T                PIC S999           VALUE ZEROS.
   134     12  WK-T1               PIC S999           VALUE ZEROS.
   135     12  WK-U                PIC S99V9(9)       VALUE ZEROS.
   136     12  WK-PREM             PIC S9(6)V999      VALUE ZEROS.
   137     12  WK-PAY-AMT          PIC S9(7)V99       VALUE ZEROS.
   138     12  WK-LEV-RATE         PIC S99V9(7)       VALUE ZEROS.
   139     12  WK-RED-RATE         PIC S99V9(7)       VALUE ZEROS.
   140     12  WK-DAILY-RATE       PIC S99V9(7)       VALUE ZEROS.
   141     12  WK-MONTHLY-RATE     PIC S99V9(7)       VALUE ZEROS.
   142     12  WK-MONTHLY-RATE-T   PIC S99V9(7)       VALUE ZEROS.
   143     12  WK-MONTHLY-RATE-J   PIC S99V9(7)       VALUE ZEROS.
   144     12  WS-MAX-TOT-BEN      PIC S9(7)V99       VALUE ZEROS.
   145     12  WS-MAX-MON-BEN      PIC S9(7)V99       VALUE ZEROS.
   146     12  WS-NUM-PAYMTS       PIC S9(5)          VALUE ZEROS.
   147     12  WS-PAY-SCH          PIC S99            VALUE ZEROS.
   148
   149 01  TEXAS-REG-WORK-AREAS.
   150     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.
   151     12  TEX-FACT-2          PIC S9(3)       COMP-3.
   152     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   153     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   154     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   155     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   156     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   157     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   158     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   159
   160 01  NET-PAY-INTERFACE.
   161     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   162     12  N-P-ORIG            PIC S9(3)       COMP-3.
   163     12  N-P-REM             PIC S9(3)       COMP-3.
   164     12  N-P-OPT             PIC X.
   165     12  N-P-LOAN            PIC S9(3)       COMP-3.
   166     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   167
   168
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page   5
* ELRATE.cbl
   170*                            COPY ERCNETWS.
   171*****************************************************************
   172*                                                               *
   173*                                                               *
   174*                            ERCNETWS                           *
   175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   176*                            VMOD=2.014                         *
   177*                                                               *
   178*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   179*                                                               *
   180*****************************************************************.
   181*                   C H A N G E   L O G
   182*
   183* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   184*-----------------------------------------------------------------
   185*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   186* EFFECTIVE    NUMBER
   187*-----------------------------------------------------------------
   188* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   189* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   190* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   191* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   192* 050713  CR2008052200001  PEMA  ADD CODE FOR 0 PCT APR
   193******************************************************************
   194
   195 01  NET-PAY-WORK-AREA.
   196     12  OPTION-SW               PIC X   VALUE 'X'.
   197        88  NPO-STD         VALUE SPACE.
   198        88  NPO-ALT         VALUE 'A'.
   199        88  NPO-SIMPLE      VALUE 'S'.
   200        88  NPO-2MO         VALUE 'I'.
   201        88  NPO-3MO         VALUE 'J'.
   202        88  NPO-4MO         VALUE 'K'.
   203        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   204        88  NPO-TRUNC-0     VALUE 'T'.
   205        88  NPO-TRUNC-1     VALUE 'U'.
   206        88  NPO-TRUNC-2     VALUE 'V'.
   207        88  NPO-TRUNC-3     VALUE 'W'.
   208        88  NPO-TRUNC-4     VALUE 'X'.
   209        88  NPO-REFUND      VALUE 'R'.
   210        88  NPO-PRUDENTIAL  VALUE 'P'.
   211
   212     12  TYPE-SW             PIC X   VALUE 'N'.
   213        88  NET-STD             VALUE 'N'.
   214        88  NET-SMP             VALUE 'S'.
   215
   216     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   217        88  NP-RATING           VALUE '1'.
   218        88  NP-REFUND           VALUE '2'.
   219        88  NP-REMAIN-AMT       VALUE '3'.
   220
   221     12  COMP-3-WORK-AREA         COMP-3.
   222         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   223         16  V               PIC SV9(13)       VALUE +.0.
   224         16  J               PIC SV9(9)        VALUE +0.
   225         16  K               PIC SV9(9)        VALUE +0.
   226         16  I               PIC SV9(10)       VALUE +.0.
   227         16  D               PIC S9(5)         VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page   6
* ELRATE.cbl
   228         16  APR100          PIC SV9(9)        VALUE +.0.
   229         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   230         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   231         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
   232         16  pema            pic s9(2)v9(15)   value +0.
   233         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   234         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
   235         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   236         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   237         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   238         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   239         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   240         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   241         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   242         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   243         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   244         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   245         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   246         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   247         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   248         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   249         16  ANGLEMY         PIC S9(5)V9(13)   VALUE +.0.
   250         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   251         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   252         16  ANGLENY         PIC S9(5)V9(13)   VALUE +.0.
   253         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   254         16  ANGLEN-MP1      PIC S9(5)V9(13)   VALUE +.0.
   255         16  ANGLEN-MP1Y     PIC S9(5)V9(13)   VALUE +.0.
   256         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   257         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   258         16  ANGLEM-1Y       PIC S9(7)V9(10)   VALUE +.0.
   259         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   260         16  PVBALLOON       PIC S9(7)V99      VALUE +.0.
   261         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   262         16  K1              PIC S999          VALUE +1.
   263         16  K12             PIC S999          VALUE +12.
   264         16  K100            PIC S999          VALUE +100.
   265         16  K1000           PIC S9(7)         VALUE +1000.
   266         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   267         16  Y REDEFINES NC-LR
   268                             PIC S99V9(5).
   269         16  TI              PIC S999V9(5)     VALUE +0.
   270         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   271         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   272         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   273         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   274         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   275         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   276         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   277         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   278
   279         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   280         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   281         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   282         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   283         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   284         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   285         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page   7
* ELRATE.cbl
   286         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   287         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   288         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   289         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   290         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   291         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   292
   293         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
   294
   295         16  ORIGINAL-TERM   PIC S999.
   296         16  M              REDEFINES ORIGINAL-TERM
   297                             PIC S999.
   298
   299         16  REMAINING-TERM  PIC S999.
   300         16  R              REDEFINES REMAINING-TERM
   301                             PIC S999.
   302
   303         16  LOAN-TERM       PIC S999.
   304         16  N              REDEFINES LOAN-TERM
   305                             PIC S999.
   306
   307         16  EXPIRED-TERM    PIC S999.
   308         16  E              REDEFINES EXPIRED-TERM
   309                             PIC S999.
   310
   311         16  PRUDENTIAL-WORK-AMT
   312                             PIC S9(7)V9(8).
   313         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   314                             PIC S9(7)V9(8).
   315
   316         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   317         16  VX              PIC S9V9(13)      VALUE +0.0.
   318         16  SV              PIC S9V9(13)      VALUE +0.0.
   319         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   320         16  SX              PIC S9V9(13)      VALUE +0.0.
   321         16  SE              PIC S9V9(10)      VALUE +0.0.
   322         16  N2              PIC S9(7)         VALUE +0.
   323         16  N3              PIC S9(7)         VALUE +0.
   324         16  K-I             PIC S9V9(8)       VALUE +0.0.
   325
   326     12  BINARY-WORK-AREA        COMP.
   327         16  X1              PIC S999        VALUE +0.
   328         16  X2              PIC S999        VALUE +0.
   329         16  MAX-X           PIC S9(5)       VALUE +0.
   330         16  B1              PIC S9(5)       VALUE +1.
   331         16  LINDX           PIC S999        VALUE ZEROS.
   332         16  AHNDX           PIC S999        VALUE ZEROS.
   333
   334     12  CSO-RATE-WORK-AREAS.
   335         16  C-PMTS-PER-YEAR     PIC S999V99 COMP-3 VALUE ZEROS.
   336         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   337         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   338     12  WS-WORK-MISC.
   339         16  ws-extra-pmts       pic s999         comp-3.
   340         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   341         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   342*        16  WS-AGE              PIC 99           VALUE ZEROS.
   343         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page   8
* ELRATE.cbl
   344         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   345         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   346         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   347         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   348         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   349         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   350         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   351         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   352         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
   353         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   354         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   355******************************************************************
   356
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page   9
* ELRATE.cbl
   358*                            COPY ELCDATE.
   359******************************************************************
   360*                                                                *
   361*                                                                *
   362*                            ELCDATE.                            *
   363*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   364*                            VMOD=2.003
   365*                                                                *
   366*                                                                *
   367*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   368*                 LENGTH = 200                                   *
   369******************************************************************
   370
   371 01  DATE-CONVERSION-DATA.
   372     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   373     12  DC-OPTION-CODE                PIC X.
   374         88  BIN-TO-GREG                VALUE ' '.
   375         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   376         88  EDIT-GREG-TO-BIN           VALUE '2'.
   377         88  YMD-GREG-TO-BIN            VALUE '3'.
   378         88  MDY-GREG-TO-BIN            VALUE '4'.
   379         88  JULIAN-TO-BIN              VALUE '5'.
   380         88  BIN-PLUS-ELAPSED           VALUE '6'.
   381         88  FIND-CENTURY               VALUE '7'.
   382         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   383         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   384         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   385         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   386         88  JULIAN-TO-BIN-3            VALUE 'C'.
   387         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   388         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   389         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   390         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   391         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   392         88  CHECK-LEAP-YEAR            VALUE 'H'.
   393         88  BIN-3-TO-GREG              VALUE 'I'.
   394         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   395         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   396         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   397         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   398         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   399         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   400         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   401         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   402         88  THREE-CHARACTER-BIN
   403                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   404         88  GREGORIAN-TO-BIN
   405                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   406         88  BIN-TO-GREGORIAN
   407                  VALUES ' ' '1' 'I' '8' 'G'.
   408         88  JULIAN-TO-BINARY
   409                  VALUES '5' 'C' 'E' 'F'.
   410     12  DC-ERROR-CODE                 PIC X.
   411         88  NO-CONVERSION-ERROR        VALUE ' '.
   412         88  DATE-CONVERSION-ERROR
   413                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   414         88  DATE-IS-ZERO               VALUE '1'.
   415         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  10
* ELRATE.cbl
   416         88  DATE-IS-INVALID            VALUE '3'.
   417         88  DATE1-GREATER-DATE2        VALUE '4'.
   418         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   419         88  DATE-INVALID-OPTION        VALUE '9'.
   420         88  INVALID-CENTURY            VALUE 'A'.
   421         88  ONLY-CENTURY               VALUE 'B'.
   422         88  ONLY-LEAP-YEAR             VALUE 'C'.
   423         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   424     12  DC-END-OF-MONTH               PIC X.
   425         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   426     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   427         88  USE-NORMAL-PROCESS         VALUE ' '.
   428         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   429         88  ADJUST-UP-100-YRS          VALUE '2'.
   430     12  FILLER                        PIC X.
   431     12  DC-CONVERSION-DATES.
   432         16  DC-BIN-DATE-1             PIC XX.
   433         16  DC-BIN-DATE-2             PIC XX.
   434         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   435         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   436                       DC-GREG-DATE-1-EDIT.
   437             20  DC-EDIT1-MONTH        PIC 99.
   438             20  SLASH1-1              PIC X.
   439             20  DC-EDIT1-DAY          PIC 99.
   440             20  SLASH1-2              PIC X.
   441             20  DC-EDIT1-YEAR         PIC 99.
   442         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   443         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   444                     DC-GREG-DATE-2-EDIT.
   445             20  DC-EDIT2-MONTH        PIC 99.
   446             20  SLASH2-1              PIC X.
   447             20  DC-EDIT2-DAY          PIC 99.
   448             20  SLASH2-2              PIC X.
   449             20  DC-EDIT2-YEAR         PIC 99.
   450         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   451         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   452                     DC-GREG-DATE-1-YMD.
   453             20  DC-YMD-YEAR           PIC 99.
   454             20  DC-YMD-MONTH          PIC 99.
   455             20  DC-YMD-DAY            PIC 99.
   456         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   457         16  DC-GREG-DATE-1-MDY-R REDEFINES
   458                      DC-GREG-DATE-1-MDY.
   459             20  DC-MDY-MONTH          PIC 99.
   460             20  DC-MDY-DAY            PIC 99.
   461             20  DC-MDY-YEAR           PIC 99.
   462         16  DC-GREG-DATE-1-ALPHA.
   463             20  DC-ALPHA-MONTH        PIC X(10).
   464             20  DC-ALPHA-DAY          PIC 99.
   465             20  FILLER                PIC XX.
   466             20  DC-ALPHA-CENTURY.
   467                 24 DC-ALPHA-CEN-N     PIC 99.
   468             20  DC-ALPHA-YEAR         PIC 99.
   469         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   470         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   471         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   472         16  DC-JULIAN-DATE            PIC 9(05).
   473         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  11
* ELRATE.cbl
   474                                       PIC 9(05).
   475         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   476             20  DC-JULIAN-YEAR        PIC 99.
   477             20  DC-JULIAN-DAYS        PIC 999.
   478         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   479         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   480         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   481     12  DATE-CONVERSION-VARIBLES.
   482         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   483         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   484             20  FILLER                PIC 9(3).
   485             20  HOLD-CEN-1-CCYY.
   486                 24  HOLD-CEN-1-CC     PIC 99.
   487                 24  HOLD-CEN-1-YY     PIC 99.
   488             20  HOLD-CEN-1-MO         PIC 99.
   489             20  HOLD-CEN-1-DA         PIC 99.
   490         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   491             20  HOLD-CEN-1-R-MO       PIC 99.
   492             20  HOLD-CEN-1-R-DA       PIC 99.
   493             20  HOLD-CEN-1-R-CCYY.
   494                 24  HOLD-CEN-1-R-CC   PIC 99.
   495                 24  HOLD-CEN-1-R-YY   PIC 99.
   496             20  FILLER                PIC 9(3).
   497         16  HOLD-CENTURY-1-X.
   498             20  FILLER                PIC X(3)  VALUE SPACES.
   499             20  HOLD-CEN-1-X-CCYY.
   500                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   501                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   502             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   503             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   504         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   505             20  HOLD-CEN-1-R-X-MO     PIC XX.
   506             20  HOLD-CEN-1-R-X-DA     PIC XX.
   507             20  HOLD-CEN-1-R-X-CCYY.
   508                 24  HOLD-CEN-1-R-X-CC PIC XX.
   509                 24  HOLD-CEN-1-R-X-YY PIC XX.
   510             20  FILLER                PIC XXX.
   511         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   512         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   513         16  DC-JULIAN-DATE-1          PIC 9(07).
   514         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   515             20  DC-JULIAN-1-CCYY.
   516                 24  DC-JULIAN-1-CC    PIC 99.
   517                 24  DC-JULIAN-1-YR    PIC 99.
   518             20  DC-JULIAN-DA-1        PIC 999.
   519         16  DC-JULIAN-DATE-2          PIC 9(07).
   520         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   521             20  DC-JULIAN-2-CCYY.
   522                 24  DC-JULIAN-2-CC    PIC 99.
   523                 24  DC-JULIAN-2-YR    PIC 99.
   524             20  DC-JULIAN-DA-2        PIC 999.
   525         16  DC-GREG-DATE-A-EDIT.
   526             20  DC-EDITA-MONTH        PIC 99.
   527             20  SLASHA-1              PIC X VALUE '/'.
   528             20  DC-EDITA-DAY          PIC 99.
   529             20  SLASHA-2              PIC X VALUE '/'.
   530             20  DC-EDITA-CCYY.
   531                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  12
* ELRATE.cbl
   532                 24  DC-EDITA-YEAR     PIC 99.
   533         16  DC-GREG-DATE-B-EDIT.
   534             20  DC-EDITB-MONTH        PIC 99.
   535             20  SLASHB-1              PIC X VALUE '/'.
   536             20  DC-EDITB-DAY          PIC 99.
   537             20  SLASHB-2              PIC X VALUE '/'.
   538             20  DC-EDITB-CCYY.
   539                 24  DC-EDITB-CENT     PIC 99.
   540                 24  DC-EDITB-YEAR     PIC 99.
   541         16  DC-GREG-DATE-CYMD         PIC 9(08).
   542         16  DC-GREG-DATE-CYMD-R REDEFINES
   543                              DC-GREG-DATE-CYMD.
   544             20  DC-CYMD-CEN           PIC 99.
   545             20  DC-CYMD-YEAR          PIC 99.
   546             20  DC-CYMD-MONTH         PIC 99.
   547             20  DC-CYMD-DAY           PIC 99.
   548         16  DC-GREG-DATE-MDCY         PIC 9(08).
   549         16  DC-GREG-DATE-MDCY-R REDEFINES
   550                              DC-GREG-DATE-MDCY.
   551             20  DC-MDCY-MONTH         PIC 99.
   552             20  DC-MDCY-DAY           PIC 99.
   553             20  DC-MDCY-CEN           PIC 99.
   554             20  DC-MDCY-YEAR          PIC 99.
   555    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   556        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   557    12  DC-EL310-DATE                  PIC X(21).
   558    12  FILLER                         PIC X(28).
   559
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  13
* ELRATE.cbl
   561*                            COPY ELCCALC.
   562******************************************************************
   563*                                                                *
   564*                           ELCCALC.                            *
   565*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   566*                            VMOD=2.025                          *
   567*                                                                *
   568*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   569*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   570*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   571*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   572*                                                                *
   573*  PASSED TO ELRTRM                                              *
   574*  -----------------                                             *
   575*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   576*  ORIGINAL TERM                                                 *
   577*  BEGINNING DATE                                                *
   578*  ENDING DATE                                                   *
   579*  COMPANY I.D.                                                  *
   580*  ACCOUNT MASTER USER FIELD                                     *
   581*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   582*  FREE LOOK DAYS                                                *
   583*                                                                *
   584*  RETURNED FROM ELRTRM                                          *
   585*  ---------------------                                         *
   586*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   587*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   588*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   589*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   590*----------------------------------------------------------------*
   591*  PASSED TO ELRAMT                                              *
   592*  ----------------                                              *
   593*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   594*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   595*  ORIGINAL AMOUNT                                               *
   596*  ALTERNATE BENEFIT (BALLON)                                    *
   597*  A.P.R. - NET PAY ONLY                                         *
   598*  METHOD
   599*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   600*  COMPANY I.D.                                                  *
   601*  BENEFIT TYPE                                                  *
   602*                                                                *
   603*  RETURNED FROM ELRAMT                                          *
   604*  --------------------                                          *
   605*  REMAINING AMOUNT 1 - CURRENT                                  *
   606*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   607*  REMAINING AMOUNT FACTOR
   608*----------------------------------------------------------------*
   609*  PASSED TO ELRESV                                              *
   610*  -----------------                                             *
   611*  CERTIFICATE EFFECTIVE DATE                                    *
   612*  VALUATION DATE                                                *
   613*  PAID THRU DATE                                                *
   614*  BENEFIT                                                       *
   615*  INCURRED DATE                                                 *
   616*  REPORTED DATE                                                 *
   617*  ISSUE AGE                                                     *
   618*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  14
* ELRATE.cbl
   619*  CDT PERCENT                                                   *
   620*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   621* *CLAIM TYPE (LIFE, A/H)                                        *
   622* *REMAINING BENEFIT (FROM ELRAMT)                               *
   623* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   624*                                                                *
   625*  RETURNED FROM ELRESV                                          *
   626*  --------------------                                          *
   627*  CDT TABLE USED                                                *
   628*  CDT FACTOR USED                                               *
   629*  PAY TO CURRENT RESERVE                                        *
   630*  I.B.N.R. - A/H ONLY                                           *
   631*  FUTURE (ACCRUED) AH ONLY                                      *
   632*----------------------------------------------------------------*
   633*  PASSED TO ELRATE                                              *
   634*  ----------------                                              *
   635*  CERT ISSUE DATE                                               *
   636*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   637*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   638*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   639*  STATE CODE (CLIENT DEFINED)                                   *
   640*  STATE CODE (STANDARD P.O. ABBRV)                              *
   641*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   642*  DEVIATION CODE                                                *
   643*  ISSUE AGE                                                     *
   644*  ORIGINAL BENEFIT AMOUNT                                       *
   645*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   646*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   647*  BENEFIT KIND (LIFE OR A/H)                                    *
   648*  A.P.R.                                                        *
   649*  METHOD
   650*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   651*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   652*  COMPANY I.D. (3 CHARACTER)                                    *
   653*  BENEFIT CODE                                                  *
   654*  BENEFIT OVERRIDE CODE                                         *
   655*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   656*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   657*  JOINT INDICATOR (CSL ONLY)                                    *
   658*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   659*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   660*                                                                *
   661*  RETURNED FROM ELRATE                                          *
   662*  --------------------                                          *
   663*  CALCULATED PREMIUM                                            *
   664*  PREMIUM RATE                                                  *
   665*  MORTALITY CODE                                                *
   666*  MAX ATTAINED AGE                                              *
   667*  MAX AGE                                                       *
   668*  MAX TERM                                                      *
   669*  MAX MONTHLY BENEFIT                                           *
   670*  MAX TOTAL BENIFIT                                             *
   671*  COMPOSITE RATE (OPEN-END ONLY)                                *
   672*----------------------------------------------------------------*
   673*  PASSED TO ELRFND                                              *
   674*  ----------------                                              *
   675*  CERT ISSUE DATE                                               *
   676*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  15
* ELRATE.cbl
   677*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   678*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   679*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   680*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   681*  STATE CODE (CLIENT DEFINED)                                   *
   682*  STATE CODE (STANDARD P.O. ABBRV)                              *
   683*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   684*  DEVIATION CODE                                                *
   685*  ISSUE AGE                                                     *
   686*  ORIGINAL BENEFIT AMOUNT                                       *
   687*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   688*  PROCESS TYPE (CANCEL)                                         *
   689*  BENEFIT KIND (LIFE OR A/H)                                    *
   690*  A.P.R.                                                        *
   691*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   692*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   693*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   694*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   695*  COMPANY I.D. (3 CHARACTER)                                    *
   696*  BENEFIT CODE                                                  *
   697*  BENEFIT OVERRIDE CODE                                         *
   698*                                                                *
   699*  RETURNED FROM ELRFND                                          *
   700*  --------------------                                          *
   701*  CALCULATED REFUND                                             *
   702*----------------------------------------------------------------*
   703*  PASSED TO ELEARN                                              *
   704*  ----------------                                              *
   705*  CERT ISSUE DATE                                               *
   706*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   707*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   708*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   709*  STATE CODE (CLIENT DEFINED)                                   *
   710*  STATE CODE (STANDARD P.O. ABBRV)                              *
   711*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   712*  DEVIATION CODE                                                *
   713*  ISSUE AGE                                                     *
   714*  ORIGINAL BENEFIT AMOUNT                                       *
   715*  BENEFIT KIND (LIFE OR A/H)                                    *
   716*  A.P.R.                                                        *
   717*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   718*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   719*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   720*  COMPANY I.D. (3 CHARACTER)                                    *
   721*  BENEFIT CODE                                                  *
   722*  BENEFIT OVERRIDE CODE                                         *
   723*                                                                *
   724*  RETURNED FROM ELEARN                                          *
   725*  --------------------                                          *
   726*  INDICATED  EARNINGS                                           *
   727*----------------------------------------------------------------*
   728*                 LENGTH = 450                                   *
   729*                                                                *
   730******************************************************************
   731******************************************************************
   732*                   C H A N G E   L O G
   733*
   734* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  16
* ELRATE.cbl
   735*-----------------------------------------------------------------
   736*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   737* EFFECTIVE    NUMBER
   738*-----------------------------------------------------------------
   739* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   740* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   741* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   742* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   743* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   744* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   745* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   746* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   747* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   748* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   749******************************************************************
   750
   751 01  CALCULATION-PASS-AREA.
   752     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   753                                     COMP.
   754
   755     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   756       88  NO-CP-ERROR                             VALUE ZERO.
   757       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   758                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   759       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   760       88  CP-ERROR-IN-DATES                       VALUE '2'.
   761       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   762       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   763       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   764       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   765       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   766       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   767       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   768       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   769       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   770       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   771       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   772       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   773       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   774       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   775       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   776
   777     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   778       88  NO-CP-ERROR-2                           VALUE ZERO.
   779***********************  INPUT AREAS ****************************
   780
   781     12  CP-CALCULATION-AREA.
   782         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   783         16  CP-CERT-EFF-DT        PIC XX.
   784         16  CP-VALUATION-DT       PIC XX.
   785         16  CP-PAID-THRU-DT       PIC XX.
   786         16  CP-BENEFIT-TYPE       PIC X.
   787           88  CP-AH                               VALUE 'A' 'D'
   788                                                   'I' 'U'.
   789           88  CP-REDUCING-LIFE                    VALUE 'R'.
   790           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   791         16  CP-INCURRED-DT        PIC XX.
   792         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  17
* ELRATE.cbl
   793         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   794         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   795         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   796                                     COMP-3.
   797         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   798                                     COMP-3.
   799         16  CP-CDT-METHOD         PIC X.
   800           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   801           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   802           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   803         16  CP-CLAIM-TYPE         PIC X.
   804           88  CP-AH-CLAIM                         VALUE 'A'.
   805           88  CP-LIFE-CLAIM                       VALUE 'L'.
   806         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   807                                     COMP-3.
   808         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   809                                     COMP-3.
   810         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   811                                     COMP-3.
   812         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   813                                     COMP-3.
   814         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   815                                     COMP-3.
   816         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   817                                     COMP-3.
   818         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   819                                     COMP-3.
   820         16  CP-REM-TERM-METHOD    PIC X.
   821           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   822           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   823           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   824           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   825           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   826           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   827           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   828         16  CP-EARNING-METHOD     PIC X.
   829           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   830           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   831           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   832           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   833           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   834           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   835           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   836           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   837           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   838           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   839           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   840           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   841           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   842           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   843         16  CP-PROCESS-TYPE       PIC X.
   844           88  CP-CLAIM                            VALUE '1'.
   845           88  CP-CANCEL                           VALUE '2'.
   846           88  CP-ISSUE                            VALUE '3'.
   847         16  CP-SPECIAL-CALC-CD    PIC X.
   848           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   849           88  CP-1-MTH-INTEREST               VALUE ' '.
   850           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  18
* ELRATE.cbl
   851           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   852           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   853           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   854           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   855           88  CP-FARM-PLAN                    VALUE 'F'.
   856           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   857           88  CP-2-MTH-INTEREST               VALUE 'I'.
   858           88  CP-3-MTH-INTEREST               VALUE 'J'.
   859           88  CP-4-MTH-INTEREST               VALUE 'K'.
   860           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   861           88  CP-MORTGAGE-REC                 VALUE 'M'.
   862           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   863           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   864           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   865           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   866                                                     'W' 'X'.
   867           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   868           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   869           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   870           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   871           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   872           88  CP-SUMMARY-REC                  VALUE 'Z'.
   873           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   874           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   875           88  CP-AD-D-BENEFIT                 VALUE '4'.
   876           88  CP-CSL-METH-1                   VALUE '5'.
   877           88  CP-CSL-METH-2                   VALUE '6'.
   878           88  CP-CSL-METH-3                   VALUE '7'.
   879           88  CP-CSL-METH-4                   VALUE '8'.
   880
   881         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   882                                     COMP-3.
   883         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   884         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   885         16  CP-STATE              PIC XX          VALUE SPACE.
   886         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   887         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   888           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   889               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   890         16  CP-R78-OPTION         PIC X.
   891           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   892           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   893
   894         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   895         16  CP-IBNR-RESERVE-SW    PIC X.
   896         16  CP-CLAIM-STATUS       PIC X.
   897         16  CP-RATE-FILE          PIC X.
   898         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   899                                     COMP-3.
   900
   901         16  CP-LIFE-OVERRIDE-CODE PIC X.
   902         16  CP-AH-OVERRIDE-CODE   PIC X.
   903
   904         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   905                                     COMP-3.
   906         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   907                                   PIC S9(5)V99 COMP-3.
   908         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  19
* ELRATE.cbl
   909                                     COMP-3.
   910         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   911                                     COMP-3.
   912         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   913                                     COMP-3.
   914         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   915                                  PIC S9(7)V99 COMP-3.
   916
   917         16  CP-PAID-FROM-DATE     PIC X(02).
   918         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   919         16  CP-EXT-DAYS-CALC      PIC X.
   920           88  CP-EXT-NO-CHG                   VALUE ' '.
   921           88  CP-EXT-CHG-LF                   VALUE '1'.
   922           88  CP-EXT-CHG-AH                   VALUE '2'.
   923           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   924         16  CP-DOMICILE-STATE     PIC XX.
   925         16  CP-CARRIER            PIC X.
   926         16  CP-REIN-FLAG          PIC X.
   927         16  CP-REM-TRM-CALC-OPTION PIC X.
   928           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   929                      '2' '3' '4' '5'.
   930           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   931           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   932           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   933           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   934           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   935           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   936           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   937           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   938         16  CP-SIG-SWITCH         PIC X.
   939         16  CP-RATING-METHOD      PIC X.
   940           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   941           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   942           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   943           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   944           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   945           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   946           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   947           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   948           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   949         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   950                                     COMP-3.
   951         16  CP-BEN-CATEGORY       PIC X.
   952         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   953         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   954                                   PIC S99V9(5) COMP-3.
   955         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   956         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   957                                   PIC S99V9(5) COMP-3.
   958         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   959         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   960         16  CP-EXPIRE-DT          PIC XX.
   961         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   962         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   963         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   964         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   965         16  CP-DDF-SPEC-CALC      PIC X.
   966             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  20
* ELRATE.cbl
   967             88  CP-CALC-CLP              VALUE 'C'.
   968         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   969         16  CP-CANCEL-REASON      PIC X.
   970         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   971         16  CP-PMT-MODE           PIC X.
   972         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   973         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   974         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   975         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   976         16  FILLER                PIC X.
   977
   978***************    OUTPUT FROM ELRESV   ************************
   979
   980         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   981
   982         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   983                                     COMP-3.
   984         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   985                                     COMP-3.
   986         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   987                                     COMP-3.
   988         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   989                                     COMP-3.
   990         16  FILLER                PIC X(09).
   991***************    OUTPUT FROM ELRTRM   *************************
   992
   993         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   994                                     COMP-3.
   995         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   996                                     COMP-3.
   997         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   998                                     COMP-3.
   999         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1000                                     COMP-3.
  1001         16  FILLER                PIC X(12).
  1002
  1003***************    OUTPUT FROM ELRAMT   *************************
  1004
  1005         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1006                                     COMP-3.
  1007         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1008                                     COMP-3.
  1009         16  FILLER                PIC X(12).
  1010
  1011***************    OUTPUT FROM ELRATE   *************************
  1012
  1013         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1014                                     COMP-3.
  1015         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1016                                     COMP-3.
  1017         16  CP-MORTALITY-CODE     PIC X(4).
  1018         16  CP-RATE-EDIT-FLAG     PIC X.
  1019             88  CP-RATES-NEED-APR                  VALUE '1'.
  1020         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1021                                     COMP-3.
  1022         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1023         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1024         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  21
* ELRATE.cbl
  1025                                   PIC S9(7)V99 COMP-3.
  1026         16  FILLER                PIC X(07).
  1027
  1028***************    OUTPUT FROM ELRFND   *************************
  1029
  1030         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1031                                     COMP-3.
  1032         16  CP-REFUND-TYPE-USED   PIC X.
  1033           88  CP-R-AS-R78                         VALUE '1'.
  1034           88  CP-R-AS-PRORATA                     VALUE '2'.
  1035           88  CP-R-AS-CALIF                       VALUE '3'.
  1036           88  CP-R-AS-TEXAS                       VALUE '4'.
  1037           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1038           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1039           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1040           88  CP-R-AS-MEAN                        VALUE '8'.
  1041           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1042           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1043           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1044           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1045           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1046           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1047         16  FILLER                PIC X(12).
  1048
  1049***************    OUTPUT FROM ELEARN   *************************
  1050
  1051         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1052                                     COMP-3.
  1053         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1054                                     COMP-3.
  1055         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1056                                     COMP-3.
  1057         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1058                                     COMP-3.
  1059         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1060                                     COMP-3.
  1061         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1062                                     COMP-3.
  1063         16  CP-EARNING-TYPE-USED  PIC X.
  1064           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1065           88  CP-E-AS-R78                         VALUE '1'.
  1066           88  CP-E-AS-PRORATA                     VALUE '2'.
  1067           88  CP-E-AS-TEXAS                       VALUE '4'.
  1068           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1069           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1070           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1071           88  CP-E-AS-MEAN                        VALUE '8'.
  1072           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1073         16  FILLER                PIC X(12).
  1074
  1075***************    OUTPUT FROM ELPMNT   *************************
  1076
  1077         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1078                                     COMP-3.
  1079         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1080                                     COMP-3.
  1081         16  FILLER                PIC X(12).
  1082
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  22
* ELRATE.cbl
  1083***************   MISC WORK AREAS    *****************************
  1084         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1085                                     COMP-3.
  1086         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1087                                     COMP-3.
  1088         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1089                                     COMP-3.
  1090         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1091                                     COMP-3.
  1092         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1093                                     COMP-3.
  1094         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1095                                     COMP-3.
  1096         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1097             88  OPEN-RATE-FILE                   VALUE 'O'.
  1098             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1099             88  IO-ERROR                         VALUE 'E'.
  1100
  1101         16  CP-FIRST-PAY-DATE     PIC XX.
  1102
  1103         16  CP-JOINT-INDICATOR    PIC X.
  1104
  1105         16  CP-RESERVE-REMAINING-TERM
  1106                                   PIC S9(4)V9    VALUE ZERO
  1107                                     COMP-3.
  1108
  1109         16  CP-INSURED-BIRTH-DT   PIC XX.
  1110
  1111         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1112                                     COMP-3.
  1113
  1114         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1115                                     COMP-3.
  1116
  1117         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1118                                     COMP-3.
  1119
  1120         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1121                                     COMP-3.
  1122
  1123         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1124                                     COMP-3.
  1125
  1126         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1127                                     COMP-3.
  1128
  1129         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1130                                     COMP-3.
  1131
  1132         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1133             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1134
  1135         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1136                                     COMP-3.
  1137         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1138                                     COMP-3.
  1139         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1140         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  23
* ELRATE.cbl
  1141         16  cp-net-only-state     pic x value spaces.
  1142         16  FILLER                PIC X(13).
  1143******************************************************************
  1144
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  24
* ELRATE.cbl
  1146****************************************************************
  1147*
  1148* Copyright (c) 2007 by Clerity Solutions, Inc.
  1149* All rights reserved.
  1150*
  1151****************************************************************
  1152 01  DFHEIV.
  1153   02  DFHEIV0               PIC X(35).
  1154   02  DFHEIV1               PIC X(08).
  1155   02  DFHEIV2               PIC X(08).
  1156   02  DFHEIV3               PIC X(08).
  1157   02  DFHEIV4               PIC X(06).
  1158   02  DFHEIV5               PIC X(04).
  1159   02  DFHEIV6               PIC X(04).
  1160   02  DFHEIV7               PIC X(02).
  1161   02  DFHEIV8               PIC X(02).
  1162   02  DFHEIV9               PIC X(01).
  1163   02  DFHEIV10              PIC S9(7) COMP-3.
  1164   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1165   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1166   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1167   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1168   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1169   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1170   02  DFHEIV17              PIC X(04).
  1171   02  DFHEIV18              PIC X(04).
  1172   02  DFHEIV19              PIC X(04).
  1173   02  DFHEIV20              USAGE IS POINTER.
  1174   02  DFHEIV21              USAGE IS POINTER.
  1175   02  DFHEIV22              USAGE IS POINTER.
  1176   02  DFHEIV23              USAGE IS POINTER.
  1177   02  DFHEIV24              USAGE IS POINTER.
  1178   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1179   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1180   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1181   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1182   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1183   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1184   02  FILLER                PIC X(02).
  1185   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1186   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1187   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1188   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1189   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1190 LINKAGE  SECTION.
  1191*****************************************************************
  1192*                                                               *
  1193* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1194* All rights reserved.                                          *
  1195*                                                               *
  1196*****************************************************************
  1197 01  dfheiblk.
  1198     02  eibtime          pic s9(7) comp-3.
  1199     02  eibdate          pic s9(7) comp-3.
  1200     02  eibtrnid         pic x(4).
  1201     02  eibtaskn         pic s9(7) comp-3.
  1202     02  eibtrmid         pic x(4).
  1203     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  25
* ELRATE.cbl
  1204     02  eibcposn         pic s9(4) comp.
  1205     02  eibcalen         pic s9(4) comp.
  1206     02  eibaid           pic x(1).
  1207     02  eibfiller1       pic x(1).
  1208     02  eibfn            pic x(2).
  1209     02  eibfiller2       pic x(2).
  1210     02  eibrcode         pic x(6).
  1211     02  eibfiller3       pic x(2).
  1212     02  eibds            pic x(8).
  1213     02  eibreqid         pic x(8).
  1214     02  eibrsrce         pic x(8).
  1215     02  eibsync          pic x(1).
  1216     02  eibfree          pic x(1).
  1217     02  eibrecv          pic x(1).
  1218     02  eibsend          pic x(1).
  1219     02  eibatt           pic x(1).
  1220     02  eibeoc           pic x(1).
  1221     02  eibfmh           pic x(1).
  1222     02  eibcompl         pic x(1).
  1223     02  eibsig           pic x(1).
  1224     02  eibconf          pic x(1).
  1225     02  eiberr           pic x(1).
  1226     02  eibrldbk         pic x(1).
  1227     02  eiberrcd         pic x(4).
  1228     02  eibsynrb         pic x(1).
  1229     02  eibnodat         pic x(1).
  1230     02  eibfiller5       pic x(2).
  1231     02  eibresp          pic 9(09) comp.
  1232     02  eibresp2         pic 9(09) comp.
  1233     02  dfheigdj         pic s9(4) comp.
  1234     02  dfheigdk         pic s9(4) comp.
  1235 01  DFHCOMMAREA             PIC X(450).
  1236
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  26
* ELRATE.cbl
  1238*01 PARMLIST              COMP.
  1239*    02  FILLER              PIC S9(8).
  1240*    02  ERRATE-POINTER      PIC S9(8).
  1241
  1242*                                COPY ERCRATE.
  1243******************************************************************
  1244*                                                                *
  1245*                                                                *
  1246*                            ERCRATE                             *
  1247*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1248*                            VMOD=2.008                          *
  1249*                                                                *
  1250*   ONLINE CREDIT SYSTEM                                         *
  1251*                                                                *
  1252*   FILE DESCRIPTION = RATES MASTER FILE                         *
  1253*                                                                *
  1254*   FILE TYPE = VSAM,KSDS                                        *
  1255*   RECORD SIZE = 1765  RECFORM = FIXED                          *
  1256*                                                                *
  1257*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
  1258*       ALTERNATE PATH = NONE                                    *
  1259*                                                                *
  1260*   LOG = NO                                                     *
  1261*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1262*                                                                *
  1263******************************************************************
  1264
  1265 01  RATE-RECORD.
  1266     12  RT-RECORD-ID                      PIC XX.
  1267         88  VALID-RT-ID                      VALUE 'RT'.
  1268
  1269     12  RT-CONTROL-PRIMARY.
  1270         16  RT-COMPANY-CD                 PIC X.
  1271         16  RT-STATE-CODE.
  1272             20  RT-ST-CODE                PIC XX.
  1273             20  RT-ST-CLASS               PIC XX.
  1274             20  RT-ST-DEV                 PIC XXX.
  1275         16  RT-L-AH-CODE.
  1276             20  RT-L-AH                   PIC X.
  1277             20  RT-LAH-NUM                PIC XX.
  1278         16  RT-LIMITS.
  1279             20  RT-HIGH-AGE               PIC 99.
  1280             20  RT-HIGH-AMT               PIC 9(6).
  1281             20  RT-FUTURE                 PIC XX.
  1282             20  RT-SEX                    PIC X.
  1283         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
  1284
  1285     12  RT-MAINT-INFORMATION.
  1286         16  RT-LAST-MAINT-DT              PIC XX.
  1287         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1288         16  RT-LAST-MAINT-USER            PIC X(4).
  1289         16  FILLER                        PIC X(10).
  1290
  1291     12  RT-STRUCTURE-COMMENT              PIC X(50).
  1292     12  RT-RATE-COMMENT                   PIC X(50).
  1293
  1294     12  CSL-RESERVED                      PIC X(10).
  1295     12  FILLER                            PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  27
* ELRATE.cbl
  1296
  1297     12  RT-MAX-AGE                        PIC 99.
  1298
  1299     12  RT-LIFE-LIMS-FLDS.
  1300         16  RT-LIFE-MORT-CODE             PIC X(4).
  1301         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
  1302             20  RT-L-EX-AGE               PIC 99.
  1303             20  RT-L-EX-TERM              PIC S999       COMP-3.
  1304             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
  1305         16  FILLER                        PIC X(20).
  1306
  1307     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
  1308         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
  1309             20  RT-AH-AGE                 PIC 99.
  1310             20  RT-AH-TERM                PIC S999       COMP-3.
  1311             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
  1312             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
  1313
  1314     12  RT-LIFE-RATES.
  1315         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
  1316
  1317     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
  1318         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
  1319
  1320     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
  1321
  1322     12  RT-DISCOUNT-OPTION                PIC X.
  1323         88  RT-DO-NOT-USE                     VALUE ' '.
  1324         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
  1325         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
  1326
  1327     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
  1328     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
  1329
  1330     12  RT-COMPOSITE-OPTION               PIC X.
  1331         88  RT-NO-COMPOSITE                   VALUE ' '.
  1332         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
  1333
  1334     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
  1335
  1336     12  RT-POLICY-FEE                     PIC S9(3)V99   COMP-3.
  1337     12  FILLER                            PIC X(13).
  1338
  1339     12  RT-TYPE-RATE                      PIC X.
  1340         88  RT-IS-STND                        VALUE ' ' 'S'.
  1341         88  RT-IS-OB                          VALUE 'O'.
  1342
  1343     12  RT-SRT-ALPHA                      PIC X.
  1344
  1345     12  RT-CONTROL-2.
  1346         16  RTC-1                         PIC X(7).
  1347         16  RTC-3                         PIC X(11).
  1348         16  RTC-4                         PIC 9(11) COMP-3.
  1349         16  RTC-2                         PIC X(3).
  1350******************************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  28
* ELRATE.cbl
  1352 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA RATE-RECORD.
  1353 0000-DFHEXIT SECTION.
  1354     MOVE '9#                    $   ' TO DFHEIV0.
  1355     MOVE 'ELRATE' TO DFHEIV1.
  1356     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1357
  1358     MOVE DFHCOMMAREA            TO  CALCULATION-PASS-AREA.
  1359
  1360 000-START-PREMIUM-CALC.
  1361     MOVE ZERO                   TO CP-RETURN-CODE
  1362                                    CP-CALC-PREMIUM
  1363                                    CP-PREMIUM-RATE
  1364                                    CP-POLICY-FEE.
  1365
  1366     MOVE SPACES                 TO CP-MORTALITY-CODE.
  1367     MOVE ALL '9'                TO ERRATE-KEY.
  1368
  1369*    IF CP-RATE-FILE = 'O'
  1370*        MOVE OERATE-FILE-ID     TO ERRATE-FILE-ID.
  1371
  1372     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD.
  1373     MOVE CP-STATE               TO RATE-ST-CODE.
  1374     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS.
  1375     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV.
  1376     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE.
  1377
  1378     IF CP-RATING-BENEFIT-AMT NOT NUMERIC  OR
  1379        CP-RATING-BENEFIT-AMT = ZEROS
  1380         MOVE CP-ORIGINAL-BENEFIT    TO RATE-HIGH-AMT
  1381     ELSE
  1382         MOVE CP-RATING-BENEFIT-AMT  TO RATE-HIGH-AMT.
  1383
  1384     IF CP-AH
  1385         MOVE CP-AH-OVERRIDE-CODE     TO RATE-L-AH
  1386     ELSE
  1387         MOVE CP-LIFE-OVERRIDE-CODE   TO RATE-L-AH.
  1388
  1389     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM.
  1390     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1391     MOVE SPACE                  TO DC-OPTION-CODE.
  1392
  1393     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1394
  1395*** Y2K, PROJ 7744
  1396     IF NO-CONVERSION-ERROR
  1397         MOVE ZEROS                 TO RATE-EXPIRY-DATE
  1398                                       WS-HOLD-RATE-EXP-DT
  1399         MOVE DC-GREG-DATE-CYMD     TO WS-HOLD-RATE-EXP-AL(4:8)
  1400         MOVE WS-HOLD-RATE-EXP-DT   TO RATE-EXPIRY-DATE
  1401         MOVE ERRATE-KEY            TO SAVE-ERRATE-KEY
  1402     ELSE
  1403         MOVE '2'                   TO CP-RETURN-CODE
  1404         GO TO 9999-CALC-RATE-PREM-X
  1405     END-IF.
  1406*** Y2K, PROJ 7744
  1407
  1408
  1409* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  29
* ELRATE.cbl
  1410*        NOTFND   (9999-RATE-NOTFND)
  1411*        NOTOPEN  (9999-RATE-NOTOPEN)
  1412*        ENDFILE  (9999-RATE-NOTFND)
  1413*    END-EXEC.
  1414*    MOVE '"$IJ''                 ! " #00001404' TO DFHEIV0
  1415     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  1416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1417     MOVE X'2220233030303031343034' TO DFHEIV0(25:11)
  1418     CALL 'kxdfhei1' USING DFHEIV0
  1419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1420
  1421
  1422 0050-RATE-START-BROWSE.
  1423
  1424* EXEC CICS STARTBR
  1425*        DATASET  (ERRATE-FILE-ID)
  1426*        RIDFLD   (ERRATE-KEY)
  1427*        GTEQ
  1428*    END-EXEC.
  1429     MOVE 0
  1430       TO DFHEIV11
  1431*    MOVE '&,         G          &   #00001411' TO DFHEIV0
  1432     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1433     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1434     MOVE X'2020233030303031343131' TO DFHEIV0(25:11)
  1435     CALL 'kxdfhei1' USING DFHEIV0,
  1436           ERRATE-FILE-ID,
  1437           ERRATE-KEY,
  1438           DFHEIV99,
  1439           DFHEIV11,
  1440           DFHEIV99
  1441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1442
  1443
  1444     MOVE 'Y'                  TO WS-BROWSE-SW.
  1445
  1446 0100-READ-RATE-LOOP.
  1447
  1448* EXEC CICS READNEXT
  1449*        DATASET  (ERRATE-FILE-ID)
  1450*        SET      (ADDRESS OF RATE-RECORD)
  1451*        RIDFLD   (ERRATE-KEY)
  1452*    END-EXEC.
  1453     MOVE 0
  1454       TO DFHEIV11
  1455*    MOVE '&.S                   )   #00001420' TO DFHEIV0
  1456     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1457     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1458     MOVE X'2020233030303031343230' TO DFHEIV0(25:11)
  1459     CALL 'kxdfhei1' USING DFHEIV0,
  1460           ERRATE-FILE-ID,
  1461           DFHEIV20,
  1462           DFHEIV99,
  1463           ERRATE-KEY,
  1464           DFHEIV99,
  1465           DFHEIV11,
  1466           DFHEIV99,
  1467           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  30
* ELRATE.cbl
  1468     SET ADDRESS OF RATE-RECORD TO
  1469         DFHEIV20
  1470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1471
  1472
  1473 0110-CHECK-KEYS.
  1474*                            COPY ELCRATPD.
  1475******************************************************************
  1476*                                                                *
  1477*                                                                *
  1478*                            ELCRATPD                            *
  1479*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1480*                            VMOD=2.061                          *
  1481*                                                                *
  1482******************************************************************
  1483******************************************************************
  1484*                   C H A N G E   L O G
  1485*
  1486* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1487*-----------------------------------------------------------------
  1488*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1489* EFFECTIVE    NUMBER
  1490*-----------------------------------------------------------------
  1491* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  1492* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  1493* 032603                   PEMA  ADD SPECIAL AZ CALC
  1494* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  1495* 120403                   PEMA  ADD SPECIAL TX CALC
  1496* 092205                   PEMA  FIX CRIT PER FOR DCC
  1497* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  1498* 021207                   PEMA  ADD PA NP
  1499* 022107                   PEMA  ADD NH NP AND NP TRUNC
  1500* 032807                   PEMA  ADD VT NP PLUS 2
  1501* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  1502* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  1503* 060909    2008042300002  PEMA  ADD NEW FARM PLAN CALC
  1504* 010410    2008021200005  PEMA  ADD MN NET PAY BALLOON
  1505* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1506* 040610  CR2010010400006  PEMA  ADD IN TO VT CODE
  1507* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1508* 071211    2010012700001  PEMA  ADD SPPDD
  1509* 071511    2011021500001  PEMA  ADD CODE FOR DCC 10C
  1510* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  1511* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1512* 032612  CR2011110200001  PEMA  AHL CHANGES
  1513* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  1514* 122613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  1515* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  1516******************************************************************
  1517
  1518 0110-CHECK-KEY.
  1519     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  1520        SVRT-ST-CODE    = RT-ST-CODE     AND
  1521        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  1522        SVRT-ST-DEV     = RT-ST-DEV      AND
  1523        SVRT-L-AH       = RT-L-AH        AND
  1524        SVRT-LAH-NUM    = RT-LAH-NUM
  1525         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  31
* ELRATE.cbl
  1526     ELSE
  1527         GO TO 9999-RATE-NOTFND.
  1528
  1529     IF  SVRT-HIGH-AGE GREATER RT-HIGH-AGE
  1530         GO TO 9999-RATE-NOTFND.
  1531
  1532     IF SVRT-HIGH-AMT NOT LESS THAN RT-HIGH-AMT
  1533        GO TO 0100-READ-RATE-LOOP.
  1534
  1535     IF SVRT-EXPIRY-DATE GREATER RT-EXPIRY-DATE
  1536         GO TO 0100-READ-RATE-LOOP.
  1537
  1538     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  1539         GO TO 0100-READ-RATE-LOOP.
  1540
  1541     IF RT-MAX-AGE = ZEROS
  1542         NEXT SENTENCE
  1543     ELSE
  1544         COMPUTE WS-AGE =
  1545             (CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12))
  1546         IF WS-AGE >= RT-MAX-AGE
  1547             MOVE 'B'               TO CP-RETURN-CODE.
  1548
  1549     IF CP-LOAN-TERM NOT NUMERIC
  1550         MOVE +0                    TO CP-LOAN-TERM.
  1551
  1552     IF CP-LOAN-TERM = ZERO
  1553         MOVE CP-ORIGINAL-TERM      TO CP-LOAN-TERM.
  1554
  1555     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1556         MOVE +0                    TO CP-TERM-OR-EXT-DAYS.
  1557
  1558     MOVE CP-R-MAX-MON-BEN          TO WS-MAX-MON-BEN.
  1559     MOVE CP-R-MAX-TOT-BEN          TO WS-MAX-TOT-BEN.
  1560
  1561     IF CP-AH
  1562         GO TO 2000-TYPE-IS-AH.
  1563
  1564     evaluate true
  1565        when (rt-is-ob)
  1566           and (cp-company-id not = 'CID')
  1567              move cp-loan-term  to ws-rate-term
  1568        when (cp-company-id = 'DCC')
  1569           and (cp-benefit-cd (1:1) = 'P')
  1570           move cp-loan-term     to ws-rate-term
  1571        when other
  1572           move cp-original-term to ws-rate-term
  1573     end-evaluate
  1574
  1575*    IF ((RT-IS-OB)
  1576*       AND (CP-COMPANY-ID NOT EQUAL 'CID'))
  1577*                     OR
  1578*       ((CP-COMPANY-ID = 'DCC')
  1579*       AND (CP-BENEFIT-CD (1:1) = 'P'))
  1580*       MOVE CP-LOAN-TERM        TO WS-RATE-TERM
  1581*    ELSE
  1582*       MOVE CP-ORIGINAL-TERM TO WS-RATE-TERM
  1583*    END-IF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  32
* ELRATE.cbl
  1584
  1585     MOVE CP-CERT-EFF-DT            TO DC-BIN-DATE-1.
  1586     MOVE SPACE                     TO DC-OPTION-CODE.
  1587
  1588     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1589
  1590 1000-TYPE-IS-LIFE.
  1591     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  1592
  1593     MOVE ZERO                      TO CP-R-MAX-AGE
  1594                                       CP-R-MAX-TERM
  1595                                       CP-R-MAX-MON-BEN
  1596                                       CP-R-MAX-TOT-BEN.
  1597
  1598     MOVE RT-LIFE-MORT-CODE         TO CP-MORTALITY-CODE.
  1599
  1600     IF RT-POLICY-FEE NUMERIC
  1601        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  1602
  1603     MOVE RT-DISCOUNT-OPTION     TO WS-DISCOUNT-OPTION.
  1604
  1605     if rt-discount-ob-rate not numeric
  1606        move zeros               to rt-discount-ob-rate
  1607     end-if
  1608     IF (RT-DISCOUNT-OPTION EQUAL
  1609                     '1' OR '2' OR '3' OR '4' OR '5') AND
  1610        (RT-DISCOUNT-OB-RATE NUMERIC)         AND
  1611        (RT-DISCOUNT-OB-RATE GREATER THAN +0)
  1612         NEXT SENTENCE
  1613     ELSE
  1614         IF (RT-DISCOUNT-OPTION EQUAL '6') AND
  1615            (CP-STATE-STD-ABBRV EQUAL 'CA')
  1616             IF RT-DISCOUNT-RATE GREATER THAN ZERO
  1617                 COMPUTE CA-DISCOUNT = RT-DISCOUNT-RATE / 100
  1618                 GO TO 1050-REGULAR-RATES
  1619             ELSE
  1620                 GO TO 1050-REGULAR-RATES
  1621         ELSE
  1622             GO TO 1050-REGULAR-RATES.
  1623
  1624*    display ' discount option ' rt-discount-option
  1625     IF RT-DISCOUNT-RATE NOT NUMERIC
  1626        MOVE +0                  TO RT-DISCOUNT-RATE.
  1627
  1628     IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1629        NEXT SENTENCE
  1630     ELSE
  1631        MOVE +0                  TO CP-PREMIUM-RATE
  1632                                    CP-COMPOSITE-RATE
  1633                                    CP-CALC-PREMIUM
  1634         MOVE '4'                TO CP-RETURN-CODE
  1635         GO TO 9999-CALC-RATE-PREM-X.
  1636
  1637     IF RT-DISCOUNT-OPTION = '1' OR '3' OR '5'
  1638        MOVE RT-DISCOUNT-RATE TO WS-WORK-DIS-RATE
  1639     ELSE
  1640        MOVE CP-LOAN-APR TO WS-WORK-DIS-RATE.
  1641
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  33
* ELRATE.cbl
  1642*    IF RT-DISCOUNT-OPTION EQUAL '4'
  1643*       MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1644*       GO TO 1075-BYPASS-REGULAR-RATE.
  1645
  1646     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  1647        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1648        COMPUTE WS-WORK-DIS-RATE EQUAL
  1649                WS-WORK-DIS-RATE / +100
  1650        GO TO 1075-BYPASS-REGULAR-RATE.
  1651
  1652     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  1653        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  1654        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1655        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1656        GO TO 1075-BYPASS-REGULAR-RATE.
  1657
  1658     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1659        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  1660        (CP-TRUNCATED-LIFE)
  1661        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1662        GO TO 1075-BYPASS-REGULAR-RATE.
  1663
  1664     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1665        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  1666        (CP-EARN-AS-NET-PAY)
  1667*       (CP-TRUNCATED-LIFE)
  1668        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1669        GO TO 1075-BYPASS-REGULAR-RATE.
  1670
  1671     IF ((CP-COMPANY-ID EQUAL 'GTL') AND
  1672        (CP-STATE-STD-ABBRV EQUAL 'RI'))
  1673                   AND
  1674        ((CP-EARN-AS-NET-PAY)
  1675               OR
  1676        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  1677        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1678        GO TO 1075-BYPASS-REGULAR-RATE.
  1679
  1680     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1681        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  1682        (CP-EARN-AS-NET-PAY) AND
  1683        (CP-SPECIAL-CALC-CD EQUAL 'H')
  1684        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1685        GO TO 1075-BYPASS-REGULAR-RATE.
  1686
  1687     if (cp-company-id = 'CID')
  1688        and (cp-state-std-abbrv = 'WA')
  1689        and (rt-discount-option = '1')
  1690        and (cp-earn-as-farm-plan)
  1691        move rt-discount-ob-rate to cp-premium-rate
  1692        go to 1075-bypass-regular-rate
  1693     end-if
  1694     IF (CP-COMPANY-ID = 'CID')
  1695        AND (CP-STATE-STD-ABBRV = 'MN')
  1696        AND (RT-DISCOUNT-OPTION = '1')
  1697        AND ((CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1698                     OR
  1699            (CP-LEVEL-LIFE OR CP-EARN-AS-FARM-PLAN)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  34
* ELRATE.cbl
  1700            AND (CP-CERT-EFF-DT > X'A4FF'))
  1701        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1702        display ' made it to MN 1 ' cp-premium-rate
  1703        GO TO 1075-BYPASS-REGULAR-RATE
  1704     END-IF
  1705     if (cp-company-id = 'CID')
  1706        and (cp-earn-as-reg-balloon)
  1707        and (cp-ben-category = 'P' or 'I')
  1708        and (rt-discount-ob-rate not = zeros)
  1709        go to 1075-bypass-regular-rate
  1710     end-if
  1711     IF (CP-COMPANY-ID EQUAL 'CID')
  1712        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  1713                      OR
  1714            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  1715        AND (CP-EARN-AS-NET-PAY)
  1716        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1717        GO TO 1075-BYPASS-REGULAR-RATE
  1718     END-IF
  1719     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  1720        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1721        (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  1722         MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1723         GO TO 1075-BYPASS-REGULAR-RATE.
  1724
  1725     IF CP-COMPANY-ID = 'CID' or 'AHL'
  1726        CONTINUE
  1727     ELSE
  1728        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1729           (CP-EARN-AS-NET-PAY ) AND
  1730           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  1731            GO TO 1075-BYPASS-REGULAR-RATE
  1732        END-IF
  1733     END-IF
  1734     IF (CP-COMPANY-ID = 'CID') AND
  1735        (CP-EARN-AS-NET-PAY) AND
  1736        (CP-LEVEL-LIFE) AND
  1737        (CP-STATE-STD-ABBRV = 'CA') AND
  1738        (CP-STATE-STD-ABBRV = CP-STATE)
  1739        COMPUTE WS-WORK-DIS-RATE =
  1740             RT-DISCOUNT-RATE / +100
  1741        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1742        GO TO 1075-BYPASS-REGULAR-RATE
  1743     END-IF
  1744
  1745     IF (CP-COMPANY-ID = 'CID')
  1746        AND (CP-EARN-AS-NET-PAY)
  1747        AND (CP-STATE-STD-ABBRV = 'ME')
  1748        COMPUTE WS-WORK-DIS-RATE =
  1749             RT-DISCOUNT-RATE / +100
  1750        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1751        GO TO 1075-BYPASS-REGULAR-RATE
  1752     END-IF
  1753     IF (CP-COMPANY-ID = 'CID')
  1754        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1755           OR 'IN' OR 'AZ')
  1756        AND (CP-FARM-PLAN)
  1757        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  35
* ELRATE.cbl
  1758        GO TO 1075-BYPASS-REGULAR-RATE
  1759     END-IF
  1760     IF (CP-COMPANY-ID = 'DCC')
  1761        AND (CP-BEN-CATEGORY = 'D')
  1762        AND (CP-EARN-AS-NET-PAY)
  1763        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1764        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  1765           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  1766*       DISPLAY ' ACT COMM ' CP-DCC-ACT-COMM
  1767*       DISPLAY ' PMF COMM ' CP-DCC-PMF-COMM
  1768*       DISPLAY ' OB RATE  ' RT-DISCOUNT-OB-RATE
  1769*       DISPLAY ' NEW RATE ' CP-PREMIUM-RATE
  1770        GO TO 1075-BYPASS-REGULAR-RATE
  1771     END-IF
  1772     IF (CP-COMPANY-ID = 'CID') AND
  1773        (CP-EARN-AS-NET-PAY) AND
  1774        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  1775                            OR 'VT')
  1776                   OR
  1777        ((CP-STATE-STD-ABBRV = 'IN') AND
  1778        (CP-CERT-EFF-DT > X'9A7F'))
  1779                   OR
  1780        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  1781        (CP-CERT-EFF-DT > X'9ADF'))) AND
  1782        (CP-STATE-STD-ABBRV = CP-STATE)
  1783        COMPUTE WS-WORK-DIS-RATE =
  1784             RT-DISCOUNT-RATE / +100
  1785        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1786        GO TO 1075-BYPASS-REGULAR-RATE
  1787     END-IF
  1788
  1789     IF (CP-COMPANY-ID = 'CID') AND
  1790        (CP-EARN-AS-NET-PAY) AND
  1791        (CP-STATE-STD-ABBRV = 'TX') AND
  1792        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1793        (WS-DISCOUNT-OPTION NOT = ' ')
  1794        COMPUTE WS-WORK-DIS-RATE =
  1795             RT-DISCOUNT-RATE / +100
  1796        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1797        GO TO 1075-BYPASS-REGULAR-RATE
  1798     END-IF
  1799
  1800     IF (CP-COMPANY-ID = 'CID') AND
  1801        (CP-EARN-AS-NET-PAY) AND
  1802        (CP-TRUNCATED-LIFE) AND
  1803        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  1804        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1805        (WS-DISCOUNT-OPTION NOT = ' ')
  1806        COMPUTE WS-WORK-DIS-RATE =
  1807             RT-DISCOUNT-RATE / +100
  1808        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1809        GO TO 1075-BYPASS-REGULAR-RATE
  1810     END-IF
  1811
  1812     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1813        IF WS-WORK-DIS-RATE NOT EQUAL +0
  1814           COMPUTE WS-WORK-DIS-RATE EQUAL
  1815                   WS-WORK-DIS-RATE / +100.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  36
* ELRATE.cbl
  1816
  1817     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1818        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1819           IF CP-MONTHLY-PAYMENT EQUAL +0
  1820            IF CP-LOAN-APR GREATER THAN +2
  1821              COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1822              CP-ORIGINAL-BENEFIT /
  1823               ((1 - (1 + (CP-LOAN-APR / +1200)) **
  1824               (WS-RATE-TERM * -1)) / (CP-LOAN-APR / +1200))
  1825            ELSE
  1826             COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1827               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1828
  1829     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1830        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1831          IF WS-WORK-DIS-RATE GREATER THAN +0
  1832           COMPUTE WK1 ROUNDED EQUAL
  1833           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1834                              (WS-RATE-TERM - +1)) /
  1835                        (WS-WORK-DIS-RATE / +12)
  1836           COMPUTE WK2 ROUNDED EQUAL
  1837           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1838                              (WS-RATE-TERM)) /
  1839                        (WS-WORK-DIS-RATE / +12)
  1840           COMPUTE WK3 EQUAL
  1841                RT-DISCOUNT-OB-RATE *
  1842                (1 + WS-WORK-DIS-RATE / +12)
  1843                MOVE WK3 TO CP-PREMIUM-RATE
  1844                COMPUTE WK5 EQUAL WK3 / +1000
  1845           GO TO 1075-BYPASS-REGULAR-RATE.
  1846*               (RT-DISCOUNT-OB-RATE / +1000) *
  1847*               (1 + WS-WORK-DIS-RATE / +12)
  1848*          GO TO 1075-BYPASS-REGULAR-RATE.
  1849
  1850     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1851        IF RT-DISCOUNT-OB-RATE GREATER THAN +0
  1852           COMPUTE WK3 EQUAL
  1853           RT-DISCOUNT-OB-RATE *
  1854           (24 / (24 + WS-WORK-DIS-RATE * WS-RATE-TERM))
  1855           MOVE WK3 TO CP-PREMIUM-RATE
  1856           COMPUTE WK5 EQUAL WK3 / +1000
  1857           GO TO 1075-BYPASS-REGULAR-RATE.
  1858
  1859     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  1860        (CP-STATE-STD-ABBRV EQUAL 'VT' OR 'MA')
  1861        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1862        GO TO 1075-BYPASS-REGULAR-RATE.
  1863
  1864     COMPUTE WS-SIN-PREM-RATE =
  1865             (RT-DISCOUNT-OB-RATE / +1000) *
  1866             ((WS-RATE-TERM + +1) / +2).
  1867
  1868     COMPUTE CP-PREMIUM-RATE =
  1869             WS-SIN-PREM-RATE /
  1870             (+1 + (((WS-WORK-DIS-RATE / +100) *
  1871             WS-RATE-TERM) / +24)).
  1872
  1873     IF CP-PREMIUM-RATE NOT = +0
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  37
* ELRATE.cbl
  1874        MULTIPLY +100 BY CP-PREMIUM-RATE
  1875        MOVE CP-PREMIUM-RATE TO WS-PREMIUM-RATE
  1876        GO TO 1075-BYPASS-REGULAR-RATE.
  1877
  1878 1050-REGULAR-RATES.
  1879
  1880     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1881        COMPUTE WK5 EQUAL
  1882        ((WS-RATE-TERM * RT-L-RATE (+12)) / +100) /
  1883        (6 * (WS-RATE-TERM + 1))
  1884        MOVE WK5 TO CP-PREMIUM-RATE
  1885        GO TO 1075-BYPASS-REGULAR-RATE.
  1886
  1887     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  1888        (CP-CSL-VALID-NP-BENEFIT-CD)
  1889        IF CP-JOINT-INDICATOR EQUAL 'J'
  1890           MOVE RT-L-RATE (3) TO CP-PREMIUM-RATE
  1891           GO TO 1075-BYPASS-REGULAR-RATE
  1892        ELSE
  1893           MOVE RT-L-RATE (1) TO CP-PREMIUM-RATE
  1894           GO TO 1075-BYPASS-REGULAR-RATE.
  1895
  1896     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  1897        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  1898        (CP-EARN-AS-NET-PAY )
  1899        MOVE RT-L-RATE (12)      TO CP-PREMIUM-RATE
  1900        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  1901        MOVE CP-FIRST-PAY-DATE   TO DC-BIN-DATE-2
  1902        MOVE '1'                 TO DC-OPTION-CODE
  1903        PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  1904        IF DATE-CONVERSION-ERROR
  1905            MOVE '2'                TO CP-RETURN-CODE
  1906            GO TO 9999-CALC-RATE-PREM-X
  1907        ELSE
  1908            COMPUTE CP-ODD-DAYS-TO-PMT = DC-ELAPSED-MONTHS * 30 +
  1909                                         DC-ODD-DAYS-OVER
  1910            GO TO 1075-BYPASS-REGULAR-RATE.
  1911
  1912     IF RT-COMPOSITE-RATE NOT NUMERIC
  1913         MOVE ZEROS                        TO RT-COMPOSITE-RATE.
  1914
  1915*    IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1916     IF WS-RATE-TERM GREATER ZERO AND LESS 361
  1917         MOVE RT-L-RATE (WS-RATE-TERM)     TO CP-PREMIUM-RATE
  1918                                              WS-PREMIUM-RATE
  1919         MOVE RT-COMPOSITE-RATE            TO CP-COMPOSITE-RATE
  1920     ELSE
  1921         MOVE +0                           TO CP-PREMIUM-RATE
  1922                                              CP-COMPOSITE-RATE
  1923                                              CP-CALC-PREMIUM
  1924         GO TO 9999-CALC-RATE-PREM-X.
  1925     IF (CP-COMPANY-ID EQUAL 'CID')
  1926        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  1927        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1928        AND (CP-EARN-AS-NET-PAY)
  1929        GO TO 1075-BYPASS-REGULAR-RATE
  1930     END-IF
  1931******************************************************
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  38
* ELRATE.cbl
  1932*    IF CP-COMPANY-ID NOT = 'LBL'
  1933     IF (CP-COMPANY-ID NOT = 'LBL' AND 'CID')
  1934                   or
  1935        ((cp-company-id = 'CID')
  1936        and (cp-earn-as-reg-balloon)
  1937        and (cp-ben-category = 'P' or 'I'))
  1938         GO TO 1075-BYPASS-REGULAR-RATE.
  1939
  1940     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1941     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  1942     MOVE '1'                    TO DC-OPTION-CODE.
  1943     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1944     IF DATE-CONVERSION-ERROR
  1945         MOVE '2'                TO CP-RETURN-CODE
  1946         GO TO 9999-CALC-RATE-PREM-X
  1947       ELSE
  1948         MOVE DC-ELAPSED-MONTHS  TO CP-MNTHS-TO-FIRST-PMT
  1949         MOVE DC-ODD-DAYS-OVER   TO CP-ODD-DAYS-TO-PMT.
  1950
  1951     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN 1
  1952        COMPUTE CP-ODD-DAYS-TO-PMT EQUAL CP-ODD-DAYS-TO-PMT +
  1953        ((CP-MNTHS-TO-FIRST-PMT - 1) * +30).
  1954
  1955     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH)
  1956        IF (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1957           NEXT SENTENCE
  1958         ELSE
  1959           GO TO 1075-BYPASS-REGULAR-RATE
  1960       ELSE
  1961        IF (CP-MNTHS-TO-FIRST-PMT = ZERO) AND
  1962           (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1963           NEXT SENTENCE
  1964         ELSE
  1965           GO TO 1075-BYPASS-REGULAR-RATE.
  1966
  1967     IF CP-MNTHS-TO-FIRST-PMT GREATER ZERO
  1968        COMPUTE CP-PREMIUM-RATE =
  1969        ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1970         * (CP-ORIGINAL-TERM + 1)) - CP-PREMIUM-RATE)
  1971         * (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  1972
  1973     IF CP-MNTHS-TO-FIRST-PMT = ZEROS
  1974        COMPUTE CP-PREMIUM-RATE =
  1975        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  1976        CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - 1))) *
  1977        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  1978        (CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1979         * (CP-ORIGINAL-TERM - 1)).
  1980******************************************************
  1981
  1982 1075-BYPASS-REGULAR-RATE.
  1983
  1984     MOVE CP-LOAN-TERM              TO WS-RATE-TERM.
  1985
  1986     MOVE +1 TO LINDX.
  1987
  1988     IF CP-COMPANY-ID EQUAL 'CRI'
  1989        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  39
* ELRATE.cbl
  1990           MOVE +5               TO LINDX
  1991           IF RT-L-EX-AGE (LINDX) EQUAL ZERO
  1992              MOVE 'F'           TO CP-RETURN-CODE
  1993              GO TO 1200-CALCULATE-PREMIUMS.
  1994
  1995     IF RT-L-EX-AGE (LINDX) = ZERO
  1996          GO TO 1200-CALCULATE-PREMIUMS.
  1997
  1998 1100-SEARCH-LIFE-LIMITS.
  1999
  2000     IF CP-COMPANY-ID EQUAL 'CRI'
  2001        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2002           IF LINDX GREATER THAN +4
  2003              MOVE 'A'           TO CP-RETURN-CODE
  2004              GO TO 1200-CALCULATE-PREMIUMS.
  2005
  2006     IF LINDX GREATER +8
  2007         MOVE 'A'                TO CP-RETURN-CODE
  2008         GO TO 1200-CALCULATE-PREMIUMS.
  2009
  2010     IF CP-ISSUE-AGE GREATER RT-L-EX-AGE (LINDX)
  2011         IF RT-L-EX-AGE (LINDX) = ZEROS
  2012             ADD +1              TO LINDX
  2013             GO TO 1100-SEARCH-LIFE-LIMITS
  2014         ELSE
  2015             MOVE RT-L-EX-AGE (LINDX)
  2016                                 TO CP-R-MAX-AGE
  2017             MOVE RT-L-EX-TERM (LINDX)
  2018                                 TO CP-R-MAX-TERM
  2019             MOVE RT-L-EX-FACE (LINDX)
  2020                                 TO CP-R-MAX-TOT-BEN
  2021             ADD +1              TO LINDX
  2022             GO TO 1100-SEARCH-LIFE-LIMITS
  2023     ELSE
  2024         MOVE RT-L-EX-AGE (LINDX)
  2025                                 TO CP-R-MAX-AGE
  2026         MOVE RT-L-EX-TERM (LINDX)
  2027                                 TO CP-R-MAX-TERM
  2028         MOVE RT-L-EX-FACE (LINDX)
  2029                                 TO CP-R-MAX-TOT-BEN.
  2030
  2031     IF CP-ORIGINAL-TERM GREATER RT-L-EX-TERM (LINDX)
  2032         MOVE '9'                TO CP-RETURN-CODE.
  2033
  2034     IF CP-ORIGINAL-BENEFIT GREATER RT-L-EX-FACE (LINDX)
  2035         MOVE '8'                TO CP-RETURN-CODE.
  2036
  2037 1200-CALCULATE-PREMIUMS.
  2038
  2039     IF CP-COMPANY-ID = 'CSL'
  2040        IF CP-CSL-VALID-NP-BENEFIT-CD
  2041           GO TO 1240-NET-PAY-CONT
  2042        ELSE
  2043           GO TO 1250-CSL-CALC.
  2044
  2045     IF CP-COMPANY-ID = 'WDS'
  2046        IF CP-STATE-STD-ABBRV = 'MN' OR 'NC'
  2047           IF CP-EARN-AS-REG-BALLOON
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  40
* ELRATE.cbl
  2048              GO TO 1240-NET-PAY-CONT.
  2049
  2050     IF (CP-COMPANY-ID = 'CID')
  2051        AND (CP-STATE-STD-ABBRV = 'MN')
  2052        AND (CP-EARN-AS-REG-BALLOON OR CP-EARN-AS-FARM-PLAN)
  2053        AND (CP-CERT-EFF-DT > X'A4FF')
  2054        display ' made it to mn 2 '
  2055        GO TO 1240-NET-PAY-CONT
  2056     END-IF
  2057     IF (CP-COMPANY-ID = 'CID')
  2058        AND (CP-STATE-STD-ABBRV = 'WA')
  2059        AND (CP-FARM-PLAN)
  2060        GO TO 1240-NET-PAY-CONT
  2061     END-IF
  2062     if (cp-company-id = 'CID')
  2063        and (cp-earn-as-reg-balloon)
  2064        and (cp-ben-category = 'P' or 'I')
  2065        display ' found balloon p or i ' rt-discount-ob-rate
  2066        evaluate true
  2067           when (cp-net-only-state = 'Y')
  2068              and (rt-discount-ob-rate > zeros)
  2069              compute cp-premium-rate = rt-discount-ob-rate / 10
  2070           when (cp-net-only-state = 'Y')
  2071              and (rt-discount-ob-rate = zeros)
  2072              display ' not ob rate     ' cp-premium-rate
  2073              compute cp-premium-rate =
  2074                 cp-premium-rate / cp-original-term * 12
  2075              display ' new rate ' cp-premium-rate
  2076              display ' net only state ' cp-premium-rate
  2077              compute cp-premium-rate rounded =
  2078                (cp-premium-rate *
  2079                   (cp-original-term + 1) / 12) /
  2080                ((cp-original-term + 2) / 2)
  2081              display ' new OB rate ' cp-premium-rate
  2082           when (cp-net-only-state <> 'Y')
  2083              and (rt-discount-ob-rate = zeros)
  2084              display ' not net only st ' cp-premium-rate
  2085              compute cp-premium-rate =
  2086                 cp-premium-rate / cp-original-term * 12
  2087              display ' new rate ' cp-premium-rate
  2088        end-evaluate
  2089        go to 1240-net-pay-cont
  2090     end-if
  2091     IF (CP-COMPANY-ID = 'CID')
  2092        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2093           OR 'IN' OR 'AZ')
  2094        AND (CP-FARM-PLAN)
  2095***  OK, I DID THIS SO ERCNETP WOULDN'T ERROR OUT
  2096***  THE APR ISN'T EVEN USED IN THE ROUTINE, SO SUE ME :)
  2097        MOVE +1.0                TO CP-LOAN-APR
  2098        GO TO 1240-NET-PAY-CONT
  2099     END-IF
  2100     IF CP-RATE-AS-STANDARD
  2101         GO TO 1210-REGULAR-RATE.
  2102
  2103     IF CP-CRITICAL-PERIOD
  2104         GO TO 1220-CRITICAL-PERIOD-LF-CONT.
  2105
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  41
* ELRATE.cbl
  2106     IF CP-EARN-AS-TEXAS
  2107         GO TO 1230-TEXAS-CONT.
  2108
  2109     IF CP-EARN-AS-NET-PAY
  2110        IF CP-STATE-STD-ABBRV = 'MD'
  2111          IF CP-COMPANY-ID = 'MON'
  2112            IF CP-BENEFIT-CD = '11' OR '12' OR '13' OR
  2113                               '14' OR '26' OR '47'
  2114              GO TO 1210-REGULAR-RATE.
  2115
  2116     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2117        IF CP-MONTHLY-PAYMENT EQUAL +0
  2118           COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2119                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2120
  2121     IF CP-COMPANY-ID EQUAL 'GTL'
  2122        NEXT SENTENCE
  2123     ELSE
  2124     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2125        IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2126           COMPUTE WK3 ROUNDED EQUAL
  2127           CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2128           CP-MONTHLY-PAYMENT
  2129           COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2130           COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2131           CP-ALTERNATE-BENEFIT)
  2132           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2133           WK3 * WK5
  2134           GO TO 9999-CALC-RATE-PREM-X
  2135        ELSE
  2136           COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2137           (CP-ORIGINAL-TERM - 1 - WK1)) /
  2138           (WS-WORK-DIS-RATE / +12)
  2139           COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2140           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2141                               WK5
  2142           GO TO 9999-CALC-RATE-PREM-X.
  2143
  2144     IF CP-COMPANY-ID EQUAL 'GTL' AND
  2145        CP-STATE-STD-ABBRV EQUAL 'RI' AND
  2146        CP-SPECIAL-CALC-CD EQUAL 'H' AND
  2147        CP-ORIGINAL-TERM LESS THAN +61
  2148        COMPUTE CP-CALC-PREMIUM EQUAL
  2149                        (CP-ORIGINAL-BENEFIT *
  2150           (CP-ORIGINAL-TERM + 1) * CP-PREMIUM-RATE) /
  2151           (20 * (1 + .0019 * CP-ORIGINAL-TERM) * 100)
  2152        COMPUTE CP-CALC-PREMIUM EQUAL
  2153                CP-CALC-PREMIUM +
  2154              (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE *
  2155        (CP-ORIGINAL-TERM + 1)) /
  2156        (10 * (1 + .0027 * (CP-ORIGINAL-TERM + 1)) * 100)
  2157        GO TO 9999-CALC-RATE-PREM-X.
  2158
  2159     IF CP-COMPANY-ID = 'GTL'     AND
  2160        CP-STATE-STD-ABBRV = 'PA' AND
  2161        CP-SPECIAL-CALC-CD = 'H'
  2162         GO TO 1260-GTL-PA-LEASE.
  2163
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  42
* ELRATE.cbl
  2164     IF (CP-EARN-AS-NET-PAY)
  2165*       AND (CP-LOAN-APR > ZEROS)
  2166        GO TO 1240-NET-PAY-CONT
  2167     END-IF
  2168
  2169     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  2170         GO TO 1210-REGULAR-RATE.
  2171
  2172**** CHECK TO SEE IF THE LEVEL PORTION OF A BALLOON IS BEING
  2173**** RATED AND BYPASS NET-PAY CHECK IF NO APR HAS BEEN ENTERED.
  2174****
  2175     IF CP-DEVIATION-CODE = 'LEV' AND
  2176        CP-LOAN-APR = ZEROS
  2177         GO TO 1210-REGULAR-RATE.
  2178
  2179     IF (CP-STATE-STD-ABBRV = 'OH')
  2180        AND (CP-CLASS-CODE NOT = 'L ')
  2181        AND (CP-ORIGINAL-TERM > 60)
  2182        AND (DC-GREG-DATE-CYMD > 19831031)
  2183        AND (CP-LOAN-APR > ZEROS)
  2184        GO TO 1240-NET-PAY-CONT
  2185     END-IF
  2186
  2187     IF (CP-STATE-STD-ABBRV = 'UT')
  2188        AND (CP-ORIGINAL-TERM > 62)
  2189        AND (DC-GREG-DATE-CYMD > 19810831)
  2190        AND (DC-GREG-DATE-CYMD < 19830901)
  2191        AND (CP-LOAN-APR > ZEROS)
  2192        GO TO 1240-NET-PAY-CONT
  2193     END-IF
  2194
  2195     IF (CP-STATE-STD-ABBRV = 'RI')
  2196        AND (CP-ORIGINAL-TERM > 60)
  2197        AND (DC-GREG-DATE-CYMD > 19831231)
  2198        AND (CP-LOAN-APR > ZEROS)
  2199        GO TO 1240-NET-PAY-CONT
  2200     END-IF
  2201     .
  2202 1210-REGULAR-RATE.
  2203
  2204     IF (CP-COMPANY-ID = 'CID')
  2205        AND (CP-EARN-AS-NET-PAY)
  2206        AND (CP-LOAN-APR = 0)
  2207        IF RT-L-RATE (WS-RATE-TERM) = 0
  2208           COMPUTE WS-SIN-PREM-RATE =
  2209              (RT-DISCOUNT-OB-RATE / +1000) *
  2210              ((WS-RATE-TERM + +1) / +2)
  2211           COMPUTE CP-PREMIUM-RATE =
  2212              WS-SIN-PREM-RATE /
  2213              (+1 + (((WS-WORK-DIS-RATE / +100) *
  2214              WS-RATE-TERM) / +24))
  2215        ELSE
  2216           MOVE RT-L-RATE (WS-RATE-TERM) TO CP-PREMIUM-RATE
  2217        END-IF
  2218     END-IF
  2219*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2220*       IF CP-MONTHLY-PAYMENT EQUAL +0
  2221*          COMPUTE CP-MONTHLY-PAYMENT EQUAL
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  43
* ELRATE.cbl
  2222*               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2223*
  2224*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2225*       IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2226*          COMPUTE WK3 ROUNDED EQUAL
  2227*          CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2228*          CP-MONTHLY-PAYMENT
  2229*          COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2230*          COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2231*          CP-ALTERNATE-BENEFIT)
  2232*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2233*          WK3 * WK5
  2234*          GO TO 9999-CALC-RATE-PREM-X
  2235*       ELSE
  2236*          COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2237*          (CP-ORIGINAL-TERM - 1 - WK1)) /
  2238*          (WS-WORK-DIS-RATE / +12)
  2239*          COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2240*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2241*                              WK5
  2242*          GO TO 9999-CALC-RATE-PREM-X.
  2243
  2244     IF CP-TERM-IS-DAYS
  2245         COMPUTE CP-PREMIUM-RATE ROUNDED =
  2246             ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM) * 12) / +365
  2247         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2248             ((CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE)
  2249                          * CP-TERM-OR-EXT-DAYS
  2250           GO TO 9999-CALC-RATE-PREM-X.
  2251
  2252     if (cp-company-id = 'AHL')
  2253        and (cp-loan-term > cp-original-term)
  2254        continue
  2255     else
  2256        IF NOT CP-TRUNCATED-LIFE
  2257           GO TO 1212-GROSS-NOT-TRUNCATED
  2258        end-if
  2259     end-if
  2260
  2261****  GROSS TRUNCATED CALCULATION
  2262
  2263     IF CP-LOAN-TERM NOT GREATER THAN CP-ORIGINAL-TERM
  2264         MOVE 'H'                TO  CP-RETURN-CODE
  2265         GO TO 9999-CALC-RATE-PREM-X.
  2266     if cp-company-id = 'AHL'
  2267        if (cp-state = 'AZ' OR 'GA' OR 'IN' OR 'MT' OR 'NH'
  2268           OR 'NJ' OR 'OH' OR 'PA' OR 'TX' OR 'VA')
  2269           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2270           cp-original-term) * (cp-loan-term - cp-original-term
  2271            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2272            cp-premium-rate / 100 * cp-original-term /
  2273            cp-loan-term * cp-original-benefit
  2274        else
  2275           compute cp-calc-premium rounded = (1 - (cp-loan-term -
  2276           cp-original-term) * (cp-loan-term - cp-original-term
  2277            + 1) / cp-loan-term / (cp-loan-term + 1)) *
  2278            cp-premium-rate * cp-original-benefit / 100
  2279        end-if
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  44
* ELRATE.cbl
  2280        go to 9999-calc-rate-prem-x
  2281     end-if
  2282
  2283     IF CP-COMPANY-ID = 'NCL'
  2284         COMPUTE WK-MONTHLY-RATE =
  2285               ((((CP-LOAN-TERM * (CP-LOAN-TERM + 1) -
  2286                  (CP-LOAN-TERM - CP-ORIGINAL-TERM) *
  2287                  (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1))
  2288                                 /
  2289                  (CP-LOAN-TERM * (CP-LOAN-TERM + 1))))
  2290                                 *
  2291                  ((RT-L-RATE (12) * CP-LOAN-TERM / 12)))
  2292         COMPUTE CP-CALC-PREMIUM =
  2293                 WK-MONTHLY-RATE * CP-ORIGINAL-BENEFIT / 100
  2294     ELSE
  2295         COMPUTE CP-R-MAX-TERM = CP-LOAN-TERM -
  2296                                 CP-ORIGINAL-TERM
  2297         COMPUTE CP-CALC-PREMIUM = CP-ORIGINAL-BENEFIT *
  2298                     ((RT-L-RATE (CP-LOAN-TERM)  -
  2299                     (1 - (CP-ORIGINAL-TERM / CP-LOAN-TERM)) *
  2300                     RT-L-RATE (CP-R-MAX-TERM)) / 100)
  2301     END-IF
  2302     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2303        COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2304           (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2305           CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS)
  2306     END-IF
  2307     GO TO 9999-CALC-RATE-PREM-X
  2308     .
  2309 1212-GROSS-NOT-TRUNCATED.
  2310*    DISPLAY ' ELCRATPD '
  2311*    DISPLAY ' MADE IT TO 1212-GROSS-NOT '
  2312*    display ' premium rate ' cp-premium-rate
  2313
  2314     IF (CP-COMPANY-ID = 'CID')
  2315        AND (CP-STATE-STD-ABBRV = 'VT' OR 'MA'
  2316           OR 'IN')
  2317        AND (CP-BENEFIT-CD = '55' OR '56')
  2318        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2319          (CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM)) *
  2320          (CP-ORIGINAL-TERM) *
  2321          ((CP-ORIGINAL-TERM) / 12) *
  2322          ((6.5 * RT-DISCOUNT-OB-RATE) / 1000)
  2323          GO TO 9999-CALC-RATE-PREM-X
  2324     END-IF
  2325     IF (CP-COMPANY-ID = 'CID')
  2326        AND (CP-STATE-STD-ABBRV = 'GA')
  2327        AND (CP-BENEFIT-CD = '55' OR '56' OR '2M' OR '2N')
  2328        COMPUTE WK3 ROUNDED =
  2329          CP-ORIGINAL-BENEFIT *
  2330          ((CP-ORIGINAL-TERM + 1) / 2) *
  2331          (RT-DISCOUNT-OB-RATE / 1000)
  2332          MOVE WK3 TO CP-CALC-PREMIUM
  2333          GO TO 9999-CALC-RATE-PREM-X
  2334     END-IF
  2335     IF (CP-COMPANY-ID EQUAL 'CID')
  2336        AND (CP-STATE-STD-ABBRV = 'MN')
  2337        AND (CP-LEVEL-LIFE)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  45
* ELRATE.cbl
  2338        AND (CP-CERT-EFF-DT > X'A4FF')
  2339        display ' made it to mn level '
  2340        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2341        MOVE CP-EXPIRE-DT        TO DC-BIN-DATE-2
  2342        MOVE '1'                 TO DC-OPTION-CODE
  2343        PERFORM 9100-CONVERT-DATE
  2344                                 THRU 9100-EXIT
  2345        IF DATE-CONVERSION-ERROR
  2346           MOVE '2'              TO CP-RETURN-CODE
  2347           MOVE ZEROS            TO FACTOR
  2348                                 CP-CALC-PREMIUM
  2349           GO TO 9999-CALC-RATE-PREM-X
  2350        END-IF
  2351        MOVE DC-ELAPSED-DAYS     TO D
  2352        COMPUTE CP-MONTHLY-PAYMENT = CP-ORIGINAL-BENEFIT /
  2353           (1 / (1 + (CP-LOAN-APR / 100) * D / 360) -
  2354           (CP-PREMIUM-RATE * 12 / 365 * D / 1000))
  2355        COMPUTE CP-CALC-PREMIUM = CP-MONTHLY-PAYMENT *
  2356           CP-PREMIUM-RATE * 12 / 365 * D / 1000
  2357        GO TO 9999-CALC-RATE-PREM-X
  2358     END-IF
  2359     IF (CP-COMPANY-ID = 'CID')
  2360        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2361        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2362           (CP-ORIGINAL-BENEFIT / 1000) * CP-PREMIUM-RATE
  2363     ELSE
  2364        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2365                 (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE
  2366     END-IF
  2367*    display ' calc premium ' cp-calc-premium
  2368
  2369*    IF CP-COMPANY-ID = 'LBL'
  2370     IF (CP-COMPANY-ID = 'LBL' OR 'CID')
  2371        AND (NOT CP-EARN-AS-NET-PAY)
  2372        GO TO 9999-CALC-RATE-PREM-X
  2373     END-IF
  2374
  2375*    display ' fell through to ext days '
  2376     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2377         GO TO 9999-CALC-RATE-PREM-X.
  2378
  2379     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2380         COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2381            (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2382               CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS).
  2383
  2384     GO TO 9999-CALC-RATE-PREM-X.
  2385
  2386 1220-CRITICAL-PERIOD-LF-CONT.
  2387     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2388               (CP-ORIGINAL-BENEFIT / +100) * CP-PREMIUM-RATE.
  2389
  2390     GO TO 9999-CALC-RATE-PREM-X.
  2391
  2392 1230-TEXAS-CONT.
  2393     IF CP-FARM-PLAN
  2394         GO TO 1235-TEXAS-FARM-CONT.
  2395
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  46
* ELRATE.cbl
  2396     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2397               (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2398
  2399     COMPUTE TEX-FACT-9 =
  2400                 (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY) /
  2401                 (CP-ORIGINAL-TERM + 1).
  2402
  2403     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2404                 CP-CALC-PREMIUM * TEX-FACT-9.
  2405
  2406     GO TO 9999-CALC-RATE-PREM-X.
  2407
  2408 1235-TEXAS-FARM-CONT.
  2409     COMPUTE WS-FARM-TERM =
  2410               (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY).
  2411
  2412     COMPUTE WS-PREMIUM-RATE = RT-L-RATE (WS-FARM-TERM) / 2.
  2413     MOVE WS-PREMIUM-RATE         TO CP-PREMIUM-RATE.
  2414
  2415
  2416     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2417              (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2418
  2419     GO TO 9999-CALC-RATE-PREM-X.
  2420
  2421 1240-NET-PAY-CONT.
  2422
  2423     MOVE CP-LOAN-APR             TO N-P-APR.
  2424     MOVE CP-ORIGINAL-TERM        TO N-P-ORIG
  2425                                     N-P-REM
  2426                                     N-P-LOAN.
  2427
  2428     MOVE CP-SPECIAL-CALC-CD      TO N-P-OPT.
  2429
  2430     IF CP-TRUNCATED-LIFE
  2431         MOVE CP-LOAN-TERM        TO N-P-LOAN.
  2432
  2433     IF CP-COMPANY-ID EQUAL 'NCL'
  2434        NEXT SENTENCE
  2435     ELSE
  2436        GO TO 1241-NET-PAY-CONT.
  2437
  2438     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  2439     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2
  2440     MOVE '1'                    TO DC-OPTION-CODE
  2441     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2442     IF DATE-CONVERSION-ERROR
  2443         MOVE '2'                TO CP-RETURN-CODE
  2444         GO TO 9999-CALC-RATE-PREM-X
  2445     ELSE
  2446        MOVE DC-ELAPSED-MONTHS   TO CP-MNTHS-TO-FIRST-PMT
  2447        MOVE DC-ODD-DAYS-OVER    TO CP-ODD-DAYS-TO-PMT.
  2448
  2449     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2450        (CP-ODD-DAYS-TO-PMT NOT EQUAL ZEROS)
  2451        NEXT SENTENCE
  2452     ELSE
  2453        MOVE +1                  TO ODF
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  47
* ELRATE.cbl
  2454        GO TO 1241-NET-PAY-CONT.
  2455
  2456     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN ZERO
  2457        COMPUTE CP-PREMIUM-RATE EQUAL
  2458        ((CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN + 1)) -
  2459        CP-PREMIUM-RATE) *
  2460        (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2461
  2462     IF CP-MNTHS-TO-FIRST-PMT EQUAL ZEROS
  2463        COMPUTE CP-PREMIUM-RATE EQUAL
  2464        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2465        N-P-LOAN * (N-P-LOAN - 1))) *
  2466        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2467        (CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN - 1)).
  2468
  2469     COMPUTE ODF EQUAL
  2470     ((1 + (N-P-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  2471     ((1 + (CP-ODD-DAYS-TO-PMT * 12 / 36500))).
  2472
  2473 1241-NET-PAY-CONT.
  2474
  2475     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2476
  2477*    IF CP-RETURN-CODE EQUAL '0' OR '8'
  2478     IF CP-RETURN-CODE EQUAL '0' OR '8' OR '9' OR 'B'
  2479        NEXT SENTENCE
  2480     ELSE
  2481        GO TO 9999-CALC-RATE-PREM-X.
  2482
  2483     IF RT-DISCOUNT-OPTION EQUAL '6'
  2484         GO TO 9999-CALC-RATE-PREM-X.
  2485
  2486     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2487        (CP-STATE-STD-ABBRV EQUAL 'IA')
  2488        GO TO 9999-CALC-RATE-PREM-X.
  2489
  2490     MOVE N-P-FACTOR              TO CP-CDT-FACTOR.
  2491
  2492     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  2493        GO TO 9999-CALC-RATE-PREM-X.
  2494
  2495     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2496        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2497        (CP-TRUNCATED-LIFE)
  2498        GO TO 9999-CALC-RATE-PREM-X.
  2499
  2500     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2501        (CP-CSL-VALID-NP-BENEFIT-CD)
  2502        GO TO 9999-CALC-RATE-PREM-X.
  2503
  2504     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  2505        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  2506        (CP-EARN-AS-NET-PAY)
  2507        GO TO 9999-CALC-RATE-PREM-X.
  2508
  2509*    IF (CP-COMPANY-ID EQUAL 'CID') AND
  2510*       (CP-STATE-STD-ABBRV EQUAL 'NV') AND
  2511*       (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  48
* ELRATE.cbl
  2512*       GO TO 9999-CALC-RATE-PREM-X.
  2513
  2514     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  2515        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2516        (CP-EARN-AS-NET-PAY)
  2517        GO TO 9999-CALC-RATE-PREM-X.
  2518
  2519     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2520        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  2521        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2522        GO TO 9999-CALC-RATE-PREM-X.
  2523
  2524     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2525        (CP-EARN-AS-NET-PAY)
  2526        GO TO 9999-CALC-RATE-PREM-X.
  2527
  2528     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2529        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  2530        (CP-TRUNCATED-LIFE)
  2531        GO TO 9999-CALC-RATE-PREM-X.
  2532
  2533     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2534        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  2535        (CP-EARN-AS-NET-PAY)
  2536*       (CP-TRUNCATED-LIFE)
  2537        GO TO 9999-CALC-RATE-PREM-X.
  2538
  2539     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2540        (CP-STATE-STD-ABBRV EQUAL 'RI')
  2541                   AND
  2542        ((CP-EARN-AS-NET-PAY)
  2543               OR
  2544        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  2545        GO TO 9999-CALC-RATE-PREM-X.
  2546
  2547     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2548        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  2549        (CP-EARN-AS-NET-PAY) AND
  2550        (CP-SPECIAL-CALC-CD EQUAL 'H')
  2551        GO TO 9999-CALC-RATE-PREM-X.
  2552
  2553     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2554        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  2555        (CP-EARN-AS-NET-PAY)
  2556        GO TO 9999-CALC-RATE-PREM-X.
  2557
  2558     IF CP-COMPANY-ID = 'CID' or 'AHL'
  2559        CONTINUE
  2560     ELSE
  2561        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2562           (CP-EARN-AS-NET-PAY) AND
  2563           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  2564           GO TO 9999-CALC-RATE-PREM-X
  2565        END-IF
  2566     END-IF
  2567
  2568     IF (CP-COMPANY-ID = 'CID')
  2569        AND (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  49
* ELRATE.cbl
  2570        AND (CP-STATE-STD-ABBRV = 'ME')
  2571        GO TO 9999-CALC-RATE-PREM-X
  2572     END-IF
  2573     IF (CP-COMPANY-ID = 'DCC')
  2574        AND (CP-BEN-CATEGORY = 'D')
  2575        AND (CP-EARN-AS-NET-PAY)
  2576        GO TO 9999-CALC-RATE-PREM-X
  2577     END-IF
  2578     IF (CP-COMPANY-ID = 'CID')
  2579        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2580           OR 'IN' OR 'AZ')
  2581        AND (CP-FARM-PLAN)
  2582        GO TO 9999-CALC-RATE-PREM-X
  2583     END-IF
  2584     IF (CP-COMPANY-ID = 'CID') AND
  2585        (CP-EARN-AS-NET-PAY) AND
  2586        (CP-LEVEL-LIFE) AND
  2587        (CP-STATE-STD-ABBRV = 'CA' OR 'MN') AND
  2588        (CP-STATE-STD-ABBRV = CP-STATE)
  2589        GO TO 9999-CALC-RATE-PREM-X
  2590     END-IF
  2591
  2592     IF (CP-COMPANY-ID = 'CID') AND
  2593        (CP-EARN-AS-NET-PAY) AND
  2594        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  2595                            OR 'VT')
  2596                   OR
  2597        ((CP-STATE-STD-ABBRV = 'IN') AND
  2598        (CP-CERT-EFF-DT > X'9A7F'))
  2599                   OR
  2600        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  2601        (CP-CERT-EFF-DT > X'9ADF'))) AND
  2602        (CP-STATE-STD-ABBRV = CP-STATE)
  2603        GO TO 9999-CALC-RATE-PREM-X
  2604     END-IF
  2605
  2606     IF (CP-COMPANY-ID = 'CID') AND
  2607        (CP-EARN-AS-NET-PAY) AND
  2608        (CP-STATE-STD-ABBRV = 'TX') AND
  2609        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2610        (WS-DISCOUNT-OPTION NOT = ' ')
  2611        GO TO 9999-CALC-RATE-PREM-X
  2612     END-IF
  2613
  2614     if (cp-company-id = 'CID')
  2615        and (cp-state-std-abbrv = 'WA')
  2616        and (rt-discount-option = '1')
  2617        and (cp-earn-as-farm-plan)
  2618        go to 9999-calc-rate-prem-x
  2619     end-if
  2620     if (cp-company-id = 'CID')
  2621        and (cp-earn-as-reg-balloon)
  2622        and (cp-ben-category = 'P' or 'I')
  2623        GO TO 9999-CALC-RATE-PREM-X
  2624     end-if
  2625     IF (CP-COMPANY-ID = 'CID')
  2626        AND (CP-STATE-STD-ABBRV = 'MN')
  2627        AND (RT-DISCOUNT-OPTION = '1')
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  50
* ELRATE.cbl
  2628        AND (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON OR
  2629           CP-EARN-AS-FARM-PLAN)
  2630        display ' made it to mn 4 '
  2631        GO TO 9999-CALC-RATE-PREM-X
  2632     END-IF
  2633     IF (CP-COMPANY-ID = 'CID')
  2634        AND (CP-EARN-AS-NET-PAY)
  2635        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  2636                      OR
  2637            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  2638        GO TO 9999-CALC-RATE-PREM-X
  2639     END-IF
  2640     IF (CP-COMPANY-ID = 'CID')
  2641        AND (CP-EARN-AS-NET-PAY)
  2642        AND (CP-STATE-STD-ABBRV = 'SC')
  2643        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2644        GO TO 9999-CALC-RATE-PREM-X
  2645     END-IF
  2646     IF (CP-COMPANY-ID = 'CID') AND
  2647        (CP-EARN-AS-NET-PAY) AND
  2648        (CP-TRUNCATED-LIFE) AND
  2649        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  2650        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2651        (WS-DISCOUNT-OPTION NOT = ' ')
  2652        GO TO 9999-CALC-RATE-PREM-X
  2653     END-IF
  2654
  2655     IF (CP-COMPANY-ID EQUAL 'DCC') AND
  2656        (CP-EARN-AS-NET-PAY)
  2657        MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE
  2658        GO TO 9999-CALC-RATE-PREM-X
  2659     END-IF
  2660
  2661     IF (CP-COMPANY-ID EQUAL 'CID')
  2662        AND (CP-EARN-AS-NET-PAY)
  2663        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2664        GO TO 9999-CALC-RATE-PREM-X
  2665     END-IF
  2666
  2667     IF (RT-IS-OB) AND
  2668        (CP-COMPANY-ID NOT EQUAL 'CID')
  2669        COMPUTE CP-PREMIUM-RATE ROUNDED =
  2670               (CP-PREMIUM-RATE * 12) / CP-LOAN-TERM
  2671      ELSE
  2672         IF (CP-COMPANY-ID = 'DCC')
  2673            AND (CP-RATE-DEV-PCT NOT = ZEROS)
  2674            COMPUTE CP-CALC-PREMIUM ROUNDED =
  2675*           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2676             (CP-PREMIUM-RATE * CP-RATE-DEV-PCT * 12) /
  2677               CP-ORIGINAL-TERM
  2678             MOVE CP-CALC-PREMIUM TO CP-PREMIUM-RATE
  2679             MOVE ZEROS          TO CP-RATE-DEV-PCT
  2680        ELSE
  2681           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2682               (CP-PREMIUM-RATE * 12) / CP-ORIGINAL-TERM
  2683        END-IF
  2684     END-IF
  2685
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  51
* ELRATE.cbl
  2686     IF CP-ROA-PREM-AT-REFUND
  2687         COMPUTE NET-BEN ROUNDED =
  2688             (CP-REMAINING-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000
  2689     ELSE
  2690         COMPUTE NET-BEN ROUNDED =
  2691              (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000.
  2692
  2693     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2694        (CP-TERM-OR-EXT-DAYS NOT = ZERO)
  2695          COMPUTE NET-BEN ROUNDED =
  2696              NET-BEN * (1 + (CP-LOAN-APR / 1200) *
  2697                         (CP-TERM-OR-EXT-DAYS / 30)).
  2698
  2699     IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'CID' OR 'MON' OR 'HAN'
  2700*       OR 'DCC'
  2701*    IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'MON' OR 'HAN'
  2702     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2703       (N-P-FACTOR * CP-PREMIUM-RATE * CP-ORIGINAL-TERM / 1200) /
  2704       (1 - (N-P-FACTOR * CP-PREMIUM-RATE
  2705                        * CP-ORIGINAL-TERM / 1200))
  2706     ELSE
  2707     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2708       (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200) /
  2709       (1 - (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200)).
  2710
  2711****** THE BELOW VERSION OF THE NET PAY FORMULA IS USED WHEN NO
  2712****** INTEREST IS CHARGED ON PREMIUM.
  2713
  2714*    IF CP-STATE-STD-ABBRV = 'MI'
  2715*         COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2716*          (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200).
  2717
  2718     MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE.
  2719
  2720     GO TO 9999-CALC-RATE-PREM-X.
  2721
  2722******
  2723****** BELOW ARE PREMIUM CALCULATIONS FOR CSL
  2724******
  2725
  2726 1250-CSL-CALC.
  2727     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2728     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2729     MOVE '1' TO DC-OPTION-CODE.
  2730     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2731
  2732     IF DATE-CONVERSION-ERROR
  2733         MOVE '2' TO CP-RETURN-CODE
  2734         GO TO 9999-CALC-RATE-PREM-X.
  2735
  2736     IF CP-JOINT-INDICATOR = 'J'
  2737         MOVE RT-L-RATE (3) TO WK-RED-RATE
  2738     ELSE
  2739         MOVE RT-L-RATE (1) TO WK-RED-RATE.
  2740
  2741     MOVE WK-RED-RATE TO CP-PREMIUM-RATE.
  2742     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2743
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  52
* ELRATE.cbl
  2744     IF CP-PAY-FREQUENCY = 12
  2745         MOVE 01               TO WS-PAY-SCH.
  2746     IF CP-PAY-FREQUENCY = 04
  2747         MOVE 03               TO WS-PAY-SCH.
  2748     IF CP-PAY-FREQUENCY = 02
  2749         MOVE 06               TO WS-PAY-SCH.
  2750     IF CP-PAY-FREQUENCY = 01
  2751         MOVE 12               TO WS-PAY-SCH.
  2752
  2753     COMPUTE WS-NUM-PAYMTS = CP-ORIGINAL-TERM / WS-PAY-SCH.
  2754     IF CP-PAY-FREQUENCY NOT = 12
  2755         COMPUTE WK-PAY-AMT = CP-REMAINING-BENEFIT /
  2756                                WS-NUM-PAYMTS.
  2757
  2758     IF CP-STATE = 'SC'  AND
  2759       (CP-BENEFIT-CD = '07'  OR  '08')
  2760         GO TO 1250-CSL-CALC-LIFE-6.
  2761
  2762     IF CP-CSL-METH-1
  2763         GO TO 1250-CSL-CALC-LIFE-1.
  2764
  2765     IF CP-CSL-METH-2
  2766         IF (WK-PAY-AMT * CP-LOAN-TERM) GREATER THAN
  2767                          WS-MAX-TOT-BEN
  2768             GO TO 1250-CSL-CALC-LIFE-2
  2769         ELSE
  2770             GO TO 1250-CSL-CALC-LIFE-1.
  2771
  2772     IF CP-CSL-METH-3
  2773         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2774             GO TO 1250-CSL-CALC-LIFE-2
  2775         ELSE
  2776             GO TO 1250-CSL-CALC-LIFE-3.
  2777
  2778     IF CP-CSL-METH-4
  2779         IF (WK-PAY-AMT * WS-NUM-PAYMTS) GREATER THAN
  2780                          WS-MAX-TOT-BEN
  2781             GO TO 1250-CSL-CALC-LIFE-5
  2782         ELSE
  2783             GO TO 1250-CSL-CALC-LIFE-4.
  2784
  2785 1250-CSL-CALC-LIFE-1.
  2786     IF CP-JOINT-INDICATOR = 'J'
  2787         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2788     ELSE
  2789         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2790
  2791     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY) /
  2792                    365) - 1) * 365 / 12.
  2793     COMPUTE WK-S ROUNDED = ((144 * WK-D * WK-LEV-RATE) +
  2794                    (365 * WS-NUM-PAYMTS * WK-RED-RATE)) /
  2795                    4380.
  2796     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PAY-AMT *
  2797                    WS-NUM-PAYMTS * WK-S.
  2798
  2799     GO TO 9999-CALC-RATE-PREM-X.
  2800
  2801 1250-CSL-CALC-LIFE-2.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  53
* ELRATE.cbl
  2802     IF CP-JOINT-INDICATOR = 'J'
  2803         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2804     ELSE
  2805         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2806
  2807     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2808     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2809     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2810                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2811                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2812     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2813                    WK-S) + WK-D.
  2814
  2815     GO TO 9999-CALC-RATE-PREM-X.
  2816
  2817 1250-CSL-CALC-LIFE-3.
  2818     IF CP-JOINT-INDICATOR = 'J'
  2819         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2820     ELSE
  2821         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2822
  2823     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2824     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2825     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2826                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2827                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2828     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2829                    WK-S) + WK-D.
  2830
  2831     GO TO 9999-CALC-RATE-PREM-X.
  2832
  2833 1250-CSL-CALC-LIFE-4.
  2834     IF CP-JOINT-INDICATOR = 'J'
  2835         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2836     ELSE
  2837         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2838
  2839     COMPUTE WK-D = DC-ELAPSED-DAYS * 12 / 365.
  2840     COMPUTE WK-S ROUNDED =
  2841                    (((6 * (WS-NUM-PAYMTS - 1)) + (WK-D *
  2842                    CP-PAY-FREQUENCY)) * WK-LEV-RATE) /
  2843                    CP-PAY-FREQUENCY.
  2844     COMPUTE CP-CALC-PREMIUM ROUNDED =  WK-PAY-AMT *
  2845                    WS-NUM-PAYMTS * WK-S.
  2846
  2847     GO TO 9999-CALC-RATE-PREM-X.
  2848
  2849 1250-CSL-CALC-LIFE-5.
  2850     IF CP-JOINT-INDICATOR = 'J'
  2851         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2852     ELSE
  2853         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2854
  2855     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2856     COMPUTE WK-S ROUNDED = (6 * (WK-K + 1) * WK-LEV-RATE) /
  2857                    CP-PAY-FREQUENCY.
  2858     COMPUTE WK-U = ((((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2859                    - 1) + WS-NUM-PAYMTS) * 12) /
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  54
* ELRATE.cbl
  2860                    CP-PAY-FREQUENCY.
  2861     COMPUTE WK-L = WK-U - (12 * WK-K / CP-PAY-FREQUENCY).
  2862     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-L * WK-LEV-RATE *
  2863                    WS-MAX-TOT-BEN) + (WK-K * WK-PAY-AMT * WK-S).
  2864
  2865     GO TO 9999-CALC-RATE-PREM-X.
  2866
  2867 1250-CSL-CALC-LIFE-6.
  2868
  2869     COMPUTE CP-PREMIUM-RATE ROUNDED =
  2870                (CP-PREMIUM-RATE * CP-ORIGINAL-TERM) / 12.
  2871
  2872     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2873                    CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE.
  2874
  2875     GO TO 9999-CALC-RATE-PREM-X.
  2876
  2877******
  2878****** END OF PREMIUM CALCULATIONS FOR CSL
  2879******
  2880
  2881 1260-GTL-PA-LEASE.
  2882
  2883     IF CP-REDUCING-LIFE
  2884         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2885                                 TO  CP-PREMIUM-RATE
  2886         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2887                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / +100
  2888     ELSE
  2889         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2890                                 TO  CP-PREMIUM-RATE
  2891         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2892                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE *
  2893                 (+1 + CP-SALES-TAX) / +100.
  2894
  2895     GO TO 9999-CALC-RATE-PREM-X.
  2896
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  55
* ELRATE.cbl
  2898******************************************************************
  2899 2000-TYPE-IS-AH.
  2900     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  2901
  2902     MOVE ZERO                      TO CP-R-MAX-AGE
  2903                                       CP-R-MAX-TERM
  2904                                       CP-R-MAX-MON-BEN
  2905                                       CP-R-MAX-TOT-BEN.
  2906
  2907     IF RT-POLICY-FEE NUMERIC
  2908        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  2909
  2910     IF RT-COMPOSITE-RATE NOT NUMERIC
  2911        MOVE ZEROS                          TO RT-COMPOSITE-RATE.
  2912
  2913     IF CP-ORIGINAL-TERM > ZERO AND < 361
  2914        MOVE RT-AH-RATE (CP-ORIGINAL-TERM)
  2915                                 TO CP-PREMIUM-RATE
  2916                                    WS-PREMIUM-RATE
  2917        MOVE RT-COMPOSITE-RATE   TO CP-COMPOSITE-RATE
  2918     ELSE
  2919         MOVE +0                 TO CP-PREMIUM-RATE
  2920                                    CP-CALC-PREMIUM
  2921         GO TO 9999-CALC-RATE-PREM-X
  2922     END-IF
  2923
  2924     IF (CP-COMPANY-ID = 'DCC')
  2925        AND (CP-DDF-SPEC-CALC = 'T')
  2926        AND (CP-LOAN-TERM > ZERO AND < 361)
  2927        MOVE RT-AH-RATE (CP-LOAN-TERM)
  2928                                 TO CP-PREMIUM-RATE
  2929                                    WS-PREMIUM-RATE
  2930     END-IF
  2931*    IF (CP-COMPANY-ID = 'DCC')
  2932*       AND ((CP-BENEFIT-CD (1:1) = 'P')
  2933*       OR (CP-DDF-SPEC-CALC = 'T'))
  2934*       AND (CP-LOAN-TERM > ZERO AND < 361)
  2935*       MOVE RT-AH-RATE (CP-LOAN-TERM)
  2936*                                TO CP-PREMIUM-RATE
  2937*                                   WS-PREMIUM-RATE
  2938*    END-IF
  2939     MOVE +1 TO AHNDX.
  2940
  2941     IF CP-COMPANY-ID EQUAL 'CRI'
  2942        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2943           MOVE +5               TO AHNDX
  2944           IF RT-AH-AGE (AHNDX) EQUAL ZERO
  2945              MOVE 'F'           TO CP-RETURN-CODE
  2946              GO TO 2200-CALCULATE-PREMIUMS.
  2947
  2948     IF RT-AH-AGE (AHNDX) = ZERO
  2949          GO TO 2200-CALCULATE-PREMIUMS.
  2950
  2951 2100-SEARCH-AH-LIMITS.
  2952
  2953     IF CP-COMPANY-ID EQUAL 'CRI'
  2954        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2955           IF AHNDX GREATER THAN +4
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  56
* ELRATE.cbl
  2956              MOVE 'A'             TO CP-RETURN-CODE
  2957              GO TO 2200-CALCULATE-PREMIUMS.
  2958
  2959     IF AHNDX GREATER +8
  2960         MOVE 'A'                TO CP-RETURN-CODE
  2961         GO TO 2200-CALCULATE-PREMIUMS.
  2962
  2963     IF CP-ISSUE-AGE GREATER RT-AH-AGE (AHNDX)
  2964         IF RT-AH-AGE (AHNDX) = ZEROS
  2965             ADD +1               TO AHNDX
  2966             GO TO 2100-SEARCH-AH-LIMITS
  2967         ELSE
  2968             MOVE RT-AH-AGE (AHNDX)
  2969                                 TO CP-R-MAX-AGE
  2970             MOVE RT-AH-TERM (AHNDX)
  2971                                 TO CP-R-MAX-TERM
  2972             MOVE RT-AH-BEN-M (AHNDX)
  2973                                 TO CP-R-MAX-MON-BEN
  2974             ADD +1               TO AHNDX
  2975             GO TO 2100-SEARCH-AH-LIMITS
  2976     ELSE
  2977         MOVE RT-AH-AGE  (AHNDX) TO CP-R-MAX-AGE
  2978         MOVE RT-AH-TERM (AHNDX) TO CP-R-MAX-TERM
  2979         MOVE RT-AH-BEN-M (AHNDX)
  2980                                 TO CP-R-MAX-MON-BEN.
  2981
  2982     IF CP-ORIGINAL-TERM GREATER RT-AH-TERM (AHNDX)
  2983         MOVE '9'                 TO CP-RETURN-CODE.
  2984
  2985     IF CP-ORIGINAL-BENEFIT GREATER RT-AH-BEN-M (AHNDX)
  2986         MOVE '8'                 TO CP-RETURN-CODE.
  2987
  2988     MULTIPLY CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  2989         GIVING WS-AH-FACE-BENEFIT.
  2990
  2991     IF WS-AH-FACE-BENEFIT GREATER RT-AH-BEN-F (AHNDX)
  2992         MOVE 'C'                 TO CP-RETURN-CODE.
  2993
  2994 2200-CALCULATE-PREMIUMS.
  2995
  2996     IF CP-COMPANY-ID = 'CSL'
  2997         GO TO 2250-CSL-CALC.
  2998
  2999*    IF CP-CRITICAL-PERIOD
  3000*       GO TO 2200-CRITICAL-PERIOD-AH-CONT.
  3001
  3002     IF CP-CRITICAL-PERIOD
  3003        IF (CP-COMPANY-ID = 'DCC')
  3004           AND ((CP-BENEFIT-CD (1:1) = 'N' OR 'M' OR 'H'
  3005               OR 'S' OR 'P')
  3006                          OR
  3007                (CP-BEN-CATEGORY = 'G' OR 'L'))
  3008           CONTINUE
  3009        ELSE
  3010           GO TO 2200-CRITICAL-PERIOD-AH-CONT
  3011        END-IF
  3012     END-IF
  3013
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  57
* ELRATE.cbl
  3014     IF (CP-COMPANY-ID = 'DCC')
  3015        AND (CP-BEN-CATEGORY = 'D')
  3016        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  3017           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  3018     END-IF
  3019     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  3020        COMPUTE WS-TERM-MINUS-ONE EQUAL CP-ORIGINAL-TERM - +1
  3021        MOVE RT-AH-RATE (WS-TERM-MINUS-ONE) TO
  3022                                     CP-PREMIUM-RATE
  3023        COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  3024        (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM - +1) *
  3025        CP-PREMIUM-RATE) / +100
  3026     ELSE
  3027        IF (CP-COMPANY-ID = 'DCC')
  3028           AND (CP-BEN-CATEGORY NOT = 'G' AND 'L')
  3029           MOVE CP-PREMIUM-RATE  TO WK-S
  3030*          MOVE CP-PREMIUM-RATE  TO CP-CALC-PREMIUM
  3031           IF CP-RATE-DEV-PCT NOT = ZEROS
  3032              COMPUTE WK-S ROUNDED =
  3033                 (CP-PREMIUM-RATE * CP-RATE-DEV-PCT)
  3034           END-IF
  3035           IF CP-BENEFIT-CD (1:1) = 'M'
  3036              COMPUTE CP-CALC-PREMIUM ROUNDED =
  3037              CP-ORIGINAL-BENEFIT * WK-S / 100
  3038           ELSE
  3039              IF CP-BENEFIT-CD (1:1) = 'H'
  3040                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  3041                    (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  3042                    WK-S) / 1000
  3043              ELSE
  3044                 IF CP-BENEFIT-CD (1:1) = 'N' OR 'S'
  3045                    GO TO 2300-CALC-DCC-MOB-NET-AH
  3046                 ELSE
  3047                    IF CP-BEN-CATEGORY = 'D'
  3048                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  3049                        CP-ORIGINAL-BENEFIT *
  3050                        CP-ORIGINAL-TERM * WK-S / 100
  3051                    ELSE
  3052                      IF CP-BENEFIT-CD (1:1) = 'P'
  3053                         GO TO 2300-CALC-DCC-BEN-P-AH
  3054                      ELSE
  3055                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  3056                        (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  3057                        WK-S) / 100
  3058                      END-IF
  3059                    END-IF
  3060                 END-IF
  3061              END-IF
  3062           END-IF
  3063           MOVE ZEROS            TO CP-RATE-DEV-PCT
  3064        ELSE
  3065           IF CP-BENEFIT-CD (1:1) = 'M'
  3066              COMPUTE CP-CALC-PREMIUM ROUNDED =
  3067                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 100
  3068           ELSE
  3069              IF CP-BENEFIT-CD (1:1) = 'N' OR 'H'
  3070                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  3071                    (CP-NET-BENEFIT-AMT *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  58
* ELRATE.cbl
  3072                    CP-PREMIUM-RATE) / 1000
  3073              ELSE
  3074                 IF CP-AH-BALLOON-SW = 'Y'
  3075                    COMPUTE CP-CALC-PREMIUM ROUNDED =
  3076                      (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM) *
  3077                      CP-PREMIUM-RATE) / 100
  3078                 ELSE
  3079                   COMPUTE CP-CALC-PREMIUM ROUNDED =
  3080                    (CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM *
  3081                    CP-PREMIUM-RATE) / 100
  3082                 END-IF
  3083              END-IF
  3084           END-IF
  3085        END-IF
  3086     END-IF
  3087
  3088     IF (CP-COMPANY-ID = 'DCC')
  3089        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  3090        COMPUTE CP-CALC-PREMIUM = CP-PREMIUM-RATE * +1000
  3091     END-IF
  3092     IF CP-TERM-OR-EXT-DAYS = ZEROS
  3093         GO TO 9999-CALC-RATE-PREM-X.
  3094
  3095     IF CP-EXT-CHG-AH OR CP-EXT-CHG-LF-AH
  3096         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3097             CP-CALC-PREMIUM +
  3098                 (((CP-CALC-PREMIUM / CP-ORIGINAL-TERM) / 30)
  3099                                       * CP-TERM-OR-EXT-DAYS).
  3100
  3101     GO TO 9999-CALC-RATE-PREM-X.
  3102
  3103 2200-CRITICAL-PERIOD-AH-CONT.
  3104
  3105     IF CP-COMPANY-ID = 'WDS'
  3106         IF CP-ORIGINAL-TERM GREATER THAN 60
  3107             MOVE 60              TO CP-LOAN-TERM.
  3108
  3109     IF CP-COMPANY-ID EQUAL 'CVL'
  3110         COMPUTE CP-CALC-PREMIUM ROUNDED =
  3111           ((CP-ORIGINAL-BENEFIT * CP-CRITICAL-MONTHS) / +100)
  3112                                       * CP-PREMIUM-RATE
  3113         GO TO 9999-CALC-RATE-PREM-X.
  3114
  3115     COMPUTE CP-CALC-PREMIUM ROUNDED =
  3116           ((CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM) / +100)
  3117                                       * CP-PREMIUM-RATE.
  3118
  3119     GO TO 9999-CALC-RATE-PREM-X.
  3120
  3121 2250-CSL-CALC.
  3122
  3123     IF RT-DAILY-RATE NOT NUMERIC OR
  3124        RT-DAILY-RATE = ZEROS
  3125            MOVE ZEROS TO CP-CALC-PREMIUM
  3126            MOVE '7' TO CP-RETURN-CODE
  3127            GO TO 9999-CALC-RATE-PREM-X.
  3128
  3129     COMPUTE WK-DAILY-RATE = RT-DAILY-RATE / 100.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  59
* ELRATE.cbl
  3130     COMPUTE WK-MONTHLY-RATE =
  3131          RT-AH-RATE (CP-ORIGINAL-TERM) / 100.
  3132
  3133     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3134     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  3135     MOVE '1' TO DC-OPTION-CODE.
  3136     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3137     IF DATE-CONVERSION-ERROR
  3138         MOVE '2' TO CP-RETURN-CODE
  3139         GO TO 9999-CALC-RATE-PREM-X.
  3140
  3141     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  3142     IF CP-CSL-METH-1
  3143         GO TO 2250-CSL-CALC-AH-1.
  3144     IF CP-CSL-METH-2
  3145         GO TO 2250-CSL-CALC-AH-2.
  3146     IF CP-CSL-METH-3
  3147         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  3148             GO TO 2250-CSL-CALC-AH-4
  3149         ELSE
  3150             GO TO 2250-CSL-CALC-AH-3.
  3151
  3152 2250-CSL-CALC-AH-1.
  3153
  3154     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3155     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3156                    + WK-MONTHLY-RATE.
  3157     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-MONTHLY-PAYMENT *
  3158                    CP-ORIGINAL-TERM * WK-D.
  3159
  3160     GO TO 9999-CALC-RATE-PREM-X.
  3161
  3162
  3163 2250-CSL-CALC-AH-2.
  3164     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3165     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3166                    + WK-MONTHLY-RATE.
  3167     COMPUTE CP-CALC-PREMIUM ROUNDED = WS-MAX-MON-BEN *
  3168                    CP-ORIGINAL-TERM * WK-D.
  3169
  3170     GO TO 9999-CALC-RATE-PREM-X.
  3171
  3172 2250-CSL-CALC-AH-3.
  3173
  3174     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3175     COMPUTE WK-T = WK-K + 1.
  3176     COMPUTE WK-MONTHLY-RATE-T =
  3177          RT-AH-RATE (WK-T) / 100.
  3178     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3179
  3180     COMPUTE WK-T1 = WK-K * (CP-ORIGINAL-TERM - WK-T).
  3181     IF WK-T1 EQUAL ZEROS
  3182         MOVE ZEROS TO CP-CALC-PREMIUM
  3183         MOVE 'G' TO CP-RETURN-CODE
  3184         GO TO 9999-CALC-RATE-PREM-X.
  3185
  3186     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3187                    WK-MONTHLY-RATE)) / (WK-K * (CP-ORIGINAL-TERM
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  60
* ELRATE.cbl
  3188                    - WK-T)).
  3189     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3190     COMPUTE WK-PREM = ((CP-ORIGINAL-TERM -
  3191                       (WK-K + 1) + (WK-D - 1))) * (WK-C *
  3192                       WS-MAX-TOT-BEN).
  3193     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * (WK-K + 1) *
  3194                    WK-MONTHLY-RATE-T) + WK-PREM.
  3195
  3196     GO TO 9999-CALC-RATE-PREM-X.
  3197
  3198 2250-CSL-CALC-AH-4.
  3199     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3200     COMPUTE WK-J = WS-MAX-TOT-BEN / WS-MAX-MON-BEN.
  3201     COMPUTE WK-MONTHLY-RATE-J =
  3202          RT-AH-RATE (WK-J) / 100.
  3203     COMPUTE WK-T = WK-J + 1.
  3204     COMPUTE WK-MONTHLY-RATE-T =
  3205          RT-AH-RATE (WK-T) / 100.
  3206     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3207     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3208                    WK-MONTHLY-RATE)) / ((WK-T - 1) *
  3209                    (CP-ORIGINAL-TERM - WK-T)).
  3210     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3211     COMPUTE WK-PREM = (CP-ORIGINAL-TERM -
  3212                       (WK-J + 1) + (WK-D - 1)) * (WK-C *
  3213                       WS-MAX-TOT-BEN).
  3214     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PREM + ((WK-J + 1) *
  3215                   (WS-MAX-MON-BEN * WK-MONTHLY-RATE-T)).
  3216
  3217     GO TO 9999-CALC-RATE-PREM-X.
  3218
  3219 2300-CALC-DCC-BEN-P-AH.
  3220     IF CP-NO-OF-PMTS NOT NUMERIC
  3221        MOVE +0                  TO CP-NO-OF-PMTS
  3222     END-IF
  3223     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  3224        AND ' ' AND 'M'
  3225        MOVE ' '                 TO CP-PMT-MODE
  3226     END-IF
  3227******************************************************************
  3228***   Default is monthly, use loan term for rate and amort     ***
  3229******************************************************************
  3230     move cp-loan-term         to c-tot-pmts
  3231     MOVE +30                  TO C-DAYS-IN-PMT-PER
  3232     MOVE +12                  TO C-PMTS-PER-YEAR
  3233******************************************************************
  3234
  3235     evaluate true
  3236        when cp-pmt-mode = 'W'
  3237           MOVE +52              TO C-PMTS-PER-YEAR
  3238           compute c-tot-pmts = cp-loan-term /
  3239              12 * c-pmts-per-year
  3240           MOVE +7               TO C-DAYS-IN-PMT-PER
  3241        when cp-pmt-mode = 'B'
  3242           MOVE +26              TO C-PMTS-PER-YEAR
  3243           compute c-tot-pmts = cp-loan-term /
  3244              12 * c-pmts-per-year
  3245           MOVE +14              TO C-DAYS-IN-PMT-PER
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  61
* ELRATE.cbl
  3246     end-evaluate
  3247     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3248     if i = zeros
  3249        move .0000000001         to i
  3250     end-if
  3251     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3252        C-DAYS-IN-PMT-PER)) / (1 + I)
  3253     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  3254     COMPUTE ANGLEN-1 = ANGLEN / Y
  3255     COMPUTE WK3 = (CP-NET-BENEFIT-AMT - CP-ORIGINAL-PREMIUM)
  3256        / ANGLEN-1
  3257     if cp-net-benefit-amt = zeros
  3258        compute wk3 = cp-original-benefit - cp-original-premium
  3259     end-if
  3260     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * WK-S
  3261     GO TO 9999-CALC-RATE-PREM-X
  3262     .
  3263 2300-CALC-DCC-MOB-NET-AH.
  3264     IF CP-ALTERNATE-BENEFIT = ZEROS
  3265        CONTINUE
  3266     ELSE
  3267        GO TO 2300-CALC-DCC-MOB-BAL-AH
  3268     END-IF
  3269     MOVE CP-ORIGINAL-TERM       TO M
  3270     MOVE CP-LOAN-TERM           TO N
  3271     IF N = ZEROS
  3272        MOVE M                   TO N
  3273     END-IF
  3274     COMPUTE I = CP-LOAN-APR / +1200
  3275     if i = zeros
  3276        move .0000000001         to i
  3277     end-if
  3278     IF CP-BENEFIT-CD (1:1) = 'S'
  3279        COMPUTE OD = CP-DAYS-TO-1ST-PMT - 30
  3280        COMPUTE WK3 = CP-ORIGINAL-BENEFIT *
  3281        ((M * (M + 1) / 2) + (M * OD / 30)) *
  3282          (WK-S / 1000)
  3283          * 1
  3284        MOVE WK3                 TO CP-CALC-PREMIUM
  3285        GO TO 9999-CALC-RATE-PREM-X
  3286     END-IF
  3287     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3288        / (1 + I)
  3289     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3290          ** ((N - M) * -1))) / I)
  3291     COMPUTE ANGLEN-M = ANGLEN-M / OD
  3292     COMPUTE J = I + (WK-S / +1000)
  3293     COMPUTE WK2 = (1 + J) ** (M * -1)
  3294     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3295     COMPUTE ANGLEM = ((1 - ((1 + J)
  3296          ** (M * -1))) / J) / OD
  3297     IF CP-NET-BENEFIT-AMT = ZEROS
  3298        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3299           * ANGLEM
  3300     END-IF
  3301     COMPUTE RA = CP-NET-BENEFIT-AMT / (ANGLEM + ANGLEN-M)
  3302     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3303          ** ((N - M) * -1))) / I)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  62
* ELRATE.cbl
  3304     MOVE +0                     TO WK3
  3305     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3306        (WS-COUNTER > M)
  3307        COMPUTE ANGLEM = (1 - ((1 + J)
  3308          ** ((M - WS-COUNTER + 1) * -1))) / J
  3309        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  3310        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  3311        COMPUTE WK3 = WK3 + (WK5-CSL * WK-S / +1000)
  3312     END-PERFORM
  3313     MOVE WK3                    TO CP-CALC-PREMIUM
  3314     GO TO 9999-CALC-RATE-PREM-X
  3315     .
  3316 2300-CALC-DCC-MOB-BAL-AH.
  3317     IF CP-BENEFIT-CD (1:1) = 'S'
  3318        GO TO 2300-CALC-DCC-MOB-BAL-AHSUM
  3319     END-IF
  3320     MOVE CP-ORIGINAL-TERM       TO M
  3321     MOVE CP-LOAN-TERM           TO N
  3322     IF N = ZEROS
  3323        MOVE M                   TO N
  3324     END-IF
  3325     COMPUTE I = CP-LOAN-APR / +1200
  3326     if i = zeros
  3327        move .0000000001         to i
  3328     end-if
  3329     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3330        / (1 + I)
  3331     COMPUTE ANGLEN-M = (WK5 / I) / OD
  3332     COMPUTE J = I + (WK-S / +1000)
  3333     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  3334     MOVE I TO K
  3335     COMPUTE WK2 = (1 + J) ** (M * -1)
  3336     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3337     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  3338          ** ((M - 1) * -1))) / J)
  3339     COMPUTE ANGLEM = ((1 - ((1 + J)
  3340          ** (M * -1))) / J) / OD
  3341     IF CP-NET-BENEFIT-AMT = ZEROS
  3342        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3343           * ANGLEM
  3344     END-IF
  3345     COMPUTE RA = (CP-NET-BENEFIT-AMT * OD -
  3346        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  3347        / ANGLEM-1
  3348     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3349          ** ((N - M) * -1))) / I)
  3350     MOVE +0                     TO WK3
  3351     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3352        (WS-COUNTER > M)
  3353        COMPUTE ANGLEM = (1 - ((1 + J)
  3354          ** ((M - WS-COUNTER) * -1))) / J
  3355        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  3356        COMPUTE WK5-CSL = (RA * ANGLEM)
  3357        + (CP-ALTERNATE-BENEFIT * WK2)
  3358        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  3359          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  3360          (WK-S / 1000)
  3361     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  63
* ELRATE.cbl
  3362     MOVE WK3                    TO CP-CALC-PREMIUM
  3363     GO TO 9999-CALC-RATE-PREM-X
  3364     .
  3365 2300-CALC-DCC-MOB-BAL-AHSUM.
  3366     MOVE CP-ORIGINAL-TERM       TO M
  3367     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3368        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  3369        * WK-S / 1000
  3370*    COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3371*       + (M - 1) * ((CP-TERM-OR-EXT-DAYS + 30) - 30) / 30)
  3372*       * WK-S / 1000
  3373     MOVE WK3                    TO CP-CALC-PREMIUM
  3374     GO TO 9999-CALC-RATE-PREM-X
  3375     .
  3376 9999-RATE-NOTFND.
  3377     MOVE '6'                    TO CP-RETURN-CODE.
  3378     GO TO 9999-CALC-RATE-PREM-X.
  3379
  3380 9999-RATE-NOTOPEN.
  3381     MOVE 'D'                    TO CP-RETURN-CODE.
  3382     GO TO 9999-CALC-RATE-PREM-X.
  3383
  3384 9999-CALC-RATE-PREM-X.
  3385     IF (CP-COMPANY-ID = 'DCC')
  3386        AND (CP-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
  3387        CONTINUE
  3388     ELSE
  3389        IF CP-RATE-DEV-PCT NOT = ZERO
  3390           COMPUTE CP-CALC-PREMIUM =
  3391              CP-CALC-PREMIUM * CP-RATE-DEV-PCT.
  3392
  3393
  3394     MOVE CALCULATION-PASS-AREA  TO  DFHCOMMAREA.
  3395
  3396     IF WS-BROWSE-STARTED
  3397
  3398* EXEC CICS ENDBR
  3399*            DATASET  (ERRATE-FILE-ID)
  3400*       END-EXEC.
  3401     MOVE 0
  3402       TO DFHEIV11
  3403*    MOVE '&2                    $   #00003350' TO DFHEIV0
  3404     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3405     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3406     MOVE X'2020233030303033333530' TO DFHEIV0(25:11)
  3407     CALL 'kxdfhei1' USING DFHEIV0,
  3408           ERRATE-FILE-ID,
  3409           DFHEIV11,
  3410           DFHEIV99
  3411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3412
  3413
  3414
  3415* EXEC CICS RETURN
  3416*    END-EXEC.
  3417*    MOVE '.(                    ''   #00003354' TO DFHEIV0
  3418     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3419     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  64
* ELRATE.cbl
  3420     MOVE X'2020233030303033333534' TO DFHEIV0(25:11)
  3421     CALL 'kxdfhei1' USING DFHEIV0,
  3422           DFHEIV99,
  3423           DFHEIV99,
  3424           DFHEIV99,
  3425           DFHEIV99,
  3426           DFHEIV99,
  3427           DFHEIV99
  3428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3429
  3430
  3431 9100-CONVERT-DATE.
  3432
  3433* EXEC CICS LINK
  3434*        PROGRAM  ('ELDATCV')
  3435*        COMMAREA (DATE-CONVERSION-DATA)
  3436*        LENGTH   (DC-COMM-LENGTH)
  3437*    END-EXEC.
  3438     MOVE 'ELDATCV' TO DFHEIV1
  3439*    MOVE '."C                   (   #00003358' TO DFHEIV0
  3440     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3441     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3442     MOVE X'2020233030303033333538' TO DFHEIV0(25:11)
  3443     CALL 'kxdfhei1' USING DFHEIV0,
  3444           DFHEIV1,
  3445           DATE-CONVERSION-DATA,
  3446           DC-COMM-LENGTH,
  3447           DFHEIV99,
  3448           DFHEIV99,
  3449           DFHEIV99,
  3450           DFHEIV99
  3451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3452
  3453
  3454 9100-EXIT.
  3455     EXIT.
  3456
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  65
* ELRATE.cbl
  3458 10000-NET-TERM SECTION.
  3459*                         COPY ERCNETP.
  3460*****************************************************************
  3461*                                                               *
  3462*                            ERCNETP                            *
  3463*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3464*                            VMOD=2.029                         *
  3465*                                                               *
  3466*****************************************************************.
  3467*
  3468*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  3469*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  3470*                                   ORIGINAL TERM (S999)
  3471*                                   REMAINING TERM (S999)
  3472*                                   NET PAY OPTION (X)
  3473*                                   LOAN TERM (S999)
  3474*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  3475*
  3476*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  3477*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  3478*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  3479*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  3480*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  3481*    CHARGED.
  3482*
  3483*    OPTIONS - S = NET SIMPLE
  3484*          SPACE = NET PAY  (1 MO. INTEREST)
  3485*              A = NET PAY  (0 MO. INTEREST)
  3486*              I = NET PAY  (2 MO. INTEREST)
  3487*              J = NET PAY  (3 MO. INTEREST)
  3488*              K = NET PAY  (4 MO. INTEREST)
  3489*              T = TRUNCATED  (0 MO. INTEREST)
  3490*              U = TRUNCATED  (1 MO. INTEREST)
  3491*              V = TRUNCATED  (2 MO. INTEREST)
  3492*              W = TRUNCATED  (3 MO. INTEREST)
  3493*              X = TRUNCATED  (4 MO. INTEREST)
  3494*              R = REFUNDS (REGULAR OR TRUNCATED)
  3495******************************************************************
  3496*                   C H A N G E   L O G
  3497*
  3498* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3499*-----------------------------------------------------------------
  3500*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3501* EFFECTIVE    NUMBER
  3502*-----------------------------------------------------------------
  3503* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  3504* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  3505* 120403                   PEMA  ADD SPECIAL TX CALC
  3506* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3507* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3508* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  3509* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  3510* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  3511* 021207                   PEMA  ADD PA NP
  3512* 022107                   PEMA  ADD NH NP AND NP TRUNC
  3513* 032807                   PEMA  ADD VT NP PLUS 2
  3514* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  3515* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  66
* ELRATE.cbl
  3516* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  3517* 110207      TO 'AL' NET PAY CALC
  3518* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  3519* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  3520* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  3521* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  3522* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  3523* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  3524* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  3525* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3526* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  3527* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3528* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  3529* 032612  CR2011110200001  PEMA  AHL CHANGES
  3530* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  3531* 022613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  3532* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  3533* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  3534* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS FOR NET BALLOON
  3535******************************************************************
  3536
  3537     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  3538     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  3539     MOVE N-P-LOAN    TO LOAN-TERM.
  3540     MOVE N-P-REM     TO REMAINING-TERM.
  3541     MOVE N-P-OPT     TO OPTION-SW.
  3542
  3543     MOVE +0 TO FACTOR.
  3544     if cp-company-id = 'CID'
  3545        if annual-int-rate = +99.9999
  3546           go to 99000-error
  3547        end-if
  3548     else
  3549        if annual-int-rate = zero
  3550           go to 99000-error
  3551        end-if
  3552     end-if
  3553     IF ORIGINAL-TERM = ZERO
  3554         GO TO 99999-RETURN.
  3555     IF REMAINING-TERM = ZERO
  3556         GO TO 99999-RETURN.
  3557     IF REMAINING-TERM GREATER ORIGINAL-TERM
  3558         GO TO 99000-ERROR.
  3559     IF LOAN-TERM = ZERO
  3560         GO TO 99999-RETURN.
  3561     IF LOAN-TERM LESS ORIGINAL-TERM
  3562         GO TO 99000-ERROR.
  3563
  3564*    IF ANNUAL-INT-RATE LESS +2
  3565*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3566*    IF ANNUAL-INT-RATE LESS +2
  3567*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3568*    IF ANNUAL-INT-RATE LESS +2
  3569*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3570
  3571     IF NPO-REFUND
  3572         MOVE '2' TO NP-PROCESS-SW
  3573       ELSE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  67
* ELRATE.cbl
  3574         IF ORIGINAL-TERM = REMAINING-TERM
  3575            MOVE '1'   TO NP-PROCESS-SW
  3576           ELSE
  3577            MOVE '3'   TO NP-PROCESS-SW.
  3578
  3579     IF NPO-SIMPLE
  3580         MOVE 'S' TO TYPE-SW
  3581     ELSE
  3582         MOVE 'N' TO TYPE-SW.
  3583
  3584     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  3585     if i = zeros
  3586        move .0000000001         to i
  3587     end-if
  3588
  3589     COMPUTE V ROUNDED = K1 / (K1 + I).
  3590
  3591     MOVE V     TO VX
  3592                   SV.
  3593
  3594     MOVE +1    TO X1
  3595                   SX.
  3596
  3597     MOVE LOAN-TERM TO MAX-X.
  3598
  3599     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  3600
  3601     IF MAX-X = +1
  3602        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  3603
  3604     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  3605
  3606     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  3607         OR 'DCC'        OR 'NCL') AND
  3608        (NOT NP-REFUND)
  3609        NEXT SENTENCE
  3610     ELSE
  3611     IF LOAN-TERM NOT = ORIGINAL-TERM
  3612        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  3613
  3614     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  3615
  3616 10500-VX-LOOP.
  3617
  3618***  VX = AMORT. LOAN TERM.
  3619***  SV = AMORT. INSURANCE TERM.
  3620***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  3621***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  3622***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  3623
  3624     IF X2 = 1
  3625        MOVE V         TO SX
  3626     END-IF
  3627     COMPUTE VX ROUNDED = VX * V.
  3628
  3629     ADD B1 TO X1.
  3630
  3631     IF X1 = REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  68
* ELRATE.cbl
  3632          MOVE VX    TO SV.
  3633
  3634     IF X1 EQUAL SV-MINUS-ONE
  3635        MOVE VX      TO SV-MINUS-ONE.
  3636
  3637     IF X1 = X2
  3638          MOVE VX    TO SX.
  3639
  3640     IF X1 NOT = MAX-X
  3641          GO TO 10500-VX-LOOP.
  3642
  3643 10700-COMPUTE-REMAINING-FACTOR.
  3644*****  WK1 = LOAN TERM AMORT
  3645     COMPUTE WK1 = K1 - VX.
  3646*****  WK2 = INS TERM AMORT
  3647     COMPUTE WK2 = K1 - SV.
  3648*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  3649     COMPUTE WK5 = K1 - SX.
  3650*****  WK6 = INS TERM - 1
  3651     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  3652
  3653     IF NP-RATING
  3654         GO TO 12000-PREMIUM-RATE.
  3655
  3656     IF NP-REFUND
  3657         GO TO 11000-REFUND-CALC.
  3658
  3659     IF NET-STD
  3660         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  3661
  3662     IF NET-SMP
  3663         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  3664         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  3665         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  3666         COMPUTE WK3 ROUNDED = WK3 * 1000.
  3667
  3668     IF REMAINING-TERM LESS THAN X2
  3669         MOVE +0 TO WK3.
  3670
  3671     MOVE WK3 TO FACTOR.
  3672
  3673     GO TO 99999-RETURN.
  3674
  3675 11000-REFUND-CALC.
  3676     IF REMAINING-TERM NOT LESS MAX-X
  3677        MOVE +1 TO FACTOR
  3678        GO TO 99999-RETURN.
  3679
  3680     IF REMAINING-TERM LESS +1
  3681        MOVE 0 TO FACTOR
  3682        GO TO 99999-RETURN.
  3683
  3684     COMPUTE WK2 ROUNDED = WK2 / I.
  3685     COMPUTE WK5 ROUNDED = WK5 / I.
  3686     COMPUTE WK1 ROUNDED = WK1 / I.
  3687
  3688     IF (CP-COMPANY-ID EQUAL 'CID')
  3689        AND (CP-STATE-STD-ABBRV = 'MN')
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  69
* ELRATE.cbl
  3690        AND (CP-CERT-EFF-DT > X'A4FF')
  3691        AND (CP-RATE-AS-REG-BALLOON)
  3692        AND (CP-EARN-AS-NET-PAY)
  3693        AND (CP-DEVIATION-CODE NOT = 'LEV')
  3694        CONTINUE
  3695     ELSE
  3696        GO TO 11000-CHECK-MN-LEV-BALLOON
  3697     END-IF
  3698
  3699     COMPUTE R = M - E
  3700     COMPUTE FACTOR = (R - WK2 + WK5) /
  3701        (M - WK1 + WK5)
  3702
  3703     GO TO 99999-RETURN
  3704
  3705      .
  3706 11000-CHECK-MN-LEV-BALLOON.
  3707
  3708     IF (CP-COMPANY-ID EQUAL 'CID')
  3709        AND (CP-STATE-STD-ABBRV = 'MN')
  3710        AND (CP-CERT-EFF-DT > X'A4FF')
  3711        AND (CP-RATE-AS-REG-BALLOON)
  3712        AND (CP-EARN-AS-NET-PAY)
  3713        AND (CP-DEVIATION-CODE = 'LEV')
  3714        CONTINUE
  3715     ELSE
  3716        GO TO 11000-CONTINUE-REFUND
  3717     END-IF
  3718
  3719     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3720     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  3721        ** (M - E)) / I
  3722
  3723     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  3724
  3725     GO TO 99999-RETURN
  3726
  3727     .
  3728 11000-CONTINUE-REFUND.
  3729*    IF CP-GAP-ACTUARIAL
  3730*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  3731*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3732*       COMPUTE WK3 = WK2 / ANGLEN
  3733*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  3734     IF CP-GAP-ACTUARIAL
  3735        COMPUTE ANGLEN = WK1 / ((1 + I) **
  3736           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3737        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  3738     ELSE
  3739        COMPUTE WK3 ROUNDED =
  3740          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  3741     END-IF
  3742
  3743     MOVE WK3  TO FACTOR.
  3744
  3745     GO TO 99999-RETURN.
  3746
  3747 12000-PREMIUM-RATE.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  70
* ELRATE.cbl
  3748*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  3749*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  3750*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  3751*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  3752*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  3753*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  3754
  3755     COMPUTE K-I = K1 + I.
  3756     MOVE K-I TO ONE-PLUS-I.
  3757
  3758     IF NPO-ALT OR NPO-TRUNC-0
  3759         MOVE K1 TO K-I.
  3760
  3761     IF NPO-2MO OR NPO-TRUNC-2
  3762         COMPUTE K-I = K1 + (2 * I).
  3763
  3764     IF NPO-3MO OR NPO-TRUNC-3
  3765         COMPUTE K-I = K1 + (3 * I).
  3766
  3767     IF NPO-4MO OR NPO-TRUNC-4
  3768         COMPUTE K-I = K1 + (4 * I).
  3769
  3770     COMPUTE RA ROUNDED = 1 -
  3771             ((X2 * (X2 + 1)) /
  3772              (N *  (N  + 1))).
  3773
  3774     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  3775        (CP-CSL-VALID-NP-BENEFIT-CD)
  3776        NEXT SENTENCE
  3777     ELSE
  3778        GO TO XXXX-CHECK-DISCOUNT-5.
  3779
  3780     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3781     MOVE ' ' TO DC-OPTION-CODE.
  3782     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3783
  3784     IF DATE-CONVERSION-ERROR
  3785        MOVE '2'                 TO CP-RETURN-CODE
  3786        MOVE ZEROS               TO FACTOR
  3787                                    CP-CALC-PREMIUM
  3788         GO TO 99999-RETURN.
  3789
  3790     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  3791     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  3792     MOVE ' ' TO DC-OPTION-CODE
  3793     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3794
  3795     IF DATE-CONVERSION-ERROR
  3796        MOVE '2'                 TO CP-RETURN-CODE
  3797        MOVE ZEROS               TO FACTOR
  3798                                    CP-CALC-PREMIUM
  3799         GO TO 99999-RETURN.
  3800
  3801     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
  3802
  3803     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  3804
  3805     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  71
* ELRATE.cbl
  3806        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  3807        CP-PAY-FREQUENCY / 365) * I
  3808     ELSE
  3809        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  3810        CP-PAY-FREQUENCY / 365) * I.
  3811
  3812     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  3813     13).
  3814
  3815     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  3816     (N - ( ANGLEN-1 / WK3)).
  3817
  3818     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  3819
  3820     COMPUTE WS-CALC-FREQ-RATE EQUAL
  3821       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  3822
  3823     COMPUTE WS-Y-X-FACTOR EQUAL
  3824       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  3825       WS-CALC-FREQ-RATE).
  3826
  3827     COMPUTE WS-ODD-DAY-UNITS EQUAL
  3828       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  3829
  3830     COMPUTE WS-X-Y-FACTOR EQUAL
  3831       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  3832
  3833     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  3834       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  3835       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  3836
  3837     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  3838
  3839     GO TO 99999-RETURN.
  3840
  3841 XXXX-CHECK-DISCOUNT-5.
  3842
  3843     IF WS-DISCOUNT-OPTION EQUAL '5'
  3844        NEXT SENTENCE
  3845     ELSE
  3846        GO TO 12000-CHECK-CLIENT.
  3847
  3848      COMPUTE ANGLEN EQUAL WK1 / I.
  3849
  3850      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3851
  3852      COMPUTE WK3 EQUAL
  3853        (12 *
  3854        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  3855        CP-ORIGINAL-BENEFIT)) /
  3856        APR100.
  3857
  3858     COMPUTE WK3 EQUAL
  3859        (WK3 * CP-PREMIUM-RATE) / +1000.
  3860
  3861     COMPUTE WK3 EQUAL
  3862        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  3863
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  72
* ELRATE.cbl
  3864      MOVE WK3 TO CP-CALC-PREMIUM.
  3865
  3866     GO TO 99999-RETURN.
  3867
  3868 12000-CHECK-CLIENT.
  3869
  3870     IF (CP-COMPANY-ID EQUAL 'MON') AND
  3871        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3872        (CP-TRUNCATED-LIFE)
  3873        NEXT SENTENCE
  3874     ELSE
  3875        GO TO 12000-CHECK-NEXT.
  3876
  3877     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3878
  3879     COMPUTE ANGLEN EQUAL WK1 / I.
  3880     COMPUTE ANGLEM EQUAL WK2 / I.
  3881
  3882     COMPUTE FM EQUAL
  3883                    (((ONE-PLUS-I ** M) * I * M) /
  3884                    ((ONE-PLUS-I ** M) - 1))
  3885                    - 1.
  3886
  3887     COMPUTE FN EQUAL
  3888                    (((ONE-PLUS-I ** N) * I * N) /
  3889                    ((ONE-PLUS-I ** N) - 1))
  3890                    - 1.
  3891
  3892     COMPUTE FNM EQUAL
  3893                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  3894                    ((ONE-PLUS-I ** (N - M)) - 1))
  3895                    - 1.
  3896
  3897     COMPUTE GR EQUAL
  3898                    (WS-WORK-RATE * ANGLEM * I) /
  3899                    (M - ANGLEM).
  3900
  3901     COMPUTE ODF EQUAL
  3902                     (1 +
  3903                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  3904                     360)) /
  3905                     ONE-PLUS-I.
  3906
  3907     COMPUTE OD EQUAL
  3908                    (1 + (ODF * (FN / I - 1))) +
  3909                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  3910
  3911     COMPUTE WK3 EQUAL
  3912*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  3913                    ((1 + FN) * ODF *
  3914                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  3915                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  3916                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  3917
  3918     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  3919     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  3920
  3921     COMPUTE WK3 EQUAL
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  73
* ELRATE.cbl
  3922                    (WK3 / (ODF * (1 + FN))) -
  3923*                   CP-ORIGINAL-BENEFIT.
  3924                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  3925
  3926      MOVE WK3 TO CP-CALC-PREMIUM.
  3927
  3928     GO TO 99999-RETURN.
  3929
  3930 12000-CHECK-NEXT.
  3931
  3932     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  3933        NEXT SENTENCE
  3934     ELSE
  3935        GO TO 12000-CHECK-PA-TRUNC.
  3936
  3937      IF WS-WORK-DIS-RATE EQUAL +0
  3938         MOVE '7'                TO CP-RETURN-CODE
  3939         MOVE ZEROS              TO FACTOR
  3940                                    CP-CALC-PREMIUM
  3941         GO TO 99999-RETURN.
  3942
  3943      COMPUTE ANGLEN EQUAL WK1 / I.
  3944
  3945      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3946
  3947      IF WS-WORK-DIS-RATE EQUAL APR100
  3948         ADD .00001 TO APR100.
  3949
  3950      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  3951      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  3952
  3953     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3954        / (1 + I)
  3955     COMPUTE ANGLEN-1 = ANGLEN / Y
  3956      IF CP-COMPANY-ID EQUAL 'CDL'
  3957         COMPUTE WK3 EQUAL
  3958
  3959          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  3960          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  3961
  3962          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3963
  3964          ((WK8 ** N) /
  3965          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3966
  3967          ((WK9 ** N) /
  3968          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  3969
  3970      ELSE
  3971         COMPUTE WK3 EQUAL
  3972
  3973          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  3974          (12 + WS-WORK-DIS-RATE) * 12) *
  3975
  3976          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3977
  3978          ((WK8 ** N) /
  3979          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  74
* ELRATE.cbl
  3980
  3981          ((WK9 ** N) /
  3982          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  3983
  3984      COMPUTE WK3 EQUAL
  3985          (WK3 * CP-PREMIUM-RATE) / +1000.
  3986
  3987      MOVE WK3 TO CP-CALC-PREMIUM.
  3988
  3989     GO TO 99999-RETURN.
  3990
  3991 12000-CHECK-PA-TRUNC.
  3992
  3993     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3994        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
  3995        (CP-EARN-AS-NET-PAY) AND
  3996        (CP-TRUNCATED-LIFE)
  3997        NEXT SENTENCE
  3998     ELSE
  3999        GO TO 12000-CHECK-MD-TRUNC.
  4000
  4001     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4002
  4003     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4004     COMPUTE ANGLEN EQUAL WK1 / I.
  4005
  4006     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4007
  4008     COMPUTE WK3 EQUAL
  4009        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  4010        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  4011
  4012     MOVE WK3 TO CP-CALC-PREMIUM.
  4013
  4014     GO TO 99999-RETURN.
  4015
  4016 12000-CHECK-MD-TRUNC.
  4017
  4018     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4019        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  4020        (CP-EARN-AS-NET-PAY) AND
  4021        (CP-TRUNCATED-LIFE)
  4022        NEXT SENTENCE
  4023     ELSE
  4024        GO TO 12000-CHECK-MD.
  4025
  4026     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4027
  4028     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4029     COMPUTE ANGLEM EQUAL WK2 / I.
  4030     COMPUTE ANGLEN EQUAL WK1 / I.
  4031
  4032     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4033
  4034     COMPUTE WK3 EQUAL
  4035        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  4036        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  4037        (ANGLEN-1 * (M - ANGLEM))).
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  75
* ELRATE.cbl
  4038
  4039     MOVE WK3 TO CP-CALC-PREMIUM.
  4040
  4041     GO TO 99999-RETURN.
  4042
  4043 12000-CHECK-MD.
  4044
  4045     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4046        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  4047        (CP-EARN-AS-NET-PAY)
  4048        NEXT SENTENCE
  4049     ELSE
  4050        GO TO 12000-CHECK-ME-TRUNC.
  4051
  4052     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  4053
  4054     COMPUTE WK3 EQUAL
  4055        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  4056
  4057     MOVE WK3 TO CP-CALC-PREMIUM.
  4058
  4059     GO TO 99999-RETURN.
  4060
  4061 12000-CHECK-ME-TRUNC.
  4062
  4063     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  4064        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4065        AND (CP-EARN-AS-NET-PAY)
  4066        AND (CP-TRUNCATED-LIFE)
  4067        CONTINUE
  4068     ELSE
  4069        GO TO 12000-CHECK-CID-WA-FARMPLAN
  4070     END-IF
  4071
  4072     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4073     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4074     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4075     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4076     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4077     COMPUTE ANGLEN-1 = ANGLEN / Y
  4078     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4079     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4080     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  4081     COMPUTE WK3
  4082        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  4083        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  4084            * (1 / (1.0635 ** (M / 12))))
  4085*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  4086*    COMPUTE WK9 EQUAL
  4087*       1 / (1 + (.045 * (N - M) / 24))
  4088*    COMPUTE WK7 EQUAL
  4089*       WS-WORK-RATE * 20 / (M + 1).
  4090*    COMPUTE WK3 EQUAL
  4091*       ((( N - ANGLEN) * WK7 * WK8) /
  4092*       (10 * ANGLEN-1 * I)) -
  4093*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  4094*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  4095*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  76
* ELRATE.cbl
  4096*
  4097     MOVE WK3 TO CP-CALC-PREMIUM.
  4098
  4099     GO TO 99999-RETURN
  4100      .
  4101 12000-CHECK-CID-WA-FARMPLAN.
  4102
  4103     IF (CP-COMPANY-ID EQUAL 'CID')
  4104        AND (CP-STATE-STD-ABBRV = 'WA')
  4105        AND (CP-FARM-PLAN)
  4106        CONTINUE
  4107     ELSE
  4108        GO TO 12000-CHECK-CID-FARMPLAN
  4109     END-IF
  4110**  This was removed due to IR 2015022300001
  4111    GO TO 12000-CHECK-CID-FARMPLAN
  4112
  4113     move cp-original-term       to n
  4114     move cp-no-of-pmts          TO C-TOT-PMTS
  4115     compute c-pmts-per-year = 12 / cp-pay-frequency
  4116     move cp-pay-frequency       to m
  4117     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  4118     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4119     if i = zeros
  4120        move .0000000001         to i
  4121     end-if
  4122     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  4123
  4124     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  4125        (m * 30))) / (1 + I)
  4126     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4127        ** CP-PAY-FREQUENCY) - 1
  4128     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  4129     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4130        ** TI) / WS-WORK-DIS-RATE
  4131     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  4132     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  4133     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4134        ** m) / WS-WORK-DIS-RATE
  4135     COMPUTE WK2 = WK2 * (1 + J)
  4136     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4137     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4138     COMPUTE WK3 = WK3 * (1 + J)
  4139     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  4140        ** (c-tot-pmts - 1))) / J
  4141     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4142        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  4143        (CP-PREMIUM-RATE / 1000)
  4144     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  4145     COMPUTE WK6 = (WK7 * GR)
  4146
  4147     MOVE WK6 TO CP-CALC-PREMIUM
  4148
  4149     GO TO 99999-RETURN
  4150
  4151     .
  4152 12000-CHECK-CID-FARMPLAN.
  4153     IF (CP-COMPANY-ID EQUAL 'CID')
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  77
* ELRATE.cbl
  4154        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  4155           OR 'IN' OR 'AZ')
  4156        AND (CP-FARM-PLAN)
  4157        CONTINUE
  4158     ELSE
  4159        GO TO 12000-CHECK-SC-CID
  4160     END-IF
  4161     COMPUTE N = M / CP-PAY-FREQUENCY
  4162     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4163     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  4164        ** CP-PAY-FREQUENCY) - 1
  4165     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  4166     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4167        ** TI) / WS-WORK-DIS-RATE
  4168     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  4169     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  4170     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  4171        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  4172     COMPUTE WK2 = WK2 * (1 + J)
  4173     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  4174     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  4175     COMPUTE WK3 = WK3 * (1 + J)
  4176     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  4177        ** (N - 1))) / J
  4178     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  4179        ((N * WK2) - WK5)) + (N * WK1)) *
  4180        (CP-PREMIUM-RATE / 1000)
  4181     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  4182     COMPUTE WK6 = (WK7 * GR)
  4183     MOVE WK6 TO CP-CALC-PREMIUM
  4184     GO TO 99999-RETURN
  4185     .
  4186 12000-CHECK-SC-CID.
  4187     IF (CP-COMPANY-ID = 'CID')
  4188        AND (CP-STATE-STD-ABBRV = 'SC')
  4189        AND (CP-EARN-AS-NET-PAY)
  4190        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  4191        move 6                   to ws-extra-pmts
  4192     ELSE
  4193        GO TO 12000-CHECK-AL-CID
  4194     END-IF
  4195     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4196     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4197     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4198        / 12)) / ((M + 1) / 2)
  4199
  4200     if i = .0000000001
  4201        compute wk4 = cp-original-benefit / n
  4202        compute wk3 = wk4 * (((n * (n + 1)) / 2 - ((n - m) *
  4203            (n - m + 1)) / 2 + ws-extra-pmts * m) * wk2 / 100)
  4204        display ' hit sc wo apr - wk2 ' wk2
  4205     else
  4206        COMPUTE ANGLEN rounded = (1 - (1 / (1 + I)) ** N) / I
  4207        COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4208        COMPUTE ANGLEN-1 = ANGLEN / Y
  4209        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4210        COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4211           + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  78
* ELRATE.cbl
  4212     end-if
  4213*    COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4214*    COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4215*    COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4216*    COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4217*    COMPUTE ANGLEN-1 = ANGLEN / Y
  4218*    COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  4219*       / 12)) / ((M + 1) / 2)
  4220*    COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4221*    COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  4222*       + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  4223     MOVE WK3 TO CP-CALC-PREMIUM
  4224     GO TO 99999-RETURN
  4225     .
  4226 12000-CHECK-AL-CID.
  4227     IF (CP-COMPANY-ID EQUAL 'CID')
  4228        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  4229        AND (CP-EARN-AS-NET-PAY)
  4230        CONTINUE
  4231     ELSE
  4232        GO TO 12000-CHECK-NH-CID
  4233     END-IF
  4234     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4235     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4236     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4237     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4238                   / (1 + I)
  4239     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4240     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4241     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  4242        (CP-PREMIUM-RATE / 1000)
  4243     MOVE WK3 TO CP-CALC-PREMIUM
  4244     GO TO 99999-RETURN
  4245     .
  4246 12000-CHECK-NH-CID.
  4247     IF (CP-COMPANY-ID EQUAL 'CID')
  4248        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  4249        AND (CP-EARN-AS-NET-PAY)
  4250        CONTINUE
  4251     ELSE
  4252        GO TO 12000-CHECK-PA-CID
  4253     END-IF
  4254     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4255     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4256     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4257                   / (1 + I)
  4258     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4259     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4260     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4261        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  4262     MOVE WK3 TO CP-CALC-PREMIUM
  4263     GO TO 99999-RETURN
  4264     .
  4265 12000-CHECK-PA-CID.
  4266     IF (CP-COMPANY-ID EQUAL 'CID')
  4267        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  4268        AND (CP-EARN-AS-NET-PAY)
  4269        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  79
* ELRATE.cbl
  4270     ELSE
  4271        GO TO 12000-CHECK-ME-CID
  4272     END-IF
  4273
  4274     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4275     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4276     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4277     COMPUTE ANGLEN-1 = ANGLEN / Y
  4278     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  4279     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4280     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  4281     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4282        * WK5
  4283     MOVE WK3 TO CP-CALC-PREMIUM
  4284     GO TO 99999-RETURN
  4285     .
  4286 12000-CHECK-ME-CID.
  4287     IF (CP-COMPANY-ID EQUAL 'CID')
  4288        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4289        AND (CP-EARN-AS-NET-PAY)
  4290        CONTINUE
  4291     ELSE
  4292        GO TO 12000-CHECK-VT-TRUNC
  4293     END-IF
  4294     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4295     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4296     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4297     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4298     COMPUTE ANGLEN-1 = ANGLEN / Y
  4299     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4300     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4301     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4302        * WK5
  4303     MOVE WK3 TO CP-CALC-PREMIUM
  4304     GO TO 99999-RETURN
  4305     .
  4306 12000-CHECK-VT-TRUNC.
  4307
  4308     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4309        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4310        (CP-EARN-AS-NET-PAY) AND
  4311        (CP-TRUNCATED-LIFE)
  4312        NEXT SENTENCE
  4313     ELSE
  4314        GO TO 12000-CHECK-VT.
  4315
  4316      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4317
  4318      COMPUTE ANGLEN EQUAL WK1 / I.
  4319
  4320      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4321
  4322      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  4323      COMPUTE WK9 EQUAL
  4324        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  4325        ((.0054 - I) / (1 + I)).
  4326      COMPUTE WK7 EQUAL
  4327        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  80
* ELRATE.cbl
  4328      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  4329        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  4330
  4331      MOVE WK3 TO CP-CALC-PREMIUM.
  4332
  4333     GO TO 99999-RETURN.
  4334
  4335 12000-CHECK-VT.
  4336
  4337     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4338        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4339        (CP-EARN-AS-NET-PAY)
  4340        NEXT SENTENCE
  4341     ELSE
  4342        GO TO 12000-CHECK-MINN-WDS.
  4343
  4344      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4345
  4346      COMPUTE ANGLEN EQUAL WK1 / I.
  4347
  4348      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4349
  4350      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  4351                        (ANGLEN-1 * I)) *
  4352
  4353                        (((1.0054 ** N - 1) /
  4354                        (1.0054 ** (N - 1) * .0054)) -
  4355
  4356                        ((V * (1 - 1.0054 ** N * VX)) /
  4357                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  4358
  4359      MOVE WK3 TO CP-CALC-PREMIUM.
  4360
  4361     GO TO 99999-RETURN.
  4362
  4363 12000-CHECK-MINN-WDS.
  4364
  4365     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4366        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4367        (CP-EARN-AS-NET-PAY)
  4368        NEXT SENTENCE
  4369     ELSE
  4370        GO TO 12000-CHECK-MINN-BALL-LEV.
  4371
  4372     COMPUTE ANGLEN EQUAL WK1 / I.
  4373     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
  4374              (N / +12) * (2 / (N + 1)).
  4375     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  4376         WK3 * ((N - ANGLEN) / I).
  4377
  4378      MOVE WK3 TO CP-CALC-PREMIUM.
  4379
  4380     GO TO 99999-RETURN.
  4381
  4382 12000-CHECK-MINN-BALL-LEV.
  4383
  4384     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4385        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  81
* ELRATE.cbl
  4386        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4387        (CP-EARN-AS-REG-BALLOON)
  4388        NEXT SENTENCE
  4389     ELSE
  4390        GO TO 12000-CHECK-MINN-BALL.
  4391
  4392     COMPUTE ANGLEN EQUAL WK1 / I.
  4393
  4394     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  4395
  4396     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4397        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  4398
  4399     MOVE WK3 TO CP-CALC-PREMIUM.
  4400
  4401     GO TO 99999-RETURN.
  4402
  4403 12000-CHECK-MINN-BALL.
  4404
  4405     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4406        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4407        (CP-EARN-AS-REG-BALLOON)
  4408        NEXT SENTENCE
  4409     ELSE
  4410        GO TO 12000-CHECK-CID-MN-BALL.
  4411
  4412     COMPUTE ANGLEN EQUAL WK1 / I.
  4413     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4414
  4415     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4416     / +100 * (N - 1) / 12 * 2 / N *
  4417     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  4418
  4419      MOVE WK3 TO CP-CALC-PREMIUM.
  4420
  4421     GO TO 99999-RETURN.
  4422
  4423 12000-CHECK-CID-MN-BALL.
  4424     IF (CP-COMPANY-ID EQUAL 'CID')
  4425        AND (CP-STATE-STD-ABBRV = 'MN')
  4426        AND (CP-CERT-EFF-DT > X'A4FF')
  4427        AND (CP-EARN-AS-REG-BALLOON)
  4428        CONTINUE
  4429     ELSE
  4430        GO TO 12000-CHECK-CID-MN-FARM
  4431     END-IF
  4432     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4433     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4434     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  4435     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4436     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4437     COMPUTE V = 1 / (1 + I)
  4438     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4439     COMPUTE Y = (1 + (D * I) / +30)
  4440        / (1 + I)
  4441     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  4442        * CP-PREMIUM-RATE / 1000
  4443*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  82
* ELRATE.cbl
  4444*       MOVE CP-MONTHLY-PAYMENT  TO GR
  4445*    ELSE
  4446*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  4447*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  4448*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  4449*       DISPLAY ' BALLOON TOP ' WK6
  4450*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  4451*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  4452*          / 100
  4453*       DISPLAY ' BALLOON BOTTOM ' WK7
  4454*       COMPUTE GR = WK6 / WK7
  4455*       DISPLAY ' BALLOON PAYMENT ' GR
  4456*    END-IF
  4457     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  4458     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  4459        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  4460     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  4461     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  4462        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  4463           (CP-ALTERNATE-BENEFIT * (M + 1)))
  4464           * CP-PREMIUM-RATE / 1000
  4465     MOVE WK3                    TO CP-CALC-PREMIUM
  4466     GO TO 99999-RETURN.
  4467     .
  4468 12000-CHECK-CID-MN-FARM.
  4469
  4470     IF (CP-COMPANY-ID EQUAL 'CID')
  4471        AND (CP-STATE-STD-ABBRV = 'MN' or 'WA')
  4472        AND (CP-CERT-EFF-DT > X'A4FF')
  4473        AND (CP-EARN-AS-FARM-PLAN)
  4474        CONTINUE
  4475     ELSE
  4476        GO TO 12000-CHECK-CID-NET-BALLoons
  4477     END-IF
  4478
  4479     EVALUATE CP-PMT-MODE
  4480        WHEN 'B'
  4481           MOVE +14              TO C-DAYS-IN-PMT-PER
  4482           MOVE +26              TO C-PMTS-PER-YEAR
  4483           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4484        WHEN 'S'
  4485           MOVE +15              TO C-DAYS-IN-PMT-PER
  4486           MOVE +24              TO C-PMTS-PER-YEAR
  4487           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4488        WHEN 'T'
  4489           MOVE +360             TO C-DAYS-IN-PMT-PER
  4490           MOVE +1               TO C-PMTS-PER-YEAR
  4491           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4492        WHEN 'W'
  4493           MOVE +7               TO C-DAYS-IN-PMT-PER
  4494           MOVE +52              TO C-PMTS-PER-YEAR
  4495           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  4496        WHEN OTHER
  4497           move cp-no-of-pmts    to c-tot-pmts
  4498           if cp-pay-frequency > zeros
  4499              compute c-pmts-per-year =
  4500                 12 / cp-pay-frequency
  4501              compute c-days-in-pmt-per = 360 / c-pmts-per-year
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  83
* ELRATE.cbl
  4502           else
  4503              MOVE +30           TO C-DAYS-IN-PMT-PER
  4504              MOVE +12           TO C-PMTS-PER-YEAR
  4505              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  4506           end-if
  4507     END-EVALUATE
  4508
  4509     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4510     if i = zeros
  4511        move .0000000001         to i
  4512     end-if
  4513
  4514     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4515        C-DAYS-IN-PMT-PER)) / (1 + I)
  4516
  4517     compute cp-premium-rate =
  4518        cp-premium-rate * 12 / c-pmts-per-year / 10
  4519     move c-tot-pmts to n m
  4520     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4521     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4522     COMPUTE ANGLEN-1 = ANGLEN / Y
  4523     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4524
  4525     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  4526        (cp-premium-rate / 100)
  4527
  4528
  4529     MOVE WK3                    TO CP-CALC-PREMIUM
  4530
  4531     GO TO 99999-RETURN.
  4532
  4533     .
  4534 12000-check-cid-net-balloons.
  4535     IF (CP-COMPANY-ID EQUAL 'CID')
  4536        AND (CP-EARN-AS-REG-BALLOON)
  4537        and (CP-NET-ONLY-STATE not = 'Y')
  4538        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  4539        CONTINUE
  4540     ELSE
  4541        GO TO 12000-check-cid-net-only-balls
  4542     END-IF
  4543     display ' *** NOT NET ONLY STATE BALLOONS *** '
  4544     COMPUTE Y =
  4545        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  4546     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4547     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  4548     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4549     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4550     COMPUTE ANGLEMY = ANGLEM / Y
  4551     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  4552     COMPUTE ANGLENY = ANGLEN / Y
  4553     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  4554     compute cp-original-benefit =
  4555        cp-original-benefit + cp-alternate-benefit
  4556     COMPUTE PVBALLOON rounded =
  4557        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  4558     compute wk4 rounded =
  4559        cp-original-benefit - pvballoon
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  84
* ELRATE.cbl
  4560     compute wk6 rounded =
  4561        (cp-original-benefit - cp-alternate-benefit)
  4562***  compute ra = wk4 / anglem-1y
  4563     compute ra = wk4 / anglemy
  4564     compute wk6 rounded = wk6 / anglemy
  4565     display ' rate before ' cp-premium-rate
  4566     compute cp-premium-rate =
  4567        (cp-premium-rate * ((m + (cp-days-to-1st-pmt - 30)
  4568            / 30) / 12))     /
  4569           ((m + 1) / 2)
  4570     display '************************************'
  4571     display ' orign ben    ' cp-original-benefit
  4572     display ' balloon      ' cp-alternate-benefit
  4573     display ' ra           ' ra
  4574     display ' wk6          ' wk6
  4575     display ' m            ' m
  4576     display ' anglemy      ' anglemy
  4577     display ' anglem-1     ' anglem-1y
  4578     display ' i            ' i
  4579     display ' extra per    ' cp-extra-periods
  4580     display ' prem rate    ' cp-premium-rate
  4581***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  4582***     (cp-extra-periods * i)) * cp-premium-rate / 100
  4583     compute wk3 = wk6 * (m - anglem) / i * (1 +
  4584        (cp-extra-periods * i)) * cp-premium-rate / 100
  4585     move wk3                    to cp-calc-premium
  4586     display ' wk3          ' wk3
  4587     display '************************************'
  4588*    compute wk3 rounded =
  4589*       cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  4590*    move wk3                    to cp-lf-balloon-prem
  4591     GO TO 99999-RETURN.
  4592     .
  4593 12000-check-cid-net-only-balls.
  4594     IF (CP-COMPANY-ID EQUAL 'CID')
  4595        AND (CP-EARN-AS-REG-BALLOON)
  4596        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  4597        CONTINUE
  4598     ELSE
  4599        GO TO 12000-CHECK-NC-WDS
  4600     END-IF
  4601     display ' *** NET ONLY STATE BALLOONS *** '
  4602     COMPUTE Y =
  4603        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  4604     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  4605     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  4606     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4607     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4608     COMPUTE ANGLEMY = ANGLEM / Y
  4609     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  4610     COMPUTE ANGLENY = ANGLEN / Y
  4611     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  4612     COMPUTE PVBALLOON rounded =
  4613        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  4614     compute wk4 rounded =
  4615        cp-original-benefit - pvballoon
  4616*    compute cp-premium-rate =
  4617*       (cp-premium-rate * (m + 1) / 12)  /
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  85
* ELRATE.cbl
  4618*          ((m + 2) / 2)
  4619***  compute ra = wk4 / anglem-1y
  4620     compute ra = (cp-original-benefit + cp-alternate-benefit -
  4621        pvballoon) / anglemy
  4622     display '************************************'
  4623     display ' ra           ' ra
  4624     display ' m            ' m
  4625     display ' anglemy      ' anglemy
  4626     display ' anglem-1     ' anglem-1y
  4627     display ' i            ' i
  4628     display ' extra per    ' cp-extra-periods
  4629     display ' prem rate    ' cp-premium-rate
  4630     display '************************************'
  4631***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  4632***     (cp-extra-periods * i)) * cp-premium-rate / 100
  4633     compute wk3 = ra * (m - anglemy) / i * (1 +
  4634        (cp-extra-periods * i)) * cp-premium-rate / 100
  4635     move wk3                    to cp-calc-premium
  4636     compute wk3 rounded =
  4637        cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  4638     move wk3                    to cp-lf-balloon-prem
  4639     GO TO 99999-RETURN.
  4640     .
  4641 12000-CHECK-NC-WDS.
  4642
  4643     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4644        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4645        (CP-EARN-AS-NET-PAY)
  4646        NEXT SENTENCE
  4647     ELSE
  4648        GO TO 12000-CHECK-NC-BALL-LEV.
  4649
  4650     COMPUTE WK4 EQUAL N * (1 + I * 2).
  4651     COMPUTE ANGLEN EQUAL WK1 / I.
  4652     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4653              CP-PREMIUM-RATE / +100 *
  4654              N / +12 * 2 / (N + 1) *
  4655              (WK4 - ANGLEN) / (I * ANGLEN).
  4656
  4657      MOVE WK3 TO CP-CALC-PREMIUM.
  4658
  4659     GO TO 99999-RETURN.
  4660
  4661 12000-CHECK-NC-BALL-LEV.
  4662
  4663     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4664        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4665        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4666        (CP-EARN-AS-REG-BALLOON)
  4667        NEXT SENTENCE
  4668     ELSE
  4669        GO TO 12000-CHECK-NC-BALL.
  4670
  4671     COMPUTE ANGLEN EQUAL WK1 / I.
  4672
  4673**** VX = 1 / (1 + I)**N.
  4674
  4675     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  86
* ELRATE.cbl
  4676        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  4677
  4678     MOVE WK3 TO CP-CALC-PREMIUM.
  4679
  4680     GO TO 99999-RETURN.
  4681
  4682 12000-CHECK-NC-BALL.
  4683
  4684     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4685        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4686        (CP-EARN-AS-REG-BALLOON)
  4687        NEXT SENTENCE
  4688     ELSE
  4689        GO TO 12000-CHECK-MINN-TRUNC.
  4690
  4691     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  4692     COMPUTE ANGLEN EQUAL WK1 / I.
  4693     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4694**** VX = 1 / (1 + I)**N.
  4695
  4696     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4697     / +100 * (N - 1) / 12 * 2 / N *
  4698     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  4699
  4700      MOVE WK3 TO CP-CALC-PREMIUM.
  4701
  4702     GO TO 99999-RETURN.
  4703
  4704 12000-CHECK-MINN-TRUNC.
  4705
  4706     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4707        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4708        (M GREATER THAN +63) AND
  4709        (CP-EARN-AS-NET-PAY) AND
  4710        (CP-TRUNCATED-LIFE)
  4711        NEXT SENTENCE
  4712     ELSE
  4713        GO TO 12000-CHECK-MINN.
  4714
  4715      COMPUTE ANGLEN EQUAL WK1 / I.
  4716      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4717
  4718      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4719
  4720      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4721       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4722       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  4723
  4724      MOVE WK3 TO CP-CALC-PREMIUM.
  4725
  4726     GO TO 99999-RETURN.
  4727
  4728 12000-CHECK-MINN.
  4729
  4730     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4731        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4732        (M GREATER THAN +63) AND
  4733        (CP-EARN-AS-NET-PAY)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  87
* ELRATE.cbl
  4734        NEXT SENTENCE
  4735     ELSE
  4736        GO TO 12000-CHECK-MONTANA-TRUNC.
  4737
  4738      COMPUTE ANGLEN EQUAL WK1 / I.
  4739
  4740      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4741
  4742      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4743       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4744       (((N - ANGLEN) / I) + (2 * N)).
  4745
  4746      MOVE WK3 TO CP-CALC-PREMIUM.
  4747
  4748     GO TO 99999-RETURN.
  4749
  4750 12000-CHECK-MONTANA-TRUNC.
  4751
  4752     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4753        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4754        (M GREATER THAN +63) AND
  4755        (CP-EARN-AS-NET-PAY) AND
  4756        (CP-TRUNCATED-LIFE)
  4757        NEXT SENTENCE
  4758     ELSE
  4759        GO TO 12000-CHECK-MONTANA.
  4760
  4761      COMPUTE ANGLEN EQUAL WK1 / I.
  4762      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4763
  4764      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4765
  4766      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4767      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4768       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  4769
  4770      MOVE WK3 TO CP-CALC-PREMIUM.
  4771
  4772     GO TO 99999-RETURN.
  4773
  4774 12000-CHECK-MONTANA.
  4775
  4776     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4777        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4778        (M GREATER THAN +63) AND
  4779        (CP-EARN-AS-NET-PAY)
  4780        NEXT SENTENCE
  4781     ELSE
  4782        GO TO 12001-CONTINUE-NCL-TRUNC.
  4783
  4784      COMPUTE ANGLEN EQUAL WK1 / I.
  4785
  4786      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4787
  4788      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4789       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4790       (((N - ANGLEN) / I) + (4 * N)).
  4791
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  88
* ELRATE.cbl
  4792      MOVE WK3 TO CP-CALC-PREMIUM.
  4793
  4794     GO TO 99999-RETURN.
  4795
  4796 12001-CONTINUE-NCL-TRUNC.
  4797
  4798     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4799        (CP-EARN-AS-NET-PAY) AND
  4800        (CP-TRUNCATED-LIFE)
  4801        NEXT SENTENCE
  4802     ELSE
  4803        GO TO 12001-CONTINUE-NCL.
  4804
  4805      COMPUTE ANGLEN EQUAL WK1 / I.
  4806      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4807
  4808      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4809
  4810      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  4811      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  4812      (ANGLEN-1 * (N + 1) * I).
  4813
  4814      MOVE WK3 TO CP-CALC-PREMIUM.
  4815
  4816     GO TO 99999-RETURN.
  4817
  4818 12001-CONTINUE-NCL.
  4819
  4820     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4821        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4822        (CP-EARN-AS-NET-PAY)
  4823        GO TO 12001-CHECK-NC-NET-PLUS3.
  4824
  4825     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4826        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4827        (CP-EARN-AS-NET-PAY)
  4828        GO TO 12001-CHECK-CA.
  4829
  4830     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4831        (CP-EARN-AS-NET-PAY)
  4832        NEXT SENTENCE
  4833     ELSE
  4834        GO TO 12000-CONTINUE-NET.
  4835
  4836      COMPUTE ANGLEN EQUAL WK1 / I.
  4837      MOVE ANGLEN                TO ANGLEN-1.
  4838
  4839      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4840
  4841      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4842       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4843       ((N - ANGLEN) / I).
  4844
  4845      MOVE WK3 TO CP-CALC-PREMIUM.
  4846
  4847     GO TO 99999-RETURN.
  4848
  4849 12000-CONTINUE-NET.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  89
* ELRATE.cbl
  4850
  4851     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  4852        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  4853        (CP-EARN-AS-NET-PAY)
  4854        NEXT SENTENCE
  4855     ELSE
  4856        GO TO 12001-CONTINUE-MINN.
  4857
  4858      COMPUTE ANGLEN EQUAL WK6 / I.
  4859      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  4860
  4861      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  4862      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  4863      COMPUTE WK3 EQUAL (WK3 / I) *
  4864       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  4865
  4866      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  4867         MOVE +0 TO CP-R-MAX-TOT-BEN.
  4868
  4869      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  4870
  4871      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  4872         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  4873         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  4874
  4875      MOVE WK3 TO CP-CALC-PREMIUM.
  4876
  4877     GO TO 99999-RETURN.
  4878
  4879 12001-CONTINUE-MINN.
  4880
  4881     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4882        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  4883        (CP-TRUNCATED-LIFE)
  4884        NEXT SENTENCE
  4885     ELSE
  4886        GO TO 12001-CHECK-RI-GTL.
  4887
  4888      COMPUTE ANGLEN EQUAL WK1 / I.
  4889      COMPUTE ANGLEM EQUAL WK2 / I.
  4890
  4891      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  4892       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  4893       * M / 2400) * 1000 + .5) / 1000000.
  4894
  4895      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
  4896       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  4897
  4898     GO TO 99999-RETURN.
  4899
  4900 12001-CHECK-RI-GTL.
  4901
  4902     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4903        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4904        (CP-EARN-AS-NET-PAY)
  4905        NEXT SENTENCE
  4906     ELSE
  4907        GO TO 12001-CHECK-RI-LEASE-GTL.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  90
* ELRATE.cbl
  4908
  4909      COMPUTE ANGLEN EQUAL WK1 / I.
  4910*     COMPUTE ANGLEM EQUAL WK2 / I.
  4911
  4912      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  4913               (1 + WS-WORK-DIS-RATE * N).
  4914      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  4915         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  4916
  4917
  4918     GO TO 99999-RETURN.
  4919
  4920 12001-CHECK-RI-LEASE-GTL.
  4921
  4922     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4923        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4924        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4925        NEXT SENTENCE
  4926     ELSE
  4927        GO TO 12001-CHECK-OR-GTL.
  4928
  4929     COMPUTE ANGLEN EQUAL WK1 / I.
  4930
  4931     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  4932        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
  4933                        /
  4934        (1000 * I * (1 + .0021 * N)).
  4935     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  4936       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  4937                            /
  4938       (1000 * (1 + .0027 * (N + 1))).
  4939
  4940     GO TO 99999-RETURN.
  4941
  4942 12001-CHECK-OR-GTL.
  4943
  4944     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4945        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  4946        (CP-EARN-AS-NET-PAY)
  4947        NEXT SENTENCE
  4948     ELSE
  4949        GO TO 12001-CHECK-GA-GTL.
  4950
  4951     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4952     COMPUTE ANGLEN EQUAL WK1 / I.
  4953
  4954     IF M LESS THAN +64
  4955        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4956         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  4957                   /
  4958         (I * ANGLEN * (N - (N - M) + 1) * 600)
  4959        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  4960     ELSE
  4961        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4962        CP-PREMIUM-RATE * (1 + I))
  4963                  /
  4964        (+1000 * I * ANGLEN)
  4965        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  91
* ELRATE.cbl
  4966*    MOVE WK3 TO CP-CALC-PREMIUM.
  4967     GO TO 99999-RETURN.
  4968
  4969 12001-CHECK-GA-GTL.
  4970
  4971     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4972        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  4973        (CP-EARN-AS-NET-PAY)
  4974*       (CP-TRUNCATED-LIFE)
  4975        NEXT SENTENCE
  4976     ELSE
  4977        GO TO 12001-CHECK-MA-GTL.
  4978
  4979     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4980     COMPUTE ANGLEN EQUAL WK1 / I.
  4981
  4982     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  4983     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  4984      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  4985     MOVE WK3 TO CP-CALC-PREMIUM.
  4986
  4987     GO TO 99999-RETURN.
  4988
  4989 12001-CHECK-MA-GTL.
  4990
  4991     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4992        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  4993        (CP-EARN-AS-NET-PAY) AND
  4994        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4995        NEXT SENTENCE
  4996     ELSE
  4997        GO TO 12001-CHECK-NV-NET.
  4998
  4999     COMPUTE ANGLEN EQUAL WK1 / I.
  5000
  5001     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  5002      CP-ALTERNATE-BENEFIT * N.
  5003
  5004     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  5005     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  5006
  5007     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  5008     WK7 * (N - ANGLEN) / I.
  5009     MOVE WK3 TO CP-CALC-PREMIUM.
  5010
  5011     GO TO 99999-RETURN.
  5012
  5013 12001-CHECK-NV-NET.
  5014     IF (CP-COMPANY-ID EQUAL 'CID')
  5015        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  5016        AND (CP-EARN-AS-NET-PAY)
  5017        CONTINUE
  5018     ELSE
  5019        GO TO 12001-CHECK-MN-NET
  5020     END-IF
  5021     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  5022     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  5023     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  92
* ELRATE.cbl
  5024                   / (1 + I)
  5025     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5026     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5027     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5028        (CP-PREMIUM-RATE * K-I / 1000)
  5029     MOVE WK3                    TO CP-CALC-PREMIUM
  5030     GO TO 99999-RETURN
  5031      .
  5032 12001-CHECK-MN-NET.
  5033     IF (CP-COMPANY-ID EQUAL 'CID')
  5034        AND (CP-STATE-STD-ABBRV = 'MN')
  5035        AND (CP-EARN-AS-NET-PAY)
  5036        AND (NOT CP-LEVEL-LIFE)
  5037        AND (WS-DISCOUNT-OPTION = '1')
  5038        CONTINUE
  5039     ELSE
  5040        GO TO 12001-CHECK-NC-NET
  5041     END-IF
  5042     if i = .0000000001
  5043        compute wk4 = cp-original-benefit / n
  5044        compute wk3 = wk4 * ((n * (n + 1) / 2) - ((n - m) *
  5045           (n - m + 1) / 2))*(cp-premium-rate / 1000)
  5046        move wk3 to cp-calc-premium
  5047        go to 99999-return
  5048     end-if
  5049     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  5050     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  5051     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  5052                   / (1 + I)
  5053     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5054     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5055     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5056        (CP-PREMIUM-RATE / 1000) * (1 + I)
  5057     MOVE WK3                    TO CP-CALC-PREMIUM
  5058     GO TO 99999-RETURN
  5059      .
  5060 12001-CHECK-NC-NET.
  5061
  5062     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  5063        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  5064        (CP-EARN-AS-NET-PAY)
  5065        NEXT SENTENCE
  5066     ELSE
  5067        GO TO 12001-CHECK-NC-NET-PLUS3.
  5068
  5069      COMPUTE ANGLEN EQUAL WK1 / I.
  5070      COMPUTE ANGLEN-M EQUAL WK5 / I.
  5071
  5072      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  5073          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  5074          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  5075          N * (CP-PREMIUM-RATE / 1000)).
  5076
  5077      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  5078          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  5079
  5080      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  5081          ((N - ANGLEN) / I + 3) / ANGLEN) /
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  93
* ELRATE.cbl
  5082          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  5083          (ANGLEN * 2))
  5084
  5085      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  5086
  5087      IF ANGLEN IS NOT LESS THAN WK7
  5088          COMPUTE CP-PREMIUM-RATE ROUNDED =
  5089              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  5090          COMPUTE WK3 ROUNDED =
  5091              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  5092
  5093     MOVE WK3 TO CP-CALC-PREMIUM.
  5094
  5095     GO TO 99999-RETURN.
  5096
  5097 12001-CHECK-NC-NET-PLUS3.
  5098
  5099     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  5100        (CP-EARN-AS-NET-PAY) AND
  5101        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL')
  5102        NEXT SENTENCE
  5103     ELSE
  5104        GO TO 12001-CHECK-CA.
  5105
  5106     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  5107     MOVE ' ' TO DC-OPTION-CODE.
  5108     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  5109
  5110     IF DATE-CONVERSION-ERROR
  5111        MOVE '2'                 TO CP-RETURN-CODE
  5112        MOVE ZEROS               TO FACTOR
  5113                                    CP-CALC-PREMIUM
  5114         GO TO 99999-RETURN.
  5115
  5116     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  5117        NEXT SENTENCE
  5118     ELSE
  5119        GO TO 12001-CONTINUE-NET.
  5120
  5121     COMPUTE ANGLEN EQUAL WK1 / I.
  5122     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5123
  5124     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  5125
  5126     COMPUTE NC-R = 20 *
  5127                    ((NC-LR * ORIGINAL-TERM) / 12)
  5128                          / (ORIGINAL-TERM + 1).
  5129
  5130     COMPUTE NC-OB = NC-R / 1000.
  5131
  5132     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  5133                    (NC-OB * ORIGINAL-TERM * 3).
  5134
  5135     IF CP-EXT-CHG-LF
  5136         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  5137     ELSE
  5138         MOVE 30                 TO  NC-BIG-D.
  5139
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  94
* ELRATE.cbl
  5140     COMPUTE NC-LITTLE-D = (1 + I) /
  5141             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  5142
  5143     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  5144             (ANGLEN * NC-LITTLE-D ).
  5145
  5146     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  5147
  5148     GO TO 99999-RETURN.
  5149
  5150 12001-CHECK-CA.
  5151
  5152     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5153        (WS-DISCOUNT-OPTION = '6')
  5154        NEXT SENTENCE
  5155     ELSE
  5156        GO TO 12001-CHECK-GTL-IA.
  5157
  5158     COMPUTE CA-J = CA-DISCOUNT / 12.
  5159     COMPUTE ANGLEN EQUAL WK1 / I.
  5160     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  5161     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  5162     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  5163     COMPUTE CA-VI = (1 + I)** -1.
  5164     COMPUTE CP-CALC-PREMIUM =
  5165         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  5166         ((1 + CA-J) / I) *
  5167         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  5168         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  5169         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  5170
  5171     GO TO 99999-RETURN.
  5172
  5173 12001-CHECK-GTL-IA.
  5174
  5175     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  5176        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  5177        (CP-EARN-AS-NET-PAY)
  5178        NEXT SENTENCE
  5179     ELSE
  5180        GO TO 12001-CHECK-CID-TRN-VA.
  5181
  5182***************************************************************
  5183
  5184     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  5185
  5186     IF GTL-IA-ODD-DAYS = ZEROS
  5187         MOVE ZERO               TO  GTL-IA-SGN
  5188     ELSE
  5189         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  5190             MOVE +1             TO  GTL-IA-SGN
  5191         ELSE
  5192             MOVE -1             TO  GTL-IA-SGN.
  5193
  5194     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  5195     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  5196
  5197     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  95
* ELRATE.cbl
  5198                          GTL-IA-SGN.
  5199
  5200     COMPUTE ANGLEN EQUAL WK1 / I.
  5201     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5202
  5203     IF GTL-IA-ODF NOT = ZERO
  5204         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  5205         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  5206
  5207     COMPUTE GTL-IA-DIVIDEND =
  5208           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  5209                             (ANGLEN - ANGLEN-M))) *
  5210           ((K1 + I) * CP-PREMIUM-RATE *
  5211                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  5212
  5213     COMPUTE GTL-IA-DIVISOR =
  5214      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  5215
  5216     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  5217
  5218     COMPUTE CP-CALC-PREMIUM =
  5219                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  5220     GO TO 99999-RETURN.
  5221
  5222
  5223 12001-CHECK-CID-TRN-VA.
  5224
  5225     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5226        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  5227        (CP-EARN-AS-NET-PAY) AND
  5228        (CP-TRUNCATED-LIFE) AND
  5229        (CP-STATE-STD-ABBRV = CP-STATE)
  5230        CONTINUE
  5231     ELSE
  5232        GO TO 12001-CHECK-CID-TX
  5233     END-IF
  5234
  5235     COMPUTE ANGLEN EQUAL WK1 / I
  5236     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5237     IF WS-WORK-DIS-RATE = ZEROS
  5238        CONTINUE
  5239     ELSE
  5240        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5241        COMPUTE WK7 = (1 / I) *
  5242              (((WK4 ** M - 1) / (WK4 - 1)) -
  5243              ((WK4 ** M * SX - VX) /
  5244              (WK4 * (1 + I) - 1))) *
  5245              (CP-PREMIUM-RATE / 1000)
  5246        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5247        COMPUTE WK8 = WK7 * 100 / ANGLEN
  5248        COMPUTE CP-CALC-PREMIUM =
  5249           WK8 *  ((WK4 * ANGLEN) / 100)
  5250     END-IF
  5251
  5252     GO TO 99999-RETURN
  5253
  5254     .
  5255
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  96
* ELRATE.cbl
  5256 12001-CHECK-CID-TX.
  5257     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5258        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  5259        (CP-EARN-AS-NET-PAY) AND
  5260        (WS-WORK-DIS-RATE > ZEROS) AND
  5261        (CP-STATE-STD-ABBRV = CP-STATE)
  5262        CONTINUE
  5263     ELSE
  5264        GO TO 12001-CHECK-CID-LEV-MN-NEW
  5265     END-IF
  5266* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  5267     COMPUTE K-I = 1 + (1 * I)
  5268     COMPUTE ANGLEN EQUAL WK1 / I
  5269     COMPUTE ANGLEM EQUAL WK2 / I
  5270     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5271     IF WS-WORK-DIS-RATE = ZEROS
  5272        CONTINUE
  5273     ELSE
  5274        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5275        COMPUTE WK7 = (K-I / I) *
  5276              (((WK4 ** M - 1) / (WK4 - 1)) -
  5277*             ((WK4 ** M * SX - VX) /
  5278              ((WK4 ** M * SX) - VX) /
  5279*             (WK4 * (1 + I) - 1))) *
  5280              (WK4 * (1 + I) - 1)) *
  5281              (CP-PREMIUM-RATE / 1000)
  5282        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5283        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  5284        COMPUTE CP-CALC-PREMIUM =
  5285           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  5286     END-IF
  5287
  5288     GO TO 99999-RETURN
  5289     .
  5290 12001-CHECK-CID-LEV-MN-NEW.
  5291*    IF (CP-COMPANY-ID EQUAL 'CID')
  5292*       AND (CP-STATE-STD-ABBRV = 'MN')
  5293*       AND (CP-EARN-AS-NET-PAY)
  5294*       AND (CP-LEVEL-LIFE)
  5295*       AND (CP-CERT-EFF-DT > X'A4FF')
  5296*       CONTINUE
  5297*    ELSE
  5298*       GO TO 12001-CHECK-CID-LEV-MN
  5299*    END-IF
  5300*
  5301*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  5302*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  5303*    MOVE '1'                    TO DC-OPTION-CODE
  5304*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  5305*
  5306*    IF DATE-CONVERSION-ERROR
  5307*       MOVE '2'                 TO CP-RETURN-CODE
  5308*       MOVE ZEROS               TO FACTOR
  5309*                                   CP-CALC-PREMIUM
  5310*       GO TO 99999-RETURN
  5311*    END-IF
  5312*
  5313*    COMPUTE I = CP-LOAN-APR / 100
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  97
* ELRATE.cbl
  5314*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  5315*
  5316*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  5317*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  5318*      * 12 / 360 * D)
  5319*
  5320*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  5321*       * 12 / 360 * D
  5322*
  5323*    GO TO 99999-RETURN
  5324      .
  5325 12001-CHECK-CID-LEV-MN.
  5326
  5327     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5328        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  5329        (CP-EARN-AS-NET-PAY) AND
  5330        (CP-LEVEL-LIFE) AND
  5331        (CP-STATE-STD-ABBRV = CP-STATE)
  5332        CONTINUE
  5333     ELSE
  5334        GO TO 12001-CHECK-CID-LEV-CA
  5335     END-IF
  5336
  5337     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  5338         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  5339         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  5340
  5341     GO TO 99999-RETURN
  5342
  5343      .
  5344 12001-CHECK-CID-LEV-CA.
  5345
  5346     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5347        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  5348        (CP-EARN-AS-NET-PAY) AND
  5349        (CP-LEVEL-LIFE) AND
  5350        (CP-STATE-STD-ABBRV = CP-STATE)
  5351        CONTINUE
  5352     ELSE
  5353        GO TO 12001-CHECK-CID-TRN-CA
  5354     END-IF
  5355
  5356     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  5357     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  5358     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  5359     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  5360     COMPUTE CP-CALC-PREMIUM =
  5361          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  5362          (CP-PREMIUM-RATE / 1000)) /
  5363          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  5364
  5365     GO TO 99999-RETURN
  5366
  5367      .
  5368 12001-CHECK-CID-TRN-CA.
  5369
  5370     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5371        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  98
* ELRATE.cbl
  5372        (CP-EARN-AS-NET-PAY) AND
  5373        (CP-TRUNCATED-LIFE) AND
  5374        (CP-STATE-STD-ABBRV = CP-STATE) AND
  5375        (WS-DISCOUNT-OPTION NOT = ' ')
  5376        CONTINUE
  5377     ELSE
  5378        GO TO 12001-CHECK-CID-TRN-MT
  5379     END-IF
  5380
  5381     COMPUTE ANGLEN EQUAL WK1 / I
  5382     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5383     IF WS-WORK-DIS-RATE = ZEROS
  5384        CONTINUE
  5385     ELSE
  5386        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5387        COMPUTE WK7 = (1 / I) *
  5388              (((WK4 ** M - 1) / (WK4 - 1)) -
  5389              ((WK4 ** M * SX - VX) /
  5390              (WK4 * (1 + I) - 1))) *
  5391              (CP-PREMIUM-RATE / 1000)
  5392        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  5393        COMPUTE CP-CALC-PREMIUM =
  5394           WK4 *  WK7
  5395     END-IF
  5396
  5397     GO TO 99999-RETURN
  5398
  5399      .
  5400 12001-CHECK-CID-TRN-MT.
  5401
  5402     IF (CP-COMPANY-ID EQUAL 'CID') AND
  5403        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  5404                   OR
  5405        ((CP-STATE-STD-ABBRV = 'IN') AND
  5406        (CP-CERT-EFF-DT > X'9A7F'))
  5407                   OR
  5408        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5409        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5410        (CP-EARN-AS-NET-PAY) AND
  5411        (CP-TRUNCATED-LIFE) AND
  5412        (CP-STATE-STD-ABBRV = CP-STATE)
  5413        CONTINUE
  5414     ELSE
  5415        GO TO 12001-CHECK-CID-MT
  5416     END-IF
  5417
  5418* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5419     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5420        MOVE 0                   TO K-I
  5421     ELSE
  5422        MOVE 2                   TO K-I
  5423     END-IF
  5424     COMPUTE CP-TERM-OR-EXT-DAYS =
  5425           CP-TERM-OR-EXT-DAYS + 30
  5426
  5427     COMPUTE ANGLEN EQUAL WK1 / I
  5428     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5429     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page  99
* ELRATE.cbl
  5430                   / (1 + I)
  5431     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5432     IF WS-WORK-DIS-RATE = ZEROS
  5433        CONTINUE
  5434     ELSE
  5435        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5436*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5437        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5438              (((WK4 ** M - 1) / (WK4 - 1)) -
  5439              ((WK4 ** M * SX - VX) /
  5440              (WK4 * (1 + I) - 1))) *
  5441              (CP-PREMIUM-RATE / 1000)
  5442        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5443*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5444        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5445        COMPUTE CP-CALC-PREMIUM =
  5446           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5447*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5448     END-IF
  5449
  5450     GO TO 99999-RETURN
  5451
  5452     .
  5453 12001-CHECK-CID-MT.
  5454
  5455     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5456        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  5457                                OR 'VT')
  5458                   OR
  5459        ((CP-STATE-STD-ABBRV = 'IN') AND
  5460        (CP-CERT-EFF-DT > X'9A7F'))
  5461                   OR
  5462        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5463        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5464        (CP-EARN-AS-NET-PAY) AND
  5465        (CP-STATE-STD-ABBRV = CP-STATE)
  5466        CONTINUE
  5467     ELSE
  5468        GO TO 12001-CHECK-DCC-DD
  5469     END-IF
  5470
  5471     COMPUTE CP-TERM-OR-EXT-DAYS =
  5472           CP-TERM-OR-EXT-DAYS + 30
  5473
  5474* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5475     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5476        MOVE 0                   TO K-I
  5477     ELSE
  5478        IF CP-STATE-STD-ABBRV = 'NJ'
  5479           MOVE 1                TO K-I
  5480        ELSE
  5481           MOVE 2                TO K-I
  5482        END-IF
  5483     END-IF
  5484     COMPUTE ANGLEN EQUAL WK1 / I
  5485     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5486     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5487                   / (1 + I)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page 100
* ELRATE.cbl
  5488     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5489     IF WS-WORK-DIS-RATE = ZEROS
  5490        CONTINUE
  5491     ELSE
  5492        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5493*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5494        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5495              (((WK4 ** N - 1) / (WK4 - 1)) -
  5496              ((WK4 ** N - SV) /
  5497              (WK4 * (1 + I) - 1))) *
  5498              (CP-PREMIUM-RATE / 1000)
  5499        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5500*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5501        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5502        COMPUTE CP-CALC-PREMIUM =
  5503           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5504*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5505     END-IF
  5506
  5507     GO TO 99999-RETURN
  5508
  5509     .
  5510 12001-CHECK-DCC-DD.
  5511     IF (CP-COMPANY-ID EQUAL 'DCC')
  5512        AND (CP-EARN-AS-NET-PAY)
  5513        AND (CP-BEN-CATEGORY = 'D')
  5514        CONTINUE
  5515     ELSE
  5516        GO TO 12001-CHECK-DCC-NET
  5517     END-IF
  5518
  5519     COMPUTE CP-TERM-OR-EXT-DAYS =
  5520           CP-TERM-OR-EXT-DAYS + 30
  5521
  5522     COMPUTE ANGLEN EQUAL WK1 / I.
  5523     COMPUTE ANGLEM EQUAL WK2 / I.
  5524     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5525
  5526     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5527           / (1 + I)
  5528     COMPUTE GR     = ANGLEN / ODF
  5529*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  5530*      CP-RATE-DEV-PCT
  5531     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5532     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5533       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  5534     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5535     MOVE WK3                    TO CP-CALC-PREMIUM
  5536
  5537     GO TO 99999-RETURN
  5538
  5539     .
  5540 12001-CHECK-DCC-NET.
  5541
  5542     IF (CP-COMPANY-ID EQUAL 'DCC')
  5543        AND (CP-EARN-AS-NET-PAY)
  5544        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  5545             AND 'H' AND 'S' AND 'P')
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page 101
* ELRATE.cbl
  5546        CONTINUE
  5547     ELSE
  5548        GO TO 12001-CHECK-DCC-PNET
  5549     END-IF
  5550
  5551     COMPUTE CP-TERM-OR-EXT-DAYS =
  5552           CP-TERM-OR-EXT-DAYS + 30
  5553
  5554     COMPUTE ANGLEN EQUAL WK1 / I.
  5555     COMPUTE ANGLEM EQUAL WK2 / I.
  5556     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5557
  5558     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5559           / (1 + I)
  5560     COMPUTE GR     = ANGLEN / ODF
  5561     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  5562     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  5563       CP-RATE-DEV-PCT
  5564     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  5565*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  5566
  5567     COMPUTE WK8 = CP-PREMIUM-RATE *
  5568        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  5569     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  5570     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5571     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5572       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  5573     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5574     MOVE WK3                    TO CP-CALC-PREMIUM
  5575
  5576     GO TO 99999-RETURN
  5577
  5578     .
  5579 12001-CHECK-DCC-PNET.
  5580     IF (CP-COMPANY-ID EQUAL 'DCC')
  5581        AND (CP-EARN-AS-NET-PAY)
  5582        AND (CP-BENEFIT-CD (1:1) = 'P')
  5583        CONTINUE
  5584     ELSE
  5585        GO TO 12001-CHECK-DCC-MNET
  5586     END-IF
  5587     IF CP-NO-OF-PMTS NOT NUMERIC
  5588        MOVE +0                  TO CP-NO-OF-PMTS
  5589     END-IF
  5590     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  5591        AND ' ' AND 'M'
  5592        MOVE ' '                 TO CP-PMT-MODE
  5593     END-IF
  5594******************************************************************
  5595***   Default is monthly, use loan term for rate and amort     ***
  5596******************************************************************
  5597     move cp-loan-term         to c-tot-pmts
  5598     MOVE +30                  TO C-DAYS-IN-PMT-PER
  5599     MOVE +12                  TO C-PMTS-PER-YEAR
  5600******************************************************************
  5601
  5602     evaluate true
  5603        when cp-pmt-mode = 'W'
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page 102
* ELRATE.cbl
  5604           MOVE +52              TO C-PMTS-PER-YEAR
  5605           compute c-tot-pmts = cp-loan-term /
  5606              12 * c-pmts-per-year
  5607           MOVE +7               TO C-DAYS-IN-PMT-PER
  5608        when cp-pmt-mode = 'B'
  5609           MOVE +26              TO C-PMTS-PER-YEAR
  5610           compute c-tot-pmts = cp-loan-term /
  5611              12 * c-pmts-per-year
  5612           MOVE +14              TO C-DAYS-IN-PMT-PER
  5613     end-evaluate
  5614     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  5615     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  5616        C-DAYS-IN-PMT-PER)) / (1 + I)
  5617     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  5618*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  5619     COMPUTE ANGLEN-1 = ANGLEN / Y
  5620     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5621     IF CP-RATE-DEV-PCT NOT = ZEROS
  5622        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5623           CP-PREMIUM-RATE
  5624     END-IF
  5625     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  5626     GO TO 99999-RETURN
  5627     .
  5628 12001-CHECK-DCC-MNET.
  5629
  5630     IF (CP-COMPANY-ID EQUAL 'DCC')
  5631        AND (CP-EARN-AS-NET-PAY)
  5632        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  5633        CONTINUE
  5634     ELSE
  5635        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  5636     END-IF
  5637
  5638*    COMPUTE ANGLEN EQUAL WK1 / I.
  5639*    COMPUTE ANGLEM EQUAL WK2 / I.
  5640*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  5641
  5642     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  5643     MOVE WK3                    TO CP-CALC-PREMIUM
  5644
  5645     GO TO 99999-RETURN
  5646
  5647     .
  5648 12001-CHECK-DCC-MNET-LF-BAL.
  5649
  5650     IF (CP-COMPANY-ID EQUAL 'DCC')
  5651        AND (CP-EARN-AS-NET-PAY)
  5652        AND (CP-BENEFIT-CD (1:1) = 'N')
  5653        AND (CP-BEN-CATEGORY NOT = 'N')
  5654        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5655        CONTINUE
  5656     ELSE
  5657        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  5658     END-IF
  5659
  5660     IF CP-RATE-DEV-PCT NOT = ZEROS
  5661        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page 103
* ELRATE.cbl
  5662           CP-PREMIUM-RATE
  5663     END-IF
  5664*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5665     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5666        / (1 + I)
  5667     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5668     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5669     COMPUTE WK2 = (1 + J) ** (M * -1)
  5670     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5671     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5672          ** ((M - 1) * -1))) / J)
  5673     COMPUTE ANGLEM = ((1 - ((1 + J)
  5674          ** (M * -1))) / J) / OD
  5675     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5676        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  5677        / ANGLEM-1
  5678     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5679          ** ((N - M) * -1))) / I)
  5680     MOVE +0                     TO WK3
  5681     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5682        (WS-COUNTER > M)
  5683        COMPUTE ANGLEM = (1 - ((1 + J)
  5684          ** ((M - WS-COUNTER) * -1))) / J
  5685        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5686        COMPUTE WK5-CSL = (RA * ANGLEM)
  5687        + (CP-ALTERNATE-BENEFIT * WK2)
  5688        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5689     END-PERFORM
  5690     MOVE WK3                    TO CP-CALC-PREMIUM
  5691
  5692     GO TO 99999-RETURN
  5693
  5694     .
  5695 12001-CHECK-DCC-MNET-LFSUM-BAL.
  5696
  5697     IF (CP-COMPANY-ID EQUAL 'DCC')
  5698        AND (CP-EARN-AS-NET-PAY)
  5699        AND (CP-BENEFIT-CD (1:1) = 'S')
  5700        AND (CP-BEN-CATEGORY NOT = 'N')
  5701        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5702        CONTINUE
  5703     ELSE
  5704        GO TO 12001-CHECK-DCC-MNET-LF
  5705     END-IF
  5706
  5707     IF CP-RATE-DEV-PCT NOT = ZEROS
  5708        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5709           CP-PREMIUM-RATE
  5710     END-IF
  5711     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5712     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5713          ** ((M - 1) * -1))) / K)
  5714     COMPUTE ANGLEM = ((1 - ((1 + K)
  5715          ** (M * -1))) / K)
  5716     MOVE CP-MONTHLY-PAYMENT     TO RA
  5717     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5718        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  5719        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page 104
* ELRATE.cbl
  5720        CP-PREMIUM-RATE / 1000
  5721     MOVE WK3                    TO CP-CALC-PREMIUM
  5722
  5723     GO TO 99999-RETURN
  5724
  5725     .
  5726 12001-CHECK-DCC-MNET-LF.
  5727
  5728     IF (CP-COMPANY-ID EQUAL 'DCC')
  5729        AND (CP-EARN-AS-NET-PAY)
  5730        AND (CP-BENEFIT-CD (1:1) = 'N')
  5731        AND (CP-BEN-CATEGORY NOT = 'N')
  5732        CONTINUE
  5733     ELSE
  5734        GO TO 12001-CHECK-DCC-MNET-SUMLF
  5735     END-IF
  5736
  5737     IF CP-RATE-DEV-PCT NOT = ZEROS
  5738        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5739           CP-PREMIUM-RATE
  5740     END-IF
  5741*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5742     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5743        / (1 + I)
  5744     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5745     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5746     COMPUTE WK2 = (1 + J) ** (M * -1)
  5747     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5748     COMPUTE ANGLEM = ((1 - ((1 + J)
  5749          ** (M * -1))) / J) / OD
  5750     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5751     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5752          ** ((N - M) * -1))) / I)
  5753     MOVE +0                     TO WK3
  5754     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5755        (WS-COUNTER > M)
  5756        COMPUTE ANGLEM = (1 - ((1 + J)
  5757          ** ((M - WS-COUNTER + 1) * -1))) / J
  5758        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5759        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5760        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5761     END-PERFORM
  5762     MOVE WK3                    TO CP-CALC-PREMIUM
  5763
  5764     GO TO 99999-RETURN
  5765
  5766     .
  5767 12001-CHECK-DCC-MNET-SUMLF.
  5768
  5769     IF (CP-COMPANY-ID EQUAL 'DCC')
  5770        AND (CP-EARN-AS-NET-PAY)
  5771        AND (CP-BENEFIT-CD (1:1) = 'S')
  5772        AND (CP-BEN-CATEGORY NOT = 'N')
  5773        CONTINUE
  5774     ELSE
  5775        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  5776     END-IF
  5777
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page 105
* ELRATE.cbl
  5778     IF CP-RATE-DEV-PCT NOT = ZEROS
  5779        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5780           CP-PREMIUM-RATE
  5781     END-IF
  5782     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5783     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5784        / (1 + K)
  5785     COMPUTE ANGLEN-M = (WK5 / I)
  5786     COMPUTE WK2 = (1 + K) ** (M * -1)
  5787     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5788     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5789     COMPUTE ANGLEM = ((1 - ((1 + K)
  5790          ** (M * -1))) / K) / Y
  5791     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5792     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  5793        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5794        - 1)) / K) * RA
  5795     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5796        + (CP-DAYS-TO-1ST-PMT - +30)
  5797        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5798        +0 / 1000 * 12 / 12)
  5799     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  5800        * (12 / 12)
  5801     MOVE WK3                    TO CP-CALC-PREMIUM
  5802
  5803     GO TO 99999-RETURN
  5804
  5805     .
  5806 12001-CHECK-DCC-MNET-TOT-BAL-N.
  5807
  5808     IF (CP-COMPANY-ID EQUAL 'DCC')
  5809        AND (CP-EARN-AS-NET-PAY)
  5810        AND (CP-BENEFIT-CD (1:1) = 'N')
  5811        AND (CP-BEN-CATEGORY = 'N')
  5812        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5813        CONTINUE
  5814     ELSE
  5815        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  5816     END-IF
  5817
  5818*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5819     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5820        / (1 + I)
  5821     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5822     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  5823     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5824     COMPUTE WK2 = (1 + J) ** (M * -1)
  5825     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5826     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5827          ** ((M - 1) * -1))) / J)
  5828     COMPUTE ANGLEM = ((1 - ((1 + J)
  5829          ** (M * -1))) / J) / OD
  5830     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5831        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  5832        / ANGLEM-1
  5833     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5834          ** ((N - M) * -1))) / I)
  5835     MOVE +0                     TO WK3
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page 106
* ELRATE.cbl
  5836     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5837        (WS-COUNTER > M)
  5838        COMPUTE ANGLEM = (1 - ((1 + J)
  5839          ** ((M - WS-COUNTER) * -1))) / J
  5840        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  5841        COMPUTE WK5-CSL = (RA * ANGLEM)
  5842        + (CP-ALTERNATE-BENEFIT * WK2)
  5843        COMPUTE WK3 = WK3 +
  5844         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  5845        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  5846          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  5847          (CP-DCC-AH-RATE / 1000)
  5848     END-PERFORM
  5849     MOVE WK3                    TO CP-CALC-PREMIUM
  5850
  5851     GO TO 99999-RETURN
  5852
  5853     .
  5854 12001-CHECK-DCC-MNET-TOT-BAL-S.
  5855
  5856     IF (CP-COMPANY-ID EQUAL 'DCC')
  5857        AND (CP-EARN-AS-NET-PAY)
  5858        AND (CP-BENEFIT-CD (1:1) = 'S')
  5859        AND (CP-BEN-CATEGORY = 'N')
  5860        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5861        CONTINUE
  5862     ELSE
  5863        GO TO 12001-CHECK-DCC-MNET-TOT-N
  5864     END-IF
  5865
  5866     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5867     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5868          ** ((M - 1) * -1))) / K)
  5869     COMPUTE ANGLEM = ((1 - ((1 + K)
  5870          ** (M * -1))) / K)
  5871     MOVE CP-MONTHLY-PAYMENT     TO RA
  5872     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5873        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  5874        * CP-DCC-AH-RATE / 1000))
  5875        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5876        CP-DCC-LF-RATE / 1000
  5877     MOVE WK3                    TO CP-LF-PREM
  5878     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  5879        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  5880        * CP-DCC-AH-RATE / 1000
  5881     COMPUTE WK3 = WK3 + WK5-CSL
  5882     MOVE WK3                    TO CP-CALC-PREMIUM
  5883
  5884     GO TO 99999-RETURN
  5885      .
  5886 12001-CHECK-DCC-MNET-TOT-N.
  5887
  5888     IF (CP-COMPANY-ID EQUAL 'DCC')
  5889        AND (CP-EARN-AS-NET-PAY)
  5890        AND (CP-BENEFIT-CD (1:1) = 'N')
  5891        AND (CP-BEN-CATEGORY = 'N')
  5892        CONTINUE
  5893     ELSE
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page 107
* ELRATE.cbl
  5894        GO TO 12001-CHECK-DCC-MNET-TOT-S
  5895     END-IF
  5896
  5897*    I = APR/1200
  5898*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  5899*    RA = PAYMENT AMOUNT
  5900*    WK5-CSL = THE BALANCE (PAY OFF )
  5901*    WK3 = THE ACCUMULATED PREMIUM
  5902*    WK2 = (1 + I) ^ (m * -1)
  5903*    OD  = GAMMA
  5904*
  5905*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5906     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5907        / (1 + I)
  5908     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5909     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  5910        (CP-DCC-AH-RATE / +1000)
  5911     COMPUTE WK2 = (1 + J) ** (M * -1)
  5912     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5913     COMPUTE ANGLEM = ((1 - ((1 + J)
  5914          ** (M * -1))) / J) / OD
  5915     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5916     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5917          ** ((N - M) * -1))) / I)
  5918     MOVE +0                     TO WK3
  5919     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5920        (WS-COUNTER > M)
  5921        COMPUTE ANGLEM = (1 - ((1 + J)
  5922          ** ((M - WS-COUNTER + 1) * -1))) / J
  5923        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5924        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5925        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  5926           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  5927     END-PERFORM
  5928     MOVE WK3                    TO CP-CALC-PREMIUM
  5929
  5930     GO TO 99999-RETURN
  5931
  5932     .
  5933 12001-CHECK-DCC-MNET-TOT-S.
  5934
  5935     IF (CP-COMPANY-ID EQUAL 'DCC')
  5936        AND (CP-EARN-AS-NET-PAY)
  5937        AND (CP-BENEFIT-CD (1:1) = 'S')
  5938        AND (CP-BEN-CATEGORY = 'N')
  5939        CONTINUE
  5940     ELSE
  5941        GO TO 12001-CONTINUE-NET
  5942     END-IF
  5943
  5944*    I = APR/1200
  5945*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  5946*    RA = PAYMENT AMOUNT
  5947*    WK5-CSL = THE BALANCE (PAY OFF )
  5948*    WK3 = THE ACCUMULATED PREMIUM
  5949*    WK2 = (1 + I) ^ (m * -1)
  5950*    OD  = GAMMA
  5951*
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page 108
* ELRATE.cbl
  5952     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  5953     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  5954        / (1 + J)
  5955     COMPUTE ANGLEM = ((1 - ((1 + J)
  5956          ** (M * -1))) / J) / OD
  5957     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5958          ** ((N - M) * -1))) / I)
  5959          * (1 + J) ** (-1 * M)
  5960     COMPUTE ANGLEN-M = ANGLEN-M / OD
  5961     MOVE CP-MONTHLY-PAYMENT     TO RA
  5962     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  5963        / +30)
  5964     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  5965        ** (WK1) - 1)) / J) * RA
  5966     COMPUTE WK5 = (((((M * (M + 1) / 2)
  5967        + (CP-DAYS-TO-1ST-PMT - +30)
  5968        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  5969        CP-DCC-AH-RATE / +1000 * 12 / 12)
  5970     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  5971        (12 / 12)
  5972     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  5973        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  5974        (CP-DCC-AH-RATE / +1000) * 12 / 12
  5975     COMPUTE WK3 = WK3 + WK5-CSL
  5976     MOVE WK3                    TO CP-CALC-PREMIUM
  5977     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5978     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5979        / (1 + K)
  5980     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5981          ** ((N - M) * -1))) / I)
  5982     COMPUTE WK2 = (1 + K) ** (M * -1)
  5983     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5984     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5985     COMPUTE ANGLEM = ((1 - ((1 + K)
  5986          ** (M * -1))) / K) / Y
  5987*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5988     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  5989        ((1 + K) ** (M + 1 / Y
  5990        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5991        - 1)) / K) * RA
  5992     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5993        + (CP-DAYS-TO-1ST-PMT - +30)
  5994        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5995        CP-DCC-AH-RATE / 1000 * 12 / 12)
  5996     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  5997        * (12 / 12)
  5998     MOVE WK3                    TO CP-LF-PREM
  5999
  6000     GO TO 99999-RETURN
  6001
  6002     .
  6003 12001-CONTINUE-NET.
  6004
  6005     IF NET-STD
  6006        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  6007*          OR 'DCC'
  6008         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  6009         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page 109
* ELRATE.cbl
  6010         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  6011         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  6012                               * ((1 + N) / (1 + M))
  6013         if (i = .0000000001)
  6014            and (wk3 = zeros)
  6015            move 1               to wk3
  6016         end-if
  6017        ELSE
  6018         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  6019         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  6020         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  6021         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  6022
  6023     IF NET-SMP
  6024         COMPUTE N2 = N * N
  6025         COMPUTE N3 = N2 * N
  6026         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  6027         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  6028         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  6029         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  6030         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  6031
  6032     IF NPO-PRUDENTIAL
  6033       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  6034           VARYING WS-COUNTER FROM 1 BY 1
  6035               UNTIL WS-COUNTER = N
  6036       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  6037       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  6038
  6039     MOVE WK3 TO FACTOR.
  6040
  6041     GO TO 99999-RETURN.
  6042
  6043 12100-PRU-CALC.
  6044     IF WS-COUNTER = 1
  6045         COMPUTE PWK = (I + 1)
  6046     ELSE
  6047         COMPUTE PWK = PWK * (I + 1).
  6048
  6049 12199-EXIT.
  6050      EXIT.
  6051
  6052 99000-ERROR.
  6053     MOVE +9999.999999999 TO N-P-FACTOR.
  6054     MOVE '4'             TO CP-RETURN-CODE.
  6055
  6056     GO TO 99999-EXIT.
  6057
  6058 99999-RETURN.
  6059     MOVE FACTOR          TO N-P-FACTOR.
  6060
  6061 99999-EXIT.
  6062      EXIT.
  6063 99999-DUMMY-STOP-RUN.
  6064
  6065* GOBACK.
  6066     MOVE '9%                    "   ' TO DFHEIV0
  6067     MOVE 'ELRATE' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 31-Aug-15 14:57 Page 110
* ELRATE.cbl
  6068     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6069     GOBACK.
  6070
  6071
  6072 9999-DFHBACK SECTION.
  6073     MOVE '9%                    "   ' TO DFHEIV0
  6074     MOVE 'ELRATE' TO DFHEIV1
  6075     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6076     GOBACK.
  6077 9999-DFHEXIT.
  6078     IF DFHEIGDJ EQUAL 0001
  6079         NEXT SENTENCE
  6080     ELSE IF DFHEIGDJ EQUAL 2
  6081         GO TO 9999-RATE-NOTFND,
  6082               9999-RATE-NOTOPEN,
  6083               9999-RATE-NOTFND
  6084         DEPENDING ON DFHEIGDI.
  6085     MOVE '9%                    "   ' TO DFHEIV0
  6086     MOVE 'ELRATE' TO DFHEIV1
  6087     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6088     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2620     Code:       56141
