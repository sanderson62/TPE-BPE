* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   1
* EL152.cbl
* Options: int("EL152.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL152.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL152.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL152.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL152 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/14/94 08:03:40.
     7*                            VMOD=2.055.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*REMARKS.    TRANSACTION - EX27 - CLAIMS LETTER WRITER.
    13
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   2
* EL152.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23*                                REMOVE OBSOLETE CODE
    24* 102703                   SMVA  MOD COPY MEMBER ELCNAMET TO LEAVE
    25*                                CERTIFICATION DESIGNATION ON
    26*                                PROCESSOR NAME LINE IN CAPS
    27* 121203                   SMVA  ADD PROCESSING FOR NEW CLM TYP G
    28* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    29* 042605    2005042100002  PEMA  FIX TEMP STORAGE PROBLEMS
    30* 010407    2006111300003  PEMA  ADD PROCESSING FOR CARRIER 8
    31* 060109  CR2008102800002  PEMA  ADD VAR 16.1
    32* 033110  CR2009122800001  AJRA  NAPERSOFT
    33* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
    34* 011212  IR2012011100002  AJRA  FIX DCC PROMPT LETTER
    35* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    36* 041513  CR2013011500003  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    37* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    38******************************************************************
    39 ENVIRONMENT DIVISION.
    40
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   3
* EL152.cbl
    42 DATA DIVISION.
    43 WORKING-STORAGE SECTION.
    44 01  DFH-START PIC X(04).
    45 77  FILLER  PIC X(32)  VALUE '********************************'.
    46 77  FILLER  PIC X(32)  VALUE '*    EL152 WORKING STORAGE     *'.
    47 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    48
    49*77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    50*77  LCP-WS-ADDR-PNTR REDEFINES LCP-WS-ADDR-COMP
    51*                                  USAGE POINTER.
    52 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    53 77  LCP-WS-ADDR-PNTR REDEFINES LCP-WS-ADDR-COMP
    54                                   USAGE POINTER.
    55 77  B1                          PIC S9(5) COMP-3 VALUE +0.
    56 77  S1                          PIC S9 VALUE +0.
    57 77  S2                          PIC S9 VALUE +0.
    58 01  P pointer.
    59 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    60 01  var-ptr pointer.
    61 01  env-var-len                 pic 9(4)  binary.
    62 01  rc                          pic 9(9)  binary.
    63 01  WS-KIXSYS.
    64     05  WS-KIX-FIL1             PIC X(10).
    65     05  WS-KIX-APPS             PIC X(10).
    66     05  WS-KIX-ENV              PIC X(10).
    67     05  WS-KIX-MYENV            PIC X(10).
    68     05  WS-KIX-SYS              PIC X(10).
    69 01  WS-HOLDING-ZIPS.
    70     05  FILLER              PIC X(10)  VALUE '--AM-ZIP--'.
    71     05  WS-AM-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    72     05  FILLER              PIC X(10)  VALUE '--AT-ZIP--'.
    73     05  WS-AT-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    74     05  FILLER              PIC X(10)  VALUE '--BE-ZIP--'.
    75     05  WS-BE-ZIP-CODE      PIC X(9)   VALUE 'XXXXXXXXX'.
    76     05  FILLER              PIC X(10)  VALUE '--CO-ZIP--'.
    77     05  WS-CO-ZIP           PIC X(9)   VALUE 'XXXXXXXXX'.
    78     05  FILLER              PIC X(17)  VALUE '--AM-ZIP-BEFORE--'.
    79     05  WS-AM-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    80     05  FILLER              PIC X(17)  VALUE '--AT-ZIP-BEFORE--'.
    81     05  WS-AT-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    82     05  FILLER              PIC X(17)  VALUE '--BE-ZIP-BEFORE--'.
    83     05  WS-BE-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    84     05  FILLER              PIC X(17)  VALUE '--CO-ZIP-BEFORE--'.
    85     05  WS-CO-ZIP-BEFORE    PIC X(9)   VALUE 'XXXXXXXXX'.
    86     05  FILLER              PIC X(17)  VALUE '-----------------'.
    87
    88*                            COPY ELCSCTM.
    89******************************************************************
    90*                                                                *
    91*                                                                *
    92*                            ELCSCTM                             *
    93*                            VMOD=2.001                          *
    94*                                                                *
    95*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    96*                                                                *
    97******************************************************************
    98 01  SECURITY-MESSAGE.
    99     12  FILLER                          PIC X(30)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   4
* EL152.cbl
   100            VALUE '** LOGIC SECURITY VIOLATION -'.
   101     12  SM-READ                         PIC X(6).
   102     12  FILLER                          PIC X(5)
   103            VALUE ' PGM='.
   104     12  SM-PGM                          PIC X(6).
   105     12  FILLER                          PIC X(5)
   106            VALUE ' OPR='.
   107     12  SM-PROCESSOR-ID                 PIC X(4).
   108     12  FILLER                          PIC X(6)
   109            VALUE ' TERM='.
   110     12  SM-TERMID                       PIC X(4).
   111     12  FILLER                          PIC XX   VALUE SPACE.
   112     12  SM-JUL-DATE                     PIC 9(5).
   113     12  FILLER                          PIC X    VALUE SPACE.
   114     12  SM-TIME                         PIC 99.99.
   115
   116
   117*                            COPY ELCSCRTY.
   118******************************************************************
   119*                                                                *
   120*                                                                *
   121*                            ELCSCRTY                            *
   122*                            VMOD=2.001                          *
   123*                                                                *
   124*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   125*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   126*        SAVED IN PI-SECURITY-ADDRESS.                           *
   127*                                                                *
   128******************************************************************
   129 01  SECURITY-CONTROL.
   130     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   131     12  FILLER                       PIC XX    VALUE 'SC'.
   132     12  SC-CREDIT-CODES.
   133         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   134             20  SC-CREDIT-DISPLAY    PIC X.
   135             20  SC-CREDIT-UPDATE     PIC X.
   136     12  SC-CLAIMS-CODES.
   137         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   138             20  SC-CLAIMS-DISPLAY    PIC X.
   139             20  SC-CLAIMS-UPDATE     PIC X.
   140
   141 01  WS-DATE-AREA.
   142     12  SAVE-DATE               PIC X(08)    VALUE SPACES.
   143     12  SAVE-BIN-DATE           PIC XX       VALUE SPACES.
   144     12  W-REVERSE-DATE-SW       PIC X        VALUE SPACES.
   145         88  W-REVERSE-DATE                   VALUE 'Y'.
   146     12  W-EDIT-DATE-1.
   147         16  W-ED1-MM            PIC XX.
   148         16  FILLER              PIC X        VALUE '/'.
   149         16  W-ED1-DD            PIC XX.
   150         16  FILLER              PIC X        VALUE '/'.
   151         16  W-ED1-YY            PIC XX.
   152     12  W-EDIT-DATE-2.
   153         16  W-ED2-DD            PIC XX.
   154         16  FILLER              PIC X        VALUE '/'.
   155         16  W-ED2-MM            PIC XX.
   156         16  FILLER              PIC X        VALUE '/'.
   157         16  W-ED2-YY            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   5
* EL152.cbl
   158 01  FILLER.
   159     05  WS-WORK-INT-RATE        PIC 99.999.
   160     05  WS-WORK-INT REDEFINES WS-WORK-INT-RATE
   161                                 PIC X(6).
   162 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
   163     'BEGINJOB mode=''MVS'''.
   164 01  TRAN-DATA-LINE2.
   165*     05  FILLER                  PIC X(39)    VALUE
   166*     '"smtp -f EL152cl2 -t pema,kmsb,jmsb -s '.
   167     05  FILLER                  PIC X(29)    VALUE
   168     '"smtp -f EL152cl2 -t ajra -s '.
   169     05  TRAN-DETAIL.
   170         10  FILLER              PIC XX       VALUE
   171         ''' '.
   172         10  TRAN-DL2-USER       PIC X(05)    VALUE SPACES.
   173         10  TRAN-DL2-ARCHNO     PIC ZZZZ999  VALUE ZEROS.
   174         10  FILLER              PIC X        VALUE SPACES.
   175         10  TRAN-DL2-CCC        PIC X(22)    VALUE SPACES.
   176     05  FILLER                  PIC XX       VALUE '''"'.
   177     05  FILLER                  PIC X(30)    VALUE SPACES.
   178 01  TRAN-DATA-LINE3             PIC X(80)    VALUE
   179     'ENDJOB            '.
   180
   181 01  WS-PRINTER-ID               PIC X(4)    VALUE SPACES.
   182 01  STANDARD-AREAS.
   183     12  WS-ACCT-READ-SW         PIC X       VALUE ' '.
   184     12  WS-COMP-READ-SW         PIC X       VALUE ' '.
   185     12  WS-PROD-READ-SW         PIC X       VALUE ' '.
   186     12  SC-ITEM                 PIC S9(4)   VALUE +1  COMP.
   187     12  MAP-NAME.
   188         16  MAP-PREFIX          PIC XX      VALUE 'EL'.
   189         16  MAP-NUMBER          PIC X(4)    VALUE '152A'.
   190         16  MAP-FILLER          PIC XX      VALUE SPACES.
   191     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   192     12  MAPSET-NAME             PIC X(8)    VALUE 'EL152S'.
   193     12  TRANS-ID                PIC X(4)    VALUE 'EX27'.
   194     12  PRINT-TRANS             PIC X(4)    VALUE 'EX57'.
   195     12  LGXX-ID                 PIC X(4)    VALUE 'LGXX'.
   196     12  PGM-NAME                PIC X(8).
   197     12  TIME-IN                 PIC S9(7).
   198     12  TIME-OUT-R  REDEFINES TIME-IN.
   199         16  FILLER              PIC X.
   200         16  TIME-OUT            PIC 99V99.
   201         16  FILLER              PIC XX.
   202     12  XCTL-005                PIC X(5)    VALUE 'EL005'.
   203     12  XCTL-010                PIC X(5)    VALUE 'EL010'.
   204     12  XCTL-126                PIC X(5)    VALUE 'EL126'.
   205     12  LINK-001                PIC X(5)    VALUE 'EL001'.
   206     12  LINK-004                PIC X(5)    VALUE 'EL004'.
   207     12  LINK-ELDATCV            PIC X(7)    VALUE 'ELDATCV'.
   208     12  THIS-PGM                PIC X(8)    VALUE 'EL152'.
   209     12  LINK-EL1522             PIC X(8)    VALUE 'EL1522'.
   210     12  PGM-EL126               PIC X(8)    VALUE 'EL126'.
   211     12  PGM-EL150               PIC X(8)    VALUE 'EL150'.
   212     12  PGM-EL141               PIC X(8)    VALUE 'EL141'.
   213     12  PGM-EL1042              PIC X(8)    VALUE 'EL1042'.
   214     12  SUB                     PIC 99.
   215     12  WS-LABELS-SW            PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   6
* EL152.cbl
   216
   217     12  WS-PI-QID.
   218         16  QID-TERM            PIC X(4)    VALUE SPACES.
   219         16  FILLER              PIC X(4)    VALUE '152A'.
   220
   221     12  W-LETTER-ADDRESS-TYPE.
   222         16  W-LETTER-ADDR-TYPE  PIC  X VALUE SPACES.
   223         16  W-LETTER-ADDR-SEQ   PIC  9 VALUE ZEROS.
   224
   225     12  W-ADDRESS-SELECTION.
   226         16  W-ACCOUNT           PIC  9 VALUE ZEROS.
   227         16  W-BENEFICIARY       PIC  9 VALUE ZEROS.
   228         16  W-EMPLOYER          PIC  9 VALUE ZEROS.
   229         16  W-INSURED           PIC  9 VALUE ZEROS.
   230         16  W-OTHER-1           PIC  9 VALUE ZEROS.
   231         16  W-OTHER-2           PIC  9 VALUE ZEROS.
   232         16  W-PHYSICIAN         PIC  9 VALUE ZEROS.
   233
   234     12  W-Z-CONTROL-DATA.
   235         16  W-NUMBER-OF-COPIES  PIC  9.
   236         16  FILLER              PIC  X.
   237         16  W-DAYS-TO-FOLLOW-UP PIC  999.
   238         16  FILLER              PIC  X.
   239         16  W-DAYS-TO-RESEND-1  PIC  999.
   240         16  FILLER              PIC  X.
   241         16  W-FORM-TO-RESEND    PIC  X(4).
   242         16  FILLER              PIC  X(1).
   243         16  W-PROMPT-LETTER     PIC  X(1).
   244         16  FILLER              PIC  X(1).
   245         16  W-ENCLOSURE-CD      PIC  X(3).
   246         16  FILLER              PIC  X(1).
   247         16  W-AUTO-CLOSE-IND    PIC  X(1).
   248         16  FILLER              PIC  X(1).
   249         16  W-LETTER-TO-BENE    PIC  X(1).
   250
   251     12  W-CREDIT-CARD-LOAN-NO.
   252         16  W-LOAN-NO           PIC  X(08).
   253         16  W-CURRENT-LOAN-NO   PIC  X(12).
   254
   255     12  W-GROUPING.
   256         16  W-GROUP-3           PIC  XXX.
   257         16  FILLER              PIC  XXX.
   258
   259     12  W-NAME.
   260         16  W-FIRST-NAME        PIC  X(12).
   261         16  W-MIDDLE-NAME       PIC  X(12).
   262         16  W-LAST-NAME         PIC  X(15).
   263
   264     12  WS-PHONE-IN             PIC 9(11)   VALUE ZEROS.
   265     12  WS-PHONE-IN-R  REDEFINES WS-PHONE-IN.
   266         16  FILLER              PIC 9.
   267         16  WSPI-AREA           PIC 9(3).
   268         16  WSPI-PFX            PIC 9(3).
   269         16  WSPI-SFX            PIC 9(4).
   270     12  WS-PHONE-OUT.
   271         16  WSPO-AREA           PIC X(3).
   272         16  FILLER              PIC X       VALUE '-'.
   273         16  WSPO-PFX            PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   7
* EL152.cbl
   274         16  FILLER              PIC X       VALUE '-'.
   275         16  WSPO-SFX            PIC X(4).
   276
   277     12  WS-ZIP-NUMERIC          PIC 9(9).
   278     12  WS-ZIP-NONNUM  REDEFINES  WS-ZIP-NUMERIC
   279                                 PIC X(9).
   280
   281     12  WS-ZIP-CODE.
   282         16  WS-AM-ZIP-CODE      PIC X(5).
   283         16  WS-AM-ZIP-DASH      PIC X.
   284         16  WS-AM-ZIP-PLUS4     PIC X(4).
   285     12  WS-ZIP-CODE-CANADIAN  REDEFINES  WS-ZIP-CODE.
   286         16  WS-CAN-POSTAL-1     PIC XXX.
   287         16  FILLER              PIC X.
   288         16  WS-CAN-POSTAL-2     PIC XXX.
   289         16  FILLER              PIC XXX.
   290
   291     12  WS-LABEL-HOLD-AREA.
   292         16  WS-LABEL-LINES OCCURS 6 TIMES
   293                            INDEXED BY WS-NDX  WS-NDX2.
   294             20  WS-LABEL-ZIP.
   295                 24  WS-LABEL-1ST-ZIP  PIC X(5).
   296                 24  FILLER            PIC X.
   297                 24  WS-LABEL-2ND-ZIP  PIC X(4).
   298             20  FILLER                PIC X(9).
   299             20  WS-LAST-DIGIT         PIC X.
   300             20  WS-LAST-ZIP.
   301                 24  WS-LAST-1ST-ZIP   PIC X(5).
   302                 24  FILLER            PIC X.
   303                 24  WS-LAST-2ND-ZIP   PIC X(4).
   304
   305     12  WS-DATA-FOUND-SW            PIC X.
   306         88  NO-CHARACTERS-FOUND           VALUE 'N'.
   307
   308     12  WS-SKIP-EMAIL           PIC X       VALUE 'N'.
   309     12  WS-STATE-LINE           PIC X       VALUE 'N'.
   310     12  WS-PROCESSOR-LINE       PIC X(01)   VALUE 'N'.
   311     12  WS-CAPS-SW              PIC X(01)   VALUE 'N'.
   312         88  THE-REST-R-CAPS                 VALUE 'Y'.
   313     12  WS-POSITION2            PIC S9(4)   COMP.
   314     12  WS-POSITION21           PIC S9(4)   COMP.
   315     12  WS-WORD-LENGTH          PIC S9(4)   COMP-3.
   316
   317     12  WS-TEMP-AREA1.
   318         16  WS-TEMP-1           PIC X OCCURS 29
   319                                       INDEXED BY TA1.
   320     12  WS-TEMP-AREA2.
   321         16  WS-TEMP-2           PIC X OCCURS 30
   322                                       INDEXED BY TA2
   323                                                  TA21
   324                                                  MOVE-INDX.
   325
   326     12  WS-SAVE-TEMP-AREA2      PIC X(30)   VALUE SPACES.
   327
   328     12  ACCT-BROWSE-STARTED     PIC X       VALUE 'N'.
   329     12  TEXT-BROWSE-STARTED     PIC X       VALUE 'N'.
   330     12  ARCH-BROWSE-STARTED     PIC X       VALUE 'N'.
   331     12  ACTV-BROWSE-STARTED     PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   8
* EL152.cbl
   332     12  PROD-BROWSE-STARTED     PIC X       VALUE 'N'.
   333     12  INDX-WORK               PIC 99.
   334     12  TEMP-CURR-LINE          PIC S9(3)    COMP-3.
   335
   336     12  DATE-WORK               PIC 9(7).
   337     12  DT-REDEF REDEFINES DATE-WORK.
   338         16  FILLER              PIC XX.
   339         16  DT-WORK             PIC 9(5).
   340
   341     12  BEN-HOLD                PIC XX.
   342
   343     12  BENEFIT-WORK            PIC XXX.
   344     12  BEN-R REDEFINES BENEFIT-WORK.
   345         16  ELIM-DAYS           PIC XX.
   346         16  FILLER              PIC X.
   347
   348     12  GETMAIN-SWITCH          PIC 9        VALUE 0.
   349         88  NO-GETMAIN-DONE-YET              VALUE 0.
   350         88  REFRESH-GETMAIN-AREA             VALUE 1.
   351
   352     12  WORK-AMOUNT             PIC S9(9)V99 VALUE +0.
   353     12  CURRENT-SAVE            PIC XX.
   354     12  CURRENT-PLUS3-SAVE      PIC XX.
   355     12  RESEND-SAVE             PIC XX    VALUE LOW-VALUE.
   356     12  FOLLOW-UP-SAVE          PIC XX    VALUE LOW-VALUE.
   357     12  SEQ-COUNTER             PIC S9(4) COMP.
   358     12  CORR-TRLR-SEQ           PIC S9(4) COMP.
   359     12  DEEDIT-FIELD            PIC X(15).
   360     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   361
   362     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   363     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   364
   365     12  LOWER-CASE PIC X(26) VALUE 'abcdefghijklmnopqrstuvwxyz'.
   366     12  UPPER-CASE PIC X(26) VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
   367
   368     12  WS-CCN-12               PIC X(12).
   369
   370     12  WS-ADDR-TYPE-CD.
   371         16  WS-ADDR-TYPE        PIC X.
   372         16  WS-ADDR-SEQ         PIC X.
   373         16  WS-ADDR-SEQ-NUM REDEFINES
   374             WS-ADDR-SEQ         PIC 9.
   375
   376     12  WS-DMD-CERT-STATE       PIC XX.
   377     12  WS-DMD-CERT-GROUPING    PIC XX.
   378     12  WS-DMD-BEN-CODE         PIC XX.
   379     12  WS-DMD-CORR-TRLR-SEQ    PIC S9(4) COMP.
   380     12  WS-DMD-LETTER-FORM      PIC X(4).
   381     12  WS-DMD-RES-ST           PIC XX.
   382
   383     12  WS-DMD-UND-STATEMENT    PIC X(50)  VALUE
   384          'Central States provides plan administration for'.
   385
   386     12  WS-DMD-UND-COMPANYA     PIC X(50)  VALUE
   387          'Central States Health and Life Co.'.
   388
   389     12  WS-DMD-UND-COMPANYB     PIC X(50)  VALUE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   9
* EL152.cbl
   390          'Central States Indemnity Co.'.
   391
   392* DLO023
   393 01  DL23-COMM-LENGTH            PIC S9(4) COMP VALUE +132.
   394 01  WS-DLO-CODES-TABLE.
   395     12  DL23-SYSTEM-ID          PIC XX.
   396     12  DL23-RECORD-TYPE        PIC XX.
   397     12  DL23-RECORD-KEY         PIC X(6).
   398     12  DL23-RETURN-CODE        PIC XX.
   399     12  DL23-CODE-DESC          PIC X(60).
   400     12  DL23-GEN-DESC-1         PIC X(20).
   401     12  DL23-GEN-DESC-2         PIC X(20).
   402     12  DL23-GEN-DESC-3         PIC X(20).
   403     12  WS-LETTER-STATUS        PIC X        VALUE ' '.
   404     12  WS-BLANK                PIC X        VALUE ' '.
   405
   406 01  WS-SAVE-ACCT-RECORD         PIC X(2000)  VALUE SPACES.
   407 01  WS-SAVE-PRODUCER-RECORD     PIC X(2000)  VALUE SPACES.
   408
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  10
* EL152.cbl
   410 01  ACCESS-KEYS-AND-FILE-IDS.
   411     12  CNTL-ID                  PIC X(8)    VALUE 'ELCNTL'.
   412     12  ACCT-ID                  PIC X(8)    VALUE 'ERACCT'.
   413     12  CERT-ID                  PIC X(8)    VALUE 'ELCERT'.
   414     12  ARCH-ID                  PIC X(8)    VALUE 'ELARCH'.
   415     12  ARCT-ID                  PIC X(8)    VALUE 'ELARCT'.
   416     12  CLAM-ID                  PIC X(8)    VALUE 'ELMSTR'.
   417     12  TEXT-ID                  PIC X(8)    VALUE 'ELLETR'.
   418     12  ACTV-ID                  PIC X(8)    VALUE 'ELTRLR'.
   419     12  BENE-ID                  PIC X(8)    VALUE 'ELBENE'.
   420     12  PROD-ID                  PIC X(8)    VALUE 'MPPROD'.
   421     12  PLCY-ID                  PIC X(8)    VALUE 'MPPLCY'.
   422     12  PLAN-ID                  PIC X(8)    VALUE 'MPPLAN'.
   423     12  NAPS-ID                  PIC X(8)    VALUE 'ELNAPS'.
   424     12  ENCC-ID                  PIC X(8)    VALUE 'ELENCC'.
   425
   426     12  CNTL-KEY.
   427         16  CNTL-CO              PIC X(3).
   428         16  CNTL-RECORD-TYPE     PIC X       VALUE '1'.
   429         16  CNTL-GENL.
   430           18 CNTL-GEN1           PIC XX      VALUE SPACES.
   431           18 CNTL-GEN2.
   432             20 CNTL-GEN3         PIC X       VALUE SPACES.
   433             20 CNTL-GEN4         PIC X       VALUE SPACES.
   434         16  CNTL-SEQ             PIC S9(4)   VALUE +0    COMP.
   435
   436      12  WS-ERCOMP-KEY.
   437          16  WS-ERCOMP-COMPANY-CD PIC X.
   438          16  WS-ERCOMP-CARRIER    PIC X.
   439          16  WS-ERCOMP-GROUPING   PIC X(6).
   440          16  WS-ERCOMP-RESP-NO    PIC X(10).
   441          16  WS-ERCOMP-ACCOUNT    PIC X(10).
   442          16  WS-ERCOMP-TYPE       PIC X.
   443
   444     12  CLAM-KEY.
   445         16  CLAM-CO              PIC X.
   446         16  CLAM-CARRIER         PIC X.
   447         16  CLAM-CLAIM           PIC X(7).
   448         16  CLAM-CERT-NUM        PIC X(11).
   449
   450     12  TEXT-KEY.
   451         16  TEXT-PARTIAL-KEY.
   452             20  TEXT-CO          PIC X.
   453             20  TEXT-LETTER      PIC X(4).
   454         16  TEXT-FILLER          PIC X(8)    VALUE SPACES.
   455         16  TEXT-SEQ             PIC S9(4)   VALUE +0    COMP.
   456
   457     12  ACTV-KEY.
   458         16  ACTV-PARTIAL-KEY.
   459             20  ACTV-CO          PIC X.
   460             20  ACTV-CARRIER     PIC X.
   461             20  ACTV-CLAIM       PIC X(7).
   462             20  ACTV-CERT-NUM    PIC X(11).
   463         16  ACTV-SEQ             PIC S9(4)   VALUE +0    COMP.
   464
   465     12  CERT-KEY.
   466         16  CERT-CO              PIC X.
   467         16  CERT-CARRIER         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  11
* EL152.cbl
   468         16  CERT-GROUPING        PIC X(6).
   469         16  CERT-STATE           PIC XX.
   470         16  CERT-ACCOUNT         PIC X(10).
   471         16  CERT-EFF-DT          PIC XX.
   472         16  CERT-CERT-NUM        PIC X(11).
   473
   474     12  ACCT-KEY.
   475         16  ACCT-PARTIAL-KEY.
   476             20  ACCT-CO              PIC X.
   477             20  ACCT-CARRIER         PIC X.
   478             20  ACCT-GROUPING        PIC X(6).
   479             20  ACCT-STATE           PIC XX.
   480             20  ACCT-ACCOUNT         PIC X(10).
   481         16  ACCT-EXP-DATE            PIC XX.
   482
   483     12  ARCH-KEY.
   484         16  ARCH-PARTIAL-KEY.
   485             20  ARCH-CO          PIC X.
   486             20  ARCH-NUMBER      PIC S9(8)      COMP.
   487         16  ARCH-REC-TYPE        PIC X.
   488         16  ARCH-SEQ             PIC S9(4)      COMP VALUE +0.
   489
   490     12  BENE-KEY.
   491         16  BENE-COMP-CD         PIC X.
   492         16  BENE-REC-TYPE        PIC X.
   493         16  BENE-NUMBER.
   494             20  BENE-CREDITOR    PIC XXX.
   495             20  FILLER           PIC X(7).
   496
   497     12  PROD-KEY.
   498         16  PROD-PARTIAL-KEY.
   499             20  PROD-CO          PIC X.
   500             20  PROD-CARRIER     PIC X.
   501             20  PROD-GROUPING    PIC X(6).
   502             20  PROD-STATE       PIC XX.
   503             20  PROD-PRODUCER    PIC X(10).
   504         16  PROD-EXP-DATE        PIC XX.
   505
   506     12  PLCY-KEY.
   507         16  PLCY-CO              PIC X.
   508         16  PLCY-CARRIER         PIC X.
   509         16  PLCY-GROUPING        PIC X(06).
   510         16  PLCY-STATE           PIC XX.
   511         16  PLCY-PRODUCER        PIC X(10).
   512         16  PLCY-EFF-DT          PIC XX.
   513         16  PLCY-REFERENCE-NO    PIC X(20).
   514
   515     12  PLAN-KEY.
   516         16  PLAN-CO              PIC X.
   517         16  PLAN-CARRIER         PIC X.
   518         16  PLAN-GROUPING        PIC X(6).
   519         16  PLAN-STATE           PIC XX.
   520         16  PLAN-PRODUCER        PIC X(10).
   521         16  PLAN-CODE            PIC XX.
   522         16  PLAN-REV-NO          PIC 999.
   523
   524     12  ELENCC-KEY.
   525         16  ELENCC-COMPANY-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  12
* EL152.cbl
   526         16  ELENCC-REC-TYPE      PIC X.
   527         16  ELENCC-ENC-CODE      PIC X(5).
   528         16  F                    PIC X(09).
   529
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  13
* EL152.cbl
   531     12  ARCH-SAVE-KEY           PIC X(5).
   532     12  ACTV-SAVE-KEY           PIC X(20).
   533     12  ACCT-SAVE-KEY           PIC X(20).
   534     12  PROD-SAVE-KEY           PIC X(20).
   535     12  ACCT-LENGTH             PIC S9(4)  COMP  VALUE +2000.
   536     12  ARCH-LENGTH             PIC S9(4)  COMP  VALUE +90.
   537     12  ARCT-LENGTH             PIC S9(4)  COMP  VALUE +90.
   538     12  ACTV-LENGTH             PIC S9(4)  COMP  VALUE +200.
   539     12  PROD-LENGTH             PIC S9(4)  COMP  VALUE +2000.
   540     12  NAPS-LENGTH             PIC S9(4)  COMP  VALUE +150.
   541     12  ENCC-LENGTH             PIC S9(4)  COMP  VALUE +400.
   542     12  TEXT-SAVE-KEY           PIC X(5).
   543     12  SAVE-VARIABLE-POINTER   PIC S9(8)   COMP.
   544     12  VAR-HOLD.
   545         16  V1                  PIC X.
   546         16  V2                  PIC X.
   547         16  V3                  PIC X.
   548         16  V4                  PIC X.
   549     12  V-HOLD REDEFINES VAR-HOLD.
   550         16  V-NUM               PIC 99.
   551         16  V-PERIOD            PIC X.
   552         16  V-DECIMAL           PIC 9.
   553
   554     12  MAX-LINES               PIC 999     VALUE 300.
   555     12  NUM-LINES-PER-SCREEN    PIC 99      VALUE 13.
   556     12  TS-NUM-REC-IN-GROUP     PIC 99      VALUE 50.
   557     12  TS-GROUP-WORK           PIC 9(5)    VALUE 0     COMP-3.
   558     12  TS-LENGTH               PIC S9(4)   VALUE +3650 COMP.
   559     12  TS-ITEM                 PIC S9(4)   VALUE +0    COMP.
   560     12  TS-MAP-LENGTH           PIC S9(4)   VALUE +1343 COMP.
   561     12  ROLL-COUNTER            PIC S999    VALUE +0    COMP-3.
   562     12  TS-NAME-TEXT.
   563         16  TS-ID-TEXT          PIC X(4)    VALUE '104A'.
   564         16  TS-ID-TIME REDEFINES TS-ID-TEXT  PIC S9(7) COMP-3.
   565         16  TS-TERM-TEXT.
   566          17 TS-TERM-PREFIX      PIC XX.
   567          17 FILLER              PIC XX.
   568     12  TS-NAME-SCREEN.
   569         16  FILLER              PIC X(4)    VALUE '152X'.
   570         16  TS-TERM-SCREEN      PIC X(4).
   571
   572     12  LINE-NUM.
   573         16  LINE1               PIC X.
   574         16  LINE23              PIC 99.
   575     12  LIN-NUM REDEFINES LINE-NUM  PIC 999.
   576     12  TOP-FORM                PIC X(70)
   577         VALUE '*****TOP OF FORM *****'.
   578     12  SINGLE-LINE             PIC X(70).
   579     12  SINGLE-LINE-BY-1 REDEFINES SINGLE-LINE.
   580         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY INDX1 INDX2
   581                                 PIC X.
   582     12  NAPERSOFT-LETTER        PIC X(16)
   583         VALUE 'Napersoft letter'.
   584
   585     12  WS-RESPONSE             PIC S9(8)   COMP.
   586         88  RESP-NORMAL              VALUE +00.
   587         88  RESP-ERROR               VALUE +01.
   588         88  RESP-NOTFND              VALUE +13.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  14
* EL152.cbl
   589         88  RESP-NOTOPEN             VALUE +19.
   590         88  RESP-ENDFILE             VALUE +20.
   591
   592 01  HAN-LETTER-REASON-DATA.
   593     12  WS-REASON-TEXT.
   594         16  WS-RE-NDX           PIC 99.
   595         16  FILLER              PIC X(68).
   596
   597     12  HAN-REASON-TABLE.
   598         16  FILLER              PIC X(50) VALUE
   599           'ADDITIONAL INFO REQUESTED FROM PHYSICIAN          '.
   600         16  FILLER              PIC X(50) VALUE
   601           'CHECKING PRE-EXISTING CONDITION                   '.
   602         16  FILLER              PIC X(50) VALUE
   603           'ADDITIONAL INFO RECEIVED / CLAIM REOPENED         '.
   604         16  FILLER              PIC X(50) VALUE
   605           'LETTER TO INSURED                                 '.
   606         16  FILLER              PIC X(50) VALUE
   607           'LETTER TO CREDITOR                                '.
   608         16  FILLER              PIC X(50) VALUE
   609           'LETTER TO EMPLOYER                                '.
   610         16  FILLER              PIC X(50) VALUE
   611           'LETTER TO INSURED / 2ND REQUEST                   '.
   612         16  FILLER              PIC X(50) VALUE
   613           'LETTER TO CREDITOR / 2ND REQUEST                  '.
   614         16  FILLER              PIC X(50) VALUE
   615           'LETTER TO EMPLOYER / 2ND REQUEST                  '.
   616         16  FILLER              PIC X(50) VALUE
   617           'AWAITING INITIAL CLAIM FORM                       '.
   618         16  FILLER              PIC X(50) VALUE
   619           'AWAITING SUPPLEMENTAL INFORMATION                 '.
   620         16  FILLER              PIC X(50) VALUE
   621           'DENIED / PRE-EXISTING CONDITION                   '.
   622         16  FILLER              PIC X(50) VALUE
   623           'DENIED / WAITING PERIOD NOT MET                   '.
   624         16  FILLER              PIC X(50) VALUE
   625           'DENIED / NORMAL PREGNANCY                         '.
   626         16  FILLER              PIC X(50) VALUE
   627           'DENIED / ACT OF WAR                               '.
   628         16  FILLER              PIC X(50) VALUE
   629           'DENIED / NOT TOTALLY DISABLED                     '.
   630         16  FILLER              PIC X(50) VALUE
   631           'DENIED / NOT UNDER CARE & TREATMENT OF PHYSICIAN  '.
   632         16  FILLER              PIC X(50) VALUE
   633           'DENIED / NO COVERAGE INFORCE                      '.
   634         16  FILLER              PIC X(50) VALUE
   635           'DENIED / DISABLED ON DATE OF LOAN                 '.
   636         16  FILLER              PIC X(50) VALUE
   637           'DENIED / OVER MAXIMUM AGE                         '.
   638         16  FILLER              PIC X(50) VALUE
   639           'CLOSED / CLAIM INFO NOT PROVIDED                  '.
   640         16  FILLER              PIC X(50) VALUE
   641           'PHYSICIAN INFORMATION INCOMPLETE                  '.
   642         16  FILLER              PIC X(50) VALUE
   643           'ACKNOWLEDGEMENT LETTER TO INSURED                 '.
   644         16  FILLER              PIC X(50) VALUE
   645           'DENIED/SUICIDE EXCLUSION                          '.
   646         16  FILLER              PIC X(50) VALUE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  15
* EL152.cbl
   647           'DENIED/LOAN EFFECTIVE BEFORE POLICY EFFECTIVE DATE'.
   648         16  FILLER              PIC X(50) VALUE
   649           'DENIED/JOINT DEBTORS NOT COVERED                  '.
   650         16  FILLER              PIC X(50) VALUE
   651           'DENIED/GROUP POLICY LAPSED                        '.
   652         16  FILLER              PIC X(50) VALUE
   653           'DENIED/DECEASED PRIOR TO POLICY EFFECTIVE DATE    '.
   654         16  FILLER              PIC X(50) VALUE
   655           'DENIED/LOAN TERM IN EXCESS OF MAXIMUM LOAN TERM   '.
   656         16  FILLER              PIC X(50) VALUE
   657           'DENIED/INSURED NOT PERMANENTLY & TOTALLY DISABLED '.
   658         16  FILLER              PIC X(50) VALUE
   659           'DENIED/IME EXAM DOES NOT SUPPORT CONT. DISABILITY '.
   660         16  FILLER              PIC X(50) VALUE
   661           'DENIED/INSURED DID NOT APPEAR FOR IME EXAM        '.
   662
   663     12  HAN-LETTER-REASON-TABLE  REDEFINES  HAN-REASON-TABLE.
   664         16  HAN-TABLE-ENTRIES  OCCURS  32  TIMES.
   665             20  HAN-REASON-TEXT PIC X(50).
   666
   667 01  ERROR-MESSAGES.
   668     12  ER-0000                 PIC X(4)  VALUE '0000'.
   669     12  ER-0004                 PIC X(4)  VALUE '0004'.
   670     12  ER-0006                 PIC X(4)  VALUE '0006'.
   671     12  ER-0008                 PIC X(4)  VALUE '0008'.
   672     12  ER-0013                 PIC X(4)  VALUE '0013'.
   673     12  ER-0023                 PIC X(4)  VALUE '0023'.
   674     12  ER-0029                 PIC X(4)  VALUE '0029'.
   675     12  ER-0033                 PIC X(4)  VALUE '0033'.
   676     12  ER-0042                 PIC X(4)  VALUE '0042'.
   677     12  ER-0047                 PIC X(4)  VALUE '0047'.
   678     12  ER-0051                 PIC X(4)  VALUE '0051'.
   679     12  ER-0066                 PIC X(4)  VALUE '0066'.
   680     12  ER-0067                 PIC X(4)  VALUE '0067'.
   681     12  ER-0070                 PIC X(4)  VALUE '0070'.
   682     12  ER-0133                 PIC X(4)  VALUE '0133'.
   683     12  ER-0154                 PIC X(4)  VALUE '0154'.
   684     12  ER-0168                 PIC X(4)  VALUE '0168'.
   685     12  ER-0169                 PIC X(4)  VALUE '0169'.
   686     12  ER-0172                 PIC X(4)  VALUE '0172'.
   687     12  ER-0174                 PIC X(4)  VALUE '0174'.
   688     12  ER-0175                 PIC X(4)  VALUE '0175'.
   689     12  ER-0176                 PIC X(4)  VALUE '0176'.
   690     12  ER-0177                 PIC X(4)  VALUE '0177'.
   691     12  ER-0178                 PIC X(4)  VALUE '0178'.
   692     12  ER-0179                 PIC X(4)  VALUE '0179'.
   693     12  ER-0180                 PIC X(4)  VALUE '0180'.
   694     12  ER-0181                 PIC X(4)  VALUE '0181'.
   695     12  ER-0182                 PIC X(4)  VALUE '0182'.
   696     12  ER-0183                 PIC X(4)  VALUE '0183'.
   697     12  ER-0184                 PIC X(4)  VALUE '0184'.
   698     12  ER-0185                 PIC X(4)  VALUE '0185'.
   699     12  ER-0186                 PIC X(4)  VALUE '0186'.
   700     12  ER-0187                 PIC X(4)  VALUE '0187'.
   701     12  ER-0188                 PIC X(4)  VALUE '0188'.
   702     12  ER-0189                 PIC X(4)  VALUE '0189'.
   703     12  ER-0190                 PIC X(4)  VALUE '0190'.
   704     12  ER-0191                 PIC X(4)  VALUE '0191'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  16
* EL152.cbl
   705     12  ER-0206                 PIC X(4)  VALUE '0206'.
   706     12  ER-0211                 PIC X(4)  VALUE '0211'.
   707     12  ER-0279                 PIC X(4)  VALUE '0279'.
   708     12  ER-0280                 PIC X(4)  VALUE '0280'.
   709     12  ER-0281                 PIC X(4)  VALUE '0281'.
   710     12  ER-0332                 PIC X(4)  VALUE '0332'.
   711     12  ER-0343                 PIC X(4)  VALUE '0343'.
   712     12  ER-0373                 PIC X(4)  VALUE '0373'.
   713     12  ER-0374                 PIC X(4)  VALUE '0374'.
   714     12  ER-0412                 PIC X(4)  VALUE '0412'.
   715     12  ER-0413                 PIC X(4)  VALUE '0413'.
   716     12  ER-0533                 PIC X(4)  VALUE '0533'.
   717     12  ER-0537                 PIC X(4)  VALUE '0537'.
   718     12  ER-0716                 PIC X(4)  VALUE '0716'.
   719     12  ER-0861                 PIC X(4)  VALUE '0861'.
   720     12  ER-0894                 PIC X(4)  VALUE '0894'.
   721     12  ER-0900                 PIC X(4)  VALUE '0900'.
   722     12  ER-0909                 PIC X(4)  VALUE '0909'.
   723     12  ER-0911                 PIC X(4)  VALUE '0911'.
   724     12  ER-0912                 PIC X(4)  VALUE '0912'.
   725     12  ER-1236                 PIC X(4)  VALUE '1236'.
   726     12  ER-1560                 PIC X(4)  VALUE '1560'.
   727     12  ER-2055                 PIC X(4)  VALUE '2055'.
   728     12  ER-2397                 PIC X(4)  VALUE '2397'.
   729     12  ER-2398                 PIC X(4)  VALUE '2398'.
   730     12  ER-3547                 PIC X(4)  VALUE '3547'.
   731     12  ER-3770                 PIC X(4)  VALUE '3770'.
   732     12  ER-3771                 PIC X(4)  VALUE '3771'.
   733     12  ER-3772                 PIC X(4)  VALUE '3772'.
   734     12  ER-7675                 PIC X(4)  VALUE '7675'.
   735     12  ER-7840                 PIC X(4)  VALUE '7840'.
   736     12  ER-7842                 PIC X(4)  VALUE '7842'.
   737     12  ER-7843                 PIC X(4)  VALUE '7843'.
   738     12  ER-8158                 PIC X(4)  VALUE '8158'.
   739     12  ER-9106                 PIC X(4)  VALUE '9106'.
   740     12  ER-9483                 PIC X(4)  VALUE '9483'.
   741     12  ER-9808                 PIC X(4)  VALUE '9808'.
   742     12  ER-9883                 PIC X(4)  VALUE '9883'.
   743     12  ER-9887                 PIC X(4)  VALUE '9887'.
   744
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  17
* EL152.cbl
   746****************************************************
   747*       WHEN ADDING OR DELETING ENTRIES TO         *
   748*       THE SYSTEM-SUPPORTED-VARIABLES THE         *
   749*       SS-NUM-ENTRIES FIELD MUST BE ALTERED       *
   750*       TO MATCH THE NUMBER OF ENTRIES IN THE      *
   751*       SYSTEM-SUPPORTED-VARIABLE TABLE.           *
   752*       ALSO YOU NEED TO INCREASE THE LENGTH OF    *
   753*       SS-WORK-AREA-LENGTH AND SYSTEM-VARIABLES   *
   754*                                                  *
   755*   3 FIELDS TO CHANGE:                            *
   756*      1 - SS-NUM-ENTRIES........(NO.OF ENTRIES)   *
   757*      2 - SS-WORK-AREA-LENGTH...(TOTAL LENGTH)    *
   758*      3 - SYSTEM-VARIABLES......( "      "   )    *
   759****************************************************
   760
   761*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
   762*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
   763
   764     12  SS-NUM-ENTRIES          PIC 999    VALUE 130      COMP-3.
   765     12  SS-COUNTER              PIC 999                   COMP-3.
   766     12  SS-WORK-AREA-LENGTH     PIC S9(4)  VALUE +3865    COMP.
   767
   768 01  VARIABLE-WORK-AREA.
   769     12  VAR-CODE                PIC X(4).
   770     12  VAR-LEN                 PIC 99.
   771     12  VAR-DATA                PIC X(100).
   772     12  VAR-DATA-R REDEFINES VAR-DATA.
   773       16  VAR-ONE-CHAR OCCURS 100 TIMES INDEXED BY INDXV PIC X.
   774
   775 01  SYSTEM-SUPPORTED-VARIABLES.
   776*****COMPANY NAME
   777     12  SS01                    PIC X(4)  VALUE     '01.0'.
   778     12  SS01L                   PIC 99    VALUE 36.
   779     12  SS01D                   PIC X(30) VALUE ALL '*'.
   780*****FULL COMPANY ADDRESS
   781     12  SS02-1                  PIC X(4)  VALUE     '02.1'.
   782     12  SS02-1L                 PIC 99    VALUE 36.
   783     12  SS02-1D                 PIC X(30) VALUE ALL '*'.
   784     12  SS02-2                  PIC X(4)  VALUE     '02.2'.
   785     12  SS02-2L                 PIC 99    VALUE 36.
   786     12  SS02-2D                 PIC X(30) VALUE ALL '*'.
   787     12  SS02-3                  PIC X(4)  VALUE     '02.3'.
   788     12  SS02-3L                 PIC 99    VALUE 36.
   789     12  SS02-3D                 PIC X(30) VALUE ALL '*'.
   790     12  SS02-4                  PIC X(4)  VALUE     '02.4'.
   791     12  SS02-4L                 PIC 99    VALUE 36.
   792     12  SS02-4D                 PIC X(30) VALUE ALL '*'.
   793     12  SS02-5                  PIC X(4)  VALUE     '02.5'.
   794     12  SS02-5L                 PIC 99    VALUE 36.
   795     12  SS02-5D                 PIC X(30) VALUE ALL '*'.
   796*****CARRIER NAME
   797     12  SS03                    PIC X(4)  VALUE     '03.0'.
   798     12  SS03L                   PIC 99    VALUE 36.
   799     12  SS03D                   PIC X(30) VALUE ALL '*'.
   800*****INVESTORS HERITAGE
   801* as Administrator for Investors Heritage Life Insurance Company
   802     12  SS03-1                  PIC X(4)  VALUE     '03.1'.
   803     12  SS03-1L                 PIC 99    VALUE 68.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  18
* EL152.cbl
   804     12  SS03-1D                 PIC X(62) VALUE ALL '*'.
   805*****FULL CARRIER ADDRESS
   806     12  SS04-1                  PIC X(4)  VALUE     '04.1'.
   807     12  SS04-1L                 PIC 99    VALUE 36.
   808     12  SS04-1D                 PIC X(30) VALUE ALL '*'.
   809     12  SS04-2                  PIC X(4)  VALUE     '04.2'.
   810     12  SS04-2L                 PIC 99    VALUE 36.
   811     12  SS04-2D                 PIC X(30) VALUE ALL '*'.
   812     12  SS04-3                  PIC X(4)  VALUE     '04.3'.
   813     12  SS04-3L                 PIC 99    VALUE 36.
   814     12  SS04-3D                 PIC X(30) VALUE ALL '*'.
   815     12  SS04-4                  PIC X(4)  VALUE     '04.4'.
   816     12  SS04-4L                 PIC 99    VALUE 36.
   817     12  SS04-4D                 PIC X(30) VALUE ALL '*'.
   818     12  SS04-5                  PIC X(4)  VALUE     '04.5'.
   819     12  SS04-5L                 PIC 99    VALUE 36.
   820     12  SS04-5D                 PIC X(30) VALUE ALL '*'.
   821*****CARRIER PHONE NUMBER
   822     12  SS04-6                  PIC X(4)  VALUE     '04.6'.
   823     12  SS04-6L                 PIC 99    VALUE 18.
   824     12  SS04-6D                 PIC X(12) VALUE ALL '*'.
   825*****FULL ADDRESEE LABEL
   826     12  SS05-1                  PIC X(4)  VALUE     '05.1'.
   827     12  SS05-1L                 PIC 99    VALUE 36.
   828     12  SS05-1D                 PIC X(30) VALUE ALL '*'.
   829     12  SS05-2                  PIC X(4)  VALUE     '05.2'.
   830     12  SS05-2L                 PIC 99    VALUE 36.
   831     12  SS05-2D                 PIC X(30) VALUE ALL '*'.
   832     12  SS05-3                  PIC X(4)  VALUE     '05.3'.
   833     12  SS05-3L                 PIC 99    VALUE 36.
   834     12  SS05-3D                 PIC X(30) VALUE ALL '*'.
   835     12  SS05-4                  PIC X(4)  VALUE     '05.4'.
   836     12  SS05-4L                 PIC 99    VALUE 36.
   837     12  SS05-4D                 PIC X(30) VALUE ALL '*'.
   838     12  SS05-5                  PIC X(4)  VALUE     '05.5'.
   839     12  SS05-5L                 PIC 99    VALUE 36.
   840     12  SS05-5D                 PIC X(30) VALUE ALL '*'.
   841     12  SS05-6                  PIC X(4)  VALUE     '05.6'.
   842     12  SS05-6L                 PIC 99    VALUE 36.
   843     12  SS05-6D                 PIC X(30) VALUE ALL '*'.
   844*****ACCOUNT NAME
   845     12  SS06                    PIC X(4)  VALUE     '06.0'.
   846     12  SS06L                   PIC 99    VALUE 36.
   847     12  SS06D                   PIC X(30) VALUE ALL '*'.
   848*****FULL ACCOUNT ADDRESS
   849     12  SS07-1                  PIC X(4)  VALUE     '07.1'.
   850     12  SS07-1L                 PIC 99    VALUE 36.
   851     12  SS07-1D                 PIC X(30) VALUE ALL '*'.
   852     12  SS07-2                  PIC X(4)  VALUE     '07.2'.
   853     12  SS07-2L                 PIC 99    VALUE 36.
   854     12  SS07-2D                 PIC X(30) VALUE ALL '*'.
   855     12  SS07-3                  PIC X(4)  VALUE     '07.3'.
   856     12  SS07-3L                 PIC 99    VALUE 36.
   857     12  SS07-3D                 PIC X(30) VALUE ALL '*'.
   858     12  SS07-4                  PIC X(4)  VALUE     '07.4'.
   859     12  SS07-4L                 PIC 99    VALUE 36.
   860     12  SS07-4D                 PIC X(30) VALUE ALL '*'.
   861     12  SS07-5                  PIC X(4)  VALUE     '07.5'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  19
* EL152.cbl
   862     12  SS07-5L                 PIC 99    VALUE 36.
   863     12  SS07-5D                 PIC X(30) VALUE ALL '*'.
   864*****ACCOUNT PHONE NUMBER
   865     12  SS07-6                  PIC X(4)  VALUE     '07.6'.
   866     12  SS07-6L                 PIC 99    VALUE 18.
   867     12  SS07-6D                 PIC X(12) VALUE ALL '*'.
   868*****EXECUTING PROCESSOR NAME
   869     12  SS08                    PIC X(4)  VALUE     '08.0'.
   870     12  SS08L                   PIC 99    VALUE 36.
   871     12  SS08D                   PIC X(30) VALUE ALL '*'.
   872*****PROCESSOR TITLE
   873     12  SS09                    PIC X(4)  VALUE     '09.0'.
   874     12  SS09L                   PIC 99    VALUE 32.
   875     12  SS09D                   PIC X(26) VALUE ALL '*'.
   876*****INSUREDS NAME
   877     12  SS10                    PIC X(4)  VALUE     '10.0'.
   878     12  SS10L                   PIC 99    VALUE 36.
   879     12  SS10D                   PIC X(30) VALUE ALL '*'.
   880*****INSUREDS ADDRESS
   881     12  SS11-1                  PIC X(4)  VALUE     '11.1'.
   882     12  SS11-1L                 PIC 99    VALUE 36.
   883     12  SS11-1D                 PIC X(30) VALUE ALL '*'.
   884     12  SS11-2                  PIC X(4)  VALUE     '11.2'.
   885     12  SS11-2L                 PIC 99    VALUE 36.
   886     12  SS11-2D                 PIC X(30) VALUE ALL '*'.
   887     12  SS11-3                  PIC X(4)  VALUE     '11.3'.
   888     12  SS11-3L                 PIC 99    VALUE 36.
   889     12  SS11-3D                 PIC X(30) VALUE ALL '*'.
   890     12  SS11-4                  PIC X(4)  VALUE     '11.4'.
   891     12  SS11-4L                 PIC 99    VALUE 36.
   892     12  SS11-4D                 PIC X(30) VALUE ALL '*'.
   893*****INSUREDS NAME FROM ADDR TRAILER
   894     12  SS11-5                  PIC X(4)  VALUE     '11.5'.
   895     12  SS11-5L                 PIC 99    VALUE 36.
   896     12  SS11-5D                 PIC X(30) VALUE ALL '*'.
   897*****INSUREDS PHONE NUMBER FROM ADDR TRAILER
   898     12  SS11-6                  PIC X(4)  VALUE     '11.6'.
   899     12  SS11-6L                 PIC 99    VALUE 18.
   900     12  SS11-6D                 PIC X(12) VALUE ALL '*'.
   901*****CLAIM TYPE NAME
   902     12  SS12                    PIC X(4)  VALUE     '12.0'.
   903     12  SS12L                   PIC 99    VALUE 12.
   904     12  SS12D                   PIC X(6)  VALUE ALL '*'.
   905*****CLAIM INCURRED DATE
   906     12  SS13                    PIC X(4)  VALUE     '13.0'.
   907     12  SS13L                   PIC 99    VALUE 14.
   908     12  SS13D                   PIC X(8)  VALUE ALL '*'.
   909*****CLAIM REPORTED DATE
   910     12  SS14                    PIC X(4)  VALUE     '14.0'.
   911     12  SS14L                   PIC 99    VALUE 14.
   912     12  SS14D                   PIC X(8)  VALUE ALL '*'.
   913*****LAST PAYMENT DATE
   914     12  SS15                    PIC X(4)  VALUE     '15.0'.
   915     12  SS15L                   PIC 99    VALUE 14.
   916     12  SS15D                   PIC X(8)  VALUE ALL '*'.
   917*****LAST PAYMENT AMOUNT
   918     12  SS16                    PIC X(4)  VALUE     '16.0'.
   919     12  SS16L                   PIC 99    VALUE 17.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  20
* EL152.cbl
   920     12  SS16D                   PIC $$$$,$$$.99 VALUE ZEROS.
   921*****CLAIM INTEREST RATE
   922     12  SS16-1                  PIC X(4)  VALUE     '16.1'.
   923     12  SS16-1L                 PIC 99    VALUE 13.
   924     12  SS16-1D                 PIC X(7)        VALUE SPACE.
   925*****CLAIM PAID THRU/TO DATE
   926     12  SS17                    PIC X(4)  VALUE     '17.0'.
   927     12  SS17L                   PIC 99    VALUE 14.
   928     12  SS17D                   PIC X(8)  VALUE ALL '*'.
   929*****TOTAL PAID TO DATE
   930     12  SS18                    PIC X(4)  VALUE     '18.0'.
   931     12  SS18L                   PIC 99    VALUE 17.
   932     12  SS18D                   PIC $$$$,$$$.99 VALUE ZEROS.
   933*****DIAGNOSIS OR CAUSE
   934     12  SS19                    PIC X(4)  VALUE     '19.0'.
   935     12  SS19L                   PIC 99    VALUE 32.
   936     12  SS19D                   PIC X(26) VALUE ALL '*'.
   937*****CAUSE CODE
   938     12  SS19-1                  PIC X(4)  VALUE     '19.1'.
   939     12  SS19-1L                 PIC 99    VALUE 12.
   940     12  SS19-1D                 PIC X(6)  VALUE ALL '*'.
   941*****CID LOAN NUMBER
   942     12  SS19-2                  PIC X(4)  VALUE     '19.2'.
   943     12  SS19-2L                 PIC 99    VALUE 31.
   944     12  SS19-2D                 PIC X(25) VALUE ALL '*'.
   945*****CURRENT DATE
   946     12  SS20                    PIC X(4)  VALUE     '20.0'.
   947     12  SS20L                   PIC 99    VALUE 14.
   948     12  SS20D                   PIC X(8)  VALUE ALL '*'.
   949*****FULL CURRENT DATE
   950     12  SS21                    PIC X(4)  VALUE     '21.0'.
   951     12  SS21L                   PIC 99    VALUE 24.
   952     12  SS21D                   PIC X(18) VALUE ALL '*'.
   953*****BENEFIT DESCRIPTION
   954     12  SS22                    PIC X(4)  VALUE     '22.0'.
   955     12  SS22L                   PIC 99    VALUE 16.
   956     12  SS22D                   PIC X(10) VALUE ALL '*'.
   957*****CARRIER CODE IN CERT
   958     12  SS23                    PIC X(4)  VALUE     '23.0'.
   959     12  SS23L                   PIC 99    VALUE 9.
   960     12  SS23D                   PIC XXX   VALUE ALL '*'.
   961*****GROUPING CODE IN CERT
   962     12  SS24                    PIC X(4)  VALUE     '24.0'.
   963     12  SS24L                   PIC 99    VALUE 12.
   964     12  SS24D                   PIC X(6)  VALUE ALL '*'.
   965*****ACCOUNT NUMBER IN CERT
   966     12  SS25                    PIC X(4)  VALUE     '25.0'.
   967     12  SS25L                   PIC 99    VALUE 16.
   968     12  SS25D                   PIC X(10) VALUE ALL '*'.
   969*****CERTIFICATE NUMBER
   970     12  SS26                    PIC X(4)  VALUE     '26.0'.
   971     12  SS26L                   PIC 99    VALUE 17.
   972     12  SS26D                   PIC X(11) VALUE ALL '*'.
   973*****CERT EFFECTIVE DATE
   974     12  SS27                    PIC X(4)  VALUE     '27.0'.
   975     12  SS27L                   PIC 99    VALUE 14.
   976     12  SS27D                   PIC X(8)  VALUE ALL '*'.
   977*****CERT EXPIRATION DATE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  21
* EL152.cbl
   978     12  SS28                    PIC X(4)  VALUE     '28.0'.
   979     12  SS28L                   PIC 99    VALUE 14.
   980     12  SS28D                   PIC X(8)  VALUE ALL '*'.
   981*****APPLICABLE COVERAGE TERM
   982     12  SS29                    PIC X(4)  VALUE     '29.0'.
   983     12  SS29L                   PIC 99    VALUE 9.
   984     12  SS29D                   PIC XXX   VALUE ALL '*'.
   985*****APPLICABLE COVERAGE AMOUNT
   986     12  SS30                    PIC X(4)  VALUE     '30.0'.
   987     12  SS30L                   PIC 99    VALUE 18.
   988     12  SS30D                   PIC $$$$$,$$$.99  VALUE ZEROS.
   989*****APPLICABLE COVERAGE CANCEL DATE
   990     12  SS31                    PIC X(4)  VALUE     '31.0'.
   991     12  SS31L                   PIC 99    VALUE 14.
   992     12  SS31D                   PIC X(8)  VALUE ALL '*'.
   993*****APPLICABLE COVERAGE FORM NUMBER
   994     12  SS32                    PIC X(4)  VALUE     '32.0'.
   995     12  SS32L                   PIC 99    VALUE 18.
   996     12  SS32D                   PIC X(12) VALUE ALL '*'.
   997*****INSURES AGE AT POLICY ISSUE
   998     12  SS33                    PIC X(4)  VALUE     '33.0'.
   999     12  SS33L                   PIC 99    VALUE 9.
  1000     12  SS33D                   PIC XXX   VALUE ALL '*'.
  1001*****CLAIM NUMBER
  1002     12  SS34                    PIC X(4)  VALUE     '34.0'.
  1003     12  SS34L                   PIC 99    VALUE 13.
  1004     12  SS34D                   PIC X(7)  VALUE ALL '*'.
  1005*****LAST DENIAL TEXT
  1006     12  SS35-1                  PIC X(4)  VALUE     '35.1'.
  1007     12  SS35-1L                 PIC 99    VALUE 66.
  1008     12  SS35-1D                 PIC X(60) VALUE ALL '*'.
  1009     12  SS35-2                  PIC X(4)  VALUE     '35.2'.
  1010     12  SS35-2L                 PIC 99    VALUE 66.
  1011     12  SS35-2D                 PIC X(60) VALUE ALL '*'.
  1012*****LOAN NUMBER
  1013     12  SS36                    PIC X(4)  VALUE     '36.0'.
  1014     12  SS36L                   PIC 99    VALUE 14.
  1015     12  SS36D                   PIC X(8)  VALUE ALL '*'.
  1016*****CURRENT LOAN NUMBER
  1017     12  SS36-1                  PIC X(4)  VALUE     '36.1'.
  1018     12  SS36-1L                 PIC 99    VALUE 26.
  1019     12  SS36-1D                 PIC X(20) VALUE ALL '*'.
  1020*****LOAN BALANCE
  1021     12  SS37                    PIC X(4)  VALUE     '37.0'.
  1022     12  SS37L                   PIC 99    VALUE 18.
  1023     12  SS37D                   PIC $$$$$,$$$.99  VALUE ZEROS.
  1024*****MEMBER NUMBER
  1025     12  SS38                    PIC X(4)  VALUE     '38.0'.
  1026     12  SS38L                   PIC 99    VALUE 18.
  1027     12  SS38D                   PIC X(12) VALUE ALL '*'.
  1028*****INSURED NAME (FIRST M LAST)
  1029     12  SS39                    PIC X(4)  VALUE     '39.0'.
  1030     12  SS39L                   PIC 99    VALUE 36.
  1031     12  SS39D                   PIC X(30) VALUE ALL '*'.
  1032*****INSURED LAST NAME ONLY
  1033     12  SS40                    PIC X(4)  VALUE     '40.0'.
  1034     12  SS40L                   PIC 99    VALUE 21.
  1035     12  SS40D                   PIC X(15) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  22
* EL152.cbl
  1036*****TITLE (MR/MS)
  1037     12  SS41                    PIC X(4)  VALUE     '41.0'.
  1038     12  SS41L                   PIC 99    VALUE 9.
  1039     12  SS41D                   PIC X(3)  VALUE ALL '*'.
  1040*****ELIMINATION PERIOD
  1041     12  SS42                    PIC X(4)  VALUE     '42.0'.
  1042     12  SS42L                   PIC 99    VALUE 9.
  1043     12  SS42D                   PIC X(3)  VALUE ALL '*'.
  1044*****BENEFICIARY NAME
  1045     12  SS43                    PIC X(4)  VALUE     '43.0'.
  1046     12  SS43L                   PIC 99    VALUE 36.
  1047     12  SS43D                   PIC X(30) VALUE ALL '*'.
  1048*****BENEFICIARY ADDRESS
  1049     12  SS44-1                  PIC X(4)  VALUE     '44.1'.
  1050     12  SS44-1L                 PIC 99    VALUE 36.
  1051     12  SS44-1D                 PIC X(30) VALUE ALL '*'.
  1052     12  SS44-2                  PIC X(4)  VALUE     '44.2'.
  1053     12  SS44-2L                 PIC 99    VALUE 36.
  1054     12  SS44-2D                 PIC X(30) VALUE ALL '*'.
  1055     12  SS44-3                  PIC X(4)  VALUE     '44.3'.
  1056     12  SS44-3L                 PIC 99    VALUE 36.
  1057     12  SS44-3D                 PIC X(30) VALUE ALL '*'.
  1058     12  SS44-4                  PIC X(4)  VALUE     '44.4'.
  1059     12  SS44-4L                 PIC 99    VALUE 36.
  1060     12  SS44-4D                 PIC X(30) VALUE ALL '*'.
  1061     12  SS44-5                  PIC X(4)  VALUE     '44.5'.
  1062     12  SS44-5L                 PIC 99    VALUE 18.
  1063     12  SS44-5D                 PIC X(12) VALUE ALL '*'.
  1064     12  SS44-6                  PIC X(4)  VALUE     '44.6'.
  1065     12  SS44-6L                 PIC 99    VALUE 36.
  1066     12  SS44-6D                 PIC X(30) VALUE ALL '*'.
  1067*****INSUREDS DATE OF BIRTH
  1068     12  SS45                    PIC X(4)  VALUE     '45.0'.
  1069     12  SS45L                   PIC 99    VALUE 14.
  1070     12  SS45D                   PIC X(8)  VALUE ALL '*'.
  1071*****INSUREDS SOC SEC NUMBER
  1072     12  SS46                    PIC X(4)  VALUE     '46.0'.
  1073     12  SS46L                   PIC 99    VALUE 17.
  1074     12  SS46D                   PIC X(11) VALUE ALL '*'.
  1075*****PHYSICIANS  NAME
  1076     12  SS47                    PIC X(4)  VALUE     '47.0'.
  1077     12  SS47L                   PIC 99    VALUE 36.
  1078     12  SS47D                   PIC X(30) VALUE ALL '*'.
  1079*****PHYSICIANS  ADDRESS
  1080     12  SS47-1                  PIC X(4)  VALUE     '47.1'.
  1081     12  SS47-1L                 PIC 99    VALUE 36.
  1082     12  SS47-1D                 PIC X(30) VALUE ALL '*'.
  1083     12  SS47-2                  PIC X(4)  VALUE     '47.2'.
  1084     12  SS47-2L                 PIC 99    VALUE 36.
  1085     12  SS47-2D                 PIC X(30) VALUE ALL '*'.
  1086     12  SS47-3                  PIC X(4)  VALUE     '47.3'.
  1087     12  SS47-3L                 PIC 99    VALUE 36.
  1088     12  SS47-3D                 PIC X(30) VALUE ALL '*'.
  1089     12  SS47-4                  PIC X(4)  VALUE     '47.4'.
  1090     12  SS47-4L                 PIC 99    VALUE 36.
  1091     12  SS47-4D                 PIC X(30) VALUE ALL '*'.
  1092     12  SS47-5                  PIC X(4)  VALUE     '47.5'.
  1093     12  SS47-5L                 PIC 99    VALUE 18.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  23
* EL152.cbl
  1094     12  SS47-5D                 PIC X(12) VALUE ALL '*'.
  1095*****EMPLOYERS   NAME
  1096     12  SS48                    PIC X(4)  VALUE     '48.0'.
  1097     12  SS48L                   PIC 99    VALUE 36.
  1098     12  SS48D                   PIC X(30) VALUE ALL '*'.
  1099*****EMPLOYERS   ADDRESS
  1100     12  SS48-1                  PIC X(4)  VALUE     '48.1'.
  1101     12  SS48-1L                 PIC 99    VALUE 36.
  1102     12  SS48-1D                 PIC X(30) VALUE ALL '*'.
  1103     12  SS48-2                  PIC X(4)  VALUE     '48.2'.
  1104     12  SS48-2L                 PIC 99    VALUE 36.
  1105     12  SS48-2D                 PIC X(30) VALUE ALL '*'.
  1106     12  SS48-3                  PIC X(4)  VALUE     '48.3'.
  1107     12  SS48-3L                 PIC 99    VALUE 36.
  1108     12  SS48-3D                 PIC X(30) VALUE ALL '*'.
  1109     12  SS48-4                  PIC X(4)  VALUE     '48.4'.
  1110     12  SS48-4L                 PIC 99    VALUE 36.
  1111     12  SS48-4D                 PIC X(30) VALUE ALL '*'.
  1112     12  SS48-5                  PIC X(4)  VALUE     '48.5'.
  1113     12  SS48-5L                 PIC 99    VALUE 18.
  1114     12  SS48-5D                 PIC X(12) VALUE ALL '*'.
  1115*****OTHER1      NAME
  1116     12  SS49                    PIC X(4)  VALUE     '49.0'.
  1117     12  SS49L                   PIC 99    VALUE 36.
  1118     12  SS49D                   PIC X(30) VALUE ALL '*'.
  1119*****OTHER1      ADDRESS
  1120     12  SS49-1                  PIC X(4)  VALUE     '49.1'.
  1121     12  SS49-1L                 PIC 99    VALUE 36.
  1122     12  SS49-1D                 PIC X(30) VALUE ALL '*'.
  1123     12  SS49-2                  PIC X(4)  VALUE     '49.2'.
  1124     12  SS49-2L                 PIC 99    VALUE 36.
  1125     12  SS49-2D                 PIC X(30) VALUE ALL '*'.
  1126     12  SS49-3                  PIC X(4)  VALUE     '49.3'.
  1127     12  SS49-3L                 PIC 99    VALUE 36.
  1128     12  SS49-3D                 PIC X(30) VALUE ALL '*'.
  1129     12  SS49-4                  PIC X(4)  VALUE     '49.4'.
  1130     12  SS49-4L                 PIC 99    VALUE 36.
  1131     12  SS49-4D                 PIC X(30) VALUE ALL '*'.
  1132     12  SS49-5                  PIC X(4)  VALUE     '49.5'.
  1133     12  SS49-5L                 PIC 99    VALUE 18.
  1134     12  SS49-5D                 PIC X(12) VALUE ALL '*'.
  1135*****OTHER2      NAME
  1136     12  SS50                    PIC X(4)  VALUE     '50.0'.
  1137     12  SS50L                   PIC 99    VALUE 36.
  1138     12  SS50D                   PIC X(30) VALUE ALL '*'.
  1139*****OTHER2      ADDRESS
  1140     12  SS50-1                  PIC X(4)  VALUE     '50.1'.
  1141     12  SS50-1L                 PIC 99    VALUE 36.
  1142     12  SS50-1D                 PIC X(30) VALUE ALL '*'.
  1143     12  SS50-2                  PIC X(4)  VALUE     '50.2'.
  1144     12  SS50-2L                 PIC 99    VALUE 36.
  1145     12  SS50-2D                 PIC X(30) VALUE ALL '*'.
  1146     12  SS50-3                  PIC X(4)  VALUE     '50.3'.
  1147     12  SS50-3L                 PIC 99    VALUE 36.
  1148     12  SS50-3D                 PIC X(30) VALUE ALL '*'.
  1149     12  SS50-4                  PIC X(4)  VALUE     '50.4'.
  1150     12  SS50-4L                 PIC 99    VALUE 36.
  1151     12  SS50-4D                 PIC X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  24
* EL152.cbl
  1152     12  SS50-5                  PIC X(4)  VALUE     '50.5'.
  1153     12  SS50-5L                 PIC 99    VALUE 18.
  1154     12  SS50-5D                 PIC X(12) VALUE ALL '*'.
  1155*****A&H TERM TIMES MON. BEN.
  1156     12  SS51                    PIC X(4)  VALUE     '51.0'.
  1157     12  SS51L                   PIC 99    VALUE 17.
  1158     12  SS51D                   PIC $$$$,$$$.99 VALUE ZEROS.
  1159*****THIRD PARTY NAME
  1160     12  SS52                    PIC X(4)  VALUE     '52.0'.
  1161     12  SS52L                   PIC 99    VALUE 36.
  1162     12  SS52D                   PIC X(30) VALUE ALL '*'.
  1163*****THIRD PARTY ADDRESS
  1164     12  SS53-1                  PIC X(4)  VALUE     '53.1'.
  1165     12  SS53-1L                 PIC 99    VALUE 36.
  1166     12  SS53-1D                 PIC X(30) VALUE ALL '*'.
  1167     12  SS53-2                  PIC X(4)  VALUE     '53.2'.
  1168     12  SS53-2L                 PIC 99    VALUE 36.
  1169     12  SS53-2D                 PIC X(30) VALUE ALL '*'.
  1170     12  SS53-3                  PIC X(4)  VALUE     '53.3'.
  1171     12  SS53-3L                 PIC 99    VALUE 36.
  1172     12  SS53-3D                 PIC X(30) VALUE ALL '*'.
  1173     12  SS53-4                  PIC X(4)  VALUE     '53.4'.
  1174     12  SS53-4L                 PIC 99    VALUE 36.
  1175     12  SS53-4D                 PIC X(30) VALUE ALL '*'.
  1176     12  SS53-5                  PIC X(4)  VALUE     '53.5'.
  1177     12  SS53-5L                 PIC 99    VALUE 36.
  1178     12  SS53-5D                 PIC X(30) VALUE ALL '*'.
  1179*****THIRD PARTY PHONE NUMBER
  1180     12  SS53-6                  PIC X(4)  VALUE     '53.6'.
  1181     12  SS53-6L                 PIC 99    VALUE 18.
  1182     12  SS53-6D                 PIC X(12) VALUE ALL '*'.
  1183*****CERTIFICATE SEQUENCE
  1184     12  SS54                    PIC X(4)  VALUE     '54.0'.
  1185     12  SS54L                   PIC 99    VALUE 09.
  1186     12  SS54D                   PIC XXX VALUE ALL '*'.
  1187*****CERTIFICATE TOTAL  E
  1188     12  SS55                    PIC X(4)  VALUE     '55.0'.
  1189     12  SS55L                   PIC 99    VALUE 09.
  1190     12  SS55D                   PIC XXX VALUE ALL '*'.
  1191*****CREDITOR ID
  1192     12  SS56                    PIC  X(04) VALUE    '56.0'.
  1193     12  SS56L                   PIC  99 VALUE 36.
  1194     12  SS56D                   PIC  X(30) VALUE ALL '*'.
  1195*****INSUREDS NAME (CERTIFICATE)
  1196     12  SS57                    PIC X(4)  VALUE     '57.0'.
  1197     12  SS57L                   PIC 99    VALUE 36.
  1198     12  SS57D                   PIC X(30) VALUE ALL '*'.
  1199*****JOINT NAME (CERTIFICATE)
  1200     12  SS58                    PIC X(4)  VALUE     '58.0'.
  1201     12  SS58L                   PIC 99    VALUE 36.
  1202     12  SS58D                   PIC X(30) VALUE ALL '*'.
  1203*****POLICY REFERENCE NUMBER
  1204     12  SS59                    PIC X(4)  VALUE     '59.0'.
  1205     12  SS59L                   PIC 99    VALUE 26.
  1206     12  SS59D                   PIC X(20) VALUE ALL '*'.
  1207*****CREDIT CARD NUMBER (CLAIMS)
  1208     12  SS60                    PIC X(4)  VALUE     '60.0'.
  1209     12  SS60L                   PIC 99    VALUE 22.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  25
* EL152.cbl
  1210     12  SS60D                   PIC X(16) VALUE ALL '*'.
  1211*****CORRESPONDENCE BENEFICIARY NAME
  1212     12  SS61                    PIC X(4)  VALUE     '61.0'.
  1213     12  SS61L                   PIC 99    VALUE 36.
  1214     12  SS61D                   PIC X(30) VALUE ALL '*'.
  1215*****CORRESPONDENCE BENEFICIARY ADDRESS
  1216     12  SS61-1                  PIC X(4)  VALUE     '61.1'.
  1217     12  SS61-1L                 PIC 99    VALUE 36.
  1218     12  SS61-1D                 PIC X(30) VALUE ALL '*'.
  1219     12  SS61-2                  PIC X(4)  VALUE     '61.2'.
  1220     12  SS61-2L                 PIC 99    VALUE 36.
  1221     12  SS61-2D                 PIC X(30) VALUE ALL '*'.
  1222     12  SS61-3                  PIC X(4)  VALUE     '61.3'.
  1223     12  SS61-3L                 PIC 99    VALUE 36.
  1224     12  SS61-3D                 PIC X(30) VALUE ALL '*'.
  1225     12  SS61-4                  PIC X(4)  VALUE     '61.4'.
  1226     12  SS61-4L                 PIC 99    VALUE 36.
  1227     12  SS61-4D                 PIC X(30) VALUE ALL '*'.
  1228     12  SS61-5                  PIC X(4)  VALUE     '61.5'.
  1229     12  SS61-5L                 PIC 99    VALUE 36.
  1230     12  SS61-5D                 PIC X(30) VALUE ALL '*'.
  1231     12  SS61-6                  PIC X(4)  VALUE     '61.6'.
  1232     12  SS61-6L                 PIC 99    VALUE 18.
  1233     12  SS61-6D                 PIC X(12) VALUE ALL '*'.
  1234
  1235*****DMD UNDERWRITER STATEMENT
  1236     12  SS62                    PIC X(4)  VALUE     '62.0'.
  1237     12  SS62L                   PIC 99    VALUE 56.
  1238     12  SS62D                   PIC X(50) VALUE ALL '*'.
  1239
  1240*****DMD UNDERWRITER NAME
  1241     12  SS63                    PIC X(4)  VALUE     '63.0'.
  1242     12  SS63L                   PIC 99    VALUE 66.
  1243     12  SS63D                   PIC X(60) VALUE ALL '*'.
  1244
  1245*****DMD UNDERWRITER NAME
  1246     12  SS64                    PIC X(4)  VALUE     '64.0'.
  1247     12  SS64L                   PIC 99    VALUE 66.
  1248     12  SS64D                   PIC X(60) VALUE ALL '*'.
  1249
  1250****************************************************
  1251*       WHEN ADDING OR DELETING ENTRIES TO         *
  1252*       THE SYSTEM-SUPPORTED-VARIABLES THE         *
  1253*       SS-NUM-ENTRIES FIELD MUST BE ALTERED       *
  1254*       TO MATCH THE NUMBER OF ENTRIES IN THE      *
  1255*       SYSTEM-SUPPORTED-VARIABLE TABLE.           *
  1256*       ALSO YOU NEED TO INCREASE THE LENGTH OF    *
  1257*       SS-WORK-AREA-LENGTH AND SYSTEM-VARIABLES   *
  1258****************************************************
  1259*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
  1260*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
  1261
  1262 01  SYSTEM-VARIABLES            PIC X(3865).
  1263 01  SYS-VAR-ENTRY.
  1264     12  SYS-VAR-CODE            PIC X(4).
  1265     12  SYS-VAR-LEN             PIC 99.
  1266     12  SYS-VAR-DATA            PIC X(100).
  1267
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  26
* EL152.cbl
  1268*                                COPY ELCDATE.
  1269******************************************************************
  1270*                                                                *
  1271*                                                                *
  1272*                            ELCDATE.                            *
  1273*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1274*                            VMOD=2.003
  1275*                                                                *
  1276*                                                                *
  1277*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1278*                 LENGTH = 200                                   *
  1279******************************************************************
  1280
  1281 01  DATE-CONVERSION-DATA.
  1282     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1283     12  DC-OPTION-CODE                PIC X.
  1284         88  BIN-TO-GREG                VALUE ' '.
  1285         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1286         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1287         88  YMD-GREG-TO-BIN            VALUE '3'.
  1288         88  MDY-GREG-TO-BIN            VALUE '4'.
  1289         88  JULIAN-TO-BIN              VALUE '5'.
  1290         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1291         88  FIND-CENTURY               VALUE '7'.
  1292         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1293         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1294         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1295         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1296         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1297         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1298         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1299         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1300         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1301         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1302         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1303         88  BIN-3-TO-GREG              VALUE 'I'.
  1304         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1305         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1306         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1307         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1308         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1309         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1310         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1311         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1312         88  THREE-CHARACTER-BIN
  1313                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1314         88  GREGORIAN-TO-BIN
  1315                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1316         88  BIN-TO-GREGORIAN
  1317                  VALUES ' ' '1' 'I' '8' 'G'.
  1318         88  JULIAN-TO-BINARY
  1319                  VALUES '5' 'C' 'E' 'F'.
  1320     12  DC-ERROR-CODE                 PIC X.
  1321         88  NO-CONVERSION-ERROR        VALUE ' '.
  1322         88  DATE-CONVERSION-ERROR
  1323                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1324         88  DATE-IS-ZERO               VALUE '1'.
  1325         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  27
* EL152.cbl
  1326         88  DATE-IS-INVALID            VALUE '3'.
  1327         88  DATE1-GREATER-DATE2        VALUE '4'.
  1328         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1329         88  DATE-INVALID-OPTION        VALUE '9'.
  1330         88  INVALID-CENTURY            VALUE 'A'.
  1331         88  ONLY-CENTURY               VALUE 'B'.
  1332         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1333         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1334     12  DC-END-OF-MONTH               PIC X.
  1335         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1336     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1337         88  USE-NORMAL-PROCESS         VALUE ' '.
  1338         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1339         88  ADJUST-UP-100-YRS          VALUE '2'.
  1340     12  FILLER                        PIC X.
  1341     12  DC-CONVERSION-DATES.
  1342         16  DC-BIN-DATE-1             PIC XX.
  1343         16  DC-BIN-DATE-2             PIC XX.
  1344         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1345         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1346                       DC-GREG-DATE-1-EDIT.
  1347             20  DC-EDIT1-MONTH        PIC 99.
  1348             20  SLASH1-1              PIC X.
  1349             20  DC-EDIT1-DAY          PIC 99.
  1350             20  SLASH1-2              PIC X.
  1351             20  DC-EDIT1-YEAR         PIC 99.
  1352         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1353         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1354                     DC-GREG-DATE-2-EDIT.
  1355             20  DC-EDIT2-MONTH        PIC 99.
  1356             20  SLASH2-1              PIC X.
  1357             20  DC-EDIT2-DAY          PIC 99.
  1358             20  SLASH2-2              PIC X.
  1359             20  DC-EDIT2-YEAR         PIC 99.
  1360         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1361         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1362                     DC-GREG-DATE-1-YMD.
  1363             20  DC-YMD-YEAR           PIC 99.
  1364             20  DC-YMD-MONTH          PIC 99.
  1365             20  DC-YMD-DAY            PIC 99.
  1366         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1367         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1368                      DC-GREG-DATE-1-MDY.
  1369             20  DC-MDY-MONTH          PIC 99.
  1370             20  DC-MDY-DAY            PIC 99.
  1371             20  DC-MDY-YEAR           PIC 99.
  1372         16  DC-GREG-DATE-1-ALPHA.
  1373             20  DC-ALPHA-MONTH        PIC X(10).
  1374             20  DC-ALPHA-DAY          PIC 99.
  1375             20  FILLER                PIC XX.
  1376             20  DC-ALPHA-CENTURY.
  1377                 24 DC-ALPHA-CEN-N     PIC 99.
  1378             20  DC-ALPHA-YEAR         PIC 99.
  1379         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1380         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1381         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1382         16  DC-JULIAN-DATE            PIC 9(05).
  1383         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  28
* EL152.cbl
  1384                                       PIC 9(05).
  1385         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1386             20  DC-JULIAN-YEAR        PIC 99.
  1387             20  DC-JULIAN-DAYS        PIC 999.
  1388         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1389         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1390         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1391     12  DATE-CONVERSION-VARIBLES.
  1392         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1393         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1394             20  FILLER                PIC 9(3).
  1395             20  HOLD-CEN-1-CCYY.
  1396                 24  HOLD-CEN-1-CC     PIC 99.
  1397                 24  HOLD-CEN-1-YY     PIC 99.
  1398             20  HOLD-CEN-1-MO         PIC 99.
  1399             20  HOLD-CEN-1-DA         PIC 99.
  1400         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1401             20  HOLD-CEN-1-R-MO       PIC 99.
  1402             20  HOLD-CEN-1-R-DA       PIC 99.
  1403             20  HOLD-CEN-1-R-CCYY.
  1404                 24  HOLD-CEN-1-R-CC   PIC 99.
  1405                 24  HOLD-CEN-1-R-YY   PIC 99.
  1406             20  FILLER                PIC 9(3).
  1407         16  HOLD-CENTURY-1-X.
  1408             20  FILLER                PIC X(3)  VALUE SPACES.
  1409             20  HOLD-CEN-1-X-CCYY.
  1410                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1411                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1412             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1413             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1414         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1415             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1416             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1417             20  HOLD-CEN-1-R-X-CCYY.
  1418                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1419                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1420             20  FILLER                PIC XXX.
  1421         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1422         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1423         16  DC-JULIAN-DATE-1          PIC 9(07).
  1424         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1425             20  DC-JULIAN-1-CCYY.
  1426                 24  DC-JULIAN-1-CC    PIC 99.
  1427                 24  DC-JULIAN-1-YR    PIC 99.
  1428             20  DC-JULIAN-DA-1        PIC 999.
  1429         16  DC-JULIAN-DATE-2          PIC 9(07).
  1430         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1431             20  DC-JULIAN-2-CCYY.
  1432                 24  DC-JULIAN-2-CC    PIC 99.
  1433                 24  DC-JULIAN-2-YR    PIC 99.
  1434             20  DC-JULIAN-DA-2        PIC 999.
  1435         16  DC-GREG-DATE-A-EDIT.
  1436             20  DC-EDITA-MONTH        PIC 99.
  1437             20  SLASHA-1              PIC X VALUE '/'.
  1438             20  DC-EDITA-DAY          PIC 99.
  1439             20  SLASHA-2              PIC X VALUE '/'.
  1440             20  DC-EDITA-CCYY.
  1441                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  29
* EL152.cbl
  1442                 24  DC-EDITA-YEAR     PIC 99.
  1443         16  DC-GREG-DATE-B-EDIT.
  1444             20  DC-EDITB-MONTH        PIC 99.
  1445             20  SLASHB-1              PIC X VALUE '/'.
  1446             20  DC-EDITB-DAY          PIC 99.
  1447             20  SLASHB-2              PIC X VALUE '/'.
  1448             20  DC-EDITB-CCYY.
  1449                 24  DC-EDITB-CENT     PIC 99.
  1450                 24  DC-EDITB-YEAR     PIC 99.
  1451         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1452         16  DC-GREG-DATE-CYMD-R REDEFINES
  1453                              DC-GREG-DATE-CYMD.
  1454             20  DC-CYMD-CEN           PIC 99.
  1455             20  DC-CYMD-YEAR          PIC 99.
  1456             20  DC-CYMD-MONTH         PIC 99.
  1457             20  DC-CYMD-DAY           PIC 99.
  1458         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1459         16  DC-GREG-DATE-MDCY-R REDEFINES
  1460                              DC-GREG-DATE-MDCY.
  1461             20  DC-MDCY-MONTH         PIC 99.
  1462             20  DC-MDCY-DAY           PIC 99.
  1463             20  DC-MDCY-CEN           PIC 99.
  1464             20  DC-MDCY-YEAR          PIC 99.
  1465    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1466        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1467    12  DC-EL310-DATE                  PIC X(21).
  1468    12  FILLER                         PIC X(28).
  1469
  1470*                                COPY ELCLOGOF.
  1471******************************************************************
  1472*                                                                *
  1473*                                                                *
  1474*                            ELCLOGOF.                           *
  1475*                            VMOD=2.001                          *
  1476*                                                                *
  1477*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1478*                                                                *
  1479******************************************************************
  1480 01  CLASIC-LOGOFF.
  1481     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1482     12  LOGOFF-TEXT.
  1483         16  FILLER          PIC X(5)    VALUE SPACES.
  1484         16  LOGOFF-MSG.
  1485             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1486             20  FILLER      PIC X       VALUE SPACES.
  1487             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1488         16  FILLER          PIC X(80)
  1489           VALUE '* YOU ARE NOW LOGGED OFF'.
  1490         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1491         16  FILLER          PIC X       VALUE QUOTE.
  1492         16  LOGOFF-SYS-MSG  PIC X(17)
  1493           VALUE 'S CLAS-IC SYSTEM '.
  1494     12  TEXT-MESSAGES.
  1495         16  UNACCESS-MSG    PIC X(29)
  1496             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1497         16  PGMIDERR-MSG    PIC X(17)
  1498             VALUE 'PROGRAM NOT FOUND'.
  1499
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  30
* EL152.cbl
  1501*                                COPY ELCNWA.
  1502*****************************************************************
  1503*                                                               *
  1504*                                                               *
  1505*                            ELCNWA.                            *
  1506*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1507*                            VMOD=2.003                         *
  1508*                                                               *
  1509*            M O V E   N A M E   W O R K   A R E A.             *
  1510*                                                               *
  1511*****************************************************************.
  1512
  1513 01  WS-NAME-WORK-AREA.
  1514     05  WS-INSURED-LAST-NAME        PIC X(15).
  1515     05  WS-INSURED-1ST-NAME         PIC X(12).
  1516     05  WS-INSURED-MID-INIT         PIC X.
  1517
  1518     05  WS-NAME-WORK.
  1519         10  WS-NW                   PIC X
  1520             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1521
  1522     05  WS-NAME-WORK2.
  1523         10  WS-NW2                  PIC X
  1524             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1525                                        NWA-INDEX0.
  1526
  1527     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1528                                     COMP-3.
  1529
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  31
* EL152.cbl
  1531*                                COPY ELCATTR.
  1532******************************************************************
  1533*                                                                *
  1534*                            ELCATTR.                            *
  1535*                            VMOD=2.001                          *
  1536*                                                                *
  1537*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1538*                                                                *
  1539*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1540*                                                                *
  1541*                   POS 1   P=PROTECTED                          *
  1542*                           U=UNPROTECTED                        *
  1543*                           S=ASKIP                              *
  1544*                   POS 2   A=ALPHA/NUMERIC                      *
  1545*                           N=NUMERIC                            *
  1546*                   POS 3   N=NORMAL                             *
  1547*                           B=BRIGHT                             *
  1548*                           D=DARK                               *
  1549*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1550*                           OF=MODIFIED DATA TAG OFF             *
  1551*                                                                *
  1552*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1553******************************************************************
  1554 01  ATTRIBUTE-LIST.
  1555     12  AL-PABOF            PIC X       VALUE 'Y'.
  1556     12  AL-PABON            PIC X       VALUE 'Z'.
  1557     12  AL-PADOF            PIC X       VALUE '%'.
  1558     12  AL-PADON            PIC X       VALUE '_'.
  1559     12  AL-PANOF            PIC X       VALUE '-'.
  1560     12  AL-PANON            PIC X       VALUE '/'.
  1561     12  AL-SABOF            PIC X       VALUE '8'.
  1562     12  AL-SABON            PIC X       VALUE '9'.
  1563     12  AL-SADOF            PIC X       VALUE '@'.
  1564     12  AL-SADON            PIC X       VALUE QUOTE.
  1565     12  AL-SANOF            PIC X       VALUE '0'.
  1566     12  AL-SANON            PIC X       VALUE '1'.
  1567     12  AL-UABOF            PIC X       VALUE 'H'.
  1568     12  AL-UABON            PIC X       VALUE 'I'.
  1569     12  AL-UADOF            PIC X       VALUE '<'.
  1570     12  AL-UADON            PIC X       VALUE '('.
  1571     12  AL-UANOF            PIC X       VALUE ' '.
  1572     12  AL-UANON            PIC X       VALUE 'A'.
  1573     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1574     12  AL-UNBON            PIC X       VALUE 'R'.
  1575     12  AL-UNDOF            PIC X       VALUE '*'.
  1576     12  AL-UNDON            PIC X       VALUE ')'.
  1577     12  AL-UNNOF            PIC X       VALUE '&'.
  1578     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  32
* EL152.cbl
  1580*                                COPY ELCEMIB.
  1581******************************************************************
  1582*                                                                *
  1583*                                                                *
  1584*                            ELCEMIB.                            *
  1585*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1586*                            VMOD=2.005                          *
  1587*                                                                *
  1588*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1589*                                                                *
  1590******************************************************************
  1591 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1592     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1593     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1594     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1595     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1596     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1597     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1598     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1599     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1600     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1601         88  EMI-NO-ERRORS                    VALUE '1'.
  1602         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1603         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1604     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1605         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1606     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1607         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1608         88  EMI-AREA1-FULL                   VALUE '2'.
  1609     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1610         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1611         88  EMI-AREA2-FULL                   VALUE '2'.
  1612     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1613         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1614         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1615         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1616         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1617         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1618     12  EMI-ERROR-LINES.
  1619         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1620         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1621         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1622         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1623             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1624                 24  EMI-ERR-NUM         PIC X(4).
  1625                 24  EMI-FILLER          PIC X.
  1626                 24  EMI-SEV             PIC X.
  1627                 24  FILLER              PIC X.
  1628             20  FILLER                  PIC X(02).
  1629     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1630         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1631             20  EMI-ERROR-NUMBER    PIC X(4).
  1632             20  EMI-FILL            PIC X.
  1633             20  EMI-SEVERITY        PIC X.
  1634             20  FILLER              PIC X.
  1635             20  EMI-ERROR-TEXT.
  1636                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1637                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  33
* EL152.cbl
  1638     12  EMI-SEVERITY-SAVE           PIC X.
  1639         88  EMI-NOTE                    VALUE 'N'.
  1640         88  EMI-WARNING                 VALUE 'W'.
  1641         88  EMI-FORCABLE                VALUE 'F'.
  1642         88  EMI-FATAL                   VALUE 'X'.
  1643     12  EMI-MESSAGE-FLAG            PIC X.
  1644         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1645         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1646     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1647     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1648         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1649         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1650         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1651     12  emi-claim-no                pic x(7).
  1652     12  emi-claim-type              pic x(6).
  1653     12  FILLER                      PIC X(124)  VALUE SPACES.
  1654     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1655     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1656     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1657     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1658 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  34
* EL152.cbl
  1660*                                COPY ELCINTF.
  1661******************************************************************
  1662*                                                                *
  1663*                                                                *
  1664*                            ELCINTF.                            *
  1665*                            VMOD=2.017                          *
  1666*                                                                *
  1667*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1668*                                                                *
  1669*       LENGTH = 1024                                            *
  1670*                                                                *
  1671******************************************************************
  1672*                   C H A N G E   L O G
  1673*
  1674* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1675*-----------------------------------------------------------------
  1676*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1677* EFFECTIVE    NUMBER
  1678*-----------------------------------------------------------------
  1679* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1680******************************************************************
  1681 01  PROGRAM-INTERFACE-BLOCK.
  1682     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1683     12  PI-CALLING-PROGRAM              PIC X(8).
  1684     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1685     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1686     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1687     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1688     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1689     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1690     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1691     12  PI-COMPANY-ID                   PIC XXX.
  1692     12  PI-COMPANY-CD                   PIC X.
  1693
  1694     12  PI-COMPANY-PASSWORD             PIC X(8).
  1695
  1696     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1697
  1698     12  PI-CONTROL-IN-PROGRESS.
  1699         16  PI-CARRIER                  PIC X.
  1700         16  PI-GROUPING                 PIC X(6).
  1701         16  PI-STATE                    PIC XX.
  1702         16  PI-ACCOUNT                  PIC X(10).
  1703         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1704                                         PIC X(10).
  1705         16  PI-CLAIM-CERT-GRP.
  1706             20  PI-CLAIM-NO             PIC X(7).
  1707             20  PI-CERT-NO.
  1708                 25  PI-CERT-PRIME       PIC X(10).
  1709                 25  PI-CERT-SFX         PIC X.
  1710             20  PI-CERT-EFF-DT          PIC XX.
  1711         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1712             20  PI-PLAN-CODE            PIC X(2).
  1713             20  PI-REVISION-NUMBER      PIC X(3).
  1714             20  PI-PLAN-EFF-DT          PIC X(2).
  1715             20  PI-PLAN-EXP-DT          PIC X(2).
  1716             20  FILLER                  PIC X(11).
  1717         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  35
* EL152.cbl
  1718             20  PI-OE-REFERENCE-1.
  1719                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1720                 25  PI-OE-REF-1-SUFF    PIC XX.
  1721
  1722     12  PI-SESSION-IN-PROGRESS          PIC X.
  1723         88  CLAIM-SESSION                   VALUE '1'.
  1724         88  CREDIT-SESSION                  VALUE '2'.
  1725         88  WARRANTY-SESSION                VALUE '3'.
  1726         88  MORTGAGE-SESSION                VALUE '4'.
  1727         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1728
  1729
  1730*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1731
  1732     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1733     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1734
  1735     12  PI-CREDIT-USER                  PIC X.
  1736         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1737         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1738
  1739     12  PI-CLAIM-USER                   PIC X.
  1740         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1741         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1742
  1743     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1744         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1745         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1746         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1747         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1748         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1749
  1750     12  PI-PROCESSOR-ID                 PIC X(4).
  1751
  1752     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1753
  1754     12  PI-MEMBER-CAPTION               PIC X(10).
  1755
  1756     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1757         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1758
  1759     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1760     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1761     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1762     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1763
  1764     12  PI-AH-OVERRIDE-L1               PIC X.
  1765     12  PI-AH-OVERRIDE-L2               PIC XX.
  1766     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1767     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1768
  1769     12  PI-NEW-SYSTEM                   PIC X(2).
  1770
  1771     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1772     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1773         88  PI-USES-PAID-TO                 VALUE '1'.
  1774     12  PI-CRDTCRD-SYSTEM.
  1775         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  36
* EL152.cbl
  1776             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1777             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1778         16  PI-CC-MONTH-END-DT          PIC XX.
  1779     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1780
  1781     12  PI-OE-REFERENCE-2.
  1782         16  PI-OE-REF-2-PRIME           PIC X(10).
  1783         16  PI-OE-REF-2-SUFF            PIC X.
  1784
  1785     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1786
  1787     12  PI-LANGUAGE-TYPE                PIC X.
  1788             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1789             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1790             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1791
  1792     12  PI-POLICY-LINKAGE-IND           PIC X.
  1793         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1794         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1795                                                   LOW-VALUES.
  1796
  1797     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1798     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1799         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1800         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1801
  1802     12  PI-PROCESSOR-CSR-IND            PIC X.
  1803         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1804         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1805
  1806     12  FILLER                          PIC X(3).
  1807
  1808     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1809
  1810     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1811         PI-SYSTEM-LEVEL.
  1812
  1813         16  PI-ENTRY-CODES.
  1814             20  PI-ENTRY-CD-1           PIC X.
  1815             20  PI-ENTRY-CD-2           PIC X.
  1816
  1817         16  PI-RETURN-CODES.
  1818             20  PI-RETURN-CD-1          PIC X.
  1819             20  PI-RETURN-CD-2          PIC X.
  1820
  1821         16  PI-UPDATE-STATUS-SAVE.
  1822             20  PI-UPDATE-BY            PIC X(4).
  1823             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1824
  1825         16  PI-LOWER-CASE-LETTERS       PIC X.
  1826             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1827
  1828*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1829*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1830*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1831
  1832         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1833             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  37
* EL152.cbl
  1834             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1835             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1836             88  ACCNT-CNTL                  VALUE '3'.
  1837             88  CARR-ACCNT-CNTL             VALUE '4'.
  1838
  1839         16  PI-PROCESSOR-CAP-LIST.
  1840             20  PI-SYSTEM-CONTROLS.
  1841                24 PI-SYSTEM-DISPLAY     PIC X.
  1842                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1843                24 PI-SYSTEM-MODIFY      PIC X.
  1844                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1845             20  FILLER                  PIC XX.
  1846             20  PI-DISPLAY-CAP          PIC X.
  1847                 88  DISPLAY-CAP             VALUE 'Y'.
  1848             20  PI-MODIFY-CAP           PIC X.
  1849                 88  MODIFY-CAP              VALUE 'Y'.
  1850             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1851                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1852             20  PI-FORCE-CAP            PIC X.
  1853                 88  FORCE-CAP               VALUE 'Y'.
  1854
  1855         16  PI-PROGRAM-CONTROLS.
  1856             20  PI-PGM-PRINT-OPT        PIC X.
  1857             20  PI-PGM-FORMAT-OPT       PIC X.
  1858             20  PI-PGM-PROCESS-OPT      PIC X.
  1859             20  PI-PGM-TOTALS-OPT       PIC X.
  1860
  1861         16  PI-HELP-INTERFACE.
  1862             20  PI-LAST-ERROR-NO        PIC X(4).
  1863             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1864
  1865         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1866             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1867
  1868         16  PI-CR-CONTROL-IN-PROGRESS.
  1869             20  PI-CR-CARRIER           PIC X.
  1870             20  PI-CR-GROUPING          PIC X(6).
  1871             20  PI-CR-STATE             PIC XX.
  1872             20  PI-CR-ACCOUNT           PIC X(10).
  1873             20  PI-CR-FIN-RESP          PIC X(10).
  1874             20  PI-CR-TYPE              PIC X.
  1875
  1876         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1877
  1878         16  PI-CR-MONTH-END-DT          PIC XX.
  1879
  1880         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1881             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1882             88  PI-ZERO-CARRIER             VALUE '1'.
  1883             88  PI-ZERO-GROUPING            VALUE '2'.
  1884             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1885
  1886         16  PI-CARRIER-SECURITY         PIC X.
  1887             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1888
  1889         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1890             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1891             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  38
* EL152.cbl
  1892
  1893         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1894             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1895                                         INDEXED BY PI-ACCESS-NDX
  1896                                         PIC X.
  1897
  1898         16  PI-GA-BILLING-CONTROL       PIC X.
  1899             88  PI-GA-BILLING               VALUE '1'.
  1900
  1901         16  PI-MAIL-PROCESSING          PIC X.
  1902             88  PI-MAIL-YES                 VALUE 'Y'.
  1903
  1904         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1905
  1906         16  PI-AR-SYSTEM.
  1907             20  PI-AR-PROCESSING-CNTL   PIC X.
  1908                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1909             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1910             20  PI-AR-MONTH-END-DT      PIC XX.
  1911
  1912         16  PI-MP-SYSTEM.
  1913             20  PI-MORTGAGE-USER            PIC X.
  1914                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1915                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1916             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1917                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1918                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1919                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1920                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1921                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1922             20  PI-MP-MONTH-END-DT          PIC XX.
  1923             20  PI-MP-REFERENCE-NO.
  1924                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1925                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1926
  1927         16  PI-LABEL-CONTROL            PIC X(01).
  1928             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1929             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1930
  1931         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1932             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1933
  1934         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1935             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1936             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1937
  1938         16  FILLER                      PIC X(14).
  1939
  1940     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1941******************************************************************
  1942     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
  1943*        COPY ELC1042.
  1944******************************************************************
  1945*                                                                *
  1946*                                                                *
  1947*                           ELC1042                              *
  1948*                            VMOD=2.002                          *
  1949*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  39
* EL152.cbl
  1950*    NOTE                                                        *
  1951*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1952*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1953*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1954*        TO THESE PROGRAMS.                                      *
  1955*                                                                *
  1956*    NOTE                                                        *
  1957*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1958*        USE ONLY!                                               *
  1959*                                                                *
  1960******************************************************************
  1961
  1962         16  PI-1042-WA.
  1963             20  PI-ACTION       PIC  X(01).
  1964                 88 PI-SHOW-MODE           VALUE '1'.
  1965                 88 PI-CLEAR-MODE          VALUE '2'.
  1966                 88 PI-CREATE-MODE         VALUE '3'.
  1967             20  PI-COMM-CONTROL PIC  X(12).
  1968             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1969             20  PI-EOF-SW       PIC  X(01).
  1970                 88  PI-FILE-EOF           VALUE 'Y'.
  1971             20  PI-FILETYP      PIC  X(01).
  1972             20  PI-FORM-SQUEEZE-CONTROL
  1973                                 PIC  X(01).
  1974                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1975                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1976             20  PI-LAST-CONTROL PIC  X(12).
  1977             20  PI-TEMP-STOR-ITEMS
  1978                                 PIC S9(04) COMP.
  1979             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1980             20  PI-UPDATE-SW    PIC  9(01).
  1981                 88 ANY-UPDATES            VALUE 1.
  1982             20  PI-104-SCREEN-SENT-IND
  1983                                 PIC  X(01).
  1984                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1985                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1986             20  PI-1042-SCREEN-SENT-IND
  1987                                 PIC  X(01).
  1988                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1989                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1990             20  PI-1042-ARCHIVE-IND
  1991                                 PIC  X(01).
  1992                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1993             20  FILLER          PIC  X(29).
  1994**********************************************************
  1995*    NOTE                                                *
  1996*        THE WORK AREA IS USED BY EL152 AND EL1522       *
  1997*        AND CANNOT BE REARRANGED WITHOUT COMPILING      *
  1998*        BOTH PROGRAMS.                                  *
  1999*                                                        *
  2000**********************************************************
  2001         16  PI-EL152-WA.
  2002             20  PI-ALT-PRINTER-ID        PIC X(4).
  2003             20  PI-ARCHIVE-NUMBER        PIC 9(8).
  2004             20  PI-FORM-NUMBER           PIC X(4).
  2005             20  PI-ADDR-TYPE             PIC XX.
  2006             20  PI-TEMP-STOR-ID          PIC X(8).
  2007             20  PI-NUM-PRINT-COPIES      PIC 9.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  40
* EL152.cbl
  2008             20  PI-ADDR-SEQ              PIC S9(4)   COMP.
  2009             20  PI-PRINT-SW              PIC X.
  2010                 88 PRINT-PERFORMED  VALUE '1'.
  2011             20  PI-LETTER-ADDRESS-TYPE   PIC XX.
  2012             20  PI-RESEND-FORM-NUMBER    PIC X(4).
  2013             20  PI-PROMPT-LETTER         PIC X.
  2014             20  PI-ENCLOSURE-CD          PIC X(3).
  2015             20  PI-AUTO-CLOSE-IND        PIC X(1).
  2016             20  PI-LETTER-TO-BENE        PIC X(1).
  2017             20  PI-FILLER                PIC X(528).
  2018             20  PI-FORCE-7840            PIC X.
  2019                 88 FORCE-7840       VALUE '1'.
  2020
  2021             20  PI-BSR-LETTER-IND        PIC XX.
  2022                 88  PI-BSR-AUTOMATED VALUE 'BA'.
  2023             20  FILLER REDEFINES PI-BSR-LETTER-IND.
  2024                 22  PI-ELLETR-BSR        PIC X.
  2025                 22  PI-ELBENE-BSR        PIC X.
  2026
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  41
* EL152.cbl
  2028*                            COPY DFHBMSCA.
  2029*****************************************************************
  2030*                                                               *
  2031* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2032* All rights reserved.                                          *
  2033*                                                               *
  2034*****************************************************************
  2035 01    DFHBMSCA.
  2036*        VARIABLE  PROTECTION    INTENSITY    MODIFIED
  2037*                                             DATA TAG
  2038*
  2039*        DFHBMUNP  Unprotected   Normal       Off
  2040     02  DFHBMUNP PIC X VALUE SPACE.
  2041*        DFHBMUNN  Numeric       Normal       Off
  2042     02  DFHBMUNN PIC X VALUE "&".
  2043*        DFHBMPRO  Protected     Normal       Off
  2044     02  DFHBMPRO PIC X VALUE "-".
  2045*        DFHBMASK  Autoskip      Normal       Off
  2046     02  DFHBMASK PIC X VALUE "0".
  2047*************************************************
  2048*        DFHBMBRY  Unprotected   Bright       Off
  2049     02  DFHBMBRY PIC X VALUE "H".
  2050*        DFHPROTI  Protected     Bright       Off
  2051     02  DFHPROTI PIC X VALUE "Y".
  2052*        DFHBMASB  Autoskip      Bright       Off
  2053     02  DFHBMASB PIC X VALUE "8".
  2054*************************************************
  2055*        DFHBMDAR  Unprotected   Non-Display  Off
  2056     02  DFHBMDAR PIC X VALUE "<".
  2057*        DFHPROTN  Protected     Non-Display  Off
  2058     02  DFHPROTN PIC X VALUE "%".
  2059*************************************************
  2060*        DFHBMFSE  Unprotected   Normal       On
  2061     02  DFHBMFSE PIC X VALUE "A".
  2062*        DFHBMASF  Autoskip      Normal       On
  2063     02  DFHBMASF  PIC X VALUE "1".
  2064*        DFHUNNUM  Numeric       Normal       On
  2065     02  DFHUNNUM PIC X VALUE "J".
  2066*        DFHBMPRF  Protected     Normal       On
  2067     02  DFHBMPRF PIC X VALUE "/".
  2068*************************************************
  2069*        DFHUNIMD  Unprotected   Bright       On
  2070     02  DFHUNIMD PIC X VALUE "I".
  2071*        DFHUNINT  Numeric       Bright       On
  2072     02  DFHUNINT PIC X VALUE "R".
  2073*************************************************
  2074*        DFHUNNOD  Unprotected   Non-Display  On
  2075     02  DFHUNNOD PIC X VALUE "(".
  2076*        DFHUNNON  Numeric       Non-Display  On
  2077     02  DFHUNNON PIC X VALUE ")".
  2078*************************************************
  2079*
  2080*     COLOURS
  2081*
  2082     02  DFHDFCOL PIC X VALUE X"00".
  2083     02  DFHBLUE  PIC X VALUE "1".
  2084     02  DFHRED   PIC X VALUE "2".
  2085     02  DFHPINK  PIC X VALUE "3".
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  42
* EL152.cbl
  2086     02  DFHGREEN PIC X VALUE "4".
  2087     02  DFHTURQ  PIC X VALUE "5".
  2088     02  DFHYELLO PIC X VALUE "6".
  2089     02  DFHNEUTR PIC X VALUE "7".
  2090     02  DFH3270  PIC X VALUE "{".
  2091     02  DFHALL   PIC X VALUE LOW-VALUE.
  2092     02  DFHBASE  PIC X VALUE LOW-VALUE.
  2093     02  DFHBLINK PIC X VALUE "1".
  2094     02  DFHBMDET PIC X VALUE LOW-VALUE.
  2095     02  DFHBMEOF PIC X VALUE X"80".
  2096     02  DFHBMPEM PIC X VALUE X"19".
  2097* Newline, DFHBMPNL, is changed to be an ASCII 0x0A
  2098     02  DFHBMPNL PIC X VALUE X"0A".
  2099     02  DFHCOLOR PIC X VALUE "!".
  2100     02  DFHDFHI  PIC X VALUE LOW-VALUE.
  2101     02  DFHDFT   PIC X VALUE X"FF".
  2102     02  DFHERROR PIC X VALUE X"1A".
  2103     02  DFHHLT   PIC X VALUE " ".
  2104     02  DFHMENT  PIC X VALUE X"02".
  2105     02  DFHBMCUR  PIC X VALUE X"02".
  2106     02  DFHBMFLG  PIC X.
  2107         88 DFHCURSR VALUES ARE X"02" , X"82".
  2108     02  DFHMET   PIC X VALUE X"03".
  2109     02  DFHMFE   PIC X VALUE X"06".
  2110     02  DFHMFET  PIC X VALUE LOW-VALUE.
  2111     02  DFHMFIL  PIC X VALUE X"1C".
  2112     02  DFHMFT   PIC X VALUE X"09".
  2113     02  DFHMT    PIC X VALUE X"01".
  2114     02  DFHPS    PIC X VALUE '"'.
  2115     02  DFHREVRS PIC X VALUE "2".
  2116     02  DFHSA    PIC X VALUE X"08".
  2117     02  DFHUNDLN PIC X VALUE "4".
  2118     02  DFHVAL   PIC X VALUE "A".
  2119     02  DFHLEFT  PIC X VALUE X"97".
  2120     02  DFHOVER  PIC X VALUE X"9C".
  2121     02  DFHRIGHT PIC X VALUE X"02".
  2122     02  DFHUNDER PIC X VALUE X"01".
  2123     02  DFHBOX-BIN  PIC 9(4) COMP VALUE 15.
  2124     02  FILLER REDEFINES DFHBOX-BIN.
  2125         03  FILLER PIC X.
  2126         03  DFHBOX PIC X.
  2127     02  DFHSOSI  PIC X VALUE X"01".
  2128     02  DFHBMPSO-BIN    PIC 9(4) COMP VALUE 3599.
  2129     02  FILLER REDEFINES DFHBMPSO-BIN.
  2130         03 DFHBMPSO  PIC X.
  2131         03 DFHBMPSI  PIC X.
  2132     02  DFHBMEC  PIC X VALUE X"82".
  2133*    02  DFHDFFR  PIC X VALUE X"00".
  2134*    02  DFHOPAQ  PIC X VALUE X"00".
  2135*    02  DFHOUTLN PIC X VALUE X"00".
  2136*    02  DFHTRANS PIC X VALUE X"00".
  2137*    02  DFHBKTRN PIC X VALUE X"00".
  2138*                            COPY ELCAID.
  2139******************************************************************
  2140*                                                                *
  2141*                            ELCAID.                             *
  2142*                            VMOD=2.001                          *
  2143*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  43
* EL152.cbl
  2144*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2145*                                                                *
  2146*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2147*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2148******************************************************************
  2149
  2150 01  DFHAID.
  2151   02  DFHNULL   PIC  X  VALUE  ' '.
  2152   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2153   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2154   02  DFHPEN    PIC  X  VALUE  '='.
  2155   02  DFHOPID   PIC  X  VALUE  'W'.
  2156   02  DFHPA1    PIC  X  VALUE  '%'.
  2157   02  DFHPA2    PIC  X  VALUE  '>'.
  2158   02  DFHPA3    PIC  X  VALUE  ','.
  2159   02  DFHPF1    PIC  X  VALUE  '1'.
  2160   02  DFHPF2    PIC  X  VALUE  '2'.
  2161   02  DFHPF3    PIC  X  VALUE  '3'.
  2162   02  DFHPF4    PIC  X  VALUE  '4'.
  2163   02  DFHPF5    PIC  X  VALUE  '5'.
  2164   02  DFHPF6    PIC  X  VALUE  '6'.
  2165   02  DFHPF7    PIC  X  VALUE  '7'.
  2166   02  DFHPF8    PIC  X  VALUE  '8'.
  2167   02  DFHPF9    PIC  X  VALUE  '9'.
  2168   02  DFHPF10   PIC  X  VALUE  ':'.
  2169   02  DFHPF11   PIC  X  VALUE  '#'.
  2170   02  DFHPF12   PIC  X  VALUE  '@'.
  2171   02  DFHPF13   PIC  X  VALUE  'A'.
  2172   02  DFHPF14   PIC  X  VALUE  'B'.
  2173   02  DFHPF15   PIC  X  VALUE  'C'.
  2174   02  DFHPF16   PIC  X  VALUE  'D'.
  2175   02  DFHPF17   PIC  X  VALUE  'E'.
  2176   02  DFHPF18   PIC  X  VALUE  'F'.
  2177   02  DFHPF19   PIC  X  VALUE  'G'.
  2178   02  DFHPF20   PIC  X  VALUE  'H'.
  2179   02  DFHPF21   PIC  X  VALUE  'I'.
  2180*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2181   02  DFHPF22   PIC  X  VALUE  '['.
  2182   02  DFHPF23   PIC  X  VALUE  '.'.
  2183   02  DFHPF24   PIC  X  VALUE  '<'.
  2184   02  DFHMSRE   PIC  X  VALUE  'X'.
  2185   02  DFHSTRF   PIC  X  VALUE  'h'.
  2186   02  DFHTRIG   PIC  X  VALUE  '"'.
  2187 01  FILLER    REDEFINES DFHAID.
  2188     12  FILLER              PIC X(8).
  2189     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  44
* EL152.cbl
  2191*                            COPY EL152S.
  2192 01  EL152AI.
  2193     05  FILLER            PIC  X(0012).
  2194*    -------------------------------
  2195     05  DATEAL PIC S9(0004) COMP.
  2196     05  DATEAF PIC  X(0001).
  2197     05  FILLER REDEFINES DATEAF.
  2198         10  DATEAA PIC  X(0001).
  2199     05  DATEAI PIC  X(0008).
  2200*    -------------------------------
  2201     05  TIMEAL PIC S9(0004) COMP.
  2202     05  TIMEAF PIC  X(0001).
  2203     05  FILLER REDEFINES TIMEAF.
  2204         10  TIMEAA PIC  X(0001).
  2205     05  TIMEAI PIC  X(0005).
  2206*    -------------------------------
  2207     05  CARRL PIC S9(0004) COMP.
  2208     05  CARRF PIC  X(0001).
  2209     05  FILLER REDEFINES CARRF.
  2210         10  CARRA PIC  X(0001).
  2211     05  CARRI PIC  X(0001).
  2212*    -------------------------------
  2213     05  CLMNOL PIC S9(0004) COMP.
  2214     05  CLMNOF PIC  X(0001).
  2215     05  FILLER REDEFINES CLMNOF.
  2216         10  CLMNOA PIC  X(0001).
  2217     05  CLMNOI PIC  X(0007).
  2218*    -------------------------------
  2219     05  CRTNOL PIC S9(0004) COMP.
  2220     05  CRTNOF PIC  X(0001).
  2221     05  FILLER REDEFINES CRTNOF.
  2222         10  CRTNOA PIC  X(0001).
  2223     05  CRTNOI PIC  X(0011).
  2224*    -------------------------------
  2225     05  PROCL PIC S9(0004) COMP.
  2226     05  PROCF PIC  X(0001).
  2227     05  FILLER REDEFINES PROCF.
  2228         10  PROCA PIC  X(0001).
  2229     05  PROCI PIC  X(0004).
  2230*    -------------------------------
  2231     05  COMPIDL PIC S9(0004) COMP.
  2232     05  COMPIDF PIC  X(0001).
  2233     05  FILLER REDEFINES COMPIDF.
  2234         10  COMPIDA PIC  X(0001).
  2235     05  COMPIDI PIC  X(0003).
  2236*    -------------------------------
  2237     05  CLEANL PIC S9(0004) COMP.
  2238     05  CLEANF PIC  X(0001).
  2239     05  FILLER REDEFINES CLEANF.
  2240         10  CLEANA PIC  X(0001).
  2241     05  CLEANI PIC  X(0001).
  2242*    -------------------------------
  2243     05  SYSL PIC S9(0004) COMP.
  2244     05  SYSF PIC  X(0001).
  2245     05  FILLER REDEFINES SYSF.
  2246         10  SYSA PIC  X(0001).
  2247     05  SYSI PIC  X(0008).
  2248*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  45
* EL152.cbl
  2249     05  MAINTL PIC S9(0004) COMP.
  2250     05  MAINTF PIC  X(0001).
  2251     05  FILLER REDEFINES MAINTF.
  2252         10  MAINTA PIC  X(0001).
  2253     05  MAINTI PIC  X(0001).
  2254*    -------------------------------
  2255     05  ARCHNUML PIC S9(0004) COMP.
  2256     05  ARCHNUMF PIC  X(0001).
  2257     05  FILLER REDEFINES ARCHNUMF.
  2258         10  ARCHNUMA PIC  X(0001).
  2259     05  ARCHNUMI PIC  99999999.
  2260*    -------------------------------
  2261     05  FORML PIC S9(0004) COMP.
  2262     05  FORMF PIC  X(0001).
  2263     05  FILLER REDEFINES FORMF.
  2264         10  FORMA PIC  X(0001).
  2265     05  FORMI PIC  X(0004).
  2266*    -------------------------------
  2267     05  FOLLOWL PIC S9(0004) COMP.
  2268     05  FOLLOWF PIC  X(0001).
  2269     05  FILLER REDEFINES FOLLOWF.
  2270         10  FOLLOWA PIC  X(0001).
  2271     05  FOLLOWI PIC  X(0008).
  2272*    -------------------------------
  2273     05  RESENDL PIC S9(0004) COMP.
  2274     05  RESENDF PIC  X(0001).
  2275     05  FILLER REDEFINES RESENDF.
  2276         10  RESENDA PIC  X(0001).
  2277     05  RESENDI PIC  X(0008).
  2278*    -------------------------------
  2279     05  PRINTL PIC S9(0004) COMP.
  2280     05  PRINTF PIC  X(0001).
  2281     05  FILLER REDEFINES PRINTF.
  2282         10  PRINTA PIC  X(0001).
  2283     05  PRINTI PIC  X(0001).
  2284*    -------------------------------
  2285     05  COPIESL PIC S9(0004) COMP.
  2286     05  COPIESF PIC  X(0001).
  2287     05  FILLER REDEFINES COPIESF.
  2288         10  COPIESA PIC  X(0001).
  2289     05  COPIESI PIC  X(0001).
  2290*    -------------------------------
  2291     05  ENCL PIC S9(0004) COMP.
  2292     05  ENCF PIC  X(0001).
  2293     05  FILLER REDEFINES ENCF.
  2294         10  ENCA PIC  X(0001).
  2295     05  ENCI PIC  X(0003).
  2296*    -------------------------------
  2297     05  ADDRL PIC S9(0004) COMP.
  2298     05  ADDRF PIC  X(0001).
  2299     05  FILLER REDEFINES ADDRF.
  2300         10  ADDRA PIC  X(0001).
  2301     05  ADDRI PIC  X(0002).
  2302*    -------------------------------
  2303     05  ACTL PIC S9(0004) COMP.
  2304     05  ACTF PIC  X(0001).
  2305     05  FILLER REDEFINES ACTF.
  2306         10  ACTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  46
* EL152.cbl
  2307     05  ACTI PIC  X(0001).
  2308*    -------------------------------
  2309     05  BENL PIC S9(0004) COMP.
  2310     05  BENF PIC  X(0001).
  2311     05  FILLER REDEFINES BENF.
  2312         10  BENA PIC  X(0001).
  2313     05  BENI PIC  X(0001).
  2314*    -------------------------------
  2315     05  EMPL PIC S9(0004) COMP.
  2316     05  EMPF PIC  X(0001).
  2317     05  FILLER REDEFINES EMPF.
  2318         10  EMPA PIC  X(0001).
  2319     05  EMPI PIC  X(0001).
  2320*    -------------------------------
  2321     05  INSL PIC S9(0004) COMP.
  2322     05  INSF PIC  X(0001).
  2323     05  FILLER REDEFINES INSF.
  2324         10  INSA PIC  X(0001).
  2325     05  INSI PIC  X(0001).
  2326*    -------------------------------
  2327     05  PHYSL PIC S9(0004) COMP.
  2328     05  PHYSF PIC  X(0001).
  2329     05  FILLER REDEFINES PHYSF.
  2330         10  PHYSA PIC  X(0001).
  2331     05  PHYSI PIC  X(0001).
  2332*    -------------------------------
  2333     05  OTHR1L PIC S9(0004) COMP.
  2334     05  OTHR1F PIC  X(0001).
  2335     05  FILLER REDEFINES OTHR1F.
  2336         10  OTHR1A PIC  X(0001).
  2337     05  OTHR1I PIC  X(0001).
  2338*    -------------------------------
  2339     05  OTHR2L PIC S9(0004) COMP.
  2340     05  OTHR2F PIC  X(0001).
  2341     05  FILLER REDEFINES OTHR2F.
  2342         10  OTHR2A PIC  X(0001).
  2343     05  OTHR2I PIC  X(0001).
  2344*    -------------------------------
  2345     05  REL PIC S9(0004) COMP.
  2346     05  REF PIC  X(0001).
  2347     05  FILLER REDEFINES REF.
  2348         10  REA PIC  X(0001).
  2349     05  REI PIC  X(0070).
  2350*    -------------------------------
  2351     05  L1L PIC S9(0004) COMP.
  2352     05  L1F PIC  X(0001).
  2353     05  FILLER REDEFINES L1F.
  2354         10  L1A PIC  X(0001).
  2355     05  L1I PIC  X(0003).
  2356*    -------------------------------
  2357     05  TEXT1L PIC S9(0004) COMP.
  2358     05  TEXT1F PIC  X(0001).
  2359     05  FILLER REDEFINES TEXT1F.
  2360         10  TEXT1A PIC  X(0001).
  2361     05  TEXT1I PIC  X(0070).
  2362*    -------------------------------
  2363     05  L2L PIC S9(0004) COMP.
  2364     05  L2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  47
* EL152.cbl
  2365     05  FILLER REDEFINES L2F.
  2366         10  L2A PIC  X(0001).
  2367     05  L2I PIC  X(0003).
  2368*    -------------------------------
  2369     05  TEXT2L PIC S9(0004) COMP.
  2370     05  TEXT2F PIC  X(0001).
  2371     05  FILLER REDEFINES TEXT2F.
  2372         10  TEXT2A PIC  X(0001).
  2373     05  TEXT2I PIC  X(0070).
  2374*    -------------------------------
  2375     05  L3L PIC S9(0004) COMP.
  2376     05  L3F PIC  X(0001).
  2377     05  FILLER REDEFINES L3F.
  2378         10  L3A PIC  X(0001).
  2379     05  L3I PIC  X(0003).
  2380*    -------------------------------
  2381     05  TEXT3L PIC S9(0004) COMP.
  2382     05  TEXT3F PIC  X(0001).
  2383     05  FILLER REDEFINES TEXT3F.
  2384         10  TEXT3A PIC  X(0001).
  2385     05  TEXT3I PIC  X(0070).
  2386*    -------------------------------
  2387     05  L4L PIC S9(0004) COMP.
  2388     05  L4F PIC  X(0001).
  2389     05  FILLER REDEFINES L4F.
  2390         10  L4A PIC  X(0001).
  2391     05  L4I PIC  X(0003).
  2392*    -------------------------------
  2393     05  TEXT4L PIC S9(0004) COMP.
  2394     05  TEXT4F PIC  X(0001).
  2395     05  FILLER REDEFINES TEXT4F.
  2396         10  TEXT4A PIC  X(0001).
  2397     05  TEXT4I PIC  X(0070).
  2398*    -------------------------------
  2399     05  L5L PIC S9(0004) COMP.
  2400     05  L5F PIC  X(0001).
  2401     05  FILLER REDEFINES L5F.
  2402         10  L5A PIC  X(0001).
  2403     05  L5I PIC  X(0003).
  2404*    -------------------------------
  2405     05  TEXT5L PIC S9(0004) COMP.
  2406     05  TEXT5F PIC  X(0001).
  2407     05  FILLER REDEFINES TEXT5F.
  2408         10  TEXT5A PIC  X(0001).
  2409     05  TEXT5I PIC  X(0070).
  2410*    -------------------------------
  2411     05  L6L PIC S9(0004) COMP.
  2412     05  L6F PIC  X(0001).
  2413     05  FILLER REDEFINES L6F.
  2414         10  L6A PIC  X(0001).
  2415     05  L6I PIC  X(0003).
  2416*    -------------------------------
  2417     05  TEXT6L PIC S9(0004) COMP.
  2418     05  TEXT6F PIC  X(0001).
  2419     05  FILLER REDEFINES TEXT6F.
  2420         10  TEXT6A PIC  X(0001).
  2421     05  TEXT6I PIC  X(0070).
  2422*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  48
* EL152.cbl
  2423     05  L7L PIC S9(0004) COMP.
  2424     05  L7F PIC  X(0001).
  2425     05  FILLER REDEFINES L7F.
  2426         10  L7A PIC  X(0001).
  2427     05  L7I PIC  X(0003).
  2428*    -------------------------------
  2429     05  TEXT7L PIC S9(0004) COMP.
  2430     05  TEXT7F PIC  X(0001).
  2431     05  FILLER REDEFINES TEXT7F.
  2432         10  TEXT7A PIC  X(0001).
  2433     05  TEXT7I PIC  X(0070).
  2434*    -------------------------------
  2435     05  L8L PIC S9(0004) COMP.
  2436     05  L8F PIC  X(0001).
  2437     05  FILLER REDEFINES L8F.
  2438         10  L8A PIC  X(0001).
  2439     05  L8I PIC  X(0003).
  2440*    -------------------------------
  2441     05  TEXT8L PIC S9(0004) COMP.
  2442     05  TEXT8F PIC  X(0001).
  2443     05  FILLER REDEFINES TEXT8F.
  2444         10  TEXT8A PIC  X(0001).
  2445     05  TEXT8I PIC  X(0070).
  2446*    -------------------------------
  2447     05  L9L PIC S9(0004) COMP.
  2448     05  L9F PIC  X(0001).
  2449     05  FILLER REDEFINES L9F.
  2450         10  L9A PIC  X(0001).
  2451     05  L9I PIC  X(0003).
  2452*    -------------------------------
  2453     05  TEXT9L PIC S9(0004) COMP.
  2454     05  TEXT9F PIC  X(0001).
  2455     05  FILLER REDEFINES TEXT9F.
  2456         10  TEXT9A PIC  X(0001).
  2457     05  TEXT9I PIC  X(0070).
  2458*    -------------------------------
  2459     05  L10L PIC S9(0004) COMP.
  2460     05  L10F PIC  X(0001).
  2461     05  FILLER REDEFINES L10F.
  2462         10  L10A PIC  X(0001).
  2463     05  L10I PIC  X(0003).
  2464*    -------------------------------
  2465     05  TEXT10L PIC S9(0004) COMP.
  2466     05  TEXT10F PIC  X(0001).
  2467     05  FILLER REDEFINES TEXT10F.
  2468         10  TEXT10A PIC  X(0001).
  2469     05  TEXT10I PIC  X(0070).
  2470*    -------------------------------
  2471     05  L11L PIC S9(0004) COMP.
  2472     05  L11F PIC  X(0001).
  2473     05  FILLER REDEFINES L11F.
  2474         10  L11A PIC  X(0001).
  2475     05  L11I PIC  X(0003).
  2476*    -------------------------------
  2477     05  TEXT11L PIC S9(0004) COMP.
  2478     05  TEXT11F PIC  X(0001).
  2479     05  FILLER REDEFINES TEXT11F.
  2480         10  TEXT11A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  49
* EL152.cbl
  2481     05  TEXT11I PIC  X(0070).
  2482*    -------------------------------
  2483     05  L12L PIC S9(0004) COMP.
  2484     05  L12F PIC  X(0001).
  2485     05  FILLER REDEFINES L12F.
  2486         10  L12A PIC  X(0001).
  2487     05  L12I PIC  X(0003).
  2488*    -------------------------------
  2489     05  TEXT12L PIC S9(0004) COMP.
  2490     05  TEXT12F PIC  X(0001).
  2491     05  FILLER REDEFINES TEXT12F.
  2492         10  TEXT12A PIC  X(0001).
  2493     05  TEXT12I PIC  X(0070).
  2494*    -------------------------------
  2495     05  L13L PIC S9(0004) COMP.
  2496     05  L13F PIC  X(0001).
  2497     05  FILLER REDEFINES L13F.
  2498         10  L13A PIC  X(0001).
  2499     05  L13I PIC  X(0003).
  2500*    -------------------------------
  2501     05  TEXT13L PIC S9(0004) COMP.
  2502     05  TEXT13F PIC  X(0001).
  2503     05  FILLER REDEFINES TEXT13F.
  2504         10  TEXT13A PIC  X(0001).
  2505     05  TEXT13I PIC  X(0070).
  2506*    -------------------------------
  2507     05  ERRMSGL PIC S9(0004) COMP.
  2508     05  ERRMSGF PIC  X(0001).
  2509     05  FILLER REDEFINES ERRMSGF.
  2510         10  ERRMSGA PIC  X(0001).
  2511     05  ERRMSGI PIC  X(0072).
  2512*    -------------------------------
  2513     05  ENTERPFL PIC S9(0004) COMP.
  2514     05  ENTERPFF PIC  X(0001).
  2515     05  FILLER REDEFINES ENTERPFF.
  2516         10  ENTERPFA PIC  X(0001).
  2517     05  ENTERPFI PIC  99.
  2518*    -------------------------------
  2519     05  PRINTERL PIC S9(0004) COMP.
  2520     05  PRINTERF PIC  X(0001).
  2521     05  FILLER REDEFINES PRINTERF.
  2522         10  PRINTERA PIC  X(0001).
  2523     05  PRINTERI PIC  X(0004).
  2524*    -------------------------------
  2525     05  PFKEY9L PIC S9(0004) COMP.
  2526     05  PFKEY9F PIC  X(0001).
  2527     05  FILLER REDEFINES PFKEY9F.
  2528         10  PFKEY9A PIC  X(0001).
  2529     05  PFKEY9I PIC  X(0014).
  2530 01  EL152AO REDEFINES EL152AI.
  2531     05  FILLER            PIC  X(0012).
  2532*    -------------------------------
  2533     05  FILLER            PIC  X(0003).
  2534     05  DATEAO PIC  X(0008).
  2535*    -------------------------------
  2536     05  FILLER            PIC  X(0003).
  2537     05  TIMEAO PIC  99.99.
  2538*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  50
* EL152.cbl
  2539     05  FILLER            PIC  X(0003).
  2540     05  CARRO PIC  X(0001).
  2541*    -------------------------------
  2542     05  FILLER            PIC  X(0003).
  2543     05  CLMNOO PIC  X(0007).
  2544*    -------------------------------
  2545     05  FILLER            PIC  X(0003).
  2546     05  CRTNOO PIC  X(0011).
  2547*    -------------------------------
  2548     05  FILLER            PIC  X(0003).
  2549     05  PROCO PIC  X(0004).
  2550*    -------------------------------
  2551     05  FILLER            PIC  X(0003).
  2552     05  COMPIDO PIC  X(0003).
  2553*    -------------------------------
  2554     05  FILLER            PIC  X(0003).
  2555     05  CLEANO PIC  X(0001).
  2556*    -------------------------------
  2557     05  FILLER            PIC  X(0003).
  2558     05  SYSO PIC  X(0008).
  2559*    -------------------------------
  2560     05  FILLER            PIC  X(0003).
  2561     05  MAINTO PIC  X(0001).
  2562*    -------------------------------
  2563     05  FILLER            PIC  X(0003).
  2564     05  ARCHNUMO PIC  X(0008).
  2565*    -------------------------------
  2566     05  FILLER            PIC  X(0003).
  2567     05  FORMO PIC  X(0004).
  2568*    -------------------------------
  2569     05  FILLER            PIC  X(0003).
  2570     05  FOLLOWO PIC  X(0008).
  2571*    -------------------------------
  2572     05  FILLER            PIC  X(0003).
  2573     05  RESENDO PIC  X(0008).
  2574*    -------------------------------
  2575     05  FILLER            PIC  X(0003).
  2576     05  PRINTO PIC  X(0001).
  2577*    -------------------------------
  2578     05  FILLER            PIC  X(0003).
  2579     05  COPIESO PIC  X(0001).
  2580*    -------------------------------
  2581     05  FILLER            PIC  X(0003).
  2582     05  ENCO PIC  X(0003).
  2583*    -------------------------------
  2584     05  FILLER            PIC  X(0003).
  2585     05  ADDRO PIC  X(0002).
  2586*    -------------------------------
  2587     05  FILLER            PIC  X(0003).
  2588     05  ACTO PIC  X(0001).
  2589*    -------------------------------
  2590     05  FILLER            PIC  X(0003).
  2591     05  BENO PIC  X(0001).
  2592*    -------------------------------
  2593     05  FILLER            PIC  X(0003).
  2594     05  EMPO PIC  X(0001).
  2595*    -------------------------------
  2596     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  51
* EL152.cbl
  2597     05  INSO PIC  X(0001).
  2598*    -------------------------------
  2599     05  FILLER            PIC  X(0003).
  2600     05  PHYSO PIC  X(0001).
  2601*    -------------------------------
  2602     05  FILLER            PIC  X(0003).
  2603     05  OTHR1O PIC  X(0001).
  2604*    -------------------------------
  2605     05  FILLER            PIC  X(0003).
  2606     05  OTHR2O PIC  X(0001).
  2607*    -------------------------------
  2608     05  FILLER            PIC  X(0003).
  2609     05  REO PIC  X(0070).
  2610*    -------------------------------
  2611     05  FILLER            PIC  X(0003).
  2612     05  L1O PIC  X(0003).
  2613*    -------------------------------
  2614     05  FILLER            PIC  X(0003).
  2615     05  TEXT1O PIC  X(0070).
  2616*    -------------------------------
  2617     05  FILLER            PIC  X(0003).
  2618     05  L2O PIC  X(0003).
  2619*    -------------------------------
  2620     05  FILLER            PIC  X(0003).
  2621     05  TEXT2O PIC  X(0070).
  2622*    -------------------------------
  2623     05  FILLER            PIC  X(0003).
  2624     05  L3O PIC  X(0003).
  2625*    -------------------------------
  2626     05  FILLER            PIC  X(0003).
  2627     05  TEXT3O PIC  X(0070).
  2628*    -------------------------------
  2629     05  FILLER            PIC  X(0003).
  2630     05  L4O PIC  X(0003).
  2631*    -------------------------------
  2632     05  FILLER            PIC  X(0003).
  2633     05  TEXT4O PIC  X(0070).
  2634*    -------------------------------
  2635     05  FILLER            PIC  X(0003).
  2636     05  L5O PIC  X(0003).
  2637*    -------------------------------
  2638     05  FILLER            PIC  X(0003).
  2639     05  TEXT5O PIC  X(0070).
  2640*    -------------------------------
  2641     05  FILLER            PIC  X(0003).
  2642     05  L6O PIC  X(0003).
  2643*    -------------------------------
  2644     05  FILLER            PIC  X(0003).
  2645     05  TEXT6O PIC  X(0070).
  2646*    -------------------------------
  2647     05  FILLER            PIC  X(0003).
  2648     05  L7O PIC  X(0003).
  2649*    -------------------------------
  2650     05  FILLER            PIC  X(0003).
  2651     05  TEXT7O PIC  X(0070).
  2652*    -------------------------------
  2653     05  FILLER            PIC  X(0003).
  2654     05  L8O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  52
* EL152.cbl
  2655*    -------------------------------
  2656     05  FILLER            PIC  X(0003).
  2657     05  TEXT8O PIC  X(0070).
  2658*    -------------------------------
  2659     05  FILLER            PIC  X(0003).
  2660     05  L9O PIC  X(0003).
  2661*    -------------------------------
  2662     05  FILLER            PIC  X(0003).
  2663     05  TEXT9O PIC  X(0070).
  2664*    -------------------------------
  2665     05  FILLER            PIC  X(0003).
  2666     05  L10O PIC  X(0003).
  2667*    -------------------------------
  2668     05  FILLER            PIC  X(0003).
  2669     05  TEXT10O PIC  X(0070).
  2670*    -------------------------------
  2671     05  FILLER            PIC  X(0003).
  2672     05  L11O PIC  X(0003).
  2673*    -------------------------------
  2674     05  FILLER            PIC  X(0003).
  2675     05  TEXT11O PIC  X(0070).
  2676*    -------------------------------
  2677     05  FILLER            PIC  X(0003).
  2678     05  L12O PIC  X(0003).
  2679*    -------------------------------
  2680     05  FILLER            PIC  X(0003).
  2681     05  TEXT12O PIC  X(0070).
  2682*    -------------------------------
  2683     05  FILLER            PIC  X(0003).
  2684     05  L13O PIC  X(0003).
  2685*    -------------------------------
  2686     05  FILLER            PIC  X(0003).
  2687     05  TEXT13O PIC  X(0070).
  2688*    -------------------------------
  2689     05  FILLER            PIC  X(0003).
  2690     05  ERRMSGO PIC  X(0072).
  2691*    -------------------------------
  2692     05  FILLER            PIC  X(0003).
  2693     05  ENTERPFO PIC  X(0002).
  2694*    -------------------------------
  2695     05  FILLER            PIC  X(0003).
  2696     05  PRINTERO PIC  X(0004).
  2697*    -------------------------------
  2698     05  FILLER            PIC  X(0003).
  2699     05  PFKEY9O PIC  X(0014).
  2700*    -------------------------------
  2701 01  MAP-REDEF REDEFINES EL152AI.
  2702     12  FILLER              PIC X(251).
  2703*    12  FILLER              PIC X(189).
  2704     12  EL152RI.
  2705       14  TEXT-LINES OCCURS 13 TIMES INDEXED BY SC-INDX.
  2706         16  SC-LINEL        PIC S9(4)  COMP.
  2707         16  SC-LINEA        PIC X.
  2708         16  SC-LINE         PIC XXX.
  2709         16  SC-TEXTL        PIC S9(4)  COMP.
  2710         16  SC-TEXTA        PIC X.
  2711         16  SC-TEXT         PIC X(70).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  53
* EL152.cbl
  2713 01  RECORD-TABLE            PIC X(21900) VALUE SPACES.
  2714
  2715 01  REC-TABLE REDEFINES RECORD-TABLE.
  2716     12  TS-GROUP OCCURS 6 TIMES INDEXED BY TS-INDX
  2717                             PIC X(3650).
  2718
  2719 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  2720     12  REC-ENT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
  2721         16  REC-TEXT        PIC X(70).
  2722         16  REC-PC          PIC 99.
  2723         16  FILLER          PIC X.
  2724
  2725 01  TS-WORK-AREA            PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  54
* EL152.cbl
  2727****************************************************************
  2728*
  2729* Copyright (c) 2007 by Clerity Solutions, Inc.
  2730* All rights reserved.
  2731*
  2732****************************************************************
  2733 01  DFHEIV.
  2734   02  DFHEIV0               PIC X(35).
  2735   02  DFHEIV1               PIC X(08).
  2736   02  DFHEIV2               PIC X(08).
  2737   02  DFHEIV3               PIC X(08).
  2738   02  DFHEIV4               PIC X(06).
  2739   02  DFHEIV5               PIC X(04).
  2740   02  DFHEIV6               PIC X(04).
  2741   02  DFHEIV7               PIC X(02).
  2742   02  DFHEIV8               PIC X(02).
  2743   02  DFHEIV9               PIC X(01).
  2744   02  DFHEIV10              PIC S9(7) COMP-3.
  2745   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2746   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2747   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2748   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2749   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2750   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2751   02  DFHEIV17              PIC X(04).
  2752   02  DFHEIV18              PIC X(04).
  2753   02  DFHEIV19              PIC X(04).
  2754   02  DFHEIV20              USAGE IS POINTER.
  2755   02  DFHEIV21              USAGE IS POINTER.
  2756   02  DFHEIV22              USAGE IS POINTER.
  2757   02  DFHEIV23              USAGE IS POINTER.
  2758   02  DFHEIV24              USAGE IS POINTER.
  2759   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2760   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2761   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2762   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2763   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2764   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2765   02  FILLER                PIC X(02).
  2766   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2767   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2768   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2769   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2770   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2771 LINKAGE  SECTION.
  2772*****************************************************************
  2773*                                                               *
  2774* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2775* All rights reserved.                                          *
  2776*                                                               *
  2777*****************************************************************
  2778 01  dfheiblk.
  2779     02  eibtime          pic s9(7) comp-3.
  2780     02  eibdate          pic s9(7) comp-3.
  2781     02  eibtrnid         pic x(4).
  2782     02  eibtaskn         pic s9(7) comp-3.
  2783     02  eibtrmid         pic x(4).
  2784     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  55
* EL152.cbl
  2785     02  eibcposn         pic s9(4) comp.
  2786     02  eibcalen         pic s9(4) comp.
  2787     02  eibaid           pic x(1).
  2788     02  eibfiller1       pic x(1).
  2789     02  eibfn            pic x(2).
  2790     02  eibfiller2       pic x(2).
  2791     02  eibrcode         pic x(6).
  2792     02  eibfiller3       pic x(2).
  2793     02  eibds            pic x(8).
  2794     02  eibreqid         pic x(8).
  2795     02  eibrsrce         pic x(8).
  2796     02  eibsync          pic x(1).
  2797     02  eibfree          pic x(1).
  2798     02  eibrecv          pic x(1).
  2799     02  eibsend          pic x(1).
  2800     02  eibatt           pic x(1).
  2801     02  eibeoc           pic x(1).
  2802     02  eibfmh           pic x(1).
  2803     02  eibcompl         pic x(1).
  2804     02  eibsig           pic x(1).
  2805     02  eibconf          pic x(1).
  2806     02  eiberr           pic x(1).
  2807     02  eibrldbk         pic x(1).
  2808     02  eiberrcd         pic x(4).
  2809     02  eibsynrb         pic x(1).
  2810     02  eibnodat         pic x(1).
  2811     02  eibfiller5       pic x(2).
  2812     02  eibresp          pic 9(09) comp.
  2813     02  eibresp2         pic 9(09) comp.
  2814     02  dfheigdj         pic s9(4) comp.
  2815     02  dfheigdk         pic s9(4) comp.
  2816 01  DFHCOMMAREA                 PIC X(1024).
  2817
  2818 01  var  pic x(30).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  56
* EL152.cbl
  2820*                                COPY ELCMSTR.
  2821******************************************************************
  2822*                                                                *
  2823*                            ELCMSTR.                            *
  2824*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2825*                            VMOD=2.012                          *
  2826*                                                                *
  2827*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  2828*                                                                *
  2829*   FILE TYPE = VSAM,KSDS                                        *
  2830*   RECORD SIZE = 350  RECFORM = FIXED                           *
  2831*                                                                *
  2832*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  2833*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  2834*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  2835*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  2836*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  2837*                                                 RKP=75,LEN=21  *
  2838*                                                                *
  2839*   **** NOTE ****                                               *
  2840*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  2841*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  2842*                                                                *
  2843*   LOG = YES                                                    *
  2844*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2845******************************************************************
  2846*                   C H A N G E   L O G
  2847*
  2848* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2849*-----------------------------------------------------------------
  2850*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2851* EFFECTIVE    NUMBER
  2852*-----------------------------------------------------------------
  2853* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  2854* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  2855* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  2856* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2857* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2858******************************************************************
  2859 01  CLAIM-MASTER.
  2860     12  CL-RECORD-ID                PIC XX.
  2861         88  VALID-CL-ID         VALUE 'CL'.
  2862
  2863     12  CL-CONTROL-PRIMARY.
  2864         16  CL-COMPANY-CD           PIC X.
  2865         16  CL-CARRIER              PIC X.
  2866         16  CL-CLAIM-NO             PIC X(7).
  2867         16  CL-CERT-NO.
  2868             20  CL-CERT-PRIME       PIC X(10).
  2869             20  CL-CERT-SFX         PIC X.
  2870
  2871     12  CL-CONTROL-BY-NAME.
  2872         16  CL-COMPANY-CD-A1        PIC X.
  2873         16  CL-INSURED-LAST-NAME    PIC X(15).
  2874         16  CL-INSURED-NAME.
  2875             20  CL-INSURED-1ST-NAME PIC X(12).
  2876             20  CL-INSURED-MID-INIT PIC X.
  2877
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  57
* EL152.cbl
  2878     12  CL-CONTROL-BY-SSN.
  2879         16  CL-COMPANY-CD-A2        PIC X.
  2880         16  CL-SOC-SEC-NO.
  2881             20  CL-SSN-STATE        PIC XX.
  2882             20  CL-SSN-ACCOUNT      PIC X(6).
  2883             20  CL-SSN-LN3          PIC X(3).
  2884
  2885     12  CL-CONTROL-BY-CERT-NO.
  2886         16  CL-COMPANY-CD-A4        PIC X.
  2887         16  CL-CERT-NO-A4.
  2888             20  CL-CERT-A4-PRIME    PIC X(10).
  2889             20  CL-CERT-A4-SFX      PIC X.
  2890
  2891     12  CL-CONTROL-BY-CCN.
  2892         16  CL-COMPANY-CD-A5        PIC X.
  2893         16  CL-CCN-A5.
  2894             20  CL-CCN.
  2895                 24  CL-CCN-PREFIX-A5 PIC X(4).
  2896                 24  CL-CCN-PRIME-A5 PIC X(12).
  2897             20  CL-CCN-FILLER-A5    PIC X(4).
  2898
  2899     12  CL-INSURED-PROFILE-DATA.
  2900         16  CL-INSURED-BIRTH-DT     PIC XX.
  2901         16  CL-INSURED-SEX-CD       PIC X.
  2902             88  INSURED-IS-MALE        VALUE 'M'.
  2903             88  INSURED-IS-FEMALE      VALUE 'F'.
  2904             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  2905         16  CL-INSURED-OCC-CD       PIC X(6).
  2906         16  FILLER                  PIC X(5).
  2907
  2908     12  CL-PROCESSING-INFO.
  2909         16  CL-PROCESSOR-ID         PIC X(4).
  2910         16  CL-CLAIM-STATUS         PIC X.
  2911             88  CLAIM-IS-OPEN          VALUE 'O'.
  2912             88  CLAIM-IS-CLOSED        VALUE 'C'.
  2913         16  CL-CLAIM-TYPE           PIC X.
  2914*            88  AH-CLAIM               VALUE 'A'.
  2915*            88  LIFE-CLAIM             VALUE 'L'.
  2916*            88  PROPERTY-CLAIM         VALUE 'P'.
  2917*            88  IUI-CLAIM              VALUE 'I'.
  2918*            88  GAP-CLAIM              VALUE 'G'.
  2919*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  2920         16  CL-CLAIM-PREM-TYPE      PIC X.
  2921             88  SINGLE-PREMIUM         VALUE '1'.
  2922             88  O-B-COVERAGE           VALUE '2'.
  2923             88  OPEN-END-COVERAGE      VALUE '3'.
  2924         16  CL-INCURRED-DT          PIC XX.
  2925         16  CL-REPORTED-DT          PIC XX.
  2926         16  CL-FILE-ESTABLISH-DT    PIC XX.
  2927         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  2928         16  CL-LAST-PMT-DT          PIC XX.
  2929         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  2930         16  CL-PAID-THRU-DT         PIC XX.
  2931         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  2932         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  2933         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  2934         16  CL-PMT-CALC-METHOD      PIC X.
  2935             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  58
* EL152.cbl
  2936             88  CL-365-DAY-YR          VALUE '2'.
  2937             88  CL-FULL-MONTHS         VALUE '3'.
  2938         16  CL-CAUSE-CD             PIC X(6).
  2939
  2940         16  CL-PRIME-CERT-NO.
  2941             20  CL-PRIME-CERT-PRIME PIC X(10).
  2942             20  CL-PRIME-CERT-SFX   PIC X.
  2943
  2944         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  2945             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  2946             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  2947
  2948         16  CL-MICROFILM-NO         PIC X(10).
  2949         16  FILLER REDEFINES CL-MICROFILM-NO.
  2950             20  CL-BENEFIT-PERIOD   PIC 99.
  2951             20  FILLER              PIC X(8).
  2952         16  CL-PROG-FORM-TYPE       PIC X.
  2953         16  CL-LAST-ADD-ON-DT       PIC XX.
  2954
  2955         16  CL-LAST-REOPEN-DT       PIC XX.
  2956         16  CL-LAST-CLOSE-DT        PIC XX.
  2957         16  CL-LAST-CLOSE-REASON    PIC X(01).
  2958             88  FINAL-PAID             VALUE '1'.
  2959             88  CLAIM-DENIED           VALUE '2'.
  2960             88  AUTO-CLOSE             VALUE '3'.
  2961             88  MANUAL-CLOSE           VALUE '4'.
  2962             88  BENEFITS-CHANGED       VALUE 'C'.
  2963             88  SETUP-ERRORS           VALUE 'E'.
  2964         16  CL-ASSOC-CERT-SEQU      PIC S99.
  2965         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  2966         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  2967             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  2968         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  2969         16  FILLER                  PIC X.
  2970
  2971     12  CL-CERTIFICATE-DATA.
  2972         16  CL-CERT-ORIGIN          PIC X.
  2973             88  CERT-WAS-ONLINE        VALUE '1'.
  2974             88  CERT-WAS-CREATED       VALUE '2'.
  2975             88  COVERAGE-WAS-ADDED     VALUE '3'.
  2976         16  CL-CERT-KEY-DATA.
  2977             20  CL-CERT-CARRIER     PIC X.
  2978             20  CL-CERT-GROUPING    PIC X(6).
  2979             20  CL-CERT-STATE       PIC XX.
  2980             20  CL-CERT-ACCOUNT.
  2981                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  2982                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  2983             20  CL-CERT-EFF-DT      PIC XX.
  2984
  2985     12  CL-STATUS-CONTROLS.
  2986         16  CL-PRIORITY-CD          PIC X.
  2987             88  CONFIDENTIAL-DATA      VALUE '8'.
  2988             88  HIGHEST-PRIORITY       VALUE '9'.
  2989         16  CL-SUPV-ATTN-CD         PIC X.
  2990             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  2991             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  2992         16  CL-PURGED-DT            PIC XX.
  2993         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  59
* EL152.cbl
  2994         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  2995         16  CL-NEXT-RESEND-DT       PIC XX.
  2996         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  2997         16  CL-CRITICAL-PERIOD      PIC 99.
  2998*        16  FILLER                  PIC XX.
  2999         16  CL-LAST-MAINT-DT        PIC XX.
  3000         16  CL-LAST-MAINT-USER      PIC X(4).
  3001         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3002         16  CL-LAST-MAINT-TYPE      PIC X.
  3003             88  CLAIM-SET-UP           VALUE ' '.
  3004             88  PAYMENT-MADE           VALUE '1'.
  3005             88  LETTER-SENT            VALUE '2'.
  3006             88  MASTER-WAS-ALTERED     VALUE '3'.
  3007             88  MASTER-WAS-RESTORED    VALUE '4'.
  3008             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3009             88  FILE-CONVERTED         VALUE '6'.
  3010             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3011             88  ERROR-CORRECTION       VALUE 'E'.
  3012         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3013         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3014         16  CL-BENEFICIARY          PIC X(10).
  3015         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3016         16  CL-DENIAL-TYPE          PIC X.
  3017             88  CL-TYPE-DENIAL          VALUE '1'.
  3018             88  CL-TYPE-RESCISSION      VALUE '2'.
  3019             88  CL-TYPE-REFORMATION     VALUE '3'.
  3020             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3021             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3022         16  filler                  pic x(5).
  3023*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3024*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3025*        16  CL-RTW-DT               PIC XX.
  3026
  3027     12  CL-TRAILER-CONTROLS.
  3028         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3029             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3030             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3031             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3032         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3033         16  FILLER                  PIC XX.
  3034         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3035         16  CL-ADDRESS-TRAILER-CNT.
  3036             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3037                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3038             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3039                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3040             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3041                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3042             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3043                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3044             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3045                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3046             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3047                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3048             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3049                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3050
  3051     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  60
* EL152.cbl
  3052         16  CL-CV-REFNO-PRIME       PIC X(18).
  3053         16  CL-CV-REFNO-SFX         PIC XX.
  3054
  3055     12  CL-FILE-LOCATION            PIC X(4).
  3056
  3057     12  CL-PROCESS-ERRORS.
  3058         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3059             88  NO-FATAL-ERRORS        VALUE ZERO.
  3060         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3061             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3062
  3063     12  CL-PRODUCT-CD               PIC X.
  3064
  3065     12  CL-CURRENT-KEY-DATA.
  3066         16  CL-CURRENT-CARRIER      PIC X.
  3067         16  CL-CURRENT-GROUPING     PIC X(6).
  3068         16  CL-CURRENT-STATE        PIC XX.
  3069         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3070
  3071     12  CL-ASSOCIATES               PIC X.
  3072         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3073         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3074         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3075         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3076
  3077     12  CL-ACTIVITY-CODE            PIC 99.
  3078     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3079     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3080
  3081     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3082     12  CL-LAG-REPORT-CODE          PIC 9.
  3083     12  CL-LOAN-TYPE                PIC XX.
  3084     12  CL-LEGAL-STATE              PIC XX.
  3085
  3086     12  CL-YESNOSW                  PIC X.
  3087     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3088         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3089         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3090         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3091     12  cl-insured-type             pic x.
  3092         88  cl-claim-on-primary         value 'P'.
  3093         88  cl-claim-on-co-borrower     value 'C'.
  3094     12  cl-benefit-expiration-dt    PIC XX.
  3095
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  61
* EL152.cbl
  3097*                                COPY ELCCNTL.
  3098******************************************************************
  3099*                                                                *
  3100*                                                                *
  3101*                            ELCCNTL.                            *
  3102*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3103*                            VMOD=2.059                          *
  3104*                                                                *
  3105*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3106*                                                                *
  3107*   FILE TYPE = VSAM,KSDS                                        *
  3108*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3109*                                                                *
  3110*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3111*       ALTERNATE INDEX = NONE                                   *
  3112*                                                                *
  3113*   LOG = YES                                                    *
  3114*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3115******************************************************************
  3116*                   C H A N G E   L O G
  3117*
  3118* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3119*-----------------------------------------------------------------
  3120*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3121* EFFECTIVE    NUMBER
  3122*-----------------------------------------------------------------
  3123* 082503                   PEMA  ADD BENEFIT GROUP
  3124* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3125* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3126* 092705    2005050300006  PEMA  ADD SPP LEASES
  3127* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3128* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3129* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3130* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3131* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3132* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3133* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3134* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3135* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3136* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3137******************************************************************
  3138*
  3139 01  CONTROL-FILE.
  3140     12  CF-RECORD-ID                       PIC XX.
  3141         88  VALID-CF-ID                        VALUE 'CF'.
  3142
  3143     12  CF-CONTROL-PRIMARY.
  3144         16  CF-COMPANY-ID                  PIC XXX.
  3145         16  CF-RECORD-TYPE                 PIC X.
  3146             88  CF-COMPANY-MASTER              VALUE '1'.
  3147             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3148             88  CF-STATE-MASTER                VALUE '3'.
  3149             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3150             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3151             88  CF-CARRIER-MASTER              VALUE '6'.
  3152             88  CF-MORTALITY-MASTER            VALUE '7'.
  3153             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3154             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  62
* EL152.cbl
  3155             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3156             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3157             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3158             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3159             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3160             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3161             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3162             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3163             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3164         16  CF-ACCESS-CD-GENL              PIC X(4).
  3165         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3166             20  CF-PROCESSOR               PIC X(4).
  3167         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3168             20  CF-STATE-CODE              PIC XX.
  3169             20  FILLER                     PIC XX.
  3170         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3171             20  FILLER                     PIC XX.
  3172             20  CF-HI-BEN-IN-REC           PIC XX.
  3173         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3174             20  FILLER                     PIC XXX.
  3175             20  CF-CARRIER-CNTL            PIC X.
  3176         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3177             20  FILLER                     PIC XX.
  3178             20  CF-HI-TYPE-IN-REC          PIC 99.
  3179         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3180             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3181                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3182             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3183             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3184         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3185             20  FILLER                     PIC X.
  3186             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3187         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3188             20  FILLER                     PIC XX.
  3189             20  CF-MORTGAGE-PLAN           PIC XX.
  3190         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3191
  3192     12  CF-LAST-MAINT-DT                   PIC XX.
  3193     12  CF-LAST-MAINT-BY                   PIC X(4).
  3194     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3195
  3196     12  CF-RECORD-BODY                     PIC X(728).
  3197
  3198
  3199****************************************************************
  3200*             COMPANY MASTER RECORD                            *
  3201****************************************************************
  3202
  3203     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3204         16  CF-COMPANY-ADDRESS.
  3205             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3206             20  CF-CL-IN-CARE-OF           PIC X(30).
  3207             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3208             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3209             20  CF-CL-CITY-STATE           PIC X(30).
  3210             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3211             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3212         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  63
* EL152.cbl
  3213         16  CF-COMPANY-PASSWORD            PIC X(8).
  3214         16  CF-SECURITY-OPTION             PIC X.
  3215             88  ALL-SECURITY                   VALUE '1'.
  3216             88  COMPANY-VERIFY                 VALUE '2'.
  3217             88  PROCESSOR-VERIFY               VALUE '3'.
  3218             88  NO-SECURITY                    VALUE '4'.
  3219             88  ALL-BUT-TERM                   VALUE '5'.
  3220         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3221             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3222         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3223             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3224         16  CF-INFORCE-LOCATION            PIC X.
  3225             88  CERTS-ARE-ONLINE               VALUE '1'.
  3226             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3227             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3228         16  CF-LOWER-CASE-LETTERS          PIC X.
  3229         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3230             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3231             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3232             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3233             88  CF-ACCNT-CNTL                  VALUE '3'.
  3234             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3235
  3236         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3237         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3238
  3239         16  CF-LGX-CREDIT-USER             PIC X.
  3240             88  CO-IS-NOT-USER                 VALUE 'N'.
  3241             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3242
  3243         16 CF-CREDIT-CALC-CODES.
  3244             20  CF-CR-REM-TERM-CALC PIC X.
  3245               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3246               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3247               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3248               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3249               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3250               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3251               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3252             20  CF-CR-R78-METHOD           PIC X.
  3253               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3254               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3255
  3256         16  CF-CLAIM-CONTROL-COUNTS.
  3257             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3258                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3259
  3260             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3261                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3262
  3263             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3264                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3265
  3266             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3267                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3268
  3269         16  CF-CURRENT-MONTH-END           PIC XX.
  3270
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  64
* EL152.cbl
  3271         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3272             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3273             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3274             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3275             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3276                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3277                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3278             20  CF-CO-PREM-REJECT-SW       PIC X.
  3279                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3280                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3281             20  CF-CO-REF-REJECT-SW        PIC X.
  3282                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3283                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3284
  3285         16  CF-CO-REPORTING-DT             PIC XX.
  3286         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3287         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3288           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3289           88  CF-CO-MONTH-END                  VALUE '1'.
  3290
  3291         16  CF-LGX-CLAIM-USER              PIC X.
  3292             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3293             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3294
  3295         16  CF-CREDIT-EDIT-CONTROLS.
  3296             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3297             20  CF-MIN-AGE                 PIC 99.
  3298             20  CF-DEFAULT-AGE             PIC 99.
  3299             20  CF-MIN-TERM                PIC S999      COMP-3.
  3300             20  CF-MAX-TERM                PIC S999      COMP-3.
  3301             20  CF-DEFAULT-SEX             PIC X.
  3302             20  CF-JOINT-AGE-INPUT         PIC X.
  3303                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3304             20  CF-BIRTH-DATE-INPUT        PIC X.
  3305                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3306             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3307                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3308                 88  CF-ZERO-CARRIER            VALUE '1'.
  3309                 88  CF-ZERO-GROUPING           VALUE '2'.
  3310                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3311             20  CF-EDIT-SW                 PIC X.
  3312                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3313             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3314             20  CF-CR-PR-METHOD            PIC X.
  3315               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3316               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3317             20  FILLER                     PIC X.
  3318
  3319         16  CF-CREDIT-MISC-CONTROLS.
  3320             20  CF-REIN-TABLE-SW           PIC X.
  3321                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3322             20  CF-COMP-TABLE-SW           PIC X.
  3323                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3324             20  CF-EXPERIENCE-RETENTION-AGE
  3325                                            PIC S9        COMP-3.
  3326             20  CF-CONVERSION-DT           PIC XX.
  3327             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3328             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  65
* EL152.cbl
  3329                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3330                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3331
  3332             20  CF-CR-CHECK-NO-CONTROL.
  3333                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3334                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3335                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3336                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3337                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3338                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3339
  3340                 24  CF-CR-CHECK-COUNT       REDEFINES
  3341                     CF-CR-CHECK-COUNTER      PIC X(4).
  3342
  3343                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3344                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3345
  3346                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3347                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3348                 24  CF-MAIL-PROCESSING       PIC X.
  3349                     88  MAIL-PROCESSING          VALUE 'Y'.
  3350
  3351         16  CF-MISC-SYSTEM-CONTROL.
  3352             20  CF-SYSTEM-C                 PIC X.
  3353                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3354             20  CF-SYSTEM-D                 PIC X.
  3355                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3356             20  CF-SOC-SEC-NO-SW            PIC X.
  3357                 88  SOC-SEC-NO-USED             VALUE '1'.
  3358             20  CF-MEMBER-NO-SW             PIC X.
  3359                 88  MEMBER-NO-USED              VALUE '1'.
  3360             20  CF-TAX-ID-NUMBER            PIC X(11).
  3361             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3362             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3363                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3364                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3365                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3366                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3367             20  CF-SYSTEM-E                 PIC X.
  3368                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3369
  3370         16  CF-LGX-LIFE-USER               PIC X.
  3371             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3372             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3373
  3374         16  CF-CR-MONTH-END-DT             PIC XX.
  3375
  3376         16  CF-FILE-MAINT-DATES.
  3377             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3378                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3379             20  CF-LAST-BATCH       REDEFINES
  3380                 CF-LAST-BATCH-NO               PIC X(4).
  3381             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3382             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3383             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3384             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3385             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3386             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  66
* EL152.cbl
  3387             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3388             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3389             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3390             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3391
  3392         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3393         16  FILLER                         PIC X.
  3394
  3395         16  CF-ALT-MORT-CODE               PIC X(4).
  3396         16  CF-MEMBER-CAPTION              PIC X(10).
  3397
  3398         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3399             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3400             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3401             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3402             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3403             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3404
  3405         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3406
  3407         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3408         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3409         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3410         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3411
  3412         16  CF-AH-OVERRIDE-L1              PIC X.
  3413         16  CF-AH-OVERRIDE-L2              PIC XX.
  3414         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3415         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3416
  3417         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3418         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3419
  3420         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3421         16  CF-AR-LAST-EL860-DT            PIC XX.
  3422         16  CF-MP-MONTH-END-DT             PIC XX.
  3423
  3424         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3425         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3426             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3427
  3428         16  CF-AR-MONTH-END-DT             PIC XX.
  3429
  3430         16  CF-CRDTCRD-USER                PIC X.
  3431             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3432             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3433
  3434         16  CF-CC-MONTH-END-DT             PIC XX.
  3435
  3436         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3437
  3438         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3439             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3440             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3441             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3442         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3443         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3444         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  67
* EL152.cbl
  3445         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3446             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3447             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3448         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3449         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3450         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3451             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3452         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3453
  3454         16  CF-CL-ZIP-CODE.
  3455             20  CF-CL-ZIP-PRIME.
  3456                 24  CF-CL-ZIP-1ST          PIC X.
  3457                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3458                 24  FILLER                 PIC X(4).
  3459             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3460         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3461             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3462             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3463             20  FILLER                     PIC XXX.
  3464
  3465         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3466         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3467         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3468         16  CF-CO-OPTION-START-DATE        PIC XX.
  3469         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3470           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3471                                                      '3' '4'.
  3472           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3473           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3474           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3475           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3476           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3477           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3478
  3479         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3480
  3481         16  CF-PAYMENT-APPROVAL-LEVELS.
  3482             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3483             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3484             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3485             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3486             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3487             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3488
  3489         16  CF-END-USER-REPORTING-USER     PIC X.
  3490             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3491             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3492
  3493         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3494             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3495             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3496
  3497         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3498
  3499         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3500         16  FILLER                         PIC X.
  3501
  3502         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  68
* EL152.cbl
  3503             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3504             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3505             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3506
  3507         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3508
  3509         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3510             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3511             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3512
  3513         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3514             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3515             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3516
  3517         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3518
  3519         16  CF-CO-ACH-ID-CODE              PIC  X.
  3520             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3521             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3522             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3523         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3524         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3525         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3526         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3527         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3528         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3529         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3530         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3531         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3532                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3533         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3534                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3535
  3536         16  CF-CO-OVER-SHORT.
  3537             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3538             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3539
  3540*         16  FILLER                         PIC X(102).
  3541         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3542             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3543             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3544
  3545         16  CF-AH-APPROVAL-DAYS.
  3546             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3547             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3548             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3549             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3550
  3551         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3552
  3553         16  CF-APPROV-LEV-5.
  3554             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3555             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3556             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3557
  3558         16  FILLER                         PIC X(68).
  3559****************************************************************
  3560*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  69
* EL152.cbl
  3561****************************************************************
  3562
  3563     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3564         16  CF-PROCESSOR-NAME              PIC X(30).
  3565         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3566         16  CF-PROCESSOR-TITLE             PIC X(26).
  3567         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3568                 88  MESSAGE-YES                VALUE 'Y'.
  3569                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3570
  3571*****************************************************
  3572****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3573****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3574****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3575****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3576*****************************************************
  3577
  3578         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3579             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3580             20  CF-APPLICATION-FORCE       PIC X.
  3581             20  CF-INDIVIDUAL-APP.
  3582                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3583                     28  CF-BROWSE-APP      PIC X.
  3584                     28  CF-UPDATE-APP      PIC X.
  3585
  3586         16  CF-CURRENT-TERM-ON             PIC X(4).
  3587         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3588             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3589             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3590             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3591             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3592             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3593             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3594             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3595         16  CF-PROCESSOR-CARRIER           PIC X.
  3596             88  NO-CARRIER-SECURITY            VALUE ' '.
  3597         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3598             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3599         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3600             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3601         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3602             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3603
  3604         16  CF-PROC-SYS-ACCESS-SW.
  3605             20  CF-PROC-CREDIT-CLAIMS-SW.
  3606                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3607                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3608                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3609                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3610             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3611                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3612                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3613             20  CF-PROC-LIFE-GNRLDGR-SW.
  3614                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3615                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3616                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3617                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3618             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  70
* EL152.cbl
  3619                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3620                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3621         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3622             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3623             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3624         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3625
  3626         16  CF-APPROVAL-LEVEL                  PIC X.
  3627             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3628             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3629             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3630             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3631             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3632
  3633         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3634
  3635         16  CF-LANGUAGE-TYPE                   PIC X.
  3636             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3637             88  CF-LANG-IS-FR                      VALUE 'F'.
  3638
  3639         16  CF-CSR-IND                         PIC X.
  3640         16  FILLER                             PIC X(239).
  3641
  3642****************************************************************
  3643*             PROCESSOR/REMINDERS RECORD                       *
  3644****************************************************************
  3645
  3646     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3647         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3648             20  CF-START-REMIND-DT         PIC XX.
  3649             20  CF-END-REMIND-DT           PIC XX.
  3650             20  CF-REMINDER-TEXT           PIC X(50).
  3651         16  FILLER                         PIC X(296).
  3652
  3653
  3654****************************************************************
  3655*             STATE MASTER RECORD                              *
  3656****************************************************************
  3657
  3658     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3659         16  CF-STATE-ABBREVIATION          PIC XX.
  3660         16  CF-STATE-NAME                  PIC X(25).
  3661         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3662         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3663             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3664             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3665             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3666             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3667                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3668                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3669             20  CF-ST-PREM-REJECT-SW       PIC X.
  3670                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3671                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3672             20  CF-ST-REF-REJECT-SW        PIC X.
  3673                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3674                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3675         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3676         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  71
* EL152.cbl
  3677         16  CF-ST-REFUND-RULES.
  3678             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3679             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3680             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3681         16  CF-ST-FST-PMT-EXTENSION.
  3682             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3683             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3684                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3685                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3686                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3687                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3688         16  CF-ST-STATE-CALL.
  3689             20  CF-ST-CALL-UNEARNED        PIC X.
  3690             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3691             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3692         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3693             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3694             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3695         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3696         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3697         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3698         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3699         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3700         16  FILLER                         PIC X.
  3701         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3702             20  CF-ST-BENEFIT-CD           PIC XX.
  3703             20  CF-ST-BENEFIT-KIND         PIC X.
  3704                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3705                 88  CF-ST-AH-KIND              VALUE 'A'.
  3706             20  CF-ST-REM-TERM-CALC        PIC X.
  3707                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3708                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3709                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3710                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3711                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3712                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3713                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3714                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3715
  3716             20  CF-ST-REFUND-CALC          PIC X.
  3717                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3718                 88  ST-REFD-BY-R78             VALUE '1'.
  3719                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3720                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3721                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3722                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3723                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3724                 88  ST-REFD-UTAH               VALUE '7'.
  3725                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3726                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3727                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3728
  3729             20  CF-ST-EARNING-CALC         PIC X.
  3730                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3731                 88  ST-EARN-BY-R78             VALUE '1'.
  3732                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3733                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3734                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  72
* EL152.cbl
  3735                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3736                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3737                 88  ST-EARN-MEAN               VALUE '8'.
  3738                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3739
  3740             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3741                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3742                 88  ST-OVRD-BY-R78             VALUE '1'.
  3743                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3744                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3745                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3746                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3747                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3748                 88  ST-OVRD-MEAN               VALUE '8'.
  3749                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3750             20  FILLER                     PIC X.
  3751
  3752         16  CF-ST-COMMISSION-CAPS.
  3753             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3754             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3755             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3756             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3757         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3758                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3759
  3760         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3761
  3762         16  CF-ST-STATUTORY-INTEREST.
  3763             20  CF-ST-STAT-DATE-FROM       PIC X.
  3764                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3765                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3766             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3767             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3768             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3769             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3770             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3771
  3772         16  CF-ST-OVER-SHORT.
  3773             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3774             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3775
  3776         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3777
  3778         16  CF-ST-RT-CALC                  PIC X.
  3779
  3780         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3781         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3782         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3783         16  CF-ST-RF-LR-CALC               PIC X.
  3784         16  CF-ST-RF-LL-CALC               PIC X.
  3785         16  CF-ST-RF-LN-CALC               PIC X.
  3786         16  CF-ST-RF-AH-CALC               PIC X.
  3787         16  CF-ST-RF-CP-CALC               PIC X.
  3788*        16  FILLER                         PIC X(206).
  3789*CIDMOD         16  FILLER                         PIC X(192).
  3790         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3791             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3792         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  73
* EL152.cbl
  3793         16  CF-ST-VFY-2ND-BENE             PIC X.
  3794         16  CF-ST-CAUSAL-STATE             PIC X.
  3795         16  FILLER                         PIC X(185).
  3796
  3797****************************************************************
  3798*             BENEFIT MASTER RECORD                            *
  3799****************************************************************
  3800
  3801     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3802         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3803             20  CF-BENEFIT-CODE            PIC XX.
  3804             20  CF-BENEFIT-NUMERIC  REDEFINES
  3805                 CF-BENEFIT-CODE            PIC XX.
  3806             20  CF-BENEFIT-ALPHA           PIC XXX.
  3807             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3808             20  CF-BENEFIT-COMMENT         PIC X(10).
  3809
  3810             20  CF-LF-COVERAGE-TYPE        PIC X.
  3811                 88  CF-REDUCING                VALUE 'R'.
  3812                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3813
  3814             20  CF-SPECIAL-CALC-CD         PIC X.
  3815                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3816                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3817                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3818                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3819                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3820                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3821                 88  CF-FARM-PLAN               VALUE 'F'.
  3822                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3823                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3824                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3825                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3826                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3827                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3828                 88  CF-PRUDENTIAL              VALUE 'P'.
  3829                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3830                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3831                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3832                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3833                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3834                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3835
  3836             20  CF-JOINT-INDICATOR         PIC X.
  3837                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3838
  3839*            20  FILLER                     PIC X(12).
  3840             20  cf-maximum-benefits        pic s999 comp-3.
  3841             20  FILLER                     PIC X(09).
  3842             20  CF-BENEFIT-CATEGORY        PIC X.
  3843             20  CF-LOAN-TYPE               PIC X(8).
  3844
  3845             20  CF-CO-REM-TERM-CALC        PIC X.
  3846                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3847                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3848                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3849                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3850                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  74
* EL152.cbl
  3851
  3852             20  CF-CO-EARNINGS-CALC        PIC X.
  3853                 88  CO-EARN-BY-R78             VALUE '1'.
  3854                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3855                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3856                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3857                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3858                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3859                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3860                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3861
  3862             20  CF-CO-REFUND-CALC          PIC X.
  3863                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3864                 88  CO-REFD-BY-R78             VALUE '1'.
  3865                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3866                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3867                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3868                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3869                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3870                 88  CO-REFD-MEAN               VALUE '8'.
  3871                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3872                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3873                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3874
  3875             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3876                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3877                 88  CO-OVRD-BY-R78             VALUE '1'.
  3878                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3879                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3880                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3881                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3882                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3883                 88  CO-OVRD-MEAN               VALUE '8'.
  3884                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3885
  3886             20  CF-CO-BEN-I-G-CD           PIC X.
  3887                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3888                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3889                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3890
  3891         16  FILLER                         PIC X(304).
  3892
  3893
  3894****************************************************************
  3895*             CARRIER MASTER RECORD                            *
  3896****************************************************************
  3897
  3898     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3899         16  CF-ADDRESS-DATA.
  3900             20  CF-MAIL-TO-NAME            PIC X(30).
  3901             20  CF-IN-CARE-OF              PIC X(30).
  3902             20  CF-ADDRESS-LINE-1          PIC X(30).
  3903             20  CF-ADDRESS-LINE-2          PIC X(30).
  3904             20  CF-CITY-STATE              PIC X(30).
  3905             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3906             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3907
  3908         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  75
* EL152.cbl
  3909             20  CF-CLAIM-NO-METHOD         PIC X.
  3910                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3911                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3912                 88  CLAIM-NO-SEQ               VALUE '3'.
  3913                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3914             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3915                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3916                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3917                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3918
  3919         16  CF-CHECK-NO-CONTROL.
  3920             20  CF-CHECK-NO-METHOD         PIC X.
  3921                 88  CHECK-NO-MANUAL            VALUE '1'.
  3922                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3923                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3924                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3925             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3926                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3927
  3928         16  CF-DOMICILE-STATE              PIC XX.
  3929
  3930         16  CF-EXPENSE-CONTROLS.
  3931             20  CF-EXPENSE-METHOD          PIC X.
  3932                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3933                 88  DOLLARS-PER-PMT            VALUE '2'.
  3934                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3935                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3936             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3937             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3938
  3939         16  CF-CORRESPONDENCE-CONTROL.
  3940             20  CF-LETTER-RESEND-OPT       PIC X.
  3941                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3942                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3943             20  FILLER                     PIC X(4).
  3944
  3945         16  CF-RESERVE-CONTROLS.
  3946             20  CF-MANUAL-SW               PIC X.
  3947                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3948             20  CF-FUTURE-SW               PIC X.
  3949                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3950             20  CF-PTC-SW                  PIC X.
  3951                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3952             20  CF-IBNR-SW                 PIC X.
  3953                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3954             20  CF-PTC-LF-SW               PIC X.
  3955                 88  CF-LF-PTC-USED             VALUE '1'.
  3956             20  CF-CDT-ACCESS-METHOD       PIC X.
  3957                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3958                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3959                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3960             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3961
  3962         16  CF-CLAIM-CALC-METHOD           PIC X.
  3963             88  360-PLUS-MONTHS                VALUE '1'.
  3964             88  365-PLUS-MONTHS                VALUE '2'.
  3965             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3966             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  76
* EL152.cbl
  3967             88  365-DAILY                      VALUE '5'.
  3968
  3969         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3970         16  FILLER                         PIC X(11).
  3971
  3972         16  CF-LIMIT-AMOUNTS.
  3973             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3974             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3975             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3976             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3977             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3978             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3979             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3980             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3981             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3982             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3983
  3984         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3985         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3986         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3987
  3988         16  CF-ZIP-CODE.
  3989             20  CF-ZIP-PRIME.
  3990                 24  CF-ZIP-1ST             PIC X.
  3991                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3992                 24  FILLER                 PIC X(4).
  3993             20  CF-ZIP-PLUS4               PIC X(4).
  3994         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3995             20  CF-CAN-POSTAL-1            PIC XXX.
  3996             20  CF-CAN-POSTAL-2            PIC XXX.
  3997             20  FILLER                     PIC XXX.
  3998
  3999         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4000         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4001         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4002
  4003         16  CF-RATING-SWITCH               PIC X.
  4004             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4005             88  CF-NO-RATING                   VALUE 'N'.
  4006
  4007         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4008
  4009         16  CF-CARRIER-OVER-SHORT.
  4010             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4011             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4012
  4013         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4014         16  CF-SECPAY-SWITCH               PIC X.
  4015             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4016             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4017         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4018         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4019         16  FILLER                         PIC X(444).
  4020*        16  FILLER                         PIC X(452).
  4021
  4022
  4023****************************************************************
  4024*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  77
* EL152.cbl
  4025****************************************************************
  4026
  4027     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4028         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4029                                INDEXED BY CF-MORT-NDX.
  4030             20  CF-MORT-TABLE              PIC X(5).
  4031             20  CF-MORT-TABLE-TYPE         PIC X.
  4032                 88  CF-MORT-JOINT              VALUE 'J'.
  4033                 88  CF-MORT-SINGLE             VALUE 'S'.
  4034                 88  CF-MORT-COMBINED           VALUE 'C'.
  4035                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4036                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4037             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4038             20  CF-MORT-AGE-METHOD         PIC XX.
  4039                 88  CF-AGE-LAST                VALUE 'AL'.
  4040                 88  CF-AGE-NEAR                VALUE 'AN'.
  4041             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4042             20  CF-MORT-ADJUSTMENT-DIRECTION
  4043                                            PIC X.
  4044                 88  CF-MINUS                   VALUE '-'.
  4045                 88  CF-PLUS                    VALUE '+'.
  4046             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4047             20  CF-MORT-JOINT-CODE         PIC X.
  4048                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4049             20  CF-MORT-PC-Q               PIC X.
  4050                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4051             20  CF-MORT-TABLE-CODE         PIC X(4).
  4052             20  CF-MORT-COMMENTS           PIC X(15).
  4053             20  FILLER                     PIC X(14).
  4054
  4055         16  FILLER                         PIC X(251).
  4056
  4057
  4058****************************************************************
  4059*             BUSSINESS TYPE MASTER RECORD                     *
  4060****************************************************************
  4061
  4062     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4063* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4064* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4065* AND RECORD 05 IS TYPES 81-99
  4066         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4067             20  CF-BUSINESS-TITLE          PIC  X(19).
  4068             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4069                                            PIC S9V9(4) COMP-3.
  4070             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4071             20  FILLER                     PIC  X.
  4072         16  FILLER                         PIC  X(248).
  4073
  4074
  4075****************************************************************
  4076*             TERMINAL MASTER RECORD                           *
  4077****************************************************************
  4078
  4079     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4080
  4081         16  CF-COMPANY-TERMINALS.
  4082             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  78
* EL152.cbl
  4083                                  PIC X(4).
  4084         16  FILLER               PIC X(248).
  4085
  4086
  4087****************************************************************
  4088*             LIFE EDIT MASTER RECORD                          *
  4089****************************************************************
  4090
  4091     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4092         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4093             20  CF-LIFE-CODE-IN            PIC XX.
  4094             20  CF-LIFE-CODE-OUT           PIC XX.
  4095         16  FILLER                         PIC X(248).
  4096
  4097
  4098****************************************************************
  4099*             AH EDIT MASTER RECORD                            *
  4100****************************************************************
  4101
  4102     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4103         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4104             20  CF-AH-CODE-IN              PIC XXX.
  4105             20  CF-AH-CODE-OUT             PIC XX.
  4106         16  FILLER                         PIC X(248).
  4107
  4108
  4109****************************************************************
  4110*             CREDIBILITY TABLES                               *
  4111****************************************************************
  4112
  4113     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4114         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4115                             INDEXED BY CF-CRDB-NDX.
  4116             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4117             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4118             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4119         16  FILLER                         PIC  X(332).
  4120
  4121
  4122****************************************************************
  4123*             REPORT CUSTOMIZATION RECORD                      *
  4124****************************************************************
  4125
  4126     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4127         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4128             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4129             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4130             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4131**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4132****       A T-TRANSFER.                                   ****
  4133             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4134
  4135         16  FILLER                         PIC XX.
  4136
  4137         16  CF-CARRIER-CNTL-OPT.
  4138             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4139                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4140                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  79
* EL152.cbl
  4141             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4142                                            PIC X.
  4143         16  CF-GROUP-CNTL-OPT.
  4144             20  CF-GROUP-OPT-SEQ           PIC 9.
  4145                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4146                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4147             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4148                                            PIC X(6).
  4149         16  CF-STATE-CNTL-OPT.
  4150             20  CF-STATE-OPT-SEQ           PIC 9.
  4151                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4152                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4153             20  CF-STATE-SELECT OCCURS 3 TIMES
  4154                                            PIC XX.
  4155         16  CF-ACCOUNT-CNTL-OPT.
  4156             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4157                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4158                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4159             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4160                                            PIC X(10).
  4161         16  CF-BUS-TYP-CNTL-OPT.
  4162             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4163                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4164                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4165             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4166                                            PIC XX.
  4167         16  CF-LF-TYP-CNTL-OPT.
  4168             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4169                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4170                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4171             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4172                                            PIC XX.
  4173         16  CF-AH-TYP-CNTL-OPT.
  4174             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4175                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4176                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4177             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4178                                            PIC XX.
  4179         16  CF-REPTCD1-CNTL-OPT.
  4180             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4181                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4182                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4183             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4184                                            PIC X(10).
  4185         16  CF-REPTCD2-CNTL-OPT.
  4186             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4187                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4188                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4189             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4190                                            PIC X(10).
  4191         16  CF-USER1-CNTL-OPT.
  4192             20  CF-USER1-OPT-SEQ           PIC 9.
  4193                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4194                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4195             20  CF-USER1-SELECT OCCURS 3 TIMES
  4196                                            PIC X(10).
  4197         16  CF-USER2-CNTL-OPT.
  4198             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  80
* EL152.cbl
  4199                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4200                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4201             20  CF-USER2-SELECT OCCURS 3 TIMES
  4202                                            PIC X(10).
  4203         16  CF-USER3-CNTL-OPT.
  4204             20  CF-USER3-OPT-SEQ           PIC 9.
  4205                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4206                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4207             20  CF-USER3-SELECT OCCURS 3 TIMES
  4208                                            PIC X(10).
  4209         16  CF-USER4-CNTL-OPT.
  4210             20  CF-USER4-OPT-SEQ           PIC 9.
  4211                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4212                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4213             20  CF-USER4-SELECT OCCURS 3 TIMES
  4214                                            PIC X(10).
  4215         16  CF-USER5-CNTL-OPT.
  4216             20  CF-USER5-OPT-SEQ           PIC 9.
  4217                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4218                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4219             20  CF-USER5-SELECT OCCURS 3 TIMES
  4220                                            PIC X(10).
  4221         16  CF-REINS-CNTL-OPT.
  4222             20  CF-REINS-OPT-SEQ           PIC 9.
  4223                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4224                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4225             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4226                 24  CF-REINS-PRIME         PIC XXX.
  4227                 24  CF-REINS-SUB           PIC XXX.
  4228
  4229         16  CF-AGENT-CNTL-OPT.
  4230             20  CF-AGENT-OPT-SEQ           PIC 9.
  4231                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4232                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4233             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4234                                            PIC X(10).
  4235
  4236         16  FILLER                         PIC X(43).
  4237
  4238         16  CF-LOSS-RATIO-SELECT.
  4239             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4240             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4241         16  CF-ENTRY-DATE-SELECT.
  4242             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4243             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4244         16  CF-EFFECTIVE-DATE-SELECT.
  4245             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4246             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4247
  4248         16  CF-EXCEPTION-LIST-IND          PIC X.
  4249             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4250
  4251         16  FILLER                         PIC X(318).
  4252
  4253****************************************************************
  4254*                  EXCEPTION REPORTING RECORD                  *
  4255****************************************************************
  4256
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  81
* EL152.cbl
  4257     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4258         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4259             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4260
  4261         16  CF-COMBINED-LIFE-AH-OPT.
  4262             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4263             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4264             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4265             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4266
  4267         16  CF-LIFE-OPT.
  4268             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4269             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4270             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4271             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4272             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4273             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4274             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4275             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4276             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4277             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4278
  4279         16  CF-AH-OPT.
  4280             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4281             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4282             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4283             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4284             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4285             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4286             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4287             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4288             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4289             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4290
  4291         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4292             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4293             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4294             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4295
  4296         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4297
  4298         16  FILLER                         PIC X(673).
  4299
  4300
  4301****************************************************************
  4302*             MORTGAGE SYSTEM PLAN RECORD                      *
  4303****************************************************************
  4304
  4305     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4306         16  CF-PLAN-TYPE                   PIC X.
  4307             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4308             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4309             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4310         16  CF-PLAN-ABBREV                 PIC XXX.
  4311         16  CF-PLAN-DESCRIPT               PIC X(10).
  4312         16  CF-PLAN-NOTES                  PIC X(20).
  4313         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4314         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  82
* EL152.cbl
  4315             20  CF-PLAN-TERM-DATA.
  4316                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4317                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4318             20  CF-PLAN-AGE-DATA.
  4319                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4320                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4321                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4322             20  CF-PLAN-BENEFIT-DATA.
  4323                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4324                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4325                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4326                                            PIC S9(7)V99  COMP-3.
  4327         16  CF-PLAN-POLICY-FORMS.
  4328             20  CF-POLICY-FORM             PIC X(12).
  4329             20  CF-MASTER-APPLICATION      PIC X(12).
  4330             20  CF-MASTER-POLICY           PIC X(12).
  4331         16  CF-PLAN-RATING.
  4332             20  CF-RATE-CODE               PIC X(5).
  4333             20  CF-SEX-RATING              PIC X.
  4334                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4335                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4336             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4337             20  CF-SUB-STD-TYPE            PIC X.
  4338                 88  CF-PCT-OF-PREM            VALUE '1'.
  4339                 88  CF-PCT-OF-BENE            VALUE '2'.
  4340         16  CF-PLAN-PREM-TOLERANCES.
  4341             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4342             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4343         16  CF-PLAN-PYMT-TOLERANCES.
  4344             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4345             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4346         16  CF-PLAN-MISC-DATA.
  4347             20  FILLER                     PIC X.
  4348             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4349             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4350         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4351         16  CF-PLAN-IND-GRP                PIC X.
  4352             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4353                                                     '1'.
  4354             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4355                                                     '2'.
  4356         16  CF-MIB-SEARCH-SW               PIC X.
  4357             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4358             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4359             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4360             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4361         16  CF-ALPHA-SEARCH-SW             PIC X.
  4362             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4363             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4364             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4365             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4366             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4367             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4368             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4369             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4370             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4371             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4372                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  83
* EL152.cbl
  4373                                                     'X' 'Y' 'Z'.
  4374         16  CF-EFF-DT-RULE-SW              PIC X.
  4375             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4376             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4377             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4378             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4379             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4380         16  FILLER                         PIC X(4).
  4381         16  CF-HEALTH-QUESTIONS            PIC X.
  4382             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4383         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4384         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4385         16  CF-PLAN-SNGL-JNT               PIC X.
  4386             88  CF-COMBINED-PLAN              VALUE 'C'.
  4387             88  CF-JNT-PLAN                   VALUE 'J'.
  4388             88  CF-SNGL-PLAN                  VALUE 'S'.
  4389         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4390         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4391         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4392         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4393         16  CF-RERATE-CNTL                 PIC  X.
  4394             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4395             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4396             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4397             88  CF-AUTO-RECALC                 VALUE '4'.
  4398         16  CF-BENEFIT-TYPE                PIC  X.
  4399             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4400             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4401         16  CF-POLICY-FEE                  PIC S999V99
  4402                                                    COMP-3.
  4403         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4404         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4405         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4406         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4407         16  FILLER                         PIC  X(32).
  4408         16  CF-TERMINATION-FORM            PIC  X(04).
  4409         16  FILLER                         PIC  X(08).
  4410         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4411                                                       COMP-3.
  4412         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4413         16  CF-ISSUE-LETTER                PIC  X(4).
  4414         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4415         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4416             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4417             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4418         16  CF-MP-REFUND-CALC              PIC X.
  4419             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4420             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4421             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4422             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4423             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4424             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4425             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4426             88  CF-MP-REFD-MEAN                VALUE '8'.
  4427         16  CF-ALT-RATE-CODE               PIC  X(5).
  4428
  4429
  4430         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  84
* EL152.cbl
  4431****************************************************************
  4432*             MORTGAGE COMPANY MASTER RECORD                   *
  4433****************************************************************
  4434
  4435     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4436         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4437         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4438             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4439             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4440             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4441             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4442             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4443
  4444         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4445         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4446         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4447         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4448         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4449
  4450         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4451             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4452         16  CF-MP-RECON-USE-IND            PIC X(1).
  4453             88  CF-MP-USE-RECON             VALUE 'Y'.
  4454         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4455             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4456         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4457             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4458             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4459         16  FILLER                         PIC X(1).
  4460         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4461             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4462         16  CF-MORTG-MIB-VERSION           PIC X.
  4463             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4464             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4465             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4466         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4467             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4468                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4469             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4470                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4471             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4472                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4473             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4474                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4475             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4476                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4477             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4478                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4479         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4480         16  FILLER                         PIC X(7).
  4481         16  CF-MORTG-DESTINATION-SYMBOL.
  4482             20  CF-MORTG-MIB-COMM          PIC X(5).
  4483             20  CF-MORTG-MIB-TERM          PIC X(5).
  4484         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4485             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4486         16  FILLER                         PIC X(03).
  4487         16  CF-MP-CHECK-NO-CONTROL.
  4488             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  85
* EL152.cbl
  4489                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4490                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4491                                                ' ' LOW-VALUES.
  4492                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4493                                               VALUE '3'.
  4494         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4495         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4496         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4497             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4498                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4499             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4500                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4501             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4502                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4503             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4504                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4505             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4506                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4507             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4508                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4509         16  CF-MORTG-BILLING-AREA.
  4510             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4511                                            PIC X.
  4512         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4513         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4514         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4515         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4516             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4517             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4518         16  FILLER                         PIC X.
  4519         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4520             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4521             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4522         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4523         16  FILLER                         PIC X(8).
  4524         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4525         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4526         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4527         16  CF-ACH-COMPANY-ID.
  4528             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4529                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4530                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4531                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4532             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4533         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4534             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4535         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4536             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4537             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4538         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4539         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4540         16  FILLER                         PIC X(536).
  4541
  4542****************************************************************
  4543*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4544****************************************************************
  4545
  4546     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  86
* EL152.cbl
  4547         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4548             20  CF-FEMALE-HEIGHT.
  4549                 24  CF-FEMALE-FT           PIC 99.
  4550                 24  CF-FEMALE-IN           PIC 99.
  4551             20  CF-FEMALE-MIN-WT           PIC 999.
  4552             20  CF-FEMALE-MAX-WT           PIC 999.
  4553         16  FILLER                         PIC X(428).
  4554
  4555     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4556         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4557             20  CF-MALE-HEIGHT.
  4558                 24  CF-MALE-FT             PIC 99.
  4559                 24  CF-MALE-IN             PIC 99.
  4560             20  CF-MALE-MIN-WT             PIC 999.
  4561             20  CF-MALE-MAX-WT             PIC 999.
  4562         16  FILLER                         PIC X(428).
  4563******************************************************************
  4564*             AUTOMATIC ACTIVITY RECORD                          *
  4565******************************************************************
  4566     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4567         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4568             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4569             20  CF-SYS-LETTER-ID           PIC X(04).
  4570             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4571             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4572             20  CF-SYS-RESET-SW            PIC X(01).
  4573             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4574             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4575
  4576         16  FILLER                         PIC X(50).
  4577
  4578         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4579             20  CF-USER-ACTIVE-SW          PIC X(01).
  4580             20  CF-USER-LETTER-ID          PIC X(04).
  4581             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4582             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4583             20  CF-USER-RESET-SW           PIC X(01).
  4584             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4585             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4586             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4587
  4588         16  FILLER                         PIC X(246).
  4589
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  87
* EL152.cbl
  4591*                                COPY ELCARCH.
  4592******************************************************************
  4593*                                                                *
  4594*                            ELCARCH.                            *
  4595*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4596*                            VMOD=2.007                          *
  4597*                                                                *
  4598*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4599*                                                                *
  4600*   FILE TYPE = VSAM,KSDS                                        *
  4601*   RECORD SIZE = 090  RECFORM = FIXED                           *
  4602*                                                                *
  4603*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  4604*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  4605*                                                                *
  4606*   LOG = NO                                                     *
  4607*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4608*                                                                *
  4609*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  4610******************************************************************
  4611 01  LETTER-ARCHIVE.
  4612     12  LA-RECORD-ID                PIC XX.
  4613         88  VALID-LA-ID                VALUE 'LA'.
  4614
  4615     12  LA-CONTROL-PRIMARY.
  4616         16  LA-COMPANY-CD           PIC X.
  4617         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  4618         16  LA-RECORD-TYPE          PIC X.
  4619             88  LA-HEADER-DATA         VALUE '1'.
  4620             88  LA-ADDRESS-DATA        VALUE '2'.
  4621             88  LA-TEXT-DATA           VALUE '3'.
  4622             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  4623         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  4624
  4625     12  LA-CONTROL-BY-TYPE.
  4626         16  LA-COMPANY-CD-A1        PIC X.
  4627         16  LA-RECORD-TYPE-A1       PIC X.
  4628         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  4629         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  4630
  4631     12  LA-TEXT-RECORD.
  4632         16  LA-SKIP-CONTROL         PIC XX.
  4633             88  NO-LINES-SKIPPED       VALUE SPACES.
  4634             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  4635         16  LA-TEXT-LINE            PIC X(70).
  4636
  4637     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  4638         16  FILLER                  PIC XX.
  4639         16  LA-ADDRESS-LINE         PIC X(30).
  4640         16  FILLER                  PIC X(40).
  4641
  4642     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  4643         16  FILLER                  PIC XX.
  4644         16  LA-CARRIER              PIC X.
  4645         16  LA-CLAIM-NO             PIC X(7).
  4646         16  LA-CERT-NO.
  4647             20  LA-CERT-PRIME       PIC X(10).
  4648             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  88
* EL152.cbl
  4649         16  LA-NO-OF-COPIES         PIC S9.
  4650         16  LA-RESEND-DATE          PIC XX.
  4651         16  LA-PROCESSOR-CD         PIC X(4).
  4652         16  LA-CREATION-DT          PIC XX.
  4653         16  LA-INITIAL-PRINT-DATE   PIC XX.
  4654         16  LA-RESEND-PRINT-DATE    PIC XX.
  4655         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  4656         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  4657*
  4658* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  4659*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  4660*   I        20  LA-DMD-PROD-CODE        PIC XX.
  4661*   I        20  LA-DMD-RES-ST           PIC XX.
  4662*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  4663*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  4664*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  4665*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  4666*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  4667*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  4668*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  4669*   I        20  LA-DMD-UND-CODE         PIC XX.
  4670*   I        20  LA-DMD-BEN-CODE         PIC XX.
  4671*   V    16  FILLER                  PIC X(15).
  4672* -----
  4673*
  4674* REINSERTED  CSO  MODS
  4675*
  4676         16  FILLER.
  4677             20  FILLER                  PIC X(29).
  4678             20  LA-CSO-LETTER-STATUS    PIC X.
  4679                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  4680                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  4681                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  4682             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  4683             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  4684*
  4685
  4686     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  4687         16  FILLER                  PIC XX.
  4688         16  LA4-CARRIER             PIC X.
  4689         16  LA4-CLAIM-NO            PIC X(7).
  4690         16  LA4-CERT-NO.
  4691             20  LA4-CERT-PRIME      PIC X(10).
  4692             20  LA4-CERT-SFX        PIC X.
  4693         16  LA4-NO-OF-COPIES        PIC S9.
  4694         16  LA4-RESEND-DATE         PIC XX.
  4695         16  LA4-PROCESSOR-CD        PIC X(4).
  4696         16  LA4-CREATION-DT         PIC XX.
  4697         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  4698         16  LA4-RESEND-PRINT-DATE   PIC XX.
  4699         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  4700         16  LA4-FORM-TYPE           PIC X.
  4701             88  LA4-INITIAL-FORM    VALUE '1'.
  4702             88  LA4-PROGRESS-FORM   VALUE '2'.
  4703         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  4704         16  LA4-STATE               PIC X(02).
  4705         16  FILLER                  PIC X(31).
  4706******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  89
* EL152.cbl
  4707
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  90
* EL152.cbl
  4709*                                COPY ELCARCT.
  4710******************************************************************
  4711*                                                                *
  4712*                            ELCARCT.                            *
  4713*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4714*                            VMOD=2.003                          *
  4715*                                                                *
  4716*   FILE DESCRIPTION = TEMPORARY LETTER ARCHIVE FILE             *
  4717*                                                                *
  4718*   FILE TYPE = VSAM,KSDS                                        *
  4719*   RECORD SIZE = 090  RECFORM = FIXED                           *
  4720*                                                                *
  4721*   BASE CLUSTER = ELARCT                        RKP=2,LEN=8     *
  4722*       ALTERNATE PATH1 = ELARCT2  (RECORD TYPE) RKP=10,LEN=8    *
  4723*                                                                *
  4724*   LOG = NO                                                     *
  4725*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4726*                                                                *
  4727*  NO  CID  MODS  IN  COPYBOOK  ELCARCT                          *
  4728******************************************************************
  4729 01  LETTER-ARCHIVE-TEMP.
  4730     12  LT-RECORD-ID                PIC XX.
  4731         88  VALID-LT-ID                VALUE 'LT'.
  4732
  4733     12  LT-CONTROL-PRIMARY.
  4734         16  LT-COMPANY-CD           PIC X.
  4735         16  LT-ARCHIVE-NO           PIC S9(8)     COMP.
  4736         16  LT-RECORD-TYPE          PIC X.
  4737             88  LT-HEADER-DATA         VALUE '1'.
  4738             88  LT-ADDRESS-DATA        VALUE '2'.
  4739             88  LT-TEXT-DATA           VALUE '3'.
  4740             88  LT-FORM-CONTROL-HDR    VALUE '4'.
  4741         16  LT-LINE-SEQ-NO          PIC S9(4)     COMP.
  4742
  4743     12  LT-CONTROL-BY-TYPE.
  4744         16  LT-COMPANY-CD-A1        PIC X.
  4745         16  LT-RECORD-TYPE-A1       PIC X.
  4746         16  LT-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  4747         16  LT-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  4748
  4749     12  LT-TEXT-RECORD.
  4750         16  LT-SKIP-CONTROL         PIC XX.
  4751         16  LT-TEXT-LINE            PIC X(70).
  4752
  4753     12  LT-ADDRESS-RECORD  REDEFINES  LT-TEXT-RECORD.
  4754         16  FILLER                  PIC XX.
  4755         16  LT-ADDRESS-LINE         PIC X(30).
  4756         16  FILLER                  PIC X(40).
  4757
  4758     12  LT-HEADER-RECORD  REDEFINES  LT-TEXT-RECORD.
  4759         16  FILLER                  PIC XX.
  4760         16  LT-CARRIER              PIC X.
  4761         16  LT-CLAIM-NO             PIC X(7).
  4762         16  LT-CERT-NO.
  4763             20  LT-CERT-PRIME       PIC X(10).
  4764             20  LT-CERT-SFX         PIC X.
  4765         16  LT-NO-OF-COPIES         PIC S9.
  4766         16  LT-RESEND-DATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  91
* EL152.cbl
  4767         16  LT-PROCESSOR-CD         PIC X(4).
  4768         16  LT-CREATION-DT          PIC XX.
  4769         16  LT-INITIAL-PRINT-DATE   PIC XX.
  4770         16  LT-RESEND-PRINT-DATE    PIC XX.
  4771         16  LT-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  4772         16  LT-1ST-RESEND-PRINT-DT  PIC XX.
  4773         16  LT-DMD-ADDITIONAL-FIELDS.
  4774             20  LT-DMD-LETTER-FORM      PIC X(4).
  4775             20  LT-DMD-PROD-CODE        PIC XX.
  4776             20  LT-DMD-RES-ST           PIC XX.
  4777             20  LT-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  4778             20  LT-DMD-LETTER-STATUS    PIC X.
  4779                 88  LT-DMD-LETTER-ONLINE   VALUE '1'.
  4780                 88  LT-DMD-LETTER-PURGED   VALUE '2'.
  4781                 88  LT-DMD-LETTER-RELOADED VALUE '3'.
  4782             20  LT-DMD-LETTER-PURGE-DT  PIC XX.
  4783             20  LT-DMD-LETTER-RELOAD-DT PIC XX.
  4784             20  LT-DMD-UND-CODE         PIC XX.
  4785             20  LT-DMD-BEN-CODE         PIC XX.
  4786         16  FILLER                  PIC X(15).
  4787
  4788     12  LT-FORM-CONTROL-HEADER REDEFINES  LT-TEXT-RECORD.
  4789         16  FILLER                  PIC XX.
  4790         16  LT4-CARRIER             PIC X.
  4791         16  LT4-CLAIM-NO            PIC X(7).
  4792         16  LT4-CERT-NO.
  4793             20  LT4-CERT-PRIME      PIC X(10).
  4794             20  LT4-CERT-SFX        PIC X.
  4795         16  LT4-NO-OF-COPIES        PIC S9.
  4796         16  LT4-RESEND-DATE         PIC XX.
  4797         16  LT4-PROCESSOR-CD        PIC X(4).
  4798         16  LT4-CREATION-DT         PIC XX.
  4799         16  LT4-INITIAL-PRINT-DATE  PIC XX.
  4800         16  LT4-RESEND-PRINT-DATE   PIC XX.
  4801         16  LT4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  4802         16  LT4-FORM-TYPE           PIC X.
  4803             88  LT4-INITIAL-FORM    VALUE '1'.
  4804             88  LT4-PROGRESS-FORM   VALUE '2'.
  4805         16  LT4-FORM-REM-PRINT-DT   PIC XX.
  4806         16  LT4-STATE               PIC XX.
  4807         16  FILLER                  PIC X(31).
  4808******************************************************************
  4809
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  92
* EL152.cbl
  4811*                                COPY ELCCERT.
  4812******************************************************************
  4813*                                                                *
  4814*                            ELCCERT.                            *
  4815*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4816*                            VMOD=2.013                          *
  4817*                                                                *
  4818*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4819*                                                                *
  4820*   FILE TYPE = VSAM,KSDS                                        *
  4821*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4822*                                                                *
  4823*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4824*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4825*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4826*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4827*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4828*                                                                *
  4829*   LOG = YES                                                    *
  4830*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4831******************************************************************
  4832*                   C H A N G E   L O G
  4833*
  4834* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4835*-----------------------------------------------------------------
  4836*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4837* EFFECTIVE    NUMBER
  4838*-----------------------------------------------------------------
  4839* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4840* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4841* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4842* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4843* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4844* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4845* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4846* 032612  CR2011110200001  PEMA  AHL CHANGES
  4847******************************************************************
  4848
  4849 01  CERTIFICATE-MASTER.
  4850     12  CM-RECORD-ID                      PIC XX.
  4851         88  VALID-CM-ID                      VALUE 'CM'.
  4852
  4853     12  CM-CONTROL-PRIMARY.
  4854         16  CM-COMPANY-CD                 PIC X.
  4855         16  CM-CARRIER                    PIC X.
  4856         16  CM-GROUPING.
  4857             20  CM-GROUPING-PREFIX        PIC X(3).
  4858             20  CM-GROUPING-PRIME         PIC X(3).
  4859         16  CM-STATE                      PIC XX.
  4860         16  CM-ACCOUNT.
  4861             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4862             20  CM-ACCOUNT-PRIME          PIC X(6).
  4863         16  CM-CERT-EFF-DT                PIC XX.
  4864         16  CM-CERT-NO.
  4865             20  CM-CERT-PRIME             PIC X(10).
  4866             20  CM-CERT-SFX               PIC X.
  4867
  4868     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  93
* EL152.cbl
  4869         16  CM-COMPANY-CD-A1              PIC X.
  4870         16  CM-INSURED-LAST-NAME          PIC X(15).
  4871         16  CM-INSURED-INITIALS.
  4872             20  CM-INSURED-INITIAL1       PIC X.
  4873             20  CM-INSURED-INITIAL2       PIC X.
  4874
  4875     12  CM-CONTROL-BY-SSN.
  4876         16  CM-COMPANY-CD-A2              PIC X.
  4877         16  CM-SOC-SEC-NO.
  4878             20  CM-SSN-STATE              PIC XX.
  4879             20  CM-SSN-ACCOUNT            PIC X(6).
  4880             20  CM-SSN-LN3.
  4881                 25  CM-INSURED-INITIALS-A2.
  4882                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4883                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4884                 25 CM-PART-LAST-NAME-A2         PIC X.
  4885
  4886     12  CM-CONTROL-BY-CERT-NO.
  4887         16  CM-COMPANY-CD-A4              PIC X.
  4888         16  CM-CERT-NO-A4                 PIC X(11).
  4889
  4890     12  CM-CONTROL-BY-MEMB.
  4891         16  CM-COMPANY-CD-A5              PIC X.
  4892         16  CM-MEMBER-NO.
  4893             20  CM-MEMB-STATE             PIC XX.
  4894             20  CM-MEMB-ACCOUNT           PIC X(6).
  4895             20  CM-MEMB-LN4.
  4896                 25  CM-INSURED-INITIALS-A5.
  4897                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4898                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4899                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4900
  4901     12  CM-INSURED-PROFILE-DATA.
  4902         16  CM-INSURED-FIRST-NAME.
  4903             20  CM-INSURED-1ST-INIT       PIC X.
  4904             20  FILLER                    PIC X(9).
  4905         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4906         16  CM-INSURED-SEX                PIC X.
  4907             88  CM-SEX-MALE                  VALUE 'M'.
  4908             88  CM-SEX-FEMAL                 VALUE 'F'.
  4909         16  CM-INSURED-JOINT-AGE          PIC 99.
  4910         16  CM-JOINT-INSURED-NAME.
  4911             20  CM-JT-LAST-NAME           PIC X(15).
  4912             20  CM-JT-FIRST-NAME.
  4913                 24  CM-JT-1ST-INIT        PIC X.
  4914                 24  FILLER                PIC X(9).
  4915             20  CM-JT-INITIAL             PIC X.
  4916
  4917     12  CM-LIFE-DATA.
  4918         16  CM-LF-BENEFIT-CD              PIC XX.
  4919         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4920         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4921         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4922         16  CM-LF-DEV-CODE                PIC XXX.
  4923         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4924         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4925         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4926         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  94
* EL152.cbl
  4927         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4928         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4929         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4930         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4931         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4932         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4933         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4934         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4935         16  cm-temp-epiq                  pic xx.
  4936             88  EPIQ-CLASS                  value 'EQ'.
  4937*        16  FILLER                        PIC XX.
  4938
  4939     12  CM-AH-DATA.
  4940         16  CM-AH-BENEFIT-CD              PIC XX.
  4941         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4942         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4943         16  CM-AH-DEV-CODE                PIC XXX.
  4944         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4945         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4946         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4947         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4948         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4949         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4950         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4951         16  CM-AH-PAID-THRU-DT            PIC XX.
  4952             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4953         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4954         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4955         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4956         16  FILLER                        PIC X.
  4957
  4958     12  CM-LOAN-INFORMATION.
  4959         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4960         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4961                                           PIC S9(5)V99  COMP-3.
  4962         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4963         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4964         16  CM-PAY-FREQUENCY              PIC S99.
  4965         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4966         16  CM-RATE-CLASS                 PIC XX.
  4967         16  CM-BENEFICIARY                PIC X(25).
  4968         16  CM-POLICY-FORM-NO             PIC X(12).
  4969         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4970         16  CM-LAST-ADD-ON-DT             PIC XX.
  4971         16  CM-DEDUCTIBLE-AMOUNTS.
  4972             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4973             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4974         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4975             20  CM-RESIDENT-STATE         PIC XX.
  4976             20  CM-RATE-CODE              PIC X(4).
  4977             20  FILLER                    PIC XX.
  4978         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4979             20  CM-LOAN-OFFICER           PIC X(5).
  4980             20  FILLER                    PIC XXX.
  4981         16  CM-CSR-CODE                   PIC XXX.
  4982         16  CM-UNDERWRITING-CODE          PIC X.
  4983             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4984         16  CM-POST-CARD-IND              PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  95
* EL152.cbl
  4985         16  CM-NH-INTERFACE-SW            PIC X.
  4986         16  CM-PREMIUM-TYPE               PIC X.
  4987             88  CM-SING-PRM                  VALUE '1'.
  4988             88  CM-O-B-COVERAGE              VALUE '2'.
  4989             88  CM-OPEN-END                  VALUE '3'.
  4990         16  CM-IND-GRP-TYPE               PIC X.
  4991             88  CM-INDIVIDUAL                VALUE 'I'.
  4992             88  CM-GROUP                     VALUE 'G'.
  4993         16  CM-SKIP-CODE                  PIC X.
  4994             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4995             88  SKIP-JULY                    VALUE '1'.
  4996             88  SKIP-AUGUST                  VALUE '2'.
  4997             88  SKIP-SEPTEMBER               VALUE '3'.
  4998             88  SKIP-JULY-AUG                VALUE '4'.
  4999             88  SKIP-AUG-SEPT                VALUE '5'.
  5000             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5001             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5002             88  SKIP-JUNE                    VALUE '8'.
  5003             88  SKIP-JUNE-JULY               VALUE '9'.
  5004             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5005             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5006         16  CM-PAYMENT-MODE               PIC X.
  5007             88  PAY-MONTHLY                  VALUE SPACE.
  5008             88  PAY-WEEKLY                   VALUE '1'.
  5009             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5010             88  PAY-BI-WEEKLY                VALUE '3'.
  5011             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5012         16  CM-LOAN-NUMBER                PIC X(8).
  5013         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5014         16  CM-OLD-LOF                    PIC XXX.
  5015*        16  CM-LOAN-OFFICER               PIC XXX.
  5016         16  CM-REIN-TABLE                 PIC XXX.
  5017         16  CM-SPECIAL-REIN-CODE          PIC X.
  5018         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5019         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5020         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5021
  5022     12  CM-STATUS-DATA.
  5023         16  CM-ENTRY-STATUS               PIC X.
  5024         16  CM-ENTRY-DT                   PIC XX.
  5025
  5026         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5027         16  CM-LF-CANCEL-DT               PIC XX.
  5028         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5029
  5030         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5031         16  CM-LF-DEATH-DT                PIC XX.
  5032         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5033
  5034         16  CM-LF-CURRENT-STATUS          PIC X.
  5035             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5036                                                'M' '4' '5' '9'.
  5037             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5038             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5039             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5040             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5041             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5042             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  96
* EL152.cbl
  5043             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5044             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5045             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5046             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5047             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5048             88  CM-LF-DECLINED               VALUE 'D'.
  5049             88  CM-LF-VOIDED                 VALUE 'V'.
  5050
  5051         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5052         16  CM-AH-CANCEL-DT               PIC XX.
  5053         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5054
  5055         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5056         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5057         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5058
  5059         16  CM-AH-CURRENT-STATUS          PIC X.
  5060             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5061                                                'M' '4' '5' '9'.
  5062             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5063             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5064             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5065             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5066             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5067             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5068             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5069             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5070             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5071             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5072             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5073             88  CM-AH-DECLINED               VALUE 'D'.
  5074             88  CM-AH-VOIDED                 VALUE 'V'.
  5075
  5076         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5077             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5078             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5079             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5080         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5081
  5082         16  CM-ENTRY-BATCH                PIC X(6).
  5083         16  CM-LF-EXIT-BATCH              PIC X(6).
  5084         16  CM-AH-EXIT-BATCH              PIC X(6).
  5085         16  CM-LAST-MONTH-END             PIC XX.
  5086
  5087     12  CM-NOTE-SW                        PIC X.
  5088         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5089         88  CERT-NOTES-PRESENT               VALUE '1'.
  5090         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5091         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5092         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5093         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5094         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5095         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5096     12  CM-COMP-EXCP-SW                   PIC X.
  5097         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5098         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5099     12  CM-INSURED-ADDRESS-SW             PIC X.
  5100         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  97
* EL152.cbl
  5101         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5102
  5103*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5104     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5105     12  FILLER                            PIC X.
  5106
  5107*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5108     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5109     12  FILLER                            PIC X.
  5110*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5111     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5112
  5113     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5114         88  CERT-ADDED-BATCH                 VALUE ' '.
  5115         88  CERT-ADDED-ONLINE                VALUE '1'.
  5116         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5117         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5118         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5119     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5120         88  CERT-AS-LOADED                   VALUE ' '.
  5121         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5122         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5123         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5124         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5125         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5126         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5127         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5128
  5129     12  CM-ACCOUNT-COMM-PCTS.
  5130         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5131         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5132
  5133     12  CM-USER-FIELD                     PIC X.
  5134     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5135     12  CM-CLP-STATE                      PIC XX.
  5136     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5137     12  CM-USER-RESERVED                  PIC XXX.
  5138     12  FILLER REDEFINES CM-USER-RESERVED.
  5139         16  CM-AH-CLASS-CD                PIC XX.
  5140         16  F                             PIC X.
  5141******************************************************************
  5142
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  98
* EL152.cbl
  5144*                                COPY ERCACCT.
  5145******************************************************************
  5146*                                                                *
  5147*                                                                *
  5148*                            ERCACCT                             *
  5149*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5150*                            VMOD=2.031                          *
  5151*                                                                *
  5152*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5153*                                                                *
  5154*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5155*   VSAM ACCOUNT MASTER FILES.                                   *
  5156*                                                                *
  5157*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5158*                                                                *
  5159*   FILE TYPE = VSAM,KSDS                                        *
  5160*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5161*                                                                *
  5162*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5163*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5164*                                                                *
  5165*   LOG = NO                                                     *
  5166*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5167*                                                                *
  5168*                                                                *
  5169******************************************************************
  5170*                   C H A N G E   L O G
  5171*
  5172* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5173*-----------------------------------------------------------------
  5174*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5175* EFFECTIVE    NUMBER
  5176*-----------------------------------------------------------------
  5177* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5178* 092705    2005050300006  PEMA  ADD SPP LEASES
  5179* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5180* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5181* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5182* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5183* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5184******************************************************************
  5185
  5186 01  ACCOUNT-MASTER.
  5187     12  AM-RECORD-ID                      PIC XX.
  5188         88  VALID-AM-ID                      VALUE 'AM'.
  5189
  5190     12  AM-CONTROL-PRIMARY.
  5191         16  AM-COMPANY-CD                 PIC X.
  5192         16  AM-MSTR-CNTRL.
  5193             20  AM-CONTROL-A.
  5194                 24  AM-CARRIER            PIC X.
  5195                 24  AM-GROUPING.
  5196                     28 AM-GROUPING-PREFIX PIC XXX.
  5197                     28 AM-GROUPING-PRIME  PIC XXX.
  5198                 24  AM-STATE              PIC XX.
  5199                 24  AM-ACCOUNT.
  5200                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5201                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  99
* EL152.cbl
  5202             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5203                                           PIC X(19).
  5204             20  AM-CNTRL-B.
  5205                 24  AM-EXPIRATION-DT      PIC XX.
  5206                 24  FILLER                PIC X(4).
  5207             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5208                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5209
  5210     12  AM-CONTROL-BY-VAR-GRP.
  5211         16  AM-COMPANY-CD-A1              PIC X.
  5212         16  AM-VG-CARRIER                 PIC X.
  5213         16  AM-VG-GROUPING                PIC X(6).
  5214         16  AM-VG-STATE                   PIC XX.
  5215         16  AM-VG-ACCOUNT                 PIC X(10).
  5216         16  AM-VG-DATE.
  5217             20  AM-VG-EXPIRATION-DT       PIC XX.
  5218             20  FILLER                    PIC X(4).
  5219         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5220                                           PIC 9(11)      COMP-3.
  5221     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5222         16  FILLER                        PIC X(10).
  5223         16  AM-VG-KEY3.
  5224             20  AM-VG3-ACCOUNT            PIC X(10).
  5225             20  AM-VG3-EXP-DT             PIC XX.
  5226         16  FILLER                        PIC X(4).
  5227     12  AM-MAINT-INFORMATION.
  5228         16  AM-LAST-MAINT-DT              PIC XX.
  5229         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5230         16  AM-LAST-MAINT-USER            PIC X(4).
  5231         16  FILLER                        PIC XX.
  5232
  5233     12  AM-EFFECTIVE-DT                   PIC XX.
  5234     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5235
  5236     12  AM-PREV-DATES  COMP-3.
  5237         16  AM-PREV-EXP-DT                PIC 9(11).
  5238         16  AM-PREV-EFF-DT                PIC 9(11).
  5239
  5240     12  AM-REPORT-CODE-1                  PIC X(10).
  5241     12  AM-REPORT-CODE-2                  PIC X(10).
  5242
  5243     12  AM-CITY-CODE                      PIC X(4).
  5244     12  AM-COUNTY-PARISH                  PIC X(6).
  5245
  5246     12  AM-NAME                           PIC X(30).
  5247     12  AM-PERSON                         PIC X(30).
  5248     12  AM-ADDRS                          PIC X(30).
  5249     12  AM-CITY.
  5250         16  AM-ADDR-CITY                  PIC X(28).
  5251         16  AM-ADDR-STATE                 PIC XX.
  5252     12  AM-ZIP.
  5253         16  AM-ZIP-PRIME.
  5254             20  AM-ZIP-PRI-1ST            PIC X.
  5255                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5256             20  FILLER                    PIC X(4).
  5257         16  AM-ZIP-PLUS4                  PIC X(4).
  5258     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5259         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 100
* EL152.cbl
  5260         16  AM-CAN-POSTAL-2               PIC XXX.
  5261         16  FILLER                        PIC XXX.
  5262     12  AM-TEL-NO.
  5263         16  AM-AREA-CODE                  PIC 999.
  5264         16  AM-TEL-PRE                    PIC 999.
  5265         16  AM-TEL-NBR                    PIC 9(4).
  5266     12  AM-TEL-LOC                        PIC X.
  5267         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5268         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5269
  5270     12  AM-COMM-STRUCTURE.
  5271         16  AM-DEFN-1.
  5272             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5273                 24  AM-AGT.
  5274                     28  AM-AGT-PREFIX     PIC X(4).
  5275                     28  AM-AGT-PRIME      PIC X(6).
  5276                 24  AM-COM-TYP            PIC X.
  5277                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5278                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5279                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5280                 24  AM-RECALC-LV-INDIC    PIC X.
  5281                 24  AM-RETRO-LV-INDIC     PIC X.
  5282                 24  AM-GL-CODES           PIC X.
  5283                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5284                 24  FILLER                PIC X(01).
  5285         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5286             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5287                 24  FILLER                PIC X(11).
  5288                 24  AM-L-COMA             PIC XXX.
  5289                 24  AM-J-COMA             PIC XXX.
  5290                 24  AM-A-COMA             PIC XXX.
  5291                 24  FILLER                PIC X(6).
  5292
  5293     12  AM-COMM-CHANGE-STATUS             PIC X.
  5294         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5295
  5296     12  AM-CSR-CODE                       PIC X(4).
  5297
  5298     12  AM-BILLING-STATUS                 PIC X.
  5299         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5300         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5301     12  AM-AUTO-REFUND-SW                 PIC X.
  5302         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5303         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5304     12  AM-GPCD                           PIC 99.
  5305     12  AM-IG                             PIC X.
  5306         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5307         88  AM-HAS-GROUP                     VALUE '2'.
  5308     12  AM-STATUS                         PIC X.
  5309         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5310         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5311         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5312         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5313         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5314         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5315     12  AM-REMIT-TO                       PIC 99.
  5316     12  AM-ID-NO                          PIC X(11).
  5317
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 101
* EL152.cbl
  5318     12  AM-CAL-TABLE                      PIC XX.
  5319     12  AM-LF-DEVIATION                   PIC XXX.
  5320     12  AM-AH-DEVIATION                   PIC XXX.
  5321     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5322     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5323     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5324     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5325     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5326     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5327
  5328     12  AM-USER-FIELDS.
  5329         16  AM-FLD-1                      PIC XX.
  5330         16  AM-FLD-2                      PIC XX.
  5331         16  AM-FLD-3                      PIC XX.
  5332         16  AM-FLD-4                      PIC XX.
  5333         16  AM-FLD-5                      PIC XX.
  5334
  5335     12  AM-1ST-PROD-DATE.
  5336         16  AM-1ST-PROD-YR                PIC XX.
  5337         16  AM-1ST-PROD-MO                PIC XX.
  5338         16  AM-1ST-PROD-DA                PIC XX.
  5339     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5340     12  AM-CERTS-PURGED-DATE.
  5341         16  AM-PUR-YR                     PIC XX.
  5342         16  AM-PUR-MO                     PIC XX.
  5343         16  AM-PUR-DA                     PIC XX.
  5344     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5345     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5346     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5347     12  AM-INACTIVE-DATE.
  5348         16  AM-INA-MO                     PIC 99.
  5349         16  AM-INA-DA                     PIC 99.
  5350         16  AM-INA-YR                     PIC 99.
  5351     12  AM-AR-HI-CERT-DATE                PIC XX.
  5352
  5353     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5354     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5355
  5356     12  AM-OB-PAYMENT-MODE                PIC X.
  5357         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5358         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5359         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5360         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5361
  5362     12  AM-AH-ONLY-INDICATOR              PIC X.
  5363         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5364         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5365
  5366     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5367
  5368     12  AM-OVER-SHORT.
  5369         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5370         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5371
  5372     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5373     12  AM-DCC-CLP-STATE                  PIC XX.
  5374
  5375     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 102
* EL152.cbl
  5376     12  AM-RECALC-REIN                    PIC X.
  5377
  5378     12  AM-REI-TABLE                      PIC XXX.
  5379     12  AM-REI-ET-LF                      PIC X.
  5380     12  AM-REI-ET-AH                      PIC X.
  5381     12  AM-REI-PE-LF                      PIC X.
  5382     12  AM-REI-PE-AH                      PIC X.
  5383     12  AM-REI-PRT-ST                     PIC X.
  5384     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5385     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5386     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5387     12  AM-REI-GROUP-A                    PIC X(6).
  5388     12  AM-REI-MORT                       PIC X(4).
  5389     12  AM-REI-PRT-OW                     PIC X.
  5390     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5391     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5392     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5393     12  AM-REI-GROUP-B                    PIC X(6).
  5394
  5395     12  AM-TRUST-TYPE                     PIC X(2).
  5396
  5397     12  AM-EMPLOYER-STMT-USED             PIC X.
  5398     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5399
  5400     12  AM-STD-AH-TYPE                    PIC XX.
  5401     12  AM-EARN-METHODS.
  5402         16  AM-EARN-METHOD-R              PIC X.
  5403             88 AM-REF-RL-R78                 VALUE 'R'.
  5404             88 AM-REF-RL-PR                  VALUE 'P'.
  5405             88 AM-REF-RL-MEAN                VALUE 'M'.
  5406             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5407         16  AM-EARN-METHOD-L              PIC X.
  5408             88 AM-REF-LL-R78                 VALUE 'R'.
  5409             88 AM-REF-LL-PR                  VALUE 'P'.
  5410             88 AM-REF-LL-MEAN                VALUE 'M'.
  5411             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5412         16  AM-EARN-METHOD-A              PIC X.
  5413             88 AM-REF-AH-R78                 VALUE 'R'.
  5414             88 AM-REF-AH-PR                  VALUE 'P'.
  5415             88 AM-REF-AH-MEAN                VALUE 'M'.
  5416             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5417             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5418             88 AM-REF-AH-NET                 VALUE 'N'.
  5419
  5420     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5421     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5422     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5423
  5424     12  AM-RET-Y-N                        PIC X.
  5425     12  AM-RET-P-E                        PIC X.
  5426     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5427     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5428     12  AM-RET-GRP                        PIC X(6).
  5429     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5430         16  AM-POOL-PRIME                 PIC XXX.
  5431         16  AM-POOL-SUB                   PIC XXX.
  5432     12  AM-RETRO-EARNINGS.
  5433         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 103
* EL152.cbl
  5434         16  AM-RET-EARN-L                 PIC X.
  5435         16  AM-RET-EARN-A                 PIC X.
  5436     12  AM-RET-ST-TAX-USE                 PIC X.
  5437         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5438         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5439     12  AM-RETRO-BEG-EARNINGS.
  5440         16  AM-RET-BEG-EARN-R             PIC X.
  5441         16  AM-RET-BEG-EARN-L             PIC X.
  5442         16  AM-RET-BEG-EARN-A             PIC X.
  5443     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5444     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5445
  5446     12  AM-USER-SELECT-OPTIONS.
  5447         16  AM-USER-SELECT-1              PIC X(10).
  5448         16  AM-USER-SELECT-2              PIC X(10).
  5449         16  AM-USER-SELECT-3              PIC X(10).
  5450         16  AM-USER-SELECT-4              PIC X(10).
  5451         16  AM-USER-SELECT-5              PIC X(10).
  5452
  5453     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5454
  5455     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5456
  5457     12  AM-RPT045A-SWITCH                 PIC X.
  5458         88  RPT045A-OFF                   VALUE 'N'.
  5459
  5460     12  AM-INSURANCE-LIMITS.
  5461         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5462         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5463
  5464     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5465         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5466
  5467     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5468         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5469         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5470
  5471     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5472
  5473     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5474     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5475     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5476     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5477     12  AM-DCC-UEF-STATE                  PIC XX.
  5478     12  FILLER                            PIC XXX.
  5479     12  AM-REPORT-CODE-3                  PIC X(10).
  5480*    12  FILLER                            PIC X(22).
  5481
  5482     12  AM-RESERVE-DATE.
  5483         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5484         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5485         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5486
  5487     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5488     12  AM-NOTIFICATION-TYPES.
  5489         16  AM-NOTIF-OF-LETTERS           PIC X.
  5490         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5491         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 104
* EL152.cbl
  5492         16  AM-NOTIF-OF-STATUS            PIC X.
  5493
  5494     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5495         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5496         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5497         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5498         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5499
  5500     12  AM-BENEFIT-CONTROLS.
  5501         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5502             20  AM-BENEFIT-CODE           PIC XX.
  5503             20  AM-BENEFIT-TYPE           PIC X.
  5504             20  AM-BENEFIT-REVISION       PIC XXX.
  5505             20  AM-BENEFIT-REM-TERM       PIC X.
  5506             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5507             20  FILLER                    PIC XX.
  5508         16  FILLER                        PIC X(80).
  5509
  5510     12  AM-TRANSFER-DATA.
  5511         16  AM-TRANSFERRED-FROM.
  5512             20  AM-TRNFROM-CARRIER        PIC X.
  5513             20  AM-TRNFROM-GROUPING.
  5514                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5515                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5516             20  AM-TRNFROM-STATE          PIC XX.
  5517             20  AM-TRNFROM-ACCOUNT.
  5518                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5519                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5520             20  AM-TRNFROM-DTE            PIC XX.
  5521         16  AM-TRANSFERRED-TO.
  5522             20  AM-TRNTO-CARRIER          PIC X.
  5523             20  AM-TRNTO-GROUPING.
  5524                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5525                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5526             20  AM-TRNTO-STATE            PIC XX.
  5527             20  AM-TRNTO-ACCOUNT.
  5528                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5529                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5530             20  AM-TRNTO-DTE              PIC XX.
  5531         16  FILLER                        PIC X(10).
  5532
  5533     12  AM-SAVED-REMIT-TO                 PIC 99.
  5534
  5535     12  AM-COMM-STRUCTURE-SAVED.
  5536         16  AM-DEFN-1-SAVED.
  5537             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5538                 24  AM-AGT-SV             PIC X(10).
  5539                 24  AM-COM-TYP-SV         PIC X.
  5540                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5541                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5542                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5543                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5544                 24  FILLER                PIC X.
  5545                 24  AM-GL-CODES-SV        PIC X.
  5546                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5547                 24  FILLER                PIC X.
  5548         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5549             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 105
* EL152.cbl
  5550                 24  FILLER                PIC X(11).
  5551                 24  AM-L-COMA-SV          PIC XXX.
  5552                 24  AM-J-COMA-SV          PIC XXX.
  5553                 24  AM-A-COMA-SV          PIC XXX.
  5554                 24  FILLER                PIC X(6).
  5555
  5556     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5557         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5558            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5559            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5560            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5561
  5562     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5563     12  FILLER                            PIC X(120).
  5564
  5565     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5566         16  AM-CONTROL-NAME               PIC X(30).
  5567         16  AM-EXECUTIVE-ONE.
  5568             20  AM-EXEC1-NAME             PIC X(15).
  5569             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5570                                                          COMP-3.
  5571             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5572                                                          COMP-3.
  5573         16  AM-EXECUTIVE-TWO.
  5574             20  AM-EXEC2-NAME             PIC X(15).
  5575             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5576                                                          COMP-3.
  5577             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5578                                                          COMP-3.
  5579
  5580     12  AM-RETRO-ADDITIONAL-DATA.
  5581         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5582         16  AM-RETRO-PREM-P-E             PIC X.
  5583         16  AM-RETRO-CLMS-P-I             PIC X.
  5584         16  AM-RETRO-RET-BRACKET-LF.
  5585             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5586                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5587                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5588             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5589                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5590                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5591             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5592                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5593                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5594         16  AM-RETRO-RET-BRACKET-AH.
  5595             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5596                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5597                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5598                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5599             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5600                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5601                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5602             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5603                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5604                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5605
  5606     12  AM-COMMENTS.
  5607         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 106
* EL152.cbl
  5608
  5609     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5610         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5611         16  AM-FLI-BILLING-CODE           PIC X.
  5612         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5613         16  AM-FLI-UNITED-IDENT           PIC X.
  5614         16  AM-FLI-INTEREST-LOST-DATA.
  5615             20  AM-FLI-BANK-NO            PIC X(5).
  5616             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5617             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5618             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5619         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5620             20  AM-FLI-AGT                PIC X(9).
  5621             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5622             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5623         16  FILLER                        PIC X(102).
  5624
  5625     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5626         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5627             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5628             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5629             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5630             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5631             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5632         16  FILLER                          PIC X(10).
  5633******************************************************************
  5634
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 107
* EL152.cbl
  5636*                                COPY ELCTEXT.
  5637******************************************************************
  5638*                                                                *
  5639*                                                                *
  5640*                            ELCTEXT.                            *
  5641*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5642*                            VMOD=2.008                          *
  5643*                                                                *
  5644*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  5645*                                     FORM LETTERS,              *
  5646*                                     CERT FORM DISPLAY.
  5647*                                                                *
  5648*   FILE TYPE = VSAM,KSDS                                        *
  5649*   RECORD SIZE = 100   RECFORM = FIXED                          *
  5650*                                                                *
  5651*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  5652*       ALTERNATE INDEX = NONE                                   *
  5653*                                                                *
  5654*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  5655*       ALTERNATE INDEX = NONE                                   *
  5656*                                                                *
  5657*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  5658*       ALTERNATE INDEX = NONE                                   *
  5659*                                                                *
  5660*   LOG = NO                                                     *
  5661*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5662******************************************************************
  5663 01  TEXT-FILES.
  5664     12  TEXT-FILE-ID                PIC XX.
  5665         88  FORMS-FILE-TEXT            VALUE 'TF'.
  5666         88  LETTER-FILE-TEXT           VALUE 'TL'.
  5667         88  HELP-FILE-TEXT             VALUE 'TH'.
  5668
  5669     12  TX-CONTROL-PRIMARY.
  5670         16  TX-COMPANY-CD           PIC X.
  5671             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  5672         16  TX-ACCESS-CD-GENL       PIC X(12).
  5673
  5674         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5675             20  TX-LETTER-NO        PIC X(4).
  5676             20  FILLER              PIC X(8).
  5677
  5678         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5679             20  TX-FORM-NO          PIC X(12).
  5680
  5681         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5682             20  TX-HELP-TYPE        PIC X.
  5683                 88  HELP-FOR-GENERAL   VALUE ' '.
  5684                 88  HELP-BY-SCREEN     VALUE 'S'.
  5685                 88  HELP-BY-ERROR      VALUE 'E'.
  5686             20  TX-SCREEN-OR-ERROR  PIC X(4).
  5687                 88  GENERAL-INFO-HELP  VALUE '0000'.
  5688             20  TX-HELP-FOR-COMPANY  PIC XXX.
  5689                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  5690             20  FILLER              PIC X(4).
  5691
  5692         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  5693
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 108
* EL152.cbl
  5694     12  TX-PROCESS-CONTROL          PIC XX.
  5695         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  5696
  5697     12  TX-TEXT-LINE                PIC X(70).
  5698
  5699     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  5700         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  5701         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  5702         88  TX-VALID-FORM-SQUEEZE-VALUE
  5703                                        VALUE 'Y' ' '.
  5704
  5705     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  5706         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  5707         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  5708         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  5709         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  5710         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  5711         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  5712         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  5713                                              'K' 'N' ' '
  5714                                              'Z'.
  5715
  5716     12  TX-ARCHIVE-SW               PIC X.
  5717         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  5718         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  5719         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  5720
  5721     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  5722     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  5723
  5724     12  TX-BSR-CODE                 PIC X.
  5725         88  TX-BSR-LETTER              VALUE 'B'.
  5726         88  TX-NON-BSR-LETTER          VALUE ' '.
  5727
  5728     12  FILLER                      PIC X.
  5729*****************************************************************
  5730
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 109
* EL152.cbl
  5732*                                COPY ELCTRLR.
  5733******************************************************************
  5734*                                                                *
  5735*                            ELCTRLR.                            *
  5736*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5737*                            VMOD=2.014                          *
  5738*                                                                *
  5739*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5740*                                                                *
  5741*   FILE TYPE = VSAM,KSDS                                        *
  5742*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5743*                                                                *
  5744*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5745*       ALTERNATE INDEX = NONE                                   *
  5746*                                                                *
  5747*   LOG = YES                                                    *
  5748*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5749******************************************************************
  5750*                   C H A N G E   L O G
  5751*
  5752* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5753*-----------------------------------------------------------------
  5754*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5755* EFFECTIVE    NUMBER
  5756*-----------------------------------------------------------------
  5757* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5758* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5759* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5760* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5761* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5762* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5763* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5764* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5765* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5766* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5767* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5768* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5769* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5770* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5771* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5772* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5773* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5774* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5775* 040814    2014030500002  AJRA  ADD ICD CODES
  5776* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5777******************************************************************
  5778 01  ACTIVITY-TRAILERS.
  5779     12  AT-RECORD-ID                    PIC XX.
  5780         88  VALID-AT-ID                       VALUE 'AT'.
  5781
  5782     12  AT-CONTROL-PRIMARY.
  5783         16  AT-COMPANY-CD               PIC X.
  5784         16  AT-CARRIER                  PIC X.
  5785         16  AT-CLAIM-NO                 PIC X(7).
  5786         16  AT-CERT-NO.
  5787             20  AT-CERT-PRIME           PIC X(10).
  5788             20  AT-CERT-SFX             PIC X.
  5789         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 110
* EL152.cbl
  5790             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5791             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5792             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5793             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5794             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5795             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5796             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5797             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5798             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5799             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5800             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5801             88  AT-BENEFICIARY-TRL           VALUE +91.
  5802             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5803             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5804             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5805             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5806
  5807     12  AT-TRAILER-TYPE                 PIC X.
  5808         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5809         88  PAYMENT-TR                       VALUE '2'.
  5810         88  AUTO-PAY-TR                      VALUE '3'.
  5811         88  CORRESPONDENCE-TR                VALUE '4'.
  5812         88  ADDRESS-TR                       VALUE '5'.
  5813         88  GENERAL-INFO-TR                  VALUE '6'.
  5814         88  AUTO-PROMPT-TR                   VALUE '7'.
  5815         88  DENIAL-TR                        VALUE '8'.
  5816         88  INCURRED-CHG-TR                  VALUE '9'.
  5817         88  FORM-CONTROL-TR                  VALUE 'A'.
  5818
  5819     12  AT-RECORDED-DT                  PIC XX.
  5820     12  AT-RECORDED-BY                  PIC X(4).
  5821     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5822
  5823     12  AT-TRAILER-BODY                 PIC X(165).
  5824
  5825     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5826         16  AT-RESERVE-CONTROLS.
  5827             20  AT-MANUAL-SW            PIC X.
  5828                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5829             20  AT-FUTURE-SW            PIC X.
  5830                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5831             20  AT-PTC-SW               PIC X.
  5832                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5833             20  AT-IBNR-SW              PIC X.
  5834                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5835             20  AT-PTC-LF-SW            PIC X.
  5836                 88  AT-LF-PTC-USED          VALUE '1'.
  5837             20  AT-CDT-ACCESS-METHOD    PIC X.
  5838                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5839                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5840                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5841             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5842         16  AT-LAST-COMPUTED-DT         PIC XX.
  5843         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5844         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5845         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5846         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5847         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 111
* EL152.cbl
  5848         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5849         16  AT-EXPENSE-CONTROLS.
  5850             20  AT-EXPENSE-METHOD       PIC X.
  5851                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5852                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5853                 88  PERCENT-OF-PMT           VALUE '3'.
  5854                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5855             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5856             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5857         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5858         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5859
  5860         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5861         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5862
  5863*        16  FILLER                      PIC X(53).
  5864         16  FILLER                      PIC X(47).
  5865
  5866         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5867         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5868
  5869         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5870             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5871             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5872*                    C = CLOSED
  5873*                    O = OPEN
  5874             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5875*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5876
  5877     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5878         16  AT-PAYMENT-TYPE             PIC X.
  5879             88  PARTIAL-PAYMENT                VALUE '1'.
  5880             88  FINAL-PAYMENT                  VALUE '2'.
  5881             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5882             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5883             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5884             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5885             88  VOIDED-PAYMENT                 VALUE '9'.
  5886             88  TRANSFER                       VALUE 'T'.
  5887             88  LIFE-INTEREST                  VALUE 'I'.
  5888
  5889         16  AT-CLAIM-TYPE               PIC X.
  5890             88  PAID-FOR-AH                    VALUE 'A'.
  5891             88  PAID-FOR-LIFE                  VALUE 'L'.
  5892             88  PAID-FOR-IUI                   VALUE 'I'.
  5893             88  PAID-FOR-GAP                   VALUE 'G'.
  5894             88  PAID-FOR-FAM                   VALUE 'F'.
  5895         16  AT-CLAIM-PREM-TYPE          PIC X.
  5896             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5897             88  AT-O-B-COVERAGE                VALUE '2'.
  5898             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5899         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5900         16  AT-CHECK-NO                 PIC X(7).
  5901         16  AT-PAID-FROM-DT             PIC XX.
  5902         16  AT-PAID-THRU-DT             PIC XX.
  5903         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5904         16  FILLER                      PIC X.
  5905         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 112
* EL152.cbl
  5906         16  AT-PAYMENT-ORIGIN           PIC X.
  5907             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5908             88  ONLINE-AUTO-PMT                VALUE '2'.
  5909             88  OFFLINE-PMT                    VALUE '3'.
  5910         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5911         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5912         16  AT-VOID-DATA.
  5913             20  AT-VOID-DT              PIC XX.
  5914*00144       20  AT-VOID-REASON          PIC X(30).
  5915             20  AT-VOID-REASON          PIC X(26).
  5916         16  AT-PMT-APPROVED-BY          PIC X(04).
  5917         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5918         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5919         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5920                                         PIC S99V9(5)  COMP-3.
  5921         16  AT-CREDIT-INTERFACE.
  5922             20  AT-PMT-SELECT-DT        PIC XX.
  5923                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5924             20  AT-PMT-ACCEPT-DT        PIC XX.
  5925                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5926             20  AT-VOID-SELECT-DT       PIC XX.
  5927                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5928             20  AT-VOID-ACCEPT-DT       PIC XX.
  5929                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5930
  5931         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5932                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5933                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5934         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5935
  5936         16  AT-FORCE-CONTROL            PIC X.
  5937             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5938         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5939         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5940         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5941         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5942         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5943         16  AT-BENEFIT-TYPE             PIC X.
  5944
  5945         16  AT-EXPENSE-TYPE             PIC X.
  5946         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5947
  5948         16  AT-PAYEE-TYPE-CD.
  5949             20  AT-PAYEE-TYPE           PIC X.
  5950                 88  INSURED-PAID           VALUE 'I'.
  5951                 88  BENEFICIARY-PAID       VALUE 'B'.
  5952                 88  ACCOUNT-PAID           VALUE 'A'.
  5953                 88  OTHER-1-PAID           VALUE 'O'.
  5954                 88  OTHER-2-PAID           VALUE 'Q'.
  5955                 88  DOCTOR-PAID            VALUE 'P'.
  5956                 88  EMPLOYER-PAID          VALUE 'E'.
  5957             20  AT-PAYEE-SEQ            PIC X.
  5958
  5959         16  AT-CASH-PAYMENT             PIC X.
  5960         16  AT-GROUPED-PAYMENT          PIC X.
  5961         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5962         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5963         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 113
* EL152.cbl
  5964         16  AT-VOID-TYPE                PIC X.
  5965             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5966             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5967         16  AT-AIG-UNEMP-IND            PIC X.
  5968             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5969         16  AT-ASSOCIATES               PIC X.
  5970             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5971             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5972
  5973         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  5974         16  AT-CV-PMT-CODE              PIC X.
  5975             88  FULL-DEATH-PAYMENT         VALUE '1'.
  5976             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5977             88  FULL-ADD-PAYMENT           VALUE '3'.
  5978             88  HALF-ADD-PAYMENT           VALUE '4'.
  5979             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5980             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5981             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5982             88  ADDL-PAYMENT               VALUE '8'.
  5983
  5984         16  AT-EOB-CODE1                PIC XXX.
  5985         16  AT-EOB-CODE2                PIC XXX.
  5986         16  AT-EOB-CODE3                PIC XXX.
  5987         16  FILLER REDEFINES AT-EOB-CODE3.
  5988             20  AT-PRINT-CLM-FORM       PIC X.
  5989             20  AT-PRINT-SURVEY         PIC X.
  5990             20  AT-SPECIAL-RELEASE      PIC X.
  5991         16  AT-EOB-CODE4                PIC XXX.
  5992         16  FILLER REDEFINES AT-EOB-CODE4.
  5993             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5994             20  FILLER                  PIC X.
  5995         16  AT-EOB-CODE5                PIC XXX.
  5996         16  FILLER REDEFINES AT-EOB-CODE5.
  5997             20  AT-PMT-PROOF-DT         PIC XX.
  5998             20  FILLER                  PIC X.
  5999
  6000         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6001             88  AT-PRINT-EOB            VALUE 'Y'.
  6002
  6003         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6004         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6005
  6006     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6007         16  AT-SCHEDULE-START-DT        PIC XX.
  6008         16  AT-SCHEDULE-END-DT          PIC XX.
  6009         16  AT-TERMINATED-DT            PIC XX.
  6010         16  AT-LAST-PMT-TYPE            PIC X.
  6011             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6012             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6013         16  AT-FIRST-PMT-DATA.
  6014             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6015             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6016             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6017         16  AT-REGULAR-PMT-DATA.
  6018             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6019             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6020             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6021         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 114
* EL152.cbl
  6022             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6023                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6024                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6025                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6026                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6027                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6028             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6029         16  AT-AUTO-PAY-DAY             PIC 99.
  6030         16  AT-AUTO-CASH                PIC X.
  6031             88  AT-CASH                      VALUE 'Y'.
  6032             88  AT-NON-CASH                  VALUE 'N'.
  6033*        16  FILLER                      PIC X(129).
  6034         16  AT-AUTO-END-LETTER          PIC X(4).
  6035         16  FILLER                      PIC X(125).
  6036
  6037         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6038         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6039
  6040     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6041         16  AT-LETTER-SENT-DT           PIC XX.
  6042         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6043         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6044         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6045         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6046         16  AT-LETTER-ORIGIN            PIC X.
  6047             88  ONLINE-CREATION              VALUE '1' '3'.
  6048             88  OFFLINE-CREATION             VALUE '2' '4'.
  6049             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6050             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6051         16  AT-STD-LETTER-FORM          PIC X(4).
  6052         16  AT-REASON-TEXT              PIC X(70).
  6053         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6054         16  AT-ADDRESEE-TYPE            PIC X.
  6055              88  INSURED-ADDRESEE            VALUE 'I'.
  6056              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6057              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6058              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6059              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6060              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6061              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6062         16  AT-ADDRESSEE-NAME           PIC X(30).
  6063         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6064         16  AT-RESEND-PRINT-DATE        PIC XX.
  6065         16  AT-CORR-SOL-UNSOL           PIC X.
  6066         16  AT-LETTER-PURGED-DT         PIC XX.
  6067*
  6068*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6069*
  6070         16  AT-CSO-REDEFINITION.
  6071             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6072             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6073             20  AT-LETTER-TO-BENE       PIC X(1).
  6074             20  AT-STOP-LETTER-DT       PIC X(2).
  6075             20  FILLER                  PIC X(19).
  6076*             20  FILLER                  PIC X(27).
  6077             20  AT-CSO-LETTER-STATUS    PIC X.
  6078                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6079                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 115
* EL152.cbl
  6080                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6081             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6082             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6083*
  6084*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6085*
  6086*        16  FILLER                      PIC X(26).
  6087*
  6088*        16  AT-DMD-BSR-CODE             PIC X.
  6089*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6090*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6091*
  6092*        16  AT-DMD-LETTER-STATUS        PIC X.
  6093*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6094*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6095*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6096*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6097*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6098
  6099         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6100         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6101
  6102     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6103         16  AT-ADDRESS-TYPE             PIC X.
  6104             88  INSURED-ADDRESS               VALUE 'I'.
  6105             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6106             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6107             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6108             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6109             88  OTHER-ADDRESS-1               VALUE 'O'.
  6110             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6111         16  AT-MAIL-TO-NAME             PIC X(30).
  6112         16  AT-ADDRESS-LINE-1           PIC X(30).
  6113         16  AT-ADDRESS-LINE-2           PIC X(30).
  6114         16  AT-CITY-STATE.
  6115             20  AT-CITY                 PIC X(28).
  6116             20  AT-STATE                PIC XX.
  6117         16  AT-ZIP.
  6118             20  AT-ZIP-CODE.
  6119                 24  AT-ZIP-1ST          PIC X.
  6120                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6121                 24  FILLER              PIC X(4).
  6122             20  AT-ZIP-PLUS4            PIC X(4).
  6123         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6124             20  AT-CAN-POSTAL-1         PIC XXX.
  6125             20  AT-CAN-POSTAL-2         PIC XXX.
  6126             20  FILLER                  PIC XXX.
  6127         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6128*         16  FILLER                      PIC X(23).
  6129         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6130         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6131         16  FILLER                      PIC X(13).
  6132         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6133         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6134
  6135     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6136         16  AT-INFO-LINE-1              PIC X(60).
  6137         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 116
* EL152.cbl
  6138             20  AT-NOTE-ERROR-NO OCCURS 15
  6139                                         PIC X(4).
  6140         16  AT-INFO-LINE-2              PIC X(60).
  6141         16  FILLER REDEFINES AT-INFO-LINE-2.
  6142             20  AT-ICD-CODE-1           PIC X(8).
  6143             20  AT-ICD-CODE-2           PIC X(8).
  6144             20  FILLER                  PIC X(44).
  6145         16  AT-INFO-TRAILER-TYPE        PIC X.
  6146             88  AT-ERRORS-NOTE          VALUE 'E'.
  6147             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6148             88  AT-CALL-NOTE            VALUE 'C'.
  6149             88  AT-MAINT-NOTE           VALUE 'M'.
  6150             88  AT-CERT-CHANGE          VALUE 'X'.
  6151             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6152             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6153             88  AT-CERT-CANCELLED       VALUE 'T'.
  6154         16  AT-CALL-TYPE                PIC X.
  6155             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6156             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6157         16  AT-NOTE-CONTINUATION        PIC X.
  6158             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6159         16  AT-EOB-CODES-EXIST          PIC X.
  6160             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6161         16  FILLER                      PIC X(35).
  6162         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6163         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6164
  6165     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6166         16  AT-PROMPT-LINE-1            PIC X(60).
  6167         16  AT-PROMPT-LINE-2            PIC X(60).
  6168         16  AT-PROMPT-START-DT          PIC XX.
  6169         16  AT-PROMPT-END-DT            PIC XX.
  6170         16  FILLER                      PIC X(35).
  6171         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6172         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6173
  6174     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6175         16  AT-DENIAL-INFO-1            PIC X(60).
  6176         16  AT-DENIAL-INFO-2            PIC X(60).
  6177         16  AT-DENIAL-DT                PIC XX.
  6178         16  AT-RETRACTION-DT            PIC XX.
  6179         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6180*         16  FILLER                      PIC X(31).
  6181         16  AT-DENIAL-PROOF-DT          PIC XX.
  6182         16  FILLER                      PIC X(29).
  6183         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6184         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6185
  6186     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6187         16  AT-OLD-INCURRED-DT          PIC XX.
  6188         16  AT-OLD-REPORTED-DT          PIC XX.
  6189         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6190         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6191         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6192         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6193         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6194         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6195         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 117
* EL152.cbl
  6196         16  AT-OLD-DIAG-CODE            PIC X(6).
  6197         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6198         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6199         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6200         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6201         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6202         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6203         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6204         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6205         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6206         16  FILLER                      PIC X(9).
  6207         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6208
  6209     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6210         16  AT-FORM-SEND-ON-DT          PIC XX.
  6211         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6212         16  AT-FORM-RE-SEND-DT          PIC XX.
  6213         16  AT-FORM-ANSWERED-DT         PIC XX.
  6214         16  AT-FORM-PRINTED-DT          PIC XX.
  6215         16  AT-FORM-REPRINT-DT          PIC XX.
  6216         16  AT-FORM-TYPE                PIC X.
  6217             88  INITIAL-FORM                  VALUE '1'.
  6218             88  PROGRESS-FORM                 VALUE '2'.
  6219         16  AT-INSTRUCT-LN-1            PIC X(28).
  6220         16  AT-INSTRUCT-LN-2            PIC X(28).
  6221         16  AT-INSTRUCT-LN-3            PIC X(28).
  6222         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6223         16  AT-FORM-ADDRESS             PIC X.
  6224             88  FORM-TO-INSURED              VALUE 'I'.
  6225             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6226             88  FORM-TO-OTHER-1              VALUE 'O'.
  6227             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6228         16  AT-RELATED-1.
  6229             20 AT-REL-CARR-1            PIC X.
  6230             20 AT-REL-CLAIM-1           PIC X(7).
  6231             20 AT-REL-CERT-1            PIC X(11).
  6232         16  AT-RELATED-2.
  6233             20 AT-REL-CARR-2            PIC X.
  6234             20 AT-REL-CLAIM-2           PIC X(7).
  6235             20 AT-REL-CERT-2            PIC X(11).
  6236         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6237         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6238         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6239         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6240         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6241         16  AT-STOP-FORM-DT             PIC X(2).
  6242
  6243         16  FILLER                      PIC X(09).
  6244         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6245         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6246******************************************************************
  6247
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 118
* EL152.cbl
  6249*                                COPY ELCBENE.
  6250******************************************************************
  6251*                                                                *
  6252*                            ELCBENE.                            *
  6253*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6254*                            VMOD=2.006                          *
  6255*                                                                *
  6256*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6257*                                                                *
  6258*   FILE TYPE = VSAM,KSDS                                        *
  6259*   RECORD SIZE = 500   RECFORM = FIX                            *
  6260*                                                                *
  6261*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6262*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6263*                                                                *
  6264*   LOG = YES                                                    *
  6265*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6266*                                                                *
  6267*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6268******************************************************************
  6269
  6270 01  BENEFICIARY-MASTER.
  6271     12  BE-RECORD-ID                PIC XX.
  6272         88  VALID-BE-ID                VALUE 'BE'.
  6273
  6274     12  BE-CONTROL-PRIMARY.
  6275         16  BE-COMPANY-CD           PIC X.
  6276         16  BE-RECORD-TYPE          PIC X.
  6277             88  BENEFICIARY-RECORD  VALUE 'B'.
  6278             88  ADJUSTOR-RECORD     VALUE 'A'.
  6279         16  BE-BENEFICIARY          PIC X(10).
  6280     12  BE-CONTROL-BY-NAME.
  6281         16  BE-COMPANY-CD-A1        PIC X.
  6282         16  BE-RECORD-TYPE-A1       PIC X.
  6283         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6284         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6285
  6286     12  BE-LAST-MAINT-DT            PIC XX.
  6287     12  BE-LAST-MAINT-BY            PIC X(4).
  6288     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6289
  6290     12  BE-ADDRESS-DATA.
  6291         16  BE-MAIL-TO-NAME         PIC X(30).
  6292         16  BE-ADDRESS-LINE-1       PIC X(30).
  6293         16  BE-ADDRESS-LINE-2       PIC X(30).
  6294         16  BE-ADDRESS-LINE-3       PIC X(30).
  6295         16  BE-CITY-STATE.
  6296             20  BE-CITY             PIC X(28).
  6297             20  BE-STATE            PIC XX.
  6298         16  BE-ZIP-CODE.
  6299             20  BE-ZIP-PRIME.
  6300                 24  BE-ZIP-1ST      PIC X.
  6301                     88  BE-CANADIAN-POST-CODE
  6302                                         VALUE 'A' THRU 'Z'.
  6303                 24  FILLER          PIC X(4).
  6304             20  BE-ZIP-PLUS4        PIC X(4).
  6305         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6306             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 119
* EL152.cbl
  6307             20  BE-CAN-POSTAL-2     PIC XXX.
  6308             20  FILLER              PIC XXX.
  6309         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6310         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6311
  6312******************************************************************
  6313*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6314*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6315******************************************************************
  6316     12  BE-CARRIER                  PIC X.
  6317
  6318     12  BE-ADDRESS-DATA2.
  6319         16  BE-MAIL-TO-NAME2        PIC X(30).
  6320         16  BE-ADDRESS-LINE-12      PIC X(30).
  6321         16  BE-ADDRESS-LINE-22      PIC X(30).
  6322         16  BE-ADDRESS-LINE-32      PIC X(30).
  6323         16  BE-CITY-STATE2.
  6324             20  BE-CITY2            PIC X(28).
  6325             20  BE-STATE2           PIC XX.
  6326         16  BE-ZIP-CODE2.
  6327             20  BE-ZIP-PRIME2.
  6328                 24  BE-ZIP-1ST2     PIC X.
  6329                     88  BE-CANADIAN-POST-CODE2
  6330                                         VALUE 'A' THRU 'Z'.
  6331                 24  FILLER          PIC X(4).
  6332             20  BE-ZIP-PLUS42       PIC X(4).
  6333         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6334             20  BE-CAN-POSTAL-12    PIC XXX.
  6335             20  BE-CAN-POSTAL-22    PIC XXX.
  6336             20  FILLER              PIC XXX.
  6337         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6338         16  BE-BILLING-STMT-DATA.
  6339             20  BE-BSR              PIC X.
  6340                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6341                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6342             20  BE-BSR-FROM         PIC X(30).
  6343             20  BE-BSR-DEPT         PIC X(30).
  6344             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6345             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6346             20  BE-OUTPUT-TYPE      PIC X.
  6347                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6348                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6349
  6350     12  FILLER                      PIC X(28).
  6351******************************************************************
  6352
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 120
* EL152.cbl
  6354*                                COPY ERCCOMP.
  6355******************************************************************
  6356*                                                                *
  6357*                                                                *
  6358*                            ERCCOMP                             *
  6359*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6360*                            VMOD=2.019                          *
  6361*                                                                *
  6362*   ONLINE CREDIT SYSTEM                                         *
  6363*                                                                *
  6364*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6365*                                                                *
  6366*   FILE TYPE = VSAM,KSDS                                        *
  6367*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6368*                                                                *
  6369*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6370*       ALTERNATE PATH = NONE                                    *
  6371*                                                                *
  6372*   LOG = NO                                                     *
  6373*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6374*                                                                *
  6375******************************************************************
  6376*                   C H A N G E   L O G
  6377*
  6378* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6379*-----------------------------------------------------------------
  6380*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6381* EFFECTIVE    NUMBER
  6382*-----------------------------------------------------------------
  6383* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6384* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6385* 092205    2005050300006  PEMA  ADD LEASE FEE
  6386* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6387* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6388* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6389* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6390* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6391* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  6392******************************************************************
  6393
  6394 01  COMPENSATION-MASTER.
  6395     12  CO-RECORD-ID                          PIC XX.
  6396         88  VALID-CO-ID                          VALUE 'CO'.
  6397
  6398     12  CO-CONTROL-PRIMARY.
  6399         16  CO-COMPANY-CD                     PIC X.
  6400         16  CO-CONTROL.
  6401             20  CO-CTL-1.
  6402                 24  CO-CARR-GROUP.
  6403                     28  CO-CARRIER            PIC X.
  6404                     28  CO-GROUPING.
  6405                         32  CO-GROUP-PREFIX   PIC XXX.
  6406                         32  CO-GROUP-PRIME    PIC XXX.
  6407                 24  CO-RESP-NO.
  6408                     28  CO-RESP-PREFIX        PIC X(4).
  6409                     28  CO-RESP-PRIME         PIC X(6).
  6410             20  CO-CTL-2.
  6411                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 121
* EL152.cbl
  6412                     28  CO-ACCT-PREFIX        PIC X(4).
  6413                     28  CO-ACCT-PRIME         PIC X(6).
  6414         16  CO-TYPE                           PIC X.
  6415             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6416             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6417             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6418
  6419     12  CO-MAINT-INFORMATION.
  6420         16  CO-LAST-MAINT-DT                  PIC XX.
  6421         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6422         16  CO-LAST-MAINT-USER                PIC X(4).
  6423     12  FILLER                                PIC XX.
  6424     12  CO-STMT-TYPE                          PIC XXX.
  6425     12  CO-COMP-TYPE                          PIC X.
  6426         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6427     12  CO-STMT-OWNER                         PIC X(4).
  6428     12  CO-BALANCE-CONTROL                    PIC X.
  6429         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6430         88  CO-NO-BALANCE                        VALUE 'N'.
  6431
  6432     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6433         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6434         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6435         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6436
  6437     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6438         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6439         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6440
  6441     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6442     12  CO-GA-DIRECT-DEP                      PIC X.
  6443     12  CO-FUTURE-SPACE                       PIC X.
  6444         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6445
  6446     12  CO-ACCT-NAME                          PIC X(30).
  6447     12  CO-MAIL-NAME                          PIC X(30).
  6448     12  CO-ADDR-1                             PIC X(30).
  6449     12  CO-ADDR-2                             PIC X(30).
  6450     12  CO-ADDR-3.
  6451         16  CO-ADDR-CITY                      PIC X(27).
  6452         16  CO-ADDR-STATE                     PIC XX.
  6453     12  CO-CSO-1099                           PIC X.
  6454     12  CO-ZIP.
  6455         16  CO-ZIP-PRIME.
  6456             20  CO-ZIP-PRI-1ST                PIC X.
  6457                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6458             20  FILLER                        PIC X(4).
  6459         16  CO-ZIP-PLUS4                      PIC X(4).
  6460     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6461         16  CO-CAN-POSTAL-1                   PIC XXX.
  6462         16  CO-CAN-POSTAL-2                   PIC XXX.
  6463         16  FILLER                            PIC XXX.
  6464     12  CO-SOC-SEC                            PIC X(13).
  6465     12  CO-TELEPHONE.
  6466         16  CO-AREA-CODE                      PIC XXX.
  6467         16  CO-PREFIX                         PIC XXX.
  6468         16  CO-PHONE                          PIC X(4).
  6469
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 122
* EL152.cbl
  6470     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  6471
  6472     12  CO-AR-BAL-LEVEL                       PIC X.
  6473         88  CO-AR-REF-LVL                        VALUE '1'.
  6474         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6475         88  CO-AR-BILL-LVL                       VALUE '2'.
  6476         88  CO-AR-AGT-LVL                        VALUE '3'.
  6477         88  CO-AR-FR-LVL                         VALUE '4'.
  6478
  6479     12  CO-AR-NORMAL-PRINT                    PIC X.
  6480         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6481         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6482
  6483     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6484
  6485     12  CO-AR-REPORTING                       PIC X.
  6486         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6487         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6488
  6489     12  CO-AR-PULL-CHECK                      PIC X.
  6490         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6491         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6492
  6493     12  CO-AR-BALANCE-PRINT                   PIC X.
  6494         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6495
  6496     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6497         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6498         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6499         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6500
  6501     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6502
  6503     12  CO-USER-CODE                          PIC X.
  6504     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6505
  6506******************************************************************
  6507*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6508*    THE LAST MONTH END RUN.
  6509******************************************************************
  6510
  6511     12  CO-LAST-ACTIVITY-DATE.
  6512         16  CO-ACT-YEAR                       PIC 99.
  6513         16  CO-ACT-MONTH                      PIC 99.
  6514         16  CO-ACT-DAY                        PIC 99.
  6515
  6516     12  CO-LAST-STMT-DT.
  6517         16  CO-LAST-STMT-YEAR                 PIC 99.
  6518         16  CO-LAST-STMT-MONTH                PIC 99.
  6519         16  CO-LAST-STMT-DAY                  PIC 99.
  6520
  6521     12  CO-MO-END-TOTALS.
  6522         16  CO-MONTHLY-TOTALS.
  6523             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6524             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6525             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6526             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6527             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 123
* EL152.cbl
  6528
  6529         16  CO-AGING-TOTALS.
  6530             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6531             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6532             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6533             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6534
  6535         16  CO-YTD-TOTALS.
  6536             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6537             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6538
  6539         16  CO-OVER-UNDER-TOTALS.
  6540             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6541             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6542
  6543     12  CO-MISCELLANEOUS-TOTALS.
  6544         16  CO-FICA-TOTALS.
  6545             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6546             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6547
  6548         16  CO-CLAIM-TOTALS.
  6549             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6550             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6551
  6552******************************************************************
  6553*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6554*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6555******************************************************************
  6556
  6557     12  CO-CURRENT-TOTALS.
  6558         16  CO-CURRENT-LAST-STMT-DT.
  6559             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6560             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6561             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6562
  6563         16  CO-CURRENT-MONTHLY-TOTALS.
  6564             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6565             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6566             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6567             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6568             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6569
  6570         16  CO-CURRENT-AGING-TOTALS.
  6571             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6572             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6573             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6574             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6575
  6576         16  CO-CURRENT-YTD-TOTALS.
  6577             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6578             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6579
  6580     12  CO-PAID-COMM-TOTALS.
  6581         16  CO-YTD-PAID-COMMS.
  6582             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6583             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6584
  6585     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 124
* EL152.cbl
  6586         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  6587         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6588
  6589     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6590         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6591         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6592         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6593         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6594         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  6595         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  6596         88  CO-FINAL-LETTER                  VALUE 'F'.
  6597         88  CO-RECONCILING                   VALUE 'R'.
  6598         88  CO-PHONE-CALL                    VALUE 'P'.
  6599         88  CO-LEGAL                         VALUE 'L'.
  6600         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  6601         88  CO-WRITE-OFF                     VALUE 'W'.
  6602         88  CO-NO-ACTION                     VALUE 'N' ' '.
  6603
  6604     12  CO-CSR-CODE                       PIC X(4).
  6605
  6606     12  CO-GA-STATUS-INFO.
  6607         16  CO-GA-EFFECTIVE-DT            PIC XX.
  6608         16  CO-GA-TERMINATION-DT          PIC XX.
  6609         16  CO-GA-STATUS-CODE             PIC X.
  6610             88  CO-GA-ACTIVE                 VALUE 'A'.
  6611             88  CO-GA-INACTIVE               VALUE 'I'.
  6612             88  CO-GA-PENDING                VALUE 'P'.
  6613         16  CO-GA-COMMENTS.
  6614             20  CO-GA-COMMENT-1           PIC X(40).
  6615             20  CO-GA-COMMENT-2           PIC X(40).
  6616             20  CO-GA-COMMENT-3           PIC X(40).
  6617             20  CO-GA-COMMENT-4           PIC X(40).
  6618
  6619     12  CO-RPTCD2                         PIC X(10).
  6620     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  6621         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  6622         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  6623
  6624     12  CO-TYPE-AGENT                     PIC X(01).
  6625         88  CO-CORPORATION                   VALUE 'C'.
  6626         88  CO-PARTNERSHIP                   VALUE 'P'.
  6627         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  6628         88  CO-TRUST                         VALUE 'T'.
  6629         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  6630
  6631     12  CO-FAXNO.
  6632         16  CO-FAX-AREA-CODE                  PIC XXX.
  6633         16  CO-FAX-PREFIX                     PIC XXX.
  6634         16  CO-FAX-PHONE                      PIC X(4).
  6635
  6636     12  CO-BANK-INFORMATION.
  6637         16  CO-BANK-TRANSIT-NO                PIC X(8).
  6638         16  CO-BANK-TRANSIT-NON REDEFINES
  6639             CO-BANK-TRANSIT-NO                PIC 9(8).
  6640
  6641         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  6642     12  CO-MISC-DEDUCT-INFO REDEFINES
  6643                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 125
* EL152.cbl
  6644         16  CO-MD-GL-ACCT                     PIC X(10).
  6645         16  CO-MD-DIV                         PIC XX.
  6646         16  CO-MD-CENTER                      PIC X(4).
  6647         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  6648         16  CO-CREATE-AP-CHECK                PIC X.
  6649         16  CO-DELIVER-CK-TO-MEL              PIC X.
  6650         16  FILLER                            PIC XXX.
  6651     12  CO-ACH-STATUS                         PIC X.
  6652         88  CO-ACH-ACTIVE                         VALUE 'A'.
  6653         88  CO-ACH-PENDING                        VALUE 'P'.
  6654
  6655     12  CO-BILL-SW                            PIC X.
  6656     12  CO-CONTROL-NAME                       PIC X(30).
  6657     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  6658     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  6659     12  CO-CLP-STATE                          PIC XX.
  6660     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  6661     12  CO-SPP-REFUND-EDIT                    PIC X.
  6662
  6663******************************************************************
  6664
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 126
* EL152.cbl
  6666*                                COPY MPCPROD.
  6667*    EJECT
  6668*                                COPY MPCPLCY.
  6669*    EJECT
  6670*                                COPY MPCPLAN.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 127
* EL152.cbl
  6672*                                COPY ELCNAPS.
  6673******************************************************************
  6674*                                                                *
  6675*                            ELCNAPS                             *
  6676*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6677*                            VMOD=2.003                          *
  6678*                                                                *
  6679*        FILE DESCRIPTION = NAPERSOFT LETTER FILE                *
  6680*                                                                *
  6681*        FILE TYPE= VSAM,KSDS                                    *
  6682*        RECORD SIZE = 150    RECFORM = FIXED                    *
  6683*                                                                *
  6684*        BASE CLUSTER = ELNAPS        RKP=2,LEN=28               *
  6685*                                                                *
  6686*        LOG = YES                                               *
  6687*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6688*                                                                *
  6689******************************************************************
  6690*                   C H A N G E   L O G
  6691*
  6692* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6693*-----------------------------------------------------------------
  6694*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6695* EFFECTIVE    NUMBER
  6696*-----------------------------------------------------------------
  6697* 033110  CR2009122800001  AJRA  NEW FILE FOR NAPERSOFT.
  6698******************************************************************
  6699
  6700 01  NAPERSOFT-FILE.
  6701     12  NA-RECORD-ID                PIC  XX.
  6702         88  VALID-NA-ID                  VALUE 'NA'.
  6703
  6704     12  NA-CONTROL-PRIMARY.
  6705         16  NA-COMPANY-CD           PIC X.
  6706         16  NA-CARRIER              PIC X.
  6707         16  NA-CLAIM-NO             PIC X(7).
  6708         16  NA-CERT-NO.
  6709             20  NA-CERT-PRIME       PIC X(10).
  6710             20  NA-CERT-SFX         PIC X.
  6711         16  NA-ARCHIVE-NO           PIC 9(8).
  6712
  6713     12  NA-LETTER-INFORMATION.
  6714         16  NA-LETTER-ID            PIC X(4).
  6715         16  NA-PROCESSOR-ID         PIC X(4).
  6716         16  NA-CREATION-DT          PIC X(2).
  6717         16  NA-INITIAL-PRINT-DT     PIC X(2).
  6718         16  NA-FOLLOW-UP-DT         PIC X(2).
  6719         16  NA-RESEND-DT            PIC X(2).
  6720         16  NA-RESEND-LETTER-ID     PIC X(4).
  6721         16  NA-NO-OF-COPIES         PIC 9(2).
  6722         16  NA-ADDRESS-TYPE         PIC X(2).
  6723         16  NA-CORR-TRLR-SEQ        PIC 9(4).
  6724         16  NA-RESEND-PRINT-DT      PIC X(2).
  6725         16  NA-1ST-LTR-PRINT-DT     PIC X(2).
  6726         16  NA-NEXT-DUE-DT          PIC X(2).
  6727         16  NA-AUTOPYDT             PIC X(2).
  6728         16  NA-ENCLOSURE-CD         PIC X(3).
  6729         16  NA-CREATED-IN-NAPERSOFT PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 128
* EL152.cbl
  6730         16  NA-ORIG-ARCHIVE-NO      PIC 9(9).
  6731         16  NA-RESEND-PROMPT-IND    PIC X(1).
  6732         16  NA-ORIG-ENCLOSURE-CD    PIC X(3).
  6733         16  FILLER                  PIC X(67).
  6734******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 129
* EL152.cbl
  6736*                                COPY ELCENCC.
  6737******************************************************************
  6738*                                                                *
  6739*                                                                *
  6740*                            ELCENCC                             *
  6741*                            VMOD=2.001                          *
  6742*                                                                *
  6743*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  6744*                                                                *
  6745*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  6746*   A NAPERSOFT DOCUMENT                                         *
  6747*                                                                *
  6748*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  6749*                                                                *
  6750*   FILE TYPE = VSAM,KSDS                                        *
  6751*   RECORD SIZE = 400   RECFORM = FIX                            *
  6752*                                                                *
  6753*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  6754*                                                                *
  6755*   LOG = NO                                                     *
  6756*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6757*                                                                *
  6758*                                                                *
  6759******************************************************************
  6760*                   C H A N G E   L O G
  6761*
  6762* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6763*-----------------------------------------------------------------
  6764*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6765* EFFECTIVE    NUMBER
  6766*-----------------------------------------------------------------
  6767* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  6768******************************************************************
  6769 01  ENCLOSURE-CODES.
  6770     12  NC-RECORD-ID                      PIC XX.
  6771         88  VALID-NC-ID                      VALUE 'NC'.
  6772     12  NC-CONTROL-PRIMARY.
  6773         16  NC-COMPANY-CD                 PIC X.
  6774         16  NC-REC-TYPE                   PIC X.
  6775             88  NC-CLAIMS                   VALUE '1'.
  6776             88  NC-ADMIN                    VALUE '2'.
  6777         16  NC-ENC-CODE                   PIC X(5).
  6778         16  FILLER                        PIC X(09).
  6779     12  NC-MAINT-INFORMATION.
  6780         16  NC-LAST-MAINT-DT              PIC XX.
  6781         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6782         16  NC-LAST-MAINT-USER            PIC X(4).
  6783         16  FILLER                        PIC XX.
  6784     12  NC-OUTPUT-STACK                   PIC XXX.
  6785     12  NC-ENCLOSURE-LINE                 PIC X(100).
  6786     12  NC-ATTACHMENTS                    PIC X(100).
  6787     12  NC-FUTURE                         PIC X(50).
  6788     12  FILLER                            PIC X(117).
  6789******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 130
* EL152.cbl
  6791*  THE SYSTEM-VARIABLES  FIELD LENGTH MUST MATCH THE LENGTH OF
  6792*  THE SS-WORK-AREA-LENGTH FIELD FOR THE VARIABLE-WORK-AREA
  6793
  6794*01  SYSTEM-VARIABLES            PIC X(3851).
  6795*01  SYS-VAR-ENTRY REDEFINES SYSTEM-VARIABLES.
  6796*    12  SYS-VAR-CODE            PIC X(4).
  6797*    12  SYS-VAR-LEN             PIC 99.
  6798*    12  SYS-VAR-DATA            PIC X(100).
  6799
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 131
* EL152.cbl
  6801 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CLAIM-MASTER
  6802                          CONTROL-FILE LETTER-ARCHIVE
  6803                          LETTER-ARCHIVE-TEMP
  6804                          CERTIFICATE-MASTER ACCOUNT-MASTER
  6805                          TEXT-FILES ACTIVITY-TRAILERS
  6806                          BENEFICIARY-MASTER
  6807                          COMPENSATION-MASTER NAPERSOFT-FILE
  6808                          ENCLOSURE-CODES.
  6809 0000-DFHEXIT SECTION.
  6810     MOVE '9#                    $   ' TO DFHEIV0.
  6811     MOVE 'EL152' TO DFHEIV1.
  6812     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6813
  6814     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  6815     MOVE '5'                   TO DC-OPTION-CODE.
  6816     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  6817     MOVE DC-GREG-DATE-1-EDIT   TO SAVE-DATE.
  6818     MOVE DC-BIN-DATE-1         TO SAVE-BIN-DATE.
  6819
  6820     MOVE DFHCOMMAREA           TO PROGRAM-INTERFACE-BLOCK.
  6821     MOVE 1                     TO EMI-NUMBER-OF-LINES.
  6822     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  6823                                TO EMI-SAVE-AREA.
  6824
  6825     MOVE EIBTRMID              TO TS-TERM-TEXT
  6826                                   TS-TERM-SCREEN
  6827                                   QID-TERM.
  6828
  6829     MOVE SAVE-BIN-DATE       TO CURRENT-SAVE.
  6830
  6831*    IF PI-COMPANY-ID = 'DMD'
  6832*       MOVE CURRENT-SAVE           TO DC-BIN-DATE-1
  6833*       MOVE '6'                    TO DC-OPTION-CODE
  6834*       MOVE +3                     TO DC-ELAPSED-MONTHS
  6835*       MOVE +0                     TO DC-ELAPSED-DAYS
  6836*       PERFORM 9700-DATE-LINK THRU 9700-EXIT
  6837*       MOVE DC-BIN-DATE-2          TO CURRENT-PLUS3-SAVE.
  6838
  6839
  6840* EXEC CICS HANDLE CONDITION
  6841*        PGMIDERR (9600-PGMID-ERROR)
  6842*        MAPFAIL  (0325-MAPFAIL)
  6843*        ERROR    (9990-ABEND)
  6844*    END-EXEC.
  6845*    MOVE '"$L?.                 ! " #00006835' TO DFHEIV0
  6846     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  6847     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6848     MOVE X'2220233030303036383335' TO DFHEIV0(25:11)
  6849     CALL 'kxdfhei1' USING DFHEIV0
  6850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6851
  6852
  6853     IF PI-PROCESSOR-ID NOT = 'LGXX'
  6854
  6855* EXEC CICS READQ TS
  6856*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6857*            INTO    (SECURITY-CONTROL)
  6858*            LENGTH  (SC-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 132
* EL152.cbl
  6859*            ITEM    (SC-ITEM)
  6860*        END-EXEC
  6861*    MOVE '*$II   L              ''   #00006842' TO DFHEIV0
  6862     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6863     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6864     MOVE X'2020233030303036383432' TO DFHEIV0(25:11)
  6865     CALL 'kxdfhei1' USING DFHEIV0,
  6866           PI-SECURITY-TEMP-STORE-ID,
  6867           SECURITY-CONTROL,
  6868           SC-COMM-LENGTH,
  6869           SC-ITEM,
  6870           DFHEIV99,
  6871           DFHEIV99
  6872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6873         MOVE SC-CLAIMS-DISPLAY (7)  TO  PI-DISPLAY-CAP
  6874         MOVE SC-CLAIMS-UPDATE  (7)  TO  PI-MODIFY-CAP.
  6875
  6876     set P to address of KIXSYS
  6877     CALL "getenv" using by value P returning var-ptr
  6878     if var-ptr = null then
  6879        display ' kixsys not set '
  6880     else
  6881        set address of var to var-ptr
  6882        move 0 to env-var-len
  6883        inspect var tallying env-var-len
  6884          for characters before X'00'
  6885        unstring var (1:env-var-len) delimited by '/'
  6886           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6887              WS-KIX-SYS
  6888        end-unstring
  6889     end-if
  6890     IF EIBCALEN = 0
  6891         GO TO 8800-UNAUTHORIZED-ACCESS.
  6892
  6893     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6894         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6895             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6896             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  6897             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6898             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6899             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6900             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6901             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6902             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  6903             PERFORM 7750-DELETE-TEMP-STOR         THRU 7750-EXIT
  6904             PERFORM 7760-DELETE-TEMP-STOR-SCREEN  THRU 7760-EXIT
  6905             PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT
  6906             MOVE SPACES              TO PI-WA
  6907                                         PI-FORCE-7840
  6908             MOVE ZEROS               TO PI-TOTAL-LINES
  6909                                         PI-CURRENT-LINE
  6910                                         PI-TEMP-STOR-ITEMS
  6911                                         PI-UPDATE-SW
  6912                                         PI-ADDR-SEQ
  6913             MOVE '2'                 TO PI-ACTION
  6914             MOVE LOW-VALUES          TO EL152AO
  6915                                         PI-ADDR-TYPE
  6916             GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 133
* EL152.cbl
  6917         ELSE
  6918             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  6919             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  6920             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  6921             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  6922             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  6923             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  6924             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  6925             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  6926             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  6927             PERFORM 7500-READ-TS           THRU 7599-EXIT
  6928             PERFORM 7600-READ-SCREEN-TS    THRU 7699-EXIT
  6929             IF PGM-NAME = PGM-EL141
  6930                PERFORM 500-RECOVER-PI-TEMP-STORAGE THRU 599-EXIT
  6931                SET TB-INDX TO PI-CURRENT-LINE
  6932                PERFORM 400-SET-CODES       THRU 499-EXIT
  6933                PERFORM 7000-READ-ADDR      THRU 7099-EXIT
  6934                PERFORM 7170-FORMAT-SCREEN  THRU 7170-EXIT
  6935                        VARYING SC-INDX FROM 1 BY 1 UNTIL
  6936                        SC-INDX > NUM-LINES-PER-SCREEN
  6937                MOVE PI-ALT-PRINTER-ID  TO PRINTERO
  6938                MOVE AL-UANON           TO PRINTERA
  6939                GO TO 8100-SEND-INITIAL-MAP
  6940             ELSE
  6941                SET TB-INDX TO PI-CURRENT-LINE
  6942                PERFORM 7170-FORMAT-SCREEN   THRU  7170-EXIT
  6943                        VARYING SC-INDX FROM 1 BY 1 UNTIL
  6944                        SC-INDX > NUM-LINES-PER-SCREEN
  6945                MOVE PI-ALT-PRINTER-ID  TO PRINTERO
  6946                MOVE AL-UANON           TO PRINTERA
  6947                GO TO 8100-SEND-INITIAL-MAP.
  6948
  6949*0100-PA.
  6950*    MOVE ER-0008                TO EMI-ERROR.
  6951*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6952*    MOVE -1                     TO MAINTL.
  6953*    GO TO 8200-SEND-DATAONLY.
  6954
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 134
* EL152.cbl
  6956 0200-RECEIVE.
  6957     MOVE TRANS-ID         TO EIBTRNID.
  6958     MOVE EMI-SAVE-AREA    TO ERROR-MESSAGE-INTERFACE-BLOCK.
  6959     MOVE LOW-VALUES       TO EL152AI.
  6960     MOVE '104A'           TO TS-ID-TEXT.
  6961     MOVE EIBTRMID         TO TS-TERM-TEXT
  6962                              TS-TERM-SCREEN
  6963                              QID-TERM.
  6964
  6965
  6966* EXEC CICS HANDLE AID
  6967*        CLEAR    (9400-CLEAR)
  6968*        PA1      (0100-PA)
  6969*        PA2      (0100-PA)
  6970*        PA3      (0100-PA)
  6971*    END-EXEC.
  6972*    MOVE '"&=!"#               V! # #00006940' TO DFHEIV0
  6973     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  6974     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  6975     MOVE X'2320233030303036393430' TO DFHEIV0(25:11)
  6976     CALL 'kxdfhei1' USING DFHEIV0
  6977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6978
  6979
  6980
  6981* EXEC CICS HANDLE CONDITION
  6982*        MAPFAIL  (0325-MAPFAIL)
  6983*    END-EXEC.
  6984*    MOVE '"$?                   ! $ #00006947' TO DFHEIV0
  6985     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  6986     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6987     MOVE X'2420233030303036393437' TO DFHEIV0(25:11)
  6988     CALL 'kxdfhei1' USING DFHEIV0
  6989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6990
  6991
  6992
  6993* EXEC CICS SYNCPOINT
  6994*    END-EXEC.
  6995*    MOVE '6"                    !   #00006951' TO DFHEIV0
  6996     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  6997     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6998     MOVE X'2020233030303036393531' TO DFHEIV0(25:11)
  6999     CALL 'kxdfhei1' USING DFHEIV0
  7000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7001
  7002
  7003     IF LOWER-CASE-LETTERS-USED
  7004
  7005* EXEC CICS RECEIVE
  7006*            MAP      (MAP-NAME)
  7007*            MAPSET   (MAPSET-NAME)
  7008*            INTO     (EL152AI)
  7009*            ASIS
  7010*       END-EXEC
  7011     MOVE LENGTH OF
  7012      EL152AI
  7013       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 135
* EL152.cbl
  7014*    MOVE '8"TAI  L              ''   #00006955' TO DFHEIV0
  7015     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  7016     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7017     MOVE X'2020233030303036393535' TO DFHEIV0(25:11)
  7018     CALL 'kxdfhei1' USING DFHEIV0,
  7019           MAP-NAME,
  7020           EL152AI,
  7021           DFHEIV11,
  7022           MAPSET-NAME,
  7023           DFHEIV99,
  7024           DFHEIV99
  7025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7026      ELSE
  7027
  7028* EXEC CICS RECEIVE
  7029*            MAP      (MAP-NAME)
  7030*            MAPSET   (MAPSET-NAME)
  7031*            INTO     (EL152AI)
  7032*       END-EXEC.
  7033     MOVE LENGTH OF
  7034      EL152AI
  7035       TO DFHEIV11
  7036*    MOVE '8"T I  L              ''   #00006962' TO DFHEIV0
  7037     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7038     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7039     MOVE X'2020233030303036393632' TO DFHEIV0(25:11)
  7040     CALL 'kxdfhei1' USING DFHEIV0,
  7041           MAP-NAME,
  7042           EL152AI,
  7043           DFHEIV11,
  7044           MAPSET-NAME,
  7045           DFHEIV99,
  7046           DFHEIV99
  7047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7048
  7049
  7050     IF NOT DISPLAY-CAP AND PI-PROCESSOR-ID NOT = 'LGXX'
  7051         MOVE 'READ'             TO  SM-READ
  7052         PERFORM 9995-SECURITY-VIOLATION
  7053         MOVE ER-0070            TO  EMI-ERROR
  7054         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7055         GO TO 8100-SEND-INITIAL-MAP.
  7056
  7057     INSPECT MAINTI CONVERTING LOWER-CASE TO UPPER-CASE.
  7058     MOVE 'N'                    TO CLEANI
  7059
  7060     IF ENTERPFL = 0
  7061         GO TO 0300-CHECK-PFKEYS.
  7062     IF EIBAID NOT = DFHENTER
  7063         MOVE ER-0004            TO EMI-ERROR
  7064         GO TO 0320-INPUT-ERROR.
  7065     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  7066         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7067     ELSE
  7068         MOVE ER-0029            TO EMI-ERROR
  7069         GO TO 0320-INPUT-ERROR.
  7070
  7071 0300-CHECK-PFKEYS.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 136
* EL152.cbl
  7072     IF EIBAID = DFHPF23
  7073         GO TO 8810-PF23.
  7074     IF EIBAID = DFHPF24
  7075         GO TO 9200-RETURN-MAIN-MENU.
  7076*    IF EIBAID = DFHPF12
  7077*        GO TO 9500-PF12.
  7078     IF EIBAID = DFHPF1
  7079         MOVE 7                  TO ROLL-COUNTER
  7080         GO TO 7900-ROLL-PAGE.
  7081     IF EIBAID = DFHPF2
  7082         MOVE -7                 TO ROLL-COUNTER
  7083         GO TO 7900-ROLL-PAGE.
  7084     IF EIBAID = DFHPF3
  7085         GO TO 6100-ADDR-MAINT.
  7086     IF EIBAID = DFHPF4
  7087         IF MODIFY-CAP
  7088             GO TO 6200-EDIT-MODE
  7089         ELSE
  7090             MOVE 'UPDATE'       TO  SM-READ
  7091             PERFORM 9995-SECURITY-VIOLATION
  7092             MOVE ER-0070        TO  EMI-ERROR
  7093             GO TO 0320-INPUT-ERROR.
  7094
  7095     IF EIBAID = DFHPF5
  7096         GO TO 0330-FUNCTION-CHECK.
  7097
  7098     IF EIBAID = DFHPF6
  7099         GO TO 0330-FUNCTION-CHECK.
  7100
  7101     IF EIBAID = DFHPF7
  7102        COMPUTE ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  7103        GO TO 7900-ROLL-PAGE.
  7104
  7105     IF EIBAID = DFHPF8
  7106        MOVE PI-TOTAL-LINES TO ROLL-COUNTER
  7107        GO TO 7900-ROLL-PAGE.
  7108
  7109*    IF EIBAID = DFHPF9 AND
  7110*       PI-COMPANY-ID = 'DMD'
  7111*        MOVE '1'           TO PI-FORCE-7840
  7112*        GO TO 0330-FUNCTION-CHECK.
  7113
  7114     IF EIBAID = DFHENTER
  7115         GO TO 0330-FUNCTION-CHECK.
  7116
  7117     PERFORM 7500-READ-TS        THRU 7599-EXIT
  7118
  7119     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  7120     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  7121             VARYING SC-INDX FROM 1 BY 1
  7122             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  7123
  7124     MOVE ER-0029                TO EMI-ERROR.
  7125 0320-INPUT-ERROR.
  7126     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7127     MOVE AL-UNBON               TO ENTERPFA.
  7128     IF ENTERPFL = 0
  7129         MOVE -1                 TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 137
* EL152.cbl
  7130     ELSE
  7131         MOVE -1                 TO ENTERPFL.
  7132
  7133     GO TO 8200-SEND-DATAONLY.
  7134
  7135 0100-PA.
  7136     MOVE ER-0008                TO EMI-ERROR.
  7137     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7138     MOVE -1                     TO MAINTL.
  7139     GO TO 8200-SEND-DATAONLY.
  7140
  7141 0325-MAPFAIL.
  7142***********************************************************
  7143*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  7144*      LETTERS ON A 3275 PRINTER.                         *
  7145***********************************************************
  7146
  7147     PERFORM 7600-READ-SCREEN-TS    THRU 7699-EXIT.
  7148
  7149     SET TB-INDX         TO PI-CURRENT-LINE.
  7150     PERFORM 7170-FORMAT-SCREEN   THRU  7170-EXIT
  7151                  VARYING SC-INDX FROM 1 BY 1 UNTIL
  7152                  SC-INDX > NUM-LINES-PER-SCREEN.
  7153
  7154     GO TO 8100-SEND-INITIAL-MAP.
  7155
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 138
* EL152.cbl
  7157 0330-FUNCTION-CHECK.
  7158     IF NOT MODIFY-CAP
  7159         IF MAINTI = 'S'
  7160             NEXT SENTENCE
  7161         ELSE
  7162             MOVE 'UPDATE'           TO  SM-READ
  7163             PERFORM 9995-SECURITY-VIOLATION
  7164             MOVE ER-0070            TO  EMI-ERROR
  7165             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7166             GO TO 8100-SEND-INITIAL-MAP.
  7167
  7168     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  7169
  7170     IF EIBAID = DFHPF5
  7171      IF PI-PROMPT-LETTER = 'Y'
  7172         MOVE ER-0894            TO EMI-ERROR
  7173         MOVE -1             TO MAINTL
  7174         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7175         MOVE AL-UABON       TO MAINTA
  7176         GO TO 8200-SEND-DATAONLY
  7177      ELSE
  7178         IF MAINTI NOT = 'C'
  7179             MOVE ER-0716        TO EMI-ERROR
  7180             MOVE -1             TO MAINTL
  7181             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7182             MOVE AL-UABON       TO MAINTA
  7183             GO TO 8200-SEND-DATAONLY
  7184         ELSE
  7185             IF MODIFY-CAP
  7186                 GO TO 6400-LETTER-RELEASE
  7187             ELSE
  7188                 IF PRINT-PERFORMED
  7189                     GO TO 6400-LETTER-RELEASE
  7190                 ELSE
  7191                     MOVE AL-UNBON TO ENTERPFA
  7192                     MOVE -1       TO ENTERPFL
  7193                     MOVE ER-2398 TO EMI-ERROR
  7194                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7195                     GO TO 8200-SEND-DATAONLY.
  7196
  7197     IF EIBAID = DFHPF6
  7198      IF PI-PROMPT-LETTER = 'Y'
  7199         MOVE ER-0894            TO EMI-ERROR
  7200         MOVE -1             TO MAINTL
  7201         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7202         MOVE AL-UABON       TO MAINTA
  7203         GO TO 8200-SEND-DATAONLY
  7204      ELSE
  7205         GO TO 7800-PRINT-LETTER-NOW.
  7206
  7207     IF MAINTI = 'S'
  7208         GO TO 1000-SHOW.
  7209
  7210     IF MAINTI = 'C'
  7211         GO TO 2000-CREATE.
  7212
  7213     IF MAINTI = 'R'
  7214        IF NOT MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 139
* EL152.cbl
  7215           MOVE ER-0070          TO EMI-ERROR
  7216           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7217           MOVE LOW-VALUES       TO EL152AO
  7218           GO TO 8100-SEND-INITIAL-MAP
  7219          ELSE
  7220           GO TO 3000-RECORD.
  7221
  7222     PERFORM 7500-READ-TS        THRU 7599-EXIT
  7223     PERFORM 7950-SET-INDX       THRU 7950-EXIT
  7224     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN
  7225                                 THRU 7960-EXIT
  7226        VARYING SC-INDX FROM 1 BY 1 UNTIL
  7227        SC-INDX > NUM-LINES-PER-SCREEN
  7228     MOVE ER-0023                TO EMI-ERROR.
  7229     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7230     MOVE -1                     TO MAINTL.
  7231     MOVE AL-UABON               TO MAINTA.
  7232     GO TO 8200-SEND-DATAONLY.
  7233
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 140
* EL152.cbl
  7235 0350-EDIT-ROUTINE.
  7236     PERFORM 400-SET-CODES THRU 499-EXIT.
  7237     MOVE PI-CLAIM-NO    TO CLAM-CLAIM
  7238                            ACTV-CLAIM.
  7239
  7240     IF ADDRL NOT = +0
  7241        INSPECT ADDRI CONVERTING LOWER-CASE TO UPPER-CASE
  7242        MOVE ADDRI           TO WS-ADDR-TYPE-CD
  7243        IF WS-ADDR-TYPE = 'I' OR 'B' OR 'A' OR 'P' OR
  7244                          'O' OR 'Q' OR 'E'
  7245           MOVE AL-UANON         TO ADDRA
  7246        ELSE
  7247           MOVE -1               TO ADDRL
  7248           MOVE AL-UABON         TO ADDRA
  7249           MOVE ER-0176          TO EMI-ERROR
  7250           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7251*     ELSE
  7252*       IF PI-COMPANY-ID = 'DMD'
  7253*        IF MAINTI = 'C' OR 'R'
  7254*          MOVE -1               TO ADDRL
  7255*          MOVE AL-UABON         TO ADDRA
  7256*          MOVE ER-0861          TO EMI-ERROR
  7257*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7258
  7259     IF ADDRL NOT = +0
  7260        IF WS-ADDR-SEQ NOT NUMERIC
  7261           MOVE -1               TO ADDRL
  7262           MOVE AL-UABON         TO ADDRA
  7263           MOVE ER-0176          TO EMI-ERROR
  7264           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7265
  7266*    IF ADDRL NOT = +0
  7267*       IF PI-COMPANY-ID = 'DMD'
  7268*          IF WS-ADDR-TYPE = 'B' AND
  7269*             WS-ADDR-SEQ NOT = '9'
  7270*                MOVE -1               TO ADDRL
  7271*                MOVE AL-UABON         TO ADDRA
  7272*                MOVE ER-7842          TO EMI-ERROR
  7273*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7274
  7275     IF FORML NOT = ZEROS
  7276        INSPECT FORMI CONVERTING LOWER-CASE TO UPPER-CASE.
  7277
  7278     IF MAINTI = 'C' AND FORML = ZEROS
  7279        MOVE -1                  TO FORML
  7280        MOVE ER-0177             TO EMI-ERROR
  7281        MOVE AL-UABON            TO FORMA
  7282        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7283
  7284     IF FOLLOWL NOT = ZEROS
  7285        MOVE FOLLOWI             TO DEEDIT-FIELD
  7286        PERFORM 8600-DEEDIT
  7287        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7288        MOVE '4'                 TO DC-OPTION-CODE
  7289        PERFORM 9700-DATE-LINK  THRU  9700-EXIT
  7290        IF DATE-CONVERSION-ERROR
  7291           MOVE ER-0182          TO EMI-ERROR
  7292           MOVE -1               TO FOLLOWL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 141
* EL152.cbl
  7293           MOVE AL-UABON         TO FOLLOWA
  7294           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7295        ELSE
  7296*          IF (PI-COMPANY-ID = 'DMD') AND
  7297*             (NOT FORCE-7840)        AND
  7298*             (DC-BIN-DATE-1 > CURRENT-PLUS3-SAVE)
  7299*              MOVE 'PF9=FORCE 7840' TO PFKEY9O
  7300*              MOVE AL-SABON         TO PFKEY9A
  7301*              MOVE ER-7840          TO EMI-ERROR
  7302*              MOVE -1               TO FOLLOWL
  7303*              MOVE AL-UABON         TO FOLLOWA
  7304*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7305*          ELSE
  7306             MOVE SPACES                TO PFKEY9O
  7307             MOVE AL-SADON              TO PFKEY9A
  7308             MOVE DC-GREG-DATE-1-EDIT   TO FOLLOWO
  7309             MOVE AL-UANON              TO FOLLOWA
  7310             MOVE DC-BIN-DATE-1         TO FOLLOW-UP-SAVE
  7311     ELSE
  7312        MOVE LOW-VALUES                 TO FOLLOW-UP-SAVE.
  7313
  7314     IF FOLLOW-UP-SAVE NOT = LOW-VALUES
  7315        IF FOLLOW-UP-SAVE NOT > CURRENT-SAVE
  7316           MOVE ER-0533          TO EMI-ERROR
  7317           MOVE AL-UABON         TO FOLLOWA
  7318           MOVE -1               TO FOLLOWL
  7319           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7320
  7321     IF RESENDL NOT = ZEROS
  7322        MOVE RESENDI             TO DEEDIT-FIELD
  7323        PERFORM 8600-DEEDIT
  7324        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7325        MOVE '4'                 TO DC-OPTION-CODE
  7326        PERFORM 9700-DATE-LINK  THRU  9700-EXIT
  7327        IF DATE-CONVERSION-ERROR
  7328           MOVE ER-0185          TO EMI-ERROR
  7329           MOVE -1               TO RESENDL
  7330           MOVE AL-UABON         TO RESENDA
  7331           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7332         ELSE
  7333*          IF (PI-COMPANY-ID = 'DMD') AND
  7334*             (NOT FORCE-7840)        AND
  7335*             (DC-BIN-DATE-1 > CURRENT-PLUS3-SAVE)
  7336*              MOVE 'PF9=FORCE 7840' TO PFKEY9O
  7337*              MOVE AL-SABON         TO PFKEY9A
  7338*              MOVE ER-7840          TO EMI-ERROR
  7339*              MOVE -1               TO RESENDL
  7340*              MOVE AL-UABON         TO RESENDA
  7341*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7342*          ELSE
  7343             MOVE SPACES                 TO PFKEY9O
  7344             MOVE AL-SADON               TO PFKEY9A
  7345             MOVE DC-GREG-DATE-1-EDIT    TO RESENDO
  7346             MOVE AL-UANON               TO RESENDA
  7347             MOVE DC-BIN-DATE-1          TO RESEND-SAVE
  7348     ELSE
  7349        MOVE LOW-VALUE                   TO RESEND-SAVE.
  7350
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 142
* EL152.cbl
  7351     IF RESEND-SAVE NOT = LOW-VALUES
  7352        IF RESEND-SAVE NOT > CURRENT-SAVE
  7353           MOVE ER-0537          TO EMI-ERROR
  7354           MOVE AL-UABON         TO RESENDA
  7355           MOVE -1               TO RESENDL
  7356           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7357
  7358     IF PRINTL NOT = ZEROS
  7359        INSPECT PRINTI CONVERTING LOWER-CASE TO UPPER-CASE
  7360        IF PRINTI = 'Y' OR = ' '
  7361           MOVE AL-UANON         TO PRINTA
  7362        ELSE
  7363           MOVE ER-0183          TO EMI-ERROR
  7364           MOVE -1               TO PRINTL
  7365           MOVE AL-UABON         TO PRINTA
  7366           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7367
  7368     MOVE 'Y'                    TO CLEANO
  7369     IF ENCL <= ZEROS
  7370        MOVE 'N'                 TO CLEANO
  7371     END-IF
  7372     IF ENCL > ZEROS
  7373        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  7374                                          PI-ENCLOSURE-CD
  7375        MOVE SPACES             TO ELENCC-KEY
  7376        MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  7377        MOVE '1'                TO ELENCC-REC-TYPE
  7378        MOVE ENCI               TO ELENCC-ENC-CODE
  7379
  7380
  7381* EXEC CICS READ
  7382*           DATASET    (ENCC-ID)
  7383*           SET        (ADDRESS OF ENCLOSURE-CODES)
  7384*           RIDFLD     (ELENCC-KEY)
  7385*           RESP       (WS-RESPONSE)
  7386*       END-EXEC
  7387*    MOVE '&"S        E          (  N#00007298' TO DFHEIV0
  7388     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7389     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7390     MOVE X'204E233030303037323938' TO DFHEIV0(25:11)
  7391     CALL 'kxdfhei1' USING DFHEIV0,
  7392           ENCC-ID,
  7393           DFHEIV20,
  7394           DFHEIV99,
  7395           ELENCC-KEY,
  7396           DFHEIV99,
  7397           DFHEIV99,
  7398           DFHEIV99
  7399     SET ADDRESS OF ENCLOSURE-CODES TO
  7400         DFHEIV20
  7401     MOVE EIBRESP  TO WS-RESPONSE
  7402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7403
  7404        IF RESP-NORMAL
  7405           MOVE ENCI             TO PI-ENCLOSURE-CD
  7406                                    W-ENCLOSURE-CD
  7407           MOVE AL-UANON         TO ENCA
  7408        ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 143
* EL152.cbl
  7409           MOVE 'N'              TO CLEANO
  7410           MOVE ER-1560          TO EMI-ERROR
  7411           MOVE -1               TO ENCL
  7412           MOVE AL-UABON         TO ENCA
  7413           PERFORM 9900-ERROR-FORMAT
  7414                                 THRU 9900-EXIT
  7415        END-IF
  7416     END-IF
  7417     IF COPIESL NOT = ZEROS
  7418        IF COPIESI NOT NUMERIC OR
  7419           COPIESI = '0'
  7420           MOVE ER-0184          TO EMI-ERROR
  7421           MOVE -1               TO COPIESL
  7422           MOVE AL-UABON         TO COPIESA
  7423           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7424        ELSE
  7425           MOVE AL-UANON         TO COPIESA.
  7426
  7427     IF PI-PROCESSOR-PRINTER NOT = SPACES
  7428         MOVE PI-PROCESSOR-PRINTER   TO  PI-ALT-PRINTER-ID.
  7429
  7430     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  7431
  7432     IF PRINTERL > ZERO
  7433        INSPECT PRINTERI CONVERTING LOWER-CASE TO UPPER-CASE
  7434        MOVE AL-UANON            TO PRINTERA
  7435        MOVE PRINTERI            TO PI-ALT-PRINTER-ID
  7436                                    PI-ALT-DMD-PRT-ID
  7437     ELSE
  7438        IF (PI-NO-CARRIER-SECURITY AND
  7439            PI-NO-ACCOUNT-SECURITY) OR
  7440            PI-PROCESSOR-PRINTER NOT = SPACES
  7441             NEXT SENTENCE
  7442        ELSE
  7443            MOVE AL-UABON       TO PRINTERA
  7444            MOVE -1             TO PRINTERL
  7445            MOVE ER-2397        TO EMI-ERROR
  7446            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7447
  7448     IF ACTL NOT = +0
  7449         MOVE ZEROS              TO W-ACCOUNT
  7450         IF ACTI > SPACES
  7451             IF ACTI NUMERIC
  7452                     AND
  7453                ACTI NOT < 1
  7454                     AND
  7455                ACTI NOT > 9
  7456                 MOVE AL-UANON   TO ACTA
  7457                 MOVE ACTI       TO W-ACCOUNT
  7458                                    W-LETTER-ADDR-SEQ
  7459                 MOVE 'A'        TO W-LETTER-ADDR-TYPE
  7460             ELSE
  7461                 MOVE -1         TO ACTL
  7462                 MOVE AL-UABON   TO ACTA
  7463                 MOVE ER-3547    TO EMI-ERROR
  7464                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7465
  7466     IF BENL NOT = +0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 144
* EL152.cbl
  7467         MOVE ZEROS              TO W-BENEFICIARY
  7468         IF BENI > SPACES
  7469             IF BENI NUMERIC
  7470                     AND
  7471                BENI NOT < 1
  7472                     AND
  7473                BENI NOT > 9
  7474                 MOVE AL-UANON   TO BENA
  7475                 MOVE BENI       TO W-BENEFICIARY
  7476                                    W-LETTER-ADDR-SEQ
  7477                 MOVE 'B'        TO W-LETTER-ADDR-TYPE
  7478             ELSE
  7479                 MOVE -1         TO BENL
  7480                 MOVE AL-UABON   TO BENA
  7481                 MOVE ER-3547    TO EMI-ERROR
  7482                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7483
  7484     IF EMPL NOT = +0
  7485         MOVE ZEROS              TO W-EMPLOYER
  7486         IF EMPI > SPACES
  7487             IF EMPI NUMERIC
  7488                     AND
  7489                EMPI NOT < 1
  7490                     AND
  7491                EMPI NOT > 9
  7492                 MOVE AL-UANON   TO EMPA
  7493                 MOVE EMPI       TO W-EMPLOYER
  7494                                    W-LETTER-ADDR-SEQ
  7495                 MOVE 'E'        TO W-LETTER-ADDR-TYPE
  7496             ELSE
  7497                 MOVE -1         TO EMPL
  7498                 MOVE AL-UABON   TO EMPA
  7499                 MOVE ER-3547    TO EMI-ERROR
  7500                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7501
  7502     IF INSL NOT = +0
  7503         MOVE ZEROS              TO W-INSURED
  7504         IF INSI > SPACES
  7505             IF INSI NUMERIC
  7506                     AND
  7507                INSI NOT < 1
  7508                     AND
  7509                INSI NOT > 9
  7510                 MOVE AL-UANON   TO INSA
  7511                 MOVE INSI       TO W-INSURED
  7512                                    W-LETTER-ADDR-SEQ
  7513                 MOVE 'I'        TO W-LETTER-ADDR-TYPE
  7514             ELSE
  7515                 MOVE -1         TO INSL
  7516                 MOVE AL-UABON   TO INSA
  7517                 MOVE ER-3547    TO EMI-ERROR
  7518                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7519
  7520     IF PHYSL NOT = +0
  7521         MOVE ZEROS              TO W-PHYSICIAN
  7522         IF PHYSI > SPACES
  7523             IF PHYSI NUMERIC
  7524                     AND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 145
* EL152.cbl
  7525                PHYSI NOT < 1
  7526                     AND
  7527                PHYSI NOT > 9
  7528                 MOVE AL-UANON   TO PHYSA
  7529                 MOVE PHYSI      TO W-PHYSICIAN
  7530                                    W-LETTER-ADDR-SEQ
  7531                 MOVE 'P'        TO W-LETTER-ADDR-TYPE
  7532             ELSE
  7533                 MOVE -1         TO PHYSL
  7534                 MOVE AL-UABON   TO PHYSA
  7535                 MOVE ER-3547    TO EMI-ERROR
  7536                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7537
  7538     IF OTHR1L NOT = +0
  7539         MOVE ZEROS              TO W-OTHER-1
  7540         IF OTHR1I > SPACES
  7541             IF OTHR1I NUMERIC
  7542                     AND
  7543                OTHR1I NOT < 1
  7544                     AND
  7545                OTHR1I NOT > 9
  7546                 MOVE AL-UANON   TO OTHR1A
  7547                 MOVE OTHR1I     TO W-OTHER-1
  7548                                    W-LETTER-ADDR-SEQ
  7549                 MOVE 'O'        TO W-LETTER-ADDR-TYPE
  7550             ELSE
  7551                 MOVE -1         TO OTHR1L
  7552                 MOVE AL-UABON   TO OTHR1A
  7553                 MOVE ER-3547    TO EMI-ERROR
  7554                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7555
  7556     IF OTHR2L NOT = +0
  7557         MOVE ZEROS              TO W-OTHER-2
  7558         IF OTHR2I > SPACES
  7559             IF OTHR2I NUMERIC
  7560                     AND
  7561                OTHR2I NOT < 1
  7562                     AND
  7563                OTHR2I NOT > 9
  7564                 MOVE AL-UANON   TO OTHR2A
  7565                 MOVE OTHR2I     TO W-OTHER-2
  7566                                    W-LETTER-ADDR-SEQ
  7567                 MOVE 'Q'        TO W-LETTER-ADDR-TYPE
  7568             ELSE
  7569                 MOVE -1         TO OTHR2L
  7570                 MOVE AL-UABON   TO OTHR2A
  7571                 MOVE ER-3547    TO EMI-ERROR
  7572                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7573
  7574     IF NOT EMI-NO-ERRORS
  7575        GO TO 8200-SEND-DATAONLY.
  7576
  7577 0350-EXIT.
  7578      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 146
* EL152.cbl
  7580 400-SET-CODES.
  7581     MOVE PI-COMPANY-ID          TO CNTL-CO.
  7582     MOVE PI-COMPANY-CD          TO CLAM-CO
  7583                                    TEXT-CO
  7584                                    ACTV-CO
  7585                                    CERT-CO
  7586                                    ACCT-CO
  7587                                    ARCH-CO
  7588                                    PROD-CO
  7589                                    PLCY-CO
  7590                                    PLAN-CO.
  7591
  7592     MOVE PI-CARRIER             TO CLAM-CARRIER
  7593                                    ACTV-CARRIER
  7594                                    CERT-CARRIER
  7595                                    ACCT-CARRIER
  7596                                    PROD-CARRIER
  7597                                    PLCY-CARRIER
  7598                                    PLAN-CARRIER.
  7599
  7600     MOVE PI-CERT-NO             TO CLAM-CERT-NUM
  7601                                    ACTV-CERT-NUM
  7602                                    CERT-CERT-NUM.
  7603 499-EXIT.
  7604      EXIT.
  7605
  7606 500-RECOVER-PI-TEMP-STORAGE.
  7607
  7608
  7609* EXEC CICS HANDLE CONDITION
  7610*        QIDERR   (590-QIDERR)
  7611*    END-EXEC.
  7612*    MOVE '"$N                   ! % #00007509' TO DFHEIV0
  7613     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  7614     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7615     MOVE X'2520233030303037353039' TO DFHEIV0(25:11)
  7616     CALL 'kxdfhei1' USING DFHEIV0
  7617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7618
  7619
  7620
  7621* EXEC CICS READQ TS
  7622*        QUEUE    (WS-PI-QID)
  7623*        INTO     (PROGRAM-INTERFACE-BLOCK)
  7624*        LENGTH   (PI-COMM-LENGTH)
  7625*    END-EXEC.
  7626*    MOVE '*$I    L              ''   #00007513' TO DFHEIV0
  7627     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7628     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7629     MOVE X'2020233030303037353133' TO DFHEIV0(25:11)
  7630     CALL 'kxdfhei1' USING DFHEIV0,
  7631           WS-PI-QID,
  7632           PROGRAM-INTERFACE-BLOCK,
  7633           PI-COMM-LENGTH,
  7634           DFHEIV99,
  7635           DFHEIV99,
  7636           DFHEIV99
  7637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 147
* EL152.cbl
  7638
  7639
  7640     PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT.
  7641
  7642     GO TO 599-EXIT.
  7643
  7644 590-QIDERR.
  7645
  7646     IF EIBTRNID = TRANS-ID
  7647         MOVE ER-0033                   TO  EMI-ERROR
  7648         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7649         GO TO 8200-SEND-DATAONLY.
  7650
  7651 599-EXIT.
  7652     EXIT.
  7653
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 148
* EL152.cbl
  7655 1000-SHOW.
  7656***************************************************************
  7657*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
  7658*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN. THE TEXT      *
  7659*     WILL BE INSERTED INTO THE TS-TABLE AND DISPLAYED TO     *
  7660*     OPERATOR.                                               *
  7661***************************************************************
  7662
  7663     MOVE SPACES                 TO RECORD-TABLE.
  7664     IF ARCHNUML = ZEROS
  7665        MOVE -1                  TO ARCHNUML
  7666        MOVE AL-UNBON            TO ARCHNUMA
  7667        MOVE ER-0174             TO EMI-ERROR
  7668        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7669        GO TO 8200-SEND-DATAONLY.
  7670
  7671     IF ARCHNUMI NOT NUMERIC
  7672        MOVE -1                  TO ARCHNUML
  7673        MOVE AL-UNBON            TO ARCHNUMA
  7674        MOVE ER-0175             TO EMI-ERROR
  7675        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7676        GO TO 8200-SEND-DATAONLY.
  7677
  7678     IF PI-SHOW-MODE
  7679*       IF PI-ARCHIVE-NUMBER = ARCHNUMI
  7680*          MOVE -1               TO MAINTL
  7681*          GO TO 8200-SEND-DATAONLY
  7682*       ELSE
  7683           PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
  7684
  7685     MOVE ARCHNUMI               TO ARCH-NUMBER
  7686                                    PI-ARCHIVE-NUMBER.
  7687     MOVE ' '                    TO ARCH-REC-TYPE.
  7688     MOVE '1'                    TO PI-ACTION.
  7689     MOVE ZEROS                  TO PI-ADDR-SEQ.
  7690     MOVE LOW-VALUES             TO PI-ADDR-TYPE.
  7691     MOVE SPACES                 TO PI-PRINT-SW
  7692                                    PI-FORM-NUMBER.
  7693     SET TB-INDX TO 1.
  7694
  7695     MOVE SPACE                  TO WS-LETTER-STATUS.
  7696
  7697
  7698* EXEC CICS HANDLE CONDITION
  7699*         NOTOPEN    (8850-ARCH-NOT-OPEN)
  7700*         NOTFND     (1020-ENDBR)
  7701*         ENDFILE    (1020-ENDBR)
  7702*    END-EXEC.
  7703*    MOVE '"$JI''                 ! & #00007576' TO DFHEIV0
  7704     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  7705     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7706     MOVE X'2620233030303037353736' TO DFHEIV0(25:11)
  7707     CALL 'kxdfhei1' USING DFHEIV0
  7708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7709
  7710
  7711     MOVE ARCH-PARTIAL-KEY       TO ARCH-SAVE-KEY.
  7712
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 149
* EL152.cbl
  7713
  7714* EXEC CICS STARTBR
  7715*         DATASET    (ARCH-ID)
  7716*         RIDFLD     (ARCH-KEY)
  7717*         GTEQ
  7718*    END-EXEC
  7719     MOVE 0
  7720       TO DFHEIV11
  7721*    MOVE '&,         G          &   #00007584' TO DFHEIV0
  7722     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7723     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7724     MOVE X'2020233030303037353834' TO DFHEIV0(25:11)
  7725     CALL 'kxdfhei1' USING DFHEIV0,
  7726           ARCH-ID,
  7727           ARCH-KEY,
  7728           DFHEIV99,
  7729           DFHEIV11,
  7730           DFHEIV99
  7731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7732
  7733     MOVE 'Y'                    TO ARCH-BROWSE-STARTED.
  7734
  7735 1010-READ-NEXT.
  7736
  7737* EXEC CICS READNEXT
  7738*         SET       (ADDRESS OF LETTER-ARCHIVE)
  7739*         DATASET   (ARCH-ID)
  7740*         RIDFLD    (ARCH-KEY)
  7741*    END-EXEC.
  7742     MOVE 0
  7743       TO DFHEIV11
  7744*    MOVE '&.S                   )   #00007593' TO DFHEIV0
  7745     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7746     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7747     MOVE X'2020233030303037353933' TO DFHEIV0(25:11)
  7748     CALL 'kxdfhei1' USING DFHEIV0,
  7749           ARCH-ID,
  7750           DFHEIV20,
  7751           DFHEIV99,
  7752           ARCH-KEY,
  7753           DFHEIV99,
  7754           DFHEIV11,
  7755           DFHEIV99,
  7756           DFHEIV99
  7757     SET ADDRESS OF LETTER-ARCHIVE TO
  7758         DFHEIV20
  7759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7760
  7761
  7762     IF LA-FORM-CONTROL-HDR
  7763        GO TO 1020-ENDBR.
  7764
  7765
  7766     IF NOT LA-HEADER-DATA
  7767         NEXT SENTENCE
  7768     ELSE
  7769         IF NOT LA-CSO-LETTER-PURGED
  7770             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 150
* EL152.cbl
  7771         ELSE
  7772             MOVE 'P'            TO WS-LETTER-STATUS
  7773             GO TO 1020-ENDBR.
  7774
  7775     IF ARCH-PARTIAL-KEY = ARCH-SAVE-KEY
  7776        IF LA-HEADER-DATA
  7777           PERFORM 1040-FORMAT-RESEND
  7778           MOVE LA-NO-OF-COPIES    TO COPIESO
  7779           PERFORM 1050-GET-CORRESPOND THRU 1059-EXIT
  7780           GO TO 1010-READ-NEXT
  7781        ELSE
  7782           IF LA-ADDRESS-DATA
  7783              MOVE LA-ADDRESS-LINE   TO REC-TEXT (TB-INDX)
  7784              MOVE ZEROS             TO REC-PC (TB-INDX)
  7785              SET TB-INDX UP BY 1
  7786              GO TO 1010-READ-NEXT
  7787           ELSE
  7788              PERFORM 1030-TEXT-BUILD
  7789              GO TO 1010-READ-NEXT.
  7790
  7791 1020-ENDBR.
  7792     IF ARCH-BROWSE-STARTED = 'Y'
  7793        MOVE 'N'                TO ARCH-BROWSE-STARTED
  7794
  7795* EXEC CICS ENDBR
  7796*            DATASET   (ARCH-ID)
  7797*       END-EXEC
  7798     MOVE 0
  7799       TO DFHEIV11
  7800*    MOVE '&2                    $   #00007631' TO DFHEIV0
  7801     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7802     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7803     MOVE X'2020233030303037363331' TO DFHEIV0(25:11)
  7804     CALL 'kxdfhei1' USING DFHEIV0,
  7805           ARCH-ID,
  7806           DFHEIV11,
  7807           DFHEIV99
  7808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7809     END-IF.
  7810
  7811*    IF PI-COMPANY-ID = 'CID'
  7812         IF TB-INDX = 1
  7813             IF WS-LETTER-STATUS EQUAL 'P'
  7814                 MOVE 9021           TO EMI-ERROR
  7815                 MOVE -1             TO ARCHNUML
  7816                 MOVE AL-UNBON       TO ARCHNUMA
  7817                 PERFORM 9900-ERROR-FORMAT THRU
  7818                         9900-EXIT
  7819                 GO TO 8200-SEND-DATAONLY
  7820             ELSE
  7821                 MOVE ER-0006             TO EMI-ERROR
  7822                 MOVE -1                  TO ARCHNUML
  7823                 MOVE AL-UNBON            TO ARCHNUMA
  7824                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7825                 GO TO 8200-SEND-DATAONLY
  7826             END-IF
  7827         END-IF
  7828*    ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 151
* EL152.cbl
  7829*        IF TB-INDX = 1
  7830*            MOVE ER-0006             TO EMI-ERROR
  7831*            MOVE -1                  TO ARCHNUML
  7832*            MOVE AL-UNBON            TO ARCHNUMA
  7833*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7834*            GO TO 8200-SEND-DATAONLY
  7835*        END-IF
  7836*    END-IF
  7837
  7838
  7839     SET TB-INDX DOWN BY 1.
  7840     SET PI-TOTAL-LINES          TO TB-INDX.
  7841     MOVE 1                      TO PI-CURRENT-LINE.
  7842     SET TB-INDX TO 1.
  7843
  7844     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
  7845             VARYING SC-INDX FROM 1 BY 1
  7846               UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  7847
  7848     MOVE SPACES                 TO PI-ADDR-TYPE
  7849                                    MAINTI.
  7850     MOVE -1                     TO MAINTL.
  7851
  7852     GO TO 8100-SEND-INITIAL-MAP.
  7853
  7854 1030-TEXT-BUILD.
  7855***** IF THERE ARE NO ADDRESS LINES OR LESS THAN 6 LINES, SET TO
  7856***** TOP OF FORM.
  7857     IF TB-INDX < 7
  7858        SET TB-INDX   TO 7.
  7859
  7860     IF TB-INDX = 7
  7861        MOVE TOP-FORM            TO REC-TEXT (TB-INDX)
  7862        SET TB-INDX UP BY 1.
  7863
  7864     MOVE LA-TEXT-LINE           TO REC-TEXT (TB-INDX).
  7865     MOVE LA-SKIP-CONTROL        TO REC-PC (TB-INDX)
  7866                                    INDX-WORK.
  7867
  7868     IF INDX-WORK NOT = 99
  7869        SET TB-INDX UP BY 1
  7870        SET TB-INDX UP BY INDX-WORK
  7871     ELSE
  7872        SET TB-INDX UP BY 1
  7873        MOVE TOP-FORM            TO REC-TEXT (TB-INDX)
  7874        SET TB-INDX UP BY 1.
  7875
  7876 1040-FORMAT-RESEND.
  7877     IF LA-RESEND-DATE = LOW-VALUES
  7878        MOVE SPACES                 TO RESENDI
  7879       ELSE
  7880        MOVE LA-RESEND-DATE         TO DC-BIN-DATE-1
  7881        MOVE ' '                    TO DC-OPTION-CODE
  7882        PERFORM 9700-DATE-LINK  THRU 9700-EXIT
  7883        MOVE DC-GREG-DATE-1-EDIT    TO RESENDO.
  7884
  7885 1050-GET-CORRESPOND.
  7886     MOVE LA-CARRIER             TO ACTV-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 152
* EL152.cbl
  7887     MOVE LA-CLAIM-NO            TO ACTV-CLAIM.
  7888     MOVE LA-CERT-NO             TO ACTV-CERT-NUM.
  7889     MOVE LA-CORR-TRLR-SEQ       TO ACTV-SEQ.
  7890
  7891
  7892* EXEC CICS READ
  7893*         DATASET     (ACTV-ID)
  7894*         RIDFLD      (ACTV-KEY)
  7895*         SET         (ADDRESS OF ACTIVITY-TRAILERS)
  7896*    END-EXEC.
  7897*    MOVE '&"S        E          (   #00007716' TO DFHEIV0
  7898     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7899     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7900     MOVE X'2020233030303037373136' TO DFHEIV0(25:11)
  7901     CALL 'kxdfhei1' USING DFHEIV0,
  7902           ACTV-ID,
  7903           DFHEIV20,
  7904           DFHEIV99,
  7905           ACTV-KEY,
  7906           DFHEIV99,
  7907           DFHEIV99,
  7908           DFHEIV99
  7909     SET ADDRESS OF ACTIVITY-TRAILERS TO
  7910         DFHEIV20
  7911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7912
  7913
  7914     IF AT-RECEIPT-FOLLOW-UP = LOW-VALUES
  7915        MOVE SPACES                TO FOLLOWI
  7916     ELSE
  7917        MOVE SPACES                TO DC-OPTION-CODE
  7918        MOVE AT-RECEIPT-FOLLOW-UP  TO DC-BIN-DATE-1
  7919        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7920        MOVE DC-GREG-DATE-1-EDIT   TO FOLLOWI.
  7921
  7922     MOVE SPACES                 TO ADDRI
  7923     MOVE AT-STD-LETTER-FORM     TO FORMI
  7924     MOVE AT-REASON-TEXT         TO REI.
  7925
  7926 1059-EXIT.
  7927      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 153
* EL152.cbl
  7929 2000-CREATE.
  7930***************************************************************
  7931*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
  7932*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
  7933*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
  7934*    WILL BE DISPLAYED ONTO THE SCREEN.                       *
  7935*                                                             *
  7936***************************************************************
  7937
  7938***************************************************************
  7939*    CHECK TO SEE IF SAME REQUEST OR NOT.                     *
  7940*    IF NEW REQUEST AND A LETTER WAS PRINTED, FORCE AN ERROR  *
  7941***************************************************************
  7942
  7943     IF PI-CREATE-MODE
  7944        IF PI-FORM-NUMBER = FORMI AND PI-ADDR-TYPE = ADDRI AND
  7945           PI-LETTER-ADDRESS-TYPE = W-LETTER-ADDRESS-TYPE
  7946           PERFORM 7500-READ-TS  THRU 7599-EXIT
  7947           PERFORM 7950-SET-INDX THRU 7950-EXIT
  7948           PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  7949             VARYING SC-INDX FROM 1 BY 1
  7950             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  7951           MOVE -1               TO MAINTL
  7952*          MOVE 'Y'              TO CLEANO
  7953           GO TO 8200-SEND-DATAONLY
  7954        ELSE
  7955           IF PRINT-PERFORMED AND
  7956              PI-RETURN-TO-PROGRAM  =  PGM-EL150 AND
  7957              FORMI NOT = 9999
  7958              MOVE ER-0279           TO EMI-ERROR
  7959              MOVE -1                TO MAINTL
  7960              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7961              GO TO 8200-SEND-DATAONLY.
  7962
  7963***************************************************************
  7964*   IF THE FORM NUMBER IS THE SAME BUT THE ADDRESS TYPE       *
  7965*   HAS CHANGED, THEN SAVE THE CURRENT SCREEN AND REBUILD     *
  7966*   THE ADDRESS DATA.                                         *
  7967***************************************************************
  7968
  7969     IF PI-FORM-NUMBER = FORMI AND
  7970        PI-ADDR-TYPE  =  ADDRI AND
  7971        PI-LETTER-ADDRESS-TYPE = W-LETTER-ADDRESS-TYPE
  7972           MOVE -1                  TO MAINTL
  7973           GO TO 8200-SEND-DATAONLY.
  7974
  7975     IF PI-LETTER-ADDRESS-TYPE NOT = W-LETTER-ADDRESS-TYPE
  7976         MOVE 0                  TO GETMAIN-SWITCH
  7977         MOVE 'N'                TO WS-ACCT-READ-SW
  7978                                    WS-PROD-READ-SW
  7979                                    WS-COMP-READ-SW.
  7980
  7981     MOVE SPACES                 TO RECORD-TABLE.
  7982
  7983     PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  7984
  7985     SET TB-INDX TO 1
  7986     MOVE TOP-FORM               TO REC-TEXT (TB-INDX).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 154
* EL152.cbl
  7987     SET TB-INDX UP BY 1.
  7988
  7989***************************************************************
  7990*    IF A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE      *
  7991*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
  7992***************************************************************
  7993
  7994     IF FORMI = '9999'
  7995        MOVE 16                  TO PI-TOTAL-LINES
  7996        MOVE 1                   TO PI-CURRENT-LINE
  7997        PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
  7998        PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT
  7999        MOVE '3'                 TO PI-ACTION
  8000        MOVE FORMI               TO PI-FORM-NUMBER
  8001                                    PI-COMM-CONTROL
  8002        MOVE ZEROS               TO PI-UPDATE-SW
  8003        MOVE PGM-EL1042          TO PGM-NAME
  8004        GO TO 9300-XCTL.
  8005
  8006     MOVE FORMI                  TO TEXT-LETTER.
  8007     MOVE TEXT-PARTIAL-KEY       TO TEXT-SAVE-KEY.
  8008
  8009
  8010* EXEC CICS HANDLE CONDITION
  8011*         NOTFND     (2120-ENDBR)
  8012*         ENDFILE    (2120-ENDBR)
  8013*         NOTOPEN    (8890-TEXT-NOT-OPEN)
  8014*    END-EXEC
  8015*    MOVE '"$I''J                 ! '' #00007817' TO DFHEIV0
  8016     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  8017     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8018     MOVE X'2720233030303037383137' TO DFHEIV0(25:11)
  8019     CALL 'kxdfhei1' USING DFHEIV0
  8020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8021
  8022
  8023* EXEC CICS STARTBR
  8024*         DATASET    (TEXT-ID)
  8025*         RIDFLD     (TEXT-KEY)
  8026*         GTEQ
  8027*    END-EXEC.
  8028     MOVE 0
  8029       TO DFHEIV11
  8030*    MOVE '&,         G          &   #00007823' TO DFHEIV0
  8031     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8032     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8033     MOVE X'2020233030303037383233' TO DFHEIV0(25:11)
  8034     CALL 'kxdfhei1' USING DFHEIV0,
  8035           TEXT-ID,
  8036           TEXT-KEY,
  8037           DFHEIV99,
  8038           DFHEIV11,
  8039           DFHEIV99
  8040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8041
  8042
  8043     MOVE 'Y'                    TO TEXT-BROWSE-STARTED.
  8044
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 155
* EL152.cbl
  8045 2110-READ-NEXT.
  8046     IF TB-INDX > MAX-LINES
  8047        MOVE ER-0051             TO EMI-ERROR
  8048        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8049        GO TO 2120-ENDBR.
  8050
  8051
  8052* EXEC CICS READNEXT
  8053*         DATASET    (TEXT-ID)
  8054*         SET        (ADDRESS OF TEXT-FILES)
  8055*         RIDFLD     (TEXT-KEY)
  8056*    END-EXEC.
  8057     MOVE 0
  8058       TO DFHEIV11
  8059*    MOVE '&.S                   )   #00007837' TO DFHEIV0
  8060     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8061     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8062     MOVE X'2020233030303037383337' TO DFHEIV0(25:11)
  8063     CALL 'kxdfhei1' USING DFHEIV0,
  8064           TEXT-ID,
  8065           DFHEIV20,
  8066           DFHEIV99,
  8067           TEXT-KEY,
  8068           DFHEIV99,
  8069           DFHEIV11,
  8070           DFHEIV99,
  8071           DFHEIV99
  8072     SET ADDRESS OF TEXT-FILES TO
  8073         DFHEIV20
  8074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8075
  8076
  8077     IF TEXT-PARTIAL-KEY NOT = TEXT-SAVE-KEY
  8078        IF TB-INDX = +2
  8079           MOVE SPACES           TO PI-FORM-NUMBER
  8080           MOVE -1               TO FORML
  8081           MOVE AL-UABON         TO FORMA
  8082           MOVE ER-1236          TO EMI-ERROR
  8083           MOVE 'N'              TO CLEANO
  8084           PERFORM 9900-ERROR-FORMAT
  8085                                 THRU 9900-EXIT
  8086        END-IF
  8087        GO TO 2120-ENDBR
  8088     END-IF
  8089
  8090     MOVE FORMI                  TO PI-FORM-NUMBER.
  8091     IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  8092         PERFORM 2800-PROCESS-Z-CONTROLS THRU 2800-EXIT
  8093         GO TO 2110-READ-NEXT.
  8094
  8095      MOVE TX-BSR-CODE           TO PI-ELLETR-BSR.
  8096
  8097      IF (PI-COMPANY-ID = 'CID' OR 'AHL')
  8098         AND (PI-CARRIER NOT = '8')
  8099         PERFORM VARYING B1 FROM +1 BY +1 UNTIL
  8100            B1 > +20
  8101            IF TX-TEXT-LINE (B1:5) = '@03.1'
  8102               GO TO 2110-READ-NEXT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 156
* EL152.cbl
  8103            END-IF
  8104         END-PERFORM
  8105      END-IF
  8106      MOVE TX-TEXT-LINE          TO REC-TEXT (TB-INDX).
  8107      MOVE TX-PROCESS-CONTROL    TO REC-PC (TB-INDX)
  8108                                    INDX-WORK.
  8109      SET TB-INDX UP BY 1.
  8110      IF INDX-WORK = 99
  8111         MOVE TOP-FORM           TO REC-TEXT (TB-INDX)
  8112         SET TB-INDX UP BY 1
  8113         GO TO 2110-READ-NEXT
  8114      ELSE
  8115         SET TB-INDX UP BY INDX-WORK
  8116         GO TO 2110-READ-NEXT.
  8117
  8118 2120-ENDBR.
  8119     IF TEXT-BROWSE-STARTED = 'Y'
  8120        MOVE 'N'                 TO TEXT-BROWSE-STARTED
  8121
  8122* EXEC CICS ENDBR
  8123*            DATASET     (TEXT-ID)
  8124*       END-EXEC.
  8125     MOVE 0
  8126       TO DFHEIV11
  8127*    MOVE '&2                    $   #00007887' TO DFHEIV0
  8128     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8129     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8130     MOVE X'2020233030303037383837' TO DFHEIV0(25:11)
  8131     CALL 'kxdfhei1' USING DFHEIV0,
  8132           TEXT-ID,
  8133           DFHEIV11,
  8134           DFHEIV99
  8135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8136
  8137
  8138*02160      IF TB-INDX = 8
  8139*02161         MOVE ER-0006             TO EMI-ERROR
  8140*02162         MOVE -1                  TO FORML
  8141*02163         MOVE AL-UABON            TO FORMA
  8142*02164         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8143*02165         GO TO 8200-SEND-DATAONLY-ERASEAUP.
  8144
  8145     SET TB-INDX DOWN BY 1.
  8146     SET PI-TOTAL-LINES          TO TB-INDX.
  8147     MOVE 1                      TO PI-CURRENT-LINE.
  8148
  8149***************************************************************
  8150*    IF IT IS A DESIGNATED CLAIM, THEN RESOLVE ALL            *
  8151*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
  8152***************************************************************
  8153
  8154     IF PI-RETURN-TO-PROGRAM = PGM-EL150
  8155        PERFORM 7200-RESOLVE-VARIABLES THRU 7269-EXIT
  8156        MOVE SPACES              TO W-REVERSE-DATE-SW
  8157        PERFORM 7300-VARIABLE-SEARCH   THRU 7399-EXIT
  8158                VARYING TB-INDX FROM 7 BY 1 UNTIL
  8159                TB-INDX > PI-TOTAL-LINES
  8160     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 157
* EL152.cbl
  8161        MOVE ER-0373             TO EMI-ERROR
  8162        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8163
  8164     SET TB-INDX TO 1.
  8165     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
  8166             VARYING SC-INDX FROM 1 BY 1 UNTIL
  8167             SC-INDX > NUM-LINES-PER-SCREEN.
  8168
  8169     MOVE '3'                    TO PI-ACTION.
  8170*    MOVE FORMI                  TO PI-FORM-NUMBER.
  8171     MOVE W-LETTER-ADDRESS-TYPE  TO PI-LETTER-ADDRESS-TYPE.
  8172     MOVE -1                     TO MAINTL.
  8173     GO TO 8200-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 158
* EL152.cbl
  8175 2800-PROCESS-Z-CONTROLS.
  8176
  8177     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
  8178
  8179     IF RESEND-SAVE = LOW-VALUES
  8180         IF W-DAYS-TO-RESEND-1 NUMERIC
  8181             IF W-DAYS-TO-RESEND-1 > ZEROS
  8182                 MOVE '6'                    TO DC-OPTION-CODE
  8183                 MOVE SAVE-BIN-DATE          TO DC-BIN-DATE-1
  8184                 MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  8185                 MOVE W-DAYS-TO-RESEND-1     TO DC-ELAPSED-DAYS
  8186                 PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8187                 IF NO-CONVERSION-ERROR
  8188                     MOVE DC-BIN-DATE-2       TO RESEND-SAVE
  8189                     MOVE DC-GREG-DATE-1-EDIT TO RESENDO
  8190                     MOVE AL-UANON            TO RESENDA
  8191                     MOVE +8                  TO RESENDL
  8192                 ELSE
  8193                     MOVE ER-3770             TO EMI-ERROR
  8194                     MOVE -1                  TO MAINTL
  8195                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8196                     GO TO 8200-SEND-DATAONLY.
  8197
  8198     IF FOLLOW-UP-SAVE = LOW-VALUES
  8199         IF W-DAYS-TO-FOLLOW-UP NUMERIC
  8200             IF W-DAYS-TO-FOLLOW-UP > ZEROS
  8201                 MOVE '6'                 TO DC-OPTION-CODE
  8202                 MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  8203                 MOVE ZEROS               TO DC-ELAPSED-MONTHS
  8204                 MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  8205                 PERFORM 9700-DATE-LINK THRU 9700-EXIT
  8206                 IF NO-CONVERSION-ERROR
  8207                     MOVE DC-BIN-DATE-2       TO FOLLOW-UP-SAVE
  8208                     MOVE DC-GREG-DATE-1-EDIT TO FOLLOWO
  8209                     MOVE AL-UANON            TO FOLLOWA
  8210                     MOVE +8                  TO FOLLOWL
  8211                 ELSE
  8212                     MOVE ER-3771             TO EMI-ERROR
  8213                     MOVE -1                  TO MAINTL
  8214                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8215                     GO TO 8200-SEND-DATAONLY.
  8216
  8217     IF COPIESI NOT NUMERIC
  8218         IF W-NUMBER-OF-COPIES NUMERIC
  8219             IF W-NUMBER-OF-COPIES > ZEROS
  8220                 MOVE W-NUMBER-OF-COPIES  TO COPIESI
  8221                 MOVE AL-UNNON            TO COPIESA
  8222                 MOVE +1                  TO COPIESL
  8223             ELSE
  8224                 MOVE +1                  TO COPIESI
  8225                 MOVE AL-UNNON            TO COPIESA
  8226                 MOVE +1                  TO COPIESL.
  8227
  8228     IF W-FORM-TO-RESEND > SPACES
  8229         MOVE W-FORM-TO-RESEND          TO PI-RESEND-FORM-NUMBER
  8230     ELSE
  8231         MOVE LOW-VALUES                TO PI-RESEND-FORM-NUMBER
  8232     END-IF.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 159
* EL152.cbl
  8233
  8234     IF W-PROMPT-LETTER = 'Y'
  8235         MOVE W-PROMPT-LETTER           TO PI-PROMPT-LETTER
  8236         MOVE ER-0894                   TO EMI-ERROR
  8237         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8238     ELSE
  8239         MOVE 'N'                       TO PI-PROMPT-LETTER
  8240     END-IF.
  8241
  8242     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
  8243                                           ENCO
  8244     MOVE AL-UANON                      TO ENCA
  8245     MOVE +3                            TO ENCL
  8246     MOVE 'N'                           TO CLEANO
  8247     MOVE W-AUTO-CLOSE-IND              TO PI-AUTO-CLOSE-IND.
  8248     MOVE W-LETTER-TO-BENE              TO PI-LETTER-TO-BENE.
  8249
  8250 2800-EXIT.
  8251     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 160
* EL152.cbl
  8253 3000-RECORD.
  8254***************************************************************
  8255*    THIS ROUTINE WILL SAVE THE LETTER TEXT (IF ANY) AND      *
  8256*    BUILD A CORRESPONDENCE TRAILER WITH THE DATA FROM        *
  8257*    THE SCREEN.                                              *
  8258***************************************************************
  8259
  8260     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8261        MOVE ER-0211             TO EMI-ERROR
  8262        MOVE -1                  TO MAINTL
  8263        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8264        GO TO 8200-SEND-DATAONLY.
  8265
  8266
  8267* EXEC CICS HANDLE CONDITION
  8268*         NOTOPEN    (8860-CLAM-NOT-OPEN)
  8269*         NOTFND     (3010-NOT-FOUND)
  8270*    END-EXEC.
  8271*    MOVE '"$JI                  ! ( #00008019' TO DFHEIV0
  8272     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8273     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8274     MOVE X'2820233030303038303139' TO DFHEIV0(25:11)
  8275     CALL 'kxdfhei1' USING DFHEIV0
  8276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8277
  8278
  8279     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8280     PERFORM 7950-SET-INDX     THRU 7950-EXIT.
  8281
  8282     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8283             VARYING SC-INDX FROM 1 BY 1
  8284             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8285
  8286     PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  8287
  8288     IF NOT EMI-NO-ERRORS
  8289        GO TO 8200-SEND-DATAONLY.
  8290
  8291     MOVE ZEROS               TO ARCH-NUMBER.
  8292     PERFORM 6500-BUILD-CORRESPOND THRU 6599-EXIT.
  8293     MOVE ER-0000             TO EMI-ERROR.
  8294     MOVE -1                  TO MAINTL.
  8295     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8296     GO TO 8200-SEND-DATAONLY.
  8297
  8298 3010-NOT-FOUND.
  8299     MOVE ER-0133             TO EMI-ERROR.
  8300     MOVE -1                  TO MAINTL.
  8301     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8302     GO TO 8200-SEND-DATAONLY.
  8303
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 161
* EL152.cbl
  8305*4000-SET-BSR. Remove as dead code
  8306*4001-READ-NEXT. Remove as dead code
  8307*4002-ENDBR. Remove as dead code
  8308*4000-EXIT. Remove as dead code
  8309
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 162
* EL152.cbl
  8311 5000-MOVE-NAME.
  8312*    COPY ELCMNS.
  8313*****************************************************************
  8314*                                                               *
  8315*                                                               *
  8316*                            ELCMNS.                            *
  8317*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8318*                            VMOD=2.002                         *
  8319*                                                               *
  8320*                     M O V E   N A M E   R O U T I N E         *
  8321*                                                               *
  8322*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8323*            NAME FROM THE CLAIM MASTER TO A WORK AREA WITH     *
  8324*            NO EMBEDDED BLANKS.                                *
  8325*                                                               *
  8326*                  FIELD               VALUE                    *
  8327*                                                               *
  8328*                LAST NAME (CL15)      SMITH                    *
  8329*                1ST NAME  (CL12)      JOHN                     *
  8330*                MID NAME  (CL12)      ALLEN                    *
  8331*                                                               *
  8332*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8333*                                                               *
  8334*                        SMITH, JOHN ALLEN                      *
  8335*                                                               *
  8336*                TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8337*            STORAGE COPYBOOK:                                  *
  8338*                                                               *
  8339*                01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8340*                                                               *
  8341*****************************************************************.
  8342
  8343     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  8344     MOVE ZERO                   TO  WS-NAME-SW.
  8345     SET NWA-INDEX TO +1.
  8346
  8347     IF CL-INSURED-1ST-NAME = SPACES  AND
  8348        CL-INSURED-MID-INIT = SPACES
  8349         MOVE +1                 TO  WS-NAME-SW.
  8350
  8351     MOVE CL-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8352     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8353
  8354     MOVE CL-INSURED-1ST-NAME   TO  WS-NAME-WORK2.
  8355     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8356
  8357     SET NWA-INDEX UP BY +1.
  8358     MOVE CL-INSURED-MID-INIT   TO  WS-NAME-WORK2.
  8359     PERFORM 5100-MOVE-NAME THRU 5190-EXIT.
  8360
  8361 5000-EXIT.
  8362     EXIT.
  8363
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 163
* EL152.cbl
  8365 5100-MOVE-NAME SECTION.
  8366     IF WS-NAME-SW GREATER THAN +1
  8367         GO TO 5190-EXIT.
  8368
  8369     IF WS-NAME-WORK2 = SPACES
  8370         GO TO 5190-EXIT.
  8371
  8372     SET NWA-INDEX2 TO +1.
  8373     SET NWA-INDEX3 TO +2.
  8374
  8375 5110-MOVE-NAME.
  8376     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8377
  8378     IF NWA-INDEX LESS THAN +30
  8379         SET NWA-INDEX UP BY +1
  8380       ELSE
  8381         ADD +2  TO  WS-NAME-SW
  8382         GO TO 5190-EXIT.
  8383
  8384     IF NWA-INDEX2 LESS THAN +20
  8385         SET NWA-INDEX3 UP BY +1
  8386         SET NWA-INDEX2 UP BY +1.
  8387
  8388     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8389        WS-NW2 (NWA-INDEX3) = SPACES
  8390         IF WS-NAME-SW = ZERO
  8391             MOVE ','            TO  WS-NW (NWA-INDEX)
  8392             SET NWA-INDEX UP BY +2
  8393             MOVE +1             TO  WS-NAME-SW
  8394             GO TO 5190-EXIT
  8395           ELSE
  8396             GO TO 5190-EXIT.
  8397
  8398     GO TO 5110-MOVE-NAME.
  8399
  8400 5190-EXIT.
  8401     EXIT.
  8402
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 164
* EL152.cbl
  8404 5200-MOVE-NAME.
  8405*    NOTE *******************************************************
  8406*         *           M O V E   N A M E   R O U T I N E         *
  8407*         *                                                     *
  8408*         *      THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8409*         *  NAME FROM THE CLAIM MASTER TO A WORK AREA WITH     *
  8410*         *  NO EMBEDDED BLANKS.                                *
  8411*         *                                                     *
  8412*         *        FIELD               VALUE                    *
  8413*         *                                                     *
  8414*         *      LAST NAME (CL15)      SMITH                    *
  8415*         *      1ST NAME  (CL12)      JOHN                     *
  8416*         *      MID NAME  (CL1)       A                        *
  8417*         *                                                     *
  8418*         *      AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8419*         *                                                     *
  8420*         *              JOHN A. SMITH                          *
  8421*         *                                                     *
  8422*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8423*         *  STORAGE COPYBOOK:                                  *
  8424*         *                                                     *
  8425*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8426*         *                                                     *
  8427*         *******************************************************.
  8428
  8429     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
  8430     MOVE ZERO                   TO  WS-NAME-SW.
  8431     SET NWA-INDEX TO +1.
  8432
  8433     IF W-FIRST-NAME = SPACES
  8434             AND
  8435        W-MIDDLE-NAME = SPACES
  8436         MOVE W-LAST-NAME        TO WS-NAME-WORK
  8437         GO TO 5200-EXIT.
  8438
  8439     MOVE W-FIRST-NAME           TO  WS-NAME-WORK2.
  8440     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8441
  8442     SET NWA-INDEX UP BY +1.
  8443
  8444     IF W-MIDDLE-NAME NOT = SPACES
  8445        MOVE W-MIDDLE-NAME       TO  WS-NW (NWA-INDEX)
  8446        SET NWA-INDEX UP BY +1
  8447        MOVE '.'                 TO  WS-NW (NWA-INDEX)
  8448        SET NWA-INDEX UP BY +2.
  8449
  8450     MOVE W-LAST-NAME            TO  WS-NAME-WORK2.
  8451     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8452
  8453 5200-EXIT.
  8454     EXIT.
  8455
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 165
* EL152.cbl
  8457 5300-MOVE-NAME.
  8458     IF WS-NAME-SW > +1
  8459         GO TO 5390-EXIT.
  8460
  8461     IF WS-NAME-WORK2 = SPACES
  8462         GO TO 5390-EXIT.
  8463
  8464     SET NWA-INDEX2 TO +1.
  8465     SET NWA-INDEX3 TO +2.
  8466
  8467 5310-MOVE-NAME.
  8468     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8469
  8470     IF NWA-INDEX < +30
  8471        SET NWA-INDEX UP BY +1
  8472     ELSE
  8473        ADD +2  TO  WS-NAME-SW
  8474        GO TO 5390-EXIT.
  8475
  8476     IF NWA-INDEX2 < +20
  8477         SET NWA-INDEX2 UP BY +1
  8478         SET NWA-INDEX3 UP BY +1.
  8479
  8480     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8481        WS-NW2 (NWA-INDEX3) = SPACES
  8482        GO TO 5390-EXIT.
  8483
  8484     GO TO 5310-MOVE-NAME.
  8485
  8486 5390-EXIT.
  8487     EXIT.
  8488
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 166
* EL152.cbl
  8490 6100-ADDR-MAINT.
  8491***************************************************************
  8492*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
  8493*    AND THE TS-TABLE OF LETTER TEXT.                         *
  8494*    IT WILL THEN XCTL TO THE ADDRESS MAINT PROGRAM.          *
  8495***************************************************************
  8496
  8497     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8498
  8499     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8500     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8501             VARYING SC-INDX FROM 1 BY 1
  8502             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8503
  8504     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8505        MOVE ER-0343             TO EMI-ERROR
  8506        MOVE -1                  TO MAINTL
  8507        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8508        GO TO 8200-SEND-DATAONLY.
  8509
  8510*    PERFORM 7500-READ-TS        THRU 7599-EXIT
  8511*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8512*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8513*            VARYING SC-INDX FROM 1 BY 1
  8514*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8515
  8516     PERFORM 7700-PUT-TEMP-STOR    THRU 7749-EXIT.
  8517     PERFORM 7790-WRITE-SCREEN-TS  THRU 7790-EXIT.
  8518     PERFORM 7795-WRITE-PI-AREA-TS THRU 7795-EXIT.
  8519     MOVE PGM-EL141 TO PGM-NAME.
  8520
  8521     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 167
* EL152.cbl
  8523 6200-EDIT-MODE.
  8524***************************************************************
  8525*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
  8526*    AND THE TS-TABLE OF LETTER TEXT.                         *
  8527*    IT WILL THEN XCTL TO THE TEXT-EDITOR PROGRAM.            *
  8528***************************************************************
  8529     IF PI-SHOW-MODE
  8530        MOVE ER-0188             TO EMI-ERROR
  8531        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8532        MOVE -1                  TO MAINTL
  8533        MOVE AL-UABON            TO MAINTA
  8534        GO TO 8200-SEND-DATAONLY
  8535     END-IF
  8536
  8537*    IF PI-COMPANY-ID = 'DMD'
  8538*        IF PI-BSR-AUTOMATED
  8539*            MOVE ER-0912        TO EMI-ERROR
  8540*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8541*            MOVE -1             TO MAINTL
  8542*            MOVE AL-UABON       TO MAINTA
  8543*            GO TO 8200-SEND-DATAONLY.
  8544
  8545     IF PI-CURRENT-LINE = ZEROS
  8546        MOVE ER-0187             TO EMI-ERROR
  8547        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8548        MOVE -1                  TO MAINTL
  8549        GO TO 8200-SEND-DATAONLY.
  8550
  8551     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8552     PERFORM 7750-DELETE-TEMP-STOR
  8553                                 THRU 7750-EXIT
  8554     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8555     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8556             VARYING SC-INDX FROM 1 BY 1
  8557             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8558
  8559     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT.
  8560     PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT.
  8561
  8562     MOVE PI-FORM-NUMBER         TO PI-COMM-CONTROL.
  8563     MOVE ZEROS                  TO PI-UPDATE-SW.
  8564     MOVE '1'                    TO PI-ENTRY-CD-1.
  8565     MOVE PGM-EL1042             TO PGM-NAME.
  8566     GO TO 9300-XCTL.
  8567
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 168
* EL152.cbl
  8569 6400-LETTER-RELEASE.
  8570***************************************************************
  8571*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
  8572*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS ONTO     *
  8573*    THE ARCHIVE FILE.                                        *
  8574*    THE FOLLOWING FUNCTIONS WILL BE PERFORMED                *
  8575*        1. CHECK SECURITY AND IF IT IS A DESIGNATED LETTER.  *
  8576*        2. RE-EDIT DATA AND UPDATE TS-TABLE WITH CHANGES     *
  8577*        3. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS         *
  8578*        4. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
  8579*        5. WRITE THE NEW ARCHIVE RECORDS FROM TS-TABLE.      *
  8580*        7. BUILD A CORRESPONDENCE TRAILER                    *
  8581*        8. BUILD OR UPDATE THE ACTIVITY QUE FILE WITH THE    *
  8582*                 ARCHIVE NUMBER IF IT IS TO BE PRINTED LATER.*
  8583*        4. RESET ALL CONTROL FIELDS AND RETURN THE           *
  8584*                 ARCHIVE NUMBER USED TO FILE THE RECORDS.    *
  8585***************************************************************
  8586
  8587     PERFORM 7500-READ-TS        THRU 7599-EXIT
  8588
  8589     PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8590     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8591             VARYING SC-INDX FROM 1 BY 1
  8592             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8593
  8594     IF NOT MODIFY-CAP
  8595        MOVE ER-0070             TO EMI-ERROR
  8596        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8597        MOVE -1                  TO MAINTL
  8598        GO TO 8200-SEND-DATAONLY.
  8599
  8600     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  8601        MOVE ER-0211             TO EMI-ERROR
  8602        MOVE -1                  TO MAINTL
  8603        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8604        GO TO 8200-SEND-DATAONLY.
  8605
  8606*    PERFORM 7500-READ-TS        THRU 7599-EXIT
  8607*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
  8608*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
  8609*            VARYING SC-INDX FROM 1 BY 1
  8610*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
  8611
  8612     IF PI-ADDR-TYPE  NOT =  ADDRI
  8613        PERFORM 7000-READ-ADDR THRU 7099-EXIT.
  8614
  8615     IF NOT EMI-NO-ERRORS
  8616        GO TO 8200-SEND-DATAONLY.
  8617
  8618     MOVE +0                     TO TALLY.
  8619     INSPECT RECORD-TABLE TALLYING TALLY
  8620                                 FOR CHARACTERS BEFORE '@'.
  8621
  8622     IF TALLY < +21900
  8623        COMPUTE PI-CURRENT-LINE = TALLY / 73
  8624        MOVE ZEROS               TO ROLL-COUNTER
  8625        MOVE ER-0191             TO EMI-ERROR
  8626        MOVE -1                  TO MAINTL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 169
* EL152.cbl
  8627        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8628        GO TO 7900-ROLL-PAGE.
  8629
  8630     MOVE '1'                    TO CNTL-RECORD-TYPE.
  8631     MOVE ZEROS                  TO CNTL-SEQ.
  8632     MOVE SPACES                 TO CNTL-GENL.
  8633
  8634* EXEC CICS READ
  8635*         DATASET    (CNTL-ID)
  8636*         SET        (ADDRESS OF CONTROL-FILE)
  8637*         RIDFLD     (CNTL-KEY)
  8638*         UPDATE
  8639*    END-EXEC.
  8640*    MOVE '&"S        EU         (   #00008378' TO DFHEIV0
  8641     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8642     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8643     MOVE X'2020233030303038333738' TO DFHEIV0(25:11)
  8644     CALL 'kxdfhei1' USING DFHEIV0,
  8645           CNTL-ID,
  8646           DFHEIV20,
  8647           DFHEIV99,
  8648           CNTL-KEY,
  8649           DFHEIV99,
  8650           DFHEIV99,
  8651           DFHEIV99
  8652     SET ADDRESS OF CONTROL-FILE TO
  8653         DFHEIV20
  8654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8655
  8656
  8657     ADD 1                       TO CF-CO-ARCHIVE-COUNTER.
  8658     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
  8659     MOVE CF-PRINT-ADDRESS-LABELS   TO  WS-LABELS-SW.
  8660
  8661
  8662* EXEC CICS REWRITE
  8663*         FROM      (CONTROL-FILE)
  8664*         DATASET   (CNTL-ID)
  8665*    END-EXEC
  8666     MOVE LENGTH OF
  8667      CONTROL-FILE
  8668       TO DFHEIV11
  8669*    MOVE '&& L                  %   #00008389' TO DFHEIV0
  8670     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8671     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8672     MOVE X'2020233030303038333839' TO DFHEIV0(25:11)
  8673     CALL 'kxdfhei1' USING DFHEIV0,
  8674           CNTL-ID,
  8675           CONTROL-FILE,
  8676           DFHEIV11,
  8677           DFHEIV99
  8678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8679
  8680     PERFORM 6500-BUILD-CORRESPOND THRU 6599-EXIT.
  8681
  8682
  8683* EXEC CICS HANDLE CONDITION
  8684*         NOTOPEN   (9990-ABEND)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 170
* EL152.cbl
  8685*    END-EXEC.
  8686*    MOVE '"$J                   ! ) #00008396' TO DFHEIV0
  8687     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  8688     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8689     MOVE X'2920233030303038333936' TO DFHEIV0(25:11)
  8690     CALL 'kxdfhei1' USING DFHEIV0
  8691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8692
  8693
  8694
  8695* EXEC CICS GETMAIN
  8696*         SET      (ADDRESS OF LETTER-ARCHIVE)
  8697*         LENGTH   (ARCH-LENGTH)
  8698*    END-EXEC.
  8699*    MOVE '," L                  $   #00008400' TO DFHEIV0
  8700     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  8701     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8702     MOVE X'2020233030303038343030' TO DFHEIV0(25:11)
  8703     CALL 'kxdfhei1' USING DFHEIV0,
  8704           DFHEIV20,
  8705           ARCH-LENGTH,
  8706           DFHEIV99
  8707     SET ADDRESS OF LETTER-ARCHIVE TO
  8708         DFHEIV20
  8709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8710
  8711
  8712     MOVE SPACES                 TO LETTER-ARCHIVE.
  8713     MOVE 'LA'                   TO LA-RECORD-ID.
  8714     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8715                                    LA-ARCHIVE-NO-A1.
  8716     MOVE '1'                    TO LA-RECORD-TYPE
  8717                                    LA-RECORD-TYPE-A1.
  8718     MOVE ZEROS                  TO LA-LINE-SEQ-NO
  8719                                    LA-LINE-SEQ-NO-A1.
  8720     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8721                                    LA-COMPANY-CD-A1.
  8722     MOVE CLAM-CARRIER           TO LA-CARRIER.
  8723     MOVE PI-CLAIM-NO            TO LA-CLAIM-NO.
  8724     MOVE PI-CERT-NO             TO LA-CERT-NO.
  8725
  8726*    IF PI-COMPANY-ID = 'DMD'
  8727*        MOVE WS-DMD-CERT-STATE    TO LA-DMD-UND-CODE
  8728*        MOVE WS-DMD-CERT-GROUPING TO LA-DMD-PROD-CODE
  8729*        MOVE WS-DMD-BEN-CODE      TO LA-DMD-BEN-CODE
  8730*        MOVE WS-DMD-CORR-TRLR-SEQ TO LA-DMD-CORR-TRLR-SEQ
  8731*        MOVE WS-DMD-LETTER-FORM   TO LA-DMD-LETTER-FORM
  8732*        MOVE WS-DMD-RES-ST        TO LA-DMD-RES-ST
  8733*        MOVE LOW-VALUES           TO LA-DMD-LETTER-PURGE-DT
  8734*                                     LA-DMD-LETTER-RELOAD-DT
  8735*        MOVE '1'                  TO LA-DMD-LETTER-STATUS
  8736*        EXEC CICS GETMAIN
  8737*            SET    (ADDRESS OF LETTER-ARCHIVE-TEMP)
  8738*            LENGTH (ARCT-LENGTH)
  8739*        END-EXEC.
  8740
  8741     IF COPIESL NOT = ZEROS
  8742        MOVE COPIESI             TO LA-NO-OF-COPIES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 171
* EL152.cbl
  8743     ELSE
  8744        MOVE  1                  TO LA-NO-OF-COPIES.
  8745
  8746     IF RESENDL NOT = ZEROS
  8747        MOVE RESEND-SAVE         TO LA-RESEND-DATE
  8748     ELSE
  8749        MOVE LOW-VALUES          TO LA-RESEND-DATE.
  8750
  8751     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
  8752     MOVE CURRENT-SAVE           TO LA-CREATION-DT.
  8753
  8754     IF PRINT-PERFORMED
  8755        MOVE CURRENT-SAVE        TO LA-INITIAL-PRINT-DATE
  8756     ELSE
  8757        MOVE LOW-VALUES          TO LA-INITIAL-PRINT-DATE.
  8758
  8759     MOVE LOW-VALUES             TO LA-RESEND-PRINT-DATE.
  8760     MOVE CORR-TRLR-SEQ          TO LA-CORR-TRLR-SEQ.
  8761     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8762
  8763     IF PI-PROMPT-LETTER NOT EQUAL 'Y'
  8764         PERFORM 6700-BUILD-NAPERSOFT THRU 6799-EXIT
  8765     END-IF.
  8766
  8767     IF WS-LABELS-SW = 'N'
  8768         NEXT SENTENCE
  8769     ELSE
  8770         SET TB-INDX TO 1
  8771         MOVE ZEROS                  TO SEQ-COUNTER
  8772         PERFORM 6480-FORMAT-ADDRESS
  8773               VARYING TB-INDX FROM 1 BY 1 UNTIL
  8774               TB-INDX > 6.
  8775
  8776     MOVE ZEROS                  TO SEQ-COUNTER.
  8777     MOVE 'N'                    TO WS-SKIP-EMAIL
  8778     PERFORM 6470-FORMAT-TEXT THRU 6479-EXIT
  8779             VARYING TB-INDX FROM 8 BY 1
  8780             UNTIL TB-INDX > PI-TOTAL-LINES.
  8781     MOVE 'Y'                    TO WS-SKIP-EMAIL.
  8782     IF SEQ-COUNTER < +15
  8783      AND WS-SKIP-EMAIL EQUAL 'N'
  8784        MOVE ARCH-NUMBER         TO TRAN-DL2-ARCHNO
  8785        MOVE PI-PROCESSOR-ID     TO TRAN-DL2-USER
  8786        MOVE SPACES              TO TRAN-DL2-CCC
  8787        STRING PI-CARRIER ' ' PI-CLAIM-NO ' ' PI-CERT-NO
  8788           DELIMITED BY SIZE
  8789           INTO TRAN-DL2-CCC
  8790        END-STRING
  8791
  8792* EXEC CICS WRITEQ TD
  8793*          QUEUE ('BTCH')
  8794*          FROM (TRAN-DATA-LINE1)
  8795*          LENGTH (80)
  8796*       END-EXEC
  8797     MOVE 80
  8798       TO DFHEIV11
  8799     MOVE 'BTCH' TO DFHEIV5
  8800*    MOVE '(" L                  &   #00008484' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 172
* EL152.cbl
  8801     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8802     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8803     MOVE X'2020233030303038343834' TO DFHEIV0(25:11)
  8804     CALL 'kxdfhei1' USING DFHEIV0,
  8805           DFHEIV5,
  8806           TRAN-DATA-LINE1,
  8807           DFHEIV11,
  8808           DFHEIV99,
  8809           DFHEIV99
  8810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8811
  8812* EXEC CICS WRITEQ TD
  8813*          QUEUE ('BTCH')
  8814*          FROM (TRAN-DATA-LINE2)
  8815*          LENGTH (80)
  8816*       END-EXEC
  8817     MOVE 80
  8818       TO DFHEIV11
  8819     MOVE 'BTCH' TO DFHEIV5
  8820*    MOVE '(" L                  &   #00008489' TO DFHEIV0
  8821     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8822     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8823     MOVE X'2020233030303038343839' TO DFHEIV0(25:11)
  8824     CALL 'kxdfhei1' USING DFHEIV0,
  8825           DFHEIV5,
  8826           TRAN-DATA-LINE2,
  8827           DFHEIV11,
  8828           DFHEIV99,
  8829           DFHEIV99
  8830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8831
  8832* EXEC CICS WRITEQ TD
  8833*          QUEUE ('BTCH')
  8834*          FROM (TRAN-DATA-LINE3)
  8835*          LENGTH (80)
  8836*       END-EXEC
  8837     MOVE 80
  8838       TO DFHEIV11
  8839     MOVE 'BTCH' TO DFHEIV5
  8840*    MOVE '(" L                  &   #00008494' TO DFHEIV0
  8841     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  8842     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8843     MOVE X'2020233030303038343934' TO DFHEIV0(25:11)
  8844     CALL 'kxdfhei1' USING DFHEIV0,
  8845           DFHEIV5,
  8846           TRAN-DATA-LINE3,
  8847           DFHEIV11,
  8848           DFHEIV99,
  8849           DFHEIV99
  8850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8851     END-IF
  8852     MOVE ER-0280                TO EMI-ERROR.
  8853
  8854     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8855     MOVE ARCH-NUMBER            TO ARCH-SUPPRESS
  8856     MOVE ARCH-EDIT              TO EMI-TEXT-VARIABLE (1).
  8857
  8858     GO TO 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 173
* EL152.cbl
  8859
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 174
* EL152.cbl
  8861 6470-FORMAT-TEXT.
  8862
  8863     IF REC-TEXT (TB-INDX) (1:16) = NAPERSOFT-LETTER
  8864         MOVE 'Y'                TO WS-SKIP-EMAIL
  8865     END-IF.
  8866
  8867     MOVE SPACES                 TO LETTER-ARCHIVE.
  8868     MOVE '3'                    TO LA-RECORD-TYPE
  8869                                    LA-RECORD-TYPE-A1.
  8870     MOVE 'LA'                   TO LA-RECORD-ID.
  8871     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8872                                    LA-ARCHIVE-NO-A1.
  8873     MOVE SEQ-COUNTER            TO LA-LINE-SEQ-NO
  8874                                    LA-LINE-SEQ-NO-A1.
  8875     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8876                                    LA-COMPANY-CD-A1.
  8877     MOVE REC-TEXT (TB-INDX)     TO LA-TEXT-LINE.
  8878     SET TB-INDX1 TO TB-INDX.
  8879     SET TB-INDX1 UP BY 1.
  8880     MOVE ZEROS                  TO INDX-WORK.
  8881
  8882 6472-LOOP.
  8883     IF TB-INDX1 < PI-TOTAL-LINES AND
  8884        REC-TEXT (TB-INDX1) = SPACES
  8885           SET TB-INDX1 UP BY 1
  8886           ADD 1                 TO INDX-WORK
  8887           GO TO 6472-LOOP.
  8888
  8889     IF REC-TEXT (TB-INDX1) = TOP-FORM
  8890        MOVE '99'                TO LA-SKIP-CONTROL
  8891        SET TB-INDX1 UP BY 1
  8892     ELSE
  8893        MOVE INDX-WORK           TO LA-SKIP-CONTROL.
  8894
  8895     SET TB-INDX TO TB-INDX1.
  8896     SET TB-INDX DOWN BY 1.
  8897     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8898     ADD 1 TO SEQ-COUNTER.
  8899
  8900 6479-EXIT.
  8901      EXIT.
  8902
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 175
* EL152.cbl
  8904 6480-FORMAT-ADDRESS.
  8905     MOVE SPACES                 TO LETTER-ARCHIVE.
  8906     MOVE '2'                    TO LA-RECORD-TYPE
  8907                                    LA-RECORD-TYPE-A1.
  8908     MOVE 'LA'                   TO LA-RECORD-ID.
  8909     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
  8910                                    LA-ARCHIVE-NO-A1.
  8911     MOVE SEQ-COUNTER            TO LA-LINE-SEQ-NO
  8912                                    LA-LINE-SEQ-NO-A1.
  8913     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8914                                    LA-COMPANY-CD-A1.
  8915     MOVE REC-TEXT (TB-INDX)     TO LA-ADDRESS-LINE.
  8916
  8917     PERFORM 6490-WRITE-ARCHIVE THRU 6499-EXIT.
  8918     ADD 1 TO SEQ-COUNTER.
  8919
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 176
* EL152.cbl
  8921 6490-WRITE-ARCHIVE.
  8922
  8923* EXEC CICS HANDLE CONDITION
  8924*        DUPKEY    (6499-EXIT)
  8925*    END-EXEC.
  8926*    MOVE '"$$                   ! * #00008570' TO DFHEIV0
  8927     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8928     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8929     MOVE X'2A20233030303038353730' TO DFHEIV0(25:11)
  8930     CALL 'kxdfhei1' USING DFHEIV0
  8931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8932
  8933
  8934*    IF PI-COMPANY-ID = 'DMD'
  8935*        MOVE LETTER-ARCHIVE     TO LETTER-ARCHIVE-TEMP
  8936*        MOVE 'LT'               TO LT-RECORD-ID
  8937*        EXEC CICS WRITE
  8938*            DATASET   (ARCT-ID)
  8939*            FROM      (LETTER-ARCHIVE-TEMP)
  8940*            RIDFLD    (LT-CONTROL-PRIMARY)
  8941*        END-EXEC.
  8942
  8943
  8944* EXEC CICS WRITE
  8945*         DATASET   (ARCH-ID)
  8946*         FROM      (LETTER-ARCHIVE)
  8947*         RIDFLD    (LA-CONTROL-PRIMARY)
  8948*    END-EXEC.
  8949     MOVE LENGTH OF
  8950      LETTER-ARCHIVE
  8951       TO DFHEIV11
  8952*    MOVE '&$ L                  ''   #00008583' TO DFHEIV0
  8953     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8954     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8955     MOVE X'2020233030303038353833' TO DFHEIV0(25:11)
  8956     CALL 'kxdfhei1' USING DFHEIV0,
  8957           ARCH-ID,
  8958           LETTER-ARCHIVE,
  8959           DFHEIV11,
  8960           LA-CONTROL-PRIMARY,
  8961           DFHEIV99,
  8962           DFHEIV99
  8963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8964
  8965
  8966 6499-EXIT.
  8967     EXIT.
  8968
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 177
* EL152.cbl
  8970 6500-BUILD-CORRESPOND.
  8971***************************************************************
  8972*    THIS ROUTINE WILL GET THE TRAILER SEQUENCE NUMBER FROM   *
  8973*    THE CLAIM MASTER AND BUILD A CORRESPONDENCE TRAILER      *
  8974*    USING THE NEW SEQUENCE NUMBER.                           *
  8975*    INPUT DATA FROM THE SCREEN IS USED TO CREATE THE NEW     *
  8976*    TRAILER RECORD.                                          *
  8977***************************************************************
  8978
  8979     MOVE PI-CLAIM-NO            TO CLAM-CLAIM.
  8980
  8981
  8982* EXEC CICS READ
  8983*         DATASET    (CLAM-ID)
  8984*         SET        (ADDRESS OF CLAIM-MASTER)
  8985*         RIDFLD     (CLAM-KEY)
  8986*         UPDATE
  8987*    END-EXEC.
  8988*    MOVE '&"S        EU         (   #00008604' TO DFHEIV0
  8989     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8990     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8991     MOVE X'2020233030303038363034' TO DFHEIV0(25:11)
  8992     CALL 'kxdfhei1' USING DFHEIV0,
  8993           CLAM-ID,
  8994           DFHEIV20,
  8995           DFHEIV99,
  8996           CLAM-KEY,
  8997           DFHEIV99,
  8998           DFHEIV99,
  8999           DFHEIV99
  9000     SET ADDRESS OF CLAIM-MASTER TO
  9001         DFHEIV20
  9002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9003
  9004
  9005     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
  9006
  9007     IF FOLLOW-UP-SAVE > CL-NEXT-FOLLOWUP-DT
  9008        MOVE FOLLOW-UP-SAVE      TO CL-NEXT-FOLLOWUP-DT.
  9009
  9010     IF RESEND-SAVE > CL-NEXT-FOLLOWUP-DT
  9011        MOVE RESEND-SAVE         TO CL-NEXT-FOLLOWUP-DT.
  9012
  9013     IF MAINTI = 'C'
  9014        MOVE '2'                 TO CL-LAST-MAINT-TYPE.
  9015
  9016     IF MAINTI = 'R'
  9017        PERFORM 6600-SET-ADDR-SEQ THRU 6699-EXIT
  9018        MOVE ACTV-SEQ            TO PI-ADDR-SEQ.
  9019
  9020*    IF PI-COMPANY-ID = 'DMD'
  9021*        MOVE 04                 TO CL-ACTIVITY-CODE.
  9022
  9023
  9024* EXEC CICS GETMAIN
  9025*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  9026*         INITIMG   (GETMAIN-SPACE)
  9027*         LENGTH    (ACTV-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 178
* EL152.cbl
  9028*    END-EXEC.
  9029*    MOVE ',"IL                  $   #00008629' TO DFHEIV0
  9030     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9031     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9032     MOVE X'2020233030303038363239' TO DFHEIV0(25:11)
  9033     CALL 'kxdfhei1' USING DFHEIV0,
  9034           DFHEIV20,
  9035           ACTV-LENGTH,
  9036           GETMAIN-SPACE
  9037     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9038         DFHEIV20
  9039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9040
  9041
  9042     MOVE 'AT'                   TO AT-RECORD-ID.
  9043     MOVE  4                     TO AT-TRAILER-TYPE.
  9044     MOVE CURRENT-SAVE           TO AT-RECORDED-DT
  9045                                    CL-LAST-MAINT-DT
  9046                                    AT-CORR-LAST-MAINT-DT
  9047     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9048                                    CL-LAST-MAINT-USER
  9049                                    AT-CORR-LAST-UPDATED-BY
  9050     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  9051                                    CL-LAST-MAINT-HHMMSS.
  9052     MOVE ACTV-KEY               TO AT-CONTROL-PRIMARY.
  9053     MOVE PI-CLAIM-NO            TO AT-CLAIM-NO.
  9054     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
  9055                                    CORR-TRLR-SEQ.
  9056     MOVE CURRENT-SAVE           TO AT-LETTER-SENT-DT.
  9057     MOVE FOLLOW-UP-SAVE         TO AT-RECEIPT-FOLLOW-UP.
  9058     MOVE RESEND-SAVE            TO AT-AUTO-RE-SEND-DT.
  9059     MOVE LOW-VALUES             TO AT-LETTER-ANSWERED-DT
  9060                                    AT-LETTER-PURGED-DT.
  9061     MOVE ARCH-NUMBER            TO AT-LETTER-ARCHIVE-NO.
  9062     MOVE '1'                    TO AT-LETTER-ORIGIN.
  9063     MOVE PI-RESEND-FORM-NUMBER  TO AT-RESEND-LETTER-FORM.
  9064     MOVE PI-AUTO-CLOSE-IND      TO AT-AUTO-CLOSE-IND.
  9065     MOVE PI-LETTER-TO-BENE      TO AT-LETTER-TO-BENE.
  9066
  9067*    IF PI-COMPANY-ID = 'DMD'
  9068*        MOVE '1'                TO AT-DMD-LETTER-STATUS
  9069*        IF PI-BSR-AUTOMATED
  9070*            MOVE 'A'            TO AT-DMD-BSR-CODE.
  9071*
  9072     IF FORML  NOT = ZEROS
  9073        MOVE FORMI               TO AT-STD-LETTER-FORM
  9074     ELSE
  9075        MOVE SPACES              TO AT-STD-LETTER-FORM.
  9076
  9077     IF REL NOT = ZEROS
  9078        MOVE REI                 TO AT-REASON-TEXT
  9079     ELSE
  9080        MOVE SPACES              TO AT-REASON-TEXT.
  9081
  9082*    IF PI-COMPANY-ID = 'HAN'  OR  'JHL'
  9083*        MOVE AT-REASON-TEXT     TO WS-REASON-TEXT
  9084*        IF WS-RE-NDX NUMERIC  AND
  9085*           WS-RE-NDX > ZERO   AND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 179
* EL152.cbl
  9086*           WS-RE-NDX < 33
  9087*            MOVE HAN-REASON-TEXT (WS-RE-NDX)
  9088*                                TO AT-REASON-TEXT.
  9089
  9090     MOVE PI-ADDR-SEQ            TO AT-ADDRESS-REC-SEQ-NO.
  9091
  9092     IF PI-ADDR-TYPE > SPACES
  9093         MOVE PI-ADDR-TYPE          TO AT-ADDRESEE-TYPE
  9094         MOVE REC-TEXT (1)          TO AT-ADDRESSEE-NAME
  9095     ELSE
  9096     IF W-ACCOUNT > ZEROS
  9097         MOVE 'A'                   TO AT-ADDRESEE-TYPE
  9098         MOVE SS06D                 TO AT-ADDRESSEE-NAME
  9099     ELSE
  9100     IF W-BENEFICIARY > ZEROS
  9101          MOVE 'B'                  TO AT-ADDRESEE-TYPE
  9102          IF W-BENEFICIARY = 9
  9103              MOVE SS61D            TO AT-ADDRESSEE-NAME
  9104            ELSE
  9105              MOVE SS43D            TO AT-ADDRESSEE-NAME
  9106     ELSE
  9107     IF W-EMPLOYER > ZEROS
  9108          MOVE 'E'                  TO AT-ADDRESEE-TYPE
  9109          MOVE SS48D                TO AT-ADDRESSEE-NAME
  9110     ELSE
  9111     IF W-INSURED > ZEROS
  9112          MOVE 'I'                  TO AT-ADDRESEE-TYPE
  9113          MOVE SS57D                TO AT-ADDRESSEE-NAME
  9114     ELSE
  9115     IF W-PHYSICIAN > ZEROS
  9116          MOVE 'P'                  TO AT-ADDRESEE-TYPE
  9117          MOVE SS47D                TO AT-ADDRESSEE-NAME
  9118     ELSE
  9119     IF W-OTHER-1 > ZEROS
  9120          MOVE 'O'                  TO AT-ADDRESEE-TYPE
  9121          MOVE SS49D                TO AT-ADDRESSEE-NAME
  9122     ELSE
  9123     IF W-OTHER-2 > ZEROS
  9124          MOVE 'Q'                  TO AT-ADDRESEE-TYPE
  9125          MOVE SS50D                TO AT-ADDRESSEE-NAME
  9126     ELSE
  9127          MOVE SPACES               TO AT-ADDRESEE-TYPE
  9128                                       AT-ADDRESSEE-NAME.
  9129     IF PRINT-PERFORMED
  9130        MOVE CURRENT-SAVE        TO AT-INITIAL-PRINT-DATE
  9131     ELSE
  9132        MOVE LOW-VALUES          TO AT-INITIAL-PRINT-DATE.
  9133
  9134     MOVE LOW-VALUES             TO AT-RESEND-PRINT-DATE.
  9135
  9136*    IF PI-COMPANY-ID = 'DMD'
  9137*        MOVE CL-CERT-STATE          TO WS-DMD-CERT-STATE
  9138*        MOVE CL-CERT-GROUPING (5:2) TO WS-DMD-CERT-GROUPING
  9139*        MOVE BEN-HOLD               TO WS-DMD-BEN-CODE
  9140*        MOVE AT-SEQUENCE-NO         TO WS-DMD-CORR-TRLR-SEQ
  9141*        MOVE AT-STD-LETTER-FORM     TO WS-DMD-LETTER-FORM.
  9142
  9143
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 180
* EL152.cbl
  9144* EXEC CICS WRITE
  9145*         DATASET    (ACTV-ID)
  9146*         FROM       (ACTIVITY-TRAILERS)
  9147*         RIDFLD     (AT-CONTROL-PRIMARY)
  9148*    END-EXEC.
  9149     MOVE LENGTH OF
  9150      ACTIVITY-TRAILERS
  9151       TO DFHEIV11
  9152*    MOVE '&$ L                  ''   #00008736' TO DFHEIV0
  9153     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9154     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9155     MOVE X'2020233030303038373336' TO DFHEIV0(25:11)
  9156     CALL 'kxdfhei1' USING DFHEIV0,
  9157           ACTV-ID,
  9158           ACTIVITY-TRAILERS,
  9159           DFHEIV11,
  9160           AT-CONTROL-PRIMARY,
  9161           DFHEIV99,
  9162           DFHEIV99
  9163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9164
  9165
  9166
  9167* EXEC CICS HANDLE CONDITION
  9168*        DUPKEY      (6599-EXIT)
  9169*    END-EXEC.
  9170*    MOVE '"$$                   ! + #00008742' TO DFHEIV0
  9171     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9172     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9173     MOVE X'2B20233030303038373432' TO DFHEIV0(25:11)
  9174     CALL 'kxdfhei1' USING DFHEIV0
  9175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9176
  9177
  9178
  9179* EXEC CICS REWRITE
  9180*         DATASET    (CLAM-ID)
  9181*         FROM       (CLAIM-MASTER)
  9182*    END-EXEC.
  9183     MOVE LENGTH OF
  9184      CLAIM-MASTER
  9185       TO DFHEIV11
  9186*    MOVE '&& L                  %   #00008746' TO DFHEIV0
  9187     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9188     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9189     MOVE X'2020233030303038373436' TO DFHEIV0(25:11)
  9190     CALL 'kxdfhei1' USING DFHEIV0,
  9191           CLAM-ID,
  9192           CLAIM-MASTER,
  9193           DFHEIV11,
  9194           DFHEIV99
  9195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9196
  9197
  9198 6599-EXIT.
  9199      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 181
* EL152.cbl
  9201 6600-SET-ADDR-SEQ.
  9202     IF ADDRL = ZEROS
  9203        GO TO 6699-EXIT.
  9204
  9205     MOVE ADDRI                  TO PI-ADDR-TYPE
  9206                                    WS-ADDR-TYPE-CD.
  9207     IF WS-ADDR-SEQ NOT NUMERIC
  9208        GO TO 6699-EXIT.
  9209
  9210     MOVE ZEROS                  TO PI-ADDR-SEQ.
  9211
  9212     IF WS-ADDR-TYPE = 'I'
  9213        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9214     ELSE
  9215     IF WS-ADDR-TYPE = 'A'
  9216        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9217        ADD +20                  TO ACTV-SEQ
  9218     ELSE
  9219     IF WS-ADDR-TYPE = 'B'
  9220        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9221        ADD +10                  TO ACTV-SEQ
  9222     ELSE
  9223     IF WS-ADDR-TYPE = 'P'
  9224        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9225        ADD +30                  TO ACTV-SEQ
  9226     ELSE
  9227     IF WS-ADDR-TYPE = 'E'
  9228        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9229        ADD +40                  TO ACTV-SEQ
  9230     ELSE
  9231     IF WS-ADDR-TYPE = 'O'
  9232        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9233        ADD +50                  TO ACTV-SEQ
  9234     ELSE
  9235     IF WS-ADDR-TYPE = 'Q'
  9236        MOVE WS-ADDR-SEQ-NUM     TO ACTV-SEQ
  9237        ADD +60                  TO ACTV-SEQ.
  9238
  9239 6699-EXIT.
  9240      EXIT.
  9241
  9242 6700-BUILD-NAPERSOFT.
  9243
  9244
  9245* EXEC CICS GETMAIN
  9246*         SET      (ADDRESS OF NAPERSOFT-FILE)
  9247*         LENGTH   (NAPS-LENGTH)
  9248*    END-EXEC.
  9249*    MOVE '," L                  $   #00008797' TO DFHEIV0
  9250     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9251     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9252     MOVE X'2020233030303038373937' TO DFHEIV0(25:11)
  9253     CALL 'kxdfhei1' USING DFHEIV0,
  9254           DFHEIV20,
  9255           NAPS-LENGTH,
  9256           DFHEIV99
  9257     SET ADDRESS OF NAPERSOFT-FILE TO
  9258         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 182
* EL152.cbl
  9259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9260
  9261
  9262     MOVE LOW-VALUES            TO  NAPERSOFT-FILE.
  9263     MOVE 'NA'                  TO  NA-RECORD-ID.
  9264     MOVE PI-COMPANY-CD         TO  NA-COMPANY-CD.
  9265     MOVE PI-CARRIER            TO  NA-CARRIER.
  9266     MOVE PI-CLAIM-NO           TO  NA-CLAIM-NO.
  9267     MOVE PI-CERT-NO            TO  NA-CERT-NO.
  9268     MOVE ARCH-NUMBER           TO  NA-ARCHIVE-NO.
  9269     MOVE FORMI                 TO  NA-LETTER-ID.
  9270     MOVE PI-PROCESSOR-ID       TO  NA-PROCESSOR-ID.
  9271     MOVE CURRENT-SAVE          TO  NA-CREATION-DT.
  9272     IF PRINT-PERFORMED
  9273         MOVE CURRENT-SAVE      TO  NA-INITIAL-PRINT-DT
  9274     ELSE
  9275         MOVE LOW-VALUES        TO  NA-INITIAL-PRINT-DT
  9276     END-IF.
  9277     MOVE FOLLOW-UP-SAVE        TO  NA-FOLLOW-UP-DT.
  9278     MOVE RESEND-SAVE           TO  NA-RESEND-DT
  9279     MOVE PI-RESEND-FORM-NUMBER TO  NA-RESEND-LETTER-ID.
  9280     IF COPIESL NOT = ZEROS
  9281         MOVE COPIESI           TO  NA-NO-OF-COPIES
  9282     ELSE
  9283         MOVE 1                 TO  NA-NO-OF-COPIES
  9284     END-IF.
  9285     IF PI-LETTER-ADDRESS-TYPE = ' 0'
  9286         MOVE LOW-VALUES        TO  NA-ADDRESS-TYPE
  9287     ELSE
  9288         MOVE PI-LETTER-ADDRESS-TYPE TO NA-ADDRESS-TYPE
  9289     END-IF.
  9290     MOVE CORR-TRLR-SEQ         TO  NA-CORR-TRLR-SEQ.
  9291     MOVE PI-ENCLOSURE-CD       TO  NA-ENCLOSURE-CD.
  9292
  9293
  9294* EXEC CICS WRITE
  9295*         DATASET    (NAPS-ID)
  9296*         FROM       (NAPERSOFT-FILE)
  9297*         RIDFLD     (NA-CONTROL-PRIMARY)
  9298*    END-EXEC.
  9299     MOVE LENGTH OF
  9300      NAPERSOFT-FILE
  9301       TO DFHEIV11
  9302*    MOVE '&$ L                  ''   #00008833' TO DFHEIV0
  9303     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9304     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9305     MOVE X'2020233030303038383333' TO DFHEIV0(25:11)
  9306     CALL 'kxdfhei1' USING DFHEIV0,
  9307           NAPS-ID,
  9308           NAPERSOFT-FILE,
  9309           DFHEIV11,
  9310           NA-CONTROL-PRIMARY,
  9311           DFHEIV99,
  9312           DFHEIV99
  9313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9314
  9315
  9316 6799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 183
* EL152.cbl
  9317      EXIT.
  9318
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 184
* EL152.cbl
  9320 7000-READ-ADDR.
  9321     IF PI-RETURN-TO-PROGRAM NOT = PGM-EL150
  9322        IF ADDRL = ZEROS
  9323           GO TO 7099-EXIT
  9324        ELSE
  9325           MOVE ER-0374             TO EMI-ERROR
  9326           MOVE -1                  TO ADDRL
  9327           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9328           GO TO 7099-EXIT.
  9329
  9330     MOVE PI-CLAIM-NO            TO CLAM-CLAIM
  9331                                    ACTV-CLAIM.
  9332
  9333
  9334* EXEC CICS HANDLE CONDITION
  9335*         NOTOPEN    (8860-CLAM-NOT-OPEN)
  9336*         NOTFND     (7090-CLAIM-NOT-FOUND)
  9337*     END-EXEC.
  9338*    MOVE '"$JI                  ! , #00008856' TO DFHEIV0
  9339     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9340     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9341     MOVE X'2C20233030303038383536' TO DFHEIV0(25:11)
  9342     CALL 'kxdfhei1' USING DFHEIV0
  9343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9344
  9345
  9346
  9347* EXEC CICS READ
  9348*         DATASET    (CLAM-ID)
  9349*         SET        (ADDRESS OF CLAIM-MASTER)
  9350*         RIDFLD     (CLAM-KEY)
  9351*    END-EXEC.
  9352*    MOVE '&"S        E          (   #00008861' TO DFHEIV0
  9353     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9354     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9355     MOVE X'2020233030303038383631' TO DFHEIV0(25:11)
  9356     CALL 'kxdfhei1' USING DFHEIV0,
  9357           CLAM-ID,
  9358           DFHEIV20,
  9359           DFHEIV99,
  9360           CLAM-KEY,
  9361           DFHEIV99,
  9362           DFHEIV99,
  9363           DFHEIV99
  9364     SET ADDRESS OF CLAIM-MASTER TO
  9365         DFHEIV20
  9366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9367
  9368
  9369*    IF PI-COMPANY-ID = 'DMD'
  9370*            AND
  9371*       NOT SYSTEM-MODIFY-CAP
  9372*            AND
  9373*        HIGHEST-PRIORITY
  9374*        IF MAINTI = 'R'
  9375*            MOVE ER-0909        TO EMI-ERROR
  9376*            MOVE -1             TO ADDRL
  9377*            MOVE AL-UABON       TO ADDRA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 185
* EL152.cbl
  9378*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9379*            GO TO 8200-SEND-DATAONLY
  9380*        ELSE
  9381*            MOVE ER-0900        TO EMI-ERROR
  9382*            MOVE -1             TO ADDRL
  9383*            MOVE AL-UABON       TO ADDRA
  9384*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9385*            GO TO 8200-SEND-DATAONLY.
  9386
  9387     IF ADDRL = ZEROS
  9388        GO TO 7099-EXIT.
  9389
  9390*    IF PI-COMPANY-ID = 'DMD'
  9391*        IF MAINTI = 'C'
  9392*           IF CL-BENEFICIARY = '0000B0CA10' OR '0000B0CAN0' OR
  9393*                               '0000B0CAS0' OR '0000B0CA50' OR
  9394*                               '0000B0CAA0' OR '0000B0CAB0' OR
  9395*                               '0000B0CAC0' OR '0000B0CAD0' OR
  9396*                               '0000B0CO20' OR '0000B0MN10' OR
  9397*                               '0000B0MN20' OR '0000B0MN30' OR
  9398*                               '0000B0MN40' OR '0000B0MN50' OR
  9399*                               '0000B0MN60' OR '0000B0MN70'
  9400*           IF ADDRI(1:1) = 'B'
  9401*              MOVE ER-8158     TO EMI-ERROR
  9402*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9403*              MOVE -1          TO MAINTL
  9404*              GO TO 8200-SEND-DATAONLY.
  9405*
  9406*    IF PI-COMPANY-ID = 'DMD'
  9407*      PERFORM 4000-SET-BSR THRU 4000-EXIT
  9408*      IF PI-BSR-AUTOMATED
  9409*        IF MAINTI = 'C'
  9410*           MOVE ER-7843          TO EMI-ERROR
  9411*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9412*           MOVE -1               TO MAINTL
  9413*           GO TO 8200-SEND-DATAONLY.
  9414
  9415     PERFORM 6600-SET-ADDR-SEQ THRU 6699-EXIT.
  9416
  9417     MOVE ADDRI TO WS-ADDR-TYPE-CD.
  9418
  9419*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  9420*        GO TO 7040-READ-PRODUCER.
  9421
  9422 7010-READ-ACCT.
  9423
  9424     MOVE CL-CERT-GROUPING       TO ACCT-GROUPING.
  9425     MOVE CL-CERT-STATE          TO ACCT-STATE.
  9426     MOVE CL-CERT-ACCOUNT        TO ACCT-ACCOUNT.
  9427     MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DATE.
  9428
  9429
  9430* EXEC CICS HANDLE CONDITION
  9431*         NOTOPEN    (8880-ACCT-NOT-OPEN)
  9432*         NOTFND     (7080-ACCT-NOT-FOUND)
  9433*    END-EXEC.
  9434*    MOVE '"$JI                  ! - #00008927' TO DFHEIV0
  9435     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 186
* EL152.cbl
  9436     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9437     MOVE X'2D20233030303038393237' TO DFHEIV0(25:11)
  9438     CALL 'kxdfhei1' USING DFHEIV0
  9439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9440
  9441
  9442     PERFORM 8000-STARTBR-ERACCT THRU 8000-STARTBR-EXIT.
  9443
  9444     MOVE ACCT-PARTIAL-KEY       TO ACCT-SAVE-KEY.
  9445
  9446 7020-READNEXT.
  9447
  9448     PERFORM 8000-READNEXT-ERACCT THRU 8000-READNEXT-EXIT.
  9449
  9450     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
  9451        IF WS-SAVE-ACCT-RECORD = SPACES
  9452            GO TO 7080-ACCT-NOT-FOUND
  9453        ELSE
  9454            MOVE 'Y'                 TO  WS-ACCT-READ-SW
  9455            MOVE AM-CONTROL-PRIMARY  TO  ACCT-KEY
  9456            MOVE WS-SAVE-ACCT-RECORD TO  ACCOUNT-MASTER
  9457            GO TO 7030-CONTINUE-BUILD-ADDR.
  9458
  9459     IF AM-EXPIRATION-DT = HIGH-VALUES
  9460         NEXT SENTENCE
  9461     ELSE
  9462         MOVE ACCOUNT-MASTER         TO  WS-SAVE-ACCT-RECORD
  9463         GO TO 7020-READNEXT.
  9464
  9465     MOVE AM-CONTROL-PRIMARY TO ACCT-KEY.
  9466     MOVE 'Y'                TO WS-ACCT-READ-SW.
  9467
  9468 7030-CONTINUE-BUILD-ADDR.
  9469
  9470     MOVE SPACES             TO  WS-SAVE-ACCT-RECORD.
  9471
  9472     IF WS-ADDR-TYPE-CD = 'A0'
  9473        MOVE ZEROS               TO PI-ADDR-SEQ
  9474     ELSE
  9475        GO TO 7067-CHECK-BENE-ADDR.
  9476
  9477     MOVE SPACES             TO               WS-LABEL-HOLD-AREA.
  9478     MOVE AM-NAME            TO  REC-TEXT (1) WS-LABEL-LINES (1).
  9479     MOVE AM-PERSON          TO  REC-TEXT (2) WS-LABEL-LINES (2).
  9480     MOVE AM-ADDRS           TO  REC-TEXT (3) WS-LABEL-LINES (3).
  9481*    MOVE AM-CITY            TO  REC-TEXT (4) WS-LABEL-LINES (4).
  9482     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE DELIMITED BY '  '
  9483        INTO WS-LABEL-LINES (4)
  9484     END-STRING
  9485     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)
  9486     MOVE SPACES             TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9487
  9488     MOVE SPACES             TO  WS-ZIP-CODE.
  9489
  9490     IF AM-CANADIAN-POST-CODE
  9491         MOVE AM-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9492         MOVE AM-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9493     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 187
* EL152.cbl
  9494         MOVE AM-ZIP-PRIME       TO  WS-AM-ZIP-CODE
  9495         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9496             MOVE '-'            TO  WS-AM-ZIP-DASH
  9497             MOVE AM-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9498
  9499     MOVE WS-ZIP-CODE        TO  REC-TEXT (6) WS-LABEL-LINES (6).
  9500
  9501     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9502
  9503     MOVE WS-LABEL-LINES (1) TO  REC-TEXT (1)    SS05-1D.
  9504     MOVE WS-LABEL-LINES (2) TO  REC-TEXT (2)    SS05-2D.
  9505     MOVE WS-LABEL-LINES (3) TO  REC-TEXT (3)    SS05-3D.
  9506     MOVE WS-LABEL-LINES (4) TO  REC-TEXT (4)    SS05-4D.
  9507     MOVE WS-LABEL-LINES (5) TO  REC-TEXT (5)    SS05-5D.
  9508     MOVE WS-LABEL-LINES (6) TO  REC-TEXT (6)    SS05-6D.
  9509
  9510     GO TO 7099-EXIT.
  9511
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 188
* EL152.cbl
  9513*7040-READ-PRODUCER. Remove as dead code
  9514*7050-READNEXT. Remove as dead code
  9515*7060-CONTINUE-BUILD-ADDR. Remove as dead code
  9516 7067-CHECK-BENE-ADDR.
  9517
  9518*    IF PI-COMPANY-ID = 'DMD'
  9519*        IF WS-ADDR-TYPE-CD = 'B9'
  9520*            GO TO 7067-CHECK-BENE-ADDR-9.
  9521
  9522     IF WS-ADDR-TYPE-CD NOT = 'B0'
  9523         GO TO 7068-CONTINUE-BUILD-ADDR.
  9524
  9525     IF CL-BENEFICIARY = SPACES
  9526         GO TO 7070-ACTV-NOT-FOUND.
  9527
  9528
  9529* EXEC CICS HANDLE CONDITION
  9530*         NOTFND     (7070-ACTV-NOT-FOUND)
  9531*    END-EXEC.
  9532*    MOVE '"$I                   ! . #00009018' TO DFHEIV0
  9533     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9534     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9535     MOVE X'2E20233030303039303138' TO DFHEIV0(25:11)
  9536     CALL 'kxdfhei1' USING DFHEIV0
  9537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9538
  9539
  9540     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
  9541     MOVE 'B'                    TO BENE-REC-TYPE.
  9542     MOVE CL-BENEFICIARY         TO BENE-NUMBER.
  9543
  9544
  9545* EXEC CICS READ
  9546*         DATASET    (BENE-ID)
  9547*         SET        (ADDRESS OF BENEFICIARY-MASTER)
  9548*         RIDFLD     (BENE-KEY)
  9549*    END-EXEC.
  9550*    MOVE '&"S        E          (   #00009026' TO DFHEIV0
  9551     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9552     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9553     MOVE X'2020233030303039303236' TO DFHEIV0(25:11)
  9554     CALL 'kxdfhei1' USING DFHEIV0,
  9555           BENE-ID,
  9556           DFHEIV20,
  9557           DFHEIV99,
  9558           BENE-KEY,
  9559           DFHEIV99,
  9560           DFHEIV99,
  9561           DFHEIV99
  9562     SET ADDRESS OF BENEFICIARY-MASTER TO
  9563         DFHEIV20
  9564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9565
  9566
  9567     MOVE SPACES              TO  WS-LABEL-HOLD-AREA.
  9568     MOVE BE-MAIL-TO-NAME     TO  REC-TEXT (1) WS-LABEL-LINES (1).
  9569     MOVE BE-ADDRESS-LINE-1   TO  REC-TEXT (2) WS-LABEL-LINES (2).
  9570     MOVE BE-ADDRESS-LINE-2   TO  REC-TEXT (3) WS-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 189
* EL152.cbl
  9571     MOVE BE-ADDRESS-LINE-3   TO  REC-TEXT (4) WS-LABEL-LINES (4).
  9572*    MOVE BE-CITY-STATE       TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9573     STRING BE-CITY ' ' BE-STATE DELIMITED BY '  '
  9574        INTO WS-LABEL-LINES (5)
  9575     END-STRING
  9576     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)
  9577
  9578     MOVE SPACES              TO  WS-ZIP-CODE.
  9579     IF BE-CANADIAN-POST-CODE
  9580         MOVE BE-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9581         MOVE BE-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9582     ELSE
  9583         MOVE BE-ZIP-PRIME       TO  WS-AM-ZIP-CODE
  9584         IF BE-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9585             MOVE '-'            TO  WS-AM-ZIP-DASH
  9586             MOVE BE-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9587
  9588     MOVE WS-ZIP-CODE         TO  REC-TEXT (6) WS-LABEL-LINES (6).
  9589
  9590     GO TO 7069-SET-ADDR.
  9591
  9592 7067-CHECK-BENE-ADDR-9.
  9593
  9594     IF CL-BENEFICIARY = SPACES
  9595         GO TO 7070-ACTV-NOT-FOUND.
  9596
  9597
  9598* EXEC CICS HANDLE CONDITION
  9599*         NOTFND     (7070-ACTV-NOT-FOUND)
  9600*    END-EXEC.
  9601*    MOVE '"$I                   ! / #00009062' TO DFHEIV0
  9602     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9603     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9604     MOVE X'2F20233030303039303632' TO DFHEIV0(25:11)
  9605     CALL 'kxdfhei1' USING DFHEIV0
  9606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9607
  9608
  9609     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
  9610     MOVE 'B'                    TO BENE-REC-TYPE.
  9611     MOVE CL-BENEFICIARY         TO BENE-NUMBER.
  9612
  9613
  9614* EXEC CICS READ
  9615*         DATASET    (BENE-ID)
  9616*         SET        (ADDRESS OF BENEFICIARY-MASTER)
  9617*         RIDFLD     (BENE-KEY)
  9618*    END-EXEC.
  9619*    MOVE '&"S        E          (   #00009070' TO DFHEIV0
  9620     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9621     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9622     MOVE X'2020233030303039303730' TO DFHEIV0(25:11)
  9623     CALL 'kxdfhei1' USING DFHEIV0,
  9624           BENE-ID,
  9625           DFHEIV20,
  9626           DFHEIV99,
  9627           BENE-KEY,
  9628           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 190
* EL152.cbl
  9629           DFHEIV99,
  9630           DFHEIV99
  9631     SET ADDRESS OF BENEFICIARY-MASTER TO
  9632         DFHEIV20
  9633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9634
  9635
  9636     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
  9637     MOVE BE-MAIL-TO-NAME2       TO REC-TEXT (1)
  9638                                    WS-LABEL-LINES (1).
  9639     MOVE BE-ADDRESS-LINE-12     TO REC-TEXT (2)
  9640                                    WS-LABEL-LINES (2).
  9641     MOVE BE-ADDRESS-LINE-22     TO REC-TEXT (3)
  9642                                    WS-LABEL-LINES (3).
  9643     MOVE BE-ADDRESS-LINE-32     TO REC-TEXT (4)
  9644                                    WS-LABEL-LINES (4).
  9645*    MOVE BE-CITY-STATE2         TO REC-TEXT (5)
  9646*                                   WS-LABEL-LINES (5).
  9647     STRING BE-CITY2 ' ' BE-STATE2 DELIMITED BY '  '
  9648        INTO WS-LABEL-LINES (5)
  9649     END-STRING
  9650     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)
  9651
  9652     MOVE SPACES                 TO WS-ZIP-CODE.
  9653
  9654     IF BE-CANADIAN-POST-CODE2
  9655         MOVE BE-CAN-POSTAL-12   TO WS-CAN-POSTAL-1
  9656         MOVE BE-CAN-POSTAL-22   TO WS-CAN-POSTAL-2
  9657     ELSE
  9658         MOVE BE-ZIP-PRIME2      TO WS-AM-ZIP-CODE
  9659         IF BE-ZIP-PLUS42 NOT = SPACES AND ZEROS
  9660             MOVE '-'            TO WS-AM-ZIP-DASH
  9661             MOVE BE-ZIP-PLUS42  TO WS-AM-ZIP-PLUS4.
  9662
  9663     MOVE WS-ZIP-CODE            TO REC-TEXT (6)
  9664                                    WS-LABEL-LINES (6).
  9665
  9666     GO TO 7069-SET-ADDR.
  9667
  9668 7068-CONTINUE-BUILD-ADDR.
  9669
  9670     IF ACTV-SEQ = ZEROS
  9671        GO TO 7070-ACTV-NOT-FOUND.
  9672
  9673     MOVE ACTV-SEQ               TO PI-ADDR-SEQ.
  9674
  9675
  9676* EXEC CICS HANDLE CONDITION
  9677*         NOTOPEN    (8870-ACTV-NOT-OPEN)
  9678*         NOTFND     (7070-ACTV-NOT-FOUND)
  9679*    END-EXEC.
  9680*    MOVE '"$JI                  ! 0 #00009115' TO DFHEIV0
  9681     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9682     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9683     MOVE X'3020233030303039313135' TO DFHEIV0(25:11)
  9684     CALL 'kxdfhei1' USING DFHEIV0
  9685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9686
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 191
* EL152.cbl
  9687
  9688
  9689* EXEC CICS READ
  9690*         DATASET    (ACTV-ID)
  9691*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
  9692*         RIDFLD     (ACTV-KEY)
  9693*    END-EXEC.
  9694*    MOVE '&"S        E          (   #00009120' TO DFHEIV0
  9695     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9696     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9697     MOVE X'2020233030303039313230' TO DFHEIV0(25:11)
  9698     CALL 'kxdfhei1' USING DFHEIV0,
  9699           ACTV-ID,
  9700           DFHEIV20,
  9701           DFHEIV99,
  9702           ACTV-KEY,
  9703           DFHEIV99,
  9704           DFHEIV99,
  9705           DFHEIV99
  9706     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9707         DFHEIV20
  9708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9709
  9710
  9711     MOVE SPACES            TO              WS-LABEL-HOLD-AREA.
  9712     MOVE AT-MAIL-TO-NAME   TO REC-TEXT (1) WS-LABEL-LINES (1).
  9713     MOVE AT-ADDRESS-LINE-1 TO REC-TEXT (2) WS-LABEL-LINES (2).
  9714     MOVE AT-ADDRESS-LINE-2 TO REC-TEXT (3) WS-LABEL-LINES (3).
  9715*    MOVE AT-CITY-STATE     TO REC-TEXT (4) WS-LABEL-LINES (4).
  9716     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
  9717        INTO WS-LABEL-LINES (4)
  9718     END-STRING
  9719     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)
  9720
  9721     MOVE SPACES            TO  WS-ZIP-CODE.
  9722     IF AT-CANADIAN-POST-CODE
  9723         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
  9724         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
  9725     ELSE
  9726         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
  9727         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9728             MOVE '-'            TO  WS-AM-ZIP-DASH
  9729             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
  9730
  9731     MOVE WS-ZIP-CODE       TO  REC-TEXT (5) WS-LABEL-LINES (5).
  9732
  9733     MOVE SPACES            TO  REC-TEXT (6).
  9734
  9735 7069-SET-ADDR.
  9736     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9737
  9738     MOVE WS-LABEL-LINES (1) TO  REC-TEXT (1)    SS05-1D.
  9739     MOVE WS-LABEL-LINES (2) TO  REC-TEXT (2)    SS05-2D.
  9740     MOVE WS-LABEL-LINES (3) TO  REC-TEXT (3)    SS05-3D.
  9741     MOVE WS-LABEL-LINES (4) TO  REC-TEXT (4)    SS05-4D.
  9742     MOVE WS-LABEL-LINES (5) TO  REC-TEXT (5)    SS05-5D.
  9743     MOVE SPACES             TO  REC-TEXT (6)    SS05-6D.
  9744
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 192
* EL152.cbl
  9745     GO TO 7099-EXIT.
  9746
  9747 7070-ACTV-NOT-FOUND.
  9748
  9749     IF ACTV-SEQ NOT = +29
  9750        GO TO 7075-CONTINUE-ACTV-ERROR.
  9751
  9752*    IF CL-SYSTEM-IDENTIFIER = 'CV'
  9753*        GO TO 7099-EXIT.
  9754
  9755     IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
  9756        MOVE ZEROS         TO AM-3RD-PARTY-NOTIF-LEVEL
  9757        GO TO 7075-CONTINUE-ACTV-ERROR.
  9758
  9759     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = SPACES OR ZEROS
  9760        GO TO 7075-CONTINUE-ACTV-ERROR.
  9761
  9762     MOVE PI-COMPANY-CD   TO WS-ERCOMP-COMPANY-CD
  9763     MOVE AM-CARRIER      TO WS-ERCOMP-CARRIER
  9764     MOVE AM-GROUPING     TO WS-ERCOMP-GROUPING
  9765     MOVE 'A'             TO WS-ERCOMP-TYPE
  9766     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
  9767                          TO WS-ERCOMP-RESP-NO.
  9768
  9769     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
  9770         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
  9771                                       'G' OR 'B' or 'S'
  9772             MOVE 'G'            TO WS-ERCOMP-TYPE
  9773             MOVE LOW-VALUES     TO WS-ERCOMP-ACCOUNT
  9774         ELSE
  9775             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
  9776                                 TO WS-ERCOMP-ACCOUNT
  9777     ELSE
  9778         MOVE 'G'                TO WS-ERCOMP-TYPE
  9779         MOVE LOW-VALUES         TO WS-ERCOMP-ACCOUNT.
  9780
  9781     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  9782        MOVE ZEROS TO WS-ERCOMP-CARRIER.
  9783
  9784     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  9785        MOVE ZEROS TO WS-ERCOMP-GROUPING.
  9786
  9787
  9788* EXEC CICS HANDLE CONDITION
  9789*         NOTFND    (7075-CONTINUE-ACTV-ERROR)
  9790*    END-EXEC.
  9791*    MOVE '"$I                   ! 1 #00009202' TO DFHEIV0
  9792     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9794     MOVE X'3120233030303039323032' TO DFHEIV0(25:11)
  9795     CALL 'kxdfhei1' USING DFHEIV0
  9796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9797
  9798
  9799
  9800* EXEC CICS  READ
  9801*         SET      (ADDRESS OF COMPENSATION-MASTER)
  9802*         DATASET  ('ERCOMP')
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 193
* EL152.cbl
  9803*         RIDFLD   (WS-ERCOMP-KEY)
  9804*    END-EXEC.
  9805     MOVE 'ERCOMP' TO DFHEIV1
  9806*    MOVE '&"S        E          (   #00009206' TO DFHEIV0
  9807     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9808     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9809     MOVE X'2020233030303039323036' TO DFHEIV0(25:11)
  9810     CALL 'kxdfhei1' USING DFHEIV0,
  9811           DFHEIV1,
  9812           DFHEIV20,
  9813           DFHEIV99,
  9814           WS-ERCOMP-KEY,
  9815           DFHEIV99,
  9816           DFHEIV99,
  9817           DFHEIV99
  9818     SET ADDRESS OF COMPENSATION-MASTER TO
  9819         DFHEIV20
  9820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9821
  9822
  9823     MOVE 'Y'                   TO WS-COMP-READ-SW.
  9824     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
  9825     MOVE CO-ACCT-NAME          TO WS-LABEL-LINES (1).
  9826
  9827     IF CO-ACCT-NAME = SPACES
  9828        MOVE CO-MAIL-NAME       TO WS-LABEL-LINES (1).
  9829
  9830     MOVE CO-ADDR-1             TO WS-LABEL-LINES (2).
  9831     MOVE CO-ADDR-2             TO WS-LABEL-LINES (3).
  9832     MOVE CO-ADDR-3             TO WS-LABEL-LINES (4).
  9833
  9834     MOVE SPACES                TO  WS-ZIP-CODE.
  9835     IF CO-CANADIAN-POST-CODE
  9836         MOVE CO-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
  9837         MOVE CO-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
  9838     ELSE
  9839         MOVE CO-ZIP-PRIME      TO  WS-AM-ZIP-CODE
  9840         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9841             MOVE '-'           TO  WS-AM-ZIP-DASH
  9842             MOVE CO-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
  9843
  9844     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
  9845
  9846     MOVE ZEROS                 TO WS-PHONE-IN.
  9847     MOVE CO-AREA-CODE          TO WSPO-AREA.
  9848     MOVE CO-PREFIX             TO WSPO-PFX.
  9849     MOVE CO-PHONE              TO WSPO-SFX.
  9850     MOVE WS-PHONE-OUT          TO SS53-6D.
  9851
  9852     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
  9853
  9854     MOVE WS-LABEL-LINES (1)     TO REC-TEXT (1)    SS52D.
  9855     MOVE WS-LABEL-LINES (2)     TO REC-TEXT (2)    SS53-1D.
  9856     MOVE WS-LABEL-LINES (3)     TO REC-TEXT (3)    SS53-2D.
  9857     MOVE WS-LABEL-LINES (4)     TO REC-TEXT (4)    SS53-3D.
  9858     MOVE WS-LABEL-LINES (5)     TO REC-TEXT (5)    SS53-4D.
  9859     MOVE WS-LABEL-LINES (6)     TO REC-TEXT (6)    SS53-5D.
  9860
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 194
* EL152.cbl
  9861     GO TO 7099-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 195
* EL152.cbl
  9863
  9864 7075-CONTINUE-ACTV-ERROR.
  9865     MOVE ER-0178                TO EMI-ERROR.
  9866     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9867     MOVE -1                     TO ADDRL.
  9868     MOVE AL-UABON               TO ADDRA.
  9869     MOVE SPACES                 TO PI-ADDR-TYPE.
  9870     MOVE SPACES                 TO REC-TEXT (1)
  9871                                    REC-TEXT (2)
  9872                                    REC-TEXT (3)
  9873                                    REC-TEXT (4)
  9874                                    REC-TEXT (5)
  9875                                    REC-TEXT (6).
  9876     GO TO 7099-EXIT.
  9877
  9878 7080-ACCT-NOT-FOUND.
  9879     MOVE ER-0179                TO EMI-ERROR.
  9880     MOVE -1                     TO ADDRL.
  9881     MOVE AL-UABON               TO ADDRA.
  9882     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9883     GO TO 8200-SEND-DATAONLY.
  9884
  9885 7090-CLAIM-NOT-FOUND.
  9886     MOVE ER-0186                TO EMI-ERROR.
  9887     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9888     GO TO 8200-SEND-DATAONLY.
  9889
  9890*7095-PROD-NOT-FOUND. Remove as dead code
  9891
  9892 7099-EXIT.
  9893      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 196
* EL152.cbl
  9895
  9896 7170-FORMAT-SCREEN.
  9897     IF MAINTI = 'S'
  9898        MOVE AL-PANOF            TO SC-TEXTA (SC-INDX)
  9899       ELSE
  9900        MOVE AL-UANOF            TO SC-TEXTA (SC-INDX).
  9901
  9902     IF TB-INDX < 7
  9903        SET LINE23 TO TB-INDX
  9904        MOVE 'A'                 TO LINE1
  9905       ELSE
  9906        IF TB-INDX = 7
  9907           MOVE ZEROS            TO LINE-NUM
  9908        ELSE
  9909           SET LIN-NUM TO TB-INDX
  9910           SUBTRACT 7            FROM LIN-NUM.
  9911
  9912     MOVE LINE-NUM               TO SC-LINE (SC-INDX).
  9913     MOVE REC-TEXT (TB-INDX)     TO SC-TEXT (SC-INDX).
  9914     SET TB-INDX UP BY 1.
  9915
  9916 7170-EXIT.
  9917      EXIT.
  9918
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 197
* EL152.cbl
  9920 7200-RESOLVE-VARIABLES.
  9921***************************************************************
  9922*    THIS ROUTINE WILL FORMAT THE SYSTEM-DEFINED SYMBOLS      *
  9923*    WITH DATA PERTAINING TO THE DESIGNATED CLAIM.            *
  9924*    THIS ROUTINE IS PERFORMED THRU 7269-EXIT TO              *
  9925*    RESOLVE ALL OF THE SYMBOLS.                              *
  9926***************************************************************
  9927
  9928*    IF PI-COMPANY-ID = 'AUK'
  9929*        MOVE 'Y'                TO W-REVERSE-DATE-SW.
  9930
  9931     MOVE PI-CLAIM-NO            TO SS34D.
  9932
  9933     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9934        MOVE PI-LIFE-OVERRIDE-L6 TO SS12D
  9935     ELSE
  9936        MOVE PI-AH-OVERRIDE-L6   TO SS12D.
  9937
  9938     MOVE CL-LAST-PMT-AMT        TO SS16D.
  9939     MOVE CL-TOTAL-PAID-AMT      TO SS18D.
  9940     MOVE CL-CAUSE-CD            TO SS19-1D.
  9941     MOVE CL-ASSOC-CERT-SEQU     TO SS54D.
  9942     MOVE CL-ASSOC-CERT-TOTAL    TO SS55D.
  9943
  9944*    IF PI-COMPANY-ID NOT = 'DMD'
  9945*        GO TO 7200-CONTINUE.
  9946
  9947     IF CL-CCN-PREFIX-A5 = '1111' OR '3333' OR '6666' OR
  9948                           '8888' OR '9876'
  9949         MOVE CL-CCN-PRIME-A5    TO WS-CCN-12
  9950         MOVE WS-CCN-12          TO CL-CCN.
  9951
  9952     IF CL-CERT-STATE NOT = '08' AND '09'
  9953         MOVE SPACES             TO SS62D
  9954                                    SS63D
  9955         GO TO 7200-CONTINUE.
  9956
  9957     MOVE WS-DMD-UND-STATEMENT   TO SS62D.
  9958
  9959     MOVE 'CL'                   TO DL23-SYSTEM-ID.
  9960     MOVE 'UN'                   TO DL23-RECORD-TYPE.
  9961     MOVE CL-CERT-STATE          TO DL23-RECORD-KEY.
  9962
  9963
  9964* EXEC CICS LINK
  9965*        PROGRAM    ('DLO023')
  9966*        COMMAREA   (WS-DLO-CODES-TABLE)
  9967*        LENGTH     (DL23-COMM-LENGTH)
  9968*    END-EXEC.
  9969     MOVE 'DLO023' TO DFHEIV1
  9970*    MOVE '."C                   (   #00009352' TO DFHEIV0
  9971     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9972     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9973     MOVE X'2020233030303039333532' TO DFHEIV0(25:11)
  9974     CALL 'kxdfhei1' USING DFHEIV0,
  9975           DFHEIV1,
  9976           WS-DLO-CODES-TABLE,
  9977           DL23-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 198
* EL152.cbl
  9978           DFHEIV99,
  9979           DFHEIV99,
  9980           DFHEIV99,
  9981           DFHEIV99
  9982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9983
  9984
  9985     IF DL23-RETURN-CODE = 'OK'
  9986         MOVE DL23-CODE-DESC     TO SS63D
  9987       ELSE
  9988         MOVE SPACES             TO SS63D.
  9989
  9990 7200-CONTINUE.
  9991     MOVE CL-CCN                 TO SS60D.
  9992
  9993     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
  9994     MOVE SPACES                 TO DC-OPTION-CODE.
  9995     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  9996     IF NO-CONVERSION-ERROR
  9997        MOVE DC-GREG-DATE-1-EDIT TO SS13D.
  9998
  9999     MOVE CL-REPORTED-DT         TO DC-BIN-DATE-1.
 10000     MOVE SPACES                 TO DC-OPTION-CODE.
 10001     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10002     IF NO-CONVERSION-ERROR
 10003        MOVE DC-GREG-DATE-1-EDIT TO SS14D.
 10004
 10005     MOVE CL-LAST-PMT-DT         TO DC-BIN-DATE-1.
 10006     MOVE SPACES                 TO DC-OPTION-CODE.
 10007     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10008     IF NO-CONVERSION-ERROR
 10009        MOVE DC-GREG-DATE-1-EDIT TO SS15D.
 10010
 10011     IF NOT PI-USES-PAID-TO
 10012        MOVE CL-PAID-THRU-DT        TO DC-BIN-DATE-1
 10013        MOVE SPACES                 TO DC-OPTION-CODE
 10014        PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10015        IF NO-CONVERSION-ERROR
 10016           MOVE DC-GREG-DATE-1-EDIT TO SS17D
 10017        ELSE
 10018           MOVE SPACES TO SS17D
 10019     ELSE
 10020        MOVE CL-PAID-THRU-DT        TO DC-BIN-DATE-1
 10021        MOVE '6'                    TO DC-OPTION-CODE
 10022        MOVE +1                     TO DC-ELAPSED-DAYS
 10023        MOVE +0                     TO DC-ELAPSED-MONTHS
 10024        PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10025        IF NO-CONVERSION-ERROR
 10026           MOVE DC-GREG-DATE-1-EDIT TO SS17D.
 10027
 10028     MOVE CL-INSURED-BIRTH-DT    TO DC-BIN-DATE-1.
 10029     MOVE SPACES                 TO DC-OPTION-CODE.
 10030     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10031     IF NO-CONVERSION-ERROR
 10032        MOVE DC-GREG-DATE-1-EDIT TO SS45D
 10033     ELSE
 10034        MOVE '@@DOB'             TO SS45D.
 10035
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 199
* EL152.cbl
 10036     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 10037        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 10038             NEXT SENTENCE
 10039         ELSE
 10040             MOVE CL-SOC-SEC-NO  TO SS46D.
 10041
 10042     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 10043                                    ACCT-GROUPING
 10044                                    PROD-GROUPING
 10045                                    PLCY-GROUPING
 10046                                    PLAN-GROUPING.
 10047     MOVE CL-CERT-STATE          TO CERT-STATE
 10048                                    ACCT-STATE
 10049                                    PROD-STATE
 10050                                    PLCY-STATE
 10051                                    PLAN-STATE.
 10052     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 10053                                    ACCT-ACCOUNT
 10054                                    PROD-PRODUCER
 10055                                    PLCY-PRODUCER
 10056                                    PLAN-PRODUCER.
 10057     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT
 10058                                    PLCY-EFF-DT.
 10059     MOVE CL-CV-REFERENCE-NO     TO PLCY-REFERENCE-NO.
 10060
 10061     PERFORM 5000-MOVE-NAME THRU 5000-EXIT.
 10062
 10063*    IF PI-COMPANY-ID = 'DMD'
 10064*       MOVE WS-NAME-WORK           TO SS10D
 10065*       GO TO 7200-CONTINUE-2.
 10066
 10067     IF LOWER-CASE-LETTERS-USED
 10068        MOVE 'N'                    TO WS-STATE-LINE
 10069        MOVE WS-NAME-WORK           TO WS-TEMP-AREA2
 10070        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10071        MOVE WS-TEMP-AREA2          TO SS10D
 10072     ELSE
 10073        MOVE WS-NAME-WORK           TO SS10D.
 10074
 10075 7200-CONTINUE-2.
 10076     MOVE CL-INSURED-1ST-NAME     TO W-FIRST-NAME.
 10077     MOVE CL-INSURED-LAST-NAME    TO W-LAST-NAME.
 10078     MOVE CL-INSURED-MID-INIT     TO W-MIDDLE-NAME.
 10079     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10080
 10081     IF LOWER-CASE-LETTERS-USED
 10082        MOVE 'N'                    TO WS-STATE-LINE
 10083        MOVE WS-NAME-WORK           TO WS-TEMP-AREA2
 10084        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10085        MOVE WS-TEMP-AREA2          TO SS39D
 10086     ELSE
 10087        MOVE WS-NAME-WORK           TO SS39D.
 10088
 10089     MOVE CL-INSURED-LAST-NAME   TO SS40D.
 10090
 10091     IF INSURED-IS-FEMALE
 10092        MOVE 'MS.'               TO SS41D
 10093       ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 200
* EL152.cbl
 10094        MOVE 'MR.'               TO SS41D.
 10095
 10096*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10097*        PERFORM 7290-RESOLVE-CREDITOR THRU 7290-EXIT.
 10098
 10099*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 10100*        GO TO 7200-READ-EMPLCY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 201
* EL152.cbl
 10102
 10103* EXEC CICS HANDLE CONDITION
 10104*         NOTOPEN   (8900-CERT-NOT-OPEN)
 10105*         NOTFND    (8910-CERT-NOT-FOUND)
 10106*    END-EXEC.
 10107*    MOVE '"$JI                  ! 2 #00009475' TO DFHEIV0
 10108     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10109     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10110     MOVE X'3220233030303039343735' TO DFHEIV0(25:11)
 10111     CALL 'kxdfhei1' USING DFHEIV0
 10112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10113
 10114
 10115
 10116* EXEC CICS READ
 10117*         DATASET   (CERT-ID)
 10118*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10119*         RIDFLD    (CERT-KEY)
 10120*    END-EXEC.
 10121*    MOVE '&"S        E          (   #00009480' TO DFHEIV0
 10122     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10123     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10124     MOVE X'2020233030303039343830' TO DFHEIV0(25:11)
 10125     CALL 'kxdfhei1' USING DFHEIV0,
 10126           CERT-ID,
 10127           DFHEIV20,
 10128           DFHEIV99,
 10129           CERT-KEY,
 10130           DFHEIV99,
 10131           DFHEIV99,
 10132           DFHEIV99
 10133     SET ADDRESS OF CERTIFICATE-MASTER TO
 10134         DFHEIV20
 10135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10136
 10137
 10138*    IF PI-COMPANY-ID = 'DMD'
 10139*        MOVE CM-RESIDENT-STATE  TO WS-DMD-RES-ST
 10140*        IF CM-POLICY-FORM-NO(6:1) = '1'
 10141*            MOVE WS-DMD-UND-COMPANYA    TO SS64D
 10142*          ELSE
 10143*        IF CM-POLICY-FORM-NO(6:1) = '2'
 10144*            MOVE WS-DMD-UND-COMPANYB    TO SS64D
 10145*          ELSE
 10146*            MOVE SPACES                 TO SS64D.
 10147
 10148     MOVE CM-CERT-NO             TO SS26D.
 10149     MOVE CM-INSURED-ISSUE-AGE   TO SS33D.
 10150
 10151*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10152*        MOVE CL-CURRENT-CARRIER TO SS23D
 10153*        MOVE CL-CURRENT-GROUPING
 10154*                                TO SS24D
 10155*        MOVE CL-CURRENT-ACCOUNT TO SS25D
 10156*        MOVE CM-MEMBER-NO       TO SS36D
 10157*        MOVE CM-GROUPING        TO W-GROUPING
 10158*        IF W-GROUP-3 = 'C01' OR 'C02'
 10159*            MOVE CM-MEMBER-NO   TO W-CURRENT-LOAN-NO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 202
* EL152.cbl
 10160*            MOVE CM-LOAN-NUMBER TO W-LOAN-NO
 10161*            MOVE W-CREDIT-CARD-LOAN-NO
 10162*                                TO SS36-1D
 10163*        ELSE
 10164*            MOVE CM-MEMBER-NO   TO SS36-1D
 10165*    ELSE
 10166         MOVE CM-CARRIER         TO SS23D.
 10167         MOVE CM-GROUPING        TO SS24D.
 10168         MOVE CM-ACCOUNT         TO SS25D.
 10169         MOVE CM-LOAN-NUMBER     TO SS36D.
 10170
 10171     MOVE CM-LOAN-BALANCE        TO SS37D.
 10172     MOVE CM-MEMBER-NO           TO SS38D.
 10173
 10174     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 10175     MOVE SPACES                 TO DC-OPTION-CODE.
 10176     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10177     IF NO-CONVERSION-ERROR
 10178        MOVE DC-GREG-DATE-1-EDIT TO SS27D.
 10179
 10180     MOVE CM-INSURED-FIRST-NAME  TO W-FIRST-NAME.
 10181     MOVE CM-INSURED-LAST-NAME   TO W-LAST-NAME.
 10182     MOVE CM-INSURED-INITIAL2    TO W-MIDDLE-NAME.
 10183     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10184
 10185     IF LOWER-CASE-LETTERS-USED
 10186         MOVE 'N'                TO WS-STATE-LINE
 10187         MOVE WS-NAME-WORK       TO WS-TEMP-AREA2
 10188         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10189         MOVE WS-TEMP-AREA2      TO SS57D
 10190     ELSE
 10191         MOVE WS-NAME-WORK       TO SS57D.
 10192
 10193     MOVE CM-JT-FIRST-NAME       TO W-FIRST-NAME.
 10194     MOVE CM-JT-LAST-NAME        TO W-LAST-NAME.
 10195     MOVE CM-JT-INITIAL          TO W-MIDDLE-NAME.
 10196     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
 10197
 10198     IF LOWER-CASE-LETTERS-USED
 10199         MOVE 'N'                TO WS-STATE-LINE
 10200         MOVE WS-NAME-WORK       TO WS-TEMP-AREA2
 10201         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 10202         MOVE WS-TEMP-AREA2      TO SS58D
 10203     ELSE
 10204         MOVE WS-NAME-WORK       TO SS58D.
 10205
 10206     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10207        MOVE CM-LF-BENEFIT-CD    TO BEN-HOLD
 10208        MOVE CM-LF-ORIG-TERM     TO SS29D
 10209        MOVE CM-LF-BENEFIT-AMT   TO SS30D
 10210        MOVE CM-POLICY-FORM-NO   TO SS32D
 10211        MOVE CM-LF-CANCEL-DT     TO DC-BIN-DATE-1
 10212     ELSE
 10213        MOVE CM-AH-BENEFIT-CD    TO BEN-HOLD
 10214        MOVE CM-AH-ORIG-TERM     TO SS29D
 10215        MOVE CM-AH-BENEFIT-AMT   TO SS30D
 10216        MOVE CM-POLICY-FORM-NO   TO SS32D
 10217        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 203
* EL152.cbl
 10218
 10219     COMPUTE WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 10220
 10221     MOVE WORK-AMOUNT            TO SS51D.
 10222
 10223     MOVE SPACES                 TO DC-OPTION-CODE.
 10224     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
 10225     IF NO-CONVERSION-ERROR
 10226        MOVE DC-GREG-DATE-1-EDIT TO SS31D.
 10227
 10228     MOVE ' '                         TO  DC-OPTION-CODE.
 10229     MOVE +0                          TO  DC-ELAPSED-MONTHS
 10230                                          DC-ELAPSED-DAYS.
 10231
 10232     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10233         MOVE CM-LF-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10234         PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10235         IF NO-CONVERSION-ERROR
 10236             MOVE DC-GREG-DATE-1-EDIT TO  SS28D
 10237         ELSE
 10238             NEXT SENTENCE
 10239     ELSE
 10240         MOVE CM-AH-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 10241         PERFORM 9700-DATE-LINK THRU 9700-EXIT
 10242         IF NO-CONVERSION-ERROR
 10243             MOVE DC-GREG-DATE-1-EDIT TO  SS28D.
 10244
 10245*    GO TO 7200-READ-DIAGNOSIS.
 10246
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 204
* EL152.cbl
 10248*7200-READ-EMPLCY. Remove as dead code
 10249 7200-READ-DIAGNOSIS.
 10250
 10251* EXEC CICS HANDLE CONDITION
 10252*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10253*         NOTFND     (7200-READ-LOAN-NUMBER)
 10254*    END-EXEC.
 10255*    MOVE '"$JI                  ! 3 #00009598' TO DFHEIV0
 10256     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10258     MOVE X'3320233030303039353938' TO DFHEIV0(25:11)
 10259     CALL 'kxdfhei1' USING DFHEIV0
 10260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10261
 10262
 10263     MOVE CL-CONTROL-PRIMARY    TO ACTV-KEY.
 10264     MOVE +90                   TO ACTV-SEQ.
 10265
 10266
 10267* EXEC CICS READ
 10268*         DATASET  (ACTV-ID)
 10269*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10270*         RIDFLD   (ACTV-KEY)
 10271*    END-EXEC.
 10272*    MOVE '&"S        E          (   #00009606' TO DFHEIV0
 10273     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10274     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10275     MOVE X'2020233030303039363036' TO DFHEIV0(25:11)
 10276     CALL 'kxdfhei1' USING DFHEIV0,
 10277           ACTV-ID,
 10278           DFHEIV20,
 10279           DFHEIV99,
 10280           ACTV-KEY,
 10281           DFHEIV99,
 10282           DFHEIV99,
 10283           DFHEIV99
 10284     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10285         DFHEIV20
 10286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10287
 10288
 10289     IF AT-TRAILER-TYPE = '6'
 10290        MOVE AT-INFO-LINE-1         TO SS19D.
 10291
 10292 7200-READ-LOAN-NUMBER.
 10293
 10294
 10295* EXEC CICS HANDLE CONDITION
 10296*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10297*         NOTFND     (7201-READ-BENEFICIARY)
 10298*    END-EXEC.
 10299*    MOVE '"$JI                  ! 4 #00009617' TO DFHEIV0
 10300     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10301     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10302     MOVE X'3420233030303039363137' TO DFHEIV0(25:11)
 10303     CALL 'kxdfhei1' USING DFHEIV0
 10304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10305
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 205
* EL152.cbl
 10306
 10307     MOVE CL-CONTROL-PRIMARY    TO ACTV-KEY.
 10308     MOVE +91                   TO ACTV-SEQ.
 10309
 10310
 10311* EXEC CICS READ
 10312*         DATASET  (ACTV-ID)
 10313*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10314*         RIDFLD   (ACTV-KEY)
 10315*    END-EXEC.
 10316*    MOVE '&"S        E          (   #00009625' TO DFHEIV0
 10317     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10318     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10319     MOVE X'2020233030303039363235' TO DFHEIV0(25:11)
 10320     CALL 'kxdfhei1' USING DFHEIV0,
 10321           ACTV-ID,
 10322           DFHEIV20,
 10323           DFHEIV99,
 10324           ACTV-KEY,
 10325           DFHEIV99,
 10326           DFHEIV99,
 10327           DFHEIV99
 10328     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10329         DFHEIV20
 10330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10331
 10332
 10333     IF AT-TRAILER-TYPE = '6'
 10334        MOVE AT-INFO-LINE-1         TO SS19-2D.
 10335
 10336 7201-READ-BENEFICIARY.
 10337     IF CL-BENIF-ADDR-CNT = +0  AND
 10338        CL-BENEFICIARY = SPACES
 10339          GO TO 7205-READ-PHYSICIAN-ADDR.
 10340
 10341     IF W-BENEFICIARY > ZERO
 10342         COMPUTE ACTV-SEQ = W-BENEFICIARY + 10
 10343     ELSE
 10344         MOVE CL-BENIF-ADDR-CNT  TO ACTV-SEQ
 10345         ADD +10                 TO ACTV-SEQ.
 10346
 10347
 10348* EXEC CICS HANDLE CONDITION
 10349*         NOTOPEN    (7290-BENE-NOT-OPEN)
 10350*         NOTFND     (7205-READ-PHYSICIAN-ADDR)
 10351*    END-EXEC.
 10352*    MOVE '"$JI                  ! 5 #00009645' TO DFHEIV0
 10353     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10355     MOVE X'3520233030303039363435' TO DFHEIV0(25:11)
 10356     CALL 'kxdfhei1' USING DFHEIV0
 10357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10358
 10359
 10360     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10361
 10362     IF ACTV-SEQ = +19
 10363         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 206
* EL152.cbl
 10364     ELSE
 10365         IF ACTV-SEQ NOT = +10
 10366             GO TO 7202-GET-FROM-ACTIVITY.
 10367
 10368     MOVE PI-COMPANY-CD        TO BENE-COMP-CD.
 10369     MOVE 'B'                  TO BENE-REC-TYPE.
 10370     MOVE CL-BENEFICIARY       TO BENE-NUMBER.
 10371
 10372
 10373* EXEC CICS READ
 10374*         DATASET    (BENE-ID)
 10375*         SET        (ADDRESS OF BENEFICIARY-MASTER)
 10376*         RIDFLD     (BENE-KEY)
 10377*    END-EXEC.
 10378*    MOVE '&"S        E          (   #00009662' TO DFHEIV0
 10379     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10380     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10381     MOVE X'2020233030303039363632' TO DFHEIV0(25:11)
 10382     CALL 'kxdfhei1' USING DFHEIV0,
 10383           BENE-ID,
 10384           DFHEIV20,
 10385           DFHEIV99,
 10386           BENE-KEY,
 10387           DFHEIV99,
 10388           DFHEIV99,
 10389           DFHEIV99
 10390     SET ADDRESS OF BENEFICIARY-MASTER TO
 10391         DFHEIV20
 10392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10393
 10394
 10395*    IF PI-COMPANY-ID = 'DMD'
 10396*        MOVE BE-BSR             TO PI-ELBENE-BSR.
 10397
 10398 7201-CONT.
 10399     MOVE BE-MAIL-TO-NAME2       TO WS-LABEL-LINES (1).
 10400     MOVE BE-ADDRESS-LINE-12     TO WS-LABEL-LINES (2).
 10401     MOVE BE-ADDRESS-LINE-22     TO WS-LABEL-LINES (3).
 10402     MOVE BE-ADDRESS-LINE-32     TO WS-LABEL-LINES (4).
 10403*    MOVE BE-CITY-STATE2         TO WS-LABEL-LINES (5).
 10404     STRING BE-CITY2 ' ' BE-STATE2 DELIMITED BY '  '
 10405        INTO WS-LABEL-LINES (5)
 10406     END-STRING
 10407
 10408     MOVE SPACES                 TO WS-ZIP-CODE.
 10409
 10410     IF BE-CANADIAN-POST-CODE2
 10411         MOVE BE-CAN-POSTAL-12   TO WS-CAN-POSTAL-1
 10412         MOVE BE-CAN-POSTAL-22   TO WS-CAN-POSTAL-2
 10413     ELSE
 10414         MOVE BE-ZIP-PRIME2      TO WS-AM-ZIP-CODE
 10415         IF BE-ZIP-PLUS42 NOT = SPACES AND ZEROS
 10416             MOVE '-'            TO WS-AM-ZIP-DASH
 10417             MOVE BE-ZIP-PLUS42  TO WS-AM-ZIP-PLUS4.
 10418
 10419     MOVE WS-ZIP-CODE            TO WS-LABEL-LINES (6).
 10420
 10421     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 207
* EL152.cbl
 10422
 10423     MOVE WS-LABEL-LINES (1)     TO SS61D.
 10424     MOVE WS-LABEL-LINES (2)     TO SS61-1D.
 10425     MOVE WS-LABEL-LINES (3)     TO SS61-2D.
 10426     MOVE WS-LABEL-LINES (4)     TO SS61-3D.
 10427     MOVE WS-LABEL-LINES (5)     TO SS61-4D.
 10428     MOVE WS-LABEL-LINES (6)     TO SS61-5D.
 10429
 10430     MOVE BE-PHONE-NO2           TO WS-PHONE-IN.
 10431     MOVE WSPI-AREA              TO WSPO-AREA.
 10432     MOVE WSPI-PFX               TO WSPO-PFX.
 10433     MOVE WSPI-SFX               TO WSPO-SFX.
 10434     MOVE WS-PHONE-OUT           TO SS61-6D.
 10435
 10436 7201-CONT-PROCESS.
 10437     MOVE BE-MAIL-TO-NAME      TO  WS-LABEL-LINES (1).
 10438     MOVE BE-ADDRESS-LINE-1    TO  WS-LABEL-LINES (2).
 10439     MOVE BE-ADDRESS-LINE-2    TO  WS-LABEL-LINES (3).
 10440     MOVE BE-ADDRESS-LINE-3    TO  WS-LABEL-LINES (4).
 10441*    MOVE BE-CITY-STATE        TO  WS-LABEL-LINES (5).
 10442     STRING BE-CITY ' ' BE-STATE DELIMITED BY '  '
 10443        INTO WS-LABEL-LINES (5)
 10444     END-STRING
 10445
 10446     MOVE SPACES               TO  WS-ZIP-CODE.
 10447     IF BE-CANADIAN-POST-CODE
 10448         MOVE BE-CAN-POSTAL-1  TO  WS-CAN-POSTAL-1
 10449         MOVE BE-CAN-POSTAL-2  TO  WS-CAN-POSTAL-2
 10450     ELSE
 10451         MOVE BE-ZIP-PRIME     TO  WS-AM-ZIP-CODE
 10452         IF BE-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10453             MOVE '-'          TO  WS-AM-ZIP-DASH
 10454             MOVE BE-ZIP-PLUS4 TO  WS-AM-ZIP-PLUS4.
 10455
 10456     MOVE WS-ZIP-CODE          TO  WS-LABEL-LINES (6).
 10457
 10458     MOVE BE-PHONE-NO          TO  WS-PHONE-IN.
 10459
 10460     GO TO 7204-SET-PHONE.
 10461
 10462 7202-GET-FROM-ACTIVITY.
 10463
 10464* EXEC CICS READ
 10465*         DATASET  (ACTV-ID)
 10466*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10467*         RIDFLD   (ACTV-KEY)
 10468*    END-EXEC.
 10469*    MOVE '&"S        E          (   #00009736' TO DFHEIV0
 10470     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10471     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10472     MOVE X'2020233030303039373336' TO DFHEIV0(25:11)
 10473     CALL 'kxdfhei1' USING DFHEIV0,
 10474           ACTV-ID,
 10475           DFHEIV20,
 10476           DFHEIV99,
 10477           ACTV-KEY,
 10478           DFHEIV99,
 10479           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 208
* EL152.cbl
 10480           DFHEIV99
 10481     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10482         DFHEIV20
 10483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10484
 10485
 10486     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10487     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10488     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10489*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10490     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10491        INTO WS-LABEL-LINES (4)
 10492     END-STRING
 10493
 10494     MOVE SPACES                 TO  WS-ZIP-CODE.
 10495     IF AT-CANADIAN-POST-CODE
 10496         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10497         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10498     ELSE
 10499         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10500         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10501             MOVE '-'            TO  WS-AM-ZIP-DASH
 10502             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10503
 10504     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10505
 10506     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10507
 10508 7204-SET-PHONE.
 10509     MOVE WSPI-AREA              TO WSPO-AREA.
 10510     MOVE WSPI-PFX               TO WSPO-PFX.
 10511     MOVE WSPI-SFX               TO WSPO-SFX.
 10512     MOVE WS-PHONE-OUT           TO SS44-5D.
 10513
 10514     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10515
 10516     MOVE WS-LABEL-LINES (1)     TO SS43D.
 10517     MOVE WS-LABEL-LINES (2)     TO SS44-1D.
 10518     MOVE WS-LABEL-LINES (3)     TO SS44-2D.
 10519     MOVE WS-LABEL-LINES (4)     TO SS44-3D.
 10520     MOVE WS-LABEL-LINES (5)     TO SS44-4D.
 10521     MOVE WS-LABEL-LINES (6)     TO SS44-6D.
 10522
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 209
* EL152.cbl
 10524 7205-READ-PHYSICIAN-ADDR.
 10525     IF W-PHYSICIAN > ZERO
 10526         COMPUTE ACTV-SEQ = W-PHYSICIAN + 30
 10527     ELSE
 10528         MOVE CL-DOCTOR-ADDR-CNT TO ACTV-SEQ
 10529         ADD +30                 TO ACTV-SEQ.
 10530
 10531     IF ACTV-SEQ = +30
 10532        GO TO 7210-READ-EMPLOYER-ADDR.
 10533
 10534
 10535* EXEC CICS HANDLE CONDITION
 10536*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10537*         NOTFND     (7210-READ-EMPLOYER-ADDR)
 10538*    END-EXEC.
 10539*    MOVE '"$JI                  ! 6 #00009790' TO DFHEIV0
 10540     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10541     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10542     MOVE X'3620233030303039373930' TO DFHEIV0(25:11)
 10543     CALL 'kxdfhei1' USING DFHEIV0
 10544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10545
 10546
 10547
 10548* EXEC CICS READ
 10549*         DATASET    (ACTV-ID)
 10550*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10551*         RIDFLD     (ACTV-KEY)
 10552*    END-EXEC.
 10553*    MOVE '&"S        E          (   #00009795' TO DFHEIV0
 10554     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10555     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10556     MOVE X'2020233030303039373935' TO DFHEIV0(25:11)
 10557     CALL 'kxdfhei1' USING DFHEIV0,
 10558           ACTV-ID,
 10559           DFHEIV20,
 10560           DFHEIV99,
 10561           ACTV-KEY,
 10562           DFHEIV99,
 10563           DFHEIV99,
 10564           DFHEIV99
 10565     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10566         DFHEIV20
 10567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10568
 10569
 10570     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10571     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10572     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10573     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10574*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10575     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10576        INTO WS-LABEL-LINES (4)
 10577     END-STRING
 10578
 10579     MOVE SPACES                 TO  WS-ZIP-CODE.
 10580     IF AT-CANADIAN-POST-CODE
 10581         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 210
* EL152.cbl
 10582         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10583     ELSE
 10584         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10585         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10586             MOVE '-'            TO  WS-AM-ZIP-DASH
 10587             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10588
 10589     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10590
 10591     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10592     MOVE WSPI-AREA              TO WSPO-AREA.
 10593     MOVE WSPI-PFX               TO WSPO-PFX.
 10594     MOVE WSPI-SFX               TO WSPO-SFX.
 10595     MOVE WS-PHONE-OUT           TO SS47-5D.
 10596
 10597     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10598
 10599     MOVE WS-LABEL-LINES (1)     TO SS47D.
 10600     MOVE WS-LABEL-LINES (2)     TO SS47-1D.
 10601     MOVE WS-LABEL-LINES (3)     TO SS47-2D.
 10602     MOVE WS-LABEL-LINES (4)     TO SS47-3D.
 10603     MOVE WS-LABEL-LINES (5)     TO SS47-4D.
 10604
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 211
* EL152.cbl
 10606
 10607 7210-READ-EMPLOYER-ADDR.
 10608     IF W-EMPLOYER > ZERO
 10609         COMPUTE ACTV-SEQ = W-EMPLOYER + 40
 10610     ELSE
 10611         MOVE CL-EMPLOYER-ADDR-CNT
 10612                                 TO ACTV-SEQ
 10613         ADD +40                 TO ACTV-SEQ.
 10614
 10615     IF ACTV-SEQ = +40
 10616        GO TO 7220-READ-INSURED-ADDR.
 10617
 10618
 10619* EXEC CICS HANDLE CONDITION
 10620*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10621*         NOTFND     (7220-READ-INSURED-ADDR)
 10622*    END-EXEC.
 10623*    MOVE '"$JI                  ! 7 #00009849' TO DFHEIV0
 10624     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10625     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10626     MOVE X'3720233030303039383439' TO DFHEIV0(25:11)
 10627     CALL 'kxdfhei1' USING DFHEIV0
 10628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10629
 10630
 10631
 10632* EXEC CICS READ
 10633*         DATASET    (ACTV-ID)
 10634*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10635*         RIDFLD     (ACTV-KEY)
 10636*    END-EXEC.
 10637*    MOVE '&"S        E          (   #00009854' TO DFHEIV0
 10638     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10639     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10640     MOVE X'2020233030303039383534' TO DFHEIV0(25:11)
 10641     CALL 'kxdfhei1' USING DFHEIV0,
 10642           ACTV-ID,
 10643           DFHEIV20,
 10644           DFHEIV99,
 10645           ACTV-KEY,
 10646           DFHEIV99,
 10647           DFHEIV99,
 10648           DFHEIV99
 10649     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10650         DFHEIV20
 10651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10652
 10653
 10654     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10655     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10656     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10657     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10658*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10659     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10660        INTO WS-LABEL-LINES (4)
 10661     END-STRING
 10662
 10663     MOVE SPACES                 TO  WS-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 212
* EL152.cbl
 10664     IF AT-CANADIAN-POST-CODE
 10665         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10666         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10667     ELSE
 10668         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10669         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10670             MOVE '-'            TO  WS-AM-ZIP-DASH
 10671             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10672
 10673     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10674
 10675     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10676     MOVE WSPI-AREA              TO WSPO-AREA.
 10677     MOVE WSPI-PFX               TO WSPO-PFX.
 10678     MOVE WSPI-SFX               TO WSPO-SFX.
 10679     MOVE WS-PHONE-OUT           TO SS48-5D.
 10680
 10681     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10682
 10683     MOVE WS-LABEL-LINES (1)     TO SS48D.
 10684     MOVE WS-LABEL-LINES (2)     TO SS48-1D.
 10685     MOVE WS-LABEL-LINES (3)     TO SS48-2D.
 10686     MOVE WS-LABEL-LINES (4)     TO SS48-3D.
 10687     MOVE WS-LABEL-LINES (5)     TO SS48-4D.
 10688
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 213
* EL152.cbl
 10690 7220-READ-INSURED-ADDR.
 10691
 10692     IF W-INSURED > ZERO
 10693         COMPUTE ACTV-SEQ = W-INSURED
 10694     ELSE
 10695         MOVE CL-INSURED-ADDR-CNT TO ACTV-SEQ.
 10696
 10697     IF ACTV-SEQ = +0
 10698        GO TO 7225-READ-OTHER1-ADDR.
 10699
 10700
 10701* EXEC CICS HANDLE CONDITION
 10702*         NOTOPEN   (8870-ACTV-NOT-OPEN)
 10703*         NOTFND    (7225-READ-OTHER1-ADDR)
 10704*    END-EXEC.
 10705*    MOVE '"$JI                  ! 8 #00009906' TO DFHEIV0
 10706     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10707     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10708     MOVE X'3820233030303039393036' TO DFHEIV0(25:11)
 10709     CALL 'kxdfhei1' USING DFHEIV0
 10710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10711
 10712
 10713
 10714* EXEC CICS READ
 10715*         DATASET   (ACTV-ID)
 10716*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10717*         RIDFLD    (ACTV-KEY)
 10718*    END-EXEC.
 10719*    MOVE '&"S        E          (   #00009911' TO DFHEIV0
 10720     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10721     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10722     MOVE X'2020233030303039393131' TO DFHEIV0(25:11)
 10723     CALL 'kxdfhei1' USING DFHEIV0,
 10724           ACTV-ID,
 10725           DFHEIV20,
 10726           DFHEIV99,
 10727           ACTV-KEY,
 10728           DFHEIV99,
 10729           DFHEIV99,
 10730           DFHEIV99
 10731     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10732         DFHEIV20
 10733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10734
 10735
 10736     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10737     MOVE SS10D                  TO WS-LABEL-LINES (1).
 10738     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10739     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10740*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10741     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10742        INTO WS-LABEL-LINES (4)
 10743     END-STRING
 10744
 10745     MOVE SPACES                 TO  WS-ZIP-CODE.
 10746     IF AT-CANADIAN-POST-CODE
 10747         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 214
* EL152.cbl
 10748         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10749     ELSE
 10750         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10751         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10752             MOVE '-'            TO  WS-AM-ZIP-DASH
 10753             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10754
 10755     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10756
 10757     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10758
 10759     MOVE WS-LABEL-LINES (1)     TO SS10D.
 10760     MOVE WS-LABEL-LINES (2)     TO SS11-1D.
 10761     MOVE WS-LABEL-LINES (3)     TO SS11-2D.
 10762     MOVE WS-LABEL-LINES (4)     TO SS11-3D.
 10763     MOVE WS-LABEL-LINES (5)     TO SS11-4D.
 10764     MOVE AT-MAIL-TO-NAME        TO SS11-5D.
 10765
 10766     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10767     MOVE WSPI-AREA              TO WSPO-AREA.
 10768     MOVE WSPI-PFX               TO WSPO-PFX.
 10769     MOVE WSPI-SFX               TO WSPO-SFX.
 10770     MOVE WS-PHONE-OUT           TO SS11-6D.
 10771
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 215
* EL152.cbl
 10773
 10774 7225-READ-OTHER1-ADDR.
 10775
 10776     IF W-OTHER-1 > ZERO
 10777         COMPUTE ACTV-SEQ = W-OTHER-1 + 50
 10778     ELSE
 10779         MOVE CL-OTHER-1-ADDR-CNT TO ACTV-SEQ
 10780         ADD +50                  TO ACTV-SEQ.
 10781
 10782     IF ACTV-SEQ = +50
 10783        GO TO 7230-READ-OTHER2-ADDR.
 10784
 10785
 10786* EXEC CICS HANDLE CONDITION
 10787*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10788*         NOTFND     (7230-READ-OTHER2-ADDR)
 10789*    END-EXEC.
 10790*    MOVE '"$JI                  ! 9 #00009966' TO DFHEIV0
 10791     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10792     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10793     MOVE X'3920233030303039393636' TO DFHEIV0(25:11)
 10794     CALL 'kxdfhei1' USING DFHEIV0
 10795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10796
 10797
 10798
 10799* EXEC CICS READ
 10800*         DATASET    (ACTV-ID)
 10801*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10802*         RIDFLD     (ACTV-KEY)
 10803*    END-EXEC.
 10804*    MOVE '&"S        E          (   #00009971' TO DFHEIV0
 10805     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10807     MOVE X'2020233030303039393731' TO DFHEIV0(25:11)
 10808     CALL 'kxdfhei1' USING DFHEIV0,
 10809           ACTV-ID,
 10810           DFHEIV20,
 10811           DFHEIV99,
 10812           ACTV-KEY,
 10813           DFHEIV99,
 10814           DFHEIV99,
 10815           DFHEIV99
 10816     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10817         DFHEIV20
 10818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10819
 10820
 10821     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10822     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10823     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10824     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10825*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10826     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10827        INTO WS-LABEL-LINES (4)
 10828     END-STRING
 10829
 10830     MOVE SPACES                 TO  WS-ZIP-CODE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 216
* EL152.cbl
 10831     IF AT-CANADIAN-POST-CODE
 10832         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10833         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10834     ELSE
 10835         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10836         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10837             MOVE '-'            TO  WS-AM-ZIP-DASH
 10838             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10839
 10840     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10841
 10842     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10843     MOVE WSPI-AREA              TO WSPO-AREA.
 10844     MOVE WSPI-PFX               TO WSPO-PFX.
 10845     MOVE WSPI-SFX               TO WSPO-SFX.
 10846     MOVE WS-PHONE-OUT           TO SS49-5D.
 10847
 10848     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10849
 10850     MOVE WS-LABEL-LINES (1)     TO SS49D.
 10851     MOVE WS-LABEL-LINES (2)     TO SS49-1D.
 10852     MOVE WS-LABEL-LINES (3)     TO SS49-2D.
 10853     MOVE WS-LABEL-LINES (4)     TO SS49-3D.
 10854     MOVE WS-LABEL-LINES (5)     TO SS49-4D.
 10855
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 217
* EL152.cbl
 10857 7230-READ-OTHER2-ADDR.
 10858
 10859     IF W-OTHER-2 > ZERO
 10860         COMPUTE ACTV-SEQ = W-OTHER-2 + 60
 10861     ELSE
 10862         MOVE CL-OTHER-2-ADDR-CNT TO ACTV-SEQ
 10863         ADD +60                  TO ACTV-SEQ.
 10864
 10865     IF ACTV-SEQ = +60
 10866        GO TO 7240-NOT-FOUND.
 10867
 10868
 10869* EXEC CICS HANDLE CONDITION
 10870*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10871*         NOTFND     (7240-NOT-FOUND)
 10872*    END-EXEC.
 10873*    MOVE '"$JI                  ! : #00010024' TO DFHEIV0
 10874     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10875     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10876     MOVE X'3A20233030303130303234' TO DFHEIV0(25:11)
 10877     CALL 'kxdfhei1' USING DFHEIV0
 10878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10879
 10880
 10881
 10882* EXEC CICS READ
 10883*         DATASET    (ACTV-ID)
 10884*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10885*         RIDFLD     (ACTV-KEY)
 10886*    END-EXEC.
 10887*    MOVE '&"S        E          (   #00010029' TO DFHEIV0
 10888     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10889     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10890     MOVE X'2020233030303130303239' TO DFHEIV0(25:11)
 10891     CALL 'kxdfhei1' USING DFHEIV0,
 10892           ACTV-ID,
 10893           DFHEIV20,
 10894           DFHEIV99,
 10895           ACTV-KEY,
 10896           DFHEIV99,
 10897           DFHEIV99,
 10898           DFHEIV99
 10899     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10900         DFHEIV20
 10901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10902
 10903
 10904     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10905     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10906     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10907     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10908*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10909     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10910        INTO WS-LABEL-LINES (4)
 10911     END-STRING
 10912
 10913     MOVE SPACES                 TO  WS-ZIP-CODE.
 10914     IF AT-CANADIAN-POST-CODE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 218
* EL152.cbl
 10915         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 10916         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 10917     ELSE
 10918         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 10919         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 10920             MOVE '-'            TO  WS-AM-ZIP-DASH
 10921             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 10922
 10923     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 10924
 10925     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 10926     MOVE WSPI-AREA              TO WSPO-AREA.
 10927     MOVE WSPI-PFX               TO WSPO-PFX.
 10928     MOVE WSPI-SFX               TO WSPO-SFX.
 10929     MOVE WS-PHONE-OUT           TO SS50-5D.
 10930
 10931     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 10932
 10933     MOVE WS-LABEL-LINES (1)     TO SS50D.
 10934     MOVE WS-LABEL-LINES (2)     TO SS50-1D.
 10935     MOVE WS-LABEL-LINES (3)     TO SS50-2D.
 10936     MOVE WS-LABEL-LINES (4)     TO SS50-3D.
 10937     MOVE WS-LABEL-LINES (5)     TO SS50-4D.
 10938
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 219
* EL152.cbl
 10940 7240-NOT-FOUND.
 10941     IF ACCOUNT-IS-ONLINE
 10942        GO TO 7250-READ-ACCOUNT.
 10943
 10944     IF W-ACCOUNT > ZERO
 10945         COMPUTE ACTV-SEQ = W-ACCOUNT + 20
 10946     ELSE
 10947         MOVE CL-ACCOUNT-ADDR-CNT TO ACTV-SEQ
 10948         ADD +20                  TO ACTV-SEQ.
 10949
 10950     IF ACTV-SEQ = +20
 10951        GO TO 7250-READ-ACCOUNT.
 10952
 10953
 10954* EXEC CICS HANDLE CONDITION
 10955*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 10956*         NOTFND     (7250-READ-ACCOUNT)
 10957*    END-EXEC.
 10958*    MOVE '"$JI                  ! ; #00010084' TO DFHEIV0
 10959     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10960     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10961     MOVE X'3B20233030303130303834' TO DFHEIV0(25:11)
 10962     CALL 'kxdfhei1' USING DFHEIV0
 10963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10964
 10965
 10966
 10967* EXEC CICS READ
 10968*         DATASET    (ACTV-ID)
 10969*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 10970*         RIDFLD     (ACTV-KEY)
 10971*    END-EXEC.
 10972*    MOVE '&"S        E          (   #00010089' TO DFHEIV0
 10973     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10974     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10975     MOVE X'2020233030303130303839' TO DFHEIV0(25:11)
 10976     CALL 'kxdfhei1' USING DFHEIV0,
 10977           ACTV-ID,
 10978           DFHEIV20,
 10979           DFHEIV99,
 10980           ACTV-KEY,
 10981           DFHEIV99,
 10982           DFHEIV99,
 10983           DFHEIV99
 10984     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10985         DFHEIV20
 10986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10987
 10988
 10989     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 10990     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 10991     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 10992     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 10993*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 10994     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 10995        INTO WS-LABEL-LINES (4)
 10996     END-STRING
 10997
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 220
* EL152.cbl
 10998     MOVE SPACES                 TO  WS-ZIP-CODE.
 10999     IF AT-CANADIAN-POST-CODE
 11000         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 11001         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 11002     ELSE
 11003         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 11004         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11005             MOVE '-'            TO  WS-AM-ZIP-DASH
 11006             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 11007
 11008     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 11009
 11010     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 11011     MOVE WSPI-AREA              TO WSPO-AREA.
 11012     MOVE WSPI-PFX               TO WSPO-PFX.
 11013     MOVE WSPI-SFX               TO WSPO-SFX.
 11014     MOVE WS-PHONE-OUT           TO SS07-6D.
 11015
 11016*    IF PI-COMPANY-ID NOT = 'FLA'
 11017*        PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11018
 11019     MOVE WS-LABEL-LINES (1)     TO SS06D.
 11020     MOVE WS-LABEL-LINES (2)     TO SS07-1D.
 11021     MOVE WS-LABEL-LINES (3)     TO SS07-2D.
 11022     MOVE WS-LABEL-LINES (4)     TO SS07-3D.
 11023     MOVE WS-LABEL-LINES (5)     TO SS07-4D.
 11024     MOVE WS-LABEL-LINES (6)     TO SS07-5D.
 11025
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 221
* EL152.cbl
 11027 7250-READ-ACCOUNT.
 11028*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 11029*        GO TO 7250-READ-PRODUCER.
 11030
 11031     IF WS-ACCT-READ-SW = 'Y'
 11032        GO TO 7250-BUILD-ACCT-ADDR.
 11033
 11034     MOVE CM-CERT-EFF-DT TO ACCT-EXP-DATE.
 11035
 11036
 11037* EXEC CICS HANDLE CONDITION
 11038*         NOTOPEN   (8880-ACCT-NOT-OPEN)
 11039*         NOTFND    (7251-READ-3RD-PARTY)
 11040*    END-EXEC.
 11041*    MOVE '"$JI                  ! < #00010142' TO DFHEIV0
 11042     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11043     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11044     MOVE X'3C20233030303130313432' TO DFHEIV0(25:11)
 11045     CALL 'kxdfhei1' USING DFHEIV0
 11046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11047
 11048
 11049 7250-STARTBR-ACCOUNT.
 11050     MOVE ACCT-PARTIAL-KEY       TO  ACCT-SAVE-KEY.
 11051     PERFORM 8000-STARTBR-ERACCT THRU 8000-STARTBR-EXIT.
 11052
 11053 7250-READNEXT-ACCOUNT.
 11054     PERFORM 8000-READNEXT-ERACCT THRU 8000-READNEXT-EXIT.
 11055
 11056     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
 11057         IF WS-SAVE-ACCT-RECORD = SPACES
 11058             GO TO 7251-READ-3RD-PARTY
 11059         ELSE
 11060             MOVE AM-CONTROL-PRIMARY  TO  ACCT-KEY
 11061             MOVE WS-SAVE-ACCT-RECORD TO  ACCOUNT-MASTER
 11062             GO TO 7250-BUILD-ACCT-ADDR.
 11063
 11064     IF AM-EXPIRATION-DT = HIGH-VALUES
 11065         MOVE AM-CONTROL-PRIMARY      TO  ACCT-KEY
 11066     ELSE
 11067         MOVE ACCOUNT-MASTER          TO  WS-SAVE-ACCT-RECORD
 11068         GO TO 7250-READNEXT-ACCOUNT.
 11069
 11070 7250-BUILD-ACCT-ADDR.
 11071     MOVE SPACES                TO  WS-SAVE-ACCT-RECORD.
 11072
 11073     IF NOT ACCOUNT-IS-ONLINE
 11074        GO TO 7251-READ-3RD-PARTY.
 11075
 11076     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
 11077     MOVE AM-NAME               TO WS-LABEL-LINES (1).
 11078     MOVE AM-PERSON             TO WS-LABEL-LINES (2).
 11079     MOVE AM-ADDRS              TO WS-LABEL-LINES (3).
 11080*    MOVE AM-CITY               TO WS-LABEL-LINES (4).
 11081     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE DELIMITED BY '  '
 11082        INTO WS-LABEL-LINES (4)
 11083     END-STRING
 11084
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 222
* EL152.cbl
 11085     MOVE SPACES                TO  WS-ZIP-CODE.
 11086     IF AM-CANADIAN-POST-CODE
 11087         MOVE AM-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11088         MOVE AM-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11089     ELSE
 11090         MOVE AM-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11091         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11092             MOVE '-'           TO  WS-AM-ZIP-DASH
 11093             MOVE AM-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11094
 11095     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
 11096
 11097     MOVE ZEROS                 TO WS-PHONE-IN.
 11098     MOVE AM-AREA-CODE          TO WSPO-AREA.
 11099     MOVE AM-TEL-PRE            TO WSPO-PFX.
 11100     MOVE AM-TEL-NBR            TO WSPO-SFX.
 11101     MOVE WS-PHONE-OUT          TO SS07-6D.
 11102
 11103*    IF PI-COMPANY-ID NOT = 'FLA'
 11104*        PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11105
 11106     MOVE WS-LABEL-LINES (1)     TO SS06D.
 11107     MOVE WS-LABEL-LINES (2)     TO SS07-1D.
 11108     MOVE WS-LABEL-LINES (3)     TO SS07-2D.
 11109     MOVE WS-LABEL-LINES (4)     TO SS07-3D.
 11110     MOVE WS-LABEL-LINES (5)     TO SS07-4D.
 11111     MOVE WS-LABEL-LINES (6)     TO SS07-5D.
 11112
 11113*    GO TO 7251-READ-3RD-PARTY.
 11114
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 223
* EL152.cbl
 11116*7250-READ-PRODUCER. Remove as dead code
 11117*7250-STARTBR-PRODUCER. Remove as dead code
 11118*7250-READNEXT-PRODUCER. Remove as dead code
 11119*7250-BUILD-PROD-ADDR. Remove as dead code
 11120 7251-READ-3RD-PARTY.
 11121
 11122     MOVE +29                    TO ACTV-SEQ.
 11123
 11124
 11125* EXEC CICS HANDLE CONDITION
 11126*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 11127*         NOTFND     (7252-READ-COMP)
 11128*    END-EXEC.
 11129*    MOVE '"$JI                  ! = #00010222' TO DFHEIV0
 11130     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11131     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11132     MOVE X'3D20233030303130323232' TO DFHEIV0(25:11)
 11133     CALL 'kxdfhei1' USING DFHEIV0
 11134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11135
 11136
 11137
 11138* EXEC CICS READ
 11139*         DATASET    (ACTV-ID)
 11140*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11141*         RIDFLD     (ACTV-KEY)
 11142*    END-EXEC.
 11143*    MOVE '&"S        E          (   #00010227' TO DFHEIV0
 11144     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11145     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11146     MOVE X'2020233030303130323237' TO DFHEIV0(25:11)
 11147     CALL 'kxdfhei1' USING DFHEIV0,
 11148           ACTV-ID,
 11149           DFHEIV20,
 11150           DFHEIV99,
 11151           ACTV-KEY,
 11152           DFHEIV99,
 11153           DFHEIV99,
 11154           DFHEIV99
 11155     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11156         DFHEIV20
 11157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11158
 11159
 11160     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 11161     MOVE AT-MAIL-TO-NAME        TO WS-LABEL-LINES (1).
 11162     MOVE AT-ADDRESS-LINE-1      TO WS-LABEL-LINES (2).
 11163     MOVE AT-ADDRESS-LINE-2      TO WS-LABEL-LINES (3).
 11164*    MOVE AT-CITY-STATE          TO WS-LABEL-LINES (4).
 11165     STRING AT-CITY ' ' AT-STATE DELIMITED BY '  '
 11166        INTO WS-LABEL-LINES (4)
 11167     END-STRING
 11168
 11169     MOVE SPACES                 TO  WS-ZIP-CODE.
 11170     IF AT-CANADIAN-POST-CODE
 11171         MOVE AT-CAN-POSTAL-1    TO  WS-CAN-POSTAL-1
 11172         MOVE AT-CAN-POSTAL-2    TO  WS-CAN-POSTAL-2
 11173     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 224
* EL152.cbl
 11174         MOVE AT-ZIP-CODE        TO  WS-AM-ZIP-CODE
 11175         IF AT-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11176             MOVE '-'            TO  WS-AM-ZIP-DASH
 11177             MOVE AT-ZIP-PLUS4   TO  WS-AM-ZIP-PLUS4.
 11178
 11179     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (5).
 11180
 11181     MOVE AT-PHONE-NO            TO WS-PHONE-IN.
 11182     MOVE WSPI-AREA              TO WSPO-AREA.
 11183     MOVE WSPI-PFX               TO WSPO-PFX.
 11184     MOVE WSPI-SFX               TO WSPO-SFX.
 11185     MOVE WS-PHONE-OUT           TO SS53-6D.
 11186
 11187     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11188
 11189     MOVE WS-LABEL-LINES (1)     TO SS52D.
 11190     MOVE WS-LABEL-LINES (2)     TO SS53-1D.
 11191     MOVE WS-LABEL-LINES (3)     TO SS53-2D.
 11192     MOVE WS-LABEL-LINES (4)     TO SS53-3D.
 11193     MOVE WS-LABEL-LINES (5)     TO SS53-4D.
 11194     MOVE WS-LABEL-LINES (6)     TO SS53-5D.
 11195
 11196     GO TO 7260-READ-DENIAL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 225
* EL152.cbl
 11198 7252-READ-COMP.
 11199
 11200     IF WS-COMP-READ-SW = 'Y'
 11201        GO TO 7255-BUILD-COMP-ADDR.
 11202
 11203     IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
 11204        MOVE ZEROS         TO AM-3RD-PARTY-NOTIF-LEVEL
 11205        GO TO 7260-READ-DENIAL.
 11206
 11207     IF AM-3RD-PARTY-NOTIF-LEVEL > 00 AND < 11
 11208        NEXT SENTENCE
 11209     ELSE
 11210        GO TO 7260-READ-DENIAL.
 11211
 11212     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = SPACES OR ZEROS
 11213        GO TO 7260-READ-DENIAL.
 11214
 11215     MOVE PI-COMPANY-CD   TO WS-ERCOMP-COMPANY-CD.
 11216     MOVE AM-CARRIER      TO WS-ERCOMP-CARRIER.
 11217     MOVE AM-GROUPING     TO WS-ERCOMP-GROUPING.
 11218     MOVE 'A'             TO WS-ERCOMP-TYPE.
 11219     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 11220                          TO WS-ERCOMP-RESP-NO.
 11221
 11222     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 11223         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 11224                                       'G' OR 'B' or 'S'
 11225             MOVE 'G'            TO WS-ERCOMP-TYPE
 11226             MOVE LOW-VALUES     TO WS-ERCOMP-ACCOUNT
 11227         ELSE
 11228             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 11229                                 TO WS-ERCOMP-ACCOUNT
 11230     ELSE
 11231         MOVE 'G'                TO WS-ERCOMP-TYPE
 11232         MOVE LOW-VALUES         TO WS-ERCOMP-ACCOUNT.
 11233
 11234     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
 11235        MOVE ZEROS TO WS-ERCOMP-CARRIER.
 11236
 11237     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
 11238        MOVE ZEROS TO WS-ERCOMP-GROUPING.
 11239
 11240
 11241* EXEC CICS HANDLE CONDITION
 11242*         NOTFND    (7260-READ-DENIAL)
 11243*    END-EXEC.
 11244*    MOVE '"$I                   ! > #00010313' TO DFHEIV0
 11245     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11246     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11247     MOVE X'3E20233030303130333133' TO DFHEIV0(25:11)
 11248     CALL 'kxdfhei1' USING DFHEIV0
 11249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11250
 11251
 11252
 11253* EXEC CICS  READ
 11254*         SET      (ADDRESS OF COMPENSATION-MASTER)
 11255*         DATASET  ('ERCOMP')
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 226
* EL152.cbl
 11256*         RIDFLD   (WS-ERCOMP-KEY)
 11257*    END-EXEC.
 11258     MOVE 'ERCOMP' TO DFHEIV1
 11259*    MOVE '&"S        E          (   #00010317' TO DFHEIV0
 11260     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11261     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11262     MOVE X'2020233030303130333137' TO DFHEIV0(25:11)
 11263     CALL 'kxdfhei1' USING DFHEIV0,
 11264           DFHEIV1,
 11265           DFHEIV20,
 11266           DFHEIV99,
 11267           WS-ERCOMP-KEY,
 11268           DFHEIV99,
 11269           DFHEIV99,
 11270           DFHEIV99
 11271     SET ADDRESS OF COMPENSATION-MASTER TO
 11272         DFHEIV20
 11273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11274
 11275
 11276 7255-BUILD-COMP-ADDR.
 11277
 11278     MOVE SPACES                TO WS-LABEL-HOLD-AREA.
 11279     MOVE CO-ACCT-NAME          TO WS-LABEL-LINES (1).
 11280     IF CO-ACCT-NAME = SPACES
 11281        MOVE CO-MAIL-NAME       TO WS-LABEL-LINES (1).
 11282     MOVE CO-ADDR-1             TO WS-LABEL-LINES (2).
 11283     MOVE CO-ADDR-2             TO WS-LABEL-LINES (3).
 11284     MOVE CO-ADDR-3             TO WS-LABEL-LINES (4).
 11285
 11286     MOVE SPACES                TO  WS-ZIP-CODE.
 11287     IF CO-CANADIAN-POST-CODE
 11288         MOVE CO-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11289         MOVE CO-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11290     ELSE
 11291         MOVE CO-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11292         IF CO-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11293             MOVE '-'           TO  WS-AM-ZIP-DASH
 11294             MOVE CO-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11295
 11296     MOVE WS-ZIP-CODE           TO  WS-LABEL-LINES (5).
 11297
 11298     MOVE ZEROS                 TO WS-PHONE-IN.
 11299     MOVE CO-AREA-CODE          TO WSPO-AREA.
 11300     MOVE CO-PREFIX             TO WSPO-PFX.
 11301     MOVE CO-PHONE              TO WSPO-SFX.
 11302     MOVE WS-PHONE-OUT          TO SS53-6D.
 11303
 11304     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11305
 11306     MOVE WS-LABEL-LINES (1)     TO SS52D.
 11307     MOVE WS-LABEL-LINES (2)     TO SS53-1D.
 11308     MOVE WS-LABEL-LINES (3)     TO SS53-2D.
 11309     MOVE WS-LABEL-LINES (4)     TO SS53-3D.
 11310     MOVE WS-LABEL-LINES (5)     TO SS53-4D.
 11311     MOVE WS-LABEL-LINES (6)     TO SS53-5D.
 11312
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 227
* EL152.cbl
 11314
 11315 7260-READ-DENIAL.
 11316
 11317     MOVE +93                    TO ACTV-SEQ
 11318
 11319
 11320* EXEC CICS HANDLE CONDITION
 11321*         NOTOPEN    (8870-ACTV-NOT-OPEN)
 11322*         NOTFND     (7265-READ-CNTL1)
 11323*         ENDFILE    (7265-READ-CNTL1)
 11324*    END-EXEC.
 11325*    MOVE '"$JI''                 ! ? #00010366' TO DFHEIV0
 11326     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 11327     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11328     MOVE X'3F20233030303130333636' TO DFHEIV0(25:11)
 11329     CALL 'kxdfhei1' USING DFHEIV0
 11330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11331
 11332
 11333
 11334* EXEC CICS STARTBR
 11335*         DATASET    (ACTV-ID)
 11336*         RIDFLD     (ACTV-KEY)
 11337*         GTEQ
 11338*    END-EXEC.
 11339     MOVE 0
 11340       TO DFHEIV11
 11341*    MOVE '&,         G          &   #00010372' TO DFHEIV0
 11342     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11343     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11344     MOVE X'2020233030303130333732' TO DFHEIV0(25:11)
 11345     CALL 'kxdfhei1' USING DFHEIV0,
 11346           ACTV-ID,
 11347           ACTV-KEY,
 11348           DFHEIV99,
 11349           DFHEIV11,
 11350           DFHEIV99
 11351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11352
 11353
 11354     MOVE 'Y'                    TO ACTV-BROWSE-STARTED.
 11355     MOVE ACTV-PARTIAL-KEY       TO ACTV-SAVE-KEY.
 11356
 11357 7262-READ-NEXT.
 11358
 11359
 11360* EXEC CICS READNEXT
 11361*         SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11362*         RIDFLD  (ACTV-KEY)
 11363*         DATASET (ACTV-ID)
 11364*    END-EXEC.
 11365     MOVE 0
 11366       TO DFHEIV11
 11367*    MOVE '&.S                   )   #00010383' TO DFHEIV0
 11368     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11369     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11370     MOVE X'2020233030303130333833' TO DFHEIV0(25:11)
 11371     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 228
* EL152.cbl
 11372           ACTV-ID,
 11373           DFHEIV20,
 11374           DFHEIV99,
 11375           ACTV-KEY,
 11376           DFHEIV99,
 11377           DFHEIV11,
 11378           DFHEIV99,
 11379           DFHEIV99
 11380     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11381         DFHEIV20
 11382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11383
 11384
 11385     IF ACTV-PARTIAL-KEY  NOT = ACTV-SAVE-KEY
 11386        GO TO 7265-READ-CNTL1.
 11387     IF AT-TRAILER-TYPE = '2'
 11388        AND AT-PAYMENT-TYPE = 'I'
 11389        AND AT-INT-RATE NUMERIC
 11390        AND AT-INT-RATE NOT = ZEROS
 11391        COMPUTE WS-WORK-INT-RATE = AT-INT-RATE * 100
 11392        MOVE +1                  TO S2
 11393        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
 11394           (S1 > +6)
 11395           IF WS-WORK-INT (S1:1) NOT = '0'
 11396              MOVE WS-WORK-INT (S1:1)
 11397                                 TO SS16-1D (S2:1)
 11398              ADD +1             TO S2
 11399           END-IF
 11400        END-PERFORM
 11401        MOVE '%'                 TO SS16-1D (S2:1)
 11402        GO TO 7262-READ-NEXT
 11403     END-IF
 11404     IF AT-TRAILER-TYPE = '8'
 11405        MOVE AT-DENIAL-INFO-1    TO SS35-1D
 11406        MOVE AT-DENIAL-INFO-2    TO SS35-2D
 11407        IF (CL-TOTAL-INT-PAID = ZEROS)
 11408           OR (CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1)
 11409           GO TO 7265-READ-CNTL1
 11410        END-IF
 11411     END-IF
 11412     GO TO 7262-READ-NEXT
 11413     .
 11414 7265-READ-CNTL1.
 11415     IF ACTV-BROWSE-STARTED = 'Y'
 11416        MOVE 'N'                  TO ACTV-BROWSE-STARTED
 11417
 11418* EXEC CICS ENDBR
 11419*            DATASET    (ACTV-ID)
 11420*       END-EXEC.
 11421     MOVE 0
 11422       TO DFHEIV11
 11423*    MOVE '&2                    $   #00010421' TO DFHEIV0
 11424     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11425     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11426     MOVE X'2020233030303130343231' TO DFHEIV0(25:11)
 11427     CALL 'kxdfhei1' USING DFHEIV0,
 11428           ACTV-ID,
 11429           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 229
* EL152.cbl
 11430           DFHEIV99
 11431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11432
 11433
 11434     IF SS35-1D = ALL '*'
 11435         MOVE '@@DENIAL1'        TO SS35-1D.
 11436
 11437     IF SS35-2D = ALL '*'
 11438         MOVE '@@DENIAL2'        TO SS35-2D.
 11439
 11440     MOVE '1'                    TO CNTL-RECORD-TYPE.
 11441     MOVE ZEROS                  TO CNTL-SEQ.
 11442
 11443* EXEC CICS HANDLE CONDITION
 11444*         NOTOPEN   (8840-CNTL-NOT-OPEN)
 11445*         NOTFND    (7266-READ-CNTL2)
 11446*    END-EXEC.
 11447*    MOVE '"$JI                  ! @ #00010433' TO DFHEIV0
 11448     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11449     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11450     MOVE X'4020233030303130343333' TO DFHEIV0(25:11)
 11451     CALL 'kxdfhei1' USING DFHEIV0
 11452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11453
 11454
 11455
 11456* EXEC CICS READ
 11457*         DATASET   (CNTL-ID)
 11458*         SET       (ADDRESS OF CONTROL-FILE)
 11459*         RIDFLD    (CNTL-KEY)
 11460*    END-EXEC.
 11461*    MOVE '&"S        E          (   #00010438' TO DFHEIV0
 11462     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11463     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11464     MOVE X'2020233030303130343338' TO DFHEIV0(25:11)
 11465     CALL 'kxdfhei1' USING DFHEIV0,
 11466           CNTL-ID,
 11467           DFHEIV20,
 11468           DFHEIV99,
 11469           CNTL-KEY,
 11470           DFHEIV99,
 11471           DFHEIV99,
 11472           DFHEIV99
 11473     SET ADDRESS OF CONTROL-FILE TO
 11474         DFHEIV20
 11475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11476
 11477
 11478     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 11479     MOVE CF-CL-MAIL-TO-NAME     TO WS-LABEL-LINES (1).
 11480     MOVE CF-CL-IN-CARE-OF       TO WS-LABEL-LINES (2).
 11481     MOVE CF-CL-ADDR-LINE-1      TO WS-LABEL-LINES (3).
 11482     MOVE CF-CL-ADDR-LINE-2      TO WS-LABEL-LINES (4).
 11483     MOVE CF-CL-CITY-STATE       TO WS-LABEL-LINES (5).
 11484
 11485     IF CF-CL-ZIP-CODE-NUM NOT NUMERIC
 11486         MOVE ZEROS              TO  CF-CL-ZIP-CODE-NUM.
 11487     IF CF-CL-ZIP-CODE-NUM NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 230
* EL152.cbl
 11488         MOVE CF-CL-ZIP-CODE-NUM TO  WS-ZIP-NUMERIC
 11489         MOVE WS-ZIP-NONNUM      TO  CF-CL-ZIP-CODE.
 11490
 11491     MOVE SPACES                 TO  WS-ZIP-CODE.
 11492     IF CF-CL-CAN-POST-CODE
 11493         MOVE CF-CL-CAN-POSTAL-1   TO  WS-CAN-POSTAL-1
 11494         MOVE CF-CL-CAN-POSTAL-2   TO  WS-CAN-POSTAL-2
 11495     ELSE
 11496         MOVE CF-CL-ZIP-PRIME      TO  WS-AM-ZIP-CODE
 11497         IF CF-CL-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11498             MOVE '-'              TO  WS-AM-ZIP-DASH
 11499             MOVE CF-CL-ZIP-PLUS4  TO  WS-AM-ZIP-PLUS4.
 11500
 11501     MOVE WS-ZIP-CODE            TO  WS-LABEL-LINES (6).
 11502
 11503     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11504
 11505     MOVE WS-LABEL-LINES (1)     TO SS01D.
 11506     MOVE WS-LABEL-LINES (2)     TO SS02-1D.
 11507     MOVE WS-LABEL-LINES (3)     TO SS02-2D.
 11508     MOVE WS-LABEL-LINES (4)     TO SS02-3D.
 11509     MOVE WS-LABEL-LINES (5)     TO SS02-4D.
 11510     MOVE WS-LABEL-LINES (6)     TO SS02-5D.
 11511
 11512 7266-READ-CNTL2.
 11513     IF PI-PROCESSOR-ID  =  LGXX-ID
 11514        GO TO 7267-READ-CNTL4.
 11515
 11516     MOVE '2'                    TO CNTL-RECORD-TYPE.
 11517     MOVE PI-PROCESSOR-ID        TO CNTL-GENL.
 11518     MOVE ZEROS                  TO CNTL-SEQ.
 11519
 11520
 11521* EXEC CICS HANDLE CONDITION
 11522*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11523*         NOTFND     (7267-READ-CNTL4)
 11524*    END-EXEC.
 11525*    MOVE '"$JI                  ! A #00010486' TO DFHEIV0
 11526     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11527     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11528     MOVE X'4120233030303130343836' TO DFHEIV0(25:11)
 11529     CALL 'kxdfhei1' USING DFHEIV0
 11530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11531
 11532
 11533
 11534* EXEC CICS READ
 11535*         DATASET    (CNTL-ID)
 11536*         SET        (ADDRESS OF CONTROL-FILE)
 11537*         RIDFLD     (CNTL-KEY)
 11538*    END-EXEC.
 11539*    MOVE '&"S        E          (   #00010491' TO DFHEIV0
 11540     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11541     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11542     MOVE X'2020233030303130343931' TO DFHEIV0(25:11)
 11543     CALL 'kxdfhei1' USING DFHEIV0,
 11544           CNTL-ID,
 11545           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 231
* EL152.cbl
 11546           DFHEIV99,
 11547           CNTL-KEY,
 11548           DFHEIV99,
 11549           DFHEIV99,
 11550           DFHEIV99
 11551     SET ADDRESS OF CONTROL-FILE TO
 11552         DFHEIV20
 11553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11554
 11555
 11556     MOVE CF-PROCESSOR-NAME      TO SS08D.
 11557     MOVE CF-PROCESSOR-TITLE     TO SS09D.
 11558
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 232
* EL152.cbl
 11560 7267-READ-CNTL4.
 11561*    IF CL-SYSTEM-IDENTIFIER = 'CV'
 11562*        GO TO 7267-READ-EMPLAN.
 11563
 11564     IF BEN-HOLD = ZEROS
 11565        GO TO 7267-READ-CNTL6.
 11566
 11567     MOVE BEN-HOLD               TO CNTL-GEN2.
 11568     MOVE SPACES                 TO CNTL-GEN1.
 11569
 11570     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11571        MOVE '4'                 TO CNTL-RECORD-TYPE
 11572     ELSE
 11573        MOVE '5'                 TO CNTL-RECORD-TYPE.
 11574
 11575     MOVE ZEROS                  TO CNTL-SEQ.
 11576
 11577
 11578* EXEC CICS HANDLE CONDITION
 11579*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11580*         NOTFND     (7267-READ-CNTL6)
 11581*    END-EXEC.
 11582*    MOVE '"$JI                  ! B #00010518' TO DFHEIV0
 11583     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11585     MOVE X'4220233030303130353138' TO DFHEIV0(25:11)
 11586     CALL 'kxdfhei1' USING DFHEIV0
 11587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11588
 11589
 11590
 11591* EXEC CICS READ
 11592*         DATASET    (CNTL-ID)
 11593*         SET        (ADDRESS OF CONTROL-FILE)
 11594*         RIDFLD     (CNTL-KEY)
 11595*         GTEQ
 11596*    END-EXEC.
 11597*    MOVE '&"S        G          (   #00010523' TO DFHEIV0
 11598     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11599     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11600     MOVE X'2020233030303130353233' TO DFHEIV0(25:11)
 11601     CALL 'kxdfhei1' USING DFHEIV0,
 11602           CNTL-ID,
 11603           DFHEIV20,
 11604           DFHEIV99,
 11605           CNTL-KEY,
 11606           DFHEIV99,
 11607           DFHEIV99,
 11608           DFHEIV99
 11609     SET ADDRESS OF CONTROL-FILE TO
 11610         DFHEIV20
 11611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11612
 11613
 11614     MOVE 1                      TO SUB.
 11615 7267-LOOP.
 11616     IF SUB = 9
 11617        GO TO 7267-READ-CNTL6.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 233
* EL152.cbl
 11618
 11619     IF CF-BENEFIT-CODE (SUB) < BEN-HOLD
 11620        ADD 1 TO SUB
 11621        GO TO 7267-LOOP.
 11622
 11623     IF BEN-HOLD = CF-BENEFIT-CODE (SUB)
 11624        MOVE CF-BENEFIT-DESCRIP (SUB) TO SS22D
 11625        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 11626           OR CL-CLAIM-TYPE = 'I'
 11627           OR CL-CLAIM-TYPE = 'G'
 11628           OR CL-CLAIM-TYPE = 'F'
 11629           MOVE CF-BENEFIT-ALPHA (SUB)   TO BENEFIT-WORK
 11630           MOVE ELIM-DAYS                TO SS42D.
 11631
 11632     GO TO 7267-READ-CNTL6.
 11633
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 234
* EL152.cbl
 11635*7267-READ-EMPLAN. Remove as dead code
 11636 7267-READ-CNTL6.
 11637     MOVE '6'                    TO CNTL-RECORD-TYPE.
 11638     MOVE SPACES                 TO CNTL-GENL.
 11639
 11640*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11641*        MOVE CL-CURRENT-CARRIER TO CNTL-GEN4
 11642*    ELSE
 11643         MOVE PI-CARRIER         TO CNTL-GEN4.
 11644
 11645     MOVE ZEROS                  TO CNTL-SEQ.
 11646
 11647
 11648* EXEC CICS HANDLE CONDITION
 11649*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 11650*         NOTFND     (7268-SET-DATE)
 11651*    END-EXEC.
 11652*    MOVE '"$JI                  ! C #00010563' TO DFHEIV0
 11653     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11655     MOVE X'4320233030303130353633' TO DFHEIV0(25:11)
 11656     CALL 'kxdfhei1' USING DFHEIV0
 11657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11658
 11659
 11660
 11661* EXEC CICS READ
 11662*         DATASET    (CNTL-ID)
 11663*         SET        (ADDRESS OF CONTROL-FILE)
 11664*         RIDFLD     (CNTL-KEY)
 11665*    END-EXEC.
 11666*    MOVE '&"S        E          (   #00010568' TO DFHEIV0
 11667     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11668     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11669     MOVE X'2020233030303130353638' TO DFHEIV0(25:11)
 11670     CALL 'kxdfhei1' USING DFHEIV0,
 11671           CNTL-ID,
 11672           DFHEIV20,
 11673           DFHEIV99,
 11674           CNTL-KEY,
 11675           DFHEIV99,
 11676           DFHEIV99,
 11677           DFHEIV99
 11678     SET ADDRESS OF CONTROL-FILE TO
 11679         DFHEIV20
 11680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11681
 11682
 11683     MOVE SPACES              TO WS-LABEL-HOLD-AREA.
 11684     MOVE CF-MAIL-TO-NAME     TO WS-LABEL-LINES (1).
 11685     MOVE CF-IN-CARE-OF       TO WS-LABEL-LINES (2).
 11686     MOVE CF-ADDRESS-LINE-1   TO WS-LABEL-LINES (3).
 11687     MOVE CF-ADDRESS-LINE-2   TO WS-LABEL-LINES (4).
 11688     MOVE CF-CITY-STATE       TO WS-LABEL-LINES (5).
 11689
 11690     IF CF-ZIP-CODE-NUM NOT NUMERIC
 11691         MOVE ZEROS              TO  CF-ZIP-CODE-NUM.
 11692     IF CF-ZIP-CODE-NUM NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 235
* EL152.cbl
 11693         MOVE CF-ZIP-CODE-NUM    TO  WS-ZIP-NUMERIC
 11694         MOVE WS-ZIP-NONNUM      TO  CF-ZIP-CODE.
 11695
 11696     MOVE SPACES              TO  WS-ZIP-CODE.
 11697     IF CF-CANADIAN-POST-CODE
 11698         MOVE CF-CAN-POSTAL-1  TO  WS-CAN-POSTAL-1
 11699         MOVE CF-CAN-POSTAL-2  TO  WS-CAN-POSTAL-2
 11700     ELSE
 11701         MOVE CF-ZIP-PRIME     TO  WS-AM-ZIP-CODE
 11702         IF CF-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
 11703             MOVE '-'          TO  WS-AM-ZIP-DASH
 11704             MOVE CF-ZIP-PLUS4 TO  WS-AM-ZIP-PLUS4.
 11705
 11706     MOVE WS-ZIP-CODE         TO  WS-LABEL-LINES (6).
 11707
 11708     MOVE CF-PHONE-NO         TO WS-PHONE-IN.
 11709     MOVE WSPI-AREA           TO WSPO-AREA.
 11710     MOVE WSPI-PFX            TO WSPO-PFX.
 11711     MOVE WSPI-SFX            TO WSPO-SFX.
 11712     MOVE WS-PHONE-OUT        TO SS04-6D.
 11713
 11714     PERFORM 7270-LABEL-MOVE THRU 7279-EXIT.
 11715
 11716     MOVE WS-LABEL-LINES (1)  TO SS03D
 11717     IF PI-CARRIER = '8'
 11718        MOVE 'as Administrator for Investors Heritage Life Insuran
 11719-     'ce Company'               TO SS03-1D
 11720     END-IF
 11721     MOVE WS-LABEL-LINES (2)  TO SS04-1D.
 11722     MOVE WS-LABEL-LINES (3)  TO SS04-2D.
 11723     MOVE WS-LABEL-LINES (4)  TO SS04-3D.
 11724     MOVE WS-LABEL-LINES (5)  TO SS04-4D.
 11725     MOVE WS-LABEL-LINES (6)  TO SS04-5D.
 11726
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 236
* EL152.cbl
 11728 7268-SET-DATE.
 11729     MOVE EIBDATE                TO DATE-WORK.
 11730     MOVE DT-WORK                TO DC-JULIAN-YYDDD.
 11731     MOVE '5'                    TO DC-OPTION-CODE.
 11732     PERFORM 9700-DATE-LINK  THRU  9700-EXIT.
 11733     MOVE DC-GREG-DATE-1-EDIT    TO SS20D.
 11734     MOVE DC-GREG-DATE-1-ALPHA   TO SS21D.
 11735
 11736     IF NOT LOWER-CASE-LETTERS-USED
 11737        GO TO 7269-EXIT.
 11738
 11739*    IF PI-COMPANY-ID = 'DMD'
 11740*        MOVE SS21D              TO WS-TEMP-AREA2
 11741*        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11742*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11743*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11744*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11745*        END-IF
 11746*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11747*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11748*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11749*        END-IF
 11750*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11751*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11752*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11753*        END-IF
 11754*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11755*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11756*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11757*        END-IF
 11758*        IF WS-TEMP-AREA2 (1:1) = SPACE
 11759*           MOVE WS-TEMP-AREA2 (2:29) TO WS-SAVE-TEMP-AREA2
 11760*           MOVE WS-SAVE-TEMP-AREA2   TO WS-TEMP-AREA2
 11761*        END-IF
 11762*        MOVE WS-TEMP-AREA2      TO SS21D
 11763*        GO TO 7269-EXIT.
 11764*
 11765     INSPECT SS19D   CONVERTING UPPER-CASE TO LOWER-CASE.
 11766     INSPECT SS35-1D CONVERTING UPPER-CASE TO LOWER-CASE.
 11767     INSPECT SS35-2D CONVERTING UPPER-CASE TO LOWER-CASE.
 11768     INSPECT SS22D   CONVERTING UPPER-CASE TO LOWER-CASE.
 11769
 11770     MOVE 'N'                    TO WS-STATE-LINE.
 11771
 11772     MOVE 'Y'                    TO WS-PROCESSOR-LINE.
 11773     MOVE SS08D                  TO WS-TEMP-AREA2.
 11774     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11775     MOVE WS-TEMP-AREA2          TO SS08D.
 11776     MOVE 'N'                    TO WS-PROCESSOR-LINE.
 11777     MOVE 'N'                    TO WS-CAPS-SW.
 11778
 11779     MOVE SS09D                  TO WS-TEMP-AREA2.
 11780     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11781     MOVE WS-TEMP-AREA2          TO SS09D.
 11782
 11783     MOVE SS11-5D                TO WS-TEMP-AREA2.
 11784     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11785     MOVE WS-TEMP-AREA2          TO SS11-5D.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 237
* EL152.cbl
 11786
 11787     MOVE SS21D                  TO WS-TEMP-AREA2.
 11788     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11789     MOVE WS-TEMP-AREA2          TO SS21D.
 11790
 11791     MOVE SS40D                  TO WS-TEMP-AREA2.
 11792     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11793     MOVE WS-TEMP-AREA2          TO SS40D.
 11794
 11795     MOVE SS41D                  TO WS-TEMP-AREA2.
 11796     PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT.
 11797     MOVE WS-TEMP-AREA2          TO SS41D.
 11798
 11799 7269-EXIT.
 11800     EXIT.
 11801
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 238
* EL152.cbl
 11803*            COPY ELCNAMET.
 11804*****************************************************************
 11805*                                                               *
 11806*                                                               *
 11807*                            ELCNAMET                           *
 11808*                            VMOD=2.003                         *
 11809*                                                               *
 11810*            TRANSLATION ROUTINE USED MAINLY FOR CONVERTING     *
 11811*            NAMES AND ADDRESSES AND OTHER VARIABLES TO         *
 11812*            LOWER CASE.  THE FIRST CHARACTER OF EACH WORD      *
 11813*            IS LEFT AS UPPER AND ALL OTHER LOWER CASE.         *
 11814*                                                               *
 11815*                                                               *
 11816*****************************************************************.
 11817*                   C H A N G E   L O G
 11818*
 11819* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 11820*-----------------------------------------------------------------
 11821*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 11822* EFFECTIVE    NUMBER
 11823*-----------------------------------------------------------------
 11824* 102703                   SMVA  LEAVE CERTIFICATION DESIGNATION O
 11825*                                PROCESSOR NAME LINE IN CAPS
 11826******************************************************************
 11827
 11828 7270-LABEL-MOVE.
 11829     IF WS-LABEL-HOLD-AREA = SPACES
 11830        GO TO 7279-EXIT.
 11831
 11832     IF PI-COMPANY-ID NOT = 'DMD'
 11833         PERFORM 7280-TRANSLATE-LOWER THRU 7280-EXIT.
 11834
 11835 7270-LABEL-MOVE-1.
 11836
 11837     IF WS-LABEL-LINES (1) = SPACES
 11838        MOVE WS-LABEL-LINES (2)  TO WS-LABEL-LINES (1)
 11839        MOVE WS-LABEL-LINES (3)  TO WS-LABEL-LINES (2)
 11840        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11841        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11842        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11843        MOVE SPACES              TO WS-LABEL-LINES (6)
 11844        GO TO 7270-LABEL-MOVE-1.
 11845
 11846     IF WS-LABEL-LINES (2) = SPACES AND
 11847        WS-LABEL-LINES (3) = SPACES AND
 11848        WS-LABEL-LINES (4) = SPACES AND
 11849        WS-LABEL-LINES (5) = SPACES AND
 11850        WS-LABEL-LINES (6) = SPACES
 11851        SET WS-NDX               TO 1
 11852        GO TO 7275-MOVE-ZIP.
 11853
 11854 7270-LABEL-MOVE-2.
 11855
 11856     IF WS-LABEL-LINES (2) = SPACES
 11857        MOVE WS-LABEL-LINES (3)  TO WS-LABEL-LINES (2)
 11858        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11859        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11860        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 239
* EL152.cbl
 11861        MOVE SPACES              TO WS-LABEL-LINES (6)
 11862        GO TO 7270-LABEL-MOVE-2.
 11863
 11864     IF WS-LABEL-LINES (3) = SPACES AND
 11865        WS-LABEL-LINES (4) = SPACES AND
 11866        WS-LABEL-LINES (5) = SPACES AND
 11867        WS-LABEL-LINES (6) = SPACES
 11868        SET WS-NDX               TO 2
 11869        GO TO 7275-MOVE-ZIP.
 11870
 11871 7270-LABEL-MOVE-3.
 11872
 11873     IF WS-LABEL-LINES (3) = SPACES
 11874        MOVE WS-LABEL-LINES (4)  TO WS-LABEL-LINES (3)
 11875        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11876        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11877        MOVE SPACES              TO WS-LABEL-LINES (6)
 11878        GO TO 7270-LABEL-MOVE-3.
 11879
 11880     IF WS-LABEL-LINES (4) = SPACES AND
 11881        WS-LABEL-LINES (5) = SPACES AND
 11882        WS-LABEL-LINES (6) = SPACES
 11883        SET WS-NDX               TO 3
 11884        GO TO 7275-MOVE-ZIP.
 11885
 11886 7270-LABEL-MOVE-4.
 11887
 11888     IF WS-LABEL-LINES (4) = SPACES
 11889        MOVE WS-LABEL-LINES (5)  TO WS-LABEL-LINES (4)
 11890        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11891        MOVE SPACES              TO WS-LABEL-LINES (6)
 11892        GO TO 7270-LABEL-MOVE-4.
 11893
 11894     IF WS-LABEL-LINES (5) = SPACES AND
 11895        WS-LABEL-LINES (6) = SPACES
 11896        SET WS-NDX               TO 4
 11897        GO TO 7275-MOVE-ZIP.
 11898
 11899 7270-LABEL-MOVE-5.
 11900
 11901     IF WS-LABEL-LINES (5) = SPACES
 11902        MOVE WS-LABEL-LINES (6)  TO WS-LABEL-LINES (5)
 11903        MOVE SPACES              TO WS-LABEL-LINES (6)
 11904        SET WS-NDX               TO 5
 11905        GO TO 7275-MOVE-ZIP
 11906
 11907     ELSE
 11908        IF WS-LABEL-LINES (6) = SPACES
 11909           SET WS-NDX            TO 5
 11910           GO TO 7275-MOVE-ZIP
 11911
 11912        ELSE
 11913           SET WS-NDX            TO 6.
 11914
 11915 7275-MOVE-ZIP.
 11916
 11917     SET WS-NDX2                 TO WS-NDX.
 11918     SET WS-NDX2 DOWN BY +1.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 240
* EL152.cbl
 11919
 11920     IF  WS-LAST-ZIP (WS-NDX2) = SPACES
 11921*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 11922         IF WS-LABEL-1ST-ZIP (WS-NDX) NUMERIC
 11923          IF PI-COMPANY-ID NOT = 'FLA'
 11924            MOVE WS-LABEL-ZIP (WS-NDX)
 11925                                     TO WS-LAST-ZIP (WS-NDX2)
 11926            MOVE SPACES              TO WS-LABEL-LINES (WS-NDX).
 11927
 11928 7279-EXIT.
 11929     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 241
* EL152.cbl
 11931
 11932 7280-TRANSLATE-LOWER.
 11933     IF LOWER-CASE-LETTERS-USED
 11934        MOVE 'N'                     TO WS-STATE-LINE
 11935     ELSE
 11936        GO TO 7280-EXIT.
 11937
 11938     IF WS-LABEL-LINES (1) NOT = SPACES
 11939        MOVE WS-LABEL-LINES (1)      TO WS-TEMP-AREA2
 11940        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11941        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (1).
 11942
 11943     IF WS-LABEL-LINES (2) NOT = SPACES
 11944        MOVE WS-LABEL-LINES (2)      TO WS-TEMP-AREA2
 11945        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11946        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (2).
 11947
 11948     IF WS-LABEL-LINES (3) NOT = SPACES
 11949        MOVE WS-LABEL-LINES (3)      TO WS-TEMP-AREA2
 11950        PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11951        MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (3).
 11952
 11953*****THE CITY STATE WILL BE ON LINE FOUR OR FIVE DEPENDING
 11954*****ON THE FORMAT USED.  THE SIXTH LINE BEING BLANK WILL TELL.
 11955
 11956
 11957     IF WS-LABEL-LINES (4) NOT = SPACES
 11958        IF (WS-LABEL-LINES (6) = SPACES  OR
 11959           WS-LABEL-LINES (5) = SPACES)
 11960           MOVE 'Y'                     TO WS-STATE-LINE
 11961           MOVE WS-LABEL-LINES (4)      TO WS-TEMP-AREA2
 11962           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11963           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (4)
 11964        ELSE
 11965           MOVE WS-LABEL-LINES (4)      TO WS-TEMP-AREA2
 11966           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11967           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (4).
 11968
 11969     IF WS-LABEL-LINES (5) NOT = SPACES
 11970        IF WS-LABEL-LINES (6) NOT = SPACES
 11971           MOVE 'Y'                     TO WS-STATE-LINE
 11972           MOVE WS-LABEL-LINES (5)      TO WS-TEMP-AREA2
 11973           PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 11974           MOVE WS-TEMP-AREA2           TO WS-LABEL-LINES (5).
 11975
 11976 7280-EXIT.
 11977     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 242
* EL152.cbl
 11979
 11980 7281-SEARCH-AND-TRANSLATE.
 11981     SET TA1  TO +1.
 11982
 11983 7281-FIND-FIRST-NON-BLANK.
 11984     IF WS-TEMP-2 (TA1) = SPACES
 11985        SET TA1 UP BY 1
 11986        GO TO 7281-FIND-FIRST-NON-BLANK.
 11987
 11988*****SET INDEX TO THE NEXT CHAR TO START THE TRANSLATE.
 11989     SET TA2   TO TA1
 11990     SET TA2   UP BY 1
 11991     SET TA21  TO TA2
 11992     SET TA21  UP BY 1.
 11993
 11994     MOVE 'N'                   TO WS-DATA-FOUND-SW.
 11995     PERFORM 7282-FIND-NEXT-BLANK THRU 7282-EXIT.
 11996
 11997 7281-EXIT.
 11998     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 243
* EL152.cbl
 12000
 12001 7282-FIND-NEXT-BLANK.
 12002     IF TA21 GREATER THAN 31
 12003        GO TO 7282-EXIT.
 12004
 12005     IF TA21 EQUAL TO 31
 12006        IF NO-CHARACTERS-FOUND
 12007           GO TO 7282-EXIT
 12008           ELSE
 12009           SET TA1   TO +1
 12010           MOVE SPACES             TO WS-TEMP-AREA1
 12011           PERFORM 7283-MOVE VARYING MOVE-INDX FROM TA2 BY 1
 12012                   UNTIL MOVE-INDX EQUAL TO TA21
 12013           PERFORM 7285-TEST-AND-TRANSLATE THRU 7285-EXIT
 12014           SET TA1   TO +1
 12015           PERFORM 7284-MOVE-BACK VARYING MOVE-INDX FROM TA2 BY 1
 12016                   UNTIL MOVE-INDX EQUAL TO TA21
 12017           GO TO 7282-EXIT.
 12018
 12019     IF WS-TEMP-2 (TA2)  = SPACE OR ',' OR '/'
 12020         GO TO 7282-NEXT-GROUP-SEARCH.
 12021
 12022     IF WS-TEMP-2 (TA21) = SPACES OR ',' OR '/'
 12023         IF WS-TEMP-2 (TA21)  = ','
 12024            AND WS-PROCESSOR-LINE = 'Y'
 12025             SET THE-REST-R-CAPS TO TRUE
 12026         ELSE
 12027             CONTINUE
 12028     ELSE
 12029         MOVE 'Y'                  TO WS-DATA-FOUND-SW
 12030         SET TA21 UP BY +1
 12031         GO TO 7282-FIND-NEXT-BLANK.
 12032
 12033     SET TA1  TO +1
 12034     MOVE SPACES                   TO WS-TEMP-AREA1.
 12035     PERFORM 7283-MOVE VARYING MOVE-INDX FROM TA2 BY 1
 12036             UNTIL MOVE-INDX EQUAL TO TA21
 12037     PERFORM 7285-TEST-AND-TRANSLATE THRU 7285-EXIT.
 12038     SET TA1  TO +1
 12039     PERFORM 7284-MOVE-BACK VARYING MOVE-INDX FROM TA2 BY 1
 12040             UNTIL MOVE-INDX EQUAL TO TA21
 12041     IF THE-REST-R-CAPS
 12042         GO TO 7282-EXIT.
 12043     SET TA2   TO TA21
 12044     SET TA21  UP BY 1
 12045     MOVE 'N'                   TO WS-DATA-FOUND-SW.
 12046 7282-NEXT-GROUP-SEARCH.
 12047     IF WS-TEMP-2 (TA2) EQUAL TO SPACES OR ',' OR '/'
 12048        SET TA2   UP BY 1
 12049        IF TA2 = 30
 12050           GO TO 7282-EXIT
 12051           ELSE
 12052           GO TO 7282-NEXT-GROUP-SEARCH.
 12053
 12054     SET TA2    UP BY 1
 12055     SET TA21   TO TA2
 12056     SET TA21   UP BY 1
 12057     GO TO 7282-FIND-NEXT-BLANK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 244
* EL152.cbl
 12058
 12059 7282-EXIT.
 12060     EXIT.
 12061
 12062
 12063 7283-MOVE.
 12064     MOVE WS-TEMP-2 (MOVE-INDX) TO WS-TEMP-1 (TA1)
 12065     SET TA1 UP BY +1.
 12066
 12067
 12068 7284-MOVE-BACK.
 12069     MOVE WS-TEMP-1 (TA1)       TO WS-TEMP-2 (MOVE-INDX).
 12070     SET TA1 UP BY +1.
 12071
 12072 7285-TEST-AND-TRANSLATE.
 12073***BYPASS IF THE AREA MAY BE A PO BOX, OR RR NUMBER
 12074     IF WS-TEMP-AREA1 = '.O.' OR 'RR' OR 'O'
 12075        GO TO 7285-EXIT.
 12076
 12077***BYPASS IF IT IS A CITY/STATE LINE AND BEYOND CHARACTER 07
 12078***AND IT APPEARS THAT IT MAY BE A ABREVIATION.
 12079
 12080     SET WS-POSITION2   TO TA2
 12081     SET WS-POSITION21  TO TA21
 12082     COMPUTE WS-WORD-LENGTH = WS-POSITION21 - WS-POSITION2
 12083     IF WS-WORD-LENGTH LESS THAN 3 AND
 12084        WS-STATE-LINE = 'Y' AND
 12085        TA2 GREATER THAN 07
 12086        GO TO 7285-EXIT.
 12087
 12088     INSPECT WS-TEMP-AREA1 CONVERTING UPPER-CASE TO LOWER-CASE.
 12089
 12090 7285-EXIT.
 12091     EXIT.
 12092
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 245
* EL152.cbl
 12094 7290-RESOLVE-CREDITOR.
 12095
 12096
 12097* EXEC CICS HANDLE CONDITION
 12098*         NOTOPEN    (7290-BENE-NOT-OPEN)
 12099*         NOTFND     (7290-EXIT)
 12100*    END-EXEC.
 12101*    MOVE '"$JI                  ! D #00010987' TO DFHEIV0
 12102     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12103     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12104     MOVE X'4420233030303130393837' TO DFHEIV0(25:11)
 12105     CALL 'kxdfhei1' USING DFHEIV0
 12106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12107
 12108
 12109     MOVE SPACES                 TO WS-LABEL-HOLD-AREA.
 12110
 12111     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 12112     MOVE 'B'                    TO BENE-REC-TYPE.
 12113     MOVE SPACES                 TO BENE-NUMBER.
 12114     MOVE CL-CURRENT-GROUPING    TO BENE-CREDITOR.
 12115
 12116
 12117* EXEC CICS READ
 12118*         DATASET    (BENE-ID)
 12119*         SET        (ADDRESS OF BENEFICIARY-MASTER)
 12120*         RIDFLD     (BENE-KEY)
 12121*    END-EXEC.
 12122*    MOVE '&"S        E          (   #00010999' TO DFHEIV0
 12123     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12124     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12125     MOVE X'2020233030303130393939' TO DFHEIV0(25:11)
 12126     CALL 'kxdfhei1' USING DFHEIV0,
 12127           BENE-ID,
 12128           DFHEIV20,
 12129           DFHEIV99,
 12130           BENE-KEY,
 12131           DFHEIV99,
 12132           DFHEIV99,
 12133           DFHEIV99
 12134     SET ADDRESS OF BENEFICIARY-MASTER TO
 12135         DFHEIV20
 12136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12137
 12138
 12139     IF LOWER-CASE-LETTERS-USED
 12140         MOVE BE-MAIL-TO-NAME    TO WS-TEMP-AREA2
 12141         PERFORM 7281-SEARCH-AND-TRANSLATE THRU 7281-EXIT
 12142         MOVE WS-TEMP-AREA2      TO SS56D
 12143     ELSE
 12144         MOVE BE-MAIL-TO-NAME    TO SS56D.
 12145
 12146     GO TO 7290-EXIT.
 12147
 12148 7290-BENE-NOT-OPEN.
 12149
 12150     MOVE ER-7675                TO EMI-ERROR.
 12151     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 246
* EL152.cbl
 12152     MOVE -1                     TO MAINTL.
 12153     GO TO 8200-SEND-DATAONLY.
 12154
 12155 7290-EXIT.
 12156     EXIT.
 12157
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 247
* EL152.cbl
 12159 7300-VARIABLE-SEARCH.
 12160***************************************************************
 12161*    THIS ROUTINE SEARCHES THE NEWLY CREATED LETTER FOR ANY   *
 12162*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 12163*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 12164*    DATA THAT WAS GENERATED IN PARAGRAPHS 7200-7299.         *
 12165*                                                             *
 12166*    THE ADDRESSING OF THE VARIABLE TABLE IS ACCOMPLISHED     *
 12167*    BY DOING A GETMAIN, MOVING THE TABLE TO THE NEW STORAGE  *
 12168*    AND BY ADJUSTING THE BLL POINTER TO POINT AT THE DATA.   *
 12169***************************************************************
 12170
 12171     MOVE REC-TEXT (TB-INDX)     TO SINGLE-LINE.
 12172
 12173     SET INDX1 TO 1.
 12174 7301-LOOP.
 12175     IF INDX1 > 70
 12176        MOVE SINGLE-LINE         TO REC-TEXT (TB-INDX)
 12177        GO TO 7399-EXIT.
 12178
 12179     IF ONE-CHAR (INDX1) NOT = '@'
 12180        SET INDX1 UP BY 1
 12181        GO TO 7301-LOOP.
 12182
 12183     SET INDX2 TO INDX1.
 12184     SET INDX2 UP BY 1.
 12185
 12186     IF ONE-CHAR (INDX2) = '@'
 12187        SET INDX1 UP BY 2
 12188        GO TO 7301-LOOP.
 12189
 12190     MOVE ONE-CHAR (INDX2)       TO V1.
 12191     SET INDX2 UP BY 1.
 12192     MOVE ONE-CHAR (INDX2)       TO V2.
 12193     SET INDX2 UP BY 1.
 12194     MOVE ONE-CHAR (INDX2)       TO V3.
 12195     SET INDX2 UP BY 1.
 12196     MOVE ONE-CHAR (INDX2)       TO V4.
 12197
 12198     IF V-NUM NOT NUMERIC
 12199        GO TO 7330-VAR-ERROR.
 12200
 12201     IF V-PERIOD NOT = '.'
 12202        MOVE '.'                 TO V-PERIOD
 12203        MOVE ZERO                TO V-DECIMAL
 12204        GO TO 7340-TABLE-SEARCH.
 12205
 12206     IF V-DECIMAL NUMERIC
 12207        GO TO 7340-TABLE-SEARCH.
 12208
 12209 7330-VAR-ERROR.
 12210     MOVE ER-0180                TO EMI-ERROR.
 12211     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12212     SET INDX1 UP BY 1.
 12213     GO TO 7301-LOOP.
 12214
 12215 7340-TABLE-SEARCH.
 12216
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 248
* EL152.cbl
 12217     IF REFRESH-GETMAIN-AREA
 12218*        MOVE SAVE-VARIABLE-POINTER      TO LCP-WS-ADDR-COMP
 12219*        SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12220         MOVE SYSTEM-SUPPORTED-VARIABLES TO SYSTEM-VARIABLES
 12221         MOVE 2                          TO GETMAIN-SWITCH
 12222         MOVE 1                          TO SS-COUNTER
 12223                                            B1
 12224     ELSE
 12225         IF NO-GETMAIN-DONE-YET
 12226*            EXEC CICS GETMAIN
 12227*                 SET       (ADDRESS OF SYSTEM-VARIABLES)
 12228*                 LENGTH    (SS-WORK-AREA-LENGTH)
 12229*            END-EXEC
 12230             MOVE 2              TO GETMAIN-SWITCH
 12231*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF SYSTEM-VARIABLES
 12232*            MOVE LCP-WS-ADDR-COMP
 12233*                                TO SAVE-VARIABLE-POINTER
 12234             MOVE SYSTEM-SUPPORTED-VARIABLES
 12235                                 TO SYSTEM-VARIABLES
 12236             MOVE 1              TO SS-COUNTER
 12237                                    B1
 12238         ELSE
 12239             MOVE 1              TO SS-COUNTER
 12240                                    B1
 12241*            MOVE SAVE-VARIABLE-POINTER
 12242*                                TO LCP-WS-ADDR-COMP
 12243*            SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12244         END-IF
 12245     END-IF
 12246     .
 12247 7350-TABLE-LOOP.
 12248
 12249     IF SS-COUNTER  >  SS-NUM-ENTRIES
 12250        GO TO 7330-VAR-ERROR.
 12251
 12252     MOVE SYSTEM-VARIABLES (B1:106)
 12253                                 TO SYS-VAR-ENTRY
 12254     IF SYS-VAR-CODE NOT = VAR-HOLD
 12255        ADD SYS-VAR-LEN          TO B1
 12256*       SET LCP-WS-ADDR-PNTR TO ADDRESS OF SYSTEM-VARIABLES
 12257*       ADD SYS-VAR-LEN          TO LCP-WS-ADDR-COMP
 12258*       SET ADDRESS OF SYSTEM-VARIABLES TO LCP-WS-ADDR-PNTR
 12259        ADD 1                    TO SS-COUNTER
 12260        GO TO 7350-TABLE-LOOP
 12261     END-IF
 12262
 12263     MOVE SYS-VAR-ENTRY          TO VARIABLE-WORK-AREA.
 12264     SET INDXV TO 1.
 12265     SUBTRACT 6                  FROM VAR-LEN.
 12266     PERFORM 7400-MOVE-VAR-DATA VAR-LEN TIMES.
 12267     GO TO 7301-LOOP.
 12268
 12269 7399-EXIT.
 12270      EXIT.
 12271
 12272 7400-MOVE-VAR-DATA.
 12273     IF INDX1 > 70
 12274        MOVE ER-0181             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 249
* EL152.cbl
 12275        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12276        GO TO 7301-LOOP.
 12277
 12278     MOVE VAR-ONE-CHAR (INDXV)   TO ONE-CHAR (INDX1).
 12279     SET INDXV UP BY 1.
 12280     SET INDX1 UP BY 1.
 12281
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 250
* EL152.cbl
 12283 7500-READ-TS.
 12284
 12285* EXEC CICS HANDLE CONDITION
 12286*         QIDERR     (7590-TS-QIDERR)
 12287*         ITEMERR    (7585-TS-ITEMERR)
 12288*    END-EXEC.
 12289*    MOVE '"$N<                  ! E #00011150' TO DFHEIV0
 12290     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 12291     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12292     MOVE X'4520233030303131313530' TO DFHEIV0(25:11)
 12293     CALL 'kxdfhei1' USING DFHEIV0
 12294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12295
 12296
 12297     SET TS-INDX TO 1.
 12298     MOVE 1                      TO TS-ITEM.
 12299
 12300 7501-LOOP.
 12301
 12302* EXEC CICS READQ TS
 12303*         INTO     (TS-WORK-AREA)
 12304*         QUEUE    (TS-NAME-TEXT)
 12305*         LENGTH   (TS-LENGTH)
 12306*         ITEM     (TS-ITEM)
 12307*    END-EXEC.
 12308*    MOVE '*$II   L              ''   #00011159' TO DFHEIV0
 12309     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 12310     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12311     MOVE X'2020233030303131313539' TO DFHEIV0(25:11)
 12312     CALL 'kxdfhei1' USING DFHEIV0,
 12313           TS-NAME-TEXT,
 12314           TS-WORK-AREA,
 12315           TS-LENGTH,
 12316           TS-ITEM,
 12317           DFHEIV99,
 12318           DFHEIV99
 12319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12320
 12321
 12322     MOVE TS-WORK-AREA           TO TS-GROUP (TS-INDX).
 12323     SET TS-INDX UP BY 1.
 12324     ADD 1                       TO TS-ITEM.
 12325     GO TO 7501-LOOP.
 12326
 12327 7585-TS-ITEMERR.
 12328     IF EIBTRNID NOT = TRANS-ID
 12329        SUBTRACT 1               FROM TS-ITEM
 12330        MOVE TS-ITEM             TO PI-TEMP-STOR-ITEMS.
 12331
 12332     GO TO 7599-EXIT.
 12333
 12334 7590-TS-QIDERR.
 12335     IF EIBTRNID = TRANS-ID
 12336        MOVE ER-0033             TO EMI-ERROR
 12337        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12338        GO TO 8200-SEND-DATAONLY.
 12339
 12340 7599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 251
* EL152.cbl
 12341      EXIT.
 12342
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 252
* EL152.cbl
 12344 7600-READ-SCREEN-TS.
 12345
 12346* EXEC CICS HANDLE CONDITION
 12347*         QIDERR     (7690-TS-QIDERR)
 12348*         ITEMERR    (7685-TS-ITEMERR)
 12349*    END-EXEC.
 12350*    MOVE '"$N<                  ! F #00011189' TO DFHEIV0
 12351     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 12352     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12353     MOVE X'4620233030303131313839' TO DFHEIV0(25:11)
 12354     CALL 'kxdfhei1' USING DFHEIV0
 12355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12356
 12357
 12358     MOVE 1                      TO TS-ITEM.
 12359
 12360
 12361* EXEC CICS READQ TS
 12362*         INTO    (EL152AO)
 12363*         QUEUE   (TS-NAME-SCREEN)
 12364*         LENGTH  (TS-MAP-LENGTH)
 12365*         ITEM    (TS-ITEM)
 12366*    END-EXEC.
 12367*    MOVE '*$II   L              ''   #00011196' TO DFHEIV0
 12368     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 12369     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12370     MOVE X'2020233030303131313936' TO DFHEIV0(25:11)
 12371     CALL 'kxdfhei1' USING DFHEIV0,
 12372           TS-NAME-SCREEN,
 12373           EL152AO,
 12374           TS-MAP-LENGTH,
 12375           TS-ITEM,
 12376           DFHEIV99,
 12377           DFHEIV99
 12378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12379
 12380
 12381     IF MAINTL NOT = ZEROS
 12382        MOVE AL-UANON            TO MAINTA.
 12383     IF ARCHNUML NOT = ZEROS
 12384        MOVE AL-UNNON            TO ARCHNUMA.
 12385     IF FORML NOT = ZEROS
 12386        MOVE AL-UANON            TO FORMA.
 12387     IF FOLLOWL NOT = ZEROS
 12388        MOVE AL-UANON            TO FOLLOWA.
 12389     IF RESENDL NOT = ZEROS
 12390        MOVE AL-UANON            TO RESENDA.
 12391     IF PRINTL NOT = ZEROS
 12392        MOVE AL-UANON            TO PRINTA.
 12393     IF COPIESL NOT = ZEROS
 12394        MOVE AL-UNNON            TO COPIESA.
 12395     IF ADDRL NOT = ZEROS
 12396        MOVE AL-UANON            TO ADDRA.
 12397     IF REL NOT = ZEROS
 12398        MOVE AL-UANON            TO REA.
 12399
 12400     GO TO 7699-EXIT.
 12401
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 253
* EL152.cbl
 12402 7685-TS-ITEMERR.
 12403     GO TO 7699-EXIT.
 12404
 12405 7690-TS-QIDERR.
 12406     IF EIBTRNID = TRANS-ID
 12407        MOVE ER-0033             TO EMI-ERROR
 12408        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12409        GO TO 8200-SEND-DATAONLY.
 12410
 12411 7699-EXIT.
 12412      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 254
* EL152.cbl
 12414
 12415 7700-PUT-TEMP-STOR.
 12416     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 12417     PERFORM 7760-DELETE-TEMP-STOR-SCREEN THRU 7760-EXIT.
 12418     SET TS-INDX TO 1.
 12419     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 12420     PERFORM 7780-WRITE-TS THRU 7780-EXIT
 12421             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
 12422             UNTIL TS-GROUP-WORK NOT < PI-TOTAL-LINES.
 12423
 12424 7749-EXIT.
 12425      EXIT.
 12426
 12427 7750-DELETE-TEMP-STOR.
 12428
 12429* EXEC CICS HANDLE CONDITION
 12430*         QIDERR      (7750-EXIT)
 12431*    END-EXEC.
 12432*    MOVE '"$N                   ! G #00011250' TO DFHEIV0
 12433     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12434     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12435     MOVE X'4720233030303131323530' TO DFHEIV0(25:11)
 12436     CALL 'kxdfhei1' USING DFHEIV0
 12437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12438
 12439
 12440
 12441* EXEC CICS DELETEQ TS
 12442*         QUEUE       (TS-NAME-TEXT)
 12443*    END-EXEC.
 12444*    MOVE '*&                    #   #00011254' TO DFHEIV0
 12445     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12446     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12447     MOVE X'2020233030303131323534' TO DFHEIV0(25:11)
 12448     CALL 'kxdfhei1' USING DFHEIV0,
 12449           TS-NAME-TEXT,
 12450           DFHEIV99
 12451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12452
 12453
 12454 7750-EXIT.
 12455     EXIT.
 12456
 12457 7760-DELETE-TEMP-STOR-SCREEN.
 12458
 12459* EXEC CICS HANDLE CONDITION
 12460*         QIDERR     (7760-EXIT)
 12461*    END-EXEC.
 12462*    MOVE '"$N                   ! H #00011262' TO DFHEIV0
 12463     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12464     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12465     MOVE X'4820233030303131323632' TO DFHEIV0(25:11)
 12466     CALL 'kxdfhei1' USING DFHEIV0
 12467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12468
 12469
 12470
 12471* EXEC CICS DELETEQ TS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 255
* EL152.cbl
 12472*         QUEUE      (TS-NAME-SCREEN)
 12473*    END-EXEC.
 12474*    MOVE '*&                    #   #00011266' TO DFHEIV0
 12475     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12476     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12477     MOVE X'2020233030303131323636' TO DFHEIV0(25:11)
 12478     CALL 'kxdfhei1' USING DFHEIV0,
 12479           TS-NAME-SCREEN,
 12480           DFHEIV99
 12481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12482
 12483
 12484 7760-EXIT.
 12485     EXIT.
 12486
 12487 7770-DELETE-TEMP-STOR-PI-AREA.
 12488
 12489* EXEC CICS HANDLE CONDITION
 12490*        QIDERR   (7770-EXIT)
 12491*    END-EXEC.
 12492*    MOVE '"$N                   ! I #00011274' TO DFHEIV0
 12493     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 12494     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12495     MOVE X'4920233030303131323734' TO DFHEIV0(25:11)
 12496     CALL 'kxdfhei1' USING DFHEIV0
 12497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12498
 12499
 12500
 12501* EXEC CICS DELETEQ TS
 12502*        QUEUE    (WS-PI-QID)
 12503*    END-EXEC.
 12504*    MOVE '*&                    #   #00011278' TO DFHEIV0
 12505     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 12506     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12507     MOVE X'2020233030303131323738' TO DFHEIV0(25:11)
 12508     CALL 'kxdfhei1' USING DFHEIV0,
 12509           WS-PI-QID,
 12510           DFHEIV99
 12511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12512
 12513
 12514 7770-EXIT.
 12515     EXIT.
 12516
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 256
* EL152.cbl
 12518 7780-WRITE-TS.
 12519     MOVE TS-GROUP (TS-INDX)     TO TS-WORK-AREA.
 12520     SET TS-INDX UP BY 1.
 12521     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 12522
 12523
 12524* EXEC CICS WRITEQ TS
 12525*         FROM    (TS-WORK-AREA)
 12526*         QUEUE   (TS-NAME-TEXT)
 12527*         LENGTH  (TS-LENGTH)
 12528*         ITEM    (PI-TEMP-STOR-ITEMS)
 12529*    END-EXEC.
 12530*    MOVE '*" I                  ''   #00011291' TO DFHEIV0
 12531     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 12532     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12533     MOVE X'2020233030303131323931' TO DFHEIV0(25:11)
 12534     CALL 'kxdfhei1' USING DFHEIV0,
 12535           TS-NAME-TEXT,
 12536           TS-WORK-AREA,
 12537           TS-LENGTH,
 12538           PI-TEMP-STOR-ITEMS,
 12539           DFHEIV99,
 12540           DFHEIV99
 12541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12542
 12543
 12544 7780-EXIT.
 12545     EXIT.
 12546
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 257
* EL152.cbl
 12548 7790-WRITE-SCREEN-TS.
 12549     MOVE 1                      TO TS-ITEM.
 12550
 12551
 12552* EXEC CICS WRITEQ TS
 12553*         FROM    (EL152AI)
 12554*         QUEUE   (TS-NAME-SCREEN)
 12555*         LENGTH  (TS-MAP-LENGTH)
 12556*         ITEM    (TS-ITEM)
 12557*    END-EXEC.
 12558*    MOVE '*" I                  ''   #00011305' TO DFHEIV0
 12559     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 12560     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12561     MOVE X'2020233030303131333035' TO DFHEIV0(25:11)
 12562     CALL 'kxdfhei1' USING DFHEIV0,
 12563           TS-NAME-SCREEN,
 12564           EL152AI,
 12565           TS-MAP-LENGTH,
 12566           TS-ITEM,
 12567           DFHEIV99,
 12568           DFHEIV99
 12569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12570
 12571
 12572 7790-EXIT.
 12573     EXIT.
 12574
 12575 7795-WRITE-PI-AREA-TS.
 12576
 12577* EXEC CICS WRITEQ TS
 12578*        QUEUE    (WS-PI-QID)
 12579*        FROM     (PROGRAM-INTERFACE-BLOCK)
 12580*        LENGTH   (PI-COMM-LENGTH)
 12581*    END-EXEC.
 12582*    MOVE '*"                    ''   #00011316' TO DFHEIV0
 12583     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 12584     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12585     MOVE X'2020233030303131333136' TO DFHEIV0(25:11)
 12586     CALL 'kxdfhei1' USING DFHEIV0,
 12587           WS-PI-QID,
 12588           PROGRAM-INTERFACE-BLOCK,
 12589           PI-COMM-LENGTH,
 12590           DFHEIV99,
 12591           DFHEIV99,
 12592           DFHEIV99
 12593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12594
 12595
 12596 7795-EXIT.
 12597     EXIT.
 12598
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 258
* EL152.cbl
 12600 7800-PRINT-LETTER-NOW.
 12601***************************************************************
 12602*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 12603*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 12604*        THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS,       *
 12605*        THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE,    *
 12606*        THE LETTER IS SAVED IN TEMP-STORAGE,                 *
 12607*        AND A START IS ISSUED FOR THE PRINT TRANSACTION.     *
 12608***************************************************************
 12609
 12610     PERFORM 400-SET-CODES THRU 499-EXIT.
 12611
 12612     PERFORM 7500-READ-TS        THRU 7599-EXIT
 12613     PERFORM 7950-SET-INDX THRU 7950-EXIT.
 12614     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12615             VARYING SC-INDX FROM 1 BY 1
 12616             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12617
 12618     IF PI-TOTAL-LINES = 0
 12619        MOVE ER-0187             TO EMI-ERROR
 12620        MOVE -1                  TO MAINTL
 12621        MOVE AL-UABON            TO MAINTA
 12622        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12623        GO TO 8200-SEND-DATAONLY.
 12624
 12625     IF COPIESL NOT = ZEROS
 12626        IF COPIESI NOT NUMERIC
 12627           MOVE ER-0184          TO EMI-ERROR
 12628           MOVE -1               TO COPIESL
 12629           MOVE AL-UNBON         TO COPIESA
 12630           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12631           GO TO 8200-SEND-DATAONLY
 12632         ELSE
 12633           MOVE COPIESI          TO PI-NUM-PRINT-COPIES
 12634       ELSE
 12635        MOVE 1                   TO PI-NUM-PRINT-COPIES.
 12636
 12637*    PERFORM 7500-READ-TS        THRU 7599-EXIT
 12638*    PERFORM 7950-SET-INDX THRU 7950-EXIT.
 12639*    PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12640*            VARYING SC-INDX FROM 1 BY 1
 12641*            UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12642
 12643     MOVE +0                     TO TALLY.
 12644     INSPECT RECORD-TABLE TALLYING TALLY
 12645                                 FOR CHARACTERS BEFORE '@'.
 12646
 12647     IF TALLY < +21900
 12648        COMPUTE PI-CURRENT-LINE = TALLY / 73
 12649        MOVE ZEROS               TO ROLL-COUNTER
 12650        MOVE ER-0191             TO EMI-ERROR
 12651        MOVE -1                  TO MAINTL
 12652        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12653        GO TO 7900-ROLL-PAGE.
 12654
 12655 7800-UPDATE-CLAIM.
 12656
 12657     IF PI-RETURN-TO-PROGRAM = PGM-EL126
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 259
* EL152.cbl
 12658         GO TO 7800-GET-PRINTER.
 12659
 12660     MOVE PI-COMPANY-CD          TO  CLAM-CO.
 12661     MOVE PI-CARRIER             TO  CLAM-CARRIER.
 12662     MOVE PI-CLAIM-NO            TO  CLAM-CLAIM.
 12663     MOVE PI-CERT-NO             TO  CLAM-CERT-NUM.
 12664
 12665
 12666* EXEC CICS HANDLE CONDITION
 12667*        NOTOPEN   (8860-CLAM-NOT-OPEN)
 12668*        NOTFND    (7800-CLAIM-NOT-FOUND)
 12669*    END-EXEC.
 12670*    MOVE '"$JI                  ! J #00011391' TO DFHEIV0
 12671     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12673     MOVE X'4A20233030303131333931' TO DFHEIV0(25:11)
 12674     CALL 'kxdfhei1' USING DFHEIV0
 12675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12676
 12677
 12678
 12679* EXEC CICS READ
 12680*        DATASET   (CLAM-ID)
 12681*        RIDFLD    (CLAM-KEY)
 12682*        SET       (ADDRESS OF CLAIM-MASTER)
 12683*        UPDATE
 12684*    END-EXEC.
 12685*    MOVE '&"S        EU         (   #00011396' TO DFHEIV0
 12686     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12687     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12688     MOVE X'2020233030303131333936' TO DFHEIV0(25:11)
 12689     CALL 'kxdfhei1' USING DFHEIV0,
 12690           CLAM-ID,
 12691           DFHEIV20,
 12692           DFHEIV99,
 12693           CLAM-KEY,
 12694           DFHEIV99,
 12695           DFHEIV99,
 12696           DFHEIV99
 12697     SET ADDRESS OF CLAIM-MASTER TO
 12698         DFHEIV20
 12699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12700
 12701
 12702     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
 12703     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
 12704     MOVE CURRENT-SAVE           TO  CL-LAST-MAINT-DT.
 12705     MOVE '2'                    TO  CL-LAST-MAINT-TYPE.
 12706
 12707
 12708* EXEC CICS HANDLE CONDITION
 12709*        DUPKEY    (7800-GET-PRINTER)
 12710*    END-EXEC.
 12711*    MOVE '"$$                   ! K #00011408' TO DFHEIV0
 12712     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12713     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12714     MOVE X'4B20233030303131343038' TO DFHEIV0(25:11)
 12715     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 260
* EL152.cbl
 12716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12717
 12718
 12719
 12720* EXEC CICS REWRITE
 12721*        DATASET   (CLAM-ID)
 12722*        FROM      (CLAIM-MASTER)
 12723*    END-EXEC.
 12724     MOVE LENGTH OF
 12725      CLAIM-MASTER
 12726       TO DFHEIV11
 12727*    MOVE '&& L                  %   #00011412' TO DFHEIV0
 12728     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12729     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12730     MOVE X'2020233030303131343132' TO DFHEIV0(25:11)
 12731     CALL 'kxdfhei1' USING DFHEIV0,
 12732           CLAM-ID,
 12733           CLAIM-MASTER,
 12734           DFHEIV11,
 12735           DFHEIV99
 12736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12737
 12738
 12739     GO TO 7800-GET-PRINTER.
 12740
 12741 7800-CLAIM-NOT-FOUND.
 12742
 12743     MOVE ER-0133                TO  EMI-ERROR.
 12744     MOVE -1                     TO  MAINTL.
 12745     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12746     GO TO 8200-SEND-DATAONLY.
 12747
 12748 7800-GET-PRINTER.
 12749
 12750     IF PI-ALT-PRINTER-ID NOT = SPACES
 12751        GO TO 7800-CNTL-BYPASS.
 12752
 12753     MOVE '1'                    TO CNTL-RECORD-TYPE.
 12754     MOVE SPACES                 TO CNTL-GENL.
 12755     MOVE ZEROS                  TO CNTL-SEQ.
 12756
 12757
 12758* EXEC CICS HANDLE CONDITION
 12759*         NOTOPEN    (8840-CNTL-NOT-OPEN)
 12760*         NOTFND     (7890-NOT-FOUND)
 12761*    END-EXEC.
 12762*    MOVE '"$JI                  ! L #00011435' TO DFHEIV0
 12763     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12764     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12765     MOVE X'4C20233030303131343335' TO DFHEIV0(25:11)
 12766     CALL 'kxdfhei1' USING DFHEIV0
 12767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12768
 12769
 12770
 12771* EXEC CICS READ
 12772*         DATASET    (CNTL-ID)
 12773*         SET        (ADDRESS OF CONTROL-FILE)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 261
* EL152.cbl
 12774*         RIDFLD     (CNTL-KEY)
 12775*    END-EXEC.
 12776*    MOVE '&"S        E          (   #00011440' TO DFHEIV0
 12777     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12778     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12779     MOVE X'2020233030303131343430' TO DFHEIV0(25:11)
 12780     CALL 'kxdfhei1' USING DFHEIV0,
 12781           CNTL-ID,
 12782           DFHEIV20,
 12783           DFHEIV99,
 12784           CNTL-KEY,
 12785           DFHEIV99,
 12786           DFHEIV99,
 12787           DFHEIV99
 12788     SET ADDRESS OF CONTROL-FILE TO
 12789         DFHEIV20
 12790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12791
 12792
 12793*    MOVE CF-FORMS-PRINTER-ID       TO TS-TERM-TEXT.
 12794     MOVE CF-FORMS-PRINTER-ID    TO WS-PRINTER-ID
 12795     GO TO 7800-SET-UP-TS.
 12796
 12797 7800-CNTL-BYPASS.
 12798*    MOVE PI-ALT-PRINTER-ID         TO TS-TERM-TEXT.
 12799     MOVE PI-ALT-PRINTER-ID      TO WS-PRINTER-ID.
 12800
 12801 7800-SET-UP-TS.
 12802
 12803***********************************************************
 12804*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 12805*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 12806***********************************************************
 12807
 12808     IF TS-TERM-PREFIX = 'DU'
 12809        PERFORM 7760-DELETE-TEMP-STOR-SCREEN THRU 7760-EXIT
 12810        PERFORM 7790-WRITE-SCREEN-TS THRU 7790-EXIT.
 12811
 12812     SET TS-INDX TO 1.
 12813
 12814
 12815* EXEC CICS ASKTIME
 12816*    END-EXEC.
 12817*    MOVE '0"                    "   #00011467' TO DFHEIV0
 12818     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
 12819     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 12820     MOVE X'2020233030303131343637' TO DFHEIV0(25:11)
 12821     CALL 'kxdfhei1' USING DFHEIV0,
 12822           DFHEIV99
 12823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12824
 12825
 12826     MOVE EIBTIME                TO TS-ID-TIME.
 12827*    MOVE '152A'                 TO TS-ID-TEXT
 12828     MOVE TS-NAME-TEXT           TO PI-TEMP-STOR-ID.
 12829     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 12830
 12831     PERFORM 7780-WRITE-TS THRU 7780-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 262
* EL152.cbl
 12832             VARYING TS-GROUP-WORK FROM 0 BY TS-NUM-REC-IN-GROUP
 12833             UNTIL TS-GROUP-WORK NOT < PI-TOTAL-LINES
 12834
 12835     IF NOT PI-SHOW-MODE
 12836        MOVE '1'                 TO PI-PRINT-SW.
 12837
 12838
 12839* EXEC CICS HANDLE CONDITION
 12840*         TERMIDERR  (8820-TERM-ERROR)
 12841*         TRANSIDERR (8830-TRAN-ERROR)
 12842*    END-EXEC.
 12843*    MOVE '"$[\                  ! M #00011482' TO DFHEIV0
 12844     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 12845     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12846     MOVE X'4D20233030303131343832' TO DFHEIV0(25:11)
 12847     CALL 'kxdfhei1' USING DFHEIV0
 12848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12849
 12850
 12851*    IF PI-COMPANY-ID = 'DMD' OR 'XXX'
 12852*        MOVE EIBTRMID    TO TS-TERM-TEXT
 12853*        EXEC CICS START
 12854*             INTERVAL    (0)
 12855*             TRANSID     (PRINT-TRANS)
 12856*             FROM        (PROGRAM-INTERFACE-BLOCK)
 12857*             LENGTH      (PI-COMM-LENGTH)
 12858*             TERMID      (TS-TERM-TEXT)
 12859*        END-EXEC
 12860*    ELSE
 12861
 12862* EXEC CICS START
 12863*             INTERVAL    (0)
 12864*             TRANSID     (PRINT-TRANS)
 12865*             FROM        (PROGRAM-INTERFACE-BLOCK)
 12866*             LENGTH      (PI-COMM-LENGTH)
 12867*             TERMID      (TS-TERM-TEXT)
 12868*             TERMID      (WS-PRINTER-ID)
 12869*        END-EXEC.
 12870     MOVE 0 TO DFHEIV10
 12871*    MOVE '0(ILFT                1   #00011497' TO DFHEIV0
 12872     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 12873     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
 12874     MOVE X'2020233030303131343937' TO DFHEIV0(25:11)
 12875     CALL 'kxdfhei1' USING DFHEIV0,
 12876           DFHEIV10,
 12877           PRINT-TRANS,
 12878           DFHEIV99,
 12879           PROGRAM-INTERFACE-BLOCK,
 12880           PI-COMM-LENGTH,
 12881           WS-PRINTER-ID,
 12882           DFHEIV99,
 12883           DFHEIV99,
 12884           DFHEIV99,
 12885           DFHEIV99,
 12886           DFHEIV99,
 12887           DFHEIV99,
 12888           DFHEIV99,
 12889           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 263
* EL152.cbl
 12890           DFHEIV99,
 12891           DFHEIV99
 12892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12893
 12894
 12895     MOVE '104A'                 TO TS-ID-TEXT
 12896     MOVE ER-0189                TO EMI-ERROR.
 12897     MOVE -1                     TO MAINTL.
 12898     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 12899     MOVE ' PRINT TRANS STARTED ' TO EMI-MESSAGE-AREA (1)
 12900     MOVE PI-TEMP-STOR-ID TO EMI-MESSAGE-AREA (1) (25:10)
 12901
 12902     GO TO 8200-SEND-DATAONLY.
 12903
 12904 7890-NOT-FOUND.
 12905     MOVE ER-0190                TO EMI-ERROR.
 12906     MOVE -1                     TO MAINTL.
 12907     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12908     GO TO 8200-SEND-DATAONLY.
 12909
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 264
* EL152.cbl
 12911 7900-ROLL-PAGE.
 12912     IF ENTERPFL NOT = ZEROS
 12913        MOVE -1                  TO ENTERPFL
 12914       ELSE
 12915        MOVE -1                  TO MAINTL.
 12916
 12917     PERFORM 7500-READ-TS     THRU 7599-EXIT
 12918     PERFORM 7950-SET-INDX    THRU 7950-EXIT
 12919     PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12920        VARYING SC-INDX FROM 1 BY 1 UNTIL
 12921        SC-INDX > NUM-LINES-PER-SCREEN
 12922     IF PI-TOTAL-LINES = 0
 12923        MOVE ER-0047             TO EMI-ERROR
 12924        MOVE -1                  TO MAINTL
 12925        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12926        GO TO 8200-SEND-DATAONLY.
 12927
 12928     COMPUTE TEMP-CURR-LINE = PI-CURRENT-LINE + ROLL-COUNTER.
 12929
 12930     IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
 12931        MOVE ER-0067             TO EMI-ERROR
 12932        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12933        MOVE 1                   TO TEMP-CURR-LINE.
 12934
 12935     IF TEMP-CURR-LINE > PI-TOTAL-LINES
 12936        MOVE ER-0066             TO EMI-ERROR
 12937        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12938        COMPUTE TEMP-CURR-LINE
 12939            = PI-TOTAL-LINES + 1 - NUM-LINES-PER-SCREEN
 12940        IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
 12941            MOVE 1 TO TEMP-CURR-LINE.
 12942
 12943*    IF EMI-ERROR NOT = ER-0191
 12944*       PERFORM 7500-READ-TS     THRU 7599-EXIT
 12945*       PERFORM 7950-SET-INDX    THRU 7950-EXIT
 12946*       PERFORM 7960-UPDATE-TABLE-FROM-SCREEN THRU 7960-EXIT
 12947*                VARYING SC-INDX FROM 1 BY 1 UNTIL
 12948*                SC-INDX > NUM-LINES-PER-SCREEN
 12949*    END-IF
 12950
 12951     IF EMI-ERROR = ER-0066 OR ER-0067 OR ER-0000 OR ER-0191
 12952        NEXT SENTENCE
 12953     ELSE
 12954        GO TO 8200-SEND-DATAONLY.
 12955
 12956*    PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 12957     MOVE TEMP-CURR-LINE         TO PI-CURRENT-LINE.
 12958     SET TB-INDX                 TO PI-CURRENT-LINE.
 12959     MOVE LOW-VALUES             TO EL152RI.
 12960
 12961*    PERFORM 7500-READ-TS        THRU 7599-EXIT
 12962     PERFORM 7170-FORMAT-SCREEN THRU 7170-EXIT
 12963             VARYING SC-INDX FROM 1 BY 1
 12964             UNTIL SC-INDX > NUM-LINES-PER-SCREEN.
 12965
 12966     GO TO 8200-SEND-DATAONLY.
 12967
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 265
* EL152.cbl
 12969 7950-SET-INDX.
 12970     IF PI-CURRENT-LINE = 0
 12971        SET TB-INDX TO 1
 12972       ELSE
 12973        SET TB-INDX              TO PI-CURRENT-LINE.
 12974
 12975 7950-EXIT.
 12976      EXIT.
 12977
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 266
* EL152.cbl
 12979 7960-UPDATE-TABLE-FROM-SCREEN.
 12980     IF SC-TEXTL (SC-INDX) NOT = ZEROS
 12981        IF TB-INDX > PI-TOTAL-LINES
 12982           IF PI-TOTAL-LINES = MAX-LINES
 12983              MOVE ER-0051       TO EMI-ERROR
 12984              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12985              GO TO 8200-SEND-DATAONLY
 12986           ELSE
 12987              MOVE SC-TEXT (SC-INDX) TO REC-TEXT (TB-INDX)
 12988              ADD 1              TO PI-TOTAL-LINES
 12989        ELSE
 12990           MOVE SC-TEXT (SC-INDX) TO REC-TEXT (TB-INDX).
 12991
 12992     SET TB-INDX UP BY 1.
 12993
 12994 7960-EXIT.
 12995      EXIT.
 12996
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 267
* EL152.cbl
 12998 8000-STARTBR-ERACCT.
 12999
 13000     IF WS-ACCT-READ-SW = 'Y'
 13001         NEXT SENTENCE
 13002     ELSE
 13003
 13004* EXEC CICS GETMAIN
 13005*             SET       (ADDRESS OF ACCOUNT-MASTER)
 13006*             LENGTH    (ACCT-LENGTH)
 13007*        END-EXEC.
 13008*    MOVE '," L                  $   #00011614' TO DFHEIV0
 13009     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 13010     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13011     MOVE X'2020233030303131363134' TO DFHEIV0(25:11)
 13012     CALL 'kxdfhei1' USING DFHEIV0,
 13013           DFHEIV20,
 13014           ACCT-LENGTH,
 13015           DFHEIV99
 13016     SET ADDRESS OF ACCOUNT-MASTER TO
 13017         DFHEIV20
 13018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13019
 13020
 13021
 13022* EXEC CICS STARTBR
 13023*        RIDFLD      (ACCT-KEY)
 13024*        DATASET     (ACCT-ID)
 13025*        KEYLENGTH   (20)
 13026*        GENERIC
 13027*    END-EXEC.
 13028     MOVE 20
 13029       TO DFHEIV11
 13030     MOVE 0
 13031       TO DFHEIV12
 13032*    MOVE '&,   KG    G          &   #00011619' TO DFHEIV0
 13033     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 13034     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13035     MOVE X'2020233030303131363139' TO DFHEIV0(25:11)
 13036     CALL 'kxdfhei1' USING DFHEIV0,
 13037           ACCT-ID,
 13038           ACCT-KEY,
 13039           DFHEIV11,
 13040           DFHEIV12,
 13041           DFHEIV99
 13042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13043
 13044
 13045     MOVE 'Y'         TO ACCT-BROWSE-STARTED.
 13046 8000-STARTBR-EXIT.
 13047     EXIT.
 13048
 13049 8000-READNEXT-ERACCT.
 13050
 13051
 13052* EXEC CICS READNEXT
 13053*        DATASET   (ACCT-ID)
 13054*        INTO      (ACCOUNT-MASTER)
 13055*        RIDFLD    (ACCT-KEY)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 268
* EL152.cbl
 13056*    END-EXEC.
 13057     MOVE LENGTH OF
 13058      ACCOUNT-MASTER
 13059       TO DFHEIV12
 13060     MOVE 0
 13061       TO DFHEIV11
 13062*    MOVE '&.IL                  )   #00011632' TO DFHEIV0
 13063     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13064     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13065     MOVE X'2020233030303131363332' TO DFHEIV0(25:11)
 13066     CALL 'kxdfhei1' USING DFHEIV0,
 13067           ACCT-ID,
 13068           ACCOUNT-MASTER,
 13069           DFHEIV12,
 13070           ACCT-KEY,
 13071           DFHEIV99,
 13072           DFHEIV11,
 13073           DFHEIV99,
 13074           DFHEIV99
 13075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13076
 13077
 13078 8000-READNEXT-EXIT.
 13079     EXIT.
 13080
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 269
* EL152.cbl
 13082*8050-STARTBR-EMPROD. Remove as dead code
 13083*8050-EXIT. Remove as dead code
 13084*8060-READNEXT-EMPROD. Remove as dead code
 13085*8060-EXIT. Remove as dead code
 13086
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 270
* EL152.cbl
 13088 8100-SEND-INITIAL-MAP.
 13089     PERFORM 7700-PUT-TEMP-STOR  THRU 7749-EXIT
 13090     MOVE SAVE-DATE              TO DATEAO.
 13091     MOVE EIBTIME                TO TIME-IN.
 13092     MOVE TIME-OUT               TO TIMEAO.
 13093
 13094     MOVE PI-CARRIER             TO CARRO
 13095     MOVE PI-CLAIM-NO            TO CLMNOO
 13096     MOVE PI-CERT-NO             TO CRTNOO
 13097     MOVE PI-PROCESSOR-ID        TO PROCO
 13098     MOVE PI-COMPANY-ID          TO COMPIDO
 13099     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 13100                                 TO SYSO
 13101     MOVE PI-ENCLOSURE-CD        TO ENCO
 13102     IF NOT EMI-NO-ERRORS
 13103         SET EMI-INDX TO 1
 13104         MOVE EMI-MESSAGE-AREA (EMI-INDX) TO ERRMSGO
 13105     ELSE
 13106         MOVE SPACES             TO ERRMSGO.
 13107
 13108     MOVE -1                     TO MAINTL.
 13109
 13110
 13111* EXEC CICS SEND
 13112*        MAP      (MAP-NAME)
 13113*        MAPSET   (MAPSET-NAME)
 13114*        FROM     (EL152AO)
 13115*        ERASE
 13116*        CURSOR
 13117*    END-EXEC.
 13118     MOVE LENGTH OF
 13119      EL152AO
 13120       TO DFHEIV12
 13121     MOVE -1
 13122       TO DFHEIV11
 13123*    MOVE '8$     CT  E    H L F ,   #00011670' TO DFHEIV0
 13124     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 13125     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13126     MOVE X'2020233030303131363730' TO DFHEIV0(25:11)
 13127     CALL 'kxdfhei1' USING DFHEIV0,
 13128           MAP-NAME,
 13129           EL152AO,
 13130           DFHEIV12,
 13131           MAPSET-NAME,
 13132           DFHEIV99,
 13133           DFHEIV99,
 13134           DFHEIV99,
 13135           DFHEIV11,
 13136           DFHEIV99,
 13137           DFHEIV99,
 13138           DFHEIV99
 13139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13140
 13141
 13142     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 13143     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 13144
 13145     GO TO 9000-RETURN-TRANS.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 271
* EL152.cbl
 13146*    GO TO 0200-RECEIVE.
 13147
 13148 8200-SEND-DATAONLY.
 13149     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 13150     MOVE PI-ENCLOSURE-CD        TO ENCO
 13151     MOVE SAVE-DATE              TO DATEAO.
 13152     MOVE EIBTIME                TO TIME-IN.
 13153     MOVE TIME-OUT               TO TIMEAO.
 13154     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
 13155
 13156*    IF PI-COMPANY-ID = 'DMD'
 13157*       IF FORCE-7840
 13158*          MOVE '7840 FORCED' TO PFKEY9O
 13159*          MOVE AL-SABON      TO PFKEY9A.
 13160
 13161
 13162* EXEC CICS SEND
 13163*        MAP      (MAP-NAME)
 13164*        MAPSET   (MAPSET-NAME)
 13165*        FROM     (EL152AO)
 13166*        DATAONLY
 13167*        CURSOR
 13168*    END-EXEC.
 13169     MOVE LENGTH OF
 13170      EL152AO
 13171       TO DFHEIV12
 13172     MOVE -1
 13173       TO DFHEIV11
 13174*    MOVE '8$D    CT       H L F ,   #00011697' TO DFHEIV0
 13175     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 13176     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13177     MOVE X'2020233030303131363937' TO DFHEIV0(25:11)
 13178     CALL 'kxdfhei1' USING DFHEIV0,
 13179           MAP-NAME,
 13180           EL152AO,
 13181           DFHEIV12,
 13182           MAPSET-NAME,
 13183           DFHEIV99,
 13184           DFHEIV99,
 13185           DFHEIV99,
 13186           DFHEIV11,
 13187           DFHEIV99,
 13188           DFHEIV99,
 13189           DFHEIV99
 13190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13191
 13192
 13193     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 13194     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 13195
 13196     GO TO 9000-RETURN-TRANS.
 13197*    GO TO 0200-RECEIVE.
 13198
 13199 8200-SEND-DATAONLY-ERASEAUP.
 13200     PERFORM 7700-PUT-TEMP-STOR   THRU 7749-EXIT
 13201     MOVE PI-ENCLOSURE-CD        TO ENCO
 13202     MOVE SAVE-DATE              TO DATEAO.
 13203     MOVE EIBTIME                TO TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 272
* EL152.cbl
 13204     MOVE TIME-OUT               TO TIMEAO.
 13205     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
 13206
 13207* EXEC CICS SEND
 13208*        MAP      (MAP-NAME)
 13209*        MAPSET   (MAPSET-NAME)
 13210*        FROM     (EL152AO)
 13211*        DATAONLY
 13212*        ERASEAUP
 13213*        CURSOR
 13214*    END-EXEC.
 13215     MOVE LENGTH OF
 13216      EL152AO
 13217       TO DFHEIV12
 13218     MOVE -1
 13219       TO DFHEIV11
 13220*    MOVE '8$D    CT  A    H L F ,   #00011718' TO DFHEIV0
 13221     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 13222     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13223     MOVE X'2020233030303131373138' TO DFHEIV0(25:11)
 13224     CALL 'kxdfhei1' USING DFHEIV0,
 13225           MAP-NAME,
 13226           EL152AO,
 13227           DFHEIV12,
 13228           MAPSET-NAME,
 13229           DFHEIV99,
 13230           DFHEIV99,
 13231           DFHEIV99,
 13232           DFHEIV11,
 13233           DFHEIV99,
 13234           DFHEIV99,
 13235           DFHEIV99
 13236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13237
 13238
 13239     PERFORM 8210-ENDBR  THRU 8210-EXIT.
 13240     PERFORM 8220-ENDBR-EMPROD THRU 8220-EXIT.
 13241
 13242     GO TO 9000-RETURN-TRANS.
 13243*    GO TO 0200-RECEIVE.
 13244
 13245 8210-ENDBR.
 13246     IF ACCT-BROWSE-STARTED = 'Y'
 13247        MOVE 'N'                  TO ACCT-BROWSE-STARTED
 13248
 13249* EXEC CICS ENDBR
 13250*            DATASET    (ACCT-ID)
 13251*       END-EXEC.
 13252     MOVE 0
 13253       TO DFHEIV11
 13254*    MOVE '&2                    $   #00011736' TO DFHEIV0
 13255     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13256     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13257     MOVE X'2020233030303131373336' TO DFHEIV0(25:11)
 13258     CALL 'kxdfhei1' USING DFHEIV0,
 13259           ACCT-ID,
 13260           DFHEIV11,
 13261           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 273
* EL152.cbl
 13262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13263
 13264
 13265 8210-EXIT.
 13266     EXIT.
 13267
 13268 8220-ENDBR-EMPROD.
 13269     IF PROD-BROWSE-STARTED = 'Y'
 13270        MOVE 'N'                  TO PROD-BROWSE-STARTED
 13271
 13272* EXEC CICS ENDBR
 13273*            DATASET    (PROD-ID)
 13274*       END-EXEC.
 13275     MOVE 0
 13276       TO DFHEIV11
 13277*    MOVE '&2                    $   #00011746' TO DFHEIV0
 13278     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13279     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13280     MOVE X'2020233030303131373436' TO DFHEIV0(25:11)
 13281     CALL 'kxdfhei1' USING DFHEIV0,
 13282           PROD-ID,
 13283           DFHEIV11,
 13284           DFHEIV99
 13285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13286
 13287
 13288 8220-EXIT.
 13289     EXIT.
 13290
 13291 8300-SEND-TEXT.
 13292
 13293* EXEC CICS SEND TEXT
 13294*        FROM    (LOGOFF-TEXT)
 13295*        LENGTH  (LOGOFF-LENGTH)
 13296*        ERASE
 13297*        FREEKB
 13298*    END-EXEC.
 13299*    MOVE '8&      T  E F  H   F -   #00011754' TO DFHEIV0
 13300     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 13301     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 13302     MOVE X'2020233030303131373534' TO DFHEIV0(25:11)
 13303     CALL 'kxdfhei1' USING DFHEIV0,
 13304           LOGOFF-TEXT,
 13305           LOGOFF-LENGTH,
 13306           DFHEIV99,
 13307           DFHEIV99,
 13308           DFHEIV99,
 13309           DFHEIV99,
 13310           DFHEIV99,
 13311           DFHEIV99,
 13312           DFHEIV99,
 13313           DFHEIV99,
 13314           DFHEIV99,
 13315           DFHEIV99
 13316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13317
 13318
 13319
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 274
* EL152.cbl
 13320* EXEC CICS RETURN
 13321*    END-EXEC.
 13322*    MOVE '.(                    ''   #00011761' TO DFHEIV0
 13323     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 13324     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13325     MOVE X'2020233030303131373631' TO DFHEIV0(25:11)
 13326     CALL 'kxdfhei1' USING DFHEIV0,
 13327           DFHEIV99,
 13328           DFHEIV99,
 13329           DFHEIV99,
 13330           DFHEIV99,
 13331           DFHEIV99,
 13332           DFHEIV99
 13333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13334
 13335
 13336 8600-DEEDIT.
 13337
 13338* EXEC CICS BIF DEEDIT
 13339*         FIELD    (DEEDIT-FIELD)
 13340*         LENGTH   (15)
 13341*    END-EXEC.
 13342     MOVE 15
 13343       TO DFHEIV11
 13344*    MOVE '@"L                   #   #00011765' TO DFHEIV0
 13345     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13346     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13347     MOVE X'2020233030303131373635' TO DFHEIV0(25:11)
 13348     CALL 'kxdfhei1' USING DFHEIV0,
 13349           DEEDIT-FIELD,
 13350           DFHEIV11
 13351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13352
 13353
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 275
* EL152.cbl
 13355 8800-UNAUTHORIZED-ACCESS.
 13356     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 13357     GO TO 8300-SEND-TEXT.
 13358
 13359 8810-PF23.
 13360     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 13361     MOVE ZEROS                  TO PI-TOTAL-LINES.
 13362     MOVE ZEROS                  TO PI-CURRENT-LINE.
 13363     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 13364     MOVE XCTL-005               TO PGM-NAME.
 13365     GO TO 9300-XCTL.
 13366
 13367 8820-TERM-ERROR.
 13368     MOVE ER-0412                TO EMI-ERROR.
 13369     MOVE SPACES                 TO PI-PRINT-SW.
 13370     GO TO 8999-OPEN-ERROR.
 13371
 13372 8830-TRAN-ERROR.
 13373     MOVE ER-0413                TO EMI-ERROR.
 13374     MOVE SPACES                 TO PI-PRINT-SW.
 13375     GO TO 8999-OPEN-ERROR.
 13376
 13377 8840-CNTL-NOT-OPEN.
 13378     MOVE ER-0042                TO EMI-ERROR.
 13379     GO TO 8999-OPEN-ERROR.
 13380
 13381 8850-ARCH-NOT-OPEN.
 13382     MOVE ER-0332                TO EMI-ERROR.
 13383     GO TO 8999-OPEN-ERROR.
 13384
 13385 8860-CLAM-NOT-OPEN.
 13386     MOVE ER-0154                TO EMI-ERROR.
 13387     GO TO 8999-OPEN-ERROR.
 13388
 13389 8870-ACTV-NOT-OPEN.
 13390     MOVE ER-0172                TO EMI-ERROR.
 13391     GO TO 8999-OPEN-ERROR.
 13392
 13393 8880-ACCT-NOT-OPEN.
 13394     MOVE ER-0168                TO EMI-ERROR.
 13395     GO TO 8999-OPEN-ERROR.
 13396
 13397 8890-TEXT-NOT-OPEN.
 13398     MOVE ER-0013                TO EMI-ERROR.
 13399     GO TO 8999-OPEN-ERROR.
 13400
 13401 8900-CERT-NOT-OPEN.
 13402     MOVE ER-0169                TO EMI-ERROR.
 13403     GO TO 8999-OPEN-ERROR.
 13404
 13405 8910-CERT-NOT-FOUND.
 13406     MOVE ER-0206                TO EMI-ERROR.
 13407     GO TO 8999-OPEN-ERROR.
 13408
 13409 8915-PROD-NOT-OPEN.
 13410     MOVE ER-9106                TO EMI-ERROR.
 13411     GO TO 8999-OPEN-ERROR.
 13412
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 276
* EL152.cbl
 13413 8920-PLCY-NOT-OPEN.
 13414     MOVE ER-9883                TO EMI-ERROR.
 13415     GO TO 8999-OPEN-ERROR.
 13416
 13417 8925-PLAN-NOT-OPEN.
 13418     MOVE ER-9808                TO EMI-ERROR.
 13419     GO TO 8999-OPEN-ERROR.
 13420
 13421 8930-PLCY-NOT-FOUND.
 13422     MOVE ER-9483                TO EMI-ERROR.
 13423     GO TO 8999-OPEN-ERROR.
 13424
 13425 8999-OPEN-ERROR.
 13426     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13427     MOVE -1                     TO MAINTL.
 13428     GO TO 8200-SEND-DATAONLY.
 13429
 13430 9000-RETURN-TRANS.
 13431
 13432     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 13433
 13434* EXEC CICS RETURN
 13435*        TRANSID    (TRANS-ID)
 13436*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 13437*        LENGTH     (PI-COMM-LENGTH)
 13438*    END-EXEC.
 13439*    MOVE '.(CT                  ''   #00011849' TO DFHEIV0
 13440     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 13441     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13442     MOVE X'2020233030303131383439' TO DFHEIV0(25:11)
 13443     CALL 'kxdfhei1' USING DFHEIV0,
 13444           TRANS-ID,
 13445           PROGRAM-INTERFACE-BLOCK,
 13446           PI-COMM-LENGTH,
 13447           DFHEIV99,
 13448           DFHEIV99,
 13449           DFHEIV99
 13450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13451
 13452
 13453
 13454 9000-EXIT.
 13455     EXIT.
 13456 9200-RETURN-MAIN-MENU.
 13457     PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT.
 13458
 13459     MOVE ZEROS                  TO PI-TOTAL-LINES
 13460                                    PI-CURRENT-LINE.
 13461     MOVE XCTL-126               TO PGM-NAME.
 13462
 13463     GO TO 9300-XCTL.
 13464
 13465 9300-XCTL.
 13466
 13467* EXEC CICS XCTL
 13468*        PROGRAM    (PGM-NAME)
 13469*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 13470*        LENGTH     (PI-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 277
* EL152.cbl
 13471*    END-EXEC.
 13472*    MOVE '.$C                   %   #00011868' TO DFHEIV0
 13473     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 13474     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13475     MOVE X'2020233030303131383638' TO DFHEIV0(25:11)
 13476     CALL 'kxdfhei1' USING DFHEIV0,
 13477           PGM-NAME,
 13478           PROGRAM-INTERFACE-BLOCK,
 13479           PI-COMM-LENGTH,
 13480           DFHEIV99
 13481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13482
 13483
 13484 9400-CLEAR.
 13485     IF PI-CLEAR-MODE
 13486         MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME
 13487         GO TO 9300-XCTL
 13488     ELSE
 13489         PERFORM 7750-DELETE-TEMP-STOR         THRU 7750-EXIT
 13490         PERFORM 7760-DELETE-TEMP-STOR-SCREEN  THRU 7760-EXIT
 13491         PERFORM 7770-DELETE-TEMP-STOR-PI-AREA THRU 7770-EXIT
 13492         MOVE SPACES             TO PI-WA
 13493                                    RECORD-TABLE
 13494                                    TS-WORK-AREA
 13495         MOVE ZEROS              TO PI-TOTAL-LINES
 13496                                    PI-CURRENT-LINE
 13497                                    PI-TEMP-STOR-ITEMS
 13498                                    PI-UPDATE-SW
 13499                                    PI-ADDR-SEQ
 13500         MOVE '2'                TO PI-ACTION
 13501         MOVE LOW-VALUES         TO EL152AO
 13502                                    PI-ADDR-TYPE
 13503         SET TS-INDX
 13504             TA1
 13505             TA2
 13506             TA21
 13507             TB-INDX
 13508             TB-INDX1
 13509             MOVE-INDX
 13510             SC-INDX             TO +1
 13511         IF GETMAIN-SWITCH = '2'
 13512             MOVE 1              TO GETMAIN-SWITCH
 13513             GO TO 8100-SEND-INITIAL-MAP
 13514         ELSE
 13515             GO TO 8100-SEND-INITIAL-MAP.
 13516
 13517 9600-PGMID-ERROR.
 13518
 13519* EXEC CICS HANDLE CONDITION
 13520*        PGMIDERR    (8300-SEND-TEXT)
 13521*    END-EXEC.
 13522*    MOVE '"$L                   ! N #00011908' TO DFHEIV0
 13523     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 13524     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13525     MOVE X'4E20233030303131393038' TO DFHEIV0(25:11)
 13526     CALL 'kxdfhei1' USING DFHEIV0
 13527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13528
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 278
* EL152.cbl
 13529
 13530     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 13531     MOVE ' '                    TO PI-ENTRY-CD-1.
 13532     MOVE XCTL-005               TO PGM-NAME.
 13533     MOVE PGM-NAME               TO LOGOFF-PGM.
 13534     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 13535     GO TO 9300-XCTL.
 13536
 13537 9700-DATE-LINK.
 13538     MOVE LINK-ELDATCV           TO PGM-NAME.
 13539
 13540* EXEC CICS LINK
 13541*        PROGRAM   (PGM-NAME)
 13542*        COMMAREA  (DATE-CONVERSION-DATA)
 13543*        LENGTH    (DC-COMM-LENGTH)
 13544*    END-EXEC.
 13545*    MOVE '."C                   (   #00011921' TO DFHEIV0
 13546     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13547     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13548     MOVE X'2020233030303131393231' TO DFHEIV0(25:11)
 13549     CALL 'kxdfhei1' USING DFHEIV0,
 13550           PGM-NAME,
 13551           DATE-CONVERSION-DATA,
 13552           DC-COMM-LENGTH,
 13553           DFHEIV99,
 13554           DFHEIV99,
 13555           DFHEIV99,
 13556           DFHEIV99
 13557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13558
 13559
 13560*    IF NO-CONVERSION-ERROR
 13561*            AND
 13562*       W-REVERSE-DATE
 13563*            AND
 13564*       PI-COMPANY-ID = 'AUK'
 13565*           MOVE DC-GREG-DATE-1-EDIT TO W-EDIT-DATE-1
 13566*           MOVE W-ED1-MM            TO W-ED2-MM
 13567*           MOVE W-ED1-DD            TO W-ED2-DD
 13568*           MOVE W-ED1-YY            TO W-ED2-YY
 13569*           MOVE W-EDIT-DATE-2       TO DC-GREG-DATE-1-EDIT.
 13570
 13571 9700-EXIT.
 13572      EXIT.
 13573
 13574 9900-ERROR-FORMAT.
 13575     IF NOT EMI-ERRORS-COMPLETE
 13576         MOVE LINK-001           TO PGM-NAME
 13577
 13578* EXEC CICS LINK
 13579*            PROGRAM   (PGM-NAME)
 13580*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 13581*            LENGTH    (EMI-COMM-LENGTH)
 13582*        END-EXEC.
 13583*    MOVE '."C                   (   #00011944' TO DFHEIV0
 13584     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13585     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13586     MOVE X'2020233030303131393434' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 279
* EL152.cbl
 13587     CALL 'kxdfhei1' USING DFHEIV0,
 13588           PGM-NAME,
 13589           ERROR-MESSAGE-INTERFACE-BLOCK,
 13590           EMI-COMM-LENGTH,
 13591           DFHEIV99,
 13592           DFHEIV99,
 13593           DFHEIV99,
 13594           DFHEIV99
 13595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13596
 13597
 13598 9900-EXIT.
 13599     EXIT.
 13600
 13601 9990-ABEND.
 13602     MOVE LINK-004               TO PGM-NAME.
 13603     MOVE DFHEIBLK               TO EMI-LINE1.
 13604
 13605* EXEC CICS LINK
 13606*        PROGRAM   (PGM-NAME)
 13607*        COMMAREA  (EMI-LINE1)
 13608*        LENGTH    (72)
 13609*    END-EXEC.
 13610     MOVE 72
 13611       TO DFHEIV11
 13612*    MOVE '."C                   (   #00011956' TO DFHEIV0
 13613     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13614     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13615     MOVE X'2020233030303131393536' TO DFHEIV0(25:11)
 13616     CALL 'kxdfhei1' USING DFHEIV0,
 13617           PGM-NAME,
 13618           EMI-LINE1,
 13619           DFHEIV11,
 13620           DFHEIV99,
 13621           DFHEIV99,
 13622           DFHEIV99,
 13623           DFHEIV99
 13624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13625
 13626
 13627     GO TO 8200-SEND-DATAONLY.
 13628
 13629 9995-SECURITY-VIOLATION.
 13630*                            COPY ELCSCTP.
 13631******************************************************************
 13632*                                                                *
 13633*                            ELCSCTP                             *
 13634*                            VMOD=2.001                          *
 13635*                                                                *
 13636*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 13637******************************************************************
 13638
 13639
 13640     MOVE EIBDATE          TO SM-JUL-DATE.
 13641     MOVE EIBTRMID         TO SM-TERMID.
 13642     MOVE THIS-PGM         TO SM-PGM.
 13643     MOVE EIBTIME          TO TIME-IN.
 13644     MOVE TIME-OUT         TO SM-TIME.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 280
* EL152.cbl
 13645     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 13646
 13647
 13648* EXEC CICS LINK
 13649*         PROGRAM  ('EL003')
 13650*         COMMAREA (SECURITY-MESSAGE)
 13651*         LENGTH   (80)
 13652*    END-EXEC.
 13653     MOVE 'EL003' TO DFHEIV1
 13654     MOVE 80
 13655       TO DFHEIV11
 13656*    MOVE '."C                   (   #00011982' TO DFHEIV0
 13657     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13658     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13659     MOVE X'2020233030303131393832' TO DFHEIV0(25:11)
 13660     CALL 'kxdfhei1' USING DFHEIV0,
 13661           DFHEIV1,
 13662           SECURITY-MESSAGE,
 13663           DFHEIV11,
 13664           DFHEIV99,
 13665           DFHEIV99,
 13666           DFHEIV99,
 13667           DFHEIV99
 13668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13669
 13670
 13671******************************************************************
 13672
 13673
 13674
 13675 9999-DFHBACK SECTION.
 13676     MOVE '9%                    "   ' TO DFHEIV0
 13677     MOVE 'EL152' TO DFHEIV1
 13678     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13679     GOBACK.
 13680 9999-DFHEXIT.
 13681     IF DFHEIGDJ EQUAL 0001
 13682         NEXT SENTENCE
 13683     ELSE IF DFHEIGDJ EQUAL 2
 13684         GO TO 9600-PGMID-ERROR,
 13685               0325-MAPFAIL,
 13686               9990-ABEND
 13687         DEPENDING ON DFHEIGDI
 13688     ELSE IF DFHEIGDJ EQUAL 3
 13689         GO TO 9400-CLEAR,
 13690               0100-PA,
 13691               0100-PA,
 13692               0100-PA
 13693         DEPENDING ON DFHEIGDI
 13694     ELSE IF DFHEIGDJ EQUAL 4
 13695         GO TO 0325-MAPFAIL
 13696         DEPENDING ON DFHEIGDI
 13697     ELSE IF DFHEIGDJ EQUAL 5
 13698         GO TO 590-QIDERR
 13699         DEPENDING ON DFHEIGDI
 13700     ELSE IF DFHEIGDJ EQUAL 6
 13701         GO TO 8850-ARCH-NOT-OPEN,
 13702               1020-ENDBR,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 281
* EL152.cbl
 13703               1020-ENDBR
 13704         DEPENDING ON DFHEIGDI
 13705     ELSE IF DFHEIGDJ EQUAL 7
 13706         GO TO 2120-ENDBR,
 13707               2120-ENDBR,
 13708               8890-TEXT-NOT-OPEN
 13709         DEPENDING ON DFHEIGDI
 13710     ELSE IF DFHEIGDJ EQUAL 8
 13711         GO TO 8860-CLAM-NOT-OPEN,
 13712               3010-NOT-FOUND
 13713         DEPENDING ON DFHEIGDI
 13714     ELSE IF DFHEIGDJ EQUAL 9
 13715         GO TO 9990-ABEND
 13716         DEPENDING ON DFHEIGDI
 13717     ELSE IF DFHEIGDJ EQUAL 10
 13718         GO TO 6499-EXIT
 13719         DEPENDING ON DFHEIGDI
 13720     ELSE IF DFHEIGDJ EQUAL 11
 13721         GO TO 6599-EXIT
 13722         DEPENDING ON DFHEIGDI
 13723     ELSE IF DFHEIGDJ EQUAL 12
 13724         GO TO 8860-CLAM-NOT-OPEN,
 13725               7090-CLAIM-NOT-FOUND
 13726         DEPENDING ON DFHEIGDI
 13727     ELSE IF DFHEIGDJ EQUAL 13
 13728         GO TO 8880-ACCT-NOT-OPEN,
 13729               7080-ACCT-NOT-FOUND
 13730         DEPENDING ON DFHEIGDI
 13731     ELSE IF DFHEIGDJ EQUAL 14
 13732         GO TO 7070-ACTV-NOT-FOUND
 13733         DEPENDING ON DFHEIGDI
 13734     ELSE IF DFHEIGDJ EQUAL 15
 13735         GO TO 7070-ACTV-NOT-FOUND
 13736         DEPENDING ON DFHEIGDI
 13737     ELSE IF DFHEIGDJ EQUAL 16
 13738         GO TO 8870-ACTV-NOT-OPEN,
 13739               7070-ACTV-NOT-FOUND
 13740         DEPENDING ON DFHEIGDI
 13741     ELSE IF DFHEIGDJ EQUAL 17
 13742         GO TO 7075-CONTINUE-ACTV-ERROR
 13743         DEPENDING ON DFHEIGDI
 13744     ELSE IF DFHEIGDJ EQUAL 18
 13745         GO TO 8900-CERT-NOT-OPEN,
 13746               8910-CERT-NOT-FOUND
 13747         DEPENDING ON DFHEIGDI
 13748     ELSE IF DFHEIGDJ EQUAL 19
 13749         GO TO 8870-ACTV-NOT-OPEN,
 13750               7200-READ-LOAN-NUMBER
 13751         DEPENDING ON DFHEIGDI
 13752     ELSE IF DFHEIGDJ EQUAL 20
 13753         GO TO 8870-ACTV-NOT-OPEN,
 13754               7201-READ-BENEFICIARY
 13755         DEPENDING ON DFHEIGDI
 13756     ELSE IF DFHEIGDJ EQUAL 21
 13757         GO TO 7290-BENE-NOT-OPEN,
 13758               7205-READ-PHYSICIAN-ADDR
 13759         DEPENDING ON DFHEIGDI
 13760     ELSE IF DFHEIGDJ EQUAL 22
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 282
* EL152.cbl
 13761         GO TO 8870-ACTV-NOT-OPEN,
 13762               7210-READ-EMPLOYER-ADDR
 13763         DEPENDING ON DFHEIGDI
 13764     ELSE IF DFHEIGDJ EQUAL 23
 13765         GO TO 8870-ACTV-NOT-OPEN,
 13766               7220-READ-INSURED-ADDR
 13767         DEPENDING ON DFHEIGDI
 13768     ELSE IF DFHEIGDJ EQUAL 24
 13769         GO TO 8870-ACTV-NOT-OPEN,
 13770               7225-READ-OTHER1-ADDR
 13771         DEPENDING ON DFHEIGDI
 13772     ELSE IF DFHEIGDJ EQUAL 25
 13773         GO TO 8870-ACTV-NOT-OPEN,
 13774               7230-READ-OTHER2-ADDR
 13775         DEPENDING ON DFHEIGDI
 13776     ELSE IF DFHEIGDJ EQUAL 26
 13777         GO TO 8870-ACTV-NOT-OPEN,
 13778               7240-NOT-FOUND
 13779         DEPENDING ON DFHEIGDI
 13780     ELSE IF DFHEIGDJ EQUAL 27
 13781         GO TO 8870-ACTV-NOT-OPEN,
 13782               7250-READ-ACCOUNT
 13783         DEPENDING ON DFHEIGDI
 13784     ELSE IF DFHEIGDJ EQUAL 28
 13785         GO TO 8880-ACCT-NOT-OPEN,
 13786               7251-READ-3RD-PARTY
 13787         DEPENDING ON DFHEIGDI
 13788     ELSE IF DFHEIGDJ EQUAL 29
 13789         GO TO 8870-ACTV-NOT-OPEN,
 13790               7252-READ-COMP
 13791         DEPENDING ON DFHEIGDI
 13792     ELSE IF DFHEIGDJ EQUAL 30
 13793         GO TO 7260-READ-DENIAL
 13794         DEPENDING ON DFHEIGDI
 13795     ELSE IF DFHEIGDJ EQUAL 31
 13796         GO TO 8870-ACTV-NOT-OPEN,
 13797               7265-READ-CNTL1,
 13798               7265-READ-CNTL1
 13799         DEPENDING ON DFHEIGDI
 13800     ELSE IF DFHEIGDJ EQUAL 32
 13801         GO TO 8840-CNTL-NOT-OPEN,
 13802               7266-READ-CNTL2
 13803         DEPENDING ON DFHEIGDI
 13804     ELSE IF DFHEIGDJ EQUAL 33
 13805         GO TO 8840-CNTL-NOT-OPEN,
 13806               7267-READ-CNTL4
 13807         DEPENDING ON DFHEIGDI
 13808     ELSE IF DFHEIGDJ EQUAL 34
 13809         GO TO 8840-CNTL-NOT-OPEN,
 13810               7267-READ-CNTL6
 13811         DEPENDING ON DFHEIGDI
 13812     ELSE IF DFHEIGDJ EQUAL 35
 13813         GO TO 8840-CNTL-NOT-OPEN,
 13814               7268-SET-DATE
 13815         DEPENDING ON DFHEIGDI
 13816     ELSE IF DFHEIGDJ EQUAL 36
 13817         GO TO 7290-BENE-NOT-OPEN,
 13818               7290-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 283
* EL152.cbl
 13819         DEPENDING ON DFHEIGDI
 13820     ELSE IF DFHEIGDJ EQUAL 37
 13821         GO TO 7590-TS-QIDERR,
 13822               7585-TS-ITEMERR
 13823         DEPENDING ON DFHEIGDI
 13824     ELSE IF DFHEIGDJ EQUAL 38
 13825         GO TO 7690-TS-QIDERR,
 13826               7685-TS-ITEMERR
 13827         DEPENDING ON DFHEIGDI
 13828     ELSE IF DFHEIGDJ EQUAL 39
 13829         GO TO 7750-EXIT
 13830         DEPENDING ON DFHEIGDI
 13831     ELSE IF DFHEIGDJ EQUAL 40
 13832         GO TO 7760-EXIT
 13833         DEPENDING ON DFHEIGDI
 13834     ELSE IF DFHEIGDJ EQUAL 41
 13835         GO TO 7770-EXIT
 13836         DEPENDING ON DFHEIGDI
 13837     ELSE IF DFHEIGDJ EQUAL 42
 13838         GO TO 8860-CLAM-NOT-OPEN,
 13839               7800-CLAIM-NOT-FOUND
 13840         DEPENDING ON DFHEIGDI
 13841     ELSE IF DFHEIGDJ EQUAL 43
 13842         GO TO 7800-GET-PRINTER
 13843         DEPENDING ON DFHEIGDI
 13844     ELSE IF DFHEIGDJ EQUAL 44
 13845         GO TO 8840-CNTL-NOT-OPEN,
 13846               7890-NOT-FOUND
 13847         DEPENDING ON DFHEIGDI
 13848     ELSE IF DFHEIGDJ EQUAL 45
 13849         GO TO 8820-TERM-ERROR,
 13850               8830-TRAN-ERROR
 13851         DEPENDING ON DFHEIGDI
 13852     ELSE IF DFHEIGDJ EQUAL 46
 13853         GO TO 8300-SEND-TEXT
 13854         DEPENDING ON DFHEIGDI.
 13855     MOVE '9%                    "   ' TO DFHEIV0
 13856     MOVE 'EL152' TO DFHEIV1
 13857     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 13858     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       47192     Code:       43961
